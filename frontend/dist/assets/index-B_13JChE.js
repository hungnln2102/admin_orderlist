function PR(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function is(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xx={exports:{}},du={},gx={exports:{}},bt={};var q_;function jR(){if(q_)return bt;q_=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.iterator;function x(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function b(G,ne,ie){this.props=G,this.context=ne,this.refs=w,this.updater=ie||g}b.prototype.isReactComponent={},b.prototype.setState=function(G,ne){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ne,"setState")},b.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function S(){}S.prototype=b.prototype;function T(G,ne,ie){this.props=G,this.context=ne,this.refs=w,this.updater=ie||g}var E=T.prototype=new S;E.constructor=T,_(E,b.prototype),E.isPureReactComponent=!0;var A=Array.isArray,k=Object.prototype.hasOwnProperty,j={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function M(G,ne,ie){var de,ge={},Oe=null,fe=null;if(ne!=null)for(de in ne.ref!==void 0&&(fe=ne.ref),ne.key!==void 0&&(Oe=""+ne.key),ne)k.call(ne,de)&&!P.hasOwnProperty(de)&&(ge[de]=ne[de]);var O=arguments.length-2;if(O===1)ge.children=ie;else if(1<O){for(var D=Array(O),z=0;z<O;z++)D[z]=arguments[z+2];ge.children=D}if(G&&G.defaultProps)for(de in O=G.defaultProps,O)ge[de]===void 0&&(ge[de]=O[de]);return{$$typeof:e,type:G,key:Oe,ref:fe,props:ge,_owner:j.current}}function L(G,ne){return{$$typeof:e,type:G.type,key:ne,ref:G.ref,props:G.props,_owner:G._owner}}function B(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function R(G){var ne={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ie){return ne[ie]})}var U=/\/+/g;function oe(G,ne){return typeof G=="object"&&G!==null&&G.key!=null?R(""+G.key):ne.toString(36)}function V(G,ne,ie,de,ge){var Oe=typeof G;(Oe==="undefined"||Oe==="boolean")&&(G=null);var fe=!1;if(G===null)fe=!0;else switch(Oe){case"string":case"number":fe=!0;break;case"object":switch(G.$$typeof){case e:case t:fe=!0}}if(fe)return fe=G,ge=ge(fe),G=de===""?"."+oe(fe,0):de,A(ge)?(ie="",G!=null&&(ie=G.replace(U,"$&/")+"/"),V(ge,ne,ie,"",function(z){return z})):ge!=null&&(B(ge)&&(ge=L(ge,ie+(!ge.key||fe&&fe.key===ge.key?"":(""+ge.key).replace(U,"$&/")+"/")+G)),ne.push(ge)),1;if(fe=0,de=de===""?".":de+":",A(G))for(var O=0;O<G.length;O++){Oe=G[O];var D=de+oe(Oe,O);fe+=V(Oe,ne,ie,D,ge)}else if(D=x(G),typeof D=="function")for(G=D.call(G),O=0;!(Oe=G.next()).done;)Oe=Oe.value,D=de+oe(Oe,O++),fe+=V(Oe,ne,ie,D,ge);else if(Oe==="object")throw ne=String(G),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return fe}function ae(G,ne,ie){if(G==null)return G;var de=[],ge=0;return V(G,de,"","",function(Oe){return ne.call(ie,Oe,ge++)}),de}function le(G){if(G._status===-1){var ne=G._result;ne=ne(),ne.then(function(ie){(G._status===0||G._status===-1)&&(G._status=1,G._result=ie)},function(ie){(G._status===0||G._status===-1)&&(G._status=2,G._result=ie)}),G._status===-1&&(G._status=0,G._result=ne)}if(G._status===1)return G._result.default;throw G._result}var J={current:null},re={transition:null},Z={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:re,ReactCurrentOwner:j};function se(){throw Error("act(...) is not supported in production builds of React.")}return bt.Children={map:ae,forEach:function(G,ne,ie){ae(G,function(){ne.apply(this,arguments)},ie)},count:function(G){var ne=0;return ae(G,function(){ne++}),ne},toArray:function(G){return ae(G,function(ne){return ne})||[]},only:function(G){if(!B(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},bt.Component=b,bt.Fragment=r,bt.Profiler=i,bt.PureComponent=T,bt.StrictMode=n,bt.Suspense=f,bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,bt.act=se,bt.cloneElement=function(G,ne,ie){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var de=_({},G.props),ge=G.key,Oe=G.ref,fe=G._owner;if(ne!=null){if(ne.ref!==void 0&&(Oe=ne.ref,fe=j.current),ne.key!==void 0&&(ge=""+ne.key),G.type&&G.type.defaultProps)var O=G.type.defaultProps;for(D in ne)k.call(ne,D)&&!P.hasOwnProperty(D)&&(de[D]=ne[D]===void 0&&O!==void 0?O[D]:ne[D])}var D=arguments.length-2;if(D===1)de.children=ie;else if(1<D){O=Array(D);for(var z=0;z<D;z++)O[z]=arguments[z+2];de.children=O}return{$$typeof:e,type:G.type,key:ge,ref:Oe,props:de,_owner:fe}},bt.createContext=function(G){return G={$$typeof:s,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:a,_context:G},G.Consumer=G},bt.createElement=M,bt.createFactory=function(G){var ne=M.bind(null,G);return ne.type=G,ne},bt.createRef=function(){return{current:null}},bt.forwardRef=function(G){return{$$typeof:l,render:G}},bt.isValidElement=B,bt.lazy=function(G){return{$$typeof:d,_payload:{_status:-1,_result:G},_init:le}},bt.memo=function(G,ne){return{$$typeof:h,type:G,compare:ne===void 0?null:ne}},bt.startTransition=function(G){var ne=re.transition;re.transition={};try{G()}finally{re.transition=ne}},bt.unstable_act=se,bt.useCallback=function(G,ne){return J.current.useCallback(G,ne)},bt.useContext=function(G){return J.current.useContext(G)},bt.useDebugValue=function(){},bt.useDeferredValue=function(G){return J.current.useDeferredValue(G)},bt.useEffect=function(G,ne){return J.current.useEffect(G,ne)},bt.useId=function(){return J.current.useId()},bt.useImperativeHandle=function(G,ne,ie){return J.current.useImperativeHandle(G,ne,ie)},bt.useInsertionEffect=function(G,ne){return J.current.useInsertionEffect(G,ne)},bt.useLayoutEffect=function(G,ne){return J.current.useLayoutEffect(G,ne)},bt.useMemo=function(G,ne){return J.current.useMemo(G,ne)},bt.useReducer=function(G,ne,ie){return J.current.useReducer(G,ne,ie)},bt.useRef=function(G){return J.current.useRef(G)},bt.useState=function(G){return J.current.useState(G)},bt.useSyncExternalStore=function(G,ne,ie){return J.current.useSyncExternalStore(G,ne,ie)},bt.useTransition=function(){return J.current.useTransition()},bt.version="18.3.1",bt}var Z_;function fc(){return Z_||(Z_=1,gx.exports=jR()),gx.exports}var Q_;function OR(){if(Q_)return du;Q_=1;var e=fc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function s(l,f,h){var d,m={},x=null,g=null;h!==void 0&&(x=""+h),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(g=f.ref);for(d in f)n.call(f,d)&&!a.hasOwnProperty(d)&&(m[d]=f[d]);if(l&&l.defaultProps)for(d in f=l.defaultProps,f)m[d]===void 0&&(m[d]=f[d]);return{$$typeof:t,type:l,key:x,ref:g,props:m,_owner:i.current}}return du.Fragment=r,du.jsx=s,du.jsxs=s,du}var J_;function DR(){return J_||(J_=1,xx.exports=OR()),xx.exports}var u=DR(),Md={},vx={exports:{}},Zn={},yx={exports:{}},wx={};var eS;function RR(){return eS||(eS=1,(function(e){function t(re,Z){var se=re.length;re.push(Z);e:for(;0<se;){var G=se-1>>>1,ne=re[G];if(0<i(ne,Z))re[G]=Z,re[se]=ne,se=G;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var Z=re[0],se=re.pop();if(se!==Z){re[0]=se;e:for(var G=0,ne=re.length,ie=ne>>>1;G<ie;){var de=2*(G+1)-1,ge=re[de],Oe=de+1,fe=re[Oe];if(0>i(ge,se))Oe<ne&&0>i(fe,ge)?(re[G]=fe,re[Oe]=se,G=Oe):(re[G]=ge,re[de]=se,G=de);else if(Oe<ne&&0>i(fe,se))re[G]=fe,re[Oe]=se,G=Oe;else break e}}return Z}function i(re,Z){var se=re.sortIndex-Z.sortIndex;return se!==0?se:re.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var f=[],h=[],d=1,m=null,x=3,g=!1,_=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(re){for(var Z=r(h);Z!==null;){if(Z.callback===null)n(h);else if(Z.startTime<=re)n(h),Z.sortIndex=Z.expirationTime,t(f,Z);else break;Z=r(h)}}function A(re){if(w=!1,E(re),!_)if(r(f)!==null)_=!0,le(k);else{var Z=r(h);Z!==null&&J(A,Z.startTime-re)}}function k(re,Z){_=!1,w&&(w=!1,S(M),M=-1),g=!0;var se=x;try{for(E(Z),m=r(f);m!==null&&(!(m.expirationTime>Z)||re&&!R());){var G=m.callback;if(typeof G=="function"){m.callback=null,x=m.priorityLevel;var ne=G(m.expirationTime<=Z);Z=e.unstable_now(),typeof ne=="function"?m.callback=ne:m===r(f)&&n(f),E(Z)}else n(f);m=r(f)}if(m!==null)var ie=!0;else{var de=r(h);de!==null&&J(A,de.startTime-Z),ie=!1}return ie}finally{m=null,x=se,g=!1}}var j=!1,P=null,M=-1,L=5,B=-1;function R(){return!(e.unstable_now()-B<L)}function U(){if(P!==null){var re=e.unstable_now();B=re;var Z=!0;try{Z=P(!0,re)}finally{Z?oe():(j=!1,P=null)}}else j=!1}var oe;if(typeof T=="function")oe=function(){T(U)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ae=V.port2;V.port1.onmessage=U,oe=function(){ae.postMessage(null)}}else oe=function(){b(U,0)};function le(re){P=re,j||(j=!0,oe())}function J(re,Z){M=b(function(){re(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){_||g||(_=!0,le(k))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(re){switch(x){case 1:case 2:case 3:var Z=3;break;default:Z=x}var se=x;x=Z;try{return re()}finally{x=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,Z){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var se=x;x=re;try{return Z()}finally{x=se}},e.unstable_scheduleCallback=function(re,Z,se){var G=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?G+se:G):se=G,re){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=se+ne,re={id:d++,callback:Z,priorityLevel:re,startTime:se,expirationTime:ne,sortIndex:-1},se>G?(re.sortIndex=se,t(h,re),r(f)===null&&re===r(h)&&(w?(S(M),M=-1):w=!0,J(A,se-G))):(re.sortIndex=ne,t(f,re),_||g||(_=!0,le(k))),re},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(re){var Z=x;return function(){var se=x;x=Z;try{return re.apply(this,arguments)}finally{x=se}}}})(wx)),wx}var tS;function IR(){return tS||(tS=1,yx.exports=RR()),yx.exports}var rS;function FR(){if(rS)return Zn;rS=1;var e=fc(),t=IR();function r(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,p=1;p<arguments.length;p++)c+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(o,c){s(o,c),s(o+"Capture",c)}function s(o,c){for(i[o]=c,o=0;o<c.length;o++)n.add(c[o])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},m={};function x(o){return f.call(m,o)?!0:f.call(d,o)?!1:h.test(o)?m[o]=!0:(d[o]=!0,!1)}function g(o,c,p,y){if(p!==null&&p.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function _(o,c,p,y){if(c===null||typeof c>"u"||g(o,c,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(o,c,p,y,N,C,I){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=y,this.attributeNamespace=N,this.mustUseProperty=p,this.propertyName=o,this.type=c,this.sanitizeURL=C,this.removeEmptyString=I}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){b[o]=new w(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];b[c]=new w(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){b[o]=new w(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){b[o]=new w(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){b[o]=new w(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){b[o]=new w(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){b[o]=new w(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){b[o]=new w(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){b[o]=new w(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(S,T);b[c]=new w(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(S,T);b[c]=new w(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(S,T);b[c]=new w(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){b[o]=new w(o,1,!1,o.toLowerCase(),null,!1,!1)}),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){b[o]=new w(o,1,!1,o.toLowerCase(),null,!0,!0)});function E(o,c,p,y){var N=b.hasOwnProperty(c)?b[c]:null;(N!==null?N.type!==0:y||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(_(c,p,N,y)&&(p=null),y||N===null?x(c)&&(p===null?o.removeAttribute(c):o.setAttribute(c,""+p)):N.mustUseProperty?o[N.propertyName]=p===null?N.type===3?!1:"":p:(c=N.attributeName,y=N.attributeNamespace,p===null?o.removeAttribute(c):(N=N.type,p=N===3||N===4&&p===!0?"":""+p,y?o.setAttributeNS(y,c,p):o.setAttribute(c,p))))}var A=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),j=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),R=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),re=Symbol.iterator;function Z(o){return o===null||typeof o!="object"?null:(o=re&&o[re]||o["@@iterator"],typeof o=="function"?o:null)}var se=Object.assign,G;function ne(o){if(G===void 0)try{throw Error()}catch(p){var c=p.stack.trim().match(/\n( *(at )?)/);G=c&&c[1]||""}return`
`+G+o}var ie=!1;function de(o,c){if(!o||ie)return"";ie=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(ke){var y=ke}Reflect.construct(o,[],c)}else{try{c.call()}catch(ke){y=ke}o.call(c.prototype)}else{try{throw Error()}catch(ke){y=ke}o()}}catch(ke){if(ke&&y&&typeof ke.stack=="string"){for(var N=ke.stack.split(`
`),C=y.stack.split(`
`),I=N.length-1,ee=C.length-1;1<=I&&0<=ee&&N[I]!==C[ee];)ee--;for(;1<=I&&0<=ee;I--,ee--)if(N[I]!==C[ee]){if(I!==1||ee!==1)do if(I--,ee--,0>ee||N[I]!==C[ee]){var ce=`
`+N[I].replace(" at new "," at ");return o.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",o.displayName)),ce}while(1<=I&&0<=ee);break}}}finally{ie=!1,Error.prepareStackTrace=p}return(o=o?o.displayName||o.name:"")?ne(o):""}function ge(o){switch(o.tag){case 5:return ne(o.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return o=de(o.type,!1),o;case 11:return o=de(o.type.render,!1),o;case 1:return o=de(o.type,!0),o;default:return""}}function Oe(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case j:return"Portal";case L:return"Profiler";case M:return"StrictMode";case oe:return"Suspense";case V:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case R:return(o.displayName||"Context")+".Consumer";case B:return(o._context.displayName||"Context")+".Provider";case U:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ae:return c=o.displayName||null,c!==null?c:Oe(o.type)||"Memo";case le:c=o._payload,o=o._init;try{return Oe(o(c))}catch{}}return null}function fe(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(c);case 8:return c===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function O(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function D(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function z(o){var c=D(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),y=""+o[c];if(!o.hasOwnProperty(c)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,C=p.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return N.call(this)},set:function(I){y=""+I,C.call(this,I)}}),Object.defineProperty(o,c,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(I){y=""+I},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function H(o){o._valueTracker||(o._valueTracker=z(o))}function te(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var p=c.getValue(),y="";return o&&(y=D(o)?o.checked?"true":"false":o.value),o=y,o!==p?(c.setValue(o),!0):!1}function Re(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ee(o,c){var p=c.checked;return se({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??o._wrapperState.initialChecked})}function me(o,c){var p=c.defaultValue==null?"":c.defaultValue,y=c.checked!=null?c.checked:c.defaultChecked;p=O(c.value!=null?c.value:p),o._wrapperState={initialChecked:y,initialValue:p,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function xe(o,c){c=c.checked,c!=null&&E(o,"checked",c,!1)}function Ce(o,c){xe(o,c);var p=O(c.value),y=c.type;if(p!=null)y==="number"?(p===0&&o.value===""||o.value!=p)&&(o.value=""+p):o.value!==""+p&&(o.value=""+p);else if(y==="submit"||y==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?pe(o,c.type,p):c.hasOwnProperty("defaultValue")&&pe(o,c.type,O(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function Le(o,c,p){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var y=c.type;if(!(y!=="submit"&&y!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,p||c===o.value||(o.value=c),o.defaultValue=c}p=o.name,p!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,p!==""&&(o.name=p)}function pe(o,c,p){(c!=="number"||Re(o.ownerDocument)!==o)&&(p==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+p&&(o.defaultValue=""+p))}var Fe=Array.isArray;function Pe(o,c,p,y){if(o=o.options,c){c={};for(var N=0;N<p.length;N++)c["$"+p[N]]=!0;for(p=0;p<o.length;p++)N=c.hasOwnProperty("$"+o[p].value),o[p].selected!==N&&(o[p].selected=N),N&&y&&(o[p].defaultSelected=!0)}else{for(p=""+O(p),c=null,N=0;N<o.length;N++){if(o[N].value===p){o[N].selected=!0,y&&(o[N].defaultSelected=!0);return}c!==null||o[N].disabled||(c=o[N])}c!==null&&(c.selected=!0)}}function We(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(r(91));return se({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function je(o,c){var p=c.value;if(p==null){if(p=c.children,c=c.defaultValue,p!=null){if(c!=null)throw Error(r(92));if(Fe(p)){if(1<p.length)throw Error(r(93));p=p[0]}c=p}c==null&&(c=""),p=c}o._wrapperState={initialValue:O(p)}}function $e(o,c){var p=O(c.value),y=O(c.defaultValue);p!=null&&(p=""+p,p!==o.value&&(o.value=p),c.defaultValue==null&&o.defaultValue!==p&&(o.defaultValue=p)),y!=null&&(o.defaultValue=""+y)}function Ae(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function xt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function he(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?xt(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var De,et=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,p,y,N){MSApp.execUnsafeLocalFunction(function(){return o(c,p,y,N)})}:o})(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(De=De||document.createElement("div"),De.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=De.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function Qe(o,c){if(c){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=c;return}}o.textContent=c}var Ve={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ke=["Webkit","ms","Moz","O"];Object.keys(Ve).forEach(function(o){Ke.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),Ve[c]=Ve[o]})});function wt(o,c,p){return c==null||typeof c=="boolean"||c===""?"":p||typeof c!="number"||c===0||Ve.hasOwnProperty(o)&&Ve[o]?(""+c).trim():c+"px"}function _t(o,c){o=o.style;for(var p in c)if(c.hasOwnProperty(p)){var y=p.indexOf("--")===0,N=wt(p,c[p],y);p==="float"&&(p="cssFloat"),y?o.setProperty(p,N):o[p]=N}}var St=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function It(o,c){if(c){if(St[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(r(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(r(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(r(61))}if(c.style!=null&&typeof c.style!="object")throw Error(r(62))}}function lr(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tr=null;function pr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var cr=null,yr=null,mr=null;function tn(o){if(o=Zc(o)){if(typeof cr!="function")throw Error(r(280));var c=o.stateNode;c&&(c=Qf(c),cr(o.stateNode,o.type,c))}}function ai(o){yr?mr?mr.push(o):mr=[o]:yr=o}function Hi(){if(yr){var o=yr,c=mr;if(mr=yr=null,tn(o),c)for(o=0;o<c.length;o++)tn(c[o])}}function Ta(o,c){return o(c)}function Of(){}var Pc=!1;function Df(o,c,p){if(Pc)return o(c,p);Pc=!0;try{return Ta(o,c,p)}finally{Pc=!1,(yr!==null||mr!==null)&&(Of(),Hi())}}function oo(o,c){var p=o.stateNode;if(p===null)return null;var y=Qf(p);if(y===null)return null;p=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(o=o.type,y=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!y;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(r(231,c,typeof p));return p}var jc=!1;if(l)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){jc=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{jc=!1}function Fp(o,c,p,y,N,C,I,ee,ce){var ke=Array.prototype.slice.call(arguments,3);try{c.apply(p,ke)}catch(He){this.onError(He)}}var lo=!1,ol=null,F=!1,Y=null,W={onError:function(o){lo=!0,ol=o}};function K(o,c,p,y,N,C,I,ee,ce){lo=!1,ol=null,Fp.apply(W,arguments)}function X(o,c,p,y,N,C,I,ee,ce){if(K.apply(this,arguments),lo){if(lo){var ke=ol;lo=!1,ol=null}else throw Error(r(198));F||(F=!0,Y=ke)}}function Q(o){var c=o,p=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(p=c.return),o=c.return;while(o)}return c.tag===3?p:null}function be(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function Ie(o){if(Q(o)!==o)throw Error(r(188))}function ye(o){var c=o.alternate;if(!c){if(c=Q(o),c===null)throw Error(r(188));return c!==o?null:o}for(var p=o,y=c;;){var N=p.return;if(N===null)break;var C=N.alternate;if(C===null){if(y=N.return,y!==null){p=y;continue}break}if(N.child===C.child){for(C=N.child;C;){if(C===p)return Ie(N),o;if(C===y)return Ie(N),c;C=C.sibling}throw Error(r(188))}if(p.return!==y.return)p=N,y=C;else{for(var I=!1,ee=N.child;ee;){if(ee===p){I=!0,p=N,y=C;break}if(ee===y){I=!0,y=N,p=C;break}ee=ee.sibling}if(!I){for(ee=C.child;ee;){if(ee===p){I=!0,p=C,y=N;break}if(ee===y){I=!0,y=C,p=N;break}ee=ee.sibling}if(!I)throw Error(r(189))}}if(p.alternate!==y)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?o:c}function _e(o){return o=ye(o),o!==null?Se(o):null}function Se(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=Se(o);if(c!==null)return c;o=o.sibling}return null}var Ge=t.unstable_scheduleCallback,Je=t.unstable_cancelCallback,rt=t.unstable_shouldYield,Xe=t.unstable_requestPaint,Ue=t.unstable_now,gt=t.unstable_getCurrentPriorityLevel,$t=t.unstable_ImmediatePriority,Vt=t.unstable_UserBlockingPriority,wr=t.unstable_NormalPriority,co=t.unstable_LowPriority,fs=t.unstable_IdlePriority,sa=null,Gr=null;function Oc(o){if(Gr&&typeof Gr.onCommitFiberRoot=="function")try{Gr.onCommitFiberRoot(sa,o,void 0,(o.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:Y5,K5=Math.log,G5=Math.LN2;function Y5(o){return o>>>=0,o===0?32:31-(K5(o)/G5|0)|0}var Rf=64,If=4194304;function Dc(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Ff(o,c){var p=o.pendingLanes;if(p===0)return 0;var y=0,N=o.suspendedLanes,C=o.pingedLanes,I=p&268435455;if(I!==0){var ee=I&~N;ee!==0?y=Dc(ee):(C&=I,C!==0&&(y=Dc(C)))}else I=p&~N,I!==0?y=Dc(I):C!==0&&(y=Dc(C));if(y===0)return 0;if(c!==0&&c!==y&&(c&N)===0&&(N=y&-y,C=c&-c,N>=C||N===16&&(C&4194240)!==0))return c;if((y&4)!==0&&(y|=p&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=y;0<c;)p=31-br(c),N=1<<p,y|=o[p],c&=~N;return y}function X5(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q5(o,c){for(var p=o.suspendedLanes,y=o.pingedLanes,N=o.expirationTimes,C=o.pendingLanes;0<C;){var I=31-br(C),ee=1<<I,ce=N[I];ce===-1?((ee&p)===0||(ee&y)!==0)&&(N[I]=X5(ee,c)):ce<=c&&(o.expiredLanes|=ee),C&=~ee}}function Mp(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Cb(){var o=Rf;return Rf<<=1,(Rf&4194240)===0&&(Rf=64),o}function Lp(o){for(var c=[],p=0;31>p;p++)c.push(o);return c}function Rc(o,c,p){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-br(c),o[c]=p}function Z5(o,c){var p=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var y=o.eventTimes;for(o=o.expirationTimes;0<p;){var N=31-br(p),C=1<<N;c[N]=0,y[N]=-1,o[N]=-1,p&=~C}}function Bp(o,c){var p=o.entangledLanes|=c;for(o=o.entanglements;p;){var y=31-br(p),N=1<<y;N&c|o[y]&c&&(o[y]|=c),p&=~N}}var Ft=0;function kb(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Ab,$p,Pb,jb,Ob,Up=!1,Mf=[],ds=null,hs=null,ps=null,Ic=new Map,Fc=new Map,ms=[],Q5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Db(o,c){switch(o){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":Ic.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fc.delete(c.pointerId)}}function Mc(o,c,p,y,N,C){return o===null||o.nativeEvent!==C?(o={blockedOn:c,domEventName:p,eventSystemFlags:y,nativeEvent:C,targetContainers:[N]},c!==null&&(c=Zc(c),c!==null&&$p(c)),o):(o.eventSystemFlags|=y,c=o.targetContainers,N!==null&&c.indexOf(N)===-1&&c.push(N),o)}function J5(o,c,p,y,N){switch(c){case"focusin":return ds=Mc(ds,o,c,p,y,N),!0;case"dragenter":return hs=Mc(hs,o,c,p,y,N),!0;case"mouseover":return ps=Mc(ps,o,c,p,y,N),!0;case"pointerover":var C=N.pointerId;return Ic.set(C,Mc(Ic.get(C)||null,o,c,p,y,N)),!0;case"gotpointercapture":return C=N.pointerId,Fc.set(C,Mc(Fc.get(C)||null,o,c,p,y,N)),!0}return!1}function Rb(o){var c=uo(o.target);if(c!==null){var p=Q(c);if(p!==null){if(c=p.tag,c===13){if(c=be(p),c!==null){o.blockedOn=c,Ob(o.priority,function(){Pb(p)});return}}else if(c===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Lf(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var p=Wp(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(p===null){p=o.nativeEvent;var y=new p.constructor(p.type,p);Tr=y,p.target.dispatchEvent(y),Tr=null}else return c=Zc(p),c!==null&&$p(c),o.blockedOn=p,!1;c.shift()}return!0}function Ib(o,c,p){Lf(o)&&p.delete(c)}function eD(){Up=!1,ds!==null&&Lf(ds)&&(ds=null),hs!==null&&Lf(hs)&&(hs=null),ps!==null&&Lf(ps)&&(ps=null),Ic.forEach(Ib),Fc.forEach(Ib)}function Lc(o,c){o.blockedOn===c&&(o.blockedOn=null,Up||(Up=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,eD)))}function Bc(o){function c(N){return Lc(N,o)}if(0<Mf.length){Lc(Mf[0],o);for(var p=1;p<Mf.length;p++){var y=Mf[p];y.blockedOn===o&&(y.blockedOn=null)}}for(ds!==null&&Lc(ds,o),hs!==null&&Lc(hs,o),ps!==null&&Lc(ps,o),Ic.forEach(c),Fc.forEach(c),p=0;p<ms.length;p++)y=ms[p],y.blockedOn===o&&(y.blockedOn=null);for(;0<ms.length&&(p=ms[0],p.blockedOn===null);)Rb(p),p.blockedOn===null&&ms.shift()}var ll=A.ReactCurrentBatchConfig,Bf=!0;function tD(o,c,p,y){var N=Ft,C=ll.transition;ll.transition=null;try{Ft=1,zp(o,c,p,y)}finally{Ft=N,ll.transition=C}}function rD(o,c,p,y){var N=Ft,C=ll.transition;ll.transition=null;try{Ft=4,zp(o,c,p,y)}finally{Ft=N,ll.transition=C}}function zp(o,c,p,y){if(Bf){var N=Wp(o,c,p,y);if(N===null)sm(o,c,y,$f,p),Db(o,y);else if(J5(N,o,c,p,y))y.stopPropagation();else if(Db(o,y),c&4&&-1<Q5.indexOf(o)){for(;N!==null;){var C=Zc(N);if(C!==null&&Ab(C),C=Wp(o,c,p,y),C===null&&sm(o,c,y,$f,p),C===N)break;N=C}N!==null&&y.stopPropagation()}else sm(o,c,y,null,p)}}var $f=null;function Wp(o,c,p,y){if($f=null,o=pr(y),o=uo(o),o!==null)if(c=Q(o),c===null)o=null;else if(p=c.tag,p===13){if(o=be(c),o!==null)return o;o=null}else if(p===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return $f=o,null}function Fb(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gt()){case $t:return 1;case Vt:return 4;case wr:case co:return 16;case fs:return 536870912;default:return 16}default:return 16}}var xs=null,Hp=null,Uf=null;function Mb(){if(Uf)return Uf;var o,c=Hp,p=c.length,y,N="value"in xs?xs.value:xs.textContent,C=N.length;for(o=0;o<p&&c[o]===N[o];o++);var I=p-o;for(y=1;y<=I&&c[p-y]===N[C-y];y++);return Uf=N.slice(o,1<y?1-y:void 0)}function zf(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Wf(){return!0}function Lb(){return!1}function si(o){function c(p,y,N,C,I){this._reactName=p,this._targetInst=N,this.type=y,this.nativeEvent=C,this.target=I,this.currentTarget=null;for(var ee in o)o.hasOwnProperty(ee)&&(p=o[ee],this[ee]=p?p(C):C[ee]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Wf:Lb,this.isPropagationStopped=Lb,this}return se(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Wf)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Wf)},persist:function(){},isPersistent:Wf}),c}var cl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vp=si(cl),$c=se({},cl,{view:0,detail:0}),nD=si($c),Kp,Gp,Uc,Hf=se({},$c,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xp,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Uc&&(Uc&&o.type==="mousemove"?(Kp=o.screenX-Uc.screenX,Gp=o.screenY-Uc.screenY):Gp=Kp=0,Uc=o),Kp)},movementY:function(o){return"movementY"in o?o.movementY:Gp}}),Bb=si(Hf),iD=se({},Hf,{dataTransfer:0}),aD=si(iD),sD=se({},$c,{relatedTarget:0}),Yp=si(sD),oD=se({},cl,{animationName:0,elapsedTime:0,pseudoElement:0}),lD=si(oD),cD=se({},cl,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),uD=si(cD),fD=se({},cl,{data:0}),$b=si(fD),dD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mD(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=pD[o])?!!c[o]:!1}function Xp(){return mD}var xD=se({},$c,{key:function(o){if(o.key){var c=dD[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=zf(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?hD[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xp,charCode:function(o){return o.type==="keypress"?zf(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?zf(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),gD=si(xD),vD=se({},Hf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ub=si(vD),yD=se({},$c,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xp}),wD=si(yD),bD=se({},cl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_D=si(bD),SD=se({},Hf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),ND=si(SD),ED=[9,13,27,32],qp=l&&"CompositionEvent"in window,zc=null;l&&"documentMode"in document&&(zc=document.documentMode);var TD=l&&"TextEvent"in window&&!zc,zb=l&&(!qp||zc&&8<zc&&11>=zc),Wb=" ",Hb=!1;function Vb(o,c){switch(o){case"keyup":return ED.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kb(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ul=!1;function CD(o,c){switch(o){case"compositionend":return Kb(c);case"keypress":return c.which!==32?null:(Hb=!0,Wb);case"textInput":return o=c.data,o===Wb&&Hb?null:o;default:return null}}function kD(o,c){if(ul)return o==="compositionend"||!qp&&Vb(o,c)?(o=Mb(),Uf=Hp=xs=null,ul=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return zb&&c.locale!=="ko"?null:c.data;default:return null}}var AD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gb(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!AD[o.type]:c==="textarea"}function Yb(o,c,p,y){ai(y),c=Xf(c,"onChange"),0<c.length&&(p=new Vp("onChange","change",null,p,y),o.push({event:p,listeners:c}))}var Wc=null,Hc=null;function PD(o){d2(o,0)}function Vf(o){var c=ml(o);if(te(c))return o}function jD(o,c){if(o==="change")return c}var Xb=!1;if(l){var Zp;if(l){var Qp="oninput"in document;if(!Qp){var qb=document.createElement("div");qb.setAttribute("oninput","return;"),Qp=typeof qb.oninput=="function"}Zp=Qp}else Zp=!1;Xb=Zp&&(!document.documentMode||9<document.documentMode)}function Zb(){Wc&&(Wc.detachEvent("onpropertychange",Qb),Hc=Wc=null)}function Qb(o){if(o.propertyName==="value"&&Vf(Hc)){var c=[];Yb(c,Hc,o,pr(o)),Df(PD,c)}}function OD(o,c,p){o==="focusin"?(Zb(),Wc=c,Hc=p,Wc.attachEvent("onpropertychange",Qb)):o==="focusout"&&Zb()}function DD(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Vf(Hc)}function RD(o,c){if(o==="click")return Vf(c)}function ID(o,c){if(o==="input"||o==="change")return Vf(c)}function FD(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Vi=typeof Object.is=="function"?Object.is:FD;function Vc(o,c){if(Vi(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var p=Object.keys(o),y=Object.keys(c);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var N=p[y];if(!f.call(c,N)||!Vi(o[N],c[N]))return!1}return!0}function Jb(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function e2(o,c){var p=Jb(o);o=0;for(var y;p;){if(p.nodeType===3){if(y=o+p.textContent.length,o<=c&&y>=c)return{node:p,offset:c-o};o=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Jb(p)}}function t2(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?t2(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function r2(){for(var o=window,c=Re();c instanceof o.HTMLIFrameElement;){try{var p=typeof c.contentWindow.location.href=="string"}catch{p=!1}if(p)o=c.contentWindow;else break;c=Re(o.document)}return c}function Jp(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function MD(o){var c=r2(),p=o.focusedElem,y=o.selectionRange;if(c!==p&&p&&p.ownerDocument&&t2(p.ownerDocument.documentElement,p)){if(y!==null&&Jp(p)){if(c=y.start,o=y.end,o===void 0&&(o=c),"selectionStart"in p)p.selectionStart=c,p.selectionEnd=Math.min(o,p.value.length);else if(o=(c=p.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var N=p.textContent.length,C=Math.min(y.start,N);y=y.end===void 0?C:Math.min(y.end,N),!o.extend&&C>y&&(N=y,y=C,C=N),N=e2(p,C);var I=e2(p,y);N&&I&&(o.rangeCount!==1||o.anchorNode!==N.node||o.anchorOffset!==N.offset||o.focusNode!==I.node||o.focusOffset!==I.offset)&&(c=c.createRange(),c.setStart(N.node,N.offset),o.removeAllRanges(),C>y?(o.addRange(c),o.extend(I.node,I.offset)):(c.setEnd(I.node,I.offset),o.addRange(c)))}}for(c=[],o=p;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<c.length;p++)o=c[p],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var LD=l&&"documentMode"in document&&11>=document.documentMode,fl=null,em=null,Kc=null,tm=!1;function n2(o,c,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;tm||fl==null||fl!==Re(y)||(y=fl,"selectionStart"in y&&Jp(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Kc&&Vc(Kc,y)||(Kc=y,y=Xf(em,"onSelect"),0<y.length&&(c=new Vp("onSelect","select",null,c,p),o.push({event:c,listeners:y}),c.target=fl)))}function Kf(o,c){var p={};return p[o.toLowerCase()]=c.toLowerCase(),p["Webkit"+o]="webkit"+c,p["Moz"+o]="moz"+c,p}var dl={animationend:Kf("Animation","AnimationEnd"),animationiteration:Kf("Animation","AnimationIteration"),animationstart:Kf("Animation","AnimationStart"),transitionend:Kf("Transition","TransitionEnd")},rm={},i2={};l&&(i2=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function Gf(o){if(rm[o])return rm[o];if(!dl[o])return o;var c=dl[o],p;for(p in c)if(c.hasOwnProperty(p)&&p in i2)return rm[o]=c[p];return o}var a2=Gf("animationend"),s2=Gf("animationiteration"),o2=Gf("animationstart"),l2=Gf("transitionend"),c2=new Map,u2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gs(o,c){c2.set(o,c),a(c,[o])}for(var nm=0;nm<u2.length;nm++){var im=u2[nm],BD=im.toLowerCase(),$D=im[0].toUpperCase()+im.slice(1);gs(BD,"on"+$D)}gs(a2,"onAnimationEnd"),gs(s2,"onAnimationIteration"),gs(o2,"onAnimationStart"),gs("dblclick","onDoubleClick"),gs("focusin","onFocus"),gs("focusout","onBlur"),gs(l2,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UD=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gc));function f2(o,c,p){var y=o.type||"unknown-event";o.currentTarget=p,X(y,c,void 0,o),o.currentTarget=null}function d2(o,c){c=(c&4)!==0;for(var p=0;p<o.length;p++){var y=o[p],N=y.event;y=y.listeners;e:{var C=void 0;if(c)for(var I=y.length-1;0<=I;I--){var ee=y[I],ce=ee.instance,ke=ee.currentTarget;if(ee=ee.listener,ce!==C&&N.isPropagationStopped())break e;f2(N,ee,ke),C=ce}else for(I=0;I<y.length;I++){if(ee=y[I],ce=ee.instance,ke=ee.currentTarget,ee=ee.listener,ce!==C&&N.isPropagationStopped())break e;f2(N,ee,ke),C=ce}}}if(F)throw o=Y,F=!1,Y=null,o}function Xt(o,c){var p=c[dm];p===void 0&&(p=c[dm]=new Set);var y=o+"__bubble";p.has(y)||(h2(c,o,2,!1),p.add(y))}function am(o,c,p){var y=0;c&&(y|=4),h2(p,o,y,c)}var Yf="_reactListening"+Math.random().toString(36).slice(2);function Yc(o){if(!o[Yf]){o[Yf]=!0,n.forEach(function(p){p!=="selectionchange"&&(UD.has(p)||am(p,!1,o),am(p,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Yf]||(c[Yf]=!0,am("selectionchange",!1,c))}}function h2(o,c,p,y){switch(Fb(c)){case 1:var N=tD;break;case 4:N=rD;break;default:N=zp}p=N.bind(null,c,p,o),N=void 0,!jc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(N=!0),y?N!==void 0?o.addEventListener(c,p,{capture:!0,passive:N}):o.addEventListener(c,p,!0):N!==void 0?o.addEventListener(c,p,{passive:N}):o.addEventListener(c,p,!1)}function sm(o,c,p,y,N){var C=y;if((c&1)===0&&(c&2)===0&&y!==null)e:for(;;){if(y===null)return;var I=y.tag;if(I===3||I===4){var ee=y.stateNode.containerInfo;if(ee===N||ee.nodeType===8&&ee.parentNode===N)break;if(I===4)for(I=y.return;I!==null;){var ce=I.tag;if((ce===3||ce===4)&&(ce=I.stateNode.containerInfo,ce===N||ce.nodeType===8&&ce.parentNode===N))return;I=I.return}for(;ee!==null;){if(I=uo(ee),I===null)return;if(ce=I.tag,ce===5||ce===6){y=C=I;continue e}ee=ee.parentNode}}y=y.return}Df(function(){var ke=C,He=pr(p),Ye=[];e:{var ze=c2.get(o);if(ze!==void 0){var tt=Vp,at=o;switch(o){case"keypress":if(zf(p)===0)break e;case"keydown":case"keyup":tt=gD;break;case"focusin":at="focus",tt=Yp;break;case"focusout":at="blur",tt=Yp;break;case"beforeblur":case"afterblur":tt=Yp;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Bb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=aD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=wD;break;case a2:case s2:case o2:tt=lD;break;case l2:tt=_D;break;case"scroll":tt=nD;break;case"wheel":tt=ND;break;case"copy":case"cut":case"paste":tt=uD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Ub}var st=(c&4)!==0,_r=!st&&o==="scroll",ve=st?ze!==null?ze+"Capture":null:ze;st=[];for(var ue=ke,Ne;ue!==null;){Ne=ue;var Ze=Ne.stateNode;if(Ne.tag===5&&Ze!==null&&(Ne=Ze,ve!==null&&(Ze=oo(ue,ve),Ze!=null&&st.push(Xc(ue,Ze,Ne)))),_r)break;ue=ue.return}0<st.length&&(ze=new tt(ze,at,null,p,He),Ye.push({event:ze,listeners:st}))}}if((c&7)===0){e:{if(ze=o==="mouseover"||o==="pointerover",tt=o==="mouseout"||o==="pointerout",ze&&p!==Tr&&(at=p.relatedTarget||p.fromElement)&&(uo(at)||at[ka]))break e;if((tt||ze)&&(ze=He.window===He?He:(ze=He.ownerDocument)?ze.defaultView||ze.parentWindow:window,tt?(at=p.relatedTarget||p.toElement,tt=ke,at=at?uo(at):null,at!==null&&(_r=Q(at),at!==_r||at.tag!==5&&at.tag!==6)&&(at=null)):(tt=null,at=ke),tt!==at)){if(st=Bb,Ze="onMouseLeave",ve="onMouseEnter",ue="mouse",(o==="pointerout"||o==="pointerover")&&(st=Ub,Ze="onPointerLeave",ve="onPointerEnter",ue="pointer"),_r=tt==null?ze:ml(tt),Ne=at==null?ze:ml(at),ze=new st(Ze,ue+"leave",tt,p,He),ze.target=_r,ze.relatedTarget=Ne,Ze=null,uo(He)===ke&&(st=new st(ve,ue+"enter",at,p,He),st.target=Ne,st.relatedTarget=_r,Ze=st),_r=Ze,tt&&at)t:{for(st=tt,ve=at,ue=0,Ne=st;Ne;Ne=hl(Ne))ue++;for(Ne=0,Ze=ve;Ze;Ze=hl(Ze))Ne++;for(;0<ue-Ne;)st=hl(st),ue--;for(;0<Ne-ue;)ve=hl(ve),Ne--;for(;ue--;){if(st===ve||ve!==null&&st===ve.alternate)break t;st=hl(st),ve=hl(ve)}st=null}else st=null;tt!==null&&p2(Ye,ze,tt,st,!1),at!==null&&_r!==null&&p2(Ye,_r,at,st,!0)}}e:{if(ze=ke?ml(ke):window,tt=ze.nodeName&&ze.nodeName.toLowerCase(),tt==="select"||tt==="input"&&ze.type==="file")var lt=jD;else if(Gb(ze))if(Xb)lt=ID;else{lt=DD;var ht=OD}else(tt=ze.nodeName)&&tt.toLowerCase()==="input"&&(ze.type==="checkbox"||ze.type==="radio")&&(lt=RD);if(lt&&(lt=lt(o,ke))){Yb(Ye,lt,p,He);break e}ht&&ht(o,ze,ke),o==="focusout"&&(ht=ze._wrapperState)&&ht.controlled&&ze.type==="number"&&pe(ze,"number",ze.value)}switch(ht=ke?ml(ke):window,o){case"focusin":(Gb(ht)||ht.contentEditable==="true")&&(fl=ht,em=ke,Kc=null);break;case"focusout":Kc=em=fl=null;break;case"mousedown":tm=!0;break;case"contextmenu":case"mouseup":case"dragend":tm=!1,n2(Ye,p,He);break;case"selectionchange":if(LD)break;case"keydown":case"keyup":n2(Ye,p,He)}var pt;if(qp)e:{switch(o){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else ul?Vb(o,p)&&(mt="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(mt="onCompositionStart");mt&&(zb&&p.locale!=="ko"&&(ul||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&ul&&(pt=Mb()):(xs=He,Hp="value"in xs?xs.value:xs.textContent,ul=!0)),ht=Xf(ke,mt),0<ht.length&&(mt=new $b(mt,o,null,p,He),Ye.push({event:mt,listeners:ht}),pt?mt.data=pt:(pt=Kb(p),pt!==null&&(mt.data=pt)))),(pt=TD?CD(o,p):kD(o,p))&&(ke=Xf(ke,"onBeforeInput"),0<ke.length&&(He=new $b("onBeforeInput","beforeinput",null,p,He),Ye.push({event:He,listeners:ke}),He.data=pt))}d2(Ye,c)})}function Xc(o,c,p){return{instance:o,listener:c,currentTarget:p}}function Xf(o,c){for(var p=c+"Capture",y=[];o!==null;){var N=o,C=N.stateNode;N.tag===5&&C!==null&&(N=C,C=oo(o,p),C!=null&&y.unshift(Xc(o,C,N)),C=oo(o,c),C!=null&&y.push(Xc(o,C,N))),o=o.return}return y}function hl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function p2(o,c,p,y,N){for(var C=c._reactName,I=[];p!==null&&p!==y;){var ee=p,ce=ee.alternate,ke=ee.stateNode;if(ce!==null&&ce===y)break;ee.tag===5&&ke!==null&&(ee=ke,N?(ce=oo(p,C),ce!=null&&I.unshift(Xc(p,ce,ee))):N||(ce=oo(p,C),ce!=null&&I.push(Xc(p,ce,ee)))),p=p.return}I.length!==0&&o.push({event:c,listeners:I})}var zD=/\r\n?/g,WD=/\u0000|\uFFFD/g;function m2(o){return(typeof o=="string"?o:""+o).replace(zD,`
`).replace(WD,"")}function qf(o,c,p){if(c=m2(c),m2(o)!==c&&p)throw Error(r(425))}function Zf(){}var om=null,lm=null;function cm(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var um=typeof setTimeout=="function"?setTimeout:void 0,HD=typeof clearTimeout=="function"?clearTimeout:void 0,x2=typeof Promise=="function"?Promise:void 0,VD=typeof queueMicrotask=="function"?queueMicrotask:typeof x2<"u"?function(o){return x2.resolve(null).then(o).catch(KD)}:um;function KD(o){setTimeout(function(){throw o})}function fm(o,c){var p=c,y=0;do{var N=p.nextSibling;if(o.removeChild(p),N&&N.nodeType===8)if(p=N.data,p==="/$"){if(y===0){o.removeChild(N),Bc(c);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=N}while(p);Bc(c)}function vs(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function g2(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(c===0)return o;c--}else p==="/$"&&c++}o=o.previousSibling}return null}var pl=Math.random().toString(36).slice(2),oa="__reactFiber$"+pl,qc="__reactProps$"+pl,ka="__reactContainer$"+pl,dm="__reactEvents$"+pl,GD="__reactListeners$"+pl,YD="__reactHandles$"+pl;function uo(o){var c=o[oa];if(c)return c;for(var p=o.parentNode;p;){if(c=p[ka]||p[oa]){if(p=c.alternate,c.child!==null||p!==null&&p.child!==null)for(o=g2(o);o!==null;){if(p=o[oa])return p;o=g2(o)}return c}o=p,p=o.parentNode}return null}function Zc(o){return o=o[oa]||o[ka],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function ml(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(r(33))}function Qf(o){return o[qc]||null}var hm=[],xl=-1;function ys(o){return{current:o}}function qt(o){0>xl||(o.current=hm[xl],hm[xl]=null,xl--)}function Kt(o,c){xl++,hm[xl]=o.current,o.current=c}var ws={},mn=ys(ws),Kn=ys(!1),fo=ws;function gl(o,c){var p=o.type.contextTypes;if(!p)return ws;var y=o.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===c)return y.__reactInternalMemoizedMaskedChildContext;var N={},C;for(C in p)N[C]=c[C];return y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=N),N}function Gn(o){return o=o.childContextTypes,o!=null}function Jf(){qt(Kn),qt(mn)}function v2(o,c,p){if(mn.current!==ws)throw Error(r(168));Kt(mn,c),Kt(Kn,p)}function y2(o,c,p){var y=o.stateNode;if(c=c.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var N in y)if(!(N in c))throw Error(r(108,fe(o)||"Unknown",N));return se({},p,y)}function ed(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ws,fo=mn.current,Kt(mn,o),Kt(Kn,Kn.current),!0}function w2(o,c,p){var y=o.stateNode;if(!y)throw Error(r(169));p?(o=y2(o,c,fo),y.__reactInternalMemoizedMergedChildContext=o,qt(Kn),qt(mn),Kt(mn,o)):qt(Kn),Kt(Kn,p)}var Aa=null,td=!1,pm=!1;function b2(o){Aa===null?Aa=[o]:Aa.push(o)}function XD(o){td=!0,b2(o)}function bs(){if(!pm&&Aa!==null){pm=!0;var o=0,c=Ft;try{var p=Aa;for(Ft=1;o<p.length;o++){var y=p[o];do y=y(!0);while(y!==null)}Aa=null,td=!1}catch(N){throw Aa!==null&&(Aa=Aa.slice(o+1)),Ge($t,bs),N}finally{Ft=c,pm=!1}}return null}var vl=[],yl=0,rd=null,nd=0,Ni=[],Ei=0,ho=null,Pa=1,ja="";function po(o,c){vl[yl++]=nd,vl[yl++]=rd,rd=o,nd=c}function _2(o,c,p){Ni[Ei++]=Pa,Ni[Ei++]=ja,Ni[Ei++]=ho,ho=o;var y=Pa;o=ja;var N=32-br(y)-1;y&=~(1<<N),p+=1;var C=32-br(c)+N;if(30<C){var I=N-N%5;C=(y&(1<<I)-1).toString(32),y>>=I,N-=I,Pa=1<<32-br(c)+N|p<<N|y,ja=C+o}else Pa=1<<C|p<<N|y,ja=o}function mm(o){o.return!==null&&(po(o,1),_2(o,1,0))}function xm(o){for(;o===rd;)rd=vl[--yl],vl[yl]=null,nd=vl[--yl],vl[yl]=null;for(;o===ho;)ho=Ni[--Ei],Ni[Ei]=null,ja=Ni[--Ei],Ni[Ei]=null,Pa=Ni[--Ei],Ni[Ei]=null}var oi=null,li=null,er=!1,Ki=null;function S2(o,c){var p=Ai(5,null,null,0);p.elementType="DELETED",p.stateNode=c,p.return=o,c=o.deletions,c===null?(o.deletions=[p],o.flags|=16):c.push(p)}function N2(o,c){switch(o.tag){case 5:var p=o.type;return c=c.nodeType!==1||p.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,oi=o,li=vs(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,oi=o,li=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(p=ho!==null?{id:Pa,overflow:ja}:null,o.memoizedState={dehydrated:c,treeContext:p,retryLane:1073741824},p=Ai(18,null,null,0),p.stateNode=c,p.return=o,o.child=p,oi=o,li=null,!0):!1;default:return!1}}function gm(o){return(o.mode&1)!==0&&(o.flags&128)===0}function vm(o){if(er){var c=li;if(c){var p=c;if(!N2(o,c)){if(gm(o))throw Error(r(418));c=vs(p.nextSibling);var y=oi;c&&N2(o,c)?S2(y,p):(o.flags=o.flags&-4097|2,er=!1,oi=o)}}else{if(gm(o))throw Error(r(418));o.flags=o.flags&-4097|2,er=!1,oi=o}}}function E2(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;oi=o}function id(o){if(o!==oi)return!1;if(!er)return E2(o),er=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!cm(o.type,o.memoizedProps)),c&&(c=li)){if(gm(o))throw T2(),Error(r(418));for(;c;)S2(o,c),c=vs(c.nextSibling)}if(E2(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var p=o.data;if(p==="/$"){if(c===0){li=vs(o.nextSibling);break e}c--}else p!=="$"&&p!=="$!"&&p!=="$?"||c++}o=o.nextSibling}li=null}}else li=oi?vs(o.stateNode.nextSibling):null;return!0}function T2(){for(var o=li;o;)o=vs(o.nextSibling)}function wl(){li=oi=null,er=!1}function ym(o){Ki===null?Ki=[o]:Ki.push(o)}var qD=A.ReactCurrentBatchConfig;function Qc(o,c,p){if(o=p.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var y=p.stateNode}if(!y)throw Error(r(147,o));var N=y,C=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===C?c.ref:(c=function(I){var ee=N.refs;I===null?delete ee[C]:ee[C]=I},c._stringRef=C,c)}if(typeof o!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,o))}return o}function ad(o,c){throw o=Object.prototype.toString.call(c),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function C2(o){var c=o._init;return c(o._payload)}function k2(o){function c(ve,ue){if(o){var Ne=ve.deletions;Ne===null?(ve.deletions=[ue],ve.flags|=16):Ne.push(ue)}}function p(ve,ue){if(!o)return null;for(;ue!==null;)c(ve,ue),ue=ue.sibling;return null}function y(ve,ue){for(ve=new Map;ue!==null;)ue.key!==null?ve.set(ue.key,ue):ve.set(ue.index,ue),ue=ue.sibling;return ve}function N(ve,ue){return ve=As(ve,ue),ve.index=0,ve.sibling=null,ve}function C(ve,ue,Ne){return ve.index=Ne,o?(Ne=ve.alternate,Ne!==null?(Ne=Ne.index,Ne<ue?(ve.flags|=2,ue):Ne):(ve.flags|=2,ue)):(ve.flags|=1048576,ue)}function I(ve){return o&&ve.alternate===null&&(ve.flags|=2),ve}function ee(ve,ue,Ne,Ze){return ue===null||ue.tag!==6?(ue=ux(Ne,ve.mode,Ze),ue.return=ve,ue):(ue=N(ue,Ne),ue.return=ve,ue)}function ce(ve,ue,Ne,Ze){var lt=Ne.type;return lt===P?He(ve,ue,Ne.props.children,Ze,Ne.key):ue!==null&&(ue.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===le&&C2(lt)===ue.type)?(Ze=N(ue,Ne.props),Ze.ref=Qc(ve,ue,Ne),Ze.return=ve,Ze):(Ze=Ad(Ne.type,Ne.key,Ne.props,null,ve.mode,Ze),Ze.ref=Qc(ve,ue,Ne),Ze.return=ve,Ze)}function ke(ve,ue,Ne,Ze){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==Ne.containerInfo||ue.stateNode.implementation!==Ne.implementation?(ue=fx(Ne,ve.mode,Ze),ue.return=ve,ue):(ue=N(ue,Ne.children||[]),ue.return=ve,ue)}function He(ve,ue,Ne,Ze,lt){return ue===null||ue.tag!==7?(ue=_o(Ne,ve.mode,Ze,lt),ue.return=ve,ue):(ue=N(ue,Ne),ue.return=ve,ue)}function Ye(ve,ue,Ne){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=ux(""+ue,ve.mode,Ne),ue.return=ve,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case k:return Ne=Ad(ue.type,ue.key,ue.props,null,ve.mode,Ne),Ne.ref=Qc(ve,null,ue),Ne.return=ve,Ne;case j:return ue=fx(ue,ve.mode,Ne),ue.return=ve,ue;case le:var Ze=ue._init;return Ye(ve,Ze(ue._payload),Ne)}if(Fe(ue)||Z(ue))return ue=_o(ue,ve.mode,Ne,null),ue.return=ve,ue;ad(ve,ue)}return null}function ze(ve,ue,Ne,Ze){var lt=ue!==null?ue.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return lt!==null?null:ee(ve,ue,""+Ne,Ze);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case k:return Ne.key===lt?ce(ve,ue,Ne,Ze):null;case j:return Ne.key===lt?ke(ve,ue,Ne,Ze):null;case le:return lt=Ne._init,ze(ve,ue,lt(Ne._payload),Ze)}if(Fe(Ne)||Z(Ne))return lt!==null?null:He(ve,ue,Ne,Ze,null);ad(ve,Ne)}return null}function tt(ve,ue,Ne,Ze,lt){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number")return ve=ve.get(Ne)||null,ee(ue,ve,""+Ze,lt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case k:return ve=ve.get(Ze.key===null?Ne:Ze.key)||null,ce(ue,ve,Ze,lt);case j:return ve=ve.get(Ze.key===null?Ne:Ze.key)||null,ke(ue,ve,Ze,lt);case le:var ht=Ze._init;return tt(ve,ue,Ne,ht(Ze._payload),lt)}if(Fe(Ze)||Z(Ze))return ve=ve.get(Ne)||null,He(ue,ve,Ze,lt,null);ad(ue,Ze)}return null}function at(ve,ue,Ne,Ze){for(var lt=null,ht=null,pt=ue,mt=ue=0,qr=null;pt!==null&&mt<Ne.length;mt++){pt.index>mt?(qr=pt,pt=null):qr=pt.sibling;var At=ze(ve,pt,Ne[mt],Ze);if(At===null){pt===null&&(pt=qr);break}o&&pt&&At.alternate===null&&c(ve,pt),ue=C(At,ue,mt),ht===null?lt=At:ht.sibling=At,ht=At,pt=qr}if(mt===Ne.length)return p(ve,pt),er&&po(ve,mt),lt;if(pt===null){for(;mt<Ne.length;mt++)pt=Ye(ve,Ne[mt],Ze),pt!==null&&(ue=C(pt,ue,mt),ht===null?lt=pt:ht.sibling=pt,ht=pt);return er&&po(ve,mt),lt}for(pt=y(ve,pt);mt<Ne.length;mt++)qr=tt(pt,ve,mt,Ne[mt],Ze),qr!==null&&(o&&qr.alternate!==null&&pt.delete(qr.key===null?mt:qr.key),ue=C(qr,ue,mt),ht===null?lt=qr:ht.sibling=qr,ht=qr);return o&&pt.forEach(function(Ps){return c(ve,Ps)}),er&&po(ve,mt),lt}function st(ve,ue,Ne,Ze){var lt=Z(Ne);if(typeof lt!="function")throw Error(r(150));if(Ne=lt.call(Ne),Ne==null)throw Error(r(151));for(var ht=lt=null,pt=ue,mt=ue=0,qr=null,At=Ne.next();pt!==null&&!At.done;mt++,At=Ne.next()){pt.index>mt?(qr=pt,pt=null):qr=pt.sibling;var Ps=ze(ve,pt,At.value,Ze);if(Ps===null){pt===null&&(pt=qr);break}o&&pt&&Ps.alternate===null&&c(ve,pt),ue=C(Ps,ue,mt),ht===null?lt=Ps:ht.sibling=Ps,ht=Ps,pt=qr}if(At.done)return p(ve,pt),er&&po(ve,mt),lt;if(pt===null){for(;!At.done;mt++,At=Ne.next())At=Ye(ve,At.value,Ze),At!==null&&(ue=C(At,ue,mt),ht===null?lt=At:ht.sibling=At,ht=At);return er&&po(ve,mt),lt}for(pt=y(ve,pt);!At.done;mt++,At=Ne.next())At=tt(pt,ve,mt,At.value,Ze),At!==null&&(o&&At.alternate!==null&&pt.delete(At.key===null?mt:At.key),ue=C(At,ue,mt),ht===null?lt=At:ht.sibling=At,ht=At);return o&&pt.forEach(function(AR){return c(ve,AR)}),er&&po(ve,mt),lt}function _r(ve,ue,Ne,Ze){if(typeof Ne=="object"&&Ne!==null&&Ne.type===P&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case k:e:{for(var lt=Ne.key,ht=ue;ht!==null;){if(ht.key===lt){if(lt=Ne.type,lt===P){if(ht.tag===7){p(ve,ht.sibling),ue=N(ht,Ne.props.children),ue.return=ve,ve=ue;break e}}else if(ht.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===le&&C2(lt)===ht.type){p(ve,ht.sibling),ue=N(ht,Ne.props),ue.ref=Qc(ve,ht,Ne),ue.return=ve,ve=ue;break e}p(ve,ht);break}else c(ve,ht);ht=ht.sibling}Ne.type===P?(ue=_o(Ne.props.children,ve.mode,Ze,Ne.key),ue.return=ve,ve=ue):(Ze=Ad(Ne.type,Ne.key,Ne.props,null,ve.mode,Ze),Ze.ref=Qc(ve,ue,Ne),Ze.return=ve,ve=Ze)}return I(ve);case j:e:{for(ht=Ne.key;ue!==null;){if(ue.key===ht)if(ue.tag===4&&ue.stateNode.containerInfo===Ne.containerInfo&&ue.stateNode.implementation===Ne.implementation){p(ve,ue.sibling),ue=N(ue,Ne.children||[]),ue.return=ve,ve=ue;break e}else{p(ve,ue);break}else c(ve,ue);ue=ue.sibling}ue=fx(Ne,ve.mode,Ze),ue.return=ve,ve=ue}return I(ve);case le:return ht=Ne._init,_r(ve,ue,ht(Ne._payload),Ze)}if(Fe(Ne))return at(ve,ue,Ne,Ze);if(Z(Ne))return st(ve,ue,Ne,Ze);ad(ve,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"?(Ne=""+Ne,ue!==null&&ue.tag===6?(p(ve,ue.sibling),ue=N(ue,Ne),ue.return=ve,ve=ue):(p(ve,ue),ue=ux(Ne,ve.mode,Ze),ue.return=ve,ve=ue),I(ve)):p(ve,ue)}return _r}var bl=k2(!0),A2=k2(!1),sd=ys(null),od=null,_l=null,wm=null;function bm(){wm=_l=od=null}function _m(o){var c=sd.current;qt(sd),o._currentValue=c}function Sm(o,c,p){for(;o!==null;){var y=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),o===p)break;o=o.return}}function Sl(o,c){od=o,wm=_l=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&c)!==0&&(Yn=!0),o.firstContext=null)}function Ti(o){var c=o._currentValue;if(wm!==o)if(o={context:o,memoizedValue:c,next:null},_l===null){if(od===null)throw Error(r(308));_l=o,od.dependencies={lanes:0,firstContext:o}}else _l=_l.next=o;return c}var mo=null;function Nm(o){mo===null?mo=[o]:mo.push(o)}function P2(o,c,p,y){var N=c.interleaved;return N===null?(p.next=p,Nm(c)):(p.next=N.next,N.next=p),c.interleaved=p,Oa(o,y)}function Oa(o,c){o.lanes|=c;var p=o.alternate;for(p!==null&&(p.lanes|=c),p=o,o=o.return;o!==null;)o.childLanes|=c,p=o.alternate,p!==null&&(p.childLanes|=c),p=o,o=o.return;return p.tag===3?p.stateNode:null}var _s=!1;function Em(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function j2(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Da(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Ss(o,c,p){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(kt&2)!==0){var N=y.pending;return N===null?c.next=c:(c.next=N.next,N.next=c),y.pending=c,Oa(o,p)}return N=y.interleaved,N===null?(c.next=c,Nm(y)):(c.next=N.next,N.next=c),y.interleaved=c,Oa(o,p)}function ld(o,c,p){if(c=c.updateQueue,c!==null&&(c=c.shared,(p&4194240)!==0)){var y=c.lanes;y&=o.pendingLanes,p|=y,c.lanes=p,Bp(o,p)}}function O2(o,c){var p=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var N=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var I={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};C===null?N=C=I:C=C.next=I,p=p.next}while(p!==null);C===null?N=C=c:C=C.next=c}else N=C=c;p={baseState:y.baseState,firstBaseUpdate:N,lastBaseUpdate:C,shared:y.shared,effects:y.effects},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=c:o.next=c,p.lastBaseUpdate=c}function cd(o,c,p,y){var N=o.updateQueue;_s=!1;var C=N.firstBaseUpdate,I=N.lastBaseUpdate,ee=N.shared.pending;if(ee!==null){N.shared.pending=null;var ce=ee,ke=ce.next;ce.next=null,I===null?C=ke:I.next=ke,I=ce;var He=o.alternate;He!==null&&(He=He.updateQueue,ee=He.lastBaseUpdate,ee!==I&&(ee===null?He.firstBaseUpdate=ke:ee.next=ke,He.lastBaseUpdate=ce))}if(C!==null){var Ye=N.baseState;I=0,He=ke=ce=null,ee=C;do{var ze=ee.lane,tt=ee.eventTime;if((y&ze)===ze){He!==null&&(He=He.next={eventTime:tt,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var at=o,st=ee;switch(ze=c,tt=p,st.tag){case 1:if(at=st.payload,typeof at=="function"){Ye=at.call(tt,Ye,ze);break e}Ye=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=st.payload,ze=typeof at=="function"?at.call(tt,Ye,ze):at,ze==null)break e;Ye=se({},Ye,ze);break e;case 2:_s=!0}}ee.callback!==null&&ee.lane!==0&&(o.flags|=64,ze=N.effects,ze===null?N.effects=[ee]:ze.push(ee))}else tt={eventTime:tt,lane:ze,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},He===null?(ke=He=tt,ce=Ye):He=He.next=tt,I|=ze;if(ee=ee.next,ee===null){if(ee=N.shared.pending,ee===null)break;ze=ee,ee=ze.next,ze.next=null,N.lastBaseUpdate=ze,N.shared.pending=null}}while(!0);if(He===null&&(ce=Ye),N.baseState=ce,N.firstBaseUpdate=ke,N.lastBaseUpdate=He,c=N.shared.interleaved,c!==null){N=c;do I|=N.lane,N=N.next;while(N!==c)}else C===null&&(N.shared.lanes=0);vo|=I,o.lanes=I,o.memoizedState=Ye}}function D2(o,c,p){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var y=o[c],N=y.callback;if(N!==null){if(y.callback=null,y=p,typeof N!="function")throw Error(r(191,N));N.call(y)}}}var Jc={},la=ys(Jc),eu=ys(Jc),tu=ys(Jc);function xo(o){if(o===Jc)throw Error(r(174));return o}function Tm(o,c){switch(Kt(tu,c),Kt(eu,o),Kt(la,Jc),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:he(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=he(c,o)}qt(la),Kt(la,c)}function Nl(){qt(la),qt(eu),qt(tu)}function R2(o){xo(tu.current);var c=xo(la.current),p=he(c,o.type);c!==p&&(Kt(eu,o),Kt(la,p))}function Cm(o){eu.current===o&&(qt(la),qt(eu))}var ur=ys(0);function ud(o){for(var c=o;c!==null;){if(c.tag===13){var p=c.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var km=[];function Am(){for(var o=0;o<km.length;o++)km[o]._workInProgressVersionPrimary=null;km.length=0}var fd=A.ReactCurrentDispatcher,Pm=A.ReactCurrentBatchConfig,go=0,fr=null,Lr=null,Yr=null,dd=!1,ru=!1,nu=0,ZD=0;function xn(){throw Error(r(321))}function jm(o,c){if(c===null)return!1;for(var p=0;p<c.length&&p<o.length;p++)if(!Vi(o[p],c[p]))return!1;return!0}function Om(o,c,p,y,N,C){if(go=C,fr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,fd.current=o===null||o.memoizedState===null?tR:rR,o=p(y,N),ru){C=0;do{if(ru=!1,nu=0,25<=C)throw Error(r(301));C+=1,Yr=Lr=null,c.updateQueue=null,fd.current=nR,o=p(y,N)}while(ru)}if(fd.current=md,c=Lr!==null&&Lr.next!==null,go=0,Yr=Lr=fr=null,dd=!1,c)throw Error(r(300));return o}function Dm(){var o=nu!==0;return nu=0,o}function ca(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?fr.memoizedState=Yr=o:Yr=Yr.next=o,Yr}function Ci(){if(Lr===null){var o=fr.alternate;o=o!==null?o.memoizedState:null}else o=Lr.next;var c=Yr===null?fr.memoizedState:Yr.next;if(c!==null)Yr=c,Lr=o;else{if(o===null)throw Error(r(310));Lr=o,o={memoizedState:Lr.memoizedState,baseState:Lr.baseState,baseQueue:Lr.baseQueue,queue:Lr.queue,next:null},Yr===null?fr.memoizedState=Yr=o:Yr=Yr.next=o}return Yr}function iu(o,c){return typeof c=="function"?c(o):c}function Rm(o){var c=Ci(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var y=Lr,N=y.baseQueue,C=p.pending;if(C!==null){if(N!==null){var I=N.next;N.next=C.next,C.next=I}y.baseQueue=N=C,p.pending=null}if(N!==null){C=N.next,y=y.baseState;var ee=I=null,ce=null,ke=C;do{var He=ke.lane;if((go&He)===He)ce!==null&&(ce=ce.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),y=ke.hasEagerState?ke.eagerState:o(y,ke.action);else{var Ye={lane:He,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};ce===null?(ee=ce=Ye,I=y):ce=ce.next=Ye,fr.lanes|=He,vo|=He}ke=ke.next}while(ke!==null&&ke!==C);ce===null?I=y:ce.next=ee,Vi(y,c.memoizedState)||(Yn=!0),c.memoizedState=y,c.baseState=I,c.baseQueue=ce,p.lastRenderedState=y}if(o=p.interleaved,o!==null){N=o;do C=N.lane,fr.lanes|=C,vo|=C,N=N.next;while(N!==o)}else N===null&&(p.lanes=0);return[c.memoizedState,p.dispatch]}function Im(o){var c=Ci(),p=c.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var y=p.dispatch,N=p.pending,C=c.memoizedState;if(N!==null){p.pending=null;var I=N=N.next;do C=o(C,I.action),I=I.next;while(I!==N);Vi(C,c.memoizedState)||(Yn=!0),c.memoizedState=C,c.baseQueue===null&&(c.baseState=C),p.lastRenderedState=C}return[C,y]}function I2(){}function F2(o,c){var p=fr,y=Ci(),N=c(),C=!Vi(y.memoizedState,N);if(C&&(y.memoizedState=N,Yn=!0),y=y.queue,Fm(B2.bind(null,p,y,o),[o]),y.getSnapshot!==c||C||Yr!==null&&Yr.memoizedState.tag&1){if(p.flags|=2048,au(9,L2.bind(null,p,y,N,c),void 0,null),Xr===null)throw Error(r(349));(go&30)!==0||M2(p,c,N)}return N}function M2(o,c,p){o.flags|=16384,o={getSnapshot:c,value:p},c=fr.updateQueue,c===null?(c={lastEffect:null,stores:null},fr.updateQueue=c,c.stores=[o]):(p=c.stores,p===null?c.stores=[o]:p.push(o))}function L2(o,c,p,y){c.value=p,c.getSnapshot=y,$2(c)&&U2(o)}function B2(o,c,p){return p(function(){$2(c)&&U2(o)})}function $2(o){var c=o.getSnapshot;o=o.value;try{var p=c();return!Vi(o,p)}catch{return!0}}function U2(o){var c=Oa(o,1);c!==null&&qi(c,o,1,-1)}function z2(o){var c=ca();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:iu,lastRenderedState:o},c.queue=o,o=o.dispatch=eR.bind(null,fr,o),[c.memoizedState,o]}function au(o,c,p,y){return o={tag:o,create:c,destroy:p,deps:y,next:null},c=fr.updateQueue,c===null?(c={lastEffect:null,stores:null},fr.updateQueue=c,c.lastEffect=o.next=o):(p=c.lastEffect,p===null?c.lastEffect=o.next=o:(y=p.next,p.next=o,o.next=y,c.lastEffect=o)),o}function W2(){return Ci().memoizedState}function hd(o,c,p,y){var N=ca();fr.flags|=o,N.memoizedState=au(1|c,p,void 0,y===void 0?null:y)}function pd(o,c,p,y){var N=Ci();y=y===void 0?null:y;var C=void 0;if(Lr!==null){var I=Lr.memoizedState;if(C=I.destroy,y!==null&&jm(y,I.deps)){N.memoizedState=au(c,p,C,y);return}}fr.flags|=o,N.memoizedState=au(1|c,p,C,y)}function H2(o,c){return hd(8390656,8,o,c)}function Fm(o,c){return pd(2048,8,o,c)}function V2(o,c){return pd(4,2,o,c)}function K2(o,c){return pd(4,4,o,c)}function G2(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Y2(o,c,p){return p=p!=null?p.concat([o]):null,pd(4,4,G2.bind(null,c,o),p)}function Mm(){}function X2(o,c){var p=Ci();c=c===void 0?null:c;var y=p.memoizedState;return y!==null&&c!==null&&jm(c,y[1])?y[0]:(p.memoizedState=[o,c],o)}function q2(o,c){var p=Ci();c=c===void 0?null:c;var y=p.memoizedState;return y!==null&&c!==null&&jm(c,y[1])?y[0]:(o=o(),p.memoizedState=[o,c],o)}function Z2(o,c,p){return(go&21)===0?(o.baseState&&(o.baseState=!1,Yn=!0),o.memoizedState=p):(Vi(p,c)||(p=Cb(),fr.lanes|=p,vo|=p,o.baseState=!0),c)}function QD(o,c){var p=Ft;Ft=p!==0&&4>p?p:4,o(!0);var y=Pm.transition;Pm.transition={};try{o(!1),c()}finally{Ft=p,Pm.transition=y}}function Q2(){return Ci().memoizedState}function JD(o,c,p){var y=Cs(o);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},J2(o))e_(c,p);else if(p=P2(o,c,p,y),p!==null){var N=Dn();qi(p,o,y,N),t_(p,c,y)}}function eR(o,c,p){var y=Cs(o),N={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(J2(o))e_(c,N);else{var C=o.alternate;if(o.lanes===0&&(C===null||C.lanes===0)&&(C=c.lastRenderedReducer,C!==null))try{var I=c.lastRenderedState,ee=C(I,p);if(N.hasEagerState=!0,N.eagerState=ee,Vi(ee,I)){var ce=c.interleaved;ce===null?(N.next=N,Nm(c)):(N.next=ce.next,ce.next=N),c.interleaved=N;return}}catch{}finally{}p=P2(o,c,N,y),p!==null&&(N=Dn(),qi(p,o,y,N),t_(p,c,y))}}function J2(o){var c=o.alternate;return o===fr||c!==null&&c===fr}function e_(o,c){ru=dd=!0;var p=o.pending;p===null?c.next=c:(c.next=p.next,p.next=c),o.pending=c}function t_(o,c,p){if((p&4194240)!==0){var y=c.lanes;y&=o.pendingLanes,p|=y,c.lanes=p,Bp(o,p)}}var md={readContext:Ti,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useInsertionEffect:xn,useLayoutEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useMutableSource:xn,useSyncExternalStore:xn,useId:xn,unstable_isNewReconciler:!1},tR={readContext:Ti,useCallback:function(o,c){return ca().memoizedState=[o,c===void 0?null:c],o},useContext:Ti,useEffect:H2,useImperativeHandle:function(o,c,p){return p=p!=null?p.concat([o]):null,hd(4194308,4,G2.bind(null,c,o),p)},useLayoutEffect:function(o,c){return hd(4194308,4,o,c)},useInsertionEffect:function(o,c){return hd(4,2,o,c)},useMemo:function(o,c){var p=ca();return c=c===void 0?null:c,o=o(),p.memoizedState=[o,c],o},useReducer:function(o,c,p){var y=ca();return c=p!==void 0?p(c):c,y.memoizedState=y.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},y.queue=o,o=o.dispatch=JD.bind(null,fr,o),[y.memoizedState,o]},useRef:function(o){var c=ca();return o={current:o},c.memoizedState=o},useState:z2,useDebugValue:Mm,useDeferredValue:function(o){return ca().memoizedState=o},useTransition:function(){var o=z2(!1),c=o[0];return o=QD.bind(null,o[1]),ca().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,p){var y=fr,N=ca();if(er){if(p===void 0)throw Error(r(407));p=p()}else{if(p=c(),Xr===null)throw Error(r(349));(go&30)!==0||M2(y,c,p)}N.memoizedState=p;var C={value:p,getSnapshot:c};return N.queue=C,H2(B2.bind(null,y,C,o),[o]),y.flags|=2048,au(9,L2.bind(null,y,C,p,c),void 0,null),p},useId:function(){var o=ca(),c=Xr.identifierPrefix;if(er){var p=ja,y=Pa;p=(y&~(1<<32-br(y)-1)).toString(32)+p,c=":"+c+"R"+p,p=nu++,0<p&&(c+="H"+p.toString(32)),c+=":"}else p=ZD++,c=":"+c+"r"+p.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},rR={readContext:Ti,useCallback:X2,useContext:Ti,useEffect:Fm,useImperativeHandle:Y2,useInsertionEffect:V2,useLayoutEffect:K2,useMemo:q2,useReducer:Rm,useRef:W2,useState:function(){return Rm(iu)},useDebugValue:Mm,useDeferredValue:function(o){var c=Ci();return Z2(c,Lr.memoizedState,o)},useTransition:function(){var o=Rm(iu)[0],c=Ci().memoizedState;return[o,c]},useMutableSource:I2,useSyncExternalStore:F2,useId:Q2,unstable_isNewReconciler:!1},nR={readContext:Ti,useCallback:X2,useContext:Ti,useEffect:Fm,useImperativeHandle:Y2,useInsertionEffect:V2,useLayoutEffect:K2,useMemo:q2,useReducer:Im,useRef:W2,useState:function(){return Im(iu)},useDebugValue:Mm,useDeferredValue:function(o){var c=Ci();return Lr===null?c.memoizedState=o:Z2(c,Lr.memoizedState,o)},useTransition:function(){var o=Im(iu)[0],c=Ci().memoizedState;return[o,c]},useMutableSource:I2,useSyncExternalStore:F2,useId:Q2,unstable_isNewReconciler:!1};function Gi(o,c){if(o&&o.defaultProps){c=se({},c),o=o.defaultProps;for(var p in o)c[p]===void 0&&(c[p]=o[p]);return c}return c}function Lm(o,c,p,y){c=o.memoizedState,p=p(y,c),p=p==null?c:se({},c,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var xd={isMounted:function(o){return(o=o._reactInternals)?Q(o)===o:!1},enqueueSetState:function(o,c,p){o=o._reactInternals;var y=Dn(),N=Cs(o),C=Da(y,N);C.payload=c,p!=null&&(C.callback=p),c=Ss(o,C,N),c!==null&&(qi(c,o,N,y),ld(c,o,N))},enqueueReplaceState:function(o,c,p){o=o._reactInternals;var y=Dn(),N=Cs(o),C=Da(y,N);C.tag=1,C.payload=c,p!=null&&(C.callback=p),c=Ss(o,C,N),c!==null&&(qi(c,o,N,y),ld(c,o,N))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var p=Dn(),y=Cs(o),N=Da(p,y);N.tag=2,c!=null&&(N.callback=c),c=Ss(o,N,y),c!==null&&(qi(c,o,y,p),ld(c,o,y))}};function r_(o,c,p,y,N,C,I){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,C,I):c.prototype&&c.prototype.isPureReactComponent?!Vc(p,y)||!Vc(N,C):!0}function n_(o,c,p){var y=!1,N=ws,C=c.contextType;return typeof C=="object"&&C!==null?C=Ti(C):(N=Gn(c)?fo:mn.current,y=c.contextTypes,C=(y=y!=null)?gl(o,N):ws),c=new c(p,C),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=xd,o.stateNode=c,c._reactInternals=o,y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=N,o.__reactInternalMemoizedMaskedChildContext=C),c}function i_(o,c,p,y){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(p,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(p,y),c.state!==o&&xd.enqueueReplaceState(c,c.state,null)}function Bm(o,c,p,y){var N=o.stateNode;N.props=p,N.state=o.memoizedState,N.refs={},Em(o);var C=c.contextType;typeof C=="object"&&C!==null?N.context=Ti(C):(C=Gn(c)?fo:mn.current,N.context=gl(o,C)),N.state=o.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(Lm(o,c,C,p),N.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(c=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),c!==N.state&&xd.enqueueReplaceState(N,N.state,null),cd(o,p,N,y),N.state=o.memoizedState),typeof N.componentDidMount=="function"&&(o.flags|=4194308)}function El(o,c){try{var p="",y=c;do p+=ge(y),y=y.return;while(y);var N=p}catch(C){N=`
Error generating stack: `+C.message+`
`+C.stack}return{value:o,source:c,stack:N,digest:null}}function $m(o,c,p){return{value:o,source:null,stack:p??null,digest:c??null}}function Um(o,c){try{console.error(c.value)}catch(p){setTimeout(function(){throw p})}}var iR=typeof WeakMap=="function"?WeakMap:Map;function a_(o,c,p){p=Da(-1,p),p.tag=3,p.payload={element:null};var y=c.value;return p.callback=function(){Sd||(Sd=!0,rx=y),Um(o,c)},p}function s_(o,c,p){p=Da(-1,p),p.tag=3;var y=o.type.getDerivedStateFromError;if(typeof y=="function"){var N=c.value;p.payload=function(){return y(N)},p.callback=function(){Um(o,c)}}var C=o.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(p.callback=function(){Um(o,c),typeof y!="function"&&(Es===null?Es=new Set([this]):Es.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})}),p}function o_(o,c,p){var y=o.pingCache;if(y===null){y=o.pingCache=new iR;var N=new Set;y.set(c,N)}else N=y.get(c),N===void 0&&(N=new Set,y.set(c,N));N.has(p)||(N.add(p),o=vR.bind(null,o,c,p),c.then(o,o))}function l_(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function c_(o,c,p,y,N){return(o.mode&1)===0?(o===c?o.flags|=65536:(o.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(c=Da(-1,1),c.tag=2,Ss(p,c,1))),p.lanes|=1),o):(o.flags|=65536,o.lanes=N,o)}var aR=A.ReactCurrentOwner,Yn=!1;function On(o,c,p,y){c.child=o===null?A2(c,null,p,y):bl(c,o.child,p,y)}function u_(o,c,p,y,N){p=p.render;var C=c.ref;return Sl(c,N),y=Om(o,c,p,y,C,N),p=Dm(),o!==null&&!Yn?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~N,Ra(o,c,N)):(er&&p&&mm(c),c.flags|=1,On(o,c,y,N),c.child)}function f_(o,c,p,y,N){if(o===null){var C=p.type;return typeof C=="function"&&!cx(C)&&C.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(c.tag=15,c.type=C,d_(o,c,C,y,N)):(o=Ad(p.type,null,y,c,c.mode,N),o.ref=c.ref,o.return=c,c.child=o)}if(C=o.child,(o.lanes&N)===0){var I=C.memoizedProps;if(p=p.compare,p=p!==null?p:Vc,p(I,y)&&o.ref===c.ref)return Ra(o,c,N)}return c.flags|=1,o=As(C,y),o.ref=c.ref,o.return=c,c.child=o}function d_(o,c,p,y,N){if(o!==null){var C=o.memoizedProps;if(Vc(C,y)&&o.ref===c.ref)if(Yn=!1,c.pendingProps=y=C,(o.lanes&N)!==0)(o.flags&131072)!==0&&(Yn=!0);else return c.lanes=o.lanes,Ra(o,c,N)}return zm(o,c,p,y,N)}function h_(o,c,p){var y=c.pendingProps,N=y.children,C=o!==null?o.memoizedState:null;if(y.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(Cl,ci),ci|=p;else{if((p&1073741824)===0)return o=C!==null?C.baseLanes|p:p,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,Kt(Cl,ci),ci|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=C!==null?C.baseLanes:p,Kt(Cl,ci),ci|=y}else C!==null?(y=C.baseLanes|p,c.memoizedState=null):y=p,Kt(Cl,ci),ci|=y;return On(o,c,N,p),c.child}function p_(o,c){var p=c.ref;(o===null&&p!==null||o!==null&&o.ref!==p)&&(c.flags|=512,c.flags|=2097152)}function zm(o,c,p,y,N){var C=Gn(p)?fo:mn.current;return C=gl(c,C),Sl(c,N),p=Om(o,c,p,y,C,N),y=Dm(),o!==null&&!Yn?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~N,Ra(o,c,N)):(er&&y&&mm(c),c.flags|=1,On(o,c,p,N),c.child)}function m_(o,c,p,y,N){if(Gn(p)){var C=!0;ed(c)}else C=!1;if(Sl(c,N),c.stateNode===null)vd(o,c),n_(c,p,y),Bm(c,p,y,N),y=!0;else if(o===null){var I=c.stateNode,ee=c.memoizedProps;I.props=ee;var ce=I.context,ke=p.contextType;typeof ke=="object"&&ke!==null?ke=Ti(ke):(ke=Gn(p)?fo:mn.current,ke=gl(c,ke));var He=p.getDerivedStateFromProps,Ye=typeof He=="function"||typeof I.getSnapshotBeforeUpdate=="function";Ye||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ee!==y||ce!==ke)&&i_(c,I,y,ke),_s=!1;var ze=c.memoizedState;I.state=ze,cd(c,y,I,N),ce=c.memoizedState,ee!==y||ze!==ce||Kn.current||_s?(typeof He=="function"&&(Lm(c,p,He,y),ce=c.memoizedState),(ee=_s||r_(c,p,ee,y,ze,ce,ke))?(Ye||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(c.flags|=4194308)):(typeof I.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=ce),I.props=y,I.state=ce,I.context=ke,y=ee):(typeof I.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{I=c.stateNode,j2(o,c),ee=c.memoizedProps,ke=c.type===c.elementType?ee:Gi(c.type,ee),I.props=ke,Ye=c.pendingProps,ze=I.context,ce=p.contextType,typeof ce=="object"&&ce!==null?ce=Ti(ce):(ce=Gn(p)?fo:mn.current,ce=gl(c,ce));var tt=p.getDerivedStateFromProps;(He=typeof tt=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(ee!==Ye||ze!==ce)&&i_(c,I,y,ce),_s=!1,ze=c.memoizedState,I.state=ze,cd(c,y,I,N);var at=c.memoizedState;ee!==Ye||ze!==at||Kn.current||_s?(typeof tt=="function"&&(Lm(c,p,tt,y),at=c.memoizedState),(ke=_s||r_(c,p,ke,y,ze,at,ce)||!1)?(He||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(y,at,ce),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(y,at,ce)),typeof I.componentDidUpdate=="function"&&(c.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof I.componentDidUpdate!="function"||ee===o.memoizedProps&&ze===o.memoizedState||(c.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||ee===o.memoizedProps&&ze===o.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=at),I.props=y,I.state=at,I.context=ce,y=ke):(typeof I.componentDidUpdate!="function"||ee===o.memoizedProps&&ze===o.memoizedState||(c.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||ee===o.memoizedProps&&ze===o.memoizedState||(c.flags|=1024),y=!1)}return Wm(o,c,p,y,C,N)}function Wm(o,c,p,y,N,C){p_(o,c);var I=(c.flags&128)!==0;if(!y&&!I)return N&&w2(c,p,!1),Ra(o,c,C);y=c.stateNode,aR.current=c;var ee=I&&typeof p.getDerivedStateFromError!="function"?null:y.render();return c.flags|=1,o!==null&&I?(c.child=bl(c,o.child,null,C),c.child=bl(c,null,ee,C)):On(o,c,ee,C),c.memoizedState=y.state,N&&w2(c,p,!0),c.child}function x_(o){var c=o.stateNode;c.pendingContext?v2(o,c.pendingContext,c.pendingContext!==c.context):c.context&&v2(o,c.context,!1),Tm(o,c.containerInfo)}function g_(o,c,p,y,N){return wl(),ym(N),c.flags|=256,On(o,c,p,y),c.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Vm(o){return{baseLanes:o,cachePool:null,transitions:null}}function v_(o,c,p){var y=c.pendingProps,N=ur.current,C=!1,I=(c.flags&128)!==0,ee;if((ee=I)||(ee=o!==null&&o.memoizedState===null?!1:(N&2)!==0),ee?(C=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&(N|=1),Kt(ur,N&1),o===null)return vm(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((c.mode&1)===0?c.lanes=1:o.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(I=y.children,o=y.fallback,C?(y=c.mode,C=c.child,I={mode:"hidden",children:I},(y&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=I):C=Pd(I,y,0,null),o=_o(o,y,p,null),C.return=c,o.return=c,C.sibling=o,c.child=C,c.child.memoizedState=Vm(p),c.memoizedState=Hm,o):Km(c,I));if(N=o.memoizedState,N!==null&&(ee=N.dehydrated,ee!==null))return sR(o,c,I,y,ee,N,p);if(C){C=y.fallback,I=c.mode,N=o.child,ee=N.sibling;var ce={mode:"hidden",children:y.children};return(I&1)===0&&c.child!==N?(y=c.child,y.childLanes=0,y.pendingProps=ce,c.deletions=null):(y=As(N,ce),y.subtreeFlags=N.subtreeFlags&14680064),ee!==null?C=As(ee,C):(C=_o(C,I,p,null),C.flags|=2),C.return=c,y.return=c,y.sibling=C,c.child=y,y=C,C=c.child,I=o.child.memoizedState,I=I===null?Vm(p):{baseLanes:I.baseLanes|p,cachePool:null,transitions:I.transitions},C.memoizedState=I,C.childLanes=o.childLanes&~p,c.memoizedState=Hm,y}return C=o.child,o=C.sibling,y=As(C,{mode:"visible",children:y.children}),(c.mode&1)===0&&(y.lanes=p),y.return=c,y.sibling=null,o!==null&&(p=c.deletions,p===null?(c.deletions=[o],c.flags|=16):p.push(o)),c.child=y,c.memoizedState=null,y}function Km(o,c){return c=Pd({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function gd(o,c,p,y){return y!==null&&ym(y),bl(c,o.child,null,p),o=Km(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function sR(o,c,p,y,N,C,I){if(p)return c.flags&256?(c.flags&=-257,y=$m(Error(r(422))),gd(o,c,I,y)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(C=y.fallback,N=c.mode,y=Pd({mode:"visible",children:y.children},N,0,null),C=_o(C,N,I,null),C.flags|=2,y.return=c,C.return=c,y.sibling=C,c.child=y,(c.mode&1)!==0&&bl(c,o.child,null,I),c.child.memoizedState=Vm(I),c.memoizedState=Hm,C);if((c.mode&1)===0)return gd(o,c,I,null);if(N.data==="$!"){if(y=N.nextSibling&&N.nextSibling.dataset,y)var ee=y.dgst;return y=ee,C=Error(r(419)),y=$m(C,y,void 0),gd(o,c,I,y)}if(ee=(I&o.childLanes)!==0,Yn||ee){if(y=Xr,y!==null){switch(I&-I){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(y.suspendedLanes|I))!==0?0:N,N!==0&&N!==C.retryLane&&(C.retryLane=N,Oa(o,N),qi(y,o,N,-1))}return lx(),y=$m(Error(r(421))),gd(o,c,I,y)}return N.data==="$?"?(c.flags|=128,c.child=o.child,c=yR.bind(null,o),N._reactRetry=c,null):(o=C.treeContext,li=vs(N.nextSibling),oi=c,er=!0,Ki=null,o!==null&&(Ni[Ei++]=Pa,Ni[Ei++]=ja,Ni[Ei++]=ho,Pa=o.id,ja=o.overflow,ho=c),c=Km(c,y.children),c.flags|=4096,c)}function y_(o,c,p){o.lanes|=c;var y=o.alternate;y!==null&&(y.lanes|=c),Sm(o.return,c,p)}function Gm(o,c,p,y,N){var C=o.memoizedState;C===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:N}:(C.isBackwards=c,C.rendering=null,C.renderingStartTime=0,C.last=y,C.tail=p,C.tailMode=N)}function w_(o,c,p){var y=c.pendingProps,N=y.revealOrder,C=y.tail;if(On(o,c,y.children,p),y=ur.current,(y&2)!==0)y=y&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&y_(o,p,c);else if(o.tag===19)y_(o,p,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}y&=1}if(Kt(ur,y),(c.mode&1)===0)c.memoizedState=null;else switch(N){case"forwards":for(p=c.child,N=null;p!==null;)o=p.alternate,o!==null&&ud(o)===null&&(N=p),p=p.sibling;p=N,p===null?(N=c.child,c.child=null):(N=p.sibling,p.sibling=null),Gm(c,!1,N,p,C);break;case"backwards":for(p=null,N=c.child,c.child=null;N!==null;){if(o=N.alternate,o!==null&&ud(o)===null){c.child=N;break}o=N.sibling,N.sibling=p,p=N,N=o}Gm(c,!0,p,null,C);break;case"together":Gm(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function vd(o,c){(c.mode&1)===0&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function Ra(o,c,p){if(o!==null&&(c.dependencies=o.dependencies),vo|=c.lanes,(p&c.childLanes)===0)return null;if(o!==null&&c.child!==o.child)throw Error(r(153));if(c.child!==null){for(o=c.child,p=As(o,o.pendingProps),c.child=p,p.return=c;o.sibling!==null;)o=o.sibling,p=p.sibling=As(o,o.pendingProps),p.return=c;p.sibling=null}return c.child}function oR(o,c,p){switch(c.tag){case 3:x_(c),wl();break;case 5:R2(c);break;case 1:Gn(c.type)&&ed(c);break;case 4:Tm(c,c.stateNode.containerInfo);break;case 10:var y=c.type._context,N=c.memoizedProps.value;Kt(sd,y._currentValue),y._currentValue=N;break;case 13:if(y=c.memoizedState,y!==null)return y.dehydrated!==null?(Kt(ur,ur.current&1),c.flags|=128,null):(p&c.child.childLanes)!==0?v_(o,c,p):(Kt(ur,ur.current&1),o=Ra(o,c,p),o!==null?o.sibling:null);Kt(ur,ur.current&1);break;case 19:if(y=(p&c.childLanes)!==0,(o.flags&128)!==0){if(y)return w_(o,c,p);c.flags|=128}if(N=c.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),Kt(ur,ur.current),y)break;return null;case 22:case 23:return c.lanes=0,h_(o,c,p)}return Ra(o,c,p)}var b_,Ym,__,S_;b_=function(o,c){for(var p=c.child;p!==null;){if(p.tag===5||p.tag===6)o.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===c)break;for(;p.sibling===null;){if(p.return===null||p.return===c)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Ym=function(){},__=function(o,c,p,y){var N=o.memoizedProps;if(N!==y){o=c.stateNode,xo(la.current);var C=null;switch(p){case"input":N=Ee(o,N),y=Ee(o,y),C=[];break;case"select":N=se({},N,{value:void 0}),y=se({},y,{value:void 0}),C=[];break;case"textarea":N=We(o,N),y=We(o,y),C=[];break;default:typeof N.onClick!="function"&&typeof y.onClick=="function"&&(o.onclick=Zf)}It(p,y);var I;p=null;for(ke in N)if(!y.hasOwnProperty(ke)&&N.hasOwnProperty(ke)&&N[ke]!=null)if(ke==="style"){var ee=N[ke];for(I in ee)ee.hasOwnProperty(I)&&(p||(p={}),p[I]="")}else ke!=="dangerouslySetInnerHTML"&&ke!=="children"&&ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&ke!=="autoFocus"&&(i.hasOwnProperty(ke)?C||(C=[]):(C=C||[]).push(ke,null));for(ke in y){var ce=y[ke];if(ee=N?.[ke],y.hasOwnProperty(ke)&&ce!==ee&&(ce!=null||ee!=null))if(ke==="style")if(ee){for(I in ee)!ee.hasOwnProperty(I)||ce&&ce.hasOwnProperty(I)||(p||(p={}),p[I]="");for(I in ce)ce.hasOwnProperty(I)&&ee[I]!==ce[I]&&(p||(p={}),p[I]=ce[I])}else p||(C||(C=[]),C.push(ke,p)),p=ce;else ke==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ee=ee?ee.__html:void 0,ce!=null&&ee!==ce&&(C=C||[]).push(ke,ce)):ke==="children"?typeof ce!="string"&&typeof ce!="number"||(C=C||[]).push(ke,""+ce):ke!=="suppressContentEditableWarning"&&ke!=="suppressHydrationWarning"&&(i.hasOwnProperty(ke)?(ce!=null&&ke==="onScroll"&&Xt("scroll",o),C||ee===ce||(C=[])):(C=C||[]).push(ke,ce))}p&&(C=C||[]).push("style",p);var ke=C;(c.updateQueue=ke)&&(c.flags|=4)}},S_=function(o,c,p,y){p!==y&&(c.flags|=4)};function su(o,c){if(!er)switch(o.tailMode){case"hidden":c=o.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function gn(o){var c=o.alternate!==null&&o.alternate.child===o.child,p=0,y=0;if(c)for(var N=o.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags&14680064,y|=N.flags&14680064,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags,y|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=y,o.childLanes=p,c}function lR(o,c,p){var y=c.pendingProps;switch(xm(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(c),null;case 1:return Gn(c.type)&&Jf(),gn(c),null;case 3:return y=c.stateNode,Nl(),qt(Kn),qt(mn),Am(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(o===null||o.child===null)&&(id(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ki!==null&&(ax(Ki),Ki=null))),Ym(o,c),gn(c),null;case 5:Cm(c);var N=xo(tu.current);if(p=c.type,o!==null&&c.stateNode!=null)__(o,c,p,y,N),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!y){if(c.stateNode===null)throw Error(r(166));return gn(c),null}if(o=xo(la.current),id(c)){y=c.stateNode,p=c.type;var C=c.memoizedProps;switch(y[oa]=c,y[qc]=C,o=(c.mode&1)!==0,p){case"dialog":Xt("cancel",y),Xt("close",y);break;case"iframe":case"object":case"embed":Xt("load",y);break;case"video":case"audio":for(N=0;N<Gc.length;N++)Xt(Gc[N],y);break;case"source":Xt("error",y);break;case"img":case"image":case"link":Xt("error",y),Xt("load",y);break;case"details":Xt("toggle",y);break;case"input":me(y,C),Xt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!C.multiple},Xt("invalid",y);break;case"textarea":je(y,C),Xt("invalid",y)}It(p,C),N=null;for(var I in C)if(C.hasOwnProperty(I)){var ee=C[I];I==="children"?typeof ee=="string"?y.textContent!==ee&&(C.suppressHydrationWarning!==!0&&qf(y.textContent,ee,o),N=["children",ee]):typeof ee=="number"&&y.textContent!==""+ee&&(C.suppressHydrationWarning!==!0&&qf(y.textContent,ee,o),N=["children",""+ee]):i.hasOwnProperty(I)&&ee!=null&&I==="onScroll"&&Xt("scroll",y)}switch(p){case"input":H(y),Le(y,C,!0);break;case"textarea":H(y),Ae(y);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(y.onclick=Zf)}y=N,c.updateQueue=y,y!==null&&(c.flags|=4)}else{I=N.nodeType===9?N:N.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=xt(p)),o==="http://www.w3.org/1999/xhtml"?p==="script"?(o=I.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof y.is=="string"?o=I.createElement(p,{is:y.is}):(o=I.createElement(p),p==="select"&&(I=o,y.multiple?I.multiple=!0:y.size&&(I.size=y.size))):o=I.createElementNS(o,p),o[oa]=c,o[qc]=y,b_(o,c,!1,!1),c.stateNode=o;e:{switch(I=lr(p,y),p){case"dialog":Xt("cancel",o),Xt("close",o),N=y;break;case"iframe":case"object":case"embed":Xt("load",o),N=y;break;case"video":case"audio":for(N=0;N<Gc.length;N++)Xt(Gc[N],o);N=y;break;case"source":Xt("error",o),N=y;break;case"img":case"image":case"link":Xt("error",o),Xt("load",o),N=y;break;case"details":Xt("toggle",o),N=y;break;case"input":me(o,y),N=Ee(o,y),Xt("invalid",o);break;case"option":N=y;break;case"select":o._wrapperState={wasMultiple:!!y.multiple},N=se({},y,{value:void 0}),Xt("invalid",o);break;case"textarea":je(o,y),N=We(o,y),Xt("invalid",o);break;default:N=y}It(p,N),ee=N;for(C in ee)if(ee.hasOwnProperty(C)){var ce=ee[C];C==="style"?_t(o,ce):C==="dangerouslySetInnerHTML"?(ce=ce?ce.__html:void 0,ce!=null&&et(o,ce)):C==="children"?typeof ce=="string"?(p!=="textarea"||ce!=="")&&Qe(o,ce):typeof ce=="number"&&Qe(o,""+ce):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(i.hasOwnProperty(C)?ce!=null&&C==="onScroll"&&Xt("scroll",o):ce!=null&&E(o,C,ce,I))}switch(p){case"input":H(o),Le(o,y,!1);break;case"textarea":H(o),Ae(o);break;case"option":y.value!=null&&o.setAttribute("value",""+O(y.value));break;case"select":o.multiple=!!y.multiple,C=y.value,C!=null?Pe(o,!!y.multiple,C,!1):y.defaultValue!=null&&Pe(o,!!y.multiple,y.defaultValue,!0);break;default:typeof N.onClick=="function"&&(o.onclick=Zf)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return gn(c),null;case 6:if(o&&c.stateNode!=null)S_(o,c,o.memoizedProps,y);else{if(typeof y!="string"&&c.stateNode===null)throw Error(r(166));if(p=xo(tu.current),xo(la.current),id(c)){if(y=c.stateNode,p=c.memoizedProps,y[oa]=c,(C=y.nodeValue!==p)&&(o=oi,o!==null))switch(o.tag){case 3:qf(y.nodeValue,p,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&qf(y.nodeValue,p,(o.mode&1)!==0)}C&&(c.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[oa]=c,c.stateNode=y}return gn(c),null;case 13:if(qt(ur),y=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(er&&li!==null&&(c.mode&1)!==0&&(c.flags&128)===0)T2(),wl(),c.flags|=98560,C=!1;else if(C=id(c),y!==null&&y.dehydrated!==null){if(o===null){if(!C)throw Error(r(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));C[oa]=c}else wl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;gn(c),C=!1}else Ki!==null&&(ax(Ki),Ki=null),C=!0;if(!C)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=p,c):(y=y!==null,y!==(o!==null&&o.memoizedState!==null)&&y&&(c.child.flags|=8192,(c.mode&1)!==0&&(o===null||(ur.current&1)!==0?Br===0&&(Br=3):lx())),c.updateQueue!==null&&(c.flags|=4),gn(c),null);case 4:return Nl(),Ym(o,c),o===null&&Yc(c.stateNode.containerInfo),gn(c),null;case 10:return _m(c.type._context),gn(c),null;case 17:return Gn(c.type)&&Jf(),gn(c),null;case 19:if(qt(ur),C=c.memoizedState,C===null)return gn(c),null;if(y=(c.flags&128)!==0,I=C.rendering,I===null)if(y)su(C,!1);else{if(Br!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(I=ud(o),I!==null){for(c.flags|=128,su(C,!1),y=I.updateQueue,y!==null&&(c.updateQueue=y,c.flags|=4),c.subtreeFlags=0,y=p,p=c.child;p!==null;)C=p,o=y,C.flags&=14680066,I=C.alternate,I===null?(C.childLanes=0,C.lanes=o,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=I.childLanes,C.lanes=I.lanes,C.child=I.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=I.memoizedProps,C.memoizedState=I.memoizedState,C.updateQueue=I.updateQueue,C.type=I.type,o=I.dependencies,C.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),p=p.sibling;return Kt(ur,ur.current&1|2),c.child}o=o.sibling}C.tail!==null&&Ue()>kl&&(c.flags|=128,y=!0,su(C,!1),c.lanes=4194304)}else{if(!y)if(o=ud(I),o!==null){if(c.flags|=128,y=!0,p=o.updateQueue,p!==null&&(c.updateQueue=p,c.flags|=4),su(C,!0),C.tail===null&&C.tailMode==="hidden"&&!I.alternate&&!er)return gn(c),null}else 2*Ue()-C.renderingStartTime>kl&&p!==1073741824&&(c.flags|=128,y=!0,su(C,!1),c.lanes=4194304);C.isBackwards?(I.sibling=c.child,c.child=I):(p=C.last,p!==null?p.sibling=I:c.child=I,C.last=I)}return C.tail!==null?(c=C.tail,C.rendering=c,C.tail=c.sibling,C.renderingStartTime=Ue(),c.sibling=null,p=ur.current,Kt(ur,y?p&1|2:p&1),c):(gn(c),null);case 22:case 23:return ox(),y=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==y&&(c.flags|=8192),y&&(c.mode&1)!==0?(ci&1073741824)!==0&&(gn(c),c.subtreeFlags&6&&(c.flags|=8192)):gn(c),null;case 24:return null;case 25:return null}throw Error(r(156,c.tag))}function cR(o,c){switch(xm(c),c.tag){case 1:return Gn(c.type)&&Jf(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Nl(),qt(Kn),qt(mn),Am(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 5:return Cm(c),null;case 13:if(qt(ur),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(r(340));wl()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return qt(ur),null;case 4:return Nl(),null;case 10:return _m(c.type._context),null;case 22:case 23:return ox(),null;case 24:return null;default:return null}}var yd=!1,vn=!1,uR=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Tl(o,c){var p=o.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){xr(o,c,y)}else p.current=null}function Xm(o,c,p){try{p()}catch(y){xr(o,c,y)}}var N_=!1;function fR(o,c){if(om=Bf,o=r2(),Jp(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var N=y.anchorOffset,C=y.focusNode;y=y.focusOffset;try{p.nodeType,C.nodeType}catch{p=null;break e}var I=0,ee=-1,ce=-1,ke=0,He=0,Ye=o,ze=null;t:for(;;){for(var tt;Ye!==p||N!==0&&Ye.nodeType!==3||(ee=I+N),Ye!==C||y!==0&&Ye.nodeType!==3||(ce=I+y),Ye.nodeType===3&&(I+=Ye.nodeValue.length),(tt=Ye.firstChild)!==null;)ze=Ye,Ye=tt;for(;;){if(Ye===o)break t;if(ze===p&&++ke===N&&(ee=I),ze===C&&++He===y&&(ce=I),(tt=Ye.nextSibling)!==null)break;Ye=ze,ze=Ye.parentNode}Ye=tt}p=ee===-1||ce===-1?null:{start:ee,end:ce}}else p=null}p=p||{start:0,end:0}}else p=null;for(lm={focusedElem:o,selectionRange:p},Bf=!1,nt=c;nt!==null;)if(c=nt,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,nt=o;else for(;nt!==null;){c=nt;try{var at=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(at!==null){var st=at.memoizedProps,_r=at.memoizedState,ve=c.stateNode,ue=ve.getSnapshotBeforeUpdate(c.elementType===c.type?st:Gi(c.type,st),_r);ve.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var Ne=c.stateNode.containerInfo;Ne.nodeType===1?Ne.textContent="":Ne.nodeType===9&&Ne.documentElement&&Ne.removeChild(Ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ze){xr(c,c.return,Ze)}if(o=c.sibling,o!==null){o.return=c.return,nt=o;break}nt=c.return}return at=N_,N_=!1,at}function ou(o,c,p){var y=c.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var N=y=y.next;do{if((N.tag&o)===o){var C=N.destroy;N.destroy=void 0,C!==void 0&&Xm(c,p,C)}N=N.next}while(N!==y)}}function wd(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var p=c=c.next;do{if((p.tag&o)===o){var y=p.create;p.destroy=y()}p=p.next}while(p!==c)}}function qm(o){var c=o.ref;if(c!==null){var p=o.stateNode;switch(o.tag){case 5:o=p;break;default:o=p}typeof c=="function"?c(o):c.current=o}}function E_(o){var c=o.alternate;c!==null&&(o.alternate=null,E_(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[oa],delete c[qc],delete c[dm],delete c[GD],delete c[YD])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function T_(o){return o.tag===5||o.tag===3||o.tag===4}function C_(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||T_(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Zm(o,c,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,c?p.nodeType===8?p.parentNode.insertBefore(o,c):p.insertBefore(o,c):(p.nodeType===8?(c=p.parentNode,c.insertBefore(o,p)):(c=p,c.appendChild(o)),p=p._reactRootContainer,p!=null||c.onclick!==null||(c.onclick=Zf));else if(y!==4&&(o=o.child,o!==null))for(Zm(o,c,p),o=o.sibling;o!==null;)Zm(o,c,p),o=o.sibling}function Qm(o,c,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,c?p.insertBefore(o,c):p.appendChild(o);else if(y!==4&&(o=o.child,o!==null))for(Qm(o,c,p),o=o.sibling;o!==null;)Qm(o,c,p),o=o.sibling}var rn=null,Yi=!1;function Ns(o,c,p){for(p=p.child;p!==null;)k_(o,c,p),p=p.sibling}function k_(o,c,p){if(Gr&&typeof Gr.onCommitFiberUnmount=="function")try{Gr.onCommitFiberUnmount(sa,p)}catch{}switch(p.tag){case 5:vn||Tl(p,c);case 6:var y=rn,N=Yi;rn=null,Ns(o,c,p),rn=y,Yi=N,rn!==null&&(Yi?(o=rn,p=p.stateNode,o.nodeType===8?o.parentNode.removeChild(p):o.removeChild(p)):rn.removeChild(p.stateNode));break;case 18:rn!==null&&(Yi?(o=rn,p=p.stateNode,o.nodeType===8?fm(o.parentNode,p):o.nodeType===1&&fm(o,p),Bc(o)):fm(rn,p.stateNode));break;case 4:y=rn,N=Yi,rn=p.stateNode.containerInfo,Yi=!0,Ns(o,c,p),rn=y,Yi=N;break;case 0:case 11:case 14:case 15:if(!vn&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){N=y=y.next;do{var C=N,I=C.destroy;C=C.tag,I!==void 0&&((C&2)!==0||(C&4)!==0)&&Xm(p,c,I),N=N.next}while(N!==y)}Ns(o,c,p);break;case 1:if(!vn&&(Tl(p,c),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(ee){xr(p,c,ee)}Ns(o,c,p);break;case 21:Ns(o,c,p);break;case 22:p.mode&1?(vn=(y=vn)||p.memoizedState!==null,Ns(o,c,p),vn=y):Ns(o,c,p);break;default:Ns(o,c,p)}}function A_(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var p=o.stateNode;p===null&&(p=o.stateNode=new uR),c.forEach(function(y){var N=wR.bind(null,o,y);p.has(y)||(p.add(y),y.then(N,N))})}}function Xi(o,c){var p=c.deletions;if(p!==null)for(var y=0;y<p.length;y++){var N=p[y];try{var C=o,I=c,ee=I;e:for(;ee!==null;){switch(ee.tag){case 5:rn=ee.stateNode,Yi=!1;break e;case 3:rn=ee.stateNode.containerInfo,Yi=!0;break e;case 4:rn=ee.stateNode.containerInfo,Yi=!0;break e}ee=ee.return}if(rn===null)throw Error(r(160));k_(C,I,N),rn=null,Yi=!1;var ce=N.alternate;ce!==null&&(ce.return=null),N.return=null}catch(ke){xr(N,c,ke)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)P_(c,o),c=c.sibling}function P_(o,c){var p=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Xi(c,o),ua(o),y&4){try{ou(3,o,o.return),wd(3,o)}catch(st){xr(o,o.return,st)}try{ou(5,o,o.return)}catch(st){xr(o,o.return,st)}}break;case 1:Xi(c,o),ua(o),y&512&&p!==null&&Tl(p,p.return);break;case 5:if(Xi(c,o),ua(o),y&512&&p!==null&&Tl(p,p.return),o.flags&32){var N=o.stateNode;try{Qe(N,"")}catch(st){xr(o,o.return,st)}}if(y&4&&(N=o.stateNode,N!=null)){var C=o.memoizedProps,I=p!==null?p.memoizedProps:C,ee=o.type,ce=o.updateQueue;if(o.updateQueue=null,ce!==null)try{ee==="input"&&C.type==="radio"&&C.name!=null&&xe(N,C),lr(ee,I);var ke=lr(ee,C);for(I=0;I<ce.length;I+=2){var He=ce[I],Ye=ce[I+1];He==="style"?_t(N,Ye):He==="dangerouslySetInnerHTML"?et(N,Ye):He==="children"?Qe(N,Ye):E(N,He,Ye,ke)}switch(ee){case"input":Ce(N,C);break;case"textarea":$e(N,C);break;case"select":var ze=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!C.multiple;var tt=C.value;tt!=null?Pe(N,!!C.multiple,tt,!1):ze!==!!C.multiple&&(C.defaultValue!=null?Pe(N,!!C.multiple,C.defaultValue,!0):Pe(N,!!C.multiple,C.multiple?[]:"",!1))}N[qc]=C}catch(st){xr(o,o.return,st)}}break;case 6:if(Xi(c,o),ua(o),y&4){if(o.stateNode===null)throw Error(r(162));N=o.stateNode,C=o.memoizedProps;try{N.nodeValue=C}catch(st){xr(o,o.return,st)}}break;case 3:if(Xi(c,o),ua(o),y&4&&p!==null&&p.memoizedState.isDehydrated)try{Bc(c.containerInfo)}catch(st){xr(o,o.return,st)}break;case 4:Xi(c,o),ua(o);break;case 13:Xi(c,o),ua(o),N=o.child,N.flags&8192&&(C=N.memoizedState!==null,N.stateNode.isHidden=C,!C||N.alternate!==null&&N.alternate.memoizedState!==null||(tx=Ue())),y&4&&A_(o);break;case 22:if(He=p!==null&&p.memoizedState!==null,o.mode&1?(vn=(ke=vn)||He,Xi(c,o),vn=ke):Xi(c,o),ua(o),y&8192){if(ke=o.memoizedState!==null,(o.stateNode.isHidden=ke)&&!He&&(o.mode&1)!==0)for(nt=o,He=o.child;He!==null;){for(Ye=nt=He;nt!==null;){switch(ze=nt,tt=ze.child,ze.tag){case 0:case 11:case 14:case 15:ou(4,ze,ze.return);break;case 1:Tl(ze,ze.return);var at=ze.stateNode;if(typeof at.componentWillUnmount=="function"){y=ze,p=ze.return;try{c=y,at.props=c.memoizedProps,at.state=c.memoizedState,at.componentWillUnmount()}catch(st){xr(y,p,st)}}break;case 5:Tl(ze,ze.return);break;case 22:if(ze.memoizedState!==null){D_(Ye);continue}}tt!==null?(tt.return=ze,nt=tt):D_(Ye)}He=He.sibling}e:for(He=null,Ye=o;;){if(Ye.tag===5){if(He===null){He=Ye;try{N=Ye.stateNode,ke?(C=N.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(ee=Ye.stateNode,ce=Ye.memoizedProps.style,I=ce!=null&&ce.hasOwnProperty("display")?ce.display:null,ee.style.display=wt("display",I))}catch(st){xr(o,o.return,st)}}}else if(Ye.tag===6){if(He===null)try{Ye.stateNode.nodeValue=ke?"":Ye.memoizedProps}catch(st){xr(o,o.return,st)}}else if((Ye.tag!==22&&Ye.tag!==23||Ye.memoizedState===null||Ye===o)&&Ye.child!==null){Ye.child.return=Ye,Ye=Ye.child;continue}if(Ye===o)break e;for(;Ye.sibling===null;){if(Ye.return===null||Ye.return===o)break e;He===Ye&&(He=null),Ye=Ye.return}He===Ye&&(He=null),Ye.sibling.return=Ye.return,Ye=Ye.sibling}}break;case 19:Xi(c,o),ua(o),y&4&&A_(o);break;case 21:break;default:Xi(c,o),ua(o)}}function ua(o){var c=o.flags;if(c&2){try{e:{for(var p=o.return;p!==null;){if(T_(p)){var y=p;break e}p=p.return}throw Error(r(160))}switch(y.tag){case 5:var N=y.stateNode;y.flags&32&&(Qe(N,""),y.flags&=-33);var C=C_(o);Qm(o,C,N);break;case 3:case 4:var I=y.stateNode.containerInfo,ee=C_(o);Zm(o,ee,I);break;default:throw Error(r(161))}}catch(ce){xr(o,o.return,ce)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function dR(o,c,p){nt=o,j_(o)}function j_(o,c,p){for(var y=(o.mode&1)!==0;nt!==null;){var N=nt,C=N.child;if(N.tag===22&&y){var I=N.memoizedState!==null||yd;if(!I){var ee=N.alternate,ce=ee!==null&&ee.memoizedState!==null||vn;ee=yd;var ke=vn;if(yd=I,(vn=ce)&&!ke)for(nt=N;nt!==null;)I=nt,ce=I.child,I.tag===22&&I.memoizedState!==null?R_(N):ce!==null?(ce.return=I,nt=ce):R_(N);for(;C!==null;)nt=C,j_(C),C=C.sibling;nt=N,yd=ee,vn=ke}O_(o)}else(N.subtreeFlags&8772)!==0&&C!==null?(C.return=N,nt=C):O_(o)}}function O_(o){for(;nt!==null;){var c=nt;if((c.flags&8772)!==0){var p=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:vn||wd(5,c);break;case 1:var y=c.stateNode;if(c.flags&4&&!vn)if(p===null)y.componentDidMount();else{var N=c.elementType===c.type?p.memoizedProps:Gi(c.type,p.memoizedProps);y.componentDidUpdate(N,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var C=c.updateQueue;C!==null&&D2(c,C,y);break;case 3:var I=c.updateQueue;if(I!==null){if(p=null,c.child!==null)switch(c.child.tag){case 5:p=c.child.stateNode;break;case 1:p=c.child.stateNode}D2(c,I,p)}break;case 5:var ee=c.stateNode;if(p===null&&c.flags&4){p=ee;var ce=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ce.autoFocus&&p.focus();break;case"img":ce.src&&(p.src=ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var ke=c.alternate;if(ke!==null){var He=ke.memoizedState;if(He!==null){var Ye=He.dehydrated;Ye!==null&&Bc(Ye)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}vn||c.flags&512&&qm(c)}catch(ze){xr(c,c.return,ze)}}if(c===o){nt=null;break}if(p=c.sibling,p!==null){p.return=c.return,nt=p;break}nt=c.return}}function D_(o){for(;nt!==null;){var c=nt;if(c===o){nt=null;break}var p=c.sibling;if(p!==null){p.return=c.return,nt=p;break}nt=c.return}}function R_(o){for(;nt!==null;){var c=nt;try{switch(c.tag){case 0:case 11:case 15:var p=c.return;try{wd(4,c)}catch(ce){xr(c,p,ce)}break;case 1:var y=c.stateNode;if(typeof y.componentDidMount=="function"){var N=c.return;try{y.componentDidMount()}catch(ce){xr(c,N,ce)}}var C=c.return;try{qm(c)}catch(ce){xr(c,C,ce)}break;case 5:var I=c.return;try{qm(c)}catch(ce){xr(c,I,ce)}}}catch(ce){xr(c,c.return,ce)}if(c===o){nt=null;break}var ee=c.sibling;if(ee!==null){ee.return=c.return,nt=ee;break}nt=c.return}}var hR=Math.ceil,bd=A.ReactCurrentDispatcher,Jm=A.ReactCurrentOwner,ki=A.ReactCurrentBatchConfig,kt=0,Xr=null,Cr=null,nn=0,ci=0,Cl=ys(0),Br=0,lu=null,vo=0,_d=0,ex=0,cu=null,Xn=null,tx=0,kl=1/0,Ia=null,Sd=!1,rx=null,Es=null,Nd=!1,Ts=null,Ed=0,uu=0,nx=null,Td=-1,Cd=0;function Dn(){return(kt&6)!==0?Ue():Td!==-1?Td:Td=Ue()}function Cs(o){return(o.mode&1)===0?1:(kt&2)!==0&&nn!==0?nn&-nn:qD.transition!==null?(Cd===0&&(Cd=Cb()),Cd):(o=Ft,o!==0||(o=window.event,o=o===void 0?16:Fb(o.type)),o)}function qi(o,c,p,y){if(50<uu)throw uu=0,nx=null,Error(r(185));Rc(o,p,y),((kt&2)===0||o!==Xr)&&(o===Xr&&((kt&2)===0&&(_d|=p),Br===4&&ks(o,nn)),qn(o,y),p===1&&kt===0&&(c.mode&1)===0&&(kl=Ue()+500,td&&bs()))}function qn(o,c){var p=o.callbackNode;q5(o,c);var y=Ff(o,o===Xr?nn:0);if(y===0)p!==null&&Je(p),o.callbackNode=null,o.callbackPriority=0;else if(c=y&-y,o.callbackPriority!==c){if(p!=null&&Je(p),c===1)o.tag===0?XD(F_.bind(null,o)):b2(F_.bind(null,o)),VD(function(){(kt&6)===0&&bs()}),p=null;else{switch(kb(y)){case 1:p=$t;break;case 4:p=Vt;break;case 16:p=wr;break;case 536870912:p=fs;break;default:p=wr}p=H_(p,I_.bind(null,o))}o.callbackPriority=c,o.callbackNode=p}}function I_(o,c){if(Td=-1,Cd=0,(kt&6)!==0)throw Error(r(327));var p=o.callbackNode;if(Al()&&o.callbackNode!==p)return null;var y=Ff(o,o===Xr?nn:0);if(y===0)return null;if((y&30)!==0||(y&o.expiredLanes)!==0||c)c=kd(o,y);else{c=y;var N=kt;kt|=2;var C=L_();(Xr!==o||nn!==c)&&(Ia=null,kl=Ue()+500,wo(o,c));do try{xR();break}catch(ee){M_(o,ee)}while(!0);bm(),bd.current=C,kt=N,Cr!==null?c=0:(Xr=null,nn=0,c=Br)}if(c!==0){if(c===2&&(N=Mp(o),N!==0&&(y=N,c=ix(o,N))),c===1)throw p=lu,wo(o,0),ks(o,y),qn(o,Ue()),p;if(c===6)ks(o,y);else{if(N=o.current.alternate,(y&30)===0&&!pR(N)&&(c=kd(o,y),c===2&&(C=Mp(o),C!==0&&(y=C,c=ix(o,C))),c===1))throw p=lu,wo(o,0),ks(o,y),qn(o,Ue()),p;switch(o.finishedWork=N,o.finishedLanes=y,c){case 0:case 1:throw Error(r(345));case 2:bo(o,Xn,Ia);break;case 3:if(ks(o,y),(y&130023424)===y&&(c=tx+500-Ue(),10<c)){if(Ff(o,0)!==0)break;if(N=o.suspendedLanes,(N&y)!==y){Dn(),o.pingedLanes|=o.suspendedLanes&N;break}o.timeoutHandle=um(bo.bind(null,o,Xn,Ia),c);break}bo(o,Xn,Ia);break;case 4:if(ks(o,y),(y&4194240)===y)break;for(c=o.eventTimes,N=-1;0<y;){var I=31-br(y);C=1<<I,I=c[I],I>N&&(N=I),y&=~C}if(y=N,y=Ue()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*hR(y/1960))-y,10<y){o.timeoutHandle=um(bo.bind(null,o,Xn,Ia),y);break}bo(o,Xn,Ia);break;case 5:bo(o,Xn,Ia);break;default:throw Error(r(329))}}}return qn(o,Ue()),o.callbackNode===p?I_.bind(null,o):null}function ix(o,c){var p=cu;return o.current.memoizedState.isDehydrated&&(wo(o,c).flags|=256),o=kd(o,c),o!==2&&(c=Xn,Xn=p,c!==null&&ax(c)),o}function ax(o){Xn===null?Xn=o:Xn.push.apply(Xn,o)}function pR(o){for(var c=o;;){if(c.flags&16384){var p=c.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var N=p[y],C=N.getSnapshot;N=N.value;try{if(!Vi(C(),N))return!1}catch{return!1}}}if(p=c.child,c.subtreeFlags&16384&&p!==null)p.return=c,c=p;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ks(o,c){for(c&=~ex,c&=~_d,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var p=31-br(c),y=1<<p;o[p]=-1,c&=~y}}function F_(o){if((kt&6)!==0)throw Error(r(327));Al();var c=Ff(o,0);if((c&1)===0)return qn(o,Ue()),null;var p=kd(o,c);if(o.tag!==0&&p===2){var y=Mp(o);y!==0&&(c=y,p=ix(o,y))}if(p===1)throw p=lu,wo(o,0),ks(o,c),qn(o,Ue()),p;if(p===6)throw Error(r(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,bo(o,Xn,Ia),qn(o,Ue()),null}function sx(o,c){var p=kt;kt|=1;try{return o(c)}finally{kt=p,kt===0&&(kl=Ue()+500,td&&bs())}}function yo(o){Ts!==null&&Ts.tag===0&&(kt&6)===0&&Al();var c=kt;kt|=1;var p=ki.transition,y=Ft;try{if(ki.transition=null,Ft=1,o)return o()}finally{Ft=y,ki.transition=p,kt=c,(kt&6)===0&&bs()}}function ox(){ci=Cl.current,qt(Cl)}function wo(o,c){o.finishedWork=null,o.finishedLanes=0;var p=o.timeoutHandle;if(p!==-1&&(o.timeoutHandle=-1,HD(p)),Cr!==null)for(p=Cr.return;p!==null;){var y=p;switch(xm(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Jf();break;case 3:Nl(),qt(Kn),qt(mn),Am();break;case 5:Cm(y);break;case 4:Nl();break;case 13:qt(ur);break;case 19:qt(ur);break;case 10:_m(y.type._context);break;case 22:case 23:ox()}p=p.return}if(Xr=o,Cr=o=As(o.current,null),nn=ci=c,Br=0,lu=null,ex=_d=vo=0,Xn=cu=null,mo!==null){for(c=0;c<mo.length;c++)if(p=mo[c],y=p.interleaved,y!==null){p.interleaved=null;var N=y.next,C=p.pending;if(C!==null){var I=C.next;C.next=N,y.next=I}p.pending=y}mo=null}return o}function M_(o,c){do{var p=Cr;try{if(bm(),fd.current=md,dd){for(var y=fr.memoizedState;y!==null;){var N=y.queue;N!==null&&(N.pending=null),y=y.next}dd=!1}if(go=0,Yr=Lr=fr=null,ru=!1,nu=0,Jm.current=null,p===null||p.return===null){Br=1,lu=c,Cr=null;break}e:{var C=o,I=p.return,ee=p,ce=c;if(c=nn,ee.flags|=32768,ce!==null&&typeof ce=="object"&&typeof ce.then=="function"){var ke=ce,He=ee,Ye=He.tag;if((He.mode&1)===0&&(Ye===0||Ye===11||Ye===15)){var ze=He.alternate;ze?(He.updateQueue=ze.updateQueue,He.memoizedState=ze.memoizedState,He.lanes=ze.lanes):(He.updateQueue=null,He.memoizedState=null)}var tt=l_(I);if(tt!==null){tt.flags&=-257,c_(tt,I,ee,C,c),tt.mode&1&&o_(C,ke,c),c=tt,ce=ke;var at=c.updateQueue;if(at===null){var st=new Set;st.add(ce),c.updateQueue=st}else at.add(ce);break e}else{if((c&1)===0){o_(C,ke,c),lx();break e}ce=Error(r(426))}}else if(er&&ee.mode&1){var _r=l_(I);if(_r!==null){(_r.flags&65536)===0&&(_r.flags|=256),c_(_r,I,ee,C,c),ym(El(ce,ee));break e}}C=ce=El(ce,ee),Br!==4&&(Br=2),cu===null?cu=[C]:cu.push(C),C=I;do{switch(C.tag){case 3:C.flags|=65536,c&=-c,C.lanes|=c;var ve=a_(C,ce,c);O2(C,ve);break e;case 1:ee=ce;var ue=C.type,Ne=C.stateNode;if((C.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||Ne!==null&&typeof Ne.componentDidCatch=="function"&&(Es===null||!Es.has(Ne)))){C.flags|=65536,c&=-c,C.lanes|=c;var Ze=s_(C,ee,c);O2(C,Ze);break e}}C=C.return}while(C!==null)}$_(p)}catch(lt){c=lt,Cr===p&&p!==null&&(Cr=p=p.return);continue}break}while(!0)}function L_(){var o=bd.current;return bd.current=md,o===null?md:o}function lx(){(Br===0||Br===3||Br===2)&&(Br=4),Xr===null||(vo&268435455)===0&&(_d&268435455)===0||ks(Xr,nn)}function kd(o,c){var p=kt;kt|=2;var y=L_();(Xr!==o||nn!==c)&&(Ia=null,wo(o,c));do try{mR();break}catch(N){M_(o,N)}while(!0);if(bm(),kt=p,bd.current=y,Cr!==null)throw Error(r(261));return Xr=null,nn=0,Br}function mR(){for(;Cr!==null;)B_(Cr)}function xR(){for(;Cr!==null&&!rt();)B_(Cr)}function B_(o){var c=W_(o.alternate,o,ci);o.memoizedProps=o.pendingProps,c===null?$_(o):Cr=c,Jm.current=null}function $_(o){var c=o;do{var p=c.alternate;if(o=c.return,(c.flags&32768)===0){if(p=lR(p,c,ci),p!==null){Cr=p;return}}else{if(p=cR(p,c),p!==null){p.flags&=32767,Cr=p;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Br=6,Cr=null;return}}if(c=c.sibling,c!==null){Cr=c;return}Cr=c=o}while(c!==null);Br===0&&(Br=5)}function bo(o,c,p){var y=Ft,N=ki.transition;try{ki.transition=null,Ft=1,gR(o,c,p,y)}finally{ki.transition=N,Ft=y}return null}function gR(o,c,p,y){do Al();while(Ts!==null);if((kt&6)!==0)throw Error(r(327));p=o.finishedWork;var N=o.finishedLanes;if(p===null)return null;if(o.finishedWork=null,o.finishedLanes=0,p===o.current)throw Error(r(177));o.callbackNode=null,o.callbackPriority=0;var C=p.lanes|p.childLanes;if(Z5(o,C),o===Xr&&(Cr=Xr=null,nn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Nd||(Nd=!0,H_(wr,function(){return Al(),null})),C=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||C){C=ki.transition,ki.transition=null;var I=Ft;Ft=1;var ee=kt;kt|=4,Jm.current=null,fR(o,p),P_(p,o),MD(lm),Bf=!!om,lm=om=null,o.current=p,dR(p),Xe(),kt=ee,Ft=I,ki.transition=C}else o.current=p;if(Nd&&(Nd=!1,Ts=o,Ed=N),C=o.pendingLanes,C===0&&(Es=null),Oc(p.stateNode),qn(o,Ue()),c!==null)for(y=o.onRecoverableError,p=0;p<c.length;p++)N=c[p],y(N.value,{componentStack:N.stack,digest:N.digest});if(Sd)throw Sd=!1,o=rx,rx=null,o;return(Ed&1)!==0&&o.tag!==0&&Al(),C=o.pendingLanes,(C&1)!==0?o===nx?uu++:(uu=0,nx=o):uu=0,bs(),null}function Al(){if(Ts!==null){var o=kb(Ed),c=ki.transition,p=Ft;try{if(ki.transition=null,Ft=16>o?16:o,Ts===null)var y=!1;else{if(o=Ts,Ts=null,Ed=0,(kt&6)!==0)throw Error(r(331));var N=kt;for(kt|=4,nt=o.current;nt!==null;){var C=nt,I=C.child;if((nt.flags&16)!==0){var ee=C.deletions;if(ee!==null){for(var ce=0;ce<ee.length;ce++){var ke=ee[ce];for(nt=ke;nt!==null;){var He=nt;switch(He.tag){case 0:case 11:case 15:ou(8,He,C)}var Ye=He.child;if(Ye!==null)Ye.return=He,nt=Ye;else for(;nt!==null;){He=nt;var ze=He.sibling,tt=He.return;if(E_(He),He===ke){nt=null;break}if(ze!==null){ze.return=tt,nt=ze;break}nt=tt}}}var at=C.alternate;if(at!==null){var st=at.child;if(st!==null){at.child=null;do{var _r=st.sibling;st.sibling=null,st=_r}while(st!==null)}}nt=C}}if((C.subtreeFlags&2064)!==0&&I!==null)I.return=C,nt=I;else e:for(;nt!==null;){if(C=nt,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:ou(9,C,C.return)}var ve=C.sibling;if(ve!==null){ve.return=C.return,nt=ve;break e}nt=C.return}}var ue=o.current;for(nt=ue;nt!==null;){I=nt;var Ne=I.child;if((I.subtreeFlags&2064)!==0&&Ne!==null)Ne.return=I,nt=Ne;else e:for(I=ue;nt!==null;){if(ee=nt,(ee.flags&2048)!==0)try{switch(ee.tag){case 0:case 11:case 15:wd(9,ee)}}catch(lt){xr(ee,ee.return,lt)}if(ee===I){nt=null;break e}var Ze=ee.sibling;if(Ze!==null){Ze.return=ee.return,nt=Ze;break e}nt=ee.return}}if(kt=N,bs(),Gr&&typeof Gr.onPostCommitFiberRoot=="function")try{Gr.onPostCommitFiberRoot(sa,o)}catch{}y=!0}return y}finally{Ft=p,ki.transition=c}}return!1}function U_(o,c,p){c=El(p,c),c=a_(o,c,1),o=Ss(o,c,1),c=Dn(),o!==null&&(Rc(o,1,c),qn(o,c))}function xr(o,c,p){if(o.tag===3)U_(o,o,p);else for(;c!==null;){if(c.tag===3){U_(c,o,p);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Es===null||!Es.has(y))){o=El(p,o),o=s_(c,o,1),c=Ss(c,o,1),o=Dn(),c!==null&&(Rc(c,1,o),qn(c,o));break}}c=c.return}}function vR(o,c,p){var y=o.pingCache;y!==null&&y.delete(c),c=Dn(),o.pingedLanes|=o.suspendedLanes&p,Xr===o&&(nn&p)===p&&(Br===4||Br===3&&(nn&130023424)===nn&&500>Ue()-tx?wo(o,0):ex|=p),qn(o,c)}function z_(o,c){c===0&&((o.mode&1)===0?c=1:(c=If,If<<=1,(If&130023424)===0&&(If=4194304)));var p=Dn();o=Oa(o,c),o!==null&&(Rc(o,c,p),qn(o,p))}function yR(o){var c=o.memoizedState,p=0;c!==null&&(p=c.retryLane),z_(o,p)}function wR(o,c){var p=0;switch(o.tag){case 13:var y=o.stateNode,N=o.memoizedState;N!==null&&(p=N.retryLane);break;case 19:y=o.stateNode;break;default:throw Error(r(314))}y!==null&&y.delete(c),z_(o,p)}var W_;W_=function(o,c,p){if(o!==null)if(o.memoizedProps!==c.pendingProps||Kn.current)Yn=!0;else{if((o.lanes&p)===0&&(c.flags&128)===0)return Yn=!1,oR(o,c,p);Yn=(o.flags&131072)!==0}else Yn=!1,er&&(c.flags&1048576)!==0&&_2(c,nd,c.index);switch(c.lanes=0,c.tag){case 2:var y=c.type;vd(o,c),o=c.pendingProps;var N=gl(c,mn.current);Sl(c,p),N=Om(null,c,y,o,N,p);var C=Dm();return c.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Gn(y)?(C=!0,ed(c)):C=!1,c.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,Em(c),N.updater=xd,c.stateNode=N,N._reactInternals=c,Bm(c,y,o,p),c=Wm(null,c,y,!0,C,p)):(c.tag=0,er&&C&&mm(c),On(null,c,N,p),c=c.child),c;case 16:y=c.elementType;e:{switch(vd(o,c),o=c.pendingProps,N=y._init,y=N(y._payload),c.type=y,N=c.tag=_R(y),o=Gi(y,o),N){case 0:c=zm(null,c,y,o,p);break e;case 1:c=m_(null,c,y,o,p);break e;case 11:c=u_(null,c,y,o,p);break e;case 14:c=f_(null,c,y,Gi(y.type,o),p);break e}throw Error(r(306,y,""))}return c;case 0:return y=c.type,N=c.pendingProps,N=c.elementType===y?N:Gi(y,N),zm(o,c,y,N,p);case 1:return y=c.type,N=c.pendingProps,N=c.elementType===y?N:Gi(y,N),m_(o,c,y,N,p);case 3:e:{if(x_(c),o===null)throw Error(r(387));y=c.pendingProps,C=c.memoizedState,N=C.element,j2(o,c),cd(c,y,null,p);var I=c.memoizedState;if(y=I.element,C.isDehydrated)if(C={element:y,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},c.updateQueue.baseState=C,c.memoizedState=C,c.flags&256){N=El(Error(r(423)),c),c=g_(o,c,y,p,N);break e}else if(y!==N){N=El(Error(r(424)),c),c=g_(o,c,y,p,N);break e}else for(li=vs(c.stateNode.containerInfo.firstChild),oi=c,er=!0,Ki=null,p=A2(c,null,y,p),c.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(wl(),y===N){c=Ra(o,c,p);break e}On(o,c,y,p)}c=c.child}return c;case 5:return R2(c),o===null&&vm(c),y=c.type,N=c.pendingProps,C=o!==null?o.memoizedProps:null,I=N.children,cm(y,N)?I=null:C!==null&&cm(y,C)&&(c.flags|=32),p_(o,c),On(o,c,I,p),c.child;case 6:return o===null&&vm(c),null;case 13:return v_(o,c,p);case 4:return Tm(c,c.stateNode.containerInfo),y=c.pendingProps,o===null?c.child=bl(c,null,y,p):On(o,c,y,p),c.child;case 11:return y=c.type,N=c.pendingProps,N=c.elementType===y?N:Gi(y,N),u_(o,c,y,N,p);case 7:return On(o,c,c.pendingProps,p),c.child;case 8:return On(o,c,c.pendingProps.children,p),c.child;case 12:return On(o,c,c.pendingProps.children,p),c.child;case 10:e:{if(y=c.type._context,N=c.pendingProps,C=c.memoizedProps,I=N.value,Kt(sd,y._currentValue),y._currentValue=I,C!==null)if(Vi(C.value,I)){if(C.children===N.children&&!Kn.current){c=Ra(o,c,p);break e}}else for(C=c.child,C!==null&&(C.return=c);C!==null;){var ee=C.dependencies;if(ee!==null){I=C.child;for(var ce=ee.firstContext;ce!==null;){if(ce.context===y){if(C.tag===1){ce=Da(-1,p&-p),ce.tag=2;var ke=C.updateQueue;if(ke!==null){ke=ke.shared;var He=ke.pending;He===null?ce.next=ce:(ce.next=He.next,He.next=ce),ke.pending=ce}}C.lanes|=p,ce=C.alternate,ce!==null&&(ce.lanes|=p),Sm(C.return,p,c),ee.lanes|=p;break}ce=ce.next}}else if(C.tag===10)I=C.type===c.type?null:C.child;else if(C.tag===18){if(I=C.return,I===null)throw Error(r(341));I.lanes|=p,ee=I.alternate,ee!==null&&(ee.lanes|=p),Sm(I,p,c),I=C.sibling}else I=C.child;if(I!==null)I.return=C;else for(I=C;I!==null;){if(I===c){I=null;break}if(C=I.sibling,C!==null){C.return=I.return,I=C;break}I=I.return}C=I}On(o,c,N.children,p),c=c.child}return c;case 9:return N=c.type,y=c.pendingProps.children,Sl(c,p),N=Ti(N),y=y(N),c.flags|=1,On(o,c,y,p),c.child;case 14:return y=c.type,N=Gi(y,c.pendingProps),N=Gi(y.type,N),f_(o,c,y,N,p);case 15:return d_(o,c,c.type,c.pendingProps,p);case 17:return y=c.type,N=c.pendingProps,N=c.elementType===y?N:Gi(y,N),vd(o,c),c.tag=1,Gn(y)?(o=!0,ed(c)):o=!1,Sl(c,p),n_(c,y,N),Bm(c,y,N,p),Wm(null,c,y,!0,o,p);case 19:return w_(o,c,p);case 22:return h_(o,c,p)}throw Error(r(156,c.tag))};function H_(o,c){return Ge(o,c)}function bR(o,c,p,y){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ai(o,c,p,y){return new bR(o,c,p,y)}function cx(o){return o=o.prototype,!(!o||!o.isReactComponent)}function _R(o){if(typeof o=="function")return cx(o)?1:0;if(o!=null){if(o=o.$$typeof,o===U)return 11;if(o===ae)return 14}return 2}function As(o,c){var p=o.alternate;return p===null?(p=Ai(o.tag,c,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=c,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&14680064,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,c=o.dependencies,p.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p}function Ad(o,c,p,y,N,C){var I=2;if(y=o,typeof o=="function")cx(o)&&(I=1);else if(typeof o=="string")I=5;else e:switch(o){case P:return _o(p.children,N,C,c);case M:I=8,N|=8;break;case L:return o=Ai(12,p,c,N|2),o.elementType=L,o.lanes=C,o;case oe:return o=Ai(13,p,c,N),o.elementType=oe,o.lanes=C,o;case V:return o=Ai(19,p,c,N),o.elementType=V,o.lanes=C,o;case J:return Pd(p,N,C,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case B:I=10;break e;case R:I=9;break e;case U:I=11;break e;case ae:I=14;break e;case le:I=16,y=null;break e}throw Error(r(130,o==null?o:typeof o,""))}return c=Ai(I,p,c,N),c.elementType=o,c.type=y,c.lanes=C,c}function _o(o,c,p,y){return o=Ai(7,o,y,c),o.lanes=p,o}function Pd(o,c,p,y){return o=Ai(22,o,y,c),o.elementType=J,o.lanes=p,o.stateNode={isHidden:!1},o}function ux(o,c,p){return o=Ai(6,o,null,c),o.lanes=p,o}function fx(o,c,p){return c=Ai(4,o.children!==null?o.children:[],o.key,c),c.lanes=p,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function SR(o,c,p,y,N){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lp(0),this.expirationTimes=Lp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lp(0),this.identifierPrefix=y,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function dx(o,c,p,y,N,C,I,ee,ce){return o=new SR(o,c,p,ee,ce),c===1?(c=1,C===!0&&(c|=8)):c=0,C=Ai(3,null,null,c),o.current=C,C.stateNode=o,C.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Em(C),o}function NR(o,c,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:y==null?null:""+y,children:o,containerInfo:c,implementation:p}}function V_(o){if(!o)return ws;o=o._reactInternals;e:{if(Q(o)!==o||o.tag!==1)throw Error(r(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Gn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(r(171))}if(o.tag===1){var p=o.type;if(Gn(p))return y2(o,p,c)}return c}function K_(o,c,p,y,N,C,I,ee,ce){return o=dx(p,y,!0,o,N,C,I,ee,ce),o.context=V_(null),p=o.current,y=Dn(),N=Cs(p),C=Da(y,N),C.callback=c??null,Ss(p,C,N),o.current.lanes=N,Rc(o,N,y),qn(o,y),o}function jd(o,c,p,y){var N=c.current,C=Dn(),I=Cs(N);return p=V_(p),c.context===null?c.context=p:c.pendingContext=p,c=Da(C,I),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=Ss(N,c,I),o!==null&&(qi(o,N,I,C),ld(o,N,I)),I}function Od(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function G_(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<c?p:c}}function hx(o,c){G_(o,c),(o=o.alternate)&&G_(o,c)}function ER(){return null}var Y_=typeof reportError=="function"?reportError:function(o){console.error(o)};function px(o){this._internalRoot=o}Dd.prototype.render=px.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(r(409));jd(o,c,null,null)},Dd.prototype.unmount=px.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;yo(function(){jd(null,o,null,null)}),c[ka]=null}};function Dd(o){this._internalRoot=o}Dd.prototype.unstable_scheduleHydration=function(o){if(o){var c=jb();o={blockedOn:null,target:o,priority:c};for(var p=0;p<ms.length&&c!==0&&c<ms[p].priority;p++);ms.splice(p,0,o),p===0&&Rb(o)}};function mx(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Rd(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function X_(){}function TR(o,c,p,y,N){if(N){if(typeof y=="function"){var C=y;y=function(){var ke=Od(I);C.call(ke)}}var I=K_(c,y,o,0,null,!1,!1,"",X_);return o._reactRootContainer=I,o[ka]=I.current,Yc(o.nodeType===8?o.parentNode:o),yo(),I}for(;N=o.lastChild;)o.removeChild(N);if(typeof y=="function"){var ee=y;y=function(){var ke=Od(ce);ee.call(ke)}}var ce=dx(o,0,!1,null,null,!1,!1,"",X_);return o._reactRootContainer=ce,o[ka]=ce.current,Yc(o.nodeType===8?o.parentNode:o),yo(function(){jd(c,ce,p,y)}),ce}function Id(o,c,p,y,N){var C=p._reactRootContainer;if(C){var I=C;if(typeof N=="function"){var ee=N;N=function(){var ce=Od(I);ee.call(ce)}}jd(c,I,o,N)}else I=TR(p,c,o,N,y);return Od(I)}Ab=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var p=Dc(c.pendingLanes);p!==0&&(Bp(c,p|1),qn(c,Ue()),(kt&6)===0&&(kl=Ue()+500,bs()))}break;case 13:yo(function(){var y=Oa(o,1);if(y!==null){var N=Dn();qi(y,o,1,N)}}),hx(o,1)}},$p=function(o){if(o.tag===13){var c=Oa(o,134217728);if(c!==null){var p=Dn();qi(c,o,134217728,p)}hx(o,134217728)}},Pb=function(o){if(o.tag===13){var c=Cs(o),p=Oa(o,c);if(p!==null){var y=Dn();qi(p,o,c,y)}hx(o,c)}},jb=function(){return Ft},Ob=function(o,c){var p=Ft;try{return Ft=o,c()}finally{Ft=p}},cr=function(o,c,p){switch(c){case"input":if(Ce(o,p),c=p.name,p.type==="radio"&&c!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<p.length;c++){var y=p[c];if(y!==o&&y.form===o.form){var N=Qf(y);if(!N)throw Error(r(90));te(y),Ce(y,N)}}}break;case"textarea":$e(o,p);break;case"select":c=p.value,c!=null&&Pe(o,!!p.multiple,c,!1)}},Ta=sx,Of=yo;var CR={usingClientEntryPoint:!1,Events:[Zc,ml,Qf,ai,Hi,sx]},fu={findFiberByHostInstance:uo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kR={bundleType:fu.bundleType,version:fu.version,rendererPackageName:fu.rendererPackageName,rendererConfig:fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=_e(o),o===null?null:o.stateNode},findFiberByHostInstance:fu.findFiberByHostInstance||ER,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fd.isDisabled&&Fd.supportsFiber)try{sa=Fd.inject(kR),Gr=Fd}catch{}}return Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CR,Zn.createPortal=function(o,c){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mx(c))throw Error(r(200));return NR(o,c,null,p)},Zn.createRoot=function(o,c){if(!mx(o))throw Error(r(299));var p=!1,y="",N=Y_;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(N=c.onRecoverableError)),c=dx(o,1,!1,null,null,p,!1,y,N),o[ka]=c.current,Yc(o.nodeType===8?o.parentNode:o),new px(c)},Zn.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=_e(c),o=o===null?null:o.stateNode,o},Zn.flushSync=function(o){return yo(o)},Zn.hydrate=function(o,c,p){if(!Rd(c))throw Error(r(200));return Id(null,o,c,!0,p)},Zn.hydrateRoot=function(o,c,p){if(!mx(o))throw Error(r(405));var y=p!=null&&p.hydratedSources||null,N=!1,C="",I=Y_;if(p!=null&&(p.unstable_strictMode===!0&&(N=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onRecoverableError!==void 0&&(I=p.onRecoverableError)),c=K_(c,null,o,1,p??null,N,!1,C,I),o[ka]=c.current,Yc(o),y)for(o=0;o<y.length;o++)p=y[o],N=p._getVersion,N=N(p._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[p,N]:c.mutableSourceEagerHydrationData.push(p,N);return new Dd(c)},Zn.render=function(o,c,p){if(!Rd(c))throw Error(r(200));return Id(null,o,c,!1,p)},Zn.unmountComponentAtNode=function(o){if(!Rd(o))throw Error(r(40));return o._reactRootContainer?(yo(function(){Id(null,null,o,!1,function(){o._reactRootContainer=null,o[ka]=null})}),!0):!1},Zn.unstable_batchedUpdates=sx,Zn.unstable_renderSubtreeIntoContainer=function(o,c,p,y){if(!Rd(p))throw Error(r(200));if(o==null||o._reactInternals===void 0)throw Error(r(38));return Id(o,c,p,!1,y)},Zn.version="18.3.1-next-f1338f8080-20240426",Zn}var nS;function Hk(){if(nS)return vx.exports;nS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),vx.exports=FR(),vx.exports}var iS;function MR(){if(iS)return Md;iS=1;var e=Hk();return Md.createRoot=e.createRoot,Md.hydrateRoot=e.hydrateRoot,Md}var LR=MR(),v=fc();const Xa=is(v),Vk=PR({__proto__:null,default:Xa},[v]);var BR=Hk();function Lu(){return Lu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lu.apply(this,arguments)}var Ls;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ls||(Ls={}));const aS="popstate";function $R(e){e===void 0&&(e={});function t(n,i){let{pathname:a,search:s,hash:l}=n.location;return Ov("",{pathname:a,search:s,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:E0(i)}return zR(t,r,null,e)}function Er(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Kk(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function UR(){return Math.random().toString(36).substr(2,8)}function sS(e,t){return{usr:e.state,key:e.key,idx:t}}function Ov(e,t,r,n){return r===void 0&&(r=null),Lu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?dc(t):t,{state:r,key:t&&t.key||n||UR()})}function E0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function dc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function zR(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,l=Ls.Pop,f=null,h=d();h==null&&(h=0,s.replaceState(Lu({},s.state,{idx:h}),""));function d(){return(s.state||{idx:null}).idx}function m(){l=Ls.Pop;let b=d(),S=b==null?null:b-h;h=b,f&&f({action:l,location:w.location,delta:S})}function x(b,S){l=Ls.Push;let T=Ov(w.location,b,S);h=d()+1;let E=sS(T,h),A=w.createHref(T);try{s.pushState(E,"",A)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(A)}a&&f&&f({action:l,location:w.location,delta:1})}function g(b,S){l=Ls.Replace;let T=Ov(w.location,b,S);h=d();let E=sS(T,h),A=w.createHref(T);s.replaceState(E,"",A),a&&f&&f({action:l,location:w.location,delta:0})}function _(b){let S=i.location.origin!=="null"?i.location.origin:i.location.href,T=typeof b=="string"?b:E0(b);return T=T.replace(/ $/,"%20"),Er(S,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,S)}let w={get action(){return l},get location(){return e(i,s)},listen(b){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(aS,m),f=b,()=>{i.removeEventListener(aS,m),f=null}},createHref(b){return t(i,b)},createURL:_,encodeLocation(b){let S=_(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:g,go(b){return s.go(b)}};return w}var oS;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(oS||(oS={}));function WR(e,t,r){return r===void 0&&(r="/"),HR(e,t,r)}function HR(e,t,r,n){let i=typeof t=="string"?dc(t):t,a=q1(i.pathname||"/",r);if(a==null)return null;let s=Gk(e);VR(s);let l=null;for(let f=0;l==null&&f<s.length;++f){let h=nI(a);l=eI(s[f],h)}return l}function Gk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,l)=>{let f={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};f.relativePath.startsWith("/")&&(Er(f.relativePath.startsWith(n),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(n.length));let h=Us([n,f.relativePath]),d=r.concat(f);a.children&&a.children.length>0&&(Er(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Gk(a.children,t,d,h)),!(a.path==null&&!a.index)&&t.push({path:h,score:QR(h,a.index),routesMeta:d})};return e.forEach((a,s)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,s);else for(let f of Yk(a.path))i(a,s,f)}),t}function Yk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=Yk(n.join("/")),l=[];return l.push(...s.map(f=>f===""?a:[a,f].join("/"))),i&&l.push(...s),l.map(f=>e.startsWith("/")&&f===""?"/":f)}function VR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:JR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const KR=/^:[\w-]+$/,GR=3,YR=2,XR=1,qR=10,ZR=-2,lS=e=>e==="*";function QR(e,t){let r=e.split("/"),n=r.length;return r.some(lS)&&(n+=ZR),t&&(n+=YR),r.filter(i=>!lS(i)).reduce((i,a)=>i+(KR.test(a)?GR:a===""?XR:qR),n)}function JR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function eI(e,t,r){let{routesMeta:n}=e,i={},a="/",s=[];for(let l=0;l<n.length;++l){let f=n[l],h=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",m=tI({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},d),x=f.route;if(!m)return null;Object.assign(i,m.params),s.push({params:i,pathname:Us([a,m.pathname]),pathnameBase:oI(Us([a,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(a=Us([a,m.pathnameBase]))}return s}function tI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=rI(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((h,d,m)=>{let{paramName:x,isOptional:g}=d;if(x==="*"){let w=l[m]||"";s=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const _=l[m];return g&&!_?h[x]=void 0:h[x]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:s,pattern:e}}function rI(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Kk(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,f)=>(n.push({paramName:l,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function nI(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Kk(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function q1(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function iI(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?dc(e):e;return{pathname:r?r.startsWith("/")?r:aI(r,t):t,search:lI(n),hash:cI(i)}}function aI(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function bx(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sI(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Z1(e,t){let r=sI(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Q1(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=dc(e):(i=Lu({},e),Er(!i.pathname||!i.pathname.includes("?"),bx("?","pathname","search",i)),Er(!i.pathname||!i.pathname.includes("#"),bx("#","pathname","hash",i)),Er(!i.search||!i.search.includes("#"),bx("#","search","hash",i)));let a=e===""||i.pathname==="",s=a?"/":i.pathname,l;if(s==null)l=r;else{let m=t.length-1;if(!n&&s.startsWith("..")){let x=s.split("/");for(;x[0]==="..";)x.shift(),m-=1;i.pathname=x.join("/")}l=m>=0?t[m]:"/"}let f=iI(i,l),h=s&&s!=="/"&&s.endsWith("/"),d=(a||s===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(h||d)&&(f.pathname+="/"),f}const Us=e=>e.join("/").replace(/\/\/+/g,"/"),oI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),lI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,cI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function uI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Xk=["post","put","patch","delete"];new Set(Xk);const fI=["get",...Xk];new Set(fI);function Bu(){return Bu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bu.apply(this,arguments)}const J1=v.createContext(null),dI=v.createContext(null),Qs=v.createContext(null),Ih=v.createContext(null),Js=v.createContext({outlet:null,matches:[],isDataRoute:!1}),qk=v.createContext(null);function hI(e,t){let{relative:r}=t===void 0?{}:t;hc()||Er(!1);let{basename:n,navigator:i}=v.useContext(Qs),{hash:a,pathname:s,search:l}=Qk(e,{relative:r}),f=s;return n!=="/"&&(f=s==="/"?n:Us([n,s])),i.createHref({pathname:f,search:l,hash:a})}function hc(){return v.useContext(Ih)!=null}function eo(){return hc()||Er(!1),v.useContext(Ih).location}function Zk(e){v.useContext(Qs).static||v.useLayoutEffect(e)}function Fh(){let{isDataRoute:e}=v.useContext(Js);return e?TI():pI()}function pI(){hc()||Er(!1);let e=v.useContext(J1),{basename:t,future:r,navigator:n}=v.useContext(Qs),{matches:i}=v.useContext(Js),{pathname:a}=eo(),s=JSON.stringify(Z1(i,r.v7_relativeSplatPath)),l=v.useRef(!1);return Zk(()=>{l.current=!0}),v.useCallback(function(h,d){if(d===void 0&&(d={}),!l.current)return;if(typeof h=="number"){n.go(h);return}let m=Q1(h,JSON.parse(s),a,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Us([t,m.pathname])),(d.replace?n.replace:n.push)(m,d.state,d)},[t,n,s,a,e])}function Qk(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=v.useContext(Qs),{matches:i}=v.useContext(Js),{pathname:a}=eo(),s=JSON.stringify(Z1(i,n.v7_relativeSplatPath));return v.useMemo(()=>Q1(e,JSON.parse(s),a,r==="path"),[e,s,a,r])}function mI(e,t){return xI(e,t)}function xI(e,t,r,n){hc()||Er(!1);let{navigator:i}=v.useContext(Qs),{matches:a}=v.useContext(Js),s=a[a.length-1],l=s?s.params:{};s&&s.pathname;let f=s?s.pathnameBase:"/";s&&s.route;let h=eo(),d;if(t){var m;let b=typeof t=="string"?dc(t):t;f==="/"||(m=b.pathname)!=null&&m.startsWith(f)||Er(!1),d=b}else d=h;let x=d.pathname||"/",g=x;if(f!=="/"){let b=f.replace(/^\//,"").split("/");g="/"+x.replace(/^\//,"").split("/").slice(b.length).join("/")}let _=WR(e,{pathname:g}),w=bI(_&&_.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Us([f,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?f:Us([f,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,r,n);return t&&w?v.createElement(Ih.Provider,{value:{location:Bu({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Ls.Pop}},w):w}function gI(){let e=EI(),t=uI(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),r?v.createElement("pre",{style:i},r):null,null)}const vI=v.createElement(gI,null);class yI extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?v.createElement(Js.Provider,{value:this.props.routeContext},v.createElement(qk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function wI(e){let{routeContext:t,match:r,children:n}=e,i=v.useContext(J1);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),v.createElement(Js.Provider,{value:t},n)}function bI(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=s.findIndex(m=>m.route.id&&l?.[m.route.id]!==void 0);d>=0||Er(!1),s=s.slice(0,Math.min(s.length,d+1))}let f=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<s.length;d++){let m=s[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=d),m.route.id){let{loaderData:x,errors:g}=r,_=m.route.loader&&x[m.route.id]===void 0&&(!g||g[m.route.id]===void 0);if(m.route.lazy||_){f=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((d,m,x)=>{let g,_=!1,w=null,b=null;r&&(g=l&&m.route.id?l[m.route.id]:void 0,w=m.route.errorElement||vI,f&&(h<0&&x===0?(CI("route-fallback"),_=!0,b=null):h===x&&(_=!0,b=m.route.hydrateFallbackElement||null)));let S=t.concat(s.slice(0,x+1)),T=()=>{let E;return g?E=w:_?E=b:m.route.Component?E=v.createElement(m.route.Component,null):m.route.element?E=m.route.element:E=d,v.createElement(wI,{match:m,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:E})};return r&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?v.createElement(yI,{location:r.location,revalidation:r.revalidation,component:w,error:g,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):T()},null)}var Jk=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(Jk||{}),e4=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(e4||{});function _I(e){let t=v.useContext(J1);return t||Er(!1),t}function SI(e){let t=v.useContext(dI);return t||Er(!1),t}function NI(e){let t=v.useContext(Js);return t||Er(!1),t}function t4(e){let t=NI(),r=t.matches[t.matches.length-1];return r.route.id||Er(!1),r.route.id}function EI(){var e;let t=v.useContext(qk),r=SI(),n=t4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function TI(){let{router:e}=_I(Jk.UseNavigateStable),t=t4(e4.UseNavigateStable),r=v.useRef(!1);return Zk(()=>{r.current=!0}),v.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Bu({fromRouteId:t},a)))},[e,t])}const cS={};function CI(e,t,r){cS[e]||(cS[e]=!0)}function Dv(e){let{to:t,replace:r,state:n,relative:i}=e;hc()||Er(!1);let{future:a,static:s}=v.useContext(Qs),{matches:l}=v.useContext(Js),{pathname:f}=eo(),h=Fh(),d=Q1(t,Z1(l,a.v7_relativeSplatPath),f,i==="path"),m=JSON.stringify(d);return v.useEffect(()=>h(JSON.parse(m),{replace:r,state:n,relative:i}),[h,m,i,r,n]),null}function wn(e){Er(!1)}function kI(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Ls.Pop,navigator:a,static:s=!1,future:l}=e;hc()&&Er(!1);let f=t.replace(/^\/*/,"/"),h=v.useMemo(()=>({basename:f,navigator:a,static:s,future:Bu({v7_relativeSplatPath:!1},l)}),[f,l,a,s]);typeof n=="string"&&(n=dc(n));let{pathname:d="/",search:m="",hash:x="",state:g=null,key:_="default"}=n,w=v.useMemo(()=>{let b=q1(d,f);return b==null?null:{location:{pathname:b,search:m,hash:x,state:g,key:_},navigationType:i}},[f,d,m,x,g,_,i]);return w==null?null:v.createElement(Qs.Provider,{value:h},v.createElement(Ih.Provider,{children:r,value:w}))}function uS(e){let{children:t,location:r}=e;return mI(Rv(t),r)}new Promise(()=>{});function Rv(e,t){t===void 0&&(t=[]);let r=[];return v.Children.forEach(e,(n,i)=>{if(!v.isValidElement(n))return;let a=[...t,i];if(n.type===v.Fragment){r.push.apply(r,Rv(n.props.children,a));return}n.type!==wn&&Er(!1),!n.props.index||!n.props.children||Er(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Rv(n.props.children,a)),r.push(s)}),r}function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(this,arguments)}function AI(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function PI(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jI(e,t){return e.button===0&&(!t||t==="_self")&&!PI(e)}const OI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],DI="6";try{window.__reactRouterVersion=DI}catch{}const RI="startTransition",fS=Vk[RI];function II(e){let{basename:t,children:r,future:n,window:i}=e,a=v.useRef();a.current==null&&(a.current=$R({window:i,v5Compat:!0}));let s=a.current,[l,f]=v.useState({action:s.action,location:s.location}),{v7_startTransition:h}=n||{},d=v.useCallback(m=>{h&&fS?fS(()=>f(m)):f(m)},[f,h]);return v.useLayoutEffect(()=>s.listen(d),[s,d]),v.createElement(kI,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:s,future:n})}const FI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dS=v.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:l,target:f,to:h,preventScrollReset:d,unstable_viewTransition:m}=t,x=AI(t,OI),{basename:g}=v.useContext(Qs),_,w=!1;if(typeof h=="string"&&MI.test(h)&&(_=h,FI))try{let E=new URL(window.location.href),A=h.startsWith("//")?new URL(E.protocol+h):new URL(h),k=q1(A.pathname,g);A.origin===E.origin&&k!=null?h=k+A.search+A.hash:w=!0}catch{}let b=hI(h,{relative:i}),S=LI(h,{replace:s,state:l,target:f,preventScrollReset:d,relative:i,unstable_viewTransition:m});function T(E){n&&n(E),E.defaultPrevented||S(E)}return v.createElement("a",Iv({},x,{href:_||b,onClick:w||a?n:T,ref:r,target:f}))});var hS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(hS||(hS={}));var pS;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(pS||(pS={}));function LI(e,t){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s,unstable_viewTransition:l}=t===void 0?{}:t,f=Fh(),h=eo(),d=Qk(e,{relative:s});return v.useCallback(m=>{if(jI(m,r)){m.preventDefault();let x=n!==void 0?n:E0(h)===E0(d);f(e,{replace:x,state:i,preventScrollReset:a,relative:s,unstable_viewTransition:l})}},[h,f,d,n,i,r,e,a,s,l])}function BI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const ey=v.forwardRef(BI);function $I({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const UI=v.forwardRef($I);function zI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const ty=v.forwardRef(zI);function WI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const HI=v.forwardRef(WI);function VI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const KI=v.forwardRef(VI);function GI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const T0=v.forwardRef(GI);function YI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const ry=v.forwardRef(YI);function XI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const qI=v.forwardRef(XI);function ZI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"}))}const QI=v.forwardRef(ZI);function JI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const e6=v.forwardRef(JI);function t6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const r4=v.forwardRef(t6);function r6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const n4=v.forwardRef(r6);function n6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"}))}const i6=v.forwardRef(n6);function a6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const s6=v.forwardRef(a6);function o6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Jl=v.forwardRef(o6);function l6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Mo=v.forwardRef(l6);function c6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const i4=v.forwardRef(c6);function u6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const f6=v.forwardRef(u6);function d6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ny=v.forwardRef(d6);function h6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const p6=v.forwardRef(h6);function m6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const _x=v.forwardRef(m6);function x6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const g6=v.forwardRef(x6);function v6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const iy=v.forwardRef(v6);function y6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const lf=v.forwardRef(y6);function w6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const b6=v.forwardRef(w6);function _6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const S6=v.forwardRef(_6);function N6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const el=v.forwardRef(N6);function E6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const a4=v.forwardRef(E6);function T6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const C6=v.forwardRef(T6);function k6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const Mh=v.forwardRef(k6);function A6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const ec=v.forwardRef(A6);function P6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ay=v.forwardRef(P6);function j6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const qa=v.forwardRef(j6);function O6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const s4=v.forwardRef(O6);function D6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const R6=v.forwardRef(D6);function I6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const sy=v.forwardRef(I6);function F6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Lo=v.forwardRef(F6);function M6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const L6=v.forwardRef(M6);function B6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const $6=v.forwardRef(B6);function U6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const o4=v.forwardRef(U6);function z6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const zr=v.forwardRef(z6),W6={};var H6={};const V6=(()=>{const e=typeof import.meta<"u"&&W6?.VITE_API_BASE_URL||"";if(e)return e;const t=typeof process<"u"&&H6?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function K6(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const Lh=K6(V6),G6=e=>{if(e.startsWith("http"))return e;const t=Lh.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Tt(e,t){const r=G6(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(i){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw i}}async function Y6(e=new Date().getFullYear()){const t=await Tt(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Khong the tai du lieu bieu do dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],i=l=>{const f=l.month||l.month_label||(Number.isFinite(l.month_num)?`T${l.month_num}`:"");return String(f||"").trim()},a=n.map(l=>({month:i(l),total_sales:Number(l.total_revenue??l.total_sales)||0})),s=n.map(l=>({month:i(l),total_orders:Number(l.total_orders)||0,total_canceled:Number(l.total_canceled)||0}));return{revenueData:a,orderStatusData:s,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function X6(){const e=await Tt("/api/dashboard/years");if(!e.ok)throw new Error("Li khi ti danh sch nm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const l4=v.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),oy=()=>v.useContext(l4),q6=({children:e})=>{const[t,r]=v.useState(null),[n,i]=v.useState(!0),a=async()=>{try{const s=await Tt("/api/auth/me");if(!s.ok){r(null);return}const l=await s.json();r(l.user||null)}catch{r(null)}finally{i(!1)}};return v.useEffect(()=>{a()},[]),u.jsx(l4.Provider,{value:{user:t,setUser:r,loading:n,refresh:a},children:e})},Sx=[{title:"Tng Quan",items:[{name:"Tng Quan",href:"/dashboard",icon:n4}]},{title:"Sn Phm",items:[{name:"n Hng",href:"/orders",icon:sy},{name:"Gi",href:"/package-products",icon:f6},{name:"Bng Gi",href:"/pricing",icon:ny},{name:"Thng Tin Sn Phm",href:"/product-info",icon:S6}]},{title:"C Nhn",items:[{name:"Thng K",href:"/stats",icon:i6},{name:"Nh Cung Cp",href:"/sources",icon:p6},{name:"Bo Gi",href:"/show-price",icon:_x},{name:"Ha n",href:"/bill-order",icon:_x},{name:"Bin Lai",href:"/invoices",icon:_x},{name:"Lu tr",href:"/warehouse",icon:ey}]}],mS=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,i])=>`${n}=${i}`).sort().join("&")},Nx=(e,t,r)=>{const[n,i]=r.split("?"),a=i?`?${i}`:"";return e!==n?!1:mS(t)===mS(a)};function Z6({isOpen:e,setIsOpen:t}){const r=eo(),{user:n,setUser:i}=oy(),[a,s]=v.useState(!1),[l,f]=v.useState(()=>Object.fromEntries(Sx.map(m=>[m.title,!0]))),h=m=>{f(x=>({...x,[m]:!x[m]}))},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{i(null),window.location.href="/login"}};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:u.jsx("button",{onClick:()=>t(!e),className:"bg-white p-2 rounded-lg shadow-lg border border-gray-200",children:e?u.jsx(zr,{className:"h-6 w-6 text-gray-600"}):u.jsx(qI,{className:"h-6 w-6 text-gray-600"})})}),e&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>t(!1)}),u.jsx("div",{className:`
          fixed top-0 left-0 z-40 w-64 h-full bg-gradient-to-b from-[#0c1230] via-[#141a3c] to-[#0a0e24] shadow-2xl border-r border-white/10
          transform transition-transform duration-300 ease-in-out
          ${e?"translate-x-0":"-translate-x-full"}
          lg:translate-x-0
        `,children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx("div",{className:"px-4 pt-6 pb-4",children:u.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 px-4 py-3 shadow-lg shadow-indigo-900/50 text-center border border-white/10",children:[u.jsx("h1",{className:"text-lg font-bold text-white tracking-wide",children:"Admin Orderlist"}),u.jsx("p",{className:"text-[11px] text-indigo-100/90 mt-1 font-medium uppercase tracking-[0.08em]",children:"Control Panel"})]})}),u.jsx("nav",{className:"flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:Sx.map(m=>{const x=l[m.title]??!0,g=m.title===Sx[0].title,_=m.items.some(w=>r.pathname===w.href||Nx(r.pathname,r.search,w.href));return u.jsx("div",{className:`w-full rounded-2xl border border-white/10 bg-white/5 shadow-[0_10px_30px_-12px_rgba(0,0,0,0.45)] backdrop-blur-sm mb-3 ${_?"ring-2 ring-indigo-500/40":""}`,children:g?u.jsx("div",{className:"space-y-1 px-2 py-1",children:m.items.map(w=>{const b=r.pathname===w.href||Nx(r.pathname,r.search,w.href);return u.jsx("div",{className:"space-y-2",children:u.jsxs(dS,{to:w.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${b?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[u.jsx(w.icon,{className:`h-5 w-5 transition-colors ${b?"text-white":"text-indigo-200 group-hover:text-white"}`}),w.name]})},w.name)})}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>h(m.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[u.jsx("span",{children:m.title}),u.jsx(i4,{className:`h-4 w-4 transition-transform ${x?"rotate-180":""}`})]}),x&&u.jsx("div",{className:"space-y-1 px-2.5 py-2",children:m.items.map(w=>{const b=r.pathname===w.href||Nx(r.pathname,r.search,w.href);return u.jsx("div",{className:"space-y-2",children:u.jsxs(dS,{to:w.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${b?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[u.jsx(w.icon,{className:`h-5 w-5 transition-colors ${b?"text-white":"text-indigo-200 group-hover:text-white"}`}),w.name]})},w.name)})})]})},m.title)})}),u.jsxs("div",{className:"relative p-4 border-t border-white/10 bg-white/5 backdrop-blur-sm",children:[u.jsxs("div",{className:"w-full flex items-center justify-between",children:[u.jsxs("button",{type:"button",onClick:()=>s(m=>!m),className:"flex items-center flex-1",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center shadow-md shadow-indigo-900/40",children:u.jsx("span",{className:"text-white text-sm font-bold tracking-wide",children:(n?.username||"A").slice(0,1).toUpperCase()})}),u.jsxs("div",{className:"ml-3 flex-1 text-left",children:[u.jsx("p",{className:"text-sm font-semibold text-white truncate",children:n?.username||"Ti khon"}),u.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:n?.role?`Role: ${n.role}`:"Cha ng nhp"})]})]}),u.jsx("button",{type:"button",onClick:d,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"ng Xut",children:u.jsx(HI,{className:"h-5 w-5"})})]}),a&&u.jsx("div",{className:"absolute bottom-16 left-4 right-4 rounded-lg border border-white/15 bg-[#0f1432] shadow-2xl shadow-black/40 z-10",children:u.jsx("ul",{className:"py-2 text-sm text-indigo-50 space-y-1",children:["Thng tin","Thm Admin","Thm Quyn","i Mt Khu"].map(m=>u.jsx("li",{children:u.jsx("button",{type:"button",className:"w-full text-left px-4 py-2 hover:bg-white/10",onClick:()=>s(!1),children:m})},m))})})]})]})})]})}const Or={sky:{border:"border-sky-100/80",glow:"from-sky-100/70 via-white/80 to-blue-100/70",iconBg:"bg-sky-500/90 text-white"},emerald:{border:"border-emerald-100/80",glow:"from-emerald-100/70 via-white/80 to-lime-100/70",iconBg:"bg-emerald-500/90 text-white"},violet:{border:"border-violet-100/80",glow:"from-violet-100/70 via-white/80 to-fuchsia-100/70",iconBg:"bg-violet-500/90 text-white"},amber:{border:"border-amber-100/80",glow:"from-amber-100/70 via-white/80 to-orange-100/70",iconBg:"bg-amber-500/90 text-white"},rose:{border:"border-rose-100/80",glow:"from-rose-100/70 via-white/80 to-pink-100/70",iconBg:"bg-rose-500/90 text-white"},indigo:{border:"border-indigo-100/80",glow:"from-indigo-100/70 via-white/80 to-purple-100/70",iconBg:"bg-indigo-500/90 text-white"},slate:{border:"border-slate-200/80",glow:"from-slate-100/70 via-white/80 to-slate-200/70",iconBg:"bg-slate-600/90 text-white"},teal:{border:"border-teal-100/80",glow:"from-teal-100/70 via-white/80 to-cyan-100/70",iconBg:"bg-teal-500/90 text-white"}},Ua=({title:e,value:t,icon:r,accent:n,subtitle:i,children:a,iconClassName:s="h-6 w-6"})=>u.jsxs("div",{className:"relative isolate overflow-hidden rounded-3xl border border-white/25 bg-gradient-to-br from-slate-200/70 via-indigo-200/60 to-slate-300/70 p-6 shadow-[0_18px_48px_-28px_rgba(0,0,0,0.6),0_12px_30px_-24px_rgba(255,255,255,0.22)] backdrop-blur transition-all hover:shadow-[0_22px_60px_-28px_rgba(0,0,0,0.65),0_16px_36px_-24px_rgba(255,255,255,0.24)]",children:[u.jsxs("div",{className:"flex items-center justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e}),u.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:t}),i&&u.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-wide text-slate-600",children:i})]}),u.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20 border border-white/35 shadow-inner shadow-black/15 text-slate-800",children:u.jsx(r,{className:s})})]}),a&&u.jsx("div",{className:"mt-4",children:a})]});function c4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=c4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Rt(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=c4(e))&&(n&&(n+=" "),n+=t);return n}var Q6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function ly(e){if(typeof e!="string")return!1;var t=Q6;return t.includes(e)}var J6=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function u4(e){if(typeof e!="string")return!1;var t=J6;return t.includes(e)}function f4(e){return typeof e=="string"&&e.startsWith("data-")}function bi(e){var t=Object.entries(e).filter(r=>{var[n]=r;return u4(n)||f4(n)});return Object.fromEntries(t)}function Bo(e){if(e==null)return null;if(v.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return bi(t)}return typeof e=="object"&&!Array.isArray(e)?bi(e):null}function Hn(e){var t=Object.entries(e).filter(r=>{var[n]=r;return u4(n)||f4(n)||ly(n)});return Object.fromEntries(t)}function eF(e){return e==null?null:v.isValidElement(e)?Hn(e.props):typeof e=="object"&&!Array.isArray(e)?Hn(e):null}var tF=["children","width","height","viewBox","className","style","title","desc"];function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fv.apply(null,arguments)}function rF(e,t){if(e==null)return{};var r,n,i=nF(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function nF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var d4=v.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:l,title:f,desc:h}=e,d=rF(e,tF),m=a||{width:n,height:i,x:0,y:0},x=Rt("recharts-surface",s);return v.createElement("svg",Fv({},Hn(d),{className:x,width:n,height:i,style:l,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,f),v.createElement("desc",null,h),r)}),iF=["children","className"];function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mv.apply(null,arguments)}function aF(e,t){if(e==null)return{};var r,n,i=sF(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function sF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var dn=v.forwardRef((e,t)=>{var{children:r,className:n}=e,i=aF(e,iF),a=Rt("recharts-layer",n);return v.createElement("g",Mv({className:a},Hn(i),{ref:t}),r)}),oF=v.createContext(null);function Gt(e){return function(){return e}}const h4=Math.cos,C0=Math.sin,aa=Math.sqrt,k0=Math.PI,Bh=2*k0,Lv=Math.PI,Bv=2*Lv,No=1e-6,lF=Bv-No;function p4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function cF(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return p4;const r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class uF{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?p4:cF(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,s){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,l=this._y1,f=n-t,h=i-r,d=s-t,m=l-r,x=d*d+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>No)if(!(Math.abs(m*f-h*d)>No)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-s,_=i-l,w=f*f+h*h,b=g*g+_*_,S=Math.sqrt(w),T=Math.sqrt(x),E=a*Math.tan((Lv-Math.acos((w+x-b)/(2*S*T)))/2),A=E/T,k=E/S;Math.abs(A-1)>No&&this._append`L${t+A*d},${r+A*m}`,this._append`A${a},${a},0,0,${+(m*g>d*_)},${this._x1=t+k*f},${this._y1=r+k*h}`}}arc(t,r,n,i,a,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),f=n*Math.sin(i),h=t+l,d=r+f,m=1^s,x=s?i-a:a-i;this._x1===null?this._append`M${h},${d}`:(Math.abs(this._x1-h)>No||Math.abs(this._y1-d)>No)&&this._append`L${h},${d}`,n&&(x<0&&(x=x%Bv+Bv),x>lF?this._append`A${n},${n},0,1,${m},${t-l},${r-f}A${n},${n},0,1,${m},${this._x1=h},${this._y1=d}`:x>No&&this._append`A${n},${n},0,${+(x>=Lv)},${m},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function cy(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new uF(t)}function uy(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function m4(e){this._context=e}m4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $h(e){return new m4(e)}function x4(e){return e[0]}function g4(e){return e[1]}function v4(e,t){var r=Gt(!0),n=null,i=$h,a=null,s=cy(l);e=typeof e=="function"?e:e===void 0?x4:Gt(e),t=typeof t=="function"?t:t===void 0?g4:Gt(t);function l(f){var h,d=(f=uy(f)).length,m,x=!1,g;for(n==null&&(a=i(g=s())),h=0;h<=d;++h)!(h<d&&r(m=f[h],h,f))===x&&((x=!x)?a.lineStart():a.lineEnd()),x&&a.point(+e(m,h,f),+t(m,h,f));if(g)return a=null,g+""||null}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:Gt(+f),l):e},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:Gt(+f),l):t},l.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Gt(!!f),l):r},l.curve=function(f){return arguments.length?(i=f,n!=null&&(a=i(n)),l):i},l.context=function(f){return arguments.length?(f==null?n=a=null:a=i(n=f),l):n},l}function Ld(e,t,r){var n=null,i=Gt(!0),a=null,s=$h,l=null,f=cy(h);e=typeof e=="function"?e:e===void 0?x4:Gt(+e),t=typeof t=="function"?t:Gt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?g4:Gt(+r);function h(m){var x,g,_,w=(m=uy(m)).length,b,S=!1,T,E=new Array(w),A=new Array(w);for(a==null&&(l=s(T=f())),x=0;x<=w;++x){if(!(x<w&&i(b=m[x],x,m))===S)if(S=!S)g=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),_=x-1;_>=g;--_)l.point(E[_],A[_]);l.lineEnd(),l.areaEnd()}S&&(E[x]=+e(b,x,m),A[x]=+t(b,x,m),l.point(n?+n(b,x,m):E[x],r?+r(b,x,m):A[x]))}if(T)return l=null,T+""||null}function d(){return v4().defined(i).curve(s).context(a)}return h.x=function(m){return arguments.length?(e=typeof m=="function"?m:Gt(+m),n=null,h):e},h.x0=function(m){return arguments.length?(e=typeof m=="function"?m:Gt(+m),h):e},h.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:Gt(+m),h):n},h.y=function(m){return arguments.length?(t=typeof m=="function"?m:Gt(+m),r=null,h):t},h.y0=function(m){return arguments.length?(t=typeof m=="function"?m:Gt(+m),h):t},h.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:Gt(+m),h):r},h.lineX0=h.lineY0=function(){return d().x(e).y(t)},h.lineY1=function(){return d().x(e).y(r)},h.lineX1=function(){return d().x(n).y(t)},h.defined=function(m){return arguments.length?(i=typeof m=="function"?m:Gt(!!m),h):i},h.curve=function(m){return arguments.length?(s=m,a!=null&&(l=s(a)),h):s},h.context=function(m){return arguments.length?(m==null?a=l=null:l=s(a=m),h):a},h}class y4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function fF(e){return new y4(e,!0)}function dF(e){return new y4(e,!1)}const fy={draw(e,t){const r=aa(t/k0);e.moveTo(r,0),e.arc(0,0,r,0,Bh)}},hF={draw(e,t){const r=aa(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},w4=aa(1/3),pF=w4*2,mF={draw(e,t){const r=aa(t/pF),n=r*w4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},xF={draw(e,t){const r=aa(t),n=-r/2;e.rect(n,n,r,r)}},gF=.8908130915292852,b4=C0(k0/10)/C0(7*k0/10),vF=C0(Bh/10)*b4,yF=-h4(Bh/10)*b4,wF={draw(e,t){const r=aa(t*gF),n=vF*r,i=yF*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const s=Bh*a/5,l=h4(s),f=C0(s);e.lineTo(f*r,-l*r),e.lineTo(l*n-f*i,f*n+l*i)}e.closePath()}},Ex=aa(3),bF={draw(e,t){const r=-aa(t/(Ex*3));e.moveTo(0,r*2),e.lineTo(-Ex*r,-r),e.lineTo(Ex*r,-r),e.closePath()}},Pi=-.5,ji=aa(3)/2,$v=1/aa(12),_F=($v/2+1)*3,SF={draw(e,t){const r=aa(t/_F),n=r/2,i=r*$v,a=n,s=r*$v+r,l=-a,f=s;e.moveTo(n,i),e.lineTo(a,s),e.lineTo(l,f),e.lineTo(Pi*n-ji*i,ji*n+Pi*i),e.lineTo(Pi*a-ji*s,ji*a+Pi*s),e.lineTo(Pi*l-ji*f,ji*l+Pi*f),e.lineTo(Pi*n+ji*i,Pi*i-ji*n),e.lineTo(Pi*a+ji*s,Pi*s-ji*a),e.lineTo(Pi*l+ji*f,Pi*f-ji*l),e.closePath()}};function NF(e,t){let r=null,n=cy(i);e=typeof e=="function"?e:Gt(e||fy),t=typeof t=="function"?t:Gt(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:Gt(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:Gt(+a),i):t},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function A0(){}function P0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function _4(e){this._context=e}_4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:P0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function EF(e){return new _4(e)}function S4(e){this._context=e}S4.prototype={areaStart:A0,areaEnd:A0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TF(e){return new S4(e)}function N4(e){this._context=e}N4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CF(e){return new N4(e)}function E4(e){this._context=e}E4.prototype={areaStart:A0,areaEnd:A0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function kF(e){return new E4(e)}function xS(e){return e<0?-1:1}function gS(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),s=(r-e._y1)/(i||n<0&&-0),l=(a*i+s*n)/(n+i);return(xS(a)+xS(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(l))||0}function vS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Tx(e,t,r){var n=e._x0,i=e._y0,a=e._x1,s=e._y1,l=(a-n)/3;e._context.bezierCurveTo(n+l,i+l*t,a-l,s-l*r,a,s)}function j0(e){this._context=e}j0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tx(this,this._t0,vS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Tx(this,vS(this,r=gS(this,e,t)),r);break;default:Tx(this,this._t0,r=gS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function T4(e){this._context=new C4(e)}(T4.prototype=Object.create(j0.prototype)).point=function(e,t){j0.prototype.point.call(this,t,e)};function C4(e){this._context=e}C4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function AF(e){return new j0(e)}function PF(e){return new T4(e)}function k4(e){this._context=e}k4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=yS(e),i=yS(t),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function yS(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function jF(e){return new k4(e)}function Uh(e,t){this._context=e,this._t=t}Uh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function OF(e){return new Uh(e,.5)}function DF(e){return new Uh(e,0)}function RF(e){return new Uh(e,1)}function tc(e,t){if((s=e.length)>1)for(var r=1,n,i,a=e[t[0]],s,l=a.length;r<s;++r)for(i=a,a=e[t[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Uv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function IF(e,t){return e[t]}function FF(e){const t=[];return t.key=e,t}function MF(){var e=Gt([]),t=Uv,r=tc,n=IF;function i(a){var s=Array.from(e.apply(this,arguments),FF),l,f=s.length,h=-1,d;for(const m of a)for(l=0,++h;l<f;++l)(s[l][h]=[0,+n(m,s[l].key,h,a)]).data=m;for(l=0,d=uy(t(s));l<f;++l)s[d[l]].index=l;return r(s,d),s}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Gt(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Gt(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?Uv:typeof a=="function"?a:Gt(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a??tc,i):r},i}function LF(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=e[r][i][1]||0;if(s)for(r=0;r<n;++r)e[r][i][1]/=s}tc(e,t)}}function BF(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var s=0,l=0;s<i;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}tc(e,t)}}function $F(e,t){if(!(!((s=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var l=0,f=0,h=0;l<s;++l){for(var d=e[t[l]],m=d[n][1]||0,x=d[n-1][1]||0,g=(m-x)/2,_=0;_<l;++_){var w=e[t[_]],b=w[n][1]||0,S=w[n-1][1]||0;g+=b-S}f+=m,h+=g*m}i[n-1][1]+=i[n-1][0]=r,f&&(r-=h/f)}i[n-1][1]+=i[n-1][0]=r,tc(e,t)}}var Cx={},kx={},wS;function UF(){return wS||(wS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(kx)),kx}var Ax={},bS;function A4(){return bS||(bS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Ax)),Ax}var Px={},_S;function dy(){return _S||(_S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Px)),Px}var jx={},Ox={},SS;function zF(){return SS||(SS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Ox)),Ox}var NS;function hy(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zF(),r=dy();function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const a=[],s=i.length;if(s===0)return a;let l=0,f="",h="",d=!1;for(i.charCodeAt(0)===46&&(a.push(""),l++);l<s;){const m=i[l];h?m==="\\"&&l+1<s?(l++,f+=i[l]):m===h?h="":f+=m:d?m==='"'||m==="'"?h=m:m==="]"?(d=!1,a.push(f),f=""):f+=m:m==="["?(d=!0,f&&(a.push(f),f="")):m==="."?f&&(a.push(f),f=""):f+=m,l++}return f&&a.push(f),a}e.toPath=n})(jx)),jx}var ES;function py(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UF(),r=A4(),n=dy(),i=hy();function a(l,f,h){if(l==null)return h;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return h;const d=l[f];return d===void 0?r.isDeepKey(f)?a(l,i.toPath(f),h):h:d}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const d=l[f];return d===void 0?h:d}default:{if(Array.isArray(f))return s(l,f,h);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return h;const d=l[f];return d===void 0?h:d}}}function s(l,f,h){if(f.length===0)return h;let d=l;for(let m=0;m<f.length;m++){if(d==null||t.isUnsafeProperty(f[m]))return h;d=d[f[m]]}return d===void 0?h:d}e.get=a})(Cx)),Cx}var Dx,TS;function WF(){return TS||(TS=1,Dx=py().get),Dx}var HF=WF();const $o=is(HF);var Jr=e=>e===0?0:e>0?1:-1,Bi=e=>typeof e=="number"&&e!=+e,Za=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,ft=e=>(typeof e=="number"||e instanceof Number)&&!Bi(e),_a=e=>ft(e)||typeof e=="string",VF=0,$u=e=>{var t=++VF;return"".concat(e||"").concat(t)},Cn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ft(t)&&typeof t!="string")return n;var a;if(Za(t)){if(r==null)return n;var s=t.indexOf("%");a=r*parseFloat(t.slice(0,s))/100}else a=+t;return Bi(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},P4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function gr(e,t,r){return ft(e)&&ft(t)?e+r*(t-e):t}function j4(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):$o(n,t))===r)}var sr=e=>e===null||typeof e>"u",cf=e=>sr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),KF=["type","size","sizeType"];function zv(){return zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zv.apply(null,arguments)}function CS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CS(Object(r),!0).forEach(function(n){GF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GF(e,t,r){return(t=YF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YF(e){var t=XF(e,"string");return typeof t=="symbol"?t:t+""}function XF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qF(e,t){if(e==null)return{};var r,n,i=ZF(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ZF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var O4={symbolCircle:fy,symbolCross:hF,symbolDiamond:mF,symbolSquare:xF,symbolStar:wF,symbolTriangle:bF,symbolWye:SF},QF=Math.PI/180,JF=e=>{var t="symbol".concat(cf(e));return O4[t]||fy},eM=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*QF;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},tM=(e,t)=>{O4["symbol".concat(cf(e))]=t},D4=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=qF(e,KF),a=kS(kS({},i),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var x=JF(s),g=NF().type(x).size(eM(r,n,s)),_=g();if(_!==null)return _},{className:f,cx:h,cy:d}=a,m=Hn(a);return h===+h&&d===+d&&r===+r?v.createElement("path",zv({},m,{className:Rt("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(d,")"),d:l()})):null};D4.registerSymbol=tM;var my=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{ly(i)&&(n[i]=(a=>r[i](r,a)))}),n},rM=(e,t,r)=>n=>(e(t,r,n),null),zh=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var a=e[i];ly(i)&&typeof a=="function"&&(n||(n={}),n[i]=rM(a,t,r))}),n},Rx={},Ix={},AS;function nM(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],l=n(s);i.has(l)||i.set(l,s)}return Array.from(i.values())}e.uniqBy=t})(Ix)),Ix}var Fx={},PS;function R4(){return PS||(PS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Fx)),Fx}var Mx={},Lx={},Bx={},jS;function iM(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Bx)),Bx}var OS;function xy(){return OS||(OS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iM();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Lx)),Lx}var $x={},DS;function aM(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})($x)),$x}var RS;function sM(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xy(),r=aM();function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(Mx)),Mx}var Ux={},zx={},IS;function oM(){return IS||(IS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=py();function r(n){return function(i){return t.get(i,n)}}e.property=r})(zx)),zx}var Wx={},Hx={},Vx={},Kx={},FS;function I4(){return FS||(FS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Kx)),Kx}var Gx={},MS;function F4(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Gx)),Gx}var Yx={},LS;function M4(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Yx)),Yx}var BS;function lM(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I4(),r=F4(),n=M4();function i(d,m,x){return typeof x!="function"?i(d,m,()=>{}):a(d,m,function g(_,w,b,S,T,E){const A=x(_,w,b,S,T,E);return A!==void 0?!!A:a(_,w,g,E)},new Map)}function a(d,m,x,g){if(m===d)return!0;switch(typeof m){case"object":return s(d,m,x,g);case"function":return Object.keys(m).length>0?a(d,{...m},x,g):n.eq(d,m);default:return t.isObject(d)?typeof m=="string"?m==="":!0:n.eq(d,m)}}function s(d,m,x,g){if(m==null)return!0;if(Array.isArray(m))return f(d,m,x,g);if(m instanceof Map)return l(d,m,x,g);if(m instanceof Set)return h(d,m,x,g);const _=Object.keys(m);if(d==null)return _.length===0;if(_.length===0)return!0;if(g?.has(m))return g.get(m)===d;g?.set(m,d);try{for(let w=0;w<_.length;w++){const b=_[w];if(!r.isPrimitive(d)&&!(b in d)||m[b]===void 0&&d[b]!==void 0||m[b]===null&&d[b]!==null||!x(d[b],m[b],b,d,m,g))return!1}return!0}finally{g?.delete(m)}}function l(d,m,x,g){if(m.size===0)return!0;if(!(d instanceof Map))return!1;for(const[_,w]of m.entries()){const b=d.get(_);if(x(b,w,_,d,m,g)===!1)return!1}return!0}function f(d,m,x,g){if(m.length===0)return!0;if(!Array.isArray(d))return!1;const _=new Set;for(let w=0;w<m.length;w++){const b=m[w];let S=!1;for(let T=0;T<d.length;T++){if(_.has(T))continue;const E=d[T];let A=!1;if(x(E,b,w,d,m,g)&&(A=!0),A){_.add(T),S=!0;break}}if(!S)return!1}return!0}function h(d,m,x,g){return m.size===0?!0:d instanceof Set?f([...d],[...m],x,g):!1}e.isMatchWith=i,e.isSetMatch=h})(Vx)),Vx}var $S;function L4(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lM();function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(Hx)),Hx}var Xx={},qx={},Zx={},US;function cM(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Zx)),Zx}var Qx={},zS;function B4(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Qx)),Qx}var Jx={},WS;function $4(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",l="[object Date]",f="[object Map]",h="[object Set]",d="[object Array]",m="[object Function]",x="[object ArrayBuffer]",g="[object Object]",_="[object Error]",w="[object DataView]",b="[object Uint8Array]",S="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",A="[object BigUint64Array]",k="[object Int8Array]",j="[object Int16Array]",P="[object Int32Array]",M="[object BigInt64Array]",L="[object Float32Array]",B="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=x,e.arrayTag=d,e.bigInt64ArrayTag=M,e.bigUint64ArrayTag=A,e.booleanTag=i,e.dataViewTag=w,e.dateTag=l,e.errorTag=_,e.float32ArrayTag=L,e.float64ArrayTag=B,e.functionTag=m,e.int16ArrayTag=j,e.int32ArrayTag=P,e.int8ArrayTag=k,e.mapTag=f,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=h,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=T,e.uint32ArrayTag=E,e.uint8ArrayTag=b,e.uint8ClampedArrayTag=S})(Jx)),Jx}var eg={},HS;function uM(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(eg)),eg}var VS;function U4(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cM(),r=B4(),n=$4(),i=F4(),a=uM();function s(d,m){return l(d,void 0,d,new Map,m)}function l(d,m,x,g=new Map,_=void 0){const w=_?.(d,m,x,g);if(w!==void 0)return w;if(i.isPrimitive(d))return d;if(g.has(d))return g.get(d);if(Array.isArray(d)){const b=new Array(d.length);g.set(d,b);for(let S=0;S<d.length;S++)b[S]=l(d[S],S,x,g,_);return Object.hasOwn(d,"index")&&(b.index=d.index),Object.hasOwn(d,"input")&&(b.input=d.input),b}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const b=new RegExp(d.source,d.flags);return b.lastIndex=d.lastIndex,b}if(d instanceof Map){const b=new Map;g.set(d,b);for(const[S,T]of d)b.set(S,l(T,S,x,g,_));return b}if(d instanceof Set){const b=new Set;g.set(d,b);for(const S of d)b.add(l(S,void 0,x,g,_));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const b=new(Object.getPrototypeOf(d)).constructor(d.length);g.set(d,b);for(let S=0;S<d.length;S++)b[S]=l(d[S],S,x,g,_);return b}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const b=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return g.set(d,b),f(b,d,x,g,_),b}if(typeof File<"u"&&d instanceof File){const b=new File([d],d.name,{type:d.type});return g.set(d,b),f(b,d,x,g,_),b}if(typeof Blob<"u"&&d instanceof Blob){const b=new Blob([d],{type:d.type});return g.set(d,b),f(b,d,x,g,_),b}if(d instanceof Error){const b=new d.constructor;return g.set(d,b),b.message=d.message,b.name=d.name,b.stack=d.stack,b.cause=d.cause,f(b,d,x,g,_),b}if(d instanceof Boolean){const b=new Boolean(d.valueOf());return g.set(d,b),f(b,d,x,g,_),b}if(d instanceof Number){const b=new Number(d.valueOf());return g.set(d,b),f(b,d,x,g,_),b}if(d instanceof String){const b=new String(d.valueOf());return g.set(d,b),f(b,d,x,g,_),b}if(typeof d=="object"&&h(d)){const b=Object.create(Object.getPrototypeOf(d));return g.set(d,b),f(b,d,x,g,_),b}return d}function f(d,m,x=d,g,_){const w=[...Object.keys(m),...t.getSymbols(m)];for(let b=0;b<w.length;b++){const S=w[b],T=Object.getOwnPropertyDescriptor(d,S);(T==null||T.writable)&&(d[S]=l(m[S],S,x,g,_))}}function h(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=f})(qx)),qx}var KS;function fM(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U4();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Xx)),Xx}var GS;function dM(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L4(),r=fM();function n(i){return i=r.cloneDeep(i),a=>t.isMatch(a,i)}e.matches=n})(Wx)),Wx}var tg={},rg={},ng={},YS;function hM(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U4(),r=$4();function n(i,a){return t.cloneDeepWith(i,(s,l,f,h)=>{const d=a?.(s,l,f,h);if(d!==void 0)return d;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new i.constructor(i?.valueOf());return t.copyProperties(m,i),m}case r.argumentsTag:{const m={};return t.copyProperties(m,i),m.length=i.length,m[Symbol.iterator]=i[Symbol.iterator],m}default:return}})}e.cloneDeepWith=n})(ng)),ng}var XS;function pM(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hM();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(rg)),rg}var ig={},ag={},qS;function z4(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(ag)),ag}var sg={},ZS;function mM(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B4();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(sg)),sg}var QS;function xM(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A4(),r=z4(),n=mM(),i=hy();function a(s,l){let f;if(Array.isArray(l)?f=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?f=i.toPath(l):f=[l],f.length===0)return!1;let h=s;for(let d=0;d<f.length;d++){const m=f[d];if((h==null||!Object.hasOwn(h,m))&&!((Array.isArray(h)||n.isArguments(h))&&r.isIndex(m)&&m<h.length))return!1;h=h[m]}return!0}e.has=a})(ig)),ig}var JS;function gM(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L4(),r=dy(),n=pM(),i=py(),a=xM();function s(l,f){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return f=n.cloneDeep(f),function(h){const d=i.get(h,l);return d===void 0?a.has(h,l):f===void 0?d===void 0:t.isMatch(d,f)}}e.matchesProperty=s})(tg)),tg}var eN;function vM(){return eN||(eN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R4(),r=oM(),n=dM(),i=gM();function a(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=a})(Ux)),Ux}var tN;function yM(){return tN||(tN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nM(),r=R4(),n=sM(),i=vM();function a(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),i.iteratee(l)):[]}e.uniqBy=a})(Rx)),Rx}var og,rN;function wM(){return rN||(rN=1,og=yM().uniqBy),og}var bM=wM();const nN=is(bM);function _M(e,t,r){return t===!0?nN(e,r):typeof t=="function"?nN(e,t):e}var lg={exports:{}},cg={},ug={exports:{}},fg={};var iN;function SM(){if(iN)return fg;iN=1;var e=fc();function t(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,i=e.useEffect,a=e.useLayoutEffect,s=e.useDebugValue;function l(m,x){var g=x(),_=n({inst:{value:g,getSnapshot:x}}),w=_[0].inst,b=_[1];return a(function(){w.value=g,w.getSnapshot=x,f(w)&&b({inst:w})},[m,g,x]),i(function(){return f(w)&&b({inst:w}),m(function(){f(w)&&b({inst:w})})},[m]),s(g),g}function f(m){var x=m.getSnapshot;m=m.value;try{var g=x();return!r(m,g)}catch{return!0}}function h(m,x){return x()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return fg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,fg}var aN;function NM(){return aN||(aN=1,ug.exports=SM()),ug.exports}var sN;function EM(){if(sN)return cg;sN=1;var e=fc(),t=NM();function r(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var n=typeof Object.is=="function"?Object.is:r,i=t.useSyncExternalStore,a=e.useRef,s=e.useEffect,l=e.useMemo,f=e.useDebugValue;return cg.useSyncExternalStoreWithSelector=function(h,d,m,x,g){var _=a(null);if(_.current===null){var w={hasValue:!1,value:null};_.current=w}else w=_.current;_=l(function(){function S(j){if(!T){if(T=!0,E=j,j=x(j),g!==void 0&&w.hasValue){var P=w.value;if(g(P,j))return A=P}return A=j}if(P=A,n(E,j))return P;var M=x(j);return g!==void 0&&g(P,M)?(E=j,P):(E=j,A=M)}var T=!1,E,A,k=m===void 0?null:m;return[function(){return S(d())},k===null?void 0:function(){return S(k())}]},[d,m,x,g]);var b=i(h,_[0],_[1]);return s(function(){w.hasValue=!0,w.value=b},[b]),f(b),b},cg}var oN;function TM(){return oN||(oN=1,lg.exports=EM()),lg.exports}var CM=TM(),gy=v.createContext(null),kM=e=>e,vr=()=>{var e=v.useContext(gy);return e?e.store.dispatch:kM},y0=()=>{},AM=()=>y0,PM=(e,t)=>e===t;function ct(e){var t=v.useContext(gy);return CM.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:AM,t?t.store.getState:y0,t?t.store.getState:y0,t?e:y0,PM)}function jM(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function OM(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function DM(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var lN=e=>Array.isArray(e)?e:[e];function RM(e){const t=Array.isArray(e[0])?e[0]:e;return DM(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function IM(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var FM=class{constructor(e){this.value=e}deref(){return this.value}},MM=typeof WeakRef<"u"?WeakRef:FM,LM=0,cN=1;function Bd(){return{s:LM,v:void 0,o:null,p:null}}function W4(e,t={}){let r=Bd();const{resultEqualityCheck:n}=t;let i,a=0;function s(){let l=r;const{length:f}=arguments;for(let m=0,x=f;m<x;m++){const g=arguments[m];if(typeof g=="function"||typeof g=="object"&&g!==null){let _=l.o;_===null&&(l.o=_=new WeakMap);const w=_.get(g);w===void 0?(l=Bd(),_.set(g,l)):l=w}else{let _=l.p;_===null&&(l.p=_=new Map);const w=_.get(g);w===void 0?(l=Bd(),_.set(g,l)):l=w}}const h=l;let d;if(l.s===cN)d=l.v;else if(d=e.apply(null,arguments),a++,n){const m=i?.deref?.()??i;m!=null&&n(m,d)&&(d=m,a!==0&&a--),i=typeof d=="object"&&d!==null||typeof d=="function"?new MM(d):d}return h.s=cN,h.v=d,d}return s.clearCache=()=>{r=Bd(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function BM(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let a=0,s=0,l,f={},h=i.pop();typeof h=="object"&&(f=h,h=i.pop()),jM(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const d={...r,...f},{memoize:m,memoizeOptions:x=[],argsMemoize:g=W4,argsMemoizeOptions:_=[]}=d,w=lN(x),b=lN(_),S=RM(i),T=m(function(){return a++,h.apply(null,arguments)},...w),E=g(function(){s++;const k=IM(S,arguments);return l=T.apply(null,k),l},...b);return Object.assign(E,{resultFunc:h,memoizedResultFunc:T,dependencies:S,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:m,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Te=BM(W4),$M=Object.assign((e,t=Te)=>{OM(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((s,l,f)=>(s[r[f]]=l,s),{}))},{withTypes:()=>$M}),dg={},hg={},pg={},uN;function UM(){return uN||(uN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=t(n),l=t(i);if(s===l&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?l-s:s-l}return 0};e.compareValues=r})(pg)),pg}var mg={},xg={},fN;function H4(){return fN||(fN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(xg)),xg}var dN;function zM(){return dN||(dN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H4(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}e.isKey=i})(mg)),mg}var hN;function WM(){return hN||(hN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UM(),r=zM(),n=hy();function i(a,s,l,f){if(a==null)return[];l=f?void 0:l,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(g=>String(g));const h=(g,_)=>{let w=g;for(let b=0;b<_.length&&w!=null;++b)w=w[_[b]];return w},d=(g,_)=>_==null||g==null?_:typeof g=="object"&&"key"in g?Object.hasOwn(_,g.key)?_[g.key]:h(_,g.path):typeof g=="function"?g(_):Array.isArray(g)?h(_,g):typeof _=="object"?_[g]:_,m=s.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return a.map(g=>({original:g,criteria:m.map(_=>d(_,g))})).slice().sort((g,_)=>{for(let w=0;w<m.length;w++){const b=t.compareValues(g.criteria[w],_.criteria[w],l[w]);if(b!==0)return b}return 0}).map(g=>g.original)}e.orderBy=i})(hg)),hg}var gg={},pN;function HM(){return pN||(pN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],a=Math.floor(n),s=(l,f)=>{for(let h=0;h<l.length;h++){const d=l[h];Array.isArray(d)&&f<a?s(d,f+1):i.push(d)}};return s(r,0),i}e.flatten=t})(gg)),gg}var vg={},mN;function V4(){return mN||(mN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z4(),r=xy(),n=I4(),i=M4();function a(s,l,f){return n.isObject(f)&&(typeof l=="number"&&r.isArrayLike(f)&&t.isIndex(l)&&l<f.length||typeof l=="string"&&l in f)?i.eq(f[l],s):!1}e.isIterateeCall=a})(vg)),vg}var xN;function VM(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WM(),r=HM(),n=V4();function i(a,...s){const l=s.length;return l>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(a,r.flatten(s),["asc"])}e.sortBy=i})(dg)),dg}var yg,gN;function KM(){return gN||(gN=1,yg=VM().sortBy),yg}var GM=KM();const Wh=is(GM);var K4=e=>e.legend.settings,YM=e=>e.legend.size,XM=e=>e.legend.payload;Te([XM,K4],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Wh(n,r):n});var $d=1;function qM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-t.height)>$d||Math.abs(s.left-t.left)>$d||Math.abs(s.top-t.top)>$d||Math.abs(s.width-t.width)>$d)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function sn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ZM=typeof Symbol=="function"&&Symbol.observable||"@@observable",vN=ZM,wg=()=>Math.random().toString(36).substring(7).split("").join("."),QM={INIT:`@@redux/INIT${wg()}`,REPLACE:`@@redux/REPLACE${wg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${wg()}`},O0=QM;function vy(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function G4(e,t,r){if(typeof e!="function")throw new Error(sn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(sn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(sn(1));return r(G4)(e,t)}let n=e,i=t,a=new Map,s=a,l=0,f=!1;function h(){s===a&&(s=new Map,a.forEach((b,S)=>{s.set(S,b)}))}function d(){if(f)throw new Error(sn(3));return i}function m(b){if(typeof b!="function")throw new Error(sn(4));if(f)throw new Error(sn(5));let S=!0;h();const T=l++;return s.set(T,b),function(){if(S){if(f)throw new Error(sn(6));S=!1,h(),s.delete(T),a=null}}}function x(b){if(!vy(b))throw new Error(sn(7));if(typeof b.type>"u")throw new Error(sn(8));if(typeof b.type!="string")throw new Error(sn(17));if(f)throw new Error(sn(9));try{f=!0,i=n(i,b)}finally{f=!1}return(a=s).forEach(T=>{T()}),b}function g(b){if(typeof b!="function")throw new Error(sn(10));n=b,x({type:O0.REPLACE})}function _(){const b=m;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(sn(11));function T(){const A=S;A.next&&A.next(d())}return T(),{unsubscribe:b(T)}},[vN](){return this}}}return x({type:O0.INIT}),{dispatch:x,subscribe:m,getState:d,replaceReducer:g,[vN]:_}}function JM(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:O0.INIT})>"u")throw new Error(sn(12));if(typeof r(void 0,{type:O0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(sn(13))})}function Y4(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const s=t[a];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let i;try{JM(r)}catch(a){i=a}return function(s={},l){if(i)throw i;let f=!1;const h={};for(let d=0;d<n.length;d++){const m=n[d],x=r[m],g=s[m],_=x(g,l);if(typeof _>"u")throw l&&l.type,new Error(sn(14));h[m]=_,f=f||_!==g}return f=f||n.length!==Object.keys(s).length,f?h:s}}function D0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function e8(...e){return t=>(r,n)=>{const i=t(r,n);let a=()=>{throw new Error(sn(15))};const s={getState:i.getState,dispatch:(f,...h)=>a(f,...h)},l=e.map(f=>f(s));return a=D0(...l)(i.dispatch),{...i,dispatch:a}}}function X4(e){return vy(e)&&"type"in e&&typeof e.type=="string"}var q4=Symbol.for("immer-nothing"),yN=Symbol.for("immer-draftable"),_i=Symbol.for("immer-state");function Ji(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Uu=Object.getPrototypeOf;function Uo(e){return!!e&&!!e[_i]}function Qa(e){return e?Z4(e)||Array.isArray(e)||!!e[yN]||!!e.constructor?.[yN]||uf(e)||Vh(e):!1}var t8=Object.prototype.constructor.toString(),wN=new WeakMap;function Z4(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=wN.get(r);return n===void 0&&(n=Function.toString.call(r),wN.set(r,n)),n===t8}function R0(e,t,r=!0){Hh(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function Hh(e){const t=e[_i];return t?t.type_:Array.isArray(e)?1:uf(e)?2:Vh(e)?3:0}function Wv(e,t){return Hh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Q4(e,t,r){const n=Hh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function r8(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function uf(e){return e instanceof Map}function Vh(e){return e instanceof Set}function Eo(e){return e.copy_||e.base_}function Hv(e,t){if(uf(e))return new Map(e);if(Vh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Z4(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[_i];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(Uu(e),n)}else{const n=Uu(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function yy(e,t=!1){return Kh(e)||Uo(e)||!Qa(e)||(Hh(e)>1&&Object.defineProperties(e,{set:Ud,add:Ud,clear:Ud,delete:Ud}),Object.freeze(e),t&&Object.values(e).forEach(r=>yy(r,!0))),e}function n8(){Ji(2)}var Ud={value:n8};function Kh(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var i8={};function zo(e){const t=i8[e];return t||Ji(0,e),t}var zu;function J4(){return zu}function a8(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function bN(e,t){t&&(zo("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Vv(e){Kv(e),e.drafts_.forEach(s8),e.drafts_=null}function Kv(e){e===zu&&(zu=e.parent_)}function _N(e){return zu=a8(zu,e)}function s8(e){const t=e[_i];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function SN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[_i].modified_&&(Vv(t),Ji(4)),Qa(e)&&(e=I0(t,e),t.parent_||F0(t,e)),t.patches_&&zo("Patches").generateReplacementPatches_(r[_i].base_,e,t.patches_,t.inversePatches_)):e=I0(t,r,[]),Vv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==q4?e:void 0}function I0(e,t,r){if(Kh(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[_i];if(!i)return R0(t,(a,s)=>NN(e,i,t,a,s,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return F0(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const a=i.copy_;let s=a,l=!1;i.type_===3&&(s=new Set(a),a.clear(),l=!0),R0(s,(f,h)=>NN(e,i,a,f,h,r,l),n),F0(e,a,!1),r&&e.patches_&&zo("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function NN(e,t,r,n,i,a,s){if(i==null||typeof i!="object"&&!s)return;const l=Kh(i);if(!(l&&!s)){if(Uo(i)){const f=a&&t&&t.type_!==3&&!Wv(t.assigned_,n)?a.concat(n):void 0,h=I0(e,i,f);if(Q4(r,n,h),Uo(h))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Qa(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&l)return;I0(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(uf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&F0(e,i)}}}function F0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&yy(t,r)}function o8(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:J4(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=wy;r&&(i=[n],a=Wu);const{revoke:s,proxy:l}=Proxy.revocable(i,a);return n.draft_=l,n.revoke_=s,l}var wy={get(e,t){if(t===_i)return e;const r=Eo(e);if(!Wv(r,t))return l8(e,r,t);const n=r[t];return e.finalized_||!Qa(n)?n:n===bg(e.base_,t)?(_g(e),e.copy_[t]=Yv(n,e)):n},has(e,t){return t in Eo(e)},ownKeys(e){return Reflect.ownKeys(Eo(e))},set(e,t,r){const n=eA(Eo(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=bg(Eo(e),t),a=i?.[_i];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(r8(r,i)&&(r!==void 0||Wv(e.base_,t)))return!0;_g(e),Gv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return bg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,_g(e),Gv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Eo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ji(11)},getPrototypeOf(e){return Uu(e.base_)},setPrototypeOf(){Ji(12)}},Wu={};R0(wy,(e,t)=>{Wu[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Wu.deleteProperty=function(e,t){return Wu.set.call(this,e,t,void 0)};Wu.set=function(e,t,r){return wy.set.call(this,e[0],t,r,e[0])};function bg(e,t){const r=e[_i];return(r?Eo(r):e)[t]}function l8(e,t,r){const n=eA(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function eA(e,t){if(!(t in e))return;let r=Uu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Uu(r)}}function Gv(e){e.modified_||(e.modified_=!0,e.parent_&&Gv(e.parent_))}function _g(e){e.copy_||(e.copy_=Hv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var c8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(f=a,...h){return s.produce(f,d=>r.call(this,d,...h))}}typeof r!="function"&&Ji(6),n!==void 0&&typeof n!="function"&&Ji(7);let i;if(Qa(t)){const a=_N(this),s=Yv(t,void 0);let l=!0;try{i=r(s),l=!1}finally{l?Vv(a):Kv(a)}return bN(a,n),SN(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===q4&&(i=void 0),this.autoFreeze_&&yy(i,!0),n){const a=[],s=[];zo("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else Ji(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,f=>t(f,...l));let n,i;return[this.produce(t,r,(s,l)=>{n=s,i=l}),n,i]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Qa(e)||Ji(8),Uo(e)&&(e=Ha(e));const t=_N(this),r=Yv(e,void 0);return r[_i].isManual_=!0,Kv(t),r}finishDraft(e,t){const r=e&&e[_i];(!r||!r.isManual_)&&Ji(9);const{scope_:n}=r;return bN(n,t),SN(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=zo("Patches").applyPatches_;return Uo(e)?n(e,t):this.produce(e,i=>n(i,t))}};function Yv(e,t){const r=uf(e)?zo("MapSet").proxyMap_(e,t):Vh(e)?zo("MapSet").proxySet_(e,t):o8(e,t);return(t?t.scope_:J4()).drafts_.push(r),r}function Ha(e){return Uo(e)||Ji(10,e),tA(e)}function tA(e){if(!Qa(e)||Kh(e))return e;const t=e[_i];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Hv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Hv(e,!0);return R0(r,(i,a)=>{Q4(r,i,tA(a))},n),t&&(t.finalized_=!1),r}var u8=new c8,rA=u8.produce;function nA(e){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,e):i(a)}var f8=nA(),d8=nA,h8=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?D0:D0.apply(null,arguments)};function $i(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(wi(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>X4(n)&&n.type===e,r}var iA=class Nu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Nu.prototype)}static get[Symbol.species](){return Nu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Nu(...t[0].concat(this)):new Nu(...t.concat(this))}};function EN(e){return Qa(e)?rA(e,()=>{}):e}function zd(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function p8(e){return typeof e=="boolean"}var m8=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=t??{};let s=new iA;return r&&(p8(r)?s.push(f8):s.push(d8(r.extraArgument))),s},aA="RTK_autoBatch",Bn=()=>e=>({payload:e,meta:{[aA]:!0}}),TN=e=>t=>{setTimeout(t,e)},sA=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,a=!1,s=!1;const l=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:TN(10):e.type==="callback"?e.queueNotification:TN(e.timeout),h=()=>{s=!1,a&&(a=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>i&&d(),x=n.subscribe(m);return l.add(d),()=>{x(),l.delete(d)}},dispatch(d){try{return i=!d?.meta?.[aA],a=!i,a&&(s||(s=!0,f(h))),n.dispatch(d)}finally{i=!0}}})},x8=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new iA(e);return n&&i.push(sA(typeof n=="object"?n:void 0)),i};function g8(e){const t=m8(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(vy(r))l=Y4(r);else throw new Error(wi(1));let f;typeof n=="function"?f=n(t):f=t();let h=D0;i&&(h=h8({trace:!1,...typeof i=="object"&&i}));const d=e8(...f),m=x8(d);let x=typeof s=="function"?s(m):m();const g=h(...x);return G4(l,a,g)}function oA(e){const t={},r=[];let n;const i={addCase(a,s){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(wi(28));if(l in t)throw new Error(wi(29));return t[l]=s,i},addAsyncThunk(a,s){return s.pending&&(t[a.pending.type]=s.pending),s.rejected&&(t[a.rejected.type]=s.rejected),s.fulfilled&&(t[a.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:a.settled,reducer:s.settled}),i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return e(i),[t,r,n]}function v8(e){return typeof e=="function"}function y8(e,t){let[r,n,i]=oA(t),a;if(v8(e))a=()=>EN(e());else{const l=EN(e);a=()=>l}function s(l=a(),f){let h=[r[f.type],...n.filter(({matcher:d})=>d(f)).map(({reducer:d})=>d)];return h.filter(d=>!!d).length===0&&(h=[i]),h.reduce((d,m)=>{if(m)if(Uo(d)){const g=m(d,f);return g===void 0?d:g}else{if(Qa(d))return rA(d,x=>m(x,f));{const x=m(d,f);if(x===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return d},l)}return s.getInitialState=a,s}var w8="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",b8=(e=21)=>{let t="",r=e;for(;r--;)t+=w8[Math.random()*64|0];return t},_8=Symbol.for("rtk-slice-createasyncthunk");function S8(e,t){return`${e}/${t}`}function N8({creators:e}={}){const t=e?.asyncThunk?.[_8];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(wi(11));const s=(typeof n.reducers=="function"?n.reducers(T8()):n.reducers)||{},l=Object.keys(s),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(E,A){const k=typeof E=="string"?E:E.type;if(!k)throw new Error(wi(12));if(k in f.sliceCaseReducersByType)throw new Error(wi(13));return f.sliceCaseReducersByType[k]=A,h},addMatcher(E,A){return f.sliceMatchers.push({matcher:E,reducer:A}),h},exposeAction(E,A){return f.actionCreators[E]=A,h},exposeCaseReducer(E,A){return f.sliceCaseReducersByName[E]=A,h}};l.forEach(E=>{const A=s[E],k={reducerName:E,type:S8(i,E),createNotation:typeof n.reducers=="function"};k8(A)?P8(k,A,h,t):C8(k,A,h)});function d(){const[E={},A=[],k=void 0]=typeof n.extraReducers=="function"?oA(n.extraReducers):[n.extraReducers],j={...E,...f.sliceCaseReducersByType};return y8(n.initialState,P=>{for(let M in j)P.addCase(M,j[M]);for(let M of f.sliceMatchers)P.addMatcher(M.matcher,M.reducer);for(let M of A)P.addMatcher(M.matcher,M.reducer);k&&P.addDefaultCase(k)})}const m=E=>E,x=new Map,g=new WeakMap;let _;function w(E,A){return _||(_=d()),_(E,A)}function b(){return _||(_=d()),_.getInitialState()}function S(E,A=!1){function k(P){let M=P[E];return typeof M>"u"&&A&&(M=zd(g,k,b)),M}function j(P=m){const M=zd(x,A,()=>new WeakMap);return zd(M,P,()=>{const L={};for(const[B,R]of Object.entries(n.selectors??{}))L[B]=E8(R,P,()=>zd(g,P,b),A);return L})}return{reducerPath:E,getSelectors:j,get selectors(){return j(k)},selectSlice:k}}const T={name:i,reducer:w,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:b,...S(a),injectInto(E,{reducerPath:A,...k}={}){const j=A??a;return E.inject({reducerPath:j,reducer:w},k),{...T,...S(j,!0)}}};return T}}function E8(e,t,r,n){function i(a,...s){let l=t(a);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return i.unwrapped=e,i}var Si=N8();function T8(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function C8({type:e,reducerName:t,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!A8(n))throw new Error(wi(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,s?$i(e,s):$i(e))}function k8(e){return e._reducerDefinitionType==="asyncThunk"}function A8(e){return e._reducerDefinitionType==="reducerWithPrepare"}function P8({type:e,reducerName:t},r,n,i){if(!i)throw new Error(wi(18));const{payloadCreator:a,fulfilled:s,pending:l,rejected:f,settled:h,options:d}=r,m=i(e,a,d);n.exposeAction(t,m),s&&n.addCase(m.fulfilled,s),l&&n.addCase(m.pending,l),f&&n.addCase(m.rejected,f),h&&n.addMatcher(m.settled,h),n.exposeCaseReducer(t,{fulfilled:s||Wd,pending:l||Wd,rejected:f||Wd,settled:h||Wd})}function Wd(){}var j8="task",lA="listener",cA="completed",by="cancelled",O8=`task-${by}`,D8=`task-${cA}`,Xv=`${lA}-${by}`,R8=`${lA}-${cA}`,Gh=class{constructor(e){this.code=e,this.message=`${j8} ${by} (reason: ${e})`}name="TaskAbortError";message},_y=(e,t)=>{if(typeof e!="function")throw new TypeError(wi(32))},M0=()=>{},uA=(e,t=M0)=>(e.catch(t),e),fA=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Oo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Do=e=>{if(e.aborted){const{reason:t}=e;throw new Gh(t)}};function dA(e,t){let r=M0;return new Promise((n,i)=>{const a=()=>i(new Gh(e.reason));if(e.aborted){a();return}r=fA(e,a),t.finally(()=>r()).then(n,i)}).finally(()=>{r=M0})}var I8=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Gh?"cancelled":"rejected",error:r}}finally{t?.()}},L0=e=>t=>uA(dA(e,t).then(r=>(Do(e),r))),hA=e=>{const t=L0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Hl}=Object,CN={},Yh="listenerMiddleware",F8=(e,t)=>{const r=n=>fA(e,()=>Oo(n,e.reason));return(n,i)=>{_y(n);const a=new AbortController;r(a);const s=I8(async()=>{Do(e),Do(a.signal);const l=await n({pause:L0(a.signal),delay:hA(a.signal),signal:a.signal});return Do(a.signal),l},()=>Oo(a,D8));return i?.autoJoin&&t.push(s.catch(M0)),{result:L0(e)(s),cancel(){Oo(a,O8)}}}},M8=(e,t)=>{const r=async(n,i)=>{Do(t);let a=()=>{};const l=[new Promise((f,h)=>{let d=e({predicate:n,effect:(m,x)=>{x.unsubscribe(),f([m,x.getState(),x.getOriginalState()])}});a=()=>{d(),h()}})];i!=null&&l.push(new Promise(f=>setTimeout(f,i,null)));try{const f=await dA(t,Promise.race(l));return Do(t),f}finally{a()}};return(n,i)=>uA(r(n,i))},pA=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=$i(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(wi(21));return _y(a),{predicate:i,type:t,effect:a}},mA=Hl(e=>{const{type:t,predicate:r,effect:n}=pA(e);return{id:b8(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(wi(22))}}},{withTypes:()=>mA}),kN=(e,t)=>{const{type:r,effect:n,predicate:i}=pA(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},qv=e=>{e.pending.forEach(t=>{Oo(t,Xv)})},L8=(e,t)=>()=>{for(const r of t.keys())qv(r);e.clear()},AN=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},xA=Hl($i(`${Yh}/add`),{withTypes:()=>xA}),B8=$i(`${Yh}/removeAll`),gA=Hl($i(`${Yh}/remove`),{withTypes:()=>gA}),$8=(...e)=>{console.error(`${Yh}/error`,...e)},ff=(e={})=>{const t=new Map,r=new Map,n=g=>{const _=r.get(g)??0;r.set(g,_+1)},i=g=>{const _=r.get(g)??1;_===1?r.delete(g):r.set(g,_-1)},{extra:a,onError:s=$8}=e;_y(s);const l=g=>(g.unsubscribe=()=>t.delete(g.id),t.set(g.id,g),_=>{g.unsubscribe(),_?.cancelActive&&qv(g)}),f=g=>{const _=kN(t,g)??mA(g);return l(_)};Hl(f,{withTypes:()=>f});const h=g=>{const _=kN(t,g);return _&&(_.unsubscribe(),g.cancelActive&&qv(_)),!!_};Hl(h,{withTypes:()=>h});const d=async(g,_,w,b)=>{const S=new AbortController,T=M8(f,S.signal),E=[];try{g.pending.add(S),n(g),await Promise.resolve(g.effect(_,Hl({},w,{getOriginalState:b,condition:(A,k)=>T(A,k).then(Boolean),take:T,delay:hA(S.signal),pause:L0(S.signal),extra:a,signal:S.signal,fork:F8(S.signal,E),unsubscribe:g.unsubscribe,subscribe:()=>{t.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((A,k,j)=>{A!==S&&(Oo(A,Xv),j.delete(A))})},cancel:()=>{Oo(S,Xv),g.pending.delete(S)},throwIfCancelled:()=>{Do(S.signal)}})))}catch(A){A instanceof Gh||AN(s,A,{raisedBy:"effect"})}finally{await Promise.all(E),Oo(S,R8),i(g),g.pending.delete(S)}},m=L8(t,r);return{middleware:g=>_=>w=>{if(!X4(w))return _(w);if(xA.match(w))return f(w.payload);if(B8.match(w)){m();return}if(gA.match(w))return h(w.payload);let b=g.getState();const S=()=>{if(b===CN)throw new Error(wi(23));return b};let T;try{if(T=_(w),t.size>0){const E=g.getState(),A=Array.from(t.values());for(const k of A){let j=!1;try{j=k.predicate(w,E,b)}catch(P){j=!1,AN(s,P,{raisedBy:"predicate"})}j&&d(k,w,g,S)}}}finally{b=CN}return T},startListening:f,stopListening:h,clearListeners:m}};function wi(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var U8={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},vA=Si({name:"chartLayout",initialState:U8,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:z8,setLayout:W8,setChartSize:H8,setScale:V8}=vA.actions,K8=vA.reducer;function PN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PN(Object(r),!0).forEach(function(n){G8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G8(e,t,r){return(t=Y8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y8(e){var t=X8(e,"string");return typeof t=="symbol"?t:t+""}function X8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B0=Math.PI/180,q8=e=>e*180/Math.PI,Dr=(e,t,r,n)=>({x:e+Math.cos(-B0*n)*r,y:t+Math.sin(-B0*n)*r}),yA=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Z8=(e,t)=>{var{x:r,y:n}=e,{x:i,y:a}=t;return Math.sqrt((r-i)**2+(n-a)**2)},Q8=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:a}=t,s=Z8({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var l=(r-i)/s,f=Math.acos(l);return n>a&&(f=2*Math.PI-f),{radius:s,angle:q8(f),angleInRadian:f}},J8=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:t-a*360,endAngle:r-a*360}},eL=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return e+s*360},tL=(e,t)=>{var{x:r,y:n}=e,{radius:i,angle:a}=Q8({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(i<s||i>l||i===0)return null;var{startAngle:f,endAngle:h}=J8(t),d=a,m;if(f<=h){for(;d>h;)d-=360;for(;d<f;)d+=360;m=d>=f&&d<=h}else{for(;d>f;)d-=360;for(;d<h;)d+=360;m=d>=h&&d<=f}return m?jN(jN({},t),{},{radius:i,angle:eL(d,t)}):null};function wA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function ON(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ON(Object(r),!0).forEach(function(n){rL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ON(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rL(e,t,r){return(t=nL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nL(e){var t=iL(e,"string");return typeof t=="symbol"?t:t+""}function iL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yt(e,t,r){return sr(e)||sr(t)?r:_a(t)?$o(e,t,r):typeof t=="function"?t(e):r}var aL=(e,t,r,n,i)=>{var a,s=-1,l=(a=t?.length)!==null&&a!==void 0?a:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var f=0;f<l;f++){var h=f>0?r[f-1].coordinate:r[l-1].coordinate,d=r[f].coordinate,m=f>=l-1?r[0].coordinate:r[f+1].coordinate,x=void 0;if(Jr(d-h)!==Jr(m-d)){var g=[];if(Jr(m-d)===Jr(i[1]-i[0])){x=m;var _=d+i[1]-i[0];g[0]=Math.min(_,(_+h)/2),g[1]=Math.max(_,(_+h)/2)}else{x=h;var w=m+i[1]-i[0];g[0]=Math.min(d,(w+d)/2),g[1]=Math.max(d,(w+d)/2)}var b=[Math.min(d,(x+d)/2),Math.max(d,(x+d)/2)];if(e>b[0]&&e<=b[1]||e>=g[0]&&e<=g[1]){({index:s}=r[f]);break}}else{var S=Math.min(h,m),T=Math.max(h,m);if(e>(S+d)/2&&e<=(T+d)/2){({index:s}=r[f]);break}}}else if(t){for(var E=0;E<l;E++)if(E===0&&e<=(t[E].coordinate+t[E+1].coordinate)/2||E>0&&E<l-1&&e>(t[E].coordinate+t[E-1].coordinate)/2&&e<=(t[E].coordinate+t[E+1].coordinate)/2||E===l-1&&e>(t[E].coordinate+t[E-1].coordinate)/2){({index:s}=t[E]);break}}return s},sL=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&a!=="center"&&ft(e[a]))return Fi(Fi({},e),{},{[a]:e[a]+(n||0)});if((l==="horizontal"||l==="vertical"&&a==="center")&&s!=="middle"&&ft(e[s]))return Fi(Fi({},e),{},{[s]:e[s]+(i||0)})}return e},to=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",bA=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var i,a,s=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(a=!0),l.coordinate));return i||s.push(t),a||s.push(r),s},_A=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:l,isCategorical:f,categoricalDomain:h,tickCount:d,ticks:m,niceTicks:x,axisType:g}=e;if(!s)return null;var _=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,w=i==="category"&&s.bandwidth?s.bandwidth()/_:0;if(w=g==="angleAxis"&&a&&a.length>=2?Jr(a[0]-a[1])*2*w:w,m||x){var b=(m||x||[]).map((S,T)=>{var E=n?n.indexOf(S):S;return{coordinate:s(E)+w,value:S,offset:w,index:T}});return b.filter(S=>!Bi(S.coordinate))}return f&&h?h.map((S,T)=>({coordinate:s(S)+w,value:S,index:T,offset:w})):s.ticks&&d!=null?s.ticks(d).map((S,T)=>({coordinate:s(S)+w,value:S,offset:w,index:T})):s.domain().map((S,T)=>({coordinate:s(S)+w,value:n?n[S]:S,index:T,offset:w}))},DN=1e-4,oL=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),i=Math.min(n[0],n[1])-DN,a=Math.max(n[0],n[1])+DN,s=e(t[0]),l=e(t[r-1]);(s<i||s>a||l<i||l>a)&&e.domain([t[0],t[r-1]])}},lL=(e,t)=>{if(!t||t.length!==2||!ft(t[0])||!ft(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!ft(e[0])||e[0]<r)&&(i[0]=r),(!ft(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},cL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,a=0,s=0;s<t;++s){var l=Bi(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1]):(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1])}},uL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,a=0;a<t;++a){var s=Bi(e[a][r][1])?e[a][r][0]:e[a][r][1];s>=0?(e[a][r][0]=i,e[a][r][1]=i+s,i=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},fL={sign:cL,expand:LF,none:tc,silhouette:BF,wiggle:$F,positive:uL},dL=(e,t,r)=>{var n=fL[r],i=MF().keys(t).value((a,s)=>+Yt(a,s,0)).order(Uv).offset(n);return i(e)};function hL(e){return e==null?void 0:String(e)}function RN(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!sr(i[t.dataKey])){var l=j4(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var f=Yt(i,sr(s)?t.dataKey:s);return sr(f)?null:t.scale(f)}var IN=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:a,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=Yt(a,t.dataKey,t.scale.domain()[s]);return sr(l)?null:t.scale(l)-i/2+n},pL=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},mL=e=>{var t=e.flat(2).filter(ft);return[Math.min(...t),Math.max(...t)]},xL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],gL=(e,t,r)=>{if(e!=null)return xL(Object.keys(e).reduce((n,i)=>{var a=e[i],{stackedData:s}=a,l=s.reduce((f,h)=>{var d=wA(h,t,r),m=mL(d);return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},FN=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MN=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Hu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=Wh(t,d=>d.coordinate),a=1/0,s=1,l=i.length;s<l;s++){var f=i[s],h=i[s-1];a=Math.min((f.coordinate||0)-(h.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function LN(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:a}=e;return Fi(Fi({},t),{},{dataKey:r,payload:n,value:i,name:a})}function pc(e,t){if(e)return String(e);if(typeof t=="string")return t}function vL(e,t,r,n,i){if(r==="horizontal"||r==="vertical"){var a=e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height;return a?{x:e,y:t}:null}return n?tL({x:e,y:t},n):null}var yL=(e,t,r,n)=>{var i=t.find(h=>h&&h.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:i.coordinate};if(e==="centric"){var a=i.coordinate,{radius:s}=n;return Fi(Fi(Fi({},n),Dr(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var l=i.coordinate,{angle:f}=n;return Fi(Fi(Fi({},n),Dr(n.cx,n.cy,l,f)),{},{angle:f,radius:l})}return{x:0,y:0}},wL=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,as=e=>e.layout.width,ss=e=>e.layout.height,bL=e=>e.layout.scale,SA=e=>e.layout.margin,Xh=Te(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),qh=Te(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),NA="data-recharts-item-index",EA="data-recharts-item-data-key",df=60;function BN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BN(Object(r),!0).forEach(function(n){_L(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _L(e,t,r){return(t=SL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SL(e){var t=NL(e,"string");return typeof t=="symbol"?t:t+""}function NL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EL=e=>e.brush.height;function TL(e){var t=qh(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:df;return r+i}return r},0)}function CL(e){var t=qh(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:df;return r+i}return r},0)}function kL(e){var t=Xh(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function AL(e){var t=Xh(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Wr=Te([as,ss,SA,EL,TL,CL,kL,AL,K4,YM],(e,t,r,n,i,a,s,l,f,h)=>{var d={left:(r.left||0)+i,right:(r.right||0)+a},m={top:(r.top||0)+s,bottom:(r.bottom||0)+l},x=Hd(Hd({},m),d),g=x.bottom;x.bottom+=n,x=sL(x,f,h);var _=e-x.left-x.right,w=t-x.top-x.bottom;return Hd(Hd({brushBottom:g},x),{},{width:Math.max(_,0),height:Math.max(w,0)})}),PL=Te(Wr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Sy=Te(as,ss,(e,t)=>({x:0,y:0,width:e,height:t})),jL=v.createContext(null),Vn=()=>v.useContext(jL)!=null,Zh=e=>e.brush,Qh=Te([Zh,Wr,SA],(e,t,r)=>({height:e.height,x:ft(e.x)?e.x:t.left,y:ft(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:ft(e.width)?e.width:t.width})),Sg={},Ng={},Eg={},$N;function OL(){return $N||($N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:a}={}){let s,l=null;const f=a!=null&&a.includes("leading"),h=a==null||a.includes("trailing"),d=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},m=()=>{h&&d(),w()};let x=null;const g=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},_=()=>{x!==null&&(clearTimeout(x),x=null)},w=()=>{_(),s=void 0,l=null},b=()=>{d()},S=function(...T){if(i?.aborted)return;s=this,l=T;const E=x==null;g(),f&&E&&d()};return S.schedule=g,S.cancel=w,S.flush=b,i?.addEventListener("abort",w,{once:!0}),S}e.debounce=t})(Eg)),Eg}var UN;function DL(){return UN||(UN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OL();function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:s=!1,trailing:l=!0,maxWait:f}=a,h=Array(2);s&&(h[0]="leading"),l&&(h[1]="trailing");let d,m=null;const x=t.debounce(function(...w){d=n.apply(this,w),m=null},i,{edges:h}),g=function(...w){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(d=n.apply(this,w),m=Date.now(),x.cancel(),x.schedule(),d):(x.apply(this,w),d)},_=()=>(x.flush(),d);return g.cancel=x.cancel,g.flush=_,g}e.debounce=r})(Ng)),Ng}var zN;function RL(){return zN||(zN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DL();function r(n,i=0,a={}){const{leading:s=!0,trailing:l=!0}=a;return t.debounce(n,i,{leading:s,maxWait:i,trailing:l})}e.throttle=r})(Sg)),Sg}var Tg,WN;function IL(){return WN||(WN=1,Tg=RL().throttle),Tg}var FL=IL();const ML=is(FL);var $0=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]},TA=(e,t,r)=>{var{width:n="100%",height:i="100%",aspect:a,maxHeight:s}=r,l=Za(n)?e:Number(n),f=Za(i)?t:Number(i);return a&&a>0&&(l?f=l/a:f&&(l=f*a),s&&f>s&&(f=s)),{calculatedWidth:l,calculatedHeight:f}},LL={width:0,height:0,overflow:"visible"},BL={width:0,overflowX:"visible"},$L={height:0,overflowY:"visible"},UL={},zL=e=>{var{width:t,height:r}=e,n=Za(t),i=Za(r);return n&&i?LL:n?BL:i?$L:UL};function WL(e){var{width:t,height:r,aspect:n}=e,i=t,a=r;return i===void 0&&a===void 0?(i="100%",a="100%"):i===void 0?i=n&&n>0?void 0:"100%":a===void 0&&(a=n&&n>0?void 0:"100%"),{width:i,height:a}}function Pn(e){return Number.isFinite(e)}function rc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function HN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function VN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HN(Object(r),!0).forEach(function(n){HL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HL(e,t,r){return(t=VL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VL(e){var t=KL(e,"string");return typeof t=="symbol"?t:t+""}function KL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CA=v.createContext({width:-1,height:-1});function kA(e){var{children:t,width:r,height:n}=e,i=v.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:v.createElement(CA.Provider,{value:i},t)}var Ny=()=>v.useContext(CA),GL=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i,height:a,minWidth:s=0,minHeight:l,maxHeight:f,children:h,debounce:d=0,id:m,className:x,onResize:g,style:_={}}=e,w=v.useRef(null),b=v.useRef();b.current=g,v.useImperativeHandle(t,()=>w.current);var[S,T]=v.useState({containerWidth:n.width,containerHeight:n.height}),E=v.useCallback((M,L)=>{T(B=>{var R=Math.round(M),U=Math.round(L);return B.containerWidth===R&&B.containerHeight===U?B:{containerWidth:R,containerHeight:U}})},[]);v.useEffect(()=>{var M=U=>{var oe,{width:V,height:ae}=U[0].contentRect;E(V,ae),(oe=b.current)===null||oe===void 0||oe.call(b,V,ae)};d>0&&(M=ML(M,d,{trailing:!0,leading:!1}));var L=new ResizeObserver(M),{width:B,height:R}=w.current.getBoundingClientRect();return E(B,R),L.observe(w.current),()=>{L.disconnect()}},[E,d]);var{containerWidth:A,containerHeight:k}=S;$0(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:P}=TA(A,k,{width:i,height:a,aspect:r,maxHeight:f});return $0(j>0||P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,P,i,a,s,l,r),v.createElement("div",{id:m?"".concat(m):void 0,className:Rt("recharts-responsive-container",x),style:VN(VN({},_),{},{width:i,height:a,minWidth:s,minHeight:l,maxHeight:f}),ref:w},v.createElement("div",{style:zL({width:i,height:a})},v.createElement(kA,{width:j,height:P},h)))}),Qv=v.forwardRef((e,t)=>{var r=Ny();if(rc(r.width)&&rc(r.height))return e.children;var{width:n,height:i}=WL({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:a,calculatedHeight:s}=TA(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return ft(a)&&ft(s)?v.createElement(kA,{width:a,height:s},e.children):v.createElement(GL,Zv({},e,{width:n,height:i,ref:t}))}),Jh=()=>{var e,t=Vn(),r=ct(PL),n=ct(Qh),i=(e=ct(Zh))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},YL={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},AA=()=>{var e;return(e=ct(Wr))!==null&&e!==void 0?e:YL},PA=()=>ct(as),jA=()=>ct(ss),Ct=e=>e.layout.layoutType,ep=()=>ct(Ct),tp=e=>{var t=vr(),r=Vn(),{width:n,height:i}=e,a=Ny(),s=n,l=i;return a&&(s=a.width>0?a.width:n,l=a.height>0?a.height:i),v.useEffect(()=>{!r&&rc(s)&&rc(l)&&t(H8({width:s,height:l}))},[t,r,s,l]),null},XL={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},OA=Si({name:"legend",initialState:XL,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Bn()},removeLegendPayload:{reducer(e,t){var r=Ha(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Bn()}}}),{setLegendSize:Coe,setLegendSettings:koe,addLegendPayload:DA,removeLegendPayload:RA}=OA.actions,qL=OA.reducer;function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jv.apply(null,arguments)}function KN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KN(Object(r),!0).forEach(function(n){ZL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZL(e,t,r){return(t=QL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QL(e){var t=JL(e,"string");return typeof t=="symbol"?t:t+""}function JL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e7(e){return Array.isArray(e)&&_a(e[0])&&_a(e[1])?e.join(" ~ "):e}var t7=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:l,wrapperClassName:f,labelClassName:h,label:d,labelFormatter:m,accessibilityLayer:x=!1}=e,g=()=>{if(a&&a.length){var k={padding:0,margin:0},j=(l?Wh(a,l):a).map((P,M)=>{if(P.type==="none")return null;var L=P.formatter||s||e7,{value:B,name:R}=P,U=B,oe=R;if(L){var V=L(B,R,P,M,a);if(Array.isArray(V))[U,oe]=V;else if(V!=null)U=V;else return null}var ae=Cg({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:ae},_a(oe)?v.createElement("span",{className:"recharts-tooltip-item-name"},oe):null,_a(oe)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},U),v.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:k},j)}return null},_=Cg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),w=Cg({margin:0},i),b=!sr(d),S=b?d:"",T=Rt("recharts-default-tooltip",f),E=Rt("recharts-tooltip-label",h);b&&m&&a!==void 0&&a!==null&&(S=m(d,a));var A=x?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",Jv({className:T,style:_},A),v.createElement("p",{className:E,style:w},v.isValidElement(S)?S:"".concat(S)),g())},hu="recharts-tooltip-wrapper",r7={visibility:"hidden"};function n7(e){var{coordinate:t,translateX:r,translateY:n}=e;return Rt(hu,{["".concat(hu,"-right")]:ft(r)&&t&&ft(t.x)&&r>=t.x,["".concat(hu,"-left")]:ft(r)&&t&&ft(t.x)&&r<t.x,["".concat(hu,"-bottom")]:ft(n)&&t&&ft(t.y)&&n>=t.y,["".concat(hu,"-top")]:ft(n)&&t&&ft(t.y)&&n<t.y})}function GN(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:l,viewBox:f,viewBoxDimension:h}=e;if(a&&ft(a[n]))return a[n];var d=r[n]-l-(i>0?i:0),m=r[n]+i;if(t[n])return s[n]?d:m;var x=f[n];if(x==null)return 0;if(s[n]){var g=d,_=x;return g<_?Math.max(m,x):Math.max(d,x)}if(h==null)return 0;var w=m+l,b=x+h;return w>b?Math.max(d,x):Math.max(m,x)}function i7(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function a7(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:l,viewBox:f}=e,h,d,m;return s.height>0&&s.width>0&&r?(d=GN({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:f,viewBoxDimension:f.width}),m=GN({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:f,viewBoxDimension:f.height}),h=i7({translateX:d,translateY:m,useTranslate3d:l})):h=r7,{cssProperties:h,cssClasses:n7({translateX:d,translateY:m,coordinate:r})}}function YN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YN(Object(r),!0).forEach(function(n){e1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e1(e,t,r){return(t=s7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s7(e){var t=o7(e,"string");return typeof t=="symbol"?t:t+""}function o7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class l7 extends v.PureComponent{constructor(){super(...arguments),e1(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),e1(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:l,isAnimationActive:f,offset:h,position:d,reverseDirection:m,useTranslate3d:x,viewBox:g,wrapperStyle:_,lastBoundingBox:w,innerRef:b,hasPortalFromProps:S}=this.props,{cssClasses:T,cssProperties:E}=a7({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:h,position:d,reverseDirection:m,tooltipBox:{height:w.height,width:w.width},useTranslate3d:x,viewBox:g}),A=S?{}:Vd(Vd({transition:f&&t?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),k=Vd(Vd({},A),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},_);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:k,ref:b},a)}}var c7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ro={devToolsEnabled:!1,isSsr:c7()},IA=()=>ct(e=>e.rootProps.accessibilityLayer);function t1(){return t1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t1.apply(null,arguments)}function XN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XN(Object(r),!0).forEach(function(n){u7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u7(e,t,r){return(t=f7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f7(e){var t=d7(e,"string");return typeof t=="symbol"?t:t+""}function d7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZN={curveBasisClosed:TF,curveBasisOpen:CF,curveBasis:EF,curveBumpX:fF,curveBumpY:dF,curveLinearClosed:kF,curveLinear:$h,curveMonotoneX:AF,curveMonotoneY:PF,curveNatural:jF,curveStep:OF,curveStepAfter:RF,curveStepBefore:DF},Kd=e=>Pn(e.x)&&Pn(e.y),pu=e=>e.x,mu=e=>e.y,h7=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(cf(e));return(r==="curveMonotone"||r==="curveBump")&&t?ZN["".concat(r).concat(t==="vertical"?"Y":"X")]:ZN[r]||$h},p7=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=e,s=h7(t,i),l=a?r.filter(Kd):r,f;if(Array.isArray(n)){var h=a?n.filter(m=>Kd(m)):n,d=l.map((m,x)=>qN(qN({},m),{},{base:h[x]}));return i==="vertical"?f=Ld().y(mu).x1(pu).x0(m=>m.base.x):f=Ld().x(pu).y1(mu).y0(m=>m.base.y),f.defined(Kd).curve(s),f(d)}return i==="vertical"&&ft(n)?f=Ld().y(mu).x1(pu).x0(n):ft(n)?f=Ld().x(pu).y1(mu).y0(n):f=v4().x(pu).y(mu),f.defined(Kd).curve(s),f(l)},Ey=e=>{var{className:t,points:r,path:n,pathRef:i}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?p7(e):n;return v.createElement("path",t1({},bi(e),my(e),{className:Rt("recharts-curve",t),d:a===null?void 0:a,ref:i}))},m7=["x","y","top","left","width","height","className"];function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(null,arguments)}function QN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function x7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QN(Object(r),!0).forEach(function(n){g7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g7(e,t,r){return(t=v7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v7(e){var t=y7(e,"string");return typeof t=="symbol"?t:t+""}function y7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w7(e,t){if(e==null)return{};var r,n,i=b7(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _7=(e,t,r,n,i,a)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),S7=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:l}=e,f=w7(e,m7),h=x7({x:t,y:r,top:n,left:i,width:a,height:s},f);return!ft(t)||!ft(r)||!ft(a)||!ft(s)||!ft(n)||!ft(i)?null:v.createElement("path",r1({},Hn(h),{className:Rt("recharts-cross",l),d:_7(t,r,a,s,n,i)}))};function N7(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function JN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function E7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JN(Object(r),!0).forEach(function(n){T7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T7(e,t,r){return(t=C7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C7(e){var t=k7(e,"string");return typeof t=="symbol"?t:t+""}function k7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pn(e,t){var r=E7({},e),n=t,i=Object.keys(t),a=i.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return a}function A7(){}function P7(e){return e!=null}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){j7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j7(e,t,r){return(t=O7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O7(e){var t=D7(e,"string");return typeof t=="symbol"?t:t+""}function D7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R7=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),FA=(e,t,r)=>e.map(n=>"".concat(R7(n)," ").concat(t,"ms ").concat(r)).join(","),I7=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),Vu=(e,t)=>Object.keys(t).reduce((r,n)=>tE(tE({},r),{},{[n]:e(n,t[n])}),{});function rE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rE(Object(r),!0).forEach(function(n){F7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F7(e,t,r){return(t=M7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7(e){var t=L7(e,"string");return typeof t=="symbol"?t:t+""}function L7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U0=(e,t,r)=>e+(t-e)*r,n1=e=>{var{from:t,to:r}=e;return t!==r},MA=(e,t,r)=>{var n=Vu((i,a)=>{if(n1(a)){var[s,l]=e(a.from,a.to,a.velocity);return ln(ln({},a),{},{from:s,velocity:l})}return a},t);return r<1?Vu((i,a)=>n1(a)?ln(ln({},a),{},{velocity:U0(a.velocity,n[i].velocity,r),from:U0(a.from,n[i].from,r)}):a,t):MA(e,n,r-1)};function B7(e,t,r,n,i,a){var s,l=n.reduce((x,g)=>ln(ln({},x),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),f=()=>Vu((x,g)=>g.from,l),h=()=>!Object.values(l).filter(n1).length,d=null,m=x=>{s||(s=x);var g=x-s,_=g/r.dt;l=MA(r,l,_),i(ln(ln(ln({},e),t),f())),s=x,h()||(d=a.setTimeout(m))};return()=>(d=a.setTimeout(m),()=>{d()})}function $7(e,t,r,n,i,a,s){var l=null,f=i.reduce((m,x)=>ln(ln({},m),{},{[x]:[e[x],t[x]]}),{}),h,d=m=>{h||(h=m);var x=(m-h)/n,g=Vu((w,b)=>U0(...b,r(x)),f);if(a(ln(ln(ln({},e),t),g)),x<1)l=s.setTimeout(d);else{var _=Vu((w,b)=>U0(...b,r(1)),f);a(ln(ln(ln({},e),t),_))}};return()=>(l=s.setTimeout(d),()=>{l()})}const U7=(e,t,r,n,i,a)=>{var s=I7(e,t);return r.isStepper===!0?B7(e,t,r,s,i,a):$7(e,t,r,n,s,i,a)};var z0=1e-4,LA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],BA=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),nE=(e,t)=>r=>{var n=LA(e,t);return BA(n,r)},z7=(e,t)=>r=>{var n=LA(e,t),i=[...n.map((a,s)=>a*s).slice(1),0];return BA(i,r)},iE=function(){for(var t,r,n,i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,i]=[0,0,1,1];break;case"ease":[t,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,i]=[.42,0,1,1];break;case"ease-out":[t,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,i]=[0,0,.58,1];break;default:{var f=s[0].split("(");f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4&&([t,n,r,i]=f[1].split(")")[0].split(",").map(_=>parseFloat(_)))}}else s.length===4&&([t,n,r,i]=s);var h=nE(t,r),d=nE(n,i),m=z7(t,r),x=_=>_>1?1:_<0?0:_,g=_=>{for(var w=_>1?1:_,b=w,S=0;S<8;++S){var T=h(b)-w,E=m(b);if(Math.abs(T-w)<z0||E<z0)return d(b);b=x(b-T/E)}return d(b)};return g.isStepper=!1,g},W7=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,a=(s,l,f)=>{var h=-(s-l)*r,d=f*n,m=f+(h-d)*i/1e3,x=f*i/1e3+s;return Math.abs(x-l)<z0&&Math.abs(m)<z0?[l,0]:[x,m]};return a.isStepper=!0,a.dt=i,a},H7=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return iE(e);case"spring":return W7();default:if(e.split("(")[0]==="cubic-bezier")return iE(e)}return typeof e=="function"?e:null};function V7(e){var t,r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[f,...h]=l;if(typeof f=="number"){i=e.setTimeout(a.bind(null,h),f);return}a(f),i=e.setTimeout(a.bind(null,h));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class K7{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}function G7(){return V7(new K7)}var Y7=v.createContext(G7);function X7(e,t){var r=v.useContext(Y7);return v.useMemo(()=>t??r(e),[e,t,r])}var q7={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},aE={t:0},kg={t:1};function hf(e){var t=pn(e,q7),{isActive:r,canBegin:n,duration:i,easing:a,begin:s,onAnimationEnd:l,onAnimationStart:f,children:h}=t,d=X7(t.animationId,t.animationManager),[m,x]=v.useState(r?aE:kg),g=v.useRef(null);return v.useEffect(()=>{r||x(kg)},[r]),v.useEffect(()=>{if(!r||!n)return A7;var _=U7(aE,kg,H7(a),i,x,d.getTimeoutController()),w=()=>{g.current=_()};return d.start([f,s,w,i,l]),()=>{d.stop(),g.current&&g.current(),l()}},[r,n,i,a,s,f,l,d]),h(m.t)}function pf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef($u(t)),n=v.useRef(e);return n.current!==e&&(r.current=$u(t),n.current=e),r.current}var Z7=["radius"],Q7=["radius"];function sE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sE(Object(r),!0).forEach(function(n){J7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J7(e,t,r){return(t=e9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e9(e){var t=t9(e,"string");return typeof t=="symbol"?t:t+""}function t9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W0.apply(null,arguments)}function lE(e,t){if(e==null)return{};var r,n,i=r9(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function r9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cE=(e,t,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,f=n>=0&&r>=0||n<0&&r<0?1:0,h;if(a>0&&i instanceof Array){for(var d=[0,0,0,0],m=0,x=4;m<x;m++)d[m]=i[m]>a?a:i[m];h="M".concat(e,",").concat(t+s*d[0]),d[0]>0&&(h+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(f,",").concat(e+l*d[0],",").concat(t)),h+="L ".concat(e+r-l*d[1],",").concat(t),d[1]>0&&(h+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(f,`,
        `).concat(e+r,",").concat(t+s*d[1])),h+="L ".concat(e+r,",").concat(t+n-s*d[2]),d[2]>0&&(h+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(f,`,
        `).concat(e+r-l*d[2],",").concat(t+n)),h+="L ".concat(e+l*d[3],",").concat(t+n),d[3]>0&&(h+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(f,`,
        `).concat(e,",").concat(t+n-s*d[3])),h+="Z"}else if(a>0&&i===+i&&i>0){var g=Math.min(a,i);h="M ".concat(e,",").concat(t+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+l*g,",").concat(t,`
            L `).concat(e+r-l*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r,",").concat(t+s*g,`
            L `).concat(e+r,",").concat(t+n-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r-l*g,",").concat(t+n,`
            L `).concat(e+l*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e,",").concat(t+n-s*g," Z")}else h="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return h},n9={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},$A=e=>{var t=pn(e,n9),r=v.useRef(null),[n,i]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var J=r.current.getTotalLength();J&&i(J)}catch{}},[]);var{x:a,y:s,width:l,height:f,radius:h,className:d}=t,{animationEasing:m,animationDuration:x,animationBegin:g,isAnimationActive:_,isUpdateAnimationActive:w}=t,b=v.useRef(l),S=v.useRef(f),T=v.useRef(a),E=v.useRef(s),A=v.useMemo(()=>({x:a,y:s,width:l,height:f,radius:h}),[a,s,l,f,h]),k=pf(A,"rectangle-");if(a!==+a||s!==+s||l!==+l||f!==+f||l===0||f===0)return null;var j=Rt("recharts-rectangle",d);if(!w){var P=Hn(t),{radius:M}=P,L=lE(P,Z7);return v.createElement("path",W0({},L,{radius:typeof h=="number"?h:void 0,className:j,d:cE(a,s,l,f,h)}))}var B=b.current,R=S.current,U=T.current,oe=E.current,V="0px ".concat(n===-1?1:n,"px"),ae="".concat(n,"px 0px"),le=FA(["strokeDasharray"],x,typeof m=="string"?m:void 0);return v.createElement(hf,{animationId:k,key:k,canBegin:n>0,duration:x,easing:m,isActive:w,begin:g},J=>{var re=gr(B,l,J),Z=gr(R,f,J),se=gr(U,a,J),G=gr(oe,s,J);r.current&&(b.current=re,S.current=Z,T.current=se,E.current=G);var ne;_?J>0?ne={transition:le,strokeDasharray:ae}:ne={strokeDasharray:V}:ne={strokeDasharray:ae};var ie=Hn(t),{radius:de}=ie,ge=lE(ie,Q7);return v.createElement("path",W0({},ge,{radius:typeof h=="number"?h:void 0,className:j,d:cE(se,G,re,Z,h),ref:r,style:oE(oE({},ne),t.style)}))})};function UA(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:a}=e,s=Dr(t,r,n,i),l=Dr(t,r,n,a);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(null,arguments)}var i9=(e,t)=>{var r=Jr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Gd=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:l,cornerIsExternal:f}=e,h=l*(s?1:-1)+n,d=Math.asin(l/h)/B0,m=f?i:i+a*d,x=Dr(t,r,h,m),g=Dr(t,r,n,m),_=f?i-a*d:i,w=Dr(t,r,h*Math.cos(d*B0),_);return{center:x,circleTangency:g,lineTangency:w,theta:d}},zA=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=e,l=i9(a,s),f=a+l,h=Dr(t,r,i,a),d=Dr(t,r,i,f),m="M ".concat(h.x,",").concat(h.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(a>f),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var x=Dr(t,r,n,a),g=Dr(t,r,n,f);m+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(a<=f),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},a9=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:l,startAngle:f,endAngle:h}=e,d=Jr(h-f),{circleTangency:m,lineTangency:x,theta:g}=Gd({cx:t,cy:r,radius:i,angle:f,sign:d,cornerRadius:a,cornerIsExternal:l}),{circleTangency:_,lineTangency:w,theta:b}=Gd({cx:t,cy:r,radius:i,angle:h,sign:-d,cornerRadius:a,cornerIsExternal:l}),S=l?Math.abs(f-h):Math.abs(f-h)-g-b;if(S<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):zA({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:f,endAngle:h});var T="M ".concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(S>180),",").concat(+(d<0),",").concat(_.x,",").concat(_.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:A,theta:k}=Gd({cx:t,cy:r,radius:n,angle:f,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),{circleTangency:j,lineTangency:P,theta:M}=Gd({cx:t,cy:r,radius:n,angle:h,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),L=l?Math.abs(f-h):Math.abs(f-h)-k-M;if(L<0&&a===0)return"".concat(T,"L").concat(t,",").concat(r,"Z");T+="L".concat(P.x,",").concat(P.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(j.x,",").concat(j.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(L>180),",").concat(+(d>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(A.x,",").concat(A.y,"Z")}else T+="L".concat(t,",").concat(r,"Z");return T},s9={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},WA=e=>{var t=pn(e,s9),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:f,startAngle:h,endAngle:d,className:m}=t;if(a<i||h===d)return null;var x=Rt("recharts-sector",m),g=a-i,_=Cn(s,g,0,!0),w;return _>0&&Math.abs(h-d)<360?w=a9({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(_,g/2),forceCornerRadius:l,cornerIsExternal:f,startAngle:h,endAngle:d}):w=zA({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:h,endAngle:d}),v.createElement("path",i1({},Hn(t),{className:x,d:w}))};function o9(e,t,r){var n,i,a,s;if(e==="horizontal")n=t.x,a=n,i=r.top,s=r.top+r.height;else if(e==="vertical")i=t.y,s=i,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:f,innerRadius:h,outerRadius:d,angle:m}=t,x=Dr(l,f,h,m),g=Dr(l,f,d,m);n=x.x,i=x.y,a=g.x,s=g.y}else return UA(t);return[{x:n,y:i},{x:a,y:s}]}var Ag={},Pg={},jg={},uE;function l9(){return uE||(uE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H4();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(jg)),jg}var fE;function c9(){return fE||(fE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l9();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Pg)),Pg}var dE;function u9(){return dE||(dE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V4(),r=c9();function n(i,a,s){s&&typeof s!="number"&&t.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((a-i)/(s||1)),0),f=new Array(l);for(let h=0;h<l;h++)f[h]=i,i+=s;return f}e.range=n})(Ag)),Ag}var Og,hE;function f9(){return hE||(hE=1,Og=u9().range),Og}var d9=f9();const HA=is(d9);function zs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function h9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ty(e){let t,r,n;e.length!==2?(t=zs,r=(l,f)=>zs(e(l),f),n=(l,f)=>e(l)-f):(t=e===zs||e===h9?e:p9,r=e,n=e);function i(l,f,h=0,d=l.length){if(h<d){if(t(f,f)!==0)return d;do{const m=h+d>>>1;r(l[m],f)<0?h=m+1:d=m}while(h<d)}return h}function a(l,f,h=0,d=l.length){if(h<d){if(t(f,f)!==0)return d;do{const m=h+d>>>1;r(l[m],f)<=0?h=m+1:d=m}while(h<d)}return h}function s(l,f,h=0,d=l.length){const m=i(l,f,h,d-1);return m>h&&n(l[m-1],f)>-n(l[m],f)?m-1:m}return{left:i,center:s,right:a}}function p9(){return 0}function VA(e){return e===null?NaN:+e}function*m9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const x9=Ty(zs),mf=x9.right;Ty(VA).center;class pE extends Map{constructor(t,r=y9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(mE(this,t))}has(t){return super.has(mE(this,t))}set(t,r){return super.set(g9(this,t),r)}delete(t){return super.delete(v9(this,t))}}function mE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function g9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function v9({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function y9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function w9(e=zs){if(e===zs)return KA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function KA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const b9=Math.sqrt(50),_9=Math.sqrt(10),S9=Math.sqrt(2);function H0(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=b9?10:a>=_9?5:a>=S9?2:1;let l,f,h;return i<0?(h=Math.pow(10,-i)/s,l=Math.round(e*h),f=Math.round(t*h),l/h<e&&++l,f/h>t&&--f,h=-h):(h=Math.pow(10,i)*s,l=Math.round(e/h),f=Math.round(t/h),l*h<e&&++l,f*h>t&&--f),f<l&&.5<=r&&r<2?H0(e,t,r*2):[l,f,h]}function a1(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,s]=n?H0(t,e,r):H0(e,t,r);if(!(a>=i))return[];const l=a-i+1,f=new Array(l);if(n)if(s<0)for(let h=0;h<l;++h)f[h]=(a-h)/-s;else for(let h=0;h<l;++h)f[h]=(a-h)*s;else if(s<0)for(let h=0;h<l;++h)f[h]=(i+h)/-s;else for(let h=0;h<l;++h)f[h]=(i+h)*s;return f}function s1(e,t,r){return t=+t,e=+e,r=+r,H0(e,t,r)[2]}function o1(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?s1(t,e,r):s1(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function xE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function gE(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function GA(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?KA:w9(i);n>r;){if(n-r>600){const f=n-r+1,h=t-r+1,d=Math.log(f),m=.5*Math.exp(2*d/3),x=.5*Math.sqrt(d*m*(f-m)/f)*(h-f/2<0?-1:1),g=Math.max(r,Math.floor(t-h*m/f+x)),_=Math.min(n,Math.floor(t+(f-h)*m/f+x));GA(e,t,g,_,i)}const a=e[t];let s=r,l=n;for(xu(e,r,t),i(e[n],a)>0&&xu(e,r,n);s<l;){for(xu(e,s,l),++s,--l;i(e[s],a)<0;)++s;for(;i(e[l],a)>0;)--l}i(e[r],a)===0?xu(e,r,l):(++l,xu(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function xu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function N9(e,t,r){if(e=Float64Array.from(m9(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return gE(e);if(t>=1)return xE(e);var n,i=(n-1)*t,a=Math.floor(i),s=xE(GA(e,a).subarray(0,a+1)),l=gE(e.subarray(a+1));return s+(l-s)*(i-a)}}function E9(e,t,r=VA){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),s=+r(e[a],a,e),l=+r(e[a+1],a+1,e);return s+(l-s)*(i-a)}}function T9(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function zi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function os(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const l1=Symbol("implicit");function Cy(){var e=new pE,t=[],r=[],n=l1;function i(a){let s=e.get(a);if(s===void 0){if(n!==l1)return n;e.set(a,s=t.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new pE;for(const s of a)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Cy(t,r).unknown(n)},zi.apply(i,arguments),i}function ky(){var e=Cy().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,s,l=!1,f=0,h=0,d=.5;delete e.unknown;function m(){var x=t().length,g=i<n,_=g?i:n,w=g?n:i;a=(w-_)/Math.max(1,x-f+h*2),l&&(a=Math.floor(a)),_+=(w-_-a*(x-f))*d,s=a*(1-f),l&&(_=Math.round(_),s=Math.round(s));var b=T9(x).map(function(S){return _+a*S});return r(g?b.reverse():b)}return e.domain=function(x){return arguments.length?(t(x),m()):t()},e.range=function(x){return arguments.length?([n,i]=x,n=+n,i=+i,m()):[n,i]},e.rangeRound=function(x){return[n,i]=x,n=+n,i=+i,l=!0,m()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(x){return arguments.length?(l=!!x,m()):l},e.padding=function(x){return arguments.length?(f=Math.min(1,h=+x),m()):f},e.paddingInner=function(x){return arguments.length?(f=Math.min(1,x),m()):f},e.paddingOuter=function(x){return arguments.length?(h=+x,m()):h},e.align=function(x){return arguments.length?(d=Math.max(0,Math.min(1,x)),m()):d},e.copy=function(){return ky(t(),[n,i]).round(l).paddingInner(f).paddingOuter(h).align(d)},zi.apply(m(),arguments)}function YA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return YA(t())},e}function C9(){return YA(ky.apply(null,arguments).paddingInner(1))}function Ay(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function XA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function xf(){}var Ku=.7,V0=1/Ku,Vl="\\s*([+-]?\\d+)\\s*",Gu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",k9=/^#([0-9a-f]{3,8})$/,A9=new RegExp(`^rgb\\(${Vl},${Vl},${Vl}\\)$`),P9=new RegExp(`^rgb\\(${wa},${wa},${wa}\\)$`),j9=new RegExp(`^rgba\\(${Vl},${Vl},${Vl},${Gu}\\)$`),O9=new RegExp(`^rgba\\(${wa},${wa},${wa},${Gu}\\)$`),D9=new RegExp(`^hsl\\(${Gu},${wa},${wa}\\)$`),R9=new RegExp(`^hsla\\(${Gu},${wa},${wa},${Gu}\\)$`),vE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ay(xf,Yu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yE,formatHex:yE,formatHex8:I9,formatHsl:F9,formatRgb:wE,toString:wE});function yE(){return this.rgb().formatHex()}function I9(){return this.rgb().formatHex8()}function F9(){return qA(this).formatHsl()}function wE(){return this.rgb().formatRgb()}function Yu(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=k9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?bE(t):r===3?new ni(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Yd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Yd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=A9.exec(e))?new ni(t[1],t[2],t[3],1):(t=P9.exec(e))?new ni(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=j9.exec(e))?Yd(t[1],t[2],t[3],t[4]):(t=O9.exec(e))?Yd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=D9.exec(e))?NE(t[1],t[2]/100,t[3]/100,1):(t=R9.exec(e))?NE(t[1],t[2]/100,t[3]/100,t[4]):vE.hasOwnProperty(e)?bE(vE[e]):e==="transparent"?new ni(NaN,NaN,NaN,0):null}function bE(e){return new ni(e>>16&255,e>>8&255,e&255,1)}function Yd(e,t,r,n){return n<=0&&(e=t=r=NaN),new ni(e,t,r,n)}function M9(e){return e instanceof xf||(e=Yu(e)),e?(e=e.rgb(),new ni(e.r,e.g,e.b,e.opacity)):new ni}function c1(e,t,r,n){return arguments.length===1?M9(e):new ni(e,t,r,n??1)}function ni(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Ay(ni,c1,XA(xf,{brighter(e){return e=e==null?V0:Math.pow(V0,e),new ni(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ku:Math.pow(Ku,e),new ni(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ni(Ro(this.r),Ro(this.g),Ro(this.b),K0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_E,formatHex:_E,formatHex8:L9,formatRgb:SE,toString:SE}));function _E(){return`#${Ao(this.r)}${Ao(this.g)}${Ao(this.b)}`}function L9(){return`#${Ao(this.r)}${Ao(this.g)}${Ao(this.b)}${Ao((isNaN(this.opacity)?1:this.opacity)*255)}`}function SE(){const e=K0(this.opacity);return`${e===1?"rgb(":"rgba("}${Ro(this.r)}, ${Ro(this.g)}, ${Ro(this.b)}${e===1?")":`, ${e})`}`}function K0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ro(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ao(e){return e=Ro(e),(e<16?"0":"")+e.toString(16)}function NE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ea(e,t,r,n)}function qA(e){if(e instanceof ea)return new ea(e.h,e.s,e.l,e.opacity);if(e instanceof xf||(e=Yu(e)),!e)return new ea;if(e instanceof ea)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,l=a-i,f=(a+i)/2;return l?(t===a?s=(r-n)/l+(r<n)*6:r===a?s=(n-t)/l+2:s=(t-r)/l+4,l/=f<.5?a+i:2-a-i,s*=60):l=f>0&&f<1?0:s,new ea(s,l,f,e.opacity)}function B9(e,t,r,n){return arguments.length===1?qA(e):new ea(e,t,r,n??1)}function ea(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Ay(ea,B9,XA(xf,{brighter(e){return e=e==null?V0:Math.pow(V0,e),new ea(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ku:Math.pow(Ku,e),new ea(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ni(Dg(e>=240?e-240:e+120,i,n),Dg(e,i,n),Dg(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ea(EE(this.h),Xd(this.s),Xd(this.l),K0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=K0(this.opacity);return`${e===1?"hsl(":"hsla("}${EE(this.h)}, ${Xd(this.s)*100}%, ${Xd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function EE(e){return e=(e||0)%360,e<0?e+360:e}function Xd(e){return Math.max(0,Math.min(1,e||0))}function Dg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Py=e=>()=>e;function $9(e,t){return function(r){return e+r*t}}function U9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function z9(e){return(e=+e)==1?ZA:function(t,r){return r-t?U9(t,r,e):Py(isNaN(t)?r:t)}}function ZA(e,t){var r=t-e;return r?$9(e,r):Py(isNaN(e)?t:e)}const TE=(function e(t){var r=z9(t);function n(i,a){var s=r((i=c1(i)).r,(a=c1(a)).r),l=r(i.g,a.g),f=r(i.b,a.b),h=ZA(i.opacity,a.opacity);return function(d){return i.r=s(d),i.g=l(d),i.b=f(d),i.opacity=h(d),i+""}}return n.gamma=e,n})(1);function W9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function H9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function V9(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=mc(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(l){for(s=0;s<n;++s)a[s]=i[s](l);return a}}function K9(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function G0(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function G9(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=mc(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var u1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Rg=new RegExp(u1.source,"g");function Y9(e){return function(){return e}}function X9(e){return function(t){return e(t)+""}}function q9(e,t){var r=u1.lastIndex=Rg.lastIndex=0,n,i,a,s=-1,l=[],f=[];for(e=e+"",t=t+"";(n=u1.exec(e))&&(i=Rg.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),l[s]?l[s]+=a:l[++s]=a),(n=n[0])===(i=i[0])?l[s]?l[s]+=i:l[++s]=i:(l[++s]=null,f.push({i:s,x:G0(n,i)})),r=Rg.lastIndex;return r<t.length&&(a=t.slice(r),l[s]?l[s]+=a:l[++s]=a),l.length<2?f[0]?X9(f[0].x):Y9(t):(t=f.length,function(h){for(var d=0,m;d<t;++d)l[(m=f[d]).i]=m.x(h);return l.join("")})}function mc(e,t){var r=typeof t,n;return t==null||r==="boolean"?Py(t):(r==="number"?G0:r==="string"?(n=Yu(t))?(t=n,TE):q9:t instanceof Yu?TE:t instanceof Date?K9:H9(t)?W9:Array.isArray(t)?V9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?G9:G0)(e,t)}function jy(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Z9(e,t){t===void 0&&(t=e,e=mc);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[l](s-l)}}function Q9(e){return function(){return e}}function Y0(e){return+e}var CE=[0,1];function Un(e){return e}function f1(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Q9(isNaN(t)?NaN:.5)}function J9(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function eB(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=f1(i,n),a=r(s,a)):(n=f1(n,i),a=r(a,s)),function(l){return a(n(l))}}function tB(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=f1(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(l){var f=mf(e,l,1,n)-1;return a[f](i[f](l))}}function gf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function rp(){var e=CE,t=CE,r=mc,n,i,a,s=Un,l,f,h;function d(){var x=Math.min(e.length,t.length);return s!==Un&&(s=J9(e[0],e[x-1])),l=x>2?tB:eB,f=h=null,m}function m(x){return x==null||isNaN(x=+x)?a:(f||(f=l(e.map(n),t,r)))(n(s(x)))}return m.invert=function(x){return s(i((h||(h=l(t,e.map(n),G0)))(x)))},m.domain=function(x){return arguments.length?(e=Array.from(x,Y0),d()):e.slice()},m.range=function(x){return arguments.length?(t=Array.from(x),d()):t.slice()},m.rangeRound=function(x){return t=Array.from(x),r=jy,d()},m.clamp=function(x){return arguments.length?(s=x?!0:Un,d()):s!==Un},m.interpolate=function(x){return arguments.length?(r=x,d()):r},m.unknown=function(x){return arguments.length?(a=x,m):a},function(x,g){return n=x,i=g,d()}}function Oy(){return rp()(Un,Un)}function rB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function X0(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function nc(e){return e=X0(Math.abs(e)),e?e[1]:NaN}function nB(e,t){return function(r,n){for(var i=r.length,a=[],s=0,l=e[0],f=0;i>0&&l>0&&(f+l+1>n&&(l=Math.max(1,n-f)),a.push(r.substring(i-=l,i+l)),!((f+=l+1)>n));)l=e[s=(s+1)%e.length];return a.reverse().join(t)}}function iB(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var aB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xu(e){if(!(t=aB.exec(e)))throw new Error("invalid format: "+e);var t;return new Dy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xu.prototype=Dy.prototype;function Dy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sB(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var QA;function oB(e,t){var r=X0(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(QA=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+X0(e,Math.max(0,t+a-1))[0]}function kE(e,t){var r=X0(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const AE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>kE(e*100,t),r:kE,s:oB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function PE(e){return e}var jE=Array.prototype.map,OE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lB(e){var t=e.grouping===void 0||e.thousands===void 0?PE:nB(jE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?PE:iB(jE.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function h(m){m=Xu(m);var x=m.fill,g=m.align,_=m.sign,w=m.symbol,b=m.zero,S=m.width,T=m.comma,E=m.precision,A=m.trim,k=m.type;k==="n"?(T=!0,k="g"):AE[k]||(E===void 0&&(E=12),A=!0,k="g"),(b||x==="0"&&g==="=")&&(b=!0,x="0",g="=");var j=w==="$"?r:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",P=w==="$"?n:/[%p]/.test(k)?s:"",M=AE[k],L=/[defgprs%]/.test(k);E=E===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function B(R){var U=j,oe=P,V,ae,le;if(k==="c")oe=M(R)+oe,R="";else{R=+R;var J=R<0||1/R<0;if(R=isNaN(R)?f:M(Math.abs(R),E),A&&(R=sB(R)),J&&+R==0&&_!=="+"&&(J=!1),U=(J?_==="("?_:l:_==="-"||_==="("?"":_)+U,oe=(k==="s"?OE[8+QA/3]:"")+oe+(J&&_==="("?")":""),L){for(V=-1,ae=R.length;++V<ae;)if(le=R.charCodeAt(V),48>le||le>57){oe=(le===46?i+R.slice(V+1):R.slice(V))+oe,R=R.slice(0,V);break}}}T&&!b&&(R=t(R,1/0));var re=U.length+R.length+oe.length,Z=re<S?new Array(S-re+1).join(x):"";switch(T&&b&&(R=t(Z+R,Z.length?S-oe.length:1/0),Z=""),g){case"<":R=U+R+oe+Z;break;case"=":R=U+Z+R+oe;break;case"^":R=Z.slice(0,re=Z.length>>1)+U+R+oe+Z.slice(re);break;default:R=Z+U+R+oe;break}return a(R)}return B.toString=function(){return m+""},B}function d(m,x){var g=h((m=Xu(m),m.type="f",m)),_=Math.max(-8,Math.min(8,Math.floor(nc(x)/3)))*3,w=Math.pow(10,-_),b=OE[8+_/3];return function(S){return g(w*S)+b}}return{format:h,formatPrefix:d}}var qd,Ry,JA;cB({thousands:",",grouping:[3],currency:["$",""]});function cB(e){return qd=lB(e),Ry=qd.format,JA=qd.formatPrefix,qd}function uB(e){return Math.max(0,-nc(Math.abs(e)))}function fB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nc(t)/3)))*3-nc(Math.abs(e)))}function dB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,nc(t)-nc(e))+1}function eP(e,t,r,n){var i=o1(e,t,r),a;switch(n=Xu(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=fB(i,s))&&(n.precision=a),JA(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=dB(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=uB(i))&&(n.precision=a-(n.type==="%")*2);break}}return Ry(n)}function no(e){var t=e.domain;return e.ticks=function(r){var n=t();return a1(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return eP(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,s=n[i],l=n[a],f,h,d=10;for(l<s&&(h=s,s=l,l=h,h=i,i=a,a=h);d-- >0;){if(h=s1(s,l,r),h===f)return n[i]=s,n[a]=l,t(n);if(h>0)s=Math.floor(s/h)*h,l=Math.ceil(l/h)*h;else if(h<0)s=Math.ceil(s*h)/h,l=Math.floor(l*h)/h;else break;f=h}return e},e}function tP(){var e=Oy();return e.copy=function(){return gf(e,tP())},zi.apply(e,arguments),no(e)}function rP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Y0),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return rP(e).unknown(t)},e=arguments.length?Array.from(e,Y0):[0,1],no(r)}function nP(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),e[r]=t.floor(i),e[n]=t.ceil(a),e}function DE(e){return Math.log(e)}function RE(e){return Math.exp(e)}function hB(e){return-Math.log(-e)}function pB(e){return-Math.exp(-e)}function mB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xB(e){return e===10?mB:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function IE(e){return(t,r)=>-e(-t,r)}function Iy(e){const t=e(DE,RE),r=t.domain;let n=10,i,a;function s(){return i=gB(n),a=xB(n),r()[0]<0?(i=IE(i),a=IE(a),e(hB,pB)):e(DE,RE),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const f=r();let h=f[0],d=f[f.length-1];const m=d<h;m&&([h,d]=[d,h]);let x=i(h),g=i(d),_,w;const b=l==null?10:+l;let S=[];if(!(n%1)&&g-x<b){if(x=Math.floor(x),g=Math.ceil(g),h>0){for(;x<=g;++x)for(_=1;_<n;++_)if(w=x<0?_/a(-x):_*a(x),!(w<h)){if(w>d)break;S.push(w)}}else for(;x<=g;++x)for(_=n-1;_>=1;--_)if(w=x>0?_/a(-x):_*a(x),!(w<h)){if(w>d)break;S.push(w)}S.length*2<b&&(S=a1(h,d,b))}else S=a1(x,g,Math.min(g-x,b)).map(a);return m?S.reverse():S},t.tickFormat=(l,f)=>{if(l==null&&(l=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=Xu(f)).precision==null&&(f.trim=!0),f=Ry(f)),l===1/0)return f;const h=Math.max(1,n*l/t.ticks().length);return d=>{let m=d/a(Math.round(i(d)));return m*n<n-.5&&(m*=n),m<=h?f(d):""}},t.nice=()=>r(nP(r(),{floor:l=>a(Math.floor(i(l))),ceil:l=>a(Math.ceil(i(l)))})),t}function iP(){const e=Iy(rp()).domain([1,10]);return e.copy=()=>gf(e,iP()).base(e.base()),zi.apply(e,arguments),e}function FE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function ME(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Fy(e){var t=1,r=e(FE(t),ME(t));return r.constant=function(n){return arguments.length?e(FE(t=+n),ME(t)):t},no(r)}function aP(){var e=Fy(rp());return e.copy=function(){return gf(e,aP()).constant(e.constant())},zi.apply(e,arguments)}function LE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yB(e){return e<0?-e*e:e*e}function My(e){var t=e(Un,Un),r=1;function n(){return r===1?e(Un,Un):r===.5?e(vB,yB):e(LE(r),LE(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},no(t)}function Ly(){var e=My(rp());return e.copy=function(){return gf(e,Ly()).exponent(e.exponent())},zi.apply(e,arguments),e}function wB(){return Ly.apply(null,arguments).exponent(.5)}function BE(e){return Math.sign(e)*e*e}function bB(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function sP(){var e=Oy(),t=[0,1],r=!1,n;function i(a){var s=bB(e(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return e.invert(BE(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,Y0)).map(BE)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return sP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},zi.apply(i,arguments),no(i)}function oP(){var e=[],t=[],r=[],n;function i(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=E9(e,s/l);return a}function a(s){return s==null||isNaN(s=+s)?n:t[mf(r,s)]}return a.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(zs),i()},a.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return oP().domain(e).range(t).unknown(n)},zi.apply(a,arguments)}function lP(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function s(f){return f!=null&&f<=f?i[mf(n,f,0,r)]:a}function l(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,l()):[e,t]},s.range=function(f){return arguments.length?(r=(i=Array.from(f)).length-1,l()):i.slice()},s.invertExtent=function(f){var h=i.indexOf(f);return h<0?[NaN,NaN]:h<1?[e,n[0]]:h>=r?[n[r-1],t]:[n[h-1],n[h]]},s.unknown=function(f){return arguments.length&&(a=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return lP().domain([e,t]).range(i).unknown(a)},zi.apply(no(s),arguments)}function cP(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[mf(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return cP().domain(e).range(t).unknown(r)},zi.apply(i,arguments)}const Ig=new Date,Fg=new Date;function Hr(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const s=i(a),l=i.ceil(a);return a-s<l-a?s:l},i.offset=(a,s)=>(t(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,l)=>{const f=[];if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<s)||!(l>0))return f;let h;do f.push(h=new Date(+a)),t(a,l),e(a);while(h<a&&a<s);return f},i.filter=a=>Hr(s=>{if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!a(s););else for(;--l>=0;)for(;t(s,1),!a(s););}),r&&(i.count=(a,s)=>(Ig.setTime(+a),Fg.setTime(+s),e(Ig),e(Fg),Math.floor(r(Ig,Fg))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const q0=Hr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);q0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Hr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):q0);q0.range;const za=1e3,Li=za*60,Wa=Li*60,Ja=Wa*24,By=Ja*7,$E=Ja*30,Mg=Ja*365,Po=Hr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*za)},(e,t)=>(t-e)/za,e=>e.getUTCSeconds());Po.range;const $y=Hr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*za)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getMinutes());$y.range;const Uy=Hr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Li)},(e,t)=>(t-e)/Li,e=>e.getUTCMinutes());Uy.range;const zy=Hr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*za-e.getMinutes()*Li)},(e,t)=>{e.setTime(+e+t*Wa)},(e,t)=>(t-e)/Wa,e=>e.getHours());zy.range;const Wy=Hr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Wa)},(e,t)=>(t-e)/Wa,e=>e.getUTCHours());Wy.range;const vf=Hr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Li)/Ja,e=>e.getDate()-1);vf.range;const np=Hr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ja,e=>e.getUTCDate()-1);np.range;const uP=Hr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ja,e=>Math.floor(e/Ja));uP.range;function tl(e){return Hr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Li)/By)}const ip=tl(0),Z0=tl(1),_B=tl(2),SB=tl(3),ic=tl(4),NB=tl(5),EB=tl(6);ip.range;Z0.range;_B.range;SB.range;ic.range;NB.range;EB.range;function rl(e){return Hr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/By)}const ap=rl(0),Q0=rl(1),TB=rl(2),CB=rl(3),ac=rl(4),kB=rl(5),AB=rl(6);ap.range;Q0.range;TB.range;CB.range;ac.range;kB.range;AB.range;const Hy=Hr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Hy.range;const Vy=Hr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Vy.range;const es=Hr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Hr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});es.range;const ts=Hr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Hr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ts.range;function fP(e,t,r,n,i,a){const s=[[Po,1,za],[Po,5,5*za],[Po,15,15*za],[Po,30,30*za],[a,1,Li],[a,5,5*Li],[a,15,15*Li],[a,30,30*Li],[i,1,Wa],[i,3,3*Wa],[i,6,6*Wa],[i,12,12*Wa],[n,1,Ja],[n,2,2*Ja],[r,1,By],[t,1,$E],[t,3,3*$E],[e,1,Mg]];function l(h,d,m){const x=d<h;x&&([h,d]=[d,h]);const g=m&&typeof m.range=="function"?m:f(h,d,m),_=g?g.range(h,+d+1):[];return x?_.reverse():_}function f(h,d,m){const x=Math.abs(d-h)/m,g=Ty(([,,b])=>b).right(s,x);if(g===s.length)return e.every(o1(h/Mg,d/Mg,m));if(g===0)return q0.every(Math.max(o1(h,d,m),1));const[_,w]=s[x/s[g-1][2]<s[g][2]/x?g-1:g];return _.every(w)}return[l,f]}const[PB,jB]=fP(ts,Vy,ap,uP,Wy,Uy),[OB,DB]=fP(es,Hy,ip,vf,zy,$y);function Lg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Bg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function gu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function RB(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,s=e.shortDays,l=e.months,f=e.shortMonths,h=vu(i),d=yu(i),m=vu(a),x=yu(a),g=vu(s),_=yu(s),w=vu(l),b=yu(l),S=vu(f),T=yu(f),E={a:J,A:re,b:Z,B:se,c:null,d:KE,e:KE,f:n$,g:h$,G:m$,H:e$,I:t$,j:r$,L:dP,m:i$,M:a$,p:G,q:ne,Q:XE,s:qE,S:s$,u:o$,U:l$,V:c$,w:u$,W:f$,x:null,X:null,y:d$,Y:p$,Z:x$,"%":YE},A={a:ie,A:de,b:ge,B:Oe,c:null,d:GE,e:GE,f:w$,g:P$,G:O$,H:g$,I:v$,j:y$,L:pP,m:b$,M:_$,p:fe,q:O,Q:XE,s:qE,S:S$,u:N$,U:E$,V:T$,w:C$,W:k$,x:null,X:null,y:A$,Y:j$,Z:D$,"%":YE},k={a:B,A:R,b:U,B:oe,c:V,d:HE,e:HE,f:qB,g:WE,G:zE,H:VE,I:VE,j:KB,L:XB,m:VB,M:GB,p:L,q:HB,Q:QB,s:JB,S:YB,u:BB,U:$B,V:UB,w:LB,W:zB,x:ae,X:le,y:WE,Y:zE,Z:WB,"%":ZB};E.x=j(r,E),E.X=j(n,E),E.c=j(t,E),A.x=j(r,A),A.X=j(n,A),A.c=j(t,A);function j(D,z){return function(H){var te=[],Re=-1,Ee=0,me=D.length,xe,Ce,Le;for(H instanceof Date||(H=new Date(+H));++Re<me;)D.charCodeAt(Re)===37&&(te.push(D.slice(Ee,Re)),(Ce=UE[xe=D.charAt(++Re)])!=null?xe=D.charAt(++Re):Ce=xe==="e"?" ":"0",(Le=z[xe])&&(xe=Le(H,Ce)),te.push(xe),Ee=Re+1);return te.push(D.slice(Ee,Re)),te.join("")}}function P(D,z){return function(H){var te=gu(1900,void 0,1),Re=M(te,D,H+="",0),Ee,me;if(Re!=H.length)return null;if("Q"in te)return new Date(te.Q);if("s"in te)return new Date(te.s*1e3+("L"in te?te.L:0));if(z&&!("Z"in te)&&(te.Z=0),"p"in te&&(te.H=te.H%12+te.p*12),te.m===void 0&&(te.m="q"in te?te.q:0),"V"in te){if(te.V<1||te.V>53)return null;"w"in te||(te.w=1),"Z"in te?(Ee=Bg(gu(te.y,0,1)),me=Ee.getUTCDay(),Ee=me>4||me===0?Q0.ceil(Ee):Q0(Ee),Ee=np.offset(Ee,(te.V-1)*7),te.y=Ee.getUTCFullYear(),te.m=Ee.getUTCMonth(),te.d=Ee.getUTCDate()+(te.w+6)%7):(Ee=Lg(gu(te.y,0,1)),me=Ee.getDay(),Ee=me>4||me===0?Z0.ceil(Ee):Z0(Ee),Ee=vf.offset(Ee,(te.V-1)*7),te.y=Ee.getFullYear(),te.m=Ee.getMonth(),te.d=Ee.getDate()+(te.w+6)%7)}else("W"in te||"U"in te)&&("w"in te||(te.w="u"in te?te.u%7:"W"in te?1:0),me="Z"in te?Bg(gu(te.y,0,1)).getUTCDay():Lg(gu(te.y,0,1)).getDay(),te.m=0,te.d="W"in te?(te.w+6)%7+te.W*7-(me+5)%7:te.w+te.U*7-(me+6)%7);return"Z"in te?(te.H+=te.Z/100|0,te.M+=te.Z%100,Bg(te)):Lg(te)}}function M(D,z,H,te){for(var Re=0,Ee=z.length,me=H.length,xe,Ce;Re<Ee;){if(te>=me)return-1;if(xe=z.charCodeAt(Re++),xe===37){if(xe=z.charAt(Re++),Ce=k[xe in UE?z.charAt(Re++):xe],!Ce||(te=Ce(D,H,te))<0)return-1}else if(xe!=H.charCodeAt(te++))return-1}return te}function L(D,z,H){var te=h.exec(z.slice(H));return te?(D.p=d.get(te[0].toLowerCase()),H+te[0].length):-1}function B(D,z,H){var te=g.exec(z.slice(H));return te?(D.w=_.get(te[0].toLowerCase()),H+te[0].length):-1}function R(D,z,H){var te=m.exec(z.slice(H));return te?(D.w=x.get(te[0].toLowerCase()),H+te[0].length):-1}function U(D,z,H){var te=S.exec(z.slice(H));return te?(D.m=T.get(te[0].toLowerCase()),H+te[0].length):-1}function oe(D,z,H){var te=w.exec(z.slice(H));return te?(D.m=b.get(te[0].toLowerCase()),H+te[0].length):-1}function V(D,z,H){return M(D,t,z,H)}function ae(D,z,H){return M(D,r,z,H)}function le(D,z,H){return M(D,n,z,H)}function J(D){return s[D.getDay()]}function re(D){return a[D.getDay()]}function Z(D){return f[D.getMonth()]}function se(D){return l[D.getMonth()]}function G(D){return i[+(D.getHours()>=12)]}function ne(D){return 1+~~(D.getMonth()/3)}function ie(D){return s[D.getUTCDay()]}function de(D){return a[D.getUTCDay()]}function ge(D){return f[D.getUTCMonth()]}function Oe(D){return l[D.getUTCMonth()]}function fe(D){return i[+(D.getUTCHours()>=12)]}function O(D){return 1+~~(D.getUTCMonth()/3)}return{format:function(D){var z=j(D+="",E);return z.toString=function(){return D},z},parse:function(D){var z=P(D+="",!1);return z.toString=function(){return D},z},utcFormat:function(D){var z=j(D+="",A);return z.toString=function(){return D},z},utcParse:function(D){var z=P(D+="",!0);return z.toString=function(){return D},z}}}var UE={"-":"",_:" ",0:"0"},en=/^\s*\d+/,IB=/^%/,FB=/[\\^$*+?|[\]().{}]/g;function jt(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function MB(e){return e.replace(FB,"\\$&")}function vu(e){return new RegExp("^(?:"+e.map(MB).join("|")+")","i")}function yu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function LB(e,t,r){var n=en.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function BB(e,t,r){var n=en.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function $B(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function UB(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function zB(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function zE(e,t,r){var n=en.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function WE(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function WB(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function HB(e,t,r){var n=en.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function VB(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function HE(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function KB(e,t,r){var n=en.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function VE(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function GB(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function YB(e,t,r){var n=en.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function XB(e,t,r){var n=en.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function qB(e,t,r){var n=en.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZB(e,t,r){var n=IB.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function QB(e,t,r){var n=en.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function JB(e,t,r){var n=en.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function KE(e,t){return jt(e.getDate(),t,2)}function e$(e,t){return jt(e.getHours(),t,2)}function t$(e,t){return jt(e.getHours()%12||12,t,2)}function r$(e,t){return jt(1+vf.count(es(e),e),t,3)}function dP(e,t){return jt(e.getMilliseconds(),t,3)}function n$(e,t){return dP(e,t)+"000"}function i$(e,t){return jt(e.getMonth()+1,t,2)}function a$(e,t){return jt(e.getMinutes(),t,2)}function s$(e,t){return jt(e.getSeconds(),t,2)}function o$(e){var t=e.getDay();return t===0?7:t}function l$(e,t){return jt(ip.count(es(e)-1,e),t,2)}function hP(e){var t=e.getDay();return t>=4||t===0?ic(e):ic.ceil(e)}function c$(e,t){return e=hP(e),jt(ic.count(es(e),e)+(es(e).getDay()===4),t,2)}function u$(e){return e.getDay()}function f$(e,t){return jt(Z0.count(es(e)-1,e),t,2)}function d$(e,t){return jt(e.getFullYear()%100,t,2)}function h$(e,t){return e=hP(e),jt(e.getFullYear()%100,t,2)}function p$(e,t){return jt(e.getFullYear()%1e4,t,4)}function m$(e,t){var r=e.getDay();return e=r>=4||r===0?ic(e):ic.ceil(e),jt(e.getFullYear()%1e4,t,4)}function x$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jt(t/60|0,"0",2)+jt(t%60,"0",2)}function GE(e,t){return jt(e.getUTCDate(),t,2)}function g$(e,t){return jt(e.getUTCHours(),t,2)}function v$(e,t){return jt(e.getUTCHours()%12||12,t,2)}function y$(e,t){return jt(1+np.count(ts(e),e),t,3)}function pP(e,t){return jt(e.getUTCMilliseconds(),t,3)}function w$(e,t){return pP(e,t)+"000"}function b$(e,t){return jt(e.getUTCMonth()+1,t,2)}function _$(e,t){return jt(e.getUTCMinutes(),t,2)}function S$(e,t){return jt(e.getUTCSeconds(),t,2)}function N$(e){var t=e.getUTCDay();return t===0?7:t}function E$(e,t){return jt(ap.count(ts(e)-1,e),t,2)}function mP(e){var t=e.getUTCDay();return t>=4||t===0?ac(e):ac.ceil(e)}function T$(e,t){return e=mP(e),jt(ac.count(ts(e),e)+(ts(e).getUTCDay()===4),t,2)}function C$(e){return e.getUTCDay()}function k$(e,t){return jt(Q0.count(ts(e)-1,e),t,2)}function A$(e,t){return jt(e.getUTCFullYear()%100,t,2)}function P$(e,t){return e=mP(e),jt(e.getUTCFullYear()%100,t,2)}function j$(e,t){return jt(e.getUTCFullYear()%1e4,t,4)}function O$(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ac(e):ac.ceil(e),jt(e.getUTCFullYear()%1e4,t,4)}function D$(){return"+0000"}function YE(){return"%"}function XE(e){return+e}function qE(e){return Math.floor(+e/1e3)}var Pl,xP,gP;R$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function R$(e){return Pl=RB(e),xP=Pl.format,Pl.parse,gP=Pl.utcFormat,Pl.utcParse,Pl}function I$(e){return new Date(e)}function F$(e){return e instanceof Date?+e:+new Date(+e)}function Ky(e,t,r,n,i,a,s,l,f,h){var d=Oy(),m=d.invert,x=d.domain,g=h(".%L"),_=h(":%S"),w=h("%I:%M"),b=h("%I %p"),S=h("%a %d"),T=h("%b %d"),E=h("%B"),A=h("%Y");function k(j){return(f(j)<j?g:l(j)<j?_:s(j)<j?w:a(j)<j?b:n(j)<j?i(j)<j?S:T:r(j)<j?E:A)(j)}return d.invert=function(j){return new Date(m(j))},d.domain=function(j){return arguments.length?x(Array.from(j,F$)):x().map(I$)},d.ticks=function(j){var P=x();return e(P[0],P[P.length-1],j??10)},d.tickFormat=function(j,P){return P==null?k:h(P)},d.nice=function(j){var P=x();return(!j||typeof j.range!="function")&&(j=t(P[0],P[P.length-1],j??10)),j?x(nP(P,j)):d},d.copy=function(){return gf(d,Ky(e,t,r,n,i,a,s,l,f,h))},d}function M$(){return zi.apply(Ky(OB,DB,es,Hy,ip,vf,zy,$y,Po,xP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function L$(){return zi.apply(Ky(PB,jB,ts,Vy,ap,np,Wy,Uy,Po,gP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function sp(){var e=0,t=1,r,n,i,a,s=Un,l=!1,f;function h(m){return m==null||isNaN(m=+m)?f:s(i===0?.5:(m=(a(m)-r)*i,l?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t]=m,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),h):[e,t]},h.clamp=function(m){return arguments.length?(l=!!m,h):l},h.interpolator=function(m){return arguments.length?(s=m,h):s};function d(m){return function(x){var g,_;return arguments.length?([g,_]=x,s=m(g,_),h):[s(0),s(1)]}}return h.range=d(mc),h.rangeRound=d(jy),h.unknown=function(m){return arguments.length?(f=m,h):f},function(m){return a=m,r=m(e),n=m(t),i=r===n?0:1/(n-r),h}}function io(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function vP(){var e=no(sp()(Un));return e.copy=function(){return io(e,vP())},os.apply(e,arguments)}function yP(){var e=Iy(sp()).domain([1,10]);return e.copy=function(){return io(e,yP()).base(e.base())},os.apply(e,arguments)}function wP(){var e=Fy(sp());return e.copy=function(){return io(e,wP()).constant(e.constant())},os.apply(e,arguments)}function Gy(){var e=My(sp());return e.copy=function(){return io(e,Gy()).exponent(e.exponent())},os.apply(e,arguments)}function B$(){return Gy.apply(null,arguments).exponent(.5)}function bP(){var e=[],t=Un;function r(n){if(n!=null&&!isNaN(n=+n))return t((mf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(zs),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>N9(e,a/n))},r.copy=function(){return bP(t).domain(e)},os.apply(r,arguments)}function op(){var e=0,t=.5,r=1,n=1,i,a,s,l,f,h=Un,d,m=!1,x;function g(w){return isNaN(w=+w)?x:(w=.5+((w=+d(w))-a)*(n*w<n*a?l:f),h(m?Math.max(0,Math.min(1,w)):w))}g.domain=function(w){return arguments.length?([e,t,r]=w,i=d(e=+e),a=d(t=+t),s=d(r=+r),l=i===a?0:.5/(a-i),f=a===s?0:.5/(s-a),n=a<i?-1:1,g):[e,t,r]},g.clamp=function(w){return arguments.length?(m=!!w,g):m},g.interpolator=function(w){return arguments.length?(h=w,g):h};function _(w){return function(b){var S,T,E;return arguments.length?([S,T,E]=b,h=Z9(w,[S,T,E]),g):[h(0),h(.5),h(1)]}}return g.range=_(mc),g.rangeRound=_(jy),g.unknown=function(w){return arguments.length?(x=w,g):x},function(w){return d=w,i=w(e),a=w(t),s=w(r),l=i===a?0:.5/(a-i),f=a===s?0:.5/(s-a),n=a<i?-1:1,g}}function _P(){var e=no(op()(Un));return e.copy=function(){return io(e,_P())},os.apply(e,arguments)}function SP(){var e=Iy(op()).domain([.1,1,10]);return e.copy=function(){return io(e,SP()).base(e.base())},os.apply(e,arguments)}function NP(){var e=Fy(op());return e.copy=function(){return io(e,NP()).constant(e.constant())},os.apply(e,arguments)}function Yy(){var e=My(op());return e.copy=function(){return io(e,Yy()).exponent(e.exponent())},os.apply(e,arguments)}function $$(){return Yy.apply(null,arguments).exponent(.5)}const Eu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ky,scaleDiverging:_P,scaleDivergingLog:SP,scaleDivergingPow:Yy,scaleDivergingSqrt:$$,scaleDivergingSymlog:NP,scaleIdentity:rP,scaleImplicit:l1,scaleLinear:tP,scaleLog:iP,scaleOrdinal:Cy,scalePoint:C9,scalePow:Ly,scaleQuantile:oP,scaleQuantize:lP,scaleRadial:sP,scaleSequential:vP,scaleSequentialLog:yP,scaleSequentialPow:Gy,scaleSequentialQuantile:bP,scaleSequentialSqrt:B$,scaleSequentialSymlog:wP,scaleSqrt:wB,scaleSymlog:aP,scaleThreshold:cP,scaleTime:M$,scaleUtc:L$,tickFormat:eP},Symbol.toStringTag,{value:"Module"}));var ao=e=>e.chartData,Xy=Te([ao],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),lp=(e,t,r,n)=>n?Xy(e):ao(e);function Wo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Pn(t)&&Pn(r))return!0}return!1}function ZE(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function EP(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,a;if(Pn(r))i=r;else if(typeof r=="function")return;if(Pn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Wo(s))return s}}function U$(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Wo(n))return ZE(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,a]=e,s,l;if(i==="auto")t!=null&&(s=Math.min(...t));else if(ft(i))s=i;else if(typeof i=="function")try{t!=null&&(s=i(t?.[0]))}catch{}else if(typeof i=="string"&&FN.test(i)){var f=FN.exec(i);if(f==null||t==null)s=void 0;else{var h=+f[1];s=t[0]-h}}else s=t?.[0];if(a==="auto")t!=null&&(l=Math.max(...t));else if(ft(a))l=a;else if(typeof a=="function")try{t!=null&&(l=a(t?.[1]))}catch{}else if(typeof a=="string"&&MN.test(a)){var d=MN.exec(a);if(d==null||t==null)l=void 0;else{var m=+d[1];l=t[1]+m}}else l=t?.[1];var x=[s,l];if(Wo(x))return t==null?x:ZE(x,t,r)}}}var xc=1e9,z$={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Zy,ir=!0,Ui="[DecimalError] ",Io=Ui+"Invalid argument: ",qy=Ui+"Exponent out of range: ",gc=Math.floor,To=Math.pow,W$=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,vi,Zr=1e7,Zt=7,TP=9007199254740991,J0=gc(TP/Zt),it={};it.absoluteValue=it.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};it.comparedTo=it.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};it.decimalPlaces=it.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Zt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};it.dividedBy=it.div=function(e){return Va(this,new this.constructor(e))};it.dividedToIntegerBy=it.idiv=function(e){var t=this,r=t.constructor;return Ht(Va(t,new r(e),0,1),r.precision)};it.equals=it.eq=function(e){return!this.cmp(e)};it.exponent=function(){return Fr(this)};it.greaterThan=it.gt=function(e){return this.cmp(e)>0};it.greaterThanOrEqualTo=it.gte=function(e){return this.cmp(e)>=0};it.isInteger=it.isint=function(){return this.e>this.d.length-2};it.isNegative=it.isneg=function(){return this.s<0};it.isPositive=it.ispos=function(){return this.s>0};it.isZero=function(){return this.s===0};it.lessThan=it.lt=function(e){return this.cmp(e)<0};it.lessThanOrEqualTo=it.lte=function(e){return this.cmp(e)<1};it.logarithm=it.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(vi))throw Error(Ui+"NaN");if(r.s<1)throw Error(Ui+(r.s?"NaN":"-Infinity"));return r.eq(vi)?new n(0):(ir=!1,t=Va(qu(r,a),qu(e,a),a),ir=!0,Ht(t,i))};it.minus=it.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?AP(t,e):CP(t,(e.s=-e.s,e))};it.modulo=it.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Ui+"NaN");return r.s?(ir=!1,t=Va(r,e,0,1).times(e),ir=!0,r.minus(t)):Ht(new n(r),i)};it.naturalExponential=it.exp=function(){return kP(this)};it.naturalLogarithm=it.ln=function(){return qu(this)};it.negated=it.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};it.plus=it.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?CP(t,e):AP(t,(e.s=-e.s,e))};it.precision=it.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Io+e);if(t=Fr(i)+1,n=i.d.length-1,r=n*Zt+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};it.squareRoot=it.sqrt=function(){var e,t,r,n,i,a,s,l=this,f=l.constructor;if(l.s<1){if(!l.s)return new f(0);throw Error(Ui+"NaN")}for(e=Fr(l),ir=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=va(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=gc((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(i.toString()),r=f.precision,i=s=r+3;;)if(a=n,n=a.plus(Va(l,a,s+2)).times(.5),va(a.d).slice(0,s)===(t=va(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),i==s&&t=="4999"){if(Ht(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(t!="9999")break;s+=4}return ir=!0,Ht(n,r)};it.times=it.mul=function(e){var t,r,n,i,a,s,l,f,h,d=this,m=d.constructor,x=d.d,g=(e=new m(e)).d;if(!d.s||!e.s)return new m(0);for(e.s*=d.s,r=d.e+e.e,f=x.length,h=g.length,f<h&&(a=x,x=g,g=a,s=f,f=h,h=s),a=[],s=f+h,n=s;n--;)a.push(0);for(n=h;--n>=0;){for(t=0,i=f+n;i>n;)l=a[i]+g[n]*x[i-n-1]+t,a[i--]=l%Zr|0,t=l/Zr|0;a[i]=(a[i]+t)%Zr|0}for(;!a[--s];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,ir?Ht(e,m.precision):e};it.toDecimalPlaces=it.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Sa(e,0,xc),t===void 0?t=n.rounding:Sa(t,0,8),Ht(r,e+Fr(r)+1,t))};it.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=Ho(n,!0):(Sa(e,0,xc),t===void 0?t=i.rounding:Sa(t,0,8),n=Ht(new i(n),e+1,t),r=Ho(n,!0,e+1)),r};it.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?Ho(i):(Sa(e,0,xc),t===void 0?t=a.rounding:Sa(t,0,8),n=Ht(new a(i),e+Fr(i)+1,t),r=Ho(n.abs(),!1,e+Fr(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};it.toInteger=it.toint=function(){var e=this,t=e.constructor;return Ht(new t(e),Fr(e)+1,t.rounding)};it.toNumber=function(){return+this};it.toPower=it.pow=function(e){var t,r,n,i,a,s,l=this,f=l.constructor,h=12,d=+(e=new f(e));if(!e.s)return new f(vi);if(l=new f(l),!l.s){if(e.s<1)throw Error(Ui+"Infinity");return l}if(l.eq(vi))return l;if(n=f.precision,e.eq(vi))return Ht(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,a=l.s,s){if((r=d<0?-d:d)<=TP){for(i=new f(vi),t=Math.ceil(n/Zt+4),ir=!1;r%2&&(i=i.times(l),JE(i.d,t)),r=gc(r/2),r!==0;)l=l.times(l),JE(l.d,t);return ir=!0,e.s<0?new f(vi).div(i):Ht(i,n)}}else if(a<0)throw Error(Ui+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,ir=!1,i=e.times(qu(l,n+h)),ir=!0,i=kP(i),i.s=a,i};it.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=Fr(i),n=Ho(i,r<=a.toExpNeg||r>=a.toExpPos)):(Sa(e,1,xc),t===void 0?t=a.rounding:Sa(t,0,8),i=Ht(new a(i),e,t),r=Fr(i),n=Ho(i,e<=r||r<=a.toExpNeg,e)),n};it.toSignificantDigits=it.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Sa(e,1,xc),t===void 0?t=n.rounding:Sa(t,0,8)),Ht(new n(r),e,t)};it.toString=it.valueOf=it.val=it.toJSON=it[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Fr(e),r=e.constructor;return Ho(e,t<=r.toExpNeg||t>=r.toExpPos)};function CP(e,t){var r,n,i,a,s,l,f,h,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ir?Ht(t,m):t;if(f=e.d,h=t.d,s=e.e,i=t.e,f=f.slice(),a=s-i,a){for(a<0?(n=f,a=-a,l=h.length):(n=h,i=s,l=f.length),s=Math.ceil(m/Zt),l=s>l?s+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=f.length,a=h.length,l-a<0&&(a=l,n=h,h=f,f=n),r=0;a;)r=(f[--a]=f[a]+h[a]+r)/Zr|0,f[a]%=Zr;for(r&&(f.unshift(r),++i),l=f.length;f[--l]==0;)f.pop();return t.d=f,t.e=i,ir?Ht(t,m):t}function Sa(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Io+e)}function va(e){var t,r,n,i=e.length-1,a="",s=e[0];if(i>0){for(a+=s,t=1;t<i;t++)n=e[t]+"",r=Zt-n.length,r&&(a+=Rs(r)),a+=n;s=e[t],n=s+"",r=Zt-n.length,r&&(a+=Rs(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Va=(function(){function e(n,i){var a,s=0,l=n.length;for(n=n.slice();l--;)a=n[l]*i+s,n[l]=a%Zr|0,s=a/Zr|0;return s&&n.unshift(s),n}function t(n,i,a,s){var l,f;if(a!=s)f=a>s?1:-1;else for(l=f=0;l<a;l++)if(n[l]!=i[l]){f=n[l]>i[l]?1:-1;break}return f}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Zr+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var l,f,h,d,m,x,g,_,w,b,S,T,E,A,k,j,P,M,L=n.constructor,B=n.s==i.s?1:-1,R=n.d,U=i.d;if(!n.s)return new L(n);if(!i.s)throw Error(Ui+"Division by zero");for(f=n.e-i.e,P=U.length,k=R.length,g=new L(B),_=g.d=[],h=0;U[h]==(R[h]||0);)++h;if(U[h]>(R[h]||0)&&--f,a==null?T=a=L.precision:s?T=a+(Fr(n)-Fr(i))+1:T=a,T<0)return new L(0);if(T=T/Zt+2|0,h=0,P==1)for(d=0,U=U[0],T++;(h<k||d)&&T--;h++)E=d*Zr+(R[h]||0),_[h]=E/U|0,d=E%U|0;else{for(d=Zr/(U[0]+1)|0,d>1&&(U=e(U,d),R=e(R,d),P=U.length,k=R.length),A=P,w=R.slice(0,P),b=w.length;b<P;)w[b++]=0;M=U.slice(),M.unshift(0),j=U[0],U[1]>=Zr/2&&++j;do d=0,l=t(U,w,P,b),l<0?(S=w[0],P!=b&&(S=S*Zr+(w[1]||0)),d=S/j|0,d>1?(d>=Zr&&(d=Zr-1),m=e(U,d),x=m.length,b=w.length,l=t(m,w,x,b),l==1&&(d--,r(m,P<x?M:U,x))):(d==0&&(l=d=1),m=U.slice()),x=m.length,x<b&&m.unshift(0),r(w,m,b),l==-1&&(b=w.length,l=t(U,w,P,b),l<1&&(d++,r(w,P<b?M:U,b))),b=w.length):l===0&&(d++,w=[0]),_[h++]=d,l&&w[0]?w[b++]=R[A]||0:(w=[R[A]],b=1);while((A++<k||w[0]!==void 0)&&T--)}return _[0]||_.shift(),g.e=f,Ht(g,s?a+Fr(g)+1:a)}})();function kP(e,t){var r,n,i,a,s,l,f=0,h=0,d=e.constructor,m=d.precision;if(Fr(e)>16)throw Error(qy+Fr(e));if(!e.s)return new d(vi);for(ir=!1,l=m,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),h+=5;for(n=Math.log(To(2,h))/Math.LN10*2+5|0,l+=n,r=i=a=new d(vi),d.precision=l;;){if(i=Ht(i.times(e),l),r=r.times(++f),s=a.plus(Va(i,r,l)),va(s.d).slice(0,l)===va(a.d).slice(0,l)){for(;h--;)a=Ht(a.times(a),l);return d.precision=m,t==null?(ir=!0,Ht(a,m)):a}a=s}}function Fr(e){for(var t=e.e*Zt,r=e.d[0];r>=10;r/=10)t++;return t}function $g(e,t,r){if(t>e.LN10.sd())throw ir=!0,r&&(e.precision=r),Error(Ui+"LN10 precision limit exceeded");return Ht(new e(e.LN10),t)}function Rs(e){for(var t="";e--;)t+="0";return t}function qu(e,t){var r,n,i,a,s,l,f,h,d,m=1,x=10,g=e,_=g.d,w=g.constructor,b=w.precision;if(g.s<1)throw Error(Ui+(g.s?"NaN":"-Infinity"));if(g.eq(vi))return new w(0);if(t==null?(ir=!1,h=b):h=t,g.eq(10))return t==null&&(ir=!0),$g(w,h);if(h+=x,w.precision=h,r=va(_),n=r.charAt(0),a=Fr(g),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=va(g.d),n=r.charAt(0),m++;a=Fr(g),n>1?(g=new w("0."+r),a++):g=new w(n+"."+r.slice(1))}else return f=$g(w,h+2,b).times(a+""),g=qu(new w(n+"."+r.slice(1)),h-x).plus(f),w.precision=b,t==null?(ir=!0,Ht(g,b)):g;for(l=s=g=Va(g.minus(vi),g.plus(vi),h),d=Ht(g.times(g),h),i=3;;){if(s=Ht(s.times(d),h),f=l.plus(Va(s,new w(i),h)),va(f.d).slice(0,h)===va(l.d).slice(0,h))return l=l.times(2),a!==0&&(l=l.plus($g(w,h+2,b).times(a+""))),l=Va(l,new w(m),h),w.precision=b,t==null?(ir=!0,Ht(l,b)):l;l=f,i+=2}}function QE(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=gc(r/Zt),e.d=[],n=(r+1)%Zt,r<0&&(n+=Zt),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=Zt;n<i;)e.d.push(+t.slice(n,n+=Zt));t=t.slice(n),n=Zt-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),ir&&(e.e>J0||e.e<-J0))throw Error(qy+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ht(e,t,r){var n,i,a,s,l,f,h,d,m=e.d;for(s=1,a=m[0];a>=10;a/=10)s++;if(n=t-s,n<0)n+=Zt,i=t,h=m[d=0];else{if(d=Math.ceil((n+1)/Zt),a=m.length,d>=a)return e;for(h=a=m[d],s=1;a>=10;a/=10)s++;n%=Zt,i=n-Zt+s}if(r!==void 0&&(a=To(10,s-i-1),l=h/a%10|0,f=t<0||m[d+1]!==void 0||h%a,f=r<4?(l||f)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||f||r==6&&(n>0?i>0?h/To(10,s-i):0:m[d-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(a=Fr(e),m.length=1,t=t-a-1,m[0]=To(10,(Zt-t%Zt)%Zt),e.e=gc(-t/Zt)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=d,a=1,d--):(m.length=d+1,a=To(10,Zt-n),m[d]=i>0?(h/To(10,s-i)%To(10,i)|0)*a:0),f)for(;;)if(d==0){(m[0]+=a)==Zr&&(m[0]=1,++e.e);break}else{if(m[d]+=a,m[d]!=Zr)break;m[d--]=0,a=1}for(n=m.length;m[--n]===0;)m.pop();if(ir&&(e.e>J0||e.e<-J0))throw Error(qy+Fr(e));return e}function AP(e,t){var r,n,i,a,s,l,f,h,d,m,x=e.constructor,g=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),ir?Ht(t,g):t;if(f=e.d,m=t.d,n=t.e,h=e.e,f=f.slice(),s=h-n,s){for(d=s<0,d?(r=f,s=-s,l=m.length):(r=m,n=h,l=f.length),i=Math.max(Math.ceil(g/Zt),l)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=f.length,l=m.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(f[i]!=m[i]){d=f[i]<m[i];break}s=0}for(d&&(r=f,f=m,m=r,t.s=-t.s),l=f.length,i=m.length-l;i>0;--i)f[l++]=0;for(i=m.length;i>s;){if(f[--i]<m[i]){for(a=i;a&&f[--a]===0;)f[a]=Zr-1;--f[a],f[i]+=Zr}f[i]-=m[i]}for(;f[--l]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,ir?Ht(t,g):t):new x(0)}function Ho(e,t,r){var n,i=Fr(e),a=va(e.d),s=a.length;return t?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+Rs(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Rs(-i-1)+a,r&&(n=r-s)>0&&(a+=Rs(n))):i>=s?(a+=Rs(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+Rs(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=Rs(n))),e.s<0?"-"+a:a}function JE(e,t){if(e.length>t)return e.length=t,!0}function PP(e){var t,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Io+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return QE(s,a.toString())}else if(typeof a!="string")throw Error(Io+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,W$.test(a))QE(s,a);else throw Error(Io+a)}if(i.prototype=it,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=PP,i.config=i.set=H$,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function H$(e){if(!e||typeof e!="object")throw Error(Ui+"Object expected");var t,r,n,i=["precision",1,xc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(gc(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Io+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Io+r+": "+n);return this}var Zy=PP(z$);vi=new Zy(1);const Lt=Zy;var V$=e=>e,jP={},OP=e=>e===jP,eT=e=>function t(){return arguments.length===0||arguments.length===1&&OP(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},DP=(e,t)=>e===1?t:eT(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==jP).length;return a>=e?t(...n):DP(e-a,eT(function(){for(var s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];var h=n.map(d=>OP(d)?l.shift():d);return t(...h,...l)}))}),cp=e=>DP(e.length,e),d1=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},K$=cp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),G$=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return V$;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((l,f)=>f(l),a(...arguments))}},h1=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),RP=e=>{var t=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t&&i.every((s,l)=>{var f;return s===((f=t)===null||f===void 0?void 0:f[l])})||(t=i,r=e(...i)),r}};function IP(e){var t;return e===0?t=1:t=Math.floor(new Lt(e).abs().log(10).toNumber())+1,t}function FP(e,t,r){for(var n=new Lt(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}cp((e,t,r)=>{var n=+e,i=+t;return n+r*(i-n)});cp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});cp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var MP=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},LP=(e,t,r)=>{if(e.lte(0))return new Lt(0);var n=IP(e.toNumber()),i=new Lt(10).pow(n),a=e.div(i),s=n!==1?.05:.1,l=new Lt(Math.ceil(a.div(s).toNumber())).add(r).mul(s),f=l.mul(i);return t?new Lt(f.toNumber()):new Lt(Math.ceil(f.toNumber()))},Y$=(e,t,r)=>{var n=new Lt(1),i=new Lt(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new Lt(10).pow(IP(e)-1),i=new Lt(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new Lt(Math.floor(e)))}else e===0?i=new Lt(Math.floor((t-1)/2)):r||(i=new Lt(Math.floor(e)));var s=Math.floor((t-1)/2),l=G$(K$(f=>i.add(new Lt(f-s).mul(n)).toNumber()),d1);return l(0,t)},BP=function(t,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Lt(0),tickMin:new Lt(0),tickMax:new Lt(0)};var s=LP(new Lt(r).sub(t).div(n-1),i,a),l;t<=0&&r>=0?l=new Lt(0):(l=new Lt(t).add(r).div(2),l=l.sub(new Lt(l).mod(s)));var f=Math.ceil(l.sub(t).div(s).toNumber()),h=Math.ceil(new Lt(r).sub(l).div(s).toNumber()),d=f+h+1;return d>n?BP(t,r,n,i,a+1):(d<n&&(h=r>0?h+(n-d):h,f=r>0?f:f+(n-d)),{step:s,tickMin:l.sub(new Lt(f).mul(s)),tickMax:l.add(new Lt(h).mul(s))})};function X$(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,l]=MP([t,r]);if(s===-1/0||l===1/0){var f=l===1/0?[s,...d1(0,n-1).map(()=>1/0)]:[...d1(0,n-1).map(()=>-1/0),l];return t>r?h1(f):f}if(s===l)return Y$(s,n,i);var{step:h,tickMin:d,tickMax:m}=BP(s,l,a,i,0),x=FP(d,m.add(new Lt(.1).mul(h)),h);return t>r?h1(x):x}function q$(e,t){var[r,n]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=MP([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var l=Math.max(t,2),f=LP(new Lt(s).sub(a).div(l-1),i,0),h=[...FP(new Lt(a),new Lt(s),f),s];return i===!1&&(h=h.map(d=>Math.round(d))),r>n?h1(h):h}var Z$=RP(X$),Q$=RP(q$),$P=e=>e.rootProps.maxBarSize,J$=e=>e.rootProps.barGap,UP=e=>e.rootProps.barCategoryGap,eU=e=>e.rootProps.barSize,yf=e=>e.rootProps.stackOffset,Qy=e=>e.options.chartName,Jy=e=>e.rootProps.syncId,zP=e=>e.rootProps.syncMethod,ew=e=>e.options.eventEmitter,Ma={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},hi={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},up=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},tU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ma.angleAxisId,includeHidden:!1,name:void 0,reversed:Ma.reversed,scale:Ma.scale,tick:Ma.tick,tickCount:void 0,ticks:void 0,type:Ma.type,unit:void 0},rU={allowDataOverflow:hi.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:hi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:hi.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:hi.scale,tick:hi.tick,tickCount:hi.tickCount,ticks:void 0,type:hi.type,unit:void 0},nU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ma.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ma.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ma.scale,tick:Ma.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},iU={allowDataOverflow:hi.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:hi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:hi.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:hi.scale,tick:hi.tick,tickCount:hi.tickCount,ticks:void 0,type:"category",unit:void 0},tw=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?nU:tU,rw=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?iU:rU,fp=e=>e.polarOptions,nw=Te([as,ss,Wr],yA),WP=Te([fp,nw],(e,t)=>{if(e!=null)return Cn(e.innerRadius,t,0)}),HP=Te([fp,nw],(e,t)=>{if(e!=null)return Cn(e.outerRadius,t,t*.8)}),aU=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},VP=Te([fp],aU);Te([tw,VP],up);var KP=Te([nw,WP,HP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Te([rw,KP],up);var GP=Te([Ct,fp,WP,HP,as,ss],(e,t,r,n,i,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:f,endAngle:h}=t;return{cx:Cn(s,i,i/2),cy:Cn(l,a,a/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:h,clockWise:!1}}}),or=(e,t)=>t,wf=(e,t,r)=>r;function iw(e){return e?.id}var Vr=e=>{var t=Ct(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},vc=e=>e.tooltip.settings.axisId,Kr=e=>{var t=Vr(e),r=vc(e);return bf(e,t,r)},YP=Te([Kr],e=>e?.dataKey);function XP(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:a}=r,s=new Map;return e.forEach(l=>{var f,h=(f=l.data)!==null&&f!==void 0?f:n;if(!(h==null||h.length===0)){var d=iw(l);h.forEach((m,x)=>{var g=a==null||i?x:String(Yt(m,a,null)),_=Yt(m,l.dataKey,0),w;s.has(g)?w=s.get(g):w={},Object.assign(w,{[d]:_}),s.set(g,w)})}}),Array.from(s.values())}function dp(e){return e.stackId!=null&&e.dataKey!=null}var hp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function pp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function tT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tT(Object(r),!0).forEach(function(n){sU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sU(e,t,r){return(t=oU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=lU(e,"string");return typeof t=="symbol"?t:t+""}function lU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p1=[0,"auto"],ui={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},qP=(e,t)=>e.cartesianAxis.xAxis[t],ls=(e,t)=>{var r=qP(e,t);return r??ui},fi={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:p1,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:df},ZP=(e,t)=>e.cartesianAxis.yAxis[t],cs=(e,t)=>{var r=ZP(e,t);return r??fi},cU={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},aw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??cU},hr=(e,t,r)=>{switch(t){case"xAxis":return ls(e,r);case"yAxis":return cs(e,r);case"zAxis":return aw(e,r);case"angleAxis":return tw(e,r);case"radiusAxis":return rw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uU=(e,t,r)=>{switch(t){case"xAxis":return ls(e,r);case"yAxis":return cs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},bf=(e,t,r)=>{switch(t){case"xAxis":return ls(e,r);case"yAxis":return cs(e,r);case"angleAxis":return tw(e,r);case"radiusAxis":return rw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},QP=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function sw(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var mp=e=>e.graphicalItems.cartesianItems,fU=Te([or,wf],sw),ow=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),_f=Te([mp,hr,fU],ow,{memoizeOptions:{resultEqualityCheck:pp}}),JP=Te([_f],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(dp)),ej=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),dU=Te([_f],ej),lw=e=>e.map(t=>t.data).filter(Boolean).flat(1),hU=Te([_f],lw,{memoizeOptions:{resultEqualityCheck:pp}}),cw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},uw=Te([hU,lp],cw),fw=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:Yt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:Yt(i,n)}))):e.map(n=>({value:n})),xp=Te([uw,hr,_f],fw);function tj(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function w0(e){if(_a(e)||e instanceof Date){var t=Number(e);if(Pn(t))return t}}function rT(e){if(Array.isArray(e)){var t=[w0(e[0]),w0(e[1])];return Wo(t)?t:void 0}var r=w0(e);if(r!=null)return[r,r]}function yc(e){return e.map(w0).filter(P7)}function pU(e,t,r){return!r||typeof t!="number"||Bi(t)?[]:r.length?yc(r.flatMap(n=>{var i=Yt(e,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!Pn(a)||!Pn(s)))return[t-a,t+s]})):[]}var mU=Te([JP,lp,Kr],XP),rj=(e,t,r)=>{var n={},i=t.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,l]=a,f=l.map(iw);return[s,{stackedData:dL(e,f,r),graphicalItems:l}]}))},m1=Te([mU,JP,yf],rj),nj=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=t;if(n==null&&r!=="zAxis"){var s=gL(e,i,a);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},xU=Te([hr],e=>e.allowDataOverflow),dw=e=>{var t;if(e==null||!("domain"in e))return p1;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=yc(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:p1},hw=Te([hr],dw),pw=Te([hw,xU],EP),gU=Te([m1,ao,or,pw],nj,{memoizeOptions:{resultEqualityCheck:hp}}),gp=e=>e.errorBars,vU=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>tj(r,n)),th=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),l=Math.max(...a);return[s,l]}},mw=(e,t,r,n,i)=>{var a,s;if(r.length>0&&e.forEach(l=>{r.forEach(f=>{var h,d,m=(h=n[f.id])===null||h===void 0?void 0:h.filter(S=>tj(i,S)),x=Yt(l,(d=t.dataKey)!==null&&d!==void 0?d:f.dataKey),g=pU(l,x,m);if(g.length>=2){var _=Math.min(...g),w=Math.max(...g);(a==null||_<a)&&(a=_),(s==null||w>s)&&(s=w)}var b=rT(x);b!=null&&(a=a==null?b[0]:Math.min(a,b[0]),s=s==null?b[1]:Math.max(s,b[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var f=rT(Yt(l,t.dataKey));f!=null&&(a=a==null?f[0]:Math.min(a,f[0]),s=s==null?f[1]:Math.max(s,f[1]))}),Pn(a)&&Pn(s))return[a,s]},yU=Te([uw,hr,dU,gp,or],mw,{memoizeOptions:{resultEqualityCheck:hp}});function wU(e){var{value:t}=e;if(_a(t)||t instanceof Date)return t}var bU=(e,t,r)=>{var n=e.map(wU).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&P4(n))?HA(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},ij=e=>e.referenceElements.dots,wc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),_U=Te([ij,or,wf],wc),aj=e=>e.referenceElements.areas,SU=Te([aj,or,wf],wc),sj=e=>e.referenceElements.lines,NU=Te([sj,or,wf],wc),oj=(e,t)=>{var r=yc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},EU=Te(_U,or,oj),lj=(e,t)=>{var r=yc(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},TU=Te([SU,or],lj),cj=(e,t)=>{var r=yc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},CU=Te(NU,or,cj),kU=Te(EU,CU,TU,(e,t,r)=>th(e,r,t)),xw=(e,t,r,n,i,a,s,l)=>{if(r!=null)return r;var f=s==="vertical"&&l==="xAxis"||s==="horizontal"&&l==="yAxis",h=f?th(n,a,i):th(a,i);return U$(t,h,e.allowDataOverflow)},AU=Te([hr,hw,pw,gU,yU,kU,Ct,or],xw,{memoizeOptions:{resultEqualityCheck:hp}}),PU=[0,1],gw=(e,t,r,n,i,a,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:f}=e,h=to(t,a);return h&&l==null?HA(0,r.length):f==="category"?bU(n,e,h):i==="expand"?PU:s}},vw=Te([hr,Ct,uw,xp,yf,or,AU],gw),uj=(e,t,r,n,i)=>{if(e!=null){var{scale:a,type:s}=e;if(a==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var l="scale".concat(cf(a));return l in Eu?l:"point"}}},bc=Te([hr,Ct,QP,Qy,or],uj);function jU(e){if(e!=null){if(e in Eu)return Eu[e]();var t="scale".concat(cf(e));if(t in Eu)return Eu[t]()}}function yw(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var i=jU(t);if(i!=null){var a=i.domain(r).range(n);return oL(a),a}}}var ww=(e,t,r)=>{var n=dw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Wo(e))return Z$(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Wo(e))return Q$(e,t.tickCount,t.allowDecimals)}},bw=Te([vw,bf,bc],ww),_w=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Wo(t)&&Array.isArray(r)&&r.length>0){var i=t[0],a=r[0],s=t[1],l=r[r.length-1];return[Math.min(i,a),Math.max(s,l)]}return t},OU=Te([hr,vw,bw,or],_w),DU=Te(xp,hr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(yc(e.map(l=>l.value))).sort((l,f)=>l-f);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),fj=Te(DU,Ct,UP,Wr,(e,t,r,n)=>n,(e,t,r,n,i)=>{if(!Pn(e))return 0;var a=t==="vertical"?n.height:n.width;if(i==="gap")return e*a/2;if(i==="no-gap"){var s=Cn(r,e*a),l=e*a/2;return l-s-(l-s)/a*s}return 0}),RU=(e,t)=>{var r=ls(e,t);return r==null||typeof r.padding!="string"?0:fj(e,"xAxis",t,r.padding)},IU=(e,t)=>{var r=cs(e,t);return r==null||typeof r.padding!="string"?0:fj(e,"yAxis",t,r.padding)},FU=Te(ls,RU,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),MU=Te(cs,IU,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),LU=Te([Wr,FU,Qh,Zh,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),BU=Te([Wr,Ct,MU,Qh,Zh,(e,t,r)=>r],(e,t,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Sf=(e,t,r,n)=>{var i;switch(t){case"xAxis":return LU(e,r,n);case"yAxis":return BU(e,r,n);case"zAxis":return(i=aw(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return VP(e);case"radiusAxis":return KP(e,r);default:return}},dj=Te([hr,Sf],up),_c=Te([hr,bc,OU,dj],yw);Te([_f,gp,or],vU);function hj(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var vp=(e,t)=>t,yp=(e,t,r)=>r,$U=Te(Xh,vp,yp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(hj)),UU=Te(qh,vp,yp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(hj)),pj=(e,t)=>({width:e.width,height:t.height}),zU=(e,t)=>{var r=typeof t.width=="number"?t.width:df;return{width:r,height:e.height}},mj=Te(Wr,ls,pj),WU=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},HU=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},VU=Te(ss,Wr,$U,vp,yp,(e,t,r,n,i)=>{var a={},s;return r.forEach(l=>{var f=pj(t,l);s==null&&(s=WU(t,n,e));var h=n==="top"&&!i||n==="bottom"&&i;a[l.id]=s-Number(h)*f.height,s+=(h?-1:1)*f.height}),a}),KU=Te(as,Wr,UU,vp,yp,(e,t,r,n,i)=>{var a={},s;return r.forEach(l=>{var f=zU(t,l);s==null&&(s=HU(t,n,e));var h=n==="left"&&!i||n==="right"&&i;a[l.id]=s-Number(h)*f.width,s+=(h?-1:1)*f.width}),a}),GU=(e,t)=>{var r=ls(e,t);if(r!=null)return VU(e,r.orientation,r.mirror)},YU=Te([Wr,ls,GU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r?.[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),XU=(e,t)=>{var r=cs(e,t);if(r!=null)return KU(e,r.orientation,r.mirror)},qU=Te([Wr,cs,XU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r?.[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),xj=Te(Wr,cs,(e,t)=>{var r=typeof t.width=="number"?t.width:df;return{width:r,height:e.height}}),nT=(e,t,r)=>{switch(t){case"xAxis":return mj(e,r).width;case"yAxis":return xj(e,r).height;default:return}},gj=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,l=to(e,n),f=t.map(h=>h.value);if(s&&l&&a==="category"&&i&&P4(f))return f}},Sw=Te([Ct,xp,hr,or],gj),vj=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=to(e,n);if(s&&(i==="number"||a!=="auto"))return t.map(l=>l.value)}},Nw=Te([Ct,xp,bf,or],vj),iT=Te([Ct,uU,bc,_c,Sw,Nw,Sf,bw,or],(e,t,r,n,i,a,s,l,f)=>{if(t==null)return null;var h=to(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:a,duplicateDomain:i,isCategorical:h,niceTicks:l,range:s,realScaleType:r,scale:n}}),ZU=(e,t,r,n,i,a,s,l,f)=>{if(!(t==null||n==null)){var h=to(e,f),{type:d,ticks:m,tickCount:x}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,_=d==="category"&&n.bandwidth?n.bandwidth()/g:0;_=f==="angleAxis"&&a!=null&&a.length>=2?Jr(a[0]-a[1])*2*_:_;var w=m||i;if(w){var b=w.map((S,T)=>{var E=s?s.indexOf(S):S;return{index:T,coordinate:n(E)+_,value:S,offset:_}});return b.filter(S=>!Bi(S.coordinate))}return h&&l?l.map((S,T)=>({coordinate:n(S)+_,value:S,index:T,offset:_})):n.ticks?n.ticks(x).map(S=>({coordinate:n(S)+_,value:S,offset:_})):n.domain().map((S,T)=>({coordinate:n(S)+_,value:s?s[S]:S,index:T,offset:_}))}},yj=Te([Ct,bf,bc,_c,bw,Sf,Sw,Nw,or],ZU),QU=(e,t,r,n,i,a,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=to(e,s),{tickCount:f}=t,h=0;return h=s==="angleAxis"&&n?.length>=2?Jr(n[0]-n[1])*2*h:h,l&&a?a.map((d,m)=>({coordinate:r(d)+h,value:d,index:m,offset:h})):r.ticks?r.ticks(f).map(d=>({coordinate:r(d)+h,value:d,offset:h})):r.domain().map((d,m)=>({coordinate:r(d)+h,value:i?i[d]:d,index:m,offset:h}))}},Hs=Te([Ct,bf,_c,Sf,Sw,Nw,or],QU),Vs=Te(hr,_c,(e,t)=>{if(!(e==null||t==null))return eh(eh({},e),{},{scale:t})}),JU=Te([hr,bc,vw,dj],yw);Te((e,t,r)=>aw(e,r),JU,(e,t)=>{if(!(e==null||t==null))return eh(eh({},e),{},{scale:t})});var ez=Te([Ct,Xh,qh],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),wj=e=>e.options.defaultTooltipEventType,bj=e=>e.options.validateTooltipEventTypes;function _j(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Ew(e,t){var r=wj(e),n=bj(e);return _j(t,r,n)}function tz(e){return ct(t=>Ew(t,e))}var Sj=(e,t)=>{var r,n=Number(t);if(!(Bi(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},rz=e=>e.tooltip.settings,Ms={active:!1,index:null,dataKey:void 0,coordinate:void 0},nz={itemInteraction:{click:Ms,hover:Ms},axisInteraction:{click:Ms,hover:Ms},keyboardInteraction:Ms,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Nj=Si({name:"tooltip",initialState:nz,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Bn()},removeTooltipEntrySettings:{reducer(e,t){var r=Ha(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Bn()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:iz,removeTooltipEntrySettings:az,setTooltipSettingsState:sz,setActiveMouseOverItemIndex:Ej,mouseLeaveItem:oz,mouseLeaveChart:Tj,setActiveClickItemIndex:lz,setMouseOverAxisIndex:Cj,setMouseClickAxisIndex:cz,setSyncInteraction:x1,setKeyboardInteraction:g1}=Nj.actions,uz=Nj.reducer;function aT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Zd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aT(Object(r),!0).forEach(function(n){fz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fz(e,t,r){return(t=dz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dz(e){var t=hz(e,"string");return typeof t=="symbol"?t:t+""}function hz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pz(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function mz(e){return e.index!=null}var kj=(e,t,r,n)=>{if(t==null)return Ms;var i=pz(e,t,r);if(i==null)return Ms;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(mz(i)){if(a)return Zd(Zd({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Zd(Zd({},Ms),{},{coordinate:i.coordinate})},Tw=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Pn(n))return r;var i=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(i,Math.min(n,a)))},Aj=(e,t,r,n,i,a,s,l)=>{if(!(a==null||l==null)){var f=s[0],h=f==null?void 0:l(f.positions,a);if(h!=null)return h;var d=i?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},Pj=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},Nf=e=>e.options.tooltipPayloadSearcher,Sc=e=>e.tooltip;function sT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sT(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xz(e,t,r){return(t=gz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gz(e){var t=vz(e,"string");return typeof t=="symbol"?t:t+""}function vz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yz(e,t){return e??t}var jj=(e,t,r,n,i,a,s)=>{if(!(t==null||a==null)){var{chartData:l,computedData:f,dataStartIndex:h,dataEndIndex:d}=r,m=[];return e.reduce((x,g)=>{var _,{dataDefinedOnItem:w,settings:b}=g,S=yz(w,l),T=Array.isArray(S)?wA(S,h,d):S,E=(_=b?.dataKey)!==null&&_!==void 0?_:n,A=b?.nameKey,k;if(n&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?k=j4(T,n,i):k=a(T,t,f,A),Array.isArray(k))k.forEach(P=>{var M=oT(oT({},b),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});x.push(LN({tooltipEntrySettings:M,dataKey:P.dataKey,payload:P.payload,value:Yt(P.payload,P.dataKey),name:P.name}))});else{var j;x.push(LN({tooltipEntrySettings:b,dataKey:E,payload:k,value:Yt(k,E),name:(j=Yt(k,A))!==null&&j!==void 0?j:b?.name}))}return x},m)}},Cw=Te([Kr,Ct,QP,Qy,Vr],uj),wz=Te([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),bz=Te([Vr,vc],sw),Ef=Te([wz,Kr,bz],ow,{memoizeOptions:{resultEqualityCheck:pp}}),_z=Te([Ef],e=>e.filter(dp)),Sz=Te([Ef],lw,{memoizeOptions:{resultEqualityCheck:pp}}),Nc=Te([Sz,ao],cw),Nz=Te([_z,ao,Kr],XP),kw=Te([Nc,Kr,Ef],fw),Oj=Te([Kr],dw),Ez=Te([Kr],e=>e.allowDataOverflow),Dj=Te([Oj,Ez],EP),Tz=Te([Ef],e=>e.filter(dp)),Cz=Te([Nz,Tz,yf],rj),kz=Te([Cz,ao,Vr,Dj],nj),Az=Te([Ef],ej),Pz=Te([Nc,Kr,Az,gp,Vr],mw,{memoizeOptions:{resultEqualityCheck:hp}}),jz=Te([ij,Vr,vc],wc),Oz=Te([jz,Vr],oj),Dz=Te([aj,Vr,vc],wc),Rz=Te([Dz,Vr],lj),Iz=Te([sj,Vr,vc],wc),Fz=Te([Iz,Vr],cj),Mz=Te([Oz,Fz,Rz],th),Lz=Te([Kr,Oj,Dj,kz,Pz,Mz,Ct,Vr],xw),Rj=Te([Kr,Ct,Nc,kw,yf,Vr,Lz],gw),Bz=Te([Rj,Kr,Cw],ww),$z=Te([Kr,Rj,Bz,Vr],_w),Ij=e=>{var t=Vr(e),r=vc(e),n=!1;return Sf(e,t,r,n)},Fj=Te([Kr,Ij],up),Mj=Te([Kr,Cw,$z,Fj],yw),Uz=Te([Ct,kw,Kr,Vr],gj),zz=Te([Ct,kw,Kr,Vr],vj),Wz=(e,t,r,n,i,a,s,l)=>{if(t){var{type:f}=t,h=to(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/d:0;return m=l==="angleAxis"&&i!=null&&i?.length>=2?Jr(i[0]-i[1])*2*m:m,h&&s?s.map((x,g)=>({coordinate:n(x)+m,value:x,index:g,offset:m})):n.domain().map((x,g)=>({coordinate:n(x)+m,value:a?a[x]:x,index:g,offset:m}))}}},us=Te([Ct,Kr,Cw,Mj,Ij,Uz,zz,Vr],Wz),Aw=Te([wj,bj,rz],(e,t,r)=>_j(r.shared,e,t)),Lj=e=>e.tooltip.settings.trigger,Pw=e=>e.tooltip.settings.defaultIndex,wp=Te([Sc,Aw,Lj,Pw],kj),Ks=Te([wp,Nc],Tw),Bj=Te([us,Ks],Sj),$j=Te([wp],e=>{if(e)return e.dataKey}),Uj=Te([Sc,Aw,Lj,Pw],Pj),Hz=Te([as,ss,Ct,Wr,us,Pw,Uj,Nf],Aj),Vz=Te([wp,Hz],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Kz=Te([wp],e=>e.active),Gz=Te([Uj,Ks,ao,YP,Bj,Nf,Aw],jj),Yz=Te([Gz],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function lT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lT(Object(r),!0).forEach(function(n){Xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xz(e,t,r){return(t=qz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qz(e){var t=Zz(e,"string");return typeof t=="symbol"?t:t+""}function Zz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qz=()=>ct(Kr),Jz=()=>{var e=Qz(),t=ct(us),r=ct(Mj);return Hu(cT(cT({},e),{},{scale:r}),t)},eW=()=>ct(Qy),jw=(e,t)=>t,zj=(e,t,r)=>r,Ow=(e,t,r,n)=>n,tW=Te(us,e=>Wh(e,t=>t.coordinate)),Dw=Te([Sc,jw,zj,Ow],kj),Wj=Te([Dw,Nc],Tw),rW=(e,t,r)=>{if(t!=null){var n=Sc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Hj=Te([Sc,jw,zj,Ow],Pj),rh=Te([as,ss,Ct,Wr,us,Ow,Hj,Nf],Aj),nW=Te([Dw,rh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),Vj=Te(us,Wj,Sj),iW=Te([Hj,Wj,ao,YP,Vj,Nf,jw],jj),aW=Te([Dw],e=>({isActive:e.active,activeIndex:e.index})),sW=(e,t,r,n,i,a,s,l)=>{if(!(!e||!t||!n||!i||!a)){var f=vL(e.chartX,e.chartY,t,r,l);if(f){var h=wL(f,t),d=aL(h,s,a,n,i),m=yL(t,a,d,f);return{activeIndex:String(d),activeCoordinate:m}}}};function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v1.apply(null,arguments)}function uT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uT(Object(r),!0).forEach(function(n){oW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oW(e,t,r){return(t=lW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lW(e){var t=cW(e,"string");return typeof t=="symbol"?t:t+""}function cW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uW(e){var{coordinate:t,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:l,tooltipEventType:f,chartName:h}=e,d=t,m=r,x=n;if(!l||!d||h!=="ScatterChart"&&f!=="axis")return null;var g,_;if(h==="ScatterChart")g=d,_=S7;else if(h==="BarChart")g=N7(s,d,i,a),_=$A;else if(s==="radial"){var{cx:w,cy:b,radius:S,startAngle:T,endAngle:E}=UA(d);g={cx:w,cy:b,startAngle:T,endAngle:E,innerRadius:S,outerRadius:S},_=WA}else g={points:o9(s,d,i)},_=Ey;var A=typeof l=="object"&&"className"in l?l.className:void 0,k=Qd(Qd(Qd(Qd({stroke:"#ccc",pointerEvents:"none"},i),g),Bo(l)),{},{payload:m,payloadIndex:x,className:Rt("recharts-tooltip-cursor",A)});return v.isValidElement(l)?v.cloneElement(l,k):v.createElement(_,k)}function fW(e){var t=Jz(),r=AA(),n=ep(),i=eW();return v.createElement(uW,v1({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var Kj=v.createContext(null),dW=()=>v.useContext(Kj),Ug={exports:{}},fT;function hW(){return fT||(fT=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(f,h,d){this.fn=f,this.context=h,this.once=d||!1}function a(f,h,d,m,x){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new i(d,m||f,x),_=r?r+h:h;return f._events[_]?f._events[_].fn?f._events[_]=[f._events[_],g]:f._events[_].push(g):(f._events[_]=g,f._eventsCount++),f}function s(f,h){--f._eventsCount===0?f._events=new n:delete f._events[h]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],d,m;if(this._eventsCount===0)return h;for(m in d=this._events)t.call(d,m)&&h.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},l.prototype.listeners=function(h){var d=r?r+h:h,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,g=m.length,_=new Array(g);x<g;x++)_[x]=m[x].fn;return _},l.prototype.listenerCount=function(h){var d=r?r+h:h,m=this._events[d];return m?m.fn?1:m.length:0},l.prototype.emit=function(h,d,m,x,g,_){var w=r?r+h:h;if(!this._events[w])return!1;var b=this._events[w],S=arguments.length,T,E;if(b.fn){switch(b.once&&this.removeListener(h,b.fn,void 0,!0),S){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,d),!0;case 3:return b.fn.call(b.context,d,m),!0;case 4:return b.fn.call(b.context,d,m,x),!0;case 5:return b.fn.call(b.context,d,m,x,g),!0;case 6:return b.fn.call(b.context,d,m,x,g,_),!0}for(E=1,T=new Array(S-1);E<S;E++)T[E-1]=arguments[E];b.fn.apply(b.context,T)}else{var A=b.length,k;for(E=0;E<A;E++)switch(b[E].once&&this.removeListener(h,b[E].fn,void 0,!0),S){case 1:b[E].fn.call(b[E].context);break;case 2:b[E].fn.call(b[E].context,d);break;case 3:b[E].fn.call(b[E].context,d,m);break;case 4:b[E].fn.call(b[E].context,d,m,x);break;default:if(!T)for(k=1,T=new Array(S-1);k<S;k++)T[k-1]=arguments[k];b[E].fn.apply(b[E].context,T)}}return!0},l.prototype.on=function(h,d,m){return a(this,h,d,m,!1)},l.prototype.once=function(h,d,m){return a(this,h,d,m,!0)},l.prototype.removeListener=function(h,d,m,x){var g=r?r+h:h;if(!this._events[g])return this;if(!d)return s(this,g),this;var _=this._events[g];if(_.fn)_.fn===d&&(!x||_.once)&&(!m||_.context===m)&&s(this,g);else{for(var w=0,b=[],S=_.length;w<S;w++)(_[w].fn!==d||x&&!_[w].once||m&&_[w].context!==m)&&b.push(_[w]);b.length?this._events[g]=b.length===1?b[0]:b:s(this,g)}return this},l.prototype.removeAllListeners=function(h){var d;return h?(d=r?r+h:h,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Ug)),Ug.exports}var pW=hW();const mW=is(pW);var Zu=new mW,y1="recharts.syncEvent.tooltip",dT="recharts.syncEvent.brush";function Rw(e,t){if(t){var r=Number.parseInt(t,10);if(!Bi(r))return e?.[r]}}var xW={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Gj=Si({name:"options",initialState:xW,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),gW=Gj.reducer,{createEventEmitter:vW}=Gj.actions;function yW(e){return e.tooltip.syncInteraction}var wW={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Yj=Si({name:"chartData",initialState:wW,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:hT,setDataStartEndIndexes:bW,setComputedData:Aoe}=Yj.actions,_W=Yj.reducer,SW=["x","y"];function pT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pT(Object(r),!0).forEach(function(n){NW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NW(e,t,r){return(t=EW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EW(e){var t=TW(e,"string");return typeof t=="symbol"?t:t+""}function TW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CW(e,t){if(e==null)return{};var r,n,i=kW(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function kW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xj=()=>{};function AW(){var e=ct(Jy),t=ct(ew),r=vr(),n=ct(zP),i=ct(us),a=ep(),s=Jh(),l=ct(f=>f.rootProps.className);v.useEffect(()=>{if(e==null)return Xj;var f=(h,d,m)=>{if(t!==m&&e===h){if(n==="index"){var x;if(s&&d!==null&&d!==void 0&&(x=d.payload)!==null&&x!==void 0&&x.coordinate&&d.payload.sourceViewBox){var g=d.payload.coordinate,{x:_,y:w}=g,b=CW(g,SW),{x:S,y:T,width:E,height:A}=d.payload.sourceViewBox,k=jl(jl({},b),{},{x:s.x+(E?(_-S)/E:0)*s.width,y:s.y+(A?(w-T)/A:0)*s.height});r(jl(jl({},d),{},{payload:jl(jl({},d.payload),{},{coordinate:k})}))}else r(d);return}if(i!=null){var j;if(typeof n=="function"){var P={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},M=n(i,P);j=i[M]}else n==="value"&&(j=i.find(le=>String(le.value)===d.payload.label));var{coordinate:L}=d.payload;if(j==null||d.payload.active===!1||L==null||s==null){r(x1({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:B,y:R}=L,U=Math.min(B,s.x+s.width),oe=Math.min(R,s.y+s.height),V={x:a==="horizontal"?j.coordinate:U,y:a==="horizontal"?oe:j.coordinate},ae=x1({active:d.payload.active,coordinate:V,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox});r(ae)}}};return Zu.on(y1,f),()=>{Zu.off(y1,f)}},[l,r,t,e,n,i,a,s])}function PW(){var e=ct(Jy),t=ct(ew),r=vr();v.useEffect(()=>{if(e==null)return Xj;var n=(i,a,s)=>{t!==s&&e===i&&r(bW(a))};return Zu.on(dT,n),()=>{Zu.off(dT,n)}},[r,t,e])}function jW(){var e=vr();v.useEffect(()=>{e(vW())},[e]),AW(),PW()}function OW(e,t,r,n,i,a){var s=ct(g=>rW(g,e,t)),l=ct(ew),f=ct(Jy),h=ct(zP),d=ct(yW),m=d?.active,x=Jh();v.useEffect(()=>{if(!m&&f!=null&&l!=null){var g=x1({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:x});Zu.emit(y1,f,g,l)}},[m,r,s,i,n,l,f,h,a,x])}function mT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mT(Object(r),!0).forEach(function(n){DW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DW(e,t,r){return(t=RW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RW(e){var t=IW(e,"string");return typeof t=="symbol"?t:t+""}function IW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FW(e){return e.dataKey}function MW(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(t7,t)}var gT=[],LW={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ro.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function w1(e){var t=pn(e,LW),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:l,isAnimationActive:f,offset:h,payloadUniqBy:d,position:m,reverseDirection:x,useTranslate3d:g,wrapperStyle:_,cursor:w,shared:b,trigger:S,defaultIndex:T,portal:E,axisId:A}=t,k=vr(),j=typeof T=="number"?String(T):T;v.useEffect(()=>{k(sz({shared:b,trigger:S,axisId:A,active:r,defaultIndex:j}))},[k,b,S,A,r,j]);var P=Jh(),M=IA(),L=tz(b),{activeIndex:B,isActive:R}=ct(ge=>aW(ge,L,S,j)),U=ct(ge=>iW(ge,L,S,j)),oe=ct(ge=>Vj(ge,L,S,j)),V=ct(ge=>nW(ge,L,S,j)),ae=U,le=dW(),J=r??R,[re,Z]=qM([ae,J]),se=L==="axis"?oe:void 0;OW(L,S,V,se,B,J);var G=E??le;if(G==null)return null;var ne=ae??gT;J||(ne=gT),l&&ne.length&&(ne=_M(ae.filter(ge=>ge.value!=null&&(ge.hide!==!0||t.includeHidden)),d,FW));var ie=ne.length>0,de=v.createElement(l7,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:f,active:J,coordinate:V,hasPayload:ie,offset:h,position:m,reverseDirection:x,useTranslate3d:g,viewBox:P,wrapperStyle:_,lastBoundingBox:re,innerRef:Z,hasPortalFromProps:!!E},MW(s,xT(xT({},t),{},{payload:ne,label:se,active:J,coordinate:V,accessibilityLayer:M})));return v.createElement(v.Fragment,null,BR.createPortal(de,G),J&&v.createElement(fW,{cursor:w,tooltipEventType:L,coordinate:V,payload:ae,index:B}))}var Tf=e=>null;Tf.displayName="Cell";function BW(e,t,r){return(t=$W(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $W(e){var t=UW(e,"string");return typeof t=="symbol"?t:t+""}function UW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class zW{constructor(t){BW(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function vT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vT(Object(r),!0).forEach(function(n){HW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HW(e,t,r){return(t=VW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=KW(e,"string");return typeof t=="symbol"?t:t+""}function KW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GW={cacheSize:2e3,enableCache:!0},qj=WW({},GW),yT=new zW(qj.cacheSize),YW={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},wT="recharts_measurement_span";function XW(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",a=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(s,"|").concat(l)}var bT=(e,t)=>{try{var r=document.getElementById(wT);r||(r=document.createElement("span"),r.setAttribute("id",wT),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,YW,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},ju=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ro.isSsr)return{width:0,height:0};if(!qj.enableCache)return bT(t,r);var n=XW(t,r),i=yT.get(n);if(i)return i;var a=bT(t,r);return yT.set(n,a),a},_T=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ST=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qW=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZW=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Zj={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QW=Object.keys(Zj),zl="NaN";function JW(e,t){return e*Zj[t]}class ti{static parse(t){var r,[,n,i]=(r=ZW.exec(t))!==null&&r!==void 0?r:[];return new ti(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Bi(t)&&(this.unit=""),r!==""&&!qW.test(r)&&(this.num=NaN,this.unit=""),QW.includes(r)&&(this.num=JW(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new ti(NaN,""):new ti(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new ti(NaN,""):new ti(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ti(NaN,""):new ti(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ti(NaN,""):new ti(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Bi(this.num)}}function Qj(e){if(e.includes(zl))return zl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,a]=(r=_T.exec(t))!==null&&r!==void 0?r:[],s=ti.parse(n??""),l=ti.parse(a??""),f=i==="*"?s.multiply(l):s.divide(l);if(f.isNaN())return zl;t=t.replace(_T,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,[,d,m,x]=(h=ST.exec(t))!==null&&h!==void 0?h:[],g=ti.parse(d??""),_=ti.parse(x??""),w=m==="+"?g.add(_):g.subtract(_);if(w.isNaN())return zl;t=t.replace(ST,w.toString())}return t}var NT=/\(([^()]*)\)/;function eH(e){for(var t=e,r;(r=NT.exec(t))!=null;){var[,n]=r;t=t.replace(NT,Qj(n))}return t}function tH(e){var t=e.replace(/\s+/g,"");return t=eH(t),t=Qj(t),t}function rH(e){try{return tH(e)}catch{return zl}}function zg(e){var t=rH(e.slice(5,-1));return t===zl?"":t}var nH=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],iH=["dx","dy","angle","className","breakAll"];function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(null,arguments)}function ET(e,t){if(e==null)return{};var r,n,i=aH(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function aH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Jj=/[ \f\n\r\t\v\u2028\u2029]+/,eO=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];sr(t)||(r?i=t.toString().split(""):i=t.toString().split(Jj));var a=i.map(l=>({word:l,width:ju(l,n).width})),s=r?0:ju("",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},sH=(e,t,r,n,i)=>{var{maxLines:a,children:s,style:l,breakAll:f}=e,h=ft(a),d=s,m=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R.reduce((U,oe)=>{var{word:V,width:ae}=oe,le=U[U.length-1];if(le&&(n==null||i||le.width+ae+r<Number(n)))le.words.push(V),le.width+=ae+r;else{var J={words:[V],width:ae};U.push(J)}return U},[])},x=m(t),g=B=>B.reduce((R,U)=>R.width>U.width?R:U);if(!h||i)return x;var _=x.length>a||g(x).width>Number(n);if(!_)return x;for(var w="",b=B=>{var R=d.slice(0,B),U=eO({breakAll:f,style:l,children:R+w}).wordsWithComputedWidth,oe=m(U),V=oe.length>a||g(oe).width>Number(n);return[V,oe]},S=0,T=d.length-1,E=0,A;S<=T&&E<=d.length-1;){var k=Math.floor((S+T)/2),j=k-1,[P,M]=b(j),[L]=b(k);if(!P&&!L&&(S=k+1),P&&L&&(T=k-1),!P&&L){A=M;break}E++}return A||x},TT=e=>{var t=sr(e)?[]:e.toString().split(Jj);return[{words:t}]},oH=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=e;if((t||r)&&!ro.isSsr){var l,f,h=eO({breakAll:a,children:n,style:i});if(h){var{wordsWithComputedWidth:d,spaceWidth:m}=h;l=d,f=m}else return TT(n);return sH({breakAll:a,children:n,maxLines:s,style:i},l,f,t,r)}return TT(n)},CT="#808080",bp=v.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:f="end",fill:h=CT}=e,d=ET(e,nH),m=v.useMemo(()=>oH({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:x,dy:g,angle:_,className:w,breakAll:b}=d,S=ET(d,iH);if(!_a(r)||!_a(n)||m.length===0)return null;var T=r+(ft(x)?x:0),E=n+(ft(g)?g:0),A;switch(f){case"start":A=zg("calc(".concat(a,")"));break;case"middle":A=zg("calc(".concat((m.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:A=zg("calc(".concat(m.length-1," * -").concat(i,")"));break}var k=[];if(s){var j=m[0].width,{width:P}=d;k.push("scale(".concat(ft(P)?P/j:1,")"))}return _&&k.push("rotate(".concat(_,", ").concat(T,", ").concat(E,")")),k.length&&(S.transform=k.join(" ")),v.createElement("text",b1({},Hn(S),{ref:t,x:T,y:E,className:Rt("recharts-text",w),textAnchor:l,fill:h.includes("url")?CT:h}),m.map((M,L)=>{var B=M.words.join(b?"":" ");return v.createElement("tspan",{x:T,dy:L===0?A:i,key:"".concat(B,"-").concat(L)},B)}))});bp.displayName="Text";var lH=["labelRef"];function cH(e,t){if(e==null)return{};var r,n,i=uH(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function uH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function kT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kT(Object(r),!0).forEach(function(n){fH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fH(e,t,r){return(t=dH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dH(e){var t=hH(e,"string");return typeof t=="symbol"?t:t+""}function hH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function La(){return La=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},La.apply(null,arguments)}var tO=v.createContext(null),pH=e=>{var{x:t,y:r,width:n,height:i,children:a}=e,s=v.useMemo(()=>({x:t,y:r,width:n,height:i}),[t,r,n,i]);return v.createElement(tO.Provider,{value:s},a)},rO=()=>{var e=v.useContext(tO),t=Jh();return e||t},mH=v.createContext(null),xH=()=>{var e=v.useContext(mH),t=ct(GP);return e||t},gH=e=>{var{value:t,formatter:r}=e,n=sr(e.children)?t:e.children;return typeof r=="function"?r(n):n},Iw=e=>e!=null&&typeof e=="function",vH=(e,t)=>{var r=Jr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},yH=(e,t,r,n,i)=>{var{offset:a,className:s}=e,{cx:l,cy:f,innerRadius:h,outerRadius:d,startAngle:m,endAngle:x,clockWise:g}=i,_=(h+d)/2,w=vH(m,x),b=w>=0?1:-1,S,T;switch(t){case"insideStart":S=m+b*a,T=g;break;case"insideEnd":S=x-b*a,T=!g;break;case"end":S=x+b*a,T=g;break;default:throw new Error("Unsupported position ".concat(t))}T=w<=0?T:!T;var E=Dr(l,f,_,S),A=Dr(l,f,_,S+(T?1:-1)*359),k="M".concat(E.x,",").concat(E.y,`
    A`).concat(_,",").concat(_,",0,1,").concat(T?0:1,`,
    `).concat(A.x,",").concat(A.y),j=sr(e.id)?$u("recharts-radial-line-"):e.id;return v.createElement("text",La({},n,{dominantBaseline:"central",className:Rt("recharts-radial-bar-label",s)}),v.createElement("defs",null,v.createElement("path",{id:j,d:k})),v.createElement("textPath",{xlinkHref:"#".concat(j)},r))},wH=(e,t,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:s,startAngle:l,endAngle:f}=e,h=(l+f)/2;if(r==="outside"){var{x:d,y:m}=Dr(n,i,s+t,h);return{x:d,y:m,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var x=(a+s)/2,{x:g,y:_}=Dr(n,i,x,h);return{x:g,y:_,textAnchor:"middle",verticalAnchor:"middle"}},nO=e=>"cx"in e&&ft(e.cx),bH=(e,t)=>{var{parentViewBox:r,offset:n,position:i}=e,a;r!=null&&!nO(r)&&(a=r);var{x:s,y:l,width:f,height:h}=t,d=h>=0?1:-1,m=d*n,x=d>0?"end":"start",g=d>0?"start":"end",_=f>=0?1:-1,w=_*n,b=_>0?"end":"start",S=_>0?"start":"end";if(i==="top"){var T={x:s+f/2,y:l-d*n,textAnchor:"middle",verticalAnchor:x};return Sr(Sr({},T),a?{height:Math.max(l-a.y,0),width:f}:{})}if(i==="bottom"){var E={x:s+f/2,y:l+h+m,textAnchor:"middle",verticalAnchor:g};return Sr(Sr({},E),a?{height:Math.max(a.y+a.height-(l+h),0),width:f}:{})}if(i==="left"){var A={x:s-w,y:l+h/2,textAnchor:b,verticalAnchor:"middle"};return Sr(Sr({},A),a?{width:Math.max(A.x-a.x,0),height:h}:{})}if(i==="right"){var k={x:s+f+w,y:l+h/2,textAnchor:S,verticalAnchor:"middle"};return Sr(Sr({},k),a?{width:Math.max(a.x+a.width-k.x,0),height:h}:{})}var j=a?{width:f,height:h}:{};return i==="insideLeft"?Sr({x:s+w,y:l+h/2,textAnchor:S,verticalAnchor:"middle"},j):i==="insideRight"?Sr({x:s+f-w,y:l+h/2,textAnchor:b,verticalAnchor:"middle"},j):i==="insideTop"?Sr({x:s+f/2,y:l+m,textAnchor:"middle",verticalAnchor:g},j):i==="insideBottom"?Sr({x:s+f/2,y:l+h-m,textAnchor:"middle",verticalAnchor:x},j):i==="insideTopLeft"?Sr({x:s+w,y:l+m,textAnchor:S,verticalAnchor:g},j):i==="insideTopRight"?Sr({x:s+f-w,y:l+m,textAnchor:b,verticalAnchor:g},j):i==="insideBottomLeft"?Sr({x:s+w,y:l+h-m,textAnchor:S,verticalAnchor:x},j):i==="insideBottomRight"?Sr({x:s+f-w,y:l+h-m,textAnchor:b,verticalAnchor:x},j):i&&typeof i=="object"&&(ft(i.x)||Za(i.x))&&(ft(i.y)||Za(i.y))?Sr({x:s+Cn(i.x,f),y:l+Cn(i.y,h),textAnchor:"end",verticalAnchor:"end"},j):Sr({x:s+f/2,y:l+h/2,textAnchor:"middle",verticalAnchor:"middle"},j)},_H={offset:5};function Is(e){var t=pn(e,_H),{viewBox:r,position:n,value:i,children:a,content:s,className:l="",textBreakAll:f,labelRef:h}=t,d=xH(),m=rO(),x=n==="center"?m:d??m,g=r||x;if(!g||sr(i)&&sr(a)&&!v.isValidElement(s)&&typeof s!="function")return null;var _=Sr(Sr({},t),{},{viewBox:g});if(v.isValidElement(s)){var{labelRef:w}=_,b=cH(_,lH);return v.cloneElement(s,b)}var S;if(typeof s=="function"){if(S=v.createElement(s,_),v.isValidElement(S))return S}else S=gH(t);var T=nO(g),E=Hn(t);if(T&&(n==="insideStart"||n==="insideEnd"||n==="end"))return yH(t,n,S,E,g);var A=T?wH(g,t.offset,t.position):bH(t,g);return v.createElement(bp,La({ref:h,className:Rt("recharts-label",l)},E,A,{breakAll:f}),S)}Is.displayName="Label";var SH=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?v.createElement(Is,La({key:"label-implicit"},n)):_a(e)?v.createElement(Is,La({key:"label-implicit",value:e},n)):v.isValidElement(e)?e.type===Is?v.cloneElement(e,Sr({key:"label-implicit"},n)):v.createElement(Is,La({key:"label-implicit",content:e},n)):Iw(e)?v.createElement(Is,La({key:"label-implicit",content:e},n)):e&&typeof e=="object"?v.createElement(Is,La({},e,{key:"label-implicit"},n)):null};function NH(e){var{label:t,labelRef:r}=e,n=rO();return SH(t,n,r)||null}var Wg={},Hg={},AT;function EH(){return AT||(AT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Hg)),Hg}var Vg={},PT;function TH(){return PT||(PT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Vg)),Vg}var jT;function CH(){return jT||(jT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EH(),r=TH(),n=xy();function i(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=i})(Wg)),Wg}var Kg,OT;function kH(){return OT||(OT=1,Kg=CH().last),Kg}var AH=kH();const PH=is(AH);var jH=["valueAccessor"],OH=["dataKey","clockWise","id","textBreakAll"];function nh(){return nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nh.apply(null,arguments)}function DT(e,t){if(e==null)return{};var r,n,i=DH(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function DH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var RH=e=>Array.isArray(e.value)?PH(e.value):e.value,iO=v.createContext(void 0),aO=iO.Provider,sO=v.createContext(void 0),IH=sO.Provider;function FH(){return v.useContext(iO)}function MH(){return v.useContext(sO)}function b0(e){var{valueAccessor:t=RH}=e,r=DT(e,jH),{dataKey:n,clockWise:i,id:a,textBreakAll:s}=r,l=DT(r,OH),f=FH(),h=MH(),d=f||h;return!d||!d.length?null:v.createElement(dn,{className:"recharts-label-list"},d.map((m,x)=>{var g,_=sr(n)?t(m,x):Yt(m&&m.payload,n),w=sr(a)?{}:{id:"".concat(a,"-").concat(x)};return v.createElement(Is,nh({key:"label-".concat(x)},Hn(m),l,w,{fill:(g=r.fill)!==null&&g!==void 0?g:m.fill,parentViewBox:m.parentViewBox,value:_,textBreakAll:s,viewBox:m.viewBox,index:x}))}))}b0.displayName="LabelList";function Fw(e){var{label:t}=e;return t?t===!0?v.createElement(b0,{key:"labelList-implicit"}):v.isValidElement(t)||Iw(t)?v.createElement(b0,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(b0,nh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_1.apply(null,arguments)}var oO=e=>{var{cx:t,cy:r,r:n,className:i}=e,a=Rt("recharts-dot",i);return t===+t&&r===+r&&n===+n?v.createElement("circle",_1({},bi(e),my(e),{className:a,cx:t,cy:r,r:n})):null},lO=e=>e.graphicalItems.polarItems,LH=Te([or,wf],sw),_p=Te([lO,hr,LH],ow),BH=Te([_p],lw),Sp=Te([BH,Xy],cw),$H=Te([Sp,hr,_p],fw);Te([Sp,hr,_p],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var a,s=Yt(n,(a=t.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:Yt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var RT=()=>{},UH=Te([Sp,hr,_p,gp,or],mw),zH=Te([hr,hw,pw,RT,UH,RT,Ct,or],xw),cO=Te([hr,Ct,Sp,$H,yf,or,zH],gw),WH=Te([cO,hr,bc],ww);Te([hr,cO,WH,or],_w);var HH={radiusAxis:{},angleAxis:{}},uO=Si({name:"polarAxis",initialState:HH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Poe,removeRadiusAxis:joe,addAngleAxis:Ooe,removeAngleAxis:Doe}=uO.actions,VH=uO.reducer;function IT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function FT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IT(Object(r),!0).forEach(function(n){KH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KH(e,t,r){return(t=GH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GH(e){var t=YH(e,"string");return typeof t=="symbol"?t:t+""}function YH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XH=(e,t)=>t,Mw=Te([lO,XH],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),qH=[],Lw=(e,t,r)=>r?.length===0?qH:r,fO=Te([Xy,Mw,Lw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if(t?.data!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>FT(FT({},t.presentationProps),a.props))),i!=null)return i}}),ZH=Te([fO,Mw,Lw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var a,s=Yt(n,t.nameKey,t.name),l;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:pc(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),QH=Te([fO,Mw,Lw,Wr],(e,t,r,n)=>{if(!(t==null||e==null))return QV({offset:n,pieSettings:t,displayedData:e,cells:r})}),Gg={exports:{}},Ut={};var MT;function JH(){if(MT)return Ut;MT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function _(w){if(typeof w=="object"&&w!==null){var b=w.$$typeof;switch(b){case e:switch(w=w.type,w){case r:case i:case n:case f:case h:case x:return w;default:switch(w=w&&w.$$typeof,w){case s:case l:case m:case d:return w;case a:return w;default:return b}}case t:return b}}}return Ut.ContextConsumer=a,Ut.ContextProvider=s,Ut.Element=e,Ut.ForwardRef=l,Ut.Fragment=r,Ut.Lazy=m,Ut.Memo=d,Ut.Portal=t,Ut.Profiler=i,Ut.StrictMode=n,Ut.Suspense=f,Ut.SuspenseList=h,Ut.isContextConsumer=function(w){return _(w)===a},Ut.isContextProvider=function(w){return _(w)===s},Ut.isElement=function(w){return typeof w=="object"&&w!==null&&w.$$typeof===e},Ut.isForwardRef=function(w){return _(w)===l},Ut.isFragment=function(w){return _(w)===r},Ut.isLazy=function(w){return _(w)===m},Ut.isMemo=function(w){return _(w)===d},Ut.isPortal=function(w){return _(w)===t},Ut.isProfiler=function(w){return _(w)===i},Ut.isStrictMode=function(w){return _(w)===n},Ut.isSuspense=function(w){return _(w)===f},Ut.isSuspenseList=function(w){return _(w)===h},Ut.isValidElementType=function(w){return typeof w=="string"||typeof w=="function"||w===r||w===i||w===n||w===f||w===h||typeof w=="object"&&w!==null&&(w.$$typeof===m||w.$$typeof===d||w.$$typeof===s||w.$$typeof===a||w.$$typeof===l||w.$$typeof===g||w.getModuleId!==void 0)},Ut.typeOf=_,Ut}var LT;function eV(){return LT||(LT=1,Gg.exports=JH()),Gg.exports}var tV=eV(),BT=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",$T=null,Yg=null,dO=e=>{if(e===$T&&Array.isArray(Yg))return Yg;var t=[];return v.Children.forEach(e,r=>{sr(r)||(tV.isFragment(r)?t=t.concat(dO(r.props.children)):t.push(r))}),Yg=t,$T=e,t};function Bw(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>BT(i)):n=[BT(t)],dO(e).forEach(i=>{var a=$o(i,"type.displayName")||$o(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var hO=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Xg={},UT;function rV(){return UT||(UT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Xg)),Xg}var qg,zT;function nV(){return zT||(zT=1,qg=rV().isPlainObject),qg}var iV=nV();const aV=is(iV);function WT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function HT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WT(Object(r),!0).forEach(function(n){sV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sV(e,t,r){return(t=oV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oV(e){var t=lV(e,"string");return typeof t=="symbol"?t:t+""}function lV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ih(){return ih=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ih.apply(null,arguments)}var VT=(e,t,r,n,i)=>{var a=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-a/2,",").concat(t+i),s+="L ".concat(e+r-a/2-n,",").concat(t+i),s+="L ".concat(e,",").concat(t," Z"),s},cV={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},uV=e=>{var t=pn(e,cV),{x:r,y:n,upperWidth:i,lowerWidth:a,height:s,className:l}=t,{animationEasing:f,animationDuration:h,animationBegin:d,isUpdateAnimationActive:m}=t,x=v.useRef(null),[g,_]=v.useState(-1),w=v.useRef(i),b=v.useRef(a),S=v.useRef(s),T=v.useRef(r),E=v.useRef(n),A=pf(e,"trapezoid-");if(v.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var V=x.current.getTotalLength();V&&_(V)}catch{}},[]),r!==+r||n!==+n||i!==+i||a!==+a||s!==+s||i===0&&a===0||s===0)return null;var k=Rt("recharts-trapezoid",l);if(!m)return v.createElement("g",null,v.createElement("path",ih({},Hn(t),{className:k,d:VT(r,n,i,a,s)})));var j=w.current,P=b.current,M=S.current,L=T.current,B=E.current,R="0px ".concat(g===-1?1:g,"px"),U="".concat(g,"px 0px"),oe=FA(["strokeDasharray"],h,f);return v.createElement(hf,{animationId:A,key:A,canBegin:g>0,duration:h,easing:f,isActive:m,begin:d},V=>{var ae=gr(j,i,V),le=gr(P,a,V),J=gr(M,s,V),re=gr(L,r,V),Z=gr(B,n,V);x.current&&(w.current=ae,b.current=le,S.current=J,T.current=re,E.current=Z);var se=V>0?{transition:oe,strokeDasharray:U}:{strokeDasharray:R};return v.createElement("path",ih({},Hn(t),{className:k,d:VT(re,Z,ae,le,J),ref:x,style:HT(HT({},se),t.style)}))})},fV=["option","shapeType","propTransformer","activeClassName","isActive"];function dV(e,t){if(e==null)return{};var r,n,i=hV(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function hV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function KT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KT(Object(r),!0).forEach(function(n){pV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pV(e,t,r){return(t=mV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mV(e){var t=xV(e,"string");return typeof t=="symbol"?t:t+""}function xV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gV(e,t){return ah(ah({},t),e)}function vV(e,t){return e==="symbols"}function GT(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement($A,r);case"trapezoid":return v.createElement(uV,r);case"sector":return v.createElement(WA,r);case"symbols":if(vV(t))return v.createElement(D4,r);break;default:return null}}function yV(e){return v.isValidElement(e)?e.props:e}function pO(e){var{option:t,shapeType:r,propTransformer:n=gV,activeClassName:i="recharts-active-shape",isActive:a}=e,s=dV(e,fV),l;if(v.isValidElement(t))l=v.cloneElement(t,ah(ah({},s),yV(t)));else if(typeof t=="function")l=t(s);else if(aV(t)&&typeof t!="boolean"){var f=n(t,s);l=v.createElement(GT,{shapeType:r,elementProps:f})}else{var h=s;l=v.createElement(GT,{shapeType:r,elementProps:h})}return a?v.createElement(dn,{className:i},l):l}var $w=(e,t)=>{var r=vr();return(n,i)=>a=>{e?.(n,i,a),r(Ej({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Uw=e=>{var t=vr();return(r,n)=>i=>{e?.(r,n,i),t(oz())}},zw=(e,t)=>{var r=vr();return(n,i)=>a=>{e?.(n,i,a),r(lz({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Ww(e){var{fn:t,args:r}=e,n=vr(),i=Vn();return v.useLayoutEffect(()=>{if(!i){var a=t(r);return n(iz(a)),()=>{n(az(a))}}},[t,r,n,i]),null}var mO=()=>{};function xO(e){var{legendPayload:t}=e,r=vr(),n=Vn();return v.useLayoutEffect(()=>n?mO:(r(DA(t)),()=>{r(RA(t))}),[r,n,t]),null}function wV(e){var{legendPayload:t}=e,r=vr(),n=ct(Ct);return v.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?mO:(r(DA(t)),()=>{r(RA(t))}),[r,n,t]),null}var Zg,bV=()=>{var[e]=v.useState(()=>$u("uid-"));return e},_V=(Zg=Vk.useId)!==null&&Zg!==void 0?Zg:bV;function SV(e,t){var r=_V();return t||(e?"".concat(e,"-").concat(r):r)}var NV=v.createContext(void 0),Hw=e=>{var{id:t,type:r,children:n}=e,i=SV("recharts-".concat(r),t);return v.createElement(NV.Provider,{value:i},n(i))},EV={cartesianItems:[],polarItems:[]},gO=Si({name:"graphicalItems",initialState:EV,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Bn()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=Ha(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:Bn()},removeCartesianGraphicalItem:{reducer(e,t){var r=Ha(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Bn()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Bn()},removePolarGraphicalItem:{reducer(e,t){var r=Ha(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Bn()}}}),{addCartesianGraphicalItem:TV,replaceCartesianGraphicalItem:CV,removeCartesianGraphicalItem:kV,addPolarGraphicalItem:AV,removePolarGraphicalItem:PV}=gO.actions,jV=gO.reducer;function vO(e){var t=vr(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(TV(e)):r.current!==e&&t(CV({prev:r.current,next:e})),r.current=e},[t,e]),v.useLayoutEffect(()=>()=>{r.current&&(t(kV(r.current)),r.current=null)},[t]),null}function OV(e){var t=vr();return v.useLayoutEffect(()=>(t(AV(e)),()=>{t(PV(e))}),[t,e]),null}var DV=["onMouseEnter","onClick","onMouseLeave"],RV=["id"],IV=["id"];function Vw(e,t){if(e==null)return{};var r,n,i=FV(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function FV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function YT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YT(Object(r),!0).forEach(function(n){MV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MV(e,t,r){return(t=LV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e){var t=BV(e,"string");return typeof t=="symbol"?t:t+""}function BV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gs(){return Gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gs.apply(null,arguments)}function $V(e){var t=v.useMemo(()=>Bw(e.children,Tf),[e.children]),r=ct(n=>ZH(n,e.id,t));return r==null?null:v.createElement(wV,{legendPayload:r})}function UV(e){var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:s,name:l,hide:f,tooltipType:h}=e;return{dataDefinedOnItem:n.map(d=>d.tooltipPayload),positions:n.map(d=>d.tooltipPosition),settings:{stroke:i,strokeWidth:a,fill:s,dataKey:t,nameKey:r,name:pc(l,t),hide:f,type:h,color:s,unit:""}}}var zV=(e,t)=>e>t?"start":e<t?"end":"middle",WV=(e,t,r)=>Cn(typeof t=="function"?t(e):t,r,r*.8),HV=(e,t,r)=>{var{top:n,left:i,width:a,height:s}=t,l=yA(a,s),f=i+Cn(e.cx,a,a/2),h=n+Cn(e.cy,s,s/2),d=Cn(e.innerRadius,l,0),m=WV(r,e.outerRadius,l),x=e.maxRadius||Math.sqrt(a*a+s*s)/2;return{cx:f,cy:h,innerRadius:d,outerRadius:m,maxRadius:x}},VV=(e,t)=>{var r=Jr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function KV(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var GV=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Rt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(Ey,Gs({},t,{type:"linear",className:r}))},YV=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),v.isValidElement(n)))return n;var i=Rt("recharts-pie-label-text",KV(e));return v.createElement(bp,Gs({},t,{alignmentBaseline:"middle",className:i}),n)};function XV(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:a,dataKey:s}=r;if(!n||!i||!t)return null;var l=bi(r),f=Bo(i),h=Bo(a),d=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,m=t.map((x,g)=>{var _=(x.startAngle+x.endAngle)/2,w=Dr(x.cx,x.cy,x.outerRadius+d,_),b=rr(rr(rr(rr({},l),x),{},{stroke:"none"},f),{},{index:g,textAnchor:zV(w.x,x.cx)},w),S=rr(rr(rr(rr({},l),x),{},{fill:"none",stroke:x.fill},h),{},{index:g,points:[Dr(x.cx,x.cy,x.outerRadius,_),w],key:"line"});return v.createElement(dn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(g)},a&&GV(a,S),YV(i,b,Yt(x,s)))});return v.createElement(dn,{className:"recharts-pie-labels"},m)}function qV(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?v.createElement(Fw,{label:i}):v.createElement(XV,{sectors:t,props:r,showLabels:n})}function ZV(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i}=e,a=ct(Ks),{onMouseEnter:s,onClick:l,onMouseLeave:f}=i,h=Vw(i,DV),d=$w(s,i.dataKey),m=Uw(f),x=zw(l,i.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((g,_)=>{if(g?.startAngle===0&&g?.endAngle===0&&t.length!==1)return null;var w=r&&String(_)===a,b=a?n:null,S=w?r:b,T=rr(rr({},g),{},{stroke:g.stroke,tabIndex:-1,[NA]:_,[EA]:i.dataKey});return v.createElement(dn,Gs({key:"sector-".concat(g?.startAngle,"-").concat(g?.endAngle,"-").concat(g.midAngle,"-").concat(_),tabIndex:-1,className:"recharts-pie-sector"},zh(h,g,_),{onMouseEnter:d(g,_),onMouseLeave:m(g,_),onClick:x(g,_)}),v.createElement(pO,Gs({option:S,isActive:w,shapeType:"sector"},T)))}))}function QV(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:a}=e,{cornerRadius:s,startAngle:l,endAngle:f,dataKey:h,nameKey:d,tooltipType:m}=r,x=Math.abs(r.minAngle),g=VV(l,f),_=Math.abs(g),w=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,b=n.filter(j=>Yt(j,h,0)!==0).length,S=(_>=360?b:b-1)*w,T=_-b*x-S,E=n.reduce((j,P)=>{var M=Yt(P,h,0);return j+(ft(M)?M:0)},0),A;if(E>0){var k;A=n.map((j,P)=>{var M=Yt(j,h,0),L=Yt(j,d,P),B=HV(r,a,j),R=(ft(M)?M:0)/E,U,oe=rr(rr({},j),i&&i[P]&&i[P].props);P?U=k.endAngle+Jr(g)*w*(M!==0?1:0):U=l;var V=U+Jr(g)*((M!==0?x:0)+R*T),ae=(U+V)/2,le=(B.innerRadius+B.outerRadius)/2,J=[{name:L,value:M,payload:oe,dataKey:h,type:m}],re=Dr(B.cx,B.cy,le,ae);return k=rr(rr(rr(rr({},r.presentationProps),{},{percent:R,cornerRadius:s,name:L,tooltipPayload:J,midAngle:ae,middleRadius:le,tooltipPosition:re},oe),B),{},{value:M,startAngle:U,endAngle:V,payload:oe,paddingAngle:Jr(g)*w}),k})}return A}function JV(e){var{showLabels:t,sectors:r,children:n}=e,i=v.useMemo(()=>!t||!r?[]:r.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})),[r,t]);return v.createElement(IH,{value:t?i:void 0},n)}function eK(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:l,activeShape:f,inactiveShape:h,onAnimationStart:d,onAnimationEnd:m}=t,x=pf(t,"recharts-pie-"),g=r.current,[_,w]=v.useState(!1),b=v.useCallback(()=>{typeof m=="function"&&m(),w(!1)},[m]),S=v.useCallback(()=>{typeof d=="function"&&d(),w(!0)},[d]);return v.createElement(JV,{showLabels:!_,sectors:n},v.createElement(hf,{animationId:x,begin:a,duration:s,isActive:i,easing:l,onAnimationStart:S,onAnimationEnd:b,key:x},T=>{var E=[],A=n&&n[0],k=A?.startAngle;return n?.forEach((j,P)=>{var M=g&&g[P],L=P>0?$o(j,"paddingAngle",0):0;if(M){var B=gr(M.endAngle-M.startAngle,j.endAngle-j.startAngle,T),R=rr(rr({},j),{},{startAngle:k+L,endAngle:k+B+L});E.push(R),k=R.endAngle}else{var{endAngle:U,startAngle:oe}=j,V=gr(0,U-oe,T),ae=rr(rr({},j),{},{startAngle:k+L,endAngle:k+V+L});E.push(ae),k=ae.endAngle}}),r.current=E,v.createElement(dn,null,v.createElement(ZV,{sectors:E,activeShape:f,inactiveShape:h,allOtherPieProps:t}))}),v.createElement(qV,{showLabels:!_,sectors:n,props:t}),t.children)}var tK={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ro.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function rK(e){var{id:t}=e,r=Vw(e,RV),{hide:n,className:i,rootTabIndex:a}=e,s=v.useMemo(()=>Bw(e.children,Tf),[e.children]),l=ct(d=>QH(d,t,s)),f=v.useRef(null),h=Rt("recharts-pie",i);return n||l==null?(f.current=null,v.createElement(dn,{tabIndex:a,className:h})):v.createElement(v.Fragment,null,v.createElement(Ww,{fn:UV,args:rr(rr({},e),{},{sectors:l})}),v.createElement(dn,{tabIndex:a,className:h},v.createElement(eK,{props:rr(rr({},r),{},{sectors:l}),previousSectorsRef:f})))}function yO(e){var t=pn(e,tK),{id:r}=t,n=Vw(t,IV),i=bi(n);return v.createElement(Hw,{id:r,type:"pie"},a=>v.createElement(v.Fragment,null,v.createElement(OV,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),v.createElement($V,Gs({},n,{id:a})),v.createElement(rK,Gs({},n,{id:a}))))}yO.displayName="Pie";function XT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XT(Object(r),!0).forEach(function(n){nK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nK(e,t,r){return(t=iK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iK(e){var t=aK(e,"string");return typeof t=="symbol"?t:t+""}function aK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sK={xAxis:{},yAxis:{},zAxis:{}},wO=Si({name:"cartesianAxis",initialState:sK,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Bn()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Bn()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Bn()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Bn()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Bn()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Bn()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&n===a[1]&&n!==i.width&&Math.abs(n-a[0])<=1)return;var s=[...a,n].slice(-3);e.yAxis[r]=qT(qT({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:oK,removeXAxis:lK,addYAxis:cK,removeYAxis:uK,addZAxis:Roe,removeZAxis:Ioe,updateYAxisWidth:fK}=wO.actions,dK=wO.reducer,hK=Te([Wr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),pK=Te([hK,as,ss],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Kw=()=>ct(pK),mK=()=>ct(Yz);function ZT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function QT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZT(Object(r),!0).forEach(function(n){xK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yK=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=e;if(i===!1||t.x==null||t.y==null)return null;var s=QT(QT({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Bo(i)),my(i)),l;return v.isValidElement(i)?l=v.cloneElement(i,s):typeof i=="function"?l=i(s):l=v.createElement(oO,s),v.createElement(dn,{className:"recharts-active-dot"},l)};function wK(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i}=e,a=ct(Ks),s=mK();if(t==null||s==null)return null;var l=t.find(f=>s.includes(f.payload));return sr(l)?null:yK({point:l,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var bK="Invariant failed";function _K(e,t){throw new Error(bK)}var SK=["x","y"];function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(null,arguments)}function JT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JT(Object(r),!0).forEach(function(n){NK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NK(e,t,r){return(t=EK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EK(e){var t=TK(e,"string");return typeof t=="symbol"?t:t+""}function TK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CK(e,t){if(e==null)return{};var r,n,i=kK(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function kK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function AK(e,t){var{x:r,y:n}=e,i=CK(e,SK),a="".concat(r),s=parseInt(a,10),l="".concat(n),f=parseInt(l,10),h="".concat(t.height||i.height),d=parseInt(h,10),m="".concat(t.width||i.width),x=parseInt(m,10);return wu(wu(wu(wu(wu({},t),i),s?{x:s}:{}),f?{y:f}:{}),{},{height:d,width:x,name:t.name,radius:t.radius})}function Gw(e){return v.createElement(pO,S1({shapeType:"rectangle",propTransformer:AK,activeClassName:"recharts-active-bar"},e))}var PK=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(ft(t))return t;var a=ft(n)||sr(n);return a?t(n,i):(a||_K(),r)}},jK={},bO=Si({name:"errorBars",initialState:jK,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:Foe,replaceErrorBar:Moe,removeErrorBar:Loe}=bO.actions,OK=bO.reducer,DK=["children"];function RK(e,t){if(e==null)return{};var r,n,i=IK(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function IK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FK={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},MK=v.createContext(FK);function _O(e){var{children:t}=e,r=RK(e,DK);return v.createElement(MK.Provider,{value:r},t)}function Yw(e,t){var r,n,i=ct(h=>ls(h,e)),a=ct(h=>cs(h,t)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:ui.allowDataOverflow,l=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:fi.allowDataOverflow,f=s||l;return{needClip:f,needClipX:s,needClipY:l}}function SO(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=Kw(),{needClipX:a,needClipY:s,needClip:l}=Yw(t,r);if(!l)return null;var{x:f,y:h,width:d,height:m}=i;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:a?f:f-d/2,y:s?h:h-m/2,width:a?d:d*2,height:s?m:m*2}))}var LK=["onMouseEnter","onMouseLeave","onClick"],BK=["value","background","tooltipPosition"],$K=["id"],UK=["onMouseEnter","onClick","onMouseLeave"];function Ys(){return Ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ys.apply(null,arguments)}function eC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eC(Object(r),!0).forEach(function(n){zK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zK(e,t,r){return(t=WK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WK(e){var t=HK(e,"string");return typeof t=="symbol"?t:t+""}function HK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sh(e,t){if(e==null)return{};var r,n,i=VK(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function VK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KK=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:n,value:pc(r,t),payload:e}]};function GK(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:a,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:pc(a,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function YK(e){var t=ct(Ks),{data:r,dataKey:n,background:i,allOtherBarProps:a}=e,{onMouseEnter:s,onMouseLeave:l,onClick:f}=a,h=sh(a,LK),d=$w(s,n),m=Uw(l),x=zw(f,n);if(!i||r==null)return null;var g=Bo(i);return v.createElement(v.Fragment,null,r.map((_,w)=>{var{value:b,background:S,tooltipPosition:T}=_,E=sh(_,BK);if(!S)return null;var A=d(_,w),k=m(_,w),j=x(_,w),P=$n($n($n($n($n({option:i,isActive:String(w)===t},E),{},{fill:"#eee"},S),g),zh(h,_,w)),{},{onMouseEnter:A,onMouseLeave:k,onClick:j,dataKey:n,index:w,className:"recharts-bar-background-rectangle"});return v.createElement(Gw,Ys({key:"background-bar-".concat(w)},P))}))}function XK(e){var{showLabels:t,children:r,rects:n}=e,i=n?.map(a=>{var s={x:a.x,y:a.y,width:a.width,height:a.height};return $n($n({},s),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:s,fill:a.fill})});return v.createElement(aO,{value:t?i:void 0},r)}function qK(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:a,dataKey:s}=e,l=ct(Ks),f=ct($j),h=r&&String(a)===l&&(f==null||s===f),d=h?r:t;return v.createElement(Gw,Ys({},n,{name:String(n.name)},i,{isActive:h,option:d,index:a,dataKey:s}))}function ZK(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:a}=e;return v.createElement(Gw,Ys({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:a}))}function QK(e){var{data:t,props:r}=e,n=bi(r),{id:i}=n,a=sh(n,$K),{shape:s,dataKey:l,activeBar:f}=r,{onMouseEnter:h,onClick:d,onMouseLeave:m}=r,x=sh(r,UK),g=$w(h,l),_=Uw(m),w=zw(d,l);return t?v.createElement(v.Fragment,null,t.map((b,S)=>v.createElement(dn,Ys({key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(S),className:"recharts-bar-rectangle"},zh(x,b,S),{onMouseEnter:g(b,S),onMouseLeave:_(b,S),onClick:w(b,S)}),f?v.createElement(qK,{shape:s,activeBar:f,baseProps:a,entry:b,index:S,dataKey:l}):v.createElement(ZK,{shape:s,baseProps:a,entry:b,index:S,dataKey:l})))):null}function JK(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:a,animationBegin:s,animationDuration:l,animationEasing:f,onAnimationEnd:h,onAnimationStart:d}=t,m=r.current,x=pf(t,"recharts-bar-"),[g,_]=v.useState(!1),w=!g,b=v.useCallback(()=>{typeof h=="function"&&h(),_(!1)},[h]),S=v.useCallback(()=>{typeof d=="function"&&d(),_(!0)},[d]);return v.createElement(XK,{showLabels:w,rects:n},v.createElement(hf,{animationId:x,begin:s,duration:l,isActive:a,easing:f,onAnimationEnd:b,onAnimationStart:S,key:x},T=>{var E=T===1?n:n?.map((A,k)=>{var j=m&&m[k];if(j)return $n($n({},A),{},{x:gr(j.x,A.x,T),y:gr(j.y,A.y,T),width:gr(j.width,A.width,T),height:gr(j.height,A.height,T)});if(i==="horizontal"){var P=gr(0,A.height,T);return $n($n({},A),{},{y:A.y+A.height-P,height:P})}var M=gr(0,A.width,T);return $n($n({},A),{},{width:M})});return T>0&&(r.current=E??null),E==null?null:v.createElement(dn,null,v.createElement(QK,{props:t,data:E}))}),v.createElement(Fw,{label:t.label}),t.children)}function eG(e){var t=v.useRef(null);return v.createElement(JK,{previousRectanglesRef:t,props:e})}var NO=0,tG=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Yt(e,t)}};class rG extends v.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:s,needClip:l,background:f,id:h}=this.props;if(t||r==null)return null;var d=Rt("recharts-bar",i),m=h;return v.createElement(dn,{className:d,id:h},l&&v.createElement("defs",null,v.createElement(SO,{clipPathId:m,xAxisId:a,yAxisId:s})),v.createElement(dn,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(m,")"):void 0},v.createElement(YK,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),v.createElement(eG,this.props)))}}var nG={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!ro.isSsr,legendType:"rect",minPointSize:NO,xAxisId:0,yAxisId:0};function iG(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:h,isAnimationActive:d}=e,{needClip:m}=Yw(t,r),x=ep(),g=Vn(),_=Bw(e.children,Tf),w=ct(T=>OG(T,t,r,g,e.id,_));if(x!=="vertical"&&x!=="horizontal")return null;var b,S=w?.[0];return S==null||S.height==null||S.width==null?b=0:b=x==="vertical"?S.height/2:S.width/2,v.createElement(_O,{xAxisId:t,yAxisId:r,data:w,dataPointFormatter:tG,errorBarOffset:b},v.createElement(rG,Ys({},e,{layout:x,needClip:m,data:w,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:s,animationBegin:l,animationDuration:f,animationEasing:h,isAnimationActive:d})))}function aG(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:s,yAxis:l,xAxisTicks:f,yAxisTicks:h,stackedData:d,displayedData:m,offset:x,cells:g,parentViewBox:_}=e,w=t==="horizontal"?l:s,b=d?w.scale.domain():null,S=pL({numericAxis:w});return m.map((T,E)=>{var A,k,j,P,M,L;d?A=lL(d[E],b):(A=Yt(T,r),Array.isArray(A)||(A=[S,A]));var B=PK(n,NO)(A[1],E);if(t==="horizontal"){var R,[U,oe]=[l.scale(A[0]),l.scale(A[1])];k=IN({axis:s,ticks:f,bandSize:a,offset:i.offset,entry:T,index:E}),j=(R=oe??U)!==null&&R!==void 0?R:void 0,P=i.size;var V=U-oe;if(M=Bi(V)?0:V,L={x:k,y:x.top,width:P,height:x.height},Math.abs(B)>0&&Math.abs(M)<Math.abs(B)){var ae=Jr(M||B)*(Math.abs(B)-Math.abs(M));j-=ae,M+=ae}}else{var[le,J]=[s.scale(A[0]),s.scale(A[1])];if(k=le,j=IN({axis:l,ticks:h,bandSize:a,offset:i.offset,entry:T,index:E}),P=J-le,M=i.size,L={x:x.left,y:j,width:x.width,height:M},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var re=Jr(P||B)*(Math.abs(B)-Math.abs(P));P+=re}}if(k==null||j==null||P==null||M==null)return null;var Z=$n($n({},T),{},{x:k,y:j,width:P,height:M,value:d?A:A[1],payload:T,background:L,tooltipPosition:{x:k+P/2,y:j+M/2},parentViewBox:_},g&&g[E]&&g[E].props);return Z}).filter(Boolean)}function sG(e){var t=pn(e,nG),r=Vn();return v.createElement(Hw,{id:t.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(xO,{legendPayload:KK(t)}),v.createElement(Ww,{fn:GK,args:t}),v.createElement(vO,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:hL(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(iG,Ys({},t,{id:n}))))}var N1=v.memo(sG);N1.displayName="Bar";function tC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tC(Object(r),!0).forEach(function(n){oG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oG(e,t,r){return(t=lG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lG(e){var t=cG(e,"string");return typeof t=="symbol"?t:t+""}function cG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uG=(e,t)=>t,fG=(e,t,r)=>r,dG=(e,t,r,n)=>n,hG=(e,t,r,n,i)=>i,Cf=Te([mp,hG],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),pG=Te([Cf],e=>e?.maxBarSize),mG=(e,t,r,n,i,a)=>a,rC=(e,t,r)=>{var n=r??e;if(!sr(n))return Cn(n,t,0)},xG=Te([Ct,mp,uG,fG,dG],(e,t,r,n,i)=>t.filter(a=>e==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),gG=(e,t,r,n)=>{var i=Ct(e);return i==="horizontal"?m1(e,"yAxis",r,n):m1(e,"xAxis",t,n)},vG=(e,t,r)=>{var n=Ct(e);return n==="horizontal"?nT(e,"xAxis",t):nT(e,"yAxis",r)},yG=(e,t,r)=>{var n={},i=e.filter(dp),a=e.filter(h=>h.stackId==null),s=i.reduce((h,d)=>(h[d.stackId]||(h[d.stackId]=[]),h[d.stackId].push(d),h),n),l=Object.entries(s).map(h=>{var[d,m]=h,x=m.map(_=>_.dataKey),g=rC(t,r,m[0].barSize);return{stackId:d,dataKeys:x,barSize:g}}),f=a.map(h=>{var d=[h.dataKey].filter(x=>x!=null),m=rC(t,r,h.barSize);return{stackId:void 0,dataKeys:d,barSize:m}});return[...l,...f]},wG=Te([xG,eU,vG],yG),bG=(e,t,r,n,i)=>{var a,s,l=Cf(e,t,r,n,i);if(l!=null){var f=Ct(e),h=$P(e),{maxBarSize:d}=l,m=sr(d)?h:d,x,g;return f==="horizontal"?(x=Vs(e,"xAxis",t,n),g=Hs(e,"xAxis",t,n)):(x=Vs(e,"yAxis",r,n),g=Hs(e,"yAxis",r,n)),(a=(s=Hu(x,g,!0))!==null&&s!==void 0?s:m)!==null&&a!==void 0?a:0}},EO=(e,t,r,n)=>{var i=Ct(e),a,s;return i==="horizontal"?(a=Vs(e,"xAxis",t,n),s=Hs(e,"xAxis",t,n)):(a=Vs(e,"yAxis",r,n),s=Hs(e,"yAxis",r,n)),Hu(a,s)};function _G(e,t,r,n,i){var a=n.length;if(!(a<1)){var s=Cn(e,r,0,!0),l,f=[];if(Pn(n[0].barSize)){var h=!1,d=r/a,m=n.reduce((S,T)=>S+(T.barSize||0),0);m+=(a-1)*s,m>=r&&(m-=(a-1)*s,s=0),m>=r&&d>0&&(h=!0,d*=.9,m=a*d);var x=(r-m)/2>>0,g={offset:x-s,size:0};l=n.reduce((S,T)=>{var E,A={stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:g.offset+g.size+s,size:h?d:(E=T.barSize)!==null&&E!==void 0?E:0}},k=[...S,A];return g=k[k.length-1].position,k},f)}else{var _=Cn(t,r,0,!0);r-2*_-(a-1)*s<=0&&(s=0);var w=(r-2*_-(a-1)*s)/a;w>1&&(w>>=0);var b=Pn(i)?Math.min(w,i):w;l=n.reduce((S,T,E)=>[...S,{stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:_+(w+s)*E+(w-b)/2,size:b}}],f)}return l}}var SG=(e,t,r,n,i,a,s)=>{var l=sr(s)?t:s,f=_G(r,n,i!==a?i:a,e,l);return i!==a&&f!=null&&(f=f.map(h=>Jd(Jd({},h),{},{position:Jd(Jd({},h.position),{},{offset:h.position.offset-i/2})}))),f},NG=Te([wG,$P,J$,UP,bG,EO,pG],SG),EG=(e,t,r,n)=>Vs(e,"xAxis",t,n),TG=(e,t,r,n)=>Vs(e,"yAxis",r,n),CG=(e,t,r,n)=>Hs(e,"xAxis",t,n),kG=(e,t,r,n)=>Hs(e,"yAxis",r,n),AG=Te([NG,Cf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),PG=(e,t)=>{var r=iw(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:a}=i;if(a)return a.find(s=>s.key===r)}}}},jG=Te([gG,Cf],PG),OG=Te([Wr,Sy,EG,TG,CG,kG,AG,Ct,lp,EO,jG,Cf,mG],(e,t,r,n,i,a,s,l,f,h,d,m,x)=>{var{chartData:g,dataStartIndex:_,dataEndIndex:w}=f;if(!(m==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||a==null||h==null)){var{data:b}=m,S;if(b!=null&&b.length>0?S=b:S=g?.slice(_,w+1),S!=null)return aG({layout:l,barSettings:m,pos:s,parentViewBox:t,bandSize:h,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:d,displayedData:S,offset:e,cells:x})}}),TO=e=>{var{chartData:t}=e,r=vr(),n=Vn();return v.useEffect(()=>n?()=>{}:(r(hT(t)),()=>{r(hT(void 0))}),[t,r,n]),null},nC={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},CO=Si({name:"brush",initialState:nC,reducers:{setBrushSettings(e,t){return t.payload==null?nC:t.payload}}}),{setBrushSettings:Boe}=CO.actions,DG=CO.reducer;function RG(e,t,r){return(t=IG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IG(e){var t=FG(e,"string");return typeof t=="symbol"?t:t+""}function FG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Xw{static create(t){return new Xw(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?t>=n&&t<=i:t>=i&&t<=n}}RG(Xw,"EPS",1e-4);function MG(e){return(e%180+180)%180}var LG=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=MG(i),s=a*Math.PI/180,l=Math.atan(n/r),f=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(f)},BG={dots:[],areas:[],lines:[]},kO=Si({name:"referenceElements",initialState:BG,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Ha(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Ha(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Ha(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:$oe,removeDot:Uoe,addArea:zoe,removeArea:Woe,addLine:Hoe,removeLine:Voe}=kO.actions,$G=kO.reducer,UG=v.createContext(void 0),zG=e=>{var{children:t}=e,[r]=v.useState("".concat($u("recharts"),"-clip")),n=Kw();if(n==null)return null;var{x:i,y:a,width:s,height:l}=n;return v.createElement(UG.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:i,y:a,height:l,width:s}))),t)};function sc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function AO(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)n.push(e[i]);return n}function WG(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return LG(n,r)}function HG(e,t,r){var n=r==="width",{x:i,y:a,width:s,height:l}=e;return t===1?{start:n?i:a,end:n?i+s:a+l}:{start:n?i+s:a+l,end:n?i:a}}function oh(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-i)<=0}function VG(e,t){return AO(e,t+1)}function KG(e,t,r,n,i){for(var a=(n||[]).slice(),{start:s,end:l}=t,f=0,h=1,d=s,m=function(){var _=n?.[f];if(_===void 0)return{v:AO(n,h)};var w=f,b,S=()=>(b===void 0&&(b=r(_,w)),b),T=_.coordinate,E=f===0||oh(e,T,S,d,l);E||(f=0,d=s,h+=1),E&&(d=T+e*(S()/2+i),f+=h)},x;h<=a.length;)if(x=m(),x)return x.v;return[]}function iC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iC(Object(r),!0).forEach(function(n){GG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GG(e,t,r){return(t=YG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YG(e){var t=XG(e,"string");return typeof t=="symbol"?t:t+""}function XG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qG(e,t,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:l}=t,{end:f}=t,h=function(x){var g=a[x],_,w=()=>(_===void 0&&(_=r(g,x)),_);if(x===s-1){var b=e*(g.coordinate+e*w()/2-f);a[x]=g=bn(bn({},g),{},{tickCoord:b>0?g.coordinate-b*e:g.coordinate})}else a[x]=g=bn(bn({},g),{},{tickCoord:g.coordinate});var S=oh(e,g.tickCoord,w,l,f);S&&(f=g.tickCoord-e*(w()/2+i),a[x]=bn(bn({},g),{},{isShow:!0}))},d=s-1;d>=0;d--)h(d);return a}function ZG(e,t,r,n,i,a){var s=(n||[]).slice(),l=s.length,{start:f,end:h}=t;if(a){var d=n[l-1],m=r(d,l-1),x=e*(d.coordinate+e*m/2-h);s[l-1]=d=bn(bn({},d),{},{tickCoord:x>0?d.coordinate-x*e:d.coordinate});var g=oh(e,d.tickCoord,()=>m,f,h);g&&(h=d.tickCoord-e*(m/2+i),s[l-1]=bn(bn({},d),{},{isShow:!0}))}for(var _=a?l-1:l,w=function(T){var E=s[T],A,k=()=>(A===void 0&&(A=r(E,T)),A);if(T===0){var j=e*(E.coordinate-e*k()/2-f);s[T]=E=bn(bn({},E),{},{tickCoord:j<0?E.coordinate-j*e:E.coordinate})}else s[T]=E=bn(bn({},E),{},{tickCoord:E.coordinate});var P=oh(e,E.tickCoord,k,f,h);P&&(f=E.tickCoord+e*(k()/2+i),s[T]=bn(bn({},E),{},{isShow:!0}))},b=0;b<_;b++)w(b);return s}function qw(e,t,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:l,interval:f,tickFormatter:h,unit:d,angle:m}=e;if(!i||!i.length||!n)return[];if(ft(f)||ro.isSsr){var x;return(x=VG(i,ft(f)?f:0))!==null&&x!==void 0?x:[]}var g=[],_=l==="top"||l==="bottom"?"width":"height",w=d&&_==="width"?ju(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(E,A)=>{var k=typeof h=="function"?h(E.value,A):E.value;return _==="width"?WG(ju(k,{fontSize:t,letterSpacing:r}),w,m):ju(k,{fontSize:t,letterSpacing:r})[_]},S=i.length>=2?Jr(i[1].coordinate-i[0].coordinate):1,T=HG(a,S,_);return f==="equidistantPreserveStart"?KG(S,T,b,i,s):(f==="preserveStart"||f==="preserveStartEnd"?g=ZG(S,T,b,i,s,f==="preserveStartEnd"):g=qG(S,T,b,i,s),g.filter(E=>E.isShow))}var QG=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=e,s=0;if(t){Array.from(t).forEach(d=>{if(d){var m=d.getBoundingClientRect();m.width>s&&(s=m.width)}});var l=r?r.getBoundingClientRect().width:0,f=i+a,h=s+f+l+(r?n:0);return Math.round(h)}return 0},JG=["axisLine","width","height","className","hide","ticks"],eY=["viewBox"],tY=["viewBox"];function E1(e,t){if(e==null)return{};var r,n,i=rY(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function rY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Vo(){return Vo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vo.apply(null,arguments)}function aC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aC(Object(r),!0).forEach(function(n){nY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nY(e,t,r){return(t=iY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iY(e){var t=aY(e,"string");return typeof t=="symbol"?t:t+""}function aY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zw={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function sY(e){var{x:t,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:l,otherSvgProps:f}=e;if(!l)return null;var h=$r($r($r({},f),bi(l)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!s||a==="bottom"&&s);h=$r($r({},h),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var m=+(a==="left"&&!s||a==="right"&&s);h=$r($r({},h),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+i})}return v.createElement("line",Vo({},h,{className:Rt("recharts-cartesian-axis-line",$o(l,"className"))}))}function oY(e,t,r,n,i,a,s,l,f){var h,d,m,x,g,_,w=l?-1:1,b=e.tickSize||s,S=ft(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":h=d=e.coordinate,x=r+ +!l*i,m=x-w*b,_=m-w*f,g=S;break;case"left":m=x=e.coordinate,d=t+ +!l*n,h=d-w*b,g=h-w*f,_=S;break;case"right":m=x=e.coordinate,d=t+ +l*n,h=d+w*b,g=h+w*f,_=S;break;default:h=d=e.coordinate,x=r+ +l*i,m=x+w*b,_=m+w*f,g=S;break}return{line:{x1:h,y1:m,x2:d,y2:x},tick:{x:g,y:_}}}function lY(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function cY(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function uY(e){var{option:t,tickProps:r,value:n}=e,i,a=Rt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))i=v.cloneElement(t,$r($r({},r),{},{className:a}));else if(typeof t=="function")i=t($r($r({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=Rt(s,t?.className)),i=v.createElement(bp,Vo({},r,{className:s}),n)}return i}function fY(e){var{ticks:t=[],tick:r,tickLine:n,stroke:i,tickFormatter:a,unit:s,padding:l,tickTextProps:f,orientation:h,mirror:d,x:m,y:x,width:g,height:_,tickSize:w,tickMargin:b,fontSize:S,letterSpacing:T,getTicksConfig:E,events:A}=e,k=qw($r($r({},E),{},{ticks:t}),S,T),j=lY(h,d),P=cY(h,d),M=bi(E),L=Bo(r),B={};typeof n=="object"&&(B=n);var R=$r($r({},M),{},{fill:"none"},B),U=k.map((oe,V)=>{var{line:ae,tick:le}=oY(oe,m,x,g,_,h,w,d,b),J=$r($r($r($r({textAnchor:j,verticalAnchor:P},M),{},{stroke:"none",fill:i},L),le),{},{index:V,payload:oe,visibleTicksCount:k.length,tickFormatter:a,padding:l},f);return v.createElement(dn,Vo({className:"recharts-cartesian-axis-tick",key:"tick-".concat(oe.value,"-").concat(oe.coordinate,"-").concat(oe.tickCoord)},zh(A,oe,V)),n&&v.createElement("line",Vo({},R,ae,{className:Rt("recharts-cartesian-axis-tick-line",$o(n,"className"))})),r&&v.createElement(uY,{option:r,tickProps:J,value:"".concat(typeof a=="function"?a(oe.value,V):oe.value).concat(s||"")}))});return U.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},U):null}var dY=v.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:a,hide:s,ticks:l}=e,f=E1(e,JG),[h,d]=v.useState(""),[m,x]=v.useState(""),g=v.useRef(null);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var w;return QG({ticks:g.current,label:(w=e.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var _=v.useCallback(w=>{if(w){var b=w.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=b;var S=b[0];if(S){var T=window.getComputedStyle(S),E=T.fontSize,A=T.letterSpacing;(E!==h||A!==m)&&(d(E),x(A))}}},[h,m]);return s||n!=null&&n<=0||i!=null&&i<=0?null:v.createElement(dn,{className:Rt("recharts-cartesian-axis",a),ref:_},v.createElement(sY,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:bi(e)}),v.createElement(fY,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:h,letterSpacing:m,getTicksConfig:e,events:f}),v.createElement(pH,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(NH,{label:e.label,labelRef:e.labelRef}),e.children))}),hY=v.memo(dY,(e,t)=>{var{viewBox:r}=e,n=E1(e,eY),{viewBox:i}=t,a=E1(t,tY);return sc(r,i)&&sc(n,a)}),Qw=v.forwardRef((e,t)=>{var r=pn(e,Zw);return v.createElement(hY,Vo({},r,{ref:t}))});Qw.displayName="CartesianAxis";var pY=["x1","y1","x2","y2","key"],mY=["offset"],xY=["xAxisId","yAxisId"],gY=["xAxisId","yAxisId"];function sC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function En(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sC(Object(r),!0).forEach(function(n){vY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vY(e,t,r){return(t=yY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=wY(e,"string");return typeof t=="symbol"?t:t+""}function wY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jo(){return jo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jo.apply(null,arguments)}function lh(e,t){if(e==null)return{};var r,n,i=bY(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function bY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _Y=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:l}=e;return v.createElement("rect",{x:n,y:i,ry:l,width:a,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function PO(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:i,x2:a,y2:s,key:l}=t,f=lh(t,pY),h=bi(f),{offset:d}=h,m=lh(h,mY);r=v.createElement("line",jo({},m,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:l}))}return r}function SY(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=e,l=lh(e,xY),f=i.map((h,d)=>{var m=En(En({},l),{},{x1:t,y1:h,x2:t+r,y2:h,key:"line-".concat(d),index:d});return PO(n,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function NY(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=e,l=lh(e,gY),f=i.map((h,d)=>{var m=En(En({},l),{},{x1:h,y1:t,x2:h,y2:t+r,key:"line-".concat(d),index:d});return PO(n,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function EY(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:l,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var h=l.map(m=>Math.round(m+i-i)).sort((m,x)=>m-x);i!==h[0]&&h.unshift(0);var d=h.map((m,x)=>{var g=!h[x+1],_=g?i+s-m:h[x+1]-m;if(_<=0)return null;var w=x%t.length;return v.createElement("rect",{key:"react-".concat(x),y:m,x:n,height:_,width:a,stroke:"none",fill:t[w],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function TY(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:l,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var h=f.map(m=>Math.round(m+i-i)).sort((m,x)=>m-x);i!==h[0]&&h.unshift(0);var d=h.map((m,x)=>{var g=!h[x+1],_=g?i+s-m:h[x+1]-m;if(_<=0)return null;var w=x%r.length;return v.createElement("rect",{key:"react-".concat(x),x:m,y:a,width:_,height:l,stroke:"none",fill:r[w],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var CY=(e,t)=>{var{xAxis:r,width:n,height:i,offset:a}=e;return bA(qw(En(En(En({},Zw),r),{},{ticks:_A(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,t)},kY=(e,t)=>{var{yAxis:r,width:n,height:i,offset:a}=e;return bA(qw(En(En(En({},Zw),r),{},{ticks:_A(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,t)},AY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function T1(e){var t=PA(),r=jA(),n=AA(),i=En(En({},pn(e,AY)),{},{x:ft(e.x)?e.x:n.left,y:ft(e.y)?e.y:n.top,width:ft(e.width)?e.width:n.width,height:ft(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:s,x:l,y:f,width:h,height:d,syncWithTicks:m,horizontalValues:x,verticalValues:g}=i,_=Vn(),w=ct(L=>iT(L,"xAxis",a,_)),b=ct(L=>iT(L,"yAxis",s,_));if(!ft(h)||h<=0||!ft(d)||d<=0||!ft(l)||l!==+l||!ft(f)||f!==+f)return null;var S=i.verticalCoordinatesGenerator||CY,T=i.horizontalCoordinatesGenerator||kY,{horizontalPoints:E,verticalPoints:A}=i;if((!E||!E.length)&&typeof T=="function"){var k=x&&x.length,j=T({yAxis:b?En(En({},b),{},{ticks:k?x:b.ticks}):void 0,width:t,height:r,offset:n},k?!0:m);$0(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(E=j)}if((!A||!A.length)&&typeof S=="function"){var P=g&&g.length,M=S({xAxis:w?En(En({},w),{},{ticks:P?g:w.ticks}):void 0,width:t,height:r,offset:n},P?!0:m);$0(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(A=M)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(_Y,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),v.createElement(EY,jo({},i,{horizontalPoints:E})),v.createElement(TY,jo({},i,{verticalPoints:A})),v.createElement(SY,jo({},i,{offset:n,horizontalPoints:E,xAxis:w,yAxis:b})),v.createElement(NY,jo({},i,{offset:n,verticalPoints:A,xAxis:w,yAxis:b})))}T1.displayName="CartesianGrid";var jO=(e,t,r,n)=>Vs(e,"xAxis",t,n),OO=(e,t,r,n)=>Hs(e,"xAxis",t,n),DO=(e,t,r,n)=>Vs(e,"yAxis",r,n),RO=(e,t,r,n)=>Hs(e,"yAxis",r,n),PY=Te([Ct,jO,DO,OO,RO],(e,t,r,n,i)=>to(e,"xAxis")?Hu(t,n,!1):Hu(r,i,!1)),jY=(e,t,r,n,i)=>i;function OY(e){return e.type==="line"}var DY=Te([mp,jY],(e,t)=>e.filter(OY).find(r=>r.id===t)),RY=Te([Ct,jO,DO,OO,RO,DY,PY,lp],(e,t,r,n,i,a,s,l)=>{var{chartData:f,dataStartIndex:h,dataEndIndex:d}=l;if(!(a==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:m,data:x}=a,g;if(x!=null&&x.length>0?g=x:g=f?.slice(h,d+1),g!=null)return nX({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:m,bandSize:s,displayedData:g})}});function IY(e){var t=Bo(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:a}=t,s=Number(i),l=Number(a);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(l)||l<0)&&(l=n),{r:s,strokeWidth:l}}return{r,strokeWidth:n}}var FY=["id"],MY=["type","layout","connectNulls","needClip"],LY=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function oC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oC(Object(r),!0).forEach(function(n){BY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BY(e,t,r){return(t=$Y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Y(e){var t=UY(e,"string");return typeof t=="symbol"?t:t+""}function UY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jw(e,t){if(e==null)return{};var r,n,i=zY(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ko.apply(null,arguments)}var WY=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:n,value:pc(r,t),payload:e}]};function HY(e){var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:l,unit:f}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:t,nameKey:void 0,name:pc(s,t),hide:l,type:e.tooltipType,color:e.stroke,unit:f}}}var IO=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function VY(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var KY=(e,t,r)=>{var n=r.reduce((m,x)=>m+x);if(!n)return IO(t,e);for(var i=Math.floor(e/n),a=e%n,s=t-e,l=[],f=0,h=0;f<r.length;h+=r[f],++f)if(h+r[f]>a){l=[...r.slice(0,f),a-h];break}var d=l.length%2===0?[0,s]:[s];return[...VY(r,i),...l,...d].map(m=>"".concat(m,"px")).join(", ")};function GY(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Rt("recharts-line-dot",typeof e!="boolean"?e.className:"");r=v.createElement(oO,Ko({},t,{className:n}))}return r}function YY(e,t){return e==null?!1:t?!0:e.length===1}function XY(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:a,needClip:s}=n;if(!YY(r,i))return null;var{id:l}=n,f=Jw(n,FY),h=hO(i),d=bi(f),m=eF(i),x=r.map((_,w)=>{var b=pi(pi(pi({key:"dot-".concat(w),r:3},d),m),{},{index:w,cx:_.x,cy:_.y,dataKey:a,value:_.value,payload:_.payload,points:r});return GY(i,b)}),g={clipPath:s?"url(#clipPath-".concat(h?"":"dots-").concat(t,")"):void 0};return v.createElement(dn,Ko({className:"recharts-line-dots",key:"dots"},g),x)}function qY(e){var{showLabels:t,children:r,points:n}=e,i=v.useMemo(()=>n?.map(a=>{var s={x:a.x,y:a.y,width:0,height:0};return pi(pi({},s),{},{value:a.value,payload:a.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return v.createElement(aO,{value:t?i:null},r)}function lC(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:a}=e,{type:s,layout:l,connectNulls:f,needClip:h}=a,d=Jw(a,MY),m=pi(pi({},Hn(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:l,connectNulls:f,strokeDasharray:i??a.strokeDasharray});return v.createElement(v.Fragment,null,n?.length>1&&v.createElement(Ey,Ko({},m,{pathRef:r})),v.createElement(XY,{points:n,clipPathId:t,props:a}))}function ZY(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function QY(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=e,{points:s,strokeDasharray:l,isAnimationActive:f,animationBegin:h,animationDuration:d,animationEasing:m,animateNewValues:x,width:g,height:_,onAnimationEnd:w,onAnimationStart:b}=r,S=i.current,T=pf(r,"recharts-line-"),[E,A]=v.useState(!1),k=!E,j=v.useCallback(()=>{typeof w=="function"&&w(),A(!1)},[w]),P=v.useCallback(()=>{typeof b=="function"&&b(),A(!0)},[b]),M=ZY(n.current),L=a.current;return v.createElement(qY,{points:s,showLabels:k},r.children,v.createElement(hf,{animationId:T,begin:h,duration:d,isActive:f,easing:m,onAnimationEnd:j,onAnimationStart:P,key:T},B=>{var R=gr(L,M+L,B),U=Math.min(R,M),oe;if(f)if(l){var V="".concat(l).split(/[,\s]+/gim).map(J=>parseFloat(J));oe=KY(U,M,V)}else oe=IO(M,U);else oe=l==null?void 0:String(l);if(S){var ae=S.length/s.length,le=B===1?s:s.map((J,re)=>{var Z=Math.floor(re*ae);if(S[Z]){var se=S[Z];return pi(pi({},J),{},{x:gr(se.x,J.x,B),y:gr(se.y,J.y,B)})}return x?pi(pi({},J),{},{x:gr(g*2,J.x,B),y:gr(_/2,J.y,B)}):pi(pi({},J),{},{x:J.x,y:J.y})});return i.current=le,v.createElement(lC,{props:r,points:le,clipPathId:t,pathRef:n,strokeDasharray:oe})}return B>0&&M>0&&(i.current=s,a.current=U),v.createElement(lC,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:oe})}),v.createElement(Fw,{label:r.label}))}function JY(e){var{clipPathId:t,props:r}=e,n=v.useRef(null),i=v.useRef(0),a=v.useRef(null);return v.createElement(QY,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:a})}var eX=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Yt(e.payload,t)});class tX extends v.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:a,yAxisId:s,top:l,left:f,width:h,height:d,id:m,needClip:x}=this.props;if(t)return null;var g=Rt("recharts-line",i),_=m,{r:w,strokeWidth:b}=IY(r),S=hO(r),T=w*2+b;return v.createElement(v.Fragment,null,v.createElement(dn,{className:g},x&&v.createElement("defs",null,v.createElement(SO,{clipPathId:_,xAxisId:a,yAxisId:s}),!S&&v.createElement("clipPath",{id:"clipPath-dots-".concat(_)},v.createElement("rect",{x:f-T/2,y:l-T/2,width:h+T,height:d+T}))),v.createElement(_O,{xAxisId:a,yAxisId:s,data:n,dataPointFormatter:eX,errorBarOffset:0},v.createElement(JY,{props:this.props,clipPathId:_}))),v.createElement(wK,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var FO={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!ro.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function rX(e){var t=pn(e,FO),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:l,dot:f,hide:h,isAnimationActive:d,label:m,legendType:x,xAxisId:g,yAxisId:_,id:w}=t,b=Jw(t,LY),{needClip:S}=Yw(g,_),T=Kw(),E=ep(),A=Vn(),k=ct(B=>RY(B,g,_,A,w));if(E!=="horizontal"&&E!=="vertical"||k==null||T==null)return null;var{height:j,width:P,x:M,y:L}=T;return v.createElement(tX,Ko({},b,{id:w,connectNulls:l,dot:f,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:d,hide:h,label:m,legendType:x,xAxisId:g,yAxisId:_,points:k,layout:E,height:j,width:P,left:M,top:L,needClip:S}))}function nX(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:l,displayedData:f}=e;return f.map((h,d)=>{var m=Yt(h,s);if(t==="horizontal"){var x=RN({axis:r,ticks:i,bandSize:l,entry:h,index:d}),g=sr(m)?null:n.scale(m);return{x,y:g,value:m,payload:h}}var _=sr(m)?null:r.scale(m),w=RN({axis:n,ticks:a,bandSize:l,entry:h,index:d});return _==null||w==null?null:{x:_,y:w,value:m,payload:h}}).filter(Boolean)}function iX(e){var t=pn(e,FO),r=Vn();return v.createElement(Hw,{id:t.id,type:"line"},n=>v.createElement(v.Fragment,null,v.createElement(xO,{legendPayload:WY(t)}),v.createElement(Ww,{fn:HY,args:t}),v.createElement(vO,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),v.createElement(rX,Ko({},t,{id:n}))))}var MO=v.memo(iX);MO.displayName="Line";var aX=["dangerouslySetInnerHTML","ticks"],sX=["id"],oX=["domain"],lX=["domain"];function C1(){return C1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C1.apply(null,arguments)}function ch(e,t){if(e==null)return{};var r,n,i=cX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function cX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function uX(e){var t=vr();return v.useLayoutEffect(()=>(t(oK(e)),()=>{t(lK(e))}),[e,t]),null}var fX=e=>{var{xAxisId:t,className:r}=e,n=ct(Sy),i=Vn(),a="xAxis",s=ct(b=>_c(b,a,t,i)),l=ct(b=>yj(b,a,t,i)),f=ct(b=>mj(b,t)),h=ct(b=>YU(b,t)),d=ct(b=>qP(b,t));if(f==null||h==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=e,g=ch(e,aX),{id:_}=d,w=ch(d,sX);return v.createElement(Qw,C1({},g,w,{scale:s,x:h.x,y:h.y,width:f.width,height:f.height,className:Rt("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:l}))},dX={allowDataOverflow:ui.allowDataOverflow,allowDecimals:ui.allowDecimals,allowDuplicatedCategory:ui.allowDuplicatedCategory,height:ui.height,hide:!1,mirror:ui.mirror,orientation:ui.orientation,padding:ui.padding,reversed:ui.reversed,scale:ui.scale,tickCount:ui.tickCount,type:ui.type,xAxisId:0},hX=e=>{var t,r,n,i,a,s=pn(e,dX);return v.createElement(v.Fragment,null,v.createElement(uX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(i=s.minTickGap)!==null&&i!==void 0?i:5,tick:(a=s.tick)!==null&&a!==void 0?a:!0,tickFormatter:s.tickFormatter}),v.createElement(fX,s))},pX=(e,t)=>{var{domain:r}=e,n=ch(e,oX),{domain:i}=t,a=ch(t,lX);return sc(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:sc({domain:r},{domain:i}):!1},k1=v.memo(hX,pX);k1.displayName="XAxis";var mX=["dangerouslySetInnerHTML","ticks"],xX=["id"],gX=["domain"],vX=["domain"];function A1(){return A1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A1.apply(null,arguments)}function uh(e,t){if(e==null)return{};var r,n,i=yX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function yX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wX(e){var t=vr();return v.useLayoutEffect(()=>(t(cK(e)),()=>{t(uK(e))}),[e,t]),null}var bX=e=>{var{yAxisId:t,className:r,width:n,label:i}=e,a=v.useRef(null),s=v.useRef(null),l=ct(Sy),f=Vn(),h=vr(),d="yAxis",m=ct(k=>_c(k,d,t,f)),x=ct(k=>xj(k,t)),g=ct(k=>qU(k,t)),_=ct(k=>yj(k,d,t,f)),w=ct(k=>ZP(k,t));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!x||Iw(i)||v.isValidElement(i)||w==null)){var k=a.current;if(k){var j=k.getCalculatedWidth();Math.round(x.width)!==Math.round(j)&&h(fK({id:t,width:j}))}}},[_,x,h,i,t,n,w]),x==null||g==null||w==null)return null;var{dangerouslySetInnerHTML:b,ticks:S}=e,T=uh(e,mX),{id:E}=w,A=uh(w,xX);return v.createElement(Qw,A1({},T,A,{ref:a,labelRef:s,scale:m,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:x.width,height:x.height,className:Rt("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:_}))},_X={allowDataOverflow:fi.allowDataOverflow,allowDecimals:fi.allowDecimals,allowDuplicatedCategory:fi.allowDuplicatedCategory,hide:!1,mirror:fi.mirror,orientation:fi.orientation,padding:fi.padding,reversed:fi.reversed,scale:fi.scale,tickCount:fi.tickCount,type:fi.type,width:fi.width,yAxisId:0},SX=e=>{var t,r,n,i,a,s=pn(e,_X);return v.createElement(v.Fragment,null,v.createElement(wX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(i=s.minTickGap)!==null&&i!==void 0?i:5,tick:(a=s.tick)!==null&&a!==void 0?a:!0,tickFormatter:s.tickFormatter}),v.createElement(bX,s))},NX=(e,t)=>{var{domain:r}=e,n=uh(e,gX),{domain:i}=t,a=uh(t,vX);return sc(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:sc({domain:r},{domain:i}):!1},P1=v.memo(SX,NX);P1.displayName="YAxis";var Qg={exports:{}},Jg={};var cC;function EX(){if(cC)return Jg;cC=1;var e=fc();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,i=e.useRef,a=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Jg.useSyncExternalStoreWithSelector=function(f,h,d,m,x){var g=i(null);if(g.current===null){var _={hasValue:!1,value:null};g.current=_}else _=g.current;g=s(function(){function b(k){if(!S){if(S=!0,T=k,k=m(k),x!==void 0&&_.hasValue){var j=_.value;if(x(j,k))return E=j}return E=k}if(j=E,r(T,k))return j;var P=m(k);return x!==void 0&&x(j,P)?(T=k,j):(T=k,E=P)}var S=!1,T,E,A=d===void 0?null:d;return[function(){return b(h())},A===null?void 0:function(){return b(A())}]},[h,d,m,x]);var w=n(f,g[0],g[1]);return a(function(){_.hasValue=!0,_.value=w},[w]),l(w),w},Jg}var uC;function TX(){return uC||(uC=1,Qg.exports=EX()),Qg.exports}TX();function CX(e){e()}function kX(){let e=null,t=null;return{clear(){e=null,t=null},notify(){CX(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var fC={notify(){},get:()=>[]};function AX(e,t){let r,n=fC,i=0,a=!1;function s(w){d();const b=n.subscribe(w);let S=!1;return()=>{S||(S=!0,b(),m())}}function l(){n.notify()}function f(){_.onStateChange&&_.onStateChange()}function h(){return a}function d(){i++,r||(r=e.subscribe(f),n=kX())}function m(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=fC)}function x(){a||(a=!0,d())}function g(){a&&(a=!1,m())}const _={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:f,isSubscribed:h,trySubscribe:x,tryUnsubscribe:g,getListeners:()=>n};return _}var PX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jX=PX(),OX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",DX=OX(),RX=()=>jX||DX?v.useLayoutEffect:v.useEffect,IX=RX(),FX=Symbol.for("react-redux-context"),MX=typeof globalThis<"u"?globalThis:{};function LX(){if(!v.createContext)return{};const e=MX[FX]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var BX=LX();function $X(e){const{children:t,context:r,serverState:n,store:i}=e,a=v.useMemo(()=>{const f=AX(i);return{store:i,subscription:f,getServerState:n?()=>n:void 0}},[i,n]),s=v.useMemo(()=>i.getState(),[i]);IX(()=>{const{subscription:f}=a;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),s!==i.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[a,s]);const l=r||BX;return v.createElement(l.Provider,{value:a},t)}var UX=$X,zX=(e,t)=>t,eb=Te([zX,Ct,GP,Vr,Fj,us,tW,Wr],sW),tb=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},LO=$i("mouseClick"),BO=ff();BO.startListening({actionCreator:LO,effect:(e,t)=>{var r=e.payload,n=eb(t.getState(),tb(r));n?.activeIndex!=null&&t.dispatch(cz({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var j1=$i("mouseMove"),$O=ff();$O.startListening({actionCreator:j1,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=Ew(n,n.tooltip.settings.shared),a=eb(n,tb(r));i==="axis"&&(a?.activeIndex!=null?t.dispatch(Cj({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(Tj()))}});var dC={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},UO=Si({name:"rootProps",initialState:dC,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:dC.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),WX=UO.reducer,{updateOptions:HX}=UO.actions,zO=Si({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:VX}=zO.actions,KX=zO.reducer,WO=$i("keyDown"),HO=$i("focus"),rb=ff();rb.startListening({actionCreator:WO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Tw(i,Nc(r))),l=us(r);if(a==="Enter"){var f=rh(r,"axis","hover",String(i.index));t.dispatch(g1({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:f}));return}var h=ez(r),d=h==="left-to-right"?1:-1,m=a==="ArrowRight"?1:-1,x=s+m*d;if(!(l==null||x>=l.length||x<0)){var g=rh(r,"axis","hover",String(x));t.dispatch(g1({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});rb.startListening({actionCreator:HO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=rh(r,"axis","hover",String(a));t.dispatch(g1({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Oi=$i("externalEvent"),VO=ff();VO.startListening({actionCreator:Oi,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Vz(r),activeDataKey:$j(r),activeIndex:Ks(r),activeLabel:Bj(r),activeTooltipIndex:Ks(r),isTooltipActive:Kz(r)};e.payload.handler(n,e.payload.reactEvent)}}});var GX=Te([Sc],e=>e.tooltipItemPayloads),YX=Te([GX,Nf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var i=e.find(l=>l.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=t(a,r);return s}}}),KO=$i("touchMove"),GO=ff();GO.startListening({actionCreator:KO,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=Ew(n,n.tooltip.settings.shared);if(i==="axis"){var a=eb(n,tb({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(Cj({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,l=r.touches[0],f=document.elementFromPoint(l.clientX,l.clientY);if(!f||!f.getAttribute)return;var h=f.getAttribute(NA),d=(s=f.getAttribute(EA))!==null&&s!==void 0?s:void 0,m=YX(t.getState(),h,d);t.dispatch(Ej({activeDataKey:d,activeIndex:h,activeCoordinate:m}))}}});var XX=Y4({brush:DG,cartesianAxis:dK,chartData:_W,errorBars:OK,graphicalItems:jV,layout:K8,legend:qL,options:gW,polarAxis:VH,polarOptions:KX,referenceElements:$G,rootProps:WX,tooltip:uz}),qX=function(t){return g8({reducer:XX,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([BO.middleware,$O.middleware,rb.middleware,VO.middleware,GO.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(sA({type:"raf"}))},devTools:ro.devToolsEnabled})};function YO(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Vn(),a=v.useRef(null);if(i)return r;a.current==null&&(a.current=qX(t));var s=gy;return v.createElement(UX,{context:s,store:a.current},r)}function XO(e){var{layout:t,margin:r}=e,n=vr(),i=Vn();return v.useEffect(()=>{i||(n(W8(t)),n(z8(r)))},[n,i,t,r]),null}function qO(e){var t=vr();return v.useEffect(()=>{t(HX(e))},[t,e]),null}var ZX=["children"];function QX(e,t){if(e==null)return{};var r,n,i=JX(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fh(){return fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fh.apply(null,arguments)}var eq={width:"100%",height:"100%",display:"block"},tq=v.forwardRef((e,t)=>{var r=PA(),n=jA(),i=IA();if(!rc(r)||!rc(n))return null;var{children:a,otherAttributes:s,title:l,desc:f}=e,h,d;return typeof s.tabIndex=="number"?h=s.tabIndex:h=i?0:void 0,typeof s.role=="string"?d=s.role:d=i?"application":void 0,v.createElement(d4,fh({},s,{title:l,desc:f,role:d,tabIndex:h,width:r,height:n,style:eq,ref:t}),a)}),rq=e=>{var{children:t}=e,r=ct(Qh);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return v.createElement(d4,{width:n,height:i,x:s,y:a},t)},hC=v.forwardRef((e,t)=>{var{children:r}=e,n=QX(e,ZX),i=Vn();return i?v.createElement(rq,null,r):v.createElement(tq,fh({ref:t},n),r)});function nq(){var e=vr(),[t,r]=v.useState(null),n=ct(bL);return v.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),a=i.width/t.offsetWidth;Pn(a)&&a!==n&&e(V8(a))}},[t,e,n]),r}function pC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pC(Object(r),!0).forEach(function(n){aq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aq(e,t,r){return(t=sq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sq(e){var t=oq(e,"string");return typeof t=="symbol"?t:t+""}function oq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Go(){return Go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Go.apply(null,arguments)}var lq=()=>(jW(),null);function dh(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var cq=v.forwardRef((e,t)=>{var r,n,i=v.useRef(null),[a,s]=v.useState({containerWidth:dh((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:dh((n=e.style)===null||n===void 0?void 0:n.height)}),l=v.useCallback((h,d)=>{s(m=>{var x=Math.round(h),g=Math.round(d);return m.containerWidth===x&&m.containerHeight===g?m:{containerWidth:x,containerHeight:g}})},[]),f=v.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null){var{width:d,height:m}=h.getBoundingClientRect();l(d,m);var x=_=>{var{width:w,height:b}=_[0].contentRect;l(w,b)},g=new ResizeObserver(x);g.observe(h),i.current=g}},[t,l]);return v.useEffect(()=>()=>{var h=i.current;h?.disconnect()},[l]),v.createElement(v.Fragment,null,v.createElement(tp,{width:a.containerWidth,height:a.containerHeight}),v.createElement("div",Go({ref:f},e)))}),uq=v.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,a]=v.useState({containerWidth:dh(r),containerHeight:dh(n)}),s=v.useCallback((f,h)=>{a(d=>{var m=Math.round(f),x=Math.round(h);return d.containerWidth===m&&d.containerHeight===x?d:{containerWidth:m,containerHeight:x}})},[]),l=v.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:h,height:d}=f.getBoundingClientRect();s(h,d)}},[t,s]);return v.createElement(v.Fragment,null,v.createElement(tp,{width:i.containerWidth,height:i.containerHeight}),v.createElement("div",Go({ref:l},e)))}),fq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return v.createElement(v.Fragment,null,v.createElement(tp,{width:r,height:n}),v.createElement("div",Go({ref:t},e)))}),dq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return Za(r)||Za(n)?v.createElement(uq,Go({},e,{ref:t})):v.createElement(fq,Go({},e,{ref:t}))});function hq(e){return e===!0?cq:dq}var pq=v.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:l,onMouseDown:f,onMouseEnter:h,onMouseLeave:d,onMouseMove:m,onMouseUp:x,onTouchEnd:g,onTouchMove:_,onTouchStart:w,style:b,width:S,responsive:T,dispatchTouchEvents:E=!0}=e,A=v.useRef(null),k=vr(),[j,P]=v.useState(null),[M,L]=v.useState(null),B=nq(),R=Ny(),U=R?.width>0?R.width:S,oe=R?.height>0?R.height:i,V=v.useCallback(D=>{B(D),typeof t=="function"&&t(D),P(D),L(D),D!=null&&(A.current=D)},[B,t,P,L]),ae=v.useCallback(D=>{k(LO(D)),k(Oi({handler:a,reactEvent:D}))},[k,a]),le=v.useCallback(D=>{k(j1(D)),k(Oi({handler:h,reactEvent:D}))},[k,h]),J=v.useCallback(D=>{k(Tj()),k(Oi({handler:d,reactEvent:D}))},[k,d]),re=v.useCallback(D=>{k(j1(D)),k(Oi({handler:m,reactEvent:D}))},[k,m]),Z=v.useCallback(()=>{k(HO())},[k]),se=v.useCallback(D=>{k(WO(D.key))},[k]),G=v.useCallback(D=>{k(Oi({handler:s,reactEvent:D}))},[k,s]),ne=v.useCallback(D=>{k(Oi({handler:l,reactEvent:D}))},[k,l]),ie=v.useCallback(D=>{k(Oi({handler:f,reactEvent:D}))},[k,f]),de=v.useCallback(D=>{k(Oi({handler:x,reactEvent:D}))},[k,x]),ge=v.useCallback(D=>{k(Oi({handler:w,reactEvent:D}))},[k,w]),Oe=v.useCallback(D=>{E&&k(KO(D)),k(Oi({handler:_,reactEvent:D}))},[k,E,_]),fe=v.useCallback(D=>{k(Oi({handler:g,reactEvent:D}))},[k,g]),O=hq(T);return v.createElement(Kj.Provider,{value:j},v.createElement(oF.Provider,{value:M},v.createElement(O,{width:U??b?.width,height:oe??b?.height,className:Rt("recharts-wrapper",n),style:iq({position:"relative",cursor:"default",width:U,height:oe},b),onClick:ae,onContextMenu:G,onDoubleClick:ne,onFocus:Z,onKeyDown:se,onMouseDown:ie,onMouseEnter:le,onMouseLeave:J,onMouseMove:re,onMouseUp:de,onTouchEnd:fe,onTouchMove:Oe,onTouchStart:ge,ref:V},v.createElement(lq,null),r)))}),mq=["width","height","responsive","children","className","style","compact","title","desc"];function xq(e,t){if(e==null)return{};var r,n,i=gq(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function gq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZO=v.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:a,className:s,style:l,compact:f,title:h,desc:d}=e,m=xq(e,mq),x=bi(m);return f?v.createElement(v.Fragment,null,v.createElement(tp,{width:r,height:n}),v.createElement(hC,{otherAttributes:x,title:h,desc:d},a)):v.createElement(pq,{className:s,style:l,width:r,height:n,responsive:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(hC,{otherAttributes:x,title:h,desc:d,ref:t},v.createElement(zG,null,a)))});function O1(){return O1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O1.apply(null,arguments)}var vq={top:5,right:5,bottom:5,left:5},yq={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:vq,reverseStackOrder:!1,syncMethod:"index",responsive:!1},QO=v.forwardRef(function(t,r){var n,i=pn(t.categoricalChartProps,yq),{chartName:a,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:f,categoricalChartProps:h}=t,d={chartName:a,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(YO,{preloadedState:{options:d},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:a},v.createElement(TO,{chartData:h.data}),v.createElement(XO,{layout:i.layout,margin:i.margin}),v.createElement(qO,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),v.createElement(ZO,O1({},i,{ref:r})))}),wq=["axis"],bq=v.forwardRef((e,t)=>v.createElement(QO,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:wq,tooltipPayloadSearcher:Rw,categoricalChartProps:e,ref:t})),_q=["axis","item"],Sq=v.forwardRef((e,t)=>v.createElement(QO,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:_q,tooltipPayloadSearcher:Rw,categoricalChartProps:e,ref:t}));function Nq(e){var t=vr();return v.useEffect(()=>{t(VX(e))},[t,e]),null}var Eq=["layout"];function D1(){return D1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D1.apply(null,arguments)}function Tq(e,t){if(e==null)return{};var r,n,i=Cq(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Cq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kq={top:5,right:5,bottom:5,left:5},Aq={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:kq,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},Pq=v.forwardRef(function(t,r){var n,i=pn(t.categoricalChartProps,Aq),{layout:a}=i,s=Tq(i,Eq),{chartName:l,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:d}=t,m={chartName:l,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:d,eventEmitter:void 0};return v.createElement(YO,{preloadedState:{options:m},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},v.createElement(TO,{chartData:i.data}),v.createElement(XO,{layout:a,margin:i.margin}),v.createElement(qO,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),v.createElement(Nq,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),v.createElement(ZO,D1({},s,{ref:r})))}),jq=["item"],Oq={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Dq=v.forwardRef((e,t)=>{var r=pn(e,Oq);return v.createElement(Pq,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:jq,tooltipPayloadSearcher:Rw,categoricalChartProps:r,ref:t})});const tr={idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status",checkFlag:"check_flag"},Ol={id:"id",orderCode:"id_order",paidDate:"payment_date",amount:"amount",receiver:"receiver",note:"note",sender:"sender"},ev={id:"id",sourceName:"source_name"},tv={sourceId:"source_id",price:"price"},Nr={product:"id_product",pctCtv:"pct_ctv",pctKhach:"pct_khach",isActive:"is_active",package:"package",packageProduct:"package_product",update:"update",pctPromo:"pct_promo"},R1=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},Fs=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),i=String(r.getUTCMonth()+1).padStart(2,"0"),a=r.getUTCFullYear();return`${n}/${i}/${a}`},Rq=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,i,a]=e.split("/").map(Number),s=new Date(a,i-1,n);return s.setMonth(s.getMonth()+t),s.setDate(s.getDate()-1),`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()}`},Iq=(e,t)=>{const[r,n,i]=e.split("/").map(Number),[a,s,l]=t.split("/").map(Number),f=new Date(i,n-1,r),h=new Date(l,s-1,a),d=1440*60*1e3;return Math.floor((h.getTime()-f.getTime())/d)+1},mC=e=>String(e).padStart(2,"0"),nb=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[i,a,s]=t.split("/").map(Number);return!i||!a||!s?null:new Date(s,a-1,i)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,i,a,s]=r.map(Number);return!s||!a||!i?null:new Date(i,a-1,s)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},Pr=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,i,a,s]=r;return`${s}/${a}/${i}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,i,a,s]=n;return`${s}/${a}/${i}`}}const t=nb(e);return t?`${mC(t.getDate())}/${mC(t.getMonth()+1)}/${t.getFullYear()}`:""},Fq=e=>{const t=nb(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},JO=e=>{const t=nb(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},xC=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},e3=e=>{const t=Number(e);return Number.isFinite(t)?t:0},ta=e=>{const t=e3(e),r=1e3;return Number.isFinite(t)?Math.round(t/r)*r:0},ga=e=>`${ta(e).toLocaleString("vi-VN")} `,gC=e=>{const t=e3(e);return t>0?t.toLocaleString("vi-VN"):""},Mq=e=>!Number.isFinite(e)||e<=0?"0":e>=1e9?`${(e/1e9).toFixed(1)}B`:e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${Math.round(e).toLocaleString("vi-VN")}`,t3=(e,t,r=[])=>{const n=e||"";if(!n)return;const i=r.find(l=>(l[ev.sourceName]||l.name||"")===n)?.[ev.id]??null;if(i!==null){const f=t.find(h=>h[tv.sourceId]===i)?.[tv.price];if(Number.isFinite(f))return Number(f)}const s=t.find(l=>(l[ev.sourceName]||"")===n)?.[tv.price];return Number.isFinite(s)?Number(s):void 0},vC=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),r3=e=>n3(e).color,yC=e=>n3(e).priority,e0={PAID:" Thanh Ton",UNPAID:"Cha Thanh Ton",EXPIRED:"Ht Hn",RENEWAL:"Cn Gia Hn"},Lq={[e0.EXPIRED]:{color:"bg-red-600 text-white",priority:1},[e0.RENEWAL]:{color:"bg-orange-500 text-white",priority:2},[e0.UNPAID]:{color:"bg-yellow-500 text-slate-900",priority:3},[e0.PAID]:{color:"bg-green-600 text-white",priority:4}},n3=e=>Lq[e?.trim()]||{color:"bg-slate-600 text-white",priority:5},ib=({accountNumber:e,bankCode:t,amount:r,description:n})=>{const i=(e||"").trim(),a=(t||"").trim();if(!i||!a)return"";const s=new URLSearchParams;s.set("acc",i),s.set("bank",a);const l=Number(r);Number.isFinite(l)&&l>0&&s.set("amount",Math.round(l).toString());const f=(n||"").trim();return f&&s.set("des",f),`https://qr.sepay.vn/img?${s.toString()}`},i3=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},Bq=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",Yo=(e,t={})=>{const{fallback:r=" xy ra li. Vui lng th li sau.",blockPatterns:n}=t,i=Bq(e);return!i||Array.isArray(n)&&n.some(a=>a.test(i))?r:i},a3=ga,s3=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",o3=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,rv=(e,t,r,n)=>{const i=Number.isFinite(Number(t))?Number(t):0,a=Number.isFinite(Number(r))?Number(r):0,s=n?a3(i):i.toLocaleString("vi-VN"),l=o3(i,a);return{name:e,value:s,change:s3(l),changeType:l>=0?"increase":"decrease"}},$q=()=>{const e=v.useMemo(()=>new Date().getFullYear(),[]),[t,r]=v.useState([]),[n,i]=v.useState([]),[a,s]=v.useState([]),[l,f]=v.useState([]),[h,d]=v.useState(e),[m,x]=v.useState(!0),[g,_]=v.useState(null),w=async b=>{x(!0),_(null);try{const S=await Tt("/api/dashboard/stats");if(!S.ok){const j=await S.text();throw new Error(Yo(j,{fallback:"Khng th ti thng k tng quan."}))}const T=await S.json(),E=[{...rv("Tng n hng",T.totalOrders.current,T.totalOrders.previous,!1),icon:sy,accent:Or.sky},{name:"n sp ht hn",value:T.overdueOrders.count.toLocaleString("vi-VN"),change:"Cn x l",changeType:"alert",icon:r4,accent:Or.rose},{...rv("Tng nhp hng",T.totalImports.current,T.totalImports.previous,!0),icon:ey,accent:Or.amber},{...rv("Tng li nhun",T.totalProfit.current,T.totalProfit.previous,!0),icon:n4,accent:Or.emerald}];r(E);const A=await Y6(b);i(A.revenueData),s(A.orderStatusData);const k=A.orderStatusData.filter(j=>Number.isFinite(Number(j.total_orders)));if(k.length>=2){const j=Number(k[k.length-1].total_orders)||0,P=Number(k[k.length-2].total_orders)||0,M=o3(j,P);r(L=>L.map((B,R)=>R===0?{...B,change:s3(M),changeType:M>=0?"increase":"decrease"}:B))}}catch(S){console.error("Li khi ly d liu dashboard:",S),_(S instanceof Error?Yo(S.message,{fallback:" c li khi ti d liu dashboard. Vui lng th li sau."}):" c li khi ti d liu dashboard. Vui lng th li sau.")}finally{x(!1)}};return v.useEffect(()=>{(async()=>{try{const S=await X6();S.length>0?(f(S),d(T=>S.includes(T)?T:S[0])):(f([e]),d(e))}catch(S){console.error("Li khi ly danh sch nm Dashboard:",S),f([e]),d(e)}})()},[e]),v.useEffect(()=>{w(h)},[h]),m?u.jsx("div",{className:"py-10 text-center",children:u.jsx("p",{className:"text-lg font-medium text-gray-700",children:"ang ti d liu dashboard..."})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white sm:p-8",children:[u.jsx("h1",{className:"text-3xl font-bold",children:"Bng iu khin"}),u.jsx("p",{className:"text-sm text-blue-100",children:"Tng quan hot ng kinh doanh ca bn"})]}),g&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:g}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:u.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:t.map((b,S)=>u.jsx(Ua,{title:b.name,value:b.value,icon:b.icon,accent:b.accent,children:u.jsx("div",{className:`flex items-center text-sm font-semibold ${b.changeType==="increase"?"text-emerald-200":b.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:b.changeType==="alert"?u.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):b.changeType==="increase"?u.jsxs(u.Fragment,{children:[u.jsx(ry,{className:"mr-1 h-4 w-4"}),b.change]}):u.jsxs(u.Fragment,{children:[u.jsx(ty,{className:"mr-1 h-4 w-4"}),b.change]})})},`${b.name}-${S}`))})}),u.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[u.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[u.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Doanh thu theo thng (Tng gi bn)"}),u.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-gray-700 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:h,onChange:b=>d(Number(b.target.value)),children:l.length===0?u.jsx("option",{value:h,children:h}):l.map(b=>u.jsx("option",{value:b,children:b},b))})]}),u.jsx("div",{className:"h-80",children:u.jsx(Qv,{width:"100%",height:"100%",children:u.jsxs(bq,{data:n,children:[u.jsx(T1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),u.jsx(k1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(P1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:b=>`${Math.round(b/1e6)}M`}),u.jsx(w1,{formatter:b=>[a3(b),"Doanh thu"],labelStyle:{color:"#111827"}}),u.jsx(MO,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]}),u.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[u.jsx("h3",{className:"mb-6 text-lg font-semibold text-gray-900",children:"Tng n hng v n hy theo thng"}),u.jsx("div",{className:"h-80",children:u.jsx(Qv,{width:"100%",height:"100%",children:u.jsxs(Sq,{data:a,children:[u.jsx(T1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),u.jsx(k1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(P1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(w1,{formatter:(b,S,T)=>[b,T?.dataKey==="total_orders"?"Tng n":"n hy"],labelStyle:{color:"#111827"}}),u.jsx(N1,{dataKey:"total_orders",name:"Tng n",fill:"#3b82f6",radius:[4,4,0,0]}),u.jsx(N1,{dataKey:"total_canceled",name:"n hy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]})]})]})},Uq={ID_ORDER:tr.idOrder,ID_PRODUCT:tr.idProduct,INFORMATION_ORDER:tr.informationOrder,CUSTOMER:tr.customer,CONTACT:tr.contact,SLOT:tr.slot,ORDER_DATE:tr.orderDate,DAYS:tr.days,ORDER_EXPIRED:tr.orderExpired,SUPPLY:tr.supply,COST:tr.cost,PRICE:tr.price,NOTE:tr.note,STATUS:tr.status,CHECK_FLAG:tr.checkFlag,REFUND:tr.refund},Nt={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},q=Uq,Pt={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",CHECK_FLAG_STATUS:"check_flag_status_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},ra={ORDER_EXPIRED:"Ht Hn",CAN_GIA_HAN:"Cn Gia Hn",CHUA_THANH_TOAN:"Cha Thanh Ton",DA_THANH_TOAN:" Thanh Ton"},l3={active:{label:"n Hng",description:"Danh sch n ang hot ng",endpoint:Nt.ORDERS},expired:{label:"Ht Hn",description:"Danh sch cc n hng  ht hn",endpoint:Nt.ORDERS_EXPIRED},canceled:{label:"Hon Tin",description:"n  hy/hon tin",endpoint:Nt.ORDERS_CANCELED}},zq=["active","expired","canceled"],Wq="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",Hq="opacity-60 cursor-not-allowed shadow-none pointer-events-none",ba=Xa.forwardRef(({icon:e,className:t="",disabled:r,children:n,...i},a)=>u.jsxs("button",{ref:a,className:`${Wq} ${r?Hq:"hover:-translate-y-0.5"} ${t}`,disabled:r,...i,children:[e&&u.jsx(e,{className:"h-4 w-4"}),u.jsx("span",{className:"font-semibold",children:n})]}));ba.displayName="GradientButton";const Vq=({isOpen:e,onClose:t,onConfirm:r,title:n,message:i})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:u.jsxs("div",{className:"w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[u.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-2",children:n}),u.jsx("div",{className:"mb-4",children:u.jsx("p",{className:"text-sm text-white/90",children:i})}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors",children:"Hy"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors",children:"OK"})]})]})}):null,Kq="VPB",wC="9183400998",Gq="NGO LE NGOC HUNG",Yq=({isOpen:e,onClose:t,order:r,formatCurrency:n})=>{const[i,a]=v.useState(null),[s,l]=v.useState(!1),[f,h]=v.useState(null),d=le=>typeof le=="string"||typeof le=="number"||le instanceof Date?le:null,m=r?.[q.ID_ORDER],x=r?.[q.ID_PRODUCT],g=Number(r?.[q.PRICE])||0,_=r?.[q.SUPPLY]||"",w=r?.customer_type||_||"",b=r?.registration_date||r?.[q.ORDER_DATE]||"",S=R1(Pr(b)||b)||null;v.useEffect(()=>{if(!e||!m||!x){a(null),l(!1),h(null);return}let le=!1;a(g);const J={san_pham_name:x,id_product:x,id_order:m};return S&&(J.order_date=S),w&&(J.customer_type=w),(async()=>{try{l(!0),h(null);const Z=await Tt(Nt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),{data:se,rawText:G}=await i3(Z);if(!Z.ok){const ie=se?.error||G||`Server responded with ${Z.status}`;throw new Error(ie)}const ne=se??{};if(!le){const ie=Number(ne.price??ne.gia_ban);a(Number.isFinite(ie)&&ie>=0?ie:g)}}catch(Z){console.error("Li khi tnh li gi n hng:",Z),le||(h("Khng th tnh li gi t ng. ang hin th gi hin c."),a(g))}finally{le||l(!1)}})(),()=>{le=!0}},[e,m,x,w,g,S]);const T=v.useMemo(()=>{if(!r)return 0;const le=Number(r[q.PRICE])||0;return Math.max(0,i??le)},[r,i]);if(!e||!r)return null;const E=String(r[Pt.TRANG_THAI_TEXT]||r.trangThaiText||r[q.STATUS]||"").trim()||"Cha Thanh Ton",A=r[Pt.SO_NGAY_CON_LAI]!==void 0&&r[Pt.SO_NGAY_CON_LAI]!==null?Number(r[Pt.SO_NGAY_CON_LAI]):null,k=d(r.expiry_date||r.expiry_date_display||r[Pt.EXPIRY_DATE_DISPLAY]||r[q.ORDER_EXPIRED]),j=JO(k),P=A!==null&&Number.isFinite(A)?A:j??0,M=d(r.registration_date_display||r[Pt.ORDER_DATE_DISPLAY]||r.registration_date||r[q.ORDER_DATE]),L=(r.registration_date_display||r[Pt.ORDER_DATE_DISPLAY]||Pr(M)||String(r[q.ORDER_DATE]||""))??"",B=r.expiry_date_display||r[Pt.EXPIRY_DATE_DISPLAY]||Pr(k)||String(r[q.ORDER_EXPIRED]||""),R=T,U=String(r[q.ID_ORDER]||""),oe=Math.max(0,Number(R)||0),V=ta(oe),ae=ib({accountNumber:wC,bankCode:Kq,amount:V,description:U});return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 px-4 py-6",onClick:t,children:u.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:le=>le.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-center items-center p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[u.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Chi tit n hng:"," ",u.jsx("span",{className:"text-blue-600",children:r[q.ID_ORDER]})]}),u.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(zr,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto flex-grow space-y-5 text-gray-700",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-sm",children:[u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID n:"}),u.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[q.ID_ORDER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sn Phm:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[q.ID_PRODUCT]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Thng Tin Sn Phm:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right break-words",children:r[q.INFORMATION_ORDER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[q.SLOT]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ghi Ch:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[q.NOTE]||"-"})]}),u.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trng Thi:"}),u.jsx("dd",{className:"w-2/3 text-right",children:u.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${r3(E)}`,children:E})})]})]}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khch Hng:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[q.CUSTOMER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1 items-start",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3 shrink-0",children:"Lin H:"}),u.jsx("dd",{className:"w-2/3 text-right break-all",children:u.jsx("a",{href:r[q.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[q.CONTACT]||"-"})})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Order:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:L})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[q.DAYS]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Ht Hn:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:B})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy Cn Li:"}),u.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:P})]})]})]}),u.jsx("hr",{className:"my-4 border-white/10"}),u.jsxs("div",{className:"text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[u.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Qut m QR  thanh ton (VietQR)"}),ae?u.jsx("div",{className:"flex justify-center mb-3",children:u.jsx("img",{src:ae,alt:`QR Code thanh ton ${r[q.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40",width:280,height:280})}):u.jsx("p",{className:"text-red-600 font-medium",children:"Khng th to m QR. Vui lng kim tra li cu hnh"}),u.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[u.jsxs("p",{children:["Ngn hng: ",u.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),u.jsxs("p",{children:["S ti khon: ",u.jsx("strong",{className:"text-indigo-100",children:wC})]}),u.jsxs("p",{children:["Ch ti khon: ",u.jsx("strong",{className:"text-indigo-100",children:Gq})]}),u.jsxs("p",{children:["S tin:"," ",u.jsx("strong",{className:"text-xl text-red-600",children:s?"ang tnh...":n(V)})]}),f&&u.jsx("p",{className:"text-xs text-red-500",children:f}),u.jsxs("p",{children:["Ni dung: ",u.jsx("strong",{className:"text-indigo-200",children:U})," ","(Vui lng in ng)"]})]})]})]})]})})},bC=Lh,Rn="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",Qn="block text-sm font-medium text-slate-100 mb-1",fa="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",_C=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",SC=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,Xq=(e,t)=>{const[r,n]=v.useState(null),[i,a]=v.useState([]),[s,l]=v.useState([]),f=v.useRef(e),[h,d]=v.useState(!1),m=v.useCallback(()=>{const A=f.current?.[q.SUPPLY]||"";return A.trim()?{id:-1,source_name:A}:null},[]),x=v.useCallback(A=>{const k=m();return k&&!A.some(P=>P.source_name===k.source_name)?[k,...A]:A},[m]),g=v.useCallback(async A=>{if(!A){const k=x([]);return a(k),k}try{const k=await fetch(`${bC}${Nt.SUPPLIES_BY_PRODUCT(A)}`,{credentials:"include"});if(!k.ok)throw new Error("Li ti danh sch ngun.");const j=await k.json(),P=x(j);return a(P),P}catch(k){console.error("Li khi fetch supplies cho sn phm:",k);const j=x([]);return a(j),j}},[x]),_=v.useCallback(async A=>{if(!A)return l([]),[];try{const k=await fetch(`${bC}${Nt.SUPPLY_PRICES_BY_PRODUCT_NAME(A)}`,{credentials:"include"});if(!k.ok)throw new Error("Li ti danh sch gi ngun.");const j=await k.json();return l(j),j}catch(k){return console.error("Li khi fetch gi ngun cho sn phm:",k),l([]),[]}},[]);v.useEffect(()=>{if(t&&e){const A={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(A),f.current=A,a(j=>x(j));const k=e.id_product;k&&(g(k),_(k)),d(!1)}else t||(n(null),a([]),l([]),d(!1))},[t,e,g,_,x]),v.useEffect(()=>{if(!t||!r?.id_product)return;const A=r.id_product;g(A),_(A)},[t,r?.id_product,g,_]);const w=v.useCallback((A,k)=>{n(j=>j&&{...j,[A]:k})},[]),b=v.useCallback(A=>{const j=i.find(L=>L.id===A)?.source_name||r?.[q.SUPPLY]||"";d(!1),w(q.SUPPLY,j||"");const P=t3(j,s,i)??s.find(L=>L.source_id===A)?.price??null,M=Number(P);if(Number.isFinite(M))w(q.COST,M);else if(f.current){const L=Number(f.current[q.COST]||0);w(q.COST,L)}},[r,w,i,s]),S=v.useCallback(A=>{d(!0),w(q.SUPPLY,A)},[w]),T=v.useCallback(()=>{d(A=>{const k=!A;return k||w(q.SUPPLY,""),k})},[w]),E=v.useCallback(()=>{n(f.current);const A=f.current?.id_product;A&&(g(A),_(A))},[g,_]);return{formData:r,supplies:i,isCustomSupply:h,supplyPrices:s,handleSupplySelect:b,resetForm:E,setFieldValue:w,handleCustomSupplyChange:S,toggleCustomSupply:T}},qq=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:i,supplies:a,isCustomSupply:s,handleSupplySelect:l,resetForm:f,setFieldValue:h,handleCustomSupplyChange:d,toggleCustomSupply:m}=Xq(r,e),[x,g]=v.useState(!1),_=k=>i?String(i[k]??""):"",w=k=>i&&Number(i[k]??0)||0,b=v.useCallback(k=>{const j=k.target,{name:P,value:M}=j,L=j instanceof HTMLInputElement&&j.type==="checkbox"?j.checked:M;h(P,L)},[h]),S=v.useMemo(()=>{if(!i)return"";const k=a.find(j=>j.source_name===i[q.SUPPLY]);return k?String(k.id):""},[i,a]),T=v.useMemo(()=>{if(!i)return"";const k=SC(i.registration_date_display||i.registration_date||i[q.ORDER_DATE]);return Pr(k)||String(k||"")},[i]),E=v.useMemo(()=>{if(!i)return"";const k=SC(i.expiry_date_display||i.expiry_date||i[q.ORDER_EXPIRED]);return Pr(k)||String(k||"")},[i]),A=async k=>{if(k.preventDefault(),!!i){g(!0);try{await n(i)}finally{g(!1)}}};return!e||!i?null:u.jsx("div",{className:"edit-order-shell fixed inset-0 z-50 flex items-center justify-center bg-black/55 backdrop-blur-lg px-4 py-6",children:u.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[u.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-6 py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Chnh sa n hng"}),u.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"ng",children:u.jsx(zr,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"M n hng"}),u.jsx("input",{type:"text",name:q.ID_ORDER,value:_(q.ID_ORDER),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Khch hng"}),u.jsx("input",{type:"text",name:q.CUSTOMER,value:_(q.CUSTOMER),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Lin h"}),u.jsx("input",{type:"text",name:q.CONTACT,value:_(q.CONTACT),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Slot"}),u.jsx("input",{type:"text",name:q.SLOT,value:_(q.SLOT),onChange:b,className:Rn})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Sn phm"}),u.jsx("input",{type:"text",name:q.ID_PRODUCT,value:_(q.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Ngun"}),u.jsxs("div",{className:"flex items-center gap-2",children:[s?u.jsx("input",{type:"text",name:q.SUPPLY,value:_(q.SUPPLY),onChange:k=>d(k.target.value),className:Rn,placeholder:"Nhp ngun mi"}):u.jsxs("select",{name:q.SUPPLY,value:S,onChange:k=>l(Number(k.target.value)),className:Rn,children:[u.jsx("option",{value:"",children:"-- Gi nguyn hoc chn --"}),a.map(k=>u.jsx("option",{value:k.id,children:k.source_name},k.id))]}),u.jsx("button",{type:"button",onClick:m,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${s?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":s?"Tt nhp ngun mi":"Nhp ngun mi",children:s?u.jsx(a4,{className:"h-6 w-6","aria-hidden":"true"}):u.jsx(ay,{className:"h-6 w-6","aria-hidden":"true"})})]}),!a.length&&!s&&u.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Khng c danh sch ngun cho sn phm hin ti."})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Thng tin n hng"}),u.jsx("input",{type:"text",name:q.INFORMATION_ORDER,value:_(q.INFORMATION_ORDER),onChange:b,className:Rn})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Ngy ng k"}),u.jsx("input",{type:"text",name:q.ORDER_DATE,value:T,readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"S ngy"}),u.jsx("input",{type:"text",name:q.DAYS,value:_(q.DAYS),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Ngy ht hn"}),u.jsx("input",{type:"text",name:q.ORDER_EXPIRED,value:E,readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Gi nhp"}),u.jsx("input",{type:"text",name:q.COST,value:_C(w(q.COST)),readOnly:!0,disabled:!0,className:`${Rn} ${fa} font-semibold`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Gi bn"}),u.jsx("input",{type:"text",name:q.PRICE,value:_C(w(q.PRICE)),readOnly:!0,disabled:!0,className:`${Rn} ${fa} font-semibold text-emerald-300`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Trng thi"}),u.jsx("input",{type:"text",name:q.STATUS,value:_(q.STATUS),readOnly:!0,disabled:!0,className:`${Rn} ${fa}`})]}),u.jsxs("div",{className:"flex items-center gap-3 mt-6 md:mt-8",children:[u.jsx("label",{className:"text-sm font-medium text-slate-100 mb-0",children:"Kim tra"}),u.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-white/30 text-indigo-300 focus:ring-indigo-400",checked:!!i[q.CHECK_FLAG],disabled:!0,readOnly:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:Qn,children:"Ghi ch"}),u.jsx("textarea",{name:q.NOTE,value:_(q.NOTE),rows:4,onChange:b,className:Rn})]}),u.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[u.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hon tc"}),u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"ng"}),u.jsx("button",{type:"submit",disabled:x,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${x?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:x?"ang lu...":"Lu thay i"})]})]})]})})},t0=Lh,Zq=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},_0=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),i=parseInt(r[1],10),a=parseInt(r[2],10),s=new Date(a,i-1,n);s.setDate(s.getDate()+t-1);const l=String(s.getDate()).padStart(2,"0"),f=String(s.getMonth()+1).padStart(2,"0"),h=s.getFullYear();return`${l}/${f}/${h}`},NC={[q.ID_ORDER]:"",[q.ID_PRODUCT]:"",[q.INFORMATION_ORDER]:"",[q.CUSTOMER]:"",[q.CONTACT]:"",[q.SLOT]:"",[q.ORDER_DATE]:"",[q.DAYS]:"0",[q.ORDER_EXPIRED]:"",[q.SUPPLY]:"",[q.COST]:0,[q.PRICE]:0,[q.NOTE]:"",[q.STATUS]:"Cha Thanh Ton",[q.CHECK_FLAG]:null},an="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-all",yn="block text-sm font-medium text-gray-700 mb-1",Dl="bg-gray-100 cursor-not-allowed",Qq=(e,t,r)=>{const[n,i]=v.useState(NC),[a,s]=v.useState("MAVC"),[l,f]=v.useState([]),[h,d]=v.useState([]),[m,x]=v.useState([]),[g,_]=v.useState([]),[w,b]=v.useState(!1),[S,T]=v.useState(!1),[E,A]=v.useState(null),[k,j]=v.useState(!1),P=v.useMemo(()=>a+vC(5),[a]),M=v.useMemo(()=>Fs(),[]),L=n[q.ID_PRODUCT],B=n[q.ID_ORDER],R=n[q.ORDER_DATE],U=fe=>{i(O=>({...O,...fe}))},oe=v.useCallback(async()=>{try{const fe=await fetch(`${t0}${Nt.PRODUCTS_ALL}`,{credentials:"include"});if(!fe.ok)throw new Error("Li ti danh sch sn phm.");const O=await fe.json();x(O)}catch(fe){console.error("Li khi fetch products:",fe)}},[]),V=v.useCallback(async()=>{try{const fe=await fetch(`${t0}${Nt.SUPPLIES}`,{credentials:"include"});if(!fe.ok)throw new Error("Li ti danh sch ngun.");const O=await fe.json();f(O),d(D=>D.length?D:O)}catch(fe){console.error("Li khi fetch all supplies:",fe),f([])}},[]),ae=v.useCallback(async fe=>{if(!fe){d(O=>O.length?O:l);return}try{const O=await fetch(`${t0}${Nt.SUPPLIES_BY_PRODUCT(fe)}`,{credentials:"include"});if(!O.ok)throw new Error("Li ti danh sch ngun.");const D=await O.json();d(D)}catch(O){console.error("Li khi fetch supplies:",O),d(l)}},[l]),le=v.useCallback(async fe=>{try{const O=await fetch(`${t0}${Nt.SUPPLY_PRICES_BY_PRODUCT_NAME(fe)}`,{credentials:"include"});if(!O.ok)throw new Error("Li tnh gi nhp ca ngun.");const D=await O.json();_(D)}catch(O){console.error("Li khi fetch all supply prices:",O),_([])}},[]),J=v.useCallback(async(fe,O,D,z)=>{b(!0),T(!1);try{const H=Zq(z)||z||null,te=await Tt(Nt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supply_id:fe,san_pham_name:O,id_product:O,id_order:D,order_date:H,customer_type:a})}),{data:Re,rawText:Ee}=await i3(te);if(!te.ok){const Fe=Re?.error||Ee||"Li tnh gi ti Server.";throw new Error(Fe)}if(!Re)throw new Error("Phn hi khng hp l t server.");const me=Re||{},xe=Pr(z)||z||Fs(),Ce={cost:Math.max(0,Number(me.gia_nhap??me.cost??0)||0),price:Math.max(0,Number(me.gia_ban??me.price??0)||0),days:Number(me.so_ngay_da_dang_ki??me.days??0)||0,order_expired:""},Le=(me.order_expired??me.het_han??"").trim(),pe=Pr(Le)||Le||(Ce.days>0?_0(xe,Ce.days):"");return Ce.order_expired=pe,Ce}catch(H){console.error("Li khi tnh gi:",H),T(!1),alert(`Tnh gi tht bi: ${H instanceof Error?H.message:"Li khng xc nhn"}`);return}finally{b(!1)}},[a]),re=v.useCallback((fe,O,D,z)=>{if(!fe)return;const H=Pr(O)||O||Fs(),te=Number(fe.days||0)||0,Re=fe.order_expired||(te>0?_0(H,te):"");i(Ee=>{const me=Number(Ee[q.COST]||0),xe=Number.isFinite(fe.cost)&&fe.cost>0?fe.cost:void 0,Le=z?.updateCost??!0?xe??Number(D??me??0):me,pe=Number(Ee[q.PRICE]||0),Fe=Number.isFinite(fe.price)&&fe.price>0?fe.price:void 0,Pe=a==="MAVK"?Le:Fe??pe??0;return{...Ee,[q.COST]:Le,[q.PRICE]:Pe,[q.DAYS]:te>0?String(te):String(Ee[q.DAYS]||"0"),[q.ORDER_EXPIRED]:Re||Ee[q.ORDER_EXPIRED]||""}}),T(!0)},[a]),Z=v.useCallback((fe,O,D,z,H,te)=>{!O||!D||!z||J(fe,O,D,z).then(Re=>re(Re,z,H,te))},[J,re]);v.useEffect(()=>{if(e){const fe="MAVC",O=fe+vC(5),D=Fs();s(fe),i({...NC,[q.ID_ORDER]:O,[q.ORDER_DATE]:D,[q.ORDER_EXPIRED]:D}),T(!1),A(null),d([]),_([]),oe(),V()}},[e,oe,V]),v.useEffect(()=>{e&&i(fe=>({...fe,[q.ID_ORDER]:P}))},[P,e]),v.useEffect(()=>{if(!L||!B||!R||r)return;if(a==="MAVK"){i(O=>({...O,[q.PRICE]:O[q.COST]||0}));return}const fe=E??0;Z(fe,L,B,R,void 0,{updateCost:!!fe})},[a,Z,L,B,R,E,r]);const se=fe=>{if(A(null),j(!1),i(O=>({...O,[q.ID_PRODUCT]:fe,[q.SUPPLY]:"",[q.COST]:0,[q.PRICE]:0,[q.DAYS]:"0",[q.ORDER_EXPIRED]:O[q.ORDER_DATE]||M})),d([]),_([]),fe){ae(fe),le(fe);const O=n[q.ID_ORDER],D=n[q.ORDER_DATE];if(O&&D&&!r){const z=E??0;Z(z,fe,O,D,void 0,{updateCost:!!z})}}else d(l),T(!1)},G=v.useCallback((fe,O,D)=>{const z=g.map(Ee=>({source_id:Ee.source_id,price:Ee.price})),H=h.map(Ee=>({id:Ee.id,source_name:Ee.source_name})),te=t3(O,z,H),Re=Number(te);if(Number.isFinite(Re))return Re;if(fe!==0){const Ee=g.find(xe=>xe.source_id===fe)?.price,me=Number(Ee);if(Number.isFinite(me))return me}return D},[h,g]);return{formData:n,supplies:h,allSupplies:l,products:m,isLoading:w,isDataLoaded:S,selectedSupplyId:E,customerType:a,updateForm:U,setIsDataLoaded:T,customProductTouched:k,setCustomProductTouched:j,handleChange:fe=>{const{name:O,value:D}=fe.target;U({[O]:D})},handleProductSelect:se,handleSourceSelect:fe=>{const O=h.find(me=>me.id===fe),D=Number(n[q.COST]||0),z=O?.source_name||"",H=G(fe,z,D);A(fe===0?null:fe),i(me=>{const xe={...me,[q.SUPPLY]:O?O.source_name:"",[q.COST]:H};return a==="MAVK"&&(xe[q.PRICE]=H),xe});const te=n[q.ID_PRODUCT],Re=n[q.ID_ORDER],Ee=n[q.ORDER_DATE];if(!te||!Re||!Ee){T(!1);return}Z(fe,te,Re,Ee,H,{updateCost:!0})},handleProductChange:fe=>{const O=fe.target.value;if(A(null),j(!1),i(D=>({...D,[q.ID_PRODUCT]:O,[q.SUPPLY]:"",[q.COST]:0,[q.PRICE]:0,[q.DAYS]:"0",[q.ORDER_EXPIRED]:D[q.ORDER_DATE]||M})),d([]),_([]),O){ae(O),le(O);const D=n[q.ID_ORDER]||"",z=n[q.ORDER_DATE]||"";if(D&&z&&!r){const H=E??0;Z(H,O,D,z,void 0,{updateCost:!!H})}}else T(!1)},handleCustomerTypeChange:fe=>{const O=fe.target.value;s(O),A(null),d([]),_([]),T(!1),i(D=>({...D,[q.ID_PRODUCT]:"",[q.SUPPLY]:"",[q.COST]:0,[q.PRICE]:0,[q.DAYS]:"0",[q.ORDER_EXPIRED]:D[q.ORDER_DATE]||Fs()}))},handleSubmit:fe=>{if(fe.preventDefault(),n&&n[q.ID_PRODUCT]&&n[q.SUPPLY]&&n[q.CUSTOMER]&&n[q.INFORMATION_ORDER]&&!w){const D=Pr(n[q.ORDER_DATE])||n[q.ORDER_DATE]||Fs(),z=Pr(n[q.ORDER_EXPIRED])||n[q.ORDER_EXPIRED]||"",H=Number(n[q.DAYS]||0)||0;let te=z;if(!te&&D&&H>0){const xe=_0(D,H);xe&&xe!=="N/A"&&(te=xe,U({[q.ORDER_EXPIRED]:te}))}const Re=R1(D),Ee=te?R1(te):Re,me={...n,[q.COST]:Number(n[q.COST]),[q.PRICE]:Number(n[q.PRICE]),[q.ORDER_DATE]:Re,[q.ORDER_EXPIRED]:Ee,[q.CONTACT]:n[q.CONTACT]||null,[q.SLOT]:n[q.SLOT]||null,[q.NOTE]:n[q.NOTE]||null};return t(me),!0}else return alert("Vui lng in y  cc thng tin"),!1}}},EC=({name:e,value:t,options:r,placeholder:n,disabled:i,onChange:a,onClear:s})=>{const l=v.useRef(null),[f,h]=v.useState(!1),[d,m]=v.useState(""),x=v.useMemo(()=>{const _=r.find(w=>w.value===t);return _?_.label:""},[r,t]);v.useEffect(()=>{m(x)},[x]);const g=v.useMemo(()=>{const _=(d||"").toLowerCase().trim();return _?r.filter(w=>w.label.toLowerCase().includes(_)):r},[r,d]);return v.useEffect(()=>{const _=w=>{l.current&&(l.current.contains(w.target)||h(!1))};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]),u.jsxs("div",{ref:l,className:"relative",children:[u.jsx("input",{name:e,type:"text",value:d,onChange:_=>{const w=_.target.value;m(w),w===""&&s?.(),f||h(!0)},onFocus:()=>h(!0),disabled:i,placeholder:n,className:`${an} pr-8`,autoComplete:"off"}),!!d&&s&&!i&&u.jsx("button",{type:"button",onMouseDown:_=>{_.preventDefault(),m(""),s(),h(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:""}),f&&!i&&u.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:g.length===0?u.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Khng c kt qu"}):g.map(_=>u.jsx("div",{className:`px-3 py-2 text-sm cursor-pointer hover:bg-indigo-500/15 ${_.value===t?"bg-gray-50":""}`,onMouseDown:w=>{w.preventDefault(),m(_.label),h(!1),a(_.value,_)},children:_.label},`${String(_.value)}-${_.label}`))})]})},Jq=({isOpen:e,onClose:t,onSave:r})=>{const[n,i]=v.useState(!1),{formData:a,updateForm:s,supplies:l,products:f,isLoading:h,selectedSupplyId:d,customerType:m,setIsDataLoaded:x,customProductTouched:g,setCustomProductTouched:_,handleChange:w,handleProductSelect:b,handleSourceSelect:S,handleCustomerTypeChange:T,handleSubmit:E}=Qq(e,r,n),A=a[q.INFORMATION_ORDER]||"",k=a[q.ID_PRODUCT]||"",j=a[q.ORDER_DATE]||Fs(),P=a[q.COST],M=a[q.PRICE],L=v.useMemo(()=>a[q.ORDER_EXPIRED]||"",[a]),B=v.useMemo(()=>a[q.ORDER_DATE]||Fs(),[a]),R=v.useMemo(()=>Number(a[q.DAYS]||0)||0,[a]),U=v.useCallback(ae=>le=>{const re=(le.target.value||"").replace(/\D/g,""),Z=re?parseInt(re,10):0;s({[ae]:Z})},[s]);v.useEffect(()=>{if(!n||!g)return;const ae=xC(A)||xC(k),le=j;if(ae>0){const J=Rq(le,ae),re=Iq(le,J);s({[q.DAYS]:String(re),[q.ORDER_EXPIRED]:J})}},[n,g,A,k,j,s]),v.useEffect(()=>{if(L){const ae=Pr(L);if(!ae&&B&&R>0){const le=_0(B,R);le&&le!=="N/A"&&s({[q.ORDER_EXPIRED]:le})}else ae&&ae!==L&&s({[q.ORDER_EXPIRED]:ae})}},[L,B,R,s]);const oe=v.useMemo(()=>{const ae=a[q.ID_PRODUCT]||"",le=a[q.SUPPLY]||"",J=a[q.INFORMATION_ORDER]||"",re=a[q.CUSTOMER]||"";return!!ae&&!!le&&!!J&&!!re},[a]);if(v.useEffect(()=>{x(oe)},[oe,x]),!e)return null;const V=!!(a[q.CUSTOMER]&&a[q.ID_PRODUCT]&&a[q.SUPPLY]&&a[q.INFORMATION_ORDER]);return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300",children:u.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col text-slate-100",children:[u.jsxs("div",{className:"p-5 border-b border-slate-700 sticky top-0 bg-slate-800/80 z-10 flex justify-between items-center",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"To n Hng Mi"}),u.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:u.jsx(zr,{className:"h-6 w-6"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsx("form",{onSubmit:E,children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border p-4 rounded-lg bg-gray-50",children:[u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Loi Khch Hng"}),u.jsxs("select",{name:"customer_type",value:m,onChange:T,className:an,children:[u.jsx("option",{value:"MAVC",children:"Cng Tc Vin"}),u.jsx("option",{value:"MAVL",children:"Khch L"}),u.jsx("option",{value:"MAVK",children:"Khuyn Mi"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"M n Hng"}),u.jsx("input",{type:"text",name:q.ID_ORDER,value:a[q.ID_ORDER]||"",readOnly:!0,className:`${an} font-semibold ${Dl}`})]}),u.jsxs("div",{children:[u.jsxs("label",{className:yn,children:["Tn Khch Hng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:q.CUSTOMER,value:a[q.CUSTOMER]||"",onChange:w,className:an,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Link Lin H"}),u.jsx("input",{type:"url",name:q.CONTACT,value:a[q.CONTACT]||"",onChange:w,className:an})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[u.jsxs("div",{className:"md:col-span-5",children:[u.jsxs("label",{className:yn,children:["Sn Phm ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(EC,{name:q.ID_PRODUCT,value:a[q.ID_PRODUCT]||"",options:f.map(ae=>({value:ae.san_pham,label:ae.san_pham})),placeholder:"-- Chn --",onChange:ae=>b(String(ae)),onClear:()=>b(""),disabled:n})]}),u.jsxs("div",{className:"md:col-span-5",children:[u.jsxs("label",{className:yn,children:["Ngun ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(EC,{name:q.SUPPLY,value:d??"",options:l.map(ae=>({value:ae.id,label:ae.source_name})),placeholder:"-- Chn --",disabled:n||!a[q.ID_PRODUCT],onChange:ae=>S(Number(ae)),onClear:()=>S(0)})]}),u.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:u.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{_(!1),i(ae=>!ae)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?u.jsx(a4,{className:"h-6 w-6","aria-hidden":"true"}):u.jsx(ay,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&u.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Sn Phm Mi"}),u.jsx("input",{type:"text",name:q.ID_PRODUCT,value:a[q.ID_PRODUCT]||"",onChange:w,onBlur:()=>_(!0),className:an,placeholder:"Nhp Tn Sn Phm Mi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Ngun Mi"}),u.jsx("input",{type:"text",name:q.SUPPLY,value:a[q.SUPPLY]||"",onChange:w,className:an,placeholder:"Nhp Tn Ngun Mi"})]})]}),u.jsxs("div",{className:"md:col-span-12",children:[u.jsxs("label",{className:yn,children:["Thng Tin Sn Phm ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:q.INFORMATION_ORDER,value:a[q.INFORMATION_ORDER]||"",onChange:w,className:an,required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Ngy ng K"}),u.jsx("input",{type:"text",name:q.ORDER_DATE,value:a[q.ORDER_DATE]||"",readOnly:!0,className:`${an} ${Dl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"S Ngy ng K"}),u.jsx("input",{type:"text",name:q.DAYS,value:a[q.DAYS]||"",readOnly:!0,className:`${an} ${Dl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Ngy Ht Hn"}),u.jsx("input",{type:"text",name:q.ORDER_EXPIRED,value:a[q.ORDER_EXPIRED]||"",readOnly:!0,className:`${an} font-medium text-red-600 ${Dl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Slot"}),u.jsx("input",{type:"text",name:q.SLOT,value:a[q.SLOT]||"",onChange:w,className:an})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Gi Nhp"}),n?u.jsx("input",{type:"text",inputMode:"numeric",name:q.COST,value:gC(Number(P??0)),onChange:U(q.COST),className:`${an} font-semibold`}):u.jsx("input",{type:"text",name:q.COST,value:ga(P??0),readOnly:!0,className:`${an} font-semibold ${Dl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Gi Bn"}),n?u.jsx("input",{type:"text",inputMode:"numeric",name:q.PRICE,value:gC(Number(M??0)),onChange:U(q.PRICE),className:`${an} font-semibold text-green-700`}):u.jsx("input",{type:"text",name:q.PRICE,value:m==="MAVK"&&!d?"":ga(M??0),readOnly:!0,className:`${an} font-semibold text-green-700 ${Dl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:yn,children:"Ghi Ch"}),u.jsx("textarea",{name:q.NOTE,value:a[q.NOTE]||"",onChange:w,rows:8,className:an})]})]})]})]})})}),u.jsxs("div",{className:"p-5 border-t border-gray-200 bg-gray-50 flex justify-end sticky bottom-0 z-10",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-indigo-500/15 transition-colors shadow-sm mr-3",children:"Hy"}),u.jsx("button",{type:"submit",onClick:E,className:`px-6 py-2 text-base font-medium text-white rounded-lg transition-colors shadow-md ${V&&!h?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,disabled:!V||h,children:h?"ang Tnh Gi...":"To n Hng"})]})]})})},TC={"ht hn":ra.ORDER_EXPIRED,"cn gia hn":ra.CAN_GIA_HAN,"cha thanh ton":ra.CHUA_THANH_TOAN," thanh ton":ra.DA_THANH_TOAN,"cha hon":"Cha Hon"," hon":" Hon"},Tu=e=>ta(e).toLocaleString("vi-VN")+" VND",bu=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},I1=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),CC=e=>I1(e).replace(/[^a-z0-9]/g,""),kC=(e,t)=>{const r=e??t;return r==null?"":Pr(r)||String(r)},Ba=e=>{if(e==null)return e;if(typeof e!="boolean"&&(typeof e=="string"||typeof e=="number"||e instanceof Date))return e},eZ=e=>e==null?e:typeof e=="boolean"?null:typeof e=="number"||typeof e=="string"?e:null,AC=e=>{if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},tZ=e=>{if(e==null)return null;if(typeof e=="boolean")return e;if(typeof e=="number"){if(e===1)return!0;if(e===0)return!1}if(typeof e=="string"){const t=e.trim().toLowerCase();if(["true","t","1"].includes(t))return!0;if(["false","f","0"].includes(t))return!1}return null},Wl=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",PC=e=>e==="chua thanh toan"||e==="chua hoan"||e.includes("chua thanh toan")||e.includes("chua hoan"),rZ=e=>{const t=Wl(e);return t&&TC[t]?TC[t]:e},jC=e=>{const t=Ba(e.expiry_date)??Ba(e[q.ORDER_EXPIRED])??Ba(e.expiry_date_display)??Ba(e[Pt.EXPIRY_DATE_DISPLAY]),n=(Pr(t)||String(t||"")).split("/");if(n.length===3){const[a,s,l]=n.map(Number);if(Number.isFinite(a)&&Number.isFinite(s)&&Number.isFinite(l))return new Date(l,s-1,a).getTime()}const i=new Date(String(t||""));return Number.isFinite(i.getTime())?i.getTime():0};function nZ(e,t=300){const[r,n]=v.useState(e);return v.useEffect(()=>{const i=setTimeout(()=>n(e),t);return()=>clearTimeout(i)},[e,t]),r}const r0=[{name:"Tng n Hng",value:"0",icon:Jl,accent:Or.sky},{name:"Cn Gia Hn",value:"0",icon:iy,accent:Or.amber},{name:"Ht Hn",value:"0",icon:ty,accent:Or.rose},{name:"ng K Hm Nay",value:"0",icon:ry,accent:Or.emerald}],js=Lh,iZ=e=>{const[t,r]=v.useState([]),[n,i]=v.useState(""),[a,s]=v.useState("all"),[l,f]=v.useState("all"),[h,d]=v.useState(1),[m,x]=v.useState(10),[g,_]=v.useState(!1),[w,b]=v.useState(!1),[S,T]=v.useState(!1),[E,A]=v.useState(!1),[k,j]=v.useState(null),[P,M]=v.useState(null),[L,B]=v.useState(null),[R,U]=v.useState(null),[oe,V]=v.useState(null),ae=nZ(n,300),le=v.useCallback(async()=>{try{U(null);const me=l3[e].endpoint,xe=await fetch(`${js}${me}`,{credentials:"include"});if(xe.status===401){window.location.href="/login";return}if(!xe.ok)throw new Error(`Li my ch: ${xe.status}`);const Ce=await xe.json();Array.isArray(Ce)?r(Ce):console.error("D liu nhn c khng phi l mng:",Ce)}catch(me){console.error("Li khi ti n hng:",me);const xe=me instanceof TypeError?"Khng th kt ni n my ch. Vui lng kim tra li dch v backend.":me instanceof Error?me.message:"C li khng xc nh khi ti n hng.";U(xe)}finally{}},[e]);v.useEffect(()=>{le()},[le]),v.useEffect(()=>{r([]),i(""),f("all"),d(1),_(!1),b(!1),T(!1),A(!1),j(null),M(null),B(null)},[e]);const J=v.useMemo(()=>{const me=t.map(Qe=>{const Ve=Ba(Qe.registration_date??Qe[q.ORDER_DATE]),Ke=Ba(Qe.expiry_date??Qe[q.ORDER_EXPIRED]),wt=kC(Ba(Qe.registration_date_display),Ve),_t=kC(Ba(Qe.expiry_date_display),Ke),St=AC(eZ(Qe.so_ngay_con_lai)),It=JO(Ke||_t),lr=St??It??0,Tr=Qe[q.STATUS]||"Cha Thanh Ton",pr=rZ(Tr.trim()),cr=tZ(Qe[q.CHECK_FLAG]),yr=ta(Number.parseFloat(String(Qe[q.PRICE]??0))||0),mr=Number(Qe[q.DAYS])||0,tn=Math.max(0,lr),ai=mr>0?yr*tn/mr:0,Hi=Qe.can_hoan??Qe[q.REFUND]??Qe.refund,Ta=AC(Hi)??(Number.isFinite(ai)?ai:null);return{...Qe,[Pt.SO_NGAY_CON_LAI]:lr,[Pt.GIA_TRI_CON_LAI]:ai,[Pt.CHECK_FLAG_STATUS]:cr,[Pt.TRANG_THAI_TEXT]:pr,[Pt.ORDER_DATE_DISPLAY]:wt,[Pt.EXPIRY_DATE_DISPLAY]:_t,can_hoan:Ta}}),xe=I1(ae),Ce=CC(ae),Le=a==="all"?[q.CUSTOMER,q.ID_ORDER,q.INFORMATION_ORDER,q.SUPPLY,q.CONTACT]:[a],pe=l==="all"?"":Wl(l),Fe=me.filter(Qe=>{const Ve=!xe||Le.some(wt=>{const _t=Qe[wt],St=I1(_t);if(!St)return!1;if(wt===q.ID_ORDER){const It=CC(_t);return!!Ce&&It.includes(Ce)||St.includes(xe)}return St.includes(xe)}),Ke=l==="all"||Wl(String(Qe[Pt.TRANG_THAI_TEXT]||""))===pe;return Ve&&Ke});Fe.sort((Qe,Ve)=>{const Ke=String(Qe[Pt.TRANG_THAI_TEXT]||""),wt=String(Ve[Pt.TRANG_THAI_TEXT]||""),_t=Wl(Ke),St=Wl(wt),It=PC(_t),lr=PC(St);if(It!==lr)return It?-1:1;if(e==="expired"){const ai=jC(Qe),Hi=jC(Ve);if(ai!==Hi)return Hi-ai}const Tr=yC(Ke),pr=yC(wt);if(Tr!==pr)return Tr-pr;const cr=Number(Qe[Pt.SO_NGAY_CON_LAI]??0),yr=Number(Ve[Pt.SO_NGAY_CON_LAI]??0);if(cr!==yr)return cr-yr;const mr=Qe[q.ID_ORDER]||"",tn=Ve[q.ID_ORDER]||"";return mr<tn?-1:mr>tn?1:0});const Pe=me.length,We=me.filter(Qe=>{const Ve=Number(Qe[Pt.SO_NGAY_CON_LAI]??0);return Number.isFinite(Ve)&&Ve>0&&Ve<=4}).length,je=me.filter(Qe=>{const Ve=Number(Qe[Pt.SO_NGAY_CON_LAI]??0);return Number.isFinite(Ve)&&Ve<=0}).length,$e=me.filter(Qe=>{const Ve=Ba(Qe.registration_date||Qe.registration_date_display||Qe[Pt.ORDER_DATE_DISPLAY]||Qe[q.ORDER_DATE]);return Fq(Ve)}).length,Ae=[{...r0[0],value:String(Pe)},{...r0[1],value:String(We)},{...r0[2],value:String(je)},{...r0[3],value:String($e)}],xt=Math.ceil(Fe.length/m),he=h*m,De=he-m,et=Fe.slice(De,he);return{filteredOrders:Fe,currentOrders:et,totalPages:xt,updatedStats:Ae,totalRecords:Pe}},[t,ae,a,l,m,h,e]),{filteredOrders:re,totalPages:Z}=J;v.useEffect(()=>{d(1)},[ae,a,l,m]);const se=v.useMemo(()=>{const me=[];if(Z<=7){for(let pe=1;pe<=Z;pe++)me.push(pe);return me}const xe=(pe,Fe,Pe)=>Math.min(Math.max(pe,Fe),Pe),Ce=xe(h-1,2,Z-3),Le=xe(h+1,4,Z-1);me.push(1),Ce>2&&me.push("...");for(let pe=Ce;pe<=Le;pe++)me.push(pe);return Le<Z-1&&me.push("..."),me.push(Z),me},[h,Z]),G=v.useCallback(()=>A(!0),[]),ne=v.useCallback(()=>A(!1),[]),ie=v.useCallback(()=>{b(!1),j(null)},[]),de=v.useCallback(()=>{T(!1),B(null)},[]),ge=v.useCallback(()=>{_(!1),M(null)},[]),Oe=v.useCallback(me=>{j(me),b(!0)},[]),fe=v.useCallback(me=>{const xe={...me,cost:Number(me[q.COST]??0)||0,price:Number(me[q.PRICE]??0)||0};B(xe),T(!0)},[]),O=v.useCallback(me=>{M(me),_(!0)},[]),D=v.useCallback(async me=>{ne();try{const xe=await fetch(`${js}${Nt.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(me)});if(!xe.ok){const Le=await xe.json();throw new Error(Le.error||"Li khi to n hng mi t My ch")}await le();const Ce=await xe.json();Oe(Ce)}catch(xe){console.error("Li khi to n hng:",xe),alert(`Li khi to n hng: ${xe instanceof Error?xe.message:String(xe)}`)}},[ne,le,Oe]),z=v.useCallback(async me=>{if(!me||!me.id)return;const Ce=String(me[q.STATUS]||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),Le=me[q.CHECK_FLAG];let pe=null;if(Ce==="chua thanh toan"&&Le==null?pe={[q.CHECK_FLAG]:!1}:Ce==="chua thanh toan"&&Le===!1?pe={[q.STATUS]:ra.DA_THANH_TOAN,[q.CHECK_FLAG]:!0}:pe={[q.STATUS]:ra.DA_THANH_TOAN,[q.CHECK_FLAG]:!0},!!pe)try{const Fe=await fetch(`${js}${Nt.ORDER_BY_ID(me.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(pe)});if(!Fe.ok){const Pe=await bu(Fe);throw new Error(Pe||"Li khi cp nht trng thi t my ch")}await le()}catch(Fe){console.error("Li khi nh du  thanh ton:",Fe),alert(`Khng th nh du  thanh ton: ${Fe instanceof Error?Fe.message:String(Fe)}`)}},[le]),H=v.useCallback(async me=>{if(!me)return;const xe=String(me[q.ID_ORDER]||"").trim();if(!xe){alert("Khng tm thy m n  gia hn.");return}const Ce=`${js}${Nt.ORDER_RENEW(xe)}`;console.log("[Renew] start",{orderCode:xe,orderId:me.id,apiBase:js,renewUrl:Ce}),V(xe);try{const Le=await fetch(Ce,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({forceRenewal:!0})});let pe=null;try{pe=await Le.clone().text()}catch{pe=null}if(console.log("[Renew] response",{orderCode:xe,status:Le.status,body:pe}),!Le.ok){const Fe=await bu(Le);throw new Error(Fe||`Gia hn tht bi (m: ${Le.status||"unknown"})`)}await le(),alert("Gia hn thnh cng.")}catch(Le){console.error("Li khi gia hn n:",Le),alert(`Gia hn tht bi: ${Le instanceof Error?Le.message:String(Le)}`)}finally{V(null)}},[le]),te=v.useCallback(async me=>{if(!(!me||!me.id))try{const xe=await fetch(`${js}${Nt.ORDER_CANCELED_REFUND(me.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!xe.ok){const Ce=await bu(xe);throw new Error(Ce||"Li khi xc nhn hon tin t my ch")}await le()}catch(xe){console.error("Li khi xc nhn hon tin:",xe),alert(`Li khi xc nhn hon tin: ${xe instanceof Error?xe.message:String(xe)}`)}},[le]),Re=v.useCallback(async me=>{de();const xe={[q.ID_ORDER]:me.id_order,[q.ID_PRODUCT]:me.id_product,[q.INFORMATION_ORDER]:me.information_order,[q.CUSTOMER]:me.customer,[q.CONTACT]:me.contact,[q.SLOT]:me.slot,[q.SUPPLY]:me.supply,[q.COST]:Number(me.cost??0)||0,[q.PRICE]:Number(me.price??0)||0,[q.NOTE]:me.note,[q.STATUS]:me.status,[q.CHECK_FLAG]:me.check_flag};try{const Ce=await fetch(`${js}${Nt.ORDER_BY_ID(Number(me.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(xe)});if(!Ce.ok){const Le=await bu(Ce);throw new Error(Le||"Li khi cp nht n hng t My ch")}await le()}catch(Ce){console.error("Li khi cp nht n hng:",Ce),alert(`Li khi cp nht n hng: ${Ce instanceof Error?Ce.message:String(Ce)}`)}},[de,le]),Ee=v.useCallback(async()=>{if(P){_(!1);try{const me=await fetch(`${js}${Nt.ORDER_BY_ID(P.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:P[Pt.GIA_TRI_CON_LAI],gia_tri_con_lai:P[Pt.GIA_TRI_CON_LAI],check_flag:P[Pt.CHECK_FLAG_STATUS]})});if(!me.ok){const xe=await bu(me);throw new Error(xe||"Li khi xa n hng t My ch")}r(xe=>xe.filter(Ce=>Ce.id!==P.id))}catch(me){console.error("Li khi xa n hng:",me),alert(`Li khi xa n hng: ${me instanceof Error?me.message:String(me)}`)}finally{M(null)}}},[P]);return{...J,filteredOrders:re,paginationPages:se,searchTerm:n,setSearchTerm:i,searchField:a,setSearchField:s,statusFilter:l,setStatusFilter:f,currentPage:h,setCurrentPage:d,rowsPerPage:m,setRowsPerPage:x,isModalOpen:g,isViewModalOpen:w,isEditModalOpen:S,isCreateModalOpen:E,orderToView:k,orderToDelete:P,orderToEdit:L,openCreateModal:G,closeCreateModal:ne,closeViewModal:ie,closeEditModal:de,closeModal:ge,handleViewOrder:Oe,handleEditOrder:fe,handleDeleteOrder:O,handleSaveNewOrder:D,handleSaveEdit:Re,handleConfirmRefund:te,handleMarkPaid:z,handleRenewOrder:H,confirmDelete:Ee,fetchError:R,reloadOrders:le,renewingOrderCode:oe}},c3=Xa.memo(function({order:t,index:r,isExpanded:n,showRemainingColumn:i,showActionButtons:a,isActiveDataset:s,isCanceled:l,totalColumns:f,renewingOrderCode:h,onToggleDetails:d,onView:m,onEdit:x,onDelete:g,onConfirmRefund:_,onMarkPaid:w,onRenew:b}){const{[Pt.SO_NGAY_CON_LAI]:S,[Pt.GIA_TRI_CON_LAI]:T,[Pt.TRANG_THAI_TEXT]:E,[Pt.CHECK_FLAG_STATUS]:A}=t,k=Number.isFinite(Number(t[q.COST]))?Number(t[q.COST]):0,j=Number.isFinite(Number(t[q.PRICE]))?Number(t[q.PRICE]):0,P=Number.isFinite(Number(T))?Number(T):0,M=Number.isFinite(Number(t.can_hoan))?Number(t.can_hoan):P,L=Wl(String(E||"")),B=l&&L.includes("chua hoan"),R=t[Pt.ORDER_DATE_DISPLAY]||"",U=t[Pt.EXPIRY_DATE_DISPLAY]||"",oe=String(t[q.ID_ORDER]||"").trim(),V=h===oe,ae=Number.isFinite(Number(S))?Number(S):0,le=l?"text-indigo-600":ae<=0?"text-red-600":ae<=4?"text-orange-500":"text-green-500",J=l?Tu(M):ae,re=v.useCallback(()=>{t.id!==void 0&&t.id!==null&&d(t.id)},[d,t.id]),Z=se=>G=>{G.stopPropagation(),se(t)};return u.jsxs(Xa.Fragment,{children:[u.jsxs("tr",{onClick:re,className:`cursor-pointer transition ${r%2===0?"bg-slate-900/55":"bg-indigo-950/40"} ${n?"bg-indigo-700/25":""} hover:bg-indigo-600/25`,children:[u.jsx("td",{className:"px-4 py-4 text-sm font-medium text-white w-[150px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"font-bold whitespace-nowrap truncate max-w-[150px]",children:t[q.ID_ORDER]||""}),u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[q.ID_PRODUCT]||""})]})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white w-[140px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"text-white/80 text-xs whitespace-nowrap truncate max-w-[150px]",children:t[q.INFORMATION_ORDER]||""}),t[q.SLOT]?u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[q.SLOT]}):null]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-white w-[150px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"font-medium whitespace-nowrap truncate max-w-[150px]",children:t[q.CUSTOMER]||""}),u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",title:String(t[q.CONTACT]||""),children:t[q.CONTACT]||""})]})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm text-white w-[150px] text-center",children:R&&U?`${R} - ${U}`:R||U||""}),i&&u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm font-bold w-[60px] text-center",children:u.jsx("span",{className:le,children:J})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate w-[90px] text-center",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${r3(String(E||""))}`,children:String(E||"")})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-right text-sm font-medium w-[90px]",children:u.jsxs("div",{className:"flex space-x-2 justify-end",children:[u.jsx("button",{onClick:Z(m),className:"text-blue-600 hover:text-blue-900 p-1 rounded",children:u.jsx(lf,{className:"h-4 w-4"})}),B&&u.jsx("button",{onClick:Z(_),className:"text-emerald-600 hover:text-emerald-800 p-1 rounded",title:"Xc nhn  gii/hon tin",children:u.jsx(Jl,{className:"h-4 w-4"})}),s&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:Z(x),className:"text-green-600 hover:text-green-900 p-1 rounded",children:u.jsx(ec,{className:"h-4 w-4"})}),u.jsx("button",{onClick:Z(g),className:"text-red-600 hover:text-red-900 p-1 rounded",children:u.jsx(Lo,{className:"h-4 w-4"})})]})]})})]}),n&&u.jsx("tr",{className:"bg-indigo-900/40",children:u.jsx("td",{colSpan:f,className:"px-6 pb-6 pt-0",children:u.jsxs("div",{className:"rounded-2xl border border-dashed border-indigo-200/60 bg-indigo-600/20 p-5 shadow-lg shadow-indigo-900/30",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1 text-center",children:[u.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tit n hng"}),u.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",t[q.ID_ORDER]||""]})]}),a&&u.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[!(t[q.STATUS]===ra.DA_THANH_TOAN&&t[q.CHECK_FLAG]===!0)&&u.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:Z(w),children:" Thanh Ton"}),u.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:V,onClick:se=>{se.stopPropagation(),V||b(t)},children:V?"ang Gia Hn...":"Gia Hn"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ngun"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[q.SUPPLY]||"N/A"})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi nhp"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Tu(k)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi bn"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Tu(j)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi tr cn li"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Tu(P)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"S ngy"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[q.DAYS]||0})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi ch"}),u.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:t[q.NOTE]||"Khng c ghi ch."})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Kim tra"}),A===null?u.jsx("div",{className:"mt-3 h-5"}):u.jsx("div",{className:"mt-3 flex items-center justify-center",children:u.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:!!A,readOnly:!0,onClick:se=>se.stopPropagation()})})]})]})]})})})]})});c3.displayName="OrderRow";const aZ=[{value:"all",label:"Tt c ct"},{value:q.ID_ORDER,label:"M n Hng"},{value:q.INFORMATION_ORDER,label:"Thng tin"},{value:q.CUSTOMER,label:"Khch Hng"},{value:q.SLOT,label:"Slot"},{value:q.SUPPLY,label:"Ngun"}];function sZ(){const[e,t]=v.useState("active"),[r,n]=v.useState({active:0,expired:0,canceled:0}),{currentOrders:i,totalPages:a,updatedStats:s,filteredOrders:l,paginationPages:f,searchTerm:h,setSearchTerm:d,searchField:m,setSearchField:x,statusFilter:g,setStatusFilter:_,currentPage:w,setCurrentPage:b,rowsPerPage:S,setRowsPerPage:T,isModalOpen:E,isViewModalOpen:A,isEditModalOpen:k,isCreateModalOpen:j,orderToView:P,orderToDelete:M,orderToEdit:L,openCreateModal:B,closeCreateModal:R,closeViewModal:U,closeEditModal:oe,closeModal:V,handleViewOrder:ae,handleEditOrder:le,handleDeleteOrder:J,handleSaveNewOrder:re,handleSaveEdit:Z,handleConfirmRefund:se,handleMarkPaid:G,handleRenewOrder:ne,confirmDelete:ie,fetchError:de,reloadOrders:ge,totalRecords:Oe,renewingOrderCode:fe}=iZ(e);v.useEffect(()=>{n(Ce=>Ce[e]===Oe?Ce:{...Ce,[e]:Oe})},[e,Oe]);const O=e==="active",[D,z]=v.useState(null),H=v.useCallback(Ce=>{z(Le=>Le===Ce?null:Ce)},[]),te=e!=="expired",Re=e!=="expired",Ee=e==="canceled",me=Ee?"Gi Tr Cn Li":"Cn Li",xe=te?7:6;return u.jsxs("div",{className:"space-y-6",children:[de&&u.jsxs("div",{className:"flex flex-col gap-3 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[u.jsx("span",{children:de}),u.jsx("button",{type:"button",onClick:ge,className:"rounded-md border border-red-300 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-red-700 transition hover:bg-red-100",children:"Th Li"})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun L n Hng"}),u.jsx("p",{className:"mt-1 text-sm text-gray-200",children:"Qun l v theo di tt c cc n hng ca khch hng"})]}),u.jsx("div",{className:"mt-4 sm:mt-0",children:O&&u.jsx(ba,{icon:qa,onClick:B,children:"To n Hng Mi"})})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-r from-indigo-200/60 via-indigo-300/55 to-slate-200/45 p-4 shadow-[0_20px_50px_-28px_rgba(0,0,0,0.5),0_14px_32px_-24px_rgba(255,255,255,0.25)] border border-white/20",children:u.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:zq.map(Ce=>{const Le=Ce,pe=l3[Le],Fe=e===Le,Pe=r[Le]??0;return u.jsxs("button",{type:"button",onClick:()=>t(Le),className:`flex items-center justify-between rounded-2xl px-5 py-4 text-left transition shadow-[0_12px_28px_-16px_rgba(0,0,0,0.65),0_8px_22px_-18px_rgba(255,255,255,0.12)] ${Fe?"bg-gradient-to-r from-indigo-500 via-violet-500 to-indigo-500 text-white ring-1 ring-white/25":"bg-indigo-700/70 text-indigo-100 hover:bg-indigo-600/80 ring-1 ring-white/10"}`,children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:pe.label}),u.jsx("p",{className:"text-xs text-indigo-100/80",children:pe.description})]}),u.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:Pe.toLocaleString("vi-VN")})]},Ce)})})}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(Ce=>u.jsx(Ua,{title:Ce.name,value:Ce.value,icon:Ce.icon,accent:Ce.accent},Ce.name))})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(el,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Tm kim n hng, khch hng...",className:"w-full pl-10 pr-44 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:h,onChange:Ce=>d(Ce.target.value)}),u.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:u.jsx("select",{className:"min-w-[140px] md:min-w-[180px] px-3 py-1.5 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:m,onChange:Ce=>x(Ce.target.value),children:aZ.map(Ce=>u.jsx("option",{value:Ce.value,children:Ce.label},Ce.value))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx(b6,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:Ce=>_(Ce.target.value),children:[u.jsx("option",{value:"all",children:"Tt c trng thi"}),u.jsx("option",{value:ra.DA_THANH_TOAN,children:" thanh ton"}),u.jsx("option",{value:ra.CHUA_THANH_TOAN,children:"Cha thanh ton"}),u.jsx("option",{value:ra.CAN_GIA_HAN,children:"Cn gia hn"}),u.jsx("option",{value:ra.ORDER_EXPIRED,children:"Ht hn"})]})]})]})}),u.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 table-fixed text-white",children:[u.jsx("thead",{className:"bg-slate-900/90",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"ORDER/SN PHM"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[140px] whitespace-nowrap truncate",children:"THNG TIN N HNG"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"KHCH HNG"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"HN N HNG"}),te&&u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[60px] whitespace-nowrap truncate",children:me}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"TRNG THI"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"THAO TC"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:i.length===0?u.jsx("tr",{children:u.jsxs("td",{colSpan:xe,className:"text-center py-12",children:[u.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng tm thy n hng"}),u.jsx("div",{className:"text-white/60",children:"Th thay i b lc tm kim"})]})}):i.map((Ce,Le)=>u.jsx(c3,{order:Ce,index:Le,isExpanded:D===Ce.id,showRemainingColumn:te,showActionButtons:Re,isActiveDataset:O,isCanceled:Ee,totalColumns:xe,renewingOrderCode:fe,onToggleDetails:H,onView:ae,onEdit:le,onDelete:J,onConfirmRefund:se,onMarkPaid:G,onRenew:ne},Ce.id))})]})}),l.length>0&&u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[u.jsx("span",{children:"Hin th"}),u.jsxs("select",{id:"rowsPerPage",value:S,onChange:Ce=>T(Number(Ce.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[u.jsx("option",{value:10,children:"10"}),u.jsx("option",{value:25,children:"25"}),u.jsx("option",{value:50,children:"50"})]}),u.jsx("span",{children:"dng"})]}),u.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[u.jsx("button",{onClick:()=>b(1),disabled:w===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang u",children:"<<"}),u.jsx("button",{onClick:()=>b(Ce=>Math.max(Ce-1,1)),disabled:w===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trc",children:"<"}),u.jsx("div",{className:"flex items-center gap-1",children:f.map((Ce,Le)=>Ce==="..."?u.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${Le}`):u.jsx("button",{onClick:()=>b(Ce),disabled:Ce===w,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${Ce===w?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:Ce},Ce))}),u.jsx("button",{onClick:()=>b(Ce=>Math.min(Ce+1,a)),disabled:w===a,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),u.jsx("button",{onClick:()=>b(a),disabled:w===a,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cui",children:">>"})]})]})]}),u.jsx(Vq,{isOpen:E,onClose:V,onConfirm:ie,title:"Xc nhn xa",message:`Bn c chc chn mun xa n hng: ${M?.id_order}?`}),u.jsx(Yq,{isOpen:A,onClose:U,order:P,formatCurrency:Tu}),u.jsx(qq,{isOpen:k,onClose:oe,order:L,onSave:Ce=>Z(Ce)}),u.jsx(Jq,{isOpen:j,onClose:R,onSave:Ce=>{re(Ce)}})]})}const oZ={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},hh=[{value:"information",label:"Thng tin gi"},{value:"note",label:"Ghi ch"},{value:"supplier",label:"Nh cung cp"},{value:"import",label:"Gi nhp (VND)"},{value:"expired",label:"Ngy ht hn"},{value:"capacity",label:"Tng dung lng (GB)"}],F1=e=>e.filter(t=>t!=="capacity"),oc=5,lc=2e3,M1=100,lZ=.2,cZ=2,uZ=[{value:"information",label:"Lin kt theo thng tin n hng",helper:"Cc gi s c lin kt vi n hng da trn cc trng thng tin nh tn sn phm, thng tin sn phm."},{value:"slot",label:"Lin kt theo v tr",helper:"Cc gi s c lin kt vi n hng da trn m nh danh v tr (slot) ca n hng."}],OC=[{value:"all",label:"Tt c trng thi"},{value:"full",label:"Cn nhiu"},{value:"low",label:"Sp ht"},{value:"out",label:" ht"}],fZ=tr.informationOrder,u3=tr.slot,f3="package_slot_link_prefs",d3=(e,t)=>t<=0||e<=0?"out":e/t<=lZ?"low":"ok",Cu=e=>e<=0?"out":e<cZ?"low":"ok",Np=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),DC=e=>{const t=Np(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},Ws=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),h3=e=>{if(!e)return"";const t=e.trim();if(!t)return"";const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r)return`${r[3]}/${r[2]}/${r[1]}`;const n=t.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n)return`${n[3]}/${n[2]}/${n[1]}`;const i=t.match(/^(\d{2})\/(\d{2})\/(\d{4})/);return i?`${i[1]}/${i[2]}/${i[3]}`:t},RC=e=>{const t=Ws(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},L1=e=>{const t=Ws(e);return t?t.toLowerCase().replace(/\s+/g,""):""},dZ=e=>{const t=L1(e.informationUser||"");return t?[t]:[]},hZ=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",pZ=(e,t,r)=>{const n=Ws(r);if(t!=="slot")return n?[n]:[];const a=(e.slotDisplay??"").split("|").map(l=>Ws(l)).filter(Boolean);if(a.length>=1)return a;const s=Ws(e.customerDisplay);return s?[s,`${s} (2)`]:n?[n]:[]},IC=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},mZ=(e,t)=>{let n=t.productKey;if(e){const s=n.indexOf(e);s>=0&&(n=n.slice(s+e.length))}const i=IC(n);if(i)return i;const a=Np(t.base?.id_product??"");return IC(a)},xZ=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):M1} GB`,gZ=e=>e===u3?"slot":"information",n0=e=>e==="slot"?u3:fZ,p3=e=>Np(e),Bs=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9.-]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},nv=e=>e==null?"":typeof e=="string"?e:String(e),FC=(e,t,r)=>[e&&`Ti khon: ${e}`,t&&`Mt khu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",vZ=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):nv(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):nv(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:nv(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}},yZ=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(f3);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},wZ=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(f3,JSON.stringify(e))}catch{}},MC=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,i=e.match??e.matchModeValue??null,a=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,s=i?gZ(i):e.slotLinkMode??(a==="slot"?"slot":"information"),l=Array.isArray(e.productCodes)?e.productCodes.map(h=>typeof h=="string"?h.trim():"").filter(h=>!!h):[],f=Array.from(new Set(l.map(h=>p3(h)).filter(Boolean)));return{...e,slot:e.slot??oc,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:s,matchModeValue:i,productCodes:l,normalizedProductCodes:f}},bZ=({row:e,showCapacityColumn:t,tableColumnCount:r,isExpanded:n,onToggle:i,onEdit:a,onView:s})=>{const l=e.slotLimit||oc,f=e.slotUsed,h=e.remainingSlots,d=l>0?Math.min(h/l*100,100):0,m=Cu(h),x=m==="out"?"bg-red-500":m==="low"?"bg-yellow-500":"bg-green-500",g=e.capacityLimit||lc,_=e.capacityUsed,w=e.remainingCapacity,b=g>0?Math.min(w/g*100,100):0,S=d3(w,g),T=S==="out"?"bg-red-500":S==="low"?"bg-yellow-500":"bg-green-500",E=Math.min(f,l),A=e.slotAssignments??[],k=Array.from({length:Math.max(l,0)},(P,M)=>{const L=M+1,B=L<=E,R=A[L-1]??null;return{slotNumber:L,isUsed:B,assignment:R}}),j=t&&!!e.hasCapacityField;return u.jsxs(u.Fragment,{children:[u.jsxs("tr",{onClick:()=>i(e.id),className:`hover:bg-indigo-500/20 ${n?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.package}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.informationUser||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-medium",children:f})," / ",l," V tr"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:u.jsx("div",{className:`h-2 rounded-full ${x}`,style:{width:`${d}%`}})}),u.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",h]})]}),t&&u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:j?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-medium",children:_})," /"," ",g," GB"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:u.jsx("div",{className:`h-2 rounded-full ${T}`,style:{width:`${b}%`}})}),u.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",w," GB"]})]}):u.jsx("div",{className:"text-sm text-white/70 italic",children:"Khng c"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.supplier||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[Number(e.import||0).toLocaleString("vi-VN")," VND"]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:h3(e.expired)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.note||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition",type:"button","aria-label":"Sa",onClick:P=>{P.stopPropagation(),a(e)},children:u.jsx(ec,{className:"h-4 w-4"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-purple-50 text-purple-600 hover:bg-purple-100 transition",type:"button","aria-label":"Xem",onClick:P=>{P.stopPropagation(),s(e)},children:u.jsx(lf,{className:"h-4 w-4"})})]})]}),n&&u.jsx("tr",{children:u.jsx("td",{colSpan:r,className:"bg-indigo-900/30 px-6 py-4 text-white",children:u.jsxs("div",{className:"border border-dashed border-white/40 rounded-lg p-4 space-y-4 text-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi Tit Cc v tr"}),u.jsxs("p",{className:"text-xs text-white/80",children:["Hin th ",l," v tr - ",f,"  dng,"," ",h," cn trng"]})]}),u.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:k.map(P=>u.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border px-3 py-2 basis-1/2 sm:basis-1/3 lg:basis-1/5 min-w-[120px] ${P.isUsed?"border-yellow-300 bg-yellow-50":"border-green-200 bg-green-50"}`,title:P.assignment?.matchValue||P.assignment?.slotLabel||void 0,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(e6,{className:`h-5 w-5 ${P.isUsed?"text-yellow-500":"text-green-500"}`}),u.jsx("span",{className:"text-sm font-semibold text-gray-900 max-w-[170px] truncate",title:P.assignment?.slotLabel||(P.assignment?void 0:`v tr ${P.slotNumber}`),children:P.assignment?.slotLabel?P.assignment.slotLabel:`v tr ${P.slotNumber}`})]}),u.jsx("p",{className:`text-xs mt-1 ${P.isUsed?"text-yellow-700":"text-green-700"}`,children:P.assignment&&j?xZ(P.assignment.capacityUnits):P.isUsed?" dng":"Cn trng"})]},P.slotNumber))})]})})})]})},_Z=({rows:e,loading:t,showCapacityColumn:r,tableColumnCount:n,onEdit:i,onView:a})=>{const[s,l]=v.useState(null),f=h=>{l(d=>d===h?null:h)};return u.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Tn Gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thng Tin Gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"S Lng"}),r&&u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Dung Lng"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"NCC"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Gi Nhp"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ngy Ht Hn"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ghi Ch"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thao Tc"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?u.jsx("tr",{children:u.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"ang Ti D Liu..."})}):e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"Khng c gi no  hin th."})}):e.map((h,d)=>u.jsx(bZ,{row:h,showCapacityColumn:r,tableColumnCount:n,isExpanded:s===h.id,onToggle:f,onEdit:i,onView:a},`${h.id}-${d}`))})]})})})},ab=({open:e,title:t,onClose:r,children:n,footer:i})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[u.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),u.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"?A3ng",children:u.jsx(zr,{className:"h-5 w-5"})})]}),u.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),u.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:i})]})}):null,SZ=({open:e,initialName:t,initialFields:r,onClose:n,onSubmit:i,mode:a})=>{const[s,l]=v.useState(t),[f,h]=v.useState(new Set(r)),[d,m]=v.useState(null);v.useEffect(()=>{e&&(l(t),h(new Set(r)),m(null))},[e,r,t]);const x=b=>{h(S=>{const T=new Set(S);return T.has(b)?T.delete(b):T.add(b),T})},g=()=>h(new Set(hh.map(b=>b.value))),_=()=>h(new Set),w=b=>{b.preventDefault();const S=s.trim();if(!S){m("Vui lng nhp tn loi gi.");return}if(f.size===0){m("Vui lng chn t nht mt trng d liu.");return}i(S,Array.from(f))};return u.jsx(ab,{open:e,title:a==="edit"&&t?`Chnh sa loi gi: ${t}`:"To loi gi sn phm mi",onClose:n,footer:u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy b"}),u.jsx("button",{onClick:w,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:a==="create"?"To Loi":"Lu Thay i"})]}),children:u.jsxs("form",{onSubmit:w,className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn Loi Gi"}),u.jsx("input",{type:"text",value:s,onChange:b=>l(b.target.value),placeholder:"V d: Google One, Netflix, Spotify...",className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${a==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:a==="edit"}),a==="edit"&&u.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bn ch c th chnh sa cc trng d liu, tn loi gi gi nguyn."})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Cc trng d liu ca loi gi ny"}),u.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[u.jsx("button",{type:"button",onClick:g,className:"text-blue-600 hover:text-blue-700",children:"Chn tt c"}),u.jsx("button",{type:"button",onClick:_,className:"text-rose-600 hover:text-rose-700",children:"B chn tt c"})]})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:hh.map(b=>u.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${f.has(b.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[u.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:f.has(b.value),onChange:()=>x(b.value)}),u.jsx("span",{className:"text-sm font-medium text-gray-800",children:b.label})]},b.value))})]}),d&&u.jsx("p",{className:"text-sm text-red-600",children:d})]})})},LC=({open:e,mode:t,template:r,initialValues:n,onClose:i,onSubmit:a})=>{const s=v.useMemo(()=>({...oZ,...n??{}}),[n]),[l,f]=v.useState(s);v.useEffect(()=>{e&&f(s)},[e,s]);const h=(S,T)=>{const E=T.target.value;f(A=>({...A,[S]:E}))},d=S=>{S.preventDefault(),a(l)},m=S=>{f(T=>({...T,slotLinkMode:S}))},g=["information","note","supplier","import","expired"].some(S=>r.fields.includes(S)),_=r.fields.includes("capacity"),w=g||_,b=g&&_;return u.jsx(ab,{open:e,title:`${t==="add"?"Thm Gi":"Sa Gi"} - ${r.name}`,onClose:i,footer:u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy"}),u.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:t==="add"?"Lu gi":"Lu thay i"})]}),children:u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[w&&u.jsxs("div",{className:`grid grid-cols-1 gap-4 ${b?"md:grid-cols-2":""}`,children:[g&&u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tit gi"}),u.jsx("p",{className:"text-xs text-white/80",children:"Nhp cc trng m t lin quan n gi ny."})]}),r.fields.includes("information")&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),u.jsx("input",{type:"text",value:l.informationUser,onChange:S=>h("informationUser",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),u.jsx("input",{type:"text",value:l.informationPass,onChange:S=>h("informationPass",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),u.jsx("input",{type:"email",value:l.informationMail,onChange:S=>h("informationMail",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),u.jsx("input",{type:"text",value:l.note,onChange:S=>h("note",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi ch cho gi ny"})]}),r.fields.includes("supplier")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nh cung cp"}),u.jsx("input",{type:"text",value:l.supplier,onChange:S=>h("supplier",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi nhp (VND)"}),u.jsx("input",{type:"number",min:0,value:l.import,onChange:S=>h("import",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy ht hn"}),u.jsx("input",{type:"date",value:l.expired,onChange:S=>h("expired",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),_&&u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),u.jsx("p",{className:"text-xs text-white/80",children:"Cung cp thng tin ti khon dung lng."})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),u.jsx("input",{type:"text",value:l.accountUser,onChange:S=>h("accountUser",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),u.jsx("input",{type:"text",value:l.accountPass,onChange:S=>h("accountPass",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),u.jsx("input",{type:"email",value:l.accountMail,onChange:S=>h("accountMail",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),u.jsx("textarea",{value:l.accountNote,onChange:S=>h("accountNote",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi ch cho ti khon dung lng"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lng (GB)"}),u.jsx("input",{type:"number",min:0,value:l.capacity,onChange:S=>h("capacity",S),placeholder:`Mc nh: ${lc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S v tr (slot)"}),u.jsx("input",{type:"number",min:0,value:l.slot,onChange:S=>h("slot",S),placeholder:`Mc nh: ${oc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"flex items-center justify-between mb-2",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Chn ch  ghp lnh"}),u.jsx("p",{className:"text-xs text-white/80",children:"Chn phng thc kt ni gia gi v n hng."})]})}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:uZ.map(S=>{const T=l.slotLinkMode===S.value;return u.jsxs("button",{type:"button",onClick:()=>m(S.value),className:`border rounded-lg p-3 text-left transition ${T?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[u.jsx("span",{className:"block text-sm font-semibold",children:S.label}),u.jsx("span",{className:"block text-xs text-white/70 mt-1",children:S.helper})]},S.value)})}),u.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[u.jsx("b",{children:"Link theo thng tin n hng:"})," So khp thng tin gi (ti khon, mail, v.v.) vi chi tit trong n hng.",u.jsx("br",{}),u.jsx("b",{children:"Link theo v tr:"})," So khp thng tin gi vi m v tr (slot) khai bo trong n hng.",u.jsx("br",{})]})]}),r.fields.length===0&&u.jsx("p",{className:"text-sm text-white/80",children:"Loi gi ny khng c trng d liu no c cu hnh."})]})})},NZ=({open:e,row:t,onClose:r})=>{if(!e||!t)return null;const n=[{label:"Ti khon",value:t.informationUser},{label:"Mt khu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi ch",value:t.note},{label:"Ngun",value:t.supplier},{label:"Gi nhp",value:t.import},{label:"Ngy ht hn",value:h3(t.expired)}],i=[{label:"Ti khon",value:t.accountUser},{label:"Mt khu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi ch",value:t.accountNote}],a=!!t.hasCapacityField,s=t.capacityLimit||lc,l=t.capacityUsed||0,f=t.remainingCapacity||0,h=s>0?Math.min(f/s*100,100):0,d=d3(f,s),m=d==="out"?"bg-red-500":d==="low"?"bg-yellow-500":"bg-green-500";return u.jsx(ab,{open:e,title:`Chi Tit Gi: ${t.package}`,onClose:r,footer:u.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"ng"}),children:u.jsxs("div",{className:`grid grid-cols-1 gap-4 ${a?"md:grid-cols-2":""}`,children:[u.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thng tin gi"}),u.jsx("p",{className:"text-xs text-white/80",children:"Cc trng d liu c lu cho gi ny."})]}),u.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(x=>u.jsxs("div",{children:[u.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),u.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))})]}),a&&u.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),u.jsx("p",{className:"text-xs text-white/80",children:"Tng quan v ti khon dung lng."})]}),u.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:i.map(x=>u.jsxs("div",{children:[u.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),u.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-semibold",children:l})," /"," ",s," GB"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full ${m}`,style:{width:`${h}%`}})}),u.jsxs("div",{className:"text-xs text-white/80",children:["Cn trng: ",f," GB"]})]})]})]})})},m3=(e,t)=>{const r=e.base;return r?.id!==void 0&&r?.id!==null?`id:${r.id}`:r?.id_order!==void 0&&r?.id_order!==null?`code:${r.id_order}`:`${e.productKey||e.infoKey}-${t}`},EZ=(e,t)=>{if(e.size===0)return[];const r=new Map;return e.forEach(n=>{const i=t.get(n);i?.length&&i.forEach(a=>{const s=m3(a,r.size);r.has(s)||r.set(s,a)})}),Array.from(r.values())},TZ=()=>{const[e,t]=v.useState(""),[r,n]=v.useState("all"),[i,a]=v.useState("all"),[s,l]=v.useState([]),[f,h]=v.useState([]),[d,m]=v.useState([]),[x,g]=v.useState(!0),[_,w]=v.useState(!0),[b,S]=v.useState(!1),[T,E]=v.useState(()=>yZ()),A=v.useRef(T),k=v.useMemo(()=>hh.map(ie=>ie.value),[]);v.useEffect(()=>{A.current=T},[T]);const j=v.useCallback((ie,de)=>{const ge=String(ie);E(Oe=>{if(Oe[ge]===de)return Oe;const fe={...Oe,[ge]:de};return wZ(fe),fe})},[]);v.useEffect(()=>{let ie=!1;return(async()=>{try{g(!0);const de=await Tt("/api/package-products");if(!de.ok)throw new Error(`HTTP ${de.status}`);const ge=await de.json();if(!ie)if(Array.isArray(ge)){const Oe=ge.map(fe=>MC(fe,A.current));l(Oe)}else l([])}catch(de){console.error("Ti sn phm gi tht bi:",de),ie||l([])}finally{ie||g(!1)}})(),()=>{ie=!0}},[]),v.useEffect(()=>{let ie=!1;return(async()=>{try{w(!0),S(!1);const de=await Tt("/api/orders");if(!de.ok)throw new Error(`HTTP ${de.status}`);const ge=await de.json();ie||(Array.isArray(ge)?h(ge):h([]),S(!0))}catch(de){console.error("Ti danh sch n hng tht bi:",de),ie||(h([]),S(!1))}finally{ie||w(!1)}})(),()=>{ie=!0}},[]);const P=v.useMemo(()=>Array.from(new Set(s.map(ie=>ie.package))).sort(),[s]);v.useEffect(()=>{m(ie=>{const de=new Map(ie.map(Oe=>[Oe.name,Oe]));let ge=!1;return P.forEach(Oe=>{if(!Oe)return;const fe=s.some(D=>D.package===Oe&&D.hasCapacityField),O=de.get(Oe);if(!O){const D=fe?k:F1(k);de.set(Oe,{name:Oe,fields:D,isCustom:!1}),ge=!0;return}if(O.isCustom!==!0&&!fe&&O.fields.includes("capacity")){const D=F1(O.fields);de.set(Oe,{...O,fields:D}),ge=!0}}),ge?Array.from(de.values()).sort((Oe,fe)=>Oe.name.localeCompare(fe.name)):ie})},[P,s,k]);const M=v.useMemo(()=>f.map(ie=>{const de=DC(ie.id_product??""),ge=DC(ie.information_order??"");return{base:ie,productKey:de.normalized,productLettersKey:de.lettersOnly,infoKey:ge.normalized,infoLettersKey:ge.lettersOnly,slotDisplay:Ws(ie.slot),slotKey:RC(ie.slot),slotMatchKey:L1(ie.slot),informationDisplay:Ws(ie.information_order),informationKey:RC(ie.information_order),informationMatchKey:L1(ie.information_order),customerDisplay:Ws(ie.customer),productCodeNormalized:p3(ie.id_product)}}),[f]),L=v.useMemo(()=>{const ie=new Map;return M.forEach(de=>{if(!de.productCodeNormalized)return;const ge=de.productCodeNormalized;ie.has(ge)||ie.set(ge,[]),ie.get(ge).push(de)}),ie},[M]),B=v.useMemo(()=>s.map(ie=>{const de=!!ie.hasCapacityField,ge=Bs(ie.slot),Oe=ge&&ge>0?Math.floor(ge):oc,fe=Bs(ie.slotUsed),O=Np(ie.package),D=O.replace(/[0-9]/g,""),H=(ie.slotLinkMode??"information")==="information"?"slot":"information",te=H==="slot"?"information":"slot",Re=dZ(ie),Ee=ie.normalizedProductCodes??[],me=Ee.length>0?new Set(Ee):null,xe=b&&M.length>0&&(me?.size||O.length>0),Ce=Ke=>!me||me.size===0?!1:!!Ke.productCodeNormalized&&me.has(Ke.productCodeNormalized),Le=Ke=>{if(!O)return!1;const wt=!!Ke.productKey&&(Ke.productKey.startsWith(O)||Ke.productKey.includes(O))||!!D&&!!Ke.productLettersKey&&(Ke.productLettersKey.startsWith(D)||Ke.productLettersKey.includes(D)),_t=!!Ke.infoKey&&(Ke.infoKey.startsWith(O)||Ke.infoKey.includes(O))||!!D&&!!Ke.infoLettersKey&&(Ke.infoLettersKey.startsWith(D)||Ke.infoLettersKey.includes(D));return wt||_t},pe=Ke=>Ce(Ke)||Le(Ke),Fe=Ke=>{if(Re.length===0)return!0;const wt=te==="slot"?Ke.slotMatchKey:Ke.informationMatchKey;return wt?Re.some(_t=>_t===wt||_t.includes(wt)||wt.includes(_t)):!1},Pe=xe&&me?.size?EZ(me,L):null,We=xe?(()=>{const Ke=new Map,wt=_t=>{const St=m3(_t,Ke.size);Ke.has(St)||Ke.set(St,_t)};return Pe?.forEach(wt),M.forEach(_t=>{pe(_t)&&wt(_t)}),Array.from(Ke.values()).filter(_t=>Fe(_t))})():[],je=new Set,$e=[];xe&&We.forEach(Ke=>{const wt=hZ(Ke,H),St=(te==="slot"?Ke.slotDisplay:Ke.informationDisplay)||Ke.customerDisplay||"",It=Ke.base?.id!==void 0&&Ke.base?.id!==null?`id:${Ke.base.id}`:Ke.base?.id_order!==void 0&&Ke.base?.id_order!==null?`code:${Ke.base.id_order}`:`${St}-${$e.length}`;if(je.has(It))return;je.add(It);const lr=wt||St,Tr=pZ(Ke,H,lr);if(Tr.length===0)return;const pr=de?mZ(O,Ke):null;Tr.forEach(cr=>{const yr=cr||lr||"";yr&&$e.push({slotLabel:yr,matchValue:St||yr,sourceOrderId:Ke.base?.id??null,sourceOrderCode:Ke.base?.id_order??null,displayColumn:H,matchColumn:te,capacityUnits:pr})})});const Ae=$e.length>0?$e.length:fe!==null?Math.max(Math.floor(fe),0):0,xt=Math.min(Ae,Oe),he=Math.max(Oe-xt,0);let De=0,et=0,Qe=0;if(de){const Ke=Bs(ie.capacity);De=Ke&&Ke>0?Math.floor(Ke):lc;const wt=Bs(ie.capacityUsed),_t=$e.length>0?$e.reduce((It,lr)=>It+(lr.capacityUnits??M1),0):Ae*M1,St=Math.min(_t,De);et=Math.min(Math.max(wt!==null?Math.floor(wt):St,0),De),Qe=Math.max(De-et,0)}const Ve=xe?We.map(Ke=>Ke.base):[];return{...ie,slotUsed:xt,slotLimit:Oe,remainingSlots:he,capacityLimit:De,capacityUsed:et,remainingCapacity:Qe,slotAssignments:$e,matchedOrders:Ve,packageCode:O,hasCapacityField:de,productCodes:ie.productCodes??[],normalizedProductCodes:Ee,matchModeValue:ie.matchModeValue??ie.match??null}}),[s,M,b,L]),R=r!=="all"?r:null,U=v.useMemo(()=>R?d.find(ie=>ie.name===R)??null:null,[d,R]),oe=v.useMemo(()=>R?B.filter(ie=>ie.package===R):B,[B,R]),V=v.useMemo(()=>oe.filter(ie=>{const de=e.trim().toLowerCase(),ge=[ie.information,ie.informationUser,ie.informationMail,ie.informationPass,ie.accountUser,ie.accountMail,ie.accountPass,ie.note],Oe=de.length===0||ge.some(z=>(z==null?"":String(z)).toLowerCase().includes(de)),fe=r==="all"||ie.package===r,O=Cu(ie.remainingSlots);return Oe&&fe&&(i==="all"||i==="full"&&O==="ok"||i===O)}),[oe,e,r,i]),ae=v.useMemo(()=>[...V].sort((ie,de)=>{const ge=Number(ie.remainingSlots),Oe=Number(de.remainingSlots),fe=Number.isFinite(ge)?ge:Number.POSITIVE_INFINITY,O=Number.isFinite(Oe)?Oe:Number.POSITIVE_INFINITY,D=fe<=0?Number.POSITIVE_INFINITY:fe,z=O<=0?Number.POSITIVE_INFINITY:O;return D===z?0:D-z}),[V]),J=V.some(ie=>ie.hasCapacityField??!1)||V.length===0&&(U?.fields.includes("capacity")??!1),re=J?9:8,Z=v.useMemo(()=>{const ie=oe.reduce((ge,Oe)=>Cu(Oe.remainingSlots)==="low"?ge+1:ge,0),de=oe.reduce((ge,Oe)=>Cu(Oe.remainingSlots)==="out"?ge+1:ge,0);return{total:oe.length,low:ie,out:de}},[oe]),se=v.useMemo(()=>{const ie=new Set;return B.forEach(de=>{const ge=(de.package||"").trim();ge&&ie.add(ge)}),d.forEach(de=>{de.name&&ie.add(de.name)}),Array.from(ie).sort((de,ge)=>de.localeCompare(ge))},[B,d]),G=v.useMemo(()=>{const ie=new Map;return se.forEach(de=>ie.set(de,{total:0,low:0,out:0})),B.forEach(de=>{const ge=(de.package||"").trim();if(!ge)return;const Oe=ie.get(ge);if(!Oe)return;Oe.total+=1;const fe=Cu(de.remainingSlots);fe==="low"&&(Oe.low+=1),fe==="out"&&(Oe.out+=1)}),se.map(de=>({name:de,...ie.get(de)??{total:0,low:0,out:0}}))},[se,B]),ne=v.useCallback(ie=>MC(ie,A.current),[]);return{data:{rows:s,templates:d,computedRows:B,filteredRows:V,sortedRows:ae,scopedRows:oe,selectedPackage:R,selectedTemplate:U,packageSummaries:G,slotStats:Z,showCapacityColumn:J,tableColumnCount:re,loading:x||_,packagesLoading:x,ordersLoading:_,ordersReady:b,defaultTemplateFields:k},filters:{searchTerm:e,categoryFilter:r,statusFilter:i},actions:{setSearchTerm:t,setCategoryFilter:n,setStatusFilter:a,setRows:l,setTemplates:m,persistSlotLinkPreference:j,applySlotLinkPrefs:ne}}},BC=[{border:"border-sky-100/70",glow:"from-sky-100/80 via-white/80 to-blue-100/70",link:"text-sky-600 hover:text-sky-700"},{border:"border-emerald-100/70",glow:"from-emerald-100/80 via-white/80 to-lime-100/70",link:"text-emerald-600 hover:text-emerald-700"},{border:"border-violet-100/70",glow:"from-violet-100/80 via-white/80 to-fuchsia-100/70",link:"text-violet-600 hover:text-violet-700"},{border:"border-amber-100/70",glow:"from-amber-100/80 via-white/80 to-orange-100/70",link:"text-amber-600 hover:text-amber-700"}],CZ=()=>{const{data:{templates:e,filteredRows:t,sortedRows:r,selectedPackage:n,selectedTemplate:i,packageSummaries:a,slotStats:s,showCapacityColumn:l,tableColumnCount:f,loading:h,defaultTemplateFields:d},filters:{searchTerm:m,categoryFilter:x,statusFilter:g},actions:{setSearchTerm:_,setCategoryFilter:w,setStatusFilter:b,setRows:S,setTemplates:T,persistSlotLinkPreference:E,applySlotLinkPrefs:A}}=TZ(),[k,j]=v.useState(!1),[P,M]=v.useState(""),[L,B]=v.useState(hh.map(he=>he.value)),[R,U]=v.useState("create"),[oe,V]=v.useState(!1),[ae,le]=v.useState(!1),[J,re]=v.useState(null),[Z,se]=v.useState(!1),[G,ne]=v.useState(null),[ie,de]=v.useState(!1),[ge,Oe]=v.useState(!1),[fe,O]=v.useState(new Set),D=eo(),z=Fh();v.useEffect(()=>{const De=new URLSearchParams(D.search).get("package");w(De||"all")},[D.search,w]),v.useEffect(()=>{const he=new URLSearchParams(D.search);x==="all"?he.delete("package"):he.set("package",x);const De=he.toString(),et=De?`?${De}`:"";et!==D.search&&z({pathname:D.pathname,search:et},{replace:!0})},[x,D.pathname,D.search,z]);const H=v.useCallback(he=>{w(De=>he==="all"||De===he?"all":he)},[w]),te=()=>{if(n&&i){Ee({name:n,fields:i.fields,mode:"edit"});return}Ee()},Re=()=>{if(n){if(!i){Ee({name:n,fields:d,mode:"create"});return}V(!0)}},Ee=v.useCallback(he=>{M(he?.name??""),B(he?.fields&&he.fields.length>0?he.fields:d),U(he?.mode??"create"),j(!0)},[d]),me=v.useCallback((he,De)=>{const et=he.trim();et&&(T(Qe=>{const Ve=Qe.filter(Ke=>Ke.name!==et);return Ve.push({name:et,fields:De,isCustom:!0}),Ve.sort((Ke,wt)=>Ke.name.localeCompare(wt.name))}),j(!1),H(et))},[H,T]),xe=v.useCallback(he=>{const De=e.find(et=>et.name===he)??null;Ee({name:he,fields:De?.fields??d,mode:"edit"})},[e,Ee,d]),Ce=v.useCallback(()=>{de(!1),O(new Set)},[]),Le=v.useCallback(he=>{const De=he.trim();De&&O(et=>{const Qe=new Set(et);return Qe.has(De)?Qe.delete(De):Qe.add(De),Qe})},[]),pe=v.useCallback(async()=>{if(fe.size===0){Ce();return}Oe(!0);const he=Array.from(fe);try{const De=await Tt("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:he})});if(!De.ok){const Ve=await De.text();throw new Error(Ve||`HTTP ${De.status}`)}const et=await De.json().catch(()=>({})),Qe=Array.isArray(et.deletedNames)?et.deletedNames:he;S(Ve=>Ve.filter(Ke=>!Qe.includes((Ke.package||"").trim()))),T(Ve=>Ve.filter(Ke=>!Qe.includes(Ke.name))),n&&Qe.includes(n)&&H("all")}catch(De){console.error("Xa nhm tht bi:",De),alert(`Xa nhm tht bi: ${De instanceof Error?De.message:"Li khng xc nh"}`)}finally{Oe(!1),Ce()}},[fe,Ce,n,H,S,T]),Fe=v.useCallback(he=>{const De=e.find(et=>et.name===he.package)??{name:he.package,fields:he.hasCapacityField?d:F1(d),isCustom:!1};re({rowId:he.id,template:De,initialValues:vZ(he),accountStorageId:he.accountStorageId??null}),le(!0)},[e,d]),Pe=v.useCallback(()=>{le(!1),re(null)},[]),We=v.useCallback(he=>{ne(he),se(!0)},[]),je=v.useCallback(()=>{se(!1),ne(null)},[]),$e=v.useCallback(async he=>{if(!i)return;const De=i.fields.includes("capacity"),et=i.fields.includes("information"),Qe=i.fields.includes("note"),Ve=i.fields.includes("supplier"),Ke=i.fields.includes("import"),wt=Bs(he.slot),_t=wt!==null&&wt>0?Math.floor(wt):oc,St=Bs(he.capacity),It=St!==null&&St>0?Math.floor(St):lc,lr=et?FC(he.informationUser||null,he.informationPass||null,he.informationMail||null):"",Tr={packageName:i.name,informationUser:et&&he.informationUser||null,informationPass:et&&he.informationPass||null,informationMail:et&&he.informationMail||null,note:Qe&&he.note||null,supplier:Ve&&he.supplier||null,importPrice:Ke?Number(he.import||0)||0:null,accountUser:De&&he.accountUser||null,accountPass:De&&he.accountPass||null,accountMail:De&&he.accountMail||null,accountNote:De&&he.accountNote||null,capacity:De?It:null,hasCapacityField:De,expired:he.expired||null,slotLimit:_t,matchMode:n0(he.slotLinkMode)};try{const pr=await Tt("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Tr)});if(!pr.ok)throw new Error(`HTTP ${pr.status}`);const cr=await pr.json(),yr=A({...cr,slot:_t,slotUsed:0,capacity:De?It:cr.capacity,information:et?lr||null:cr.information,match:cr.match??n0(he.slotLinkMode),hasCapacityField:De});S(mr=>[...mr,yr]),cr.id!==void 0&&cr.id!==null&&E(cr.id,he.slotLinkMode),V(!1)}catch(pr){console.error("Li khi to gi sn phm:",pr)}},[i,A,S,E]),Ae=v.useCallback(async he=>{if(!J)return;const{template:De,rowId:et,accountStorageId:Qe}=J,Ve=De.fields.includes("capacity"),Ke=De.fields.includes("information"),wt=De.fields.includes("note"),_t=De.fields.includes("supplier"),St=De.fields.includes("import"),It=Bs(he.slot),lr=It!==null&&It>0?Math.floor(It):oc,Tr=Bs(he.capacity),pr=Tr!==null&&Tr>0?Math.floor(Tr):lc,cr=Ke?FC(he.informationUser||null,he.informationPass||null,he.informationMail||null):"",yr={packageName:De.name,informationUser:Ke&&he.informationUser||null,informationPass:Ke&&he.informationPass||null,informationMail:Ke&&he.informationMail||null,note:wt&&he.note||null,supplier:_t&&he.supplier||null,importPrice:St?Number(he.import||0)||0:null,expired:he.expired||null,slotLimit:lr,accountStorageId:Qe??null,accountUser:Ve&&he.accountUser||null,accountPass:Ve&&he.accountPass||null,accountMail:Ve&&he.accountMail||null,accountNote:Ve&&he.accountNote||null,capacity:Ve?pr:null,hasCapacityField:Ve,matchMode:n0(he.slotLinkMode)};try{const mr=await Tt(`/api/package-products/${et}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(yr)});if(!mr.ok)throw new Error(`HTTP ${mr.status}`);const tn=await mr.json(),ai=A({...tn,slot:lr,capacity:Ve?pr:tn.capacity,information:Ke?cr||null:tn.information,match:tn.match??n0(he.slotLinkMode),hasCapacityField:Ve});S(Hi=>Hi.map(Ta=>Ta.id===et?ai:Ta)),E(et,he.slotLinkMode),Pe()}catch(mr){console.error(`Cp nht Gi Sn Phm ${et} Li:`,mr)}},[J,Pe,A,S,E]),xt=v.useMemo(()=>[{name:"Tng",value:String(s.total),icon:Jl,accent:Or.sky},{name:"Gi sp ht",value:String(s.low),icon:iy,accent:Or.amber},{name:"Gi  ht",value:String(s.out),icon:ty,accent:Or.rose},{name:"Thm hm nay",value:"0",icon:ry,accent:Or.emerald}],[s]);return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun l Gi Sn phm"}),u.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Qun l cc loi gi sn phm v cc gi con."})]}),u.jsxs("div",{className:"mt-4 sm:mt-0 flex flex-wrap gap-3",children:[ie?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:pe,className:"flex items-center justify-center gap-1 rounded-lg bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-600 transition disabled:opacity-60",disabled:ge,title:"Xc nhn xa",children:u.jsx(Mo,{className:"h-5 w-5"})}),u.jsx("button",{type:"button",onClick:Ce,className:"flex items-center justify-center gap-1 rounded-lg bg-white/20 px-3 py-2 text-sm font-semibold text-gray-800 shadow hover:bg-gray-300 transition disabled:opacity-60",disabled:ge,title:"Hy xa",children:u.jsx(zr,{className:"h-5 w-5"})})]}):u.jsx(ba,{icon:Lo,onClick:()=>{de(!0),O(new Set)},disabled:ge,children:"Xa Loi gi"}),u.jsx(ba,{icon:qa,onClick:te,children:"To Loi Gi"}),u.jsx(ba,{icon:qa,onClick:Re,disabled:!n,children:"Thm Gi"})]})]}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-white/5 via-indigo-900/35 to-indigo-950/55 border border-white/10 p-6 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:xt.map(he=>u.jsx(Ua,{title:he.name,value:he.value,icon:he.icon,accent:he.accent},he.name))})}),u.jsxs("div",{className:"bg-white/10 rounded-xl shadow-sm p-6 text-white",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tng quan cc loi gi"}),u.jsx("p",{className:"text-sm text-white/80",children:"Chn mt loi gi  xem chi tit hoc xa."})]})}),a.length===0?u.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Khng c loi gi no c tm thy."}):u.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:a.map((he,De)=>{const et=he.name===n,Qe=BC[De%BC.length],Ve=fe.has(he.name.trim());return u.jsxs("div",{className:`relative isolate rounded-3xl border ${Qe.border} bg-white/80 p-5 text-white shadow-[0_20px_50px_-35px_rgba(15,23,42,0.7)] backdrop-blur transition duration-200 ${et?"ring-2 ring-blue-400 shadow-[0_25px_65px_-35px_rgba(37,99,235,0.7)]":"hover:shadow-[0_30px_75px_-40px_rgba(15,23,42,0.55)]"}`,children:[u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/70",children:"Loi Gi"}),u.jsx("h3",{className:"text-lg font-semibold",children:he.name}),u.jsxs("p",{className:"mt-1 text-sm text-white/80",children:["S lng gi: ",he.total]})]}),ie?u.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[u.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:Ve,disabled:ge,onChange:()=>Le(he.name)}),"Chn  xa"]}):u.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>H(he.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${et?"text-blue-300":"text-white/80"}`,title:"Xem chi tit",children:u.jsx(lf,{className:"h-5 w-5"})}),u.jsx("button",{type:"button",onClick:()=>xe(he.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chnh sa Loi Gi",children:u.jsx(ec,{className:"h-5 w-5"})})]})})]}),u.jsxs("dl",{className:"mt-5 grid grid-cols-3 gap-4 text-sm",children:[u.jsxs("div",{className:"rounded-2xl border border-white/60 bg-white/70 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tng"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-white",children:he.total})]}),u.jsxs("div",{className:"rounded-2xl border border-amber-100/70 bg-amber-50/60 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-amber-600",children:"Sp ht"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-amber-500",children:he.low})]}),u.jsxs("div",{className:"rounded-2xl border border-rose-100/70 bg-rose-50/60 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-rose-600",children:"Ht"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-rose-500",children:he.out})]})]})]},he.name)})})]}),n&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(el,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/70"}),u.jsx("input",{type:"text",placeholder:`Tm kim trong cc gi ca ${n}...`,className:"w-full pl-10 pr-4 py-2 border border-white/40 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:m,onChange:he=>_(he.target.value)})]}),u.jsx("select",{className:"w-full px-4 py-2 border border-white/40 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-700",value:g,onChange:he=>b(he.target.value),children:OC.map(he=>u.jsx("option",{value:he.value,children:he.label},he.value))}),u.jsx("button",{className:`px-4 py-2 rounded-lg transition-colors ${t.length?"bg-gray-100 text-gray-700 hover:bg-indigo-500/20":"bg-gray-100 text-white/70 cursor-not-allowed"}`,disabled:!t.length,children:"Xut Excel"})]}),u.jsxs("div",{className:"text-sm text-white/80",children:["ang xem loi gi:"," ",u.jsx("span",{className:"font-medium text-white",children:n??"Tt c"}),g!=="all"&&u.jsxs(u.Fragment,{children:[" ",""," ",u.jsx("span",{className:"font-medium text-white",children:OC.find(he=>he.value===g)?.label})]})]})]}),u.jsx(_Z,{rows:r,loading:h,showCapacityColumn:l,tableColumnCount:f,onEdit:Fe,onView:We})]}),u.jsx(SZ,{open:k,initialName:P,initialFields:L,mode:R,onClose:()=>j(!1),onSubmit:me}),i&&u.jsx(LC,{mode:"add",open:oe,template:i,onClose:()=>V(!1),onSubmit:$e}),ae&&J&&u.jsx(LC,{mode:"edit",open:ae,template:J.template,initialValues:J.initialValues,onClose:Pe,onSubmit:Ae}),u.jsx(NZ,{open:Z,row:G,onClose:je})]})},kZ=async e=>{const t=await Tt("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(Yo(n,{fallback:"Khong the luu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phan hoi khong hop le tu server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},AZ=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Tt(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(Yo(l,{fallback:"Khong the tai thong tin san pham."}))}const i=await n.json().catch(()=>null);if(!i||!Array.isArray(i.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const a=typeof i.count=="number"&&Number.isFinite(i.count)?i.count:i.items.length,s=typeof i.total=="number"&&Number.isFinite(i.total)?i.total:a;return{...i,count:a,total:s,offset:typeof i.offset=="number"&&Number.isFinite(i.offset)?i.offset:e.offset??0,limit:typeof i.limit=="number"&&Number.isFinite(i.limit)?i.limit:e.limit??i.items.length}},PZ=({searchTerm:e,onSearchChange:t,onAddClick:r})=>u.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[u.jsxs("div",{className:"relative flex-1 min-w-[220px] max-w-xl",children:[u.jsx("input",{type:"text",placeholder:"Tm kim theo tn hoc m sn phm...",className:"w-full bg-[#0f1729] border border-white/10 text-white placeholder:text-white/50 rounded-lg pl-10 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:e,onChange:n=>t(n.target.value)}),u.jsx(el,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"})]}),u.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold rounded-lg shadow",onClick:r,type:"button",children:"Thm Sn Phm Mi"})]}),B1=(e,t,r)=>Math.min(Math.max(e,t),r),jZ=(e,t)=>{const r=[];if(e<=5){for(let a=1;a<=e;a++)r.push(a);return r}const n=B1(t-1,2,e-3),i=B1(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let a=n;a<=i;a++)r.push(a);return i<e-1&&r.push("..."),r.push(e),r};function OZ({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:i=""}){const a=r>0?r:10,s=Math.max(1,Math.ceil(t/a)),l=B1(e,1,s),f=l>1,h=l<s,d=t===0?0:(l-1)*a+1,m=Math.min(l*a,t),x=jZ(s,l);return u.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${i}`,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(1),disabled:!f,children:"<<"}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(l-1),disabled:!f,children:"<"}),u.jsx("div",{className:"flex items-center gap-1",children:x.map((g,_)=>g==="..."?u.jsx("span",{className:"px-2 text-white/50",children:"..."},`ellipsis-${_}`):u.jsx("button",{className:`px-3 py-1 rounded font-semibold transition ${g===l?"bg-blue-600 text-white":"bg-white/5 text-white/80 hover:bg-white/10"}`,onClick:()=>n(g),disabled:g===l,children:g},g))}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(l+1),disabled:!h,children:">"}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(s),disabled:!h,children:">>"})]}),u.jsx("div",{className:"text-white/70",children:t===0?"0 mc":`${d}-${m} trong ${t}`})]})}const S0=10,DZ=e=>{const t=e.trim();return t?t.slice(0,2).toUpperCase():"--"},cn=e=>e?e.replace(/--\d+m$/i,"").trim():"",ri=e=>(e||"").replace(/\n/g,"<br/>"),Rl=e=>cn(e).toLowerCase(),iv=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),ku=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),i=s=>{if(s.nodeType===Node.TEXT_NODE)return iv(s.textContent||"");if(s.nodeType===Node.ELEMENT_NODE){const l=s;if(l.tagName==="BR")return"<br/>";if(l.tagName==="A"){const h=l.getAttribute("href")||"#",d=iv(h),m=Array.from(l.childNodes).map(i).join("");return`<a href="${d}" title="${d}" target="_blank" rel="noopener noreferrer">${m}</a>`}const f=Array.from(l.childNodes).map(i).join("");return n.has(l.tagName)?`${f}<br/>`:f}return""};return Array.from(r.body.childNodes).map(i).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return iv(e)}},RZ=e=>e?ku(e):"",av=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),i=/(thA'ng tin\s*&\s*tA-nh nng|thA'ng tin sn phcm|mA' t|nTi dung|tA-nh nng)/i,a=n.match(i),s=l=>l.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(a&&(a.index??0)>=3){const l=a.index??0,f=r.slice(0,l).trim(),h=r.slice(l).trim();return{rulesHtml:s(f),descriptionHtml:s(h)}}return{rulesHtml:e||"",descriptionHtml:t||""}},IZ=(e,t,r)=>{const n=(r||"").toLowerCase().trim(),i=new Map;t.forEach(l=>{const f=Rl(l.san_pham||""),h=Rl(l.package_product||"");[f,h].filter(Boolean).forEach(m=>{i.has(m)||i.set(m,l)})});const a=new Map;for(const l of e){const f=Rl(l.productId||""),h=f?i.get(f):null,d={...l,productId:cn(l.productId||""),productName:l.productName||(h?cn(h.package_product||h.san_pham||""):null)||l.productId,packageProduct:h?cn(h.package_product||h.san_pham||""):null,packageName:h?cn(h.package||h.san_pham||""):null,rulesHtml:l.rulesHtml||ri(l.rules||""),descriptionHtml:l.descriptionHtml||ri(l.description||"")},m=f||Rl(d.productName||"");m&&(a.has(m)||a.set(m,d))}for(const l of t){const f=Rl(l.san_pham||""),h=Rl(l.package_product||""),d=f||h,m=f&&a.has(f)||h&&a.has(h);!d||m||a.set(d,{id:l.id,productId:cn(l.san_pham||""),productName:cn(l.package_product||l.san_pham||""),packageProduct:cn(l.package_product||l.san_pham||""),packageName:cn(l.package||""),rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:null})}let s=Array.from(a.values());return n&&(s=s.filter(l=>`${l.productId||""} ${l.productName||""} ${l.description||""} ${l.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),s},$C=({item:e,size:t="small"})=>{const r=e.productName||e.productId||"--",n=DZ(r),i=t==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs",a="rounded-md bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold";return e.imageUrl?u.jsx("img",{src:e.imageUrl,alt:r,className:`${i} rounded-md object-cover`,onError:s=>{s.currentTarget.style.display="none"}}):u.jsx("div",{className:`${i} ${a}`,children:u.jsx("span",{children:n})})},FZ=({item:e,isExpanded:t,onToggle:r,onEdit:n})=>{const i=e.packageProduct||e.productName||e.productId||"--",a=e.rulesHtml||ri(e.rules||""),s=e.descriptionHtml||ri(e.description||""),{rulesHtml:l,descriptionHtml:f}=av(a,s),h=ku(l)||"Cha c-p nh-t",d=ku(f||ri(e.description||""))||"Cha c-p nh-t";return u.jsxs(Xa.Fragment,{children:[u.jsxs("tr",{className:`hover:bg-white/5 cursor-pointer ${t?"bg-white/5":""}`,onClick:()=>r(t?null:Number(e.id)),children:[u.jsx("td",{className:"px-4 py-3",children:u.jsx($C,{item:e})}),u.jsx("td",{className:"px-4 py-3 text-white",children:u.jsx("div",{className:"flex flex-col",children:u.jsx("span",{className:"font-semibold text-white",children:cn(e.productId||"")||"--"})})}),u.jsx("td",{className:"px-4 py-3 text-white",children:cn(i)||"--"}),u.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:u.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.rulesHtml?void 0:e.rules||"",dangerouslySetInnerHTML:{__html:h}})}),u.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:u.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.descriptionHtml?void 0:e.description||"",dangerouslySetInnerHTML:{__html:d}})}),u.jsxs("td",{className:"px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",children:u.jsx(lf,{className:"h-5 w-5 text-blue-400"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"S-a",type:"button",onClick:m=>{m.stopPropagation(),n(e)},children:u.jsx(Mh,{className:"h-5 w-5 text-green-400"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"XA3a",type:"button",children:u.jsx(Lo,{className:"h-5 w-5 text-red-400"})})]})]}),t&&u.jsx("tr",{className:"bg-white/5",children:u.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"ThA'ng tin chi tit"}),u.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:cn(e.packageProduct||e.productName||e.productId||"")||"Cha cA3 mA' t chi tit."})]}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[u.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:u.jsx($C,{item:e,size:"large"})}),u.jsxs("div",{className:"flex-1 space-y-3",children:[u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy t_c bo hAnh"}),u.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:ku(av(e.rulesHtml||ri(e.rules||""),e.descriptionHtml||ri(e.description||"")).rulesHtml)||"Cha cA3 quy t_c."}})]}),u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"ThA'ng tin sn phcm"}),u.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:ku(av(e.rulesHtml||ri(e.rules||""),e.descriptionHtml||ri(e.description||"")).descriptionHtml||ri(e.description||""))||"Cha cA3 nTi dung."}})]})]})]})]})})]},`${e.id}-${e.productId}`)},MZ=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:i,onPageChange:a,expandedId:s,onToggleExpand:l,onEdit:f})=>u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-[#0b1220] shadow-xl overflow-hidden",children:[u.jsxs("div",{className:"border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sn Phcm"}),r&&u.jsx("span",{className:"text-xs text-white/60",children:"?ang ti..."})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"8%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"17%"}}),u.jsx("col",{style:{width:"25%",minWidth:"240px"}}),u.jsx("col",{style:{width:"25%",minWidth:"240px"}}),u.jsx("col",{style:{width:"11%",minWidth:"120px"}})]}),u.jsx("thead",{className:"bg-white/5 text-white",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"nh"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"MA Sn Phcm"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"TAn Sn Phcm"}),u.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy T_c"}),u.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"MA' T"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao TAc"})]})}),u.jsxs("tbody",{className:"divide-y divide-white/5",children:[e.map(h=>u.jsx(FZ,{item:h,isExpanded:s===h.id,onToggle:l,onEdit:f},`${h.id}-${h.productId}`)),!r&&e.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/70",children:"KhA'ng cA3 d_ liu product_desc."})}),r&&e.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/80",children:"?ang ti danh sAch..."})})]})]})}),u.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:u.jsx(OZ,{currentPage:n,totalItems:t,pageSize:i,onPageChange:a})})]}),LZ=({open:e,url:t,error:r,onChange:n,onClose:i,onConfirm:a})=>e?u.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 px-4",children:u.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-[#0b1220] border border-white/10 p-5 shadow-2xl space-y-4",children:[u.jsx("h4",{className:"text-white font-semibold",children:'ChA"n liAn kt'}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70",children:"URL"}),u.jsx("input",{type:"text",value:t,onChange:s=>n(s.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."}),r&&u.jsx("div",{className:"text-xs text-rose-300",children:r})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:i,type:"button",children:"Hy"}),u.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:a,type:"button",children:'ChA"n link'})]})]})}):null,BZ=({product:e,saving:t,onClose:r,onSave:n})=>{const i=v.useMemo(()=>({productId:cn(e?.productId||""),productName:cn(e?.packageProduct||e?.productName||"")||"",rules:e?.rules||"",rulesHtml:e?.rulesHtml||ri(e?.rules||""),description:e?.description||"",descriptionHtml:e?.descriptionHtml||ri(e?.description||""),imageUrl:e?.imageUrl||""}),[e]),[a,s]=v.useState(i),[l,f]=v.useState(null),h=v.useRef(null),d=v.useRef(null),m=v.useRef(null),x=v.useRef(!1),[g,_]=v.useState(null),[w,b]=v.useState("#38bdf8"),S=v.useRef(null),[T,E]=v.useState(!1),[A,k]=v.useState("https://"),[j,P]=v.useState(null);v.useEffect(()=>{e&&(s(i),f(null),E(!1),k("https://"),P(null))},[i,e]);const M=()=>l==="rules"?h.current:d.current,L=(Z,se)=>{if(!se)return;const G=document.getSelection(),ne=G&&G.rangeCount>0?G.getRangeAt(0).cloneRange():null,ie=RZ(se.innerHTML),de=se.innerText;x.current=!0,s(Oe=>({...Oe,[Z]:de,[`${Z}Html`]:ie}));const ge=document.activeElement===se;ne&&ge&&(G?.removeAllRanges(),G?.addRange(ne))};v.useEffect(()=>{const Z=h.current;if(Z){if(x.current){x.current=!1;return}Z.innerHTML=a.rulesHtml||ri(a.rules)}},[a.rules,a.rulesHtml]),v.useEffect(()=>{const Z=d.current;if(Z){if(x.current){x.current=!1;return}Z.innerHTML=a.descriptionHtml||ri(a.description)}},[a.description,a.descriptionHtml]),v.useEffect(()=>{if(!g)return;const Z=S.current;Z&&requestAnimationFrame(()=>{typeof Z.showPicker=="function"?Z.showPicker():Z.click()})},[g]);const B=()=>{const Z=M();if(!Z){m.current=null;return}const se=document.getSelection();se&&se.rangeCount>0&&Z.contains(se.focusNode)?m.current=se.getRangeAt(0).cloneRange():m.current=null},R=(Z,se,G=!1)=>{const ne=M();if(ne){if(G&&m.current){const ie=document.getSelection();ie&&(ie.removeAllRanges(),ie.addRange(m.current))}else B();ne.focus(),document.execCommand(Z,!1,se),L(l||"rules",ne)}},U=()=>{M()&&(B(),k("https://"),P(null),E(!0))},oe=()=>{E(!1),P(null),k("https://")},V=()=>{const Z=M();if(!Z){P('Vui lAng ch?n nTi dung tr>c khi chA"n link.');return}const se=A.trim();if(!/^https?:\/\//i.test(se)){P("URL phi b_t `u bng http:// hoc https://");return}Z.focus();const G=document.getSelection();G&&m.current&&(G.removeAllRanges(),G.addRange(m.current)),document.execCommand("createLink",!1,se),L(l||"rules",Z),oe()},ae=(Z,se)=>{f(se),B(),_(Z),b(Z==="hiliteColor"?"#fef08a":"#38bdf8")},le=Z=>{const se=g;se&&(b(Z),_(null),R(se,Z,!0))},J=Z=>{if(!Z){_(null);return}b(Z),le(Z)},re=Z=>u.jsx("div",{className:"rich-toolbar-wrapper",children:u.jsxs("div",{className:"rich-toolbar mb-2",children:[u.jsx("button",{type:"button",onClick:()=>R("bold"),children:"B"}),u.jsx("button",{type:"button",onClick:()=>R("italic"),children:"I"}),u.jsx("button",{type:"button",onClick:()=>R("underline"),children:"U"}),u.jsx("button",{type:"button",onClick:U,children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[u.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),u.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.71"})]})}),u.jsx("button",{type:"button","data-color-button":"true",onClick:()=>ae("foreColor",Z),children:"A"}),u.jsx("button",{type:"button","data-color-button":"true",onClick:()=>ae("hiliteColor",Z),children:"Bg"}),u.jsx("button",{type:"button",className:"rich-toolbar-heading",onClick:()=>{const se=window.prompt("Chon heading (1-6):","2"),G=Number(se);Number.isInteger(G)&&G>=1&&G<=6&&R("formatBlock",`h${G}`)},children:"H"}),u.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:se=>{const G=se.target.value;se.target.value="",G&&R("fontName",G)},children:[u.jsx("option",{value:"",children:"Font"}),u.jsx("option",{value:"Arial",children:"Arial"}),u.jsx("option",{value:"Georgia",children:"Georgia"}),u.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),u.jsx("option",{value:"Verdana",children:"Verdana"}),u.jsx("option",{value:"Tahoma",children:"Tahoma"}),u.jsx("option",{value:"Roboto",children:"Roboto"}),u.jsx("option",{value:"Inter",children:"Inter"}),u.jsx("option",{value:"Poppins",children:"Poppins"}),u.jsx("option",{value:"Montserrat",children:"Montserrat"}),u.jsx("option",{value:"Open Sans",children:"Open Sans"}),u.jsx("option",{value:"Nunito",children:"Nunito"}),u.jsx("option",{value:"Raleway",children:"Raleway"}),u.jsx("option",{value:"Merriweather",children:"Merriweather"}),u.jsx("option",{value:"Playfair Display",children:"Playfair Display"}),u.jsx("option",{value:"Courier New",children:"Courier New"}),u.jsx("option",{value:"Fira Code",children:"Fira Code"}),u.jsx("option",{value:"Source Sans Pro",children:"Source Sans Pro"})]}),u.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:se=>{const G=se.target.value;se.target.value="",G&&R("fontSize",G)},children:[u.jsx("option",{value:"",children:"Size"}),u.jsx("option",{value:"2",children:"12px"}),u.jsx("option",{value:"3",children:"16px"}),u.jsx("option",{value:"4",children:"18px"}),u.jsx("option",{value:"5",children:"24px"}),u.jsx("option",{value:"6",children:"32px"}),u.jsx("option",{value:"7",children:"48px"})]})]})});return e?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:u.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl custom-scroll",children:[u.jsx("input",{ref:S,type:"color",className:"rich-color-native",value:w,onChange:Z=>J(Z.target.value),onBlur:()=>_(null)}),u.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Ch%nh s-a thA'ng tin sn phcm"}),u.jsx("button",{className:"text-white/70 hover:text-white",onClick:r,disabled:t,type:"button",children:"A-"})]}),u.jsxs("div",{className:"space-y-4 px-5 py-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"MA sn phcm"}),u.jsx("input",{type:"text",value:a.productId,onChange:Z=>s(se=>({...se,productId:Z.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"TAn sn phcm / Package product"}),u.jsx("input",{type:"text",value:a.productName,onChange:Z=>s(se=>({...se,productName:Z.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Quy t_c"}),re("rules"),u.jsx("div",{ref:h,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>f("rules"),onInput:Z=>L("rules",Z.currentTarget),onBlur:Z=>L("rules",Z.currentTarget)},(e?.id??"rules")+"-editor")]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"MA' t"}),re("description"),u.jsx("div",{ref:d,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>f("description"),onInput:Z=>L("description",Z.currentTarget),onBlur:Z=>L("description",Z.currentTarget)},(e?.id??"description")+"-editor")]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Image URL"}),u.jsx("input",{type:"text",value:a.imageUrl,onChange:Z=>s(se=>({...se,imageUrl:Z.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-3",children:[u.jsx("button",{className:"px-4 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:r,disabled:t,type:"button",children:"Hy"}),u.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:()=>n(a),disabled:t,type:"button",children:t?"?ang lu...":"Lu thay `\x07i"})]})]})}),u.jsx(LZ,{open:!!e&&T,url:A,error:j,onChange:Z=>{k(Z),P(null)},onClose:oe,onConfirm:V})]}):null},$Z=()=>{const[e,t]=v.useState(null),[r,n]=v.useState(1),[i,a]=v.useState([]),[s,l]=v.useState([]),[f,h]=v.useState(""),[d,m]=v.useState(!1),[x,g]=v.useState(null),_=v.useMemo(()=>IZ(i,s,f),[i,s,f]),w=v.useMemo(()=>Math.max(1,Math.ceil(_.length/S0)),[_.length]),b=v.useMemo(()=>{const E=(r-1)*S0,A=E+S0;return _.slice(E,A)},[_,r]),S=v.useCallback(async()=>{m(!0),g(null);try{const[E,A]=await Promise.all([AZ({}),Tt("/api/products")]),k=await A.json().catch(()=>[]);a(Array.isArray(E.items)?E.items:[]),l(Array.isArray(k)?k:[])}catch(E){a([]),l([]),g(Yo(E instanceof Error?E.message:String(E??""),{fallback:"KhA'ng th ti danh sAch sn phcm."}))}finally{m(!1)}},[]);return v.useEffect(()=>{S()},[S]),v.useEffect(()=>{r>w&&n(w)},[r,w]),{data:{mergedProducts:_,pagedProducts:b,loading:d,error:x,currentPage:r,totalPages:w,expandedId:e,searchTerm:f},actions:{handleSearchChange:E=>{h(E),n(1)},setCurrentPage:n,setExpandedId:t,reload:S,setProductDescs:a,setError:g}}},UZ=()=>{const{data:{mergedProducts:e,pagedProducts:t,loading:r,error:n,currentPage:i,expandedId:a,searchTerm:s},actions:{handleSearchChange:l,setCurrentPage:f,setExpandedId:h,reload:d,setProductDescs:m,setError:x}}=$Z(),[g,_]=v.useState(null),[w,b]=v.useState(!1),S=A=>{_(A)},T=()=>{_(null),b(!1)},E=v.useCallback(async A=>{if(!g)return;b(!0);const k={productId:A.productId.trim()||g.productId||"",rules:A.rulesHtml||A.rules,description:A.descriptionHtml||A.description,imageUrl:A.imageUrl||null};try{const j=await kZ(k),P=j.rulesHtml||j.rules||A.rulesHtml||A.rules||"",M=j.descriptionHtml||j.description||A.descriptionHtml||A.description||"",L={...g,id:j.id||g.id,productId:j.productId,productName:cn(A.productName||g.productName||"")||g.productName,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:M,imageUrl:j.imageUrl||A.imageUrl||null};m(B=>{const R=cn(j.productId||g.productId||"").toLowerCase(),U=B.findIndex(V=>cn(V.productId||"").toLowerCase()===R);if(U===-1)return[...B,{id:j.id||g.id,productId:j.productId,productName:L.productName||null,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:M,imageUrl:j.imageUrl||null}];const oe=[...B];return oe[U]={...oe[U],id:j.id||oe[U].id,productId:j.productId,productName:L.productName||oe[U].productName||null,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:M,imageUrl:j.imageUrl||null},oe}),_(null)}catch(j){x(Yo(j instanceof Error?j.message:String(j??""),{fallback:"Khng th lu thng tin sn phm."}))}finally{b(!1)}},[g,m,x]);return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thng Tin Sn Phm"}),u.jsx("p",{className:"text-sm text-white/70",children:"ng b vi bng product_desc trong database."})]}),u.jsx(PZ,{searchTerm:s,onSearchChange:l,onAddClick:d}),n&&u.jsx("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),u.jsx(MZ,{products:t,mergedTotal:e.length,loading:r,currentPage:i,pageSize:S0,onPageChange:f,expandedId:a,onToggleExpand:h,onEdit:S}),g&&u.jsx(BZ,{product:g,saving:w,onClose:T,onSave:E})]})},zZ=({searchTerm:e,statusFilter:t,isLoading:r,isRefreshing:n,error:i,onSearchChange:a,onStatusChange:s,onRefresh:l})=>u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/70 via-slate-900/60 to-indigo-950/70 p-6 text-white shadow-lg backdrop-blur",children:[u.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[u.jsxs("div",{className:"relative md:col-span-2",children:[u.jsx(el,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-white/60"}),u.jsx("input",{type:"text",placeholder:"Tm Kim Sn Phm...",className:"w-full rounded-lg border border-white/20 bg-white/10 px-10 py-2 text-white placeholder:text-white/60 focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:e,onChange:f=>a(f.target.value)})]}),u.jsxs("select",{className:"w-full rounded-lg border border-white/20 bg-white/10 px-4 py-2 text-white focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:t,onChange:f=>s(f.target.value),children:[u.jsx("option",{value:"all",children:"Trng Thi"}),u.jsx("option",{value:"active",children:"ang Hot ng"}),u.jsx("option",{value:"inactive",children:"Tm Dng"})]}),u.jsx(ba,{className:"w-full justify-center",type:"button",onClick:l,disabled:r||n,children:r||n?"ang ng B...":"ng B Li"})]}),i&&u.jsx("div",{className:"mt-4 rounded-lg border border-red-400/40 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:i})]}),WZ=({stats:e,onAddProduct:t})=>u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col justify-between gap-3 sm:flex-row sm:items-center",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bng Gi Sn Phm"}),u.jsx(ba,{icon:qa,onClick:t,children:"Thm Sn Phm"})]}),u.jsx("div",{className:"rounded-[28px] border border-white/10 bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(r=>u.jsx(Ua,{title:r.name,value:r.value,icon:r.icon,subtitle:r.subtitle,accent:Or[r.accent]},r.name))})})]}),$1=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),U1=0,sv=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},x3=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},UC=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),HZ=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",VZ=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Thng`},KZ=(e,t)=>{const r=VZ(t);return e&&r?`${e} ${r}`:e||r||HZ(t)||"Khng Xc nh"},Os=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},GZ=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},YZ=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t))return null;const r=t>1?t/100:t;return r<0||r>=1?null:1-r},ph=(e,t,r)=>typeof e!="number"||!Number.isFinite(e)||e<U1||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?!1:YZ(t,e)!==null,XZ=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",qZ=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${XZ(r.sourceName)}`,i=t.get(n);if(!i){t.set(n,r);continue}const a=i.price??Number.POSITIVE_INFINITY,s=r.price??Number.POSITIVE_INFINITY,l=Date.parse(i.lastOrderDate??"")||0,f=Date.parse(r.lastOrderDate??"")||0;(s<a||s===a&&f>l)&&t.set(n,r)}return Array.from(t.values())},i0=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,i=r.price??Number.POSITIVE_INFINITY;if(n!==i)return n-i;const a=Date.parse(t.lastOrderDate??"")||0,s=Date.parse(r.lastOrderDate??"")||0;return a!==s?s-a:t.sourceName.localeCompare(r.sourceName)}),$l=(e,t)=>`${e}-${t}`,Qu=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,g3=(e,t)=>Qu(t,e),v3=(e,t,r,n,i)=>{const a=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof i=="number"&&Number.isFinite(i)&&i>0&&i||null;if(a===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!ph(t,e,r))return null;const s=t>1?t/100:t,l=e&&e>1?e:e||1,f=a*l,h=f-f*s;return Math.min(f,Math.max(a,h))},Au=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=g3(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,i=Qu(n??t,e.pctKhach),a=v3(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.retailPrice,promoPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.promoPrice}},z1=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},y3=e=>{if(e==null)return"";const t=String(e).replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?new Intl.NumberFormat("vi-VN").format(r):""},Mi=e=>{if(e==null)return null;const t=e.toString().replace(",",".").trim();return t?Os(t):null},zC=({multiplier:e,price:t,basePrice:r})=>"",Jn=e=>{const t=x3(e);return t===null||t<=0?"-":$1.format(t)},ov=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},WC=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},Ou=e=>(e||"").trim(),HC=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=x3(e)??0;return t===0?$1.format(0):$1.format(t)},ZZ=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,i=typeof r=="number"&&Number.isFinite(r)?r-e:null,a=HC(n),s=HC(i);return`${a} - ${s}`},mh=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},QZ=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,i=r.price??Number.POSITIVE_INFINITY;if(i<n)return r;if(i>n)return t;const a=mh(t.lastOrderDate);return mh(r.lastOrderDate)>a?r:t},null):null,Ds=(e,t)=>{const r=e.reduce((n,i)=>{const a=typeof i.price=="number"&&Number.isFinite(i.price)?i.price:Number.NEGATIVE_INFINITY;return a>n?a:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},w3=(e,t)=>{const r=UC(e?.[Nr.package]??e?.package_label),n=UC(e?.[Nr.packageProduct]??e?.package_product_label),i=(e?.[Nr.product]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Khng xc nh",packageProduct:n,sanPhamRaw:i,variantLabel:KZ(n,i),pctCtv:Os(e?.[Nr.pctCtv]),pctKhach:Os(e?.[Nr.pctKhach]),pctPromo:Os(e?.[Nr.pctPromo]),isActive:GZ(e?.[Nr.isActive]),baseSupplyPrice:Os(e?.max_supply_price),wholesalePrice:Os(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:Os(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:Os(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[Nr.update]=="string"?e[Nr.update]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:typeof e?.update=="string"?e.update:null}},JZ=({item:e,productKey:t,isExpanded:r,statusOverride:n,updatedTimestamp:i,supplyState:a,pendingNewSupply:s,editingProductId:l,productEditForm:f,productEditError:h,isSavingProductEdit:d,isDeletingProduct:m,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:_,supplyRowErrors:w,onToggleProductDetails:b,onStartProductEdit:S,onProductEditChange:T,onCancelProductEdit:E,onSubmitProductEdit:A,onRequestDeleteProduct:k,onStartEditingSupply:j,onSupplyInputChange:P,onCancelSupplyEditing:M,onConfirmSupplyEditing:L,onStartAddSupplierRow:B,onNewSupplierInputChange:R,onCancelAddSupplierRow:U,onConfirmAddSupplierRow:oe,onDeleteSupplyRow:V,onToggleStatus:ae,fetchSupplyPricesForProduct:le})=>{const J=a?.items??[],re=s??null,Z=QZ(J),se=Z?.price??e.baseSupplyPrice,G=Z?.sourceName??"-",ne=Ds(J,e.baseSupplyPrice),ie=[...J.map(pe=>({kind:"existing",supplier:pe})),...re?[{kind:"new"}]:[]],de=n??e.isActive??!1,ge=i??e.lastUpdated??"",Oe=ge?WC(ge):"-",fe=ph(e.pctPromo,e.pctKhach,e.pctCtv),O=l===e.id,D=O?f:null,z=D?{pctCtv:Mi(D.pctCtv),pctKhach:Mi(D.pctKhach),pctPromo:Mi(D.pctPromo)}:null,H=z?g3(z.pctCtv,ne):null,te=typeof H=="number"&&Number.isFinite(H)&&H>0?H:ne,Re=z?Qu(te,z.pctKhach):null,Ee=z?v3(z.pctKhach,z.pctPromo,z.pctCtv,H,ne):null,me=ov(z?.pctPromo??null),xe=ph(z?.pctPromo??null,z?.pctKhach??null,z?.pctCtv??null)&&Number.isFinite(Ee??NaN),Ce=typeof ne=="number"&&Number.isFinite(ne)&&ne>0?Jn(ne):"Cha c d liu",Le=()=>{le(e.sanPhamRaw)};return u.jsxs(Xa.Fragment,{children:[u.jsxs("tr",{className:"cursor-pointer bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 transition hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70",onClick:()=>b(e),children:[u.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(i4,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${r?"rotate-180":""}`}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-semibold text-white",children:e.packageName}),u.jsx("div",{className:"text-xs text-white/70",children:e.variantLabel})]})]})}),u.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[u.jsx("div",{className:"text-sm font-semibold text-white",children:Jn(e.wholesalePrice)}),u.jsx("div",{className:"text-xs text-white/70",children:zC({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),u.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[u.jsx("div",{className:"text-sm font-semibold text-amber-300",children:Jn(e.retailPrice)}),u.jsx("div",{className:"text-xs text-white/70",children:zC({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),u.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:fe?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-sm font-semibold text-pink-200",children:Jn(e.promoPrice)}),u.jsx("div",{className:"text-xs text-white/70",children:ov(e.pctPromo)??"-"})]}):u.jsx("div",{className:"text-sm text-white/60",children:"-"})}),u.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:u.jsx("div",{className:"flex flex-col items-center",children:u.jsx("button",{type:"button",onClick:pe=>{pe.stopPropagation(),ae(e)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${de?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":de,children:u.jsx(s4,{className:"h-4 w-4"})})})}),u.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:u.jsx("div",{className:"text-sm text-white",children:Oe})}),u.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:u.jsxs("div",{className:"flex items-center justify-end gap-3",children:[u.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:pe=>S(pe,e),children:u.jsx(ec,{className:"h-4 w-4"})}),u.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${m?"cursor-not-allowed opacity-60":""}`,onClick:pe=>k(pe,e),disabled:m,children:u.jsx(Lo,{className:"h-4 w-4"})})]})})]}),O&&D&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 pb-6",children:u.jsxs("div",{className:"space-y-6 rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[u.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thng Tin Sn Phm"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tn sn phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:D.packageName,onChange:pe=>T("packageName",pe.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Gi sn phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:D.packageProduct,onChange:pe=>T("packageProduct",pe.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"M sn phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:D.sanPham,onChange:pe=>T("sanPham",pe.target.value)})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"T gi"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi CTV"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:D.pctCtv,onChange:pe=>T("pctCtv",pe.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi khch"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:D.pctKhach,onChange:pe=>T("pctKhach",pe.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi khuyn mi"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:D.pctPromo,onChange:pe=>T("pctPromo",pe.target.value)})]})]})]})]}),D&&u.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-4 shadow-lg backdrop-blur",children:[u.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[u.jsx("span",{children:"Gi d kin theo t gi"}),u.jsxs("span",{className:"font-medium normal-case text-amber-200",children:["Gi ngun cao nht:"," ",u.jsx("span",{className:"font-semibold",children:Ce})]})]}),u.jsxs("div",{className:`mt-4 grid gap-3 text-center text-sm ${xe?"md:grid-cols-3":"md:grid-cols-2"}`,children:[u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi S d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(H)}),u.jsx("p",{className:"text-[11px] text-white/70",children:D.pctCtv?`T Gi: ${D.pctCtv}`:"Nhp t gi CTV"})]}),u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khch d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(Re)}),u.jsx("p",{className:"text-[11px] text-white/70",children:D.pctKhach?`T Gi: ${D.pctKhach}`:"Nhp t gi khch"})]}),xe&&u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khuyn mi d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(Ee)}),u.jsx("p",{className:"text-[11px] text-white/70",children:me??"Nhp t gi khuyn mi"})]})]})]}),h&&u.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:h}),u.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:E,disabled:d,children:"Hy b"}),u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:A,disabled:d,children:d?"ang Lu...":"Lu thay i"})]})]})})}),r&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 pb-6",children:u.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 p-4 text-white",children:u.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tit gi sn phm"})}),u.jsxs("div",{className:`grid gap-4 text-center ${fe?"md:grid-cols-4":"md:grid-cols-3"}`,children:[u.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi ngun thp nht"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(se)}),u.jsx("p",{className:"text-xs text-white/70",children:G})]}),u.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi s hin ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(e.wholesalePrice)})]}),u.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi khch hin ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(e.retailPrice)})]}),fe&&u.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi khuyn mi hin ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Jn(e.promoPrice)}),u.jsx("p",{className:"text-xs text-white/70",children:ov(e.pctPromo)??"-"})]})]}),u.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/15",children:[u.jsx("div",{className:"flex justify-end border-b border-white/10 bg-white/5 px-4 py-2",children:u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>B(e.id),disabled:!!re,children:[u.jsx(ay,{className:"h-4 w-4"}),"Thm ngun"]})}),u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{className:"bg-white/5 text-[11px] uppercase tracking-wide text-white/70",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left",children:"NCC"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Gi nhp"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Li nhun"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Thao tc"})]})}),u.jsx("tbody",{children:a?.loading?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"ang Ti D Liu"})}):a?.error?u.jsx("tr",{children:u.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white",children:[u.jsx("span",{children:a.error})," ",u.jsx("button",{type:"button",className:"text-xs text-red-400 hover:text-red-200 hover:underline",onClick:Le,children:"Th Li"})]})}):J.length===0&&ie.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Cha c d liu t NCC"})}):ie.map(pe=>{if(pe.kind==="existing"&&pe.supplier){const Fe=pe.supplier,Pe=$l(e.id,Fe.sourceId),We=x[Pe]??!1,je=_[Pe]??!1,$e=g[Pe]??(Fe.price??"").toString();w[Pe];const Ae=!We||je,xt=Jn(Fe.price);return u.jsxs("tr",{className:"border-t border-dashed border-white/10",children:[u.jsxs("td",{className:"px-4 py-3",children:[u.jsx("div",{className:"text-sm font-semibold text-white",children:Fe.sourceName}),u.jsx("div",{className:"text-xs text-white/60",children:Fe.lastOrderDate?WC(Fe.lastOrderDate):"-"})]}),u.jsx("td",{className:"px-4 py-3",children:We?u.jsxs("div",{className:"flex flex-col items-center gap-1",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"text",className:"w-28 rounded-lg border border-white/25 bg-white/5 px-2 py-1 text-center text-sm text-white placeholder:text-white/50 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/30 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:$e,onChange:he=>P(e.id,Fe.sourceId,he.target.value),disabled:Ae}),u.jsx("span",{className:"text-xs text-white/70",children:""})]}),u.jsx("span",{className:"text-[11px] text-white/60",children:"Nhp gi mi"})]}):u.jsx("div",{className:"flex justify-center",children:u.jsx("span",{className:"inline-flex min-w-[112px] justify-center rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white",children:xt})})}),u.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:ZZ(Fe.price,e.wholesalePrice,e.retailPrice)}),u.jsx("td",{className:"px-4 py-3",children:We?u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:je,onClick:()=>L(e.id,Fe.sourceId,t,e.sanPhamRaw),children:u.jsx(Mo,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:je,onClick:()=>M(e.id,Fe.sourceId),children:u.jsx(zr,{className:"h-4 w-4"})})]}):u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:je,onClick:()=>j(e.id,Fe.sourceId,Fe.price),children:u.jsx(ec,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:je,onClick:()=>V(e.id,Fe.sourceId,t,e.sanPhamRaw),children:u.jsx(o4,{className:"h-4 w-4"})})]})})]},Pe)}if(pe.kind==="new"&&re){const Fe=re;return u.jsxs(Xa.Fragment,{children:[u.jsxs("tr",{className:"border-t border-dashed border-sky-100 bg-sky-50/40",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsx("input",{type:"text",className:"w-full rounded-lg border border-sky-200 bg-white px-3 py-2 text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200",placeholder:"Tn ngun",value:Fe.sourceName,onChange:Pe=>R(e.id,"sourceName",Pe.target.value),disabled:Fe.isSaving})}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center gap-1",children:[u.jsx("input",{type:"text",className:"w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Gi nhp",value:Fe.price,onChange:Pe=>R(e.id,"price",Pe.target.value),disabled:Fe.isSaving}),u.jsx("span",{className:"text-xs text-white/70",children:""})]})}),u.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:"-"}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:Fe.isSaving,onClick:()=>oe(e),children:u.jsx(Mo,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:Fe.isSaving,onClick:()=>U(e.id),children:u.jsx(zr,{className:"h-4 w-4"})})]})})]}),Fe.error&&u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:Fe.error})})]},`new-${e.id}`)}return null})})]})]})]})})})})]})},eQ=Xa.memo(JZ),tQ=({items:e,isLoading:t,error:r,expandedProductId:n,supplyPriceMap:i,statusOverrides:a,updatedTimestampMap:s,editingSupplyRows:l,supplyPriceDrafts:f,savingSupplyRows:h,supplyRowErrors:d,newSupplyRows:m,editingProductId:x,productEditForm:g,productEditError:_,isSavingProductEdit:w,deleteProductState:b,onToggleProductDetails:S,onStartProductEdit:T,onProductEditChange:E,onCancelProductEdit:A,onSubmitProductEdit:k,onRequestDeleteProduct:j,onStartEditingSupply:P,onSupplyInputChange:M,onCancelSupplyEditing:L,onConfirmSupplyEditing:B,onStartAddSupplierRow:R,onNewSupplierInputChange:U,onCancelAddSupplierRow:oe,onConfirmAddSupplierRow:V,onDeleteSupplyRow:ae,onToggleStatus:le,fetchSupplyPricesForProduct:J})=>u.jsx("div",{className:"overflow-hidden rounded-2xl border border-white/10 bg-white/10 text-white shadow-lg backdrop-blur",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Sn Phm"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi S"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi L"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi Khyn Mi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Tnh Trng"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Cp Nht"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Thao Tc"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10 bg-white/5",children:t?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"ang Ti D Liu..."})}):e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:r?"KhA'ng th ti d_ liu. Vui lAng th- li.":"KhA'ng cA3 sn phcm."})}):e.map(re=>{const Z=n===re.id,se=Ou(re.sanPhamRaw),G=i[se],ne=m[re.id]||null,ie=b.product?.id===re.id&&b.loading;return u.jsx(eQ,{item:re,productKey:se,isExpanded:Z,statusOverride:a[re.id],updatedTimestamp:s[re.id],supplyState:G,pendingNewSupply:ne,editingProductId:x,productEditForm:g,productEditError:_,isSavingProductEdit:w,isDeletingProduct:ie,editingSupplyRows:l,supplyPriceDrafts:f,savingSupplyRows:h,supplyRowErrors:d,onToggleProductDetails:S,onStartProductEdit:T,onProductEditChange:E,onCancelProductEdit:A,onSubmitProductEdit:k,onRequestDeleteProduct:j,onStartEditingSupply:P,onSupplyInputChange:M,onCancelSupplyEditing:L,onConfirmSupplyEditing:B,onStartAddSupplierRow:R,onNewSupplierInputChange:U,onCancelAddSupplierRow:oe,onConfirmAddSupplierRow:V,onDeleteSupplyRow:ae,onToggleStatus:le,fetchSupplyPricesForProduct:J},re.id)})})]})})}),rQ=({isOpen:e,createForm:t,createSuppliers:r,supplierOptions:n,bankOptions:i,isLoadingSuppliers:a,isLoadingBanks:s,isSubmitting:l,createError:f,onClose:h,onFormChange:d,onSupplierChange:m,onSupplierSelectChange:x,onSupplierPriceInput:g,onEnableCustomSupplier:_,onAddSupplier:w,onRemoveSupplier:b,onSubmit:S})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-black/40 px-2 py-4 sm:px-4 sm:py-6",children:u.jsxs("div",{className:"relative flex w-full max-w-5xl flex-col rounded-2xl bg-white shadow-2xl max-h-[95vh]",children:[u.jsx("button",{className:"absolute right-4 top-4 text-white/60 hover:text-white/70",onClick:h,children:u.jsx(zr,{className:"h-6 w-6"})}),u.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto px-4 py-6 sm:px-6 sm:py-8",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-sky-100",children:"Thm Sn Phm mi"}),u.jsx("p",{className:"text-base text-sky-200/90",children:"Nhp Thng tin Sn Phm, Nh Cung Cp, T Gi"})]}),u.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-sky-100 bg-gradient-to-br from-white via-sky-50 to-sky-100/40 p-5 shadow-sm",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-600",children:"Thng Tin Sn Phm"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageName,onChange:T=>d("packageName",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageProduct,onChange:T=>d("packageProduct",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"M Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.sanPham,onChange:T=>d("sanPham",T.target.value)})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-purple-100 bg-gradient-to-br from-white via-purple-50 to-purple-100/40 p-5 shadow-sm",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-600",children:"T Gi"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi CTV"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctCtv,onChange:T=>d("pctCtv",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khch"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctKhach,onChange:T=>d("pctKhach",T.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khuyn Mi"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctPromo,onChange:T=>d("pctPromo",T.target.value)})]})]})]})]}),u.jsx("div",{className:"rounded-2xl border border-gray-100 bg-gradient-to-br from-white via-gray-50 to-gray-100/40 p-5 shadow-sm",children:u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Thng Tin Nh Cung Cp"}),u.jsx("div",{className:"space-y-4",children:r.map((T,E)=>u.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/80 p-4 shadow-inner",children:[u.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[u.jsxs("p",{className:"text-sm font-semibold text-white",children:["Nh Cung Cp #",E+1]}),r.length>1&&u.jsx("button",{type:"button",className:"text-xs text-red-500 hover:text-red-600",onClick:()=>b(T.id),children:"Xa"})]}),u.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tn NCC"}),u.jsxs("div",{className:"mt-1 flex items-stretch gap-2",children:[u.jsx("div",{className:"flex-1",children:T.useCustomName?u.jsx("input",{type:"text",className:"w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",placeholder:"Nhp tn NCC",value:T.sourceName,onChange:A=>m(T.id,"sourceName",A.target.value)}):u.jsxs("select",{className:"supplier-select w-full rounded-xl border border-gray-200 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.sourceId!==null?String(T.sourceId):T.sourceName,onChange:A=>x(T.id,A.target.value),children:[u.jsx("option",{value:"",children:a?"ang ti NCC...":"Chn NCC"}),n.map(A=>{const k=A.id!==null?String(A.id):A.name;return u.jsx("option",{value:k,children:A.name},k)})]})}),u.jsx("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-xl border border-blue-300/70 bg-white/90 text-blue-600 hover:bg-blue-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-60",onClick:()=>T.useCustomName?x(T.id,""):_(T.id),title:T.useCustomName?"Quay li chn NCC c sn":"Thm NCC mi (in tn th cng)",children:T.useCustomName?u.jsx(C6,{className:"h-5 w-5"}):u.jsx(qa,{className:"h-5 w-5"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Nhp"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:y3(T.price),onChange:A=>g(T.id,A.target.value),placeholder:"0"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"S Ti Khon"}),(()=>{const A=!T.useCustomName&&!!T.sourceId&&!!(T.bankBin||T.numberBank);return u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.numberBank,onChange:k=>m(T.id,"numberBank",k.target.value),disabled:A,style:A?{opacity:.7,cursor:"not-allowed"}:void 0})})()]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Ngn Hng"}),(()=>{const A=!T.useCustomName&&!!T.sourceId&&!!(T.bankBin||T.numberBank);return u.jsxs("select",{className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.bankBin,onChange:k=>m(T.id,"bankBin",k.target.value),disabled:A,style:A?{opacity:.7,cursor:"not-allowed"}:void 0,children:[u.jsx("option",{value:"",children:"Chn Ngn Hng"}),i.map(k=>u.jsx("option",{value:k.bin,children:k.name},k.bin))]})})(),s&&u.jsx("p",{className:"mt-1 text-[11px] text-white/60",children:"ang Ti Danh Sch Ngn Hng..."})]}),u.jsx("div",{className:"md:col-span-2",children:(()=>{const A=Number((T.price||"").replace(/\D+/g,"")),k=Mi(t.pctCtv),j=Mi(t.pctKhach),P=A&&k?Qu(A,k):null,M=j&&(P||A)?Qu(P||A,j):null;return u.jsxs("div",{className:"mt-3 rounded-xl border border-white/20 bg-white/10 px-4 py-3 shadow-inner",children:[u.jsx("p",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Xem trc gi"}),u.jsxs("div",{className:"mt-2 grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi s (theo T gi CTV)"}),u.jsx("span",{className:"text-sm font-semibold text-white",children:P?Jn(P):"-"})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi l (theo T gi Khch)"}),u.jsx("span",{className:"text-sm font-semibold text-white",children:M?Jn(M):"-"})]})]})]})})()})]})]},T.id))}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{type:"button",className:"inline-flex items-center rounded-full border border-dashed border-blue-300 px-4 py-2 text-sm font-semibold text-blue-600 hover:border-blue-400 hover:text-blue-700",onClick:w,children:[u.jsx($6,{className:"mr-2 h-4 w-4"}),"Thm NCC"]})})]})}),f&&u.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:f}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:h,disabled:l,children:"Hy B"}),u.jsx(ba,{className:"px-5 py-2 text-sm font-semibold",onClick:S,disabled:l,children:l?"ang Lu...":"Lu Sn Phm"})]})]})]})}):null,nQ=({product:e,loading:t,error:r,onClose:n,onConfirm:i})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:()=>{t||n()},children:u.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:a=>a.stopPropagation(),children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xc nh Xa"}),u.jsx("p",{className:"text-sm text-sky-200/90",children:"Hnh ng ny s Xa Sn Phm khi bng Gi."})]}),u.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:n,disabled:t,children:u.jsx(zr,{className:"h-5 w-5"})})]}),u.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-sky-100",children:e.packageName||e.packageProduct||e.sanPhamRaw||`Sn Phm #${e.id}`}),u.jsxs("p",{className:"text-sm text-sky-200/90",children:["M: ",e.sanPhamRaw||"Khng xc nh"]})]}),u.jsx("p",{children:"Bn c chc chn mun xa sn phm ny? Hnh ng khng th hon tc v d liu lin quan s c cp nht."})]}),r&&u.jsx("p",{className:"mt-4 text-xs text-red-500",children:r}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{type:"button",className:"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-white/70 hover:bg-indigo-500/10 disabled:opacity-50",onClick:n,disabled:t,children:"Hy"}),u.jsx("button",{type:"button",className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60",onClick:i,disabled:t,children:t?"ang Xa...":"Xa Sn Phm"})]})]})}):null,iQ=e=>{const[t,r]=v.useState(""),[n,i]=v.useState("all"),[a,s]=v.useState([]),[l,f]=v.useState(!1),[h,d]=v.useState(null),[m,x]=v.useState(null),[g,_]=v.useState({}),[w,b]=v.useState({}),[S,T]=v.useState(!1),E=v.useCallback(async()=>{f(!0),d(null);try{const k=await fetch(`${e}${Nt.PRODUCT_PRICES}`,{credentials:"include"});if(k.status===401){window.location.href="/login";return}if(!k.ok)throw new Error("KhA'ng th ti d_ liu sn phcm.");const j=await k.json(),L=(Array.isArray(j)?j:Array.isArray(j?.items)?j.items:[]).map((R,U)=>w3(R,U)).map(R=>Au(R,R.baseSupplyPrice)),B=L.reduce((R,U)=>(U.lastUpdated&&(R[U.id]=U.lastUpdated),R),{});s(L),_({}),b(B)}catch(k){console.error("L-i khi ti d_ liu:",k),s([]),d(k instanceof Error?k.message:"KhA'ng th ti d_ liu product_price.")}finally{f(!1)}},[e]),A=v.useMemo(()=>{const k=t.trim().toLowerCase();return a.filter(j=>n==="active"&&!j.isActive||n==="inactive"&&j.isActive?!1:k?[j.packageName,j.packageProduct,j.sanPhamRaw,j.variantLabel].join(" ").toLowerCase().includes(k):!0).sort((j,P)=>{const M=!(g[j.id]??j.isActive),L=!(g[P.id]??P.isActive);if(M!==L)return M?1:-1;const B=mh(w[j.id]??j.lastUpdated),R=mh(w[P.id]??P.lastUpdated);return B!==R?R-B:j.id-P.id})},[a,t,n,g,w]);return{searchTerm:t,setSearchTerm:r,statusFilter:n,setStatusFilter:i,productPrices:a,setProductPrices:s,isLoading:l,setIsLoading:f,error:h,setError:d,statusOverrides:g,setStatusOverrides:_,updatedTimestampMap:w,setUpdatedTimestampMap:b,expandedProductId:m,setExpandedProductId:x,isRefreshing:S,setIsRefreshing:T,fetchProductPrices:E,filteredPricing:A}},aQ=async e=>{const t=await Tt(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(Yo(n,{fallback:"Khng th xa sn phm khi bng gi.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},sQ=e=>({packageName:e.packageName||"",packageProduct:e.packageProduct||"",sanPham:e.sanPhamRaw||"",pctCtv:e.pctCtv!==null&&e.pctCtv!==void 0?String(e.pctCtv):"",pctKhach:e.pctKhach!==null&&e.pctKhach!==void 0?String(e.pctKhach):"",pctPromo:e.pctPromo!==null&&e.pctPromo!==void 0?String(e.pctPromo):""}),oQ=({apiBase:e,productPrices:t,setProductPrices:r,fetchProductPrices:n,statusOverrides:i,setStatusOverrides:a,updatedTimestampMap:s,setUpdatedTimestampMap:l})=>{const[f,h]=v.useState(null),[d,m]=v.useState(null),[x,g]=v.useState(null),[_,w]=v.useState(!1),[b,S]=v.useState(!1),[T,E]=v.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[A,k]=v.useState([sv()]),[j,P]=v.useState(null),[M,L]=v.useState(!1),[B,R]=v.useState([]),[U,oe]=v.useState(!1),[V,ae]=v.useState([]),[le,J]=v.useState(!1),[re,Z]=v.useState({product:null,loading:!1,error:null}),se=v.useCallback(async()=>{if(!(le||V.length>0)){J(!0);try{const Pe=await fetch(`${e}${Nt.BANK_LIST}`,{credentials:"include"});if(!Pe.ok)throw new Error("Khng th ti danh sch ngn hng.");const We=await Pe.json(),je=Array.isArray(We)?We.map($e=>({bin:$e?.bin?.toString().trim()??"",name:$e?.bank_name?.toString().trim()??$e?.name??""})).filter($e=>$e.bin&&$e.name):[];ae(je)}catch(Pe){console.error("Li khi ti danh sch ngn hng:",Pe)}finally{J(!1)}}},[e,V.length,le]),G=v.useCallback(async()=>{if(!(U||B.length>0)){oe(!0);try{const Pe=await fetch(`${e}${Nt.SUPPLIES}`,{credentials:"include"});if(!Pe.ok)throw new Error("Khng th ti danh sch NCC.");const We=await Pe.json().catch(()=>null),$e=(Array.isArray(We?.items)?We.items:Array.isArray(We)?We:[]).map(he=>{const De=he?.id??he?.sourceId??he?.source_id,et=typeof De=="number"&&Number.isFinite(De)?De:Number.isFinite(Number(De))?Number(De):null,Qe=he?.source_name??he?.name??he?.sourceName??he?.source??"";return{id:et??null,name:(Qe||"").trim(),numberBank:he?.number_bank??he?.numberBank??he?.bankNumber??"",binBank:he?.bin_bank??he?.binBank??he?.bankBin??""}}).filter(he=>he.name.length>0),Ae=[],xt=new Set;for(const he of $e){const De=he.id!==null?`id:${he.id}`:`name:${he.name.toLowerCase().trim()}`;xt.has(De)||(xt.add(De),Ae.push(he))}R(Ae)}catch(Pe){console.error("Li khi ti danh sch NCC:",Pe)}finally{oe(!1)}}},[e,U,B.length]);v.useEffect(()=>{b&&V.length===0&&!le&&se(),b&&B.length===0&&!U&&G()},[b,V.length,le,se,B.length,U,G]);const ne=(Pe,We)=>{if(Pe.stopPropagation(),w(!1),f===We.id){h(null),m(null),g(null);return}g(null),h(We.id),m(sQ(We))},ie=(Pe,We)=>{m(je=>je&&{...je,[Pe]:We})},de=()=>{h(null),m(null),g(null),w(!1)},ge=async()=>{if(!d||f===null)return;const Pe=d.packageName?.trim()??"",We=d.packageProduct?.trim()??"",je=d.sanPham?.trim()??"";if(!je){g("Vui lng nhp m sn phm hp l");return}const $e=Mi(d.pctCtv),Ae=Mi(d.pctKhach),xt=Mi(d.pctPromo);if(!$e||$e<=0){g("T gi CTV phi ln hn 0");return}if(!Ae||Ae<=0){g("T gi Khch phi ln hn 0");return}if(xt!==null){if(xt<U1){g("T l khuyn mi khng c m.");return}const he=Math.max(0,Ae-1);if(he===0&&xt>0){g("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(xt>he){g(`T l khuyn mi khng c vt ${he.toFixed(2)}`);return}}w(!0),g(null);try{const he=await fetch(`${e}${Nt.PRODUCT_PRICE_DETAIL(f)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:Pe,packageProduct:We,sanPham:je,pctCtv:$e,pctKhach:Ae,pctPromo:xt}),credentials:"include"}),De=await he.text();let et=null;if(De)try{et=JSON.parse(De)}catch{et=null}if(!he.ok){const Ve=et?.error||De?.trim()||"Khng th cp nht gi sn phm";throw new Error(Ve)}const Qe=w3(et,f);r(Ve=>Ve.map(Ke=>Ke.id===f?Qe:Ke)),Qe?.id!==void 0&&l(Ve=>({...Ve,[Qe.id]:Qe.lastUpdated||new Date().toISOString()})),await n(),h(null),m(null)}catch(he){console.error("Li khi cp nht gi sn phm:",he),g(he instanceof Error?he.message:"Khng th cp nht gi sn phm")}finally{w(!1)}},Oe=v.useCallback((Pe,We)=>{Pe.stopPropagation(),Z({product:We,loading:!1,error:null})},[]),fe=v.useCallback(()=>{Z({product:null,loading:!1,error:null})},[]),O=v.useCallback(async()=>{const Pe=re.product;if(Pe){Z(We=>({...We,loading:!0,error:null}));try{const We=await aQ(Pe.id);if(!We.success)throw new Error(We.message||"Khng th xa sn phm.");r(je=>je.filter($e=>$e.id!==Pe.id)),a(je=>{const $e={...je};return delete $e[Pe.id],$e}),l(je=>{const $e={...je};return delete $e[Pe.id],$e}),fe()}catch(We){console.error("Failed to delete product price:",We),Z(je=>({...je,loading:!1,error:We instanceof Error?We.message:"Khng th xa sn phm. Vui lng th li."}))}}},[fe,re.product,r,a,l]),D=()=>{E({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),k([sv()]),P(null),L(!1)},z=()=>{D(),S(!0),V.length===0&&!le&&se(),B.length===0&&!U&&G()},H=()=>{S(!1),D()};return{editingProductId:f,productEditForm:d,productEditError:x,isSavingProductEdit:_,isCreateModalOpen:b,createForm:T,createSuppliers:A,createError:j,isSubmittingCreate:M,supplierOptions:B,isLoadingSuppliers:U,bankOptions:V,isLoadingBanks:le,deleteProductState:re,handleStartProductEdit:ne,handleProductEditChange:ie,handleCancelProductEdit:de,handleSubmitProductEdit:ge,handleRequestDeleteProduct:Oe,confirmDeleteProduct:O,closeDeleteProductModal:fe,handleOpenCreateModal:z,handleCloseCreateModal:H,handleCreateFormChange:(Pe,We)=>{E(je=>({...je,[Pe]:We}))},handleSupplierChange:(Pe,We,je)=>{k($e=>$e.map(Ae=>Ae.id===Pe?{...Ae,[We]:We==="sourceId"?je&&Number(je)||null:We==="useCustomName"?je==="true":je}:Ae))},handleSupplierSelectChange:(Pe,We)=>{const je=B.find($e=>$e.id!==null&&We===String($e.id)||$e.id===null&&We===$e.name)||null;k($e=>$e.map(Ae=>Ae.id===Pe?{...Ae,sourceId:je?.id??null,sourceName:je?.name??"",numberBank:je?.numberBank??"",bankBin:je?.binBank??"",useCustomName:!1}:Ae))},handleSupplierPriceInput:(Pe,We)=>{const je=z1(We);k($e=>$e.map(Ae=>Ae.id===Pe?{...Ae,price:je}:Ae))},handleEnableCustomSupplier:Pe=>{k(We=>We.map(je=>je.id===Pe?{...je,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:je))},handleAddSupplierRow:()=>{k(Pe=>[...Pe,sv()])},handleRemoveSupplierRow:Pe=>{k(We=>We.length===1?We:We.filter(je=>je.id!==Pe))},handleSubmitCreateProduct:async()=>{const Pe=T.packageName.trim(),We=T.packageProduct.trim(),je=T.sanPham.trim(),$e=Mi(T.pctCtv),Ae=Mi(T.pctKhach),xt=Mi(T.pctPromo);if(!je){P("Vui lng nhp m sn phm");return}if($e!==null&&$e<=0){P("T gi CTV phi ln hn 0.");return}if(Ae!==null&&Ae<=0){P("T gi khch phi ln hn 0.");return}if(xt!==null){if(xt<U1){P("T l khuyn mi khng c m.");return}if(Ae!==null&&Ae>0){const De=Math.max(0,Ae-1);if(De===0&&xt>0){P("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(xt>De){P(`T l khuyn mi khng c vt ${De.toFixed(2)}`);return}}}const he=A.map(De=>{const et=De.sourceName.trim(),Qe=Number((De.price||"").replace(/\D+/g,"")),Ve=Number.isFinite(Qe)&&Qe>0?Qe:null;return!et&&Ve===null?null:{sourceId:De.sourceId!==null&&Number.isFinite(De.sourceId)?De.sourceId:void 0,sourceName:et||void 0,price:Ve,numberBank:De.numberBank.trim()||void 0,binBank:De.bankBin.trim()||void 0}}).filter(De=>!!(De&&(De.sourceId!==void 0||De.sourceName)));L(!0),P(null);try{const De=await fetch(`${e}${Nt.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:Pe,packageProduct:We,sanPham:je,pctCtv:$e,pctKhach:Ae,pctPromo:xt,suppliers:he}),credentials:"include"}),et=await De.text();let Qe=null;if(et)try{Qe=JSON.parse(et)}catch{Qe=null}if(!De.ok){const Ve=Qe?.error||et?.trim()||"Khng th to sn phm";throw new Error(Ve)}await n(),H()}catch(De){console.error("Li khi to sn phm:",De),P(De instanceof Error?De.message:"Khng th to sn phm")}finally{L(!1)}},handleToggleStatus:async Pe=>{const je=!(i[Pe.id]??Pe.isActive??!1),$e=i[Pe.id],Ae=s[Pe.id],xt=new Date().toISOString();a(he=>({...he,[Pe.id]:je})),r(he=>he.map(De=>De.id===Pe.id?{...De,isActive:je}:De)),l(he=>({...he,[Pe.id]:xt}));try{const he=await fetch(`${e}${Nt.PRODUCT_PRICES}/${Pe.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:je}),credentials:"include"});if(!he.ok)throw new Error("Li khi cp nht trng thi");const De=await he.json(),et=De?.is_active??je,Qe=typeof De?.update=="string"?De.update:xt;a(Ve=>({...Ve,[Pe.id]:et})),r(Ve=>Ve.map(Ke=>Ke.id===Pe.id?{...Ke,isActive:et,lastUpdated:Qe}:Ke)),l(Ve=>({...Ve,[Pe.id]:Qe}))}catch(he){console.error("Failed to toggle product status:",he),a(De=>{const et={...De};return $e===void 0?delete et[Pe.id]:et[Pe.id]=$e,et}),r(De=>De.map(et=>et.id===Pe.id?{...et,isActive:$e??Pe.isActive??!1}:et)),l(De=>{const et={...De};return Ae?et[Pe.id]=Ae:delete et[Pe.id],et}),alert("Cp nht tht bi. Vui lng th li")}}}},lQ=({apiBase:e,setProductPrices:t,fetchProductPrices:r})=>{const[n,i]=v.useState({}),[a,s]=v.useState({}),[l,f]=v.useState({}),[h,d]=v.useState({}),[m,x]=v.useState({}),[g,_]=v.useState({}),w=v.useCallback(async B=>{const R=Ou(B);if(R){i(U=>({...U,[R]:{items:U[R]?.items??[],loading:!0,error:null,productName:U[R]?.productName??B}}));try{const U=await fetch(`${e}${Nt.SUPPLY_PRICES_BY_PRODUCT_NAME(B)}`,{credentials:"include"});if(!U.ok)throw new Error("KhA'ng th ti giA nh-p");const oe=await U.json(),V=Array.isArray(oe)?oe.map((J,re)=>({sourceId:Number.isFinite(Number(J?.sourceId??J?.source_id))?Number(J?.sourceId??J?.source_id):re,sourceName:J?.sourceName?.toString().trim()||J?.source_name?.toString().trim()||`NhA Cung Cp #${Number(J?.sourceId)||re+1}`,price:typeof J?.price=="number"&&Number.isFinite(J.price)?J.price:null,lastOrderDate:typeof J?.last_order_date=="string"?J.last_order_date:null})):[],ae=i0(qZ(V)),le=Ds(ae,null);typeof le=="number"&&Number.isFinite(le)&&le>0&&t(J=>{let re=!1;const Z=J.map(se=>{if(Ou(se.sanPhamRaw)!==R)return se;const G=typeof se.baseSupplyPrice=="number"&&Number.isFinite(se.baseSupplyPrice)&&Math.abs(se.baseSupplyPrice-le)<1e-5,ne=typeof se.wholesalePrice=="number"&&Number.isFinite(se.wholesalePrice)&&se.wholesalePrice>0,ie=typeof se.retailPrice=="number"&&Number.isFinite(se.retailPrice)&&se.retailPrice>0,de=ph(se.pctPromo,se.pctKhach,se.pctCtv),ge=typeof se.promoPrice=="number"&&Number.isFinite(se.promoPrice)&&se.promoPrice>0;return G&&ne&&ie&&(!de||ge)?se:(re=!0,Au({...se,baseSupplyPrice:le},le))});return re?Z:J}),i(J=>({...J,[R]:{loading:!1,error:null,items:ae,productName:B}}))}catch(U){i(oe=>({...oe,[R]:{loading:!1,items:oe[R]?.items??[],error:U instanceof Error?U.message:"KhA'ng th ti giA nh-p ca NCC",productName:oe[R]?.productName??B}}))}}},[e,t]),b=B=>{s(R=>{const U={...R};return delete U[B],U}),f(R=>{const U={...R};return delete U[B],U}),x(R=>{const U={...R};return delete U[B],U})},S=(B,R,U)=>{const oe=$l(B,R);s(V=>({...V,[oe]:!0})),f(V=>({...V,[oe]:U==null?"":y3(U)})),x(V=>({...V,[oe]:null}))},T=(B,R,U)=>{const oe=$l(B,R),V=z1(U);f(ae=>({...ae,[oe]:V})),x(ae=>({...ae,[oe]:null}))},E=(B,R)=>{const U=$l(B,R);b(U),d(oe=>{const V={...oe};return delete V[U],V})},A=async(B,R,U,oe)=>{const V=$l(B,R),le=l[V]?.toString().trim()??"";if(!le){x(re=>({...re,[V]:"Vui lAng nh-p giA hp l"}));return}const J=Number(le.replace(/\D+/g,""));if(!Number.isFinite(J)||J<0){x(re=>({...re,[V]:"GiA nh-p khA'ng `c thp hn 0."}));return}d(re=>({...re,[V]:!0}));try{const re=await fetch(`${e}${Nt.UPDATE_SUPPLY_PRICE(B,R)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:J}),credentials:"include"}),Z=await re.json().catch(()=>null);if(!re.ok)throw new Error(Z?.error||"KhA'ng th c-p nh-t giA nh-p");const se=Number.isFinite(Number(Z?.price))?Number(Z?.price):J;let G=null,ne=!1;if(i(ie=>{const de=ie[U];if(!de)return ie;const ge=Ds(de.items,null),Oe=de.items.find(Re=>Re.sourceId===R),fe=typeof Oe?.price=="number"?Oe.price:null,O=typeof fe=="number"&&typeof ge=="number"&&Math.abs(fe-ge)<1e-5,D=i0(de.items.map(Re=>Re.sourceId===R?{...Re,price:se}:Re)),z=Ds(D,null),H=fe===null||fe!==se;return typeof z=="number"&&Number.isFinite(z)&&z>0?(G=z,(z!==ge||O&&H)&&(ne=!0)):O&&H&&(G=z??null,ne=!0),{...ie,[U]:{...de,items:D}}}),ne&&t(ie=>ie.map(de=>de.id===B?Au(de,G):de)),b(V),await w(oe),ne)try{await r()}catch(ie){console.error("Failed to refresh product pricing:",ie)}}catch(re){x(Z=>({...Z,[V]:re instanceof Error?re.message:"KhA'ng th c-p nh-t giA nh-p."}))}finally{d(re=>{const Z={...re};return delete Z[V],Z})}},k=B=>{_(R=>R[B]?R:{...R,[B]:{sourceName:"",price:"",error:null,isSaving:!1}})},j=(B,R,U)=>{const oe=R==="price"?z1(U):U;_(V=>{const ae=V[B];return ae?{...V,[B]:{...ae,[R]:oe,error:null}}:V})},P=B=>{_(R=>{const U={...R};return delete U[B],U})};return{supplyPriceMap:n,editingSupplyRows:a,supplyPriceDrafts:l,savingSupplyRows:h,supplyRowErrors:m,newSupplyRows:g,fetchSupplyPricesForProduct:w,handleStartEditingSupply:S,handleSupplyInputChange:T,handleCancelSupplyEditing:E,handleConfirmSupplyEditing:A,handleStartAddSupplierRow:k,handleNewSupplierInputChange:j,handleCancelAddSupplierRow:P,handleConfirmAddSupplierRow:async B=>{const R=g[B.id];if(!R)return;const U=R.sourceName.trim(),oe=Number((R.price||"").replace(/\D+/g,""));if(!U){_(V=>({...V,[B.id]:{...R,error:"Vui long nhap ten nguon hop le."}}));return}if(!Number.isFinite(oe)||oe<=0){_(V=>({...V,[B.id]:{...R,error:"Gia nhap phai lon hon 0."}}));return}_(V=>({...V,[B.id]:{...R,isSaving:!0,error:null}}));try{const V=await fetch(`${e}${Nt.CREATE_SUPPLY_PRICE(B.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:U,price:oe}),credentials:"include"}),ae=await V.json().catch(()=>null);if(!V.ok)throw new Error(ae?.error||"Khong the them nguon moi.");const le=Ou(B.sanPhamRaw),J=Number(ae?.sourceId),re=Number.isFinite(Number(ae?.price))?Number(ae?.price):oe;let Z=null,se=!1;if(i(G=>{const ne=G[le],ie=ne?.items??[],de=ie.some(D=>typeof D.sourceId=="number"&&D.sourceId===J),ge=i0(de?ie.map(D=>D.sourceId===J?{...D,price:re}:D):[...ie,{sourceId:Number.isFinite(J)&&J>0?J:Date.now(),sourceName:U,price:re,lastOrderDate:null}]),Oe=Ds(ie,null),fe=Ds(ge,null);return(typeof Oe=="number"&&typeof fe=="number"?Math.abs(fe-Oe)>1e-5:Oe!==fe)&&(se=!0),Z=fe,{...G,[le]:{loading:ne?.loading??!1,error:null,items:ge}}}),se&&t(G=>G.map(ne=>ne.id===B.id?Au(ne,Z):ne)),await w(B.sanPhamRaw),P(B.id),se)try{await r()}catch(G){console.error("Failed to refresh product pricing:",G)}}catch(V){_(ae=>({...ae,[B.id]:{...R,isSaving:!1,error:V instanceof Error?V.message:"Khong the them nguon moi."}}))}},handleDeleteSupplyRow:async(B,R,U,oe)=>{const V=$l(B,R);x(J=>({...J,[V]:null})),d(J=>({...J,[V]:!0}));let ae=null,le=!1;try{const J=await fetch(`${e}${Nt.DELETE_SUPPLY_PRICE(B,R)}`,{method:"DELETE",credentials:"include"}),re=await J.json().catch(()=>null);if(!J.ok)throw new Error(re?.error||"Khong the xoa nguon nay.");if(i(Z=>{const se=Z[U];if(!se)return Z;const G=i0(se.items.filter(ge=>ge.sourceId!==R)),ne=Ds(se.items,null),ie=Ds(G,null);return(typeof ne=="number"&&typeof ie=="number"?Math.abs(ie-ne)>1e-5:ne!==ie)&&(le=!0),ae=ie,{...Z,[U]:{...se,items:G}}}),b(V),le&&t(Z=>Z.map(se=>se.id===B?Au(se,ae):se)),await w(oe),le)try{await r()}catch(Z){console.error("Failed to refresh product pricing:",Z)}}catch(J){x(re=>({...re,[V]:J instanceof Error?J.message:"Khong the xoa nguon nay."}))}finally{d(J=>{const re={...J};return delete re[V],re})}}}},cQ={};var uQ={};const lv=typeof import.meta<"u"&&cQ?.VITE_API_BASE_URL||uQ.VITE_API_BASE_URL||"http://localhost:3001",fQ=()=>{const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,productPrices:i,setProductPrices:a,isLoading:s,error:l,statusOverrides:f,setStatusOverrides:h,updatedTimestampMap:d,setUpdatedTimestampMap:m,expandedProductId:x,setExpandedProductId:g,isRefreshing:_,setIsRefreshing:w,fetchProductPrices:b,filteredPricing:S}=iQ(lv),T=lQ({apiBase:lv,setProductPrices:a,fetchProductPrices:b}),{supplyPriceMap:E,fetchSupplyPricesForProduct:A}=T,k=oQ({apiBase:lv,productPrices:i,setProductPrices:a,fetchProductPrices:b,statusOverrides:f,setStatusOverrides:h,updatedTimestampMap:d,setUpdatedTimestampMap:m});v.useEffect(()=>{b()},[b]);const j=v.useCallback(async()=>{if(!_){w(!0);try{await b();const L=new Set;Object.values(E).forEach(B=>{B?.productName&&L.add(B.productName)}),await Promise.all(Array.from(L).map(B=>A(B)))}catch(L){console.error("Failed to refresh pricing data:",L)}finally{w(!1)}}},[_,b,w,E,A]),P=L=>{const B=x===L.id?null:L.id;if(g(B),B===L.id){const R=Ou(L.sanPhamRaw),U=T.supplyPriceMap[R];(!U||!U.loading&&U.items.length===0)&&T.fetchSupplyPricesForProduct(L.sanPhamRaw)}},M=v.useMemo(()=>{const L=i.length,B=i.filter(U=>U.isActive).length,R=L-B;return[{name:"Tng Sn Phm",value:L.toString(),icon:ny,accent:"emerald",subtitle:"Tt c sn phm"},{name:"ang Hot ng",value:B.toString(),icon:T0,accent:"sky",subtitle:"Sn sng bn"},{name:"Tm Dng",value:R.toString(),icon:ec,accent:"violet",subtitle:"ang n trn bng gi"}]},[i]);return{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,filteredPricing:S,pricingStats:M,isLoading:s,error:l,isRefreshing:_,expandedProductId:x,supplyPriceMap:E,editingSupplyRows:T.editingSupplyRows,supplyPriceDrafts:T.supplyPriceDrafts,savingSupplyRows:T.savingSupplyRows,supplyRowErrors:T.supplyRowErrors,newSupplyRows:T.newSupplyRows,editingProductId:k.editingProductId,productEditForm:k.productEditForm,productEditError:k.productEditError,isSavingProductEdit:k.isSavingProductEdit,isCreateModalOpen:k.isCreateModalOpen,createForm:k.createForm,createSuppliers:k.createSuppliers,createError:k.createError,isSubmittingCreate:k.isSubmittingCreate,supplierOptions:k.supplierOptions,isLoadingSuppliers:k.isLoadingSuppliers,bankOptions:k.bankOptions,isLoadingBanks:k.isLoadingBanks,statusOverrides:f,updatedTimestampMap:d,deleteProductState:k.deleteProductState,handleRefreshAll:j,handleToggleProductDetails:P,handleStartEditingSupply:T.handleStartEditingSupply,handleSupplyInputChange:T.handleSupplyInputChange,handleCancelSupplyEditing:T.handleCancelSupplyEditing,handleConfirmSupplyEditing:T.handleConfirmSupplyEditing,handleStartAddSupplierRow:T.handleStartAddSupplierRow,handleNewSupplierInputChange:T.handleNewSupplierInputChange,handleCancelAddSupplierRow:T.handleCancelAddSupplierRow,handleConfirmAddSupplierRow:T.handleConfirmAddSupplierRow,handleDeleteSupplyRow:T.handleDeleteSupplyRow,handleStartProductEdit:k.handleStartProductEdit,handleProductEditChange:k.handleProductEditChange,handleCancelProductEdit:k.handleCancelProductEdit,handleSubmitProductEdit:k.handleSubmitProductEdit,handleRequestDeleteProduct:k.handleRequestDeleteProduct,confirmDeleteProduct:k.confirmDeleteProduct,closeDeleteProductModal:k.closeDeleteProductModal,handleOpenCreateModal:k.handleOpenCreateModal,handleCloseCreateModal:k.handleCloseCreateModal,handleCreateFormChange:k.handleCreateFormChange,handleSupplierChange:k.handleSupplierChange,handleSupplierSelectChange:k.handleSupplierSelectChange,handleSupplierPriceInput:k.handleSupplierPriceInput,handleEnableCustomSupplier:k.handleEnableCustomSupplier,handleAddSupplierRow:k.handleAddSupplierRow,handleRemoveSupplierRow:k.handleRemoveSupplierRow,handleSubmitCreateProduct:k.handleSubmitCreateProduct,handleToggleStatus:k.handleToggleStatus,fetchSupplyPricesForProduct:T.fetchSupplyPricesForProduct}};function dQ(){const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,pricingStats:i,filteredPricing:a,isLoading:s,error:l,isRefreshing:f,expandedProductId:h,supplyPriceMap:d,statusOverrides:m,updatedTimestampMap:x,editingSupplyRows:g,supplyPriceDrafts:_,savingSupplyRows:w,supplyRowErrors:b,newSupplyRows:S,editingProductId:T,productEditForm:E,productEditError:A,isSavingProductEdit:k,deleteProductState:j,isCreateModalOpen:P,createForm:M,createSuppliers:L,createError:B,isSubmittingCreate:R,supplierOptions:U,isLoadingSuppliers:oe,bankOptions:V,isLoadingBanks:ae,handleRefreshAll:le,handleToggleProductDetails:J,handleStartProductEdit:re,handleProductEditChange:Z,handleCancelProductEdit:se,handleSubmitProductEdit:G,handleRequestDeleteProduct:ne,confirmDeleteProduct:ie,closeDeleteProductModal:de,handleStartEditingSupply:ge,handleSupplyInputChange:Oe,handleCancelSupplyEditing:fe,handleConfirmSupplyEditing:O,handleStartAddSupplierRow:D,handleNewSupplierInputChange:z,handleCancelAddSupplierRow:H,handleConfirmAddSupplierRow:te,handleDeleteSupplyRow:Re,handleToggleStatus:Ee,handleOpenCreateModal:me,handleCloseCreateModal:xe,handleCreateFormChange:Ce,handleSupplierChange:Le,handleSupplierSelectChange:pe,handleSupplierPriceInput:Fe,handleEnableCustomSupplier:Pe,handleAddSupplierRow:We,handleRemoveSupplierRow:je,handleSubmitCreateProduct:$e,fetchSupplyPricesForProduct:Ae}=fQ();return u.jsxs(u.Fragment,{children:[u.jsx(nQ,{product:j.product,loading:j.loading,error:j.error,onClose:de,onConfirm:ie}),u.jsx(rQ,{isOpen:P,createForm:M,createSuppliers:L,supplierOptions:U,bankOptions:V,isLoadingSuppliers:oe,isLoadingBanks:ae,createError:B,isSubmitting:R,onClose:xe,onFormChange:Ce,onSupplierChange:Le,onSupplierSelectChange:pe,onSupplierPriceInput:Fe,onEnableCustomSupplier:Pe,onAddSupplier:We,onRemoveSupplier:je,onSubmit:$e,parseRatioInput:Mi}),u.jsxs("div",{className:"space-y-6",children:[u.jsx(WZ,{stats:i,onAddProduct:me}),u.jsx(zZ,{searchTerm:e,statusFilter:r,isLoading:s,isRefreshing:f,error:l,onSearchChange:t,onStatusChange:n,onRefresh:le}),u.jsx(tQ,{items:a,isLoading:s,error:l,expandedProductId:h,supplyPriceMap:d,statusOverrides:m,updatedTimestampMap:x,editingSupplyRows:g,supplyPriceDrafts:_,savingSupplyRows:w,supplyRowErrors:b,newSupplyRows:S,editingProductId:T,productEditForm:E,productEditError:A,isSavingProductEdit:k,deleteProductState:j,onToggleProductDetails:J,onStartProductEdit:re,onProductEditChange:Z,onCancelProductEdit:se,onSubmitProductEdit:G,onRequestDeleteProduct:ne,onStartEditingSupply:ge,onSupplyInputChange:Oe,onCancelSupplyEditing:fe,onConfirmSupplyEditing:O,onStartAddSupplierRow:D,onNewSupplierInputChange:z,onCancelAddSupplierRow:H,onConfirmAddSupplierRow:te,onDeleteSupplyRow:Re,onToggleStatus:Ee,fetchSupplyPricesForProduct:Ae})]})]})}function hQ(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[i,a]=v.useState(null),[s,l]=v.useState(!1),f=v.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]),{setUser:h}=oy(),d=Fh();return u.jsxs("div",{className:"retro-login",children:[u.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:u.jsxs("linearGradient",{id:f,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[u.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),u.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),u.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),u.jsxs("div",{className:"retro-shell",children:[u.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[u.jsx("div",{className:"retro-grid"}),u.jsx("div",{className:"retro-sun"}),u.jsx("div",{className:"retro-planet"}),u.jsx("div",{className:"retro-glow"})]}),u.jsxs("div",{className:"retro-card",children:[u.jsx("div",{className:"card-top",children:u.jsxs("div",{className:"title",children:[u.jsx("p",{className:"eyebrow",children:"Cho mng tr li"}),u.jsx("h1",{className:"gradient-title",children:"Mavryk Premium"}),u.jsx("p",{className:"subtitle",children:"Nhp thng tin ca bn  vo trang qun tr."})]})}),u.jsxs("form",{className:"form",onSubmit:m=>{m.preventDefault(),a(null),l(!0),Tt("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async x=>{if(!x.ok){const _=await x.json().catch(()=>({}));throw new Error(_.error||"Login failed")}const g=await x.json();h(g.user||null),d("/dashboard",{replace:!0})}).catch(x=>{a(x instanceof Error?x.message:"Login failed")}).finally(()=>l(!1))},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{children:"Ti khon"}),u.jsx("input",{type:"text",required:!0,value:e,onChange:m=>t(m.target.value),placeholder:"Nhp tn ng nhp"})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{children:"Mt khu"}),u.jsx("input",{type:"password",required:!0,value:r,onChange:m=>n(m.target.value),placeholder:"Nhp mt khu"})]}),u.jsxs("div",{className:"controls",children:[u.jsxs("label",{className:"remember",children:[u.jsx("input",{type:"checkbox",defaultChecked:!0}),u.jsx("span",{children:"Ghi nh ng nhp"})]}),u.jsx("button",{type:"button",className:"ghost",children:"Qun mt khu?"})]}),u.jsx("button",{type:"submit",className:"cta",disabled:s,children:s?"ang ng nhp...":"ng nhp"}),i&&u.jsx("p",{className:"error-msg",children:i})]})]})]}),u.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Vast+Shadow&display=swap');

        :root {
          --retro-bg: #0b0b14;
          --retro-card: rgba(13, 14, 26, 0.8);
          --retro-border: rgba(255, 255, 255, 0.08);
          --retro-text: #e5e7ff;
          --retro-muted: #9aa4c2;
          --retro-accent: #ff6ec7;
          --retro-accent-2: #7c5cff;
          --retro-glow: 0 10px 50px rgba(124, 92, 255, 0.5);
          --glass: rgba(255, 255, 255, 0.04);
          color-scheme: dark;
        }

        .retro-login {
          min-height: 100vh;
          background: radial-gradient(circle at 20% 20%, rgba(255, 110, 199, 0.12), transparent 30%),
                      radial-gradient(circle at 80% 0%, rgba(77, 225, 236, 0.12), transparent 32%),
                      var(--retro-bg);
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 32px;
          position: relative;
          overflow: hidden;
          font-family: "Inter", "Space Grotesk", system-ui, -apple-system, sans-serif;
        }

        .retro-shell {
          position: relative;
          width: min(1100px, 100%);
          min-height: 620px;
          border: 1px solid var(--retro-border);
          border-radius: 24px;
          overflow: hidden;
          background: linear-gradient(135deg, rgba(255, 110, 199, 0.06), rgba(77, 225, 236, 0.05));
          box-shadow: 0 30px 120px rgba(0, 0, 0, 0.45);
        }

        .retro-bg {
          position: absolute;
          inset: 0;
          overflow: hidden;
          pointer-events: none;
        }

        .retro-grid {
          position: absolute;
          inset: 0;
          background-image: linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
          background-size: 80px 80px;
          transform: perspective(600px) rotateX(70deg) translateY(-20%);
          transform-origin: center;
          filter: blur(0.3px);
        }

        .retro-sun {
          position: absolute;
          width: 340px;
          height: 340px;
          border-radius: 50%;
          background: conic-gradient(from 120deg, rgba(255, 110, 199, 0.3), rgba(124, 92, 255, 0.35), rgba(77, 225, 236, 0.3));
          top: -80px;
          left: 50%;
          transform: translateX(-50%);
          filter: blur(10px);
          opacity: 0.9;
        }

        .retro-planet {
          position: absolute;
          width: 120px;
          height: 120px;
          border-radius: 50%;
          background: radial-gradient(circle at 30% 30%, #fff, #7c5cff 45%, #0b0b14 75%);
          top: 60px;
          right: 140px;
          box-shadow: 0 0 40px rgba(124, 92, 255, 0.7);
          opacity: 0.7;
        }

        .retro-glow {
          position: absolute;
          inset: 0;
          background: radial-gradient(circle at 50% 70%, rgba(255, 110, 199, 0.1), transparent 45%);
          mix-blend-mode: screen;
        }

        .retro-card {
          position: relative;
          z-index: 1;
          margin: 48px;
          padding: 36px;
          border-radius: 18px;
          background: var(--retro-card);
          border: 1px solid var(--retro-border);
          backdrop-filter: blur(16px);
          box-shadow: var(--retro-glow);
          color: var(--retro-text);
          display: grid;
          gap: 24px;
          max-width: 640px;
          overflow: hidden;
        }
        .retro-card::before {
          content: "";
          position: absolute;
          inset: -60px;
          background: conic-gradient(#ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          filter: blur(40px);
          opacity: 0.45;
          animation: spinGlow 12s linear infinite;
          z-index: 0;
          pointer-events: none;
        }
        .retro-card > * { position: relative; z-index: 1; }

        .card-top {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }

        .badge {
          align-self: flex-start;
          padding: 6px 12px;
          border-radius: 999px;
          background: linear-gradient(90deg, rgba(255, 110, 199, 0.2), rgba(77, 225, 236, 0.2));
          border: 1px solid rgba(255, 255, 255, 0.12);
          text-transform: uppercase;
          letter-spacing: 0.08em;
          font-size: 11px;
          color: var(--retro-text);
        }

        .title h1 {
          font-size: 36px;
          line-height: 1.2;
          margin: 6px 0 6px;
          letter-spacing: -0.01em;
        }
        .gradient-title {
          background: linear-gradient(120deg, #ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          animation: gradientShift 4s ease-in-out infinite;
          font-family: "Vast Shadow", "Cinzel Decorative", "Inter", system-ui, -apple-system, sans-serif;
          letter-spacing: 0.5px;
        }
        .title .eyebrow {
          text-transform: uppercase;
          letter-spacing: 0.12em;
          font-size: 12px;
          color: var(--retro-muted);
          margin: 0;
        }
        .title .subtitle {
          margin: 0;
          color: var(--retro-muted);
          font-size: 14px;
        }

        .form {
          display: grid;
          gap: 16px;
        }
        .field {
          display: grid;
          gap: 6px;
          font-size: 14px;
          color: var(--retro-text);
        }
        .field input {
          width: 100%;
          border-radius: 12px;
          border: 1px solid var(--retro-border);
          background: var(--glass);
          padding: 12px 14px;
          color: var(--retro-text);
          transition: border-color 0.2s, box-shadow 0.2s;
        }
        .field input:focus {
          outline: none;
          border-color: rgba(255, 110, 199, 0.6);
          box-shadow: 0 0 0 3px rgba(124, 92, 255, 0.25);
        }

        .controls {
          display: flex;
          align-items: center;
          justify-content: space-between;
          font-size: 13px;
          color: var(--retro-muted);
        }
        .remember {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          cursor: pointer;
        }
        .remember input { accent-color: #7c5cff; }
        .ghost {
          background: transparent;
          border: none;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          padding: 4px 8px;
        }

        .cta {
          width: 100%;
          border: none;
          border-radius: 14px;
          padding: 14px;
          font-weight: 700;
          letter-spacing: 0.01em;
          color: #0b0b14;
          background: linear-gradient(90deg, #ff6ec7, #7c5cff, #4de1ec);
          box-shadow: 0 15px 40px rgba(124, 92, 255, 0.45);
          cursor: pointer;
          transition: transform 0.15s ease, box-shadow 0.15s ease;
        }
        .cta:hover {
          transform: translateY(-1px);
          box-shadow: 0 18px 50px rgba(124, 92, 255, 0.55);
        }
        .cta:active { transform: translateY(0); }

        .divider {
          display: grid;
          grid-template-columns: 1fr auto 1fr;
          align-items: center;
          gap: 10px;
          color: var(--retro-muted);
          font-size: 12px;
        }
        .divider span {
          height: 1px;
          background: linear-gradient(90deg, rgba(255, 255, 255, 0), rgba(255,255,255,0.25), rgba(255,255,255,0));
        }

        .social {
          display: grid;
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 10px;
        }
        .social button {
          border: 1px solid var(--retro-border);
          background: var(--glass);
          border-radius: 12px;
          padding: 10px 12px;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          transition: border-color 0.2s, transform 0.2s;
        }
        .social button:hover {
          border-color: rgba(255, 110, 199, 0.5);
          transform: translateY(-1px);
        }
        .cta:disabled { opacity: 0.6; cursor: not-allowed; }
        .error-msg { margin-top: 8px; color: #ff9b9b; font-size: 13px; }
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        @keyframes spinBorder {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes spinGlow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .retro-shell { margin: 16px; }
          .retro-card { margin: 32px 20px; padding: 28px; }
        }
      `})]})}const pQ=[{title:"Tng chi tiu",value:"89,935",delta:"+1.01% thng ny",trend:"up",accent:"amber",icon:T0},{title:"Tng thu nhp",value:"23,283.5",delta:"+0.49% thng ny",trend:"up",accent:"emerald",icon:T0}],a0=[{name:"Nh ca & Tin ch",value:8e6,color:"#F8C573"},{name:"Thc phm",value:512e4,color:"#9BE7C4"},{name:"Chm sc c nhn",value:538e4,color:"#7CB3FF"},{name:"Ph kin",value:412e4,color:"#F48FB1"},{name:"Dch v khc",value:303e4,color:"#C7D2FE"}],mQ=[{name:"Nh ca & Tin ch",used:315e4,total:45e5},{name:"Thc phm & Thit yu",used:226e4,total:45e5},{name:"Chm sc c nhn",used:189e4,total:45e5},{name:"Ph kin",used:152e4,total:45e5}],xQ=[{name:"Laptop mi",progress:50,saved:3375e3,target:675e4,accent:"#f8c573"},{name:"Du lch",progress:70,saved:474e4,target:675e4,accent:"#9be7c4"}],gQ=[{time:"01/12/2025",momo:15e5,bank:325e4,supper:22e5,gold:18e5},{time:"05/12/2025",momo:9e5,bank:2e6,supper:16e5,gold:145e4},{time:"10/12/2025",momo:125e4,bank:28e5,supper:21e5,gold:17e5},{time:"14/12/2025",momo:11e5,bank:26e5,supper:185e4,gold:15e5}],Zi=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),vQ=new Intl.NumberFormat("vi-VN",{maximumFractionDigits:1}),yQ={amber:{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"},emerald:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"}},wQ=({title:e,value:t,delta:r,trend:n,accent:i,icon:a})=>{const s=yQ[i],l=n==="up"?T0:KI;return u.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.12em] text-slate-500",children:e}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t}),u.jsxs("div",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold ${s.chip}`,children:[u.jsx(l,{className:"h-4 w-4"}),u.jsx("span",{children:r})]})]}),u.jsx("div",{className:`h-12 w-12 rounded-2xl flex items-center justify-center ${s.iconBg}`,children:u.jsx(a,{className:"h-6 w-6"})})]})},bQ=({name:e,used:t,total:r})=>{const n=Math.min(100,Math.round(t/r*100)),i=r-t;return u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-slate-900",children:[u.jsx("span",{children:e}),u.jsxs("span",{children:[n,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-slate-200",children:u.jsx("div",{className:"h-full rounded-full bg-slate-900",style:{width:`${n}%`}})}),u.jsxs("p",{className:"text-xs text-slate-500",children:["Cn li ",Zi.format(i)," /"," ",Zi.format(r)]})]})},_Q=({progress:e,color:t})=>u.jsxs("div",{className:"relative h-14 w-14",children:[u.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`conic-gradient(${t} ${e}%, #e2e8f0 ${e}%)`}}),u.jsxs("div",{className:"absolute inset-[6px] rounded-full bg-slate-900 border border-white/10 flex items-center justify-center text-xs font-semibold text-white shadow-inner shadow-black/30",children:[Math.round(e),"%"]})]});function SQ(){const e=v.useMemo(()=>a0.reduce((t,r)=>t+r.value,0),[]);return u.jsx("div",{className:"stats-shell min-h-screen",children:u.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6 space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:pQ.map(t=>u.jsx(wQ,{...t},t.title))}),u.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[u.jsxs("div",{className:"stats-card p-6 space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Chi tiu hng thng"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Tng quan thng hin ti"})]})}),u.jsxs("div",{className:"grid items-center gap-6 lg:grid-cols-[1.1fr_1fr]",children:[u.jsxs("div",{className:"relative h-72 w-full",children:[u.jsx(Qv,{width:"100%",height:"100%",children:u.jsxs(Dq,{children:[u.jsx(yO,{data:a0,dataKey:"value",nameKey:"name",innerRadius:"60%",outerRadius:"85%",paddingAngle:4,cornerRadius:12,stroke:"none",children:a0.map(t=>u.jsx(Tf,{fill:t.color},t.name))}),u.jsx(w1,{formatter:t=>Zi.format(t),contentStyle:{background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:12,color:"#0f172a"}})]})}),u.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center text-center",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-slate-900",children:Zi.format(e)}),u.jsx("p",{className:"text-sm text-slate-500",children:"Tng"})]})})]}),u.jsxs("div",{className:"space-y-2 rounded-2xl border border-white/10 bg-white/5 p-3 shadow-[0_14px_40px_-28px_rgba(0,0,0,0.7)] backdrop-blur-sm",children:[u.jsxs("div",{className:"grid grid-cols-12 text-xs font-semibold text-white/70",children:[u.jsx("span",{className:"col-span-6",children:"Nhn"}),u.jsx("span",{className:"col-span-4 text-right",children:"Gi tr"}),u.jsx("span",{className:"col-span-2 text-right",children:"%"})]}),a0.map(t=>{const r=t.value/e*100;return u.jsxs("div",{className:"grid grid-cols-12 items-center rounded-xl px-3 py-2 transition-colors hover:bg-white/5",children:[u.jsxs("div",{className:"col-span-6 flex items-center gap-2 text-sm font-semibold text-white",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:t.color}}),t.name]}),u.jsx("div",{className:"col-span-4 text-right text-sm font-semibold text-white",children:Zi.format(t.value)}),u.jsxs("div",{className:"col-span-2 text-right text-xs text-white/70",children:[vQ.format(r),"%"]})]},t.name)})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 shadow-[0_16px_42px_-26px_rgba(0,0,0,0.75)] space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Dng tin"}),u.jsx("span",{className:"text-xs text-white/60",children:"Tng hp theo ngun"})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full text-sm",children:[u.jsx("thead",{className:"bg-white/5 text-white/70 text-xs uppercase tracking-[0.08em]",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Thi gian"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Momo"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Ngn Hng"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Supper Sinh Li"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Vng"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10 text-white",children:gQ.map((t,r)=>u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-3 py-2 font-semibold",children:t.time}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:Zi.format(t.momo)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:Zi.format(t.bank)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:Zi.format(t.supper)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:Zi.format(t.gold)})]},`${t.time}-${r}`))})]})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"stats-card stats-alert p-4 flex items-start gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-white flex items-center justify-center border border-amber-100",children:u.jsx(QI,{className:"h-5 w-5 text-amber-700"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold",children:"Chi tiu thc phm tng 20% trong thng ny"}),u.jsx("p",{className:"text-xs text-amber-700",children:"Xem li hn mc  trnh vt ngn sch."})]})]}),u.jsxs("div",{className:"stats-card p-5 space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Ngn sch"}),u.jsx(g6,{className:"h-5 w-5 text-slate-400"})]}),u.jsx("div",{className:"space-y-3",children:mQ.map(t=>u.jsx(bQ,{...t},t.name))}),u.jsx("button",{type:"button",className:"w-full rounded-xl bg-slate-900 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-18px_rgba(15,23,42,0.45)] hover:bg-slate-800 transition-colors",children:"To ngn sch"})]}),u.jsxs("div",{className:"stats-card p-5 space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Mc tiu tit kim"}),u.jsx(s6,{className:"h-5 w-5 text-emerald-500"})]}),u.jsx("div",{className:"space-y-3",children:xQ.map(t=>u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/10 bg-white/5 px-3 py-2 shadow-[0_12px_32px_-26px_rgba(0,0,0,0.65)] backdrop-blur-sm",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(_Q,{progress:t.progress,color:t.accent}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:t.name}),u.jsxs("p",{className:"text-xs text-white/70",children:[Zi.format(t.saved)," /"," ",Zi.format(t.target)]})]})]}),u.jsx(R6,{className:"h-5 w-5 text-white/60"})]},t.name))}),u.jsx("button",{type:"button",className:"w-full rounded-xl bg-white/10 py-3 text-sm font-semibold text-white border border-white/15 hover:bg-white/15 transition-colors shadow-[0_12px_30px_-24px_rgba(0,0,0,0.65)]",children:"t mc tiu mi"})]})]})]})]})})}const NQ=async e=>{const t=await Tt(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Ngun  c xa trc ."};if(!t.ok){const n=await t.text();throw new Error(n||"Khng th xa ngun.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},EQ=({stats:e})=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsx(Ua,{title:"Tng NCC",value:e.totalSuppliers,icon:L6,accent:Or.sky}),u.jsx(Ua,{title:"ang hot ng",value:e.activeSuppliers,icon:Jl,accent:Or.emerald}),u.jsx(Ua,{title:"Tng n",value:e.monthlyOrders,icon:sy,accent:Or.violet}),u.jsx(Ua,{title:"Tng nhp",value:Mq(e.totalImportValue),icon:ny,accent:Or.amber})]}),VC=e=>e.trim().toLowerCase(),cv=e=>Number(e.replace(/[^\d]/g,""))||0,TQ=ib,KC=ga,CQ=({supplyId:e})=>{const[t,r]=v.useState([]),[n,i]=v.useState(!1),[a,s]=v.useState({round:"",import:"",paid:"",isEditing:!1}),[l,f]=v.useState(null),[h,d]=v.useState(""),m=v.useCallback(async()=>{i(!0);try{const w=await Tt(`/api/supplies/${e}/payments?offset=0&limit=20`);if(w.ok){const b=await w.json();r(b.payments||[])}}finally{i(!1)}},[e]);v.useEffect(()=>{m()},[m]);const x=async()=>{if(a.round)try{const w={round:a.round,totalImport:cv(a.import),paid:cv(a.paid),status:"Chua Thanh Toan"};(await Tt(`/api/supplies/${e}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).ok&&(s({round:"",import:"",paid:"",isEditing:!1}),m())}catch(w){console.error(w)}},g=async w=>{try{await Tt(`/api/supplies/${e}/payments/${w}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:cv(h)})}),f(null),m()}catch(b){console.error(b)}},_=w=>(w||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();return u.jsxs("div",{className:"bg-slate-900/80 rounded-xl border border-white/10 overflow-hidden",children:[u.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center",children:[u.jsx("h4",{className:"text-sm font-semibold text-white",children:"Lch S Thanh Ton"}),u.jsxs("button",{onClick:()=>s({...a,isEditing:!0}),className:"text-xs flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-white transition",children:[u.jsx(qa,{className:"h-3 w-3"})," Thm Chu K"]})]}),u.jsxs("table",{className:"w-full text-sm text-left text-white/80",children:[u.jsx("thead",{className:"bg-white/5 text-xs uppercase text-white/60",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2",children:"Chu K"}),u.jsx("th",{className:"px-4 py-2",children:"Tng Nhp"}),u.jsx("th",{className:"px-4 py-2",children:" Thanh Ton"}),u.jsx("th",{className:"px-4 py-2",children:"Trng Thi"}),u.jsx("th",{className:"px-4 py-2 text-right",children:"Thao Tc"})]})}),u.jsxs("tbody",{className:"divide-y divide-white/5",children:[a.isEditing&&u.jsxs("tr",{className:"bg-indigo-500/10",children:[u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"Tn chu k...",value:a.round,onChange:w=>s({...a,round:w.target.value})})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:a.import,onChange:w=>s({...a,import:Number(w.target.value.replace(/\D/g,"")).toLocaleString("vi-VN")})})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:a.paid,onChange:w=>s({...a,paid:Number(w.target.value.replace(/\D/g,"")).toLocaleString("vi-VN")})})}),u.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"Mi"}),u.jsxs("td",{className:"px-4 py-2 text-right",children:[u.jsx("button",{onClick:x,className:"text-emerald-400 hover:text-emerald-300 mr-2",children:u.jsx(Mo,{className:"h-5 w-5 inline"})}),u.jsx("button",{onClick:()=>s({...a,isEditing:!1}),className:"text-rose-400 hover:text-rose-300",children:u.jsx(zr,{className:"h-5 w-5 inline"})})]})]}),n?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"text-center py-4",children:"ang ti..."})}):t.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"text-center py-4 opacity-50",children:"Cha c d liu thanh ton"})}):t.map(w=>{const b=_(w.status)==="chua thanh toan";return u.jsxs("tr",{className:"hover:bg-white/5",children:[u.jsx("td",{className:"px-4 py-2",children:w.round}),u.jsx("td",{className:"px-4 py-2",children:l===w.id?u.jsx("input",{className:"bg-black/20 border border-white/20 rounded px-1 w-24 text-right",value:h,onChange:S=>d(Number(S.target.value.replace(/\D/g,"")).toLocaleString("vi-VN"))}):KC(w.totalImport)}),u.jsx("td",{className:"px-4 py-2",children:KC(w.paid)}),u.jsx("td",{className:"px-4 py-2",children:w.status}),u.jsx("td",{className:"px-4 py-2 text-right",children:l===w.id?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>g(w.id),className:"text-emerald-400 mr-2",children:u.jsx(Mo,{className:"h-4 w-4 inline"})}),u.jsx("button",{onClick:()=>f(null),className:"text-rose-400",children:u.jsx(zr,{className:"h-4 w-4 inline"})})]}):b&&u.jsx("button",{onClick:()=>{f(w.id),d(w.totalImport.toLocaleString("vi-VN"))},className:"text-white/40 hover:text-blue-300",children:u.jsx(Mh,{className:"h-4 w-4 inline"})})})]},w.id)})]})]})]})},uv=ga,kQ=e=>e?Pr(e):"--",AQ=({supplies:e,loading:t,expandedId:r,onToggle:n,onEdit:i,onDelete:a,onView:s,onToggleStatus:l})=>u.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden shadow-2xl backdrop-blur-sm",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full text-left",children:[u.jsx("thead",{className:"bg-black/20 text-xs uppercase text-white/60 font-semibold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Nh cung cp"}),u.jsx("th",{className:"px-4 py-3",children:"Ti khon"}),u.jsx("th",{className:"px-4 py-3",children:"Thng ny"}),u.jsx("th",{className:"px-4 py-3",children:"Ln cui"}),u.jsx("th",{className:"px-4 py-3",children:" tr"}),u.jsx("th",{className:"px-4 py-3",children:"Cn n"}),u.jsx("th",{className:"px-4 py-3 text-center",children:"TT"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Thao tc"})]})}),u.jsx("tbody",{className:"divide-y divide-white/5",children:t?u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"text-center py-8 text-white/50",children:"ang ti..."})}):e.map(f=>u.jsx(PQ,{supply:f,isExpanded:r===f.id,onToggle:n,onEdit:i,onDelete:a,onView:s,onToggleStatus:l},f.id))})]})})}),PQ=({supply:e,isExpanded:t,onToggle:r,onEdit:n,onDelete:i,onView:a,onToggleStatus:s})=>u.jsxs(u.Fragment,{children:[u.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:bg-white/5 cursor-pointer transition border-b border-white/5",onClick:()=>r(e.id),children:[u.jsxs("td",{className:"px-4 py-4",children:[u.jsx("div",{className:"font-medium text-white",children:e.sourceName||"Khng Tn"}),u.jsxs("div",{className:"text-xs text-white/60",children:["Tng n: ",e.totalOrders]})]}),u.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[u.jsx("div",{children:e.numberBank||"--"}),u.jsx("div",{className:"text-xs text-white/50",children:e.bankName})]}),u.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[u.jsxs("div",{children:[e.monthlyOrders," n"]}),u.jsx("div",{className:"text-xs text-emerald-400",children:uv(e.monthlyImportValue)})]}),u.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:kQ(e.lastOrderDate)}),u.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:uv(e.totalPaidImport)}),u.jsx("td",{className:"px-4 py-4 font-bold text-orange-400 text-sm",children:uv(e.totalUnpaidImport)}),u.jsx("td",{className:"px-4 py-4 text-center",children:u.jsx("button",{onClick:l=>{l.stopPropagation(),s(e)},className:`w-8 h-8 rounded-full flex items-center justify-center transition ${e.isActive?"bg-emerald-500 text-white":"bg-gray-600 text-gray-300"}`,children:u.jsx(s4,{className:"h-4 w-4"})})}),u.jsx("td",{className:"px-4 py-4 text-right",children:u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:l=>{l.stopPropagation(),a(e)},className:"p-1 text-blue-400 hover:text-blue-300",children:u.jsx(lf,{className:"h-5 w-5"})}),u.jsx("button",{onClick:l=>{l.stopPropagation(),n(e)},className:"p-1 text-green-400 hover:text-green-300",children:u.jsx(Mh,{className:"h-5 w-5"})}),u.jsx("button",{onClick:l=>{l.stopPropagation(),i(e)},className:"p-1 text-rose-400 hover:text-rose-300",children:u.jsx(Lo,{className:"h-5 w-5"})})]})})]}),t&&u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"px-0 pb-4 pt-0 bg-indigo-950/30",children:u.jsx("div",{className:"p-4 border-b border-white/10 shadow-inner",children:u.jsx(CQ,{supplyId:e.id})})})})]}),jQ=(e,t)=>{const[r,n]=v.useState(!1),[i,a]=v.useState(null),[s,l]=v.useState(null),f=v.useCallback(async()=>{if(e){n(!0),a(null);try{const h=await Tt(`/api/supplies/${e}/overview`),d=await h.json();if(!h.ok)throw new Error(d?.error||"Khng ti c chi tit");l(d)}catch(h){a(h?.message||" c li xy ra")}finally{n(!1)}}},[e]);return v.useEffect(()=>{t&&e?f():t||(l(null),a(null))},[t,e,f]),{overview:s,loading:r,error:i,fetchOverview:f,setError:a}},OQ=({supply:e,fetchOverview:t,onRefreshList:r})=>{const[n,i]=v.useState(null),[a,s]=v.useState(null);return{confirmingId:n,qrPayment:a,confirmPayment:async h=>{i(h);try{const d=await Tt(`/api/payment-supply/${h}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!d.ok){const m=await d.json().catch(()=>({}));throw new Error(m?.error||"Khng th thanh ton chu k")}return await t(),s(null),r?.(),{success:!0}}catch(d){return{success:!1,error:d?.message||"Khng th thanh ton chu k"}}finally{i(null)}},showQrForPayment:h=>{const d=Math.max(0,(h.totalImport||0)-(h.paid||0)),m=(()=>{const g=new Date,_=String(g.getDate()).padStart(2,"0"),w=String(g.getMonth()+1).padStart(2,"0"),b=g.getFullYear();return`${_}/${w}/${b}`})(),x=TQ({accountNumber:e?.numberBank||"",bankCode:e?.binBank||"",amount:d,description:h.round||m});s({id:h.id,amount:d,url:x,round:h.round||""})},setQrPayment:s}},DQ=({payment:e,onClose:t})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4",onClick:t,children:u.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl border border-white/10 shadow-2xl p-6 w-full max-w-sm",onClick:r=>r.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Chu k"}),u.jsx("p",{className:"text-lg font-bold",children:e.round||"QR thanh ton"})]}),u.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70",children:u.jsx(zr,{className:"h-5 w-5"})})]}),e.url?u.jsx("img",{src:e.url,alt:"QR thanh ton",className:"rounded-lg border border-white/10 bg-white p-4 w-full"}):u.jsx("div",{className:"w-full aspect-square rounded-lg border border-dashed border-white/20 flex items-center justify-center text-white/60",children:"Thiu thng tin  to QR"}),u.jsx("p",{className:"text-xs text-white/60 text-center mt-3",children:"Qut QR  thanh ton s tin chu k."})]})}):null,RQ=({isOpen:e,onClose:t,supplyId:r,banks:n=[],onRefreshList:i})=>{const{overview:a,loading:s,error:l,fetchOverview:f,setError:h}=jQ(r,e),{confirmingId:d,qrPayment:m,confirmPayment:x,showQrForPayment:g,setQrPayment:_}=OQ({supply:a?.supply,fetchOverview:f,onRefreshList:i});if(!e||!r)return null;const w=a?.supply,b=a?.stats,S=a?.unpaidPayments||[],T=S.reduce((B,R)=>B+Math.max(0,(R.totalImport||0)-(R.paid||0)),0),E=b?.monthlyOrders||[],A=w?.isActive?"ang hot ng":"Tm dng",k=w?.isActive?"bg-emerald-500/20 text-emerald-200":"bg-gray-500/20 text-gray-200",j=w?.bankName||n.find(B=>(B.bin||"").trim()===(w?.binBank||"").trim())?.name||w?.binBank||"--",P=[{label:"Tng n",value:b?.totalOrders??0},{label:" thanh ton",value:b?.paidOrders??0},{label:"Cha thanh ton",value:b?.unpaidOrders??0},{label:" hy",value:b?.canceledOrders??0}],M=async B=>{const R=await x(B);R.success||h(R.error||"Khng th thanh ton chu k")},L=()=>{_(null),t()};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60 p-4",onClick:L,children:u.jsxs("div",{className:"bg-slate-900 border border-white/20 p-6 rounded-2xl text-white w-full max-w-4xl max-h-[90vh] shadow-2xl overflow-y-auto",onClick:B=>B.stopPropagation(),children:[u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-white/60",children:["Chi tit Supplier #",r]}),u.jsx("h2",{className:"text-2xl font-bold",children:w?.sourceName||"ang ti..."}),w&&u.jsx("span",{className:`inline-flex mt-2 px-3 py-1 rounded-full text-xs font-semibold ${k}`,children:A})]}),u.jsx("button",{onClick:L,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70","aria-label":"ng",children:u.jsx(zr,{className:"h-6 w-6"})})]}),s?u.jsx("div",{className:"mt-6 text-center text-white/70",children:"ang ti chi tit..."}):l?u.jsxs("div",{className:"mt-6 bg-rose-500/10 text-rose-200 border border-rose-500/40 rounded-xl p-4 flex items-center justify-between gap-3",children:[u.jsx("span",{children:l}),u.jsx("button",{onClick:f,className:"px-3 py-1 rounded-lg bg-rose-500 text-white text-sm hover:bg-rose-600",children:"Th li"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[u.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[u.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Thng tin chung"}),u.jsxs("div",{className:"text-sm text-white/80 space-y-1",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-white/50",children:"Ngn hng: "}),j]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-white/50",children:"S ti khon: "}),w?.numberBank||"--"]}),u.jsxs("div",{children:[u.jsx("span",{className:"text-white/50",children:"Trng thi: "}),A]})]})]}),u.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[u.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Tng quan thanh ton"}),u.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-white/80",children:[u.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[u.jsx("p",{className:"text-white/50 text-xs",children:" thanh ton"}),u.jsx("p",{className:"text-lg font-semibold",children:ga(b?.totalPaidAmount||0)})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[u.jsx("p",{className:"text-white/50 text-xs",children:"Cn n"}),u.jsx("p",{className:"text-lg font-semibold text-orange-300",children:ga(T)})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[u.jsx("p",{className:"text-white/50 text-xs",children:"n cha thanh ton"}),u.jsx("p",{className:"text-lg font-semibold",children:b?.unpaidOrders??0})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[u.jsx("p",{className:"text-white/50 text-xs",children:"n  thanh ton"}),u.jsx("p",{className:"text-lg font-semibold",children:b?.paidOrders??0})]})]})]})]}),u.jsx("div",{className:"grid md:grid-cols-4 gap-3 mt-4",children:P.map(B=>u.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[u.jsx("p",{className:"text-white/50 text-xs",children:B.label}),u.jsx("p",{className:"text-xl font-semibold",children:B.value})]},B.label))}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[u.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Chu k cha thanh ton"}),u.jsxs("span",{className:"text-xs text-white/60",children:["Cn n ",ga(T)]})]}),S.length===0?u.jsx("p",{className:"text-white/50 text-sm",children:"Khng c chu k n."}):u.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:S.map(B=>u.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5 gap-3",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"font-semibold text-sm truncate",children:B.round||"Chu k"}),u.jsx("p",{className:"text-xs text-white/60",children:B.status})]}),u.jsxs("div",{className:"text-right text-sm",children:[u.jsxs("p",{children:["Nhp: ",ga(B.totalImport||0)]}),u.jsxs("p",{className:"text-white/60 text-xs",children:[" tr: ",ga(B.paid||0)]})]}),u.jsx("div",{className:"flex-shrink-0",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{type:"button",onClick:()=>g(B),className:"px-3 py-1.5 text-xs rounded-lg bg-indigo-500 text-white hover:bg-indigo-600",children:"Xem QR"}),u.jsx("button",{disabled:d===B.id,onClick:()=>M(B.id),className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-60",children:d===B.id?"ang x l...":"Thanh ton"})]})})]},B.id))})]}),u.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"n theo thng"}),u.jsxs("span",{className:"text-xs text-white/60",children:[E.length," thng"]})]}),E.length===0?u.jsx("p",{className:"text-white/50 text-sm",children:"Cha c d liu."}):u.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:E.map(B=>u.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5",children:[u.jsxs("span",{className:"text-sm font-semibold",children:["Thng ",B.month]}),u.jsxs("span",{className:"text-sm",children:[B.orders," n"]})]},B.month))})]})]}),u.jsx("div",{className:"mt-6 text-right",children:u.jsx("button",{onClick:L,className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white",children:"ng"})})]})]})}),u.jsx(DQ,{payment:m,onClose:()=>_(null)})]})},IQ=()=>{const[e,t]=v.useState([]),[r,n]=v.useState({totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0}),[i,a]=v.useState(!1),[s,l]=v.useState(null),f=v.useCallback(async()=>{a(!0);try{const d=await Tt("/api/supply-insights");if(!d.ok)throw new Error("Li ti d liu");const m=await d.json(),x=(m.supplies||[]).map(g=>{const _=g.isActive??(g.status!=="inactive"&&g.status!=="tam dung");return{...g,isActive:_,status:_?"active":"inactive",products:Array.isArray(g.products)?g.products.filter(Boolean):[]}});t(x),n({totalSuppliers:Number(m.stats?.totalSuppliers)||0,activeSuppliers:Number(m.stats?.activeSuppliers)||x.filter(g=>g.isActive).length,monthlyOrders:Number(m.stats?.monthlyOrders)||0,totalImportValue:Number(m.stats?.totalImportValue)||0})}catch(d){l(d instanceof Error?d.message:"Li khng xc nh")}finally{a(!1)}},[]);return{supplies:e,stats:r,loading:i,error:s,fetchSupplies:f,setSupplies:t,toggleStatus:async(d,m)=>{t(x=>x.map(g=>g.id===d?{...g,isActive:!m,status:m?"inactive":"active"}:g));try{await Tt(`/api/supplies/${d}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!m})})}catch{t(x=>x.map(g=>g.id===d?{...g,isActive:m,status:m?"active":"inactive"}:g)),alert("Khng th cp nht trng thi")}}}},FQ=({isOpen:e,onClose:t,onSuccess:r,banks:n})=>{const[i,a]=v.useState({sourceName:"",numberBank:"",bankBin:"",status:"active"}),[s,l]=v.useState(!1),[f,h]=v.useState(null);if(v.useEffect(()=>{e&&n.length>0&&!i.bankBin&&a(m=>({...m,bankBin:n[0].bin}))},[e,n,i.bankBin]),!e)return null;const d=async m=>{if(m.preventDefault(),!i.sourceName.trim())return h("Tn khng c  trng");l(!0),h(null);try{const x=await Tt("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!x.ok)throw new Error((await x.json()).error||"Li khi to");r(),t(),a({sourceName:"",numberBank:"",bankBin:n[0]?.bin||"",status:"active"})}catch(x){h(x instanceof Error?x.message:"Li to nh cung cp")}finally{l(!1)}};return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:u.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-md p-6",onClick:m=>m.stopPropagation(),children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Thm Nh Cung Cp Mi"}),f&&u.jsx("p",{className:"text-sm text-red-600 mb-3",children:f}),u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tn Nh Cung Cp"}),u.jsx("input",{className:"w-full border rounded-lg p-2 mt-1 focus:ring-2 focus:ring-blue-500",value:i.sourceName,onChange:m=>a({...i,sourceName:m.target.value}),placeholder:"Nhp tn..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"S Ti Khon"}),u.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.numberBank,onChange:m=>a({...i,numberBank:m.target.value}),placeholder:"STK..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngn Hng"}),u.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:i.bankBin,onChange:m=>a({...i,bankBin:m.target.value}),children:n.map(m=>u.jsx("option",{value:m.bin,children:m.name||`BIN ${m.bin}`},m.bin))})]}),u.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),u.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:s?"ang x l...":"Thm Mi"})]})]})]})})},MQ=({isOpen:e,onClose:t,onSuccess:r,supply:n,banks:i})=>{const[a,s]=v.useState({sourceName:"",numberBank:"",bankBin:""}),[l,f]=v.useState(!1),[h,d]=v.useState(null);if(v.useEffect(()=>{n&&s({sourceName:n.sourceName||"",numberBank:n.numberBank||"",bankBin:n.binBank||i[0]?.bin||""})},[n,i]),!e||!n)return null;const m=async x=>{x.preventDefault(),f(!0);try{if(!(await Tt(`/api/supplies/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw new Error("Li cp nht");r(),t()}catch(g){d(g instanceof Error?g.message:"Li cp nht")}finally{f(!1)}};return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:u.jsxs("div",{className:"w-full max-w-lg bg-white rounded-2xl p-6 shadow-2xl",onClick:x=>x.stopPropagation(),children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Chnh Sa Thng Tin"}),u.jsxs("form",{onSubmit:m,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tn Nh Cung Cp"}),u.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.sourceName,onChange:x=>s({...a,sourceName:x.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"S Ti Khon"}),u.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.numberBank,onChange:x=>s({...a,numberBank:x.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngn Hng"}),u.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:a.bankBin,onChange:x=>s({...a,bankBin:x.target.value}),children:i.map(x=>u.jsx("option",{value:x.bin,children:x.name||`BIN ${x.bin}`},x.bin))})]}),h&&u.jsx("p",{className:"text-sm text-red-500",children:h}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),u.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Lu Thay i"})]})]})]})})},LQ=({isOpen:e,onClose:t,onConfirm:r,supplyName:n})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full shadow-2xl",children:[u.jsx("h3",{className:"text-lg font-bold text-rose-600 mb-2",children:"Xa Nh Cung Cp?"}),u.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa ",u.jsx("b",{children:n}),"? Hnh ng ny khng th hon tc."]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:"Hy"}),u.jsx("button",{onClick:r,className:"px-4 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700",children:"Xa Vnh Vin"})]})]})}):null;function BQ(){const{supplies:e,stats:t,loading:r,fetchSupplies:n,setSupplies:i,toggleStatus:a}=IQ(),[s,l]=v.useState(""),[f,h]=v.useState("all"),[d,m]=v.useState([]),[x,g]=v.useState(null),[_,w]=v.useState(!1),[b,S]=v.useState(null),[T,E]=v.useState(null),[A,k]=v.useState(null);v.useEffect(()=>{n(),Tt("/api/banks").then(M=>M.json()).then(M=>{Array.isArray(M)&&m(M.map(L=>({bin:L.bin,name:L.name})))}).catch(console.error)},[n]);const j=v.useMemo(()=>{const M=VC(s),L=e.filter(R=>{const U=!M||VC(R.sourceName).includes(M),oe=f==="all"||(f==="active"?R.isActive:!R.isActive);return U&&oe}),B=R=>{if(!R)return 0;const U=new Date(R).getTime();return Number.isFinite(U)?U:0};return L.sort((R,U)=>{const oe=Number(R.totalUnpaidImport)||0,V=Number(U.totalUnpaidImport)||0,ae=oe>0,le=V>0;if(ae!==le)return ae?-1:1;if(ae&&le&&oe!==V)return V-oe;const J=B(R.lastOrderDate),re=B(U.lastOrderDate),Z=J>0,se=re>0;if(Z!==se)return Z?-1:1;if(J!==re)return re-J;const G=(U.totalOrders||0)-(R.totalOrders||0);return G!==0?G:R.sourceName.localeCompare(U.sourceName)})},[e,s,f]),P=async()=>{if(A){const M=await NQ(A.id);M.success?(i(L=>L.filter(B=>B.id!==A.id)),k(null)):alert(M.message)}};return u.jsxs("div",{className:"space-y-6 pb-20",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun L Ngun Hng"}),u.jsx("p",{className:"text-white/60 text-sm",children:"Theo di cng n v chu k thanh ton"})]}),u.jsx(ba,{icon:qa,onClick:()=>w(!0),children:"Thm NCC"})]}),u.jsx(EQ,{stats:t}),u.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-2xl flex flex-col md:flex-row gap-4",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(el,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-white/40"}),u.jsx("input",{className:"w-full bg-black/20 border border-white/10 rounded-xl py-2 pl-10 text-white focus:outline-none focus:border-indigo-500",placeholder:"Tm kim...",value:s,onChange:M=>l(M.target.value)})]}),u.jsxs("select",{className:"bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-white focus:outline-none",value:f,onChange:M=>h(M.target.value),children:[u.jsx("option",{value:"all",children:"Tt c trng thi"}),u.jsx("option",{value:"active",children:"ang hot ng"}),u.jsx("option",{value:"inactive",children:"Tm dng"})]})]}),u.jsx(AQ,{supplies:j,loading:r,expandedId:x,onToggle:M=>g(L=>L===M?null:M),onEdit:S,onDelete:k,onView:M=>E(M.id),onToggleStatus:M=>a(M.id,M.isActive)}),u.jsx(FQ,{isOpen:_,onClose:()=>w(!1),onSuccess:n,banks:d}),u.jsx(MQ,{isOpen:!!b,onClose:()=>S(null),onSuccess:n,supply:b,banks:d}),u.jsx(LQ,{isOpen:!!A,onClose:()=>k(null),onConfirm:P,supplyName:A?.sourceName}),u.jsx(RQ,{isOpen:!!T,onClose:()=>E(null),supplyId:T,banks:d,onRefreshList:n})]})}const $Q="/assets/sign-DzA7EGyE.png",UQ={};var zQ={};const WQ="/mavryk-logo.png",fv=e=>e.toLocaleString("vi-VN"),Co=e=>{const t=Number(e);return Number.isFinite(t)?t:0},HQ=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},s0=e=>(e||"").trim().toLowerCase(),o0=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},Il=e=>(e||"").trim().toLowerCase(),dv=e=>{const t=Number(e);return Number.isFinite(t)?t:0},VQ=e=>{const t=dv(e?.price),r=dv(e?.resellPrice),n=dv(e?.promoPrice);return{price:t||r||n||0,promoPrice:n||0,resellPrice:r||void 0}},KQ=(e,t)=>{if(e){const h=ta(e.price||0),d=e.promoPrice>0?ta(e.promoPrice):0;return{unitPrice:h,discount:d}}const r=t?.basePrice??t?.unitPrice??0,n=t?.pctPromo!==void 0?Co(t.pctPromo):0,i=n>1?n/100:Math.max(0,n),a=t?.pctKhach!==void 0&&t?.pctKhach>0?t.pctKhach:1,s=t?.pctCtv!==void 0&&t?.pctCtv>0?t.pctCtv:1,l=ta(r*a*s),f=i>0?ta(l*i):0;return{unitPrice:l,discount:f}},GC=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),i=[],a=(l,f)=>{if(l.nodeType===Node.TEXT_NODE){f.push((l.textContent||"").replace(/\u00a0/g," "));return}if(l.nodeType===Node.ELEMENT_NODE){const h=l;if(h.tagName==="BR"){f.push(`
`);return}const d=[];h.childNodes.forEach(x=>a(x,d));const m=d.join("");f.push(m),n.has(h.tagName)&&f.push(`
`)}},s=[];return r.body.childNodes.forEach(l=>a(l,s)),s.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e}},YC=typeof import.meta<"u"&&UQ?.VITE_API_BASE_URL||zQ.VITE_API_BASE_URL||"http://localhost:3001",GQ=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},Fl="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60";function YQ(){v.useEffect(()=>{const V=document.title;return document.title="Mavryk Premium Store",()=>{document.title=V}},[]);const[e,t]=v.useState(new Date().toISOString().slice(0,10)),[r,n]=v.useState("Ms. Diu Nguyen"),[i,a]=v.useState(""),[s,l]=v.useState([]),[f,h]=v.useState([]),[d,m]=v.useState(""),[x,g]=v.useState({}),_=v.useRef({}),[w,b]=v.useState([]),[S,T]=v.useState([]),E=v.useMemo(()=>{const V=S.map(le=>({...le,total:(le.unitPrice-(le.discount||0))*le.quantity})),ae=V.reduce((le,J)=>le+J.total,0);return{rows:V,grandTotal:ae}},[S]);v.useEffect(()=>{let V=!0;return(async()=>{try{const J=await fetch(`${YC}${Nt.PRODUCT_PRICES}`,{credentials:"include"});if(!J.ok)throw new Error("Failed to load product_price");const re=await J.json();if(!V)return;Array.isArray(re)?l(re):re?.items&&Array.isArray(re.items)?l(re.items):l([])}catch(J){console.error("Khng th ti product_price:",J)}})(),(async()=>{try{const J=await fetch(`${YC}${Nt.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!J.ok)throw new Error("Failed to load product_desc");const re=await J.json();V&&re?.items&&Array.isArray(re.items)&&h(re.items.map(Z=>({productId:Z.productId||Z.product_id||"",rules:Z.rules??"",description:Z.description??""})))}catch(J){console.error("Khng th ti product_desc:",J)}})(),()=>{V=!1}},[]);const A=v.useCallback(async V=>{const ae=V.map(Z=>({original:Z,key:Il(Z)})).filter(Z=>Z.key);if(!ae.length)return x;const le=ae.filter(Z=>!x[Z.key]);if(!le.length)return x;const J={},re=[];return le.forEach(({original:Z,key:se})=>{if(_.current[se]){re.push(_.current[se].then(ne=>{ne&&(J[se]=ne)}));return}const G=(async()=>{try{const ne=await Tt(Nt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({san_pham_name:Z,id_product:Z,customer_type:"LE",for_quote:!0})}),ie=await ne.json().catch(()=>null);if(!ne.ok)throw new Error(ie?.error||"Fail calculate-price");return VQ(ie)}catch(ne){return console.error("calculate-price failed",Z,ne),null}})();_.current[se]=G,re.push(G.then(ne=>{ne&&(J[se]=ne)}).finally(()=>{delete _.current[se]}))}),re.length&&await Promise.all(re),Object.keys(J).length?(g(Z=>({...Z,...J})),{...x,...J}):x},[x]),k=v.useMemo(()=>{const V=new Set,ae=[];return s.forEach(le=>{const re=(le?.[Nr.product]||le?.san_pham||"").trim();if(!re)return;const Z=re.toLowerCase();if(V.has(Z))return;V.add(Z);const se=HQ(re),G=Co(le?.pct_khach??le?.[Nr.pctKhach]),ne=Co(le?.pct_ctv??le?.[Nr.pctCtv]),ie=G>10?G/100:G>0?G:1,de=ne>10?ne/100:ne>0?ne:1,ge=Co(le?.pct_promo??le?.[Nr.pctPromo]),Oe=ge>1?ge/100:Math.max(0,ge),fe=Co(le?.max_supply_price),O=Co(le?.computed_retail_price??le?.retail_price??le?.gia_le??le?.gia_ban)||0,D=Co(le?.computed_promo_price??le?.promo_price??le?.gia_khuyen_mai??le?.gia_km)||0,z=fe>0?ta(fe):0,te=(O||D||z)*(de>0?de:1)*(ie>0?ie:1),Re=ta(te),Ee=Re*(1-Oe),me=ta(Ee),xe=Math.min(Re,z>0?Math.max(z,me):me),Ce=xe>0?Re-xe:0,Le=le?.[Nr.packageProduct]||le?.package_product||le?.package_product_label||"",pe=Le?`${Le} (${re})`:le?.package?`${le?.package} (${re})`:re,Fe=Il(re),Pe=x[Fe];ae.push({productId:re,value:re,productDisplay:le?.package||re,packageDisplay:Le||le?.package||re,label:pe,durationMonths:se.months,durationDays:se.days,term:se.days?`${se.days} ngy`:"",unitPrice:Re,discountValue:Ce,basePrice:Pe?.price??Pe?.resellPrice??O??Re,promoPrice:Pe?.promoPrice??0,pctPromo:Oe,pctKhach:ie,pctCtv:de,wholesalePrice:z})}),ae.sort((le,J)=>le.label.localeCompare(J.label,"vi"))},[s,x]),j=v.useMemo(()=>{const V=new Map;return k.forEach(ae=>{V.set(Il(ae.value),ae)}),V},[k]),P=v.useMemo(()=>{const V=new Map;return s.forEach(ae=>{const le=ae?.[Nr.product]||ae?.san_pham||"",J=ae?.[Nr.packageProduct]||ae?.package_product||ae?.package_product_label||"",re=s0(o0(le));re&&J&&V.set(re,J)}),V},[s]),M=v.useMemo(()=>{const V=new Map;return f.forEach(ae=>{const le=s0(o0(ae.productId));le&&V.set(le,ae)}),V},[f]),L=v.useMemo(()=>{const V=d.trim().toLowerCase();return V?k.filter(ae=>{const le=ae.label.toLowerCase(),J=ae.value.toLowerCase(),re=ae.productDisplay.toLowerCase();return le.includes(V)||J.includes(V)||re.includes(V)}):k},[k,d]),B=v.useMemo(()=>{const V=new Set,ae=[];return S.forEach(le=>{const J=le.productCode||le.product||"",re=s0(o0(J));if(!re||V.has(re))return;V.add(re);const Z=M.get(re),se=P.get(re)||le.packageName||le.product;ae.push({name:se,rules:GC(Z?.rules),description:GC(Z?.description)})}),ae},[S,M,P]),R=async()=>{if(!w.length)return;const V=w.map(le=>le.trim()).filter(Boolean);if(!V.length)return;const ae=await A(V);T(le=>{const J=[...le];return V.forEach(re=>{const Z=j.get(Il(re))??j.get(Il(re.normalize("NFD").replace(/[\u0300-\u036f]/g,""))),se=(J.length+1).toString(),G=Z?.durationDays?`${Z.durationDays} ngy`:Z?.term||"",ne=Il(re),ie=ae[ne],{unitPrice:de,discount:ge}=KQ(ie,Z||{});J.push({id:se,productCode:re,product:Z?.productDisplay||re,packageName:Z?.packageDisplay||P.get(s0(o0(re)))||"",term:G,durationMonths:Z?.durationMonths??null,durationDays:Z?.durationDays??null,unitPrice:de,quantity:1,discount:ge})}),J}),b([])},U=V=>T(ae=>ae.filter(le=>le.id!==V)),oe=`BG-${(e||"").replaceAll("-","")||"----"}`;return u.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[u.jsx("style",{children:XQ}),u.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[u.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thng tin bo gi"})}),u.jsxs("div",{className:"px-6 py-5 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Knh gi"}),u.jsx("input",{type:"text",value:r,onChange:V=>n(V.target.value),className:Fl})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Ngy"}),u.jsx("input",{type:"date",value:e,onChange:V=>t(V.target.value),className:Fl})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"M bo gi"}),u.jsx("input",{value:oe,readOnly:!0,className:`${Fl} opacity-80`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Lin h"}),u.jsx("input",{type:"text",value:i,onChange:V=>a(V.target.value),className:Fl,placeholder:"Email / SDT"})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi ch (ty chn)"}),u.jsx("input",{type:"text",className:Fl,placeholder:"Thng tin thm cho bo gi"})]})]}),u.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[u.jsx("label",{className:"text-sm font-semibold text-white block",children:"M Sn Phm"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[u.jsx("input",{type:"text",value:d,onChange:V=>m(V.target.value),className:`${Fl} text-sm`,placeholder:"Tm sn phm..."}),u.jsx("button",{type:"button",onClick:()=>m(""),className:"px-3 py-2 text-sm rounded-lg border border-white/20 bg-white/5 text-white hover:border-white/40 transition-colors",children:"Xa Tm Kim"})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:L.map(V=>{const ae=w.includes(V.value);return u.jsx("button",{type:"button",onClick:()=>b(le=>le.includes(V.value)?le.filter(J=>J!==V.value):[...le,V.value]),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${ae?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:V.label,children:V.label},V.value)})}),u.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[u.jsx("button",{type:"button",onClick:R,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!w.length,children:"Thm"}),u.jsx("button",{type:"button",onClick:()=>window.print(),className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),S.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:S.map(V=>u.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[V.product,u.jsx("button",{type:"button",onClick:()=>U(V.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xa",children:""})]},V.id))})]})]})]}),u.jsx("div",{className:"print-wrapper flex justify-center",children:u.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[u.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:u.jsx("img",{src:WQ,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:V=>{V.currentTarget.style.display="none"}})}),u.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),u.jsx("p",{children:"SDT: 0378.304.963"}),u.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),u.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BNG BO GI"}),u.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800",children:[u.jsxs("p",{children:["Ngy: ",u.jsx("strong",{children:GQ(e)||"..."})]}),u.jsxs("p",{children:["Knh gi: ",u.jsx("strong",{children:r})]}),i?u.jsxs("p",{children:["Thng tin lin h: ",u.jsx("strong",{children:i})]}):null,u.jsx("p",{className:"mt-3 italic",children:"Li u tin, xin trn trng cm n qu khch hng  quan tm n sn phm ca chng ti. Chng ti xin gi n qu khch hng bng bo gi chi tit nh sau:"})]}),u.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[u.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),u.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TN SN PHM"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THI GIAN"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"N GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIM GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THNH TIN"}),u.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CH"})]})}),u.jsx("tbody",{children:E.rows.map((V,ae)=>u.jsxs("tr",{className:"align-top",children:[u.jsx("td",{className:"border border-slate-600 text-center py-2",children:ae+1}),u.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:V.product,children:V.product}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:V.packageName||V.term}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:V.durationMonths?`${V.durationMonths} thng`:V.durationDays?`${V.durationDays} ngy`:V.term||"--"}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:fv(V.unitPrice)}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:fv(V.discount||0)}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:fv(V.total)}),u.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:V.note||""})]},V.id))})]}),u.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[B.length===0?u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Quy Tc"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Cha cp nht."}),u.jsx("p",{className:"font-semibold mt-3",children:"Thng tin sn phm"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Cha cp nht."})]}):B.map(V=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"font-semibold",children:V.name}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Quy Tc"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:V.rules||"Cha cp nht."})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Thng tin sn phm"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:V.description||"Cha cp nht."})]})]},V.name)),u.jsxs("div",{className:"pt-2 text-sm",children:[u.jsx("p",{className:"font-semibold",children:"Mi thng tin chi tit c th lin h:"}),u.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Ti Khon Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]}),u.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:u.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[u.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),u.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(K, ghi r h tn)"}),u.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:u.jsx("img",{src:$Q,alt:"Ch k",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:V=>{V.currentTarget.style.display="none"}})})]})})]})})})]})}const XQ=`
  /* Hide scrollbars while keeping scroll functionality */
  body {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  body::-webkit-scrollbar {
    display: none;
  }

  @media print {
    /* Hide everything except the printable quote */
    body { background: white !important; margin: 0 !important; padding: 0 !important; }
    body * { visibility: hidden !important; }
    #quote-print-area,
    #quote-print-area * { visibility: visible !important; }
    #quote-print-area {
      position: absolute;
      left: 0;
      top: 0;
      box-shadow: none !important;
      border: none !important;
    }
    .no-print { display: none !important; }
    .print-wrapper { margin: 0 !important; padding: 0 !important; }
  }
`,qQ=({form:e,invoiceCodes:t,onChange:r,onAddInvoiceCode:n,onRemoveInvoiceCode:i,onSubmit:a})=>{const s=v.useId(),[l,f]=v.useState(null),h="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",d="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",m="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",x=g=>{g.key==="Enter"&&(g.preventDefault(),n())};return u.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[u.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thng tin ha n"})}),u.jsxs("form",{className:"px-6 py-5 space-y-4",onSubmit:a,children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:s,className:"text-sm font-medium text-slate-100",children:"Ha n"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:d,onMouseLeave:()=>f(null),children:t.map(g=>u.jsxs("button",{type:"button",onClick:()=>i(g.id),onMouseEnter:()=>f(g.id),onMouseLeave:()=>f(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xa ha n ${g.code}`,children:[u.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:g.code}),u.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${l===g.id?"bg-white/20 text-red-500":""}`,children:u.jsx(zr,{className:"h-4 w-4"})})]},g.id))}),u.jsx("div",{className:m,children:u.jsx("input",{id:s,type:"text",onMouseEnter:()=>f(null),onFocus:()=>f(null),onBlur:()=>f(null),value:e.invoiceCode,onChange:g=>r("invoiceCode",g.target.value),onKeyDown:x,className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhp m ha n v nhn Enter"})})]})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngy"}),u.jsx("input",{type:"date",value:e.invoiceDate,onChange:g=>r("invoiceDate",g.target.value),className:h})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"M s thu"}),u.jsx("input",{type:"text",value:e.taxCode,onChange:g=>r("taxCode",g.target.value),className:h})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khch hng / Cng ty"}),u.jsx("input",{type:"text",value:e.customerName,onChange:g=>r("customerName",g.target.value),className:h})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),u.jsx("input",{type:"text",value:e.fax,onChange:g=>r("fax",g.target.value),className:h})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"a ch"}),u.jsx("textarea",{value:e.address,onChange:g=>r("address",g.target.value),rows:2,className:`${h} resize-none`})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"ST"}),u.jsx("input",{type:"text",value:e.phone,onChange:g=>r("phone",g.target.value),className:h})]})]}),u.jsx("div",{className:"pt-2",children:u.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cp nht thng tin"})})]})]})};let XC=0;const ZQ=e=>(XC+=1,{id:`inv-${Date.now().toString(36)}-${XC.toString(36)}`,code:e}),l0=e=>(e||"").trim().toLowerCase(),qC=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},QQ=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith("MAVC")?"MAVC":t.startsWith("MAVL")?"MAVL":t.startsWith("MAVK")?"MAVK":t.startsWith("MAVT")?"MAVT":null},hv=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},JQ=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},Ml={name:"MAVRYK PREMIUM",address:"Phan Vn Tr, Phng 11, Qun Bnh Thnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ng L Ngc Hng"},eJ={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},pv="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",mv=e=>`${e.toLocaleString("vi-VN")} `,tJ=({form:e,invoiceLines:t,totals:r,dateDisplay:n,onDownload:i})=>{const a=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${pv};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${pv} !important;
      }
    }
  `;return u.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[u.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trc & ti v"})}),u.jsxs("div",{className:"p-6",children:[u.jsx("style",{children:a}),u.jsx("div",{id:"invoice-print-area",children:u.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:pv},children:[u.jsxs("div",{className:"text-center leading-7",children:[u.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:Ml.name}),u.jsxs("p",{children:["a ch: ",Ml.address]}),u.jsxs("p",{children:["in thoi: ",Ml.phone]}),u.jsxs("p",{children:["Ngn hng: ",Ml.bank]}),u.jsxs("p",{children:["STK: ",Ml.accountNumber]}),u.jsxs("p",{children:["Tn ngi nhn: ",Ml.receiver]})]}),u.jsx("div",{className:"my-4 h-px bg-slate-300"}),u.jsxs("div",{className:"text-center space-y-2 leading-7",children:[u.jsx("h2",{className:"text-xl font-bold uppercase",children:"HA N BN HNG"}),u.jsx("div",{className:"text-sm",children:u.jsxs("p",{children:["Ngy: ",n]})})]}),u.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"Khch hng: "}),e.customerName||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"a ch: "}),e.address||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",u.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"M s Thu: "}),e.taxCode||"---"]})]}),u.jsx("div",{className:"mt-8 px-2",children:u.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:u.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tn hng ha / Dch v"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"n gi"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chit khu"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thnh tin"})]})}),u.jsx("tbody",{children:t.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Cha c m ha n no c chn."})}):t.map(s=>u.jsxs("tr",{children:[u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:u.jsx("div",{className:"font-semibold",children:s.description})}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:mv(s.unitPrice)}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:s.quantity}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${s.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:mv(s.total)})]},s.id))})]})})}),u.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tng tin hng: ",mv(r.subtotal)]}),u.jsx("div",{className:"mt-8 text-center text-sm italic",children:"Cm n v hn gp li!"})]})}),u.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:u.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[u.jsx(UI,{className:"h-5 w-5"}),"Download PDF"]})})]})]})},rJ={};var nJ={};const ZC=typeof import.meta<"u"&&rJ?.VITE_API_BASE_URL||nJ.VITE_API_BASE_URL||"http://localhost:3001";function iJ(){v.useEffect(()=>{const T=document.title;return document.title="Mavryk Premium Store",()=>{document.title=T}},[]);const[e,t]=v.useState(eJ),[r,n]=v.useState([]),[i,a]=v.useState([]),[s,l]=v.useState([]);v.useEffect(()=>{let T=!0;const E=async()=>{try{const k=await fetch(`${ZC}${Nt.ORDERS}`,{credentials:"include"});if(!k.ok)throw new Error("Failed to load orders");const j=await k.json();T&&Array.isArray(j)&&a(j)}catch(k){console.error("Khng th ti d liu order_list:",k)}},A=async()=>{try{const k=await fetch(`${ZC}${Nt.PRODUCT_PRICES}`,{credentials:"include"});if(!k.ok)throw new Error("Failed to load product_price");const j=await k.json();T&&j?.items&&Array.isArray(j.items)&&l(j.items)}catch(k){console.error("Khng th ti d liu product_price:",k)}};return E(),A(),()=>{T=!1}},[]);const f=v.useMemo(()=>{const T=new Map;return i.forEach(E=>{const A=l0(E?.[tr.idOrder]);A&&T.set(A,E)}),T},[i]),h=v.useMemo(()=>{const T=new Map;return s.forEach(E=>{const A=l0(E?.[Nr.product]);A&&T.set(A,E)}),T},[s]),d=v.useMemo(()=>r.map(T=>{const E=f.get(l0(T.code)),A=l0(E?.[tr.idProduct]),k=h.get(A),j=QQ(E?.[tr.idOrder]||T.code),P=qC(E?.[tr.idProduct])||qC(k?.[Nr.product]),M=P?`${P} thng`:"",L=k?.[Nr.packageProduct]||k?.[Nr.package]||E?.[tr.idProduct]||T.code,B=M?`${L} ${M}`:L,R=hv(k?.computed_wholesale_price)||hv(E?.[tr.price]),U=hv(k?.computed_retail_price)||R;let oe=U;j==="MAVC"?oe=R:j==="MAVT"?oe=0:j==="MAVL"||j==="MAVK"?oe=U:oe=U||R;const V=j==="MAVK"?JQ(k?.[Nr.pctPromo]):0,ae=Number((V*100).toFixed(2)),le=1,J=Math.max(0,oe*le*(1-V));return{id:T.id,code:T.code,description:B,unitPrice:oe,quantity:le,discountPct:ae,total:J}}),[r,f,h]),m=v.useMemo(()=>({subtotal:d.reduce((E,A)=>E+A.total,0)}),[d]),x=v.useMemo(()=>{if(!e.invoiceDate)return"..... thng ..... nm 20..";const T=new Date(e.invoiceDate);return Number.isNaN(T.getTime())?"..... thng ..... nm 20..":new Intl.DateTimeFormat("vi-VN").format(T)},[e.invoiceDate]),g=(T,E)=>{t(A=>({...A,[T]:E}))},_=()=>{const T=e.invoiceCode.trim();T&&(n(E=>E.some(A=>A.code===T)?E:[...E,ZQ(T)]),t(E=>({...E,invoiceCode:""})))},w=T=>{n(E=>E.filter(A=>A.id!==T))},b=T=>{T.preventDefault()},S=()=>{window.print()};return u.jsxs("div",{className:"space-y-6 print-wrapper",children:[u.jsx(qQ,{form:e,invoiceCodes:r,onChange:g,onAddInvoiceCode:_,onRemoveInvoiceCode:w,onSubmit:b}),u.jsx(tJ,{form:e,invoiceLines:d,totals:m,dateDisplay:x,onDownload:S})]})}var xh={};xh.version="0.20.3";var $a=1200,Ju=function(e){$a=e};function aJ(){Ju(1200)}var c0=function(t){return String.fromCharCode(t)},QC=function(t){return String.fromCharCode(t)},Tn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gh(e){for(var t="",r=0,n=0,i=0,a=0,s=0,l=0,f=0,h=0;h<e.length;)r=e.charCodeAt(h++),a=r>>2,n=e.charCodeAt(h++),s=(r&3)<<4|n>>4,i=e.charCodeAt(h++),l=(n&15)<<2|i>>6,f=i&63,isNaN(n)?l=f=64:isNaN(i)&&(f=64),t+=Tn.charAt(a)+Tn.charAt(s)+Tn.charAt(l)+Tn.charAt(f);return t}function sJ(e){for(var t="",r=0,n=0,i=0,a=0,s=0,l=0,f=0,h=0;h<e.length;)r=e.charCodeAt(h++),r>255&&(r=95),a=r>>2,n=e.charCodeAt(h++),n>255&&(n=95),s=(r&3)<<4|n>>4,i=e.charCodeAt(h++),i>255&&(i=95),l=(n&15)<<2|i>>6,f=i&63,isNaN(n)?l=f=64:isNaN(i)&&(f=64),t+=Tn.charAt(a)+Tn.charAt(s)+Tn.charAt(l)+Tn.charAt(f);return t}function oJ(e){for(var t="",r=0,n=0,i=0,a=0,s=0,l=0,f=0,h=0;h<e.length;)r=e[h++],a=r>>2,n=e[h++],s=(r&3)<<4|n>>4,i=e[h++],l=(n&15)<<2|i>>6,f=i&63,isNaN(n)?l=f=64:isNaN(i)&&(f=64),t+=Tn.charAt(a)+Tn.charAt(s)+Tn.charAt(l)+Tn.charAt(f);return t}function Xs(e){var t="",r=0,n=0,i=0,a=0,s=0,l=0,f=0;if(e.slice(0,5)=="data:"){var h=e.slice(0,1024).indexOf(";base64,");h>-1&&(e=e.slice(h+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)a=Tn.indexOf(e.charAt(h++)),s=Tn.indexOf(e.charAt(h++)),r=a<<2|s>>4,t+=String.fromCharCode(r),l=Tn.indexOf(e.charAt(h++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),f=Tn.indexOf(e.charAt(h++)),i=(l&3)<<6|f,f!==64&&(t+=String.fromCharCode(i));return t}var Dt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ea=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),vh=(function(){if(typeof Buffer>"u")return!1;var e=Ea([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function Xo(e){return Dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function JC(e){return Dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var mi=function(t){return Dt?Ea(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ep(e){if(typeof ArrayBuffer>"u")return mi(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function qo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function lJ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var jr=Dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ea(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)i=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(mi(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function cJ(e){for(var t=[],r=0,n=e.length+250,i=Xo(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|l>>6&15|(s&3)<<4,i[r++]=128|l&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Xo(65535),n=65530)}return t.push(i.slice(0,r)),jr(t)}var Du=/\u0000/g,u0=/[\u0001-\u0006]/g;function Kl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function na(e,t){var r=""+e;return r.length>=t?r:nr("0",t-r.length)+r}function sb(e,t){var r=""+e;return r.length>=t?r:nr(" ",t-r.length)+r}function yh(e,t){var r=""+e;return r.length>=t?r:r+nr(" ",t-r.length)}function uJ(e,t){var r=""+Math.round(e);return r.length>=t?r:nr("0",t-r.length)+r}function fJ(e,t){var r=""+e;return r.length>=t?r:nr("0",t-r.length)+r}var ek=Math.pow(2,32);function Ll(e,t){if(e>ek||e<-ek)return uJ(e,t);var r=Math.round(e);return fJ(r,t)}function wh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var tk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dJ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Qt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},rk={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},hJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bh(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,l=0,f=1,h=0,d=0,m=Math.floor(i);h<t&&(m=Math.floor(i),l=m*s+a,d=m*h+f,!(i-m<5e-8));)i=1/(i-m),a=s,s=l,f=h,h=d;if(d>t&&(h>t?(d=f,l=a):(d=h,l=s)),!r)return[0,n*l,d];var x=Math.floor(n*l/d);return[x,n*l-x*d,d]}function pJ(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+nr("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+nr("0",t.length-15);return Number(n)}function Bl(e,t,r){if(e>2958465||e<0)return null;e=pJ(e);var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],a=f.getDay(),n<60&&(a=(a+6)%7),r&&(a=yJ(f,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}function ob(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mJ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xJ(e){var t=e<0?12:11,r=ob(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function gJ(e){var t=ob(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function vJ(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xJ(e):t===10?r=e.toFixed(10).substr(0,12):r=gJ(e),ob(mJ(r.toUpperCase()))}function W1(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):vJ(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return rs(14,hn(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function yJ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wJ(e,t,r,n){var i="",a=0,s=0,l=r.y,f,h=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:f=l%100,h=2;break;default:f=l%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,h=t.length;break;case 3:return xv[r.m-1][1];case 5:return xv[r.m-1][0];default:return xv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,h=t.length;break;case 3:return tk[r.q][0];default:return tk[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?na(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=na(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:f=l,h=1;break}var d=h>0?na(f,h):"";return d}function $s(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var b3=/%/g;function bJ(e,t,r){var n=t.replace(b3,""),i=t.length-n.length;return Ka(e,n,r*Math.pow(10,2*i))+nr("%",i)}function _J(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ka(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_3(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,h,d){return f+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S3=/# (\?+)( ?)\/( ?)(\d+)/;function SJ(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,l=n;return r+(a===0?"":""+a)+" "+(s===0?nr(" ",e[1].length+1+e[4].length):sb(s,e[1].length)+e[2]+"/"+e[3]+na(l,e[4].length))}function NJ(e,t,r){return r+(t===0?"":""+t)+nr(" ",e[1].length+2+e[4].length)}var N3=/^#*0*\.([0#]+)/,E3=/\)[^)]*[0#]/,T3=/\(###\) ###\\?-####/;function Mn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function nk(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ik(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function EJ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function TJ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Di(e,t,r){if(e.charCodeAt(0)===40&&!t.match(E3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Di("n",n,r):"("+Di("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _J(e,t,r);if(t.indexOf("%")!==-1)return bJ(e,t,r);if(t.indexOf("E")!==-1)return _3(t,r);if(t.charCodeAt(0)===36)return"$"+Di(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,l,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Ll(f,t.length);if(t.match(/^[#?]+$/))return i=Ll(r,0),i==="0"&&(i=""),i.length>t.length?i:Mn(t.substr(0,t.length-i.length))+i;if(a=t.match(S3))return SJ(a,f,h);if(t.match(/^#+0+$/))return h+Ll(f,t.length-t.indexOf("0"));if(a=t.match(N3))return i=nk(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Mn(a[1])).replace(/\.$/,"."+Mn(a[1])).replace(/\.(\d*)$/,function(_,w){return"."+w+nr("0",Mn(a[1]).length-w.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return h+nk(f,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return h+$s(Ll(f,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Di(e,t,-r):$s(""+(Math.floor(r)+EJ(r,a[1].length)))+"."+na(ik(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Di(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(Di(e,t.replace(/[\\-]/g,""),r)),s=0,Kl(Kl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<i.length?i.charAt(s++):_==="0"?"0":""}));if(t.match(T3))return i=Di(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=bh(f,Math.pow(10,s)-1,!1),i=""+h,d=Ka("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=yh(l[2],s),d.length<a[4].length&&(d=Mn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),l=bh(f,Math.pow(10,s)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?sb(l[1],s)+a[2]+"/"+a[3]+yh(l[2],s):nr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Ll(r,0),t.length<=i.length?i:Mn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var m=t.indexOf(".")-s,x=t.length-i.length-m;return Mn(t.substr(0,m)+i+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=ik(r,a[1].length),r<0?"-"+Di(e,t,-r):$s(TJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?na(0,3-_.length):"")+_})+"."+na(s,a[1].length);switch(t){case"###,##0.00":return Di(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=$s(Ll(f,0));return g!=="0"?h+g:"";case"###,###.00":return Di(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Di(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ka(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kJ(e,t,r){var n=t.replace(b3,""),i=t.length-n.length;return Ka(e,n,r*Math.pow(10,2*i))+nr("%",i)}function C3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C3(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,f,h,d){return f+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ha(e,t,r){if(e.charCodeAt(0)===40&&!t.match(E3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ha("n",n,r):"("+ha("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CJ(e,t,r);if(t.indexOf("%")!==-1)return kJ(e,t,r);if(t.indexOf("E")!==-1)return C3(t,r);if(t.charCodeAt(0)===36)return"$"+ha(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,l,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+na(f,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Mn(t.substr(0,t.length-i.length))+i;if(a=t.match(S3))return NJ(a,f,h);if(t.match(/^#+0+$/))return h+na(f,t.length-t.indexOf("0"));if(a=t.match(N3))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Mn(a[1])).replace(/\.$/,"."+Mn(a[1])),i=i.replace(/\.(\d*)$/,function(_,w){return"."+w+nr("0",Mn(a[1]).length-w.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return h+$s(""+f);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):$s(""+r)+"."+nr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ha(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(ha(e,t.replace(/[\\-]/g,""),r)),s=0,Kl(Kl(t.replace(/\\/g,"")).replace(/[0#]/g,function(_){return s<i.length?i.charAt(s++):_==="0"?"0":""}));if(t.match(T3))return i=ha(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=bh(f,Math.pow(10,s)-1,!1),i=""+h,d=Ka("n",a[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=yh(l[2],s),d.length<a[4].length&&(d=Mn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),l=bh(f,Math.pow(10,s)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?sb(l[1],s)+a[2]+"/"+a[3]+yh(l[2],s):nr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Mn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var m=t.indexOf(".")-s,x=t.length-i.length-m;return Mn(t.substr(0,m)+i+t.substr(t.length-x))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ha(e,t,-r):$s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?na(0,3-_.length):"")+_})+"."+na(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=$s(""+f);return g!=="0"?h+g:"";default:if(t.match(/\.[0#?]*$/))return ha(e,t.slice(0,t.lastIndexOf(".")),r)+Mn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ka(e,t,r){return(r|0)===r?ha(e,t,r):Di(e,t,r)}function AJ(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var k3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zo(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":wh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(k3))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function PJ(e,t,r,n){for(var i=[],a="",s=0,l="",f="t",h,d,m,x="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!wh(e,s))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(m=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(m);i[i.length]={t:"t",v:a},++s;break;case"\\":var g=e.charAt(++s),_=g==="("||g===")"?g:"t";i[i.length]={t:_,v:g},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(h==null&&(h=Bl(t,r,e.charAt(s+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},f=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Bl(t,r),h==null))return"";for(a=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)a+=l;l==="m"&&f.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),i[i.length]={t:l,v:a},f=l;break;case"A":case"a":case"":var w={t:l,v:l};if(h==null&&(h=Bl(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?e.charAt(s+2):l),w.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",s+=5,x="h"):(w.t="t",++s),h==null&&w.t==="T")return"";i[i.length]=w,f=l;break;case"[":for(a=l;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(k3)){if(h==null&&(h=Bl(t,r),h==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},f=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zo(e)||(i[i.length]={t:"t",v:a}));break;case".":if(h!=null){for(a=l;++s<e.length&&(l=e.charAt(s))==="0";)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;e.charAt(++s)===l;)a+=l;i[i.length]={t:l,v:a},f=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++s;break}var b=0,S=0,T;for(s=i.length-1,f="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=x,f="h",b<1&&(b=1);break;case"s":(T=i[s].v.match(/\.0+$/))&&(S=Math.max(S,T[0].length-1),b=4),b<3&&(b=3);case"d":case"y":case"e":f=i[s].t;break;case"M":f=i[s].t,b<2&&(b=2);break;case"m":f==="s"&&(i[s].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[s].v.match(/[Hh]/)&&(b=1),b<2&&i[s].v.match(/[Mm]/)&&(b=2),b<3&&i[s].v.match(/[Ss]/)&&(b=3)}var E;switch(b){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,E=Bl(h.D),E.u=h.u,E.S=h.S,E.M=h.M,E.H=h.H,h=E);break;case 4:switch(S){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,E=Bl(h.D),E.u=h.u,E.S=h.S,E.M=h.M,E.H=h.H,h=E);break}var A="",k;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=wJ(i[s].t.charCodeAt(0),i[s].v,h,S),i[s].t="t";break;case"n":case"?":for(k=s+1;i[k]!=null&&((l=i[k].t)==="?"||l==="D"||(l===" "||l==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[s].v+=i[k].v,i[k]={v:"",t:";"},++k;A+=i[s].v,s=k-1;break;case"G":i[s].t="t",i[s].v=W1(t,r);break}var j="",P,M;if(A.length>0){A.charCodeAt(0)==40?(P=t<0&&A.charCodeAt(0)===45?-t:t,M=Ka("n",A,P)):(P=t<0&&n>1?-t:t,M=Ka("n",A,P),P<0&&i[0]&&i[0].t=="t"&&(M=M.substr(1),i[0].v="-"+i[0].v)),k=M.length-1;var L=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){L=s;break}var B=i.length;if(L===i.length&&M.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(k>=i[s].v.length-1?(k-=i[s].v.length,i[s].v=M.substr(k+1,i[s].v.length)):k<0?i[s].v="":(i[s].v=M.substr(0,k+1),k=-1),i[s].t="t",B=s);k>=0&&B<i.length&&(i[B].v=M.substr(0,k+1)+i[B].v)}else if(L!==i.length&&M.indexOf("E")===-1){for(k=M.indexOf(".")-1,s=L;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")-1:i[s].v.length-1,j=i[s].v.substr(d+1);d>=0;--d)k>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(j=M.charAt(k--)+j);i[s].v=j,i[s].t="t",B=s}for(k>=0&&B<i.length&&(i[B].v=M.substr(0,k+1)+i[B].v),k=M.indexOf(".")+1,s=L;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==L)){for(d=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")+1:0,j=i[s].v.substr(0,d);d<i[s].v.length;++d)k<M.length&&(j+=M.charAt(k++));i[s].v=j,i[s].t="t",B=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(P=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Ka(i[s].t,i[s].v,P),i[s].t="t");var R="";for(s=0;s!==i.length;++s)i[s]!=null&&(R+=i[s].v);return R}var ak=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sk(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jJ(e,t){var r=AJ(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(ak),l=r[1].match(ak);return sk(t,s)?[n,r[0]]:sk(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,a]}function rs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Qt)[e],n==null&&(n=r.table&&r.table[rk[e]]||Qt[rk[e]]),n==null&&(n=hJ[e]||"General");break}if(wh(n,0))return W1(t,r);t instanceof Date&&(t=hn(t,r.date1904));var i=jJ(n,t);if(wh(i[1]))return W1(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return PJ(i[1],t,r,i[0])}function A3(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Qt[r]==null){t<0&&(t=r);continue}if(Qt[r]==e){t=r;break}}t<0&&(t=391)}return Qt[t]=e,t}function Tp(e){for(var t=0;t!=392;++t)e[t]!==void 0&&A3(e[t],t)}function Cp(){Qt=dJ()}var _h=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function OJ(e){var t=typeof e=="number"?Qt[e]:e;return t=t.replace(_h,"(\\d+)"),_h.lastIndex=0,new RegExp("^"+t+"$")}function DJ(e,t,r){var n=-1,i=-1,a=-1,s=-1,l=-1,f=-1;(t.match(_h)||[]).forEach(function(m,x){var g=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=g;break;case"d":a=g;break;case"h":s=g;break;case"s":f=g;break;case"m":s>=0?l=g:i=g;break}}),_h.lastIndex=0,f>=0&&l==-1&&i>=0&&(l=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&l==-1&&f==-1?h:n==-1&&i==-1&&a==-1?d:h+"T"+d}var RJ={"d.m":"d\\.m"};function IJ(e,t){return A3(RJ[e]||e,t)}var ok=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,M=new Array(256),L=0;L!=256;++L)P=L,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,M[L]=P;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(P){var M=0,L=0,B=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)R[B]=P[B];for(B=0;B!=256;++B)for(L=P[B],M=256+B;M<4096;M+=256)L=R[M]=L>>>8^P[L&255];var U=[];for(B=1;B!=16;++B)U[B-1]=typeof Int32Array<"u"&&typeof R.subarray=="function"?R.subarray(B*256,B*256+256):R.slice(B*256,B*256+256);return U}var i=n(r),a=i[0],s=i[1],l=i[2],f=i[3],h=i[4],d=i[5],m=i[6],x=i[7],g=i[8],_=i[9],w=i[10],b=i[11],S=i[12],T=i[13],E=i[14];function A(P,M){for(var L=M^-1,B=0,R=P.length;B<R;)L=L>>>8^r[(L^P.charCodeAt(B++))&255];return~L}function k(P,M){for(var L=M^-1,B=P.length-15,R=0;R<B;)L=E[P[R++]^L&255]^T[P[R++]^L>>8&255]^S[P[R++]^L>>16&255]^b[P[R++]^L>>>24]^w[P[R++]]^_[P[R++]]^g[P[R++]]^x[P[R++]]^m[P[R++]]^d[P[R++]]^h[P[R++]]^f[P[R++]]^l[P[R++]]^s[P[R++]]^a[P[R++]]^r[P[R++]];for(B+=15;R<B;)L=L>>>8^r[(L^P[R++])&255];return~L}function j(P,M){for(var L=M^-1,B=0,R=P.length,U=0,oe=0;B<R;)U=P.charCodeAt(B++),U<128?L=L>>>8^r[(L^U)&255]:U<2048?(L=L>>>8^r[(L^(192|U>>6&31))&255],L=L>>>8^r[(L^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,oe=P.charCodeAt(B++)&1023,L=L>>>8^r[(L^(240|U>>8&7))&255],L=L>>>8^r[(L^(128|U>>2&63))&255],L=L>>>8^r[(L^(128|oe>>6&15|(U&3)<<4))&255],L=L>>>8^r[(L^(128|oe&63))&255]):(L=L>>>8^r[(L^(224|U>>12&15))&255],L=L>>>8^r[(L^(128|U>>6&63))&255],L=L>>>8^r[(L^(128|U&63))&255]);return~L}return e.table=r,e.bstr=A,e.buf=k,e.str=j,e})(),Wt=(function(){var t={};t.version="1.2.2";function r(F,Y){for(var W=F.split("/"),K=Y.split("/"),X=0,Q=0,be=Math.min(W.length,K.length);X<be;++X){if(Q=W[X].length-K[X].length)return Q;if(W[X]!=K[X])return W[X]<K[X]?-1:1}return W.length-K.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var Y=F.lastIndexOf("/");return Y===-1?F:F.slice(0,Y+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var Y=F.lastIndexOf("/");return Y===-1?F:F.slice(Y+1)}function a(F,Y){typeof Y=="string"&&(Y=new Date(Y));var W=Y.getHours();W=W<<6|Y.getMinutes(),W=W<<5|Y.getSeconds()>>>1,F.write_shift(2,W);var K=Y.getFullYear()-1980;K=K<<4|Y.getMonth()+1,K=K<<5|Y.getDate(),F.write_shift(2,K)}function s(F){var Y=F.read_shift(2)&65535,W=F.read_shift(2)&65535,K=new Date,X=W&31;W>>>=5;var Q=W&15;W>>>=4,K.setMilliseconds(0),K.setFullYear(W+1980),K.setMonth(Q-1),K.setDate(X);var be=Y&31;Y>>>=5;var Ie=Y&63;return Y>>>=6,K.setHours(Y),K.setMinutes(Ie),K.setSeconds(be<<1),K}function l(F){Ln(F,0);for(var Y={},W=0;F.l<=F.length-4;){var K=F.read_shift(2),X=F.read_shift(2),Q=F.l+X,be={};switch(K){case 21589:W=F.read_shift(1),W&1&&(be.mtime=F.read_shift(4)),X>5&&(W&2&&(be.atime=F.read_shift(4)),W&4&&(be.ctime=F.read_shift(4))),be.mtime&&(be.mt=new Date(be.mtime*1e3));break;case 1:{var Ie=F.read_shift(4),ye=F.read_shift(4);be.usz=ye*Math.pow(2,32)+Ie,Ie=F.read_shift(4),ye=F.read_shift(4),be.csz=ye*Math.pow(2,32)+Ie}break}F.l=Q,Y[K]=be}return Y}var f;function h(){return f||(f=FJ)}function d(F,Y){if(F[0]==80&&F[1]==75)return cr(F,Y);if((F[0]|32)==109&&(F[1]|32)==105)return Df(F,Y);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var W=3,K=512,X=0,Q=0,be=0,Ie=0,ye=0,_e=[],Se=F.slice(0,512);Ln(Se,0);var Ge=m(Se);switch(W=Ge[0],W){case 3:K=512;break;case 4:K=4096;break;case 0:if(Ge[1]==0)return cr(F,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}K!==512&&(Se=F.slice(0,K),Ln(Se,28));var Je=F.slice(0,K);x(Se,W);var rt=Se.read_shift(4,"i");if(W===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);Se.l+=4,be=Se.read_shift(4,"i"),Se.l+=4,Se.chk("00100000","Mini Stream Cutoff Size: "),Ie=Se.read_shift(4,"i"),X=Se.read_shift(4,"i"),ye=Se.read_shift(4,"i"),Q=Se.read_shift(4,"i");for(var Xe=-1,Ue=0;Ue<109&&(Xe=Se.read_shift(4,"i"),!(Xe<0));++Ue)_e[Ue]=Xe;var gt=g(F,K);b(ye,Q,gt,K,_e);var $t=T(gt,be,_e,K);be<$t.length&&($t[be].name="!Directory"),X>0&&Ie!==oe&&($t[Ie].name="!MiniFAT"),$t[_e[0]].name="!FAT",$t.fat_addrs=_e,$t.ssz=K;var Vt={},wr=[],co=[],fs=[];E(be,$t,gt,wr,X,Vt,co,Ie),_(co,fs,wr),wr.shift();var sa={FileIndex:co,FullPaths:fs};return Y&&Y.raw&&(sa.raw={header:Je,sectors:gt}),sa}function m(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(V,"Header Signature: "),F.l+=16;var Y=F.read_shift(2,"u");return[F.read_shift(2,"u"),Y]}function x(F,Y){var W=9;switch(F.l+=2,W=F.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function g(F,Y){for(var W=Math.ceil(F.length/Y)-1,K=[],X=1;X<W;++X)K[X-1]=F.slice(X*Y,(X+1)*Y);return K[W-1]=F.slice(W*Y),K}function _(F,Y,W){for(var K=0,X=0,Q=0,be=0,Ie=0,ye=W.length,_e=[],Se=[];K<ye;++K)_e[K]=Se[K]=K,Y[K]=W[K];for(;Ie<Se.length;++Ie)K=Se[Ie],X=F[K].L,Q=F[K].R,be=F[K].C,_e[K]===K&&(X!==-1&&_e[X]!==X&&(_e[K]=_e[X]),Q!==-1&&_e[Q]!==Q&&(_e[K]=_e[Q])),be!==-1&&(_e[be]=K),X!==-1&&K!=_e[K]&&(_e[X]=_e[K],Se.lastIndexOf(X)<Ie&&Se.push(X)),Q!==-1&&K!=_e[K]&&(_e[Q]=_e[K],Se.lastIndexOf(Q)<Ie&&Se.push(Q));for(K=1;K<ye;++K)_e[K]===K&&(Q!==-1&&_e[Q]!==Q?_e[K]=_e[Q]:X!==-1&&_e[X]!==X&&(_e[K]=_e[X]));for(K=1;K<ye;++K)if(F[K].type!==0){if(Ie=K,Ie!=_e[Ie])do Ie=_e[Ie],Y[K]=Y[Ie]+"/"+Y[K];while(Ie!==0&&_e[Ie]!==-1&&Ie!=_e[Ie]);_e[K]=-1}for(Y[0]+="/",K=1;K<ye;++K)F[K].type!==2&&(Y[K]+="/")}function w(F,Y,W){for(var K=F.start,X=F.size,Q=[],be=K;W&&X>0&&be>=0;)Q.push(Y.slice(be*U,be*U+U)),X-=U,be=ko(W,be*4);return Q.length===0?we(0):jr(Q).slice(0,F.size)}function b(F,Y,W,K,X){var Q=oe;if(F===oe){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var be=W[F],Ie=(K>>>2)-1;if(!be)return;for(var ye=0;ye<Ie&&(Q=ko(be,ye*4))!==oe;++ye)X.push(Q);Y>=1&&b(ko(be,K-4),Y-1,W,K,X)}}function S(F,Y,W,K,X){var Q=[],be=[];X||(X=[]);var Ie=K-1,ye=0,_e=0;for(ye=Y;ye>=0;){X[ye]=!0,Q[Q.length]=ye,be.push(F[ye]);var Se=W[Math.floor(ye*4/K)];if(_e=ye*4&Ie,K<4+_e)throw new Error("FAT boundary crossed: "+ye+" 4 "+K);if(!F[Se])break;ye=ko(F[Se],_e)}return{nodes:Q,data:pk([be])}}function T(F,Y,W,K){var X=F.length,Q=[],be=[],Ie=[],ye=[],_e=K-1,Se=0,Ge=0,Je=0,rt=0;for(Se=0;Se<X;++Se)if(Ie=[],Je=Se+Y,Je>=X&&(Je-=X),!be[Je]){ye=[];var Xe=[];for(Ge=Je;Ge>=0;){Xe[Ge]=!0,be[Ge]=!0,Ie[Ie.length]=Ge,ye.push(F[Ge]);var Ue=W[Math.floor(Ge*4/K)];if(rt=Ge*4&_e,K<4+rt)throw new Error("FAT boundary crossed: "+Ge+" 4 "+K);if(!F[Ue]||(Ge=ko(F[Ue],rt),Xe[Ge]))break}Q[Je]={nodes:Ie,data:pk([ye])}}return Q}function E(F,Y,W,K,X,Q,be,Ie){for(var ye=0,_e=K.length?2:0,Se=Y[F].data,Ge=0,Je=0,rt;Ge<Se.length;Ge+=128){var Xe=Se.slice(Ge,Ge+128);Ln(Xe,64),Je=Xe.read_shift(2),rt=hb(Xe,0,Je-_e),K.push(rt);var Ue={name:rt,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},gt=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);gt!==0&&(Ue.ct=A(Xe,Xe.l-8));var $t=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);$t!==0&&(Ue.mt=A(Xe,Xe.l-8)),Ue.start=Xe.read_shift(4,"i"),Ue.size=Xe.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=oe,Ue.name=""),Ue.type===5?(ye=Ue.start,X>0&&ye!==oe&&(Y[ye].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",Y[Ue.start]===void 0&&(Y[Ue.start]=S(W,Ue.start,Y.fat_addrs,Y.ssz)),Y[Ue.start].name=Ue.name,Ue.content=Y[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:ye!==oe&&Ue.start!==oe&&Y[ye]&&(Ue.content=w(Ue,Y[ye].data,(Y[Ie]||{}).data))),Ue.content&&Ln(Ue.content,0),Q[rt]=Ue,be.push(Ue)}}function A(F,Y){return new Date((gi(F,Y+4)/1e7*Math.pow(2,32)+gi(F,Y)/1e7-11644473600)*1e3)}function k(F,Y){return h(),d(f.readFileSync(F),Y)}function j(F,Y){var W=Y&&Y.type;switch(W||Dt&&Buffer.isBuffer(F)&&(W="buffer"),W||"base64"){case"file":return k(F,Y);case"base64":return d(mi(Xs(F)),Y);case"binary":return d(mi(F),Y)}return d(F,Y)}function P(F,Y){var W=Y||{},K=W.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=K+"/",F.FileIndex[0]={name:K,type:5}),W.CLSID&&(F.FileIndex[0].clsid=W.CLSID),M(F)}function M(F){var Y="Sh33tJ5";if(!Wt.find(F,"/"+Y)){var W=we(4);W[0]=55,W[1]=W[3]=50,W[2]=54,F.FileIndex.push({name:Y,type:2,content:W,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+Y),L(F)}}function L(F,Y){P(F);for(var W=!1,K=!1,X=F.FullPaths.length-1;X>=0;--X){var Q=F.FileIndex[X];switch(Q.type){case 0:K?W=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(Q.R*Q.L*Q.C)&&(W=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!Y)){var be=new Date(1987,1,19),Ie=0,ye=Object.create?Object.create(null):{},_e=[];for(X=0;X<F.FullPaths.length;++X)ye[F.FullPaths[X]]=!0,F.FileIndex[X].type!==0&&_e.push([F.FullPaths[X],F.FileIndex[X]]);for(X=0;X<_e.length;++X){var Se=n(_e[X][0]);for(K=ye[Se];!K;){for(;n(Se)&&!ye[n(Se)];)Se=n(Se);_e.push([Se,{name:i(Se).replace("/",""),type:1,clsid:le,ct:be,mt:be,content:null}]),ye[Se]=!0,Se=n(_e[X][0]),K=ye[Se]}}for(_e.sort(function(rt,Xe){return r(rt[0],Xe[0])}),F.FullPaths=[],F.FileIndex=[],X=0;X<_e.length;++X)F.FullPaths[X]=_e[X][0],F.FileIndex[X]=_e[X][1];for(X=0;X<_e.length;++X){var Ge=F.FileIndex[X],Je=F.FullPaths[X];if(Ge.name=i(Je).replace("/",""),Ge.L=Ge.R=Ge.C=-(Ge.color=1),Ge.size=Ge.content?Ge.content.length:0,Ge.start=0,Ge.clsid=Ge.clsid||le,X===0)Ge.C=_e.length>1?1:-1,Ge.size=0,Ge.type=5;else if(Je.slice(-1)=="/"){for(Ie=X+1;Ie<_e.length&&n(F.FullPaths[Ie])!=Je;++Ie);for(Ge.C=Ie>=_e.length?-1:Ie,Ie=X+1;Ie<_e.length&&n(F.FullPaths[Ie])!=n(Je);++Ie);Ge.R=Ie>=_e.length?-1:Ie,Ge.type=1}else n(F.FullPaths[X+1]||"")==n(Je)&&(Ge.R=X+1),Ge.type=2}}}function B(F,Y){var W=Y||{};if(W.fileType=="mad")return oo(F,W);switch(L(F),W.fileType){case"zip":return mr(F,W)}var K=(function(rt){for(var Xe=0,Ue=0,gt=0;gt<rt.FileIndex.length;++gt){var $t=rt.FileIndex[gt];if($t.content){var Vt=$t.content.length;Vt>0&&(Vt<4096?Xe+=Vt+63>>6:Ue+=Vt+511>>9)}}for(var wr=rt.FullPaths.length+3>>2,co=Xe+7>>3,fs=Xe+127>>7,sa=co+Ue+wr+fs,Gr=sa+127>>7,Oc=Gr<=109?0:Math.ceil((Gr-109)/127);sa+Gr+Oc+127>>7>Gr;)Oc=++Gr<=109?0:Math.ceil((Gr-109)/127);var br=[1,Oc,Gr,fs,wr,Ue,Xe,0];return rt.FileIndex[0].size=Xe<<6,br[7]=(rt.FileIndex[0].start=br[0]+br[1]+br[2]+br[3]+br[4]+br[5])+(br[6]+7>>3),br})(F),X=we(K[7]<<9),Q=0,be=0;{for(Q=0;Q<8;++Q)X.write_shift(1,ae[Q]);for(Q=0;Q<8;++Q)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),Q=0;Q<3;++Q)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,K[2]),X.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:oe),X.write_shift(4,K[3]),X.write_shift(-4,K[1]?K[0]-1:oe),X.write_shift(4,K[1]),Q=0;Q<109;++Q)X.write_shift(-4,Q<K[2]?K[1]+Q:-1)}if(K[1])for(be=0;be<K[1];++be){for(;Q<236+be*127;++Q)X.write_shift(-4,Q<K[2]?K[1]+Q:-1);X.write_shift(-4,be===K[1]-1?oe:be+1)}var Ie=function(rt){for(be+=rt;Q<be-1;++Q)X.write_shift(-4,Q+1);rt&&(++Q,X.write_shift(-4,oe))};for(be=Q=0,be+=K[1];Q<be;++Q)X.write_shift(-4,J.DIFSECT);for(be+=K[2];Q<be;++Q)X.write_shift(-4,J.FATSECT);Ie(K[3]),Ie(K[4]);for(var ye=0,_e=0,Se=F.FileIndex[0];ye<F.FileIndex.length;++ye)Se=F.FileIndex[ye],Se.content&&(_e=Se.content.length,!(_e<4096)&&(Se.start=be,Ie(_e+511>>9)));for(Ie(K[6]+7>>3);X.l&511;)X.write_shift(-4,J.ENDOFCHAIN);for(be=Q=0,ye=0;ye<F.FileIndex.length;++ye)Se=F.FileIndex[ye],Se.content&&(_e=Se.content.length,!(!_e||_e>=4096)&&(Se.start=be,Ie(_e+63>>6)));for(;X.l&511;)X.write_shift(-4,J.ENDOFCHAIN);for(Q=0;Q<K[4]<<2;++Q){var Ge=F.FullPaths[Q];if(!Ge||Ge.length===0){for(ye=0;ye<17;++ye)X.write_shift(4,0);for(ye=0;ye<3;++ye)X.write_shift(4,-1);for(ye=0;ye<12;++ye)X.write_shift(4,0);continue}Se=F.FileIndex[Q],Q===0&&(Se.start=Se.size?Se.start-1:oe);var Je=Q===0&&W.root||Se.name;if(Je.length>31&&(console.error("Name "+Je+" will be truncated to "+Je.slice(0,31)),Je=Je.slice(0,31)),_e=2*(Je.length+1),X.write_shift(64,Je,"utf16le"),X.write_shift(2,_e),X.write_shift(1,Se.type),X.write_shift(1,Se.color),X.write_shift(-4,Se.L),X.write_shift(-4,Se.R),X.write_shift(-4,Se.C),Se.clsid)X.write_shift(16,Se.clsid,"hex");else for(ye=0;ye<4;++ye)X.write_shift(4,0);X.write_shift(4,Se.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,Se.start),X.write_shift(4,Se.size),X.write_shift(4,0)}for(Q=1;Q<F.FileIndex.length;++Q)if(Se=F.FileIndex[Q],Se.size>=4096)if(X.l=Se.start+1<<9,Dt&&Buffer.isBuffer(Se.content))Se.content.copy(X,X.l,0,Se.size),X.l+=Se.size+511&-512;else{for(ye=0;ye<Se.size;++ye)X.write_shift(1,Se.content[ye]);for(;ye&511;++ye)X.write_shift(1,0)}for(Q=1;Q<F.FileIndex.length;++Q)if(Se=F.FileIndex[Q],Se.size>0&&Se.size<4096)if(Dt&&Buffer.isBuffer(Se.content))Se.content.copy(X,X.l,0,Se.size),X.l+=Se.size+63&-64;else{for(ye=0;ye<Se.size;++ye)X.write_shift(1,Se.content[ye]);for(;ye&63;++ye)X.write_shift(1,0)}if(Dt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function R(F,Y){var W=F.FullPaths.map(function(ye){return ye.toUpperCase()}),K=W.map(function(ye){var _e=ye.split("/");return _e[_e.length-(ye.slice(-1)=="/"?2:1)]}),X=!1;Y.charCodeAt(0)===47?(X=!0,Y=W[0].slice(0,-1)+Y):X=Y.indexOf("/")!==-1;var Q=Y.toUpperCase(),be=X===!0?W.indexOf(Q):K.indexOf(Q);if(be!==-1)return F.FileIndex[be];var Ie=!Q.match(u0);for(Q=Q.replace(Du,""),Ie&&(Q=Q.replace(u0,"!")),be=0;be<W.length;++be)if((Ie?W[be].replace(u0,"!"):W[be]).replace(Du,"")==Q||(Ie?K[be].replace(u0,"!"):K[be]).replace(Du,"")==Q)return F.FileIndex[be];return null}var U=64,oe=-2,V="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:oe,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(F,Y,W){h();var K=B(F,W);f.writeFileSync(Y,K)}function Z(F){for(var Y=new Array(F.length),W=0;W<F.length;++W)Y[W]=String.fromCharCode(F[W]);return Y.join("")}function se(F,Y){var W=B(F,Y);switch(Y&&Y.type||"buffer"){case"file":return h(),f.writeFileSync(Y.filename,W),W;case"binary":return typeof W=="string"?W:Z(W);case"base64":return gh(typeof W=="string"?W:Z(W));case"buffer":if(Dt)return Buffer.isBuffer(W)?W:Ea(W);case"array":return typeof W=="string"?mi(W):W}return W}var G;function ne(F){try{var Y=F.InflateRaw,W=new Y;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)G=F;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function ie(F,Y){if(!G)return Tr(F,Y);var W=G.InflateRaw,K=new W,X=K._processChunk(F.slice(F.l),K._finishFlushFlag);return F.l+=K.bytesRead,X}function de(F){return G?G.deflateRawSync(F):Qe(F)}var ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(F){var Y=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var D=typeof Uint8Array<"u",z=D?new Uint8Array(256):[],H=0;H<256;++H)z[H]=O(H);function te(F,Y){var W=z[F&255];return Y<=8?W>>>8-Y:(W=W<<8|z[F>>8&255],Y<=16?W>>>16-Y:(W=W<<8|z[F>>16&255],W>>>24-Y))}function Re(F,Y){var W=Y&7,K=Y>>>3;return(F[K]|(W<=6?0:F[K+1]<<8))>>>W&3}function Ee(F,Y){var W=Y&7,K=Y>>>3;return(F[K]|(W<=5?0:F[K+1]<<8))>>>W&7}function me(F,Y){var W=Y&7,K=Y>>>3;return(F[K]|(W<=4?0:F[K+1]<<8))>>>W&15}function xe(F,Y){var W=Y&7,K=Y>>>3;return(F[K]|(W<=3?0:F[K+1]<<8))>>>W&31}function Ce(F,Y){var W=Y&7,K=Y>>>3;return(F[K]|(W<=1?0:F[K+1]<<8))>>>W&127}function Le(F,Y,W){var K=Y&7,X=Y>>>3,Q=(1<<W)-1,be=F[X]>>>K;return W<8-K||(be|=F[X+1]<<8-K,W<16-K)||(be|=F[X+2]<<16-K,W<24-K)||(be|=F[X+3]<<24-K),be&Q}function pe(F,Y,W){var K=Y&7,X=Y>>>3;return K<=5?F[X]|=(W&7)<<K:(F[X]|=W<<K&255,F[X+1]=(W&7)>>8-K),Y+3}function Fe(F,Y,W){var K=Y&7,X=Y>>>3;return W=(W&1)<<K,F[X]|=W,Y+1}function Pe(F,Y,W){var K=Y&7,X=Y>>>3;return W<<=K,F[X]|=W&255,W>>>=8,F[X+1]=W,Y+8}function We(F,Y,W){var K=Y&7,X=Y>>>3;return W<<=K,F[X]|=W&255,W>>>=8,F[X+1]=W&255,F[X+2]=W>>>8,Y+16}function je(F,Y){var W=F.length,K=2*W>Y?2*W:Y+5,X=0;if(W>=Y)return F;if(Dt){var Q=JC(K);if(F.copy)F.copy(Q);else for(;X<F.length;++X)Q[X]=F[X];return Q}else if(D){var be=new Uint8Array(K);if(be.set)be.set(F);else for(;X<W;++X)be[X]=F[X];return be}return F.length=K,F}function $e(F){for(var Y=new Array(F),W=0;W<F;++W)Y[W]=0;return Y}function Ae(F,Y,W){var K=1,X=0,Q=0,be=0,Ie=0,ye=F.length,_e=D?new Uint16Array(32):$e(32);for(Q=0;Q<32;++Q)_e[Q]=0;for(Q=ye;Q<W;++Q)F[Q]=0;ye=F.length;var Se=D?new Uint16Array(ye):$e(ye);for(Q=0;Q<ye;++Q)_e[X=F[Q]]++,K<X&&(K=X),Se[Q]=0;for(_e[0]=0,Q=1;Q<=K;++Q)_e[Q+16]=Ie=Ie+_e[Q-1]<<1;for(Q=0;Q<ye;++Q)Ie=F[Q],Ie!=0&&(Se[Q]=_e[Ie+16]++);var Ge=0;for(Q=0;Q<ye;++Q)if(Ge=F[Q],Ge!=0)for(Ie=te(Se[Q],K)>>K-Ge,be=(1<<K+4-Ge)-1;be>=0;--be)Y[Ie|be<<Ge]=Ge&15|Q<<4;return K}var xt=D?new Uint16Array(512):$e(512),he=D?new Uint16Array(32):$e(32);if(!D){for(var De=0;De<512;++De)xt[De]=0;for(De=0;De<32;++De)he[De]=0}(function(){for(var F=[],Y=0;Y<32;Y++)F.push(5);Ae(F,he,32);var W=[];for(Y=0;Y<=143;Y++)W.push(8);for(;Y<=255;Y++)W.push(9);for(;Y<=279;Y++)W.push(7);for(;Y<=287;Y++)W.push(8);Ae(W,xt,288)})();var et=(function(){for(var Y=D?new Uint8Array(32768):[],W=0,K=0;W<fe.length-1;++W)for(;K<fe[W+1];++K)Y[K]=W;for(;K<32768;++K)Y[K]=29;var X=D?new Uint8Array(259):[];for(W=0,K=0;W<Oe.length-1;++W)for(;K<Oe[W+1];++K)X[K]=W;function Q(Ie,ye){for(var _e=0;_e<Ie.length;){var Se=Math.min(65535,Ie.length-_e),Ge=_e+Se==Ie.length;for(ye.write_shift(1,+Ge),ye.write_shift(2,Se),ye.write_shift(2,~Se&65535);Se-- >0;)ye[ye.l++]=Ie[_e++]}return ye.l}function be(Ie,ye){for(var _e=0,Se=0,Ge=D?new Uint16Array(32768):[];Se<Ie.length;){var Je=Math.min(65535,Ie.length-Se);if(Je<10){for(_e=pe(ye,_e,+(Se+Je==Ie.length)),_e&7&&(_e+=8-(_e&7)),ye.l=_e/8|0,ye.write_shift(2,Je),ye.write_shift(2,~Je&65535);Je-- >0;)ye[ye.l++]=Ie[Se++];_e=ye.l*8;continue}_e=pe(ye,_e,+(Se+Je==Ie.length)+2);for(var rt=0;Je-- >0;){var Xe=Ie[Se];rt=(rt<<5^Xe)&32767;var Ue=-1,gt=0;if((Ue=Ge[rt])&&(Ue|=Se&-32768,Ue>Se&&(Ue-=32768),Ue<Se))for(;Ie[Ue+gt]==Ie[Se+gt]&&gt<250;)++gt;if(gt>2){Xe=X[gt],Xe<=22?_e=Pe(ye,_e,z[Xe+1]>>1)-1:(Pe(ye,_e,3),_e+=5,Pe(ye,_e,z[Xe-23]>>5),_e+=3);var $t=Xe<8?0:Xe-4>>2;$t>0&&(We(ye,_e,gt-Oe[Xe]),_e+=$t),Xe=Y[Se-Ue],_e=Pe(ye,_e,z[Xe]>>3),_e-=3;var Vt=Xe<4?0:Xe-2>>1;Vt>0&&(We(ye,_e,Se-Ue-fe[Xe]),_e+=Vt);for(var wr=0;wr<gt;++wr)Ge[rt]=Se&32767,rt=(rt<<5^Ie[Se])&32767,++Se;Je-=gt-1}else Xe<=143?Xe=Xe+48:_e=Fe(ye,_e,1),_e=Pe(ye,_e,z[Xe]),Ge[rt]=Se&32767,++Se}_e=Pe(ye,_e,0)-1}return ye.l=(_e+7)/8|0,ye.l}return function(ye,_e){return ye.length<8?Q(ye,_e):be(ye,_e)}})();function Qe(F){var Y=we(50+Math.floor(F.length*1.1)),W=et(F,Y);return Y.slice(0,W)}var Ve=D?new Uint16Array(32768):$e(32768),Ke=D?new Uint16Array(32768):$e(32768),wt=D?new Uint16Array(128):$e(128),_t=1,St=1;function It(F,Y){var W=xe(F,Y)+257;Y+=5;var K=xe(F,Y)+1;Y+=5;var X=me(F,Y)+4;Y+=4;for(var Q=0,be=D?new Uint8Array(19):$e(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,_e=D?new Uint8Array(8):$e(8),Se=D?new Uint8Array(8):$e(8),Ge=be.length,Je=0;Je<X;++Je)be[ge[Je]]=Q=Ee(F,Y),ye<Q&&(ye=Q),_e[Q]++,Y+=3;var rt=0;for(_e[0]=0,Je=1;Je<=ye;++Je)Se[Je]=rt=rt+_e[Je-1]<<1;for(Je=0;Je<Ge;++Je)(rt=be[Je])!=0&&(Ie[Je]=Se[rt]++);var Xe=0;for(Je=0;Je<Ge;++Je)if(Xe=be[Je],Xe!=0){rt=z[Ie[Je]]>>8-Xe;for(var Ue=(1<<7-Xe)-1;Ue>=0;--Ue)wt[rt|Ue<<Xe]=Xe&7|Je<<3}var gt=[];for(ye=1;gt.length<W+K;)switch(rt=wt[Ce(F,Y)],Y+=rt&7,rt>>>=3){case 16:for(Q=3+Re(F,Y),Y+=2,rt=gt[gt.length-1];Q-- >0;)gt.push(rt);break;case 17:for(Q=3+Ee(F,Y),Y+=3;Q-- >0;)gt.push(0);break;case 18:for(Q=11+Ce(F,Y),Y+=7;Q-- >0;)gt.push(0);break;default:gt.push(rt),ye<rt&&(ye=rt);break}var $t=gt.slice(0,W),Vt=gt.slice(W);for(Je=W;Je<286;++Je)$t[Je]=0;for(Je=K;Je<30;++Je)Vt[Je]=0;return _t=Ae($t,Ve,286),St=Ae(Vt,Ke,30),Y}function lr(F,Y){if(F[0]==3&&!(F[1]&3))return[Xo(Y),2];for(var W=0,K=0,X=JC(Y||1<<18),Q=0,be=X.length>>>0,Ie=0,ye=0;(K&1)==0;){if(K=Ee(F,W),W+=3,K>>>1)K>>1==1?(Ie=9,ye=5):(W=It(F,W),Ie=_t,ye=St);else{W&7&&(W+=8-(W&7));var _e=F[W>>>3]|F[(W>>>3)+1]<<8;if(W+=32,_e>0)for(!Y&&be<Q+_e&&(X=je(X,Q+_e),be=X.length);_e-- >0;)X[Q++]=F[W>>>3],W+=8;continue}for(;;){!Y&&be<Q+32767&&(X=je(X,Q+32767),be=X.length);var Se=Le(F,W,Ie),Ge=K>>>1==1?xt[Se]:Ve[Se];if(W+=Ge&15,Ge>>>=4,(Ge>>>8&255)===0)X[Q++]=Ge;else{if(Ge==256)break;Ge-=257;var Je=Ge<8?0:Ge-4>>2;Je>5&&(Je=0);var rt=Q+Oe[Ge];Je>0&&(rt+=Le(F,W,Je),W+=Je),Se=Le(F,W,ye),Ge=K>>>1==1?he[Se]:Ke[Se],W+=Ge&15,Ge>>>=4;var Xe=Ge<4?0:Ge-2>>1,Ue=fe[Ge];for(Xe>0&&(Ue+=Le(F,W,Xe),W+=Xe),!Y&&be<rt&&(X=je(X,rt+100),be=X.length);Q<rt;)X[Q]=X[Q-Ue],++Q}}}return Y?[X,W+7>>>3]:[X.slice(0,Q),W+7>>>3]}function Tr(F,Y){var W=F.slice(F.l||0),K=lr(W,Y);return F.l+=K[1],K[0]}function pr(F,Y){if(F)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function cr(F,Y){var W=F;Ln(W,0);var K=[],X=[],Q={FileIndex:K,FullPaths:X};P(Q,{root:Y.root});for(var be=W.length-4;(W[be]!=80||W[be+1]!=75||W[be+2]!=5||W[be+3]!=6)&&be>=0;)--be;W.l=be+4,W.l+=4;var Ie=W.read_shift(2);W.l+=6;var ye=W.read_shift(4);for(W.l=ye,be=0;be<Ie;++be){W.l+=20;var _e=W.read_shift(4),Se=W.read_shift(4),Ge=W.read_shift(2),Je=W.read_shift(2),rt=W.read_shift(2);W.l+=8;var Xe=W.read_shift(4),Ue=l(W.slice(W.l+Ge,W.l+Ge+Je));W.l+=Ge+Je+rt;var gt=W.l;W.l=Xe+4,Ue&&Ue[1]&&((Ue[1]||{}).usz&&(Se=Ue[1].usz),(Ue[1]||{}).csz&&(_e=Ue[1].csz)),yr(W,_e,Se,Q,Ue),W.l=gt}return Q}function yr(F,Y,W,K,X){F.l+=2;var Q=F.read_shift(2),be=F.read_shift(2),Ie=s(F);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var ye=F.read_shift(4),_e=F.read_shift(4),Se=F.read_shift(4),Ge=F.read_shift(2),Je=F.read_shift(2),rt="",Xe=0;Xe<Ge;++Xe)rt+=String.fromCharCode(F[F.l++]);if(Je){var Ue=l(F.slice(F.l,F.l+Je));(Ue[21589]||{}).mt&&(Ie=Ue[21589].mt),(Ue[1]||{}).usz&&(Se=Ue[1].usz),(Ue[1]||{}).csz&&(_e=Ue[1].csz),X&&((X[21589]||{}).mt&&(Ie=X[21589].mt),(X[1]||{}).usz&&(Se=X[1].usz),(X[1]||{}).csz&&(_e=X[1].csz))}F.l+=Je;var gt=F.slice(F.l,F.l+_e);switch(be){case 8:gt=ie(F,Se);break;case 0:F.l+=_e;break;default:throw new Error("Unsupported ZIP Compression method "+be)}var $t=!1;Q&8&&(ye=F.read_shift(4),ye==134695760&&(ye=F.read_shift(4),$t=!0),_e=F.read_shift(4),Se=F.read_shift(4)),_e!=Y&&pr($t,"Bad compressed size: "+Y+" != "+_e),Se!=W&&pr($t,"Bad uncompressed size: "+W+" != "+Se),Ca(K,rt,gt,{unsafe:!0,mt:Ie})}function mr(F,Y){var W=Y||{},K=[],X=[],Q=we(1),be=W.compression?8:0,Ie=0,ye=0,_e=0,Se=0,Ge=0,Je=F.FullPaths[0],rt=Je,Xe=F.FileIndex[0],Ue=[],gt=0;for(ye=1;ye<F.FullPaths.length;++ye)if(rt=F.FullPaths[ye].slice(Je.length),Xe=F.FileIndex[ye],!(!Xe.size||!Xe.content||Array.isArray(Xe.content)&&Xe.content.length==0||rt=="Sh33tJ5")){var $t=Se,Vt=we(rt.length);for(_e=0;_e<rt.length;++_e)Vt.write_shift(1,rt.charCodeAt(_e)&127);Vt=Vt.slice(0,Vt.l),Ue[Ge]=typeof Xe.content=="string"?ok.bstr(Xe.content,0):ok.buf(Xe.content,0);var wr=typeof Xe.content=="string"?mi(Xe.content):Xe.content;be==8&&(wr=de(wr)),Q=we(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Ie),Q.write_shift(2,be),Xe.mt?a(Q,Xe.mt):Q.write_shift(4,0),Q.write_shift(-4,Ue[Ge]),Q.write_shift(4,wr.length),Q.write_shift(4,Xe.content.length),Q.write_shift(2,Vt.length),Q.write_shift(2,0),Se+=Q.length,K.push(Q),Se+=Vt.length,K.push(Vt),Se+=wr.length,K.push(wr),Q=we(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Ie),Q.write_shift(2,be),Q.write_shift(4,0),Q.write_shift(-4,Ue[Ge]),Q.write_shift(4,wr.length),Q.write_shift(4,Xe.content.length),Q.write_shift(2,Vt.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,$t),gt+=Q.l,X.push(Q),gt+=Vt.length,X.push(Vt),++Ge}return Q=we(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,Ge),Q.write_shift(2,Ge),Q.write_shift(4,gt),Q.write_shift(4,Se),Q.write_shift(2,0),jr([jr(K),jr(X),Q])}var tn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ai(F,Y){if(F.ctype)return F.ctype;var W=F.name||"",K=W.match(/\.([^\.]+)$/);return K&&tn[K[1]]||Y&&(K=(W=Y).match(/[\.\\]([^\.\\])+$/),K&&tn[K[1]])?tn[K[1]]:"application/octet-stream"}function Hi(F){for(var Y=gh(F),W=[],K=0;K<Y.length;K+=76)W.push(Y.slice(K,K+76));return W.join(`\r
`)+`\r
`}function Ta(F){var Y=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(_e){var Se=_e.charCodeAt(0).toString(16).toUpperCase();return"="+(Se.length==1?"0"+Se:Se)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],K=Y.split(`\r
`),X=0;X<K.length;++X){var Q=K[X];if(Q.length==0){W.push("");continue}for(var be=0;be<Q.length;){var Ie=76,ye=Q.slice(be,be+Ie);ye.charAt(Ie-1)=="="?Ie--:ye.charAt(Ie-2)=="="?Ie-=2:ye.charAt(Ie-3)=="="&&(Ie-=3),ye=Q.slice(be,be+Ie),be+=Ie,be<Q.length&&(ye+="="),W.push(ye)}}return W.join(`\r
`)}function Of(F){for(var Y=[],W=0;W<F.length;++W){for(var K=F[W];W<=F.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+F[++W];Y.push(K)}for(var X=0;X<Y.length;++X)Y[X]=Y[X].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return mi(Y.join(`\r
`))}function Pc(F,Y,W){for(var K="",X="",Q="",be,Ie=0;Ie<10;++Ie){var ye=Y[Ie];if(!ye||ye.match(/^\s*$/))break;var _e=ye.match(/^([^:]*?):\s*([^\s].*)$/);if(_e)switch(_e[1].toLowerCase()){case"content-location":K=_e[2].trim();break;case"content-type":Q=_e[2].trim();break;case"content-transfer-encoding":X=_e[2].trim();break}}switch(++Ie,X.toLowerCase()){case"base64":be=mi(Xs(Y.slice(Ie).join("")));break;case"quoted-printable":be=Of(Y.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var Se=Ca(F,K.slice(W.length),be,{unsafe:!0});Q&&(Se.ctype=Q)}function Df(F,Y){if(Z(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=Y&&Y.root||"",K=(Dt&&Buffer.isBuffer(F)?F.toString("binary"):Z(F)).split(`\r
`),X=0,Q="";for(X=0;X<K.length;++X)if(Q=K[X],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),W||(W=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),Q.slice(0,W.length)!=W););var be=(K[1]||"").match(/boundary="(.*?)"/);if(!be)throw new Error("MAD cannot find boundary");var Ie="--"+(be[1]||""),ye=[],_e=[],Se={FileIndex:ye,FullPaths:_e};P(Se);var Ge,Je=0;for(X=0;X<K.length;++X){var rt=K[X];rt!==Ie&&rt!==Ie+"--"||(Je++&&Pc(Se,K.slice(Ge,X),W),Ge=X)}return Se}function oo(F,Y){var W=Y||{},K=W.boundary||"SheetJS";K="------="+K;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],Q=F.FullPaths[0],be=Q,Ie=F.FileIndex[0],ye=1;ye<F.FullPaths.length;++ye)if(be=F.FullPaths[ye].slice(Q.length),Ie=F.FileIndex[ye],!(!Ie.size||!Ie.content||be=="Sh33tJ5")){be=be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var _e=Ie.content,Se=Dt&&Buffer.isBuffer(_e)?_e.toString("binary"):Z(_e),Ge=0,Je=Math.min(1024,Se.length),rt=0,Xe=0;Xe<=Je;++Xe)(rt=Se.charCodeAt(Xe))>=32&&rt<128&&++Ge;var Ue=Ge>=Je*4/5;X.push(K),X.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+be),X.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),X.push("Content-Type: "+ai(Ie,be)),X.push(""),X.push(Ue?Ta(Se):Hi(Se))}return X.push(K+`--\r
`),X.join(`\r
`)}function jc(F){var Y={};return P(Y,F),Y}function Ca(F,Y,W,K){var X=K&&K.unsafe;X||P(F);var Q=!X&&Wt.find(F,Y);if(!Q){var be=F.FullPaths[0];Y.slice(0,be.length)==be?be=Y:(be.slice(-1)!="/"&&(be+="/"),be=(be+Y).replace("//","/")),Q={name:i(Y),type:2},F.FileIndex.push(Q),F.FullPaths.push(be),X||Wt.utils.cfb_gc(F)}return Q.content=W,Q.size=W?W.length:0,K&&(K.CLSID&&(Q.clsid=K.CLSID),K.mt&&(Q.mt=K.mt),K.ct&&(Q.ct=K.ct)),Q}function Fp(F,Y){P(F);var W=Wt.find(F,Y);if(W){for(var K=0;K<F.FileIndex.length;++K)if(F.FileIndex[K]==W)return F.FileIndex.splice(K,1),F.FullPaths.splice(K,1),!0}return!1}function lo(F,Y,W){P(F);var K=Wt.find(F,Y);if(K){for(var X=0;X<F.FileIndex.length;++X)if(F.FileIndex[X]==K)return F.FileIndex[X].name=i(W),F.FullPaths[X]=W,!0}return!1}function ol(F){L(F,!0)}return t.find=R,t.read=j,t.parse=d,t.write=se,t.writeFile=re,t.utils={cfb_new:jc,cfb_add:Ca,cfb_del:Fp,cfb_mov:lo,cfb_gc:ol,ReadShift:Ru,CheckField:K3,prep_blob:Ln,bconcat:jr,use_zlib:ne,_deflateRaw:Qe,_inflateRaw:Tr,consts:J},t})(),FJ;function lk(e){return typeof e=="string"?Ep(e):Array.isArray(e)?lJ(e):e}function kf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ep(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ef(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([lk(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+oJ(new Uint8Array(lk(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=qo(t)),f.write(t),f.close(),t}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+e)}function Rr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ck(e,t){for(var r=[],n=Rr(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function lb(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function kp(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MJ(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var P3=Date.UTC(1899,11,30,0,0,0),LJ=Date.UTC(1899,11,31,0,0,0),BJ=Date.UTC(1904,0,1,0,0,0);function hn(e,t){var r=e.getTime(),n=(r-P3)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Gl(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+P3),t}var $J=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,UJ=/^(\d+)-(\d+)-(\d+)$/,j3=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function ii(e,t){if(e instanceof Date)return e;var r=e.match($J);if(r)return new Date((t?BJ:LJ)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(UJ),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(j3),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function cb(e,t){if(Dt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}var n=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{try{for(;i<e.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{for(;i!=e.length;++i)n.push(String.fromCharCode(e[i]))}}return n.join("")}function jn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=jn(e[r]));return t}function nr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ga(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var zJ=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,WJ=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,HJ=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,VJ=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function KJ(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function GJ(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var YJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sh(e){if(HJ.test(e))return e.indexOf("Z")==-1?Ap(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(zJ);if(n)return KJ(n);if(n=r.match(WJ),n)return GJ(n);if(n=r.match(j3),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var i=new Date(VJ&&e.indexOf("UTC")==-1?e+" UTC":e),a=new Date(NaN),s=i.getYear();i.getMonth();var l=i.getDate();if(isNaN(l))return a;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&YJ.indexOf(t)==-1)return a}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return a;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?a:i}function cc(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function Ap(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function vt(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return Dt?n=Ea(r):n=cJ(r),Wt.utils.cfb_add(e,t,n)}Wt.utils.cfb_add(e,t,r)}else e.file(t,r)}function ub(){return Wt.utils.cfb_new()}var Mr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,XJ={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fb=lb(XJ),db=/[&<>'"]/g,qJ=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function yt(e){var t=e+"";return t.replace(db,function(r){return fb[r]}).replace(qJ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function uk(e){return yt(e).replace(/ /g,"_x0020_")}var O3=/[\u0000-\u001f]/g;function gv(e){var t=e+"";return t.replace(db,function(r){return fb[r]}).replace(/\n/g,"<br/>").replace(O3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ZJ(e){var t=e+"";return t.replace(db,function(r){return fb[r]}).replace(O3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function QJ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function JJ(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function vv(e){for(var t="",r=0,n=0,i=0,a=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function fk(e){var t=Xo(2*e.length),r,n,i=1,a=0,s=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function dk(e){return Ea(e,"binary").toString("utf8")}var f0="foo bar baz",Yl=Dt&&(dk(f0)==vv(f0)&&dk||fk(f0)==vv(f0)&&fk)||vv,ef=Dt?function(e){return Ea(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},eee=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),D3=/(^\s|\s$|\n)/;function un(e,t){return"<"+e+(t.match(D3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function tf(e){return Rr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function qe(e,t,r){return"<"+e+(r!=null?tf(r):"")+(t!=null?(t.match(D3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function H1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function tee(e,t){switch(typeof e){case"string":var r=qe("vt:lpwstr",yt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return qe((e|0)==e?"vt:i4":"vt:r8",yt(String(e)));case"boolean":return qe("vt:bool",e?"true":"false")}if(e instanceof Date)return qe("vt:filetime",H1(e));throw new Error("Unable to serialize "+e)}var Qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ec=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ree(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function nee(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var l=0;l<=5;++l,a/=256)e[r+l]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var hk=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},pk=Dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ea(t)})):hk(e)}:hk,mk=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Pu(e,i)));return n.join("").replace(Du,"")},hb=Dt?function(e,t,r){return!Buffer.isBuffer(e)||!vh?mk(e,t,r):e.toString("utf16le",t,r).replace(Du,"")}:mk,xk=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},R3=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):xk(e,t,r)}:xk,gk=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Ul(e,i)));return n.join("")},Af=Dt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):gk(t,r,n)}:gk,I3=function(e,t){var r=gi(e,t);return r>0?Af(e,t+4,t+4+r-1):""},F3=I3,M3=function(e,t){var r=gi(e,t);return r>0?Af(e,t+4,t+4+r-1):""},L3=M3,B3=function(e,t){var r=2*gi(e,t);return r>0?Af(e,t+4,t+4+r-1):""},$3=B3,U3=function(t,r){var n=gi(t,r);return n>0?hb(t,r+4,r+4+n):""},z3=U3,W3=function(e,t){var r=gi(e,t);return r>0?Af(e,t+4,t+4+r):""},H3=W3,V3=function(e,t){return ree(e,t)},Nh=V3,pb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Dt&&(F3=function(t,r){if(!Buffer.isBuffer(t))return I3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},L3=function(t,r){if(!Buffer.isBuffer(t))return M3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$3=function(t,r){if(!Buffer.isBuffer(t)||!vh)return B3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},z3=function(t,r){if(!Buffer.isBuffer(t)||!vh)return U3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},H3=function(t,r){if(!Buffer.isBuffer(t))return W3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Nh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):V3(t,r)},pb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ul=function(e,t){return e[t]},Pu=function(e,t){return e[t+1]*256+e[t]},iee=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},gi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ko=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},aee=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ru(e,t){var r="",n,i,a=[],s,l,f,h;switch(t){case"dbcs":if(h=this.l,Dt&&Buffer.isBuffer(this)&&vh)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(Pu(this,h)),h+=2;e*=2;break;case"utf8":r=Af(this,this.l,this.l+e);break;case"utf16le":e*=2,r=hb(this,this.l,this.l+e);break;case"wstr":return Ru.call(this,e,"dbcs");case"lpstr-ansi":r=F3(this,this.l),e=4+gi(this,this.l);break;case"lpstr-cp":r=L3(this,this.l),e=4+gi(this,this.l);break;case"lpwstr":r=$3(this,this.l),e=4+2*gi(this,this.l);break;case"lpp4":e=4+gi(this,this.l),r=z3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+gi(this,this.l),r=H3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Ul(this,this.l+e++))!==0;)a.push(c0(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=Pu(this,this.l+e))!==0;)a.push(c0(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return s=Ul(this,h),this.l=h+1,l=Ru.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(c0(Pu(this,h))),h+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return s=Ul(this,h),this.l=h+1,l=Ru.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(c0(Ul(this,h))),h+=1}r=a.join("");break;default:switch(e){case 1:return n=Ul(this,this.l),this.l++,n;case 2:return n=(t==="i"?iee:Pu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?ko:aee)(this,this.l),this.l+=4,n):(i=gi(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Nh(this,this.l):i=Nh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=R3(this,this.l,e);break}}return this.l+=e,r}var see=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},oee=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},lee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function cee(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)lee(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,see(this,t,this.l);break;case 8:if(n=8,r==="f"){nee(this,t,this.l);break}case 16:break;case-4:n=4,oee(this,t,this.l);break}return this.l+=n,this}function K3(e,t){var r=R3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ln(e,t){e.l=t,e.read_shift=Ru,e.chk=K3,e.write_shift=cee}function Na(e,t){e.l+=t}function we(e){var t=Xo(e);return Ln(t,0),t}function kn(){var e=[],t=Dt?16384:2048;Dt&&we(t).copy;var r=function(d){var m=we(d);return Ln(m,0),m},n=r(t),i=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},a=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,t)))},s=function(){return i(),jr(e)},l=function(){return i(),e},f=function(d){i(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:f,end:s,_bufs:e,end2:l}}function Me(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=xse[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&pb(r)&&e.push(r)}}function Iu(e,t,r){var n=jn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vk(e,t,r){var n=jn(e);return n.s=Iu(n.s,t.s,r),n.e=Iu(n.e,t.s,r),n}function Fu(e,t){if(e.cRel&&e.c<0)for(e=jn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=jn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=dr(e);return!e.cRel&&e.cRel!=null&&(r=dee(r)),!e.rRel&&e.rRel!=null&&(r=uee(r)),r}function yv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Bt(e.s.c)+":"+(e.e.cRel?"":"$")+Bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+zt(e.s.r)+":"+(e.e.rRel?"":"$")+zt(e.e.r):Fu(e.s,t.biff)+":"+Fu(e.e,t.biff)}function mb(e){return parseInt(fee(e),10)-1}function zt(e){return""+(e+1)}function uee(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function fee(e){return e.replace(/\$(\d+)$/,"$1")}function xb(e){for(var t=hee(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function dee(e){return e.replace(/^([A-Z])/,"$$$1")}function hee(e){return e.replace(/^\$([A-Z])/,"$1")}function pee(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ar(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function dr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fn(e){var t=e.indexOf(":");return t==-1?{s:ar(e),e:ar(e)}:{s:ar(e.slice(0,t)),e:ar(e.slice(t+1))}}function Ir(e,t){return typeof t>"u"||typeof t=="number"?Ir(e.s,e.e):(typeof e!="string"&&(e=dr(e)),typeof t!="string"&&(t=dr(t)),e==t?e:e+":"+t)}function rf(e){var t=fn(e);return"$"+Bt(t.s.c)+"$"+zt(t.s.r)+":$"+Bt(t.e.c)+"$"+zt(t.e.r)}function nf(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function yk(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=rs(e.z,r?hn(t):t)}catch{}try{return e.w=rs((e.XF||{}).numFmtId||(r?14:0),r?hn(t):t)}catch{return""+t}}function ns(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Wn[e.v]||e.v:t==null?yk(e,e.v):yk(e,t))}function Tc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function mee(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function G3(e,t,r){var n=r||{},i=e?e["!data"]!=null:n.dense,a=e||(i?{"!data":[]}:{});i&&!a["!data"]&&(a["!data"]=[]);var s=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?ar(n.origin):n.origin;s=f.r,l=f.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Jt(a["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),s==-1&&(h.e.r=s=a["!ref"]?d.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var m=[],x=!1,g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");var _=s+g;i&&(a["!data"][_]||(a["!data"][_]=[]),m=a["!data"][_]);for(var w=t[g],b=0;b!=w.length;++b)if(!(typeof w[b]>"u")){var S={v:w[b],t:""},T=l+b;if(h.s.r>_&&(h.s.r=_),h.s.c>T&&(h.s.c=T),h.e.r<_&&(h.e.r=_),h.e.c<T&&(h.e.c=T),x=!0,w[b]&&typeof w[b]=="object"&&!Array.isArray(w[b])&&!(w[b]instanceof Date))S=w[b];else if(Array.isArray(S.v)&&(S.f=w[b][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?isFinite(S.v)?S.t="n":isNaN(S.v)?(S.t="e",S.v=15):(S.t="e",S.v=7):typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||Qt[14],n.UTC||(S.v=Ap(S.v)),n.cellDates?(S.t="d",S.w=rs(S.z,hn(S.v,n.date1904))):(S.t="n",S.v=hn(S.v,n.date1904),S.w=rs(S.z,S.v))):S.t="s";if(i)m[T]&&m[T].z&&(S.z=m[T].z),m[T]=S;else{var E=Bt(T)+(_+1);a[E]&&a[E].z&&(S.z=a[E].z),a[E]=S}}}return x&&h.s.c<104e5&&(a["!ref"]=Ir(h)),a}function Cc(e,t){return G3(null,e,t)}function xee(e){return e.read_shift(4,"i")}function ia(e,t){return t||(t=we(4)),t.write_shift(4,e),t}function An(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ur(e,t){var r=!1;return t==null&&(r=!0,t=we(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function gee(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vee(e,t){return t||(t=we(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gb(e,t){var r=e.l,n=e.read_shift(1),i=An(e),a=[],s={t:i,h:i};if((n&1)!==0){for(var l=e.read_shift(4),f=0;f!=l;++f)a.push(gee(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function yee(e,t){var r=!1;return t==null&&(r=!0,t=we(15+4*e.t.length)),t.write_shift(1,0),Ur(e.t,t),r?t.slice(0,t.l):t}var wee=gb;function bee(e,t){var r=!1;return t==null&&(r=!0,t=we(23+4*e.t.length)),t.write_shift(1,1),Ur(e.t,t),t.write_shift(4,1),vee({},t),r?t.slice(0,t.l):t}function Wi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function nl(e,t){return t==null&&(t=we(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function il(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function al(e,t){return t==null&&(t=we(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var _ee=An,Y3=Ur;function Pp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function af(e,t){var r=!1;return t==null&&(r=!0,t=we(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var See=An,V1=Pp,vb=af;function yb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Nh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ko(t,0)>>2;return r?i/100:i}function X3(e,t){t==null&&(t=we(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function q3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Nee(e,t){return t||(t=we(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var sl=q3,kc=Nee;function Ac(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Qo(e,t){return(t||we(8)).write_shift(8,e,"f")}function Eee(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var h=Ree[i];h&&(t.rgb=jk(h));break;case 2:t.rgb=jk([s,l,f]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Eh(e,t){if(t||(t=we(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Tee(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Cee(e,t){t||(t=we(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Z3=2,di=3,d0=11,Th=19,h0=64,kee=65,Aee=71,Pee=4108,jee=4126,on=80,wk={1:{n:"CodePage",t:Z3},2:{n:"Category",t:on},3:{n:"PresentationFormat",t:on},4:{n:"ByteCount",t:di},5:{n:"LineCount",t:di},6:{n:"ParagraphCount",t:di},7:{n:"SlideCount",t:di},8:{n:"NoteCount",t:di},9:{n:"HiddenCount",t:di},10:{n:"MultimediaClipCount",t:di},11:{n:"ScaleCrop",t:d0},12:{n:"HeadingPairs",t:Pee},13:{n:"TitlesOfParts",t:jee},14:{n:"Manager",t:on},15:{n:"Company",t:on},16:{n:"LinksUpToDate",t:d0},17:{n:"CharacterCount",t:di},19:{n:"SharedDoc",t:d0},22:{n:"HyperlinksChanged",t:d0},23:{n:"AppVersion",t:di,p:"version"},24:{n:"DigSig",t:kee},26:{n:"ContentType",t:on},27:{n:"ContentStatus",t:on},28:{n:"Language",t:on},29:{n:"Version",t:on},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},bk={1:{n:"CodePage",t:Z3},2:{n:"Title",t:on},3:{n:"Subject",t:on},4:{n:"Author",t:on},5:{n:"Keywords",t:on},6:{n:"Comments",t:on},7:{n:"Template",t:on},8:{n:"LastAuthor",t:on},9:{n:"RevNumber",t:on},10:{n:"EditTime",t:h0},11:{n:"LastPrinted",t:h0},12:{n:"CreatedDate",t:h0},13:{n:"ModifiedDate",t:h0},14:{n:"PageCount",t:di},15:{n:"WordCount",t:di},16:{n:"CharCount",t:di},17:{n:"Thumbnail",t:Aee},18:{n:"Application",t:on},19:{n:"DocSecurity",t:di},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}};function Oee(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Dee=Oee([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ree=jn(Dee),Wn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ya={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Iee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Fee={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},p0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Q3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function J3(e,t,r){var n=MJ(Fee),i=[],a;i[i.length]=Mr,i[i.length]=qe("Types",null,{xmlns:Qr.CT,"xmlns:xsd":Qr.xsd,"xmlns:xsi":Qr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return qe("Default",null,{Extension:h[0],ContentType:h[1]})}));var s=function(h){e[h]&&e[h].length>0&&(a=e[h][0],i[i.length]=qe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:p0[h][t.bookType]||p0[h].xlsx}))},l=function(h){(e[h]||[]).forEach(function(d){i[i.length]=qe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:p0[h][t.bookType]||p0[h].xlsx})})},f=function(h){(e[h]||[]).forEach(function(d){i[i.length]=qe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[h][0]})})};return s("workbooks"),l("sheets"),l("charts"),f("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),l("metadata"),f("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Et={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function e5(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Xl(e){var t=[Mr,qe("Relationships",null,{xmlns:Qr.RELS})];return Rr(e["!id"]).forEach(function(r){t[t.length]=qe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Et.HLINK,Et.XPATH,Et.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Mee(e){var t=[Mr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function _k(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Lee(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Bee(e){var t=[Mr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(_k(e[r][0],e[r][1])),t.push(Lee("",e[r][0]));return t.push(_k("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function t5(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xh.version+"</meta:generator></office:meta></office:document-meta>"}var Fo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function wv(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=yt(t),n[n.length]=r?qe(e,t,r):un(e,t))}function r5(e,t){var r=t||{},n=[Mr,qe("cp:coreProperties",null,{"xmlns:cp":Qr.CORE_PROPS,"xmlns:dc":Qr.dc,"xmlns:dcterms":Qr.dcterms,"xmlns:dcmitype":Qr.dcmitype,"xmlns:xsi":Qr.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&wv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:H1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&wv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:H1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Fo.length;++a){var s=Fo[a],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&wv(s[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ql=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],n5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function i5(e){var t=[],r=qe;return e||(e={}),e.Application="SheetJS",t[t.length]=Mr,t[t.length]=qe("Properties",null,{xmlns:Qr.EXT_PROPS,"xmlns:vt":Qr.vt}),ql.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=yt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+yt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function a5(e){var t=[Mr,qe("Properties",null,{xmlns:Qr.CUST_PROPS,"xmlns:vt":Qr.vt})];if(!e)return t.join("");var r=1;return Rr(e).forEach(function(i){++r,t[t.length]=qe("property",tee(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function $ee(e,t){var r=[];return Rr(Sk).map(function(n){for(var i=0;i<Fo.length;++i)if(Fo[i][1]==n)return Fo[i];for(i=0;i<ql.length;++i)if(ql[i][1]==n)return ql[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(un(Sk[n[1]]||n[1],i))}}),qe("DocumentProperties",r.join(""),{xmlns:xi.o})}function Uee(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Rr(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var s=0;s<Fo.length;++s)if(a==Fo[s][1])return;for(s=0;s<ql.length;++s)if(a==ql[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var l=e[a],f="string";typeof l=="number"?(f="float",l=String(l)):l===!0||l===!1?(f="boolean",l=l?"1":"0"):l=String(l),i.push(qe(uk(a),l,{"dt:dt":f}))}}),t&&Rr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var s=t[a],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),i.push(qe(uk(a),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+xi.o+'">'+i.join("")+"</"+n+">"}function zee(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=we(8);return s.write_shift(4,n),s.write_shift(4,i),s}function Nk(e,t){var r=we(4),n=we(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=we(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=zee(t);break;case 31:case 80:for(n=we(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return jr([r,n])}var s5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Wee(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ek(e,t,r){var n=we(8),i=[],a=[],s=8,l=0,f=we(8),h=we(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),a.push(f),i.push(h),s+=8+f.length,!t){h=we(8),h.write_shift(4,0),i.unshift(h);var d=[we(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var m=e[l][0];for(f=we(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,l+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);d.push(f)}f=jr(d),a.unshift(f),s+=8+f.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(s5.indexOf(e[l][0])>-1||n5.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],g=0;if(t){g=+t[e[l][0]];var _=r[g];if(_.p=="version"&&typeof x=="string"){var w=x.split(".");x=(+w[0]<<16)+(+w[1]||0)}f=Nk(_.t,x)}else{var b=Wee(x);b==-1&&(b=31,x=String(x)),f=Nk(b,x)}a.push(f),h=we(8),h.write_shift(4,t?g:2+l),i.push(h),s+=8+f.length}var S=8*(a.length+1);for(l=0;l<a.length;++l)i[l].write_shift(4,S),S+=a[l].length;return n.write_shift(4,s),n.write_shift(4,a.length),jr([n].concat(i).concat(a))}function Tk(e,t,r,n,i,a){var s=we(i?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Wt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var f=Ek(e,r,n);if(l.push(f),i){var h=Ek(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+f.length),l.push(h)}return jr(l)}function Hee(e,t){t||(t=we(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Vee(e,t){return e.read_shift(t)===1}function Nn(e,t){return t||(t=we(2)),t.write_shift(2,+!!e),t}function N0(e){return e.read_shift(2,"u")}function Ii(e,t){return t||(t=we(2)),t.write_shift(2,e),t}function o5(e,t,r){return r||(r=we(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function l5(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",a=$a;if(r&&r.biff>=8&&($a=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return $a=a,l}function Kee(e){var t=e.t||"",r=we(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=we(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return jr(i)}function Gee(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Yee(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Gee(e,n,r)}function Xee(e,t,r){if(r.biff>5)return Yee(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function c5(e,t,r){return r||(r=we(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Ck(e,t){t||(t=we(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function qee(e){var t=we(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(a==28)n=n.slice(1),Ck(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),a&8&&Ck(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Jo(e,t,r,n){return n||(n=we(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Zee(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function Qee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function u5(e,t){return t||(t=we(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function wb(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=we(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Jee(e,t){var r=!t||t.biff==8,n=we(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ete(e,t){var r=!t||t.biff>=8?2:1,n=we(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function tte(e,t){var r=we(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=Kee(e[i]);var a=jr([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function rte(){var e=we(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nte(e){var t=we(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ite(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=we(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function ate(e,t,r,n){var i=we(10);return Jo(e,t,n,i),i.write_shift(4,r),i}function ste(e,t,r,n,i){var a=!i||i.biff==8,s=we(8+ +a+(1+a)*r.length);return Jo(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function ote(e,t,r,n){var i=r&&r.biff==5;n||(n=we(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function lte(e){var t=we(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function cte(e){var t=we(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function ute(e,t){var r=t.biff==8||!t.biff?4:2,n=we(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function kk(e,t,r,n){var i=r&&r.biff==5;n||(n=we(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function fte(e){var t=we(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function f5(e){var t=we(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var dte=f5;function hte(e){var t=we(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function bv(e,t,r,n,i,a){var s=we(8);return Jo(e,t,n,s),o5(r,a,s),s}function pte(e,t,r,n){var i=we(14);return Jo(e,t,n,i),Qo(r,i),i}function mte(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return Ak(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Zee(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Ak(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=l5(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _v(e,t,r,n){var i=we(6+(n||e.length));return i.write_shift(2,t),i.write_shift(2,r),i.write_shift(2,n||e.length),i.write_shift(e.length,e,"sbcs"),i}function xte(e){var t=we(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)u5(e[r],t);return t}function gte(e){var t=we(24),r=ar(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return jr([t,qee(e[1])])}function vte(e){var t=e[1].Tooltip,r=we(10+2*(t.length+1));r.write_shift(2,2048);var n=ar(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function yte(e){return e||(e=we(4)),e.write_shift(2,1),e.write_shift(2,1),e}function wte(e,t,r){if(!r.cellStyles)return Na(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var h={s:i,e:a,w:s,ixfe:l,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function bte(e,t){var r=we(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function _te(e){for(var t=we(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Pf(e,t,r,n,i){return e||(e=we(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,i||0),e.write_shift(1,0),e}function Ste(e,t,r,n,i){var a=we(15);return Pf(a,e,t,n||0,i||0),a.write_shift(8,r,"f"),a}function Nte(e,t,r,n,i){var a=we(9);return Pf(a,e,t,n||0,i||0),a.write_shift(2,r),a}var Ete=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,f){var h=[],d=Xo(1);switch(f.type){case"base64":d=mi(Xs(l));break;case"binary":d=mi(l);break;case"buffer":case"array":d=l;break}Ln(d,0);var m=d.read_shift(1),x=!!(m&136),g=!1,_=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var w=0,b=521;m==2&&(w=d.read_shift(2)),d.l+=3,m!=2&&(w=d.read_shift(4)),w>1048576&&(w=1e6),m!=2&&(b=d.read_shift(2));var S=d.read_shift(2);f.codepage,m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&e[d[d.l]],d.l+=1,d.l+=2),_&&(d.l+=36);for(var T=[],E={},A=Math.min(d.length,m==2?521:b-10-(g?264:0)),k=_?32:11;d.l<A&&d[d.l]!=13;)switch(E={},E.name=qo(d.slice(d.l,d.l+k)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=k,E.type=String.fromCharCode(d.read_shift(1)),m!=2&&!_&&(E.offset=d.read_shift(4)),E.len=d.read_shift(1),m==2&&(E.offset=d.read_shift(2)),E.dec=d.read_shift(1),E.name.length&&T.push(E),m!=2&&(d.l+=_?13:14),E.type){case"B":(!g||E.len!=8)&&f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var j=0,P=0;for(h[0]=[],P=0;P!=T.length;++P)h[0][P]=T[P].name;for(;w-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,h[++j]=[],P=0,P=0;P!=T.length;++P){var M=d.slice(d.l,d.l+T[P].len);d.l+=T[P].len,Ln(M,0);var L=qo(M);switch(T[P].type){case"C":L.trim().length&&(h[j][P]=L.replace(/([^\s])\s+$/,"$1"));break;case"D":L.length===8?(h[j][P]=new Date(Date.UTC(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8),0,0,0,0)),f&&f.UTC||(h[j][P]=cc(h[j][P]))):h[j][P]=L;break;case"F":h[j][P]=parseFloat(L.trim());break;case"+":case"I":h[j][P]=_?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":h[j][P]=!0;break;case"N":case"F":h[j][P]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[j][P]="##MEMO##"+(_?parseInt(L.trim(),10):M.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(h[j][P]=+L||0);break;case"@":h[j][P]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":{var B=M.read_shift(4),R=M.read_shift(4);if(B==0&&R==0)break;h[j][P]=new Date((B-2440588)*864e5+R),f&&f.UTC||(h[j][P]=cc(h[j][P]))}break;case"Y":h[j][P]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[j][P]=-M.read_shift(-8,"f");break;case"B":if(g&&T[P].len==8){h[j][P]=M.read_shift(8,"f");break}case"G":case"P":M.l+=T[P].len;break;case"0":if(T[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[P].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=T,h}function n(l,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var d=Cc(r(l,h),h);return d["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,d}function i(l,f){try{var h=Tc(n(l,f),f);return h.bookType="dbf",h}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,f){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=f||{},d=$a;if(+h.codepage>=0&&Ju(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=kn(),x=X1(l,{header:1,raw:!0,cellDates:!0}),g=x[0],_=x.slice(1),w=l["!cols"]||[],b=0,S=0,T=0,E=1;for(b=0;b<g.length;++b){if(((w[b]||{}).DBF||{}).name){g[b]=w[b].DBF.name,++T;continue}if(g[b]!=null){if(++T,typeof g[b]=="number"&&(g[b]=g[b].toString(10)),typeof g[b]!="string")throw new Error("DBF Invalid column name "+g[b]+" |"+typeof g[b]+"|");if(g.indexOf(g[b])!==b){for(S=0;S<1024;++S)if(g.indexOf(g[b]+"_"+S)==-1){g[b]+="_"+S;break}}}}var A=Jt(l["!ref"]),k=[],j=[],P=[];for(b=0;b<=A.e.c-A.s.c;++b){var M="",L="",B=0,R=[];for(S=0;S<_.length;++S)_[S][b]!=null&&R.push(_[S][b]);if(R.length==0||g[b]==null){k[b]="?";continue}for(S=0;S<R.length;++S){switch(typeof R[S]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=R[S]instanceof Date?"D":"C";break;default:L="C"}B=Math.max(B,String(R[S]).length),M=M&&M!=L?"C":L}B>250&&(B=250),L=((w[b]||{}).DBF||{}).type,L=="C"&&w[b].DBF.len>B&&(B=w[b].DBF.len),M=="B"&&L=="N"&&(M="N",P[b]=w[b].DBF.dec,B=w[b].DBF.len),j[b]=M=="C"||L=="N"?B:a[M]||0,E+=j[b],k[b]=M}var U=m.next(32);for(U.write_shift(4,318902576),U.write_shift(4,_.length),U.write_shift(2,296+32*T),U.write_shift(2,E),b=0;b<4;++b)U.write_shift(4,0);var oe=+t[$a]||3;for(U.write_shift(4,0|oe<<8),e[oe]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+$a+", using 1252"),$a=1252),b=0,S=0;b<g.length;++b)if(g[b]!=null){var V=m.next(32),ae=(g[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ae,"sbcs"),V.write_shift(1,k[b]=="?"?"C":k[b],"sbcs"),V.write_shift(4,S),V.write_shift(1,j[b]||a[k[b]]||0),V.write_shift(1,P[b]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),S+=j[b]||a[k[b]]||0}var le=m.next(264);for(le.write_shift(4,13),b=0;b<65;++b)le.write_shift(4,0);for(b=0;b<_.length;++b){var J=m.next(E);for(J.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(k[S]){case"L":J.write_shift(1,_[b][S]==null?63:_[b][S]?84:70);break;case"B":J.write_shift(8,_[b][S]||0,"f");break;case"N":var re="0";for(typeof _[b][S]=="number"&&(re=_[b][S].toFixed(P[S]||0)),re.length>j[S]&&(re=re.slice(0,j[S])),T=0;T<j[S]-re.length;++T)J.write_shift(1,32);J.write_shift(1,re,"sbcs");break;case"D":_[b][S]?(J.write_shift(4,("0000"+_[b][S].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(_[b][S].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+_[b][S].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var Z=J.l,se=String(_[b][S]!=null?_[b][S]:"").slice(0,j[S]);for(J.write_shift(1,se,"cpstr"),Z+=j[S]-J.l,T=0;T<Z;++T)J.write_shift(1,32);break}}return $a=d,m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}})(),Tte=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+Rr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(g,_){var w=e[_];return typeof w=="number"?QC(w):w},n=function(g,_,w){var b=_.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?g:QC(b)};e["|"]=254;var i=function(g){return g.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function a(g,_){switch(_.type){case"base64":return s(Xs(g),_);case"binary":return s(g,_);case"buffer":return s(Dt&&Buffer.isBuffer(g)?g.toString("binary"):qo(g),_);case"array":return s(cb(g),_)}throw new Error("Unrecognized type "+_.type)}function s(g,_){var w=g.split(/[\n\r]+/),b=-1,S=-1,T=0,E=0,A=[],k=[],j=null,P={},M=[],L=[],B=[],R=0,U,oe={Workbook:{WBProps:{},Names:[]}};for(+_.codepage>=0&&Ju(+_.codepage);T!==w.length;++T){R=0;var V=w[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ae=V.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),le=ae[0],J;if(V.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":for(E=1;E<ae.length;++E)switch(ae[E].charAt(0)){case"V":{var re=parseInt(ae[E].slice(1),10);re>=1&&re<=4&&(oe.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(ae[1].charAt(0)){case"P":k.push(V.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Z={Sheet:0};for(E=1;E<ae.length;++E)switch(ae[E].charAt(0)){case"N":Z.Name=ae[E].slice(1);break;case"E":Z.Ref=(_&&_.sheet||"Sheet1")+"!"+Rk(ae[E].slice(1));break}oe.Workbook.Names.push(Z)}break;case"C":var se=!1,G=!1,ne=!1,ie=!1,de=-1,ge=-1,Oe="",fe="z",O="";for(E=1;E<ae.length;++E)switch(ae[E].charAt(0)){case"A":O=ae[E].slice(1);break;case"X":S=parseInt(ae[E].slice(1),10)-1,G=!0;break;case"Y":for(b=parseInt(ae[E].slice(1),10)-1,G||(S=0),U=A.length;U<=b;++U)A[U]=[];break;case"K":J=ae[E].slice(1),J.charAt(0)==='"'?(J=J.slice(1,J.length-1),fe="s"):J==="TRUE"||J==="FALSE"?(J=J==="TRUE",fe="b"):J.charAt(0)=="#"&&ya[J]!=null?(fe="e",J=ya[J]):isNaN(Ga(J))||(J=Ga(J),fe="n",j!==null&&Zo(j)&&_.cellDates&&(J=Gl(oe.Workbook.WBProps.date1904?J+1462:J),fe=typeof J=="number"?"n":"d")),se=!0;break;case"E":ie=!0,Oe=Rk(ae[E].slice(1),{r:b,c:S});break;case"S":ne=!0;break;case"G":break;case"R":de=parseInt(ae[E].slice(1),10)-1;break;case"C":ge=parseInt(ae[E].slice(1),10)-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+V)}if(se&&(A[b][S]?(A[b][S].t=fe,A[b][S].v=J):A[b][S]={t:fe,v:J},j&&(A[b][S].z=j),_.cellText!==!1&&j&&(A[b][S].w=rs(A[b][S].z,A[b][S].v,{date1904:oe.Workbook.WBProps.date1904})),j=null),ne){if(ie)throw new Error("SYLK shared formula cannot have own formula");var D=de>-1&&A[de][ge];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");Oe=Cre(D[1],{r:b-de,c:S-ge})}Oe&&(A[b][S]?A[b][S].f=Oe:A[b][S]={t:"n",f:Oe}),O&&(A[b][S]||(A[b][S]={t:"z"}),A[b][S].c=[{a:"SheetJSYLK",t:O}]);break;case"F":var z=0;for(E=1;E<ae.length;++E)switch(ae[E].charAt(0)){case"X":S=parseInt(ae[E].slice(1),10)-1,++z;break;case"Y":for(b=parseInt(ae[E].slice(1),10)-1,U=A.length;U<=b;++U)A[U]=[];break;case"M":R=parseInt(ae[E].slice(1),10)/20;break;case"F":break;case"G":break;case"P":j=k[parseInt(ae[E].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(B=ae[E].slice(1).split(" "),U=parseInt(B[0],10);U<=parseInt(B[1],10);++U)R=parseInt(B[2],10),L[U-1]=R===0?{hidden:!0}:{wch:R};break;case"C":S=parseInt(ae[E].slice(1),10)-1,L[S]||(L[S]={});break;case"R":b=parseInt(ae[E].slice(1),10)-1,M[b]||(M[b]={}),R>0?(M[b].hpt=R,M[b].hpx=m5(R)):R===0&&(M[b].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+V)}z<1&&(j=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+V)}}return M.length>0&&(P["!rows"]=M),L.length>0&&(P["!cols"]=L),L.forEach(function(H){bb(H)}),_&&_.sheetRows&&(A=A.slice(0,_.sheetRows)),[A,P,oe]}function l(g,_){var w=a(g,_),b=w[0],S=w[1],T=w[2],E=jn(_);E.date1904=(((T||{}).Workbook||{}).WBProps||{}).date1904;var A=Cc(b,E);Rr(S).forEach(function(j){A[j]=S[j]});var k=Tc(A,_);return Rr(T).forEach(function(j){k[j]=T[j]}),k.bookType="sylk",k}function f(g,_,w,b,S,T){var E="C;Y"+(w+1)+";X"+(b+1)+";K";switch(g.t){case"n":E+=isFinite(g.v)?g.v||0:Wn[isNaN(g.v)?36:7],g.f&&!g.F&&(E+=";E"+Op(g.f,{r:w,c:b}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||Wn[g.v]||g.v;break;case"d":E+=hn(ii(g.v,T),T);break;case"s":E+='"'+(g.v==null?"":String(g.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(g,_,w){var b="C;Y"+(_+1)+";X"+(w+1)+";A";return b+=i(g.map(function(S){return S.t}).join("")),b}function d(g,_){_.forEach(function(w,b){var S="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Ch(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=kh(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function m(g,_){_.forEach(function(w,b){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*Ah(w.hpx)+";"),S.length>2&&g.push(S+"R"+(b+1))})}function x(g,_,w){_||(_={}),_._formats=["General"];var b=["ID;PSheetJS;N;E"],S=[],T=Jt(g["!ref"]||"A1"),E,A=g["!data"]!=null,k=`\r
`,j=(((w||{}).Workbook||{}).WBProps||{}).date1904,P="General";b.push("P;PGeneral");var M=T.s.r,L=T.s.c,B=[];if(g["!ref"]){for(M=T.s.r;M<=T.e.r;++M)if(!(A&&!g["!data"][M])){for(B=[],L=T.s.c;L<=T.e.c;++L)E=A?g["!data"][M][L]:g[Bt(L)+zt(M)],!(!E||!E.c)&&B.push(h(E.c,M,L));B.length&&S.push(B.join(k))}}if(g["!ref"]){for(M=T.s.r;M<=T.e.r;++M)if(!(A&&!g["!data"][M])){for(B=[],L=T.s.c;L<=T.e.c;++L)if(E=A?g["!data"][M][L]:g[Bt(L)+zt(M)],!(!E||E.v==null&&(!E.f||E.F))){if((E.z||(E.t=="d"?Qt[14]:"General"))!=P){var R=_._formats.indexOf(E.z);R==-1&&(_._formats.push(E.z),R=_._formats.length-1,b.push("P;P"+E.z.replace(/;/g,";;"))),B.push("F;P"+R+";Y"+(M+1)+";X"+(L+1))}B.push(f(E,g,M,L,_,j))}S.push(B.join(k))}}return b.push("F;P0;DG0G8;M255"),g["!cols"]&&d(b,g["!cols"]),g["!rows"]&&m(b,g["!rows"]),g["!ref"]&&b.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" ")),b.push("O;L;D;B"+(j?";V4":"")+";K47;G100 0.001"),delete _._formats,b.join(k)+k+S.join(k)+k+"E"+k}return{to_workbook:l,from_sheet:x}})(),Cte=(function(){function e(l,f){switch(f.type){case"base64":return t(Xs(l),f);case"binary":return t(l,f);case"buffer":return t(Dt&&Buffer.isBuffer(l)?l.toString("binary"):qo(l),f);case"array":return t(cb(l),f)}throw new Error("Unrecognized type "+f.type)}function t(l,f){for(var h=l.split(`
`),d=-1,m=-1,x=0,g=[];x!==h.length;++x){if(h[x].trim()==="BOT"){g[++d]=[],m=0;continue}if(!(d<0)){var _=h[x].trim().split(","),w=_[0],b=_[1];++x;for(var S=h[x]||"";(S.match(/["]/g)||[]).length&1&&x<h.length-1;)S+=`
`+h[++x];switch(S=S.trim(),+w){case-1:if(S==="BOT"){g[++d]=[],m=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?g[d][m]=!0:S==="FALSE"?g[d][m]=!1:isNaN(Ga(b))?isNaN(Sh(b).getDate())?g[d][m]=b:(g[d][m]=ii(b),f&&f.UTC||(g[d][m]=cc(g[d][m]))):g[d][m]=Ga(b),++m;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),g[d][m++]=S!==""?S:null;break}if(S==="EOD")break}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function r(l,f){return Cc(e(l,f),f)}function n(l,f){var h=Tc(r(l,f),f);return h.bookType="dif",h}function i(l,f){return"0,"+String(l)+`\r
`+f}function a(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function s(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var f=Jt(l["!ref"]),h=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(f.e.r-f.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(f.e.c-f.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],m=f.s.r;m<=f.e.r;++m){for(var x=h?l["!data"][m]:[],g=`-1,0\r
BOT\r
`,_=f.s.c;_<=f.e.c;++_){var w=h?x&&x[_]:l[dr({r:m,c:_})];if(w==null){g+=`1,0\r
""\r
`;continue}switch(w.t){case"n":w.w!=null?g+="0,"+w.w+`\r
V`:w.v!=null?g+=i(w.v,"V"):w.f!=null&&!w.F?g+=a("="+w.f):g+=`1,0\r
""`;break;case"b":g+=w.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":g+=a(isNaN(+w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=rs(w.z||Qt[14],hn(ii(w.v)))),g+=i(w.w,"V");break;default:g+=`1,0\r
""`}g+=`\r
`}d.push(g)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),d5=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var g=m.split(`
`),_=-1,w=-1,b=0,S=[];b!==g.length;++b){var T=g[b].trim().split(":");if(T[0]==="cell"){var E=ar(T[1]);if(S.length<=E.r)for(_=S.length;_<=E.r;++_)S[_]||(S[_]=[]);switch(_=E.r,w=E.c,T[2]){case"t":S[_][w]=e(T[3]);break;case"v":S[_][w]=+T[3];break;case"vtf":var A=T[T.length-1];case"vtc":switch(T[3]){case"nl":S[_][w]=!!+T[4];break;default:S[_][w]=T[T.length-1].charAt(0)=="#"?{t:"e",v:ya[T[T.length-1]]}:+T[4];break}T[2]=="vtf"&&(S[_][w]=[S[_][w],A])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(m,x){return Cc(r(m,x),x)}function i(m,x){return Tc(n(m,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var x=[],g=[],_,w="",b=fn(m["!ref"]),S=m["!data"]!=null,T=b.s.r;T<=b.e.r;++T)for(var E=b.s.c;E<=b.e.c;++E)if(w=dr({r:T,c:E}),_=S?(m["!data"][T]||[])[E]:m[w],!(!_||_.v==null||_.t==="z")){switch(g=["cell",w,"t"],_.t){case"s":g.push(t(_.v));break;case"b":g[2]="vt"+(_.f?"f":"c"),g[3]="nl",g[4]=_.v?"1":"0",g[5]=t(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var A=hn(ii(_.v));g[2]="vtc",g[3]="nd",g[4]=""+A,g[5]=_.w||rs(_.z||Qt[14],A);break;case"n":isFinite(_.v)?_.f?(g[2]="vtf",g[3]="n",g[4]=_.v,g[5]=t(_.f)):(g[2]="v",g[3]=_.v):(g[2]="vt"+(_.f?"f":"c"),g[3]="e"+Wn[isNaN(_.v)?36:7],g[4]="0",g[5]=_.f||g[3].slice(1),g[6]="e",g[7]=g[3].slice(1));break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[a,s,l,s,h(m),f].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}})(),kte=(function(){function e(d,m,x,g,_){_.raw?m[x][g]=d:d===""||(d==="TRUE"?m[x][g]=!0:d==="FALSE"?m[x][g]=!1:isNaN(Ga(d))?isNaN(Sh(d).getDate())?d.charCodeAt(0)==35&&ya[d]!=null?m[x][g]={t:"e",v:ya[d],w:d}:m[x][g]=d:m[x][g]=ii(d):m[x][g]=Ga(d))}function t(d,m){var x=m||{},g=[];if(!d||d.length===0)return g;for(var _=d.split(/[\r\n]/),w=_.length-1;w>=0&&_[w].length===0;)--w;for(var b=10,S=0,T=0;T<=w;++T)S=_[T].indexOf(" "),S==-1?S=_[T].length:S++,b=Math.max(b,S);for(T=0;T<=w;++T){g[T]=[];var E=0;for(e(_[T].slice(0,b).trim(),g,T,E,x),E=1;E<=(_[T].length-b)/10+1;++E)e(_[T].slice(b+(E-1)*10,b+E*10).trim(),g,T,E,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var m={},x=!1,g=0,_=0;g<d.length;++g)(_=d.charCodeAt(g))==34?x=!x:!x&&_ in r&&(m[_]=(m[_]||0)+1);_=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&_.push([m[g],g]);if(!_.length){m=n;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&_.push([m[g],g])}return _.sort(function(w,b){return w[0]-b[0]||n[w[1]]-n[b[1]]}),r[_.pop()[1]]||44}function a(d,m){var x=m||{},g="",_={};x.dense&&(_["!data"]=[]);var w={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=i(d.slice(0,1024)):x&&x.FS?g=x.FS:g=i(d.slice(0,1024));var b=0,S=0,T=0,E=0,A=0,k=g.charCodeAt(0),j=!1,P=0,M=d.charCodeAt(0),L=x.dateNF!=null?OJ(x.dateNF):null;function B(){var R=d.slice(E,A);R.slice(-1)=="\r"&&(R=R.slice(0,-1));var U={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),x.cellText!==!1&&(U.w=R),R.length===0)U.t="z";else if(x.raw)U.t="s",U.v=R;else if(R.trim().length===0)U.t="s",U.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(U.t="s",U.v=R.slice(2,-1).replace(/""/g,'"')):kre(R)?(U.t="s",U.f=R.slice(1),U.v=R):(U.t="s",U.v=R);else if(R=="TRUE")U.t="b",U.v=!0;else if(R=="FALSE")U.t="b",U.v=!1;else if(!isNaN(T=Ga(R)))U.t="n",U.v=T;else if(!isNaN((T=Sh(R)).getDate())||L&&R.match(L)){if(U.z=x.dateNF||Qt[14],L&&R.match(L)){var oe=DJ(R,x.dateNF,R.match(L)||[]);T=ii(oe),x&&x.UTC===!1&&(T=cc(T))}else x&&x.UTC===!1?T=cc(T):x.cellText!==!1&&x.dateNF&&(U.w=rs(U.z,T));x.cellDates?(U.t="d",U.v=T):(U.t="n",U.v=hn(T)),x.cellNF||delete U.z}else R.charCodeAt(0)==35&&ya[R]!=null?(U.t="e",U.w=R,U.v=ya[R]):(U.t="s",U.v=R);if(U.t=="z"||(x.dense?(_["!data"][b]||(_["!data"][b]=[]),_["!data"][b][S]=U):_[dr({c:S,r:b})]=U),E=A+1,M=d.charCodeAt(E),w.e.c<S&&(w.e.c=S),w.e.r<b&&(w.e.r=b),P==k)++S;else if(S=0,++b,x.sheetRows&&x.sheetRows<=b)return!0}e:for(;A<d.length;++A)switch(P=d.charCodeAt(A)){case 34:M===34&&(j=!j);break;case 13:if(j)break;d.charCodeAt(A+1)==10&&++A;case k:case 10:if(!j&&B())break e;break}return A-E>0&&B(),_["!ref"]=Ir(w),_}function s(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,m):Cc(t(d,m),m)}function l(d,m){var x="",g=m.type=="string"?[0,0,0,0]:toe(d,m);switch(m.type){case"base64":x=Xs(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):(m.codepage,x=Dt&&Buffer.isBuffer(d)?d.toString("binary"):qo(d));break;case"array":x=cb(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=Yl(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=Yl(x):m.type=="binary",x.slice(0,19)=="socialcalc:version:"?d5.to_sheet(m.type=="string"?x:Yl(x),m):s(x,m)}function f(d,m){return Tc(l(d,m),m)}function h(d){var m=[];if(!d["!ref"])return"";for(var x=Jt(d["!ref"]),g,_=d["!data"]!=null,w=x.s.r;w<=x.e.r;++w){for(var b=[],S=x.s.c;S<=x.e.c;++S){var T=dr({r:w,c:S});if(g=_?(d["!data"][w]||[])[S]:d[T],!g||g.v==null){b.push("          ");continue}for(var E=(g.w||(ns(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";b.push(E+(S===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:l,from_sheet:h}})(),Pk=(function(){function e(O,D,z){if(O){Ln(O,O.l||0);for(var H=z.Enum||ie;O.l<O.length;){var te=O.read_shift(2),Re=H[te]||H[65535],Ee=O.read_shift(2),me=O.l+Ee,xe=Re.f&&Re.f(O,Ee,z);if(O.l=me,D(xe,Re,te))return}}}function t(O,D){switch(D.type){case"base64":return n(mi(Xs(O)),D);case"binary":return n(mi(O),D);case"buffer":case"array":return n(O,D)}throw"Unsupported type "+D.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(O,D){if(!O)return O;var z=D||{},H={},te="Sheet1",Re="",Ee=0,me={},xe=[],Ce=[],Le=[];z.dense&&(Le=H["!data"]=[]);var pe={s:{r:0,c:0},e:{r:0,c:0}},Fe=z.sheetRows||0,Pe={};if(O[4]==81&&O[5]==80&&O[6]==87)return fe(O,D);if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)z.Enum=ie,e(O,function(Ae,xt,he){switch(he){case 0:z.vers=Ae,Ae>=4096&&(z.qpro=!0);break;case 255:z.vers=Ae,z.works=!0;break;case 6:pe=Ae;break;case 204:Ae&&(Re=Ae);break;case 222:Re=Ae;break;case 15:case 51:(!z.qpro&&!z.works||he==51)&&Ae[1].v.charCodeAt(0)<48&&(Ae[1].v=Ae[1].v.slice(1)),(z.works||z.works2)&&(Ae[1].v=Ae[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=z.dateNF||r[(Ae[2]&15)-1]||Qt[14],z.cellDates&&(Ae[1].v=Gl(Ae[1].v),Ae[1].t=typeof Ae[1].v=="number"?"n":"d")),z.qpro&&Ae[3]>Ee&&(H["!ref"]=Ir(pe),me[te]=H,xe.push(te),H={},z.dense&&(Le=H["!data"]=[]),pe={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],te=Re||"Sheet"+(Ee+1),Re="");var De=z.dense?(Le[Ae[0].r]||[])[Ae[0].c]:H[dr(Ae[0])];if(De){De.t=Ae[1].t,De.v=Ae[1].v,Ae[1].z!=null&&(De.z=Ae[1].z),Ae[1].f!=null&&(De.f=Ae[1].f),Pe=De;break}z.dense?(Le[Ae[0].r]||(Le[Ae[0].r]=[]),Le[Ae[0].r][Ae[0].c]=Ae[1]):H[dr(Ae[0])]=Ae[1],Pe=Ae[1];break;case 21509:z.works2=!0;break;case 21506:Ae==5281&&(Pe.z="hh:mm:ss",z.cellDates&&Pe.t=="n"&&(Pe.v=Gl(Pe.v),Pe.t=typeof Pe.v=="number"?"n":"d"));break}},z);else if(O[2]==26||O[2]==14)z.Enum=de,O[2]==14&&(z.qpro=!0,O.l=0),e(O,function(Ae,xt,he){switch(he){case 204:te=Ae;break;case 22:Ae[1].v.charCodeAt(0)<48&&(Ae[1].v=Ae[1].v.slice(1)),Ae[1].v=Ae[1].v.replace(/\x0F./g,function(De){return String.fromCharCode(De.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ee&&(H["!ref"]=Ir(pe),me[te]=H,xe.push(te),H={},z.dense&&(Le=H["!data"]=[]),pe={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],te="Sheet"+(Ee+1)),Fe>0&&Ae[0].r>=Fe)break;z.dense?(Le[Ae[0].r]||(Le[Ae[0].r]=[]),Le[Ae[0].r][Ae[0].c]=Ae[1]):H[dr(Ae[0])]=Ae[1],pe.e.c<Ae[0].c&&(pe.e.c=Ae[0].c),pe.e.r<Ae[0].r&&(pe.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(Ce[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:Ce[Ae[0]]=Ae[1],Ae[0]==Ee&&(te=Ae[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(H["!ref"]=Ir(pe),me[Re||te]=H,xe.push(Re||te),!Ce.length)return{SheetNames:xe,Sheets:me};for(var We={},je=[],$e=0;$e<Ce.length;++$e)me[xe[$e]]?(je.push(Ce[$e]||xe[$e]),We[Ce[$e]]=me[Ce[$e]]||me[xe[$e]]):(je.push(Ce[$e]),We[Ce[$e]]={"!ref":"A1"});return{SheetNames:je,Sheets:We}}function i(O,D){var z=D||{};if(+z.codepage>=0&&Ju(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var H=kn();if(!O["!ref"])throw new Error("Cannot export empty sheet to WK1");var te=Jt(O["!ref"]),Re=O["!data"]!=null,Ee=[];Be(H,0,s(1030)),Be(H,6,h(te));for(var me=Math.min(te.e.r,8191),xe=te.s.c;xe<=te.e.c;++xe)Ee[xe]=Bt(xe);for(var Ce=te.s.r;Ce<=me;++Ce){var Le=zt(Ce);for(xe=te.s.c;xe<=te.e.c;++xe){var pe=Re?(O["!data"][Ce]||[])[xe]:O[Ee[xe]+Le];if(!(!pe||pe.t=="z"))switch(pe.t){case"n":(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?Be(H,13,b(Ce,xe,pe)):Be(H,14,T(Ce,xe,pe));break;case"d":var Fe=hn(pe.v);(Fe|0)==Fe&&Fe>=-32768&&Fe<=32767?Be(H,13,b(Ce,xe,{v:Fe,z:pe.z||Qt[14]})):Be(H,14,T(Ce,xe,{v:Fe,z:pe.z||Qt[14]}));break;default:var Pe=ns(pe);Be(H,15,g(Ce,xe,Pe.slice(0,239)))}}}return Be(H,1),H.end()}function a(O,D){var z=D||{};if(+z.codepage>=0&&Ju(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var H=kn();Be(H,0,l(O));for(var te=0,Re=0;te<O.SheetNames.length;++te)(O.Sheets[O.SheetNames[te]]||{})["!ref"]&&Be(H,27,ne(O.SheetNames[te],Re++));var Ee=0;for(te=0;te<O.SheetNames.length;++te){var me=O.Sheets[O.SheetNames[te]];if(!(!me||!me["!ref"])){for(var xe=Jt(me["!ref"]),Ce=me["!data"]!=null,Le=[],pe=Math.min(xe.e.r,8191),Fe=xe.s.r;Fe<=pe;++Fe)for(var Pe=zt(Fe),We=xe.s.c;We<=xe.e.c;++We){Fe===xe.s.r&&(Le[We]=Bt(We));var je=Le[We]+Pe,$e=Ce?(me["!data"][Fe]||[])[We]:me[je];if(!(!$e||$e.t=="z"))if($e.t=="n")Be(H,23,oe(Fe,We,Ee,$e.v));else{var Ae=ns($e);Be(H,22,B(Fe,We,Ee,Ae.slice(0,239)))}}++Ee}}return Be(H,1),H.end()}function s(O){var D=we(2);return D.write_shift(2,O),D}function l(O){var D=we(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var z=0,H=0,te=0,Re=0;Re<O.SheetNames.length;++Re){var Ee=O.SheetNames[Re],me=O.Sheets[Ee];if(!(!me||!me["!ref"])){++te;var xe=fn(me["!ref"]);z<xe.e.r&&(z=xe.e.r),H<xe.e.c&&(H=xe.e.c)}}return z>8191&&(z=8191),D.write_shift(2,z),D.write_shift(1,te),D.write_shift(1,H),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function f(O,D,z){var H={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&z.qpro?(H.s.c=O.read_shift(1),O.l++,H.s.r=O.read_shift(2),H.e.c=O.read_shift(1),O.l++,H.e.r=O.read_shift(2),H):(H.s.c=O.read_shift(2),H.s.r=O.read_shift(2),D==12&&z.qpro&&(O.l+=2),H.e.c=O.read_shift(2),H.e.r=O.read_shift(2),D==12&&z.qpro&&(O.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function h(O){var D=we(8);return D.write_shift(2,O.s.c),D.write_shift(2,O.s.r),D.write_shift(2,O.e.c),D.write_shift(2,O.e.r),D}function d(O,D,z){var H=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(H[0].c=O.read_shift(1),H[3]=O.read_shift(1),H[0].r=O.read_shift(2),O.l+=2):z.works?(H[0].c=O.read_shift(2),H[0].r=O.read_shift(2),H[2]=O.read_shift(2)):(H[2]=O.read_shift(1),H[0].c=O.read_shift(2),H[0].r=O.read_shift(2)),H}function m(O){return O.z&&Zo(O.z)?240|(r.indexOf(O.z)+1||2):255}function x(O,D,z){var H=O.l+D,te=d(O,D,z);if(te[1].t="s",(z.vers&65534)==20768){O.l++;var Re=O.read_shift(1);return te[1].v=O.read_shift(Re,"utf8"),te}return z.qpro&&O.l++,te[1].v=O.read_shift(H-O.l,"cstr"),te}function g(O,D,z){var H=we(7+z.length);H.write_shift(1,255),H.write_shift(2,D),H.write_shift(2,O),H.write_shift(1,39);for(var te=0;te<H.length;++te){var Re=z.charCodeAt(te);H.write_shift(1,Re>=128?95:Re)}return H.write_shift(1,0),H}function _(O,D,z){var H=O.l+D,te=d(O,D,z);if(te[1].t="s",z.vers==20768){var Re=O.read_shift(1);return te[1].v=O.read_shift(Re,"utf8"),te}return te[1].v=O.read_shift(H-O.l,"cstr"),te}function w(O,D,z){var H=d(O,D,z);return H[1].v=O.read_shift(2,"i"),H}function b(O,D,z){var H=we(7);return H.write_shift(1,m(z)),H.write_shift(2,D),H.write_shift(2,O),H.write_shift(2,z.v,"i"),H}function S(O,D,z){var H=d(O,D,z);return H[1].v=O.read_shift(8,"f"),H}function T(O,D,z){var H=we(13);return H.write_shift(1,m(z)),H.write_shift(2,D),H.write_shift(2,O),H.write_shift(8,z.v,"f"),H}function E(O,D,z){var H=O.l+D,te=d(O,D,z);if(te[1].v=O.read_shift(8,"f"),z.qpro)O.l=H;else{var Re=O.read_shift(2);P(O.slice(O.l,O.l+Re),te),O.l+=Re}return te}function A(O,D,z){var H=D&32768;return D&=-32769,D=(H?O:0)+(D>=8192?D-16384:D),(H?"":"$")+(z?Bt(D):zt(D))}var k={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(O,D){Ln(O,0);for(var z=[],H=0,te="",Re="",Ee="",me="";O.l<O.length;){var xe=O[O.l++];switch(xe){case 0:z.push(O.read_shift(8,"f"));break;case 1:Re=A(D[0].c,O.read_shift(2),!0),te=A(D[0].r,O.read_shift(2),!1),z.push(Re+te);break;case 2:{var Ce=A(D[0].c,O.read_shift(2),!0),Le=A(D[0].r,O.read_shift(2),!1);Re=A(D[0].c,O.read_shift(2),!0),te=A(D[0].r,O.read_shift(2),!1),z.push(Ce+Le+":"+Re+te)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(O.read_shift(2));break;case 6:{for(var pe="";xe=O[O.l++];)pe+=String.fromCharCode(xe);z.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:me=z.pop(),Ee=z.pop(),z.push(["AND","OR"][xe-20]+"("+Ee+","+me+")");break;default:if(xe<32&&j[xe])me=z.pop(),Ee=z.pop(),z.push(Ee+j[xe]+me);else if(k[xe]){if(H=k[xe][1],H==69&&(H=O[O.l++]),H>z.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+z.join("|")+"|");return}var Fe=z.slice(-H);z.length-=H,z.push(k[xe][0]+"("+Fe.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}z.length==1?D[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function M(O){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=O.read_shift(2),D[3]=O[O.l++],D[0].c=O[O.l++],D}function L(O,D){var z=M(O);return z[1].t="s",z[1].v=O.read_shift(D-4,"cstr"),z}function B(O,D,z,H){var te=we(6+H.length);te.write_shift(2,O),te.write_shift(1,z),te.write_shift(1,D),te.write_shift(1,39);for(var Re=0;Re<H.length;++Re){var Ee=H.charCodeAt(Re);te.write_shift(1,Ee>=128?95:Ee)}return te.write_shift(1,0),te}function R(O,D){var z=M(O);z[1].v=O.read_shift(2);var H=z[1].v>>1;if(z[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return z[1].v=H,z}function U(O,D){var z=M(O),H=O.read_shift(4),te=O.read_shift(4),Re=O.read_shift(2);if(Re==65535)return H===0&&te===3221225472?(z[1].t="e",z[1].v=15):H===0&&te===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ee=Re&32768;return Re=(Re&32767)-16446,z[1].v=(1-Ee*2)*(te*Math.pow(2,Re+32)+H*Math.pow(2,Re)),z}function oe(O,D,z,H){var te=we(14);if(te.write_shift(2,O),te.write_shift(1,z),te.write_shift(1,D),H==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var Re=0,Ee=0,me=0,xe=0;return H<0&&(Re=1,H=-H),Ee=Math.log2(H)|0,H/=Math.pow(2,Ee-31),xe=H>>>0,(xe&2147483648)==0&&(H/=2,++Ee,xe=H>>>0),H-=xe,xe|=2147483648,xe>>>=0,H*=Math.pow(2,32),me=H>>>0,te.write_shift(4,me),te.write_shift(4,xe),Ee+=16383+(Re?32768:0),te.write_shift(2,Ee),te}function V(O,D){var z=U(O);return O.l+=D-14,z}function ae(O,D){var z=M(O),H=O.read_shift(4);return z[1].v=H>>6,z}function le(O,D){var z=M(O),H=O.read_shift(8,"f");return z[1].v=H,z}function J(O,D){var z=le(O);return O.l+=D-12,z}function re(O,D){return O[O.l+D-1]==0?O.read_shift(D,"cstr"):""}function Z(O,D){var z=O[O.l++];z>D-1&&(z=D-1);for(var H="";H.length<z;)H+=String.fromCharCode(O[O.l++]);return H}function se(O,D,z){if(!(!z.qpro||D<21)){var H=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var te=O.read_shift(D-21,"cstr");return[H,te]}}function G(O,D){for(var z={},H=O.l+D;O.l<H;){var te=O.read_shift(2);if(te==14e3){for(z[te]=[0,""],z[te][0]=O.read_shift(2);O[O.l];)z[te][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return z}function ne(O,D){var z=we(5+O.length);z.write_shift(2,14e3),z.write_shift(2,D);for(var H=0;H<O.length;++H){var te=O.charCodeAt(H);z[z.l++]=te>127?95:te}return z[z.l++]=0,z}var ie={0:{n:"BOF",f:N0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:w},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:_},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:Z},255:{n:"BOF",f:N0},21506:{n:"WKSNF",f:N0},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ae},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},ge={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Oe(O){var D=O.read_shift(2),z=O.read_shift(1);if(z!=0)throw"unsupported QPW string type "+z.toString(16);return O.read_shift(D,"sbcs-cont")}function fe(O,D){Ln(O,0);var z=D||{},H={};z.dense&&(H["!data"]=[]);var te=[],Re="",Ee={s:{r:-1,c:-1},e:{r:-1,c:-1}},me=0,xe=0,Ce=0,Le=0,pe={SheetNames:[],Sheets:{}},Fe=[];e:for(;O.l<O.length;){var Pe=O.read_shift(2),We=O.read_shift(2),je=O.slice(O.l,O.l+We);switch(Ln(je,0),Pe){case 1:if(je.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var $e=je.read_shift(4),Ae=(je.length-je.l)/$e|0,xt=0;xt<$e;++xt){var he=je.l+Ae,De={};je.l+=2,De.numFmtId=je.read_shift(2),ge[De.numFmtId]&&(De.z=ge[De.numFmtId]),je.l=he,Fe.push(De)}break;case 1025:break;case 1026:break;case 1031:for(je.l+=12;je.l<je.length;)me=je.read_shift(2),xe=je.read_shift(1),te.push(je.read_shift(me,"cstr"));break;case 1032:break;case 1537:{var et=je.read_shift(2);H={},z.dense&&(H["!data"]=[]),Ee.s.c=je.read_shift(2),Ee.e.c=je.read_shift(2),Ee.s.r=je.read_shift(4),Ee.e.r=je.read_shift(4),je.l+=4,je.l+2<je.length&&(me=je.read_shift(2),xe=je.read_shift(1),Re=me==0?"":je.read_shift(me,"cstr")),Re||(Re=Bt(et))}break;case 1538:{if(Ee.s.c>255||Ee.s.r>999999)break;Ee.e.c<Ee.s.c&&(Ee.e.c=Ee.s.c),Ee.e.r<Ee.s.r&&(Ee.e.r=Ee.s.r),H["!ref"]=Ir(Ee),Tb(pe,H,Re)}break;case 2561:Ce=je.read_shift(2),Ee.e.c<Ce&&(Ee.e.c=Ce),Ee.s.c>Ce&&(Ee.s.c=Ce),Le=je.read_shift(4),Ee.s.r>Le&&(Ee.s.r=Le),Le=je.read_shift(4),Ee.e.r<Le&&(Ee.e.r=Le);break;case 3073:{Le=je.read_shift(4),me=je.read_shift(4),Ee.s.r>Le&&(Ee.s.r=Le),Ee.e.r<Le+me-1&&(Ee.e.r=Le+me-1);for(var Qe=Bt(Ce);je.l<je.length;){var Ve={t:"z"},Ke=je.read_shift(1),wt=-1;Ke&128&&(wt=je.read_shift(2));var _t=Ke&64?je.read_shift(2)-1:0;switch(Ke&31){case 0:break;case 1:break;case 2:Ve={t:"n",v:je.read_shift(2)};break;case 3:Ve={t:"n",v:je.read_shift(2,"i")};break;case 4:Ve={t:"n",v:yb(je)};break;case 5:Ve={t:"n",v:je.read_shift(8,"f")};break;case 7:Ve={t:"s",v:te[xe=je.read_shift(4)-1]};break;case 8:Ve={t:"n",v:je.read_shift(8,"f")},je.l+=2,je.l+=4,isNaN(Ve.v)&&(Ve={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Ke&31)}wt!=-1&&(Fe[wt-1]||{}).z&&(Ve.z=Fe[wt-1].z);var St=0;if(Ke&32)switch(Ke&31){case 2:St=je.read_shift(2);break;case 3:St=je.read_shift(2,"i");break;case 7:St=je.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Ke&31)}if(!(!z.sheetStubs&&Ve.t=="z")){var It=jn(Ve);Ve.t=="n"&&Ve.z&&Zo(Ve.z)&&z.cellDates&&(It.v=Gl(Ve.v),It.t=typeof It.v=="number"?"n":"d"),H["!data"]!=null?(H["!data"][Le]||(H["!data"][Le]=[]),H["!data"][Le][Ce]=It):H[Qe+zt(Le)]=It}for(++Le,--me;_t-- >0&&me>=0;){if(Ke&32)switch(Ke&31){case 2:Ve={t:"n",v:Ve.v+St&65535};break;case 3:Ve={t:"n",v:Ve.v+St&65535},Ve.v>32767&&(Ve.v-=65536);break;case 7:Ve={t:"s",v:te[xe=xe+St>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Ke&31)}else switch(Ke&31){case 1:Ve={t:"z"};break;case 2:Ve={t:"n",v:je.read_shift(2)};break;case 7:Ve={t:"s",v:te[xe=je.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Ke&31)}!z.sheetStubs&&Ve.t=="z"||(H["!data"]!=null?(H["!data"][Le]||(H["!data"][Le]=[]),H["!data"][Le][Ce]=Ve):H[Qe+zt(Le)]=Ve),++Le,--me}}}break;case 3074:{Ce=je.read_shift(2),Le=je.read_shift(4);var lr=Oe(je);H["!data"]!=null?(H["!data"][Le]||(H["!data"][Le]=[]),H["!data"][Le][Ce]={t:"s",v:lr}):H[Bt(Ce)+zt(Le)]={t:"s",v:lr}}break}O.l+=We}return pe}return{sheet_to_wk1:i,book_to_wk3:a,to_workbook:t}})(),Ate=/^\s|\s$|[\t\n\r]/;function Pte(e,t){if(!t.bookSST)return"";var r=[Mr];r[r.length]=qe("sst",null,{xmlns:Ec[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(Ate)&&(a+=' xml:space="preserve"'),a+=">"+yt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jte(e){return[e.read_shift(4),e.read_shift(4)]}function Ote(e,t){return t||(t=we(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Dte=yee;function Rte(e){var t=kn();Me(t,159,Ote(e));for(var r=0;r<e.length;++r)Me(t,19,Dte(e[r]));return Me(t,160),t.end()}function Ite(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function h5(e){var t=0,r,n=Ite(e),i=n.length+1,a,s,l,f,h;for(r=Xo(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],l=(t&16384)===0?0:1,f=t<<1&32767,h=l|f,t=h^s;return t^52811}function Fte(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=Jt(e["!ref"]),i,a=e["!data"]!=null,s=[],l=n.s.r;l<=n.e.r;++l){r.push("\\trowd\\trautofit1");for(var f=n.s.c;f<=n.e.c;++f)r.push("\\cellx"+(f+1));for(r.push("\\pard\\intbl"),a&&(s=e["!data"][l]||[]),f=n.s.c;f<=n.e.c;++f){var h=dr({r:l,c:f});if(i=a?s[f]:e[h],!i||i.v==null&&(!i.f||i.F)){r.push(" \\cell");continue}r.push(" "+(i.w||(ns(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function jk(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Mte=6,Ya=Mte;function Ch(e){return Math.floor((e+Math.round(128/Ya)/256)*Ya)}function kh(e){return Math.floor((e-5)/Ya*100+.5)/100}function K1(e){return Math.round((e*Ya+5)/Ya*256)/256}function bb(e){e.width?(e.wpx=Ch(e.width),e.wch=kh(e.wpx),e.MDW=Ya):e.wpx?(e.wch=kh(e.wpx),e.width=K1(e.wch),e.MDW=Ya):typeof e.wch=="number"&&(e.width=K1(e.wch),e.wpx=Ch(e.width),e.MDW=Ya),e.customWidth&&delete e.customWidth}var Lte=96,p5=Lte;function Ah(e){return e*96/p5}function m5(e){return e*p5/96}function Bte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=qe("numFmt",null,{numFmtId:n,formatCode:yt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=qe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function $te(e){var t=[];return t[t.length]=qe("cellXfs",null),e.forEach(function(r){t[t.length]=qe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=qe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ute(e,t){var r=[Mr,qe("styleSheet",null,{xmlns:Ec[0],"xmlns:vt":Qr.vt})],n;return e.SSF&&(n=Bte(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=$te(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function zte(e,t){var r=e.read_shift(2),n=An(e);return[r,n]}function Wte(e,t,r){r||(r=we(6+4*t.length)),r.write_shift(2,e),Ur(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Hte(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Tee(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=Eee(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=An(e),n}function Vte(e,t){t||(t=we(153)),t.write_shift(2,e.sz*20),Cee(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Eh(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ur(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Kte=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Sv,Gte=Na;function Ok(e,t){t||(t=we(84)),Sv||(Sv=lb(Kte));var r=Sv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Eh({auto:1},t),Eh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Yte(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function x5(e,t,r){r||(r=we(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _u(e,t){return t||(t=we(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Xte=Na;function qte(e,t){return t||(t=we(51)),t.write_shift(1,0),_u(null,t),_u(null,t),_u(null,t),_u(null,t),_u(null,t),t.length>t.l?t.slice(0,t.l):t}function Zte(e,t){return t||(t=we(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),af(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Qte(e,t,r){var n=we(2052);return n.write_shift(4,e),af(t,n),af(r,n),n.length>n.l?n.slice(0,n.l):n}function Jte(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Me(e,615,ia(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Me(e,44,Wte(i,t[i]))}),Me(e,616))}}function ere(e){var t=1;Me(e,611,ia(t)),Me(e,43,Vte({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(e,612)}function tre(e){var t=2;Me(e,603,ia(t)),Me(e,45,Ok({patternType:"none"})),Me(e,45,Ok({patternType:"gray125"})),Me(e,604)}function rre(e){var t=1;Me(e,613,ia(t)),Me(e,46,qte()),Me(e,614)}function nre(e){var t=1;Me(e,626,ia(t)),Me(e,47,x5({numFmtId:0},65535)),Me(e,627)}function ire(e,t){Me(e,617,ia(t.length)),t.forEach(function(r){Me(e,47,x5(r,0))}),Me(e,618)}function are(e){var t=1;Me(e,619,ia(t)),Me(e,48,Zte({xfId:0,name:"Normal"})),Me(e,620)}function sre(e){var t=0;Me(e,505,ia(t)),Me(e,506)}function ore(e){var t=0;Me(e,508,Qte(t,"TableStyleMedium9","PivotStyleMedium4")),Me(e,509)}function lre(e,t){var r=kn();return Me(r,278),Jte(r,e.SSF),ere(r),tre(r),rre(r),nre(r),ire(r,t.cellXfs),are(r),sre(r),ore(r),Me(r,279),r.end()}function g5(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Mr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function cre(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:An(e)}}function ure(e){var t=we(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ur(e.name,t),t.slice(0,t.l)}function fre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function dre(e){var t=we(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function hre(e,t){var r=we(8+2*t.length);return r.write_shift(4,e),Ur(t,r),r.slice(0,r.l)}function pre(e){return e.l+=4,e.read_shift(4)!=0}function mre(e,t){var r=we(8);return r.write_shift(4,e),r.write_shift(4,1),r}function xre(){var e=kn();return Me(e,332),Me(e,334,ia(1)),Me(e,335,ure({name:"XLDAPR",version:12e4,flags:3496657072})),Me(e,336),Me(e,339,hre(1,"XLDAPR")),Me(e,52),Me(e,35,ia(514)),Me(e,4096,ia(0)),Me(e,4097,Ii(1)),Me(e,36),Me(e,53),Me(e,340),Me(e,337,mre(1)),Me(e,51,dre([[1,0]])),Me(e,338),Me(e,333),e.end()}function gre(){var e=[Mr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function vre(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=dr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function v5(e,t,r){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[qe("xml",null,{"xmlns:v":xi.v,"xmlns:o":xi.o,"xmlns:x":xi.x,"xmlns:mv":xi.mv}).replace(/\/>/,">"),qe("o:shapelayout",qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,l=t||[];return l.length>0&&a.push(qe("v:shapetype",[qe("v:stroke",null,{joinstyle:"miter"}),qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),l.forEach(function(f){++s,a.push(yre(f,s))}),a.push("</xml>"),a.join("")}function yre(e,t,r){var n=ar(e[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var a=i.type=="gradient"?qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=qe("v:fill",a,i),l={on:"t",obscured:"t"};return["<v:shape"+tf({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,qe("v:shadow",null,l),qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",un("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),un("x:AutoFill","False"),un("x:Row",String(n.r)),un("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function wre(e){var t=[Mr,qe("comments",null,{xmlns:Ec[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=yt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(h){h.a&&(i=r.indexOf(yt(h.a))),h.T&&++s,a.push(h.t==null?"":yt(h.t))}),s===0)n[1].forEach(function(h){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(yt(h.a))+'"><text>'),t.push(un("t",h.t==null?"":yt(h.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>');for(var l=`Comment:
    `+a[0]+`
`,f=1;f<a.length;++f)l+=`Reply:
    `+a[f]+`
`;t.push(un("t",yt(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function y5(e,t,r){var n=[Mr,qe("ThreadedComments",null,{xmlns:Qr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var f={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?a=f.id:f.parentId=a,s.ID=f.id,s.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(qe("threadedComment",un("text",s.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function w5(e){var t=[Mr,qe("personList",null,{xmlns:Qr.TCMNT,"xmlns:x":Ec[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(qe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function bre(e){var t={};t.iauthor=e.read_shift(4);var r=sl(e);return t.rfx=r.s,t.ref=dr(r.s),e.l+=16,t}function _re(e,t){return t==null&&(t=we(36)),t.write_shift(4,e[1].iauthor),kc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Sre=An;function Dk(e){return Ur(e.slice(0,54))}function Nre(e){var t=kn(),r=[];return Me(t,628),Me(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Me(t,632,Dk(i.a)),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),Me(t,632,Dk("tc="+i.ID))))})}),Me(t,631),Me(t,633),e.forEach(function(n){n[1].forEach(function(i){var a=-1;i.ID&&(a=r.indexOf("tc="+i.ID)),a==-1&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),a==-1&&(a=r.indexOf(i.a)),i.iauthor=a;var s={s:ar(n[0]),e:ar(n[0])};Me(t,635,_re([s,i])),i.t&&i.t.length>0&&Me(t,637,bee(i)),Me(t,636),delete i.iauthor})}),Me(t,634),Me(t,629),t.end()}function Ere(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Wt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var Tre=["xlsb","xlsm","xlam","biff8","xla"],Rk=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var l=!1,f=!1;a.length==0?f=!0:a.charAt(0)=="["&&(f=!0,a=a.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var h=a.length>0?parseInt(a,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return l?d+=t.c:--d,f?h+=t.r:--h,i+(l?"":"$")+Bt(d)+(f?"":"$")+zt(h)}return function(i,a){return t=a,i.replace(e,r)}})(),jp=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{jp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Op=(function(){return function(t,r){return t.replace(jp,function(n,i,a,s,l,f){var h=xb(s)-(a?0:r.c),d=mb(f)-(l?0:r.r),m=l=="$"?d+1:d==0?"":"["+d+"]",x=a=="$"?h+1:h==0?"":"["+h+"]";return i+"R"+m+"C"+x})}})();function Cre(e,t){return e.replace(jp,function(r,n,i,a,s,l){return n+(i=="$"?i+a:Bt(xb(a)+t.c))+(s=="$"?s+l:zt(mb(l)+t.r))})}function kre(e){return e.length!=1}function kr(e){e.l+=1}function qs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function b5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return _5(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=qs(e),l=qs(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function _5(e){var t=qs(e),r=qs(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Are(e,t,r){if(r.biff<8)return _5(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=qs(e),s=qs(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function S5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Pre(e);var n=e.read_shift(r&&r.biff==12?4:2),i=qs(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function Pre(e){var t=qs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function jre(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Ore(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Dre(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,l=(a&32768)>>15;if(a&=16383,l==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:l}}function Dre(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Rre(e,t,r){var n=(e[e.l++]&96)>>5,i=b5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Ire(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=b5(e,a,r);return[n,i,s]}function Fre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Mre(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function Lre(e,t,r){var n=(e[e.l++]&96)>>5,i=Are(e,t-1,r);return[n,i]}function Bre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ik(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $re(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Ure(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function zre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Wre(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Hre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function N5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Vre(e){return e.read_shift(2),N5(e)}function Kre(e){return e.read_shift(2),N5(e)}function Gre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=S5(e,0,r);return[n,i]}function Yre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=Ore(e,0,r);return[n,i]}function Xre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=S5(e,0,r);return[n,i,a]}function qre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[oie[i],C5[i],n]}function Zre(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Qre(e);return[i,(a[0]===0?C5:sie)[a[1]]]}function Qre(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Jre(e,t,r){e.l+=r&&r.biff==2?3:4}function ene(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tne(e){return e.l++,Wn[e.read_shift(1)]}function rne(e){return e.l++,e.read_shift(2)}function nne(e){return e.l++,e.read_shift(1)!==0}function ine(e){return e.l++,Ac(e)}function ane(e,t,r){return e.l++,l5(e,t-1,r)}function sne(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Vee(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Wn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ac(e);break;case 2:r[1]=Xee(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function one(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?sl:Qee)(e));return i}function lne(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var l=0;l!=i;++l)s[a][l]=sne(e,r.biff);return s}function cne(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function une(e,t,r){if(r.biff==5)return fne(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function fne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function dne(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function hne(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function pne(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function mne(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var xne=Na,gne=Na,vne=Na;function jf(e,t,r){return e.l+=2,[jre(e)]}function _b(e){return e.l+=6,[]}var yne=jf,wne=_b,bne=_b,_ne=jf;function E5(e){return e.l+=2,[N0(e),e.read_shift(2)&1]}var Sne=jf,Nne=E5,Ene=_b,Tne=jf,Cne=jf,kne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ane(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=kne[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function Pne(e){return e.l+=2,[e.read_shift(4)]}function jne(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function One(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Dne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Rne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ine(e){return e.l+=4,[0,0]}var Fk={1:{n:"PtgExp",f:ene},2:{n:"PtgTbl",f:vne},3:{n:"PtgAdd",f:kr},4:{n:"PtgSub",f:kr},5:{n:"PtgMul",f:kr},6:{n:"PtgDiv",f:kr},7:{n:"PtgPower",f:kr},8:{n:"PtgConcat",f:kr},9:{n:"PtgLt",f:kr},10:{n:"PtgLe",f:kr},11:{n:"PtgEq",f:kr},12:{n:"PtgGe",f:kr},13:{n:"PtgGt",f:kr},14:{n:"PtgNe",f:kr},15:{n:"PtgIsect",f:kr},16:{n:"PtgUnion",f:kr},17:{n:"PtgRange",f:kr},18:{n:"PtgUplus",f:kr},19:{n:"PtgUminus",f:kr},20:{n:"PtgPercent",f:kr},21:{n:"PtgParen",f:kr},22:{n:"PtgMissArg",f:kr},23:{n:"PtgStr",f:ane},26:{n:"PtgSheet",f:jne},27:{n:"PtgEndSheet",f:One},28:{n:"PtgErr",f:tne},29:{n:"PtgBool",f:nne},30:{n:"PtgInt",f:rne},31:{n:"PtgNum",f:ine},32:{n:"PtgArray",f:Bre},33:{n:"PtgFunc",f:qre},34:{n:"PtgFuncVar",f:Zre},35:{n:"PtgName",f:cne},36:{n:"PtgRef",f:Gre},37:{n:"PtgArea",f:Rre},38:{n:"PtgMemArea",f:dne},39:{n:"PtgMemErr",f:xne},40:{n:"PtgMemNoMem",f:gne},41:{n:"PtgMemFunc",f:hne},42:{n:"PtgRefErr",f:pne},43:{n:"PtgAreaErr",f:Fre},44:{n:"PtgRefN",f:Yre},45:{n:"PtgAreaN",f:Lre},46:{n:"PtgMemAreaN",f:Dne},47:{n:"PtgMemNoMemN",f:Rne},57:{n:"PtgNameX",f:une},58:{n:"PtgRef3d",f:Xre},59:{n:"PtgArea3d",f:Ire},60:{n:"PtgRefErr3d",f:mne},61:{n:"PtgAreaErr3d",f:Mre},255:{}},Fne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Mne={1:{n:"PtgElfLel",f:E5},2:{n:"PtgElfRw",f:Tne},3:{n:"PtgElfCol",f:yne},6:{n:"PtgElfRwV",f:Cne},7:{n:"PtgElfColV",f:_ne},10:{n:"PtgElfRadical",f:Sne},11:{n:"PtgElfRadicalS",f:Ene},13:{n:"PtgElfColS",f:wne},15:{n:"PtgElfColSV",f:bne},16:{n:"PtgElfRadicalLel",f:Nne},25:{n:"PtgList",f:Ane},29:{n:"PtgSxName",f:Pne},255:{}},Lne={0:{n:"PtgAttrNoop",f:Ine},1:{n:"PtgAttrSemi",f:Hre},2:{n:"PtgAttrIf",f:zre},4:{n:"PtgAttrChoose",f:$re},8:{n:"PtgAttrGoto",f:Ure},16:{n:"PtgAttrSum",f:Jre},32:{n:"PtgAttrBaxcel",f:Ik},33:{n:"PtgAttrBaxcel",f:Ik},64:{n:"PtgAttrSpace",f:Vre},65:{n:"PtgAttrSpaceSemi",f:Kre},128:{n:"PtgAttrIfError",f:Wre},255:{}};function Bne(e,t,r,n){if(n.biff<8)return Na(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=lne(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=one(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(Na(e,t)),a}function $ne(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=Fk[a]||Fk[Fne[a]],(a===24||a===25)&&(i=(a===24?Mne:Lne)[e[e.l+1]]),!i||!i.f?Na(e,t):s.push([i.n,i.f(e,t,r)]);return s}function Une(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var zne={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Wne(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function T5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mk(e,t,r){var n=T5(e,t,r);return n=="#REF"?n:nf(n,r)}function uc(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0}},l=[],f,h,d,m=0,x=0,g,_="";if(!e[0]||!e[0][0])return"";for(var w=-1,b="",S=0,T=e[0].length;S<T;++S){var E=e[0][S];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=l.pop(),h=l.pop(),w>=0){switch(e[0][w][1][0]){case 0:b=nr(" ",e[0][w][1][1]);break;case 1:b=nr("\r",e[0][w][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+b,w=-1}l.push(h+zne[E[0]]+f);break;case"PtgIsect":f=l.pop(),h=l.pop(),l.push(h+" "+f);break;case"PtgUnion":f=l.pop(),h=l.pop(),l.push(h+","+f);break;case"PtgRange":f=l.pop(),h=l.pop(),l.push(Wne(h,f));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Iu(E[1][1],s,i),l.push(Fu(d,a));break;case"PtgRefN":d=r?Iu(E[1][1],r,i):E[1][1],l.push(Fu(d,a));break;case"PtgRef3d":m=E[1][1],d=Iu(E[1][2],s,i),_=Mk(n,m,i),l.push(_+"!"+Fu(d,a));break;case"PtgFunc":case"PtgFuncVar":var A=E[1][0],k=E[1][1];A||(A=0),A&=127;var j=A==0?[]:l.slice(-A);l.length-=A,k==="User"&&(k=j.shift()),l.push(k+"("+j.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":g=vk(E[1][1],r?{s:r}:s,i),l.push(yv(g,i));break;case"PtgArea":g=vk(E[1][1],s,i),l.push(yv(g,i));break;case"PtgArea3d":m=E[1][1],g=E[1][2],_=Mk(n,m,i),l.push(_+"!"+yv(g,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=E[1][2];var P=(n.names||[])[x-1]||(n[0]||[])[x],M=P?P.Name:"SH33TJSNAME"+String(x);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var L=E[1][1];x=E[1][2];var B;if(i.biff<=5)L<0&&(L=-L),n[L]&&(B=n[L][x]);else{var R="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][x]&&n[L][x].itab>0&&(R=n.SheetNames[n[L][x].itab-1]+"!"):R=n.SheetNames[x-1]+"!"),n[L]&&n[L][x])R+=n[L][x].Name;else if(n[0]&&n[0][x])R+=n[0][x].Name;else{var U=(T5(n,L,i)||"").split(";;");U[x-1]?R=U[x-1]:R+="SH33TJSERRX"}l.push(R);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var oe="(",V=")";if(w>=0){switch(b="",e[0][w][1][0]){case 2:oe=nr(" ",e[0][w][1][1])+oe;break;case 3:oe=nr("\r",e[0][w][1][1])+oe;break;case 4:V=nr(" ",e[0][w][1][1])+V;break;case 5:V=nr("\r",e[0][w][1][1])+V;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}l.push(oe+l.pop()+V);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:E[1][1],r:E[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[dr(d)]){var le=n.sharedf[dr(d)];l.push(uc(le,s,ae,n,i))}else{var J=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){l.push(uc(h[1],s,ae,n,i)),J=!0;break}J||l.push(E[1])}break;case"PtgArray":l.push("{"+Une(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&w>=0&&re.indexOf(e[0][S][0])==-1){E=e[0][w];var Z=!0;switch(E[1][0]){case 4:Z=!1;case 0:b=nr(" ",E[1][1]);break;case 5:Z=!1;case 1:b=nr("\r",E[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((Z?b:"")+l.pop()+(Z?"":b)),w=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function Hne(e){if(e==null){var t=we(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Qo(e);return Qo(0)}function Vne(e,t,r,n,i){var a=Jo(t,r,i),s=Hne(e.v),l=we(6),f=33;l.write_shift(2,f),l.write_shift(4,0);for(var h=we(e.bf.length),d=0;d<e.bf.length;++d)h[d]=e.bf[d];var m=jr([a,s,l,h]);return m}function Dp(e,t,r){var n=e.read_shift(4),i=$ne(e,n,r),a=e.read_shift(4),s=a>0?Bne(e,a,i,r):null;return[i,s]}var Kne=Dp,Rp=Dp,Gne=Dp,Yne=Dp;function Lk(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=we(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=we(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function Xne(e){var t=we(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function qne(e){var t=we(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function Zne(e){var t=we(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=we(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=we(4);return n.write_shift(4,0),jr([t,r,n])}function Qne(e){var t=ar(e),r=we(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function Jne(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var i=ar(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=we(17);return a.write_shift(4,9),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,i.r),a.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function eie(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=we(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function tie(e){var t=e.split(":"),r=t[0],n=we(23);n.write_shift(4,15),r=t[0];var i=ar(r);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],i=ar(r),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function rie(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=e.split(":"),a=we(27);a.write_shift(4,19);var s=i[0],l=ar(s);return a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,l.r),a.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=i[1],l=ar(s),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,l.r),a.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),a.write_shift(1,17),a.write_shift(4,0),a}function nie(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=fn(e),a=we(23);return a.write_shift(4,15),a.write_shift(1,59),a.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,i.s.r),a.write_shift(4,i.e.r),a.write_shift(2,i.s.c),a.write_shift(2,i.e.c),a.write_shift(4,0),a}function iie(e,t){if(typeof e=="number")return Lk(e);if(typeof e=="boolean")return qne(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return Xne(+ya[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Qne(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return tie(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return nie(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Jne(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return rie(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return eie(e,t);if(/^".*"$/.test(e))return Zne(e);if(/^[+-]\d+$/.test(e))return Lk(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var aie=iie,sie={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},C5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oie={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function lie(e){var t="of:="+e.replace(jp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function k5(e){return e.replace(/!/,".").replace(/:/,":.")}var Mu=typeof Map<"u";function Sb(e,t,r){var n=0,i=e.length;if(r){if(Mu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Mu?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Mu?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Ip(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ya=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=kh(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=K1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function A5(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function so(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){IJ(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function cie(e,t,r){if(e&&e["!ref"]){var n=Jt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function uie(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ir(e[r])+'"/>';return t+"</mergeCells>"}function fie(e,t,r,n,i){var a=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}a=!0,s.codeName=ef(yt(f))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),l=(l||"")+qe("outlinePr",null,h)}!a&&!l||(i[i.length]=qe("sheetPr",l,s))}var die=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hie=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pie(e){var t={sheet:1};return die.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),hie.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=h5(e.password).toString(16).toUpperCase()),qe("sheetProtection",null,t)}function mie(e){return A5(e),qe("pageMargins",null,e)}function xie(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=qe("col",null,Ip(i,n)));return r[r.length]="</cols>",r.join("")}function gie(e,t,r,n){var i=typeof e.ref=="string"?e.ref:Ir(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=fn(i);s.s.r==s.e.r&&(s.e.r=fn(t["!ref"]).e.r,i=Ir(s));for(var l=0;l<a.length;++l){var f=a[l];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref=nf(r.SheetNames[n])+"!"+rf(i);break}}return l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),qe("autoFilter",null,{ref:i})}function vie(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),qe("sheetViews",qe("sheetView",null,i),{})}function yie(e,t,r,n,i,a,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var l="",f=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=Wn[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=Wn[e.v=7]);break;case"e":l=Wn[e.v];break;case"d":if(n&&n.cellDates){var d=ii(e.v,s);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else e=jn(e),e.t="n",l=""+(e.v=hn(ii(e.v,s),s));typeof e.z>"u"&&(e.z=Qt[14]);break;default:l=e.v;break}var m=e.t=="z"||e.v==null?"":un("v",yt(l)),x={r:t},g=so(n.cellXfs,e,n);switch(g!==0&&(x.s=g),e.t){case"n":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){m=un("v",""+Sb(n.Strings,e.v,n.revStrings)),x.t="s";break}else x.t="str";break}if(e.t!=f&&(e.t=f,e.v=h),typeof e.f=="string"&&e.f){var _=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;m=qe("f",yt(e.f),_)+(e.v!=null?m:"")}return e.l&&(e.l.display=yt(l),r["!links"].push([t,e.l])),e.D&&(x.cm=1),qe("c",m,x)}function wie(e,t,r,n){var i=[],a=[],s=Jt(e["!ref"]),l="",f,h="",d=[],m=0,x=0,g=e["!rows"],_=e["!data"]!=null,w=_?e["!data"]:[],b={r:h},S,T=-1,E=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(x=s.s.c;x<=s.e.c;++x)d[x]=Bt(x);for(m=s.s.r;m<=s.e.r;++m){a=[],h=zt(m);var A=_?w[m]:[];for(x=s.s.c;x<=s.e.c;++x){f=d[x]+h;var k=_?A[x]:e[f];k!==void 0&&(l=yie(k,f,e,t,r,n,E))!=null&&a.push(l)}(a.length>0||g&&g[m])&&(b={r:h},g&&g[m]&&(S=g[m],S.hidden&&(b.hidden=1),T=-1,S.hpx?T=Ah(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(b.ht=T,b.customHeight=1),S.level&&(b.outlineLevel=S.level)),i[i.length]=qe("row",a.join(""),b))}if(g)for(;m<g.length;++m)g&&g[m]&&(b={r:m+1},S=g[m],S.hidden&&(b.hidden=1),T=-1,S.hpx?T=Ah(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(b.ht=T,b.customHeight=1),S.level&&(b.outlineLevel=S.level),i[i.length]=qe("row","",b));return i.join("")}function bie(e,t,r,n){var i=[Mr,qe("worksheet",null,{xmlns:Ec[0],"xmlns:r":Qr.r})],a=r.SheetNames[e],s=0,l="",f=r.Sheets[a];f==null&&(f={});var h=f["!ref"]||"A1",d=Jt(h);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=Ir(d)}n||(n={}),f["!comments"]=[];var m=[];fie(f,r,e,t,i),i[i.length]=qe("dimension",null,{ref:h}),i[i.length]=vie(f,t,e,r),t.sheetFormat&&(i[i.length]=qe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(i[i.length]=xie(f,f["!cols"])),i[s=i.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(l=wie(f,t,e,r),l.length>0&&(i[i.length]=l)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),f["!protect"]&&(i[i.length]=pie(f["!protect"])),f["!autofilter"]!=null&&(i[i.length]=gie(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(i[i.length]=uie(f["!merges"]));var x=-1,g,_=-1;return f["!links"].length>0&&(i[i.length]="<hyperlinks>",f["!links"].forEach(function(w){w[1].Target&&(g={ref:w[0]},w[1].Target.charAt(0)!="#"&&(_=Ot(n,-1,yt(w[1].Target).replace(/#[\s\S]*$/,""),Et.HLINK),g["r:id"]="rId"+_),(x=w[1].Target.indexOf("#"))>-1&&(g.location=yt(w[1].Target.slice(x+1))),w[1].Tooltip&&(g.tooltip=yt(w[1].Tooltip)),g.display=w[1].display,i[i.length]=qe("hyperlink",null,g))}),i[i.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(i[i.length]=mie(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=un("ignoredErrors",qe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),m.length>0&&(_=Ot(n,-1,"../drawings/drawing"+(e+1)+".xml",Et.DRAW),i[i.length]=qe("drawing",null,{"r:id":"rId"+_}),f["!drawing"]=m),f["!comments"].length>0&&(_=Ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Et.VML),i[i.length]=qe("legacyDrawing",null,{"r:id":"rId"+_}),f["!legacy"]=_),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function _ie(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function Sie(e,t,r){var n=we(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=Ah(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,f=n.l;n.l+=4;for(var h={r:e,c:0},d=r["!data"]!=null,m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,g=-1,_=m<<10;_<m+1<<10;++_){h.c=_;var w=d?(r["!data"][h.r]||[])[h.c]:r[dr(h)];w&&(x<0&&(x=_),g=_)}x<0||(++l,n.write_shift(4,x),n.write_shift(4,g))}var b=n.l;return n.l=f,n.write_shift(4,l),n.l=b,n.length>n.l?n.slice(0,n.l):n}function Nie(e,t,r,n){var i=Sie(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Me(e,0,i)}var Eie=sl,Tie=kc;function Cie(){}function kie(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=_ee(e),r}function Aie(e,t,r){r==null&&(r=we(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Eh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Y3(e,r),r.slice(0,r.l)}function Pie(e){var t=Wi(e);return[t]}function jie(e,t,r){return r==null&&(r=we(8)),nl(t,r)}function Oie(e){var t=il(e);return[t]}function Die(e,t,r){return r==null&&(r=we(4)),al(t,r)}function Rie(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"b"]}function Iie(e,t,r){return r==null&&(r=we(9)),nl(t,r),r.write_shift(1,e.v?1:0),r}function Fie(e){var t=il(e),r=e.read_shift(1);return[t,r,"b"]}function Mie(e,t,r){return r==null&&(r=we(5)),al(t,r),r.write_shift(1,e.v?1:0),r}function Lie(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"e"]}function Nv(e,t,r){return r==null&&(r=we(9)),nl(t,r),r.write_shift(1,e.v),r}function Bie(e){var t=il(e),r=e.read_shift(1);return[t,r,"e"]}function Ev(e,t,r){return r==null&&(r=we(8)),al(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function $ie(e){var t=Wi(e),r=e.read_shift(4);return[t,r,"s"]}function Uie(e,t,r){return r==null&&(r=we(12)),nl(t,r),r.write_shift(4,t.v),r}function zie(e){var t=il(e),r=e.read_shift(4);return[t,r,"s"]}function Wie(e,t,r){return r==null&&(r=we(8)),al(t,r),r.write_shift(4,t.v),r}function Hie(e){var t=Wi(e),r=Ac(e);return[t,r,"n"]}function Vie(e,t,r){return r==null&&(r=we(16)),nl(t,r),Qo(e.v,r),r}function Kie(e){var t=il(e),r=Ac(e);return[t,r,"n"]}function Gie(e,t,r){return r==null&&(r=we(12)),al(t,r),Qo(e.v,r),r}function Yie(e){var t=Wi(e),r=yb(e);return[t,r,"n"]}function Xie(e,t,r){return r==null&&(r=we(12)),nl(t,r),X3(e.v,r),r}function qie(e){var t=il(e),r=yb(e);return[t,r,"n"]}function Zie(e,t,r){return r==null&&(r=we(8)),al(t,r),X3(e.v,r),r}function Qie(e){var t=Wi(e),r=gb(e);return[t,r,"is"]}function Jie(e){var t=Wi(e),r=An(e);return[t,r,"str"]}function eae(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=we(12+4*e.v.length)),nl(t,r),Ur(n,r),r.length>r.l?r.slice(0,r.l):r}function tae(e){var t=il(e),r=An(e);return[t,r,"str"]}function rae(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=we(8+4*n.length)),al(t,r),Ur(n,r),r.length>r.l?r.slice(0,r.l):r}function nae(e,t,r){var n=e.l+t,i=Wi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var l=Rp(e,n-e.l,r);s[3]=uc(l,null,i,r.supbooks,r)}else e.l=n;return s}function iae(e,t,r){var n=e.l+t,i=Wi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var l=Rp(e,n-e.l,r);s[3]=uc(l,null,i,r.supbooks,r)}else e.l=n;return s}function aae(e,t,r){var n=e.l+t,i=Wi(e);i.r=r["!row"];var a=Ac(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var l=Rp(e,n-e.l,r);s[3]=uc(l,null,i,r.supbooks,r)}else e.l=n;return s}function sae(e,t,r){var n=e.l+t,i=Wi(e);i.r=r["!row"];var a=An(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var l=Rp(e,n-e.l,r);s[3]=uc(l,null,i,r.supbooks,r)}else e.l=n;return s}var oae=sl,lae=kc;function cae(e,t){return t==null&&(t=we(4)),t.write_shift(4,e),t}function uae(e,t){var r=e.l+t,n=sl(e),i=Pp(e),a=An(e),s=An(e),l=An(e);e.l=r;var f={rfx:n,relId:i,loc:a,display:l};return s&&(f.Tooltip=s),f}function fae(e,t){var r=we(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));kc({s:ar(e[0]),e:ar(e[0])},r),vb("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Ur(i||"",r),Ur(e[1].Tooltip||"",r),Ur("",r),r.slice(0,r.l)}function dae(){}function hae(e,t,r){var n=e.l+t,i=q3(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var l=Kne(e,n-e.l,r);s[1]=l}else e.l=n;return s}function pae(e,t,r){var n=e.l+t,i=sl(e),a=[i];if(r.cellFormula){var s=Yne(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}function mae(e,t,r){r==null&&(r=we(18));var n=Ip(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var P5=["left","right","top","bottom","header","footer"];function xae(e){var t={};return P5.forEach(function(r){t[r]=Ac(e)}),t}function gae(e,t){return t==null&&(t=we(48)),A5(e),P5.forEach(function(r){Qo(e[r],t)}),t}function vae(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function yae(e,t,r){r==null&&(r=we(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function wae(e){var t=we(24);return t.write_shift(4,4),t.write_shift(4,1),kc(e,t),t}function bae(e,t){return t==null&&(t=we(66)),t.write_shift(2,e.password?h5(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function _ae(){}function Sae(){}function Nae(e,t,r,n,i,a,s,l){var f={r,c:n};if(t.c&&a["!comments"].push([dr(f),t.c]),t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=jn(t),t.z=t.z||Qt[14],t.v=hn(ii(t.v,l),l),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}switch(f.s=so(i.cellXfs,t,i),t.l&&a["!links"].push([dr(f),t.l]),t.t){case"s":case"str":return i.bookSST?(h=Sb(i.Strings,t.v==null?"":String(t.v),i.revStrings),f.t="s",f.v=h,s?Me(e,18,Wie(t,f)):Me(e,7,Uie(t,f))):(f.t="str",s?Me(e,17,rae(t,f)):Me(e,6,eae(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Me(e,13,Zie(t,f)):Me(e,2,Xie(t,f)):isFinite(t.v)?s?Me(e,16,Gie(t,f)):Me(e,5,Vie(t,f)):(f.t="e",isNaN(t.v)?s?Me(e,14,Ev({v:36},f)):Me(e,3,Nv({v:36},f)):s?Me(e,14,Ev({v:7},f)):Me(e,3,Nv({v:7},f))),!0;case"b":return f.t="b",s?Me(e,15,Mie(t,f)):Me(e,4,Iie(t,f)),!0;case"e":return f.t="e",s?Me(e,14,Ev(t,f)):Me(e,3,Nv(t,f)),!0}return s?Me(e,12,Die(t,f)):Me(e,1,jie(t,f)),!0}function Eae(e,t,r,n,i){var a=Jt(t["!ref"]||"A1"),s="",l=[],f=(((i||{}).Workbook||{}).WBProps||{}).date1904;Me(e,145);var h=t["!data"]!=null,d=h?t["!data"][a.s.r]:[],m=a.e.r;t["!rows"]&&(m=Math.max(a.e.r,t["!rows"].length-1));for(var x=a.s.r;x<=m;++x)if(s=zt(x),h&&(d=t["!data"][x]),Nie(e,t,a,x),!(h&&!d)){var g=!1;if(x<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){x===a.s.r&&(l[_]=Bt(_));var w=h?d[_]:t[l[_]+s];if(!w){g=!1;continue}g=Nae(e,w,x,_,n,t,g,f)}}Me(e,146)}function Tae(e,t){!t||!t["!merges"]||(Me(e,177,cae(t["!merges"].length)),t["!merges"].forEach(function(r){Me(e,176,lae(r))}),Me(e,178))}function Cae(e,t){!t||!t["!cols"]||(Me(e,390),t["!cols"].forEach(function(r,n){r&&Me(e,60,mae(n,r))}),Me(e,391))}function kae(e,t){!t||!t["!ref"]||(Me(e,648),Me(e,649,wae(Jt(t["!ref"]))),Me(e,650))}function Aae(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Ot(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),Et.HLINK);Me(e,494,fae(n,i))}}),delete t["!links"]}function Pae(e,t,r,n){if(t["!comments"].length>0){var i=Ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Et.VML);Me(e,551,vb("rId"+i)),t["!legacy"]=i}}function jae(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:Ir(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=fn(a);l.s.r==l.e.r&&(l.e.r=fn(t["!ref"]).e.r,a=Ir(l));for(var f=0;f<s.length;++f){var h=s[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref=nf(r.SheetNames[n])+"!"+rf(a);break}}f==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:nf(r.SheetNames[n])+"!"+rf(a)}),Me(e,161,kc(Jt(a))),Me(e,162)}}function Oae(e,t,r){Me(e,133),Me(e,137,yae(t,r)),Me(e,138),Me(e,134)}function Dae(e,t){t["!protect"]&&Me(e,535,bae(t["!protect"]))}function Rae(e,t,r,n){var i=kn(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=a;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var f=Jt(s["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Me(i,129),(r.vbaraw||s["!outline"])&&Me(i,147,Aie(l,s["!outline"])),Me(i,148,Tie(f)),Oae(i,s,r.Workbook),Cae(i,s),Eae(i,s,e,t,r),Dae(i,s),jae(i,s,r,e),Tae(i,s),Aae(i,s,n),s["!margins"]&&Me(i,476,gae(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&kae(i,s),Pae(i,s,e,n),Me(i,130),i.end()}function Iae(e,t){e.l+=10;var r=An(e);return{name:r}}var Fae=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Mae(e){return!e.Workbook||!e.Workbook.WBProps?"false":JJ(e.Workbook.WBProps.date1904)?"true":"false"}var Lae=":][*?/\\".split("");function j5(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");Lae.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function Bae(e,t,r){e.forEach(function(n,i){j5(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function $ae(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Bae(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)cie(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,i){var a=e.Sheets[n];if(!(!a||!a["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(f){f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i&&(s=f)});var l=nf(n)+"!"+rf(a["!autofilter"].ref);s?s.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:l})}})}function Uae(e){var t=[Mr];t[t.length]=qe("workbook",null,{xmlns:Ec[0],"xmlns:r":Qr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Fae.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=qe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:yt(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=qe("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var f={name:l.Name};l.Comment&&(f.comment=l.Comment),l.Sheet!=null&&(f.localSheetId=""+l.Sheet),l.Hidden&&(f.hidden="1"),l.Ref&&(t[t.length]=qe("definedName",yt(l.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zae(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=V1(e),r.name=An(e),r}function Wae(e,t){return t||(t=we(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vb(e.strRelID,t),Ur(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Hae(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?An(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Vae(e,t){t||(t=we(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),Y3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Kae(e,t,r){var n=e.l+t,i=e.read_shift(4);e.l+=1;var a=e.read_shift(4),s=See(e),l,f="";try{l=Gne(e,0,r);try{f=Pp(e)}catch{}}catch{console.error("Could not parse defined name "+s)}i&32&&(s="_xlnm."+s),e.l=n;var h={Name:s,Ptg:l,Flags:i};return a<268435455&&(h.Sheet=a),f&&(h.Comment=f),h}function Gae(e,t){var r=we(9),n=0,i=e.Name;Iee.indexOf(i)>-1&&(n|=32,i=i.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var a=[r,Ur(i),aie(e.Ref,t)];if(e.Comment)a.push(af(e.Comment));else{var s=we(4);s.write_shift(4,4294967295),a.push(s)}return jr(a)}function Yae(e,t){Me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Me(e,156,Wae(i))}Me(e,144)}function Xae(e,t){t||(t=we(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ur("SheetJS",t),Ur(xh.version,t),Ur(xh.version,t),Ur("7262",t),t.length>t.l?t.slice(0,t.l):t}function qae(e,t){t||(t=we(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Zae(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(Me(e,135),Me(e,158,qae(i)),Me(e,136))}}function Qae(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;Me(e,39,Gae(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function Jae(e){var t=e.SheetNames.length,r=we(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function ese(e,t){Me(e,353),Me(e,357),Me(e,362,Jae(t)),Me(e,354)}function tse(e,t){var r=kn();return Me(r,131),Me(r,128,Xae()),Me(r,153,Vae(e.Workbook&&e.Workbook.WBProps||null)),Zae(r,e),Yae(r,e),ese(r,e),(e.Workbook||{}).Names&&Qae(r,e),Me(r,132),r.end()}function rse(e,t){var r=[];return e.Props&&r.push($ee(e.Props,t)),e.Custprops&&r.push(Uee(e.Props,e.Custprops)),r.join("")}function nse(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function ise(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(qe("NumberFormat",null,{"ss:Format":yt(Qt[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(qe("Style",a.join(""),s))}),qe("Styles",r.join(""))}function O5(e){return qe("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+Op(e.Ref,{r:0,c:0})})}function ase(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(O5(i)))}return qe("Names",r.join(""))}function sse(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var l=i[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||a.push(O5(l)))}return a.join("")}function ose(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(qe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(qe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(un("ProtectContents","True")),e["!protect"].objects&&i.push(un("ProtectObjects","True")),e["!protect"].scenarios&&i.push(un("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(un("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(un("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":qe("WorksheetOptions",i.join(""),{xmlns:xi.x})}function lse(e){return e.map(function(t){var r=QJ(t.t||""),n=qe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return t.a&&(i["ss:Author"]=t.a),e.hidden||(i["ss:ShowAlways"]="1"),qe("Comment",n,i)}).join("")}function cse(e,t,r,n,i,a,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+yt(Op(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var f=ar(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(f.r==s.r?"":"["+(f.r-s.r)+"]")+"C"+(f.c==s.c?"":"["+(f.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=yt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=yt(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=s.c||h[d].s.r!=s.r||(h[d].e.c>h[d].s.c&&(l["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(l["ss:MergeDown"]=h[d].e.r-h[d].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(m="Number",x=String(e.v)):(m="Error",x=Wn[isNaN(e.v)?36:7]);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=Wn[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Qt[14]);break;case"s":m="String",x=ZJ(e.v||"");break}var g=so(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+g),l["ss:Index"]=s.c+1;var _=e.v!=null?x:"",w=e.t=="z"?"":'<Data ss:Type="'+m+'">'+_+"</Data>";return(e.c||[]).length>0&&(w+=lse(e.c)),qe("Cell",w,l)}function use(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=m5(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function fse(e,t,r,n){if(!e["!ref"])return"";var i=Jt(e["!ref"]),a=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,S){bb(b);var T=!!b.width,E=Ip(S,b),A={"ss:Index":S+1};T&&(A["ss:Width"]=Ch(E.width)),b.hidden&&(A["ss:Hidden"]="1"),l.push(qe("Column",null,A))});for(var f=e["!data"]!=null,h={r:0,c:0},d=i.s.r;d<=i.e.r;++d){var m=[use(d,(e["!rows"]||[])[d])];h.r=d;for(var x=i.s.c;x<=i.e.c;++x){h.c=x;var g=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>x)&&!(a[s].s.r>d)&&!(a[s].e.c<x)&&!(a[s].e.r<d)){(a[s].s.c!=x||a[s].s.r!=d)&&(g=!0);break}if(!g){var _=Bt(x)+zt(d),w=f?(e["!data"][d]||[])[x]:e[_];m.push(cse(w,_,e,t,r,n,h))}}m.push("</Row>"),m.length>2&&l.push(m.join(""))}return l.join("")}function dse(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?sse(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?fse(a,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(ose(a,t,e,r)),a&&a["!autofilter"]&&n.push('<AutoFilter x:Range="'+Op(rf(a["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function hse(e,t){t||(t={}),e.SSF||(e.SSF=jn(Qt)),e.SSF&&(Cp(),Tp(e.SSF),t.revssf=kp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],so(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(rse(e,t)),r.push(nse(e)),r.push(""),r.push(ase(e));for(var n=0;n<e.SheetNames.length;++n)r.push(qe("Worksheet",dse(n,t,e),{"ss:Name":yt(e.SheetNames[n])}));return r[2]=ise(e,t),Mr+qe("Workbook",r.join(""),{xmlns:xi.ss,"xmlns:o":xi.o,"xmlns:x":xi.x,"xmlns:ss":xi.ss,"xmlns:dt":xi.dt,"xmlns:html":xi.html})}var Tv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pse(e,t){var r=[],n=[],i=[],a=0,s,l=ck(wk,"n"),f=ck(bk,"n");if(e.Props)for(s=Rr(e.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(l,s[a])?r:Object.prototype.hasOwnProperty.call(f,s[a])?n:i).push([s[a],e.Props[s[a]]]);if(e.Custprops)for(s=Rr(e.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(l,s[a])?r:Object.prototype.hasOwnProperty.call(f,s[a])?n:i).push([s[a],e.Custprops[s[a]]]);var h=[];for(a=0;a<i.length;++a)s5.indexOf(i[a][0])>-1||n5.indexOf(i[a][0])>-1||i[a][1]!=null&&h.push(i[a]);n.length&&Wt.utils.cfb_add(t,"/SummaryInformation",Tk(n,Tv.SI,f,bk)),(r.length||h.length)&&Wt.utils.cfb_add(t,"/DocumentSummaryInformation",Tk(r,Tv.DSI,l,wk,h.length?h:null,Tv.UDI))}function mse(e,t){var r=t||{},n=Wt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Wt.utils.cfb_add(n,i,R5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&pse(e,n),r.biff==8&&e.vbaraw&&Ere(n,Wt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var xse={0:{f:_ie},1:{f:Pie},2:{f:Yie},3:{f:Lie},4:{f:Rie},5:{f:Hie},6:{f:Jie},7:{f:$ie},8:{f:sae},9:{f:aae},10:{f:nae},11:{f:iae},12:{f:Oie},13:{f:qie},14:{f:Bie},15:{f:Fie},16:{f:Kie},17:{f:tae},18:{f:zie},19:{f:gb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Kae},40:{},42:{},43:{f:Hte},44:{f:zte},45:{f:Gte},46:{f:Xte},47:{f:Yte},48:{},49:{f:xee},50:{},51:{f:fre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wte},62:{f:Qie},63:{f:vre},64:{f:_ae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Na,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:kie},148:{f:Eie,p:16},151:{f:dae},152:{},153:{f:Hae},154:{},155:{},156:{f:zae},157:{},158:{},159:{T:1,f:jte},160:{T:-1},161:{T:1,f:sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:oae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:cre},336:{T:-1},337:{f:pre,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:V1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mte},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hae},427:{f:pae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Cie},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:V1},551:{f:Pp},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Sre},633:{T:1},634:{T:-1},635:{T:1,f:bre},636:{T:-1},637:{f:wee},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Iae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Sae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Be(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&pb(r)&&e.push(r)}}function gse(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Be(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],l=0,f=0,h=0;h+(s[l]||8224)<=8224;)h+=s[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h;f<i;){for(d=e.next(4),d.write_shift(2,60),h=0;h+(s[l]||8224)<=8224;)h+=s[l]||8224,l++;d.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h}}}function Cv(e,t,r,n){var i=we(9);return Pf(i,e,t),o5(r,n||"b",i),i}function vse(e,t,r){var n=we(8+2*r.length);return Pf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function D5(e,t){t.forEach(function(r){var n=r[0].map(function(a){return a.t}).join("");if(n.length<=2048)return Be(e,28,_v(n,r[1],r[2]));Be(e,28,_v(n.slice(0,2048),r[1],r[2],n.length));for(var i=2048;i<n.length;i+=2048)Be(e,28,_v(n.slice(i,Math.min(i+2048,n.length)),-1,-1,Math.min(2048,n.length-i)))})}function yse(e,t,r,n,i,a){var s=0;t.z!=null&&(s=i._BIFF2FmtTable.indexOf(t.z),s==-1&&(i._BIFF2FmtTable.push(t.z),s=i._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<i.cellXfs.length&&i.cellXfs[l].numFmtId!=s;++l);l==i.cellXfs.length&&i.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var f=t.t=="d"?hn(ii(t.v,a),a):t.v;i.biff==2&&f==(f|0)&&f>=0&&f<65536?Be(e,2,Nte(r,n,f,l,s)):isNaN(f)?Be(e,5,Cv(r,n,36,"e")):isFinite(f)?Be(e,3,Ste(r,n,f,l,s)):Be(e,5,Cv(r,n,7,"e"));return;case"b":case"e":Be(e,5,Cv(r,n,t.v,t.t));return;case"s":case"str":Be(e,4,vse(r,n,t.v==null?"":String(t.v).slice(0,255)));return}Be(e,1,Pf(null,r,n))}function wse(e,t,r,n,i){var a=t["!data"]!=null,s=Jt(t["!ref"]||"A1"),l="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var h=(((i||{}).Workbook||{}).WBProps||{}).date1904,d=[],m=[],x=s.s.c;x<=s.e.c;++x)f[x]=Bt(x);for(var g=s.s.r;g<=s.e.r;++g)for(a&&(d=t["!data"][g]||[]),l=zt(g),x=s.s.c;x<=s.e.c;++x){var _=a?d[x]:t[f[x]+l];_&&(yse(e,_,g,x,n,h),_.c&&m.push([_.c,g,x]))}D5(e,m)}function bse(e,t){for(var r=t||{},n=kn(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);Be(n,r.biff==4?1033:r.biff==3?521:9,wb(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&Be(n,34,Nn(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=kn();return wse(s,e.Sheets[e.SheetNames[i]],i,r,e),r._BIFF2FmtTable.forEach(function(l){r.biff<=3?Be(n,30,lte(l)):Be(n,1054,cte(l))}),r.cellXfs.forEach(function(l){switch(r.biff){case 2:Be(n,67,fte(l));break;case 3:Be(n,579,f5(l));break;case 4:Be(n,1091,dte(l));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),Be(n,10),n.end()}var Qi=1,Ri=[];function _se(){var e=we(82+8*Ri.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*Ri.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*Ri.length);{e.write_shift(4,Qi),e.write_shift(4,Ri.length+1);for(var t=0,r=0;r<Ri.length;++r)t+=Ri[r]&&Ri[r][1]||0;e.write_shift(4,t),e.write_shift(4,Ri.length)}Ri.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function Sse(e,t){var r=[],n=0,i=kn(),a=Qi,s;t.forEach(function(f,h){var d="",m=f[0].map(function(E){return E.a&&!d&&(d=E.a),E.t}).join("");++Qi;{var x=we(150);x.write_shift(2,15),x.write_shift(2,61444),x.write_shift(4,150),x.write_shift(2,3234),x.write_shift(2,61450),x.write_shift(4,8),x.write_shift(4,Qi),x.write_shift(4,2560),x.write_shift(2,227),x.write_shift(2,61451),x.write_shift(4,84),x.write_shift(2,128),x.write_shift(4,0),x.write_shift(2,139),x.write_shift(4,2),x.write_shift(2,191),x.write_shift(4,524296),x.write_shift(2,344),x.l+=4,x.write_shift(2,385),x.write_shift(4,134217808),x.write_shift(2,387),x.write_shift(4,134217808),x.write_shift(2,389),x.write_shift(4,268435700),x.write_shift(2,447),x.write_shift(4,1048592),x.write_shift(2,448),x.write_shift(4,134217809),x.write_shift(2,451),x.write_shift(4,268435700),x.write_shift(2,513),x.write_shift(4,134217809),x.write_shift(2,515),x.write_shift(4,268435700),x.write_shift(2,575),x.write_shift(4,196609),x.write_shift(2,959),x.write_shift(4,131072|(f[0].hidden?2:0)),x.l+=2,x.write_shift(2,61456),x.write_shift(4,18),x.write_shift(2,3),x.write_shift(2,f[2]+2),x.l+=2,x.write_shift(2,f[1]+1),x.l+=2,x.write_shift(2,f[2]+4),x.l+=2,x.write_shift(2,f[1]+5),x.l+=2,x.l+=2,x.write_shift(2,61457),x.l+=4,x.l=150,h==0?s=x:Be(i,236,x)}n+=150;{var g=we(52);g.write_shift(2,21),g.write_shift(2,18),g.write_shift(2,25),g.write_shift(2,Qi),g.write_shift(2,0),g.l=22,g.write_shift(2,13),g.write_shift(2,22),g.write_shift(4,1651663474),g.write_shift(4,2503426821),g.write_shift(4,2150634280),g.write_shift(4,1768515844+Qi*256),g.write_shift(2,0),g.write_shift(4,0),g.l+=4,Be(i,93,g)}{var _=we(8);_.l+=2,_.write_shift(2,61453),_.l+=4,Be(i,236,_)}n+=8;{var w=we(18);w.write_shift(2,18),w.l+=8,w.write_shift(2,m.length),w.write_shift(2,16),w.l+=4,Be(i,438,w);{var b=we(1+m.length);b.write_shift(1,0),b.write_shift(m.length,m,"sbcs"),Be(i,60,b)}{var S=we(16);S.l+=8,S.write_shift(2,m.length),S.l+=6,Be(i,60,S)}}{var T=we(12+d.length);T.write_shift(2,f[1]),T.write_shift(2,f[2]),T.write_shift(2,0|(f[0].hidden?0:2)),T.write_shift(2,Qi),T.write_shift(2,d.length),T.write_shift(1,0),T.write_shift(d.length,d,"sbcs"),T.l++,r.push(T)}});{var l=we(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Qi),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,a),l.write_shift(4,5),Be(e,236,s?jr([l,s]):l)}e.push(i.end()),r.forEach(function(f){Be(e,28,f)}),Ri.push([a,t.length+1,Qi]),++Qi}function Nse(e,t,r){Be(e,49,ite({sz:12,name:"Arial"},r))}function Ese(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Be(e,1054,ote(i,t[i],r))})}function Tse(e,t){var r=we(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Be(e,2151,r),r=we(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),u5(Jt(t["!ref"]||"A1"),r),r.write_shift(4,4),Be(e,2152,r)}function Cse(e,t){for(var r=0;r<16;++r)Be(e,224,kk({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Be(e,224,kk(n,0,t))})}function kse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Be(e,440,gte(n)),n[1].Tooltip&&Be(e,2048,vte(n))}delete t["!links"]}function Ase(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Be(e,125,bte(Ip(i,n),i))})}}function Pse(e,t,r,n,i,a){var s=16+so(i.cellXfs,t,i);if(t.v==null&&!t.bf){Be(e,513,Jo(r,n,s));return}if(t.bf)Be(e,6,Vne(t,r,n,i,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?hn(ii(t.v,a),a):t.v;isNaN(l)?Be(e,517,bv(r,n,36,s,i,"e")):isFinite(l)?Be(e,515,pte(r,n,l,s)):Be(e,517,bv(r,n,7,s,i,"e"));break;case"b":case"e":Be(e,517,bv(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var f=Sb(i.Strings,t.v==null?"":String(t.v),i.revStrings);Be(e,253,ate(r,n,f,s))}else Be(e,516,ste(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,i));break;default:Be(e,513,Jo(r,n,s))}}function jse(e,t,r){var n=kn(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},f=a["!data"]!=null,h=t.biff==8,d="",m=[],x=Jt(a["!ref"]||"A1"),g=h?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV"+g);x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.r,g-1)}Be(n,2057,wb(r,16,t)),Be(n,13,Ii(1)),Be(n,12,Ii(100)),Be(n,15,Nn(!0)),Be(n,17,Nn(!1)),Be(n,16,Qo(.001)),Be(n,95,Nn(!0)),Be(n,42,Nn(!1)),Be(n,43,Nn(!1)),Be(n,130,Ii(1)),Be(n,128,hte()),Be(n,131,Nn(!1)),Be(n,132,Nn(!1)),h&&Ase(n,a["!cols"]),Be(n,512,ute(x,t));var _=(((r||{}).Workbook||{}).WBProps||{}).date1904;h&&(a["!links"]=[]);for(var w=x.s.c;w<=x.e.c;++w)m[w]=Bt(w);for(var b=[],S=[],T=x.s.r;T<=x.e.r;++T)for(f&&(S=a["!data"][T]||[]),d=zt(T),w=x.s.c;w<=x.e.c;++w){var E=f?S[w]:a[m[w]+d];E&&(Pse(n,E,T,w,t,_),h&&E.l&&a["!links"].push([m[w]+d,E.l]),E.c&&b.push([E.c,T,w]))}var A=l.CodeName||l.name||i;return h?Sse(n,b):D5(n,b),h&&Be(n,574,nte((s.Views||[])[0])),h&&(a["!merges"]||[]).length&&Be(n,229,xte(a["!merges"])),h&&kse(n,a),Be(n,442,c5(A)),h&&Tse(n,a),Be(n,10),n.end()}function Ose(e,t,r){var n=kn(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},l=r.biff==8,f=r.biff==5;if(Be(n,2057,wb(e,5,r)),r.bookType=="xla"&&Be(n,135),Be(n,225,l?Ii(1200):null),Be(n,193,Hee(2)),f&&Be(n,191),f&&Be(n,192),Be(n,226),Be(n,92,Jee("SheetJS",r)),Be(n,66,Ii(l?1200:1252)),l&&Be(n,353,Ii(0)),l&&Be(n,448),Be(n,317,_te(e.SheetNames.length)),l&&e.vbaraw&&Be(n,211),l&&e.vbaraw){var h=s.CodeName||"ThisWorkbook";Be(n,442,c5(h))}Be(n,156,Ii(17)),Be(n,25,Nn(!1)),Be(n,18,Nn(!1)),Be(n,19,Ii(0)),l&&Be(n,431,Nn(!1)),l&&Be(n,444,Ii(0)),Be(n,61,rte()),Be(n,64,Nn(!1)),Be(n,141,Ii(0)),Be(n,34,Nn(Mae(e)=="true")),Be(n,14,Nn(!0)),l&&Be(n,439,Nn(!1)),Be(n,218,Ii(0)),Nse(n,e,r),Ese(n,e.SSF,r),Cse(n,r),l&&Be(n,352,Nn(!1));var d=n.end(),m=kn();l&&Be(m,140,yte()),l&&Ri.length&&Be(m,235,_se()),l&&r.Strings&&gse(m,252,tte(r.Strings)),Be(m,10);var x=m.end(),g=kn(),_=0,w=0;for(w=0;w<e.SheetNames.length;++w)_+=(l?12:11)+(l?2:1)*e.SheetNames[w].length;var b=d.length+_+x.length;for(w=0;w<e.SheetNames.length;++w){var S=a[w]||{};Be(g,133,ete({pos:b,hs:S.Hidden||0,dt:0,name:e.SheetNames[w]},r)),b+=t[w].length}var T=g.end();if(_!=T.length)throw new Error("BS8 "+_+" != "+T.length);var E=[];return d.length&&E.push(d),T.length&&E.push(T),x.length&&E.push(x),jr(E)}function Dse(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=jn(Qt)),e&&e.SSF&&(Cp(),Tp(e.SSF),r.revssf=kp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),Qi=1,Ri=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Nb(r),r.cellXfs=[],so(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=jse(i,r,e);return n.unshift(Ose(e,n,r)),jr(n)}function R5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=fn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Dse(e,t);case 4:case 3:case 2:return bse(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Rse(e,t,r,n){for(var i=e["!merges"]||[],a=[],s={},l=e["!data"]!=null,f=t.s.c;f<=t.e.c;++f){for(var h=0,d=0,m=0;m<i.length;++m)if(!(i[m].s.r>r||i[m].s.c>f)&&!(i[m].e.r<r||i[m].e.c<f)){if(i[m].s.r<r||i[m].s.c<f){h=-1;break}h=i[m].e.r-i[m].s.r+1,d=i[m].e.c-i[m].s.c+1;break}if(!(h<0)){var x=Bt(f)+zt(r),g=l?(e["!data"][r]||[])[f]:e[x];g&&g.t=="n"&&g.v!=null&&!isFinite(g.v)&&(isNaN(g.v)?g={t:"e",v:36,w:Wn[36]}:g={t:"e",v:7,w:Wn[7]});var _=g&&g.v!=null&&(g.h||gv(g.w||(ns(g),g.w)||""))||"";s={},h>1&&(s.rowspan=h),d>1&&(s.colspan=d),n.editable?_='<span contenteditable="true">'+_+"</span>":g&&(s["data-t"]=g&&g.t||"z",g.v!=null&&(s["data-v"]=gv(g.v instanceof Date?g.v.toISOString():g.v)),g.z!=null&&(s["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+gv(g.l.Target)+'">'+_+"</a>")),s.id=(n.id||"sjs")+"-"+x,a.push(qe("td",_,s))}}var w="<tr>";return w+a.join("")+"</tr>"}var Ise='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Fse="</body></html>";function Mse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function I5(e,t){var r=t||{},n=r.header!=null?r.header:Ise,i=r.footer!=null?r.footer:Fse,a=[n],s=fn(e["!ref"]||"A1");if(a.push(Mse(e,s,r)),e["!ref"])for(var l=s.s.r;l<=s.e.r;++l)a.push(Rse(e,s,l,r));return a.push("</table>"+i),a.join("")}function F5(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var i=r||{},a=e["!data"]!=null,s=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var f=typeof i.origin=="string"?ar(i.origin):i.origin;s=f.r,l=f.c}var h=Math.min(i.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var m=fn(e["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),s==-1&&(d.e.r=s=m.e.r+1)}var x=[],g=0,_=e["!rows"]||(e["!rows"]=[]),w=0,b=0,S=0,T=0,E=0,A=0;for(e["!cols"]||(e["!cols"]=[]);w<n.length&&b<h;++w){var k=n[w];if(Bk(k)){if(i.display)continue;_[b]={hidden:!0}}var j=k.cells;for(S=T=0;S<j.length;++S){var P=j[S];if(!(i.display&&Bk(P))){var M=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):eee(P.innerHTML),L=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<x.length;++g){var B=x[g];B.s.c==T+l&&B.s.r<b+s&&b+s<=B.e.r&&(T=B.e.c+1-l,g=-1)}A=+P.getAttribute("colspan")||1,((E=+P.getAttribute("rowspan")||1)>1||A>1)&&x.push({s:{r:b+s,c:T+l},e:{r:b+s+(E||1)-1,c:T+l+(A||1)-1}});var R={t:"s",v:M},U=P.getAttribute("data-t")||P.getAttribute("t")||"";M!=null&&(M.length==0?R.t=U||"z":i.raw||M.trim().length==0||U=="s"||(U=="e"&&Wn[+M]?R={t:"e",v:+M,w:Wn[+M]}:M==="TRUE"?R={t:"b",v:!0}:M==="FALSE"?R={t:"b",v:!1}:isNaN(Ga(M))?isNaN(Sh(M).getDate())?M.charCodeAt(0)==35&&ya[M]!=null&&(R={t:"e",v:ya[M],w:M}):(R={t:"d",v:ii(M)},i.UTC&&(R.v=Ap(R.v)),i.cellDates||(R={t:"n",v:hn(R.v)}),R.z=i.dateNF||Qt[14]):R={t:"n",v:Ga(M)})),R.z===void 0&&L!=null&&(R.z=L);var oe="",V=P.getElementsByTagName("A");if(V&&V.length)for(var ae=0;ae<V.length&&!(V[ae].hasAttribute("href")&&(oe=V[ae].getAttribute("href"),oe.charAt(0)!="#"));++ae);oe&&oe.charAt(0)!="#"&&oe.slice(0,11).toLowerCase()!="javascript:"&&(R.l={Target:oe}),a?(e["!data"][b+s]||(e["!data"][b+s]=[]),e["!data"][b+s][T+l]=R):e[dr({c:T+l,r:b+s})]=R,d.e.c<T+l&&(d.e.c=T+l),T+=A}}++b}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,b-1+s),e["!ref"]=Ir(d),b>=h&&(e["!fullref"]=Ir((d.e.r=n.length-w+b-1+s,d))),e}function M5(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),F5(n,e,t)}function Lse(e,t){var r=Tc(M5(e,t),t);return r}function Bk(e){var t="",r=Bse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Bse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var $se=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+tf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Mr+t}})();function Use(e,t){var r="number",n="",i={"style:name":t},a="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(a="";e[++s]!='"'||e[++s]=='"';)a+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+yt(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+yt(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var l=e.match(/# (\?+)\/(\?+)/);if(l){n+=qe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=e.match(/# (\?+)\/(\d+)/)){n+=qe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=qe("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var f=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(a=e[s].toLowerCase()){case"h":case"s":f=!0,--s;break t;case"m":r:for(var h=s+1;h<e.length;++h)switch(e[h]){case"y":case"d":break r;case"h":case"s":f=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==a[0];)a+=a[0];switch(--s,a){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(a.length%2?"short":"long")+'" number:textual="'+(a.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(a.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(a.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)a+=e[s];--s,n+="<number:text>"+yt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":a=e[++s],n+="<number:text>"+yt(a)+"</number:text>";break;case"/":case":":n+="<number:text>"+yt(a)+"</number:text>";break;default:console.error("unrecognized character "+a+" in ODF format "+e)}if(!f)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");s<e.length;++s)switch(a=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==a[0];)a+=a[0];switch(--s,a){case"h":case"hh":n+='<number:hours number:style="'+(a.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(a.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do a+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(a.match("ss")?"long":"short")+'"'+(a.match(/\./)?' number:decimal-places="'+(a.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)a+=e[s];--s,n+="<number:text>"+yt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+yt(a)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+a+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)a+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+yt(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+yt(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+e);else{var m=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(m.indexOf("0")==-1?"0":m.length-m.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",s=d.index+d[0].length}if(e[s]=='"'){for(a="";e[++s]!='"'||e[++s]=='"';)a+=e[s];--s,n+="<number:text>"+yt(a.replace(/""/g,'"'))+"</number:text>"}}return n?qe("number:"+r+"-style",n,i):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function $k(e,t,r){for(var n=[],i=0;i<e.length;++i){var a=e[i];a&&a.Sheet==(r==-1?null:r)&&n.push(a)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var l=(r==-1?"$":"")+k5(s.Ref);return"        "+qe("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var Uk=(function(){var e=function(i,a){return yt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(i,a,s,l,f,h){var d=[];d.push('      <table:table table:name="'+yt(a.SheetNames[s])+`" table:style-name="ta1">
`);var m=0,x=0,g=fn(i["!ref"]||"A1"),_=i["!merges"]||[],w=0,b=i["!data"]!=null;if(i["!cols"])for(x=0;x<=g.e.c;++x)d.push("        <table:table-column"+(i["!cols"][x]?' table:style-name="co'+i["!cols"][x].ods+'"':"")+`></table:table-column>
`);var S="",T=i["!rows"]||[];for(m=0;m<g.s.r;++m)S=T[m]?' table:style-name="ro'+T[m].ods+'"':"",d.push("        <table:table-row"+S+`></table:table-row>
`);for(;m<=g.e.r;++m){for(S=T[m]?' table:style-name="ro'+T[m].ods+'"':"",d.push("        <table:table-row"+S+`>
`),x=0;x<g.s.c;++x)d.push(t);for(;x<=g.e.c;++x){var E=!1,A={},k="";for(w=0;w!=_.length;++w)if(!(_[w].s.c>x)&&!(_[w].s.r>m)&&!(_[w].e.c<x)&&!(_[w].e.r<m)){(_[w].s.c!=x||_[w].s.r!=m)&&(E=!0),A["table:number-columns-spanned"]=_[w].e.c-_[w].s.c+1,A["table:number-rows-spanned"]=_[w].e.r-_[w].s.r+1;break}if(E){d.push(`          <table:covered-table-cell/>
`);continue}var j=dr({r:m,c:x}),P=b?(i["!data"][m]||[])[x]:i[j];if(P&&P.f&&(A["table:formula"]=yt(lie(P.f)),P.F&&P.F.slice(0,j.length)==j)){var M=fn(P.F);A["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,A["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!P){d.push(t);continue}switch(P.t){case"b":k=P.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=P.v?"true":"false";break;case"n":isFinite(P.v)?(k=P.w||String(P.v||0),A["office:value-type"]="float",A["office:value"]=P.v||0):(isNaN(P.v)?(k="#NUM!",A["table:formula"]="of:=#NUM!"):(k="#DIV/0!",A["table:formula"]="of:="+(P.v<0?"-":"")+"1/0"),A["office:string-value"]="",A["office:value-type"]="string",A["calcext:value-type"]="error");break;case"s":case"str":k=P.v==null?"":P.v,A["office:value-type"]="string";break;case"d":k=P.w||ii(P.v,h).toISOString(),A["office:value-type"]="date",A["office:date-value"]=ii(P.v,h).toISOString(),A["table:style-name"]="ce1";break;default:d.push(t);continue}var L=e(k);if(P.l&&P.l.Target){var B=P.l.Target;B=B.charAt(0)=="#"?"#"+k5(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),L=qe("text:a",L,{"xlink:href":B.replace(/&/g,"&amp;")})}f[P.z]&&(A["table:style-name"]="ce"+f[P.z].slice(1));var R=qe("text:p",L,{});if(P.c){for(var U="",oe="",V={},ae=0;ae<P.c.length;++ae)!U&&P.c[ae].a&&(U=P.c[ae].a),oe+="<text:p>"+e(P.c[ae].t)+"</text:p>";P.c.hidden||(V["office:display"]=!0),R=qe("office:annotation",oe,V)+R}d.push("          "+qe("table:table-cell",R,A)+`
`)}d.push(`        </table:table-row>
`)}return(a.Workbook||{}).Names&&d.push($k(a.Workbook.Names,a.SheetNames,s)),d.push(`      </table:table>
`),d.join("")},n=function(i,a){i.push(` <office:automatic-styles>
`);var s=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var x=d["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;bb(x),x.ods=s;var g=d["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),i.push(`  </style:style>
`),++s}}});var l=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=l;var x=d["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var f={},h=69;return a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d){var m=d["!data"]!=null;if(d["!ref"])for(var x=fn(d["!ref"]),g=0;g<=x.e.r;++g)for(var _=0;_<=x.e.c;++_){var w=m?(d["!data"][g]||[])[_]:d[dr({r:g,c:_})];if(!(!w||!w.z||w.z.toLowerCase()=="general")&&!f[w.z]){var b=Use(w.z,"N"+h);b&&(f[w.z]="N"+h,++h,i.push(b+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Rr(f).forEach(function(d){i.push('<style:style style:name="ce'+f[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+f[d]+`"/>
`)}),i.push(` </office:automatic-styles>
`),f};return function(a,s){var l=[Mr],f=tf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=tf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(l.push("<office:document"+f+h+`>
`),l.push(t5().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+f+`>
`);var d=n(l,a);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((a.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var m=0;m!=a.SheetNames.length;++m)l.push(r(a.Sheets[a.SheetNames[m]],a,m,s,d,((a.Workbook||{}).WBProps||{}).date1904));return(a.Workbook||{}).Names&&l.push($k(a.Workbook.Names,a.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),s.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function L5(e,t){if(t.bookType=="fods")return Uk(e,t);var r=ub(),n="",i=[],a=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,Uk(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",vt(r,n,$se(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Mr+t5()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,Bee(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,Mee(i)),r}var zn=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function Ph(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Yl(qo(e))}function Fn(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):mi(ef(e))}function Zs(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0;r<e.length;++r){var a=e[r],s=a.length;if(s<250)for(var l=0;l<s;++l)n[i++]=a[l];else n.set(a,i),i+=s}return n}function zse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function of(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[zn](0,r)}function B5(e){for(var t={l:0},r=[];t.l<e.length;)r.push(of(e,t));return r}function $5(e){return Zs(e.map(function(t){return ot(t)}))}function yi(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function dt(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,i=of(e,r),a=i&7;i=i/8|0;var s,l=r.l;switch(a){case 0:{for(;e[l++]>=128;);s=e[zn](r.l,l),r.l=l}break;case 1:s=e[zn](l,l+8),r.l=l+8;break;case 2:{var f=of(e,r);s=e[zn](r.l,r.l+f),r.l+=f}break;case 5:s=e[zn](l,l+4),r.l=l+4;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var h={data:s,type:a};t[i]==null&&(t[i]=[]),t[i].push(h)}return t}function ut(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(i){i.data&&(t.push(ot(n*8+i.type)),i.type==2&&t.push(ot(i.data.length)),t.push(i.data))})}),Zs(t)}function jh(e,t){return e?.map(function(r){return t(r.data)})||[]}function Oh(e){for(var t,r=[],n={l:0};n.l<e.length;){var i=of(e,n),a=dt(e[zn](n.l,n.l+i));n.l+=i;var s={id:yi(a[1][0].data),messages:[]};a[2].forEach(function(l){var f=dt(l.data),h=yi(f[3][0].data);s.messages.push({meta:f,data:e[zn](n.l,n.l+h)}),n.l+=h}),(t=a[3])!=null&&t[0]&&(s.merge=yi(a[3][0].data)>>>0>0),r.push(s)}return r}function Zl(e){var t=[];return e.forEach(function(r){var n=[[],[{data:ot(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:ot(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:ot(s.data.length)}],n[2].push({data:ut(s.meta),type:2})});var a=ut(n);t.push(ot(a.length)),t.push(a),i.forEach(function(s){return t.push(s)})}),Zs(t)}function Wse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=of(t,r),i=[],a=r.l;a<t.length;){var s=t[a]&3;if(s==0){var l=t[a++]>>2;if(l<60)++l;else{var f=l-59;l=t[a],f>1&&(l|=t[a+1]<<8),f>2&&(l|=t[a+2]<<16),f>3&&(l|=t[a+3]<<24),l>>>=0,l++,a+=f}i.push(t[zn](a,a+l)),a+=l;continue}else{var h=0,d=0;if(s==1?(d=(t[a]>>2&7)+4,h=(t[a++]&224)<<3,h|=t[a++]):(d=(t[a++]>>2)+1,s==2?(h=t[a]|t[a+1]<<8,a+=2):(h=(t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24)>>>0,a+=4)),h==0)throw new Error("Invalid offset 0");for(var m=i.length-1,x=h;m>=0&&x>=i[m].length;)x-=i[m].length,--m;if(m<0)if(x==0)x=i[m=0].length;else throw new Error("Invalid offset beyond length");if(d<x)i.push(i[m][zn](i[m].length-x,i[m].length-x+d));else{for(x>0&&(i.push(i[m][zn](i[m].length-x)),d-=x),++m;d>=i[m].length;)i.push(i[m]),d-=i[m].length,++m;d&&i.push(i[m][zn](0,d))}i.length>25&&(i=[Zs(i)])}}for(var g=0,_=0;_<i.length;++_)g+=i[_].length;if(g!=n)throw new Error("Unexpected length: ".concat(g," != ").concat(n));return i}function Dh(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,Wse(n,e[zn](r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Zs(t)}function Ql(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=ot(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[zn](r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return Zs(t)}function kv(e,t){var r=new Uint8Array(32),n=Ph(r),i=12,a=0;switch(r[0]=5,e.t){case"n":if(e.z&&Zo(e.z)){r[1]=5,n.setFloat64(i,(Gl(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break}else r[1]=2,zse(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var l=t.rsst.findIndex(function(h){var d;return h.v==s&&h.l==((d=e.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(i,l,!0),a|=16,i+=4}else{var f=t.sst.indexOf(s);f==-1&&(t.sst[f=t.sst.length]=s),r[1]=3,n.setUint32(i,f,!0),a|=8,i+=4}}break;case"d":r[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(Hse(e.c)),n.setUint32(i,t.cmnt.length-1,!0),a|=524288,i+=4),n.setUint32(8,a,!0),r[zn](0,i)}function Av(e,t){var r=new Uint8Array(32),n=Ph(r),i=12,a=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var l=t.rsst.findIndex(function(h){var d;return h.v==s&&h.l==((d=e.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(i,l,!0),a|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(i,t.cmnt.length-1,!0),a|=4096,i+=4),e.t){case"n":r[1]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var f=t.sst.indexOf(s);f==-1&&(t.sst[f=t.sst.length]=s),r[1]=3,n.setUint32(i,f,!0),a|=16,i+=4}break;case"d":r[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=64,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r[zn](0,i)}function Ar(e){var t=dt(e);return yi(t[1][0].data)}function Sn(e){return ut([[],[{type:0,data:ot(e)}]])}function _n(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?B5(e.messages[0].meta[5][0].data):[],i=n.indexOf(t);i==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:$5(n)}])}function Fa(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?B5(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:$5(n.filter(function(i){return i!=t}))}]}function Hse(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function Vse(e,t,r){var n,i,a,s=[[],[{type:0,data:ot(0)}],[{type:0,data:ot(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ot(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ot(1)}]];if(!((n=s[6])!=null&&n[0])||!((i=s[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(s[7][0].data.length<2*e.length){var f=new Uint8Array(2*e.length);f.set(s[7][0].data),s[7][0].data=f}if(s[4][0].data.length<2*e.length){var h=new Uint8Array(2*e.length);h.set(s[4][0].data),s[4][0].data=h}for(var d=Ph(s[7][0].data),m=0,x=[],g=Ph(s[4][0].data),_=0,w=[],b=4,S=0;S<e.length;++S){if(e[S]==null||e[S].t=="z"&&!((a=e[S].c)!=null&&a.length)||e[S].t=="e"){d.setUint16(S*2,65535,!0),g.setUint16(S*2,65535);continue}d.setUint16(S*2,m/b,!0),g.setUint16(S*2,_/b,!0);var T,E;switch(e[S].t){case"d":if(e[S].v instanceof Date){T=kv(e[S],t),E=Av(e[S],t);break}T=kv(e[S],t),E=Av(e[S],t);break;case"s":case"n":case"b":case"z":T=kv(e[S],t),E=Av(e[S],t);break;default:throw new Error("Unsupported value "+e[S])}x.push(T),m+=T.length,w.push(E),_+=E.length,++l}for(s[2][0].data=ot(l),s[5][0].data=ot(5);S<s[7][0].data.length/2;++S)d.setUint16(S*2,65535,!0),g.setUint16(S*2,65535,!0);return s[6][0].data=Zs(x),s[3][0].data=Zs(w),s[8]=[{type:0,data:ot(1)}],s}function G1(e,t){return{meta:[[],[{type:0,data:ot(e)}]],data:t}}function ma(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function Kse(e){var t={},r=[];return e.FileIndex.map(function(n,i){return[n,e.FullPaths[i]]}).forEach(function(n){var i=n[0],a=n[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&Oh(Dh(i.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:a,type:yi(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&Oh(Dh(n.content)).forEach(function(i){i.messages.forEach(function(a){[5,6].forEach(function(s){a.meta[s]&&a.meta[s].forEach(function(l){t[i.id].deps.push(yi(l.data))})})})})}),t}function m0(e,t,r){return ut([[],[{type:0,data:ot(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ot(1)}]])}function zk(e){switch(e){case 0:return m0(99,222,171);case 1:return m0(162,197,240);case 2:return m0(255,189,189)}return m0(Math.random()*255,Math.random()*255,Math.random()*255)}function Gse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=Wt.read(t.numbers,{type:"base64"}),n=Kse(r),i=xa(r,n,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var a=jh(dt(i.messages[0].data)[1],Ar);if(a.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,l){l>=1&&(Xse(r,n,l+1),i=xa(r,n,1),a=jh(dt(i.messages[0].data)[1],Ar)),qse(r,n,e.Sheets[s],s,l,a[l])}),r}function Mt(e,t,r,n){var i=Wt.find(e,t[r].location);if(!i)throw"Could not find ".concat(t[r].location," in Numbers template");var a=Oh(Dh(i.content)),s=a.find(function(l){return l.id==r});n(s,a),i.content=Ql(Zl(a)),i.size=i.content.length}function xa(e,t,r){var n=Wt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var i=Oh(Dh(n.content)),a=i.find(function(s){return s.id==r});return a}function Y1(e,t,r){e[3].push({type:2,data:ut([[],[{type:0,data:ot(t)}],[{type:2,data:Fn(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:Fn(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(0)}]])}),e[1]=[{type:0,data:ot(Math.max(t+1,yi(e[1][0].data)))}]}function So(e,t,r,n,i,a){a||(a=ma({deps:[],location:"",type:t},i));var s="".concat(n,"-").concat(a,".iwa");i[a].location="Root Entry"+s,Wt.utils.cfb_add(e,s,Ql(Zl([{id:a,messages:[G1(t,ut(r))]}])));var l=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Mt(e,i,2,function(f){var h=dt(f.messages[0].data);Y1(h,a||0,l),f.messages[0].data=ut(h)}),a}function ei(e,t,r,n){var i=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex(function(l){var f,h,d=dt(l.data);return(f=d[3])!=null&&f[0]?sf(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&sf(d[2][0].data)==i)}),s=dt(e[3][a].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){s[6].push({type:2,data:ut([[],[{type:0,data:ot(l)}]])})}),e[3][a].data=ut(s)}function Yse(e,t,r,n){var i=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=e[3].findIndex(function(l){var f,h,d=dt(l.data);return(f=d[3])!=null&&f[0]?sf(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&sf(d[2][0].data)==i)}),s=dt(e[3][a].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(l){return yi(dt(l.data)[1][0].data)!=n}),e[3][a].data=ut(s)}function Xse(e,t,r){var n=-1,i=-1,a={};Mt(e,t,1,function(f,h){var d=dt(f.messages[0].data);n=Ar(dt(f.messages[0].data)[1][0].data),i=ma({deps:[1],location:t[n].location,type:2},t),a[n]=i,_n(f,i),d[1].push({type:2,data:Sn(i)});var m=xa(e,t,n);m.id=i,t[1].location==t[i].location?h.push(m):Mt(e,t,i,function(x,g){return g.push(m)}),f.messages[0].data=ut(d)});var s=-1;Mt(e,t,i,function(f,h){for(var d=dt(f.messages[0].data),m=3;m<=69;++m)delete d[m];var x=jh(d[2],Ar);x.forEach(function(_){return Fa(f,_)}),s=ma({deps:[i],location:t[x[0]].location,type:t[x[0]].type},t),_n(f,s),a[x[0]]=s,d[2]=[{type:2,data:Sn(s)}];var g=xa(e,t,x[0]);g.id=s,t[x[0]].location==t[i].location?h.push(g):(Mt(e,t,2,function(_){var w=dt(_.messages[0].data);ei(w,t,i,s),_.messages[0].data=ut(w)}),Mt(e,t,s,function(_,w){return w.push(g)})),f.messages[0].data=ut(d)});var l=-1;Mt(e,t,s,function(f,h){for(var d=dt(f.messages[0].data),m=dt(d[1][0].data),x=3;x<=69;++x)delete m[x];var g=Ar(m[2][0].data);m[2][0].data=Sn(a[g]),d[1][0].data=ut(m);var _=Ar(d[2][0].data);Fa(f,_),l=ma({deps:[s],location:t[_].location,type:t[_].type},t),_n(f,l),a[_]=l,d[2][0].data=Sn(l);var w=xa(e,t,_);w.id=l,t[s].location==t[l].location?h.push(w):Mt(e,t,l,function(b,S){return S.push(w)}),f.messages[0].data=ut(d)}),Mt(e,t,l,function(f,h){var d,m,x=dt(f.messages[0].data),g=sf(x[1][0].data),_=g.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(x[1][0].data=Fn(_),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(k){return delete x[k]}),x[45]){var w=dt(x[45][0].data),b=Ar(w[1][0].data);Fa(f,b),delete x[45]}if(x[70]){var S=dt(x[70][0].data);(d=S[2])==null||d.forEach(function(k){var j=dt(k.data);[2,3].map(function(P){return j[P][0]}).forEach(function(P){var M=dt(P.data);if(M[8]){var L=Ar(M[8][0].data);Fa(f,L)}})}),delete x[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(k){if(x[k]){var j=Ar(x[k][0].data);delete x[k],Fa(f,j)}});var T=dt(x[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(k){var j;if((j=T[k])!=null&&j[0]){var P=Ar(T[k][0].data),M=ma({deps:[l],location:t[P].location,type:t[P].type},t);Fa(f,P),_n(f,M),a[P]=M;var L=xa(e,t,P);if(L.id=M,t[P].location==t[l].location)h.push(L);else{t[M].location=t[P].location.replace(P.toString(),M.toString()),t[M].location==t[P].location&&(t[M].location=t[M].location.replace(/\.iwa/,"-".concat(M,".iwa"))),Wt.utils.cfb_add(e,t[M].location,Ql(Zl([L])));var B=t[M].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Mt(e,t,2,function(R){var U=dt(R.messages[0].data);Y1(U,M,B),ei(U,t,l,M),R.messages[0].data=ut(U)})}T[k][0].data=Sn(M)}});var E=dt(T[1][0].data);(m=E[2])==null||m.forEach(function(k){var j=Ar(k.data),P=ma({deps:[l],location:t[j].location,type:t[j].type},t);Fa(f,j),_n(f,P),a[j]=P;var M=xa(e,t,j);if(M.id=P,t[j].location==t[l].location)h.push(M);else{t[P].location=t[j].location.replace(j.toString(),P.toString()),t[P].location==t[j].location&&(t[P].location=t[P].location.replace(/\.iwa/,"-".concat(P,".iwa"))),Wt.utils.cfb_add(e,t[P].location,Ql(Zl([M])));var L=t[P].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Mt(e,t,2,function(B){var R=dt(B.messages[0].data);Y1(R,P,L),ei(R,t,l,P),B.messages[0].data=ut(R)})}k.data=Sn(P)}),T[1][0].data=ut(E);var A=dt(T[3][0].data);A[1].forEach(function(k){var j=dt(k.data),P=Ar(j[2][0].data),M=a[P];if(!a[P]){M=ma({deps:[l],location:"",type:t[P].type},t),t[M].location="Root Entry/Index/Tables/Tile-".concat(M,".iwa"),a[P]=M;var L=xa(e,t,P);L.id=M,Fa(f,P),_n(f,M),Wt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(M,".iwa"),Ql(Zl([L]))),Mt(e,t,2,function(B){var R=dt(B.messages[0].data);R[3].push({type:2,data:ut([[],[{type:0,data:ot(M)}],[{type:2,data:Fn("Tables/Tile")}],[{type:2,data:Fn("Tables/Tile-".concat(M))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(0)}]])}),R[1]=[{type:0,data:ot(Math.max(M+1,yi(R[1][0].data)))}],ei(R,t,l,M),B.messages[0].data=ut(R)})}j[2][0].data=Sn(M),k.data=ut(j)}),T[3][0].data=ut(A)}x[4][0].data=ut(T),f.messages[0].data=ut(x)})}function qse(e,t,r,n,i,a){var s=[];Mt(e,t,a,function(h){var d=dt(h.messages[0].data);d[1]=[{type:2,data:Fn(n)}],s=jh(d[2],Ar),h.messages[0].data=ut(d)});var l=xa(e,t,s[0]),f=Ar(dt(l.messages[0].data)[2][0].data);Mt(e,t,f,function(h,d){return Zse(e,t,r,h,d,f)})}function Zse(e,t,r,n,i,a){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=fn(r["!ref"]);s.s.r=s.s.c=0;var l=!1;s.e.c>999&&(l=!0,s.e.c=999),s.e.r>999999&&(l=!0,s.e.r=999999),l&&console.error("Truncating to ".concat(Ir(s)));var f=[];if(r["!data"])f=r["!data"];else{for(var h=[],d=0;d<=s.e.c;++d)h[d]=Bt(d);for(var m=0;m<=s.e.r;++m){f[m]=[];var x=""+(m+1);for(d=0;d<=s.e.c;++d){var g=r[h[d]+x];g&&(f[m][d]=g)}}}var _={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},w=dt(n.messages[0].data);{w[6][0].data=ot(s.e.r+1),w[7][0].data=ot(s.e.c+1),delete w[46];var b=dt(w[4][0].data);{var S=Ar(dt(b[1][0].data)[2][0].data);Mt(e,t,S,function(ne,ie){var de,ge=dt(ne.messages[0].data);if((de=ge?.[2])!=null&&de[0])for(var Oe=0;Oe<f.length;++Oe){var fe=dt(ge[2][0].data);fe[1][0].data=ot(Oe),fe[4][0].data=ot(f[Oe].length),ge[2][Oe]={type:ge[2][0].type,data:ut(fe)}}ne.messages[0].data=ut(ge)});var T=Ar(b[2][0].data);Mt(e,t,T,function(ne,ie){for(var de=dt(ne.messages[0].data),ge=0;ge<=s.e.c;++ge){var Oe=dt(de[2][0].data);Oe[1][0].data=ot(ge),Oe[4][0].data=ot(s.e.r+1),de[2][ge]={type:de[2][0].type,data:ut(Oe)}}ne.messages[0].data=ut(de)});var E=dt(b[9][0].data);E[1]=[];var A=dt(b[3][0].data);{var k=256;A[2]=[{type:0,data:ot(k)}];var j=Ar(dt(A[1][0].data)[2][0].data),P=(function(){var ne=xa(e,t,2),ie=dt(ne.messages[0].data),de=ie[3].filter(function(ge){return yi(dt(ge.data)[1][0].data)==j});return de?.length?yi(dt(de[0].data)[12][0].data):0})();Wt.utils.cfb_del(e,t[j].location),Mt(e,t,2,function(ne){var ie=dt(ne.messages[0].data);ie[3]=ie[3].filter(function(de){return yi(dt(de.data)[1][0].data)!=j}),Yse(ie,t,a,j),ne.messages[0].data=ut(ie)}),Fa(n,j),A[1]=[];for(var M=Math.ceil((s.e.r+1)/k),L=0;L<M;++L){var B=ma({deps:[],location:"",type:6002},t);t[B].location="Root Entry/Index/Tables/Tile-".concat(B,".iwa");for(var R=[[],[{type:0,data:ot(0)}],[{type:0,data:ot(Math.min(s.e.r+1,(L+1)*k))}],[{type:0,data:ot(0)}],[{type:0,data:ot(Math.min((L+1)*k,s.e.r+1)-L*k)}],[],[{type:0,data:ot(5)}],[{type:0,data:ot(1)}],[{type:0,data:ot(1)}]],U=L*k;U<=Math.min(s.e.r,(L+1)*k-1);++U){var oe=Vse(f[U],_);oe[1][0].data=ot(U-L*k),R[5].push({data:ut(oe),type:2})}A[1].push({type:2,data:ut([[],[{type:0,data:ot(L)}],[{type:2,data:Sn(B)}]])});var V={id:B,messages:[G1(6002,ut(R))]},ae=Ql(Zl([V]));Wt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(B,".iwa"),ae),Mt(e,t,2,function(ne){var ie=dt(ne.messages[0].data);ie[3].push({type:2,data:ut([[],[{type:0,data:ot(B)}],[{type:2,data:Fn("Tables/Tile")}],[{type:2,data:Fn("Tables/Tile-".concat(B))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(P)}]])}),ie[1]=[{type:0,data:ot(Math.max(B+1,yi(ie[1][0].data)))}],ei(ie,t,a,B),ne.messages[0].data=ut(ie)}),_n(n,B),E[1].push({type:2,data:ut([[],[{type:0,data:ot(L*k)}],[{type:0,data:ot(L)}]])})}}if(b[3][0].data=ut(A),b[9][0].data=ut(E),b[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var le=ma({type:6144,deps:[a],location:t[a].location},t);i.push({id:le,messages:[G1(6144,ut([[],r["!merges"].map(function(ne){return{type:2,data:ut([[],[{type:2,data:ut([[],[{type:5,data:new Uint8Array(new Uint16Array([ne.s.r,ne.s.c]).buffer)}]])}],[{type:2,data:ut([[],[{type:5,data:new Uint8Array(new Uint16Array([ne.e.r-ne.s.r+1,ne.e.c-ne.s.c+1]).buffer)}]])}]])}})]))]}),b[13]=[{type:2,data:Sn(le)}],Mt(e,t,2,function(ne){var ie=dt(ne.messages[0].data);ei(ie,t,a,le),ne.messages[0].data=ut(ie)}),_n(n,le)}else delete b[13];var J=Ar(b[4][0].data);Mt(e,t,J,function(ne){var ie=dt(ne.messages[0].data);ie[3]=[],_.sst.forEach(function(de,ge){ge!=0&&ie[3].push({type:2,data:ut([[],[{type:0,data:ot(ge)}],[{type:0,data:ot(1)}],[{type:2,data:Fn(de)}]])})}),ne.messages[0].data=ut(ie)});var re=Ar(b[17][0].data);if(Mt(e,t,re,function(ne){var ie=dt(ne.messages[0].data);ie[3]=[];var de=[904980,903835,903815,903845];_.rsst.forEach(function(ge,Oe){if(Oe!=0){var fe=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Fn(ge.v)}]];fe[10]=[{type:0,data:new Uint8Array([1])}],fe[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],fe[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],fe[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],fe[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],fe[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],fe[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],fe[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],fe[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var O=ma({deps:[],location:"",type:2001},t),D=[];if(ge.l){var z=So(e,2032,[[],[],[{type:2,data:Fn(ge.l)}]],"/Index/Tables/DataList",t);fe[11]=[];var H=[[],[]];H[1]||(H[1]=[]),H[1].push({type:2,data:ut([[],[{type:0,data:ot(0)}],[{type:2,data:Sn(z)}]])}),fe[11][0]={type:2,data:ut(H)},D.push(z)}So(e,2001,fe,"/Index/Tables/DataList",t,O),Mt(e,t,O,function(Re){de.forEach(function(Ee){return _n(Re,Ee)}),D.forEach(function(Ee){return _n(Re,Ee)})});var te=So(e,6218,[[],[{type:2,data:Sn(O)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);Mt(e,t,te,function(Re){return _n(Re,O)}),ie[3].push({type:2,data:ut([[],[{type:0,data:ot(Oe)}],[{type:0,data:ot(1)}],[],[],[],[],[],[],[{type:2,data:Sn(te)}]])}),_n(ne,te),Mt(e,t,2,function(Re){var Ee=dt(Re.messages[0].data);ei(Ee,t,re,te),ei(Ee,t,te,O),ei(Ee,t,O,D),ei(Ee,t,O,de),Re.messages[0].data=ut(Ee)})}}),ne.messages[0].data=ut(ie)}),_.cmnt.length>1){var Z=Ar(b[19][0].data),se={},G=0;Mt(e,t,Z,function(ne){var ie=dt(ne.messages[0].data);ie[3]=[],_.cmnt.forEach(function(de,ge){if(ge!=0){var Oe=[];de.replies&&de.replies.forEach(function(D){se[D.a||""]||(se[D.a||""]=So(e,212,[[],[{type:2,data:Fn(D.a||"")}],[{type:2,data:zk(++G)}],[],[{type:0,data:ot(0)}]],"/Index/Tables/DataList",t));var z=se[D.a||""],H=So(e,3056,[[],[{type:2,data:Fn(D.t||"")}],[{type:2,data:ut([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Sn(z)}]],"/Index/Tables/DataList",t);Mt(e,t,H,function(te){return _n(te,z)}),Oe.push(H),Mt(e,t,2,function(te){var Re=dt(te.messages[0].data);ei(Re,t,H,z),te.messages[0].data=ut(Re)})}),se[de.a||""]||(se[de.a||""]=So(e,212,[[],[{type:2,data:Fn(de.a||"")}],[{type:2,data:zk(++G)}],[],[{type:0,data:ot(0)}]],"/Index/Tables/DataList",t));var fe=se[de.a||""],O=So(e,3056,[[],[{type:2,data:Fn(de.t||"")}],[{type:2,data:ut([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Sn(fe)}],Oe.map(function(D){return{type:2,data:Sn(D)}}),[{type:2,data:ut([[],[{type:0,data:ot(ge)}],[{type:0,data:ot(0)}]])}]],"/Index/Tables/DataList",t);Mt(e,t,O,function(D){_n(D,fe),Oe.forEach(function(z){return _n(D,z)})}),ie[3].push({type:2,data:ut([[],[{type:0,data:ot(ge)}],[{type:0,data:ot(1)}],[],[],[],[],[],[],[],[{type:2,data:Sn(O)}]])}),_n(ne,O),Mt(e,t,2,function(D){var z=dt(D.messages[0].data);ei(z,t,Z,O),ei(z,t,O,fe),Oe.length&&ei(z,t,O,Oe),D.messages[0].data=ut(z)})}}),ie[2][0].data=ot(_.cmnt.length+1),ne.messages[0].data=ut(ie)})}}w[4][0].data=ut(b)}n.messages[0].data=ut(w)}function Qse(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Nb(e){Qse([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Jse(e,t){e&&!e.SSF&&(e.SSF=jn(Qt)),e&&e.SSF&&(Cp(),Tp(e.SSF),t.revssf=kp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,i=Q3();Nb(t=t||{});var a=ub(),s="",l=0;if(t.cellXfs=[],so(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",vt(a,s,r5(e.Props,t)),i.coreprops.push(s),Ot(t.rels,2,s,Et.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,vt(a,s,i5(e.Props)),i.extprops.push(s),Ot(t.rels,3,s,Et.EXT_PROPS),e.Custprops!==e.Props&&Rr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",vt(a,s,a5(e.Custprops)),i.custprops.push(s),Ot(t.rels,4,s,Et.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,vt(a,s,Rae(l-1,t,e,m)),i.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Et.WS[0])}if(x){var _=x["!comments"],w=!1,b="";if(_&&_.length>0){var S=!1;_.forEach(function(E){E[1].forEach(function(A){A.T==!0&&(S=!0)})}),S&&(b="xl/threadedComments/threadedComment"+l+".xml",vt(a,b,y5(_,d,t)),i.threadedcomments.push(b),Ot(m,-1,"../threadedComments/threadedComment"+l+".xml",Et.TCMNT)),b="xl/comments"+l+"."+r,vt(a,b,Nre(_)),i.comments.push(b),Ot(m,-1,"../comments"+l+"."+r,Et.CMNT),w=!0}x["!legacy"]&&w&&vt(a,"xl/drawings/vmlDrawing"+l+".vml",v5(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&vt(a,e5(s),Xl(m))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,vt(a,s,Rte(t.Strings)),i.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,Et.SST)),s="xl/workbook."+r,vt(a,s,tse(e)),i.workbooks.push(s),Ot(t.rels,1,s,Et.WB),s="xl/theme/theme1.xml";var T=g5(e.Themes,t);return vt(a,s,T),i.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",Et.THEME),s="xl/styles."+r,vt(a,s,lre(e,t)),i.styles.push(s),Ot(t.wbrels,-1,"styles."+r,Et.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",vt(a,s,e.vbaraw),i.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",Et.VBA)),s="xl/metadata."+r,vt(a,s,xre()),i.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,Et.XLMETA),d.length>1&&(s="xl/persons/person.xml",vt(a,s,w5(d)),i.people.push(s),Ot(t.wbrels,-1,"persons/person.xml",Et.PEOPLE)),vt(a,"[Content_Types].xml",J3(i,t)),vt(a,"_rels/.rels",Xl(t.rels)),vt(a,"xl/_rels/workbook."+r+".rels",Xl(t.wbrels)),delete t.revssf,delete t.ssf,a}function eoe(e,t){e&&!e.SSF&&(e.SSF=jn(Qt)),e&&e.SSF&&(Cp(),Tp(e.SSF),t.revssf=kp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Tre.indexOf(t.bookType)>-1,i=Q3();Nb(t=t||{});var a=ub(),s="",l=0;if(t.cellXfs=[],so(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",vt(a,s,r5(e.Props,t)),i.coreprops.push(s),Ot(t.rels,2,s,Et.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,vt(a,s,i5(e.Props)),i.extprops.push(s),Ot(t.rels,3,s,Et.EXT_PROPS),e.Custprops!==e.Props&&Rr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",vt(a,s,a5(e.Custprops)),i.custprops.push(s),Ot(t.rels,4,s,Et.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var m={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,vt(a,s,bie(l-1,t,e,m)),i.sheets.push(s),Ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Et.WS[0])}if(x){var _=x["!comments"],w=!1,b="";if(_&&_.length>0){var S=!1;_.forEach(function(T){T[1].forEach(function(E){E.T==!0&&(S=!0)})}),S&&(b="xl/threadedComments/threadedComment"+l+".xml",vt(a,b,y5(_,d,t)),i.threadedcomments.push(b),Ot(m,-1,"../threadedComments/threadedComment"+l+".xml",Et.TCMNT)),b="xl/comments"+l+"."+r,vt(a,b,wre(_)),i.comments.push(b),Ot(m,-1,"../comments"+l+"."+r,Et.CMNT),w=!0}x["!legacy"]&&w&&vt(a,"xl/drawings/vmlDrawing"+l+".vml",v5(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&vt(a,e5(s),Xl(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,vt(a,s,Pte(t.Strings,t)),i.strs.push(s),Ot(t.wbrels,-1,"sharedStrings."+r,Et.SST)),s="xl/workbook."+r,vt(a,s,Uae(e)),i.workbooks.push(s),Ot(t.rels,1,s,Et.WB),s="xl/theme/theme1.xml",vt(a,s,g5(e.Themes,t)),i.themes.push(s),Ot(t.wbrels,-1,"theme/theme1.xml",Et.THEME),s="xl/styles."+r,vt(a,s,Ute(e,t)),i.styles.push(s),Ot(t.wbrels,-1,"styles."+r,Et.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",vt(a,s,e.vbaraw),i.vba.push(s),Ot(t.wbrels,-1,"vbaProject.bin",Et.VBA)),s="xl/metadata."+r,vt(a,s,gre()),i.metadata.push(s),Ot(t.wbrels,-1,"metadata."+r,Et.XLMETA),d.length>1&&(s="xl/persons/person.xml",vt(a,s,w5(d)),i.people.push(s),Ot(t.wbrels,-1,"persons/person.xml",Et.PEOPLE)),vt(a,"[Content_Types].xml",J3(i,t)),vt(a,"_rels/.rels",Xl(t.rels)),vt(a,"xl/_rels/workbook."+r+".rels",Xl(t.wbrels)),delete t.revssf,delete t.ssf,a}function toe(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Xs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function U5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return kf(t.file,Wt.write(e,{type:Dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Wt.write(e,t)}function roe(e,t){switch(t.bookType){case"ods":return L5(e,t);case"numbers":return Gse(e,t);case"xlsb":return Jse(e,t);default:return eoe(e,t)}}function noe(e,t){var r=jn(t||{}),n=roe(e,r);return ioe(n,r)}function ioe(e,t){var r={},n=Dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Wt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ep(i))}return t.password&&typeof encrypt_agile<"u"?U5(encrypt_agile(i,t.password),t):t.type==="file"?kf(t.file,i):t.type=="string"?Yl(i):i}function aoe(e,t){var r=t||{},n=mse(e,r);return U5(n,r)}function pa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return gh(ef(n));case"binary":return ef(n);case"string":return e;case"file":return kf(t.file,n,"utf8");case"buffer":return Dt?Ea(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function soe(e,t){switch(t.type){case"base64":return sJ(e);case"binary":return e;case"string":return e;case"file":return kf(t.file,e,"binary");case"buffer":return Dt?Ea(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function x0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?gh(r):t.type=="string"?Yl(r):r;case"file":return kf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function z5(e,t){aJ(),$ae(e);var r=jn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=z5(e,r);return r.type="array",Ep(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pa(hse(e,r),r);case"slk":case"sylk":return pa(Tte.from_sheet(e.Sheets[e.SheetNames[i]],r,e),r);case"htm":case"html":return pa(I5(e.Sheets[e.SheetNames[i]],r),r);case"txt":return soe(W5(e.Sheets[e.SheetNames[i]],r),r);case"csv":return pa(Eb(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return pa(Cte.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return x0(Ete.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return pa(kte.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return pa(Fte(e.Sheets[e.SheetNames[i]]),r);case"eth":return pa(d5.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return pa(L5(e,r),r);case"wk1":return x0(Pk.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return x0(Pk.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),x0(R5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),aoe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return noe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ooe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function loe(e,t,r){var n=r||{};return n.type="file",n.file=t,ooe(n),z5(e,n)}function coe(e,t,r,n,i,a,s){var l=zt(r),f=s.defval,h=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,m=e["!data"]!=null,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!m||e["!data"][r])for(var g=t.s.c;g<=t.e.c;++g){var _=m?(e["!data"][r]||[])[g]:e[n[g]+l];if(_==null||_.t===void 0){if(f===void 0)continue;a[g]!=null&&(x[a[g]]=f);continue}var w=_.v;switch(_.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"b":case"n":if(!_.z||!Zo(_.z)||(w=Gl(w),typeof w=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(w=cc(new Date(w)));break;default:throw new Error("unrecognized type "+_.t)}if(a[g]!=null){if(w==null)if(_.t=="e"&&w===null)x[a[g]]=null;else if(f!==void 0)x[a[g]]=f;else if(h&&w===null)x[a[g]]=null;else continue;else x[a[g]]=(_.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:h)?w:ns(_,w,s);w!=null&&(d=!1)}}return{row:x,isempty:d}}function X1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,l="",f={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},d=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":f=Jt(d);break;case"number":f=Jt(e["!ref"]),f.s.r=d;break;default:f=d}n>0&&(i=0);var m=zt(f.s.r),x=[],g=[],_=0,w=0,b=e["!data"]!=null,S=f.s.r,T=0,E={};b&&!e["!data"][S]&&(e["!data"][S]=[]);var A=h.skipHidden&&e["!cols"]||[],k=h.skipHidden&&e["!rows"]||[];for(T=f.s.c;T<=f.e.c;++T)if(!(A[T]||{}).hidden)switch(x[T]=Bt(T),r=b?e["!data"][S][T]:e[x[T]+m],n){case 1:a[T]=T-f.s.c;break;case 2:a[T]=x[T];break;case 3:a[T]=h.header[T-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=ns(r,null,h),w=E[s]||0,!w)E[s]=1;else{do l=s+"_"+w++;while(E[l]);E[s]=w,E[l]=1}a[T]=l}for(S=f.s.r+i;S<=f.e.r;++S)if(!(k[S]||{}).hidden){var j=coe(e,f,S,x,n,a,h);(j.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(g[_++]=j.row)}return g.length=_,g}var Wk=/"/g;function uoe(e,t,r,n,i,a,s,l,f){for(var h=!0,d=[],m="",x=zt(r),g=e["!data"]!=null,_=g&&e["!data"][r]||[],w=t.s.c;w<=t.e.c;++w)if(n[w]){var b=g?_[w]:e[n[w]+x];if(b==null)m="";else if(b.v!=null){h=!1,m=""+(f.rawNumbers&&b.t=="n"?b.v:ns(b,null,f));for(var S=0,T=0;S!==m.length;++S)if((T=m.charCodeAt(S))===i||T===a||T===34||f.forceQuotes){m='"'+m.replace(Wk,'""')+'"';break}m=="ID"&&l==0&&d.length==0&&(m='"ID"')}else b.f!=null&&!b.F?(h=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(Wk,'""')+'"')):m="";d.push(m)}if(f.strip)for(;d[d.length-1]==="";)--d.length;return f.blankrows===!1&&h?null:d.join(s)}function Eb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var i=Jt(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,f=l.charCodeAt(0),h="",d=[],m=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(m[g]||{}).hidden||(d[g]=Bt(g));for(var _=0,w=i.s.r;w<=i.e.r;++w)(x[w]||{}).hidden||(h=uoe(e,i,w,d,s,f,a,_,n),h!=null&&(h||n.blankrows!==!1)&&r.push((_++?l:"")+h));return r.join("")}function W5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Eb(e,t);return r}function foe(e,t){var r="",n,i="";if(e==null||e["!ref"]==null)return[];var a=Jt(e["!ref"]),s="",l=[],f,h=[],d=e["!data"]!=null;for(f=a.s.c;f<=a.e.c;++f)l[f]=Bt(f);for(var m=a.s.r;m<=a.e.r;++m)for(s=zt(m),f=a.s.c;f<=a.e.c;++f)if(r=l[f]+s,n=d?(e["!data"][m]||[])[f]:e[r],i="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;i=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)i=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)i=""+n.v;else if(n.t=="b")i=n.v?"TRUE":"FALSE";else if(n.w!==void 0)i="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?i="'"+n.v:i=""+n.v}}h[h.length]=r+"="+i}return h}function H5(e,t,r){var n=r||{},i=e?e["!data"]!=null:n.dense,a=+!n.skipHeader,s=e||{};!e&&i&&(s["!data"]=[]);var l=0,f=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?ar(n.origin):n.origin;l=h.r,f=h.c}var d={s:{c:0,r:0},e:{c:f,r:l+t.length-1+a}};if(s["!ref"]){var m=Jt(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+a)}else l==-1&&(l=0,d.e.r=t.length-1+a);var x=n.header||[],g=0,_=[];t.forEach(function(b,S){i&&!s["!data"][l+S+a]&&(s["!data"][l+S+a]=[]),i&&(_=s["!data"][l+S+a]),Rr(b).forEach(function(T){(g=x.indexOf(T))==-1&&(x[g=x.length]=T);var E=b[T],A="z",k="",j=i?"":Bt(f+g)+zt(l+S+a),P=i?_[f+g]:s[j];E&&typeof E=="object"&&!(E instanceof Date)?i?_[f+g]=E:s[j]=E:(typeof E=="number"?A="n":typeof E=="boolean"?A="b":typeof E=="string"?A="s":E instanceof Date?(A="d",n.UTC||(E=Ap(E)),n.cellDates||(A="n",E=hn(E)),k=P!=null&&P.z&&Zo(P.z)?P.z:n.dateNF||Qt[14]):E===null&&n.nullError&&(A="e",E=0),P?(P.t=A,P.v=E,delete P.w,delete P.R,k&&(P.z=k)):i?_[f+g]=P={t:A,v:E}:s[j]=P={t:A,v:E},k&&(P.z=k))})}),d.e.c=Math.max(d.e.c,f+x.length-1);var w=zt(l);if(i&&!s["!data"][l]&&(s["!data"][l]=[]),a)for(g=0;g<x.length;++g)i?s["!data"][l][g+f]={t:"s",v:x[g]}:s[Bt(g+f)+w]={t:"s",v:x[g]};return s["!ref"]=Ir(d),s}function doe(e,t){return H5(null,e,t)}function Rh(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=ar(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Rh(e,dr(t)):Rh(e,Bt(r||0)+zt(t))}function hoe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function poe(e,t){var r={SheetNames:[],Sheets:{}};return e&&Tb(r,e,t||"Sheet1"),r}function Tb(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var a=r.match(/\d+$/);i=a&&+a[0]||0;var s=a&&r.slice(0,a.index)||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(j5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function moe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hoe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function xoe(e,t){return e.z=t,e}function V5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function goe(e,t,r){return V5(e,"#"+t,r)}function voe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yoe(e,t,r,n){for(var i=typeof t!="string"?t:Jt(t),a=typeof t=="string"?t:Ir(t),s=i.s.r;s<=i.e.r;++s)for(var l=i.s.c;l<=i.e.c;++l){var f=Rh(e,s,l);f.t="n",f.F=a,delete f.v,s==i.s.r&&l==i.s.c&&(f.f=r,n&&(f.D=!0))}var h=fn(e["!ref"]);return h.s.r>i.s.r&&(h.s.r=i.s.r),h.s.c>i.s.c&&(h.s.c=i.s.c),h.e.r<i.e.r&&(h.e.r=i.e.r),h.e.c<i.e.c&&(h.e.c=i.e.c),e["!ref"]=Ir(h),e}var Pv={encode_col:Bt,encode_row:zt,encode_cell:dr,encode_range:Ir,decode_col:xb,decode_row:mb,split_cell:pee,decode_cell:ar,decode_range:fn,format_cell:ns,sheet_new:mee,sheet_add_aoa:G3,sheet_add_json:H5,sheet_add_dom:F5,aoa_to_sheet:Cc,json_to_sheet:doe,table_to_sheet:M5,table_to_book:Lse,sheet_to_csv:Eb,sheet_to_txt:W5,sheet_to_json:X1,sheet_to_html:I5,sheet_to_formulae:foe,sheet_to_row_object_array:X1,sheet_get_cell:Rh,book_new:poe,book_append_sheet:Tb,book_set_sheet_visibility:moe,cell_set_number_format:xoe,cell_set_hyperlink:V5,cell_set_internal_link:goe,cell_add_comment:voe,sheet_set_array_formula:yoe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const g0=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",woe=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")}`:"0",boe=e=>{if(!e)return null;const t=e.match(/nhn t\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},Su=e=>boe(e.note)||e.sender||"",jv=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},_oe=[{value:"receipt",label:"Bin Nhn",description:"M n bt u bng MAV"},{value:"refund",label:"Hon tin",description:"Cc bin nhn khc"}],da={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankBin:"970422"};function Soe(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[i,a]=v.useState(""),[s,l]=v.useState("receipt"),[f,h]=v.useState([]),[d,m]=v.useState(!1),[x,g]=v.useState(null),[_,w]=v.useState(!1),[b,S]=v.useState(null),[T,E]=v.useState(!1),[A,k]=v.useState(!1),[j,P]=v.useState(!1),[M,L]=v.useState(!1),[B,R]=v.useState(null),[U,oe]=v.useState(""),[V,ae]=v.useState(""),[le,J]=v.useState(""),[re,Z]=v.useState(""),se=v.useRef(null),G=v.useMemo(()=>{const pe=U.replace(/[^\d]/g,"");if(!pe)return 0;const Fe=Number(pe);return Number.isFinite(Fe)?Fe:0},[U]),ne=G>0?`${G.toLocaleString("vi-VN")} VND`:"Cha cp nht",ie=v.useMemo(()=>ib({accountNumber:da.accountNumber,bankCode:da.bankBin,amount:G,description:V.trim()}),[G,V]),de=()=>{k(!0),J(U),Z(V)},ge=()=>{k(!1),P(!1),L(!1)},Oe=()=>{const pe=le.replace(/[^\d]/g,"");oe(pe),P(!1)},fe=()=>{ae(re.trim()),L(!1)},O=V.trim()||"Cha c ni dung",D=v.useMemo(()=>{const pe=e.trim().toLowerCase(),Fe=je=>{const $e=je.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!$e)return null;const[,Ae,xt,he]=$e.map(Number);return new Date(he,xt-1,Ae).getTime()},Pe=Fe(r),We=Fe(i);return f.filter(je=>{const $e=jv(je.orderCode),Ae=!pe||[je.orderCode,je.note,Su(je)].map(Qe=>Qe?.toLowerCase()??"").some(Qe=>Qe.includes(pe)),xt=Fe(Pr(je.paidAt)||""),he=Pe===null||xt===null||xt>=Pe,De=We===null||xt===null||xt<=We;return Ae&&he&&De&&$e===s})},[f,e,r,i,s]),z=v.useMemo(()=>{const pe=f.reduce((Pe,We)=>(We.orderCode||"").toUpperCase().startsWith("MAV")?Pe+We.amount:Pe,0),Fe=f.length>0?f[0].paidAt??"":"";return[{name:"Tng Bin Nhn",value:f.length.toString(),icon:Jl,accent:Or.sky},{name:"Tng S Tin",value:woe(pe),icon:Jl,accent:Or.emerald},{name:"Bin Lai Gn Nht",value:Fe?Pr(Fe)??"--":"--",icon:o4,accent:Or.violet}]},[f]),H=v.useMemo(()=>f.reduce((pe,Fe)=>{const Pe=jv(Fe.orderCode);return pe[Pe]+=1,pe},{receipt:0,refund:0}),[f]);v.useEffect(()=>{(async()=>{try{m(!0),g(null);const Fe=await Tt("/api/payment-receipts");if(!Fe.ok)throw new Error("Khng th ti bin nhn.");const Pe=await Fe.json(),We=Ae=>typeof Ae=="string"?Ae:"",je=Ae=>({id:Number(Ae?.id)||0,orderCode:We(Ae?.orderCode??Ae?.[Ol.orderCode]),paidAt:We(Ae?.paidAt??Ae?.[Ol.paidDate]),amount:Number(Ae?.amount??Ae?.[Ol.amount])||0,sender:We(Ae?.sender??Ae?.[Ol.sender]),receiver:We(Ae?.receiver??Ae?.[Ol.receiver]),note:We(Ae?.note??Ae?.[Ol.note])}),$e=Array.isArray(Pe?.receipts)?Pe.receipts:Array.isArray(Pe)?Pe:[];h($e.map(je))}catch(Fe){console.error(Fe),g(Fe instanceof Error?Fe.message:"Khng th ti bin nhn.")}finally{m(!1)}})()},[]);const te=pe=>{R(Fe=>Fe===pe?null:pe)},Re=()=>{S(null),w(!1)},Ee=()=>{if(!D.length)return;const pe=["#","M n","Ngi gi","Ngi nhn","S tin gc","S tin nh dng","Ni dung chuyn khon","Ngy thanh ton","Nhm"],Fe=D.map(($e,Ae)=>[Ae+1,$e.orderCode||"",Su($e),$e.receiver||"",$e.amount,g0($e.amount),$e.note||"",$e.paidAt?Pr($e.paidAt):"",jv($e.orderCode)==="receipt"?"Bin nhn":"Hon tin"]),Pe=Pv.aoa_to_sheet([pe,...Fe]);Pe["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}];const We=Pv.book_new();Pv.book_append_sheet(We,Pe,"Bin nhn thanh ton");const je=new Date().toISOString().slice(0,10).replace(/-/g,"");loe(We,`payment_receipts_${je}.xlsx`)},me=d||D.length===0;v.useEffect(()=>{const pe=Fe=>{se.current&&!se.current.contains(Fe.target)&&E(!1)};return document.addEventListener("mousedown",pe),()=>document.removeEventListener("mousedown",pe)},[]);const xe=pe=>{const Fe=pe.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!Fe)return pe;const[,Pe,We,je]=Fe;return`${je}/${We}/${Pe}`},Ce=r&&i?`${r} - ${i}`:"dd/mm/yyyy - dd/mm/yyyy",Le=pe=>{const Fe=pe.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!Fe)return"";const[,Pe,We,je]=Fe;return`${je}-${We}-${Pe}`};return u.jsxs(u.Fragment,{children:[A&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:u.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative",children:[u.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:ge,children:u.jsx(zr,{className:"h-6 w-6"})}),u.jsxs("div",{className:"px-6 py-10 space-y-6",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h2",{className:"text-2xl font-semibold",children:"To thng tin thanh ton qua QR Code"}),u.jsx("p",{className:"text-sm text-slate-300",children:"Qut m QR  chuyn khon nhanh chng. in s tin v ni dung  cp nht chi tit."})]}),u.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[u.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Qut m QR  thanh ton"}),u.jsx("div",{className:"rounded-2xl bg-white p-4",children:u.jsx("img",{src:ie,alt:"QR thanh ton",className:"h-64 w-64 object-contain"})}),u.jsx("a",{href:ie,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400",children:"Ti nh QR"}),u.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[u.jsxs("p",{children:["Ngn hng:"," ",u.jsx("span",{className:"font-semibold",children:da.bankName})]}),u.jsxs("p",{children:["S ti khon:"," ",u.jsx("span",{className:"font-semibold",children:da.accountNumber})]}),u.jsxs("p",{children:["Ch ti khon:"," ",u.jsx("span",{className:"font-semibold uppercase",children:da.accountHolder})]}),u.jsxs("p",{children:["S tin:"," ",u.jsx("span",{className:"font-semibold text-rose-200",children:ne})]}),u.jsxs("p",{children:["Ni dung:"," ",u.jsx("span",{className:"font-semibold text-violet-200",children:O})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[u.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[u.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngn hng"}),u.jsx("p",{className:"text-lg font-semibold text-white",children:da.bankName})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[u.jsx("span",{children:"Th hng"}),u.jsx("span",{className:"font-semibold text-white",children:da.accountHolder})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"text-sm text-slate-300",children:"S Ti Khon"}),u.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:da.accountNumber})]})]}),u.jsxs("div",{className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:()=>{P(!0),J(U||"")},children:"+ Thm s tin"}),j&&u.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[u.jsx("input",{type:"text",placeholder:"V d: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:le,onChange:pe=>J(pe.target.value),onBlur:Oe}),u.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:Oe,children:"OK"})]})]}),u.jsxs("div",{children:[u.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:()=>{L(!0),Z(V||"")},children:"+ Thm ni dung"}),M&&u.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[u.jsx("input",{type:"text",placeholder:"Nhp ni dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:re,onChange:pe=>Z(pe.target.value),onBlur:fe}),u.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:fe,children:"OK"})]})]})]}),u.jsxs("div",{className:"rounded-2xl bg-slate-900/60 p-4 text-sm text-slate-200 space-y-2",children:[u.jsxs("p",{children:[u.jsx("span",{className:"text-slate-400",children:"S tin hin ti:"})," ",u.jsx("span",{className:"font-semibold text-white",children:ne})]}),u.jsxs("p",{children:[u.jsx("span",{className:"text-slate-400",children:"Ni dung hin ti:"})," ",u.jsx("span",{className:"font-semibold text-white",children:O})]}),u.jsx("p",{className:"text-xs text-slate-500",children:"* Nhn OK hoc ri khi  nhp  cp nht thng tin vo QR."})]})]})]})]})]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white drop-shadow-sm",children:"Bin nhn thanh ton"}),u.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Theo di giao dch chuyn n c lu trong h thng"})]}),u.jsx(ba,{icon:qa,className:"mt-4 sm:mt-0",onClick:de,children:"Thm bin nhn"})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:z.map(pe=>u.jsx(Ua,{title:pe.name,value:pe.value,icon:pe.icon,accent:pe.accent},pe.name))})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4 relative z-50",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(el,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Tm m n ngi gi hoc ghi ch...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 bg-gray-50/60 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:e,onChange:pe=>t(pe.target.value)})]}),u.jsxs("div",{className:"relative z-[120] flex items-stretch",ref:se,children:[u.jsxs("button",{type:"button",onClick:()=>E(pe=>!pe),className:`flex items-center justify-between gap-3 px-4 py-3 rounded-2xl border transition w-full lg:w-64 ${T?"border-indigo-400/70 bg-indigo-900/60 shadow-[0_10px_30px_-18px_rgba(79,70,229,0.65)]":"border-white/15 bg-slate-900/70 text-white hover:bg-slate-800/70 shadow-[0_10px_26px_-18px_rgba(0,0,0,0.65)]"} text-white`,children:[u.jsx("div",{className:"flex flex-col text-left",children:u.jsx("span",{className:"text-sm font-medium",children:Ce})}),u.jsx(r4,{className:`w-5 h-5 ${T?"text-indigo-300":"text-slate-200"}`})]}),T&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-80 bg-white border border-gray-200 rounded-2xl shadow-xl z-[150] p-4 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"T Ngy"}),u.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:Le(r),onChange:pe=>n(pe.target.value?xe(pe.target.value):"")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"n Ngy"}),u.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:Le(i),onChange:pe=>a(pe.target.value?xe(pe.target.value):"")})]})]}),u.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[u.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-800",onClick:()=>{n(""),a("")},children:"Xa Khong"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 border border-gray-200 rounded-lg hover:bg-indigo-500/10",onClick:()=>E(!1),children:"ng"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",onClick:()=>E(!1),children:"p Dng"})]})]})]})]}),u.jsx("button",{type:"button",onClick:Ee,disabled:me,className:`px-5 py-3 rounded-2xl bg-gray-900 text-white text-sm font-semibold transition-colors shadow-sm ${me?"opacity-60 cursor-not-allowed":"hover:bg-gray-700"}`,children:"Ti V"})]}),x&&u.jsx("div",{className:"text-sm text-red-600",children:x})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-slate-800/75 via-slate-800/60 to-slate-900/80 border border-white/12 p-4 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.8),0_14px_36px_-28px_rgba(255,255,255,0.18)] backdrop-blur-sm flex flex-col sm:flex-row gap-3 text-slate-200",children:_oe.map(pe=>{const Fe=s===pe.value;return u.jsx("button",{type:"button",onClick:()=>l(pe.value),className:`flex-1 min-w-[180px] text-left rounded-2xl border p-4 transition shadow-[0_12px_28px_-18px_rgba(0,0,0,0.65)] ${Fe?"bg-gradient-to-r from-indigo-500 to-violet-500 text-white border-white/50 shadow-[0_16px_45px_-22px_rgba(79,70,229,0.65)]":"bg-slate-800/70 text-slate-100 border-white/12 hover:bg-slate-700/70 hover:border-white/20"}`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold drop-shadow-sm",children:pe.label}),u.jsx("p",{className:"text-xs text-slate-300 mt-1",children:pe.description})]}),u.jsx("span",{className:`text-lg font-semibold ${Fe?"text-white":"text-slate-100"}`,children:H[pe.value]})]})},pe.value)})}),u.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[u.jsx("thead",{className:"bg-slate-900/90",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"M n"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Nhn"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"S Tin"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ni Dung Chuyn Khon"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngy Thanh Ton"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:D.map((pe,Fe)=>{const Pe=B===pe.id;return u.jsxs(Xa.Fragment,{children:[u.jsxs("tr",{className:`transition ${Fe%2===0?"bg-slate-900/55":"bg-indigo-950/40"} hover:bg-indigo-600/25 ${Pe?"ring-2 ring-indigo-400/60":""} cursor-pointer`,onClick:()=>te(pe.id),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-semibold",children:pe.orderCode||"--"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-white",children:Su(pe)||"--"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-white",children:pe.receiver||da.accountNumber})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-white",children:g0(pe.amount)}),u.jsx("td",{className:"px-6 py-4 text-sm text-white/90 max-w-xs",children:u.jsx("span",{className:"block truncate text-white/90",children:pe.note||"--"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:pe.paidAt?Pr(pe.paidAt):"--"})]}),Pe&&u.jsx("tr",{className:"bg-indigo-900/35",children:u.jsx("td",{colSpan:6,className:"px-6 pb-5 pt-2",children:u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-900/70 p-4 text-sm text-white/90 space-y-2",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"M n"}),u.jsx("p",{className:"font-semibold text-white",children:pe.orderCode||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngi gi"}),u.jsx("p",{className:"font-semibold text-white",children:Su(pe)||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngi nhn"}),u.jsx("p",{className:"font-semibold text-white",children:da.accountNumber})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"S tin"}),u.jsx("p",{className:"font-semibold text-emerald-200",children:g0(pe.amount)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngy thanh ton"}),u.jsx("p",{className:"font-semibold text-white",children:pe.paidAt?Pr(pe.paidAt):"--"})]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ni dung chuyn khon"}),u.jsx("p",{className:"mt-1 rounded-xl bg-white/5 px-3 py-2 text-white",children:pe.note||"Khng c ghi ch"})]})]})})})]},pe.id)})})]})}),!d&&D.length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng C Bin Nhn"}),u.jsx("div",{className:"text-white/60",children:"Th t kha khc"})]}),d&&u.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"ang ti d liu..."})]}),_&&b&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl",children:[u.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tit bin nhn"}),u.jsx("button",{onClick:Re,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"ng",children:u.jsx(zr,{className:"h-5 w-5"})})]}),u.jsxs("div",{className:"px-5 py-4 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"M n"}),u.jsx("p",{className:"font-semibold text-gray-900",children:b.orderCode||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngy Thanh Ton"}),u.jsx("p",{className:"font-semibold text-gray-900",children:b.paidAt?Pr(b.paidAt):"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Gi"}),u.jsx("p",{className:"font-semibold text-gray-900",children:Su(b)||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Nhn"}),u.jsx("p",{className:"font-semibold text-gray-900",children:b.receiver||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"S Tin"}),u.jsx("p",{className:"font-semibold text-gray-900",children:g0(b.amount)})]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Ni Dung Chuyn Khon"}),u.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:b.note||"Khng c ghi ch"})]})]}),u.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:u.jsx("button",{onClick:Re,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"ng"})})]})})]})]})}const In="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",v0=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();function Noe(){const[e,t]=v.useState([]),[r,n]=v.useState(!1),[i,a]=v.useState(null),[s,l]=v.useState(""),[f,h]=v.useState(null),[d,m]=v.useState(null);v.useEffect(()=>{let E=!0;const A=j=>j?Array.isArray(j)?j:Array.isArray(j.items)?j.items:[]:[];return(async()=>{n(!0),a(null);try{let j=await Tt(Nt.WAREHOUSE);if(j.status===404&&(j=await Tt("/api/warehouses")),!j.ok)throw new Error(`Khng ti c d liu (${j.status})`);const P=await j.json(),M=A(P);E&&t(M)}catch(j){E&&a(j?.message||"Li khng xc nh")}finally{E&&n(!1)}})(),()=>{E=!1}},[]);const x=E=>{h(E.id??null),m({...E})},g=()=>{h(null),m(null)},_=(E,A)=>{m(k=>({...k||{},[E]:A}))},w=async E=>{if(!(!E&&f!=="new"||!d)){n(!0),a(null);try{if(f==="new"){const A=await Tt(Nt.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!A.ok)throw new Error(`To mi tht bi (${A.status})`);const k=await A.json();t(j=>[...j,k]),g()}else{const A=await Tt(`${Nt.WAREHOUSE}/${E}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!A.ok)throw new Error(`Cp nht tht bi (${A.status})`);const k=await A.json();t(j=>j.map(P=>P.id===E?{...P,...k}:P)),g()}}catch(A){a(A?.message||"Li khi cp nht")}finally{n(!1)}}},b=async E=>{if(E&&confirm("Bn c chc mun xa bn ghi ny?")){n(!0),a(null);try{const A=await Tt(`${Nt.WAREHOUSE}/${E}`,{method:"DELETE"});if(!A.ok)throw new Error(`Xa tht bi (${A.status})`);t(k=>k.filter(j=>j.id!==E)),f===E&&g()}catch(A){a(A?.message||"Li khi xa")}finally{n(!1)}}},S=()=>{h("new"),m({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Tn"})},T=v.useMemo(()=>({filtered:e.filter(A=>{if(!s.trim())return!0;const k=v0(s);return[A.category,A.account,A.password,A.backup_email,A.two_fa,A.note,A.status].some(j=>v0(j).includes(k))}).sort((A,k)=>{const j=v0(A.category),P=v0(k.category);return j.localeCompare(P,"vi")})}),[e,s]);return u.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ey,{className:"h-7 w-7 text-indigo-300"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-semibold text-white",children:"Lu tr"}),u.jsx("p",{className:"text-sm text-white/70",children:"Hng ang cn tn kho (cha ghp vo n hng)"})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 shadow-lg shadow-indigo-900/40 p-4 space-y-3",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(el,{className:"h-5 w-5 text-white/60 absolute left-3 top-2.5"}),u.jsx("input",{className:`${In} pl-10`,placeholder:"Tm theo gi, ti khon, nh cung cp...",value:s,onChange:E=>l(E.target.value)})]}),u.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm font-semibold disabled:opacity-60",disabled:r,children:[u.jsx(qa,{className:"h-4 w-4"}),"Thm"]}),r&&u.jsxs("div",{className:"text-sm text-white/80 flex items-center gap-2",children:[u.jsx("span",{className:"animate-spin h-4 w-4 rounded-full border-2 border-white/40 border-t-transparent"}),"ang ti..."]}),i&&u.jsxs("div",{className:"text-sm text-rose-200 flex items-center gap-2",children:[u.jsx(iy,{className:"h-5 w-5"}),i]})]}),u.jsx("div",{className:"overflow-auto rounded-xl border border-white/10 bg-white/5",children:u.jsxs("table",{className:"min-w-full text-sm text-white",children:[u.jsx("thead",{className:"bg-white/10 text-left",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Loi"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ti khon"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mt khu"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mail d phng"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"2FA"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Trng thi"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ghi ch"}),u.jsx("th",{className:"px-4 py-2 font-semibold text-center",children:"Thao tc"})]})}),u.jsxs("tbody",{children:[f==="new"&&d&&u.jsxs("tr",{className:"border-t border-white/5 bg-white/5",children:[u.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.category||"",onChange:E=>_("category",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20 font-medium`,value:d.account||"",onChange:E=>_("account",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.password||"",onChange:E=>_("password",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.backup_email||"",onChange:E=>_("backup_email",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.two_fa||"",onChange:E=>_("two_fa",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.status||"",onChange:E=>_("status",E.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:d.note||"",onChange:E=>_("note",E.target.value)})}),u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsxs("div",{className:"inline-flex items-center gap-2",children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>w(void 0),disabled:r,title:"Lu",children:u.jsx(Mo,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:g,disabled:r,title:"Hy",children:u.jsx(zr,{className:"h-4 w-4"})})]})})]}),T.filtered.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-white/70",children:r?"ang ti d liu...":"Khng c hng tn kho"})}):T.filtered.map(E=>{const A=f===E.id,k=A&&d||E;return u.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[u.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.category||"",onChange:j=>_("category",j.target.value)}):E.category||"N/A"}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20 font-medium`,value:k.account||"",onChange:j=>_("account",j.target.value)}):u.jsx("div",{className:"font-medium",children:E.account||"Cha c ti khon"})}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.password||"",onChange:j=>_("password",j.target.value)}):E.password||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.backup_email||"",onChange:j=>_("backup_email",j.target.value)}):E.backup_email||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.two_fa||"",onChange:j=>_("two_fa",j.target.value)}):E.two_fa||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.status||"",onChange:j=>_("status",j.target.value)}):u.jsx("span",{className:"inline-flex rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white",children:E.status||"--"})}),u.jsx("td",{className:"px-4 py-2",children:A?u.jsx("input",{className:`${In} bg-white/10 border-white/20`,value:k.note||"",onChange:j=>_("note",j.target.value)}):u.jsx("div",{className:"text-white/80 whitespace-pre-wrap break-words",children:E.note||"--"})}),u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsx("div",{className:"inline-flex items-center gap-2",children:A?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>w(E.id),disabled:r,title:"Lu",children:u.jsx(Mo,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-rose-600/70 hover:bg-rose-600 text-white transition disabled:opacity-60",onClick:()=>b(E.id),disabled:r,title:"Xa",children:u.jsx(Lo,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:g,disabled:r,title:"Hy",children:u.jsx(zr,{className:"h-4 w-4"})})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-indigo-100 hover:text-white transition disabled:opacity-60",onClick:()=>x(E),disabled:r,title:"Sa",children:u.jsx(Mh,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-rose-200 hover:text-rose-100 transition disabled:opacity-60",onClick:()=>b(E.id),disabled:r,title:"Xa",children:u.jsx(Lo,{className:"h-4 w-4"})})]})})})]},E.id??`${E.category??""}-${E.account??""}`)})]})]})})]})]})}function Eoe({children:e}){const{user:t,loading:r}=oy(),n=eo();return r?null:t?u.jsx(u.Fragment,{children:e}):u.jsx(Dv,{to:"/login",replace:!0,state:{from:n.pathname}})}function Toe(){const[e,t]=v.useState(!1);return u.jsx(II,{children:u.jsx(q6,{children:u.jsxs(uS,{children:[u.jsx(wn,{path:"/login",element:u.jsx(hQ,{})}),u.jsx(wn,{path:"/*",element:u.jsx(Eoe,{children:u.jsxs("div",{className:"min-h-screen app-aurora",children:[u.jsx(Z6,{isOpen:e,setIsOpen:t}),u.jsxs("div",{className:"transition-all duration-300 ease-in-out lg:ml-64 print-shell",children:[u.jsx("div",{className:"h-16 lg:hidden"}),u.jsx("main",{className:"p-0 pt-[10px] pl-[10px] max-w-none",children:u.jsxs(uS,{children:[u.jsx(wn,{path:"/",element:u.jsx(Dv,{to:"/dashboard",replace:!0})}),u.jsx(wn,{path:"/dashboard",element:u.jsx($q,{})}),u.jsx(wn,{path:"/orders",element:u.jsx(sZ,{})}),u.jsx(wn,{path:"/package-products",element:u.jsx(CZ,{})}),u.jsx(wn,{path:"/product-info",element:u.jsx(UZ,{})}),u.jsx(wn,{path:"/stats",element:u.jsx(SQ,{})}),u.jsx(wn,{path:"/sources",element:u.jsx(BQ,{})}),u.jsx(wn,{path:"/pricing",element:u.jsx(dQ,{})}),u.jsx(wn,{path:"/bill-order",element:u.jsx(iJ,{})}),u.jsx(wn,{path:"/show-price",element:u.jsx(YQ,{})}),u.jsx(wn,{path:"/invoices",element:u.jsx(Soe,{})}),u.jsx(wn,{path:"/warehouse",element:u.jsx(Noe,{})}),u.jsx(wn,{path:"*",element:u.jsx(Dv,{to:"/dashboard",replace:!0})})]})})]})]})})})]})})})}LR.createRoot(document.getElementById("root")).render(u.jsx(Toe,{}));
