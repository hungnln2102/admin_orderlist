function CI(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function ys(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ex={exports:{}},Au={},Tx={exports:{}},Pt={};var sS;function AI(){if(sS)return Pt;sS=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.iterator;function x(ie){return ie===null||typeof ie!="object"?null:(ie=m&&ie[m]||ie["@@iterator"],typeof ie=="function"?ie:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function w(ie,he,De){this.props=ie,this.context=he,this.refs=_,this.updater=De||g}w.prototype.isReactComponent={},w.prototype.setState=function(ie,he){if(typeof ie!="object"&&typeof ie!="function"&&ie!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ie,he,"setState")},w.prototype.forceUpdate=function(ie){this.updater.enqueueForceUpdate(this,ie,"forceUpdate")};function S(){}S.prototype=w.prototype;function A(ie,he,De){this.props=ie,this.context=he,this.refs=_,this.updater=De||g}var T=A.prototype=new S;T.constructor=A,b(T,w.prototype),T.isPureReactComponent=!0;var D=Array.isArray,O=Object.prototype.hasOwnProperty,I={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function z(ie,he,De){var We,Ve={},Ge=null,Te=null;if(he!=null)for(We in he.ref!==void 0&&(Te=he.ref),he.key!==void 0&&(Ge=""+he.key),he)O.call(he,We)&&!j.hasOwnProperty(We)&&(Ve[We]=he[We]);var U=arguments.length-2;if(U===1)Ve.children=De;else if(1<U){for(var H=Array(U),X=0;X<U;X++)H[X]=arguments[X+2];Ve.children=H}if(ie&&ie.defaultProps)for(We in U=ie.defaultProps,U)Ve[We]===void 0&&(Ve[We]=U[We]);return{$$typeof:e,type:ie,key:Ge,ref:Te,props:Ve,_owner:I.current}}function R(ie,he){return{$$typeof:e,type:ie.type,key:he,ref:ie.ref,props:ie.props,_owner:ie._owner}}function q(ie){return typeof ie=="object"&&ie!==null&&ie.$$typeof===e}function V(ie){var he={"=":"=0",":":"=2"};return"$"+ie.replace(/[=:]/g,function(De){return he[De]})}var J=/\/+/g;function ue(ie,he){return typeof ie=="object"&&ie!==null&&ie.key!=null?V(""+ie.key):he.toString(36)}function Ne(ie,he,De,We,Ve){var Ge=typeof ie;(Ge==="undefined"||Ge==="boolean")&&(ie=null);var Te=!1;if(ie===null)Te=!0;else switch(Ge){case"string":case"number":Te=!0;break;case"object":switch(ie.$$typeof){case e:case t:Te=!0}}if(Te)return Te=ie,Ve=Ve(Te),ie=We===""?"."+ue(Te,0):We,D(Ve)?(De="",ie!=null&&(De=ie.replace(J,"$&/")+"/"),Ne(Ve,he,De,"",function(X){return X})):Ve!=null&&(q(Ve)&&(Ve=R(Ve,De+(!Ve.key||Te&&Te.key===Ve.key?"":(""+Ve.key).replace(J,"$&/")+"/")+ie)),he.push(Ve)),1;if(Te=0,We=We===""?".":We+":",D(ie))for(var U=0;U<ie.length;U++){Ge=ie[U];var H=We+ue(Ge,U);Te+=Ne(Ge,he,De,H,Ve)}else if(H=x(ie),typeof H=="function")for(ie=H.call(ie),U=0;!(Ge=ie.next()).done;)Ge=Ge.value,H=We+ue(Ge,U++),Te+=Ne(Ge,he,De,H,Ve);else if(Ge==="object")throw he=String(ie),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(ie).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.");return Te}function pe(ie,he,De){if(ie==null)return ie;var We=[],Ve=0;return Ne(ie,We,"","",function(Ge){return he.call(De,Ge,Ve++)}),We}function Ie(ie){if(ie._status===-1){var he=ie._result;he=he(),he.then(function(De){(ie._status===0||ie._status===-1)&&(ie._status=1,ie._result=De)},function(De){(ie._status===0||ie._status===-1)&&(ie._status=2,ie._result=De)}),ie._status===-1&&(ie._status=0,ie._result=he)}if(ie._status===1)return ie._result.default;throw ie._result}var xe={current:null},ye={transition:null},ge={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:ye,ReactCurrentOwner:I};function Oe(){throw Error("act(...) is not supported in production builds of React.")}return Pt.Children={map:pe,forEach:function(ie,he,De){pe(ie,function(){he.apply(this,arguments)},De)},count:function(ie){var he=0;return pe(ie,function(){he++}),he},toArray:function(ie){return pe(ie,function(he){return he})||[]},only:function(ie){if(!q(ie))throw Error("React.Children.only expected to receive a single React element child.");return ie}},Pt.Component=w,Pt.Fragment=r,Pt.Profiler=a,Pt.PureComponent=A,Pt.StrictMode=n,Pt.Suspense=f,Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ge,Pt.act=Oe,Pt.cloneElement=function(ie,he,De){if(ie==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ie+".");var We=b({},ie.props),Ve=ie.key,Ge=ie.ref,Te=ie._owner;if(he!=null){if(he.ref!==void 0&&(Ge=he.ref,Te=I.current),he.key!==void 0&&(Ve=""+he.key),ie.type&&ie.type.defaultProps)var U=ie.type.defaultProps;for(H in he)O.call(he,H)&&!j.hasOwnProperty(H)&&(We[H]=he[H]===void 0&&U!==void 0?U[H]:he[H])}var H=arguments.length-2;if(H===1)We.children=De;else if(1<H){U=Array(H);for(var X=0;X<H;X++)U[X]=arguments[X+2];We.children=U}return{$$typeof:e,type:ie.type,key:Ve,ref:Ge,props:We,_owner:Te}},Pt.createContext=function(ie){return ie={$$typeof:s,_currentValue:ie,_currentValue2:ie,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ie.Provider={$$typeof:i,_context:ie},ie.Consumer=ie},Pt.createElement=z,Pt.createFactory=function(ie){var he=z.bind(null,ie);return he.type=ie,he},Pt.createRef=function(){return{current:null}},Pt.forwardRef=function(ie){return{$$typeof:c,render:ie}},Pt.isValidElement=q,Pt.lazy=function(ie){return{$$typeof:d,_payload:{_status:-1,_result:ie},_init:Ie}},Pt.memo=function(ie,he){return{$$typeof:h,type:ie,compare:he===void 0?null:he}},Pt.startTransition=function(ie){var he=ye.transition;ye.transition={};try{ie()}finally{ye.transition=he}},Pt.unstable_act=Oe,Pt.useCallback=function(ie,he){return xe.current.useCallback(ie,he)},Pt.useContext=function(ie){return xe.current.useContext(ie)},Pt.useDebugValue=function(){},Pt.useDeferredValue=function(ie){return xe.current.useDeferredValue(ie)},Pt.useEffect=function(ie,he){return xe.current.useEffect(ie,he)},Pt.useId=function(){return xe.current.useId()},Pt.useImperativeHandle=function(ie,he,De){return xe.current.useImperativeHandle(ie,he,De)},Pt.useInsertionEffect=function(ie,he){return xe.current.useInsertionEffect(ie,he)},Pt.useLayoutEffect=function(ie,he){return xe.current.useLayoutEffect(ie,he)},Pt.useMemo=function(ie,he){return xe.current.useMemo(ie,he)},Pt.useReducer=function(ie,he,De){return xe.current.useReducer(ie,he,De)},Pt.useRef=function(ie){return xe.current.useRef(ie)},Pt.useState=function(ie){return xe.current.useState(ie)},Pt.useSyncExternalStore=function(ie,he,De){return xe.current.useSyncExternalStore(ie,he,De)},Pt.useTransition=function(){return xe.current.useTransition()},Pt.version="18.3.1",Pt}var oS;function Ac(){return oS||(oS=1,Tx.exports=AI()),Tx.exports}var lS;function jI(){if(lS)return Au;lS=1;var e=Ac(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(c,f,h){var d,m={},x=null,g=null;h!==void 0&&(x=""+h),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(g=f.ref);for(d in f)n.call(f,d)&&!i.hasOwnProperty(d)&&(m[d]=f[d]);if(c&&c.defaultProps)for(d in f=c.defaultProps,f)m[d]===void 0&&(m[d]=f[d]);return{$$typeof:t,type:c,key:x,ref:g,props:m,_owner:a.current}}return Au.Fragment=r,Au.jsx=s,Au.jsxs=s,Au}var cS;function PI(){return cS||(cS=1,Ex.exports=jI()),Ex.exports}var u=PI(),qd={},kx={exports:{}},ma={},Cx={exports:{}},Ax={};var uS;function OI(){return uS||(uS=1,(function(e){function t(ye,ge){var Oe=ye.length;ye.push(ge);e:for(;0<Oe;){var ie=Oe-1>>>1,he=ye[ie];if(0<a(he,ge))ye[ie]=ge,ye[Oe]=he,Oe=ie;else break e}}function r(ye){return ye.length===0?null:ye[0]}function n(ye){if(ye.length===0)return null;var ge=ye[0],Oe=ye.pop();if(Oe!==ge){ye[0]=Oe;e:for(var ie=0,he=ye.length,De=he>>>1;ie<De;){var We=2*(ie+1)-1,Ve=ye[We],Ge=We+1,Te=ye[Ge];if(0>a(Ve,Oe))Ge<he&&0>a(Te,Ve)?(ye[ie]=Te,ye[Ge]=Oe,ie=Ge):(ye[ie]=Ve,ye[We]=Oe,ie=We);else if(Ge<he&&0>a(Te,Oe))ye[ie]=Te,ye[Ge]=Oe,ie=Ge;else break e}}return ge}function a(ye,ge){var Oe=ye.sortIndex-ge.sortIndex;return Oe!==0?Oe:ye.id-ge.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,c=s.now();e.unstable_now=function(){return s.now()-c}}var f=[],h=[],d=1,m=null,x=3,g=!1,b=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(ye){for(var ge=r(h);ge!==null;){if(ge.callback===null)n(h);else if(ge.startTime<=ye)n(h),ge.sortIndex=ge.expirationTime,t(f,ge);else break;ge=r(h)}}function D(ye){if(_=!1,T(ye),!b)if(r(f)!==null)b=!0,Ie(O);else{var ge=r(h);ge!==null&&xe(D,ge.startTime-ye)}}function O(ye,ge){b=!1,_&&(_=!1,S(z),z=-1),g=!0;var Oe=x;try{for(T(ge),m=r(f);m!==null&&(!(m.expirationTime>ge)||ye&&!V());){var ie=m.callback;if(typeof ie=="function"){m.callback=null,x=m.priorityLevel;var he=ie(m.expirationTime<=ge);ge=e.unstable_now(),typeof he=="function"?m.callback=he:m===r(f)&&n(f),T(ge)}else n(f);m=r(f)}if(m!==null)var De=!0;else{var We=r(h);We!==null&&xe(D,We.startTime-ge),De=!1}return De}finally{m=null,x=Oe,g=!1}}var I=!1,j=null,z=-1,R=5,q=-1;function V(){return!(e.unstable_now()-q<R)}function J(){if(j!==null){var ye=e.unstable_now();q=ye;var ge=!0;try{ge=j(!0,ye)}finally{ge?ue():(I=!1,j=null)}}else I=!1}var ue;if(typeof A=="function")ue=function(){A(J)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,pe=Ne.port2;Ne.port1.onmessage=J,ue=function(){pe.postMessage(null)}}else ue=function(){w(J,0)};function Ie(ye){j=ye,I||(I=!0,ue())}function xe(ye,ge){z=w(function(){ye(e.unstable_now())},ge)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ye){ye.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,Ie(O))},e.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ye?Math.floor(1e3/ye):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(f)},e.unstable_next=function(ye){switch(x){case 1:case 2:case 3:var ge=3;break;default:ge=x}var Oe=x;x=ge;try{return ye()}finally{x=Oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ye,ge){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Oe=x;x=ye;try{return ge()}finally{x=Oe}},e.unstable_scheduleCallback=function(ye,ge,Oe){var ie=e.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?ie+Oe:ie):Oe=ie,ye){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=Oe+he,ye={id:d++,callback:ge,priorityLevel:ye,startTime:Oe,expirationTime:he,sortIndex:-1},Oe>ie?(ye.sortIndex=Oe,t(h,ye),r(f)===null&&ye===r(h)&&(_?(S(z),z=-1):_=!0,xe(D,Oe-ie))):(ye.sortIndex=he,t(f,ye),b||g||(b=!0,Ie(O))),ye},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(ye){var ge=x;return function(){var Oe=x;x=ge;try{return ye.apply(this,arguments)}finally{x=Oe}}}})(Ax)),Ax}var fS;function DI(){return fS||(fS=1,Cx.exports=OI()),Cx.exports}var dS;function II(){if(dS)return ma;dS=1;var e=Ac(),t=DI();function r(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,p=1;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(o,l){s(o,l),s(o+"Capture",l)}function s(o,l){for(a[o]=l,o=0;o<l.length;o++)n.add(l[o])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},m={};function x(o){return f.call(m,o)?!0:f.call(d,o)?!1:h.test(o)?m[o]=!0:(d[o]=!0,!1)}function g(o,l,p,y){if(p!==null&&p.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return y?!1:p!==null?!p.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function b(o,l,p,y){if(l===null||typeof l>"u"||g(o,l,p,y))return!0;if(y)return!1;if(p!==null)switch(p.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function _(o,l,p,y,N,k,B){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=y,this.attributeNamespace=N,this.mustUseProperty=p,this.propertyName=o,this.type=l,this.sanitizeURL=k,this.removeEmptyString=B}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){w[o]=new _(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];w[l]=new _(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){w[o]=new _(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){w[o]=new _(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){w[o]=new _(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){w[o]=new _(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){w[o]=new _(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){w[o]=new _(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){w[o]=new _(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(S,A);w[l]=new _(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(S,A);w[l]=new _(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(S,A);w[l]=new _(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){w[o]=new _(o,1,!1,o.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){w[o]=new _(o,1,!1,o.toLowerCase(),null,!0,!0)});function T(o,l,p,y){var N=w.hasOwnProperty(l)?w[l]:null;(N!==null?N.type!==0:y||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(b(l,p,N,y)&&(p=null),y||N===null?x(l)&&(p===null?o.removeAttribute(l):o.setAttribute(l,""+p)):N.mustUseProperty?o[N.propertyName]=p===null?N.type===3?!1:"":p:(l=N.attributeName,y=N.attributeNamespace,p===null?o.removeAttribute(l):(N=N.type,p=N===3||N===4&&p===!0?"":""+p,y?o.setAttributeNS(y,l,p):o.setAttribute(l,p))))}var D=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),I=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),V=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),Ne=Symbol.for("react.suspense_list"),pe=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),ye=Symbol.iterator;function ge(o){return o===null||typeof o!="object"?null:(o=ye&&o[ye]||o["@@iterator"],typeof o=="function"?o:null)}var Oe=Object.assign,ie;function he(o){if(ie===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);ie=l&&l[1]||""}return`
`+ie+o}var De=!1;function We(o,l){if(!o||De)return"";De=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Ce){var y=Ce}Reflect.construct(o,[],l)}else{try{l.call()}catch(Ce){y=Ce}o.call(l.prototype)}else{try{throw Error()}catch(Ce){y=Ce}o()}}catch(Ce){if(Ce&&y&&typeof Ce.stack=="string"){for(var N=Ce.stack.split(`
`),k=y.stack.split(`
`),B=N.length-1,te=k.length-1;1<=B&&0<=te&&N[B]!==k[te];)te--;for(;1<=B&&0<=te;B--,te--)if(N[B]!==k[te]){if(B!==1||te!==1)do if(B--,te--,0>te||N[B]!==k[te]){var oe=`
`+N[B].replace(" at new "," at ");return o.displayName&&oe.includes("<anonymous>")&&(oe=oe.replace("<anonymous>",o.displayName)),oe}while(1<=B&&0<=te);break}}}finally{De=!1,Error.prepareStackTrace=p}return(o=o?o.displayName||o.name:"")?he(o):""}function Ve(o){switch(o.tag){case 5:return he(o.type);case 16:return he("Lazy");case 13:return he("Suspense");case 19:return he("SuspenseList");case 0:case 2:case 15:return o=We(o.type,!1),o;case 11:return o=We(o.type.render,!1),o;case 1:return o=We(o.type,!0),o;default:return""}}function Ge(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case j:return"Fragment";case I:return"Portal";case R:return"Profiler";case z:return"StrictMode";case ue:return"Suspense";case Ne:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case V:return(o.displayName||"Context")+".Consumer";case q:return(o._context.displayName||"Context")+".Provider";case J:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case pe:return l=o.displayName||null,l!==null?l:Ge(o.type)||"Memo";case Ie:l=o._payload,o=o._init;try{return Ge(o(l))}catch{}}return null}function Te(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ge(l);case 8:return l===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function U(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function H(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function X(o){var l=H(o)?"checked":"value",p=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),y=""+o[l];if(!o.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var N=p.get,k=p.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return N.call(this)},set:function(B){y=""+B,k.call(this,B)}}),Object.defineProperty(o,l,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(B){y=""+B},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function Z(o){o._valueTracker||(o._valueTracker=X(o))}function ee(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var p=l.getValue(),y="";return o&&(y=H(o)?o.checked?"true":"false":o.value),o=y,o!==p?(l.setValue(o),!0):!1}function Fe(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function _e(o,l){var p=l.checked;return Oe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??o._wrapperState.initialChecked})}function Me(o,l){var p=l.defaultValue==null?"":l.defaultValue,y=l.checked!=null?l.checked:l.defaultChecked;p=U(l.value!=null?l.value:p),o._wrapperState={initialChecked:y,initialValue:p,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Re(o,l){l=l.checked,l!=null&&T(o,"checked",l,!1)}function ne(o,l){Re(o,l);var p=U(l.value),y=l.type;if(p!=null)y==="number"?(p===0&&o.value===""||o.value!=p)&&(o.value=""+p):o.value!==""+p&&(o.value=""+p);else if(y==="submit"||y==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?me(o,l.type,p):l.hasOwnProperty("defaultValue")&&me(o,l.type,U(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function Ae(o,l,p){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var y=l.type;if(!(y!=="submit"&&y!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,p||l===o.value||(o.value=l),o.defaultValue=l}p=o.name,p!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,p!==""&&(o.name=p)}function me(o,l,p){(l!=="number"||Fe(o.ownerDocument)!==o)&&(p==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+p&&(o.defaultValue=""+p))}var je=Array.isArray;function He(o,l,p,y){if(o=o.options,l){l={};for(var N=0;N<p.length;N++)l["$"+p[N]]=!0;for(p=0;p<o.length;p++)N=l.hasOwnProperty("$"+o[p].value),o[p].selected!==N&&(o[p].selected=N),N&&y&&(o[p].defaultSelected=!0)}else{for(p=""+U(p),l=null,N=0;N<o.length;N++){if(o[N].value===p){o[N].selected=!0,y&&(o[N].defaultSelected=!0);return}l!==null||o[N].disabled||(l=o[N])}l!==null&&(l.selected=!0)}}function et(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return Oe({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Ue(o,l){var p=l.value;if(p==null){if(p=l.children,l=l.defaultValue,p!=null){if(l!=null)throw Error(r(92));if(je(p)){if(1<p.length)throw Error(r(93));p=p[0]}l=p}l==null&&(l=""),p=l}o._wrapperState={initialValue:U(p)}}function fe(o,l){var p=U(l.value),y=U(l.defaultValue);p!=null&&(p=""+p,p!==o.value&&(o.value=p),l.defaultValue==null&&o.defaultValue!==p&&(o.defaultValue=p)),y!=null&&(o.defaultValue=""+y)}function ce(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function rt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _t(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?rt(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var yt,Bt=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,p,y,N){MSApp.execUnsafeLocalFunction(function(){return o(l,p,y,N)})}:o})(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(yt=yt||document.createElement("div"),yt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=yt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function Tt(o,l){if(l){var p=o.firstChild;if(p&&p===o.lastChild&&p.nodeType===3){p.nodeValue=l;return}}o.textContent=l}var dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$t=["Webkit","ms","Moz","O"];Object.keys(dt).forEach(function(o){$t.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),dt[l]=dt[o]})});function Qt(o,l,p){return l==null||typeof l=="boolean"||l===""?"":p||typeof l!="number"||l===0||dt.hasOwnProperty(o)&&dt[o]?(""+l).trim():l+"px"}function Ut(o,l){o=o.style;for(var p in l)if(l.hasOwnProperty(p)){var y=p.indexOf("--")===0,N=Qt(p,l[p],y);p==="float"&&(p="cssFloat"),y?o.setProperty(p,N):o[p]=N}}var Dr=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function en(o,l){if(l){if(Dr[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function Ur(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ca=null;function Yn(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Xe=null,St=null,Ht=null;function Rt(o){if(o=pu(o)){if(typeof Xe!="function")throw Error(r(280));var l=o.stateNode;l&&(l=fd(l),Xe(o.stateNode,o.type,l))}}function tn(o){St?Ht?Ht.push(o):Ht=[o]:St=o}function zr(){if(St){var o=St,l=Ht;if(Ht=St=null,Rt(o),l)for(o=0;o<l.length;o++)Rt(l[o])}}function ae(o,l){return o(l)}function Le(){}var Je=!1;function tt(o,l,p){if(Je)return o(l,p);Je=!0;try{return ae(o,l,p)}finally{Je=!1,(St!==null||Ht!==null)&&(Le(),zr())}}function at(o,l){var p=o.stateNode;if(p===null)return null;var y=fd(p);if(y===null)return null;p=y[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(o=o.type,y=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!y;break e;default:o=!1}if(o)return null;if(p&&typeof p!="function")throw Error(r(231,l,typeof p));return p}var gt=!1;if(c)try{var Nt={};Object.defineProperty(Nt,"passive",{get:function(){gt=!0}}),window.addEventListener("test",Nt,Nt),window.removeEventListener("test",Nt,Nt)}catch{gt=!1}function ir(o,l,p,y,N,k,B,te,oe){var Ce=Array.prototype.slice.call(arguments,3);try{l.apply(p,Ce)}catch(Ye){this.onError(Ye)}}var Dt=!1,rr=null,L=!1,Y=null,C={onError:function(o){Dt=!0,rr=o}};function P(o,l,p,y,N,k,B,te,oe){Dt=!1,rr=null,ir.apply(C,arguments)}function M(o,l,p,y,N,k,B,te,oe){if(P.apply(this,arguments),Dt){if(Dt){var Ce=rr;Dt=!1,rr=null}else throw Error(r(198));L||(L=!0,Y=Ce)}}function E(o){var l=o,p=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(p=l.return),o=l.return;while(o)}return l.tag===3?p:null}function F(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function W(o){if(E(o)!==o)throw Error(r(188))}function K(o){var l=o.alternate;if(!l){if(l=E(o),l===null)throw Error(r(188));return l!==o?null:o}for(var p=o,y=l;;){var N=p.return;if(N===null)break;var k=N.alternate;if(k===null){if(y=N.return,y!==null){p=y;continue}break}if(N.child===k.child){for(k=N.child;k;){if(k===p)return W(N),o;if(k===y)return W(N),l;k=k.sibling}throw Error(r(188))}if(p.return!==y.return)p=N,y=k;else{for(var B=!1,te=N.child;te;){if(te===p){B=!0,p=N,y=k;break}if(te===y){B=!0,y=N,p=k;break}te=te.sibling}if(!B){for(te=k.child;te;){if(te===p){B=!0,p=k,y=N;break}if(te===y){B=!0,y=k,p=N;break}te=te.sibling}if(!B)throw Error(r(189))}}if(p.alternate!==y)throw Error(r(190))}if(p.tag!==3)throw Error(r(188));return p.stateNode.current===p?o:l}function G(o){return o=K(o),o!==null?re(o):null}function re(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=re(o);if(l!==null)return l;o=o.sibling}return null}var se=t.unstable_scheduleCallback,de=t.unstable_cancelCallback,Pe=t.unstable_shouldYield,we=t.unstable_requestPaint,ke=t.unstable_now,$e=t.unstable_getCurrentPriorityLevel,ht=t.unstable_ImmediatePriority,xt=t.unstable_UserBlockingPriority,kt=t.unstable_NormalPriority,kr=t.unstable_LowPriority,Cr=t.unstable_IdlePriority,jt=null,Ot=null;function vr(o){if(Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(jt,o,void 0,(o.current.flags&128)===128)}catch{}}var Ft=Math.clz32?Math.clz32:Wi,Nl=Math.log,qc=Math.LN2;function Wi(o){return o>>>=0,o===0?32:31-(Nl(o)/qc|0)|0}var Eo=64,El=4194304;function Ts(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function To(o,l){var p=o.pendingLanes;if(p===0)return 0;var y=0,N=o.suspendedLanes,k=o.pingedLanes,B=p&268435455;if(B!==0){var te=B&~N;te!==0?y=Ts(te):(k&=B,k!==0&&(y=Ts(k)))}else B=p&~N,B!==0?y=Ts(B):k!==0&&(y=Ts(k));if(y===0)return 0;if(l!==0&&l!==y&&(l&N)===0&&(N=y&-y,k=l&-l,N>=k||N===16&&(k&4194240)!==0))return l;if((y&4)!==0&&(y|=p&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=y;0<l;)p=31-Ft(l),N=1<<p,y|=o[p],l&=~N;return y}function cr(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ir(o,l){for(var p=o.suspendedLanes,y=o.pingedLanes,N=o.expirationTimes,k=o.pendingLanes;0<k;){var B=31-Ft(k),te=1<<B,oe=N[B];oe===-1?((te&p)===0||(te&y)!==0)&&(N[B]=cr(te,l)):oe<=l&&(o.expiredLanes|=te),k&=~te}}function Na(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Tl(){var o=Eo;return Eo<<=1,(Eo&4194240)===0&&(Eo=64),o}function Vi(o){for(var l=[],p=0;31>p;p++)l.push(o);return l}function ko(o,l,p){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-Ft(l),o[l]=p}function Zc(o,l){var p=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var y=o.eventTimes;for(o=o.expirationTimes;0<p;){var N=31-Ft(p),k=1<<N;l[N]=0,y[N]=-1,o[N]=-1,p&=~k}}function kl(o,l){var p=o.entangledLanes|=l;for(o=o.entanglements;p;){var y=31-Ft(p),N=1<<y;N&l|o[y]&l&&(o[y]|=l),p&=~N}}var Gt=0;function Xf(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Bb,Xp,$b,Ub,zb,qp=!1,qf=[],ks=null,Cs=null,As=null,Qc=new Map,Jc=new Map,js=[],q3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hb(o,l){switch(o){case"focusin":case"focusout":ks=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":As=null;break;case"pointerover":case"pointerout":Qc.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jc.delete(l.pointerId)}}function eu(o,l,p,y,N,k){return o===null||o.nativeEvent!==k?(o={blockedOn:l,domEventName:p,eventSystemFlags:y,nativeEvent:k,targetContainers:[N]},l!==null&&(l=pu(l),l!==null&&Xp(l)),o):(o.eventSystemFlags|=y,l=o.targetContainers,N!==null&&l.indexOf(N)===-1&&l.push(N),o)}function Z3(o,l,p,y,N){switch(l){case"focusin":return ks=eu(ks,o,l,p,y,N),!0;case"dragenter":return Cs=eu(Cs,o,l,p,y,N),!0;case"mouseover":return As=eu(As,o,l,p,y,N),!0;case"pointerover":var k=N.pointerId;return Qc.set(k,eu(Qc.get(k)||null,o,l,p,y,N)),!0;case"gotpointercapture":return k=N.pointerId,Jc.set(k,eu(Jc.get(k)||null,o,l,p,y,N)),!0}return!1}function Wb(o){var l=Co(o.target);if(l!==null){var p=E(l);if(p!==null){if(l=p.tag,l===13){if(l=F(p),l!==null){o.blockedOn=l,zb(o.priority,function(){$b(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){o.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Zf(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var p=Qp(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(p===null){p=o.nativeEvent;var y=new p.constructor(p.type,p);ca=y,p.target.dispatchEvent(y),ca=null}else return l=pu(p),l!==null&&Xp(l),o.blockedOn=p,!1;l.shift()}return!0}function Vb(o,l,p){Zf(o)&&p.delete(l)}function Q3(){qp=!1,ks!==null&&Zf(ks)&&(ks=null),Cs!==null&&Zf(Cs)&&(Cs=null),As!==null&&Zf(As)&&(As=null),Qc.forEach(Vb),Jc.forEach(Vb)}function tu(o,l){o.blockedOn===l&&(o.blockedOn=null,qp||(qp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Q3)))}function ru(o){function l(N){return tu(N,o)}if(0<qf.length){tu(qf[0],o);for(var p=1;p<qf.length;p++){var y=qf[p];y.blockedOn===o&&(y.blockedOn=null)}}for(ks!==null&&tu(ks,o),Cs!==null&&tu(Cs,o),As!==null&&tu(As,o),Qc.forEach(l),Jc.forEach(l),p=0;p<js.length;p++)y=js[p],y.blockedOn===o&&(y.blockedOn=null);for(;0<js.length&&(p=js[0],p.blockedOn===null);)Wb(p),p.blockedOn===null&&js.shift()}var Cl=D.ReactCurrentBatchConfig,Qf=!0;function J3(o,l,p,y){var N=Gt,k=Cl.transition;Cl.transition=null;try{Gt=1,Zp(o,l,p,y)}finally{Gt=N,Cl.transition=k}}function eD(o,l,p,y){var N=Gt,k=Cl.transition;Cl.transition=null;try{Gt=4,Zp(o,l,p,y)}finally{Gt=N,Cl.transition=k}}function Zp(o,l,p,y){if(Qf){var N=Qp(o,l,p,y);if(N===null)mm(o,l,y,Jf,p),Hb(o,y);else if(Z3(N,o,l,p,y))y.stopPropagation();else if(Hb(o,y),l&4&&-1<q3.indexOf(o)){for(;N!==null;){var k=pu(N);if(k!==null&&Bb(k),k=Qp(o,l,p,y),k===null&&mm(o,l,y,Jf,p),k===N)break;N=k}N!==null&&y.stopPropagation()}else mm(o,l,y,null,p)}}var Jf=null;function Qp(o,l,p,y){if(Jf=null,o=Yn(y),o=Co(o),o!==null)if(l=E(o),l===null)o=null;else if(p=l.tag,p===13){if(o=F(l),o!==null)return o;o=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return Jf=o,null}function Kb(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case ht:return 1;case xt:return 4;case kt:case kr:return 16;case Cr:return 536870912;default:return 16}default:return 16}}var Ps=null,Jp=null,ed=null;function Gb(){if(ed)return ed;var o,l=Jp,p=l.length,y,N="value"in Ps?Ps.value:Ps.textContent,k=N.length;for(o=0;o<p&&l[o]===N[o];o++);var B=p-o;for(y=1;y<=B&&l[p-y]===N[k-y];y++);return ed=N.slice(o,1<y?1-y:void 0)}function td(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function rd(){return!0}function Yb(){return!1}function Ea(o){function l(p,y,N,k,B){this._reactName=p,this._targetInst=N,this.type=y,this.nativeEvent=k,this.target=B,this.currentTarget=null;for(var te in o)o.hasOwnProperty(te)&&(p=o[te],this[te]=p?p(k):k[te]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?rd:Yb,this.isPropagationStopped=Yb,this}return Oe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=rd)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=rd)},persist:function(){},isPersistent:rd}),l}var Al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},em=Ea(Al),nu=Oe({},Al,{view:0,detail:0}),tD=Ea(nu),tm,rm,au,nd=Oe({},nu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:am,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==au&&(au&&o.type==="mousemove"?(tm=o.screenX-au.screenX,rm=o.screenY-au.screenY):rm=tm=0,au=o),tm)},movementY:function(o){return"movementY"in o?o.movementY:rm}}),Xb=Ea(nd),rD=Oe({},nd,{dataTransfer:0}),nD=Ea(rD),aD=Oe({},nu,{relatedTarget:0}),nm=Ea(aD),iD=Oe({},Al,{animationName:0,elapsedTime:0,pseudoElement:0}),sD=Ea(iD),oD=Oe({},Al,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),lD=Ea(oD),cD=Oe({},Al,{data:0}),qb=Ea(cD),uD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hD(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=dD[o])?!!l[o]:!1}function am(){return hD}var pD=Oe({},nu,{key:function(o){if(o.key){var l=uD[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=td(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?fD[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:am,charCode:function(o){return o.type==="keypress"?td(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?td(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),mD=Ea(pD),xD=Oe({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zb=Ea(xD),gD=Oe({},nu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:am}),vD=Ea(gD),yD=Oe({},Al,{propertyName:0,elapsedTime:0,pseudoElement:0}),wD=Ea(yD),bD=Oe({},nd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),_D=Ea(bD),SD=[9,13,27,32],im=c&&"CompositionEvent"in window,iu=null;c&&"documentMode"in document&&(iu=document.documentMode);var ND=c&&"TextEvent"in window&&!iu,Qb=c&&(!im||iu&&8<iu&&11>=iu),Jb=" ",e2=!1;function t2(o,l){switch(o){case"keyup":return SD.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r2(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var jl=!1;function ED(o,l){switch(o){case"compositionend":return r2(l);case"keypress":return l.which!==32?null:(e2=!0,Jb);case"textInput":return o=l.data,o===Jb&&e2?null:o;default:return null}}function TD(o,l){if(jl)return o==="compositionend"||!im&&t2(o,l)?(o=Gb(),ed=Jp=Ps=null,jl=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Qb&&l.locale!=="ko"?null:l.data;default:return null}}var kD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n2(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!kD[o.type]:l==="textarea"}function a2(o,l,p,y){tn(y),l=ld(l,"onChange"),0<l.length&&(p=new em("onChange","change",null,p,y),o.push({event:p,listeners:l}))}var su=null,ou=null;function CD(o){_2(o,0)}function ad(o){var l=Rl(o);if(ee(l))return o}function AD(o,l){if(o==="change")return l}var i2=!1;if(c){var sm;if(c){var om="oninput"in document;if(!om){var s2=document.createElement("div");s2.setAttribute("oninput","return;"),om=typeof s2.oninput=="function"}sm=om}else sm=!1;i2=sm&&(!document.documentMode||9<document.documentMode)}function o2(){su&&(su.detachEvent("onpropertychange",l2),ou=su=null)}function l2(o){if(o.propertyName==="value"&&ad(ou)){var l=[];a2(l,ou,o,Yn(o)),tt(CD,l)}}function jD(o,l,p){o==="focusin"?(o2(),su=l,ou=p,su.attachEvent("onpropertychange",l2)):o==="focusout"&&o2()}function PD(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return ad(ou)}function OD(o,l){if(o==="click")return ad(l)}function DD(o,l){if(o==="input"||o==="change")return ad(l)}function ID(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var ci=typeof Object.is=="function"?Object.is:ID;function lu(o,l){if(ci(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var p=Object.keys(o),y=Object.keys(l);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var N=p[y];if(!f.call(l,N)||!ci(o[N],l[N]))return!1}return!0}function c2(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function u2(o,l){var p=c2(o);o=0;for(var y;p;){if(p.nodeType===3){if(y=o+p.textContent.length,o<=l&&y>=l)return{node:p,offset:l-o};o=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=c2(p)}}function f2(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?f2(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function d2(){for(var o=window,l=Fe();l instanceof o.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)o=l.contentWindow;else break;l=Fe(o.document)}return l}function lm(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function RD(o){var l=d2(),p=o.focusedElem,y=o.selectionRange;if(l!==p&&p&&p.ownerDocument&&f2(p.ownerDocument.documentElement,p)){if(y!==null&&lm(p)){if(l=y.start,o=y.end,o===void 0&&(o=l),"selectionStart"in p)p.selectionStart=l,p.selectionEnd=Math.min(o,p.value.length);else if(o=(l=p.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var N=p.textContent.length,k=Math.min(y.start,N);y=y.end===void 0?k:Math.min(y.end,N),!o.extend&&k>y&&(N=y,y=k,k=N),N=u2(p,k);var B=u2(p,y);N&&B&&(o.rangeCount!==1||o.anchorNode!==N.node||o.anchorOffset!==N.offset||o.focusNode!==B.node||o.focusOffset!==B.offset)&&(l=l.createRange(),l.setStart(N.node,N.offset),o.removeAllRanges(),k>y?(o.addRange(l),o.extend(B.node,B.offset)):(l.setEnd(B.node,B.offset),o.addRange(l)))}}for(l=[],o=p;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<l.length;p++)o=l[p],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var FD=c&&"documentMode"in document&&11>=document.documentMode,Pl=null,cm=null,cu=null,um=!1;function h2(o,l,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;um||Pl==null||Pl!==Fe(y)||(y=Pl,"selectionStart"in y&&lm(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),cu&&lu(cu,y)||(cu=y,y=ld(cm,"onSelect"),0<y.length&&(l=new em("onSelect","select",null,l,p),o.push({event:l,listeners:y}),l.target=Pl)))}function id(o,l){var p={};return p[o.toLowerCase()]=l.toLowerCase(),p["Webkit"+o]="webkit"+l,p["Moz"+o]="moz"+l,p}var Ol={animationend:id("Animation","AnimationEnd"),animationiteration:id("Animation","AnimationIteration"),animationstart:id("Animation","AnimationStart"),transitionend:id("Transition","TransitionEnd")},fm={},p2={};c&&(p2=document.createElement("div").style,"AnimationEvent"in window||(delete Ol.animationend.animation,delete Ol.animationiteration.animation,delete Ol.animationstart.animation),"TransitionEvent"in window||delete Ol.transitionend.transition);function sd(o){if(fm[o])return fm[o];if(!Ol[o])return o;var l=Ol[o],p;for(p in l)if(l.hasOwnProperty(p)&&p in p2)return fm[o]=l[p];return o}var m2=sd("animationend"),x2=sd("animationiteration"),g2=sd("animationstart"),v2=sd("transitionend"),y2=new Map,w2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Os(o,l){y2.set(o,l),i(l,[o])}for(var dm=0;dm<w2.length;dm++){var hm=w2[dm],MD=hm.toLowerCase(),LD=hm[0].toUpperCase()+hm.slice(1);Os(MD,"on"+LD)}Os(m2,"onAnimationEnd"),Os(x2,"onAnimationIteration"),Os(g2,"onAnimationStart"),Os("dblclick","onDoubleClick"),Os("focusin","onFocus"),Os("focusout","onBlur"),Os(v2,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BD=new Set("cancel close invalid load scroll toggle".split(" ").concat(uu));function b2(o,l,p){var y=o.type||"unknown-event";o.currentTarget=p,M(y,l,void 0,o),o.currentTarget=null}function _2(o,l){l=(l&4)!==0;for(var p=0;p<o.length;p++){var y=o[p],N=y.event;y=y.listeners;e:{var k=void 0;if(l)for(var B=y.length-1;0<=B;B--){var te=y[B],oe=te.instance,Ce=te.currentTarget;if(te=te.listener,oe!==k&&N.isPropagationStopped())break e;b2(N,te,Ce),k=oe}else for(B=0;B<y.length;B++){if(te=y[B],oe=te.instance,Ce=te.currentTarget,te=te.listener,oe!==k&&N.isPropagationStopped())break e;b2(N,te,Ce),k=oe}}}if(L)throw o=Y,L=!1,Y=null,o}function hr(o,l){var p=l[bm];p===void 0&&(p=l[bm]=new Set);var y=o+"__bubble";p.has(y)||(S2(l,o,2,!1),p.add(y))}function pm(o,l,p){var y=0;l&&(y|=4),S2(p,o,y,l)}var od="_reactListening"+Math.random().toString(36).slice(2);function fu(o){if(!o[od]){o[od]=!0,n.forEach(function(p){p!=="selectionchange"&&(BD.has(p)||pm(p,!1,o),pm(p,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[od]||(l[od]=!0,pm("selectionchange",!1,l))}}function S2(o,l,p,y){switch(Kb(l)){case 1:var N=J3;break;case 4:N=eD;break;default:N=Zp}p=N.bind(null,l,p,o),N=void 0,!gt||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(N=!0),y?N!==void 0?o.addEventListener(l,p,{capture:!0,passive:N}):o.addEventListener(l,p,!0):N!==void 0?o.addEventListener(l,p,{passive:N}):o.addEventListener(l,p,!1)}function mm(o,l,p,y,N){var k=y;if((l&1)===0&&(l&2)===0&&y!==null)e:for(;;){if(y===null)return;var B=y.tag;if(B===3||B===4){var te=y.stateNode.containerInfo;if(te===N||te.nodeType===8&&te.parentNode===N)break;if(B===4)for(B=y.return;B!==null;){var oe=B.tag;if((oe===3||oe===4)&&(oe=B.stateNode.containerInfo,oe===N||oe.nodeType===8&&oe.parentNode===N))return;B=B.return}for(;te!==null;){if(B=Co(te),B===null)return;if(oe=B.tag,oe===5||oe===6){y=k=B;continue e}te=te.parentNode}}y=y.return}tt(function(){var Ce=k,Ye=Yn(p),qe=[];e:{var Ke=y2.get(o);if(Ke!==void 0){var nt=em,ot=o;switch(o){case"keypress":if(td(p)===0)break e;case"keydown":case"keyup":nt=mD;break;case"focusin":ot="focus",nt=nm;break;case"focusout":ot="blur",nt=nm;break;case"beforeblur":case"afterblur":nt=nm;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Xb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=nD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=vD;break;case m2:case x2:case g2:nt=sD;break;case v2:nt=wD;break;case"scroll":nt=tD;break;case"wheel":nt=_D;break;case"copy":case"cut":case"paste":nt=lD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Zb}var lt=(l&4)!==0,Lr=!lt&&o==="scroll",ve=lt?Ke!==null?Ke+"Capture":null:Ke;lt=[];for(var le=Ce,Se;le!==null;){Se=le;var Qe=Se.stateNode;if(Se.tag===5&&Qe!==null&&(Se=Qe,ve!==null&&(Qe=at(le,ve),Qe!=null&&lt.push(du(le,Qe,Se)))),Lr)break;le=le.return}0<lt.length&&(Ke=new nt(Ke,ot,null,p,Ye),qe.push({event:Ke,listeners:lt}))}}if((l&7)===0){e:{if(Ke=o==="mouseover"||o==="pointerover",nt=o==="mouseout"||o==="pointerout",Ke&&p!==ca&&(ot=p.relatedTarget||p.fromElement)&&(Co(ot)||ot[Ki]))break e;if((nt||Ke)&&(Ke=Ye.window===Ye?Ye:(Ke=Ye.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,nt?(ot=p.relatedTarget||p.toElement,nt=Ce,ot=ot?Co(ot):null,ot!==null&&(Lr=E(ot),ot!==Lr||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(nt=null,ot=Ce),nt!==ot)){if(lt=Xb,Qe="onMouseLeave",ve="onMouseEnter",le="mouse",(o==="pointerout"||o==="pointerover")&&(lt=Zb,Qe="onPointerLeave",ve="onPointerEnter",le="pointer"),Lr=nt==null?Ke:Rl(nt),Se=ot==null?Ke:Rl(ot),Ke=new lt(Qe,le+"leave",nt,p,Ye),Ke.target=Lr,Ke.relatedTarget=Se,Qe=null,Co(Ye)===Ce&&(lt=new lt(ve,le+"enter",ot,p,Ye),lt.target=Se,lt.relatedTarget=Lr,Qe=lt),Lr=Qe,nt&&ot)t:{for(lt=nt,ve=ot,le=0,Se=lt;Se;Se=Dl(Se))le++;for(Se=0,Qe=ve;Qe;Qe=Dl(Qe))Se++;for(;0<le-Se;)lt=Dl(lt),le--;for(;0<Se-le;)ve=Dl(ve),Se--;for(;le--;){if(lt===ve||ve!==null&&lt===ve.alternate)break t;lt=Dl(lt),ve=Dl(ve)}lt=null}else lt=null;nt!==null&&N2(qe,Ke,nt,lt,!1),ot!==null&&Lr!==null&&N2(qe,Lr,ot,lt,!0)}}e:{if(Ke=Ce?Rl(Ce):window,nt=Ke.nodeName&&Ke.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Ke.type==="file")var ut=AD;else if(n2(Ke))if(i2)ut=DD;else{ut=PD;var wt=jD}else(nt=Ke.nodeName)&&nt.toLowerCase()==="input"&&(Ke.type==="checkbox"||Ke.type==="radio")&&(ut=OD);if(ut&&(ut=ut(o,Ce))){a2(qe,ut,p,Ye);break e}wt&&wt(o,Ke,Ce),o==="focusout"&&(wt=Ke._wrapperState)&&wt.controlled&&Ke.type==="number"&&me(Ke,"number",Ke.value)}switch(wt=Ce?Rl(Ce):window,o){case"focusin":(n2(wt)||wt.contentEditable==="true")&&(Pl=wt,cm=Ce,cu=null);break;case"focusout":cu=cm=Pl=null;break;case"mousedown":um=!0;break;case"contextmenu":case"mouseup":case"dragend":um=!1,h2(qe,p,Ye);break;case"selectionchange":if(FD)break;case"keydown":case"keyup":h2(qe,p,Ye)}var bt;if(im)e:{switch(o){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else jl?t2(o,p)&&(Et="onCompositionEnd"):o==="keydown"&&p.keyCode===229&&(Et="onCompositionStart");Et&&(Qb&&p.locale!=="ko"&&(jl||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&jl&&(bt=Gb()):(Ps=Ye,Jp="value"in Ps?Ps.value:Ps.textContent,jl=!0)),wt=ld(Ce,Et),0<wt.length&&(Et=new qb(Et,o,null,p,Ye),qe.push({event:Et,listeners:wt}),bt?Et.data=bt:(bt=r2(p),bt!==null&&(Et.data=bt)))),(bt=ND?ED(o,p):TD(o,p))&&(Ce=ld(Ce,"onBeforeInput"),0<Ce.length&&(Ye=new qb("onBeforeInput","beforeinput",null,p,Ye),qe.push({event:Ye,listeners:Ce}),Ye.data=bt))}_2(qe,l)})}function du(o,l,p){return{instance:o,listener:l,currentTarget:p}}function ld(o,l){for(var p=l+"Capture",y=[];o!==null;){var N=o,k=N.stateNode;N.tag===5&&k!==null&&(N=k,k=at(o,p),k!=null&&y.unshift(du(o,k,N)),k=at(o,l),k!=null&&y.push(du(o,k,N))),o=o.return}return y}function Dl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function N2(o,l,p,y,N){for(var k=l._reactName,B=[];p!==null&&p!==y;){var te=p,oe=te.alternate,Ce=te.stateNode;if(oe!==null&&oe===y)break;te.tag===5&&Ce!==null&&(te=Ce,N?(oe=at(p,k),oe!=null&&B.unshift(du(p,oe,te))):N||(oe=at(p,k),oe!=null&&B.push(du(p,oe,te)))),p=p.return}B.length!==0&&o.push({event:l,listeners:B})}var $D=/\r\n?/g,UD=/\u0000|\uFFFD/g;function E2(o){return(typeof o=="string"?o:""+o).replace($D,`
`).replace(UD,"")}function cd(o,l,p){if(l=E2(l),E2(o)!==l&&p)throw Error(r(425))}function ud(){}var xm=null,gm=null;function vm(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var ym=typeof setTimeout=="function"?setTimeout:void 0,zD=typeof clearTimeout=="function"?clearTimeout:void 0,T2=typeof Promise=="function"?Promise:void 0,HD=typeof queueMicrotask=="function"?queueMicrotask:typeof T2<"u"?function(o){return T2.resolve(null).then(o).catch(WD)}:ym;function WD(o){setTimeout(function(){throw o})}function wm(o,l){var p=l,y=0;do{var N=p.nextSibling;if(o.removeChild(p),N&&N.nodeType===8)if(p=N.data,p==="/$"){if(y===0){o.removeChild(N),ru(l);return}y--}else p!=="$"&&p!=="$?"&&p!=="$!"||y++;p=N}while(p);ru(l)}function Ds(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function k2(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="$"||p==="$!"||p==="$?"){if(l===0)return o;l--}else p==="/$"&&l++}o=o.previousSibling}return null}var Il=Math.random().toString(36).slice(2),Ei="__reactFiber$"+Il,hu="__reactProps$"+Il,Ki="__reactContainer$"+Il,bm="__reactEvents$"+Il,VD="__reactListeners$"+Il,KD="__reactHandles$"+Il;function Co(o){var l=o[Ei];if(l)return l;for(var p=o.parentNode;p;){if(l=p[Ki]||p[Ei]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(o=k2(o);o!==null;){if(p=o[Ei])return p;o=k2(o)}return l}o=p,p=o.parentNode}return null}function pu(o){return o=o[Ei]||o[Ki],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Rl(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(r(33))}function fd(o){return o[hu]||null}var _m=[],Fl=-1;function Is(o){return{current:o}}function pr(o){0>Fl||(o.current=_m[Fl],_m[Fl]=null,Fl--)}function ur(o,l){Fl++,_m[Fl]=o.current,o.current=l}var Rs={},Pn=Is(Rs),ua=Is(!1),Ao=Rs;function Ml(o,l){var p=o.type.contextTypes;if(!p)return Rs;var y=o.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===l)return y.__reactInternalMemoizedMaskedChildContext;var N={},k;for(k in p)N[k]=l[k];return y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=N),N}function fa(o){return o=o.childContextTypes,o!=null}function dd(){pr(ua),pr(Pn)}function C2(o,l,p){if(Pn.current!==Rs)throw Error(r(168));ur(Pn,l),ur(ua,p)}function A2(o,l,p){var y=o.stateNode;if(l=l.childContextTypes,typeof y.getChildContext!="function")return p;y=y.getChildContext();for(var N in y)if(!(N in l))throw Error(r(108,Te(o)||"Unknown",N));return Oe({},p,y)}function hd(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Rs,Ao=Pn.current,ur(Pn,o),ur(ua,ua.current),!0}function j2(o,l,p){var y=o.stateNode;if(!y)throw Error(r(169));p?(o=A2(o,l,Ao),y.__reactInternalMemoizedMergedChildContext=o,pr(ua),pr(Pn),ur(Pn,o)):pr(ua),ur(ua,p)}var Gi=null,pd=!1,Sm=!1;function P2(o){Gi===null?Gi=[o]:Gi.push(o)}function GD(o){pd=!0,P2(o)}function Fs(){if(!Sm&&Gi!==null){Sm=!0;var o=0,l=Gt;try{var p=Gi;for(Gt=1;o<p.length;o++){var y=p[o];do y=y(!0);while(y!==null)}Gi=null,pd=!1}catch(N){throw Gi!==null&&(Gi=Gi.slice(o+1)),se(ht,Fs),N}finally{Gt=l,Sm=!1}}return null}var Ll=[],Bl=0,md=null,xd=0,Wa=[],Va=0,jo=null,Yi=1,Xi="";function Po(o,l){Ll[Bl++]=xd,Ll[Bl++]=md,md=o,xd=l}function O2(o,l,p){Wa[Va++]=Yi,Wa[Va++]=Xi,Wa[Va++]=jo,jo=o;var y=Yi;o=Xi;var N=32-Ft(y)-1;y&=~(1<<N),p+=1;var k=32-Ft(l)+N;if(30<k){var B=N-N%5;k=(y&(1<<B)-1).toString(32),y>>=B,N-=B,Yi=1<<32-Ft(l)+N|p<<N|y,Xi=k+o}else Yi=1<<k|p<<N|y,Xi=o}function Nm(o){o.return!==null&&(Po(o,1),O2(o,1,0))}function Em(o){for(;o===md;)md=Ll[--Bl],Ll[Bl]=null,xd=Ll[--Bl],Ll[Bl]=null;for(;o===jo;)jo=Wa[--Va],Wa[Va]=null,Xi=Wa[--Va],Wa[Va]=null,Yi=Wa[--Va],Wa[Va]=null}var Ta=null,ka=null,yr=!1,ui=null;function D2(o,l){var p=Xa(5,null,null,0);p.elementType="DELETED",p.stateNode=l,p.return=o,l=o.deletions,l===null?(o.deletions=[p],o.flags|=16):l.push(p)}function I2(o,l){switch(o.tag){case 5:var p=o.type;return l=l.nodeType!==1||p.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,Ta=o,ka=Ds(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,Ta=o,ka=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(p=jo!==null?{id:Yi,overflow:Xi}:null,o.memoizedState={dehydrated:l,treeContext:p,retryLane:1073741824},p=Xa(18,null,null,0),p.stateNode=l,p.return=o,o.child=p,Ta=o,ka=null,!0):!1;default:return!1}}function Tm(o){return(o.mode&1)!==0&&(o.flags&128)===0}function km(o){if(yr){var l=ka;if(l){var p=l;if(!I2(o,l)){if(Tm(o))throw Error(r(418));l=Ds(p.nextSibling);var y=Ta;l&&I2(o,l)?D2(y,p):(o.flags=o.flags&-4097|2,yr=!1,Ta=o)}}else{if(Tm(o))throw Error(r(418));o.flags=o.flags&-4097|2,yr=!1,Ta=o}}}function R2(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Ta=o}function gd(o){if(o!==Ta)return!1;if(!yr)return R2(o),yr=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!vm(o.type,o.memoizedProps)),l&&(l=ka)){if(Tm(o))throw F2(),Error(r(418));for(;l;)D2(o,l),l=Ds(l.nextSibling)}if(R2(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var p=o.data;if(p==="/$"){if(l===0){ka=Ds(o.nextSibling);break e}l--}else p!=="$"&&p!=="$!"&&p!=="$?"||l++}o=o.nextSibling}ka=null}}else ka=Ta?Ds(o.stateNode.nextSibling):null;return!0}function F2(){for(var o=ka;o;)o=Ds(o.nextSibling)}function $l(){ka=Ta=null,yr=!1}function Cm(o){ui===null?ui=[o]:ui.push(o)}var YD=D.ReactCurrentBatchConfig;function mu(o,l,p){if(o=p.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(r(309));var y=p.stateNode}if(!y)throw Error(r(147,o));var N=y,k=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===k?l.ref:(l=function(B){var te=N.refs;B===null?delete te[k]:te[k]=B},l._stringRef=k,l)}if(typeof o!="string")throw Error(r(284));if(!p._owner)throw Error(r(290,o))}return o}function vd(o,l){throw o=Object.prototype.toString.call(l),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function M2(o){var l=o._init;return l(o._payload)}function L2(o){function l(ve,le){if(o){var Se=ve.deletions;Se===null?(ve.deletions=[le],ve.flags|=16):Se.push(le)}}function p(ve,le){if(!o)return null;for(;le!==null;)l(ve,le),le=le.sibling;return null}function y(ve,le){for(ve=new Map;le!==null;)le.key!==null?ve.set(le.key,le):ve.set(le.index,le),le=le.sibling;return ve}function N(ve,le){return ve=Ws(ve,le),ve.index=0,ve.sibling=null,ve}function k(ve,le,Se){return ve.index=Se,o?(Se=ve.alternate,Se!==null?(Se=Se.index,Se<le?(ve.flags|=2,le):Se):(ve.flags|=2,le)):(ve.flags|=1048576,le)}function B(ve){return o&&ve.alternate===null&&(ve.flags|=2),ve}function te(ve,le,Se,Qe){return le===null||le.tag!==6?(le=yx(Se,ve.mode,Qe),le.return=ve,le):(le=N(le,Se),le.return=ve,le)}function oe(ve,le,Se,Qe){var ut=Se.type;return ut===j?Ye(ve,le,Se.props.children,Qe,Se.key):le!==null&&(le.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Ie&&M2(ut)===le.type)?(Qe=N(le,Se.props),Qe.ref=mu(ve,le,Se),Qe.return=ve,Qe):(Qe=zd(Se.type,Se.key,Se.props,null,ve.mode,Qe),Qe.ref=mu(ve,le,Se),Qe.return=ve,Qe)}function Ce(ve,le,Se,Qe){return le===null||le.tag!==4||le.stateNode.containerInfo!==Se.containerInfo||le.stateNode.implementation!==Se.implementation?(le=wx(Se,ve.mode,Qe),le.return=ve,le):(le=N(le,Se.children||[]),le.return=ve,le)}function Ye(ve,le,Se,Qe,ut){return le===null||le.tag!==7?(le=Bo(Se,ve.mode,Qe,ut),le.return=ve,le):(le=N(le,Se),le.return=ve,le)}function qe(ve,le,Se){if(typeof le=="string"&&le!==""||typeof le=="number")return le=yx(""+le,ve.mode,Se),le.return=ve,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case O:return Se=zd(le.type,le.key,le.props,null,ve.mode,Se),Se.ref=mu(ve,null,le),Se.return=ve,Se;case I:return le=wx(le,ve.mode,Se),le.return=ve,le;case Ie:var Qe=le._init;return qe(ve,Qe(le._payload),Se)}if(je(le)||ge(le))return le=Bo(le,ve.mode,Se,null),le.return=ve,le;vd(ve,le)}return null}function Ke(ve,le,Se,Qe){var ut=le!==null?le.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return ut!==null?null:te(ve,le,""+Se,Qe);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case O:return Se.key===ut?oe(ve,le,Se,Qe):null;case I:return Se.key===ut?Ce(ve,le,Se,Qe):null;case Ie:return ut=Se._init,Ke(ve,le,ut(Se._payload),Qe)}if(je(Se)||ge(Se))return ut!==null?null:Ye(ve,le,Se,Qe,null);vd(ve,Se)}return null}function nt(ve,le,Se,Qe,ut){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return ve=ve.get(Se)||null,te(le,ve,""+Qe,ut);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case O:return ve=ve.get(Qe.key===null?Se:Qe.key)||null,oe(le,ve,Qe,ut);case I:return ve=ve.get(Qe.key===null?Se:Qe.key)||null,Ce(le,ve,Qe,ut);case Ie:var wt=Qe._init;return nt(ve,le,Se,wt(Qe._payload),ut)}if(je(Qe)||ge(Qe))return ve=ve.get(Se)||null,Ye(le,ve,Qe,ut,null);vd(le,Qe)}return null}function ot(ve,le,Se,Qe){for(var ut=null,wt=null,bt=le,Et=le=0,hn=null;bt!==null&&Et<Se.length;Et++){bt.index>Et?(hn=bt,bt=null):hn=bt.sibling;var Wt=Ke(ve,bt,Se[Et],Qe);if(Wt===null){bt===null&&(bt=hn);break}o&&bt&&Wt.alternate===null&&l(ve,bt),le=k(Wt,le,Et),wt===null?ut=Wt:wt.sibling=Wt,wt=Wt,bt=hn}if(Et===Se.length)return p(ve,bt),yr&&Po(ve,Et),ut;if(bt===null){for(;Et<Se.length;Et++)bt=qe(ve,Se[Et],Qe),bt!==null&&(le=k(bt,le,Et),wt===null?ut=bt:wt.sibling=bt,wt=bt);return yr&&Po(ve,Et),ut}for(bt=y(ve,bt);Et<Se.length;Et++)hn=nt(bt,ve,Et,Se[Et],Qe),hn!==null&&(o&&hn.alternate!==null&&bt.delete(hn.key===null?Et:hn.key),le=k(hn,le,Et),wt===null?ut=hn:wt.sibling=hn,wt=hn);return o&&bt.forEach(function(Vs){return l(ve,Vs)}),yr&&Po(ve,Et),ut}function lt(ve,le,Se,Qe){var ut=ge(Se);if(typeof ut!="function")throw Error(r(150));if(Se=ut.call(Se),Se==null)throw Error(r(151));for(var wt=ut=null,bt=le,Et=le=0,hn=null,Wt=Se.next();bt!==null&&!Wt.done;Et++,Wt=Se.next()){bt.index>Et?(hn=bt,bt=null):hn=bt.sibling;var Vs=Ke(ve,bt,Wt.value,Qe);if(Vs===null){bt===null&&(bt=hn);break}o&&bt&&Vs.alternate===null&&l(ve,bt),le=k(Vs,le,Et),wt===null?ut=Vs:wt.sibling=Vs,wt=Vs,bt=hn}if(Wt.done)return p(ve,bt),yr&&Po(ve,Et),ut;if(bt===null){for(;!Wt.done;Et++,Wt=Se.next())Wt=qe(ve,Wt.value,Qe),Wt!==null&&(le=k(Wt,le,Et),wt===null?ut=Wt:wt.sibling=Wt,wt=Wt);return yr&&Po(ve,Et),ut}for(bt=y(ve,bt);!Wt.done;Et++,Wt=Se.next())Wt=nt(bt,ve,Et,Wt.value,Qe),Wt!==null&&(o&&Wt.alternate!==null&&bt.delete(Wt.key===null?Et:Wt.key),le=k(Wt,le,Et),wt===null?ut=Wt:wt.sibling=Wt,wt=Wt);return o&&bt.forEach(function(kI){return l(ve,kI)}),yr&&Po(ve,Et),ut}function Lr(ve,le,Se,Qe){if(typeof Se=="object"&&Se!==null&&Se.type===j&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case O:e:{for(var ut=Se.key,wt=le;wt!==null;){if(wt.key===ut){if(ut=Se.type,ut===j){if(wt.tag===7){p(ve,wt.sibling),le=N(wt,Se.props.children),le.return=ve,ve=le;break e}}else if(wt.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Ie&&M2(ut)===wt.type){p(ve,wt.sibling),le=N(wt,Se.props),le.ref=mu(ve,wt,Se),le.return=ve,ve=le;break e}p(ve,wt);break}else l(ve,wt);wt=wt.sibling}Se.type===j?(le=Bo(Se.props.children,ve.mode,Qe,Se.key),le.return=ve,ve=le):(Qe=zd(Se.type,Se.key,Se.props,null,ve.mode,Qe),Qe.ref=mu(ve,le,Se),Qe.return=ve,ve=Qe)}return B(ve);case I:e:{for(wt=Se.key;le!==null;){if(le.key===wt)if(le.tag===4&&le.stateNode.containerInfo===Se.containerInfo&&le.stateNode.implementation===Se.implementation){p(ve,le.sibling),le=N(le,Se.children||[]),le.return=ve,ve=le;break e}else{p(ve,le);break}else l(ve,le);le=le.sibling}le=wx(Se,ve.mode,Qe),le.return=ve,ve=le}return B(ve);case Ie:return wt=Se._init,Lr(ve,le,wt(Se._payload),Qe)}if(je(Se))return ot(ve,le,Se,Qe);if(ge(Se))return lt(ve,le,Se,Qe);vd(ve,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,le!==null&&le.tag===6?(p(ve,le.sibling),le=N(le,Se),le.return=ve,ve=le):(p(ve,le),le=yx(Se,ve.mode,Qe),le.return=ve,ve=le),B(ve)):p(ve,le)}return Lr}var Ul=L2(!0),B2=L2(!1),yd=Is(null),wd=null,zl=null,Am=null;function jm(){Am=zl=wd=null}function Pm(o){var l=yd.current;pr(yd),o._currentValue=l}function Om(o,l,p){for(;o!==null;){var y=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,y!==null&&(y.childLanes|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),o===p)break;o=o.return}}function Hl(o,l){wd=o,Am=zl=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(da=!0),o.firstContext=null)}function Ka(o){var l=o._currentValue;if(Am!==o)if(o={context:o,memoizedValue:l,next:null},zl===null){if(wd===null)throw Error(r(308));zl=o,wd.dependencies={lanes:0,firstContext:o}}else zl=zl.next=o;return l}var Oo=null;function Dm(o){Oo===null?Oo=[o]:Oo.push(o)}function $2(o,l,p,y){var N=l.interleaved;return N===null?(p.next=p,Dm(l)):(p.next=N.next,N.next=p),l.interleaved=p,qi(o,y)}function qi(o,l){o.lanes|=l;var p=o.alternate;for(p!==null&&(p.lanes|=l),p=o,o=o.return;o!==null;)o.childLanes|=l,p=o.alternate,p!==null&&(p.childLanes|=l),p=o,o=o.return;return p.tag===3?p.stateNode:null}var Ms=!1;function Im(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U2(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Zi(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function Ls(o,l,p){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(zt&2)!==0){var N=y.pending;return N===null?l.next=l:(l.next=N.next,N.next=l),y.pending=l,qi(o,p)}return N=y.interleaved,N===null?(l.next=l,Dm(y)):(l.next=N.next,N.next=l),y.interleaved=l,qi(o,p)}function bd(o,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194240)!==0)){var y=l.lanes;y&=o.pendingLanes,p|=y,l.lanes=p,kl(o,p)}}function z2(o,l){var p=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var N=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var B={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};k===null?N=k=B:k=k.next=B,p=p.next}while(p!==null);k===null?N=k=l:k=k.next=l}else N=k=l;p={baseState:y.baseState,firstBaseUpdate:N,lastBaseUpdate:k,shared:y.shared,effects:y.effects},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=l:o.next=l,p.lastBaseUpdate=l}function _d(o,l,p,y){var N=o.updateQueue;Ms=!1;var k=N.firstBaseUpdate,B=N.lastBaseUpdate,te=N.shared.pending;if(te!==null){N.shared.pending=null;var oe=te,Ce=oe.next;oe.next=null,B===null?k=Ce:B.next=Ce,B=oe;var Ye=o.alternate;Ye!==null&&(Ye=Ye.updateQueue,te=Ye.lastBaseUpdate,te!==B&&(te===null?Ye.firstBaseUpdate=Ce:te.next=Ce,Ye.lastBaseUpdate=oe))}if(k!==null){var qe=N.baseState;B=0,Ye=Ce=oe=null,te=k;do{var Ke=te.lane,nt=te.eventTime;if((y&Ke)===Ke){Ye!==null&&(Ye=Ye.next={eventTime:nt,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var ot=o,lt=te;switch(Ke=l,nt=p,lt.tag){case 1:if(ot=lt.payload,typeof ot=="function"){qe=ot.call(nt,qe,Ke);break e}qe=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=lt.payload,Ke=typeof ot=="function"?ot.call(nt,qe,Ke):ot,Ke==null)break e;qe=Oe({},qe,Ke);break e;case 2:Ms=!0}}te.callback!==null&&te.lane!==0&&(o.flags|=64,Ke=N.effects,Ke===null?N.effects=[te]:Ke.push(te))}else nt={eventTime:nt,lane:Ke,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Ye===null?(Ce=Ye=nt,oe=qe):Ye=Ye.next=nt,B|=Ke;if(te=te.next,te===null){if(te=N.shared.pending,te===null)break;Ke=te,te=Ke.next,Ke.next=null,N.lastBaseUpdate=Ke,N.shared.pending=null}}while(!0);if(Ye===null&&(oe=qe),N.baseState=oe,N.firstBaseUpdate=Ce,N.lastBaseUpdate=Ye,l=N.shared.interleaved,l!==null){N=l;do B|=N.lane,N=N.next;while(N!==l)}else k===null&&(N.shared.lanes=0);Ro|=B,o.lanes=B,o.memoizedState=qe}}function H2(o,l,p){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var y=o[l],N=y.callback;if(N!==null){if(y.callback=null,y=p,typeof N!="function")throw Error(r(191,N));N.call(y)}}}var xu={},Ti=Is(xu),gu=Is(xu),vu=Is(xu);function Do(o){if(o===xu)throw Error(r(174));return o}function Rm(o,l){switch(ur(vu,l),ur(gu,o),ur(Ti,xu),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:_t(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=_t(l,o)}pr(Ti),ur(Ti,l)}function Wl(){pr(Ti),pr(gu),pr(vu)}function W2(o){Do(vu.current);var l=Do(Ti.current),p=_t(l,o.type);l!==p&&(ur(gu,o),ur(Ti,p))}function Fm(o){gu.current===o&&(pr(Ti),pr(gu))}var Ar=Is(0);function Sd(o){for(var l=o;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Mm=[];function Lm(){for(var o=0;o<Mm.length;o++)Mm[o]._workInProgressVersionPrimary=null;Mm.length=0}var Nd=D.ReactCurrentDispatcher,Bm=D.ReactCurrentBatchConfig,Io=0,jr=null,rn=null,fn=null,Ed=!1,yu=!1,wu=0,XD=0;function On(){throw Error(r(321))}function $m(o,l){if(l===null)return!1;for(var p=0;p<l.length&&p<o.length;p++)if(!ci(o[p],l[p]))return!1;return!0}function Um(o,l,p,y,N,k){if(Io=k,jr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Nd.current=o===null||o.memoizedState===null?JD:eI,o=p(y,N),yu){k=0;do{if(yu=!1,wu=0,25<=k)throw Error(r(301));k+=1,fn=rn=null,l.updateQueue=null,Nd.current=tI,o=p(y,N)}while(yu)}if(Nd.current=Cd,l=rn!==null&&rn.next!==null,Io=0,fn=rn=jr=null,Ed=!1,l)throw Error(r(300));return o}function zm(){var o=wu!==0;return wu=0,o}function ki(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?jr.memoizedState=fn=o:fn=fn.next=o,fn}function Ga(){if(rn===null){var o=jr.alternate;o=o!==null?o.memoizedState:null}else o=rn.next;var l=fn===null?jr.memoizedState:fn.next;if(l!==null)fn=l,rn=o;else{if(o===null)throw Error(r(310));rn=o,o={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},fn===null?jr.memoizedState=fn=o:fn=fn.next=o}return fn}function bu(o,l){return typeof l=="function"?l(o):l}function Hm(o){var l=Ga(),p=l.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var y=rn,N=y.baseQueue,k=p.pending;if(k!==null){if(N!==null){var B=N.next;N.next=k.next,k.next=B}y.baseQueue=N=k,p.pending=null}if(N!==null){k=N.next,y=y.baseState;var te=B=null,oe=null,Ce=k;do{var Ye=Ce.lane;if((Io&Ye)===Ye)oe!==null&&(oe=oe.next={lane:0,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null}),y=Ce.hasEagerState?Ce.eagerState:o(y,Ce.action);else{var qe={lane:Ye,action:Ce.action,hasEagerState:Ce.hasEagerState,eagerState:Ce.eagerState,next:null};oe===null?(te=oe=qe,B=y):oe=oe.next=qe,jr.lanes|=Ye,Ro|=Ye}Ce=Ce.next}while(Ce!==null&&Ce!==k);oe===null?B=y:oe.next=te,ci(y,l.memoizedState)||(da=!0),l.memoizedState=y,l.baseState=B,l.baseQueue=oe,p.lastRenderedState=y}if(o=p.interleaved,o!==null){N=o;do k=N.lane,jr.lanes|=k,Ro|=k,N=N.next;while(N!==o)}else N===null&&(p.lanes=0);return[l.memoizedState,p.dispatch]}function Wm(o){var l=Ga(),p=l.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=o;var y=p.dispatch,N=p.pending,k=l.memoizedState;if(N!==null){p.pending=null;var B=N=N.next;do k=o(k,B.action),B=B.next;while(B!==N);ci(k,l.memoizedState)||(da=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),p.lastRenderedState=k}return[k,y]}function V2(){}function K2(o,l){var p=jr,y=Ga(),N=l(),k=!ci(y.memoizedState,N);if(k&&(y.memoizedState=N,da=!0),y=y.queue,Vm(X2.bind(null,p,y,o),[o]),y.getSnapshot!==l||k||fn!==null&&fn.memoizedState.tag&1){if(p.flags|=2048,_u(9,Y2.bind(null,p,y,N,l),void 0,null),dn===null)throw Error(r(349));(Io&30)!==0||G2(p,l,N)}return N}function G2(o,l,p){o.flags|=16384,o={getSnapshot:l,value:p},l=jr.updateQueue,l===null?(l={lastEffect:null,stores:null},jr.updateQueue=l,l.stores=[o]):(p=l.stores,p===null?l.stores=[o]:p.push(o))}function Y2(o,l,p,y){l.value=p,l.getSnapshot=y,q2(l)&&Z2(o)}function X2(o,l,p){return p(function(){q2(l)&&Z2(o)})}function q2(o){var l=o.getSnapshot;o=o.value;try{var p=l();return!ci(o,p)}catch{return!0}}function Z2(o){var l=qi(o,1);l!==null&&pi(l,o,1,-1)}function Q2(o){var l=ki();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bu,lastRenderedState:o},l.queue=o,o=o.dispatch=QD.bind(null,jr,o),[l.memoizedState,o]}function _u(o,l,p,y){return o={tag:o,create:l,destroy:p,deps:y,next:null},l=jr.updateQueue,l===null?(l={lastEffect:null,stores:null},jr.updateQueue=l,l.lastEffect=o.next=o):(p=l.lastEffect,p===null?l.lastEffect=o.next=o:(y=p.next,p.next=o,o.next=y,l.lastEffect=o)),o}function J2(){return Ga().memoizedState}function Td(o,l,p,y){var N=ki();jr.flags|=o,N.memoizedState=_u(1|l,p,void 0,y===void 0?null:y)}function kd(o,l,p,y){var N=Ga();y=y===void 0?null:y;var k=void 0;if(rn!==null){var B=rn.memoizedState;if(k=B.destroy,y!==null&&$m(y,B.deps)){N.memoizedState=_u(l,p,k,y);return}}jr.flags|=o,N.memoizedState=_u(1|l,p,k,y)}function e_(o,l){return Td(8390656,8,o,l)}function Vm(o,l){return kd(2048,8,o,l)}function t_(o,l){return kd(4,2,o,l)}function r_(o,l){return kd(4,4,o,l)}function n_(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function a_(o,l,p){return p=p!=null?p.concat([o]):null,kd(4,4,n_.bind(null,l,o),p)}function Km(){}function i_(o,l){var p=Ga();l=l===void 0?null:l;var y=p.memoizedState;return y!==null&&l!==null&&$m(l,y[1])?y[0]:(p.memoizedState=[o,l],o)}function s_(o,l){var p=Ga();l=l===void 0?null:l;var y=p.memoizedState;return y!==null&&l!==null&&$m(l,y[1])?y[0]:(o=o(),p.memoizedState=[o,l],o)}function o_(o,l,p){return(Io&21)===0?(o.baseState&&(o.baseState=!1,da=!0),o.memoizedState=p):(ci(p,l)||(p=Tl(),jr.lanes|=p,Ro|=p,o.baseState=!0),l)}function qD(o,l){var p=Gt;Gt=p!==0&&4>p?p:4,o(!0);var y=Bm.transition;Bm.transition={};try{o(!1),l()}finally{Gt=p,Bm.transition=y}}function l_(){return Ga().memoizedState}function ZD(o,l,p){var y=zs(o);if(p={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null},c_(o))u_(l,p);else if(p=$2(o,l,p,y),p!==null){var N=qn();pi(p,o,y,N),f_(p,l,y)}}function QD(o,l,p){var y=zs(o),N={lane:y,action:p,hasEagerState:!1,eagerState:null,next:null};if(c_(o))u_(l,N);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var B=l.lastRenderedState,te=k(B,p);if(N.hasEagerState=!0,N.eagerState=te,ci(te,B)){var oe=l.interleaved;oe===null?(N.next=N,Dm(l)):(N.next=oe.next,oe.next=N),l.interleaved=N;return}}catch{}finally{}p=$2(o,l,N,y),p!==null&&(N=qn(),pi(p,o,y,N),f_(p,l,y))}}function c_(o){var l=o.alternate;return o===jr||l!==null&&l===jr}function u_(o,l){yu=Ed=!0;var p=o.pending;p===null?l.next=l:(l.next=p.next,p.next=l),o.pending=l}function f_(o,l,p){if((p&4194240)!==0){var y=l.lanes;y&=o.pendingLanes,p|=y,l.lanes=p,kl(o,p)}}var Cd={readContext:Ka,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},JD={readContext:Ka,useCallback:function(o,l){return ki().memoizedState=[o,l===void 0?null:l],o},useContext:Ka,useEffect:e_,useImperativeHandle:function(o,l,p){return p=p!=null?p.concat([o]):null,Td(4194308,4,n_.bind(null,l,o),p)},useLayoutEffect:function(o,l){return Td(4194308,4,o,l)},useInsertionEffect:function(o,l){return Td(4,2,o,l)},useMemo:function(o,l){var p=ki();return l=l===void 0?null:l,o=o(),p.memoizedState=[o,l],o},useReducer:function(o,l,p){var y=ki();return l=p!==void 0?p(l):l,y.memoizedState=y.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},y.queue=o,o=o.dispatch=ZD.bind(null,jr,o),[y.memoizedState,o]},useRef:function(o){var l=ki();return o={current:o},l.memoizedState=o},useState:Q2,useDebugValue:Km,useDeferredValue:function(o){return ki().memoizedState=o},useTransition:function(){var o=Q2(!1),l=o[0];return o=qD.bind(null,o[1]),ki().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,p){var y=jr,N=ki();if(yr){if(p===void 0)throw Error(r(407));p=p()}else{if(p=l(),dn===null)throw Error(r(349));(Io&30)!==0||G2(y,l,p)}N.memoizedState=p;var k={value:p,getSnapshot:l};return N.queue=k,e_(X2.bind(null,y,k,o),[o]),y.flags|=2048,_u(9,Y2.bind(null,y,k,p,l),void 0,null),p},useId:function(){var o=ki(),l=dn.identifierPrefix;if(yr){var p=Xi,y=Yi;p=(y&~(1<<32-Ft(y)-1)).toString(32)+p,l=":"+l+"R"+p,p=wu++,0<p&&(l+="H"+p.toString(32)),l+=":"}else p=XD++,l=":"+l+"r"+p.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},eI={readContext:Ka,useCallback:i_,useContext:Ka,useEffect:Vm,useImperativeHandle:a_,useInsertionEffect:t_,useLayoutEffect:r_,useMemo:s_,useReducer:Hm,useRef:J2,useState:function(){return Hm(bu)},useDebugValue:Km,useDeferredValue:function(o){var l=Ga();return o_(l,rn.memoizedState,o)},useTransition:function(){var o=Hm(bu)[0],l=Ga().memoizedState;return[o,l]},useMutableSource:V2,useSyncExternalStore:K2,useId:l_,unstable_isNewReconciler:!1},tI={readContext:Ka,useCallback:i_,useContext:Ka,useEffect:Vm,useImperativeHandle:a_,useInsertionEffect:t_,useLayoutEffect:r_,useMemo:s_,useReducer:Wm,useRef:J2,useState:function(){return Wm(bu)},useDebugValue:Km,useDeferredValue:function(o){var l=Ga();return rn===null?l.memoizedState=o:o_(l,rn.memoizedState,o)},useTransition:function(){var o=Wm(bu)[0],l=Ga().memoizedState;return[o,l]},useMutableSource:V2,useSyncExternalStore:K2,useId:l_,unstable_isNewReconciler:!1};function fi(o,l){if(o&&o.defaultProps){l=Oe({},l),o=o.defaultProps;for(var p in o)l[p]===void 0&&(l[p]=o[p]);return l}return l}function Gm(o,l,p,y){l=o.memoizedState,p=p(y,l),p=p==null?l:Oe({},l,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}var Ad={isMounted:function(o){return(o=o._reactInternals)?E(o)===o:!1},enqueueSetState:function(o,l,p){o=o._reactInternals;var y=qn(),N=zs(o),k=Zi(y,N);k.payload=l,p!=null&&(k.callback=p),l=Ls(o,k,N),l!==null&&(pi(l,o,N,y),bd(l,o,N))},enqueueReplaceState:function(o,l,p){o=o._reactInternals;var y=qn(),N=zs(o),k=Zi(y,N);k.tag=1,k.payload=l,p!=null&&(k.callback=p),l=Ls(o,k,N),l!==null&&(pi(l,o,N,y),bd(l,o,N))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var p=qn(),y=zs(o),N=Zi(p,y);N.tag=2,l!=null&&(N.callback=l),l=Ls(o,N,y),l!==null&&(pi(l,o,y,p),bd(l,o,y))}};function d_(o,l,p,y,N,k,B){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,k,B):l.prototype&&l.prototype.isPureReactComponent?!lu(p,y)||!lu(N,k):!0}function h_(o,l,p){var y=!1,N=Rs,k=l.contextType;return typeof k=="object"&&k!==null?k=Ka(k):(N=fa(l)?Ao:Pn.current,y=l.contextTypes,k=(y=y!=null)?Ml(o,N):Rs),l=new l(p,k),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ad,o.stateNode=l,l._reactInternals=o,y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=N,o.__reactInternalMemoizedMaskedChildContext=k),l}function p_(o,l,p,y){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,y),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,y),l.state!==o&&Ad.enqueueReplaceState(l,l.state,null)}function Ym(o,l,p,y){var N=o.stateNode;N.props=p,N.state=o.memoizedState,N.refs={},Im(o);var k=l.contextType;typeof k=="object"&&k!==null?N.context=Ka(k):(k=fa(l)?Ao:Pn.current,N.context=Ml(o,k)),N.state=o.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&(Gm(o,l,k,p),N.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(l=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),l!==N.state&&Ad.enqueueReplaceState(N,N.state,null),_d(o,p,N,y),N.state=o.memoizedState),typeof N.componentDidMount=="function"&&(o.flags|=4194308)}function Vl(o,l){try{var p="",y=l;do p+=Ve(y),y=y.return;while(y);var N=p}catch(k){N=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:l,stack:N,digest:null}}function Xm(o,l,p){return{value:o,source:null,stack:p??null,digest:l??null}}function qm(o,l){try{console.error(l.value)}catch(p){setTimeout(function(){throw p})}}var rI=typeof WeakMap=="function"?WeakMap:Map;function m_(o,l,p){p=Zi(-1,p),p.tag=3,p.payload={element:null};var y=l.value;return p.callback=function(){Fd||(Fd=!0,fx=y),qm(o,l)},p}function x_(o,l,p){p=Zi(-1,p),p.tag=3;var y=o.type.getDerivedStateFromError;if(typeof y=="function"){var N=l.value;p.payload=function(){return y(N)},p.callback=function(){qm(o,l)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(p.callback=function(){qm(o,l),typeof y!="function"&&($s===null?$s=new Set([this]):$s.add(this));var B=l.stack;this.componentDidCatch(l.value,{componentStack:B!==null?B:""})}),p}function g_(o,l,p){var y=o.pingCache;if(y===null){y=o.pingCache=new rI;var N=new Set;y.set(l,N)}else N=y.get(l),N===void 0&&(N=new Set,y.set(l,N));N.has(p)||(N.add(p),o=xI.bind(null,o,l,p),l.then(o,o))}function v_(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function y_(o,l,p,y,N){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(l=Zi(-1,1),l.tag=2,Ls(p,l,1))),p.lanes|=1),o):(o.flags|=65536,o.lanes=N,o)}var nI=D.ReactCurrentOwner,da=!1;function Xn(o,l,p,y){l.child=o===null?B2(l,null,p,y):Ul(l,o.child,p,y)}function w_(o,l,p,y,N){p=p.render;var k=l.ref;return Hl(l,N),y=Um(o,l,p,y,k,N),p=zm(),o!==null&&!da?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~N,Qi(o,l,N)):(yr&&p&&Nm(l),l.flags|=1,Xn(o,l,y,N),l.child)}function b_(o,l,p,y,N){if(o===null){var k=p.type;return typeof k=="function"&&!vx(k)&&k.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(l.tag=15,l.type=k,__(o,l,k,y,N)):(o=zd(p.type,null,y,l,l.mode,N),o.ref=l.ref,o.return=l,l.child=o)}if(k=o.child,(o.lanes&N)===0){var B=k.memoizedProps;if(p=p.compare,p=p!==null?p:lu,p(B,y)&&o.ref===l.ref)return Qi(o,l,N)}return l.flags|=1,o=Ws(k,y),o.ref=l.ref,o.return=l,l.child=o}function __(o,l,p,y,N){if(o!==null){var k=o.memoizedProps;if(lu(k,y)&&o.ref===l.ref)if(da=!1,l.pendingProps=y=k,(o.lanes&N)!==0)(o.flags&131072)!==0&&(da=!0);else return l.lanes=o.lanes,Qi(o,l,N)}return Zm(o,l,p,y,N)}function S_(o,l,p){var y=l.pendingProps,N=y.children,k=o!==null?o.memoizedState:null;if(y.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur(Gl,Ca),Ca|=p;else{if((p&1073741824)===0)return o=k!==null?k.baseLanes|p:p,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,ur(Gl,Ca),Ca|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=k!==null?k.baseLanes:p,ur(Gl,Ca),Ca|=y}else k!==null?(y=k.baseLanes|p,l.memoizedState=null):y=p,ur(Gl,Ca),Ca|=y;return Xn(o,l,N,p),l.child}function N_(o,l){var p=l.ref;(o===null&&p!==null||o!==null&&o.ref!==p)&&(l.flags|=512,l.flags|=2097152)}function Zm(o,l,p,y,N){var k=fa(p)?Ao:Pn.current;return k=Ml(l,k),Hl(l,N),p=Um(o,l,p,y,k,N),y=zm(),o!==null&&!da?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~N,Qi(o,l,N)):(yr&&y&&Nm(l),l.flags|=1,Xn(o,l,p,N),l.child)}function E_(o,l,p,y,N){if(fa(p)){var k=!0;hd(l)}else k=!1;if(Hl(l,N),l.stateNode===null)Pd(o,l),h_(l,p,y),Ym(l,p,y,N),y=!0;else if(o===null){var B=l.stateNode,te=l.memoizedProps;B.props=te;var oe=B.context,Ce=p.contextType;typeof Ce=="object"&&Ce!==null?Ce=Ka(Ce):(Ce=fa(p)?Ao:Pn.current,Ce=Ml(l,Ce));var Ye=p.getDerivedStateFromProps,qe=typeof Ye=="function"||typeof B.getSnapshotBeforeUpdate=="function";qe||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(te!==y||oe!==Ce)&&p_(l,B,y,Ce),Ms=!1;var Ke=l.memoizedState;B.state=Ke,_d(l,y,B,N),oe=l.memoizedState,te!==y||Ke!==oe||ua.current||Ms?(typeof Ye=="function"&&(Gm(l,p,Ye,y),oe=l.memoizedState),(te=Ms||d_(l,p,te,y,Ke,oe,Ce))?(qe||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(l.flags|=4194308)):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=y,l.memoizedState=oe),B.props=y,B.state=oe,B.context=Ce,y=te):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),y=!1)}else{B=l.stateNode,U2(o,l),te=l.memoizedProps,Ce=l.type===l.elementType?te:fi(l.type,te),B.props=Ce,qe=l.pendingProps,Ke=B.context,oe=p.contextType,typeof oe=="object"&&oe!==null?oe=Ka(oe):(oe=fa(p)?Ao:Pn.current,oe=Ml(l,oe));var nt=p.getDerivedStateFromProps;(Ye=typeof nt=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(te!==qe||Ke!==oe)&&p_(l,B,y,oe),Ms=!1,Ke=l.memoizedState,B.state=Ke,_d(l,y,B,N);var ot=l.memoizedState;te!==qe||Ke!==ot||ua.current||Ms?(typeof nt=="function"&&(Gm(l,p,nt,y),ot=l.memoizedState),(Ce=Ms||d_(l,p,Ce,y,Ke,ot,oe)||!1)?(Ye||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(y,ot,oe),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(y,ot,oe)),typeof B.componentDidUpdate=="function"&&(l.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof B.componentDidUpdate!="function"||te===o.memoizedProps&&Ke===o.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||te===o.memoizedProps&&Ke===o.memoizedState||(l.flags|=1024),l.memoizedProps=y,l.memoizedState=ot),B.props=y,B.state=ot,B.context=oe,y=Ce):(typeof B.componentDidUpdate!="function"||te===o.memoizedProps&&Ke===o.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||te===o.memoizedProps&&Ke===o.memoizedState||(l.flags|=1024),y=!1)}return Qm(o,l,p,y,k,N)}function Qm(o,l,p,y,N,k){N_(o,l);var B=(l.flags&128)!==0;if(!y&&!B)return N&&j2(l,p,!1),Qi(o,l,k);y=l.stateNode,nI.current=l;var te=B&&typeof p.getDerivedStateFromError!="function"?null:y.render();return l.flags|=1,o!==null&&B?(l.child=Ul(l,o.child,null,k),l.child=Ul(l,null,te,k)):Xn(o,l,te,k),l.memoizedState=y.state,N&&j2(l,p,!0),l.child}function T_(o){var l=o.stateNode;l.pendingContext?C2(o,l.pendingContext,l.pendingContext!==l.context):l.context&&C2(o,l.context,!1),Rm(o,l.containerInfo)}function k_(o,l,p,y,N){return $l(),Cm(N),l.flags|=256,Xn(o,l,p,y),l.child}var Jm={dehydrated:null,treeContext:null,retryLane:0};function ex(o){return{baseLanes:o,cachePool:null,transitions:null}}function C_(o,l,p){var y=l.pendingProps,N=Ar.current,k=!1,B=(l.flags&128)!==0,te;if((te=B)||(te=o!==null&&o.memoizedState===null?!1:(N&2)!==0),te?(k=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(N|=1),ur(Ar,N&1),o===null)return km(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(B=y.children,o=y.fallback,k?(y=l.mode,k=l.child,B={mode:"hidden",children:B},(y&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=B):k=Hd(B,y,0,null),o=Bo(o,y,p,null),k.return=l,o.return=l,k.sibling=o,l.child=k,l.child.memoizedState=ex(p),l.memoizedState=Jm,o):tx(l,B));if(N=o.memoizedState,N!==null&&(te=N.dehydrated,te!==null))return aI(o,l,B,y,te,N,p);if(k){k=y.fallback,B=l.mode,N=o.child,te=N.sibling;var oe={mode:"hidden",children:y.children};return(B&1)===0&&l.child!==N?(y=l.child,y.childLanes=0,y.pendingProps=oe,l.deletions=null):(y=Ws(N,oe),y.subtreeFlags=N.subtreeFlags&14680064),te!==null?k=Ws(te,k):(k=Bo(k,B,p,null),k.flags|=2),k.return=l,y.return=l,y.sibling=k,l.child=y,y=k,k=l.child,B=o.child.memoizedState,B=B===null?ex(p):{baseLanes:B.baseLanes|p,cachePool:null,transitions:B.transitions},k.memoizedState=B,k.childLanes=o.childLanes&~p,l.memoizedState=Jm,y}return k=o.child,o=k.sibling,y=Ws(k,{mode:"visible",children:y.children}),(l.mode&1)===0&&(y.lanes=p),y.return=l,y.sibling=null,o!==null&&(p=l.deletions,p===null?(l.deletions=[o],l.flags|=16):p.push(o)),l.child=y,l.memoizedState=null,y}function tx(o,l){return l=Hd({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function jd(o,l,p,y){return y!==null&&Cm(y),Ul(l,o.child,null,p),o=tx(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function aI(o,l,p,y,N,k,B){if(p)return l.flags&256?(l.flags&=-257,y=Xm(Error(r(422))),jd(o,l,B,y)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(k=y.fallback,N=l.mode,y=Hd({mode:"visible",children:y.children},N,0,null),k=Bo(k,N,B,null),k.flags|=2,y.return=l,k.return=l,y.sibling=k,l.child=y,(l.mode&1)!==0&&Ul(l,o.child,null,B),l.child.memoizedState=ex(B),l.memoizedState=Jm,k);if((l.mode&1)===0)return jd(o,l,B,null);if(N.data==="$!"){if(y=N.nextSibling&&N.nextSibling.dataset,y)var te=y.dgst;return y=te,k=Error(r(419)),y=Xm(k,y,void 0),jd(o,l,B,y)}if(te=(B&o.childLanes)!==0,da||te){if(y=dn,y!==null){switch(B&-B){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(y.suspendedLanes|B))!==0?0:N,N!==0&&N!==k.retryLane&&(k.retryLane=N,qi(o,N),pi(y,o,N,-1))}return gx(),y=Xm(Error(r(421))),jd(o,l,B,y)}return N.data==="$?"?(l.flags|=128,l.child=o.child,l=gI.bind(null,o),N._reactRetry=l,null):(o=k.treeContext,ka=Ds(N.nextSibling),Ta=l,yr=!0,ui=null,o!==null&&(Wa[Va++]=Yi,Wa[Va++]=Xi,Wa[Va++]=jo,Yi=o.id,Xi=o.overflow,jo=l),l=tx(l,y.children),l.flags|=4096,l)}function A_(o,l,p){o.lanes|=l;var y=o.alternate;y!==null&&(y.lanes|=l),Om(o.return,l,p)}function rx(o,l,p,y,N){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:N}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=y,k.tail=p,k.tailMode=N)}function j_(o,l,p){var y=l.pendingProps,N=y.revealOrder,k=y.tail;if(Xn(o,l,y.children,p),y=Ar.current,(y&2)!==0)y=y&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&A_(o,p,l);else if(o.tag===19)A_(o,p,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}y&=1}if(ur(Ar,y),(l.mode&1)===0)l.memoizedState=null;else switch(N){case"forwards":for(p=l.child,N=null;p!==null;)o=p.alternate,o!==null&&Sd(o)===null&&(N=p),p=p.sibling;p=N,p===null?(N=l.child,l.child=null):(N=p.sibling,p.sibling=null),rx(l,!1,N,p,k);break;case"backwards":for(p=null,N=l.child,l.child=null;N!==null;){if(o=N.alternate,o!==null&&Sd(o)===null){l.child=N;break}o=N.sibling,N.sibling=p,p=N,N=o}rx(l,!0,p,null,k);break;case"together":rx(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Pd(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function Qi(o,l,p){if(o!==null&&(l.dependencies=o.dependencies),Ro|=l.lanes,(p&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(r(153));if(l.child!==null){for(o=l.child,p=Ws(o,o.pendingProps),l.child=p,p.return=l;o.sibling!==null;)o=o.sibling,p=p.sibling=Ws(o,o.pendingProps),p.return=l;p.sibling=null}return l.child}function iI(o,l,p){switch(l.tag){case 3:T_(l),$l();break;case 5:W2(l);break;case 1:fa(l.type)&&hd(l);break;case 4:Rm(l,l.stateNode.containerInfo);break;case 10:var y=l.type._context,N=l.memoizedProps.value;ur(yd,y._currentValue),y._currentValue=N;break;case 13:if(y=l.memoizedState,y!==null)return y.dehydrated!==null?(ur(Ar,Ar.current&1),l.flags|=128,null):(p&l.child.childLanes)!==0?C_(o,l,p):(ur(Ar,Ar.current&1),o=Qi(o,l,p),o!==null?o.sibling:null);ur(Ar,Ar.current&1);break;case 19:if(y=(p&l.childLanes)!==0,(o.flags&128)!==0){if(y)return j_(o,l,p);l.flags|=128}if(N=l.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),ur(Ar,Ar.current),y)break;return null;case 22:case 23:return l.lanes=0,S_(o,l,p)}return Qi(o,l,p)}var P_,nx,O_,D_;P_=function(o,l){for(var p=l.child;p!==null;){if(p.tag===5||p.tag===6)o.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===l)break;for(;p.sibling===null;){if(p.return===null||p.return===l)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},nx=function(){},O_=function(o,l,p,y){var N=o.memoizedProps;if(N!==y){o=l.stateNode,Do(Ti.current);var k=null;switch(p){case"input":N=_e(o,N),y=_e(o,y),k=[];break;case"select":N=Oe({},N,{value:void 0}),y=Oe({},y,{value:void 0}),k=[];break;case"textarea":N=et(o,N),y=et(o,y),k=[];break;default:typeof N.onClick!="function"&&typeof y.onClick=="function"&&(o.onclick=ud)}en(p,y);var B;p=null;for(Ce in N)if(!y.hasOwnProperty(Ce)&&N.hasOwnProperty(Ce)&&N[Ce]!=null)if(Ce==="style"){var te=N[Ce];for(B in te)te.hasOwnProperty(B)&&(p||(p={}),p[B]="")}else Ce!=="dangerouslySetInnerHTML"&&Ce!=="children"&&Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&Ce!=="autoFocus"&&(a.hasOwnProperty(Ce)?k||(k=[]):(k=k||[]).push(Ce,null));for(Ce in y){var oe=y[Ce];if(te=N?.[Ce],y.hasOwnProperty(Ce)&&oe!==te&&(oe!=null||te!=null))if(Ce==="style")if(te){for(B in te)!te.hasOwnProperty(B)||oe&&oe.hasOwnProperty(B)||(p||(p={}),p[B]="");for(B in oe)oe.hasOwnProperty(B)&&te[B]!==oe[B]&&(p||(p={}),p[B]=oe[B])}else p||(k||(k=[]),k.push(Ce,p)),p=oe;else Ce==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,te=te?te.__html:void 0,oe!=null&&te!==oe&&(k=k||[]).push(Ce,oe)):Ce==="children"?typeof oe!="string"&&typeof oe!="number"||(k=k||[]).push(Ce,""+oe):Ce!=="suppressContentEditableWarning"&&Ce!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ce)?(oe!=null&&Ce==="onScroll"&&hr("scroll",o),k||te===oe||(k=[])):(k=k||[]).push(Ce,oe))}p&&(k=k||[]).push("style",p);var Ce=k;(l.updateQueue=Ce)&&(l.flags|=4)}},D_=function(o,l,p,y){p!==y&&(l.flags|=4)};function Su(o,l){if(!yr)switch(o.tailMode){case"hidden":l=o.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function Dn(o){var l=o.alternate!==null&&o.alternate.child===o.child,p=0,y=0;if(l)for(var N=o.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags&14680064,y|=N.flags&14680064,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)p|=N.lanes|N.childLanes,y|=N.subtreeFlags,y|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=y,o.childLanes=p,l}function sI(o,l,p){var y=l.pendingProps;switch(Em(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(l),null;case 1:return fa(l.type)&&dd(),Dn(l),null;case 3:return y=l.stateNode,Wl(),pr(ua),pr(Pn),Lm(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(o===null||o.child===null)&&(gd(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ui!==null&&(px(ui),ui=null))),nx(o,l),Dn(l),null;case 5:Fm(l);var N=Do(vu.current);if(p=l.type,o!==null&&l.stateNode!=null)O_(o,l,p,y,N),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!y){if(l.stateNode===null)throw Error(r(166));return Dn(l),null}if(o=Do(Ti.current),gd(l)){y=l.stateNode,p=l.type;var k=l.memoizedProps;switch(y[Ei]=l,y[hu]=k,o=(l.mode&1)!==0,p){case"dialog":hr("cancel",y),hr("close",y);break;case"iframe":case"object":case"embed":hr("load",y);break;case"video":case"audio":for(N=0;N<uu.length;N++)hr(uu[N],y);break;case"source":hr("error",y);break;case"img":case"image":case"link":hr("error",y),hr("load",y);break;case"details":hr("toggle",y);break;case"input":Me(y,k),hr("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!k.multiple},hr("invalid",y);break;case"textarea":Ue(y,k),hr("invalid",y)}en(p,k),N=null;for(var B in k)if(k.hasOwnProperty(B)){var te=k[B];B==="children"?typeof te=="string"?y.textContent!==te&&(k.suppressHydrationWarning!==!0&&cd(y.textContent,te,o),N=["children",te]):typeof te=="number"&&y.textContent!==""+te&&(k.suppressHydrationWarning!==!0&&cd(y.textContent,te,o),N=["children",""+te]):a.hasOwnProperty(B)&&te!=null&&B==="onScroll"&&hr("scroll",y)}switch(p){case"input":Z(y),Ae(y,k,!0);break;case"textarea":Z(y),ce(y);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(y.onclick=ud)}y=N,l.updateQueue=y,y!==null&&(l.flags|=4)}else{B=N.nodeType===9?N:N.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=rt(p)),o==="http://www.w3.org/1999/xhtml"?p==="script"?(o=B.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof y.is=="string"?o=B.createElement(p,{is:y.is}):(o=B.createElement(p),p==="select"&&(B=o,y.multiple?B.multiple=!0:y.size&&(B.size=y.size))):o=B.createElementNS(o,p),o[Ei]=l,o[hu]=y,P_(o,l,!1,!1),l.stateNode=o;e:{switch(B=Ur(p,y),p){case"dialog":hr("cancel",o),hr("close",o),N=y;break;case"iframe":case"object":case"embed":hr("load",o),N=y;break;case"video":case"audio":for(N=0;N<uu.length;N++)hr(uu[N],o);N=y;break;case"source":hr("error",o),N=y;break;case"img":case"image":case"link":hr("error",o),hr("load",o),N=y;break;case"details":hr("toggle",o),N=y;break;case"input":Me(o,y),N=_e(o,y),hr("invalid",o);break;case"option":N=y;break;case"select":o._wrapperState={wasMultiple:!!y.multiple},N=Oe({},y,{value:void 0}),hr("invalid",o);break;case"textarea":Ue(o,y),N=et(o,y),hr("invalid",o);break;default:N=y}en(p,N),te=N;for(k in te)if(te.hasOwnProperty(k)){var oe=te[k];k==="style"?Ut(o,oe):k==="dangerouslySetInnerHTML"?(oe=oe?oe.__html:void 0,oe!=null&&Bt(o,oe)):k==="children"?typeof oe=="string"?(p!=="textarea"||oe!=="")&&Tt(o,oe):typeof oe=="number"&&Tt(o,""+oe):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(a.hasOwnProperty(k)?oe!=null&&k==="onScroll"&&hr("scroll",o):oe!=null&&T(o,k,oe,B))}switch(p){case"input":Z(o),Ae(o,y,!1);break;case"textarea":Z(o),ce(o);break;case"option":y.value!=null&&o.setAttribute("value",""+U(y.value));break;case"select":o.multiple=!!y.multiple,k=y.value,k!=null?He(o,!!y.multiple,k,!1):y.defaultValue!=null&&He(o,!!y.multiple,y.defaultValue,!0);break;default:typeof N.onClick=="function"&&(o.onclick=ud)}switch(p){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Dn(l),null;case 6:if(o&&l.stateNode!=null)D_(o,l,o.memoizedProps,y);else{if(typeof y!="string"&&l.stateNode===null)throw Error(r(166));if(p=Do(vu.current),Do(Ti.current),gd(l)){if(y=l.stateNode,p=l.memoizedProps,y[Ei]=l,(k=y.nodeValue!==p)&&(o=Ta,o!==null))switch(o.tag){case 3:cd(y.nodeValue,p,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&cd(y.nodeValue,p,(o.mode&1)!==0)}k&&(l.flags|=4)}else y=(p.nodeType===9?p:p.ownerDocument).createTextNode(y),y[Ei]=l,l.stateNode=y}return Dn(l),null;case 13:if(pr(Ar),y=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(yr&&ka!==null&&(l.mode&1)!==0&&(l.flags&128)===0)F2(),$l(),l.flags|=98560,k=!1;else if(k=gd(l),y!==null&&y.dehydrated!==null){if(o===null){if(!k)throw Error(r(318));if(k=l.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(r(317));k[Ei]=l}else $l(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Dn(l),k=!1}else ui!==null&&(px(ui),ui=null),k=!0;if(!k)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=p,l):(y=y!==null,y!==(o!==null&&o.memoizedState!==null)&&y&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(Ar.current&1)!==0?nn===0&&(nn=3):gx())),l.updateQueue!==null&&(l.flags|=4),Dn(l),null);case 4:return Wl(),nx(o,l),o===null&&fu(l.stateNode.containerInfo),Dn(l),null;case 10:return Pm(l.type._context),Dn(l),null;case 17:return fa(l.type)&&dd(),Dn(l),null;case 19:if(pr(Ar),k=l.memoizedState,k===null)return Dn(l),null;if(y=(l.flags&128)!==0,B=k.rendering,B===null)if(y)Su(k,!1);else{if(nn!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(B=Sd(o),B!==null){for(l.flags|=128,Su(k,!1),y=B.updateQueue,y!==null&&(l.updateQueue=y,l.flags|=4),l.subtreeFlags=0,y=p,p=l.child;p!==null;)k=p,o=y,k.flags&=14680066,B=k.alternate,B===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=B.childLanes,k.lanes=B.lanes,k.child=B.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=B.memoizedProps,k.memoizedState=B.memoizedState,k.updateQueue=B.updateQueue,k.type=B.type,o=B.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),p=p.sibling;return ur(Ar,Ar.current&1|2),l.child}o=o.sibling}k.tail!==null&&ke()>Yl&&(l.flags|=128,y=!0,Su(k,!1),l.lanes=4194304)}else{if(!y)if(o=Sd(B),o!==null){if(l.flags|=128,y=!0,p=o.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),Su(k,!0),k.tail===null&&k.tailMode==="hidden"&&!B.alternate&&!yr)return Dn(l),null}else 2*ke()-k.renderingStartTime>Yl&&p!==1073741824&&(l.flags|=128,y=!0,Su(k,!1),l.lanes=4194304);k.isBackwards?(B.sibling=l.child,l.child=B):(p=k.last,p!==null?p.sibling=B:l.child=B,k.last=B)}return k.tail!==null?(l=k.tail,k.rendering=l,k.tail=l.sibling,k.renderingStartTime=ke(),l.sibling=null,p=Ar.current,ur(Ar,y?p&1|2:p&1),l):(Dn(l),null);case 22:case 23:return xx(),y=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==y&&(l.flags|=8192),y&&(l.mode&1)!==0?(Ca&1073741824)!==0&&(Dn(l),l.subtreeFlags&6&&(l.flags|=8192)):Dn(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function oI(o,l){switch(Em(l),l.tag){case 1:return fa(l.type)&&dd(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Wl(),pr(ua),pr(Pn),Lm(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return Fm(l),null;case 13:if(pr(Ar),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(r(340));$l()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return pr(Ar),null;case 4:return Wl(),null;case 10:return Pm(l.type._context),null;case 22:case 23:return xx(),null;case 24:return null;default:return null}}var Od=!1,In=!1,lI=typeof WeakSet=="function"?WeakSet:Set,it=null;function Kl(o,l){var p=o.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(y){Rr(o,l,y)}else p.current=null}function ax(o,l,p){try{p()}catch(y){Rr(o,l,y)}}var I_=!1;function cI(o,l){if(xm=Qf,o=d2(),lm(o)){if("selectionStart"in o)var p={start:o.selectionStart,end:o.selectionEnd};else e:{p=(p=o.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var N=y.anchorOffset,k=y.focusNode;y=y.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break e}var B=0,te=-1,oe=-1,Ce=0,Ye=0,qe=o,Ke=null;t:for(;;){for(var nt;qe!==p||N!==0&&qe.nodeType!==3||(te=B+N),qe!==k||y!==0&&qe.nodeType!==3||(oe=B+y),qe.nodeType===3&&(B+=qe.nodeValue.length),(nt=qe.firstChild)!==null;)Ke=qe,qe=nt;for(;;){if(qe===o)break t;if(Ke===p&&++Ce===N&&(te=B),Ke===k&&++Ye===y&&(oe=B),(nt=qe.nextSibling)!==null)break;qe=Ke,Ke=qe.parentNode}qe=nt}p=te===-1||oe===-1?null:{start:te,end:oe}}else p=null}p=p||{start:0,end:0}}else p=null;for(gm={focusedElem:o,selectionRange:p},Qf=!1,it=l;it!==null;)if(l=it,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,it=o;else for(;it!==null;){l=it;try{var ot=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var lt=ot.memoizedProps,Lr=ot.memoizedState,ve=l.stateNode,le=ve.getSnapshotBeforeUpdate(l.elementType===l.type?lt:fi(l.type,lt),Lr);ve.__reactInternalSnapshotBeforeUpdate=le}break;case 3:var Se=l.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Qe){Rr(l,l.return,Qe)}if(o=l.sibling,o!==null){o.return=l.return,it=o;break}it=l.return}return ot=I_,I_=!1,ot}function Nu(o,l,p){var y=l.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var N=y=y.next;do{if((N.tag&o)===o){var k=N.destroy;N.destroy=void 0,k!==void 0&&ax(l,p,k)}N=N.next}while(N!==y)}}function Dd(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&o)===o){var y=p.create;p.destroy=y()}p=p.next}while(p!==l)}}function ix(o){var l=o.ref;if(l!==null){var p=o.stateNode;switch(o.tag){case 5:o=p;break;default:o=p}typeof l=="function"?l(o):l.current=o}}function R_(o){var l=o.alternate;l!==null&&(o.alternate=null,R_(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[Ei],delete l[hu],delete l[bm],delete l[VD],delete l[KD])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function F_(o){return o.tag===5||o.tag===3||o.tag===4}function M_(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||F_(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function sx(o,l,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,l?p.nodeType===8?p.parentNode.insertBefore(o,l):p.insertBefore(o,l):(p.nodeType===8?(l=p.parentNode,l.insertBefore(o,p)):(l=p,l.appendChild(o)),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=ud));else if(y!==4&&(o=o.child,o!==null))for(sx(o,l,p),o=o.sibling;o!==null;)sx(o,l,p),o=o.sibling}function ox(o,l,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,l?p.insertBefore(o,l):p.appendChild(o);else if(y!==4&&(o=o.child,o!==null))for(ox(o,l,p),o=o.sibling;o!==null;)ox(o,l,p),o=o.sibling}var yn=null,di=!1;function Bs(o,l,p){for(p=p.child;p!==null;)L_(o,l,p),p=p.sibling}function L_(o,l,p){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(jt,p)}catch{}switch(p.tag){case 5:In||Kl(p,l);case 6:var y=yn,N=di;yn=null,Bs(o,l,p),yn=y,di=N,yn!==null&&(di?(o=yn,p=p.stateNode,o.nodeType===8?o.parentNode.removeChild(p):o.removeChild(p)):yn.removeChild(p.stateNode));break;case 18:yn!==null&&(di?(o=yn,p=p.stateNode,o.nodeType===8?wm(o.parentNode,p):o.nodeType===1&&wm(o,p),ru(o)):wm(yn,p.stateNode));break;case 4:y=yn,N=di,yn=p.stateNode.containerInfo,di=!0,Bs(o,l,p),yn=y,di=N;break;case 0:case 11:case 14:case 15:if(!In&&(y=p.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){N=y=y.next;do{var k=N,B=k.destroy;k=k.tag,B!==void 0&&((k&2)!==0||(k&4)!==0)&&ax(p,l,B),N=N.next}while(N!==y)}Bs(o,l,p);break;case 1:if(!In&&(Kl(p,l),y=p.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=p.memoizedProps,y.state=p.memoizedState,y.componentWillUnmount()}catch(te){Rr(p,l,te)}Bs(o,l,p);break;case 21:Bs(o,l,p);break;case 22:p.mode&1?(In=(y=In)||p.memoizedState!==null,Bs(o,l,p),In=y):Bs(o,l,p);break;default:Bs(o,l,p)}}function B_(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var p=o.stateNode;p===null&&(p=o.stateNode=new lI),l.forEach(function(y){var N=vI.bind(null,o,y);p.has(y)||(p.add(y),y.then(N,N))})}}function hi(o,l){var p=l.deletions;if(p!==null)for(var y=0;y<p.length;y++){var N=p[y];try{var k=o,B=l,te=B;e:for(;te!==null;){switch(te.tag){case 5:yn=te.stateNode,di=!1;break e;case 3:yn=te.stateNode.containerInfo,di=!0;break e;case 4:yn=te.stateNode.containerInfo,di=!0;break e}te=te.return}if(yn===null)throw Error(r(160));L_(k,B,N),yn=null,di=!1;var oe=N.alternate;oe!==null&&(oe.return=null),N.return=null}catch(Ce){Rr(N,l,Ce)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)$_(l,o),l=l.sibling}function $_(o,l){var p=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(hi(l,o),Ci(o),y&4){try{Nu(3,o,o.return),Dd(3,o)}catch(lt){Rr(o,o.return,lt)}try{Nu(5,o,o.return)}catch(lt){Rr(o,o.return,lt)}}break;case 1:hi(l,o),Ci(o),y&512&&p!==null&&Kl(p,p.return);break;case 5:if(hi(l,o),Ci(o),y&512&&p!==null&&Kl(p,p.return),o.flags&32){var N=o.stateNode;try{Tt(N,"")}catch(lt){Rr(o,o.return,lt)}}if(y&4&&(N=o.stateNode,N!=null)){var k=o.memoizedProps,B=p!==null?p.memoizedProps:k,te=o.type,oe=o.updateQueue;if(o.updateQueue=null,oe!==null)try{te==="input"&&k.type==="radio"&&k.name!=null&&Re(N,k),Ur(te,B);var Ce=Ur(te,k);for(B=0;B<oe.length;B+=2){var Ye=oe[B],qe=oe[B+1];Ye==="style"?Ut(N,qe):Ye==="dangerouslySetInnerHTML"?Bt(N,qe):Ye==="children"?Tt(N,qe):T(N,Ye,qe,Ce)}switch(te){case"input":ne(N,k);break;case"textarea":fe(N,k);break;case"select":var Ke=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!k.multiple;var nt=k.value;nt!=null?He(N,!!k.multiple,nt,!1):Ke!==!!k.multiple&&(k.defaultValue!=null?He(N,!!k.multiple,k.defaultValue,!0):He(N,!!k.multiple,k.multiple?[]:"",!1))}N[hu]=k}catch(lt){Rr(o,o.return,lt)}}break;case 6:if(hi(l,o),Ci(o),y&4){if(o.stateNode===null)throw Error(r(162));N=o.stateNode,k=o.memoizedProps;try{N.nodeValue=k}catch(lt){Rr(o,o.return,lt)}}break;case 3:if(hi(l,o),Ci(o),y&4&&p!==null&&p.memoizedState.isDehydrated)try{ru(l.containerInfo)}catch(lt){Rr(o,o.return,lt)}break;case 4:hi(l,o),Ci(o);break;case 13:hi(l,o),Ci(o),N=o.child,N.flags&8192&&(k=N.memoizedState!==null,N.stateNode.isHidden=k,!k||N.alternate!==null&&N.alternate.memoizedState!==null||(ux=ke())),y&4&&B_(o);break;case 22:if(Ye=p!==null&&p.memoizedState!==null,o.mode&1?(In=(Ce=In)||Ye,hi(l,o),In=Ce):hi(l,o),Ci(o),y&8192){if(Ce=o.memoizedState!==null,(o.stateNode.isHidden=Ce)&&!Ye&&(o.mode&1)!==0)for(it=o,Ye=o.child;Ye!==null;){for(qe=it=Ye;it!==null;){switch(Ke=it,nt=Ke.child,Ke.tag){case 0:case 11:case 14:case 15:Nu(4,Ke,Ke.return);break;case 1:Kl(Ke,Ke.return);var ot=Ke.stateNode;if(typeof ot.componentWillUnmount=="function"){y=Ke,p=Ke.return;try{l=y,ot.props=l.memoizedProps,ot.state=l.memoizedState,ot.componentWillUnmount()}catch(lt){Rr(y,p,lt)}}break;case 5:Kl(Ke,Ke.return);break;case 22:if(Ke.memoizedState!==null){H_(qe);continue}}nt!==null?(nt.return=Ke,it=nt):H_(qe)}Ye=Ye.sibling}e:for(Ye=null,qe=o;;){if(qe.tag===5){if(Ye===null){Ye=qe;try{N=qe.stateNode,Ce?(k=N.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(te=qe.stateNode,oe=qe.memoizedProps.style,B=oe!=null&&oe.hasOwnProperty("display")?oe.display:null,te.style.display=Qt("display",B))}catch(lt){Rr(o,o.return,lt)}}}else if(qe.tag===6){if(Ye===null)try{qe.stateNode.nodeValue=Ce?"":qe.memoizedProps}catch(lt){Rr(o,o.return,lt)}}else if((qe.tag!==22&&qe.tag!==23||qe.memoizedState===null||qe===o)&&qe.child!==null){qe.child.return=qe,qe=qe.child;continue}if(qe===o)break e;for(;qe.sibling===null;){if(qe.return===null||qe.return===o)break e;Ye===qe&&(Ye=null),qe=qe.return}Ye===qe&&(Ye=null),qe.sibling.return=qe.return,qe=qe.sibling}}break;case 19:hi(l,o),Ci(o),y&4&&B_(o);break;case 21:break;default:hi(l,o),Ci(o)}}function Ci(o){var l=o.flags;if(l&2){try{e:{for(var p=o.return;p!==null;){if(F_(p)){var y=p;break e}p=p.return}throw Error(r(160))}switch(y.tag){case 5:var N=y.stateNode;y.flags&32&&(Tt(N,""),y.flags&=-33);var k=M_(o);ox(o,k,N);break;case 3:case 4:var B=y.stateNode.containerInfo,te=M_(o);sx(o,te,B);break;default:throw Error(r(161))}}catch(oe){Rr(o,o.return,oe)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function uI(o,l,p){it=o,U_(o)}function U_(o,l,p){for(var y=(o.mode&1)!==0;it!==null;){var N=it,k=N.child;if(N.tag===22&&y){var B=N.memoizedState!==null||Od;if(!B){var te=N.alternate,oe=te!==null&&te.memoizedState!==null||In;te=Od;var Ce=In;if(Od=B,(In=oe)&&!Ce)for(it=N;it!==null;)B=it,oe=B.child,B.tag===22&&B.memoizedState!==null?W_(N):oe!==null?(oe.return=B,it=oe):W_(N);for(;k!==null;)it=k,U_(k),k=k.sibling;it=N,Od=te,In=Ce}z_(o)}else(N.subtreeFlags&8772)!==0&&k!==null?(k.return=N,it=k):z_(o)}}function z_(o){for(;it!==null;){var l=it;if((l.flags&8772)!==0){var p=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:In||Dd(5,l);break;case 1:var y=l.stateNode;if(l.flags&4&&!In)if(p===null)y.componentDidMount();else{var N=l.elementType===l.type?p.memoizedProps:fi(l.type,p.memoizedProps);y.componentDidUpdate(N,p.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var k=l.updateQueue;k!==null&&H2(l,k,y);break;case 3:var B=l.updateQueue;if(B!==null){if(p=null,l.child!==null)switch(l.child.tag){case 5:p=l.child.stateNode;break;case 1:p=l.child.stateNode}H2(l,B,p)}break;case 5:var te=l.stateNode;if(p===null&&l.flags&4){p=te;var oe=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":oe.autoFocus&&p.focus();break;case"img":oe.src&&(p.src=oe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Ce=l.alternate;if(Ce!==null){var Ye=Ce.memoizedState;if(Ye!==null){var qe=Ye.dehydrated;qe!==null&&ru(qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}In||l.flags&512&&ix(l)}catch(Ke){Rr(l,l.return,Ke)}}if(l===o){it=null;break}if(p=l.sibling,p!==null){p.return=l.return,it=p;break}it=l.return}}function H_(o){for(;it!==null;){var l=it;if(l===o){it=null;break}var p=l.sibling;if(p!==null){p.return=l.return,it=p;break}it=l.return}}function W_(o){for(;it!==null;){var l=it;try{switch(l.tag){case 0:case 11:case 15:var p=l.return;try{Dd(4,l)}catch(oe){Rr(l,p,oe)}break;case 1:var y=l.stateNode;if(typeof y.componentDidMount=="function"){var N=l.return;try{y.componentDidMount()}catch(oe){Rr(l,N,oe)}}var k=l.return;try{ix(l)}catch(oe){Rr(l,k,oe)}break;case 5:var B=l.return;try{ix(l)}catch(oe){Rr(l,B,oe)}}}catch(oe){Rr(l,l.return,oe)}if(l===o){it=null;break}var te=l.sibling;if(te!==null){te.return=l.return,it=te;break}it=l.return}}var fI=Math.ceil,Id=D.ReactCurrentDispatcher,lx=D.ReactCurrentOwner,Ya=D.ReactCurrentBatchConfig,zt=0,dn=null,Hr=null,wn=0,Ca=0,Gl=Is(0),nn=0,Eu=null,Ro=0,Rd=0,cx=0,Tu=null,ha=null,ux=0,Yl=1/0,Ji=null,Fd=!1,fx=null,$s=null,Md=!1,Us=null,Ld=0,ku=0,dx=null,Bd=-1,$d=0;function qn(){return(zt&6)!==0?ke():Bd!==-1?Bd:Bd=ke()}function zs(o){return(o.mode&1)===0?1:(zt&2)!==0&&wn!==0?wn&-wn:YD.transition!==null?($d===0&&($d=Tl()),$d):(o=Gt,o!==0||(o=window.event,o=o===void 0?16:Kb(o.type)),o)}function pi(o,l,p,y){if(50<ku)throw ku=0,dx=null,Error(r(185));ko(o,p,y),((zt&2)===0||o!==dn)&&(o===dn&&((zt&2)===0&&(Rd|=p),nn===4&&Hs(o,wn)),pa(o,y),p===1&&zt===0&&(l.mode&1)===0&&(Yl=ke()+500,pd&&Fs()))}function pa(o,l){var p=o.callbackNode;Ir(o,l);var y=To(o,o===dn?wn:0);if(y===0)p!==null&&de(p),o.callbackNode=null,o.callbackPriority=0;else if(l=y&-y,o.callbackPriority!==l){if(p!=null&&de(p),l===1)o.tag===0?GD(K_.bind(null,o)):P2(K_.bind(null,o)),HD(function(){(zt&6)===0&&Fs()}),p=null;else{switch(Xf(y)){case 1:p=ht;break;case 4:p=xt;break;case 16:p=kt;break;case 536870912:p=Cr;break;default:p=kt}p=eS(p,V_.bind(null,o))}o.callbackPriority=l,o.callbackNode=p}}function V_(o,l){if(Bd=-1,$d=0,(zt&6)!==0)throw Error(r(327));var p=o.callbackNode;if(Xl()&&o.callbackNode!==p)return null;var y=To(o,o===dn?wn:0);if(y===0)return null;if((y&30)!==0||(y&o.expiredLanes)!==0||l)l=Ud(o,y);else{l=y;var N=zt;zt|=2;var k=Y_();(dn!==o||wn!==l)&&(Ji=null,Yl=ke()+500,Mo(o,l));do try{pI();break}catch(te){G_(o,te)}while(!0);jm(),Id.current=k,zt=N,Hr!==null?l=0:(dn=null,wn=0,l=nn)}if(l!==0){if(l===2&&(N=Na(o),N!==0&&(y=N,l=hx(o,N))),l===1)throw p=Eu,Mo(o,0),Hs(o,y),pa(o,ke()),p;if(l===6)Hs(o,y);else{if(N=o.current.alternate,(y&30)===0&&!dI(N)&&(l=Ud(o,y),l===2&&(k=Na(o),k!==0&&(y=k,l=hx(o,k))),l===1))throw p=Eu,Mo(o,0),Hs(o,y),pa(o,ke()),p;switch(o.finishedWork=N,o.finishedLanes=y,l){case 0:case 1:throw Error(r(345));case 2:Lo(o,ha,Ji);break;case 3:if(Hs(o,y),(y&130023424)===y&&(l=ux+500-ke(),10<l)){if(To(o,0)!==0)break;if(N=o.suspendedLanes,(N&y)!==y){qn(),o.pingedLanes|=o.suspendedLanes&N;break}o.timeoutHandle=ym(Lo.bind(null,o,ha,Ji),l);break}Lo(o,ha,Ji);break;case 4:if(Hs(o,y),(y&4194240)===y)break;for(l=o.eventTimes,N=-1;0<y;){var B=31-Ft(y);k=1<<B,B=l[B],B>N&&(N=B),y&=~k}if(y=N,y=ke()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*fI(y/1960))-y,10<y){o.timeoutHandle=ym(Lo.bind(null,o,ha,Ji),y);break}Lo(o,ha,Ji);break;case 5:Lo(o,ha,Ji);break;default:throw Error(r(329))}}}return pa(o,ke()),o.callbackNode===p?V_.bind(null,o):null}function hx(o,l){var p=Tu;return o.current.memoizedState.isDehydrated&&(Mo(o,l).flags|=256),o=Ud(o,l),o!==2&&(l=ha,ha=p,l!==null&&px(l)),o}function px(o){ha===null?ha=o:ha.push.apply(ha,o)}function dI(o){for(var l=o;;){if(l.flags&16384){var p=l.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var y=0;y<p.length;y++){var N=p[y],k=N.getSnapshot;N=N.value;try{if(!ci(k(),N))return!1}catch{return!1}}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Hs(o,l){for(l&=~cx,l&=~Rd,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var p=31-Ft(l),y=1<<p;o[p]=-1,l&=~y}}function K_(o){if((zt&6)!==0)throw Error(r(327));Xl();var l=To(o,0);if((l&1)===0)return pa(o,ke()),null;var p=Ud(o,l);if(o.tag!==0&&p===2){var y=Na(o);y!==0&&(l=y,p=hx(o,y))}if(p===1)throw p=Eu,Mo(o,0),Hs(o,l),pa(o,ke()),p;if(p===6)throw Error(r(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,Lo(o,ha,Ji),pa(o,ke()),null}function mx(o,l){var p=zt;zt|=1;try{return o(l)}finally{zt=p,zt===0&&(Yl=ke()+500,pd&&Fs())}}function Fo(o){Us!==null&&Us.tag===0&&(zt&6)===0&&Xl();var l=zt;zt|=1;var p=Ya.transition,y=Gt;try{if(Ya.transition=null,Gt=1,o)return o()}finally{Gt=y,Ya.transition=p,zt=l,(zt&6)===0&&Fs()}}function xx(){Ca=Gl.current,pr(Gl)}function Mo(o,l){o.finishedWork=null,o.finishedLanes=0;var p=o.timeoutHandle;if(p!==-1&&(o.timeoutHandle=-1,zD(p)),Hr!==null)for(p=Hr.return;p!==null;){var y=p;switch(Em(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&dd();break;case 3:Wl(),pr(ua),pr(Pn),Lm();break;case 5:Fm(y);break;case 4:Wl();break;case 13:pr(Ar);break;case 19:pr(Ar);break;case 10:Pm(y.type._context);break;case 22:case 23:xx()}p=p.return}if(dn=o,Hr=o=Ws(o.current,null),wn=Ca=l,nn=0,Eu=null,cx=Rd=Ro=0,ha=Tu=null,Oo!==null){for(l=0;l<Oo.length;l++)if(p=Oo[l],y=p.interleaved,y!==null){p.interleaved=null;var N=y.next,k=p.pending;if(k!==null){var B=k.next;k.next=N,y.next=B}p.pending=y}Oo=null}return o}function G_(o,l){do{var p=Hr;try{if(jm(),Nd.current=Cd,Ed){for(var y=jr.memoizedState;y!==null;){var N=y.queue;N!==null&&(N.pending=null),y=y.next}Ed=!1}if(Io=0,fn=rn=jr=null,yu=!1,wu=0,lx.current=null,p===null||p.return===null){nn=1,Eu=l,Hr=null;break}e:{var k=o,B=p.return,te=p,oe=l;if(l=wn,te.flags|=32768,oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var Ce=oe,Ye=te,qe=Ye.tag;if((Ye.mode&1)===0&&(qe===0||qe===11||qe===15)){var Ke=Ye.alternate;Ke?(Ye.updateQueue=Ke.updateQueue,Ye.memoizedState=Ke.memoizedState,Ye.lanes=Ke.lanes):(Ye.updateQueue=null,Ye.memoizedState=null)}var nt=v_(B);if(nt!==null){nt.flags&=-257,y_(nt,B,te,k,l),nt.mode&1&&g_(k,Ce,l),l=nt,oe=Ce;var ot=l.updateQueue;if(ot===null){var lt=new Set;lt.add(oe),l.updateQueue=lt}else ot.add(oe);break e}else{if((l&1)===0){g_(k,Ce,l),gx();break e}oe=Error(r(426))}}else if(yr&&te.mode&1){var Lr=v_(B);if(Lr!==null){(Lr.flags&65536)===0&&(Lr.flags|=256),y_(Lr,B,te,k,l),Cm(Vl(oe,te));break e}}k=oe=Vl(oe,te),nn!==4&&(nn=2),Tu===null?Tu=[k]:Tu.push(k),k=B;do{switch(k.tag){case 3:k.flags|=65536,l&=-l,k.lanes|=l;var ve=m_(k,oe,l);z2(k,ve);break e;case 1:te=oe;var le=k.type,Se=k.stateNode;if((k.flags&128)===0&&(typeof le.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&($s===null||!$s.has(Se)))){k.flags|=65536,l&=-l,k.lanes|=l;var Qe=x_(k,te,l);z2(k,Qe);break e}}k=k.return}while(k!==null)}q_(p)}catch(ut){l=ut,Hr===p&&p!==null&&(Hr=p=p.return);continue}break}while(!0)}function Y_(){var o=Id.current;return Id.current=Cd,o===null?Cd:o}function gx(){(nn===0||nn===3||nn===2)&&(nn=4),dn===null||(Ro&268435455)===0&&(Rd&268435455)===0||Hs(dn,wn)}function Ud(o,l){var p=zt;zt|=2;var y=Y_();(dn!==o||wn!==l)&&(Ji=null,Mo(o,l));do try{hI();break}catch(N){G_(o,N)}while(!0);if(jm(),zt=p,Id.current=y,Hr!==null)throw Error(r(261));return dn=null,wn=0,nn}function hI(){for(;Hr!==null;)X_(Hr)}function pI(){for(;Hr!==null&&!Pe();)X_(Hr)}function X_(o){var l=J_(o.alternate,o,Ca);o.memoizedProps=o.pendingProps,l===null?q_(o):Hr=l,lx.current=null}function q_(o){var l=o;do{var p=l.alternate;if(o=l.return,(l.flags&32768)===0){if(p=sI(p,l,Ca),p!==null){Hr=p;return}}else{if(p=oI(p,l),p!==null){p.flags&=32767,Hr=p;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{nn=6,Hr=null;return}}if(l=l.sibling,l!==null){Hr=l;return}Hr=l=o}while(l!==null);nn===0&&(nn=5)}function Lo(o,l,p){var y=Gt,N=Ya.transition;try{Ya.transition=null,Gt=1,mI(o,l,p,y)}finally{Ya.transition=N,Gt=y}return null}function mI(o,l,p,y){do Xl();while(Us!==null);if((zt&6)!==0)throw Error(r(327));p=o.finishedWork;var N=o.finishedLanes;if(p===null)return null;if(o.finishedWork=null,o.finishedLanes=0,p===o.current)throw Error(r(177));o.callbackNode=null,o.callbackPriority=0;var k=p.lanes|p.childLanes;if(Zc(o,k),o===dn&&(Hr=dn=null,wn=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Md||(Md=!0,eS(kt,function(){return Xl(),null})),k=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||k){k=Ya.transition,Ya.transition=null;var B=Gt;Gt=1;var te=zt;zt|=4,lx.current=null,cI(o,p),$_(p,o),RD(gm),Qf=!!xm,gm=xm=null,o.current=p,uI(p),we(),zt=te,Gt=B,Ya.transition=k}else o.current=p;if(Md&&(Md=!1,Us=o,Ld=N),k=o.pendingLanes,k===0&&($s=null),vr(p.stateNode),pa(o,ke()),l!==null)for(y=o.onRecoverableError,p=0;p<l.length;p++)N=l[p],y(N.value,{componentStack:N.stack,digest:N.digest});if(Fd)throw Fd=!1,o=fx,fx=null,o;return(Ld&1)!==0&&o.tag!==0&&Xl(),k=o.pendingLanes,(k&1)!==0?o===dx?ku++:(ku=0,dx=o):ku=0,Fs(),null}function Xl(){if(Us!==null){var o=Xf(Ld),l=Ya.transition,p=Gt;try{if(Ya.transition=null,Gt=16>o?16:o,Us===null)var y=!1;else{if(o=Us,Us=null,Ld=0,(zt&6)!==0)throw Error(r(331));var N=zt;for(zt|=4,it=o.current;it!==null;){var k=it,B=k.child;if((it.flags&16)!==0){var te=k.deletions;if(te!==null){for(var oe=0;oe<te.length;oe++){var Ce=te[oe];for(it=Ce;it!==null;){var Ye=it;switch(Ye.tag){case 0:case 11:case 15:Nu(8,Ye,k)}var qe=Ye.child;if(qe!==null)qe.return=Ye,it=qe;else for(;it!==null;){Ye=it;var Ke=Ye.sibling,nt=Ye.return;if(R_(Ye),Ye===Ce){it=null;break}if(Ke!==null){Ke.return=nt,it=Ke;break}it=nt}}}var ot=k.alternate;if(ot!==null){var lt=ot.child;if(lt!==null){ot.child=null;do{var Lr=lt.sibling;lt.sibling=null,lt=Lr}while(lt!==null)}}it=k}}if((k.subtreeFlags&2064)!==0&&B!==null)B.return=k,it=B;else e:for(;it!==null;){if(k=it,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Nu(9,k,k.return)}var ve=k.sibling;if(ve!==null){ve.return=k.return,it=ve;break e}it=k.return}}var le=o.current;for(it=le;it!==null;){B=it;var Se=B.child;if((B.subtreeFlags&2064)!==0&&Se!==null)Se.return=B,it=Se;else e:for(B=le;it!==null;){if(te=it,(te.flags&2048)!==0)try{switch(te.tag){case 0:case 11:case 15:Dd(9,te)}}catch(ut){Rr(te,te.return,ut)}if(te===B){it=null;break e}var Qe=te.sibling;if(Qe!==null){Qe.return=te.return,it=Qe;break e}it=te.return}}if(zt=N,Fs(),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(jt,o)}catch{}y=!0}return y}finally{Gt=p,Ya.transition=l}}return!1}function Z_(o,l,p){l=Vl(p,l),l=m_(o,l,1),o=Ls(o,l,1),l=qn(),o!==null&&(ko(o,1,l),pa(o,l))}function Rr(o,l,p){if(o.tag===3)Z_(o,o,p);else for(;l!==null;){if(l.tag===3){Z_(l,o,p);break}else if(l.tag===1){var y=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&($s===null||!$s.has(y))){o=Vl(p,o),o=x_(l,o,1),l=Ls(l,o,1),o=qn(),l!==null&&(ko(l,1,o),pa(l,o));break}}l=l.return}}function xI(o,l,p){var y=o.pingCache;y!==null&&y.delete(l),l=qn(),o.pingedLanes|=o.suspendedLanes&p,dn===o&&(wn&p)===p&&(nn===4||nn===3&&(wn&130023424)===wn&&500>ke()-ux?Mo(o,0):cx|=p),pa(o,l)}function Q_(o,l){l===0&&((o.mode&1)===0?l=1:(l=El,El<<=1,(El&130023424)===0&&(El=4194304)));var p=qn();o=qi(o,l),o!==null&&(ko(o,l,p),pa(o,p))}function gI(o){var l=o.memoizedState,p=0;l!==null&&(p=l.retryLane),Q_(o,p)}function vI(o,l){var p=0;switch(o.tag){case 13:var y=o.stateNode,N=o.memoizedState;N!==null&&(p=N.retryLane);break;case 19:y=o.stateNode;break;default:throw Error(r(314))}y!==null&&y.delete(l),Q_(o,p)}var J_;J_=function(o,l,p){if(o!==null)if(o.memoizedProps!==l.pendingProps||ua.current)da=!0;else{if((o.lanes&p)===0&&(l.flags&128)===0)return da=!1,iI(o,l,p);da=(o.flags&131072)!==0}else da=!1,yr&&(l.flags&1048576)!==0&&O2(l,xd,l.index);switch(l.lanes=0,l.tag){case 2:var y=l.type;Pd(o,l),o=l.pendingProps;var N=Ml(l,Pn.current);Hl(l,p),N=Um(null,l,y,o,N,p);var k=zm();return l.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,fa(y)?(k=!0,hd(l)):k=!1,l.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,Im(l),N.updater=Ad,l.stateNode=N,N._reactInternals=l,Ym(l,y,o,p),l=Qm(null,l,y,!0,k,p)):(l.tag=0,yr&&k&&Nm(l),Xn(null,l,N,p),l=l.child),l;case 16:y=l.elementType;e:{switch(Pd(o,l),o=l.pendingProps,N=y._init,y=N(y._payload),l.type=y,N=l.tag=wI(y),o=fi(y,o),N){case 0:l=Zm(null,l,y,o,p);break e;case 1:l=E_(null,l,y,o,p);break e;case 11:l=w_(null,l,y,o,p);break e;case 14:l=b_(null,l,y,fi(y.type,o),p);break e}throw Error(r(306,y,""))}return l;case 0:return y=l.type,N=l.pendingProps,N=l.elementType===y?N:fi(y,N),Zm(o,l,y,N,p);case 1:return y=l.type,N=l.pendingProps,N=l.elementType===y?N:fi(y,N),E_(o,l,y,N,p);case 3:e:{if(T_(l),o===null)throw Error(r(387));y=l.pendingProps,k=l.memoizedState,N=k.element,U2(o,l),_d(l,y,null,p);var B=l.memoizedState;if(y=B.element,k.isDehydrated)if(k={element:y,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){N=Vl(Error(r(423)),l),l=k_(o,l,y,p,N);break e}else if(y!==N){N=Vl(Error(r(424)),l),l=k_(o,l,y,p,N);break e}else for(ka=Ds(l.stateNode.containerInfo.firstChild),Ta=l,yr=!0,ui=null,p=B2(l,null,y,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if($l(),y===N){l=Qi(o,l,p);break e}Xn(o,l,y,p)}l=l.child}return l;case 5:return W2(l),o===null&&km(l),y=l.type,N=l.pendingProps,k=o!==null?o.memoizedProps:null,B=N.children,vm(y,N)?B=null:k!==null&&vm(y,k)&&(l.flags|=32),N_(o,l),Xn(o,l,B,p),l.child;case 6:return o===null&&km(l),null;case 13:return C_(o,l,p);case 4:return Rm(l,l.stateNode.containerInfo),y=l.pendingProps,o===null?l.child=Ul(l,null,y,p):Xn(o,l,y,p),l.child;case 11:return y=l.type,N=l.pendingProps,N=l.elementType===y?N:fi(y,N),w_(o,l,y,N,p);case 7:return Xn(o,l,l.pendingProps,p),l.child;case 8:return Xn(o,l,l.pendingProps.children,p),l.child;case 12:return Xn(o,l,l.pendingProps.children,p),l.child;case 10:e:{if(y=l.type._context,N=l.pendingProps,k=l.memoizedProps,B=N.value,ur(yd,y._currentValue),y._currentValue=B,k!==null)if(ci(k.value,B)){if(k.children===N.children&&!ua.current){l=Qi(o,l,p);break e}}else for(k=l.child,k!==null&&(k.return=l);k!==null;){var te=k.dependencies;if(te!==null){B=k.child;for(var oe=te.firstContext;oe!==null;){if(oe.context===y){if(k.tag===1){oe=Zi(-1,p&-p),oe.tag=2;var Ce=k.updateQueue;if(Ce!==null){Ce=Ce.shared;var Ye=Ce.pending;Ye===null?oe.next=oe:(oe.next=Ye.next,Ye.next=oe),Ce.pending=oe}}k.lanes|=p,oe=k.alternate,oe!==null&&(oe.lanes|=p),Om(k.return,p,l),te.lanes|=p;break}oe=oe.next}}else if(k.tag===10)B=k.type===l.type?null:k.child;else if(k.tag===18){if(B=k.return,B===null)throw Error(r(341));B.lanes|=p,te=B.alternate,te!==null&&(te.lanes|=p),Om(B,p,l),B=k.sibling}else B=k.child;if(B!==null)B.return=k;else for(B=k;B!==null;){if(B===l){B=null;break}if(k=B.sibling,k!==null){k.return=B.return,B=k;break}B=B.return}k=B}Xn(o,l,N.children,p),l=l.child}return l;case 9:return N=l.type,y=l.pendingProps.children,Hl(l,p),N=Ka(N),y=y(N),l.flags|=1,Xn(o,l,y,p),l.child;case 14:return y=l.type,N=fi(y,l.pendingProps),N=fi(y.type,N),b_(o,l,y,N,p);case 15:return __(o,l,l.type,l.pendingProps,p);case 17:return y=l.type,N=l.pendingProps,N=l.elementType===y?N:fi(y,N),Pd(o,l),l.tag=1,fa(y)?(o=!0,hd(l)):o=!1,Hl(l,p),h_(l,y,N),Ym(l,y,N,p),Qm(null,l,y,!0,o,p);case 19:return j_(o,l,p);case 22:return S_(o,l,p)}throw Error(r(156,l.tag))};function eS(o,l){return se(o,l)}function yI(o,l,p,y){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xa(o,l,p,y){return new yI(o,l,p,y)}function vx(o){return o=o.prototype,!(!o||!o.isReactComponent)}function wI(o){if(typeof o=="function")return vx(o)?1:0;if(o!=null){if(o=o.$$typeof,o===J)return 11;if(o===pe)return 14}return 2}function Ws(o,l){var p=o.alternate;return p===null?(p=Xa(o.tag,l,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=l,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&14680064,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,l=o.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p}function zd(o,l,p,y,N,k){var B=2;if(y=o,typeof o=="function")vx(o)&&(B=1);else if(typeof o=="string")B=5;else e:switch(o){case j:return Bo(p.children,N,k,l);case z:B=8,N|=8;break;case R:return o=Xa(12,p,l,N|2),o.elementType=R,o.lanes=k,o;case ue:return o=Xa(13,p,l,N),o.elementType=ue,o.lanes=k,o;case Ne:return o=Xa(19,p,l,N),o.elementType=Ne,o.lanes=k,o;case xe:return Hd(p,N,k,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case q:B=10;break e;case V:B=9;break e;case J:B=11;break e;case pe:B=14;break e;case Ie:B=16,y=null;break e}throw Error(r(130,o==null?o:typeof o,""))}return l=Xa(B,p,l,N),l.elementType=o,l.type=y,l.lanes=k,l}function Bo(o,l,p,y){return o=Xa(7,o,y,l),o.lanes=p,o}function Hd(o,l,p,y){return o=Xa(22,o,y,l),o.elementType=xe,o.lanes=p,o.stateNode={isHidden:!1},o}function yx(o,l,p){return o=Xa(6,o,null,l),o.lanes=p,o}function wx(o,l,p){return l=Xa(4,o.children!==null?o.children:[],o.key,l),l.lanes=p,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function bI(o,l,p,y,N){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vi(0),this.expirationTimes=Vi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vi(0),this.identifierPrefix=y,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function bx(o,l,p,y,N,k,B,te,oe){return o=new bI(o,l,p,te,oe),l===1?(l=1,k===!0&&(l|=8)):l=0,k=Xa(3,null,null,l),o.current=k,k.stateNode=o,k.memoizedState={element:y,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Im(k),o}function _I(o,l,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:y==null?null:""+y,children:o,containerInfo:l,implementation:p}}function tS(o){if(!o)return Rs;o=o._reactInternals;e:{if(E(o)!==o||o.tag!==1)throw Error(r(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(fa(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(o.tag===1){var p=o.type;if(fa(p))return A2(o,p,l)}return l}function rS(o,l,p,y,N,k,B,te,oe){return o=bx(p,y,!0,o,N,k,B,te,oe),o.context=tS(null),p=o.current,y=qn(),N=zs(p),k=Zi(y,N),k.callback=l??null,Ls(p,k,N),o.current.lanes=N,ko(o,N,y),pa(o,y),o}function Wd(o,l,p,y){var N=l.current,k=qn(),B=zs(N);return p=tS(p),l.context===null?l.context=p:l.pendingContext=p,l=Zi(k,B),l.payload={element:o},y=y===void 0?null:y,y!==null&&(l.callback=y),o=Ls(N,l,B),o!==null&&(pi(o,N,B,k),bd(o,N,B)),B}function Vd(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function nS(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<l?p:l}}function _x(o,l){nS(o,l),(o=o.alternate)&&nS(o,l)}function SI(){return null}var aS=typeof reportError=="function"?reportError:function(o){console.error(o)};function Sx(o){this._internalRoot=o}Kd.prototype.render=Sx.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(r(409));Wd(o,l,null,null)},Kd.prototype.unmount=Sx.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;Fo(function(){Wd(null,o,null,null)}),l[Ki]=null}};function Kd(o){this._internalRoot=o}Kd.prototype.unstable_scheduleHydration=function(o){if(o){var l=Ub();o={blockedOn:null,target:o,priority:l};for(var p=0;p<js.length&&l!==0&&l<js[p].priority;p++);js.splice(p,0,o),p===0&&Wb(o)}};function Nx(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Gd(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function iS(){}function NI(o,l,p,y,N){if(N){if(typeof y=="function"){var k=y;y=function(){var Ce=Vd(B);k.call(Ce)}}var B=rS(l,y,o,0,null,!1,!1,"",iS);return o._reactRootContainer=B,o[Ki]=B.current,fu(o.nodeType===8?o.parentNode:o),Fo(),B}for(;N=o.lastChild;)o.removeChild(N);if(typeof y=="function"){var te=y;y=function(){var Ce=Vd(oe);te.call(Ce)}}var oe=bx(o,0,!1,null,null,!1,!1,"",iS);return o._reactRootContainer=oe,o[Ki]=oe.current,fu(o.nodeType===8?o.parentNode:o),Fo(function(){Wd(l,oe,p,y)}),oe}function Yd(o,l,p,y,N){var k=p._reactRootContainer;if(k){var B=k;if(typeof N=="function"){var te=N;N=function(){var oe=Vd(B);te.call(oe)}}Wd(l,B,o,N)}else B=NI(p,l,o,N,y);return Vd(B)}Bb=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var p=Ts(l.pendingLanes);p!==0&&(kl(l,p|1),pa(l,ke()),(zt&6)===0&&(Yl=ke()+500,Fs()))}break;case 13:Fo(function(){var y=qi(o,1);if(y!==null){var N=qn();pi(y,o,1,N)}}),_x(o,1)}},Xp=function(o){if(o.tag===13){var l=qi(o,134217728);if(l!==null){var p=qn();pi(l,o,134217728,p)}_x(o,134217728)}},$b=function(o){if(o.tag===13){var l=zs(o),p=qi(o,l);if(p!==null){var y=qn();pi(p,o,l,y)}_x(o,l)}},Ub=function(){return Gt},zb=function(o,l){var p=Gt;try{return Gt=o,l()}finally{Gt=p}},Xe=function(o,l,p){switch(l){case"input":if(ne(o,p),l=p.name,p.type==="radio"&&l!=null){for(p=o;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<p.length;l++){var y=p[l];if(y!==o&&y.form===o.form){var N=fd(y);if(!N)throw Error(r(90));ee(y),ne(y,N)}}}break;case"textarea":fe(o,p);break;case"select":l=p.value,l!=null&&He(o,!!p.multiple,l,!1)}},ae=mx,Le=Fo;var EI={usingClientEntryPoint:!1,Events:[pu,Rl,fd,tn,zr,mx]},Cu={findFiberByHostInstance:Co,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TI={bundleType:Cu.bundleType,version:Cu.version,rendererPackageName:Cu.rendererPackageName,rendererConfig:Cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=G(o),o===null?null:o.stateNode},findFiberByHostInstance:Cu.findFiberByHostInstance||SI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xd.isDisabled&&Xd.supportsFiber)try{jt=Xd.inject(TI),Ot=Xd}catch{}}return ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EI,ma.createPortal=function(o,l){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nx(l))throw Error(r(200));return _I(o,l,null,p)},ma.createRoot=function(o,l){if(!Nx(o))throw Error(r(299));var p=!1,y="",N=aS;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=bx(o,1,!1,null,null,p,!1,y,N),o[Ki]=l.current,fu(o.nodeType===8?o.parentNode:o),new Sx(l)},ma.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=G(l),o=o===null?null:o.stateNode,o},ma.flushSync=function(o){return Fo(o)},ma.hydrate=function(o,l,p){if(!Gd(l))throw Error(r(200));return Yd(null,o,l,!0,p)},ma.hydrateRoot=function(o,l,p){if(!Nx(o))throw Error(r(405));var y=p!=null&&p.hydratedSources||null,N=!1,k="",B=aS;if(p!=null&&(p.unstable_strictMode===!0&&(N=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(B=p.onRecoverableError)),l=rS(l,null,o,1,p??null,N,!1,k,B),o[Ki]=l.current,fu(o),y)for(o=0;o<y.length;o++)p=y[o],N=p._getVersion,N=N(p._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[p,N]:l.mutableSourceEagerHydrationData.push(p,N);return new Kd(l)},ma.render=function(o,l,p){if(!Gd(l))throw Error(r(200));return Yd(null,o,l,!1,p)},ma.unmountComponentAtNode=function(o){if(!Gd(o))throw Error(r(40));return o._reactRootContainer?(Fo(function(){Yd(null,null,o,!1,function(){o._reactRootContainer=null,o[Ki]=null})}),!0):!1},ma.unstable_batchedUpdates=mx,ma.unstable_renderSubtreeIntoContainer=function(o,l,p,y){if(!Gd(p))throw Error(r(200));if(o==null||o._reactInternals===void 0)throw Error(r(38));return Yd(o,l,p,!1,y)},ma.version="18.3.1-next-f1338f8080-20240426",ma}var hS;function XC(){if(hS)return kx.exports;hS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),kx.exports=II(),kx.exports}var pS;function RI(){if(pS)return qd;pS=1;var e=XC();return qd.createRoot=e.createRoot,qd.hydrateRoot=e.hydrateRoot,qd}var FI=RI(),v=Ac();const _i=ys(v),qC=CI({__proto__:null,default:_i},[v]);var MI=XC();function tf(){return tf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tf.apply(this,arguments)}var eo;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(eo||(eo={}));const mS="popstate";function LI(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:c}=n.location;return Uv("",{pathname:i,search:s,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:L0(a)}return $I(t,r,null,e)}function $r(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ZC(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function BI(){return Math.random().toString(36).substr(2,8)}function xS(e,t){return{usr:e.state,key:e.key,idx:t}}function Uv(e,t,r,n){return r===void 0&&(r=null),tf({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?jc(t):t,{state:r,key:t&&t.key||n||BI()})}function L0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function jc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function $I(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,c=eo.Pop,f=null,h=d();h==null&&(h=0,s.replaceState(tf({},s.state,{idx:h}),""));function d(){return(s.state||{idx:null}).idx}function m(){c=eo.Pop;let w=d(),S=w==null?null:w-h;h=w,f&&f({action:c,location:_.location,delta:S})}function x(w,S){c=eo.Push;let A=Uv(_.location,w,S);h=d()+1;let T=xS(A,h),D=_.createHref(A);try{s.pushState(T,"",D)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(D)}i&&f&&f({action:c,location:_.location,delta:1})}function g(w,S){c=eo.Replace;let A=Uv(_.location,w,S);h=d();let T=xS(A,h),D=_.createHref(A);s.replaceState(T,"",D),i&&f&&f({action:c,location:_.location,delta:0})}function b(w){let S=a.location.origin!=="null"?a.location.origin:a.location.href,A=typeof w=="string"?w:L0(w);return A=A.replace(/ $/,"%20"),$r(S,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,S)}let _={get action(){return c},get location(){return e(a,s)},listen(w){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(mS,m),f=w,()=>{a.removeEventListener(mS,m),f=null}},createHref(w){return t(a,w)},createURL:b,encodeLocation(w){let S=b(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:g,go(w){return s.go(w)}};return _}var gS;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(gS||(gS={}));function UI(e,t,r){return r===void 0&&(r="/"),zI(e,t,r)}function zI(e,t,r,n){let a=typeof t=="string"?jc(t):t,i=iy(a.pathname||"/",r);if(i==null)return null;let s=QC(e);HI(s);let c=null;for(let f=0;c==null&&f<s.length;++f){let h=t6(i);c=QI(s[f],h)}return c}function QC(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,c)=>{let f={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};f.relativePath.startsWith("/")&&($r(f.relativePath.startsWith(n),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(n.length));let h=no([n,f.relativePath]),d=r.concat(f);i.children&&i.children.length>0&&($r(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),QC(i.children,t,d,h)),!(i.path==null&&!i.index)&&t.push({path:h,score:qI(h,i.index),routesMeta:d})};return e.forEach((i,s)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,s);else for(let f of JC(i.path))a(i,s,f)}),t}function JC(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=JC(n.join("/")),c=[];return c.push(...s.map(f=>f===""?i:[i,f].join("/"))),a&&c.push(...s),c.map(f=>e.startsWith("/")&&f===""?"/":f)}function HI(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:ZI(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const WI=/^:[\w-]+$/,VI=3,KI=2,GI=1,YI=10,XI=-2,vS=e=>e==="*";function qI(e,t){let r=e.split("/"),n=r.length;return r.some(vS)&&(n+=XI),t&&(n+=KI),r.filter(a=>!vS(a)).reduce((a,i)=>a+(WI.test(i)?VI:i===""?GI:YI),n)}function ZI(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function QI(e,t,r){let{routesMeta:n}=e,a={},i="/",s=[];for(let c=0;c<n.length;++c){let f=n[c],h=c===n.length-1,d=i==="/"?t:t.slice(i.length)||"/",m=JI({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},d),x=f.route;if(!m)return null;Object.assign(a,m.params),s.push({params:a,pathname:no([i,m.pathname]),pathnameBase:i6(no([i,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(i=no([i,m.pathnameBase]))}return s}function JI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=e6(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((h,d,m)=>{let{paramName:x,isOptional:g}=d;if(x==="*"){let _=c[m]||"";s=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const b=c[m];return g&&!b?h[x]=void 0:h[x]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:s,pattern:e}}function e6(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ZC(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,c,f)=>(n.push({paramName:c,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function t6(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ZC(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function iy(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function r6(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?jc(e):e;return{pathname:r?r.startsWith("/")?r:n6(r,t):t,search:s6(n),hash:o6(a)}}function n6(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function jx(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function a6(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function sy(e,t){let r=a6(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function oy(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=jc(e):(a=tf({},e),$r(!a.pathname||!a.pathname.includes("?"),jx("?","pathname","search",a)),$r(!a.pathname||!a.pathname.includes("#"),jx("#","pathname","hash",a)),$r(!a.search||!a.search.includes("#"),jx("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,c;if(s==null)c=r;else{let m=t.length-1;if(!n&&s.startsWith("..")){let x=s.split("/");for(;x[0]==="..";)x.shift(),m-=1;a.pathname=x.join("/")}c=m>=0?t[m]:"/"}let f=r6(a,c),h=s&&s!=="/"&&s.endsWith("/"),d=(i||s===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(h||d)&&(f.pathname+="/"),f}const no=e=>e.join("/").replace(/\/\/+/g,"/"),i6=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),s6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,o6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function l6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const e4=["post","put","patch","delete"];new Set(e4);const c6=["get",...e4];new Set(c6);function rf(){return rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rf.apply(this,arguments)}const ly=v.createContext(null),u6=v.createContext(null),xo=v.createContext(null),qh=v.createContext(null),go=v.createContext({outlet:null,matches:[],isDataRoute:!1}),t4=v.createContext(null);function f6(e,t){let{relative:r}=t===void 0?{}:t;Pc()||$r(!1);let{basename:n,navigator:a}=v.useContext(xo),{hash:i,pathname:s,search:c}=n4(e,{relative:r}),f=s;return n!=="/"&&(f=s==="/"?n:no([n,s])),a.createHref({pathname:f,search:c,hash:i})}function Pc(){return v.useContext(qh)!=null}function vo(){return Pc()||$r(!1),v.useContext(qh).location}function r4(e){v.useContext(xo).static||v.useLayoutEffect(e)}function Zh(){let{isDataRoute:e}=v.useContext(go);return e?N6():d6()}function d6(){Pc()||$r(!1);let e=v.useContext(ly),{basename:t,future:r,navigator:n}=v.useContext(xo),{matches:a}=v.useContext(go),{pathname:i}=vo(),s=JSON.stringify(sy(a,r.v7_relativeSplatPath)),c=v.useRef(!1);return r4(()=>{c.current=!0}),v.useCallback(function(h,d){if(d===void 0&&(d={}),!c.current)return;if(typeof h=="number"){n.go(h);return}let m=oy(h,JSON.parse(s),i,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:no([t,m.pathname])),(d.replace?n.replace:n.push)(m,d.state,d)},[t,n,s,i,e])}function n4(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=v.useContext(xo),{matches:a}=v.useContext(go),{pathname:i}=vo(),s=JSON.stringify(sy(a,n.v7_relativeSplatPath));return v.useMemo(()=>oy(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function h6(e,t){return p6(e,t)}function p6(e,t,r,n){Pc()||$r(!1);let{navigator:a}=v.useContext(xo),{matches:i}=v.useContext(go),s=i[i.length-1],c=s?s.params:{};s&&s.pathname;let f=s?s.pathnameBase:"/";s&&s.route;let h=vo(),d;if(t){var m;let w=typeof t=="string"?jc(t):t;f==="/"||(m=w.pathname)!=null&&m.startsWith(f)||$r(!1),d=w}else d=h;let x=d.pathname||"/",g=x;if(f!=="/"){let w=f.replace(/^\//,"").split("/");g="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=UI(e,{pathname:g}),_=y6(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:no([f,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?f:no([f,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n);return t&&_?v.createElement(qh.Provider,{value:{location:rf({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:eo.Pop}},_):_}function m6(){let e=S6(),t=l6(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),r?v.createElement("pre",{style:a},r):null,null)}const x6=v.createElement(m6,null);class g6 extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?v.createElement(go.Provider,{value:this.props.routeContext},v.createElement(t4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function v6(e){let{routeContext:t,match:r,children:n}=e,a=v.useContext(ly);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),v.createElement(go.Provider,{value:t},n)}function y6(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,c=(a=r)==null?void 0:a.errors;if(c!=null){let d=s.findIndex(m=>m.route.id&&c?.[m.route.id]!==void 0);d>=0||$r(!1),s=s.slice(0,Math.min(s.length,d+1))}let f=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<s.length;d++){let m=s[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(h=d),m.route.id){let{loaderData:x,errors:g}=r,b=m.route.loader&&x[m.route.id]===void 0&&(!g||g[m.route.id]===void 0);if(m.route.lazy||b){f=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((d,m,x)=>{let g,b=!1,_=null,w=null;r&&(g=c&&m.route.id?c[m.route.id]:void 0,_=m.route.errorElement||x6,f&&(h<0&&x===0?(E6("route-fallback"),b=!0,w=null):h===x&&(b=!0,w=m.route.hydrateFallbackElement||null)));let S=t.concat(s.slice(0,x+1)),A=()=>{let T;return g?T=_:b?T=w:m.route.Component?T=v.createElement(m.route.Component,null):m.route.element?T=m.route.element:T=d,v.createElement(v6,{match:m,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:T})};return r&&(m.route.ErrorBoundary||m.route.errorElement||x===0)?v.createElement(g6,{location:r.location,revalidation:r.revalidation,component:_,error:g,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):A()},null)}var a4=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(a4||{}),i4=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(i4||{});function w6(e){let t=v.useContext(ly);return t||$r(!1),t}function b6(e){let t=v.useContext(u6);return t||$r(!1),t}function _6(e){let t=v.useContext(go);return t||$r(!1),t}function s4(e){let t=_6(),r=t.matches[t.matches.length-1];return r.route.id||$r(!1),r.route.id}function S6(){var e;let t=v.useContext(t4),r=b6(),n=s4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function N6(){let{router:e}=w6(a4.UseNavigateStable),t=s4(i4.UseNavigateStable),r=v.useRef(!1);return r4(()=>{r.current=!0}),v.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,rf({fromRouteId:t},i)))},[e,t])}const yS={};function E6(e,t,r){yS[e]||(yS[e]=!0)}function zv(e){let{to:t,replace:r,state:n,relative:a}=e;Pc()||$r(!1);let{future:i,static:s}=v.useContext(xo),{matches:c}=v.useContext(go),{pathname:f}=vo(),h=Zh(),d=oy(t,sy(c,i.v7_relativeSplatPath),f,a==="path"),m=JSON.stringify(d);return v.useEffect(()=>h(JSON.parse(m),{replace:r,state:n,relative:a}),[h,m,a,r,n]),null}function Fn(e){$r(!1)}function T6(e){let{basename:t="/",children:r=null,location:n,navigationType:a=eo.Pop,navigator:i,static:s=!1,future:c}=e;Pc()&&$r(!1);let f=t.replace(/^\/*/,"/"),h=v.useMemo(()=>({basename:f,navigator:i,static:s,future:rf({v7_relativeSplatPath:!1},c)}),[f,c,i,s]);typeof n=="string"&&(n=jc(n));let{pathname:d="/",search:m="",hash:x="",state:g=null,key:b="default"}=n,_=v.useMemo(()=>{let w=iy(d,f);return w==null?null:{location:{pathname:w,search:m,hash:x,state:g,key:b},navigationType:a}},[f,d,m,x,g,b,a]);return _==null?null:v.createElement(xo.Provider,{value:h},v.createElement(qh.Provider,{children:r,value:_}))}function wS(e){let{children:t,location:r}=e;return h6(Hv(t),r)}new Promise(()=>{});function Hv(e,t){t===void 0&&(t=[]);let r=[];return v.Children.forEach(e,(n,a)=>{if(!v.isValidElement(n))return;let i=[...t,a];if(n.type===v.Fragment){r.push.apply(r,Hv(n.props.children,i));return}n.type!==Fn&&$r(!1),!n.props.index||!n.props.children||$r(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Hv(n.props.children,i)),r.push(s)}),r}function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wv.apply(this,arguments)}function k6(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function C6(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function A6(e,t){return e.button===0&&(!t||t==="_self")&&!C6(e)}const j6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],P6="6";try{window.__reactRouterVersion=P6}catch{}const O6="startTransition",bS=qC[O6];function D6(e){let{basename:t,children:r,future:n,window:a}=e,i=v.useRef();i.current==null&&(i.current=LI({window:a,v5Compat:!0}));let s=i.current,[c,f]=v.useState({action:s.action,location:s.location}),{v7_startTransition:h}=n||{},d=v.useCallback(m=>{h&&bS?bS(()=>f(m)):f(m)},[f,h]);return v.useLayoutEffect(()=>s.listen(d),[s,d]),v.createElement(T6,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:s,future:n})}const I6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",R6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_S=v.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:c,target:f,to:h,preventScrollReset:d,unstable_viewTransition:m}=t,x=k6(t,j6),{basename:g}=v.useContext(xo),b,_=!1;if(typeof h=="string"&&R6.test(h)&&(b=h,I6))try{let T=new URL(window.location.href),D=h.startsWith("//")?new URL(T.protocol+h):new URL(h),O=iy(D.pathname,g);D.origin===T.origin&&O!=null?h=O+D.search+D.hash:_=!0}catch{}let w=f6(h,{relative:a}),S=F6(h,{replace:s,state:c,target:f,preventScrollReset:d,relative:a,unstable_viewTransition:m});function A(T){n&&n(T),T.defaultPrevented||S(T)}return v.createElement("a",Wv({},x,{href:b||w,onClick:_||i?n:A,ref:r,target:f}))});var SS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(SS||(SS={}));var NS;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(NS||(NS={}));function F6(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,unstable_viewTransition:c}=t===void 0?{}:t,f=Zh(),h=vo(),d=n4(e,{relative:s});return v.useCallback(m=>{if(A6(m,r)){m.preventDefault();let x=n!==void 0?n:L0(h)===L0(d);f(e,{replace:x,state:a,preventScrollReset:i,relative:s,unstable_viewTransition:c})}},[h,f,d,n,a,r,e,i,s,c])}function M6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const cy=v.forwardRef(M6);function L6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const B6=v.forwardRef(L6);function $6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const uy=v.forwardRef($6);function U6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const z6=v.forwardRef(U6);function H6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const W6=v.forwardRef(H6);function V6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const B0=v.forwardRef(V6);function K6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const fy=v.forwardRef(K6);function G6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const Y6=v.forwardRef(G6);function X6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"}))}const q6=v.forwardRef(X6);function Z6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const Q6=v.forwardRef(Z6);function J6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const dy=v.forwardRef(J6);function eR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const o4=v.forwardRef(eR);function tR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"}))}const rR=v.forwardRef(tR);function nR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const aR=v.forwardRef(nR);function iR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const wc=v.forwardRef(iR);function sR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const tl=v.forwardRef(sR);function oR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const l4=v.forwardRef(oR);function lR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const cR=v.forwardRef(lR);function uR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const fR=v.forwardRef(uR);function dR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const $0=v.forwardRef(dR);function hR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const pR=v.forwardRef(hR);function mR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Px=v.forwardRef(mR);function xR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const gR=v.forwardRef(xR);function vR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const hy=v.forwardRef(vR);function yR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const nf=v.forwardRef(yR);function wR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const bR=v.forwardRef(wR);function _R({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const SR=v.forwardRef(_R);function NR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const gl=v.forwardRef(NR);function ER({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const c4=v.forwardRef(ER);function TR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const kR=v.forwardRef(TR);function CR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const U0=v.forwardRef(CR);function AR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const cc=v.forwardRef(AR);function jR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const py=v.forwardRef(jR);function PR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Mi=v.forwardRef(PR);function OR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const u4=v.forwardRef(OR);function DR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const IR=v.forwardRef(DR);function RR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const my=v.forwardRef(RR);function FR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const rl=v.forwardRef(FR);function MR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const LR=v.forwardRef(MR);function BR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const $R=v.forwardRef(BR);function UR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const xy=v.forwardRef(UR);function zR({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Tn=v.forwardRef(zR),HR={};var WR={};const VR=(()=>{const e=typeof import.meta<"u"&&HR?.VITE_API_BASE_URL||"";if(e)return e;const t=typeof process<"u"&&WR?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function KR(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const Ef=KR(VR),GR=e=>{if(e.startsWith("http"))return e;const t=Ef.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Xt(e,t){const r=GR(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(a){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw a}}async function YR(e=new Date().getFullYear()){const t=await Xt(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Khong the tai du lieu bieu do dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],a=c=>{const f=c.month||c.month_label||(Number.isFinite(c.month_num)?`T${c.month_num}`:"");return String(f||"").trim()},i=n.map(c=>({month:a(c),total_sales:Number(c.total_revenue??c.total_sales)||0})),s=n.map(c=>({month:a(c),total_orders:Number(c.total_orders)||0,total_canceled:Number(c.total_canceled)||0}));return{revenueData:i,orderStatusData:s,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function XR(){const e=await Xt("/api/dashboard/years");if(!e.ok)throw new Error("Li khi ti danh sch nm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const f4=v.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),gy=()=>v.useContext(f4),qR=({children:e})=>{const[t,r]=v.useState(null),[n,a]=v.useState(!0),i=async()=>{try{const s=await Xt("/api/auth/me");if(!s.ok){r(null);return}const c=await s.json();r(c.user||null)}catch{r(null)}finally{a(!1)}};return v.useEffect(()=>{i()},[]),u.jsx(f4.Provider,{value:{user:t,setUser:r,loading:n,refresh:i},children:e})},Ox=[{title:"Tng Quan",items:[{name:"Tng Quan",href:"/dashboard",icon:o4}]},{title:"Sn Phm",items:[{name:"n Hng",href:"/orders",icon:my},{name:"Gi",href:"/package-products",icon:fR},{name:"Bng Gi",href:"/pricing",icon:$0},{name:"Thng Tin Sn Phm",href:"/product-info",icon:SR}]},{title:"C Nhn",items:[{name:"Thng K",href:"/stats",icon:rR},{name:"Nh Cung Cp",href:"/sources",icon:pR},{name:"Bo Gi",href:"/show-price",icon:Px},{name:"Ha n",href:"/bill-order",icon:Px},{name:"Bin Lai",href:"/invoices",icon:Px},{name:"Lu tr",href:"/warehouse",icon:cy}]}],ES=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,a])=>`${n}=${a}`).sort().join("&")},Dx=(e,t,r)=>{const[n,a]=r.split("?"),i=a?`?${a}`:"";return e!==n?!1:ES(t)===ES(i)};function ZR({isOpen:e,setIsOpen:t}){const r=vo(),{user:n,setUser:a}=gy(),[i,s]=v.useState(!1),[c,f]=v.useState(()=>Object.fromEntries(Ox.map(m=>[m.title,!0]))),h=m=>{f(x=>({...x,[m]:!x[m]}))},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{a(null),window.location.href="/login"}};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:u.jsx("button",{onClick:()=>t(!e),className:"bg-white p-2 rounded-lg shadow-lg border border-gray-200",children:e?u.jsx(Tn,{className:"h-6 w-6 text-gray-600"}):u.jsx(Y6,{className:"h-6 w-6 text-gray-600"})})}),e&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>t(!1)}),u.jsx("div",{className:`
          fixed top-0 left-0 z-40 w-64 h-full bg-gradient-to-b from-[#0c1230] via-[#141a3c] to-[#0a0e24] shadow-2xl border-r border-white/10
          transform transition-transform duration-300 ease-in-out
          ${e?"translate-x-0":"-translate-x-full"}
          lg:translate-x-0
        `,children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx("div",{className:"px-4 pt-6 pb-4",children:u.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 px-4 py-3 shadow-lg shadow-indigo-900/50 text-center border border-white/10",children:[u.jsx("h1",{className:"text-lg font-bold text-white tracking-wide",children:"Admin Orderlist"}),u.jsx("p",{className:"text-[11px] text-indigo-100/90 mt-1 font-medium uppercase tracking-[0.08em]",children:"Control Panel"})]})}),u.jsx("nav",{className:"flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:Ox.map(m=>{const x=c[m.title]??!0,g=m.title===Ox[0].title,b=m.items.some(_=>r.pathname===_.href||Dx(r.pathname,r.search,_.href));return u.jsx("div",{className:`w-full rounded-2xl border border-white/10 bg-white/5 shadow-[0_10px_30px_-12px_rgba(0,0,0,0.45)] backdrop-blur-sm mb-3 ${b?"ring-2 ring-indigo-500/40":""}`,children:g?u.jsx("div",{className:"space-y-1 px-2 py-1",children:m.items.map(_=>{const w=r.pathname===_.href||Dx(r.pathname,r.search,_.href);return u.jsx("div",{className:"space-y-2",children:u.jsxs(_S,{to:_.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${w?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[u.jsx(_.icon,{className:`h-5 w-5 transition-colors ${w?"text-white":"text-indigo-200 group-hover:text-white"}`}),_.name]})},_.name)})}):u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",onClick:()=>h(m.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[u.jsx("span",{children:m.title}),u.jsx(l4,{className:`h-4 w-4 transition-transform ${x?"rotate-180":""}`})]}),x&&u.jsx("div",{className:"space-y-1 px-2.5 py-2",children:m.items.map(_=>{const w=r.pathname===_.href||Dx(r.pathname,r.search,_.href);return u.jsx("div",{className:"space-y-2",children:u.jsxs(_S,{to:_.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${w?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[u.jsx(_.icon,{className:`h-5 w-5 transition-colors ${w?"text-white":"text-indigo-200 group-hover:text-white"}`}),_.name]})},_.name)})})]})},m.title)})}),u.jsxs("div",{className:"relative p-4 border-t border-white/10 bg-white/5 backdrop-blur-sm",children:[u.jsxs("div",{className:"w-full flex items-center justify-between",children:[u.jsxs("button",{type:"button",onClick:()=>s(m=>!m),className:"flex items-center flex-1",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center shadow-md shadow-indigo-900/40",children:u.jsx("span",{className:"text-white text-sm font-bold tracking-wide",children:(n?.username||"A").slice(0,1).toUpperCase()})}),u.jsxs("div",{className:"ml-3 flex-1 text-left",children:[u.jsx("p",{className:"text-sm font-semibold text-white truncate",children:n?.username||"Ti khon"}),u.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:n?.role?`Role: ${n.role}`:"Cha ng nhp"})]})]}),u.jsx("button",{type:"button",onClick:d,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"ng Xut",children:u.jsx(z6,{className:"h-5 w-5"})})]}),i&&u.jsx("div",{className:"absolute bottom-16 left-4 right-4 rounded-lg border border-white/15 bg-[#0f1432] shadow-2xl shadow-black/40 z-10",children:u.jsx("ul",{className:"py-2 text-sm text-indigo-50 space-y-1",children:["Thng tin","Thm Admin","Thm Quyn","i Mt Khu"].map(m=>u.jsx("li",{children:u.jsx("button",{type:"button",className:"w-full text-left px-4 py-2 hover:bg-white/10",onClick:()=>s(!1),children:m})},m))})})]})]})})]})}const Yr={sky:{border:"border-sky-100/80",glow:"from-sky-100/70 via-white/80 to-blue-100/70",iconBg:"bg-sky-500/90 text-white"},emerald:{border:"border-emerald-100/80",glow:"from-emerald-100/70 via-white/80 to-lime-100/70",iconBg:"bg-emerald-500/90 text-white"},violet:{border:"border-violet-100/80",glow:"from-violet-100/70 via-white/80 to-fuchsia-100/70",iconBg:"bg-violet-500/90 text-white"},amber:{border:"border-amber-100/80",glow:"from-amber-100/70 via-white/80 to-orange-100/70",iconBg:"bg-amber-500/90 text-white"},rose:{border:"border-rose-100/80",glow:"from-rose-100/70 via-white/80 to-pink-100/70",iconBg:"bg-rose-500/90 text-white"},indigo:{border:"border-indigo-100/80",glow:"from-indigo-100/70 via-white/80 to-purple-100/70",iconBg:"bg-indigo-500/90 text-white"},slate:{border:"border-slate-200/80",glow:"from-slate-100/70 via-white/80 to-slate-200/70",iconBg:"bg-slate-600/90 text-white"},teal:{border:"border-teal-100/80",glow:"from-teal-100/70 via-white/80 to-cyan-100/70",iconBg:"bg-teal-500/90 text-white"}},Oc=({title:e,value:t,icon:r,accent:n,subtitle:a,children:i,iconClassName:s="h-6 w-6"})=>u.jsxs("div",{className:"relative isolate overflow-hidden rounded-3xl border border-white/25 bg-gradient-to-br from-slate-200/70 via-indigo-200/60 to-slate-300/70 p-6 shadow-[0_18px_48px_-28px_rgba(0,0,0,0.6),0_12px_30px_-24px_rgba(255,255,255,0.22)] backdrop-blur transition-all hover:shadow-[0_22px_60px_-28px_rgba(0,0,0,0.65),0_16px_36px_-24px_rgba(255,255,255,0.24)]",children:[u.jsxs("div",{className:"flex items-center justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e}),u.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:t}),a&&u.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-wide text-slate-600",children:a})]}),u.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20 border border-white/35 shadow-inner shadow-black/15 text-slate-800",children:u.jsx(r,{className:s})})]}),i&&u.jsx("div",{className:"mt-4",children:i})]});function d4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=d4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Zt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=d4(e))&&(n&&(n+=" "),n+=t);return n}var QR=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function vy(e){if(typeof e!="string")return!1;var t=QR;return t.includes(e)}var JR=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function h4(e){if(typeof e!="string")return!1;var t=JR;return t.includes(e)}function p4(e){return typeof e=="string"&&e.startsWith("data-")}function Ua(e){var t=Object.entries(e).filter(r=>{var[n]=r;return h4(n)||p4(n)});return Object.fromEntries(t)}function nl(e){if(e==null)return null;if(v.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Ua(t)}return typeof e=="object"&&!Array.isArray(e)?Ua(e):null}function oa(e){var t=Object.entries(e).filter(r=>{var[n]=r;return h4(n)||p4(n)||vy(n)});return Object.fromEntries(t)}function eF(e){return e==null?null:v.isValidElement(e)?oa(e.props):typeof e=="object"&&!Array.isArray(e)?oa(e):null}var tF=["children","width","height","viewBox","className","style","title","desc"];function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vv.apply(null,arguments)}function rF(e,t){if(e==null)return{};var r,n,a=nF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var m4=v.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:c,title:f,desc:h}=e,d=rF(e,tF),m=i||{width:n,height:a,x:0,y:0},x=Zt("recharts-surface",s);return v.createElement("svg",Vv({},oa(d),{className:x,width:n,height:a,style:c,viewBox:"".concat(m.x," ").concat(m.y," ").concat(m.width," ").concat(m.height),ref:t}),v.createElement("title",null,f),v.createElement("desc",null,h),r)}),aF=["children","className"];function Kv(){return Kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kv.apply(null,arguments)}function iF(e,t){if(e==null)return{};var r,n,a=sF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Cn=v.forwardRef((e,t)=>{var{children:r,className:n}=e,a=iF(e,aF),i=Zt("recharts-layer",n);return v.createElement("g",Kv({className:i},oa(a),{ref:t}),r)}),oF=v.createContext(null);function fr(e){return function(){return e}}const x4=Math.cos,z0=Math.sin,Ni=Math.sqrt,H0=Math.PI,Qh=2*H0,Gv=Math.PI,Yv=2*Gv,zo=1e-6,lF=Yv-zo;function g4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function cF(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return g4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class uF{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?g4:cF(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,c=this._y1,f=n-t,h=a-r,d=s-t,m=c-r,x=d*d+m*m;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>zo)if(!(Math.abs(m*f-h*d)>zo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-s,b=a-c,_=f*f+h*h,w=g*g+b*b,S=Math.sqrt(_),A=Math.sqrt(x),T=i*Math.tan((Gv-Math.acos((_+x-w)/(2*S*A)))/2),D=T/A,O=T/S;Math.abs(D-1)>zo&&this._append`L${t+D*d},${r+D*m}`,this._append`A${i},${i},0,0,${+(m*g>d*b)},${this._x1=t+O*f},${this._y1=r+O*h}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),f=n*Math.sin(a),h=t+c,d=r+f,m=1^s,x=s?a-i:i-a;this._x1===null?this._append`M${h},${d}`:(Math.abs(this._x1-h)>zo||Math.abs(this._y1-d)>zo)&&this._append`L${h},${d}`,n&&(x<0&&(x=x%Yv+Yv),x>lF?this._append`A${n},${n},0,1,${m},${t-c},${r-f}A${n},${n},0,1,${m},${this._x1=h},${this._y1=d}`:x>zo&&this._append`A${n},${n},0,${+(x>=Gv)},${m},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function yy(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new uF(t)}function wy(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function v4(e){this._context=e}v4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Jh(e){return new v4(e)}function y4(e){return e[0]}function w4(e){return e[1]}function b4(e,t){var r=fr(!0),n=null,a=Jh,i=null,s=yy(c);e=typeof e=="function"?e:e===void 0?y4:fr(e),t=typeof t=="function"?t:t===void 0?w4:fr(t);function c(f){var h,d=(f=wy(f)).length,m,x=!1,g;for(n==null&&(i=a(g=s())),h=0;h<=d;++h)!(h<d&&r(m=f[h],h,f))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(m,h,f),+t(m,h,f));if(g)return i=null,g+""||null}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:fr(+f),c):e},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:fr(+f),c):t},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:fr(!!f),c):r},c.curve=function(f){return arguments.length?(a=f,n!=null&&(i=a(n)),c):a},c.context=function(f){return arguments.length?(f==null?n=i=null:i=a(n=f),c):n},c}function Zd(e,t,r){var n=null,a=fr(!0),i=null,s=Jh,c=null,f=yy(h);e=typeof e=="function"?e:e===void 0?y4:fr(+e),t=typeof t=="function"?t:fr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?w4:fr(+r);function h(m){var x,g,b,_=(m=wy(m)).length,w,S=!1,A,T=new Array(_),D=new Array(_);for(i==null&&(c=s(A=f())),x=0;x<=_;++x){if(!(x<_&&a(w=m[x],x,m))===S)if(S=!S)g=x,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),b=x-1;b>=g;--b)c.point(T[b],D[b]);c.lineEnd(),c.areaEnd()}S&&(T[x]=+e(w,x,m),D[x]=+t(w,x,m),c.point(n?+n(w,x,m):T[x],r?+r(w,x,m):D[x]))}if(A)return c=null,A+""||null}function d(){return b4().defined(a).curve(s).context(i)}return h.x=function(m){return arguments.length?(e=typeof m=="function"?m:fr(+m),n=null,h):e},h.x0=function(m){return arguments.length?(e=typeof m=="function"?m:fr(+m),h):e},h.x1=function(m){return arguments.length?(n=m==null?null:typeof m=="function"?m:fr(+m),h):n},h.y=function(m){return arguments.length?(t=typeof m=="function"?m:fr(+m),r=null,h):t},h.y0=function(m){return arguments.length?(t=typeof m=="function"?m:fr(+m),h):t},h.y1=function(m){return arguments.length?(r=m==null?null:typeof m=="function"?m:fr(+m),h):r},h.lineX0=h.lineY0=function(){return d().x(e).y(t)},h.lineY1=function(){return d().x(e).y(r)},h.lineX1=function(){return d().x(n).y(t)},h.defined=function(m){return arguments.length?(a=typeof m=="function"?m:fr(!!m),h):a},h.curve=function(m){return arguments.length?(s=m,i!=null&&(c=s(i)),h):s},h.context=function(m){return arguments.length?(m==null?i=c=null:c=s(i=m),h):i},h}class _4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function fF(e){return new _4(e,!0)}function dF(e){return new _4(e,!1)}const by={draw(e,t){const r=Ni(t/H0);e.moveTo(r,0),e.arc(0,0,r,0,Qh)}},hF={draw(e,t){const r=Ni(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},S4=Ni(1/3),pF=S4*2,mF={draw(e,t){const r=Ni(t/pF),n=r*S4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},xF={draw(e,t){const r=Ni(t),n=-r/2;e.rect(n,n,r,r)}},gF=.8908130915292852,N4=z0(H0/10)/z0(7*H0/10),vF=z0(Qh/10)*N4,yF=-x4(Qh/10)*N4,wF={draw(e,t){const r=Ni(t*gF),n=vF*r,a=yF*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Qh*i/5,c=x4(s),f=z0(s);e.lineTo(f*r,-c*r),e.lineTo(c*n-f*a,f*n+c*a)}e.closePath()}},Ix=Ni(3),bF={draw(e,t){const r=-Ni(t/(Ix*3));e.moveTo(0,r*2),e.lineTo(-Ix*r,-r),e.lineTo(Ix*r,-r),e.closePath()}},qa=-.5,Za=Ni(3)/2,Xv=1/Ni(12),_F=(Xv/2+1)*3,SF={draw(e,t){const r=Ni(t/_F),n=r/2,a=r*Xv,i=n,s=r*Xv+r,c=-i,f=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(c,f),e.lineTo(qa*n-Za*a,Za*n+qa*a),e.lineTo(qa*i-Za*s,Za*i+qa*s),e.lineTo(qa*c-Za*f,Za*c+qa*f),e.lineTo(qa*n+Za*a,qa*a-Za*n),e.lineTo(qa*i+Za*s,qa*s-Za*i),e.lineTo(qa*c+Za*f,qa*f-Za*c),e.closePath()}};function NF(e,t){let r=null,n=yy(a);e=typeof e=="function"?e:fr(e||by),t=typeof t=="function"?t:fr(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:fr(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:fr(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function W0(){}function V0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function E4(e){this._context=e}E4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:V0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:V0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function EF(e){return new E4(e)}function T4(e){this._context=e}T4.prototype={areaStart:W0,areaEnd:W0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:V0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TF(e){return new T4(e)}function k4(e){this._context=e}k4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:V0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kF(e){return new k4(e)}function C4(e){this._context=e}C4.prototype={areaStart:W0,areaEnd:W0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function CF(e){return new C4(e)}function TS(e){return e<0?-1:1}function kS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),c=(i*a+s*n)/(n+a);return(TS(i)+TS(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(c))||0}function CS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Rx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*t,i-c,s-c*r,i,s)}function K0(e){this._context=e}K0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Rx(this,this._t0,CS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Rx(this,CS(this,r=kS(this,e,t)),r);break;default:Rx(this,this._t0,r=kS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function A4(e){this._context=new j4(e)}(A4.prototype=Object.create(K0.prototype)).point=function(e,t){K0.prototype.point.call(this,t,e)};function j4(e){this._context=e}j4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function AF(e){return new K0(e)}function jF(e){return new A4(e)}function P4(e){this._context=e}P4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=AS(e),a=AS(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function AS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function PF(e){return new P4(e)}function ep(e,t){this._context=e,this._t=t}ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function OF(e){return new ep(e,.5)}function DF(e){return new ep(e,0)}function IF(e){return new ep(e,1)}function bc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,c=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function qv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function RF(e,t){return e[t]}function FF(e){const t=[];return t.key=e,t}function MF(){var e=fr([]),t=qv,r=bc,n=RF;function a(i){var s=Array.from(e.apply(this,arguments),FF),c,f=s.length,h=-1,d;for(const m of i)for(c=0,++h;c<f;++c)(s[c][h]=[0,+n(m,s[c].key,h,i)]).data=m;for(c=0,d=wy(t(s));c<f;++c)s[d[c]].index=c;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:fr(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:fr(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?qv:typeof i=="function"?i:fr(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??bc,a):r},a}function LF(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}bc(e,t)}}function BF(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,c=0;s<a;++s)c+=e[s][r][1]||0;n[r][1]+=n[r][0]=-c/2}bc(e,t)}}function $F(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var c=0,f=0,h=0;c<s;++c){for(var d=e[t[c]],m=d[n][1]||0,x=d[n-1][1]||0,g=(m-x)/2,b=0;b<c;++b){var _=e[t[b]],w=_[n][1]||0,S=_[n-1][1]||0;g+=w-S}f+=m,h+=g*m}a[n-1][1]+=a[n-1][0]=r,f&&(r-=h/f)}a[n-1][1]+=a[n-1][0]=r,bc(e,t)}}var Fx={},Mx={},jS;function UF(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Mx)),Mx}var Lx={},PS;function O4(){return PS||(PS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Lx)),Lx}var Bx={},OS;function _y(){return OS||(OS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Bx)),Bx}var $x={},Ux={},DS;function zF(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Ux)),Ux}var IS;function Sy(){return IS||(IS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zF(),r=_y();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let c=0,f="",h="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),c++);c<s;){const m=a[c];h?m==="\\"&&c+1<s?(c++,f+=a[c]):m===h?h="":f+=m:d?m==='"'||m==="'"?h=m:m==="]"?(d=!1,i.push(f),f=""):f+=m:m==="["?(d=!0,f&&(i.push(f),f="")):m==="."?f&&(i.push(f),f=""):f+=m,c++}return f&&i.push(f),i}e.toPath=n})($x)),$x}var RS;function Ny(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UF(),r=O4(),n=_y(),a=Sy();function i(c,f,h){if(c==null)return h;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return h;const d=c[f];return d===void 0?r.isDeepKey(f)?i(c,a.toPath(f),h):h:d}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const d=c[f];return d===void 0?h:d}default:{if(Array.isArray(f))return s(c,f,h);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return h;const d=c[f];return d===void 0?h:d}}}function s(c,f,h){if(f.length===0)return h;let d=c;for(let m=0;m<f.length;m++){if(d==null||t.isUnsafeProperty(f[m]))return h;d=d[f[m]]}return d===void 0?h:d}e.get=i})(Fx)),Fx}var zx,FS;function HF(){return FS||(FS=1,zx=Ny().get),zx}var WF=HF();const al=ys(WF);var gn=e=>e===0?0:e>0?1:-1,ai=e=>typeof e=="number"&&e!=+e,ds=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,mt=e=>(typeof e=="number"||e instanceof Number)&&!ai(e),$i=e=>mt(e)||typeof e=="string",VF=0,af=e=>{var t=++VF;return"".concat(e||"").concat(t)},Hn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!mt(t)&&typeof t!="string")return n;var i;if(ds(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ai(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},D4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Fr(e,t,r){return mt(e)&&mt(t)?e+r*(t-e):t}function I4(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):al(n,t))===r)}var Er=e=>e===null||typeof e>"u",Tf=e=>Er(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),KF=["type","size","sizeType"];function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function MS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function LS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MS(Object(r),!0).forEach(function(n){GF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GF(e,t,r){return(t=YF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YF(e){var t=XF(e,"string");return typeof t=="symbol"?t:t+""}function XF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qF(e,t){if(e==null)return{};var r,n,a=ZF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var R4={symbolCircle:by,symbolCross:hF,symbolDiamond:mF,symbolSquare:xF,symbolStar:wF,symbolTriangle:bF,symbolWye:SF},QF=Math.PI/180,JF=e=>{var t="symbol".concat(Tf(e));return R4[t]||by},e8=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*QF;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},t8=(e,t)=>{R4["symbol".concat(Tf(e))]=t},F4=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=qF(e,KF),i=LS(LS({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var c=()=>{var x=JF(s),g=NF().type(x).size(e8(r,n,s)),b=g();if(b!==null)return b},{className:f,cx:h,cy:d}=i,m=oa(i);return h===+h&&d===+d&&r===+r?v.createElement("path",Zv({},m,{className:Zt("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(d,")"),d:c()})):null};F4.registerSymbol=t8;var Ey=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{vy(a)&&(n[a]=(i=>r[a](r,i)))}),n},r8=(e,t,r)=>n=>(e(t,r,n),null),tp=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];vy(a)&&typeof i=="function"&&(n||(n={}),n[a]=r8(i,t,r))}),n},Hx={},Wx={},BS;function n8(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],c=n(s);a.has(c)||a.set(c,s)}return Array.from(a.values())}e.uniqBy=t})(Wx)),Wx}var Vx={},$S;function M4(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Vx)),Vx}var Kx={},Gx={},Yx={},US;function a8(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Yx)),Yx}var zS;function Ty(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a8();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Gx)),Gx}var Xx={},HS;function i8(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Xx)),Xx}var WS;function s8(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ty(),r=i8();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Kx)),Kx}var qx={},Zx={},VS;function o8(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ny();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Zx)),Zx}var Qx={},Jx={},eg={},tg={},KS;function L4(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(tg)),tg}var rg={},GS;function B4(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(rg)),rg}var ng={},YS;function $4(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(ng)),ng}var XS;function l8(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L4(),r=B4(),n=$4();function a(d,m,x){return typeof x!="function"?a(d,m,()=>{}):i(d,m,function g(b,_,w,S,A,T){const D=x(b,_,w,S,A,T);return D!==void 0?!!D:i(b,_,g,T)},new Map)}function i(d,m,x,g){if(m===d)return!0;switch(typeof m){case"object":return s(d,m,x,g);case"function":return Object.keys(m).length>0?i(d,{...m},x,g):n.eq(d,m);default:return t.isObject(d)?typeof m=="string"?m==="":!0:n.eq(d,m)}}function s(d,m,x,g){if(m==null)return!0;if(Array.isArray(m))return f(d,m,x,g);if(m instanceof Map)return c(d,m,x,g);if(m instanceof Set)return h(d,m,x,g);const b=Object.keys(m);if(d==null)return b.length===0;if(b.length===0)return!0;if(g?.has(m))return g.get(m)===d;g?.set(m,d);try{for(let _=0;_<b.length;_++){const w=b[_];if(!r.isPrimitive(d)&&!(w in d)||m[w]===void 0&&d[w]!==void 0||m[w]===null&&d[w]!==null||!x(d[w],m[w],w,d,m,g))return!1}return!0}finally{g?.delete(m)}}function c(d,m,x,g){if(m.size===0)return!0;if(!(d instanceof Map))return!1;for(const[b,_]of m.entries()){const w=d.get(b);if(x(w,_,b,d,m,g)===!1)return!1}return!0}function f(d,m,x,g){if(m.length===0)return!0;if(!Array.isArray(d))return!1;const b=new Set;for(let _=0;_<m.length;_++){const w=m[_];let S=!1;for(let A=0;A<d.length;A++){if(b.has(A))continue;const T=d[A];let D=!1;if(x(T,w,_,d,m,g)&&(D=!0),D){b.add(A),S=!0;break}}if(!S)return!1}return!0}function h(d,m,x,g){return m.size===0?!0:d instanceof Set?f([...d],[...m],x,g):!1}e.isMatchWith=a,e.isSetMatch=h})(eg)),eg}var qS;function U4(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l8();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Jx)),Jx}var ag={},ig={},sg={},ZS;function c8(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(sg)),sg}var og={},QS;function z4(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(og)),og}var lg={},JS;function H4(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",c="[object Date]",f="[object Map]",h="[object Set]",d="[object Array]",m="[object Function]",x="[object ArrayBuffer]",g="[object Object]",b="[object Error]",_="[object DataView]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",A="[object Uint16Array]",T="[object Uint32Array]",D="[object BigUint64Array]",O="[object Int8Array]",I="[object Int16Array]",j="[object Int32Array]",z="[object BigInt64Array]",R="[object Float32Array]",q="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=x,e.arrayTag=d,e.bigInt64ArrayTag=z,e.bigUint64ArrayTag=D,e.booleanTag=a,e.dataViewTag=_,e.dateTag=c,e.errorTag=b,e.float32ArrayTag=R,e.float64ArrayTag=q,e.functionTag=m,e.int16ArrayTag=I,e.int32ArrayTag=j,e.int8ArrayTag=O,e.mapTag=f,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=h,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=A,e.uint32ArrayTag=T,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=S})(lg)),lg}var cg={},eN;function u8(){return eN||(eN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(cg)),cg}var tN;function W4(){return tN||(tN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c8(),r=z4(),n=H4(),a=B4(),i=u8();function s(d,m){return c(d,void 0,d,new Map,m)}function c(d,m,x,g=new Map,b=void 0){const _=b?.(d,m,x,g);if(_!==void 0)return _;if(a.isPrimitive(d))return d;if(g.has(d))return g.get(d);if(Array.isArray(d)){const w=new Array(d.length);g.set(d,w);for(let S=0;S<d.length;S++)w[S]=c(d[S],S,x,g,b);return Object.hasOwn(d,"index")&&(w.index=d.index),Object.hasOwn(d,"input")&&(w.input=d.input),w}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const w=new RegExp(d.source,d.flags);return w.lastIndex=d.lastIndex,w}if(d instanceof Map){const w=new Map;g.set(d,w);for(const[S,A]of d)w.set(S,c(A,S,x,g,b));return w}if(d instanceof Set){const w=new Set;g.set(d,w);for(const S of d)w.add(c(S,void 0,x,g,b));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const w=new(Object.getPrototypeOf(d)).constructor(d.length);g.set(d,w);for(let S=0;S<d.length;S++)w[S]=c(d[S],S,x,g,b);return w}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const w=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return g.set(d,w),f(w,d,x,g,b),w}if(typeof File<"u"&&d instanceof File){const w=new File([d],d.name,{type:d.type});return g.set(d,w),f(w,d,x,g,b),w}if(typeof Blob<"u"&&d instanceof Blob){const w=new Blob([d],{type:d.type});return g.set(d,w),f(w,d,x,g,b),w}if(d instanceof Error){const w=new d.constructor;return g.set(d,w),w.message=d.message,w.name=d.name,w.stack=d.stack,w.cause=d.cause,f(w,d,x,g,b),w}if(d instanceof Boolean){const w=new Boolean(d.valueOf());return g.set(d,w),f(w,d,x,g,b),w}if(d instanceof Number){const w=new Number(d.valueOf());return g.set(d,w),f(w,d,x,g,b),w}if(d instanceof String){const w=new String(d.valueOf());return g.set(d,w),f(w,d,x,g,b),w}if(typeof d=="object"&&h(d)){const w=Object.create(Object.getPrototypeOf(d));return g.set(d,w),f(w,d,x,g,b),w}return d}function f(d,m,x=d,g,b){const _=[...Object.keys(m),...t.getSymbols(m)];for(let w=0;w<_.length;w++){const S=_[w],A=Object.getOwnPropertyDescriptor(d,S);(A==null||A.writable)&&(d[S]=c(m[S],S,x,g,b))}}function h(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=c,e.copyProperties=f})(ig)),ig}var rN;function f8(){return rN||(rN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W4();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(ag)),ag}var nN;function d8(){return nN||(nN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U4(),r=f8();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Qx)),Qx}var ug={},fg={},dg={},aN;function h8(){return aN||(aN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W4(),r=H4();function n(a,i){return t.cloneDeepWith(a,(s,c,f,h)=>{const d=i?.(s,c,f,h);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const m=new a.constructor(a?.valueOf());return t.copyProperties(m,a),m}case r.argumentsTag:{const m={};return t.copyProperties(m,a),m.length=a.length,m[Symbol.iterator]=a[Symbol.iterator],m}default:return}})}e.cloneDeepWith=n})(dg)),dg}var iN;function p8(){return iN||(iN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h8();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(fg)),fg}var hg={},pg={},sN;function V4(){return sN||(sN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(pg)),pg}var mg={},oN;function m8(){return oN||(oN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z4();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(mg)),mg}var lN;function x8(){return lN||(lN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O4(),r=V4(),n=m8(),a=Sy();function i(s,c){let f;if(Array.isArray(c)?f=c:typeof c=="string"&&t.isDeepKey(c)&&s?.[c]==null?f=a.toPath(c):f=[c],f.length===0)return!1;let h=s;for(let d=0;d<f.length;d++){const m=f[d];if((h==null||!Object.hasOwn(h,m))&&!((Array.isArray(h)||n.isArguments(h))&&r.isIndex(m)&&m<h.length))return!1;h=h[m]}return!0}e.has=i})(hg)),hg}var cN;function g8(){return cN||(cN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U4(),r=_y(),n=p8(),a=Ny(),i=x8();function s(c,f){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return f=n.cloneDeep(f),function(h){const d=a.get(h,c);return d===void 0?i.has(h,c):f===void 0?d===void 0:t.isMatch(d,f)}}e.matchesProperty=s})(ug)),ug}var uN;function v8(){return uN||(uN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M4(),r=o8(),n=d8(),a=g8();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(qx)),qx}var fN;function y8(){return fN||(fN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n8(),r=M4(),n=s8(),a=v8();function i(s,c=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(c)):[]}e.uniqBy=i})(Hx)),Hx}var xg,dN;function w8(){return dN||(dN=1,xg=y8().uniqBy),xg}var b8=w8();const hN=ys(b8);function _8(e,t,r){return t===!0?hN(e,r):typeof t=="function"?hN(e,t):e}var gg={exports:{}},vg={},yg={exports:{}},wg={};var pN;function S8(){if(pN)return wg;pN=1;var e=Ac();function t(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function c(m,x){var g=x(),b=n({inst:{value:g,getSnapshot:x}}),_=b[0].inst,w=b[1];return i(function(){_.value=g,_.getSnapshot=x,f(_)&&w({inst:_})},[m,g,x]),a(function(){return f(_)&&w({inst:_}),m(function(){f(_)&&w({inst:_})})},[m]),s(g),g}function f(m){var x=m.getSnapshot;m=m.value;try{var g=x();return!r(m,g)}catch{return!0}}function h(m,x){return x()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return wg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,wg}var mN;function N8(){return mN||(mN=1,yg.exports=S8()),yg.exports}var xN;function E8(){if(xN)return vg;xN=1;var e=Ac(),t=N8();function r(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,c=e.useMemo,f=e.useDebugValue;return vg.useSyncExternalStoreWithSelector=function(h,d,m,x,g){var b=i(null);if(b.current===null){var _={hasValue:!1,value:null};b.current=_}else _=b.current;b=c(function(){function S(I){if(!A){if(A=!0,T=I,I=x(I),g!==void 0&&_.hasValue){var j=_.value;if(g(j,I))return D=j}return D=I}if(j=D,n(T,I))return j;var z=x(I);return g!==void 0&&g(j,z)?(T=I,j):(T=I,D=z)}var A=!1,T,D,O=m===void 0?null:m;return[function(){return S(d())},O===null?void 0:function(){return S(O())}]},[d,m,x,g]);var w=a(h,b[0],b[1]);return s(function(){_.hasValue=!0,_.value=w},[w]),f(w),w},vg}var gN;function T8(){return gN||(gN=1,gg.exports=E8()),gg.exports}var k8=T8(),ky=v.createContext(null),C8=e=>e,Mr=()=>{var e=v.useContext(ky);return e?e.store.dispatch:C8},P0=()=>{},A8=()=>P0,j8=(e,t)=>e===t;function ft(e){var t=v.useContext(ky);return k8.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:A8,t?t.store.getState:P0,t?t.store.getState:P0,t?e:P0,j8)}function P8(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function O8(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function D8(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var vN=e=>Array.isArray(e)?e:[e];function I8(e){const t=Array.isArray(e[0])?e[0]:e;return D8(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function R8(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var F8=class{constructor(e){this.value=e}deref(){return this.value}},M8=typeof WeakRef<"u"?WeakRef:F8,L8=0,yN=1;function Qd(){return{s:L8,v:void 0,o:null,p:null}}function K4(e,t={}){let r=Qd();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let c=r;const{length:f}=arguments;for(let m=0,x=f;m<x;m++){const g=arguments[m];if(typeof g=="function"||typeof g=="object"&&g!==null){let b=c.o;b===null&&(c.o=b=new WeakMap);const _=b.get(g);_===void 0?(c=Qd(),b.set(g,c)):c=_}else{let b=c.p;b===null&&(c.p=b=new Map);const _=b.get(g);_===void 0?(c=Qd(),b.set(g,c)):c=_}}const h=c;let d;if(c.s===yN)d=c.v;else if(d=e.apply(null,arguments),i++,n){const m=a?.deref?.()??a;m!=null&&n(m,d)&&(d=m,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new M8(d):d}return h.s=yN,h.v=d,d}return s.clearCache=()=>{r=Qd(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function B8(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,c,f={},h=a.pop();typeof h=="object"&&(f=h,h=a.pop()),P8(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const d={...r,...f},{memoize:m,memoizeOptions:x=[],argsMemoize:g=K4,argsMemoizeOptions:b=[]}=d,_=vN(x),w=vN(b),S=I8(a),A=m(function(){return i++,h.apply(null,arguments)},..._),T=g(function(){s++;const O=R8(S,arguments);return c=A.apply(null,O),c},...w);return Object.assign(T,{resultFunc:h,memoizedResultFunc:A,dependencies:S,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:m,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Ee=B8(K4),$8=Object.assign((e,t=Ee)=>{O8(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,c,f)=>(s[r[f]]=c,s),{}))},{withTypes:()=>$8}),bg={},_g={},Sg={},wN;function U8(){return wN||(wN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),c=t(a);if(s===c&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?c-s:s-c}return 0};e.compareValues=r})(Sg)),Sg}var Ng={},Eg={},bN;function G4(){return bN||(bN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Eg)),Eg}var _N;function z8(){return _N||(_N=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G4(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(Ng)),Ng}var SN;function H8(){return SN||(SN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U8(),r=z8(),n=Sy();function a(i,s,c,f){if(i==null)return[];c=f?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(g=>String(g));const h=(g,b)=>{let _=g;for(let w=0;w<b.length&&_!=null;++w)_=_[b[w]];return _},d=(g,b)=>b==null||g==null?b:typeof g=="object"&&"key"in g?Object.hasOwn(b,g.key)?b[g.key]:h(b,g.path):typeof g=="function"?g(b):Array.isArray(g)?h(b,g):typeof b=="object"?b[g]:b,m=s.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return i.map(g=>({original:g,criteria:m.map(b=>d(b,g))})).slice().sort((g,b)=>{for(let _=0;_<m.length;_++){const w=t.compareValues(g.criteria[_],b.criteria[_],c[_]);if(w!==0)return w}return 0}).map(g=>g.original)}e.orderBy=a})(_g)),_g}var Tg={},NN;function W8(){return NN||(NN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(c,f)=>{for(let h=0;h<c.length;h++){const d=c[h];Array.isArray(d)&&f<i?s(d,f+1):a.push(d)}};return s(r,0),a}e.flatten=t})(Tg)),Tg}var kg={},EN;function Y4(){return EN||(EN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V4(),r=Ty(),n=L4(),a=$4();function i(s,c,f){return n.isObject(f)&&(typeof c=="number"&&r.isArrayLike(f)&&t.isIndex(c)&&c<f.length||typeof c=="string"&&c in f)?a.eq(f[c],s):!1}e.isIterateeCall=i})(kg)),kg}var TN;function V8(){return TN||(TN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H8(),r=W8(),n=Y4();function a(i,...s){const c=s.length;return c>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:c>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(bg)),bg}var Cg,kN;function K8(){return kN||(kN=1,Cg=V8().sortBy),Cg}var G8=K8();const rp=ys(G8);var X4=e=>e.legend.settings,Y8=e=>e.legend.size,X8=e=>e.legend.payload;Ee([X8,X4],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?rp(n,r):n});var Jd=1;function q8(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>Jd||Math.abs(s.left-t.left)>Jd||Math.abs(s.top-t.top)>Jd||Math.abs(s.width-t.width)>Jd)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function _n(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Z8=typeof Symbol=="function"&&Symbol.observable||"@@observable",CN=Z8,Ag=()=>Math.random().toString(36).substring(7).split("").join("."),Q8={INIT:`@@redux/INIT${Ag()}`,REPLACE:`@@redux/REPLACE${Ag()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ag()}`},G0=Q8;function Cy(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function q4(e,t,r){if(typeof e!="function")throw new Error(_n(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(_n(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(_n(1));return r(q4)(e,t)}let n=e,a=t,i=new Map,s=i,c=0,f=!1;function h(){s===i&&(s=new Map,i.forEach((w,S)=>{s.set(S,w)}))}function d(){if(f)throw new Error(_n(3));return a}function m(w){if(typeof w!="function")throw new Error(_n(4));if(f)throw new Error(_n(5));let S=!0;h();const A=c++;return s.set(A,w),function(){if(S){if(f)throw new Error(_n(6));S=!1,h(),s.delete(A),i=null}}}function x(w){if(!Cy(w))throw new Error(_n(7));if(typeof w.type>"u")throw new Error(_n(8));if(typeof w.type!="string")throw new Error(_n(17));if(f)throw new Error(_n(9));try{f=!0,a=n(a,w)}finally{f=!1}return(i=s).forEach(A=>{A()}),w}function g(w){if(typeof w!="function")throw new Error(_n(10));n=w,x({type:G0.REPLACE})}function b(){const w=m;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(_n(11));function A(){const D=S;D.next&&D.next(d())}return A(),{unsubscribe:w(A)}},[CN](){return this}}}return x({type:G0.INIT}),{dispatch:x,subscribe:m,getState:d,replaceReducer:g,[CN]:b}}function J8(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:G0.INIT})>"u")throw new Error(_n(12));if(typeof r(void 0,{type:G0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(_n(13))})}function Z4(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{J8(r)}catch(i){a=i}return function(s={},c){if(a)throw a;let f=!1;const h={};for(let d=0;d<n.length;d++){const m=n[d],x=r[m],g=s[m],b=x(g,c);if(typeof b>"u")throw c&&c.type,new Error(_n(14));h[m]=b,f=f||b!==g}return f=f||n.length!==Object.keys(s).length,f?h:s}}function Y0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function eM(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(_n(15))};const s={getState:a.getState,dispatch:(f,...h)=>i(f,...h)},c=e.map(f=>f(s));return i=Y0(...c)(a.dispatch),{...a,dispatch:i}}}function Q4(e){return Cy(e)&&"type"in e&&typeof e.type=="string"}var J4=Symbol.for("immer-nothing"),AN=Symbol.for("immer-draftable"),za=Symbol.for("immer-state");function vi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var sf=Object.getPrototypeOf;function il(e){return!!e&&!!e[za]}function hs(e){return e?eA(e)||Array.isArray(e)||!!e[AN]||!!e.constructor?.[AN]||kf(e)||ap(e):!1}var tM=Object.prototype.constructor.toString(),jN=new WeakMap;function eA(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=jN.get(r);return n===void 0&&(n=Function.toString.call(r),jN.set(r,n)),n===tM}function X0(e,t,r=!0){np(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function np(e){const t=e[za];return t?t.type_:Array.isArray(e)?1:kf(e)?2:ap(e)?3:0}function Qv(e,t){return np(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function tA(e,t,r){const n=np(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function rM(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function kf(e){return e instanceof Map}function ap(e){return e instanceof Set}function Ho(e){return e.copy_||e.base_}function Jv(e,t){if(kf(e))return new Map(e);if(ap(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=eA(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[za];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],c=n[s];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[s]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[s]})}return Object.create(sf(e),n)}else{const n=sf(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Ay(e,t=!1){return ip(e)||il(e)||!hs(e)||(np(e)>1&&Object.defineProperties(e,{set:e0,add:e0,clear:e0,delete:e0}),Object.freeze(e),t&&Object.values(e).forEach(r=>Ay(r,!0))),e}function nM(){vi(2)}var e0={value:nM};function ip(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var aM={};function sl(e){const t=aM[e];return t||vi(0,e),t}var of;function rA(){return of}function iM(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function PN(e,t){t&&(sl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function e1(e){t1(e),e.drafts_.forEach(sM),e.drafts_=null}function t1(e){e===of&&(of=e.parent_)}function ON(e){return of=iM(of,e)}function sM(e){const t=e[za];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function DN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[za].modified_&&(e1(t),vi(4)),hs(e)&&(e=q0(t,e),t.parent_||Z0(t,e)),t.patches_&&sl("Patches").generateReplacementPatches_(r[za].base_,e,t.patches_,t.inversePatches_)):e=q0(t,r,[]),e1(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==J4?e:void 0}function q0(e,t,r){if(ip(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[za];if(!a)return X0(t,(i,s)=>IN(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return Z0(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,c=!1;a.type_===3&&(s=new Set(i),i.clear(),c=!0),X0(s,(f,h)=>IN(e,a,i,f,h,r,c),n),Z0(e,i,!1),r&&e.patches_&&sl("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function IN(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const c=ip(a);if(!(c&&!s)){if(il(a)){const f=i&&t&&t.type_!==3&&!Qv(t.assigned_,n)?i.concat(n):void 0,h=q0(e,a,f);if(tA(r,n,h),il(h))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(hs(a)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&c)return;q0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(kf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Z0(e,a)}}}function Z0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ay(t,r)}function oM(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:rA(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=jy;r&&(a=[n],i=lf);const{revoke:s,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=s,c}var jy={get(e,t){if(t===za)return e;const r=Ho(e);if(!Qv(r,t))return lM(e,r,t);const n=r[t];return e.finalized_||!hs(n)?n:n===jg(e.base_,t)?(Pg(e),e.copy_[t]=n1(n,e)):n},has(e,t){return t in Ho(e)},ownKeys(e){return Reflect.ownKeys(Ho(e))},set(e,t,r){const n=nA(Ho(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=jg(Ho(e),t),i=a?.[za];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(rM(r,a)&&(r!==void 0||Qv(e.base_,t)))return!0;Pg(e),r1(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return jg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Pg(e),r1(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ho(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){vi(11)},getPrototypeOf(e){return sf(e.base_)},setPrototypeOf(){vi(12)}},lf={};X0(jy,(e,t)=>{lf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});lf.deleteProperty=function(e,t){return lf.set.call(this,e,t,void 0)};lf.set=function(e,t,r){return jy.set.call(this,e[0],t,r,e[0])};function jg(e,t){const r=e[za];return(r?Ho(r):e)[t]}function lM(e,t,r){const n=nA(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function nA(e,t){if(!(t in e))return;let r=sf(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=sf(r)}}function r1(e){e.modified_||(e.modified_=!0,e.parent_&&r1(e.parent_))}function Pg(e){e.copy_||(e.copy_=Jv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var cM=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(f=i,...h){return s.produce(f,d=>r.call(this,d,...h))}}typeof r!="function"&&vi(6),n!==void 0&&typeof n!="function"&&vi(7);let a;if(hs(t)){const i=ON(this),s=n1(t,void 0);let c=!0;try{a=r(s),c=!1}finally{c?e1(i):t1(i)}return PN(i,n),DN(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===J4&&(a=void 0),this.autoFreeze_&&Ay(a,!0),n){const i=[],s=[];sl("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else vi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...c)=>this.produceWithPatches(s,f=>t(f,...c));let n,a;return[this.produce(t,r,(s,c)=>{n=s,a=c}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){hs(e)||vi(8),il(e)&&(e=os(e));const t=ON(this),r=n1(e,void 0);return r[za].isManual_=!0,t1(t),r}finishDraft(e,t){const r=e&&e[za];(!r||!r.isManual_)&&vi(9);const{scope_:n}=r;return PN(n,t),DN(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=sl("Patches").applyPatches_;return il(e)?n(e,t):this.produce(e,a=>n(a,t))}};function n1(e,t){const r=kf(e)?sl("MapSet").proxyMap_(e,t):ap(e)?sl("MapSet").proxySet_(e,t):oM(e,t);return(t?t.scope_:rA()).drafts_.push(r),r}function os(e){return il(e)||vi(10,e),aA(e)}function aA(e){if(!hs(e)||ip(e))return e;const t=e[za];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Jv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Jv(e,!0);return X0(r,(a,i)=>{tA(r,a,aA(i))},n),t&&(t.finalized_=!1),r}var uM=new cM,iA=uM.produce;function sA(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var fM=sA(),dM=sA,hM=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Y0:Y0.apply(null,arguments)};function ii(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error($a(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Q4(n)&&n.type===e,r}var oA=class Vu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Vu.prototype)}static get[Symbol.species](){return Vu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Vu(...t[0].concat(this)):new Vu(...t.concat(this))}};function RN(e){return hs(e)?iA(e,()=>{}):e}function t0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function pM(e){return typeof e=="boolean"}var mM=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new oA;return r&&(pM(r)?s.push(fM):s.push(dM(r.extraArgument))),s},lA="RTK_autoBatch",ra=()=>e=>({payload:e,meta:{[lA]:!0}}),FN=e=>t=>{setTimeout(t,e)},cA=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const c=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:FN(10):e.type==="callback"?e.queueNotification:FN(e.timeout),h=()=>{s=!1,i&&(i=!1,c.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>a&&d(),x=n.subscribe(m);return c.add(d),()=>{x(),c.delete(d)}},dispatch(d){try{return a=!d?.meta?.[lA],i=!a,i&&(s||(s=!0,f(h))),n.dispatch(d)}finally{a=!0}}})},xM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new oA(e);return n&&a.push(cA(typeof n=="object"?n:void 0)),a};function gM(e){const t=mM(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(Cy(r))c=Z4(r);else throw new Error($a(1));let f;typeof n=="function"?f=n(t):f=t();let h=Y0;a&&(h=hM({trace:!1,...typeof a=="object"&&a}));const d=eM(...f),m=xM(d);let x=typeof s=="function"?s(m):m();const g=h(...x);return q4(c,i,g)}function uA(e){const t={},r=[];let n;const a={addCase(i,s){const c=typeof i=="string"?i:i.type;if(!c)throw new Error($a(28));if(c in t)throw new Error($a(29));return t[c]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function vM(e){return typeof e=="function"}function yM(e,t){let[r,n,a]=uA(t),i;if(vM(e))i=()=>RN(e());else{const c=RN(e);i=()=>c}function s(c=i(),f){let h=[r[f.type],...n.filter(({matcher:d})=>d(f)).map(({reducer:d})=>d)];return h.filter(d=>!!d).length===0&&(h=[a]),h.reduce((d,m)=>{if(m)if(il(d)){const g=m(d,f);return g===void 0?d:g}else{if(hs(d))return iA(d,x=>m(x,f));{const x=m(d,f);if(x===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return d},c)}return s.getInitialState=i,s}var wM="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",bM=(e=21)=>{let t="",r=e;for(;r--;)t+=wM[Math.random()*64|0];return t},_M=Symbol.for("rtk-slice-createasyncthunk");function SM(e,t){return`${e}/${t}`}function NM({creators:e}={}){const t=e?.asyncThunk?.[_M];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error($a(11));const s=(typeof n.reducers=="function"?n.reducers(TM()):n.reducers)||{},c=Object.keys(s),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(T,D){const O=typeof T=="string"?T:T.type;if(!O)throw new Error($a(12));if(O in f.sliceCaseReducersByType)throw new Error($a(13));return f.sliceCaseReducersByType[O]=D,h},addMatcher(T,D){return f.sliceMatchers.push({matcher:T,reducer:D}),h},exposeAction(T,D){return f.actionCreators[T]=D,h},exposeCaseReducer(T,D){return f.sliceCaseReducersByName[T]=D,h}};c.forEach(T=>{const D=s[T],O={reducerName:T,type:SM(a,T),createNotation:typeof n.reducers=="function"};CM(D)?jM(O,D,h,t):kM(O,D,h)});function d(){const[T={},D=[],O=void 0]=typeof n.extraReducers=="function"?uA(n.extraReducers):[n.extraReducers],I={...T,...f.sliceCaseReducersByType};return yM(n.initialState,j=>{for(let z in I)j.addCase(z,I[z]);for(let z of f.sliceMatchers)j.addMatcher(z.matcher,z.reducer);for(let z of D)j.addMatcher(z.matcher,z.reducer);O&&j.addDefaultCase(O)})}const m=T=>T,x=new Map,g=new WeakMap;let b;function _(T,D){return b||(b=d()),b(T,D)}function w(){return b||(b=d()),b.getInitialState()}function S(T,D=!1){function O(j){let z=j[T];return typeof z>"u"&&D&&(z=t0(g,O,w)),z}function I(j=m){const z=t0(x,D,()=>new WeakMap);return t0(z,j,()=>{const R={};for(const[q,V]of Object.entries(n.selectors??{}))R[q]=EM(V,j,()=>t0(g,j,w),D);return R})}return{reducerPath:T,getSelectors:I,get selectors(){return I(O)},selectSlice:O}}const A={name:a,reducer:_,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:w,...S(i),injectInto(T,{reducerPath:D,...O}={}){const I=D??i;return T.inject({reducerPath:I,reducer:_},O),{...A,...S(I,!0)}}};return A}}function EM(e,t,r,n){function a(i,...s){let c=t(i);return typeof c>"u"&&n&&(c=r()),e(c,...s)}return a.unwrapped=e,a}var Ha=NM();function TM(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function kM({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!AM(n))throw new Error($a(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?ii(e,s):ii(e))}function CM(e){return e._reducerDefinitionType==="asyncThunk"}function AM(e){return e._reducerDefinitionType==="reducerWithPrepare"}function jM({type:e,reducerName:t},r,n,a){if(!a)throw new Error($a(18));const{payloadCreator:i,fulfilled:s,pending:c,rejected:f,settled:h,options:d}=r,m=a(e,i,d);n.exposeAction(t,m),s&&n.addCase(m.fulfilled,s),c&&n.addCase(m.pending,c),f&&n.addCase(m.rejected,f),h&&n.addMatcher(m.settled,h),n.exposeCaseReducer(t,{fulfilled:s||r0,pending:c||r0,rejected:f||r0,settled:h||r0})}function r0(){}var PM="task",fA="listener",dA="completed",Py="cancelled",OM=`task-${Py}`,DM=`task-${dA}`,a1=`${fA}-${Py}`,IM=`${fA}-${dA}`,sp=class{constructor(e){this.code=e,this.message=`${PM} ${Py} (reason: ${e})`}name="TaskAbortError";message},Oy=(e,t)=>{if(typeof e!="function")throw new TypeError($a(32))},Q0=()=>{},hA=(e,t=Q0)=>(e.catch(t),e),pA=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),qo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Zo=e=>{if(e.aborted){const{reason:t}=e;throw new sp(t)}};function mA(e,t){let r=Q0;return new Promise((n,a)=>{const i=()=>a(new sp(e.reason));if(e.aborted){i();return}r=pA(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Q0})}var RM=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof sp?"cancelled":"rejected",error:r}}finally{t?.()}},J0=e=>t=>hA(mA(e,t).then(r=>(Zo(e),r))),xA=e=>{const t=J0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:uc}=Object,MN={},op="listenerMiddleware",FM=(e,t)=>{const r=n=>pA(e,()=>qo(n,e.reason));return(n,a)=>{Oy(n);const i=new AbortController;r(i);const s=RM(async()=>{Zo(e),Zo(i.signal);const c=await n({pause:J0(i.signal),delay:xA(i.signal),signal:i.signal});return Zo(i.signal),c},()=>qo(i,DM));return a?.autoJoin&&t.push(s.catch(Q0)),{result:J0(e)(s),cancel(){qo(i,OM)}}}},MM=(e,t)=>{const r=async(n,a)=>{Zo(t);let i=()=>{};const c=[new Promise((f,h)=>{let d=e({predicate:n,effect:(m,x)=>{x.unsubscribe(),f([m,x.getState(),x.getOriginalState()])}});i=()=>{d(),h()}})];a!=null&&c.push(new Promise(f=>setTimeout(f,a,null)));try{const f=await mA(t,Promise.race(c));return Zo(t),f}finally{i()}};return(n,a)=>hA(r(n,a))},gA=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=ii(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error($a(21));return Oy(i),{predicate:a,type:t,effect:i}},vA=uc(e=>{const{type:t,predicate:r,effect:n}=gA(e);return{id:bM(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error($a(22))}}},{withTypes:()=>vA}),LN=(e,t)=>{const{type:r,effect:n,predicate:a}=gA(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},i1=e=>{e.pending.forEach(t=>{qo(t,a1)})},LM=(e,t)=>()=>{for(const r of t.keys())i1(r);e.clear()},BN=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},yA=uc(ii(`${op}/add`),{withTypes:()=>yA}),BM=ii(`${op}/removeAll`),wA=uc(ii(`${op}/remove`),{withTypes:()=>wA}),$M=(...e)=>{console.error(`${op}/error`,...e)},Cf=(e={})=>{const t=new Map,r=new Map,n=g=>{const b=r.get(g)??0;r.set(g,b+1)},a=g=>{const b=r.get(g)??1;b===1?r.delete(g):r.set(g,b-1)},{extra:i,onError:s=$M}=e;Oy(s);const c=g=>(g.unsubscribe=()=>t.delete(g.id),t.set(g.id,g),b=>{g.unsubscribe(),b?.cancelActive&&i1(g)}),f=g=>{const b=LN(t,g)??vA(g);return c(b)};uc(f,{withTypes:()=>f});const h=g=>{const b=LN(t,g);return b&&(b.unsubscribe(),g.cancelActive&&i1(b)),!!b};uc(h,{withTypes:()=>h});const d=async(g,b,_,w)=>{const S=new AbortController,A=MM(f,S.signal),T=[];try{g.pending.add(S),n(g),await Promise.resolve(g.effect(b,uc({},_,{getOriginalState:w,condition:(D,O)=>A(D,O).then(Boolean),take:A,delay:xA(S.signal),pause:J0(S.signal),extra:i,signal:S.signal,fork:FM(S.signal,T),unsubscribe:g.unsubscribe,subscribe:()=>{t.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((D,O,I)=>{D!==S&&(qo(D,a1),I.delete(D))})},cancel:()=>{qo(S,a1),g.pending.delete(S)},throwIfCancelled:()=>{Zo(S.signal)}})))}catch(D){D instanceof sp||BN(s,D,{raisedBy:"effect"})}finally{await Promise.all(T),qo(S,IM),a(g),g.pending.delete(S)}},m=LM(t,r);return{middleware:g=>b=>_=>{if(!Q4(_))return b(_);if(yA.match(_))return f(_.payload);if(BM.match(_)){m();return}if(wA.match(_))return h(_.payload);let w=g.getState();const S=()=>{if(w===MN)throw new Error($a(23));return w};let A;try{if(A=b(_),t.size>0){const T=g.getState(),D=Array.from(t.values());for(const O of D){let I=!1;try{I=O.predicate(_,T,w)}catch(j){I=!1,BN(s,j,{raisedBy:"predicate"})}I&&d(O,_,g,S)}}}finally{w=MN}return A},startListening:f,stopListening:h,clearListeners:m}};function $a(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var UM={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},bA=Ha({name:"chartLayout",initialState:UM,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:zM,setLayout:HM,setChartSize:WM,setScale:VM}=bA.actions,KM=bA.reducer;function $N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$N(Object(r),!0).forEach(function(n){GM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GM(e,t,r){return(t=YM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YM(e){var t=XM(e,"string");return typeof t=="symbol"?t:t+""}function XM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eh=Math.PI/180,qM=e=>e*180/Math.PI,Xr=(e,t,r,n)=>({x:e+Math.cos(-eh*n)*r,y:t+Math.sin(-eh*n)*r}),_A=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},ZM=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},QM=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=ZM({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var c=(r-a)/s,f=Math.acos(c);return n>i&&(f=2*Math.PI-f),{radius:s,angle:qM(f),angleInRadian:f}},JM=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},eL=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},tL=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=QM({x:r,y:n},t),{innerRadius:s,outerRadius:c}=t;if(a<s||a>c||a===0)return null;var{startAngle:f,endAngle:h}=JM(t),d=i,m;if(f<=h){for(;d>h;)d-=360;for(;d<f;)d+=360;m=d>=f&&d<=h}else{for(;d>f;)d-=360;for(;d<h;)d+=360;m=d>=h&&d<=f}return m?UN(UN({},t),{},{radius:a,angle:eL(d,t)}):null};function SA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function zN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ri(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zN(Object(r),!0).forEach(function(n){rL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rL(e,t,r){return(t=nL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nL(e){var t=aL(e,"string");return typeof t=="symbol"?t:t+""}function aL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dr(e,t,r){return Er(e)||Er(t)?r:$i(t)?al(e,t,r):typeof t=="function"?t(e):r}var iL=(e,t,r,n,a)=>{var i,s=-1,c=(i=t?.length)!==null&&i!==void 0?i:0;if(c<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var f=0;f<c;f++){var h=f>0?r[f-1].coordinate:r[c-1].coordinate,d=r[f].coordinate,m=f>=c-1?r[0].coordinate:r[f+1].coordinate,x=void 0;if(gn(d-h)!==gn(m-d)){var g=[];if(gn(m-d)===gn(a[1]-a[0])){x=m;var b=d+a[1]-a[0];g[0]=Math.min(b,(b+h)/2),g[1]=Math.max(b,(b+h)/2)}else{x=h;var _=m+a[1]-a[0];g[0]=Math.min(d,(_+d)/2),g[1]=Math.max(d,(_+d)/2)}var w=[Math.min(d,(x+d)/2),Math.max(d,(x+d)/2)];if(e>w[0]&&e<=w[1]||e>=g[0]&&e<=g[1]){({index:s}=r[f]);break}}else{var S=Math.min(h,m),A=Math.max(h,m);if(e>(S+d)/2&&e<=(A+d)/2){({index:s}=r[f]);break}}}else if(t){for(var T=0;T<c;T++)if(T===0&&e<=(t[T].coordinate+t[T+1].coordinate)/2||T>0&&T<c-1&&e>(t[T].coordinate+t[T-1].coordinate)/2&&e<=(t[T].coordinate+t[T+1].coordinate)/2||T===c-1&&e>(t[T].coordinate+t[T-1].coordinate)/2){({index:s}=t[T]);break}}return s},sL=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:c}=t;if((c==="vertical"||c==="horizontal"&&s==="middle")&&i!=="center"&&mt(e[i]))return ri(ri({},e),{},{[i]:e[i]+(n||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&s!=="middle"&&mt(e[s]))return ri(ri({},e),{},{[s]:e[s]+(a||0)})}return e},yo=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",NA=(e,t,r,n)=>{if(n)return e.map(c=>c.coordinate);var a,i,s=e.map(c=>(c.coordinate===t&&(a=!0),c.coordinate===r&&(i=!0),c.coordinate));return a||s.push(t),i||s.push(r),s},EA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:c,isCategorical:f,categoricalDomain:h,tickCount:d,ticks:m,niceTicks:x,axisType:g}=e;if(!s)return null;var b=c==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,_=a==="category"&&s.bandwidth?s.bandwidth()/b:0;if(_=g==="angleAxis"&&i&&i.length>=2?gn(i[0]-i[1])*2*_:_,m||x){var w=(m||x||[]).map((S,A)=>{var T=n?n.indexOf(S):S;return{coordinate:s(T)+_,value:S,offset:_,index:A}});return w.filter(S=>!ai(S.coordinate))}return f&&h?h.map((S,A)=>({coordinate:s(S)+_,value:S,index:A,offset:_})):s.ticks&&d!=null?s.ticks(d).map((S,A)=>({coordinate:s(S)+_,value:S,offset:_,index:A})):s.domain().map((S,A)=>({coordinate:s(S)+_,value:n?n[S]:S,index:A,offset:_}))},HN=1e-4,oL=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-HN,i=Math.max(n[0],n[1])+HN,s=e(t[0]),c=e(t[r-1]);(s<a||s>i||c<a||c>i)&&e.domain([t[0],t[r-1]])}},lL=(e,t)=>{if(!t||t.length!==2||!mt(t[0])||!mt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!mt(e[0])||e[0]<r)&&(a[0]=r),(!mt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},cL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var c=ai(e[s][r][1])?e[s][r][0]:e[s][r][1];c>=0?(e[s][r][0]=a,e[s][r][1]=a+c,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+c,i=e[s][r][1])}},uL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=ai(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},fL={sign:cL,expand:LF,none:bc,silhouette:BF,wiggle:$F,positive:uL},dL=(e,t,r)=>{var n=fL[r],a=MF().keys(t).value((i,s)=>+dr(i,s,0)).order(qv).offset(n);return a(e)};function hL(e){return e==null?void 0:String(e)}function WN(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Er(a[t.dataKey])){var c=I4(r,"value",a[t.dataKey]);if(c)return c.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var f=dr(a,Er(s)?t.dataKey:s);return Er(f)?null:t.scale(f)}var VN=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var c=dr(i,t.dataKey,t.scale.domain()[s]);return Er(c)?null:t.scale(c)-a/2+n},pL=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},mL=e=>{var t=e.flat(2).filter(mt);return[Math.min(...t),Math.max(...t)]},xL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],gL=(e,t,r)=>{if(e!=null)return xL(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,c=s.reduce((f,h)=>{var d=SA(h,t,r),m=mL(d);return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},KN=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,GN=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cf=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=rp(t,d=>d.coordinate),i=1/0,s=1,c=a.length;s<c;s++){var f=a[s],h=a[s-1];i=Math.min((f.coordinate||0)-(h.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function YN(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return ri(ri({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Dc(e,t){if(e)return String(e);if(typeof t=="string")return t}function vL(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?tL({x:e,y:t},n):null}var yL=(e,t,r,n)=>{var a=t.find(h=>h&&h.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return ri(ri(ri({},n),Xr(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var c=a.coordinate,{angle:f}=n;return ri(ri(ri({},n),Xr(n.cx,n.cy,c,f)),{},{angle:f,radius:c})}return{x:0,y:0}},wL=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,ws=e=>e.layout.width,bs=e=>e.layout.height,bL=e=>e.layout.scale,TA=e=>e.layout.margin,lp=Ee(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),cp=Ee(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),kA="data-recharts-item-index",CA="data-recharts-item-data-key",Af=60;function XN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XN(Object(r),!0).forEach(function(n){_L(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _L(e,t,r){return(t=SL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SL(e){var t=NL(e,"string");return typeof t=="symbol"?t:t+""}function NL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EL=e=>e.brush.height;function TL(e){var t=cp(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Af;return r+a}return r},0)}function kL(e){var t=cp(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Af;return r+a}return r},0)}function CL(e){var t=lp(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function AL(e){var t=lp(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var on=Ee([ws,bs,TA,EL,TL,kL,CL,AL,X4,Y8],(e,t,r,n,a,i,s,c,f,h)=>{var d={left:(r.left||0)+a,right:(r.right||0)+i},m={top:(r.top||0)+s,bottom:(r.bottom||0)+c},x=n0(n0({},m),d),g=x.bottom;x.bottom+=n,x=sL(x,f,h);var b=e-x.left-x.right,_=t-x.top-x.bottom;return n0(n0({brushBottom:g},x),{},{width:Math.max(b,0),height:Math.max(_,0)})}),jL=Ee(on,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Dy=Ee(ws,bs,(e,t)=>({x:0,y:0,width:e,height:t})),PL=v.createContext(null),la=()=>v.useContext(PL)!=null,up=e=>e.brush,fp=Ee([up,on,TA],(e,t,r)=>({height:e.height,x:mt(e.x)?e.x:t.left,y:mt(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:mt(e.width)?e.width:t.width})),Og={},Dg={},Ig={},qN;function OL(){return qN||(qN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,c=null;const f=i!=null&&i.includes("leading"),h=i==null||i.includes("trailing"),d=()=>{c!==null&&(r.apply(s,c),s=void 0,c=null)},m=()=>{h&&d(),_()};let x=null;const g=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,m()},n)},b=()=>{x!==null&&(clearTimeout(x),x=null)},_=()=>{b(),s=void 0,c=null},w=()=>{d()},S=function(...A){if(a?.aborted)return;s=this,c=A;const T=x==null;g(),f&&T&&d()};return S.schedule=g,S.cancel=_,S.flush=w,a?.addEventListener("abort",_,{once:!0}),S}e.debounce=t})(Ig)),Ig}var ZN;function DL(){return ZN||(ZN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OL();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:c=!0,maxWait:f}=i,h=Array(2);s&&(h[0]="leading"),c&&(h[1]="trailing");let d,m=null;const x=t.debounce(function(..._){d=n.apply(this,_),m=null},a,{edges:h}),g=function(..._){return f!=null&&(m===null&&(m=Date.now()),Date.now()-m>=f)?(d=n.apply(this,_),m=Date.now(),x.cancel(),x.schedule(),d):(x.apply(this,_),d)},b=()=>(x.flush(),d);return g.cancel=x.cancel,g.flush=b,g}e.debounce=r})(Dg)),Dg}var QN;function IL(){return QN||(QN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DL();function r(n,a=0,i={}){const{leading:s=!0,trailing:c=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:c})}e.throttle=r})(Og)),Og}var Rg,JN;function RL(){return JN||(JN=1,Rg=IL().throttle),Rg}var FL=RL();const ML=ys(FL);var th=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},AA=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,c=ds(n)?e:Number(n),f=ds(a)?t:Number(a);return i&&i>0&&(c?f=c/i:f&&(c=f*i),s&&f>s&&(f=s)),{calculatedWidth:c,calculatedHeight:f}},LL={width:0,height:0,overflow:"visible"},BL={width:0,overflowX:"visible"},$L={height:0,overflowY:"visible"},UL={},zL=e=>{var{width:t,height:r}=e,n=ds(t),a=ds(r);return n&&a?LL:n?BL:a?$L:UL};function HL(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function Kn(e){return Number.isFinite(e)}function _c(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(null,arguments)}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){WL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WL(e,t,r){return(t=VL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VL(e){var t=KL(e,"string");return typeof t=="symbol"?t:t+""}function KL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jA=v.createContext({width:-1,height:-1});function PA(e){var{children:t,width:r,height:n}=e,a=v.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:v.createElement(jA.Provider,{value:a},t)}var Iy=()=>v.useContext(jA),GL=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:c,maxHeight:f,children:h,debounce:d=0,id:m,className:x,onResize:g,style:b={}}=e,_=v.useRef(null),w=v.useRef();w.current=g,v.useImperativeHandle(t,()=>_.current);var[S,A]=v.useState({containerWidth:n.width,containerHeight:n.height}),T=v.useCallback((z,R)=>{A(q=>{var V=Math.round(z),J=Math.round(R);return q.containerWidth===V&&q.containerHeight===J?q:{containerWidth:V,containerHeight:J}})},[]);v.useEffect(()=>{var z=J=>{var ue,{width:Ne,height:pe}=J[0].contentRect;T(Ne,pe),(ue=w.current)===null||ue===void 0||ue.call(w,Ne,pe)};d>0&&(z=ML(z,d,{trailing:!0,leading:!1}));var R=new ResizeObserver(z),{width:q,height:V}=_.current.getBoundingClientRect();return T(q,V),R.observe(_.current),()=>{R.disconnect()}},[T,d]);var{containerWidth:D,containerHeight:O}=S;th(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:I,calculatedHeight:j}=AA(D,O,{width:a,height:i,aspect:r,maxHeight:f});return th(I>0||j>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,j,a,i,s,c,r),v.createElement("div",{id:m?"".concat(m):void 0,className:Zt("recharts-responsive-container",x),style:tE(tE({},b),{},{width:a,height:i,minWidth:s,minHeight:c,maxHeight:f}),ref:_},v.createElement("div",{style:zL({width:a,height:i})},v.createElement(PA,{width:I,height:j},h)))}),o1=v.forwardRef((e,t)=>{var r=Iy();if(_c(r.width)&&_c(r.height))return e.children;var{width:n,height:a}=HL({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=AA(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return mt(i)&&mt(s)?v.createElement(PA,{width:i,height:s},e.children):v.createElement(GL,s1({},e,{width:n,height:a,ref:t}))}),dp=()=>{var e,t=la(),r=ft(jL),n=ft(fp),a=(e=ft(up))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},YL={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},OA=()=>{var e;return(e=ft(on))!==null&&e!==void 0?e:YL},DA=()=>ft(ws),IA=()=>ft(bs),Lt=e=>e.layout.layoutType,hp=()=>ft(Lt),pp=e=>{var t=Mr(),r=la(),{width:n,height:a}=e,i=Iy(),s=n,c=a;return i&&(s=i.width>0?i.width:n,c=i.height>0?i.height:a),v.useEffect(()=>{!r&&_c(s)&&_c(c)&&t(WM({width:s,height:c}))},[t,r,s,c]),null},XL={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},RA=Ha({name:"legend",initialState:XL,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:ra()},removeLegendPayload:{reducer(e,t){var r=os(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:ra()}}}),{setLegendSize:Jse,setLegendSettings:eoe,addLegendPayload:FA,removeLegendPayload:MA}=RA.actions,qL=RA.reducer;function l1(){return l1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l1.apply(null,arguments)}function rE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rE(Object(r),!0).forEach(function(n){ZL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZL(e,t,r){return(t=QL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QL(e){var t=JL(e,"string");return typeof t=="symbol"?t:t+""}function JL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e7(e){return Array.isArray(e)&&$i(e[0])&&$i(e[1])?e.join(" ~ "):e}var t7=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:c,wrapperClassName:f,labelClassName:h,label:d,labelFormatter:m,accessibilityLayer:x=!1}=e,g=()=>{if(i&&i.length){var O={padding:0,margin:0},I=(c?rp(i,c):i).map((j,z)=>{if(j.type==="none")return null;var R=j.formatter||s||e7,{value:q,name:V}=j,J=q,ue=V;if(R){var Ne=R(q,V,j,z,i);if(Array.isArray(Ne))[J,ue]=Ne;else if(Ne!=null)J=Ne;else return null}var pe=Fg({display:"block",paddingTop:4,paddingBottom:4,color:j.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:pe},$i(ue)?v.createElement("span",{className:"recharts-tooltip-item-name"},ue):null,$i(ue)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},J),v.createElement("span",{className:"recharts-tooltip-item-unit"},j.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:O},I)}return null},b=Fg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),_=Fg({margin:0},a),w=!Er(d),S=w?d:"",A=Zt("recharts-default-tooltip",f),T=Zt("recharts-tooltip-label",h);w&&m&&i!==void 0&&i!==null&&(S=m(d,i));var D=x?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",l1({className:A,style:b},D),v.createElement("p",{className:T,style:_},v.isValidElement(S)?S:"".concat(S)),g())},ju="recharts-tooltip-wrapper",r7={visibility:"hidden"};function n7(e){var{coordinate:t,translateX:r,translateY:n}=e;return Zt(ju,{["".concat(ju,"-right")]:mt(r)&&t&&mt(t.x)&&r>=t.x,["".concat(ju,"-left")]:mt(r)&&t&&mt(t.x)&&r<t.x,["".concat(ju,"-bottom")]:mt(n)&&t&&mt(t.y)&&n>=t.y,["".concat(ju,"-top")]:mt(n)&&t&&mt(t.y)&&n<t.y})}function nE(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:c,viewBox:f,viewBoxDimension:h}=e;if(i&&mt(i[n]))return i[n];var d=r[n]-c-(a>0?a:0),m=r[n]+a;if(t[n])return s[n]?d:m;var x=f[n];if(x==null)return 0;if(s[n]){var g=d,b=x;return g<b?Math.max(m,x):Math.max(d,x)}if(h==null)return 0;var _=m+c,w=x+h;return _>w?Math.max(d,x):Math.max(m,x)}function a7(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function i7(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:c,viewBox:f}=e,h,d,m;return s.height>0&&s.width>0&&r?(d=nE({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:f,viewBoxDimension:f.width}),m=nE({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:f,viewBoxDimension:f.height}),h=a7({translateX:d,translateY:m,useTranslate3d:c})):h=r7,{cssProperties:h,cssClasses:n7({translateX:d,translateY:m,coordinate:r})}}function aE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function a0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aE(Object(r),!0).forEach(function(n){c1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c1(e,t,r){return(t=s7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s7(e){var t=o7(e,"string");return typeof t=="symbol"?t:t+""}function o7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class l7 extends v.PureComponent{constructor(){super(...arguments),c1(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),c1(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:c,isAnimationActive:f,offset:h,position:d,reverseDirection:m,useTranslate3d:x,viewBox:g,wrapperStyle:b,lastBoundingBox:_,innerRef:w,hasPortalFromProps:S}=this.props,{cssClasses:A,cssProperties:T}=i7({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:h,position:d,reverseDirection:m,tooltipBox:{height:_.height,width:_.width},useTranslate3d:x,viewBox:g}),D=S?{}:a0(a0({transition:f&&t?"transform ".concat(n,"ms ").concat(a):void 0},T),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),O=a0(a0({},D),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},b);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:O,ref:w},i)}}var c7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),wo={devToolsEnabled:!1,isSsr:c7()},LA=()=>ft(e=>e.rootProps.accessibilityLayer);function u1(){return u1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u1.apply(null,arguments)}function iE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iE(Object(r),!0).forEach(function(n){u7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u7(e,t,r){return(t=f7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f7(e){var t=d7(e,"string");return typeof t=="symbol"?t:t+""}function d7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oE={curveBasisClosed:TF,curveBasisOpen:kF,curveBasis:EF,curveBumpX:fF,curveBumpY:dF,curveLinearClosed:CF,curveLinear:Jh,curveMonotoneX:AF,curveMonotoneY:jF,curveNatural:PF,curveStep:OF,curveStepAfter:IF,curveStepBefore:DF},i0=e=>Kn(e.x)&&Kn(e.y),Pu=e=>e.x,Ou=e=>e.y,h7=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Tf(e));return(r==="curveMonotone"||r==="curveBump")&&t?oE["".concat(r).concat(t==="vertical"?"Y":"X")]:oE[r]||Jh},p7=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=h7(t,a),c=i?r.filter(i0):r,f;if(Array.isArray(n)){var h=i?n.filter(m=>i0(m)):n,d=c.map((m,x)=>sE(sE({},m),{},{base:h[x]}));return a==="vertical"?f=Zd().y(Ou).x1(Pu).x0(m=>m.base.x):f=Zd().x(Pu).y1(Ou).y0(m=>m.base.y),f.defined(i0).curve(s),f(d)}return a==="vertical"&&mt(n)?f=Zd().y(Ou).x1(Pu).x0(n):mt(n)?f=Zd().x(Pu).y1(Ou).y0(n):f=b4().x(Pu).y(Ou),f.defined(i0).curve(s),f(c)},Ry=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?p7(e):n;return v.createElement("path",u1({},Ua(e),Ey(e),{className:Zt("recharts-curve",t),d:i===null?void 0:i,ref:a}))},m7=["x","y","top","left","width","height","className"];function f1(){return f1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f1.apply(null,arguments)}function lE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lE(Object(r),!0).forEach(function(n){g7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g7(e,t,r){return(t=v7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v7(e){var t=y7(e,"string");return typeof t=="symbol"?t:t+""}function y7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w7(e,t){if(e==null)return{};var r,n,a=b7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _7=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),S7=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:c}=e,f=w7(e,m7),h=x7({x:t,y:r,top:n,left:a,width:i,height:s},f);return!mt(t)||!mt(r)||!mt(i)||!mt(s)||!mt(n)||!mt(a)?null:v.createElement("path",f1({},oa(h),{className:Zt("recharts-cross",c),d:_7(t,r,i,s,n,a)}))};function N7(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function cE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(r),!0).forEach(function(n){T7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T7(e,t,r){return(t=k7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k7(e){var t=C7(e,"string");return typeof t=="symbol"?t:t+""}function C7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jn(e,t){var r=E7({},e),n=t,a=Object.keys(t),i=a.reduce((s,c)=>(s[c]===void 0&&n[c]!==void 0&&(s[c]=n[c]),s),r);return i}function A7(){}function j7(e){return e!=null}function uE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uE(Object(r),!0).forEach(function(n){P7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P7(e,t,r){return(t=O7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O7(e){var t=D7(e,"string");return typeof t=="symbol"?t:t+""}function D7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I7=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),BA=(e,t,r)=>e.map(n=>"".concat(I7(n)," ").concat(t,"ms ").concat(r)).join(","),R7=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),uf=(e,t)=>Object.keys(t).reduce((r,n)=>fE(fE({},r),{},{[n]:e(n,t[n])}),{});function dE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dE(Object(r),!0).forEach(function(n){F7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F7(e,t,r){return(t=M7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7(e){var t=L7(e,"string");return typeof t=="symbol"?t:t+""}function L7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rh=(e,t,r)=>e+(t-e)*r,d1=e=>{var{from:t,to:r}=e;return t!==r},$A=(e,t,r)=>{var n=uf((a,i)=>{if(d1(i)){var[s,c]=e(i.from,i.to,i.velocity);return Nn(Nn({},i),{},{from:s,velocity:c})}return i},t);return r<1?uf((a,i)=>d1(i)?Nn(Nn({},i),{},{velocity:rh(i.velocity,n[a].velocity,r),from:rh(i.from,n[a].from,r)}):i,t):$A(e,n,r-1)};function B7(e,t,r,n,a,i){var s,c=n.reduce((x,g)=>Nn(Nn({},x),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),f=()=>uf((x,g)=>g.from,c),h=()=>!Object.values(c).filter(d1).length,d=null,m=x=>{s||(s=x);var g=x-s,b=g/r.dt;c=$A(r,c,b),a(Nn(Nn(Nn({},e),t),f())),s=x,h()||(d=i.setTimeout(m))};return()=>(d=i.setTimeout(m),()=>{d()})}function $7(e,t,r,n,a,i,s){var c=null,f=a.reduce((m,x)=>Nn(Nn({},m),{},{[x]:[e[x],t[x]]}),{}),h,d=m=>{h||(h=m);var x=(m-h)/n,g=uf((_,w)=>rh(...w,r(x)),f);if(i(Nn(Nn(Nn({},e),t),g)),x<1)c=s.setTimeout(d);else{var b=uf((_,w)=>rh(...w,r(1)),f);i(Nn(Nn(Nn({},e),t),b))}};return()=>(c=s.setTimeout(d),()=>{c()})}const U7=(e,t,r,n,a,i)=>{var s=R7(e,t);return r.isStepper===!0?B7(e,t,r,s,a,i):$7(e,t,r,n,s,a,i)};var nh=1e-4,UA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],zA=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),hE=(e,t)=>r=>{var n=UA(e,t);return zA(n,r)},z7=(e,t)=>r=>{var n=UA(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return zA(a,r)},pE=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var f=s[0].split("(");f[0]==="cubic-bezier"&&f[1].split(")")[0].split(",").length===4&&([t,n,r,a]=f[1].split(")")[0].split(",").map(b=>parseFloat(b)))}}else s.length===4&&([t,n,r,a]=s);var h=hE(t,r),d=hE(n,a),m=z7(t,r),x=b=>b>1?1:b<0?0:b,g=b=>{for(var _=b>1?1:b,w=_,S=0;S<8;++S){var A=h(w)-_,T=m(w);if(Math.abs(A-_)<nh||T<nh)return d(w);w=x(w-A/T)}return d(w)};return g.isStepper=!1,g},H7=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,c,f)=>{var h=-(s-c)*r,d=f*n,m=f+(h-d)*a/1e3,x=f*a/1e3+s;return Math.abs(x-c)<nh&&Math.abs(m)<nh?[c,0]:[x,m]};return i.isStepper=!0,i.dt=a,i},W7=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return pE(e);case"spring":return H7();default:if(e.split("(")[0]==="cubic-bezier")return pE(e)}return typeof e=="function"?e:null};function V7(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var c=s,[f,...h]=c;if(typeof f=="number"){a=e.setTimeout(i.bind(null,h),f);return}i(f),a=e.setTimeout(i.bind(null,h));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class K7{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function G7(){return V7(new K7)}var Y7=v.createContext(G7);function X7(e,t){var r=v.useContext(Y7);return v.useMemo(()=>t??r(e),[e,t,r])}var q7={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},mE={t:0},Mg={t:1};function jf(e){var t=jn(e,q7),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:c,onAnimationStart:f,children:h}=t,d=X7(t.animationId,t.animationManager),[m,x]=v.useState(r?mE:Mg),g=v.useRef(null);return v.useEffect(()=>{r||x(Mg)},[r]),v.useEffect(()=>{if(!r||!n)return A7;var b=U7(mE,Mg,W7(i),a,x,d.getTimeoutController()),_=()=>{g.current=b()};return d.start([f,s,_,a,c]),()=>{d.stop(),g.current&&g.current(),c()}},[r,n,a,i,s,f,c,d]),h(m.t)}function Pf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(af(t)),n=v.useRef(e);return n.current!==e&&(r.current=af(t),n.current=e),r.current}var Z7=["radius"],Q7=["radius"];function xE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xE(Object(r),!0).forEach(function(n){J7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J7(e,t,r){return(t=e9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e9(e){var t=t9(e,"string");return typeof t=="symbol"?t:t+""}function t9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ah(){return ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ah.apply(null,arguments)}function vE(e,t){if(e==null)return{};var r,n,a=r9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function r9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yE=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,c=r>=0?1:-1,f=n>=0&&r>=0||n<0&&r<0?1:0,h;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],m=0,x=4;m<x;m++)d[m]=a[m]>i?i:a[m];h="M".concat(e,",").concat(t+s*d[0]),d[0]>0&&(h+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(f,",").concat(e+c*d[0],",").concat(t)),h+="L ".concat(e+r-c*d[1],",").concat(t),d[1]>0&&(h+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(f,`,
        `).concat(e+r,",").concat(t+s*d[1])),h+="L ".concat(e+r,",").concat(t+n-s*d[2]),d[2]>0&&(h+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(f,`,
        `).concat(e+r-c*d[2],",").concat(t+n)),h+="L ".concat(e+c*d[3],",").concat(t+n),d[3]>0&&(h+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(f,`,
        `).concat(e,",").concat(t+n-s*d[3])),h+="Z"}else if(i>0&&a===+a&&a>0){var g=Math.min(i,a);h="M ".concat(e,",").concat(t+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+c*g,",").concat(t,`
            L `).concat(e+r-c*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r,",").concat(t+s*g,`
            L `).concat(e+r,",").concat(t+n-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e+r-c*g,",").concat(t+n,`
            L `).concat(e+c*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(f,",").concat(e,",").concat(t+n-s*g," Z")}else h="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return h},n9={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},HA=e=>{var t=jn(e,n9),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var xe=r.current.getTotalLength();xe&&a(xe)}catch{}},[]);var{x:i,y:s,width:c,height:f,radius:h,className:d}=t,{animationEasing:m,animationDuration:x,animationBegin:g,isAnimationActive:b,isUpdateAnimationActive:_}=t,w=v.useRef(c),S=v.useRef(f),A=v.useRef(i),T=v.useRef(s),D=v.useMemo(()=>({x:i,y:s,width:c,height:f,radius:h}),[i,s,c,f,h]),O=Pf(D,"rectangle-");if(i!==+i||s!==+s||c!==+c||f!==+f||c===0||f===0)return null;var I=Zt("recharts-rectangle",d);if(!_){var j=oa(t),{radius:z}=j,R=vE(j,Z7);return v.createElement("path",ah({},R,{radius:typeof h=="number"?h:void 0,className:I,d:yE(i,s,c,f,h)}))}var q=w.current,V=S.current,J=A.current,ue=T.current,Ne="0px ".concat(n===-1?1:n,"px"),pe="".concat(n,"px 0px"),Ie=BA(["strokeDasharray"],x,typeof m=="string"?m:void 0);return v.createElement(jf,{animationId:O,key:O,canBegin:n>0,duration:x,easing:m,isActive:_,begin:g},xe=>{var ye=Fr(q,c,xe),ge=Fr(V,f,xe),Oe=Fr(J,i,xe),ie=Fr(ue,s,xe);r.current&&(w.current=ye,S.current=ge,A.current=Oe,T.current=ie);var he;b?xe>0?he={transition:Ie,strokeDasharray:pe}:he={strokeDasharray:Ne}:he={strokeDasharray:pe};var De=oa(t),{radius:We}=De,Ve=vE(De,Q7);return v.createElement("path",ah({},Ve,{radius:typeof h=="number"?h:void 0,className:I,d:yE(Oe,ie,ye,ge,h),ref:r,style:gE(gE({},he),t.style)}))})};function WA(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Xr(t,r,n,a),c=Xr(t,r,n,i);return{points:[s,c],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function h1(){return h1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h1.apply(null,arguments)}var a9=(e,t)=>{var r=gn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},s0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:c,cornerIsExternal:f}=e,h=c*(s?1:-1)+n,d=Math.asin(c/h)/eh,m=f?a:a+i*d,x=Xr(t,r,h,m),g=Xr(t,r,n,m),b=f?a-i*d:a,_=Xr(t,r,h*Math.cos(d*eh),b);return{center:x,circleTangency:g,lineTangency:_,theta:d}},VA=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,c=a9(i,s),f=i+c,h=Xr(t,r,a,i),d=Xr(t,r,a,f),m="M ".concat(h.x,",").concat(h.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>f),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var x=Xr(t,r,n,i),g=Xr(t,r,n,f);m+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=f),`,
            `).concat(x.x,",").concat(x.y," Z")}else m+="L ".concat(t,",").concat(r," Z");return m},i9=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:c,startAngle:f,endAngle:h}=e,d=gn(h-f),{circleTangency:m,lineTangency:x,theta:g}=s0({cx:t,cy:r,radius:a,angle:f,sign:d,cornerRadius:i,cornerIsExternal:c}),{circleTangency:b,lineTangency:_,theta:w}=s0({cx:t,cy:r,radius:a,angle:h,sign:-d,cornerRadius:i,cornerIsExternal:c}),S=c?Math.abs(f-h):Math.abs(f-h)-g-w;if(S<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):VA({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:f,endAngle:h});var A="M ".concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(S>180),",").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(_.x,",").concat(_.y,`
  `);if(n>0){var{circleTangency:T,lineTangency:D,theta:O}=s0({cx:t,cy:r,radius:n,angle:f,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:I,lineTangency:j,theta:z}=s0({cx:t,cy:r,radius:n,angle:h,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),R=c?Math.abs(f-h):Math.abs(f-h)-O-z;if(R<0&&i===0)return"".concat(A,"L").concat(t,",").concat(r,"Z");A+="L".concat(j.x,",").concat(j.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(I.x,",").concat(I.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(R>180),",").concat(+(d>0),",").concat(T.x,",").concat(T.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(D.x,",").concat(D.y,"Z")}else A+="L".concat(t,",").concat(r,"Z");return A},s9={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},KA=e=>{var t=jn(e,s9),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:c,cornerIsExternal:f,startAngle:h,endAngle:d,className:m}=t;if(i<a||h===d)return null;var x=Zt("recharts-sector",m),g=i-a,b=Hn(s,g,0,!0),_;return b>0&&Math.abs(h-d)<360?_=i9({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(b,g/2),forceCornerRadius:c,cornerIsExternal:f,startAngle:h,endAngle:d}):_=VA({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:h,endAngle:d}),v.createElement("path",h1({},oa(t),{className:x,d:_}))};function o9(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:c,cy:f,innerRadius:h,outerRadius:d,angle:m}=t,x=Xr(c,f,h,m),g=Xr(c,f,d,m);n=x.x,a=x.y,i=g.x,s=g.y}else return WA(t);return[{x:n,y:a},{x:i,y:s}]}var Lg={},Bg={},$g={},wE;function l9(){return wE||(wE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G4();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})($g)),$g}var bE;function c9(){return bE||(bE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l9();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Bg)),Bg}var _E;function u9(){return _E||(_E=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y4(),r=c9();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const c=Math.max(Math.ceil((i-a)/(s||1)),0),f=new Array(c);for(let h=0;h<c;h++)f[h]=a,a+=s;return f}e.range=n})(Lg)),Lg}var Ug,SE;function f9(){return SE||(SE=1,Ug=u9().range),Ug}var d9=f9();const GA=ys(d9);function ao(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function h9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Fy(e){let t,r,n;e.length!==2?(t=ao,r=(c,f)=>ao(e(c),f),n=(c,f)=>e(c)-f):(t=e===ao||e===h9?e:p9,r=e,n=e);function a(c,f,h=0,d=c.length){if(h<d){if(t(f,f)!==0)return d;do{const m=h+d>>>1;r(c[m],f)<0?h=m+1:d=m}while(h<d)}return h}function i(c,f,h=0,d=c.length){if(h<d){if(t(f,f)!==0)return d;do{const m=h+d>>>1;r(c[m],f)<=0?h=m+1:d=m}while(h<d)}return h}function s(c,f,h=0,d=c.length){const m=a(c,f,h,d-1);return m>h&&n(c[m-1],f)>-n(c[m],f)?m-1:m}return{left:a,center:s,right:i}}function p9(){return 0}function YA(e){return e===null?NaN:+e}function*m9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const x9=Fy(ao),Of=x9.right;Fy(YA).center;class NE extends Map{constructor(t,r=y9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(EE(this,t))}has(t){return super.has(EE(this,t))}set(t,r){return super.set(g9(this,t),r)}delete(t){return super.delete(v9(this,t))}}function EE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function g9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function v9({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function y9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function w9(e=ao){if(e===ao)return XA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function XA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const b9=Math.sqrt(50),_9=Math.sqrt(10),S9=Math.sqrt(2);function ih(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=b9?10:i>=_9?5:i>=S9?2:1;let c,f,h;return a<0?(h=Math.pow(10,-a)/s,c=Math.round(e*h),f=Math.round(t*h),c/h<e&&++c,f/h>t&&--f,h=-h):(h=Math.pow(10,a)*s,c=Math.round(e/h),f=Math.round(t/h),c*h<e&&++c,f*h>t&&--f),f<c&&.5<=r&&r<2?ih(e,t,r*2):[c,f,h]}function p1(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?ih(t,e,r):ih(e,t,r);if(!(i>=a))return[];const c=i-a+1,f=new Array(c);if(n)if(s<0)for(let h=0;h<c;++h)f[h]=(i-h)/-s;else for(let h=0;h<c;++h)f[h]=(i-h)*s;else if(s<0)for(let h=0;h<c;++h)f[h]=(a+h)/-s;else for(let h=0;h<c;++h)f[h]=(a+h)*s;return f}function m1(e,t,r){return t=+t,e=+e,r=+r,ih(e,t,r)[2]}function x1(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?m1(t,e,r):m1(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function TE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function kE(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function qA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?XA:w9(a);n>r;){if(n-r>600){const f=n-r+1,h=t-r+1,d=Math.log(f),m=.5*Math.exp(2*d/3),x=.5*Math.sqrt(d*m*(f-m)/f)*(h-f/2<0?-1:1),g=Math.max(r,Math.floor(t-h*m/f+x)),b=Math.min(n,Math.floor(t+(f-h)*m/f+x));qA(e,t,g,b,a)}const i=e[t];let s=r,c=n;for(Du(e,r,t),a(e[n],i)>0&&Du(e,r,n);s<c;){for(Du(e,s,c),++s,--c;a(e[s],i)<0;)++s;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?Du(e,r,c):(++c,Du(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function Du(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function N9(e,t,r){if(e=Float64Array.from(m9(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return kE(e);if(t>=1)return TE(e);var n,a=(n-1)*t,i=Math.floor(a),s=TE(qA(e,i).subarray(0,i+1)),c=kE(e.subarray(i+1));return s+(c-s)*(a-i)}}function E9(e,t,r=YA){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return s+(c-s)*(a-i)}}function T9(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function oi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function _s(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const g1=Symbol("implicit");function My(){var e=new NE,t=[],r=[],n=g1;function a(i){let s=e.get(i);if(s===void 0){if(n!==g1)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new NE;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return My(t,r).unknown(n)},oi.apply(a,arguments),a}function Ly(){var e=My().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,c=!1,f=0,h=0,d=.5;delete e.unknown;function m(){var x=t().length,g=a<n,b=g?a:n,_=g?n:a;i=(_-b)/Math.max(1,x-f+h*2),c&&(i=Math.floor(i)),b+=(_-b-i*(x-f))*d,s=i*(1-f),c&&(b=Math.round(b),s=Math.round(s));var w=T9(x).map(function(S){return b+i*S});return r(g?w.reverse():w)}return e.domain=function(x){return arguments.length?(t(x),m()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,m()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,c=!0,m()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(x){return arguments.length?(c=!!x,m()):c},e.padding=function(x){return arguments.length?(f=Math.min(1,h=+x),m()):f},e.paddingInner=function(x){return arguments.length?(f=Math.min(1,x),m()):f},e.paddingOuter=function(x){return arguments.length?(h=+x,m()):h},e.align=function(x){return arguments.length?(d=Math.max(0,Math.min(1,x)),m()):d},e.copy=function(){return Ly(t(),[n,a]).round(c).paddingInner(f).paddingOuter(h).align(d)},oi.apply(m(),arguments)}function ZA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ZA(t())},e}function k9(){return ZA(Ly.apply(null,arguments).paddingInner(1))}function By(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function QA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Df(){}var ff=.7,sh=1/ff,fc="\\s*([+-]?\\d+)\\s*",df="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Li="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",C9=/^#([0-9a-f]{3,8})$/,A9=new RegExp(`^rgb\\(${fc},${fc},${fc}\\)$`),j9=new RegExp(`^rgb\\(${Li},${Li},${Li}\\)$`),P9=new RegExp(`^rgba\\(${fc},${fc},${fc},${df}\\)$`),O9=new RegExp(`^rgba\\(${Li},${Li},${Li},${df}\\)$`),D9=new RegExp(`^hsl\\(${df},${Li},${Li}\\)$`),I9=new RegExp(`^hsla\\(${df},${Li},${Li},${df}\\)$`),CE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};By(Df,hf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:AE,formatHex:AE,formatHex8:R9,formatHsl:F9,formatRgb:jE,toString:jE});function AE(){return this.rgb().formatHex()}function R9(){return this.rgb().formatHex8()}function F9(){return JA(this).formatHsl()}function jE(){return this.rgb().formatRgb()}function hf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=C9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?PE(t):r===3?new _a(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?o0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?o0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=A9.exec(e))?new _a(t[1],t[2],t[3],1):(t=j9.exec(e))?new _a(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=P9.exec(e))?o0(t[1],t[2],t[3],t[4]):(t=O9.exec(e))?o0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=D9.exec(e))?IE(t[1],t[2]/100,t[3]/100,1):(t=I9.exec(e))?IE(t[1],t[2]/100,t[3]/100,t[4]):CE.hasOwnProperty(e)?PE(CE[e]):e==="transparent"?new _a(NaN,NaN,NaN,0):null}function PE(e){return new _a(e>>16&255,e>>8&255,e&255,1)}function o0(e,t,r,n){return n<=0&&(e=t=r=NaN),new _a(e,t,r,n)}function M9(e){return e instanceof Df||(e=hf(e)),e?(e=e.rgb(),new _a(e.r,e.g,e.b,e.opacity)):new _a}function v1(e,t,r,n){return arguments.length===1?M9(e):new _a(e,t,r,n??1)}function _a(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}By(_a,v1,QA(Df,{brighter(e){return e=e==null?sh:Math.pow(sh,e),new _a(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ff:Math.pow(ff,e),new _a(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _a(Qo(this.r),Qo(this.g),Qo(this.b),oh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:OE,formatHex:OE,formatHex8:L9,formatRgb:DE,toString:DE}));function OE(){return`#${Ko(this.r)}${Ko(this.g)}${Ko(this.b)}`}function L9(){return`#${Ko(this.r)}${Ko(this.g)}${Ko(this.b)}${Ko((isNaN(this.opacity)?1:this.opacity)*255)}`}function DE(){const e=oh(this.opacity);return`${e===1?"rgb(":"rgba("}${Qo(this.r)}, ${Qo(this.g)}, ${Qo(this.b)}${e===1?")":`, ${e})`}`}function oh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ko(e){return e=Qo(e),(e<16?"0":"")+e.toString(16)}function IE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new yi(e,t,r,n)}function JA(e){if(e instanceof yi)return new yi(e.h,e.s,e.l,e.opacity);if(e instanceof Df||(e=hf(e)),!e)return new yi;if(e instanceof yi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,c=i-a,f=(i+a)/2;return c?(t===i?s=(r-n)/c+(r<n)*6:r===i?s=(n-t)/c+2:s=(t-r)/c+4,c/=f<.5?i+a:2-i-a,s*=60):c=f>0&&f<1?0:s,new yi(s,c,f,e.opacity)}function B9(e,t,r,n){return arguments.length===1?JA(e):new yi(e,t,r,n??1)}function yi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}By(yi,B9,QA(Df,{brighter(e){return e=e==null?sh:Math.pow(sh,e),new yi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ff:Math.pow(ff,e),new yi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new _a(zg(e>=240?e-240:e+120,a,n),zg(e,a,n),zg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new yi(RE(this.h),l0(this.s),l0(this.l),oh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=oh(this.opacity);return`${e===1?"hsl(":"hsla("}${RE(this.h)}, ${l0(this.s)*100}%, ${l0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function RE(e){return e=(e||0)%360,e<0?e+360:e}function l0(e){return Math.max(0,Math.min(1,e||0))}function zg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const $y=e=>()=>e;function $9(e,t){return function(r){return e+r*t}}function U9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function z9(e){return(e=+e)==1?ej:function(t,r){return r-t?U9(t,r,e):$y(isNaN(t)?r:t)}}function ej(e,t){var r=t-e;return r?$9(e,r):$y(isNaN(e)?t:e)}const FE=(function e(t){var r=z9(t);function n(a,i){var s=r((a=v1(a)).r,(i=v1(i)).r),c=r(a.g,i.g),f=r(a.b,i.b),h=ej(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=c(d),a.b=f(d),a.opacity=h(d),a+""}}return n.gamma=e,n})(1);function H9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function W9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function V9(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Ic(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(c){for(s=0;s<n;++s)i[s]=a[s](c);return i}}function K9(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function lh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function G9(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Ic(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var y1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hg=new RegExp(y1.source,"g");function Y9(e){return function(){return e}}function X9(e){return function(t){return e(t)+""}}function q9(e,t){var r=y1.lastIndex=Hg.lastIndex=0,n,a,i,s=-1,c=[],f=[];for(e=e+"",t=t+"";(n=y1.exec(e))&&(a=Hg.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[s]?c[s]+=i:c[++s]=i),(n=n[0])===(a=a[0])?c[s]?c[s]+=a:c[++s]=a:(c[++s]=null,f.push({i:s,x:lh(n,a)})),r=Hg.lastIndex;return r<t.length&&(i=t.slice(r),c[s]?c[s]+=i:c[++s]=i),c.length<2?f[0]?X9(f[0].x):Y9(t):(t=f.length,function(h){for(var d=0,m;d<t;++d)c[(m=f[d]).i]=m.x(h);return c.join("")})}function Ic(e,t){var r=typeof t,n;return t==null||r==="boolean"?$y(t):(r==="number"?lh:r==="string"?(n=hf(t))?(t=n,FE):q9:t instanceof hf?FE:t instanceof Date?K9:W9(t)?H9:Array.isArray(t)?V9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?G9:lh)(e,t)}function Uy(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Z9(e,t){t===void 0&&(t=e,e=Ic);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var c=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[c](s-c)}}function Q9(e){return function(){return e}}function ch(e){return+e}var ME=[0,1];function aa(e){return e}function w1(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Q9(isNaN(t)?NaN:.5)}function J9(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function eB(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=w1(a,n),i=r(s,i)):(n=w1(n,a),i=r(i,s)),function(c){return i(n(c))}}function tB(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=w1(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(c){var f=Of(e,c,1,n)-1;return i[f](a[f](c))}}function If(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function mp(){var e=ME,t=ME,r=Ic,n,a,i,s=aa,c,f,h;function d(){var x=Math.min(e.length,t.length);return s!==aa&&(s=J9(e[0],e[x-1])),c=x>2?tB:eB,f=h=null,m}function m(x){return x==null||isNaN(x=+x)?i:(f||(f=c(e.map(n),t,r)))(n(s(x)))}return m.invert=function(x){return s(a((h||(h=c(t,e.map(n),lh)))(x)))},m.domain=function(x){return arguments.length?(e=Array.from(x,ch),d()):e.slice()},m.range=function(x){return arguments.length?(t=Array.from(x),d()):t.slice()},m.rangeRound=function(x){return t=Array.from(x),r=Uy,d()},m.clamp=function(x){return arguments.length?(s=x?!0:aa,d()):s!==aa},m.interpolate=function(x){return arguments.length?(r=x,d()):r},m.unknown=function(x){return arguments.length?(i=x,m):i},function(x,g){return n=x,a=g,d()}}function zy(){return mp()(aa,aa)}function rB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function uh(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Sc(e){return e=uh(Math.abs(e)),e?e[1]:NaN}function nB(e,t){return function(r,n){for(var a=r.length,i=[],s=0,c=e[0],f=0;a>0&&c>0&&(f+c+1>n&&(c=Math.max(1,n-f)),i.push(r.substring(a-=c,a+c)),!((f+=c+1)>n));)c=e[s=(s+1)%e.length];return i.reverse().join(t)}}function aB(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var iB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pf(e){if(!(t=iB.exec(e)))throw new Error("invalid format: "+e);var t;return new Hy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}pf.prototype=Hy.prototype;function Hy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Hy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sB(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var tj;function oB(e,t){var r=uh(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(tj=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+uh(e,Math.max(0,t+i-1))[0]}function LE(e,t){var r=uh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const BE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>LE(e*100,t),r:LE,s:oB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function $E(e){return e}var UE=Array.prototype.map,zE=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lB(e){var t=e.grouping===void 0||e.thousands===void 0?$E:nB(UE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?$E:aB(UE.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function h(m){m=pf(m);var x=m.fill,g=m.align,b=m.sign,_=m.symbol,w=m.zero,S=m.width,A=m.comma,T=m.precision,D=m.trim,O=m.type;O==="n"?(A=!0,O="g"):BE[O]||(T===void 0&&(T=12),D=!0,O="g"),(w||x==="0"&&g==="=")&&(w=!0,x="0",g="=");var I=_==="$"?r:_==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",j=_==="$"?n:/[%p]/.test(O)?s:"",z=BE[O],R=/[defgprs%]/.test(O);T=T===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,T)):Math.max(0,Math.min(20,T));function q(V){var J=I,ue=j,Ne,pe,Ie;if(O==="c")ue=z(V)+ue,V="";else{V=+V;var xe=V<0||1/V<0;if(V=isNaN(V)?f:z(Math.abs(V),T),D&&(V=sB(V)),xe&&+V==0&&b!=="+"&&(xe=!1),J=(xe?b==="("?b:c:b==="-"||b==="("?"":b)+J,ue=(O==="s"?zE[8+tj/3]:"")+ue+(xe&&b==="("?")":""),R){for(Ne=-1,pe=V.length;++Ne<pe;)if(Ie=V.charCodeAt(Ne),48>Ie||Ie>57){ue=(Ie===46?a+V.slice(Ne+1):V.slice(Ne))+ue,V=V.slice(0,Ne);break}}}A&&!w&&(V=t(V,1/0));var ye=J.length+V.length+ue.length,ge=ye<S?new Array(S-ye+1).join(x):"";switch(A&&w&&(V=t(ge+V,ge.length?S-ue.length:1/0),ge=""),g){case"<":V=J+V+ue+ge;break;case"=":V=J+ge+V+ue;break;case"^":V=ge.slice(0,ye=ge.length>>1)+J+V+ue+ge.slice(ye);break;default:V=ge+J+V+ue;break}return i(V)}return q.toString=function(){return m+""},q}function d(m,x){var g=h((m=pf(m),m.type="f",m)),b=Math.max(-8,Math.min(8,Math.floor(Sc(x)/3)))*3,_=Math.pow(10,-b),w=zE[8+b/3];return function(S){return g(_*S)+w}}return{format:h,formatPrefix:d}}var c0,Wy,rj;cB({thousands:",",grouping:[3],currency:["$",""]});function cB(e){return c0=lB(e),Wy=c0.format,rj=c0.formatPrefix,c0}function uB(e){return Math.max(0,-Sc(Math.abs(e)))}function fB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Sc(t)/3)))*3-Sc(Math.abs(e)))}function dB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Sc(t)-Sc(e))+1}function nj(e,t,r,n){var a=x1(e,t,r),i;switch(n=pf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=fB(a,s))&&(n.precision=i),rj(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=dB(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=uB(a))&&(n.precision=i-(n.type==="%")*2);break}}return Wy(n)}function bo(e){var t=e.domain;return e.ticks=function(r){var n=t();return p1(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return nj(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],c=n[i],f,h,d=10;for(c<s&&(h=s,s=c,c=h,h=a,a=i,i=h);d-- >0;){if(h=m1(s,c,r),h===f)return n[a]=s,n[i]=c,t(n);if(h>0)s=Math.floor(s/h)*h,c=Math.ceil(c/h)*h;else if(h<0)s=Math.ceil(s*h)/h,c=Math.floor(c*h)/h;else break;f=h}return e},e}function aj(){var e=zy();return e.copy=function(){return If(e,aj())},oi.apply(e,arguments),bo(e)}function ij(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,ch),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return ij(e).unknown(t)},e=arguments.length?Array.from(e,ch):[0,1],bo(r)}function sj(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function HE(e){return Math.log(e)}function WE(e){return Math.exp(e)}function hB(e){return-Math.log(-e)}function pB(e){return-Math.exp(-e)}function mB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xB(e){return e===10?mB:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function VE(e){return(t,r)=>-e(-t,r)}function Vy(e){const t=e(HE,WE),r=t.domain;let n=10,a,i;function s(){return a=gB(n),i=xB(n),r()[0]<0?(a=VE(a),i=VE(i),e(hB,pB)):e(HE,WE),t}return t.base=function(c){return arguments.length?(n=+c,s()):n},t.domain=function(c){return arguments.length?(r(c),s()):r()},t.ticks=c=>{const f=r();let h=f[0],d=f[f.length-1];const m=d<h;m&&([h,d]=[d,h]);let x=a(h),g=a(d),b,_;const w=c==null?10:+c;let S=[];if(!(n%1)&&g-x<w){if(x=Math.floor(x),g=Math.ceil(g),h>0){for(;x<=g;++x)for(b=1;b<n;++b)if(_=x<0?b/i(-x):b*i(x),!(_<h)){if(_>d)break;S.push(_)}}else for(;x<=g;++x)for(b=n-1;b>=1;--b)if(_=x>0?b/i(-x):b*i(x),!(_<h)){if(_>d)break;S.push(_)}S.length*2<w&&(S=p1(h,d,w))}else S=p1(x,g,Math.min(g-x,w)).map(i);return m?S.reverse():S},t.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=pf(f)).precision==null&&(f.trim=!0),f=Wy(f)),c===1/0)return f;const h=Math.max(1,n*c/t.ticks().length);return d=>{let m=d/i(Math.round(a(d)));return m*n<n-.5&&(m*=n),m<=h?f(d):""}},t.nice=()=>r(sj(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function oj(){const e=Vy(mp()).domain([1,10]);return e.copy=()=>If(e,oj()).base(e.base()),oi.apply(e,arguments),e}function KE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function GE(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ky(e){var t=1,r=e(KE(t),GE(t));return r.constant=function(n){return arguments.length?e(KE(t=+n),GE(t)):t},bo(r)}function lj(){var e=Ky(mp());return e.copy=function(){return If(e,lj()).constant(e.constant())},oi.apply(e,arguments)}function YE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yB(e){return e<0?-e*e:e*e}function Gy(e){var t=e(aa,aa),r=1;function n(){return r===1?e(aa,aa):r===.5?e(vB,yB):e(YE(r),YE(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},bo(t)}function Yy(){var e=Gy(mp());return e.copy=function(){return If(e,Yy()).exponent(e.exponent())},oi.apply(e,arguments),e}function wB(){return Yy.apply(null,arguments).exponent(.5)}function XE(e){return Math.sign(e)*e*e}function bB(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function cj(){var e=zy(),t=[0,1],r=!1,n;function a(i){var s=bB(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(XE(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,ch)).map(XE)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return cj(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},oi.apply(a,arguments),bo(a)}function uj(){var e=[],t=[],r=[],n;function a(){var s=0,c=Math.max(1,t.length);for(r=new Array(c-1);++s<c;)r[s-1]=E9(e,s/c);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Of(r,s)]}return i.invertExtent=function(s){var c=t.indexOf(s);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let c of s)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ao),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return uj().domain(e).range(t).unknown(n)},oi.apply(i,arguments)}function fj(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(f){return f!=null&&f<=f?a[Of(n,f,0,r)]:i}function c(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return s}return s.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,c()):[e,t]},s.range=function(f){return arguments.length?(r=(a=Array.from(f)).length-1,c()):a.slice()},s.invertExtent=function(f){var h=a.indexOf(f);return h<0?[NaN,NaN]:h<1?[e,n[0]]:h>=r?[n[r-1],t]:[n[h-1],n[h]]},s.unknown=function(f){return arguments.length&&(i=f),s},s.thresholds=function(){return n.slice()},s.copy=function(){return fj().domain([e,t]).range(a).unknown(i)},oi.apply(bo(s),arguments)}function dj(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Of(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return dj().domain(e).range(t).unknown(r)},oi.apply(a,arguments)}const Wg=new Date,Vg=new Date;function ln(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),c=a.ceil(i);return i-s<c-i?s:c},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,c)=>{const f=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<s)||!(c>0))return f;let h;do f.push(h=new Date(+i)),t(i,c),e(i);while(h<i&&i<s);return f},a.filter=i=>ln(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,c)=>{if(s>=s)if(c<0)for(;++c<=0;)for(;t(s,-1),!i(s););else for(;--c>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Wg.setTime(+i),Vg.setTime(+s),e(Wg),e(Vg),Math.floor(r(Wg,Vg))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const fh=ln(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);fh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ln(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):fh);fh.range;const is=1e3,ni=is*60,ss=ni*60,ps=ss*24,Xy=ps*7,qE=ps*30,Kg=ps*365,Go=ln(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*is)},(e,t)=>(t-e)/is,e=>e.getUTCSeconds());Go.range;const qy=ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*is)},(e,t)=>{e.setTime(+e+t*ni)},(e,t)=>(t-e)/ni,e=>e.getMinutes());qy.range;const Zy=ln(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ni)},(e,t)=>(t-e)/ni,e=>e.getUTCMinutes());Zy.range;const Qy=ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*is-e.getMinutes()*ni)},(e,t)=>{e.setTime(+e+t*ss)},(e,t)=>(t-e)/ss,e=>e.getHours());Qy.range;const Jy=ln(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ss)},(e,t)=>(t-e)/ss,e=>e.getUTCHours());Jy.range;const Rf=ln(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ni)/ps,e=>e.getDate()-1);Rf.range;const xp=ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ps,e=>e.getUTCDate()-1);xp.range;const hj=ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ps,e=>Math.floor(e/ps));hj.range;function vl(e){return ln(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ni)/Xy)}const gp=vl(0),dh=vl(1),_B=vl(2),SB=vl(3),Nc=vl(4),NB=vl(5),EB=vl(6);gp.range;dh.range;_B.range;SB.range;Nc.range;NB.range;EB.range;function yl(e){return ln(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Xy)}const vp=yl(0),hh=yl(1),TB=yl(2),kB=yl(3),Ec=yl(4),CB=yl(5),AB=yl(6);vp.range;hh.range;TB.range;kB.range;Ec.range;CB.range;AB.range;const ew=ln(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ew.range;const tw=ln(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());tw.range;const ms=ln(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ms.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ln(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ms.range;const xs=ln(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());xs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ln(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});xs.range;function pj(e,t,r,n,a,i){const s=[[Go,1,is],[Go,5,5*is],[Go,15,15*is],[Go,30,30*is],[i,1,ni],[i,5,5*ni],[i,15,15*ni],[i,30,30*ni],[a,1,ss],[a,3,3*ss],[a,6,6*ss],[a,12,12*ss],[n,1,ps],[n,2,2*ps],[r,1,Xy],[t,1,qE],[t,3,3*qE],[e,1,Kg]];function c(h,d,m){const x=d<h;x&&([h,d]=[d,h]);const g=m&&typeof m.range=="function"?m:f(h,d,m),b=g?g.range(h,+d+1):[];return x?b.reverse():b}function f(h,d,m){const x=Math.abs(d-h)/m,g=Fy(([,,w])=>w).right(s,x);if(g===s.length)return e.every(x1(h/Kg,d/Kg,m));if(g===0)return fh.every(Math.max(x1(h,d,m),1));const[b,_]=s[x/s[g-1][2]<s[g][2]/x?g-1:g];return b.every(_)}return[c,f]}const[jB,PB]=pj(xs,tw,vp,hj,Jy,Zy),[OB,DB]=pj(ms,ew,gp,Rf,Qy,qy);function Gg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Yg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Iu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function IB(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,c=e.months,f=e.shortMonths,h=Ru(a),d=Fu(a),m=Ru(i),x=Fu(i),g=Ru(s),b=Fu(s),_=Ru(c),w=Fu(c),S=Ru(f),A=Fu(f),T={a:xe,A:ye,b:ge,B:Oe,c:null,d:rT,e:rT,f:n$,g:h$,G:m$,H:e$,I:t$,j:r$,L:mj,m:a$,M:i$,p:ie,q:he,Q:iT,s:sT,S:s$,u:o$,U:l$,V:c$,w:u$,W:f$,x:null,X:null,y:d$,Y:p$,Z:x$,"%":aT},D={a:De,A:We,b:Ve,B:Ge,c:null,d:nT,e:nT,f:w$,g:j$,G:O$,H:g$,I:v$,j:y$,L:gj,m:b$,M:_$,p:Te,q:U,Q:iT,s:sT,S:S$,u:N$,U:E$,V:T$,w:k$,W:C$,x:null,X:null,y:A$,Y:P$,Z:D$,"%":aT},O={a:q,A:V,b:J,B:ue,c:Ne,d:eT,e:eT,f:qB,g:JE,G:QE,H:tT,I:tT,j:KB,L:XB,m:VB,M:GB,p:R,q:WB,Q:QB,s:JB,S:YB,u:BB,U:$B,V:UB,w:LB,W:zB,x:pe,X:Ie,y:JE,Y:QE,Z:HB,"%":ZB};T.x=I(r,T),T.X=I(n,T),T.c=I(t,T),D.x=I(r,D),D.X=I(n,D),D.c=I(t,D);function I(H,X){return function(Z){var ee=[],Fe=-1,_e=0,Me=H.length,Re,ne,Ae;for(Z instanceof Date||(Z=new Date(+Z));++Fe<Me;)H.charCodeAt(Fe)===37&&(ee.push(H.slice(_e,Fe)),(ne=ZE[Re=H.charAt(++Fe)])!=null?Re=H.charAt(++Fe):ne=Re==="e"?" ":"0",(Ae=X[Re])&&(Re=Ae(Z,ne)),ee.push(Re),_e=Fe+1);return ee.push(H.slice(_e,Fe)),ee.join("")}}function j(H,X){return function(Z){var ee=Iu(1900,void 0,1),Fe=z(ee,H,Z+="",0),_e,Me;if(Fe!=Z.length)return null;if("Q"in ee)return new Date(ee.Q);if("s"in ee)return new Date(ee.s*1e3+("L"in ee?ee.L:0));if(X&&!("Z"in ee)&&(ee.Z=0),"p"in ee&&(ee.H=ee.H%12+ee.p*12),ee.m===void 0&&(ee.m="q"in ee?ee.q:0),"V"in ee){if(ee.V<1||ee.V>53)return null;"w"in ee||(ee.w=1),"Z"in ee?(_e=Yg(Iu(ee.y,0,1)),Me=_e.getUTCDay(),_e=Me>4||Me===0?hh.ceil(_e):hh(_e),_e=xp.offset(_e,(ee.V-1)*7),ee.y=_e.getUTCFullYear(),ee.m=_e.getUTCMonth(),ee.d=_e.getUTCDate()+(ee.w+6)%7):(_e=Gg(Iu(ee.y,0,1)),Me=_e.getDay(),_e=Me>4||Me===0?dh.ceil(_e):dh(_e),_e=Rf.offset(_e,(ee.V-1)*7),ee.y=_e.getFullYear(),ee.m=_e.getMonth(),ee.d=_e.getDate()+(ee.w+6)%7)}else("W"in ee||"U"in ee)&&("w"in ee||(ee.w="u"in ee?ee.u%7:"W"in ee?1:0),Me="Z"in ee?Yg(Iu(ee.y,0,1)).getUTCDay():Gg(Iu(ee.y,0,1)).getDay(),ee.m=0,ee.d="W"in ee?(ee.w+6)%7+ee.W*7-(Me+5)%7:ee.w+ee.U*7-(Me+6)%7);return"Z"in ee?(ee.H+=ee.Z/100|0,ee.M+=ee.Z%100,Yg(ee)):Gg(ee)}}function z(H,X,Z,ee){for(var Fe=0,_e=X.length,Me=Z.length,Re,ne;Fe<_e;){if(ee>=Me)return-1;if(Re=X.charCodeAt(Fe++),Re===37){if(Re=X.charAt(Fe++),ne=O[Re in ZE?X.charAt(Fe++):Re],!ne||(ee=ne(H,Z,ee))<0)return-1}else if(Re!=Z.charCodeAt(ee++))return-1}return ee}function R(H,X,Z){var ee=h.exec(X.slice(Z));return ee?(H.p=d.get(ee[0].toLowerCase()),Z+ee[0].length):-1}function q(H,X,Z){var ee=g.exec(X.slice(Z));return ee?(H.w=b.get(ee[0].toLowerCase()),Z+ee[0].length):-1}function V(H,X,Z){var ee=m.exec(X.slice(Z));return ee?(H.w=x.get(ee[0].toLowerCase()),Z+ee[0].length):-1}function J(H,X,Z){var ee=S.exec(X.slice(Z));return ee?(H.m=A.get(ee[0].toLowerCase()),Z+ee[0].length):-1}function ue(H,X,Z){var ee=_.exec(X.slice(Z));return ee?(H.m=w.get(ee[0].toLowerCase()),Z+ee[0].length):-1}function Ne(H,X,Z){return z(H,t,X,Z)}function pe(H,X,Z){return z(H,r,X,Z)}function Ie(H,X,Z){return z(H,n,X,Z)}function xe(H){return s[H.getDay()]}function ye(H){return i[H.getDay()]}function ge(H){return f[H.getMonth()]}function Oe(H){return c[H.getMonth()]}function ie(H){return a[+(H.getHours()>=12)]}function he(H){return 1+~~(H.getMonth()/3)}function De(H){return s[H.getUTCDay()]}function We(H){return i[H.getUTCDay()]}function Ve(H){return f[H.getUTCMonth()]}function Ge(H){return c[H.getUTCMonth()]}function Te(H){return a[+(H.getUTCHours()>=12)]}function U(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var X=I(H+="",T);return X.toString=function(){return H},X},parse:function(H){var X=j(H+="",!1);return X.toString=function(){return H},X},utcFormat:function(H){var X=I(H+="",D);return X.toString=function(){return H},X},utcParse:function(H){var X=j(H+="",!0);return X.toString=function(){return H},X}}}var ZE={"-":"",_:" ",0:"0"},vn=/^\s*\d+/,RB=/^%/,FB=/[\\^$*+?|[\]().{}]/g;function Kt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function MB(e){return e.replace(FB,"\\$&")}function Ru(e){return new RegExp("^(?:"+e.map(MB).join("|")+")","i")}function Fu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function LB(e,t,r){var n=vn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function BB(e,t,r){var n=vn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function $B(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function UB(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function zB(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function QE(e,t,r){var n=vn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function JE(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function HB(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function WB(e,t,r){var n=vn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function VB(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function eT(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function KB(e,t,r){var n=vn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function tT(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function GB(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function YB(e,t,r){var n=vn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function XB(e,t,r){var n=vn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function qB(e,t,r){var n=vn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZB(e,t,r){var n=RB.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function QB(e,t,r){var n=vn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function JB(e,t,r){var n=vn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function rT(e,t){return Kt(e.getDate(),t,2)}function e$(e,t){return Kt(e.getHours(),t,2)}function t$(e,t){return Kt(e.getHours()%12||12,t,2)}function r$(e,t){return Kt(1+Rf.count(ms(e),e),t,3)}function mj(e,t){return Kt(e.getMilliseconds(),t,3)}function n$(e,t){return mj(e,t)+"000"}function a$(e,t){return Kt(e.getMonth()+1,t,2)}function i$(e,t){return Kt(e.getMinutes(),t,2)}function s$(e,t){return Kt(e.getSeconds(),t,2)}function o$(e){var t=e.getDay();return t===0?7:t}function l$(e,t){return Kt(gp.count(ms(e)-1,e),t,2)}function xj(e){var t=e.getDay();return t>=4||t===0?Nc(e):Nc.ceil(e)}function c$(e,t){return e=xj(e),Kt(Nc.count(ms(e),e)+(ms(e).getDay()===4),t,2)}function u$(e){return e.getDay()}function f$(e,t){return Kt(dh.count(ms(e)-1,e),t,2)}function d$(e,t){return Kt(e.getFullYear()%100,t,2)}function h$(e,t){return e=xj(e),Kt(e.getFullYear()%100,t,2)}function p$(e,t){return Kt(e.getFullYear()%1e4,t,4)}function m$(e,t){var r=e.getDay();return e=r>=4||r===0?Nc(e):Nc.ceil(e),Kt(e.getFullYear()%1e4,t,4)}function x$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Kt(t/60|0,"0",2)+Kt(t%60,"0",2)}function nT(e,t){return Kt(e.getUTCDate(),t,2)}function g$(e,t){return Kt(e.getUTCHours(),t,2)}function v$(e,t){return Kt(e.getUTCHours()%12||12,t,2)}function y$(e,t){return Kt(1+xp.count(xs(e),e),t,3)}function gj(e,t){return Kt(e.getUTCMilliseconds(),t,3)}function w$(e,t){return gj(e,t)+"000"}function b$(e,t){return Kt(e.getUTCMonth()+1,t,2)}function _$(e,t){return Kt(e.getUTCMinutes(),t,2)}function S$(e,t){return Kt(e.getUTCSeconds(),t,2)}function N$(e){var t=e.getUTCDay();return t===0?7:t}function E$(e,t){return Kt(vp.count(xs(e)-1,e),t,2)}function vj(e){var t=e.getUTCDay();return t>=4||t===0?Ec(e):Ec.ceil(e)}function T$(e,t){return e=vj(e),Kt(Ec.count(xs(e),e)+(xs(e).getUTCDay()===4),t,2)}function k$(e){return e.getUTCDay()}function C$(e,t){return Kt(hh.count(xs(e)-1,e),t,2)}function A$(e,t){return Kt(e.getUTCFullYear()%100,t,2)}function j$(e,t){return e=vj(e),Kt(e.getUTCFullYear()%100,t,2)}function P$(e,t){return Kt(e.getUTCFullYear()%1e4,t,4)}function O$(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ec(e):Ec.ceil(e),Kt(e.getUTCFullYear()%1e4,t,4)}function D$(){return"+0000"}function aT(){return"%"}function iT(e){return+e}function sT(e){return Math.floor(+e/1e3)}var ql,yj,wj;I$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function I$(e){return ql=IB(e),yj=ql.format,ql.parse,wj=ql.utcFormat,ql.utcParse,ql}function R$(e){return new Date(e)}function F$(e){return e instanceof Date?+e:+new Date(+e)}function rw(e,t,r,n,a,i,s,c,f,h){var d=zy(),m=d.invert,x=d.domain,g=h(".%L"),b=h(":%S"),_=h("%I:%M"),w=h("%I %p"),S=h("%a %d"),A=h("%b %d"),T=h("%B"),D=h("%Y");function O(I){return(f(I)<I?g:c(I)<I?b:s(I)<I?_:i(I)<I?w:n(I)<I?a(I)<I?S:A:r(I)<I?T:D)(I)}return d.invert=function(I){return new Date(m(I))},d.domain=function(I){return arguments.length?x(Array.from(I,F$)):x().map(R$)},d.ticks=function(I){var j=x();return e(j[0],j[j.length-1],I??10)},d.tickFormat=function(I,j){return j==null?O:h(j)},d.nice=function(I){var j=x();return(!I||typeof I.range!="function")&&(I=t(j[0],j[j.length-1],I??10)),I?x(sj(j,I)):d},d.copy=function(){return If(d,rw(e,t,r,n,a,i,s,c,f,h))},d}function M$(){return oi.apply(rw(OB,DB,ms,ew,gp,Rf,Qy,qy,Go,yj).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function L$(){return oi.apply(rw(jB,PB,xs,tw,vp,xp,Jy,Zy,Go,wj).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yp(){var e=0,t=1,r,n,a,i,s=aa,c=!1,f;function h(m){return m==null||isNaN(m=+m)?f:s(a===0?.5:(m=(i(m)-r)*a,c?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([e,t]=m,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),h):[e,t]},h.clamp=function(m){return arguments.length?(c=!!m,h):c},h.interpolator=function(m){return arguments.length?(s=m,h):s};function d(m){return function(x){var g,b;return arguments.length?([g,b]=x,s=m(g,b),h):[s(0),s(1)]}}return h.range=d(Ic),h.rangeRound=d(Uy),h.unknown=function(m){return arguments.length?(f=m,h):f},function(m){return i=m,r=m(e),n=m(t),a=r===n?0:1/(n-r),h}}function _o(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function bj(){var e=bo(yp()(aa));return e.copy=function(){return _o(e,bj())},_s.apply(e,arguments)}function _j(){var e=Vy(yp()).domain([1,10]);return e.copy=function(){return _o(e,_j()).base(e.base())},_s.apply(e,arguments)}function Sj(){var e=Ky(yp());return e.copy=function(){return _o(e,Sj()).constant(e.constant())},_s.apply(e,arguments)}function nw(){var e=Gy(yp());return e.copy=function(){return _o(e,nw()).exponent(e.exponent())},_s.apply(e,arguments)}function B$(){return nw.apply(null,arguments).exponent(.5)}function Nj(){var e=[],t=aa;function r(n){if(n!=null&&!isNaN(n=+n))return t((Of(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ao),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>N9(e,i/n))},r.copy=function(){return Nj(t).domain(e)},_s.apply(r,arguments)}function wp(){var e=0,t=.5,r=1,n=1,a,i,s,c,f,h=aa,d,m=!1,x;function g(_){return isNaN(_=+_)?x:(_=.5+((_=+d(_))-i)*(n*_<n*i?c:f),h(m?Math.max(0,Math.min(1,_)):_))}g.domain=function(_){return arguments.length?([e,t,r]=_,a=d(e=+e),i=d(t=+t),s=d(r=+r),c=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(_){return arguments.length?(m=!!_,g):m},g.interpolator=function(_){return arguments.length?(h=_,g):h};function b(_){return function(w){var S,A,T;return arguments.length?([S,A,T]=w,h=Z9(_,[S,A,T]),g):[h(0),h(.5),h(1)]}}return g.range=b(Ic),g.rangeRound=b(Uy),g.unknown=function(_){return arguments.length?(x=_,g):x},function(_){return d=_,a=_(e),i=_(t),s=_(r),c=a===i?0:.5/(i-a),f=i===s?0:.5/(s-i),n=i<a?-1:1,g}}function Ej(){var e=bo(wp()(aa));return e.copy=function(){return _o(e,Ej())},_s.apply(e,arguments)}function Tj(){var e=Vy(wp()).domain([.1,1,10]);return e.copy=function(){return _o(e,Tj()).base(e.base())},_s.apply(e,arguments)}function kj(){var e=Ky(wp());return e.copy=function(){return _o(e,kj()).constant(e.constant())},_s.apply(e,arguments)}function aw(){var e=Gy(wp());return e.copy=function(){return _o(e,aw()).exponent(e.exponent())},_s.apply(e,arguments)}function $$(){return aw.apply(null,arguments).exponent(.5)}const Ku=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ly,scaleDiverging:Ej,scaleDivergingLog:Tj,scaleDivergingPow:aw,scaleDivergingSqrt:$$,scaleDivergingSymlog:kj,scaleIdentity:ij,scaleImplicit:g1,scaleLinear:aj,scaleLog:oj,scaleOrdinal:My,scalePoint:k9,scalePow:Yy,scaleQuantile:uj,scaleQuantize:fj,scaleRadial:cj,scaleSequential:bj,scaleSequentialLog:_j,scaleSequentialPow:nw,scaleSequentialQuantile:Nj,scaleSequentialSqrt:B$,scaleSequentialSymlog:Sj,scaleSqrt:wB,scaleSymlog:lj,scaleThreshold:dj,scaleTime:M$,scaleUtc:L$,tickFormat:nj},Symbol.toStringTag,{value:"Module"}));var So=e=>e.chartData,iw=Ee([So],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),bp=(e,t,r,n)=>n?iw(e):So(e);function ol(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Kn(t)&&Kn(r))return!0}return!1}function oT(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Cj(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Kn(r))a=r;else if(typeof r=="function")return;if(Kn(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(ol(s))return s}}function U$(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ol(n))return oT(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,c;if(a==="auto")t!=null&&(s=Math.min(...t));else if(mt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&KN.test(a)){var f=KN.exec(a);if(f==null||t==null)s=void 0;else{var h=+f[1];s=t[0]-h}}else s=t?.[0];if(i==="auto")t!=null&&(c=Math.max(...t));else if(mt(i))c=i;else if(typeof i=="function")try{t!=null&&(c=i(t?.[1]))}catch{}else if(typeof i=="string"&&GN.test(i)){var d=GN.exec(i);if(d==null||t==null)c=void 0;else{var m=+d[1];c=t[1]+m}}else c=t?.[1];var x=[s,c];if(ol(x))return t==null?x:oT(x,t,r)}}}var Rc=1e9,z$={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},ow,Sr=!0,si="[DecimalError] ",Jo=si+"Invalid argument: ",sw=si+"Exponent out of range: ",Fc=Math.floor,Wo=Math.pow,H$=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ma,pn=1e7,mr=7,Aj=9007199254740991,ph=Fc(Aj/mr),st={};st.absoluteValue=st.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};st.comparedTo=st.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};st.decimalPlaces=st.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*mr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};st.dividedBy=st.div=function(e){return ls(this,new this.constructor(e))};st.dividedToIntegerBy=st.idiv=function(e){var t=this,r=t.constructor;return lr(ls(t,new r(e),0,1),r.precision)};st.equals=st.eq=function(e){return!this.cmp(e)};st.exponent=function(){return Qr(this)};st.greaterThan=st.gt=function(e){return this.cmp(e)>0};st.greaterThanOrEqualTo=st.gte=function(e){return this.cmp(e)>=0};st.isInteger=st.isint=function(){return this.e>this.d.length-2};st.isNegative=st.isneg=function(){return this.s<0};st.isPositive=st.ispos=function(){return this.s>0};st.isZero=function(){return this.s===0};st.lessThan=st.lt=function(e){return this.cmp(e)<0};st.lessThanOrEqualTo=st.lte=function(e){return this.cmp(e)<1};st.logarithm=st.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ma))throw Error(si+"NaN");if(r.s<1)throw Error(si+(r.s?"NaN":"-Infinity"));return r.eq(Ma)?new n(0):(Sr=!1,t=ls(mf(r,i),mf(e,i),i),Sr=!0,lr(t,a))};st.minus=st.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Oj(t,e):jj(t,(e.s=-e.s,e))};st.modulo=st.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(si+"NaN");return r.s?(Sr=!1,t=ls(r,e,0,1).times(e),Sr=!0,r.minus(t)):lr(new n(r),a)};st.naturalExponential=st.exp=function(){return Pj(this)};st.naturalLogarithm=st.ln=function(){return mf(this)};st.negated=st.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};st.plus=st.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?jj(t,e):Oj(t,(e.s=-e.s,e))};st.precision=st.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Jo+e);if(t=Qr(a)+1,n=a.d.length-1,r=n*mr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};st.squareRoot=st.sqrt=function(){var e,t,r,n,a,i,s,c=this,f=c.constructor;if(c.s<1){if(!c.s)return new f(0);throw Error(si+"NaN")}for(e=Qr(c),Sr=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=Ri(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Fc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(a.toString()),r=f.precision,a=s=r+3;;)if(i=n,n=i.plus(ls(c,i,s+2)).times(.5),Ri(i.d).slice(0,s)===(t=Ri(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(lr(i,r+1,0),i.times(i).eq(c)){n=i;break}}else if(t!="9999")break;s+=4}return Sr=!0,lr(n,r)};st.times=st.mul=function(e){var t,r,n,a,i,s,c,f,h,d=this,m=d.constructor,x=d.d,g=(e=new m(e)).d;if(!d.s||!e.s)return new m(0);for(e.s*=d.s,r=d.e+e.e,f=x.length,h=g.length,f<h&&(i=x,x=g,g=i,s=f,f=h,h=s),i=[],s=f+h,n=s;n--;)i.push(0);for(n=h;--n>=0;){for(t=0,a=f+n;a>n;)c=i[a]+g[n]*x[a-n-1]+t,i[a--]=c%pn|0,t=c/pn|0;i[a]=(i[a]+t)%pn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Sr?lr(e,m.precision):e};st.toDecimalPlaces=st.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ui(e,0,Rc),t===void 0?t=n.rounding:Ui(t,0,8),lr(r,e+Qr(r)+1,t))};st.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=ll(n,!0):(Ui(e,0,Rc),t===void 0?t=a.rounding:Ui(t,0,8),n=lr(new a(n),e+1,t),r=ll(n,!0,e+1)),r};st.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?ll(a):(Ui(e,0,Rc),t===void 0?t=i.rounding:Ui(t,0,8),n=lr(new i(a),e+Qr(a)+1,t),r=ll(n.abs(),!1,e+Qr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};st.toInteger=st.toint=function(){var e=this,t=e.constructor;return lr(new t(e),Qr(e)+1,t.rounding)};st.toNumber=function(){return+this};st.toPower=st.pow=function(e){var t,r,n,a,i,s,c=this,f=c.constructor,h=12,d=+(e=new f(e));if(!e.s)return new f(Ma);if(c=new f(c),!c.s){if(e.s<1)throw Error(si+"Infinity");return c}if(c.eq(Ma))return c;if(n=f.precision,e.eq(Ma))return lr(c,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=c.s,s){if((r=d<0?-d:d)<=Aj){for(a=new f(Ma),t=Math.ceil(n/mr+4),Sr=!1;r%2&&(a=a.times(c),cT(a.d,t)),r=Fc(r/2),r!==0;)c=c.times(c),cT(c.d,t);return Sr=!0,e.s<0?new f(Ma).div(a):lr(a,n)}}else if(i<0)throw Error(si+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,Sr=!1,a=e.times(mf(c,n+h)),Sr=!0,a=Pj(a),a.s=i,a};st.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Qr(a),n=ll(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ui(e,1,Rc),t===void 0?t=i.rounding:Ui(t,0,8),a=lr(new i(a),e,t),r=Qr(a),n=ll(a,e<=r||r<=i.toExpNeg,e)),n};st.toSignificantDigits=st.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ui(e,1,Rc),t===void 0?t=n.rounding:Ui(t,0,8)),lr(new n(r),e,t)};st.toString=st.valueOf=st.val=st.toJSON=st[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Qr(e),r=e.constructor;return ll(e,t<=r.toExpNeg||t>=r.toExpPos)};function jj(e,t){var r,n,a,i,s,c,f,h,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Sr?lr(t,m):t;if(f=e.d,h=t.d,s=e.e,a=t.e,f=f.slice(),i=s-a,i){for(i<0?(n=f,i=-i,c=h.length):(n=h,a=s,c=f.length),s=Math.ceil(m/mr),c=s>c?s+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=f.length,i=h.length,c-i<0&&(i=c,n=h,h=f,f=n),r=0;i;)r=(f[--i]=f[i]+h[i]+r)/pn|0,f[i]%=pn;for(r&&(f.unshift(r),++a),c=f.length;f[--c]==0;)f.pop();return t.d=f,t.e=a,Sr?lr(t,m):t}function Ui(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Jo+e)}function Ri(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=mr-n.length,r&&(i+=Xs(r)),i+=n;s=e[t],n=s+"",r=mr-n.length,r&&(i+=Xs(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var ls=(function(){function e(n,a){var i,s=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+s,n[c]=i%pn|0,s=i/pn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var c,f;if(i!=s)f=i>s?1:-1;else for(c=f=0;c<i;c++)if(n[c]!=a[c]){f=n[c]>a[c]?1:-1;break}return f}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*pn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var c,f,h,d,m,x,g,b,_,w,S,A,T,D,O,I,j,z,R=n.constructor,q=n.s==a.s?1:-1,V=n.d,J=a.d;if(!n.s)return new R(n);if(!a.s)throw Error(si+"Division by zero");for(f=n.e-a.e,j=J.length,O=V.length,g=new R(q),b=g.d=[],h=0;J[h]==(V[h]||0);)++h;if(J[h]>(V[h]||0)&&--f,i==null?A=i=R.precision:s?A=i+(Qr(n)-Qr(a))+1:A=i,A<0)return new R(0);if(A=A/mr+2|0,h=0,j==1)for(d=0,J=J[0],A++;(h<O||d)&&A--;h++)T=d*pn+(V[h]||0),b[h]=T/J|0,d=T%J|0;else{for(d=pn/(J[0]+1)|0,d>1&&(J=e(J,d),V=e(V,d),j=J.length,O=V.length),D=j,_=V.slice(0,j),w=_.length;w<j;)_[w++]=0;z=J.slice(),z.unshift(0),I=J[0],J[1]>=pn/2&&++I;do d=0,c=t(J,_,j,w),c<0?(S=_[0],j!=w&&(S=S*pn+(_[1]||0)),d=S/I|0,d>1?(d>=pn&&(d=pn-1),m=e(J,d),x=m.length,w=_.length,c=t(m,_,x,w),c==1&&(d--,r(m,j<x?z:J,x))):(d==0&&(c=d=1),m=J.slice()),x=m.length,x<w&&m.unshift(0),r(_,m,w),c==-1&&(w=_.length,c=t(J,_,j,w),c<1&&(d++,r(_,j<w?z:J,w))),w=_.length):c===0&&(d++,_=[0]),b[h++]=d,c&&_[0]?_[w++]=V[D]||0:(_=[V[D]],w=1);while((D++<O||_[0]!==void 0)&&A--)}return b[0]||b.shift(),g.e=f,lr(g,s?i+Qr(g)+1:i)}})();function Pj(e,t){var r,n,a,i,s,c,f=0,h=0,d=e.constructor,m=d.precision;if(Qr(e)>16)throw Error(sw+Qr(e));if(!e.s)return new d(Ma);for(Sr=!1,c=m,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),h+=5;for(n=Math.log(Wo(2,h))/Math.LN10*2+5|0,c+=n,r=a=i=new d(Ma),d.precision=c;;){if(a=lr(a.times(e),c),r=r.times(++f),s=i.plus(ls(a,r,c)),Ri(s.d).slice(0,c)===Ri(i.d).slice(0,c)){for(;h--;)i=lr(i.times(i),c);return d.precision=m,t==null?(Sr=!0,lr(i,m)):i}i=s}}function Qr(e){for(var t=e.e*mr,r=e.d[0];r>=10;r/=10)t++;return t}function Xg(e,t,r){if(t>e.LN10.sd())throw Sr=!0,r&&(e.precision=r),Error(si+"LN10 precision limit exceeded");return lr(new e(e.LN10),t)}function Xs(e){for(var t="";e--;)t+="0";return t}function mf(e,t){var r,n,a,i,s,c,f,h,d,m=1,x=10,g=e,b=g.d,_=g.constructor,w=_.precision;if(g.s<1)throw Error(si+(g.s?"NaN":"-Infinity"));if(g.eq(Ma))return new _(0);if(t==null?(Sr=!1,h=w):h=t,g.eq(10))return t==null&&(Sr=!0),Xg(_,h);if(h+=x,_.precision=h,r=Ri(b),n=r.charAt(0),i=Qr(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=Ri(g.d),n=r.charAt(0),m++;i=Qr(g),n>1?(g=new _("0."+r),i++):g=new _(n+"."+r.slice(1))}else return f=Xg(_,h+2,w).times(i+""),g=mf(new _(n+"."+r.slice(1)),h-x).plus(f),_.precision=w,t==null?(Sr=!0,lr(g,w)):g;for(c=s=g=ls(g.minus(Ma),g.plus(Ma),h),d=lr(g.times(g),h),a=3;;){if(s=lr(s.times(d),h),f=c.plus(ls(s,new _(a),h)),Ri(f.d).slice(0,h)===Ri(c.d).slice(0,h))return c=c.times(2),i!==0&&(c=c.plus(Xg(_,h+2,w).times(i+""))),c=ls(c,new _(m),h),_.precision=w,t==null?(Sr=!0,lr(c,w)):c;c=f,a+=2}}function lT(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Fc(r/mr),e.d=[],n=(r+1)%mr,r<0&&(n+=mr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=mr;n<a;)e.d.push(+t.slice(n,n+=mr));t=t.slice(n),n=mr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Sr&&(e.e>ph||e.e<-ph))throw Error(sw+r)}else e.s=0,e.e=0,e.d=[0];return e}function lr(e,t,r){var n,a,i,s,c,f,h,d,m=e.d;for(s=1,i=m[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=mr,a=t,h=m[d=0];else{if(d=Math.ceil((n+1)/mr),i=m.length,d>=i)return e;for(h=i=m[d],s=1;i>=10;i/=10)s++;n%=mr,a=n-mr+s}if(r!==void 0&&(i=Wo(10,s-a-1),c=h/i%10|0,f=t<0||m[d+1]!==void 0||h%i,f=r<4?(c||f)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||f||r==6&&(n>0?a>0?h/Wo(10,s-a):0:m[d-1])%10&1||r==(e.s<0?8:7))),t<1||!m[0])return f?(i=Qr(e),m.length=1,t=t-i-1,m[0]=Wo(10,(mr-t%mr)%mr),e.e=Fc(-t/mr)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(n==0?(m.length=d,i=1,d--):(m.length=d+1,i=Wo(10,mr-n),m[d]=a>0?(h/Wo(10,s-a)%Wo(10,a)|0)*i:0),f)for(;;)if(d==0){(m[0]+=i)==pn&&(m[0]=1,++e.e);break}else{if(m[d]+=i,m[d]!=pn)break;m[d--]=0,i=1}for(n=m.length;m[--n]===0;)m.pop();if(Sr&&(e.e>ph||e.e<-ph))throw Error(sw+Qr(e));return e}function Oj(e,t){var r,n,a,i,s,c,f,h,d,m,x=e.constructor,g=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),Sr?lr(t,g):t;if(f=e.d,m=t.d,n=t.e,h=e.e,f=f.slice(),s=h-n,s){for(d=s<0,d?(r=f,s=-s,c=m.length):(r=m,n=h,c=f.length),a=Math.max(Math.ceil(g/mr),c)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=f.length,c=m.length,d=a<c,d&&(c=a),a=0;a<c;a++)if(f[a]!=m[a]){d=f[a]<m[a];break}s=0}for(d&&(r=f,f=m,m=r,t.s=-t.s),c=f.length,a=m.length-c;a>0;--a)f[c++]=0;for(a=m.length;a>s;){if(f[--a]<m[a]){for(i=a;i&&f[--i]===0;)f[i]=pn-1;--f[i],f[a]+=pn}f[a]-=m[a]}for(;f[--c]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,Sr?lr(t,g):t):new x(0)}function ll(e,t,r){var n,a=Qr(e),i=Ri(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Xs(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Xs(-a-1)+i,r&&(n=r-s)>0&&(i+=Xs(n))):a>=s?(i+=Xs(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Xs(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Xs(n))),e.s<0?"-"+i:i}function cT(e,t){if(e.length>t)return e.length=t,!0}function Dj(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Jo+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return lT(s,i.toString())}else if(typeof i!="string")throw Error(Jo+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,H$.test(i))lT(s,i);else throw Error(Jo+i)}if(a.prototype=st,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Dj,a.config=a.set=W$,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function W$(e){if(!e||typeof e!="object")throw Error(si+"Object expected");var t,r,n,a=["precision",1,Rc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Fc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Jo+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Jo+r+": "+n);return this}var ow=Dj(z$);Ma=new ow(1);const er=ow;var V$=e=>e,Ij={},Rj=e=>e===Ij,uT=e=>function t(){return arguments.length===0||arguments.length===1&&Rj(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Fj=(e,t)=>e===1?t:uT(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==Ij).length;return i>=e?t(...n):Fj(e-i,uT(function(){for(var s=arguments.length,c=new Array(s),f=0;f<s;f++)c[f]=arguments[f];var h=n.map(d=>Rj(d)?c.shift():d);return t(...h,...c)}))}),_p=e=>Fj(e.length,e),b1=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},K$=_p((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),G$=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return V$;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((c,f)=>f(c),i(...arguments))}},_1=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Mj=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,c)=>{var f;return s===((f=t)===null||f===void 0?void 0:f[c])})||(t=a,r=e(...a)),r}};function Lj(e){var t;return e===0?t=1:t=Math.floor(new er(e).abs().log(10).toNumber())+1,t}function Bj(e,t,r){for(var n=new er(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}_p((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});_p((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});_p((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var $j=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},Uj=(e,t,r)=>{if(e.lte(0))return new er(0);var n=Lj(e.toNumber()),a=new er(10).pow(n),i=e.div(a),s=n!==1?.05:.1,c=new er(Math.ceil(i.div(s).toNumber())).add(r).mul(s),f=c.mul(a);return t?new er(f.toNumber()):new er(Math.ceil(f.toNumber()))},Y$=(e,t,r)=>{var n=new er(1),a=new er(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new er(10).pow(Lj(e)-1),a=new er(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new er(Math.floor(e)))}else e===0?a=new er(Math.floor((t-1)/2)):r||(a=new er(Math.floor(e)));var s=Math.floor((t-1)/2),c=G$(K$(f=>a.add(new er(f-s).mul(n)).toNumber()),b1);return c(0,t)},zj=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new er(0),tickMin:new er(0),tickMax:new er(0)};var s=Uj(new er(r).sub(t).div(n-1),a,i),c;t<=0&&r>=0?c=new er(0):(c=new er(t).add(r).div(2),c=c.sub(new er(c).mod(s)));var f=Math.ceil(c.sub(t).div(s).toNumber()),h=Math.ceil(new er(r).sub(c).div(s).toNumber()),d=f+h+1;return d>n?zj(t,r,n,a,i+1):(d<n&&(h=r>0?h+(n-d):h,f=r>0?f:f+(n-d)),{step:s,tickMin:c.sub(new er(f).mul(s)),tickMax:c.add(new er(h).mul(s))})};function X$(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,c]=$j([t,r]);if(s===-1/0||c===1/0){var f=c===1/0?[s,...b1(0,n-1).map(()=>1/0)]:[...b1(0,n-1).map(()=>-1/0),c];return t>r?_1(f):f}if(s===c)return Y$(s,n,a);var{step:h,tickMin:d,tickMax:m}=zj(s,c,i,a,0),x=Bj(d,m.add(new er(.1).mul(h)),h);return t>r?_1(x):x}function q$(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=$j([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var c=Math.max(t,2),f=Uj(new er(s).sub(i).div(c-1),a,0),h=[...Bj(new er(i),new er(s),f),s];return a===!1&&(h=h.map(d=>Math.round(d))),r>n?_1(h):h}var Z$=Mj(X$),Q$=Mj(q$),Hj=e=>e.rootProps.maxBarSize,J$=e=>e.rootProps.barGap,Wj=e=>e.rootProps.barCategoryGap,eU=e=>e.rootProps.barSize,Ff=e=>e.rootProps.stackOffset,lw=e=>e.options.chartName,cw=e=>e.rootProps.syncId,Vj=e=>e.rootProps.syncMethod,uw=e=>e.options.eventEmitter,rs={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Oa={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Sp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},tU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:rs.angleAxisId,includeHidden:!1,name:void 0,reversed:rs.reversed,scale:rs.scale,tick:rs.tick,tickCount:void 0,ticks:void 0,type:rs.type,unit:void 0},rU={allowDataOverflow:Oa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oa.scale,tick:Oa.tick,tickCount:Oa.tickCount,ticks:void 0,type:Oa.type,unit:void 0},nU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:rs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:rs.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:rs.scale,tick:rs.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},aU={allowDataOverflow:Oa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oa.scale,tick:Oa.tick,tickCount:Oa.tickCount,ticks:void 0,type:"category",unit:void 0},fw=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?nU:tU,dw=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?aU:rU,Np=e=>e.polarOptions,hw=Ee([ws,bs,on],_A),Kj=Ee([Np,hw],(e,t)=>{if(e!=null)return Hn(e.innerRadius,t,0)}),Gj=Ee([Np,hw],(e,t)=>{if(e!=null)return Hn(e.outerRadius,t,t*.8)}),iU=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},Yj=Ee([Np],iU);Ee([fw,Yj],Sp);var Xj=Ee([hw,Kj,Gj],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Ee([dw,Xj],Sp);var qj=Ee([Lt,Np,Kj,Gj,ws,bs],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:c,startAngle:f,endAngle:h}=t;return{cx:Hn(s,a,a/2),cy:Hn(c,i,i/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:h,clockWise:!1}}}),Tr=(e,t)=>t,Mf=(e,t,r)=>r;function pw(e){return e?.id}var cn=e=>{var t=Lt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Mc=e=>e.tooltip.settings.axisId,un=e=>{var t=cn(e),r=Mc(e);return Lf(e,t,r)},Zj=Ee([un],e=>e?.dataKey);function Qj(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(c=>{var f,h=(f=c.data)!==null&&f!==void 0?f:n;if(!(h==null||h.length===0)){var d=pw(c);h.forEach((m,x)=>{var g=i==null||a?x:String(dr(m,i,null)),b=dr(m,c.dataKey,0),_;s.has(g)?_=s.get(g):_={},Object.assign(_,{[d]:b}),s.set(g,_)})}}),Array.from(s.values())}function Ep(e){return e.stackId!=null&&e.dataKey!=null}var Tp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function kp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function fT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fT(Object(r),!0).forEach(function(n){sU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sU(e,t,r){return(t=oU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oU(e){var t=lU(e,"string");return typeof t=="symbol"?t:t+""}function lU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S1=[0,"auto"],Aa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Jj=(e,t)=>e.cartesianAxis.xAxis[t],Ss=(e,t)=>{var r=Jj(e,t);return r??Aa},ja={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:S1,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Af},eP=(e,t)=>e.cartesianAxis.yAxis[t],Ns=(e,t)=>{var r=eP(e,t);return r??ja},cU={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},mw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??cU},Or=(e,t,r)=>{switch(t){case"xAxis":return Ss(e,r);case"yAxis":return Ns(e,r);case"zAxis":return mw(e,r);case"angleAxis":return fw(e,r);case"radiusAxis":return dw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},uU=(e,t,r)=>{switch(t){case"xAxis":return Ss(e,r);case"yAxis":return Ns(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Lf=(e,t,r)=>{switch(t){case"xAxis":return Ss(e,r);case"yAxis":return Ns(e,r);case"angleAxis":return fw(e,r);case"radiusAxis":return dw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},tP=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function xw(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Cp=e=>e.graphicalItems.cartesianItems,fU=Ee([Tr,Mf],xw),gw=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Bf=Ee([Cp,Or,fU],gw,{memoizeOptions:{resultEqualityCheck:kp}}),rP=Ee([Bf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Ep)),nP=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),dU=Ee([Bf],nP),vw=e=>e.map(t=>t.data).filter(Boolean).flat(1),hU=Ee([Bf],vw,{memoizeOptions:{resultEqualityCheck:kp}}),yw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},ww=Ee([hU,bp],yw),bw=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:dr(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:dr(a,n)}))):e.map(n=>({value:n})),Ap=Ee([ww,Or,Bf],bw);function aP(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function O0(e){if($i(e)||e instanceof Date){var t=Number(e);if(Kn(t))return t}}function dT(e){if(Array.isArray(e)){var t=[O0(e[0]),O0(e[1])];return ol(t)?t:void 0}var r=O0(e);if(r!=null)return[r,r]}function Lc(e){return e.map(O0).filter(j7)}function pU(e,t,r){return!r||typeof t!="number"||ai(t)?[]:r.length?Lc(r.flatMap(n=>{var a=dr(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Kn(i)||!Kn(s)))return[t-i,t+s]})):[]}var mU=Ee([rP,bp,un],Qj),iP=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,c]=i,f=c.map(pw);return[s,{stackedData:dL(e,f,r),graphicalItems:c}]}))},N1=Ee([mU,rP,Ff],iP),sP=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=gL(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},xU=Ee([Or],e=>e.allowDataOverflow),_w=e=>{var t;if(e==null||!("domain"in e))return S1;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Lc(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:S1},Sw=Ee([Or],_w),Nw=Ee([Sw,xU],Cj),gU=Ee([N1,So,Tr,Nw],sP,{memoizeOptions:{resultEqualityCheck:Tp}}),jp=e=>e.errorBars,vU=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>aP(r,n)),xh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),c=Math.max(...i);return[s,c]}},Ew=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(c=>{r.forEach(f=>{var h,d,m=(h=n[f.id])===null||h===void 0?void 0:h.filter(S=>aP(a,S)),x=dr(c,(d=t.dataKey)!==null&&d!==void 0?d:f.dataKey),g=pU(c,x,m);if(g.length>=2){var b=Math.min(...g),_=Math.max(...g);(i==null||b<i)&&(i=b),(s==null||_>s)&&(s=_)}var w=dT(x);w!=null&&(i=i==null?w[0]:Math.min(i,w[0]),s=s==null?w[1]:Math.max(s,w[1]))})}),t?.dataKey!=null&&e.forEach(c=>{var f=dT(dr(c,t.dataKey));f!=null&&(i=i==null?f[0]:Math.min(i,f[0]),s=s==null?f[1]:Math.max(s,f[1]))}),Kn(i)&&Kn(s))return[i,s]},yU=Ee([ww,Or,dU,jp,Tr],Ew,{memoizeOptions:{resultEqualityCheck:Tp}});function wU(e){var{value:t}=e;if($i(t)||t instanceof Date)return t}var bU=(e,t,r)=>{var n=e.map(wU).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&D4(n))?GA(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},oP=e=>e.referenceElements.dots,Bc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),_U=Ee([oP,Tr,Mf],Bc),lP=e=>e.referenceElements.areas,SU=Ee([lP,Tr,Mf],Bc),cP=e=>e.referenceElements.lines,NU=Ee([cP,Tr,Mf],Bc),uP=(e,t)=>{var r=Lc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},EU=Ee(_U,Tr,uP),fP=(e,t)=>{var r=Lc(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},TU=Ee([SU,Tr],fP),dP=(e,t)=>{var r=Lc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},kU=Ee(NU,Tr,dP),CU=Ee(EU,kU,TU,(e,t,r)=>xh(e,r,t)),Tw=(e,t,r,n,a,i,s,c)=>{if(r!=null)return r;var f=s==="vertical"&&c==="xAxis"||s==="horizontal"&&c==="yAxis",h=f?xh(n,i,a):xh(i,a);return U$(t,h,e.allowDataOverflow)},AU=Ee([Or,Sw,Nw,gU,yU,CU,Lt,Tr],Tw,{memoizeOptions:{resultEqualityCheck:Tp}}),jU=[0,1],kw=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:c,type:f}=e,h=yo(t,i);return h&&c==null?GA(0,r.length):f==="category"?bU(n,e,h):a==="expand"?jU:s}},Cw=Ee([Or,Lt,ww,Ap,Ff,Tr,AU],kw),hP=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var c="scale".concat(Tf(i));return c in Ku?c:"point"}}},$c=Ee([Or,Lt,tP,lw,Tr],hP);function PU(e){if(e!=null){if(e in Ku)return Ku[e]();var t="scale".concat(Tf(e));if(t in Ku)return Ku[t]()}}function Aw(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=PU(t);if(a!=null){var i=a.domain(r).range(n);return oL(i),i}}}var jw=(e,t,r)=>{var n=_w(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ol(e))return Z$(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ol(e))return Q$(e,t.tickCount,t.allowDecimals)}},Pw=Ee([Cw,Lf,$c],jw),Ow=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&ol(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],c=r[r.length-1];return[Math.min(a,i),Math.max(s,c)]}return t},OU=Ee([Or,Cw,Pw,Tr],Ow),DU=Ee(Ap,Or,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Lc(e.map(c=>c.value))).sort((c,f)=>c-f);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),pP=Ee(DU,Lt,Wj,on,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Kn(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=Hn(r,e*i),c=e*i/2;return c-s-(c-s)/i*s}return 0}),IU=(e,t)=>{var r=Ss(e,t);return r==null||typeof r.padding!="string"?0:pP(e,"xAxis",t,r.padding)},RU=(e,t)=>{var r=Ns(e,t);return r==null||typeof r.padding!="string"?0:pP(e,"yAxis",t,r.padding)},FU=Ee(Ss,IU,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),MU=Ee(Ns,RU,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),LU=Ee([on,FU,fp,up,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),BU=Ee([on,Lt,MU,fp,up,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),$f=(e,t,r,n)=>{var a;switch(t){case"xAxis":return LU(e,r,n);case"yAxis":return BU(e,r,n);case"zAxis":return(a=mw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Yj(e);case"radiusAxis":return Xj(e,r);default:return}},mP=Ee([Or,$f],Sp),Uc=Ee([Or,$c,OU,mP],Aw);Ee([Bf,jp,Tr],vU);function xP(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Pp=(e,t)=>t,Op=(e,t,r)=>r,$U=Ee(lp,Pp,Op,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(xP)),UU=Ee(cp,Pp,Op,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(xP)),gP=(e,t)=>({width:e.width,height:t.height}),zU=(e,t)=>{var r=typeof t.width=="number"?t.width:Af;return{width:r,height:e.height}},vP=Ee(on,Ss,gP),HU=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},WU=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},VU=Ee(bs,on,$U,Pp,Op,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var f=gP(t,c);s==null&&(s=HU(t,n,e));var h=n==="top"&&!a||n==="bottom"&&a;i[c.id]=s-Number(h)*f.height,s+=(h?-1:1)*f.height}),i}),KU=Ee(ws,on,UU,Pp,Op,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var f=zU(t,c);s==null&&(s=WU(t,n,e));var h=n==="left"&&!a||n==="right"&&a;i[c.id]=s-Number(h)*f.width,s+=(h?-1:1)*f.width}),i}),GU=(e,t)=>{var r=Ss(e,t);if(r!=null)return VU(e,r.orientation,r.mirror)},YU=Ee([on,Ss,GU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),XU=(e,t)=>{var r=Ns(e,t);if(r!=null)return KU(e,r.orientation,r.mirror)},qU=Ee([on,Ns,XU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),yP=Ee(on,Ns,(e,t)=>{var r=typeof t.width=="number"?t.width:Af;return{width:r,height:e.height}}),hT=(e,t,r)=>{switch(t){case"xAxis":return vP(e,r).width;case"yAxis":return yP(e,r).height;default:return}},wP=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,c=yo(e,n),f=t.map(h=>h.value);if(s&&c&&i==="category"&&a&&D4(f))return f}},Dw=Ee([Lt,Ap,Or,Tr],wP),bP=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=yo(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(c=>c.value)}},Iw=Ee([Lt,Ap,Lf,Tr],bP),pT=Ee([Lt,uU,$c,Uc,Dw,Iw,$f,Pw,Tr],(e,t,r,n,a,i,s,c,f)=>{if(t==null)return null;var h=yo(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:i,duplicateDomain:a,isCategorical:h,niceTicks:c,range:s,realScaleType:r,scale:n}}),ZU=(e,t,r,n,a,i,s,c,f)=>{if(!(t==null||n==null)){var h=yo(e,f),{type:d,ticks:m,tickCount:x}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,b=d==="category"&&n.bandwidth?n.bandwidth()/g:0;b=f==="angleAxis"&&i!=null&&i.length>=2?gn(i[0]-i[1])*2*b:b;var _=m||a;if(_){var w=_.map((S,A)=>{var T=s?s.indexOf(S):S;return{index:A,coordinate:n(T)+b,value:S,offset:b}});return w.filter(S=>!ai(S.coordinate))}return h&&c?c.map((S,A)=>({coordinate:n(S)+b,value:S,index:A,offset:b})):n.ticks?n.ticks(x).map(S=>({coordinate:n(S)+b,value:S,offset:b})):n.domain().map((S,A)=>({coordinate:n(S)+b,value:s?s[S]:S,index:A,offset:b}))}},_P=Ee([Lt,Lf,$c,Uc,Pw,$f,Dw,Iw,Tr],ZU),QU=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var c=yo(e,s),{tickCount:f}=t,h=0;return h=s==="angleAxis"&&n?.length>=2?gn(n[0]-n[1])*2*h:h,c&&i?i.map((d,m)=>({coordinate:r(d)+h,value:d,index:m,offset:h})):r.ticks?r.ticks(f).map(d=>({coordinate:r(d)+h,value:d,offset:h})):r.domain().map((d,m)=>({coordinate:r(d)+h,value:a?a[d]:d,index:m,offset:h}))}},so=Ee([Lt,Lf,Uc,$f,Dw,Iw,Tr],QU),oo=Ee(Or,Uc,(e,t)=>{if(!(e==null||t==null))return mh(mh({},e),{},{scale:t})}),JU=Ee([Or,$c,Cw,mP],Aw);Ee((e,t,r)=>mw(e,r),JU,(e,t)=>{if(!(e==null||t==null))return mh(mh({},e),{},{scale:t})});var ez=Ee([Lt,lp,cp],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),SP=e=>e.options.defaultTooltipEventType,NP=e=>e.options.validateTooltipEventTypes;function EP(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Rw(e,t){var r=SP(e),n=NP(e);return EP(t,r,n)}function tz(e){return ft(t=>Rw(t,e))}var TP=(e,t)=>{var r,n=Number(t);if(!(ai(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},rz=e=>e.tooltip.settings,Js={active:!1,index:null,dataKey:void 0,coordinate:void 0},nz={itemInteraction:{click:Js,hover:Js},axisInteraction:{click:Js,hover:Js},keyboardInteraction:Js,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},kP=Ha({name:"tooltip",initialState:nz,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:ra()},removeTooltipEntrySettings:{reducer(e,t){var r=os(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:ra()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:az,removeTooltipEntrySettings:iz,setTooltipSettingsState:sz,setActiveMouseOverItemIndex:CP,mouseLeaveItem:oz,mouseLeaveChart:AP,setActiveClickItemIndex:lz,setMouseOverAxisIndex:jP,setMouseClickAxisIndex:cz,setSyncInteraction:E1,setKeyboardInteraction:T1}=kP.actions,uz=kP.reducer;function mT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mT(Object(r),!0).forEach(function(n){fz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fz(e,t,r){return(t=dz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dz(e){var t=hz(e,"string");return typeof t=="symbol"?t:t+""}function hz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pz(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function mz(e){return e.index!=null}var PP=(e,t,r,n)=>{if(t==null)return Js;var a=pz(e,t,r);if(a==null)return Js;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(mz(a)){if(i)return u0(u0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return u0(u0({},Js),{},{coordinate:a.coordinate})},Fw=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Kn(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},OP=(e,t,r,n,a,i,s,c)=>{if(!(i==null||c==null)){var f=s[0],h=f==null?void 0:c(f.positions,i);if(h!=null)return h;var d=a?.[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},DP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Uf=e=>e.options.tooltipPayloadSearcher,zc=e=>e.tooltip;function xT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xT(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xz(e,t,r){return(t=gz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gz(e){var t=vz(e,"string");return typeof t=="symbol"?t:t+""}function vz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yz(e,t){return e??t}var IP=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:c,computedData:f,dataStartIndex:h,dataEndIndex:d}=r,m=[];return e.reduce((x,g)=>{var b,{dataDefinedOnItem:_,settings:w}=g,S=yz(_,c),A=Array.isArray(S)?SA(S,h,d):S,T=(b=w?.dataKey)!==null&&b!==void 0?b:n,D=w?.nameKey,O;if(n&&Array.isArray(A)&&!Array.isArray(A[0])&&s==="axis"?O=I4(A,n,a):O=i(A,t,f,D),Array.isArray(O))O.forEach(j=>{var z=gT(gT({},w),{},{name:j.name,unit:j.unit,color:void 0,fill:void 0});x.push(YN({tooltipEntrySettings:z,dataKey:j.dataKey,payload:j.payload,value:dr(j.payload,j.dataKey),name:j.name}))});else{var I;x.push(YN({tooltipEntrySettings:w,dataKey:T,payload:O,value:dr(O,T),name:(I=dr(O,D))!==null&&I!==void 0?I:w?.name}))}return x},m)}},Mw=Ee([un,Lt,tP,lw,cn],hP),wz=Ee([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),bz=Ee([cn,Mc],xw),zf=Ee([wz,un,bz],gw,{memoizeOptions:{resultEqualityCheck:kp}}),_z=Ee([zf],e=>e.filter(Ep)),Sz=Ee([zf],vw,{memoizeOptions:{resultEqualityCheck:kp}}),Hc=Ee([Sz,So],yw),Nz=Ee([_z,So,un],Qj),Lw=Ee([Hc,un,zf],bw),RP=Ee([un],_w),Ez=Ee([un],e=>e.allowDataOverflow),FP=Ee([RP,Ez],Cj),Tz=Ee([zf],e=>e.filter(Ep)),kz=Ee([Nz,Tz,Ff],iP),Cz=Ee([kz,So,cn,FP],sP),Az=Ee([zf],nP),jz=Ee([Hc,un,Az,jp,cn],Ew,{memoizeOptions:{resultEqualityCheck:Tp}}),Pz=Ee([oP,cn,Mc],Bc),Oz=Ee([Pz,cn],uP),Dz=Ee([lP,cn,Mc],Bc),Iz=Ee([Dz,cn],fP),Rz=Ee([cP,cn,Mc],Bc),Fz=Ee([Rz,cn],dP),Mz=Ee([Oz,Fz,Iz],xh),Lz=Ee([un,RP,FP,Cz,jz,Mz,Lt,cn],Tw),MP=Ee([un,Lt,Hc,Lw,Ff,cn,Lz],kw),Bz=Ee([MP,un,Mw],jw),$z=Ee([un,MP,Bz,cn],Ow),LP=e=>{var t=cn(e),r=Mc(e),n=!1;return $f(e,t,r,n)},BP=Ee([un,LP],Sp),$P=Ee([un,Mw,$z,BP],Aw),Uz=Ee([Lt,Lw,un,cn],wP),zz=Ee([Lt,Lw,un,cn],bP),Hz=(e,t,r,n,a,i,s,c)=>{if(t){var{type:f}=t,h=yo(e,c);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,m=f==="category"&&n.bandwidth?n.bandwidth()/d:0;return m=c==="angleAxis"&&a!=null&&a?.length>=2?gn(a[0]-a[1])*2*m:m,h&&s?s.map((x,g)=>({coordinate:n(x)+m,value:x,index:g,offset:m})):n.domain().map((x,g)=>({coordinate:n(x)+m,value:i?i[x]:x,index:g,offset:m}))}}},Es=Ee([Lt,un,Mw,$P,LP,Uz,zz,cn],Hz),Bw=Ee([SP,NP,rz],(e,t,r)=>EP(r.shared,e,t)),UP=e=>e.tooltip.settings.trigger,$w=e=>e.tooltip.settings.defaultIndex,Dp=Ee([zc,Bw,UP,$w],PP),lo=Ee([Dp,Hc],Fw),zP=Ee([Es,lo],TP),HP=Ee([Dp],e=>{if(e)return e.dataKey}),WP=Ee([zc,Bw,UP,$w],DP),Wz=Ee([ws,bs,Lt,on,Es,$w,WP,Uf],OP),Vz=Ee([Dp,Wz],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Kz=Ee([Dp],e=>e.active),Gz=Ee([WP,lo,So,Zj,zP,Uf,Bw],IP),Yz=Ee([Gz],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function vT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vT(Object(r),!0).forEach(function(n){Xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xz(e,t,r){return(t=qz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qz(e){var t=Zz(e,"string");return typeof t=="symbol"?t:t+""}function Zz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qz=()=>ft(un),Jz=()=>{var e=Qz(),t=ft(Es),r=ft($P);return cf(yT(yT({},e),{},{scale:r}),t)},eH=()=>ft(lw),Uw=(e,t)=>t,VP=(e,t,r)=>r,zw=(e,t,r,n)=>n,tH=Ee(Es,e=>rp(e,t=>t.coordinate)),Hw=Ee([zc,Uw,VP,zw],PP),KP=Ee([Hw,Hc],Fw),rH=(e,t,r)=>{if(t!=null){var n=zc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},GP=Ee([zc,Uw,VP,zw],DP),gh=Ee([ws,bs,Lt,on,Es,zw,GP,Uf],OP),nH=Ee([Hw,gh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),YP=Ee(Es,KP,TP),aH=Ee([GP,KP,So,Zj,YP,Uf,Uw],IP),iH=Ee([Hw],e=>({isActive:e.active,activeIndex:e.index})),sH=(e,t,r,n,a,i,s,c)=>{if(!(!e||!t||!n||!a||!i)){var f=vL(e.chartX,e.chartY,t,r,c);if(f){var h=wL(f,t),d=iL(h,s,i,n,a),m=yL(t,i,d,f);return{activeIndex:String(d),activeCoordinate:m}}}};function k1(){return k1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k1.apply(null,arguments)}function wT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wT(Object(r),!0).forEach(function(n){oH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oH(e,t,r){return(t=lH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lH(e){var t=cH(e,"string");return typeof t=="symbol"?t:t+""}function cH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uH(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:c,tooltipEventType:f,chartName:h}=e,d=t,m=r,x=n;if(!c||!d||h!=="ScatterChart"&&f!=="axis")return null;var g,b;if(h==="ScatterChart")g=d,b=S7;else if(h==="BarChart")g=N7(s,d,a,i),b=HA;else if(s==="radial"){var{cx:_,cy:w,radius:S,startAngle:A,endAngle:T}=WA(d);g={cx:_,cy:w,startAngle:A,endAngle:T,innerRadius:S,outerRadius:S},b=KA}else g={points:o9(s,d,a)},b=Ry;var D=typeof c=="object"&&"className"in c?c.className:void 0,O=f0(f0(f0(f0({stroke:"#ccc",pointerEvents:"none"},a),g),nl(c)),{},{payload:m,payloadIndex:x,className:Zt("recharts-tooltip-cursor",D)});return v.isValidElement(c)?v.cloneElement(c,O):v.createElement(b,O)}function fH(e){var t=Jz(),r=OA(),n=hp(),a=eH();return v.createElement(uH,k1({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var XP=v.createContext(null),dH=()=>v.useContext(XP),qg={exports:{}},bT;function hH(){return bT||(bT=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(f,h,d){this.fn=f,this.context=h,this.once=d||!1}function i(f,h,d,m,x){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new a(d,m||f,x),b=r?r+h:h;return f._events[b]?f._events[b].fn?f._events[b]=[f._events[b],g]:f._events[b].push(g):(f._events[b]=g,f._eventsCount++),f}function s(f,h){--f._eventsCount===0?f._events=new n:delete f._events[h]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var h=[],d,m;if(this._eventsCount===0)return h;for(m in d=this._events)t.call(d,m)&&h.push(r?m.slice(1):m);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},c.prototype.listeners=function(h){var d=r?r+h:h,m=this._events[d];if(!m)return[];if(m.fn)return[m.fn];for(var x=0,g=m.length,b=new Array(g);x<g;x++)b[x]=m[x].fn;return b},c.prototype.listenerCount=function(h){var d=r?r+h:h,m=this._events[d];return m?m.fn?1:m.length:0},c.prototype.emit=function(h,d,m,x,g,b){var _=r?r+h:h;if(!this._events[_])return!1;var w=this._events[_],S=arguments.length,A,T;if(w.fn){switch(w.once&&this.removeListener(h,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,m),!0;case 4:return w.fn.call(w.context,d,m,x),!0;case 5:return w.fn.call(w.context,d,m,x,g),!0;case 6:return w.fn.call(w.context,d,m,x,g,b),!0}for(T=1,A=new Array(S-1);T<S;T++)A[T-1]=arguments[T];w.fn.apply(w.context,A)}else{var D=w.length,O;for(T=0;T<D;T++)switch(w[T].once&&this.removeListener(h,w[T].fn,void 0,!0),S){case 1:w[T].fn.call(w[T].context);break;case 2:w[T].fn.call(w[T].context,d);break;case 3:w[T].fn.call(w[T].context,d,m);break;case 4:w[T].fn.call(w[T].context,d,m,x);break;default:if(!A)for(O=1,A=new Array(S-1);O<S;O++)A[O-1]=arguments[O];w[T].fn.apply(w[T].context,A)}}return!0},c.prototype.on=function(h,d,m){return i(this,h,d,m,!1)},c.prototype.once=function(h,d,m){return i(this,h,d,m,!0)},c.prototype.removeListener=function(h,d,m,x){var g=r?r+h:h;if(!this._events[g])return this;if(!d)return s(this,g),this;var b=this._events[g];if(b.fn)b.fn===d&&(!x||b.once)&&(!m||b.context===m)&&s(this,g);else{for(var _=0,w=[],S=b.length;_<S;_++)(b[_].fn!==d||x&&!b[_].once||m&&b[_].context!==m)&&w.push(b[_]);w.length?this._events[g]=w.length===1?w[0]:w:s(this,g)}return this},c.prototype.removeAllListeners=function(h){var d;return h?(d=r?r+h:h,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(qg)),qg.exports}var pH=hH();const mH=ys(pH);var xf=new mH,C1="recharts.syncEvent.tooltip",_T="recharts.syncEvent.brush";function Ww(e,t){if(t){var r=Number.parseInt(t,10);if(!ai(r))return e?.[r]}}var xH={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},qP=Ha({name:"options",initialState:xH,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),gH=qP.reducer,{createEventEmitter:vH}=qP.actions;function yH(e){return e.tooltip.syncInteraction}var wH={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},ZP=Ha({name:"chartData",initialState:wH,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:ST,setDataStartEndIndexes:bH,setComputedData:toe}=ZP.actions,_H=ZP.reducer,SH=["x","y"];function NT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NT(Object(r),!0).forEach(function(n){NH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NH(e,t,r){return(t=EH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EH(e){var t=TH(e,"string");return typeof t=="symbol"?t:t+""}function TH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kH(e,t){if(e==null)return{};var r,n,a=CH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var QP=()=>{};function AH(){var e=ft(cw),t=ft(uw),r=Mr(),n=ft(Vj),a=ft(Es),i=hp(),s=dp(),c=ft(f=>f.rootProps.className);v.useEffect(()=>{if(e==null)return QP;var f=(h,d,m)=>{if(t!==m&&e===h){if(n==="index"){var x;if(s&&d!==null&&d!==void 0&&(x=d.payload)!==null&&x!==void 0&&x.coordinate&&d.payload.sourceViewBox){var g=d.payload.coordinate,{x:b,y:_}=g,w=kH(g,SH),{x:S,y:A,width:T,height:D}=d.payload.sourceViewBox,O=Zl(Zl({},w),{},{x:s.x+(T?(b-S)/T:0)*s.width,y:s.y+(D?(_-A)/D:0)*s.height});r(Zl(Zl({},d),{},{payload:Zl(Zl({},d.payload),{},{coordinate:O})}))}else r(d);return}if(a!=null){var I;if(typeof n=="function"){var j={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},z=n(a,j);I=a[z]}else n==="value"&&(I=a.find(Ie=>String(Ie.value)===d.payload.label));var{coordinate:R}=d.payload;if(I==null||d.payload.active===!1||R==null||s==null){r(E1({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:q,y:V}=R,J=Math.min(q,s.x+s.width),ue=Math.min(V,s.y+s.height),Ne={x:i==="horizontal"?I.coordinate:J,y:i==="horizontal"?ue:I.coordinate},pe=E1({active:d.payload.active,coordinate:Ne,dataKey:d.payload.dataKey,index:String(I.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox});r(pe)}}};return xf.on(C1,f),()=>{xf.off(C1,f)}},[c,r,t,e,n,a,i,s])}function jH(){var e=ft(cw),t=ft(uw),r=Mr();v.useEffect(()=>{if(e==null)return QP;var n=(a,i,s)=>{t!==s&&e===a&&r(bH(i))};return xf.on(_T,n),()=>{xf.off(_T,n)}},[r,t,e])}function PH(){var e=Mr();v.useEffect(()=>{e(vH())},[e]),AH(),jH()}function OH(e,t,r,n,a,i){var s=ft(g=>rH(g,e,t)),c=ft(uw),f=ft(cw),h=ft(Vj),d=ft(yH),m=d?.active,x=dp();v.useEffect(()=>{if(!m&&f!=null&&c!=null){var g=E1({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:x});xf.emit(C1,f,g,c)}},[m,r,s,a,n,c,f,h,i,x])}function ET(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function TT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ET(Object(r),!0).forEach(function(n){DH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ET(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DH(e,t,r){return(t=IH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IH(e){var t=RH(e,"string");return typeof t=="symbol"?t:t+""}function RH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FH(e){return e.dataKey}function MH(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(t7,t)}var kT=[],LH={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!wo.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function A1(e){var t=jn(e,LH),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:c,isAnimationActive:f,offset:h,payloadUniqBy:d,position:m,reverseDirection:x,useTranslate3d:g,wrapperStyle:b,cursor:_,shared:w,trigger:S,defaultIndex:A,portal:T,axisId:D}=t,O=Mr(),I=typeof A=="number"?String(A):A;v.useEffect(()=>{O(sz({shared:w,trigger:S,axisId:D,active:r,defaultIndex:I}))},[O,w,S,D,r,I]);var j=dp(),z=LA(),R=tz(w),{activeIndex:q,isActive:V}=ft(Ve=>iH(Ve,R,S,I)),J=ft(Ve=>aH(Ve,R,S,I)),ue=ft(Ve=>YP(Ve,R,S,I)),Ne=ft(Ve=>nH(Ve,R,S,I)),pe=J,Ie=dH(),xe=r??V,[ye,ge]=q8([pe,xe]),Oe=R==="axis"?ue:void 0;OH(R,S,Ne,Oe,q,xe);var ie=T??Ie;if(ie==null)return null;var he=pe??kT;xe||(he=kT),c&&he.length&&(he=_8(pe.filter(Ve=>Ve.value!=null&&(Ve.hide!==!0||t.includeHidden)),d,FH));var De=he.length>0,We=v.createElement(l7,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:f,active:xe,coordinate:Ne,hasPayload:De,offset:h,position:m,reverseDirection:x,useTranslate3d:g,viewBox:j,wrapperStyle:b,lastBoundingBox:ye,innerRef:ge,hasPortalFromProps:!!T},MH(s,TT(TT({},t),{},{payload:he,label:Oe,active:xe,coordinate:Ne,accessibilityLayer:z})));return v.createElement(v.Fragment,null,MI.createPortal(We,ie),xe&&v.createElement(fH,{cursor:_,tooltipEventType:R,coordinate:Ne,payload:pe,index:q}))}var Hf=e=>null;Hf.displayName="Cell";function BH(e,t,r){return(t=$H(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $H(e){var t=UH(e,"string");return typeof t=="symbol"?t:t+""}function UH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class zH{constructor(t){BH(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function CT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CT(Object(r),!0).forEach(function(n){WH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WH(e,t,r){return(t=VH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VH(e){var t=KH(e,"string");return typeof t=="symbol"?t:t+""}function KH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GH={cacheSize:2e3,enableCache:!0},JP=HH({},GH),AT=new zH(JP.cacheSize),YH={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},jT="recharts_measurement_span";function XH(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(c)}var PT=(e,t)=>{try{var r=document.getElementById(jT);r||(r=document.createElement("span"),r.setAttribute("id",jT),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,YH,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Xu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||wo.isSsr)return{width:0,height:0};if(!JP.enableCache)return PT(t,r);var n=XH(t,r),a=AT.get(n);if(a)return a;var i=PT(t,r);return AT.set(n,i),i},OT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,DT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,e5={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QH=Object.keys(e5),sc="NaN";function JH(e,t){return e*e5[t]}class wa{static parse(t){var r,[,n,a]=(r=ZH.exec(t))!==null&&r!==void 0?r:[];return new wa(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ai(t)&&(this.unit=""),r!==""&&!qH.test(r)&&(this.num=NaN,this.unit=""),QH.includes(r)&&(this.num=JH(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new wa(NaN,""):new wa(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new wa(NaN,""):new wa(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new wa(NaN,""):new wa(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new wa(NaN,""):new wa(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ai(this.num)}}function t5(e){if(e.includes(sc))return sc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=OT.exec(t))!==null&&r!==void 0?r:[],s=wa.parse(n??""),c=wa.parse(i??""),f=a==="*"?s.multiply(c):s.divide(c);if(f.isNaN())return sc;t=t.replace(OT,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,[,d,m,x]=(h=DT.exec(t))!==null&&h!==void 0?h:[],g=wa.parse(d??""),b=wa.parse(x??""),_=m==="+"?g.add(b):g.subtract(b);if(_.isNaN())return sc;t=t.replace(DT,_.toString())}return t}var IT=/\(([^()]*)\)/;function eW(e){for(var t=e,r;(r=IT.exec(t))!=null;){var[,n]=r;t=t.replace(IT,t5(n))}return t}function tW(e){var t=e.replace(/\s+/g,"");return t=eW(t),t=t5(t),t}function rW(e){try{return tW(e)}catch{return sc}}function Zg(e){var t=rW(e.slice(5,-1));return t===sc?"":t}var nW=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],aW=["dx","dy","angle","className","breakAll"];function j1(){return j1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j1.apply(null,arguments)}function RT(e,t){if(e==null)return{};var r,n,a=iW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var r5=/[ \f\n\r\t\v\u2028\u2029]+/,n5=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Er(t)||(r?a=t.toString().split(""):a=t.toString().split(r5));var i=a.map(c=>({word:c,width:Xu(c,n).width})),s=r?0:Xu("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},sW=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:c,breakAll:f}=e,h=mt(i),d=s,m=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V.reduce((J,ue)=>{var{word:Ne,width:pe}=ue,Ie=J[J.length-1];if(Ie&&(n==null||a||Ie.width+pe+r<Number(n)))Ie.words.push(Ne),Ie.width+=pe+r;else{var xe={words:[Ne],width:pe};J.push(xe)}return J},[])},x=m(t),g=q=>q.reduce((V,J)=>V.width>J.width?V:J);if(!h||a)return x;var b=x.length>i||g(x).width>Number(n);if(!b)return x;for(var _="",w=q=>{var V=d.slice(0,q),J=n5({breakAll:f,style:c,children:V+_}).wordsWithComputedWidth,ue=m(J),Ne=ue.length>i||g(ue).width>Number(n);return[Ne,ue]},S=0,A=d.length-1,T=0,D;S<=A&&T<=d.length-1;){var O=Math.floor((S+A)/2),I=O-1,[j,z]=w(I),[R]=w(O);if(!j&&!R&&(S=O+1),j&&R&&(A=O-1),!j&&R){D=z;break}T++}return D||x},FT=e=>{var t=Er(e)?[]:e.toString().split(r5);return[{words:t}]},oW=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!wo.isSsr){var c,f,h=n5({breakAll:i,children:n,style:a});if(h){var{wordsWithComputedWidth:d,spaceWidth:m}=h;c=d,f=m}else return FT(n);return sW({breakAll:i,children:n,maxLines:s,style:a},c,f,t,r)}return FT(n)},MT="#808080",Ip=v.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:c="start",verticalAnchor:f="end",fill:h=MT}=e,d=RT(e,nW),m=v.useMemo(()=>oW({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:x,dy:g,angle:b,className:_,breakAll:w}=d,S=RT(d,aW);if(!$i(r)||!$i(n)||m.length===0)return null;var A=r+(mt(x)?x:0),T=n+(mt(g)?g:0),D;switch(f){case"start":D=Zg("calc(".concat(i,")"));break;case"middle":D=Zg("calc(".concat((m.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:D=Zg("calc(".concat(m.length-1," * -").concat(a,")"));break}var O=[];if(s){var I=m[0].width,{width:j}=d;O.push("scale(".concat(mt(j)?j/I:1,")"))}return b&&O.push("rotate(".concat(b,", ").concat(A,", ").concat(T,")")),O.length&&(S.transform=O.join(" ")),v.createElement("text",j1({},oa(S),{ref:t,x:A,y:T,className:Zt("recharts-text",_),textAnchor:c,fill:h.includes("url")?MT:h}),m.map((z,R)=>{var q=z.words.join(w?"":" ");return v.createElement("tspan",{x:A,dy:R===0?D:a,key:"".concat(q,"-").concat(R)},q)}))});Ip.displayName="Text";var lW=["labelRef"];function cW(e,t){if(e==null)return{};var r,n,a=uW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function LT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LT(Object(r),!0).forEach(function(n){fW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fW(e,t,r){return(t=dW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dW(e){var t=hW(e,"string");return typeof t=="symbol"?t:t+""}function hW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(){return ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ns.apply(null,arguments)}var a5=v.createContext(null),pW=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=v.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return v.createElement(a5.Provider,{value:s},i)},i5=()=>{var e=v.useContext(a5),t=dp();return e||t},mW=v.createContext(null),xW=()=>{var e=v.useContext(mW),t=ft(qj);return e||t},gW=e=>{var{value:t,formatter:r}=e,n=Er(e.children)?t:e.children;return typeof r=="function"?r(n):n},Vw=e=>e!=null&&typeof e=="function",vW=(e,t)=>{var r=gn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},yW=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:c,cy:f,innerRadius:h,outerRadius:d,startAngle:m,endAngle:x,clockWise:g}=a,b=(h+d)/2,_=vW(m,x),w=_>=0?1:-1,S,A;switch(t){case"insideStart":S=m+w*i,A=g;break;case"insideEnd":S=x-w*i,A=!g;break;case"end":S=x+w*i,A=g;break;default:throw new Error("Unsupported position ".concat(t))}A=_<=0?A:!A;var T=Xr(c,f,b,S),D=Xr(c,f,b,S+(A?1:-1)*359),O="M".concat(T.x,",").concat(T.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(A?0:1,`,
    `).concat(D.x,",").concat(D.y),I=Er(e.id)?af("recharts-radial-line-"):e.id;return v.createElement("text",ns({},n,{dominantBaseline:"central",className:Zt("recharts-radial-bar-label",s)}),v.createElement("defs",null,v.createElement("path",{id:I,d:O})),v.createElement("textPath",{xlinkHref:"#".concat(I)},r))},wW=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:c,endAngle:f}=e,h=(c+f)/2;if(r==="outside"){var{x:d,y:m}=Xr(n,a,s+t,h);return{x:d,y:m,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(i+s)/2,{x:g,y:b}=Xr(n,a,x,h);return{x:g,y:b,textAnchor:"middle",verticalAnchor:"middle"}},s5=e=>"cx"in e&&mt(e.cx),bW=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!s5(r)&&(i=r);var{x:s,y:c,width:f,height:h}=t,d=h>=0?1:-1,m=d*n,x=d>0?"end":"start",g=d>0?"start":"end",b=f>=0?1:-1,_=b*n,w=b>0?"end":"start",S=b>0?"start":"end";if(a==="top"){var A={x:s+f/2,y:c-d*n,textAnchor:"middle",verticalAnchor:x};return Br(Br({},A),i?{height:Math.max(c-i.y,0),width:f}:{})}if(a==="bottom"){var T={x:s+f/2,y:c+h+m,textAnchor:"middle",verticalAnchor:g};return Br(Br({},T),i?{height:Math.max(i.y+i.height-(c+h),0),width:f}:{})}if(a==="left"){var D={x:s-_,y:c+h/2,textAnchor:w,verticalAnchor:"middle"};return Br(Br({},D),i?{width:Math.max(D.x-i.x,0),height:h}:{})}if(a==="right"){var O={x:s+f+_,y:c+h/2,textAnchor:S,verticalAnchor:"middle"};return Br(Br({},O),i?{width:Math.max(i.x+i.width-O.x,0),height:h}:{})}var I=i?{width:f,height:h}:{};return a==="insideLeft"?Br({x:s+_,y:c+h/2,textAnchor:S,verticalAnchor:"middle"},I):a==="insideRight"?Br({x:s+f-_,y:c+h/2,textAnchor:w,verticalAnchor:"middle"},I):a==="insideTop"?Br({x:s+f/2,y:c+m,textAnchor:"middle",verticalAnchor:g},I):a==="insideBottom"?Br({x:s+f/2,y:c+h-m,textAnchor:"middle",verticalAnchor:x},I):a==="insideTopLeft"?Br({x:s+_,y:c+m,textAnchor:S,verticalAnchor:g},I):a==="insideTopRight"?Br({x:s+f-_,y:c+m,textAnchor:w,verticalAnchor:g},I):a==="insideBottomLeft"?Br({x:s+_,y:c+h-m,textAnchor:S,verticalAnchor:x},I):a==="insideBottomRight"?Br({x:s+f-_,y:c+h-m,textAnchor:w,verticalAnchor:x},I):a&&typeof a=="object"&&(mt(a.x)||ds(a.x))&&(mt(a.y)||ds(a.y))?Br({x:s+Hn(a.x,f),y:c+Hn(a.y,h),textAnchor:"end",verticalAnchor:"end"},I):Br({x:s+f/2,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},I)},_W={offset:5};function qs(e){var t=jn(e,_W),{viewBox:r,position:n,value:a,children:i,content:s,className:c="",textBreakAll:f,labelRef:h}=t,d=xW(),m=i5(),x=n==="center"?m:d??m,g=r||x;if(!g||Er(a)&&Er(i)&&!v.isValidElement(s)&&typeof s!="function")return null;var b=Br(Br({},t),{},{viewBox:g});if(v.isValidElement(s)){var{labelRef:_}=b,w=cW(b,lW);return v.cloneElement(s,w)}var S;if(typeof s=="function"){if(S=v.createElement(s,b),v.isValidElement(S))return S}else S=gW(t);var A=s5(g),T=oa(t);if(A&&(n==="insideStart"||n==="insideEnd"||n==="end"))return yW(t,n,S,T,g);var D=A?wW(g,t.offset,t.position):bW(t,g);return v.createElement(Ip,ns({ref:h,className:Zt("recharts-label",c)},T,D,{breakAll:f}),S)}qs.displayName="Label";var SW=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?v.createElement(qs,ns({key:"label-implicit"},n)):$i(e)?v.createElement(qs,ns({key:"label-implicit",value:e},n)):v.isValidElement(e)?e.type===qs?v.cloneElement(e,Br({key:"label-implicit"},n)):v.createElement(qs,ns({key:"label-implicit",content:e},n)):Vw(e)?v.createElement(qs,ns({key:"label-implicit",content:e},n)):e&&typeof e=="object"?v.createElement(qs,ns({},e,{key:"label-implicit"},n)):null};function NW(e){var{label:t,labelRef:r}=e,n=i5();return SW(t,n,r)||null}var Qg={},Jg={},BT;function EW(){return BT||(BT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Jg)),Jg}var ev={},$T;function TW(){return $T||($T=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(ev)),ev}var UT;function kW(){return UT||(UT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EW(),r=TW(),n=Ty();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Qg)),Qg}var tv,zT;function CW(){return zT||(zT=1,tv=kW().last),tv}var AW=CW();const jW=ys(AW);var PW=["valueAccessor"],OW=["dataKey","clockWise","id","textBreakAll"];function vh(){return vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vh.apply(null,arguments)}function HT(e,t){if(e==null)return{};var r,n,a=DW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var IW=e=>Array.isArray(e.value)?jW(e.value):e.value,o5=v.createContext(void 0),l5=o5.Provider,c5=v.createContext(void 0),RW=c5.Provider;function FW(){return v.useContext(o5)}function MW(){return v.useContext(c5)}function D0(e){var{valueAccessor:t=IW}=e,r=HT(e,PW),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,c=HT(r,OW),f=FW(),h=MW(),d=f||h;return!d||!d.length?null:v.createElement(Cn,{className:"recharts-label-list"},d.map((m,x)=>{var g,b=Er(n)?t(m,x):dr(m&&m.payload,n),_=Er(i)?{}:{id:"".concat(i,"-").concat(x)};return v.createElement(qs,vh({key:"label-".concat(x)},oa(m),c,_,{fill:(g=r.fill)!==null&&g!==void 0?g:m.fill,parentViewBox:m.parentViewBox,value:b,textBreakAll:s,viewBox:m.viewBox,index:x}))}))}D0.displayName="LabelList";function Kw(e){var{label:t}=e;return t?t===!0?v.createElement(D0,{key:"labelList-implicit"}):v.isValidElement(t)||Vw(t)?v.createElement(D0,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(D0,vh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function P1(){return P1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P1.apply(null,arguments)}var u5=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=Zt("recharts-dot",a);return t===+t&&r===+r&&n===+n?v.createElement("circle",P1({},Ua(e),Ey(e),{className:i,cx:t,cy:r,r:n})):null},f5=e=>e.graphicalItems.polarItems,LW=Ee([Tr,Mf],xw),Rp=Ee([f5,Or,LW],gw),BW=Ee([Rp],vw),Fp=Ee([BW,iw],yw),$W=Ee([Fp,Or,Rp],bw);Ee([Fp,Or,Rp],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=dr(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:dr(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var WT=()=>{},UW=Ee([Fp,Or,Rp,jp,Tr],Ew),zW=Ee([Or,Sw,Nw,WT,UW,WT,Lt,Tr],Tw),d5=Ee([Or,Lt,Fp,$W,Ff,Tr,zW],kw),HW=Ee([d5,Or,$c],jw);Ee([Or,d5,HW,Tr],Ow);var WW={radiusAxis:{},angleAxis:{}},h5=Ha({name:"polarAxis",initialState:WW,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:roe,removeRadiusAxis:noe,addAngleAxis:aoe,removeAngleAxis:ioe}=h5.actions,VW=h5.reducer;function VT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VT(Object(r),!0).forEach(function(n){KW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KW(e,t,r){return(t=GW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GW(e){var t=YW(e,"string");return typeof t=="symbol"?t:t+""}function YW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XW=(e,t)=>t,Gw=Ee([f5,XW],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),qW=[],Yw=(e,t,r)=>r?.length===0?qW:r,p5=Ee([iw,Gw,Yw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>KT(KT({},t.presentationProps),i.props))),a!=null)return a}}),ZW=Ee([p5,Gw,Yw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=dr(n,t.nameKey,t.name),c;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?c=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?c=n.fill:c=t.fill,{value:Dc(s,t.dataKey),color:c,payload:n,type:t.legendType}})}),QW=Ee([p5,Gw,Yw,on],(e,t,r,n)=>{if(!(t==null||e==null))return QV({offset:n,pieSettings:t,displayedData:e,cells:r})}),rv={exports:{}},nr={};var GT;function JW(){if(GT)return nr;GT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function b(_){if(typeof _=="object"&&_!==null){var w=_.$$typeof;switch(w){case e:switch(_=_.type,_){case r:case a:case n:case f:case h:case x:return _;default:switch(_=_&&_.$$typeof,_){case s:case c:case m:case d:return _;case i:return _;default:return w}}case t:return w}}}return nr.ContextConsumer=i,nr.ContextProvider=s,nr.Element=e,nr.ForwardRef=c,nr.Fragment=r,nr.Lazy=m,nr.Memo=d,nr.Portal=t,nr.Profiler=a,nr.StrictMode=n,nr.Suspense=f,nr.SuspenseList=h,nr.isContextConsumer=function(_){return b(_)===i},nr.isContextProvider=function(_){return b(_)===s},nr.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===e},nr.isForwardRef=function(_){return b(_)===c},nr.isFragment=function(_){return b(_)===r},nr.isLazy=function(_){return b(_)===m},nr.isMemo=function(_){return b(_)===d},nr.isPortal=function(_){return b(_)===t},nr.isProfiler=function(_){return b(_)===a},nr.isStrictMode=function(_){return b(_)===n},nr.isSuspense=function(_){return b(_)===f},nr.isSuspenseList=function(_){return b(_)===h},nr.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===r||_===a||_===n||_===f||_===h||typeof _=="object"&&_!==null&&(_.$$typeof===m||_.$$typeof===d||_.$$typeof===s||_.$$typeof===i||_.$$typeof===c||_.$$typeof===g||_.getModuleId!==void 0)},nr.typeOf=b,nr}var YT;function eV(){return YT||(YT=1,rv.exports=JW()),rv.exports}var tV=eV(),XT=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",qT=null,nv=null,m5=e=>{if(e===qT&&Array.isArray(nv))return nv;var t=[];return v.Children.forEach(e,r=>{Er(r)||(tV.isFragment(r)?t=t.concat(m5(r.props.children)):t.push(r))}),nv=t,qT=e,t};function Xw(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>XT(a)):n=[XT(t)],m5(e).forEach(a=>{var i=al(a,"type.displayName")||al(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var x5=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,av={},ZT;function rV(){return ZT||(ZT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(av)),av}var iv,QT;function nV(){return QT||(QT=1,iv=rV().isPlainObject),iv}var aV=nV();const iV=ys(aV);function JT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ek(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JT(Object(r),!0).forEach(function(n){sV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sV(e,t,r){return(t=oV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oV(e){var t=lV(e,"string");return typeof t=="symbol"?t:t+""}function lV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yh.apply(null,arguments)}var tk=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},cV={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},uV=e=>{var t=jn(e,cV),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:c}=t,{animationEasing:f,animationDuration:h,animationBegin:d,isUpdateAnimationActive:m}=t,x=v.useRef(null),[g,b]=v.useState(-1),_=v.useRef(a),w=v.useRef(i),S=v.useRef(s),A=v.useRef(r),T=v.useRef(n),D=Pf(e,"trapezoid-");if(v.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var Ne=x.current.getTotalLength();Ne&&b(Ne)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var O=Zt("recharts-trapezoid",c);if(!m)return v.createElement("g",null,v.createElement("path",yh({},oa(t),{className:O,d:tk(r,n,a,i,s)})));var I=_.current,j=w.current,z=S.current,R=A.current,q=T.current,V="0px ".concat(g===-1?1:g,"px"),J="".concat(g,"px 0px"),ue=BA(["strokeDasharray"],h,f);return v.createElement(jf,{animationId:D,key:D,canBegin:g>0,duration:h,easing:f,isActive:m,begin:d},Ne=>{var pe=Fr(I,a,Ne),Ie=Fr(j,i,Ne),xe=Fr(z,s,Ne),ye=Fr(R,r,Ne),ge=Fr(q,n,Ne);x.current&&(_.current=pe,w.current=Ie,S.current=xe,A.current=ye,T.current=ge);var Oe=Ne>0?{transition:ue,strokeDasharray:J}:{strokeDasharray:V};return v.createElement("path",yh({},oa(t),{className:O,d:tk(ye,ge,pe,Ie,xe),ref:x,style:ek(ek({},Oe),t.style)}))})},fV=["option","shapeType","propTransformer","activeClassName","isActive"];function dV(e,t){if(e==null)return{};var r,n,a=hV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rk(Object(r),!0).forEach(function(n){pV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pV(e,t,r){return(t=mV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mV(e){var t=xV(e,"string");return typeof t=="symbol"?t:t+""}function xV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gV(e,t){return wh(wh({},t),e)}function vV(e,t){return e==="symbols"}function nk(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(HA,r);case"trapezoid":return v.createElement(uV,r);case"sector":return v.createElement(KA,r);case"symbols":if(vV(t))return v.createElement(F4,r);break;default:return null}}function yV(e){return v.isValidElement(e)?e.props:e}function g5(e){var{option:t,shapeType:r,propTransformer:n=gV,activeClassName:a="recharts-active-shape",isActive:i}=e,s=dV(e,fV),c;if(v.isValidElement(t))c=v.cloneElement(t,wh(wh({},s),yV(t)));else if(typeof t=="function")c=t(s);else if(iV(t)&&typeof t!="boolean"){var f=n(t,s);c=v.createElement(nk,{shapeType:r,elementProps:f})}else{var h=s;c=v.createElement(nk,{shapeType:r,elementProps:h})}return i?v.createElement(Cn,{className:a},c):c}var qw=(e,t)=>{var r=Mr();return(n,a)=>i=>{e?.(n,a,i),r(CP({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Zw=e=>{var t=Mr();return(r,n)=>a=>{e?.(r,n,a),t(oz())}},Qw=(e,t)=>{var r=Mr();return(n,a)=>i=>{e?.(n,a,i),r(lz({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Jw(e){var{fn:t,args:r}=e,n=Mr(),a=la();return v.useLayoutEffect(()=>{if(!a){var i=t(r);return n(az(i)),()=>{n(iz(i))}}},[t,r,n,a]),null}var v5=()=>{};function y5(e){var{legendPayload:t}=e,r=Mr(),n=la();return v.useLayoutEffect(()=>n?v5:(r(FA(t)),()=>{r(MA(t))}),[r,n,t]),null}function wV(e){var{legendPayload:t}=e,r=Mr(),n=ft(Lt);return v.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?v5:(r(FA(t)),()=>{r(MA(t))}),[r,n,t]),null}var sv,bV=()=>{var[e]=v.useState(()=>af("uid-"));return e},_V=(sv=qC.useId)!==null&&sv!==void 0?sv:bV;function SV(e,t){var r=_V();return t||(e?"".concat(e,"-").concat(r):r)}var NV=v.createContext(void 0),eb=e=>{var{id:t,type:r,children:n}=e,a=SV("recharts-".concat(r),t);return v.createElement(NV.Provider,{value:a},n(a))},EV={cartesianItems:[],polarItems:[]},w5=Ha({name:"graphicalItems",initialState:EV,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:ra()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=os(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:ra()},removeCartesianGraphicalItem:{reducer(e,t){var r=os(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:ra()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:ra()},removePolarGraphicalItem:{reducer(e,t){var r=os(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:ra()}}}),{addCartesianGraphicalItem:TV,replaceCartesianGraphicalItem:kV,removeCartesianGraphicalItem:CV,addPolarGraphicalItem:AV,removePolarGraphicalItem:jV}=w5.actions,PV=w5.reducer;function b5(e){var t=Mr(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(TV(e)):r.current!==e&&t(kV({prev:r.current,next:e})),r.current=e},[t,e]),v.useLayoutEffect(()=>()=>{r.current&&(t(CV(r.current)),r.current=null)},[t]),null}function OV(e){var t=Mr();return v.useLayoutEffect(()=>(t(AV(e)),()=>{t(jV(e))}),[t,e]),null}var DV=["onMouseEnter","onClick","onMouseLeave"],IV=["id"],RV=["id"];function tb(e,t){if(e==null)return{};var r,n,a=FV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function FV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ak(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ak(Object(r),!0).forEach(function(n){MV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ak(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MV(e,t,r){return(t=LV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LV(e){var t=BV(e,"string");return typeof t=="symbol"?t:t+""}function BV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function co(){return co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},co.apply(null,arguments)}function $V(e){var t=v.useMemo(()=>Xw(e.children,Hf),[e.children]),r=ft(n=>ZW(n,e.id,t));return r==null?null:v.createElement(wV,{legendPayload:r})}function UV(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:c,hide:f,tooltipType:h}=e;return{dataDefinedOnItem:n.map(d=>d.tooltipPayload),positions:n.map(d=>d.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Dc(c,t),hide:f,type:h,color:s,unit:""}}}var zV=(e,t)=>e>t?"start":e<t?"end":"middle",HV=(e,t,r)=>Hn(typeof t=="function"?t(e):t,r,r*.8),WV=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,c=_A(i,s),f=a+Hn(e.cx,i,i/2),h=n+Hn(e.cy,s,s/2),d=Hn(e.innerRadius,c,0),m=HV(r,e.outerRadius,c),x=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:f,cy:h,innerRadius:d,outerRadius:m,maxRadius:x}},VV=(e,t)=>{var r=gn(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function KV(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var GV=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Zt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(Ry,co({},t,{type:"linear",className:r}))},YV=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),v.isValidElement(n)))return n;var a=Zt("recharts-pie-label-text",KV(e));return v.createElement(Ip,co({},t,{alignmentBaseline:"middle",className:a}),n)};function XV(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var c=Ua(r),f=nl(a),h=nl(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,m=t.map((x,g)=>{var b=(x.startAngle+x.endAngle)/2,_=Xr(x.cx,x.cy,x.outerRadius+d,b),w=br(br(br(br({},c),x),{},{stroke:"none"},f),{},{index:g,textAnchor:zV(_.x,x.cx)},_),S=br(br(br(br({},c),x),{},{fill:"none",stroke:x.fill},h),{},{index:g,points:[Xr(x.cx,x.cy,x.outerRadius,b),_],key:"line"});return v.createElement(Cn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(g)},i&&GV(i,S),YV(a,w,dr(x,s)))});return v.createElement(Cn,{className:"recharts-pie-labels"},m)}function qV(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?v.createElement(Kw,{label:a}):v.createElement(XV,{sectors:t,props:r,showLabels:n})}function ZV(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=ft(lo),{onMouseEnter:s,onClick:c,onMouseLeave:f}=a,h=tb(a,DV),d=qw(s,a.dataKey),m=Zw(f),x=Qw(c,a.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((g,b)=>{if(g?.startAngle===0&&g?.endAngle===0&&t.length!==1)return null;var _=r&&String(b)===i,w=i?n:null,S=_?r:w,A=br(br({},g),{},{stroke:g.stroke,tabIndex:-1,[kA]:b,[CA]:a.dataKey});return v.createElement(Cn,co({key:"sector-".concat(g?.startAngle,"-").concat(g?.endAngle,"-").concat(g.midAngle,"-").concat(b),tabIndex:-1,className:"recharts-pie-sector"},tp(h,g,b),{onMouseEnter:d(g,b),onMouseLeave:m(g,b),onClick:x(g,b)}),v.createElement(g5,co({option:S,isActive:_,shapeType:"sector"},A)))}))}function QV(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:c,endAngle:f,dataKey:h,nameKey:d,tooltipType:m}=r,x=Math.abs(r.minAngle),g=VV(c,f),b=Math.abs(g),_=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,w=n.filter(I=>dr(I,h,0)!==0).length,S=(b>=360?w:w-1)*_,A=b-w*x-S,T=n.reduce((I,j)=>{var z=dr(j,h,0);return I+(mt(z)?z:0)},0),D;if(T>0){var O;D=n.map((I,j)=>{var z=dr(I,h,0),R=dr(I,d,j),q=WV(r,i,I),V=(mt(z)?z:0)/T,J,ue=br(br({},I),a&&a[j]&&a[j].props);j?J=O.endAngle+gn(g)*_*(z!==0?1:0):J=c;var Ne=J+gn(g)*((z!==0?x:0)+V*A),pe=(J+Ne)/2,Ie=(q.innerRadius+q.outerRadius)/2,xe=[{name:R,value:z,payload:ue,dataKey:h,type:m}],ye=Xr(q.cx,q.cy,Ie,pe);return O=br(br(br(br({},r.presentationProps),{},{percent:V,cornerRadius:s,name:R,tooltipPayload:xe,midAngle:pe,middleRadius:Ie,tooltipPosition:ye},ue),q),{},{value:z,startAngle:J,endAngle:Ne,payload:ue,paddingAngle:gn(g)*_}),O})}return D}function JV(e){var{showLabels:t,sectors:r,children:n}=e,a=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(RW,{value:t?a:void 0},n)}function eK(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:c,activeShape:f,inactiveShape:h,onAnimationStart:d,onAnimationEnd:m}=t,x=Pf(t,"recharts-pie-"),g=r.current,[b,_]=v.useState(!1),w=v.useCallback(()=>{typeof m=="function"&&m(),_(!1)},[m]),S=v.useCallback(()=>{typeof d=="function"&&d(),_(!0)},[d]);return v.createElement(JV,{showLabels:!b,sectors:n},v.createElement(jf,{animationId:x,begin:i,duration:s,isActive:a,easing:c,onAnimationStart:S,onAnimationEnd:w,key:x},A=>{var T=[],D=n&&n[0],O=D?.startAngle;return n?.forEach((I,j)=>{var z=g&&g[j],R=j>0?al(I,"paddingAngle",0):0;if(z){var q=Fr(z.endAngle-z.startAngle,I.endAngle-I.startAngle,A),V=br(br({},I),{},{startAngle:O+R,endAngle:O+q+R});T.push(V),O=V.endAngle}else{var{endAngle:J,startAngle:ue}=I,Ne=Fr(0,J-ue,A),pe=br(br({},I),{},{startAngle:O+R,endAngle:O+Ne+R});T.push(pe),O=pe.endAngle}}),r.current=T,v.createElement(Cn,null,v.createElement(ZV,{sectors:T,activeShape:f,inactiveShape:h,allOtherPieProps:t}))}),v.createElement(qV,{showLabels:!b,sectors:n,props:t}),t.children)}var tK={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!wo.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function rK(e){var{id:t}=e,r=tb(e,IV),{hide:n,className:a,rootTabIndex:i}=e,s=v.useMemo(()=>Xw(e.children,Hf),[e.children]),c=ft(d=>QW(d,t,s)),f=v.useRef(null),h=Zt("recharts-pie",a);return n||c==null?(f.current=null,v.createElement(Cn,{tabIndex:i,className:h})):v.createElement(v.Fragment,null,v.createElement(Jw,{fn:UV,args:br(br({},e),{},{sectors:c})}),v.createElement(Cn,{tabIndex:i,className:h},v.createElement(eK,{props:br(br({},r),{},{sectors:c}),previousSectorsRef:f})))}function _5(e){var t=jn(e,tK),{id:r}=t,n=tb(t,RV),a=Ua(n);return v.createElement(eb,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(OV,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),v.createElement($V,co({},n,{id:i})),v.createElement(rK,co({},n,{id:i}))))}_5.displayName="Pie";function ik(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ik(Object(r),!0).forEach(function(n){nK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ik(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nK(e,t,r){return(t=aK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aK(e){var t=iK(e,"string");return typeof t=="symbol"?t:t+""}function iK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sK={xAxis:{},yAxis:{},zAxis:{}},S5=Ha({name:"cartesianAxis",initialState:sK,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:ra()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:ra()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:ra()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:ra()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:ra()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:ra()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=sk(sk({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:oK,removeXAxis:lK,addYAxis:cK,removeYAxis:uK,addZAxis:soe,removeZAxis:ooe,updateYAxisWidth:fK}=S5.actions,dK=S5.reducer,hK=Ee([on],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),pK=Ee([hK,ws,bs],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),rb=()=>ft(pK),mK=()=>ft(Yz);function ok(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ok(Object(r),!0).forEach(function(n){xK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ok(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yK=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=lk(lk({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},nl(a)),Ey(a)),c;return v.isValidElement(a)?c=v.cloneElement(a,s):typeof a=="function"?c=a(s):c=v.createElement(u5,s),v.createElement(Cn,{className:"recharts-active-dot"},c)};function wK(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=ft(lo),s=mK();if(t==null||s==null)return null;var c=t.find(f=>s.includes(f.payload));return Er(c)?null:yK({point:c,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var bK="Invariant failed";function _K(e,t){throw new Error(bK)}var SK=["x","y"];function O1(){return O1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O1.apply(null,arguments)}function ck(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ck(Object(r),!0).forEach(function(n){NK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ck(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NK(e,t,r){return(t=EK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EK(e){var t=TK(e,"string");return typeof t=="symbol"?t:t+""}function TK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kK(e,t){if(e==null)return{};var r,n,a=CK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function AK(e,t){var{x:r,y:n}=e,a=kK(e,SK),i="".concat(r),s=parseInt(i,10),c="".concat(n),f=parseInt(c,10),h="".concat(t.height||a.height),d=parseInt(h,10),m="".concat(t.width||a.width),x=parseInt(m,10);return Mu(Mu(Mu(Mu(Mu({},t),a),s?{x:s}:{}),f?{y:f}:{}),{},{height:d,width:x,name:t.name,radius:t.radius})}function nb(e){return v.createElement(g5,O1({shapeType:"rectangle",propTransformer:AK,activeClassName:"recharts-active-bar"},e))}var jK=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(mt(t))return t;var i=mt(n)||Er(n);return i?t(n,a):(i||_K(),r)}},PK={},N5=Ha({name:"errorBars",initialState:PK,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:loe,replaceErrorBar:coe,removeErrorBar:uoe}=N5.actions,OK=N5.reducer,DK=["children"];function IK(e,t){if(e==null)return{};var r,n,a=RK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function RK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FK={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},MK=v.createContext(FK);function E5(e){var{children:t}=e,r=IK(e,DK);return v.createElement(MK.Provider,{value:r},t)}function ab(e,t){var r,n,a=ft(h=>Ss(h,e)),i=ft(h=>Ns(h,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:Aa.allowDataOverflow,c=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ja.allowDataOverflow,f=s||c;return{needClip:f,needClipX:s,needClipY:c}}function T5(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=rb(),{needClipX:i,needClipY:s,needClip:c}=ab(t,r);if(!c)return null;var{x:f,y:h,width:d,height:m}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:i?f:f-d/2,y:s?h:h-m/2,width:i?d:d*2,height:s?m:m*2}))}var LK=["onMouseEnter","onMouseLeave","onClick"],BK=["value","background","tooltipPosition"],$K=["id"],UK=["onMouseEnter","onClick","onMouseLeave"];function uo(){return uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uo.apply(null,arguments)}function uk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function na(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uk(Object(r),!0).forEach(function(n){zK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zK(e,t,r){return(t=HK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HK(e){var t=WK(e,"string");return typeof t=="symbol"?t:t+""}function WK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bh(e,t){if(e==null)return{};var r,n,a=VK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KK=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Dc(r,t),payload:e}]};function GK(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:c}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Dc(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:c}}}function YK(e){var t=ft(lo),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:c,onClick:f}=i,h=bh(i,LK),d=qw(s,n),m=Zw(c),x=Qw(f,n);if(!a||r==null)return null;var g=nl(a);return v.createElement(v.Fragment,null,r.map((b,_)=>{var{value:w,background:S,tooltipPosition:A}=b,T=bh(b,BK);if(!S)return null;var D=d(b,_),O=m(b,_),I=x(b,_),j=na(na(na(na(na({option:a,isActive:String(_)===t},T),{},{fill:"#eee"},S),g),tp(h,b,_)),{},{onMouseEnter:D,onMouseLeave:O,onClick:I,dataKey:n,index:_,className:"recharts-bar-background-rectangle"});return v.createElement(nb,uo({key:"background-bar-".concat(_)},j))}))}function XK(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return na(na({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return v.createElement(l5,{value:t?a:void 0},r)}function qK(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,c=ft(lo),f=ft(HP),h=r&&String(i)===c&&(f==null||s===f),d=h?r:t;return v.createElement(nb,uo({},n,{name:String(n.name)},a,{isActive:h,option:d,index:i,dataKey:s}))}function ZK(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return v.createElement(nb,uo({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function QK(e){var{data:t,props:r}=e,n=Ua(r),{id:a}=n,i=bh(n,$K),{shape:s,dataKey:c,activeBar:f}=r,{onMouseEnter:h,onClick:d,onMouseLeave:m}=r,x=bh(r,UK),g=qw(h,c),b=Zw(m),_=Qw(d,c);return t?v.createElement(v.Fragment,null,t.map((w,S)=>v.createElement(Cn,uo({key:"rectangle-".concat(w?.x,"-").concat(w?.y,"-").concat(w?.value,"-").concat(S),className:"recharts-bar-rectangle"},tp(x,w,S),{onMouseEnter:g(w,S),onMouseLeave:b(w,S),onClick:_(w,S)}),f?v.createElement(qK,{shape:s,activeBar:f,baseProps:i,entry:w,index:S,dataKey:c}):v.createElement(ZK,{shape:s,baseProps:i,entry:w,index:S,dataKey:c})))):null}function JK(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:c,animationEasing:f,onAnimationEnd:h,onAnimationStart:d}=t,m=r.current,x=Pf(t,"recharts-bar-"),[g,b]=v.useState(!1),_=!g,w=v.useCallback(()=>{typeof h=="function"&&h(),b(!1)},[h]),S=v.useCallback(()=>{typeof d=="function"&&d(),b(!0)},[d]);return v.createElement(XK,{showLabels:_,rects:n},v.createElement(jf,{animationId:x,begin:s,duration:c,isActive:i,easing:f,onAnimationEnd:w,onAnimationStart:S,key:x},A=>{var T=A===1?n:n?.map((D,O)=>{var I=m&&m[O];if(I)return na(na({},D),{},{x:Fr(I.x,D.x,A),y:Fr(I.y,D.y,A),width:Fr(I.width,D.width,A),height:Fr(I.height,D.height,A)});if(a==="horizontal"){var j=Fr(0,D.height,A);return na(na({},D),{},{y:D.y+D.height-j,height:j})}var z=Fr(0,D.width,A);return na(na({},D),{},{width:z})});return A>0&&(r.current=T??null),T==null?null:v.createElement(Cn,null,v.createElement(QK,{props:t,data:T}))}),v.createElement(Kw,{label:t.label}),t.children)}function eG(e){var t=v.useRef(null);return v.createElement(JK,{previousRectanglesRef:t,props:e})}var k5=0,tG=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:dr(e,t)}};class rG extends v.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:c,background:f,id:h}=this.props;if(t||r==null)return null;var d=Zt("recharts-bar",a),m=h;return v.createElement(Cn,{className:d,id:h},c&&v.createElement("defs",null,v.createElement(T5,{clipPathId:m,xAxisId:i,yAxisId:s})),v.createElement(Cn,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(m,")"):void 0},v.createElement(YK,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),v.createElement(eG,this.props)))}}var nG={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!wo.isSsr,legendType:"rect",minPointSize:k5,xAxisId:0,yAxisId:0};function aG(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:f,animationEasing:h,isAnimationActive:d}=e,{needClip:m}=ab(t,r),x=hp(),g=la(),b=Xw(e.children,Hf),_=ft(A=>OG(A,t,r,g,e.id,b));if(x!=="vertical"&&x!=="horizontal")return null;var w,S=_?.[0];return S==null||S.height==null||S.width==null?w=0:w=x==="vertical"?S.height/2:S.width/2,v.createElement(E5,{xAxisId:t,yAxisId:r,data:_,dataPointFormatter:tG,errorBarOffset:w},v.createElement(rG,uo({},e,{layout:x,needClip:m,data:_,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:c,animationDuration:f,animationEasing:h,isAnimationActive:d})))}function iG(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:c,xAxisTicks:f,yAxisTicks:h,stackedData:d,displayedData:m,offset:x,cells:g,parentViewBox:b}=e,_=t==="horizontal"?c:s,w=d?_.scale.domain():null,S=pL({numericAxis:_});return m.map((A,T)=>{var D,O,I,j,z,R;d?D=lL(d[T],w):(D=dr(A,r),Array.isArray(D)||(D=[S,D]));var q=jK(n,k5)(D[1],T);if(t==="horizontal"){var V,[J,ue]=[c.scale(D[0]),c.scale(D[1])];O=VN({axis:s,ticks:f,bandSize:i,offset:a.offset,entry:A,index:T}),I=(V=ue??J)!==null&&V!==void 0?V:void 0,j=a.size;var Ne=J-ue;if(z=ai(Ne)?0:Ne,R={x:O,y:x.top,width:j,height:x.height},Math.abs(q)>0&&Math.abs(z)<Math.abs(q)){var pe=gn(z||q)*(Math.abs(q)-Math.abs(z));I-=pe,z+=pe}}else{var[Ie,xe]=[s.scale(D[0]),s.scale(D[1])];if(O=Ie,I=VN({axis:c,ticks:h,bandSize:i,offset:a.offset,entry:A,index:T}),j=xe-Ie,z=a.size,R={x:x.left,y:I,width:x.width,height:z},Math.abs(q)>0&&Math.abs(j)<Math.abs(q)){var ye=gn(j||q)*(Math.abs(q)-Math.abs(j));j+=ye}}if(O==null||I==null||j==null||z==null)return null;var ge=na(na({},A),{},{x:O,y:I,width:j,height:z,value:d?D:D[1],payload:A,background:R,tooltipPosition:{x:O+j/2,y:I+z/2},parentViewBox:b},g&&g[T]&&g[T].props);return ge}).filter(Boolean)}function sG(e){var t=jn(e,nG),r=la();return v.createElement(eb,{id:t.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(y5,{legendPayload:KK(t)}),v.createElement(Jw,{fn:GK,args:t}),v.createElement(b5,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:hL(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(aG,uo({},t,{id:n}))))}var D1=v.memo(sG);D1.displayName="Bar";function fk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fk(Object(r),!0).forEach(function(n){oG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oG(e,t,r){return(t=lG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lG(e){var t=cG(e,"string");return typeof t=="symbol"?t:t+""}function cG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uG=(e,t)=>t,fG=(e,t,r)=>r,dG=(e,t,r,n)=>n,hG=(e,t,r,n,a)=>a,Wf=Ee([Cp,hG],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),pG=Ee([Wf],e=>e?.maxBarSize),mG=(e,t,r,n,a,i)=>i,dk=(e,t,r)=>{var n=r??e;if(!Er(n))return Hn(n,t,0)},xG=Ee([Lt,Cp,uG,fG,dG],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),gG=(e,t,r,n)=>{var a=Lt(e);return a==="horizontal"?N1(e,"yAxis",r,n):N1(e,"xAxis",t,n)},vG=(e,t,r)=>{var n=Lt(e);return n==="horizontal"?hT(e,"xAxis",t):hT(e,"yAxis",r)},yG=(e,t,r)=>{var n={},a=e.filter(Ep),i=e.filter(h=>h.stackId==null),s=a.reduce((h,d)=>(h[d.stackId]||(h[d.stackId]=[]),h[d.stackId].push(d),h),n),c=Object.entries(s).map(h=>{var[d,m]=h,x=m.map(b=>b.dataKey),g=dk(t,r,m[0].barSize);return{stackId:d,dataKeys:x,barSize:g}}),f=i.map(h=>{var d=[h.dataKey].filter(x=>x!=null),m=dk(t,r,h.barSize);return{stackId:void 0,dataKeys:d,barSize:m}});return[...c,...f]},wG=Ee([xG,eU,vG],yG),bG=(e,t,r,n,a)=>{var i,s,c=Wf(e,t,r,n,a);if(c!=null){var f=Lt(e),h=Hj(e),{maxBarSize:d}=c,m=Er(d)?h:d,x,g;return f==="horizontal"?(x=oo(e,"xAxis",t,n),g=so(e,"xAxis",t,n)):(x=oo(e,"yAxis",r,n),g=so(e,"yAxis",r,n)),(i=(s=cf(x,g,!0))!==null&&s!==void 0?s:m)!==null&&i!==void 0?i:0}},C5=(e,t,r,n)=>{var a=Lt(e),i,s;return a==="horizontal"?(i=oo(e,"xAxis",t,n),s=so(e,"xAxis",t,n)):(i=oo(e,"yAxis",r,n),s=so(e,"yAxis",r,n)),cf(i,s)};function _G(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=Hn(e,r,0,!0),c,f=[];if(Kn(n[0].barSize)){var h=!1,d=r/i,m=n.reduce((S,A)=>S+(A.barSize||0),0);m+=(i-1)*s,m>=r&&(m-=(i-1)*s,s=0),m>=r&&d>0&&(h=!0,d*=.9,m=i*d);var x=(r-m)/2>>0,g={offset:x-s,size:0};c=n.reduce((S,A)=>{var T,D={stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:g.offset+g.size+s,size:h?d:(T=A.barSize)!==null&&T!==void 0?T:0}},O=[...S,D];return g=O[O.length-1].position,O},f)}else{var b=Hn(t,r,0,!0);r-2*b-(i-1)*s<=0&&(s=0);var _=(r-2*b-(i-1)*s)/i;_>1&&(_>>=0);var w=Kn(a)?Math.min(_,a):_;c=n.reduce((S,A,T)=>[...S,{stackId:A.stackId,dataKeys:A.dataKeys,position:{offset:b+(_+s)*T+(_-w)/2,size:w}}],f)}return c}}var SG=(e,t,r,n,a,i,s)=>{var c=Er(s)?t:s,f=_G(r,n,a!==i?a:i,e,c);return a!==i&&f!=null&&(f=f.map(h=>d0(d0({},h),{},{position:d0(d0({},h.position),{},{offset:h.position.offset-a/2})}))),f},NG=Ee([wG,Hj,J$,Wj,bG,C5,pG],SG),EG=(e,t,r,n)=>oo(e,"xAxis",t,n),TG=(e,t,r,n)=>oo(e,"yAxis",r,n),kG=(e,t,r,n)=>so(e,"xAxis",t,n),CG=(e,t,r,n)=>so(e,"yAxis",r,n),AG=Ee([NG,Wf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),jG=(e,t)=>{var r=pw(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},PG=Ee([gG,Wf],jG),OG=Ee([on,Dy,EG,TG,kG,CG,AG,Lt,bp,C5,PG,Wf,mG],(e,t,r,n,a,i,s,c,f,h,d,m,x)=>{var{chartData:g,dataStartIndex:b,dataEndIndex:_}=f;if(!(m==null||s==null||t==null||c!=="horizontal"&&c!=="vertical"||r==null||n==null||a==null||i==null||h==null)){var{data:w}=m,S;if(w!=null&&w.length>0?S=w:S=g?.slice(b,_+1),S!=null)return iG({layout:c,barSettings:m,pos:s,parentViewBox:t,bandSize:h,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:S,offset:e,cells:x})}}),A5=e=>{var{chartData:t}=e,r=Mr(),n=la();return v.useEffect(()=>n?()=>{}:(r(ST(t)),()=>{r(ST(void 0))}),[t,r,n]),null},hk={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},j5=Ha({name:"brush",initialState:hk,reducers:{setBrushSettings(e,t){return t.payload==null?hk:t.payload}}}),{setBrushSettings:foe}=j5.actions,DG=j5.reducer;function IG(e,t,r){return(t=RG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RG(e){var t=FG(e,"string");return typeof t=="symbol"?t:t+""}function FG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class ib{static create(t){return new ib(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}IG(ib,"EPS",1e-4);function MG(e){return(e%180+180)%180}var LG=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=MG(a),s=i*Math.PI/180,c=Math.atan(n/r),f=s>c&&s<Math.PI-c?n/Math.sin(s):r/Math.cos(s);return Math.abs(f)},BG={dots:[],areas:[],lines:[]},P5=Ha({name:"referenceElements",initialState:BG,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=os(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=os(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=os(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:doe,removeDot:hoe,addArea:poe,removeArea:moe,addLine:xoe,removeLine:goe}=P5.actions,$G=P5.reducer,UG=v.createContext(void 0),zG=e=>{var{children:t}=e,[r]=v.useState("".concat(af("recharts"),"-clip")),n=rb();if(n==null)return null;var{x:a,y:i,width:s,height:c}=n;return v.createElement(UG.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:i,height:c,width:s}))),t)};function Tc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function O5(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function HG(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return LG(n,r)}function WG(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:c}=e;return t===1?{start:n?a:i,end:n?a+s:i+c}:{start:n?a+s:i+c,end:n?a:i}}function _h(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function VG(e,t){return O5(e,t+1)}function KG(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:c}=t,f=0,h=1,d=s,m=function(){var b=n?.[f];if(b===void 0)return{v:O5(n,h)};var _=f,w,S=()=>(w===void 0&&(w=r(b,_)),w),A=b.coordinate,T=f===0||_h(e,A,S,d,c);T||(f=0,d=s,h+=1),T&&(d=A+e*(S()/2+a),f+=h)},x;h<=i.length;)if(x=m(),x)return x.v;return[]}function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){GG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GG(e,t,r){return(t=YG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YG(e){var t=XG(e,"string");return typeof t=="symbol"?t:t+""}function XG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qG(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:c}=t,{end:f}=t,h=function(x){var g=i[x],b,_=()=>(b===void 0&&(b=r(g,x)),b);if(x===s-1){var w=e*(g.coordinate+e*_()/2-f);i[x]=g=Mn(Mn({},g),{},{tickCoord:w>0?g.coordinate-w*e:g.coordinate})}else i[x]=g=Mn(Mn({},g),{},{tickCoord:g.coordinate});var S=_h(e,g.tickCoord,_,c,f);S&&(f=g.tickCoord-e*(_()/2+a),i[x]=Mn(Mn({},g),{},{isShow:!0}))},d=s-1;d>=0;d--)h(d);return i}function ZG(e,t,r,n,a,i){var s=(n||[]).slice(),c=s.length,{start:f,end:h}=t;if(i){var d=n[c-1],m=r(d,c-1),x=e*(d.coordinate+e*m/2-h);s[c-1]=d=Mn(Mn({},d),{},{tickCoord:x>0?d.coordinate-x*e:d.coordinate});var g=_h(e,d.tickCoord,()=>m,f,h);g&&(h=d.tickCoord-e*(m/2+a),s[c-1]=Mn(Mn({},d),{},{isShow:!0}))}for(var b=i?c-1:c,_=function(A){var T=s[A],D,O=()=>(D===void 0&&(D=r(T,A)),D);if(A===0){var I=e*(T.coordinate-e*O()/2-f);s[A]=T=Mn(Mn({},T),{},{tickCoord:I<0?T.coordinate-I*e:T.coordinate})}else s[A]=T=Mn(Mn({},T),{},{tickCoord:T.coordinate});var j=_h(e,T.tickCoord,O,f,h);j&&(f=T.tickCoord+e*(O()/2+a),s[A]=Mn(Mn({},T),{},{isShow:!0}))},w=0;w<b;w++)_(w);return s}function sb(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:c,interval:f,tickFormatter:h,unit:d,angle:m}=e;if(!a||!a.length||!n)return[];if(mt(f)||wo.isSsr){var x;return(x=VG(a,mt(f)?f:0))!==null&&x!==void 0?x:[]}var g=[],b=c==="top"||c==="bottom"?"width":"height",_=d&&b==="width"?Xu(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(T,D)=>{var O=typeof h=="function"?h(T.value,D):T.value;return b==="width"?HG(Xu(O,{fontSize:t,letterSpacing:r}),_,m):Xu(O,{fontSize:t,letterSpacing:r})[b]},S=a.length>=2?gn(a[1].coordinate-a[0].coordinate):1,A=WG(i,S,b);return f==="equidistantPreserveStart"?KG(S,A,w,a,s):(f==="preserveStart"||f==="preserveStartEnd"?g=ZG(S,A,w,a,s,f==="preserveStartEnd"):g=qG(S,A,w,a,s),g.filter(T=>T.isShow))}var QG=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(d=>{if(d){var m=d.getBoundingClientRect();m.width>s&&(s=m.width)}});var c=r?r.getBoundingClientRect().width:0,f=a+i,h=s+f+c+(r?n:0);return Math.round(h)}return 0},JG=["axisLine","width","height","className","hide","ticks"],eY=["viewBox"],tY=["viewBox"];function I1(e,t){if(e==null)return{};var r,n,a=rY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cl.apply(null,arguments)}function mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mk(Object(r),!0).forEach(function(n){nY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nY(e,t,r){return(t=aY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aY(e){var t=iY(e,"string");return typeof t=="symbol"?t:t+""}function iY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ob={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function sY(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:c,otherSvgProps:f}=e;if(!c)return null;var h=an(an(an({},f),Ua(c)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!s||i==="bottom"&&s);h=an(an({},h),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var m=+(i==="left"&&!s||i==="right"&&s);h=an(an({},h),{},{x1:t+m*n,y1:r,x2:t+m*n,y2:r+a})}return v.createElement("line",cl({},h,{className:Zt("recharts-cartesian-axis-line",al(c,"className"))}))}function oY(e,t,r,n,a,i,s,c,f){var h,d,m,x,g,b,_=c?-1:1,w=e.tickSize||s,S=mt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":h=d=e.coordinate,x=r+ +!c*a,m=x-_*w,b=m-_*f,g=S;break;case"left":m=x=e.coordinate,d=t+ +!c*n,h=d-_*w,g=h-_*f,b=S;break;case"right":m=x=e.coordinate,d=t+ +c*n,h=d+_*w,g=h+_*f,b=S;break;default:h=d=e.coordinate,x=r+ +c*a,m=x+_*w,b=m+_*f,g=S;break}return{line:{x1:h,y1:m,x2:d,y2:x},tick:{x:g,y:b}}}function lY(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function cY(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function uY(e){var{option:t,tickProps:r,value:n}=e,a,i=Zt(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))a=v.cloneElement(t,an(an({},r),{},{className:i}));else if(typeof t=="function")a=t(an(an({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=Zt(s,t?.className)),a=v.createElement(Ip,cl({},r,{className:s}),n)}return a}function fY(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:c,tickTextProps:f,orientation:h,mirror:d,x:m,y:x,width:g,height:b,tickSize:_,tickMargin:w,fontSize:S,letterSpacing:A,getTicksConfig:T,events:D}=e,O=sb(an(an({},T),{},{ticks:t}),S,A),I=lY(h,d),j=cY(h,d),z=Ua(T),R=nl(r),q={};typeof n=="object"&&(q=n);var V=an(an({},z),{},{fill:"none"},q),J=O.map((ue,Ne)=>{var{line:pe,tick:Ie}=oY(ue,m,x,g,b,h,_,d,w),xe=an(an(an(an({textAnchor:I,verticalAnchor:j},z),{},{stroke:"none",fill:a},R),Ie),{},{index:Ne,payload:ue,visibleTicksCount:O.length,tickFormatter:i,padding:c},f);return v.createElement(Cn,cl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ue.value,"-").concat(ue.coordinate,"-").concat(ue.tickCoord)},tp(D,ue,Ne)),n&&v.createElement("line",cl({},V,pe,{className:Zt("recharts-cartesian-axis-tick-line",al(n,"className"))})),r&&v.createElement(uY,{option:r,tickProps:xe,value:"".concat(typeof i=="function"?i(ue.value,Ne):ue.value).concat(s||"")}))});return J.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},J):null}var dY=v.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:c}=e,f=I1(e,JG),[h,d]=v.useState(""),[m,x]=v.useState(""),g=v.useRef(null);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var _;return QG({ticks:g.current,label:(_=e.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var b=v.useCallback(_=>{if(_){var w=_.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=w;var S=w[0];if(S){var A=window.getComputedStyle(S),T=A.fontSize,D=A.letterSpacing;(T!==h||D!==m)&&(d(T),x(D))}}},[h,m]);return s||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(Cn,{className:Zt("recharts-cartesian-axis",i),ref:b},v.createElement(sY,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Ua(e)}),v.createElement(fY,{ticks:c,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:h,letterSpacing:m,getTicksConfig:e,events:f}),v.createElement(pW,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(NW,{label:e.label,labelRef:e.labelRef}),e.children))}),hY=v.memo(dY,(e,t)=>{var{viewBox:r}=e,n=I1(e,eY),{viewBox:a}=t,i=I1(t,tY);return Tc(r,a)&&Tc(n,i)}),lb=v.forwardRef((e,t)=>{var r=jn(e,ob);return v.createElement(hY,cl({},r,{ref:t}))});lb.displayName="CartesianAxis";var pY=["x1","y1","x2","y2","key"],mY=["offset"],xY=["xAxisId","yAxisId"],gY=["xAxisId","yAxisId"];function xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xk(Object(r),!0).forEach(function(n){vY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vY(e,t,r){return(t=yY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=wY(e,"string");return typeof t=="symbol"?t:t+""}function wY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yo(){return Yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yo.apply(null,arguments)}function Sh(e,t){if(e==null)return{};var r,n,a=bY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var _Y=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:c}=e;return v.createElement("rect",{x:n,y:a,ry:c,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function D5(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:c}=t,f=Sh(t,pY),h=Ua(f),{offset:d}=h,m=Sh(h,mY);r=v.createElement("line",Yo({},m,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:c}))}return r}function SY(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,c=Sh(e,xY),f=a.map((h,d)=>{var m=Un(Un({},c),{},{x1:t,y1:h,x2:t+r,y2:h,key:"line-".concat(d),index:d});return D5(n,m)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function NY(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,c=Sh(e,gY),f=a.map((h,d)=>{var m=Un(Un({},c),{},{x1:h,y1:t,x2:h,y2:t+r,key:"line-".concat(d),index:d});return D5(n,m)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function EY(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:c,horizontal:f=!0}=e;if(!f||!t||!t.length)return null;var h=c.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==h[0]&&h.unshift(0);var d=h.map((m,x)=>{var g=!h[x+1],b=g?a+s-m:h[x+1]-m;if(b<=0)return null;var _=x%t.length;return v.createElement("rect",{key:"react-".concat(x),y:m,x:n,height:b,width:i,stroke:"none",fill:t[_],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function TY(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:c,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var h=f.map(m=>Math.round(m+a-a)).sort((m,x)=>m-x);a!==h[0]&&h.unshift(0);var d=h.map((m,x)=>{var g=!h[x+1],b=g?a+s-m:h[x+1]-m;if(b<=0)return null;var _=x%r.length;return v.createElement("rect",{key:"react-".concat(x),x:m,y:i,width:b,height:c,stroke:"none",fill:r[_],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var kY=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return NA(sb(Un(Un(Un({},ob),r),{},{ticks:EA(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},CY=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return NA(sb(Un(Un(Un({},ob),r),{},{ticks:EA(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},AY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function R1(e){var t=DA(),r=IA(),n=OA(),a=Un(Un({},jn(e,AY)),{},{x:mt(e.x)?e.x:n.left,y:mt(e.y)?e.y:n.top,width:mt(e.width)?e.width:n.width,height:mt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:c,y:f,width:h,height:d,syncWithTicks:m,horizontalValues:x,verticalValues:g}=a,b=la(),_=ft(R=>pT(R,"xAxis",i,b)),w=ft(R=>pT(R,"yAxis",s,b));if(!mt(h)||h<=0||!mt(d)||d<=0||!mt(c)||c!==+c||!mt(f)||f!==+f)return null;var S=a.verticalCoordinatesGenerator||kY,A=a.horizontalCoordinatesGenerator||CY,{horizontalPoints:T,verticalPoints:D}=a;if((!T||!T.length)&&typeof A=="function"){var O=x&&x.length,I=A({yAxis:w?Un(Un({},w),{},{ticks:O?x:w.ticks}):void 0,width:t,height:r,offset:n},O?!0:m);th(Array.isArray(I),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof I,"]")),Array.isArray(I)&&(T=I)}if((!D||!D.length)&&typeof S=="function"){var j=g&&g.length,z=S({xAxis:_?Un(Un({},_),{},{ticks:j?g:_.ticks}):void 0,width:t,height:r,offset:n},j?!0:m);th(Array.isArray(z),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof z,"]")),Array.isArray(z)&&(D=z)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(_Y,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(EY,Yo({},a,{horizontalPoints:T})),v.createElement(TY,Yo({},a,{verticalPoints:D})),v.createElement(SY,Yo({},a,{offset:n,horizontalPoints:T,xAxis:_,yAxis:w})),v.createElement(NY,Yo({},a,{offset:n,verticalPoints:D,xAxis:_,yAxis:w})))}R1.displayName="CartesianGrid";var I5=(e,t,r,n)=>oo(e,"xAxis",t,n),R5=(e,t,r,n)=>so(e,"xAxis",t,n),F5=(e,t,r,n)=>oo(e,"yAxis",r,n),M5=(e,t,r,n)=>so(e,"yAxis",r,n),jY=Ee([Lt,I5,F5,R5,M5],(e,t,r,n,a)=>yo(e,"xAxis")?cf(t,n,!1):cf(r,a,!1)),PY=(e,t,r,n,a)=>a;function OY(e){return e.type==="line"}var DY=Ee([Cp,PY],(e,t)=>e.filter(OY).find(r=>r.id===t)),IY=Ee([Lt,I5,F5,R5,M5,DY,jY,bp],(e,t,r,n,a,i,s,c)=>{var{chartData:f,dataStartIndex:h,dataEndIndex:d}=c;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:m,data:x}=i,g;if(x!=null&&x.length>0?g=x:g=f?.slice(h,d+1),g!=null)return nX({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:m,bandSize:s,displayedData:g})}});function RY(e){var t=nl(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),c=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(c)||c<0)&&(c=n),{r:s,strokeWidth:c}}return{r,strokeWidth:n}}var FY=["id"],MY=["type","layout","connectNulls","needClip"],LY=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gk(Object(r),!0).forEach(function(n){BY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BY(e,t,r){return(t=$Y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Y(e){var t=UY(e,"string");return typeof t=="symbol"?t:t+""}function UY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cb(e,t){if(e==null)return{};var r,n,a=zY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ul(){return ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ul.apply(null,arguments)}var HY=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Dc(r,t),payload:e}]};function WY(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:c,unit:f}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Dc(s,t),hide:c,type:e.tooltipType,color:e.stroke,unit:f}}}var L5=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function VY(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var KY=(e,t,r)=>{var n=r.reduce((m,x)=>m+x);if(!n)return L5(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,c=[],f=0,h=0;f<r.length;h+=r[f],++f)if(h+r[f]>i){c=[...r.slice(0,f),i-h];break}var d=c.length%2===0?[0,s]:[s];return[...VY(r,a),...c,...d].map(m=>"".concat(m,"px")).join(", ")};function GY(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Zt("recharts-line-dot",typeof e!="boolean"?e.className:"");r=v.createElement(u5,ul({},t,{className:n}))}return r}function YY(e,t){return e==null?!1:t?!0:e.length===1}function XY(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!YY(r,a))return null;var{id:c}=n,f=cb(n,FY),h=x5(a),d=Ua(f),m=eF(a),x=r.map((b,_)=>{var w=Da(Da(Da({key:"dot-".concat(_),r:3},d),m),{},{index:_,cx:b.x,cy:b.y,dataKey:i,value:b.value,payload:b.payload,points:r});return GY(a,w)}),g={clipPath:s?"url(#clipPath-".concat(h?"":"dots-").concat(t,")"):void 0};return v.createElement(Cn,ul({className:"recharts-line-dots",key:"dots"},g),x)}function qY(e){var{showLabels:t,children:r,points:n}=e,a=v.useMemo(()=>n?.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return Da(Da({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return v.createElement(l5,{value:t?a:null},r)}function vk(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:c,connectNulls:f,needClip:h}=i,d=cb(i,MY),m=Da(Da({},oa(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:c,connectNulls:f,strokeDasharray:a??i.strokeDasharray});return v.createElement(v.Fragment,null,n?.length>1&&v.createElement(Ry,ul({},m,{pathRef:r})),v.createElement(XY,{points:n,clipPathId:t,props:i}))}function ZY(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function QY(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:c,isAnimationActive:f,animationBegin:h,animationDuration:d,animationEasing:m,animateNewValues:x,width:g,height:b,onAnimationEnd:_,onAnimationStart:w}=r,S=a.current,A=Pf(r,"recharts-line-"),[T,D]=v.useState(!1),O=!T,I=v.useCallback(()=>{typeof _=="function"&&_(),D(!1)},[_]),j=v.useCallback(()=>{typeof w=="function"&&w(),D(!0)},[w]),z=ZY(n.current),R=i.current;return v.createElement(qY,{points:s,showLabels:O},r.children,v.createElement(jf,{animationId:A,begin:h,duration:d,isActive:f,easing:m,onAnimationEnd:I,onAnimationStart:j,key:A},q=>{var V=Fr(R,z+R,q),J=Math.min(V,z),ue;if(f)if(c){var Ne="".concat(c).split(/[,\s]+/gim).map(xe=>parseFloat(xe));ue=KY(J,z,Ne)}else ue=L5(z,J);else ue=c==null?void 0:String(c);if(S){var pe=S.length/s.length,Ie=q===1?s:s.map((xe,ye)=>{var ge=Math.floor(ye*pe);if(S[ge]){var Oe=S[ge];return Da(Da({},xe),{},{x:Fr(Oe.x,xe.x,q),y:Fr(Oe.y,xe.y,q)})}return x?Da(Da({},xe),{},{x:Fr(g*2,xe.x,q),y:Fr(b/2,xe.y,q)}):Da(Da({},xe),{},{x:xe.x,y:xe.y})});return a.current=Ie,v.createElement(vk,{props:r,points:Ie,clipPathId:t,pathRef:n,strokeDasharray:ue})}return q>0&&z>0&&(a.current=s,i.current=J),v.createElement(vk,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:ue})}),v.createElement(Kw,{label:r.label}))}function JY(e){var{clipPathId:t,props:r}=e,n=v.useRef(null),a=v.useRef(0),i=v.useRef(null);return v.createElement(QY,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var eX=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:dr(e.payload,t)});class tX extends v.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:c,left:f,width:h,height:d,id:m,needClip:x}=this.props;if(t)return null;var g=Zt("recharts-line",a),b=m,{r:_,strokeWidth:w}=RY(r),S=x5(r),A=_*2+w;return v.createElement(v.Fragment,null,v.createElement(Cn,{className:g},x&&v.createElement("defs",null,v.createElement(T5,{clipPathId:b,xAxisId:i,yAxisId:s}),!S&&v.createElement("clipPath",{id:"clipPath-dots-".concat(b)},v.createElement("rect",{x:f-A/2,y:c-A/2,width:h+A,height:d+A}))),v.createElement(E5,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:eX,errorBarOffset:0},v.createElement(JY,{props:this.props,clipPathId:b}))),v.createElement(wK,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var B5={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!wo.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function rX(e){var t=jn(e,B5),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:c,dot:f,hide:h,isAnimationActive:d,label:m,legendType:x,xAxisId:g,yAxisId:b,id:_}=t,w=cb(t,LY),{needClip:S}=ab(g,b),A=rb(),T=hp(),D=la(),O=ft(q=>IY(q,g,b,D,_));if(T!=="horizontal"&&T!=="vertical"||O==null||A==null)return null;var{height:I,width:j,x:z,y:R}=A;return v.createElement(tX,ul({},w,{id:_,connectNulls:c,dot:f,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:h,label:m,legendType:x,xAxisId:g,yAxisId:b,points:O,layout:T,height:I,width:j,left:z,top:R,needClip:S}))}function nX(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:c,displayedData:f}=e;return f.map((h,d)=>{var m=dr(h,s);if(t==="horizontal"){var x=WN({axis:r,ticks:a,bandSize:c,entry:h,index:d}),g=Er(m)?null:n.scale(m);return{x,y:g,value:m,payload:h}}var b=Er(m)?null:r.scale(m),_=WN({axis:n,ticks:i,bandSize:c,entry:h,index:d});return b==null||_==null?null:{x:b,y:_,value:m,payload:h}}).filter(Boolean)}function aX(e){var t=jn(e,B5),r=la();return v.createElement(eb,{id:t.id,type:"line"},n=>v.createElement(v.Fragment,null,v.createElement(y5,{legendPayload:HY(t)}),v.createElement(Jw,{fn:WY,args:t}),v.createElement(b5,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),v.createElement(rX,ul({},t,{id:n}))))}var $5=v.memo(aX);$5.displayName="Line";var iX=["dangerouslySetInnerHTML","ticks"],sX=["id"],oX=["domain"],lX=["domain"];function F1(){return F1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F1.apply(null,arguments)}function Nh(e,t){if(e==null)return{};var r,n,a=cX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function cX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function uX(e){var t=Mr();return v.useLayoutEffect(()=>(t(oK(e)),()=>{t(lK(e))}),[e,t]),null}var fX=e=>{var{xAxisId:t,className:r}=e,n=ft(Dy),a=la(),i="xAxis",s=ft(w=>Uc(w,i,t,a)),c=ft(w=>_P(w,i,t,a)),f=ft(w=>vP(w,t)),h=ft(w=>YU(w,t)),d=ft(w=>Jj(w,t));if(f==null||h==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:x}=e,g=Nh(e,iX),{id:b}=d,_=Nh(d,sX);return v.createElement(lb,F1({},g,_,{scale:s,x:h.x,y:h.y,width:f.width,height:f.height,className:Zt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:c}))},dX={allowDataOverflow:Aa.allowDataOverflow,allowDecimals:Aa.allowDecimals,allowDuplicatedCategory:Aa.allowDuplicatedCategory,height:Aa.height,hide:!1,mirror:Aa.mirror,orientation:Aa.orientation,padding:Aa.padding,reversed:Aa.reversed,scale:Aa.scale,tickCount:Aa.tickCount,type:Aa.type,xAxisId:0},hX=e=>{var t,r,n,a,i,s=jn(e,dX);return v.createElement(v.Fragment,null,v.createElement(uX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(fX,s))},pX=(e,t)=>{var{domain:r}=e,n=Nh(e,oX),{domain:a}=t,i=Nh(t,lX);return Tc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:Tc({domain:r},{domain:a}):!1},M1=v.memo(hX,pX);M1.displayName="XAxis";var mX=["dangerouslySetInnerHTML","ticks"],xX=["id"],gX=["domain"],vX=["domain"];function L1(){return L1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L1.apply(null,arguments)}function Eh(e,t){if(e==null)return{};var r,n,a=yX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wX(e){var t=Mr();return v.useLayoutEffect(()=>(t(cK(e)),()=>{t(uK(e))}),[e,t]),null}var bX=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=v.useRef(null),s=v.useRef(null),c=ft(Dy),f=la(),h=Mr(),d="yAxis",m=ft(O=>Uc(O,d,t,f)),x=ft(O=>yP(O,t)),g=ft(O=>qU(O,t)),b=ft(O=>_P(O,d,t,f)),_=ft(O=>eP(O,t));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!x||Vw(a)||v.isValidElement(a)||_==null)){var O=i.current;if(O){var I=O.getCalculatedWidth();Math.round(x.width)!==Math.round(I)&&h(fK({id:t,width:I}))}}},[b,x,h,a,t,n,_]),x==null||g==null||_==null)return null;var{dangerouslySetInnerHTML:w,ticks:S}=e,A=Eh(e,mX),{id:T}=_,D=Eh(_,xX);return v.createElement(lb,L1({},A,D,{ref:i,labelRef:s,scale:m,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:x.width,height:x.height,className:Zt("recharts-".concat(d," ").concat(d),r),viewBox:c,ticks:b}))},_X={allowDataOverflow:ja.allowDataOverflow,allowDecimals:ja.allowDecimals,allowDuplicatedCategory:ja.allowDuplicatedCategory,hide:!1,mirror:ja.mirror,orientation:ja.orientation,padding:ja.padding,reversed:ja.reversed,scale:ja.scale,tickCount:ja.tickCount,type:ja.type,width:ja.width,yAxisId:0},SX=e=>{var t,r,n,a,i,s=jn(e,_X);return v.createElement(v.Fragment,null,v.createElement(wX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(bX,s))},NX=(e,t)=>{var{domain:r}=e,n=Eh(e,gX),{domain:a}=t,i=Eh(t,vX);return Tc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:Tc({domain:r},{domain:a}):!1},B1=v.memo(SX,NX);B1.displayName="YAxis";var ov={exports:{}},lv={};var yk;function EX(){if(yk)return lv;yk=1;var e=Ac();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return lv.useSyncExternalStoreWithSelector=function(f,h,d,m,x){var g=a(null);if(g.current===null){var b={hasValue:!1,value:null};g.current=b}else b=g.current;g=s(function(){function w(O){if(!S){if(S=!0,A=O,O=m(O),x!==void 0&&b.hasValue){var I=b.value;if(x(I,O))return T=I}return T=O}if(I=T,r(A,O))return I;var j=m(O);return x!==void 0&&x(I,j)?(A=O,I):(A=O,T=j)}var S=!1,A,T,D=d===void 0?null:d;return[function(){return w(h())},D===null?void 0:function(){return w(D())}]},[h,d,m,x]);var _=n(f,g[0],g[1]);return i(function(){b.hasValue=!0,b.value=_},[_]),c(_),_},lv}var wk;function TX(){return wk||(wk=1,ov.exports=EX()),ov.exports}TX();function kX(e){e()}function CX(){let e=null,t=null;return{clear(){e=null,t=null},notify(){kX(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var bk={notify(){},get:()=>[]};function AX(e,t){let r,n=bk,a=0,i=!1;function s(_){d();const w=n.subscribe(_);let S=!1;return()=>{S||(S=!0,w(),m())}}function c(){n.notify()}function f(){b.onStateChange&&b.onStateChange()}function h(){return i}function d(){a++,r||(r=e.subscribe(f),n=CX())}function m(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=bk)}function x(){i||(i=!0,d())}function g(){i&&(i=!1,m())}const b={addNestedSub:s,notifyNestedSubs:c,handleChangeWrapper:f,isSubscribed:h,trySubscribe:x,tryUnsubscribe:g,getListeners:()=>n};return b}var jX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PX=jX(),OX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",DX=OX(),IX=()=>PX||DX?v.useLayoutEffect:v.useEffect,RX=IX(),FX=Symbol.for("react-redux-context"),MX=typeof globalThis<"u"?globalThis:{};function LX(){if(!v.createContext)return{};const e=MX[FX]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var BX=LX();function $X(e){const{children:t,context:r,serverState:n,store:a}=e,i=v.useMemo(()=>{const f=AX(a);return{store:a,subscription:f,getServerState:n?()=>n:void 0}},[a,n]),s=v.useMemo(()=>a.getState(),[a]);RX(()=>{const{subscription:f}=i;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),s!==a.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[i,s]);const c=r||BX;return v.createElement(c.Provider,{value:i},t)}var UX=$X,zX=(e,t)=>t,ub=Ee([zX,Lt,qj,cn,BP,Es,tH,on],sH),fb=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},U5=ii("mouseClick"),z5=Cf();z5.startListening({actionCreator:U5,effect:(e,t)=>{var r=e.payload,n=ub(t.getState(),fb(r));n?.activeIndex!=null&&t.dispatch(cz({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var $1=ii("mouseMove"),H5=Cf();H5.startListening({actionCreator:$1,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Rw(n,n.tooltip.settings.shared),i=ub(n,fb(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(jP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(AP()))}});var _k={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},W5=Ha({name:"rootProps",initialState:_k,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:_k.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),HX=W5.reducer,{updateOptions:WX}=W5.actions,V5=Ha({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:VX}=V5.actions,KX=V5.reducer,K5=ii("keyDown"),G5=ii("focus"),db=Cf();db.startListening({actionCreator:K5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Fw(a,Hc(r))),c=Es(r);if(i==="Enter"){var f=gh(r,"axis","hover",String(a.index));t.dispatch(T1({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:f}));return}var h=ez(r),d=h==="left-to-right"?1:-1,m=i==="ArrowRight"?1:-1,x=s+m*d;if(!(c==null||x>=c.length||x<0)){var g=gh(r,"axis","hover",String(x));t.dispatch(T1({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});db.startListening({actionCreator:G5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=gh(r,"axis","hover",String(i));t.dispatch(T1({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Qa=ii("externalEvent"),Y5=Cf();Y5.startListening({actionCreator:Qa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Vz(r),activeDataKey:HP(r),activeIndex:lo(r),activeLabel:zP(r),activeTooltipIndex:lo(r),isTooltipActive:Kz(r)};e.payload.handler(n,e.payload.reactEvent)}}});var GX=Ee([zc],e=>e.tooltipItemPayloads),YX=Ee([GX,Uf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(c=>c.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),X5=ii("touchMove"),q5=Cf();q5.startListening({actionCreator:X5,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Rw(n,n.tooltip.settings.shared);if(a==="axis"){var i=ub(n,fb({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(jP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,c=r.touches[0],f=document.elementFromPoint(c.clientX,c.clientY);if(!f||!f.getAttribute)return;var h=f.getAttribute(kA),d=(s=f.getAttribute(CA))!==null&&s!==void 0?s:void 0,m=YX(t.getState(),h,d);t.dispatch(CP({activeDataKey:d,activeIndex:h,activeCoordinate:m}))}}});var XX=Z4({brush:DG,cartesianAxis:dK,chartData:_H,errorBars:OK,graphicalItems:PV,layout:KM,legend:qL,options:gH,polarAxis:VW,polarOptions:KX,referenceElements:$G,rootProps:HX,tooltip:uz}),qX=function(t){return gM({reducer:XX,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([z5.middleware,H5.middleware,db.middleware,Y5.middleware,q5.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(cA({type:"raf"}))},devTools:wo.devToolsEnabled})};function Z5(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=la(),i=v.useRef(null);if(a)return r;i.current==null&&(i.current=qX(t));var s=ky;return v.createElement(UX,{context:s,store:i.current},r)}function Q5(e){var{layout:t,margin:r}=e,n=Mr(),a=la();return v.useEffect(()=>{a||(n(HM(t)),n(zM(r)))},[n,a,t,r]),null}function J5(e){var t=Mr();return v.useEffect(()=>{t(WX(e))},[t,e]),null}var ZX=["children"];function QX(e,t){if(e==null)return{};var r,n,a=JX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(null,arguments)}var eq={width:"100%",height:"100%",display:"block"},tq=v.forwardRef((e,t)=>{var r=DA(),n=IA(),a=LA();if(!_c(r)||!_c(n))return null;var{children:i,otherAttributes:s,title:c,desc:f}=e,h,d;return typeof s.tabIndex=="number"?h=s.tabIndex:h=a?0:void 0,typeof s.role=="string"?d=s.role:d=a?"application":void 0,v.createElement(m4,Th({},s,{title:c,desc:f,role:d,tabIndex:h,width:r,height:n,style:eq,ref:t}),i)}),rq=e=>{var{children:t}=e,r=ft(fp);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return v.createElement(m4,{width:n,height:a,x:s,y:i},t)},Sk=v.forwardRef((e,t)=>{var{children:r}=e,n=QX(e,ZX),a=la();return a?v.createElement(rq,null,r):v.createElement(tq,Th({ref:t},n),r)});function nq(){var e=Mr(),[t,r]=v.useState(null),n=ft(bL);return v.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Kn(i)&&i!==n&&e(VM(i))}},[t,e,n]),r}function Nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nk(Object(r),!0).forEach(function(n){iq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iq(e,t,r){return(t=sq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sq(e){var t=oq(e,"string");return typeof t=="symbol"?t:t+""}function oq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fl(){return fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fl.apply(null,arguments)}var lq=()=>(PH(),null);function kh(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var cq=v.forwardRef((e,t)=>{var r,n,a=v.useRef(null),[i,s]=v.useState({containerWidth:kh((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:kh((n=e.style)===null||n===void 0?void 0:n.height)}),c=v.useCallback((h,d)=>{s(m=>{var x=Math.round(h),g=Math.round(d);return m.containerWidth===x&&m.containerHeight===g?m:{containerWidth:x,containerHeight:g}})},[]),f=v.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null){var{width:d,height:m}=h.getBoundingClientRect();c(d,m);var x=b=>{var{width:_,height:w}=b[0].contentRect;c(_,w)},g=new ResizeObserver(x);g.observe(h),a.current=g}},[t,c]);return v.useEffect(()=>()=>{var h=a.current;h?.disconnect()},[c]),v.createElement(v.Fragment,null,v.createElement(pp,{width:i.containerWidth,height:i.containerHeight}),v.createElement("div",fl({ref:f},e)))}),uq=v.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=v.useState({containerWidth:kh(r),containerHeight:kh(n)}),s=v.useCallback((f,h)=>{i(d=>{var m=Math.round(f),x=Math.round(h);return d.containerWidth===m&&d.containerHeight===x?d:{containerWidth:m,containerHeight:x}})},[]),c=v.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:h,height:d}=f.getBoundingClientRect();s(h,d)}},[t,s]);return v.createElement(v.Fragment,null,v.createElement(pp,{width:a.containerWidth,height:a.containerHeight}),v.createElement("div",fl({ref:c},e)))}),fq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return v.createElement(v.Fragment,null,v.createElement(pp,{width:r,height:n}),v.createElement("div",fl({ref:t},e)))}),dq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return ds(r)||ds(n)?v.createElement(uq,fl({},e,{ref:t})):v.createElement(fq,fl({},e,{ref:t}))});function hq(e){return e===!0?cq:dq}var pq=v.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:c,onMouseDown:f,onMouseEnter:h,onMouseLeave:d,onMouseMove:m,onMouseUp:x,onTouchEnd:g,onTouchMove:b,onTouchStart:_,style:w,width:S,responsive:A,dispatchTouchEvents:T=!0}=e,D=v.useRef(null),O=Mr(),[I,j]=v.useState(null),[z,R]=v.useState(null),q=nq(),V=Iy(),J=V?.width>0?V.width:S,ue=V?.height>0?V.height:a,Ne=v.useCallback(H=>{q(H),typeof t=="function"&&t(H),j(H),R(H),H!=null&&(D.current=H)},[q,t,j,R]),pe=v.useCallback(H=>{O(U5(H)),O(Qa({handler:i,reactEvent:H}))},[O,i]),Ie=v.useCallback(H=>{O($1(H)),O(Qa({handler:h,reactEvent:H}))},[O,h]),xe=v.useCallback(H=>{O(AP()),O(Qa({handler:d,reactEvent:H}))},[O,d]),ye=v.useCallback(H=>{O($1(H)),O(Qa({handler:m,reactEvent:H}))},[O,m]),ge=v.useCallback(()=>{O(G5())},[O]),Oe=v.useCallback(H=>{O(K5(H.key))},[O]),ie=v.useCallback(H=>{O(Qa({handler:s,reactEvent:H}))},[O,s]),he=v.useCallback(H=>{O(Qa({handler:c,reactEvent:H}))},[O,c]),De=v.useCallback(H=>{O(Qa({handler:f,reactEvent:H}))},[O,f]),We=v.useCallback(H=>{O(Qa({handler:x,reactEvent:H}))},[O,x]),Ve=v.useCallback(H=>{O(Qa({handler:_,reactEvent:H}))},[O,_]),Ge=v.useCallback(H=>{T&&O(X5(H)),O(Qa({handler:b,reactEvent:H}))},[O,T,b]),Te=v.useCallback(H=>{O(Qa({handler:g,reactEvent:H}))},[O,g]),U=hq(A);return v.createElement(XP.Provider,{value:I},v.createElement(oF.Provider,{value:z},v.createElement(U,{width:J??w?.width,height:ue??w?.height,className:Zt("recharts-wrapper",n),style:aq({position:"relative",cursor:"default",width:J,height:ue},w),onClick:pe,onContextMenu:ie,onDoubleClick:he,onFocus:ge,onKeyDown:Oe,onMouseDown:De,onMouseEnter:Ie,onMouseLeave:xe,onMouseMove:ye,onMouseUp:We,onTouchEnd:Te,onTouchMove:Ge,onTouchStart:Ve,ref:Ne},v.createElement(lq,null),r)))}),mq=["width","height","responsive","children","className","style","compact","title","desc"];function xq(e,t){if(e==null)return{};var r,n,a=gq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eO=v.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:c,compact:f,title:h,desc:d}=e,m=xq(e,mq),x=Ua(m);return f?v.createElement(v.Fragment,null,v.createElement(pp,{width:r,height:n}),v.createElement(Sk,{otherAttributes:x,title:h,desc:d},i)):v.createElement(pq,{className:s,style:c,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(Sk,{otherAttributes:x,title:h,desc:d,ref:t},v.createElement(zG,null,i)))});function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U1.apply(null,arguments)}var vq={top:5,right:5,bottom:5,left:5},yq={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:vq,reverseStackOrder:!1,syncMethod:"index",responsive:!1},tO=v.forwardRef(function(t,r){var n,a=jn(t.categoricalChartProps,yq),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,categoricalChartProps:h}=t,d={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(Z5,{preloadedState:{options:d},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:i},v.createElement(A5,{chartData:h.data}),v.createElement(Q5,{layout:a.layout,margin:a.margin}),v.createElement(J5,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(eO,U1({},a,{ref:r})))}),wq=["axis"],bq=v.forwardRef((e,t)=>v.createElement(tO,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:wq,tooltipPayloadSearcher:Ww,categoricalChartProps:e,ref:t})),_q=["axis","item"],Sq=v.forwardRef((e,t)=>v.createElement(tO,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:_q,tooltipPayloadSearcher:Ww,categoricalChartProps:e,ref:t}));function Nq(e){var t=Mr();return v.useEffect(()=>{t(VX(e))},[t,e]),null}var Eq=["layout"];function z1(){return z1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z1.apply(null,arguments)}function Tq(e,t){if(e==null)return{};var r,n,a=kq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Cq={top:5,right:5,bottom:5,left:5},Aq={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Cq,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},jq=v.forwardRef(function(t,r){var n,a=jn(t.categoricalChartProps,Aq),{layout:i}=a,s=Tq(a,Eq),{chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:d}=t,m={chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:d,eventEmitter:void 0};return v.createElement(Z5,{preloadedState:{options:m},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:c},v.createElement(A5,{chartData:a.data}),v.createElement(Q5,{layout:i,margin:a.margin}),v.createElement(J5,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(Nq,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),v.createElement(eO,z1({},s,{ref:r})))}),Pq=["item"],Oq={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Dq=v.forwardRef((e,t)=>{var r=jn(e,Oq);return v.createElement(jq,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Pq,tooltipPayloadSearcher:Ww,categoricalChartProps:r,ref:t})});const Iq={ORDER:{idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status",checkFlag:"check_flag",refund:"refund"}},Wc={orderList:{columns:Iq.ORDER},productPrice:{columns:{product:"san_pham",pctCtv:"pct_ctv",pctKhach:"pct_khach",isActive:"is_active",package:"package",packageProduct:"package_product",updateDate:"update",pctPromo:"pct_promo"}},paymentReceipt:{columns:{id:"id",orderCode:"ma_don_hang",paidDate:"ngay_thanh_toan",amount:"so_tien",receiver:"nguoi_gui",sender:"sender",note:"noi_dung_ck"}},bankList:{columns:{bin:"bin",bankName:"bank_name"}},supply:{columns:{id:"id",sourceName:"source_name",numberBank:"number_bank",binBank:"bin_bank",activeSupply:"active_supply"}},supplyPrice:{columns:{id:"id",productId:"product_id",sourceId:"source_id",price:"price"}}},wr=Wc.orderList.columns,H1=Wc.bankList.columns,Ql=Wc.paymentReceipt.columns,mn=Wc.productPrice.columns,La=Wc.supply.columns,Xo=Wc.supplyPrice.columns,W1=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},Zs=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),a=String(r.getUTCMonth()+1).padStart(2,"0"),i=r.getUTCFullYear();return`${n}/${a}/${i}`},Rq=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,a,i]=e.split("/").map(Number),s=new Date(i,a-1,n);return s.setMonth(s.getMonth()+t),s.setDate(s.getDate()-1),`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()}`},Fq=(e,t)=>{const[r,n,a]=e.split("/").map(Number),[i,s,c]=t.split("/").map(Number),f=new Date(a,n-1,r),h=new Date(c,s-1,i),d=1440*60*1e3;return Math.floor((h.getTime()-f.getTime())/d)+1},Ek=e=>String(e).padStart(2,"0"),hb=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[a,i,s]=t.split("/").map(Number);return!a||!i||!s?null:new Date(s,i-1,a)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r.map(Number);return!s||!i||!a?null:new Date(a,i-1,s)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},Kr=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r;return`${s}/${i}/${a}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,a,i,s]=n;return`${s}/${i}/${a}`}}const t=hb(e);return t?`${Ek(t.getDate())}/${Ek(t.getMonth()+1)}/${t.getFullYear()}`:""},Mq=e=>{const t=hb(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},rO=e=>{const t=hb(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},Tk=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},nO=e=>{const t=Number(e);return Number.isFinite(t)?t:0},Mp=e=>{const t=nO(e);return t>=0?Math.floor(t+.5):-Math.floor(Math.abs(t)+.5)},to=e=>`${Mp(e).toLocaleString("vi-VN")} `,kk=e=>{const t=nO(e);return t>0?t.toLocaleString("vi-VN"):""},Lq=e=>!Number.isFinite(e)||e<=0?"0":e>=1e9?`${(e/1e9).toFixed(1)}B`:e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${Math.round(e).toLocaleString("vi-VN")}`,aO=(e,t,r=[])=>{const n=(e||"").trim().toLowerCase();if(!n)return;const a=r.find(c=>(c[La.sourceName]||c.name||"").trim().toLowerCase()===n)?.[La.id]??null;if(a!==null){const f=t.find(h=>h[Xo.sourceId]===a)?.[Xo.price];if(Number.isFinite(f))return Number(f)}const s=t.find(c=>(c[La.sourceName]||"").trim().toLowerCase()===n)?.[Xo.price];return Number.isFinite(s)?Number(s):void 0},Ck=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),iO=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",sO=e=>{switch(iO(e)){case"da thanh toan":return"bg-green-600 text-white";case"chua thanh toan":return"bg-yellow-500 text-slate-900";case"can gia han":return"bg-orange-500 text-white";case"het han":return"bg-red-600 text-white";default:return"bg-slate-600 text-white"}},Ak=e=>{const t=iO(e);return t==="het han"?1:t==="can gia han"?2:t==="chua thanh toan"?3:t==="da thanh toan"?4:5},pb=({accountNumber:e,bankCode:t,amount:r,description:n})=>{const a=(e||"").trim(),i=(t||"").trim();if(!a||!i)return"";const s=new URLSearchParams;s.set("acc",a),s.set("bank",i);const c=Number(r);Number.isFinite(c)&&c>0&&s.set("amount",Math.round(c).toString());const f=(n||"").trim();return f&&s.set("des",f),`https://qr.sepay.vn/img?${s.toString()}`},oO=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},Bq=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",fo=(e,t={})=>{const{fallback:r=" xy ra li. Vui lng th li sau.",blockPatterns:n}=t,a=Bq(e);return!a||Array.isArray(n)&&n.some(i=>i.test(a))?r:a},lO=to,cO=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",uO=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,cv=(e,t,r,n)=>{const a=Number.isFinite(Number(t))?Number(t):0,i=Number.isFinite(Number(r))?Number(r):0,s=n?lO(a):a.toLocaleString("vi-VN"),c=uO(a,i);return{name:e,value:s,change:cO(c),changeType:c>=0?"increase":"decrease"}},$q=()=>{const e=v.useMemo(()=>new Date().getFullYear(),[]),[t,r]=v.useState([]),[n,a]=v.useState([]),[i,s]=v.useState([]),[c,f]=v.useState([]),[h,d]=v.useState(e),[m,x]=v.useState(!0),[g,b]=v.useState(null),_=async w=>{x(!0),b(null);try{const S=await Xt("/api/dashboard/stats");if(!S.ok){const I=await S.text();throw new Error(fo(I,{fallback:"Khng th ti thng k tng quan."}))}const A=await S.json(),T=[{...cv("Tng n hng",A.totalOrders.current,A.totalOrders.previous,!1),icon:my,accent:Yr.sky},{name:"n sp ht hn",value:A.overdueOrders.count.toLocaleString("vi-VN"),change:"Cn x l",changeType:"alert",icon:dy,accent:Yr.rose},{...cv("Tng nhp hng",A.totalImports.current,A.totalImports.previous,!0),icon:cy,accent:Yr.amber},{...cv("Tng li nhun",A.totalProfit.current,A.totalProfit.previous,!0),icon:o4,accent:Yr.emerald}];r(T);const D=await YR(w);a(D.revenueData),s(D.orderStatusData);const O=D.orderStatusData.filter(I=>Number.isFinite(Number(I.total_orders)));if(O.length>=2){const I=Number(O[O.length-1].total_orders)||0,j=Number(O[O.length-2].total_orders)||0,z=uO(I,j);r(R=>R.map((q,V)=>V===0?{...q,change:cO(z),changeType:z>=0?"increase":"decrease"}:q))}}catch(S){console.error("Li khi ly d liu dashboard:",S),b(S instanceof Error?fo(S.message,{fallback:" c li khi ti d liu dashboard. Vui lng th li sau."}):" c li khi ti d liu dashboard. Vui lng th li sau.")}finally{x(!1)}};return v.useEffect(()=>{(async()=>{try{const S=await XR();S.length>0?(f(S),d(A=>S.includes(A)?A:S[0])):(f([e]),d(e))}catch(S){console.error("Li khi ly danh sch nm Dashboard:",S),f([e]),d(e)}})()},[e]),v.useEffect(()=>{_(h)},[h]),m?u.jsx("div",{className:"py-10 text-center",children:u.jsx("p",{className:"text-lg font-medium text-gray-700",children:"ang ti d liu dashboard..."})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white sm:p-8",children:[u.jsx("h1",{className:"text-3xl font-bold",children:"Bng iu khin"}),u.jsx("p",{className:"text-sm text-blue-100",children:"Tng quan hot ng kinh doanh ca bn"})]}),g&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:g}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:u.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:t.map((w,S)=>u.jsx(Oc,{title:w.name,value:w.value,icon:w.icon,accent:w.accent,children:u.jsx("div",{className:`flex items-center text-sm font-semibold ${w.changeType==="increase"?"text-emerald-200":w.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:w.changeType==="alert"?u.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):w.changeType==="increase"?u.jsxs(u.Fragment,{children:[u.jsx(fy,{className:"mr-1 h-4 w-4"}),w.change]}):u.jsxs(u.Fragment,{children:[u.jsx(uy,{className:"mr-1 h-4 w-4"}),w.change]})})},`${w.name}-${S}`))})}),u.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[u.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[u.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Doanh thu theo thng (Tng gi bn)"}),u.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-gray-700 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:h,onChange:w=>d(Number(w.target.value)),children:c.length===0?u.jsx("option",{value:h,children:h}):c.map(w=>u.jsx("option",{value:w,children:w},w))})]}),u.jsx("div",{className:"h-80",children:u.jsx(o1,{width:"100%",height:"100%",children:u.jsxs(bq,{data:n,children:[u.jsx(R1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),u.jsx(M1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(B1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:w=>`${Math.round(w/1e6)}M`}),u.jsx(A1,{formatter:w=>[lO(w),"Doanh thu"],labelStyle:{color:"#111827"}}),u.jsx($5,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]}),u.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[u.jsx("h3",{className:"mb-6 text-lg font-semibold text-gray-900",children:"Tng n hng v n hy theo thng"}),u.jsx("div",{className:"h-80",children:u.jsx(o1,{width:"100%",height:"100%",children:u.jsxs(Sq,{data:i,children:[u.jsx(R1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),u.jsx(M1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(B1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),u.jsx(A1,{formatter:(w,S,A)=>[w,A?.dataKey==="total_orders"?"Tng n":"n hy"],labelStyle:{color:"#111827"}}),u.jsx(D1,{dataKey:"total_orders",name:"Tng n",fill:"#3b82f6",radius:[4,4,0,0]}),u.jsx(D1,{dataKey:"total_canceled",name:"n hy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]})]})]})},Uq={ID_ORDER:wr.idOrder,ID_PRODUCT:wr.idProduct,INFORMATION_ORDER:wr.informationOrder,CUSTOMER:wr.customer,CONTACT:wr.contact,SLOT:wr.slot,ORDER_DATE:wr.orderDate,DAYS:wr.days,ORDER_EXPIRED:wr.orderExpired,SUPPLY:wr.supply,COST:wr.cost,PRICE:wr.price,NOTE:wr.note,STATUS:wr.status,CHECK_FLAG:wr.checkFlag,REFUND:wr.refund},It={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},Q=Uq,Vt={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",CHECK_FLAG_STATUS:"check_flag_status_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},wi={ORDER_EXPIRED:"Ht Hn",CAN_GIA_HAN:"Cn Gia Hn",CHUA_THANH_TOAN:"Cha Thanh Ton",DA_THANH_TOAN:" Thanh Ton"},fO={active:{label:"n Hng",description:"Danh sch n ang hot ng",endpoint:It.ORDERS},expired:{label:"Ht Hn",description:"Danh sch cc n hng  ht hn",endpoint:It.ORDERS_EXPIRED},canceled:{label:"Hon Tin",description:"n  hy/hon tin",endpoint:It.ORDERS_CANCELED}},zq=["active","expired","canceled"],Hq="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",Wq="opacity-60 cursor-not-allowed shadow-none pointer-events-none",Bi=_i.forwardRef(({icon:e,className:t="",disabled:r,children:n,...a},i)=>u.jsxs("button",{ref:i,className:`${Hq} ${r?Wq:"hover:-translate-y-0.5"} ${t}`,disabled:r,...a,children:[e&&u.jsx(e,{className:"h-4 w-4"}),u.jsx("span",{className:"font-semibold",children:n})]}));Bi.displayName="GradientButton";const Vq=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a})=>e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:u.jsxs("div",{className:"w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[u.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-2",children:n}),u.jsx("div",{className:"mb-4",children:u.jsx("p",{className:"text-sm text-white/90",children:a})}),u.jsxs("div",{className:"flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors",children:"Hy"}),u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors",children:"OK"})]})]})}):null,Kq="VPB",jk="9183400998",Gq="NGO LE NGOC HUNG",Yq=Ef,Xq=({isOpen:e,onClose:t,order:r,formatCurrency:n})=>{const[a,i]=v.useState(null),[s,c]=v.useState(!1),[f,h]=v.useState(null),d=Ie=>typeof Ie=="string"||typeof Ie=="number"||Ie instanceof Date?Ie:null,m=r?.[Q.ID_ORDER],x=r?.[Q.ID_PRODUCT],g=Number(r?.[Q.PRICE])||0,b=r?.[Q.SUPPLY]||"",_=r?.customer_type||b||"",w=r?.registration_date||r?.[Q.ORDER_DATE]||"",S=W1(Kr(w)||w)||null;v.useEffect(()=>{if(!e||!m||!x){i(null),c(!1),h(null);return}let Ie=!1;i(g);const xe={san_pham_name:x,id_product:x,id_order:m};return S&&(xe.order_date=S),_&&(xe.customer_type=_),(async()=>{try{c(!0),h(null);const ge=await fetch(`${Yq}${It.CALCULATE_PRICE}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(xe)}),{data:Oe,rawText:ie}=await oO(ge);if(!ge.ok){const De=Oe?.error||ie||`Server responded with ${ge.status}`;throw new Error(De)}const he=Oe??{};if(!Ie){const De=Number(he.price??he.gia_ban);i(Number.isFinite(De)&&De>=0?De:g)}}catch(ge){console.error("Li khi tnh li gi n hng:",ge),Ie||(h("Khng th tnh li gi t ng. ang hin th gi hin c."),i(g))}finally{Ie||c(!1)}})(),()=>{Ie=!0}},[e,m,x,_,g,S]);const A=v.useMemo(()=>{if(!r)return 0;const Ie=Number(r[Q.PRICE])||0;return Math.max(0,a??Ie)},[r,a]);if(!e||!r)return null;const T=String(r[Vt.TRANG_THAI_TEXT]||r.trangThaiText||r[Q.STATUS]||"").trim()||"Cha Thanh Ton",D=r[Vt.SO_NGAY_CON_LAI]!==void 0&&r[Vt.SO_NGAY_CON_LAI]!==null?Number(r[Vt.SO_NGAY_CON_LAI]):null,O=d(r.expiry_date||r.expiry_date_display||r[Vt.EXPIRY_DATE_DISPLAY]||r[Q.ORDER_EXPIRED]),I=rO(O),j=D!==null&&Number.isFinite(D)?D:I??0,z=d(r.registration_date_display||r[Vt.ORDER_DATE_DISPLAY]||r.registration_date||r[Q.ORDER_DATE]),R=(r.registration_date_display||r[Vt.ORDER_DATE_DISPLAY]||Kr(z)||String(r[Q.ORDER_DATE]||""))??"",q=r.expiry_date_display||r[Vt.EXPIRY_DATE_DISPLAY]||Kr(O)||String(r[Q.ORDER_EXPIRED]||""),V=A,J=String(r[Q.ID_ORDER]||""),ue=Math.max(0,Number(V)||0),Ne=Mp(ue),pe=pb({accountNumber:jk,bankCode:Kq,amount:Ne,description:J});return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 px-4 py-6",onClick:t,children:u.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:Ie=>Ie.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-center items-center p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[u.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Chi tit n hng:"," ",u.jsx("span",{className:"text-blue-600",children:r[Q.ID_ORDER]})]}),u.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(Tn,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"p-6 overflow-y-auto flex-grow space-y-5 text-gray-700",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-sm",children:[u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID n:"}),u.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[Q.ID_ORDER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sn Phm:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[Q.ID_PRODUCT]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Thng Tin Sn Phm:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right break-words",children:r[Q.INFORMATION_ORDER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[Q.SLOT]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ghi Ch:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[Q.NOTE]||"-"})]}),u.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trng Thi:"}),u.jsx("dd",{className:"w-2/3 text-right",children:u.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${sO(T)}`,children:T})})]})]}),u.jsxs("dl",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khch Hng:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[Q.CUSTOMER]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1 items-start",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3 shrink-0",children:"Lin H:"}),u.jsx("dd",{className:"w-2/3 text-right break-all",children:u.jsx("a",{href:r[Q.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[Q.CONTACT]||"-"})})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Order:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:R})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[Q.DAYS]})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Ht Hn:"}),u.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:q})]}),u.jsxs("div",{className:"flex justify-between border-b pb-1",children:[u.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy Cn Li:"}),u.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:j})]})]})]}),u.jsx("hr",{className:"my-4 border-white/10"}),u.jsxs("div",{className:"text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[u.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Qut m QR  thanh ton (VietQR)"}),pe?u.jsx("div",{className:"flex justify-center mb-3",children:u.jsx("img",{src:pe,alt:`QR Code thanh ton ${r[Q.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40",width:280,height:280})}):u.jsx("p",{className:"text-red-600 font-medium",children:"Khng th to m QR. Vui lng kim tra li cu hnh"}),u.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[u.jsxs("p",{children:["Ngn hng: ",u.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),u.jsxs("p",{children:["S ti khon: ",u.jsx("strong",{className:"text-indigo-100",children:jk})]}),u.jsxs("p",{children:["Ch ti khon: ",u.jsx("strong",{className:"text-indigo-100",children:Gq})]}),u.jsxs("p",{children:["S tin:"," ",u.jsx("strong",{className:"text-xl text-red-600",children:s?"ang tnh...":n(Ne)})]}),f&&u.jsx("p",{className:"text-xs text-red-500",children:f}),u.jsxs("p",{children:["Ni dung: ",u.jsx("strong",{className:"text-indigo-200",children:J})," ","(Vui lng in ng)"]})]})]})]})]})})},Pk=Ef,Zn="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",xa="block text-sm font-medium text-slate-100 mb-1",Ai="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",Ok=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",Dk=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,qq=(e,t)=>{const[r,n]=v.useState(null),[a,i]=v.useState([]),[s,c]=v.useState([]),f=v.useRef(e),[h,d]=v.useState(!1),m=v.useCallback(()=>{const D=f.current?.[Q.SUPPLY]||"";return D.trim()?{id:-1,source_name:D}:null},[]),x=v.useCallback(D=>{const O=m();return O&&!D.some(j=>j.source_name===O.source_name)?[O,...D]:D},[m]),g=v.useCallback(async D=>{if(!D){const O=x([]);return i(O),O}try{const O=await fetch(`${Pk}${It.SUPPLIES_BY_PRODUCT(D)}`,{credentials:"include"});if(!O.ok)throw new Error("Li ti danh sch ngun.");const I=await O.json(),j=x(I);return i(j),j}catch(O){console.error("Li khi fetch supplies cho sn phm:",O);const I=x([]);return i(I),I}},[x]),b=v.useCallback(async D=>{if(!D)return c([]),[];try{const O=await fetch(`${Pk}${It.SUPPLY_PRICES_BY_PRODUCT_NAME(D)}`,{credentials:"include"});if(!O.ok)throw new Error("Li ti danh sch gi ngun.");const I=await O.json();return c(I),I}catch(O){return console.error("Li khi fetch gi ngun cho sn phm:",O),c([]),[]}},[]);v.useEffect(()=>{if(t&&e){const D={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(D),f.current=D,i(I=>x(I));const O=e.id_product;O&&(g(O),b(O)),d(!1)}else t||(n(null),i([]),c([]),d(!1))},[t,e,g,b,x]),v.useEffect(()=>{if(!t||!r?.id_product)return;const D=r.id_product;g(D),b(D)},[t,r?.id_product,g,b]);const _=v.useCallback((D,O)=>{n(I=>I&&{...I,[D]:O})},[]),w=v.useCallback(D=>{const I=a.find(R=>R.id===D)?.source_name||r?.[Q.SUPPLY]||"";d(!1),_(Q.SUPPLY,I||"");const j=aO(I,s,a)??s.find(R=>R.source_id===D)?.price??null,z=Number(j);if(Number.isFinite(z))_(Q.COST,z);else if(f.current){const R=Number(f.current[Q.COST]||0);_(Q.COST,R)}},[r,_,a,s]),S=v.useCallback(D=>{d(!0),_(Q.SUPPLY,D)},[_]),A=v.useCallback(()=>{d(D=>{const O=!D;return O||_(Q.SUPPLY,""),O})},[_]),T=v.useCallback(()=>{n(f.current);const D=f.current?.id_product;D&&(g(D),b(D))},[g,b]);return{formData:r,supplies:a,isCustomSupply:h,supplyPrices:s,handleSupplySelect:w,resetForm:T,setFieldValue:_,handleCustomSupplyChange:S,toggleCustomSupply:A}},Zq=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:a,supplies:i,isCustomSupply:s,handleSupplySelect:c,resetForm:f,setFieldValue:h,handleCustomSupplyChange:d,toggleCustomSupply:m}=qq(r,e),[x,g]=v.useState(!1),b=O=>a?String(a[O]??""):"",_=O=>a&&Number(a[O]??0)||0,w=v.useCallback(O=>{const I=O.target,{name:j,value:z}=I,R=I instanceof HTMLInputElement&&I.type==="checkbox"?I.checked:z;h(j,R)},[h]),S=v.useMemo(()=>{if(!a)return"";const O=i.find(I=>I.source_name===a[Q.SUPPLY]);return O?String(O.id):""},[a,i]),A=v.useMemo(()=>{if(!a)return"";const O=Dk(a.registration_date_display||a.registration_date||a[Q.ORDER_DATE]);return Kr(O)||String(O||"")},[a]),T=v.useMemo(()=>{if(!a)return"";const O=Dk(a.expiry_date_display||a.expiry_date||a[Q.ORDER_EXPIRED]);return Kr(O)||String(O||"")},[a]),D=async O=>{if(O.preventDefault(),!!a){g(!0);try{await n(a)}finally{g(!1)}}};return!e||!a?null:u.jsx("div",{className:"edit-order-shell fixed inset-0 z-50 flex items-center justify-center bg-black/55 backdrop-blur-lg px-4 py-6",children:u.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[u.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-6 py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[u.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Chnh sa n hng"}),u.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"ng",children:u.jsx(Tn,{className:"h-6 w-6"})})]}),u.jsxs("form",{onSubmit:D,className:"p-6 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"M n hng"}),u.jsx("input",{type:"text",name:Q.ID_ORDER,value:b(Q.ID_ORDER),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Khch hng"}),u.jsx("input",{type:"text",name:Q.CUSTOMER,value:b(Q.CUSTOMER),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Lin h"}),u.jsx("input",{type:"text",name:Q.CONTACT,value:b(Q.CONTACT),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Slot"}),u.jsx("input",{type:"text",name:Q.SLOT,value:b(Q.SLOT),onChange:w,className:Zn})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Sn phm"}),u.jsx("input",{type:"text",name:Q.ID_PRODUCT,value:b(Q.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Ngun"}),u.jsxs("div",{className:"flex items-center gap-2",children:[s?u.jsx("input",{type:"text",name:Q.SUPPLY,value:b(Q.SUPPLY),onChange:O=>d(O.target.value),className:Zn,placeholder:"Nhp ngun mi"}):u.jsxs("select",{name:Q.SUPPLY,value:S,onChange:O=>c(Number(O.target.value)),className:Zn,children:[u.jsx("option",{value:"",children:"-- Gi nguyn hoc chn --"}),i.map(O=>u.jsx("option",{value:O.id,children:O.source_name},O.id))]}),u.jsx("button",{type:"button",onClick:m,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${s?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":s?"Tt nhp ngun mi":"Nhp ngun mi",children:s?u.jsx(c4,{className:"h-6 w-6","aria-hidden":"true"}):u.jsx(py,{className:"h-6 w-6","aria-hidden":"true"})})]}),!i.length&&!s&&u.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Khng c danh sch ngun cho sn phm hin ti."})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Thng tin n hng"}),u.jsx("input",{type:"text",name:Q.INFORMATION_ORDER,value:b(Q.INFORMATION_ORDER),onChange:w,className:Zn})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Ngy ng k"}),u.jsx("input",{type:"text",name:Q.ORDER_DATE,value:A,readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"S ngy"}),u.jsx("input",{type:"text",name:Q.DAYS,value:b(Q.DAYS),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Ngy ht hn"}),u.jsx("input",{type:"text",name:Q.ORDER_EXPIRED,value:T,readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Gi nhp"}),u.jsx("input",{type:"text",name:Q.COST,value:Ok(_(Q.COST)),readOnly:!0,disabled:!0,className:`${Zn} ${Ai} font-semibold`})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Gi bn"}),u.jsx("input",{type:"text",name:Q.PRICE,value:Ok(_(Q.PRICE)),readOnly:!0,disabled:!0,className:`${Zn} ${Ai} font-semibold text-emerald-300`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Trng thi"}),u.jsx("input",{type:"text",name:Q.STATUS,value:b(Q.STATUS),readOnly:!0,disabled:!0,className:`${Zn} ${Ai}`})]}),u.jsxs("div",{className:"flex items-center gap-3 mt-6 md:mt-8",children:[u.jsx("label",{className:"text-sm font-medium text-slate-100 mb-0",children:"Kim tra"}),u.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-white/30 text-indigo-300 focus:ring-indigo-400",checked:!!a[Q.CHECK_FLAG],disabled:!0,readOnly:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:xa,children:"Ghi ch"}),u.jsx("textarea",{name:Q.NOTE,value:b(Q.NOTE),rows:4,onChange:w,className:Zn})]}),u.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[u.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hon tc"}),u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"ng"}),u.jsx("button",{type:"submit",disabled:x,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${x?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:x?"ang lu...":"Lu thay i"})]})]})]})})},Lu=Ef,Qq=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},I0=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),a=parseInt(r[1],10),i=parseInt(r[2],10),s=new Date(i,a-1,n);s.setDate(s.getDate()+t-1);const c=String(s.getDate()).padStart(2,"0"),f=String(s.getMonth()+1).padStart(2,"0"),h=s.getFullYear();return`${c}/${f}/${h}`},Ik={[Q.ID_ORDER]:"",[Q.ID_PRODUCT]:"",[Q.INFORMATION_ORDER]:"",[Q.CUSTOMER]:"",[Q.CONTACT]:"",[Q.SLOT]:"",[Q.ORDER_DATE]:"",[Q.DAYS]:"0",[Q.ORDER_EXPIRED]:"",[Q.SUPPLY]:"",[Q.COST]:0,[Q.PRICE]:0,[Q.NOTE]:"",[Q.STATUS]:"Cha Thanh Ton",[Q.CHECK_FLAG]:null},bn="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-all",Rn="block text-sm font-medium text-gray-700 mb-1",Jl="bg-gray-100 cursor-not-allowed",Jq=(e,t,r)=>{const[n,a]=v.useState(Ik),[i,s]=v.useState("MAVC"),[c,f]=v.useState([]),[h,d]=v.useState([]),[m,x]=v.useState([]),[g,b]=v.useState([]),[_,w]=v.useState(!1),[S,A]=v.useState(!1),[T,D]=v.useState(null),[O,I]=v.useState(!1),j=v.useMemo(()=>i+Ck(5),[i]),z=v.useMemo(()=>Zs(),[]),R=n[Q.ID_PRODUCT],q=n[Q.ID_ORDER],V=n[Q.ORDER_DATE],J=Te=>{a(U=>({...U,...Te}))},ue=v.useCallback(async()=>{try{const Te=await fetch(`${Lu}${It.PRODUCTS_ALL}`,{credentials:"include"});if(!Te.ok)throw new Error("Li ti danh sch sn phm.");const U=await Te.json();x(U)}catch(Te){console.error("Li khi fetch products:",Te)}},[]),Ne=v.useCallback(async()=>{try{const Te=await fetch(`${Lu}${It.SUPPLIES}`,{credentials:"include"});if(!Te.ok)throw new Error("Li ti danh sch ngun.");const U=await Te.json();f(U),d(H=>H.length?H:U)}catch(Te){console.error("Li khi fetch all supplies:",Te),f([])}},[]),pe=v.useCallback(async Te=>{if(!Te){d(U=>U.length?U:c);return}try{const U=await fetch(`${Lu}${It.SUPPLIES_BY_PRODUCT(Te)}`,{credentials:"include"});if(!U.ok)throw new Error("Li ti danh sch ngun.");const H=await U.json();d(H)}catch(U){console.error("Li khi fetch supplies:",U),d(c)}},[c]),Ie=v.useCallback(async Te=>{try{const U=await fetch(`${Lu}${It.SUPPLY_PRICES_BY_PRODUCT_NAME(Te)}`,{credentials:"include"});if(!U.ok)throw new Error("Li tnh gi nhp ca ngun.");const H=await U.json();b(H)}catch(U){console.error("Li khi fetch all supply prices:",U),b([])}},[]),xe=v.useCallback(async(Te,U,H,X)=>{w(!0),A(!1);try{const Z=Qq(X)||X||null,ee=await fetch(`${Lu}${It.CALCULATE_PRICE}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({supply_id:Te,san_pham_name:U,id_product:U,id_order:H,order_date:Z,customer_type:i})}),{data:Fe,rawText:_e}=await oO(ee);if(!ee.ok){const je=Fe?.error||_e||"Li tnh gi ti Server.";throw new Error(je)}if(!Fe)throw new Error("Phn hi khng hp l t server.");const Me=Fe||{},Re=Kr(X)||X||Zs(),ne={cost:Math.max(0,Number(Me.gia_nhap??Me.cost??0)||0),price:Math.max(0,Number(Me.gia_ban??Me.price??0)||0),days:Number(Me.so_ngay_da_dang_ki??Me.days??0)||0,order_expired:""},Ae=(Me.order_expired??Me.het_han??"").trim(),me=Kr(Ae)||Ae||(ne.days>0?I0(Re,ne.days):"");return ne.order_expired=me,ne}catch(Z){console.error("Li khi tnh gi:",Z),A(!1),alert(`Tnh gi tht bi: ${Z instanceof Error?Z.message:"Li khng xc nhn"}`);return}finally{w(!1)}},[i]),ye=v.useCallback((Te,U,H,X)=>{if(!Te)return;const Z=Kr(U)||U||Zs(),ee=Number(Te.days||0)||0,Fe=Te.order_expired||(ee>0?I0(Z,ee):"");a(_e=>{const Me=Number(_e[Q.COST]||0),Re=Number.isFinite(Te.cost)&&Te.cost>0?Te.cost:void 0,Ae=X?.updateCost??!0?Re??Number(H??Me??0):Me,me=Number(_e[Q.PRICE]||0),je=Number.isFinite(Te.price)&&Te.price>0?Te.price:void 0,He=i==="MAVK"?Ae:je??me??0;return{..._e,[Q.COST]:Ae,[Q.PRICE]:He,[Q.DAYS]:ee>0?String(ee):String(_e[Q.DAYS]||"0"),[Q.ORDER_EXPIRED]:Fe||_e[Q.ORDER_EXPIRED]||""}}),A(!0)},[i]),ge=v.useCallback((Te,U,H,X,Z,ee)=>{!U||!H||!X||xe(Te,U,H,X).then(Fe=>ye(Fe,X,Z,ee))},[xe,ye]);v.useEffect(()=>{if(e){const Te="MAVC",U=Te+Ck(5),H=Zs();s(Te),a({...Ik,[Q.ID_ORDER]:U,[Q.ORDER_DATE]:H,[Q.ORDER_EXPIRED]:H}),A(!1),D(null),d([]),b([]),ue(),Ne()}},[e,ue,Ne]),v.useEffect(()=>{e&&a(Te=>({...Te,[Q.ID_ORDER]:j}))},[j,e]),v.useEffect(()=>{if(!R||!q||!V||r)return;if(i==="MAVK"){a(U=>({...U,[Q.PRICE]:U[Q.COST]||0}));return}const Te=T??0;ge(Te,R,q,V,void 0,{updateCost:!!Te})},[i,ge,R,q,V,T,r]);const Oe=Te=>{if(D(null),I(!1),a(U=>({...U,[Q.ID_PRODUCT]:Te,[Q.SUPPLY]:"",[Q.COST]:0,[Q.PRICE]:0,[Q.DAYS]:"0",[Q.ORDER_EXPIRED]:U[Q.ORDER_DATE]||z})),d([]),b([]),Te){pe(Te),Ie(Te);const U=n[Q.ID_ORDER],H=n[Q.ORDER_DATE];if(U&&H&&!r){const X=T??0;ge(X,Te,U,H,void 0,{updateCost:!!X})}}else d(c),A(!1)},ie=v.useCallback((Te,U,H)=>{const X=g.map(_e=>({source_id:_e.source_id,price:_e.price})),Z=h.map(_e=>({id:_e.id,source_name:_e.source_name})),ee=aO(U,X,Z),Fe=Number(ee);if(Number.isFinite(Fe))return Fe;if(Te!==0){const _e=g.find(Re=>Re.source_id===Te)?.price,Me=Number(_e);if(Number.isFinite(Me))return Me}return H},[h,g]);return{formData:n,supplies:h,allSupplies:c,products:m,isLoading:_,isDataLoaded:S,selectedSupplyId:T,customerType:i,updateForm:J,setIsDataLoaded:A,customProductTouched:O,setCustomProductTouched:I,handleChange:Te=>{const{name:U,value:H}=Te.target;J({[U]:H})},handleProductSelect:Oe,handleSourceSelect:Te=>{const U=h.find(Me=>Me.id===Te),H=Number(n[Q.COST]||0),X=U?.source_name||"",Z=ie(Te,X,H);D(Te===0?null:Te),a(Me=>{const Re={...Me,[Q.SUPPLY]:U?U.source_name:"",[Q.COST]:Z};return i==="MAVK"&&(Re[Q.PRICE]=Z),Re});const ee=n[Q.ID_PRODUCT],Fe=n[Q.ID_ORDER],_e=n[Q.ORDER_DATE];if(!ee||!Fe||!_e){A(!1);return}ge(Te,ee,Fe,_e,Z,{updateCost:!0})},handleProductChange:Te=>{const U=Te.target.value;if(D(null),I(!1),a(H=>({...H,[Q.ID_PRODUCT]:U,[Q.SUPPLY]:"",[Q.COST]:0,[Q.PRICE]:0,[Q.DAYS]:"0",[Q.ORDER_EXPIRED]:H[Q.ORDER_DATE]||z})),d([]),b([]),U){pe(U),Ie(U);const H=n[Q.ID_ORDER]||"",X=n[Q.ORDER_DATE]||"";if(H&&X&&!r){const Z=T??0;ge(Z,U,H,X,void 0,{updateCost:!!Z})}}else A(!1)},handleCustomerTypeChange:Te=>{const U=Te.target.value;s(U),D(null),d([]),b([]),A(!1),a(H=>({...H,[Q.ID_PRODUCT]:"",[Q.SUPPLY]:"",[Q.COST]:0,[Q.PRICE]:0,[Q.DAYS]:"0",[Q.ORDER_EXPIRED]:H[Q.ORDER_DATE]||Zs()}))},handleSubmit:Te=>{if(Te.preventDefault(),n&&n[Q.ID_PRODUCT]&&n[Q.SUPPLY]&&n[Q.CUSTOMER]&&n[Q.INFORMATION_ORDER]&&!_){const H=Kr(n[Q.ORDER_DATE])||n[Q.ORDER_DATE]||Zs(),X=Kr(n[Q.ORDER_EXPIRED])||n[Q.ORDER_EXPIRED]||"",Z=Number(n[Q.DAYS]||0)||0;let ee=X;if(!ee&&H&&Z>0){const Re=I0(H,Z);Re&&Re!=="N/A"&&(ee=Re,J({[Q.ORDER_EXPIRED]:ee}))}const Fe=W1(H),_e=ee?W1(ee):Fe,Me={...n,[Q.COST]:Number(n[Q.COST]),[Q.PRICE]:Number(n[Q.PRICE]),[Q.ORDER_DATE]:Fe,[Q.ORDER_EXPIRED]:_e,[Q.CONTACT]:n[Q.CONTACT]||null,[Q.SLOT]:n[Q.SLOT]||null,[Q.NOTE]:n[Q.NOTE]||null};return t(Me),!0}else return alert("Vui lng in y  cc thng tin"),!1}}},Rk=({name:e,value:t,options:r,placeholder:n,disabled:a,onChange:i,onClear:s})=>{const c=v.useRef(null),[f,h]=v.useState(!1),[d,m]=v.useState(""),x=v.useMemo(()=>{const b=r.find(_=>_.value===t);return b?b.label:""},[r,t]);v.useEffect(()=>{m(x)},[x]);const g=v.useMemo(()=>{const b=(d||"").toLowerCase().trim();return b?r.filter(_=>_.label.toLowerCase().includes(b)):r},[r,d]);return v.useEffect(()=>{const b=_=>{c.current&&(c.current.contains(_.target)||h(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]),u.jsxs("div",{ref:c,className:"relative",children:[u.jsx("input",{name:e,type:"text",value:d,onChange:b=>{const _=b.target.value;m(_),_===""&&s?.(),f||h(!0)},onFocus:()=>h(!0),disabled:a,placeholder:n,className:`${bn} pr-8`,autoComplete:"off"}),!!d&&s&&!a&&u.jsx("button",{type:"button",onMouseDown:b=>{b.preventDefault(),m(""),s(),h(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:""}),f&&!a&&u.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:g.length===0?u.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Khng c kt qu"}):g.map(b=>u.jsx("div",{className:`px-3 py-2 text-sm cursor-pointer hover:bg-indigo-500/15 ${b.value===t?"bg-gray-50":""}`,onMouseDown:_=>{_.preventDefault(),m(b.label),h(!1),i(b.value,b)},children:b.label},`${String(b.value)}-${b.label}`))})]})},eZ=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=v.useState(!1),{formData:i,updateForm:s,supplies:c,products:f,isLoading:h,selectedSupplyId:d,customerType:m,setIsDataLoaded:x,customProductTouched:g,setCustomProductTouched:b,handleChange:_,handleProductSelect:w,handleSourceSelect:S,handleCustomerTypeChange:A,handleSubmit:T}=Jq(e,r,n),D=i[Q.INFORMATION_ORDER]||"",O=i[Q.ID_PRODUCT]||"",I=i[Q.ORDER_DATE]||Zs(),j=i[Q.COST],z=i[Q.PRICE],R=v.useMemo(()=>i[Q.ORDER_EXPIRED]||"",[i]),q=v.useMemo(()=>i[Q.ORDER_DATE]||Zs(),[i]),V=v.useMemo(()=>Number(i[Q.DAYS]||0)||0,[i]),J=v.useCallback(pe=>Ie=>{const ye=(Ie.target.value||"").replace(/\D/g,""),ge=ye?parseInt(ye,10):0;s({[pe]:ge})},[s]);v.useEffect(()=>{if(!n||!g)return;const pe=Tk(D)||Tk(O),Ie=I;if(pe>0){const xe=Rq(Ie,pe),ye=Fq(Ie,xe);s({[Q.DAYS]:String(ye),[Q.ORDER_EXPIRED]:xe})}},[n,g,D,O,I,s]),v.useEffect(()=>{if(R){const pe=Kr(R);if(!pe&&q&&V>0){const Ie=I0(q,V);Ie&&Ie!=="N/A"&&s({[Q.ORDER_EXPIRED]:Ie})}else pe&&pe!==R&&s({[Q.ORDER_EXPIRED]:pe})}},[R,q,V,s]);const ue=v.useMemo(()=>{const pe=i[Q.ID_PRODUCT]||"",Ie=i[Q.SUPPLY]||"",xe=i[Q.INFORMATION_ORDER]||"",ye=i[Q.CUSTOMER]||"";return!!pe&&!!Ie&&!!xe&&!!ye},[i]);if(v.useEffect(()=>{x(ue)},[ue,x]),!e)return null;const Ne=!!(i[Q.CUSTOMER]&&i[Q.ID_PRODUCT]&&i[Q.SUPPLY]&&i[Q.INFORMATION_ORDER]);return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300",children:u.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col text-slate-100",children:[u.jsxs("div",{className:"p-5 border-b border-slate-700 sticky top-0 bg-slate-800/80 z-10 flex justify-between items-center",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"To n Hng Mi"}),u.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:u.jsx(Tn,{className:"h-6 w-6"})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsx("form",{onSubmit:T,children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border p-4 rounded-lg bg-gray-50",children:[u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Loi Khch Hng"}),u.jsxs("select",{name:"customer_type",value:m,onChange:A,className:bn,children:[u.jsx("option",{value:"MAVC",children:"Cng Tc Vin"}),u.jsx("option",{value:"MAVL",children:"Khch L"}),u.jsx("option",{value:"MAVK",children:"Khuyn Mi"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"M n Hng"}),u.jsx("input",{type:"text",name:Q.ID_ORDER,value:i[Q.ID_ORDER]||"",readOnly:!0,className:`${bn} font-semibold ${Jl}`})]}),u.jsxs("div",{children:[u.jsxs("label",{className:Rn,children:["Tn Khch Hng ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:Q.CUSTOMER,value:i[Q.CUSTOMER]||"",onChange:_,className:bn,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Link Lin H"}),u.jsx("input",{type:"url",name:Q.CONTACT,value:i[Q.CONTACT]||"",onChange:_,className:bn})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[u.jsxs("div",{className:"md:col-span-5",children:[u.jsxs("label",{className:Rn,children:["Sn Phm ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(Rk,{name:Q.ID_PRODUCT,value:i[Q.ID_PRODUCT]||"",options:f.map(pe=>({value:pe.san_pham,label:pe.san_pham})),placeholder:"-- Chn --",onChange:pe=>w(String(pe)),onClear:()=>w(""),disabled:n})]}),u.jsxs("div",{className:"md:col-span-5",children:[u.jsxs("label",{className:Rn,children:["Ngun ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx(Rk,{name:Q.SUPPLY,value:d??"",options:c.map(pe=>({value:pe.id,label:pe.source_name})),placeholder:"-- Chn --",disabled:n||!i[Q.ID_PRODUCT],onChange:pe=>S(Number(pe)),onClear:()=>S(0)})]}),u.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:u.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{b(!1),a(pe=>!pe)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?u.jsx(c4,{className:"h-6 w-6","aria-hidden":"true"}):u.jsx(py,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&u.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Sn Phm Mi"}),u.jsx("input",{type:"text",name:Q.ID_PRODUCT,value:i[Q.ID_PRODUCT]||"",onChange:_,onBlur:()=>b(!0),className:bn,placeholder:"Nhp Tn Sn Phm Mi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Ngun Mi"}),u.jsx("input",{type:"text",name:Q.SUPPLY,value:i[Q.SUPPLY]||"",onChange:_,className:bn,placeholder:"Nhp Tn Ngun Mi"})]})]}),u.jsxs("div",{className:"md:col-span-12",children:[u.jsxs("label",{className:Rn,children:["Thng Tin Sn Phm ",u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsx("input",{type:"text",name:Q.INFORMATION_ORDER,value:i[Q.INFORMATION_ORDER]||"",onChange:_,className:bn,required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Ngy ng K"}),u.jsx("input",{type:"text",name:Q.ORDER_DATE,value:i[Q.ORDER_DATE]||"",readOnly:!0,className:`${bn} ${Jl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"S Ngy ng K"}),u.jsx("input",{type:"text",name:Q.DAYS,value:i[Q.DAYS]||"",readOnly:!0,className:`${bn} ${Jl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Ngy Ht Hn"}),u.jsx("input",{type:"text",name:Q.ORDER_EXPIRED,value:i[Q.ORDER_EXPIRED]||"",readOnly:!0,className:`${bn} font-medium text-red-600 ${Jl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Slot"}),u.jsx("input",{type:"text",name:Q.SLOT,value:i[Q.SLOT]||"",onChange:_,className:bn})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Gi Nhp"}),n?u.jsx("input",{type:"text",inputMode:"numeric",name:Q.COST,value:kk(Number(j??0)),onChange:J(Q.COST),className:`${bn} font-semibold`}):u.jsx("input",{type:"text",name:Q.COST,value:to(j??0),readOnly:!0,className:`${bn} font-semibold ${Jl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Gi Bn"}),n?u.jsx("input",{type:"text",inputMode:"numeric",name:Q.PRICE,value:kk(Number(z??0)),onChange:J(Q.PRICE),className:`${bn} font-semibold text-green-700`}):u.jsx("input",{type:"text",name:Q.PRICE,value:m==="MAVK"&&!d?"":to(z??0),readOnly:!0,className:`${bn} font-semibold text-green-700 ${Jl}`})]}),u.jsxs("div",{children:[u.jsx("label",{className:Rn,children:"Ghi Ch"}),u.jsx("textarea",{name:Q.NOTE,value:i[Q.NOTE]||"",onChange:_,rows:8,className:bn})]})]})]})]})})}),u.jsxs("div",{className:"p-5 border-t border-gray-200 bg-gray-50 flex justify-end sticky bottom-0 z-10",children:[u.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-indigo-500/15 transition-colors shadow-sm mr-3",children:"Hy"}),u.jsx("button",{type:"submit",onClick:T,className:`px-6 py-2 text-base font-medium text-white rounded-lg transition-colors shadow-md ${Ne&&!h?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,disabled:!Ne||h,children:h?"ang Tnh Gi...":"To n Hng"})]})]})})},Ks=Ef,Fk={"ht hn":wi.ORDER_EXPIRED,"cn gia hn":wi.CAN_GIA_HAN,"cha thanh ton":wi.CHUA_THANH_TOAN," thanh ton":wi.DA_THANH_TOAN,"cha hon":"Cha Hon"," hon":" Hon"},h0=[{name:"Tng n Hng",value:"0",icon:wc,accent:Yr.sky},{name:"Cn Gia Hn",value:"0",icon:hy,accent:Yr.amber},{name:"Ht Hn",value:"0",icon:uy,accent:Yr.rose},{name:"ng K Hm Nay",value:"0",icon:fy,accent:Yr.emerald}],tZ=e=>Mp(e).toLocaleString("vi-VN")+" VND",Bu=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},rZ=[{value:"all",label:"Tt c ct"},{value:Q.ID_ORDER,label:"M n Hng"},{value:Q.INFORMATION_ORDER,label:"Thng tin"},{value:Q.CUSTOMER,label:"Khch Hng"},{value:Q.SLOT,label:"Slot"},{value:Q.SUPPLY,label:"Ngun"}],V1=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),Mk=e=>V1(e).replace(/[^a-z0-9]/g,""),nZ=e=>{const[t,r]=v.useState([]),[n,a]=v.useState(""),[i,s]=v.useState("all"),[c,f]=v.useState("all"),[h,d]=v.useState(1),[m,x]=v.useState(10),[g,b]=v.useState(!1),[_,w]=v.useState(!1),[S,A]=v.useState(!1),[T,D]=v.useState(!1),[O,I]=v.useState(null),[j,z]=v.useState(null),[R,q]=v.useState(null),[V,J]=v.useState(null),[ue,Ne]=v.useState(null),pe=v.useCallback(async()=>{try{J(null);const ne=fO[e].endpoint,Ae=await fetch(`${Ks}${ne}`,{credentials:"include"});if(Ae.status===401){window.location.href="/login";return}if(!Ae.ok)throw new Error(`Li my ch: ${Ae.status}`);const me=await Ae.json();Array.isArray(me)?r(me):console.error("D liu nhn c khng phi l mng:",me)}catch(ne){console.error("Li khi ti n hng:",ne);const Ae=ne instanceof TypeError?"Khng th kt ni n my ch. Vui lng kim tra li dch v backend.":ne instanceof Error?ne.message:"C li khng xc nh khi ti n hng.";J(Ae)}finally{}},[e]);v.useEffect(()=>{pe()},[pe]),v.useEffect(()=>{r([]),a(""),f("all"),d(1),b(!1),w(!1),A(!1),D(!1),I(null),z(null),q(null)},[e]);const Ie=v.useMemo(()=>{const ne=(Xe,St)=>{const Ht=Xe??St;return Ht==null?"":Kr(Ht)||String(Ht)},Ae=Xe=>{if(Xe==null)return Xe;if(typeof Xe!="boolean"&&(typeof Xe=="string"||typeof Xe=="number"||Xe instanceof Date))return Xe},me=Xe=>Xe==null?Xe:typeof Xe=="boolean"?null:typeof Xe=="number"||typeof Xe=="string"?Xe:null,je=Xe=>{if(Xe==null)return null;if(typeof Xe=="number"&&Number.isFinite(Xe))return Xe;if(typeof Xe=="string"){const St=Xe.trim();if(!St)return null;const Ht=Number(St);return Number.isFinite(Ht)?Ht:null}return null},He=Xe=>{if(Xe==null)return null;if(typeof Xe=="boolean")return Xe;if(typeof Xe=="number"){if(Xe===1)return!0;if(Xe===0)return!1}if(typeof Xe=="string"){const St=Xe.trim().toLowerCase();if(["true","t","1"].includes(St))return!0;if(["false","f","0"].includes(St))return!1}return null},et=Xe=>Xe?Xe.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",Ue=Xe=>Xe==="chua thanh toan"||Xe==="chua hoan"||Xe.includes("chua thanh toan")||Xe.includes("chua hoan"),fe=Xe=>{const St=et(Xe);return St&&Fk[St]?Fk[St]:Xe},ce=t.map(Xe=>{const St=Ae(Xe.registration_date??Xe[Q.ORDER_DATE]),Ht=Ae(Xe.expiry_date??Xe[Q.ORDER_EXPIRED]),Rt=ne(Ae(Xe.registration_date_display),St),tn=ne(Ae(Xe.expiry_date_display),Ht),zr=je(me(Xe.so_ngay_con_lai)),ae=rO(Ht||tn),Le=zr??ae??0,Je=Xe[Q.STATUS]||"Cha Thanh Ton",tt=fe(Je.trim()),at=He(Xe[Q.CHECK_FLAG]),gt=Mp(Number.parseFloat(String(Xe[Q.PRICE]??0))||0),Nt=Number(Xe[Q.DAYS])||0,ir=Math.max(0,Le),Dt=Nt>0?gt*ir/Nt:0,rr=Xe.can_hoan??Xe[Q.REFUND]??Xe.refund,L=je(rr)??(Number.isFinite(Dt)?Dt:null);return{...Xe,[Vt.SO_NGAY_CON_LAI]:Le,[Vt.GIA_TRI_CON_LAI]:Dt,[Vt.CHECK_FLAG_STATUS]:at,[Vt.TRANG_THAI_TEXT]:tt,[Vt.ORDER_DATE_DISPLAY]:Rt,[Vt.EXPIRY_DATE_DISPLAY]:tn,can_hoan:L}}),rt=V1(n),_t=Mk(n),yt=i==="all"?[Q.CUSTOMER,Q.ID_ORDER,Q.INFORMATION_ORDER,Q.SUPPLY,Q.CONTACT]:[i],Bt=c==="all"?"":et(c),Tt=ce.filter(Xe=>{const St=!rt||yt.some(Rt=>{const tn=Xe[Rt],zr=V1(tn);if(!zr)return!1;if(Rt===Q.ID_ORDER){const ae=Mk(tn);return!!_t&&ae.includes(_t)||zr.includes(rt)}return zr.includes(rt)}),Ht=c==="all"||et(String(Xe[Vt.TRANG_THAI_TEXT]||""))===Bt;return St&&Ht});Tt.sort((Xe,St)=>{const Ht=String(Xe[Vt.TRANG_THAI_TEXT]||""),Rt=String(St[Vt.TRANG_THAI_TEXT]||""),tn=et(Ht),zr=et(Rt),ae=Ue(tn),Le=Ue(zr);if(ae!==Le)return ae?-1:1;if(e==="expired"){const Dt=Y=>{const C=Ae(Y.expiry_date)??Ae(Y[Q.ORDER_EXPIRED])??Ae(Y.expiry_date_display)??Ae(Y[Vt.EXPIRY_DATE_DISPLAY]),M=(Kr(C)||String(C||"")).split("/");if(M.length===3){const[F,W,K]=M.map(Number);if(Number.isFinite(F)&&Number.isFinite(W)&&Number.isFinite(K))return new Date(K,W-1,F).getTime()}const E=new Date(String(C||""));return Number.isFinite(E.getTime())?E.getTime():0},rr=Dt(Xe),L=Dt(St);if(rr!==L)return L-rr}const Je=Ak(Ht),tt=Ak(Rt);if(Je!==tt)return Je-tt;const at=Number(Xe[Vt.SO_NGAY_CON_LAI]??0),gt=Number(St[Vt.SO_NGAY_CON_LAI]??0);if(at!==gt)return at-gt;const Nt=Xe[Q.ID_ORDER]||"",ir=St[Q.ID_ORDER]||"";return Nt<ir?-1:Nt>ir?1:0});const dt=ce.length,$t=ce.filter(Xe=>{const St=Number(Xe[Vt.SO_NGAY_CON_LAI]??0);return Number.isFinite(St)&&St>0&&St<=4}).length,Qt=ce.filter(Xe=>{const St=Number(Xe[Vt.SO_NGAY_CON_LAI]??0);return Number.isFinite(St)&&St<=0}).length,Ut=ce.filter(Xe=>{const St=Ae(Xe.registration_date||Xe.registration_date_display||Xe[Vt.ORDER_DATE_DISPLAY]||Xe[Q.ORDER_DATE]);return Mq(St)}).length,Dr=[{...h0[0],value:String(dt)},{...h0[1],value:String($t)},{...h0[2],value:String(Qt)},{...h0[3],value:String(Ut)}],en=Math.ceil(Tt.length/m),Ur=h*m,ca=Ur-m,Yn=Tt.slice(ca,Ur);return{filteredOrders:Tt,currentOrders:Yn,totalPages:en,updatedStats:Dr,totalRecords:dt}},[t,n,i,c,m,h]),{filteredOrders:xe,currentOrders:ye,totalPages:ge,updatedStats:Oe,totalRecords:ie}=Ie;v.useEffect(()=>{d(1)},[n,i,c,m]);const he=v.useMemo(()=>{const ne=[];if(ge<=7){for(let He=1;He<=ge;He++)ne.push(He);return ne}const Ae=(He,et,Ue)=>Math.min(Math.max(He,et),Ue),me=Ae(h-1,2,ge-3),je=Ae(h+1,4,ge-1);ne.push(1),me>2&&ne.push("...");for(let He=me;He<=je;He++)ne.push(He);return je<ge-1&&ne.push("..."),ne.push(ge),ne},[h,ge]),De=()=>D(!0),We=()=>D(!1),Ve=()=>{w(!1),I(null)},Ge=()=>{A(!1),q(null)},Te=()=>{b(!1),z(null)},U=ne=>{I(ne),w(!0)};return{...Ie,filteredOrders:xe,paginationPages:he,searchTerm:n,setSearchTerm:a,searchField:i,setSearchField:s,statusFilter:c,setStatusFilter:f,currentPage:h,setCurrentPage:d,rowsPerPage:m,setRowsPerPage:x,isModalOpen:g,isViewModalOpen:_,isEditModalOpen:S,isCreateModalOpen:T,orderToView:O,orderToDelete:j,orderToEdit:R,openCreateModal:De,closeCreateModal:We,closeViewModal:Ve,closeEditModal:Ge,closeModal:Te,handleViewOrder:U,handleEditOrder:ne=>{const Ae={...ne,cost:Number(ne[Q.COST]??0)||0,price:Number(ne[Q.PRICE]??0)||0};q(Ae),A(!0)},handleDeleteOrder:ne=>{z(ne),b(!0)},handleSaveNewOrder:async ne=>{We();try{const Ae=await fetch(`${Ks}${It.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(ne)});if(!Ae.ok){const je=await Ae.json();throw new Error(je.error||"Li khi to n hng mi t My ch")}await pe();const me=await Ae.json();U(me)}catch(Ae){console.error("Li khi to n hng:",Ae),alert(`Li khi to n hng: ${Ae instanceof Error?Ae.message:String(Ae)}`)}},handleSaveEdit:async ne=>{Ge();const Ae={[Q.ID_ORDER]:ne.id_order,[Q.ID_PRODUCT]:ne.id_product,[Q.INFORMATION_ORDER]:ne.information_order,[Q.CUSTOMER]:ne.customer,[Q.CONTACT]:ne.contact,[Q.SLOT]:ne.slot,[Q.SUPPLY]:ne.supply,[Q.COST]:Number(ne.cost??0)||0,[Q.PRICE]:Number(ne.price??0)||0,[Q.NOTE]:ne.note,[Q.STATUS]:ne.status,[Q.CHECK_FLAG]:ne.check_flag};try{const me=await fetch(`${Ks}${It.ORDER_BY_ID(Number(ne.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Ae)});if(!me.ok){const je=await Bu(me);throw new Error(je||"Li khi cp nht n hng t My ch")}await pe()}catch(me){console.error("Li khi cp nht n hng:",me),alert(`Li khi cp nht n hng: ${me instanceof Error?me.message:String(me)}`)}},handleConfirmRefund:async ne=>{if(!(!ne||!ne.id))try{const Ae=await fetch(`${Ks}${It.ORDER_CANCELED_REFUND(ne.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!Ae.ok){const me=await Bu(Ae);throw new Error(me||"Li khi xc nhn hon tin t my ch")}await pe()}catch(Ae){console.error("Li khi xc nhn hon tin:",Ae),alert(`Li khi xc nhn hon tin: ${Ae instanceof Error?Ae.message:String(Ae)}`)}},handleMarkPaid:async ne=>{if(!ne||!ne.id)return;const me=String(ne[Q.STATUS]||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),je=ne[Q.CHECK_FLAG];let He=null;if(me==="chua thanh toan"&&je==null?He={[Q.CHECK_FLAG]:!1}:me==="chua thanh toan"&&je===!1?He={[Q.STATUS]:wi.DA_THANH_TOAN,[Q.CHECK_FLAG]:!0}:He={[Q.STATUS]:wi.DA_THANH_TOAN,[Q.CHECK_FLAG]:!0},!!He)try{const et=await fetch(`${Ks}${It.ORDER_BY_ID(ne.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(He)});if(!et.ok){const Ue=await Bu(et);throw new Error(Ue||"Li khi cp nht trng thi t my ch")}await pe()}catch(et){console.error("Li khi nh du  thanh ton:",et),alert(`Khng th nh du  thanh ton: ${et instanceof Error?et.message:String(et)}`)}},handleRenewOrder:async ne=>{if(!ne)return;const Ae=String(ne[Q.ID_ORDER]||"").trim();if(!Ae){alert("Khng tm thy m n  gia hn.");return}const me=`${Ks}${It.ORDER_RENEW(Ae)}`;console.log("[Renew] start",{orderCode:Ae,orderId:ne.id,apiBase:Ks,renewUrl:me}),Ne(Ae);try{const je=await fetch(me,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({forceRenewal:!0})});let He=null;try{He=await je.clone().text()}catch{He=null}if(console.log("[Renew] response",{orderCode:Ae,status:je.status,body:He}),!je.ok){const et=await Bu(je);throw new Error(et||`Gia hn tht bi (m: ${je.status||"unknown"})`)}await pe(),alert("Gia hn thnh cng.")}catch(je){console.error("Li khi gia hn n:",je),alert(`Gia hn tht bi: ${je instanceof Error?je.message:String(je)}`)}finally{Ne(null)}},confirmDelete:async()=>{if(j){b(!1);try{const ne=await fetch(`${Ks}${It.ORDER_BY_ID(j.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:j[Vt.GIA_TRI_CON_LAI],gia_tri_con_lai:j[Vt.GIA_TRI_CON_LAI],check_flag:j[Vt.CHECK_FLAG_STATUS]})});if(!ne.ok){const Ae=await Bu(ne);throw new Error(Ae||"Li khi xa n hng t My ch")}r(Ae=>Ae.filter(me=>me.id!==j.id))}catch(ne){console.error("Li khi xa n hng:",ne),alert(`Li khi xa n hng: ${ne instanceof Error?ne.message:String(ne)}`)}finally{z(null)}}},fetchError:V,reloadOrders:pe,renewingOrderCode:ue}};function aZ(){const[e,t]=v.useState("active"),[r,n]=v.useState({active:0,expired:0,canceled:0}),{currentOrders:a,totalPages:i,updatedStats:s,filteredOrders:c,paginationPages:f,searchTerm:h,setSearchTerm:d,searchField:m,setSearchField:x,statusFilter:g,setStatusFilter:b,currentPage:_,setCurrentPage:w,rowsPerPage:S,setRowsPerPage:A,isModalOpen:T,isViewModalOpen:D,isEditModalOpen:O,isCreateModalOpen:I,orderToView:j,orderToDelete:z,orderToEdit:R,openCreateModal:q,closeCreateModal:V,closeViewModal:J,closeEditModal:ue,closeModal:Ne,handleViewOrder:pe,handleEditOrder:Ie,handleDeleteOrder:xe,handleSaveNewOrder:ye,handleSaveEdit:ge,handleConfirmRefund:Oe,handleMarkPaid:ie,handleRenewOrder:he,confirmDelete:De,fetchError:We,reloadOrders:Ve,totalRecords:Ge,renewingOrderCode:Te}=nZ(e);v.useEffect(()=>{n(ne=>ne[e]===Ge?ne:{...ne,[e]:Ge})},[e,Ge]);const U=e==="active",[H,X]=v.useState(null),Z=ne=>{X(Ae=>Ae===ne?null:ne)},ee=e!=="expired",Fe=e!=="expired",_e=e==="canceled",Me=_e?"Gi Tr Cn Li":"Cn Li",Re=ee?7:6;return u.jsxs("div",{className:"space-y-6",children:[We&&u.jsxs("div",{className:"flex flex-col gap-3 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[u.jsx("span",{children:We}),u.jsx("button",{type:"button",onClick:Ve,className:"rounded-md border border-red-300 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-red-700 transition hover:bg-red-100",children:"Th Li"})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun L n Hng"}),u.jsx("p",{className:"mt-1 text-sm text-gray-200",children:"Qun l v theo di tt c cc n hng ca khch hng"})]}),u.jsx("div",{className:"mt-4 sm:mt-0",children:U&&u.jsx(Bi,{icon:Mi,onClick:q,children:"To n Hng Mi"})})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-r from-indigo-200/60 via-indigo-300/55 to-slate-200/45 p-4 shadow-[0_20px_50px_-28px_rgba(0,0,0,0.5),0_14px_32px_-24px_rgba(255,255,255,0.25)] border border-white/20",children:u.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:zq.map(ne=>{const Ae=ne,me=fO[Ae],je=e===Ae,He=r[Ae]??0;return u.jsxs("button",{type:"button",onClick:()=>t(Ae),className:`flex items-center justify-between rounded-2xl px-5 py-4 text-left transition shadow-[0_12px_28px_-16px_rgba(0,0,0,0.65),0_8px_22px_-18px_rgba(255,255,255,0.12)] ${je?"bg-gradient-to-r from-indigo-500 via-violet-500 to-indigo-500 text-white ring-1 ring-white/25":"bg-indigo-700/70 text-indigo-100 hover:bg-indigo-600/80 ring-1 ring-white/10"}`,children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:me.label}),u.jsx("p",{className:"text-xs text-indigo-100/80",children:me.description})]}),u.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:He.toLocaleString("vi-VN")})]},ne)})})}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(ne=>u.jsx(Oc,{title:ne.name,value:ne.value,icon:ne.icon,accent:ne.accent},ne.name))})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(gl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Tm kim n hng, khch hng...",className:"w-full pl-10 pr-44 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:h,onChange:ne=>d(ne.target.value)}),u.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:u.jsx("select",{className:"min-w-[140px] md:min-w-[180px] px-3 py-1.5 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:m,onChange:ne=>x(ne.target.value),children:rZ.map(ne=>u.jsx("option",{value:ne.value,children:ne.label},ne.value))})})]}),u.jsxs("div",{className:"relative",children:[u.jsx(bR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:ne=>b(ne.target.value),children:[u.jsx("option",{value:"all",children:"Tt c trng thi"}),u.jsx("option",{value:wi.DA_THANH_TOAN,children:" thanh ton"}),u.jsx("option",{value:wi.CHUA_THANH_TOAN,children:"Cha thanh ton"}),u.jsx("option",{value:wi.CAN_GIA_HAN,children:"Cn gia hn"}),u.jsx("option",{value:wi.ORDER_EXPIRED,children:"Ht hn"})]})]})]})}),u.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 table-fixed text-white",children:[u.jsx("thead",{className:"bg-slate-900/90",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"ORDER/SN PHM"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[140px] whitespace-nowrap truncate",children:"THNG TIN N HNG"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"KHCH HNG"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"HN N HNG"}),ee&&u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[60px] whitespace-nowrap truncate",children:Me}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"TRNG THI"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"THAO TC"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:a.length===0?u.jsx("tr",{children:u.jsxs("td",{colSpan:Re,className:"text-center py-12",children:[u.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng tm thy n hng"}),u.jsx("div",{className:"text-white/60",children:"Th thay i b lc tm kim"})]})}):a.map((ne,Ae)=>{const{[Vt.SO_NGAY_CON_LAI]:me,[Vt.GIA_TRI_CON_LAI]:je,[Vt.TRANG_THAI_TEXT]:He,[Vt.CHECK_FLAG_STATUS]:et}=ne,Ue=Number.isFinite(Number(ne[Q.COST]))?Number(ne[Q.COST]):0,fe=Number.isFinite(Number(ne[Q.PRICE]))?Number(ne[Q.PRICE]):0,ce=Number.isFinite(Number(je))?Number(je):0,rt=Number.isFinite(Number(ne.can_hoan))?Number(ne.can_hoan):ce,_t=String(He||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),yt=e==="canceled"&&_t.includes("chua hoan"),Bt=ne[Vt.ORDER_DATE_DISPLAY]||"",Tt=ne[Vt.EXPIRY_DATE_DISPLAY]||"",dt=H===ne.id,$t=String(ne[Q.ID_ORDER]||"").trim(),Qt=Te===$t;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{onClick:()=>Z(ne.id),className:`cursor-pointer transition ${Ae%2===0?"bg-slate-900/55":"bg-indigo-950/40"} ${dt?"bg-indigo-700/25":""} hover:bg-indigo-600/25`,children:[u.jsx("td",{className:"px-4 py-4 text-sm font-medium text-white w-[150px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"font-bold whitespace-nowrap truncate max-w-[150px]",children:ne[Q.ID_ORDER]||""}),u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:ne[Q.ID_PRODUCT]||""})]})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white w-[140px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"text-white/80 text-xs whitespace-nowrap truncate max-w-[150px]",children:ne[Q.INFORMATION_ORDER]||""}),ne[Q.SLOT]?u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:ne[Q.SLOT]}):null]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-white w-[150px] text-center",children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"font-medium whitespace-nowrap truncate max-w-[150px]",children:ne[Q.CUSTOMER]||""}),u.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",title:String(ne[Q.CONTACT]||""),children:ne[Q.CONTACT]||""})]})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm text-white w-[150px] text-center",children:Bt&&Tt?`${Bt} - ${Tt}`:Bt||Tt||""}),ee&&u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm font-bold w-[60px] text-center",children:(()=>{const Ut=Number.isFinite(Number(me))?Number(me):0;return u.jsx("span",{className:_e?"text-indigo-600":Ut<=0?"text-red-600":Ut<=4?"text-orange-500":"text-green-500",children:_e?to(rt):Ut})})()}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate w-[90px] text-center",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${sO(String(He||""))}`,children:String(He||"")})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-right text-sm font-medium w-[90px]",children:u.jsxs("div",{className:"flex space-x-2 justify-end",children:[u.jsx("button",{onClick:Ut=>{Ut.stopPropagation(),pe(ne)},className:"text-blue-600 hover:text-blue-900 p-1 rounded",children:u.jsx(nf,{className:"h-4 w-4"})}),yt&&u.jsx("button",{onClick:Ut=>{Ut.stopPropagation(),Oe(ne)},className:"text-emerald-600 hover:text-emerald-800 p-1 rounded",title:"Xc nhn  gii/hon tin",children:u.jsx(wc,{className:"h-4 w-4"})}),U&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:Ut=>{Ut.stopPropagation(),Ie(ne)},className:"text-green-600 hover:text-green-900 p-1 rounded",children:u.jsx(cc,{className:"h-4 w-4"})}),u.jsx("button",{onClick:Ut=>{Ut.stopPropagation(),xe(ne)},className:"text-red-600 hover:text-red-900 p-1 rounded",children:u.jsx(rl,{className:"h-4 w-4"})})]})]})})]}),dt&&u.jsx("tr",{className:"bg-indigo-900/40",children:u.jsx("td",{colSpan:Re,className:"px-6 pb-6 pt-0",children:u.jsxs("div",{className:"rounded-2xl border border-dashed border-indigo-200/60 bg-indigo-600/20 p-5 shadow-lg shadow-indigo-900/30",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1 text-center",children:[u.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tit n hng"}),u.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",ne[Q.ID_ORDER]||""]})]}),Fe&&u.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[!(ne[Q.STATUS]===wi.DA_THANH_TOAN&&ne[Q.CHECK_FLAG]===!0)&&u.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:Ut=>{Ut.stopPropagation(),ie(ne)},children:" Thanh Ton"}),u.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:Qt,onClick:Ut=>{Ut.stopPropagation(),Qt||he(ne)},children:Qt?"ang Gia Hn...":"Gia Hn"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ngun"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:ne[Q.SUPPLY]||"N/A"})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi nhp"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:to(Ue)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi bn"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:to(fe)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi tr cn li"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:to(ce)})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"S ngy"}),u.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:ne[Q.DAYS]||0})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi ch"}),u.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:ne[Q.NOTE]||"Khng c ghi ch."})]}),u.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Kim tra"}),et===null?u.jsx("div",{className:"mt-3 h-5"}):u.jsx("div",{className:"mt-3 flex items-center justify-center",children:u.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:!!et,readOnly:!0,onClick:Ut=>Ut.stopPropagation()})})]})]})]})})})]},ne.id)})})]})}),c.length>0&&u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[u.jsx("span",{children:"Hin th"}),u.jsxs("select",{id:"rowsPerPage",value:S,onChange:ne=>A(Number(ne.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[u.jsx("option",{value:10,children:"10"}),u.jsx("option",{value:25,children:"25"}),u.jsx("option",{value:50,children:"50"})]}),u.jsx("span",{children:"dng"})]}),u.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[u.jsx("button",{onClick:()=>w(1),disabled:_===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang u",children:"<<"}),u.jsx("button",{onClick:()=>w(ne=>Math.max(ne-1,1)),disabled:_===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trc",children:"<"}),u.jsx("div",{className:"flex items-center gap-1",children:f.map((ne,Ae)=>ne==="..."?u.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${Ae}`):u.jsx("button",{onClick:()=>w(ne),disabled:ne===_,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${ne===_?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:ne},ne))}),u.jsx("button",{onClick:()=>w(ne=>Math.min(ne+1,i)),disabled:_===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),u.jsx("button",{onClick:()=>w(i),disabled:_===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cui",children:">>"})]})]})]}),u.jsx(Vq,{isOpen:T,onClose:Ne,onConfirm:De,title:"Xc nhn xa",message:`Bn c chc chn mun xa n hng: ${z?.id_order}?`}),u.jsx(Xq,{isOpen:D,onClose:J,order:j,formatCurrency:tZ}),u.jsx(Zq,{isOpen:O,onClose:ue,order:R,onSave:ne=>ge(ne)}),u.jsx(eZ,{isOpen:I,onClose:V,onSave:ne=>{ye(ne)}})]})}const Lk=[{border:"border-sky-100/70",glow:"from-sky-100/80 via-white/80 to-blue-100/70",link:"text-sky-600 hover:text-sky-700"},{border:"border-emerald-100/70",glow:"from-emerald-100/80 via-white/80 to-lime-100/70",link:"text-emerald-600 hover:text-emerald-700"},{border:"border-violet-100/70",glow:"from-violet-100/80 via-white/80 to-fuchsia-100/70",link:"text-violet-600 hover:text-violet-700"},{border:"border-amber-100/70",glow:"from-amber-100/80 via-white/80 to-orange-100/70",link:"text-amber-600 hover:text-amber-700"}],iZ={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},Ch=[{value:"information",label:"Thng tin gi"},{value:"note",label:"Ghi ch"},{value:"supplier",label:"Nh cung cp"},{value:"import",label:"Gi nhp (VND)"},{value:"expired",label:"Ngy ht hn"},{value:"capacity",label:"Tng dung lng (GB)"}],uv=e=>e.filter(t=>t!=="capacity"),oc=5,lc=2e3,K1=100,sZ=.2,oZ=2,dO=(e,t)=>t<=0||e<=0?"out":e/t<=sZ?"low":"ok",$u=e=>e<=0?"out":e<oZ?"low":"ok",mb=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),Bk=e=>{const t=mb(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},io=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),hO=e=>{if(!e)return"";const t=e.trim();if(!t)return"";const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r)return`${r[3]}/${r[2]}/${r[1]}`;const n=t.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n)return`${n[3]}/${n[2]}/${n[1]}`;const a=t.match(/^(\d{2})\/(\d{2})\/(\d{4})/);return a?`${a[1]}/${a[2]}/${a[3]}`:t},$k=e=>{const t=io(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},G1=e=>{const t=io(e);return t?t.toLowerCase().replace(/\s+/g,""):""},lZ=e=>{const t=G1(e.informationUser||"");return t?[t]:[]},cZ=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",uZ=(e,t,r)=>{const n=io(r);if(t!=="slot")return n?[n]:[];const i=(e.slotDisplay??"").split("|").map(c=>io(c)).filter(Boolean);if(i.length>=1)return i;const s=io(e.customerDisplay);return s?[s,`${s} (2)`]:n?[n]:[]},Uk=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},fZ=(e,t)=>{let n=t.productKey;if(e){const s=n.indexOf(e);s>=0&&(n=n.slice(s+e.length))}const a=Uk(n);if(a)return a;const i=mb(t.base?.id_product??"");return Uk(i)},dZ=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):K1} GB`,pO="package_slot_link_prefs",hZ=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(pO);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},pZ=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(pO,JSON.stringify(e))}catch{}},fv=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,a=e.match??e.matchModeValue??null,i=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,s=a?gZ(a):e.slotLinkMode??(i==="slot"?"slot":"information"),c=Array.isArray(e.productCodes)?e.productCodes.map(h=>typeof h=="string"?h.trim():"").filter(h=>!!h):[],f=Array.from(new Set(c.map(h=>xO(h)).filter(Boolean)));return{...e,slot:e.slot??oc,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:s,matchModeValue:a,productCodes:c,normalizedProductCodes:f}},zk=[{value:"all",label:"Tt c trng thi"},{value:"full",label:"Cn nhiu"},{value:"low",label:"Sp ht"},{value:"out",label:" ht"}],mZ=[{value:"information",label:"Lin kt theo thng tin n hng",helper:"Cc gi s c lin kt vi n hng da trn cc trng thng tin nh tn sn phm, thng tin sn phm."},{value:"slot",label:"Lin kt theo v tr",helper:"Cc gi s c lin kt vi n hng da trn m nh danh v tr (slot) ca n hng."}],xZ=wr.informationOrder,mO=wr.slot,gZ=e=>e===mO?"slot":"information",p0=e=>e==="slot"?mO:xZ,xO=e=>(e||"").trim().toLowerCase(),Gs=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9.-]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},dv=e=>e==null?"":typeof e=="string"?e:String(e),Hk=(e,t,r)=>[e&&`Ti khon: ${e}`,t&&`Mt khu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",vZ=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):dv(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):dv(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:dv(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}};function yZ(){const[e,t]=v.useState(""),[r,n]=v.useState("all"),[a,i]=v.useState("all"),[s,c]=v.useState([]),[f,h]=v.useState([]),[d,m]=v.useState(null),[x,g]=v.useState(!0),[b,_]=v.useState(!0),[w,S]=v.useState(!1),[A,T]=v.useState(()=>hZ()),D=v.useRef(A),[O,I]=v.useState([]),[j,z]=v.useState(!1),[R,q]=v.useState(""),[V,J]=v.useState(Ch.map(ae=>ae.value)),[ue,Ne]=v.useState("create"),[pe,Ie]=v.useState(!1),[xe,ye]=v.useState(!1),[ge,Oe]=v.useState(null),[ie,he]=v.useState(!1),[De,We]=v.useState(null),[Ve,Ge]=v.useState(!1),[Te,U]=v.useState(!1),[H,X]=v.useState(new Set),Z=vo(),ee=Zh(),Fe=x||b;v.useEffect(()=>{D.current=A},[A]);const _e=v.useCallback((ae,Le)=>{const Je=String(ae);T(tt=>{if(tt[Je]===Le)return tt;const at={...tt,[Je]:Le};return pZ(at),at})},[]),Me=v.useMemo(()=>Ch.map(ae=>ae.value),[]);v.useEffect(()=>{let ae=!1;return(async()=>{try{g(!0);const Le=await Xt("/api/package-products");if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const Je=await Le.json();if(!ae)if(Array.isArray(Je)){const tt=Je.map(at=>fv(at,D.current));c(tt)}else c([])}catch(Le){console.error("Ti sn phm gi tht bi:",Le),ae||c([])}finally{ae||g(!1)}})(),()=>{ae=!0}},[]),v.useEffect(()=>{let ae=!1;return(async()=>{try{_(!0),S(!1);const Le=await Xt("/api/orders");if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const Je=await Le.json();ae||(Array.isArray(Je)?h(Je):h([]),S(!0))}catch(Le){console.error("Ti danh sch n hng tht bi:",Le),ae||(h([]),S(!1))}finally{ae||_(!1)}})(),()=>{ae=!0}},[]);const Re=v.useMemo(()=>Array.from(new Set(s.map(ae=>ae.package))).sort(),[s]),ne=v.useMemo(()=>f.map(ae=>{const Le=Bk(ae.id_product??""),Je=Bk(ae.information_order??"");return{base:ae,productKey:Le.normalized,productLettersKey:Le.lettersOnly,infoKey:Je.normalized,infoLettersKey:Je.lettersOnly,slotDisplay:io(ae.slot),slotKey:$k(ae.slot),slotMatchKey:G1(ae.slot),informationDisplay:io(ae.information_order),informationKey:$k(ae.information_order),informationMatchKey:G1(ae.information_order),customerDisplay:io(ae.customer),productCodeNormalized:xO(ae.id_product)}}),[f]);v.useEffect(()=>{I(ae=>{const Le=new Map(ae.map(tt=>[tt.name,tt]));let Je=!1;return Re.forEach(tt=>{if(!tt)return;const at=s.some(Nt=>Nt.package===tt&&Nt.hasCapacityField),gt=Le.get(tt);if(!gt){const Nt=at?Me:uv(Me);Le.set(tt,{name:tt,fields:Nt,isCustom:!1}),Je=!0;return}if(gt.isCustom!==!0&&!at&&gt.fields.includes("capacity")){const Nt=uv(gt.fields);Le.set(tt,{...gt,fields:Nt}),Je=!0}}),Je?Array.from(Le.values()).sort((tt,at)=>tt.name.localeCompare(at.name)):ae})},[Re,s,Me]),v.useEffect(()=>{const Le=new URLSearchParams(Z.search).get("package");n(Le||"all")},[Z.search]),v.useEffect(()=>{const ae=new URLSearchParams(Z.search);r==="all"?ae.delete("package"):ae.set("package",r);const Le=ae.toString(),Je=Le?`?${Le}`:"";Je!==Z.search&&ee({pathname:Z.pathname,search:Je},{replace:!0})},[r,Z.pathname,Z.search,ee]);const Ae=v.useCallback(ae=>{n(Le=>ae==="all"||Le===ae?"all":ae)},[]),me=v.useMemo(()=>s.map(ae=>{const Le=!!ae.hasCapacityField,Je=Gs(ae.slot),tt=Je&&Je>0?Math.floor(Je):oc,at=Gs(ae.slotUsed),gt=mb(ae.package),Nt=gt.replace(/[0-9]/g,""),Dt=(ae.slotLinkMode??"information")==="information"?"slot":"information",rr=Dt==="slot"?"information":"slot",L=lZ(ae),Y=ae.normalizedProductCodes??[],C=Y.length>0?new Set(Y):null,P=w&&ne.length>0&&(C?.size||gt.length>0),M=$e=>{if(C&&C.size>0)return!(!$e.productCodeNormalized||!C.has($e.productCodeNormalized));if(!gt)return!1;const ht=!!$e.productKey&&($e.productKey.startsWith(gt)||$e.productKey.includes(gt))||!!Nt&&!!$e.productLettersKey&&($e.productLettersKey.startsWith(Nt)||$e.productLettersKey.includes(Nt)),xt=!!$e.infoKey&&($e.infoKey.startsWith(gt)||$e.infoKey.includes(gt))||!!Nt&&!!$e.infoLettersKey&&($e.infoLettersKey.startsWith(Nt)||$e.infoLettersKey.includes(Nt));return ht||xt},E=$e=>{if(L.length===0)return!0;const ht=rr==="slot"?$e.slotMatchKey:$e.informationMatchKey;return ht?L.some(xt=>xt===ht||xt.includes(ht)||ht.includes(xt)):!1},F=P?ne.filter($e=>M($e)&&E($e)):[],W=new Set,K=[];P&&F.forEach($e=>{const ht=cZ($e,Dt),kt=(rr==="slot"?$e.slotDisplay:$e.informationDisplay)||$e.customerDisplay||"",kr=$e.base?.id!==void 0&&$e.base?.id!==null?`id:${$e.base.id}`:$e.base?.id_order!==void 0&&$e.base?.id_order!==null?`code:${$e.base.id_order}`:`${kt}-${K.length}`;if(W.has(kr))return;W.add(kr);const Cr=ht||kt,jt=uZ($e,Dt,Cr);if(jt.length===0)return;const Ot=Le?fZ(gt,$e):null;jt.forEach(vr=>{const Ft=vr||Cr||"";Ft&&K.push({slotLabel:Ft,matchValue:kt||Ft,sourceOrderId:$e.base?.id??null,sourceOrderCode:$e.base?.id_order??null,displayColumn:Dt,matchColumn:rr,capacityUnits:Ot})})});const G=K.length>0?K.length:at!==null?Math.max(Math.floor(at),0):0,re=Math.min(G,tt),se=Math.max(tt-re,0);let de=0,Pe=0,we=0;if(Le){const $e=Gs(ae.capacity);de=$e&&$e>0?Math.floor($e):lc;const ht=Gs(ae.capacityUsed),xt=K.length>0?K.reduce((kr,Cr)=>kr+(Cr.capacityUnits??K1),0):G*K1,kt=Math.min(xt,de);Pe=Math.min(Math.max(ht!==null?Math.floor(ht):kt,0),de),we=Math.max(de-Pe,0)}const ke=P?F.map($e=>$e.base):[];return{...ae,slotUsed:re,slotLimit:tt,remainingSlots:se,capacityLimit:de,capacityUsed:Pe,remainingCapacity:we,slotAssignments:K,matchedOrders:ke,packageCode:gt,productCodes:ae.productCodes??[],normalizedProductCodes:Y,matchModeValue:ae.matchModeValue??ae.match??null}}),[s,ne,w]),je=r!=="all"?r:null,He=v.useMemo(()=>je?O.find(ae=>ae.name===je)??null:null,[O,je]),et=v.useMemo(()=>je?me.filter(ae=>ae.package===je):me,[me,je]),Ue=et.filter(ae=>{const Le=e.trim().toLowerCase(),Je=[ae.information,ae.informationUser,ae.informationMail,ae.informationPass,ae.accountUser,ae.accountMail,ae.accountPass,ae.note],tt=Le.length===0||Je.some(ir=>(ir==null?"":String(ir)).toLowerCase().includes(Le)),at=r==="all"||ae.package===r,gt=$u(ae.remainingSlots);return tt&&at&&(a==="all"||a==="full"&&gt==="ok"||a===gt)}),fe=v.useMemo(()=>[...Ue].sort((ae,Le)=>{const Je=Number(ae.remainingSlots),tt=Number(Le.remainingSlots),at=Number.isFinite(Je)?Je:Number.POSITIVE_INFINITY,gt=Number.isFinite(tt)?tt:Number.POSITIVE_INFINITY,Nt=at<=0?Number.POSITIVE_INFINITY:at,ir=gt<=0?Number.POSITIVE_INFINITY:gt;return Nt===ir?0:Nt-ir}),[Ue]),rt=Ue.some(ae=>ae.hasCapacityField??!1)||Ue.length===0&&(He?.fields.includes("capacity")??!1),_t=rt?9:8,yt=v.useMemo(()=>[{name:"Tng",value:String(et.length),icon:wc,accent:Yr.sky},{name:"Gi sp ht",value:String(et.reduce((ae,Le)=>$u(Le.remainingSlots)==="low"?ae+1:ae,0)),icon:hy,accent:Yr.amber},{name:"Gi  ht",value:String(et.reduce((ae,Le)=>$u(Le.remainingSlots)==="out"?ae+1:ae,0)),icon:uy,accent:Yr.rose},{name:"Thm hm nay",value:"0",icon:fy,accent:Yr.emerald}],[et]),Bt=v.useMemo(()=>{const ae=new Set;return me.forEach(Le=>{const Je=(Le.package||"").trim();Je&&ae.add(Je)}),O.forEach(Le=>{Le.name&&ae.add(Le.name)}),Array.from(ae).sort((Le,Je)=>Le.localeCompare(Je))},[me,O]),Tt=v.useMemo(()=>{const ae=new Map;return Bt.forEach(Le=>ae.set(Le,{total:0,low:0,out:0})),me.forEach(Le=>{const Je=(Le.package||"").trim();if(!Je)return;const tt=ae.get(Je);if(!tt)return;tt.total+=1;const at=$u(Le.remainingSlots);at==="low"&&(tt.low+=1),at==="out"&&(tt.out+=1)}),Bt.map(Le=>({name:Le,...ae.get(Le)??{total:0,low:0,out:0}}))},[Bt,me]),dt=v.useCallback(ae=>{q(ae?.name??""),J(ae?.fields&&ae.fields.length>0?ae.fields:Me),Ne(ae?.mode??"create"),z(!0)},[Me]),$t=v.useCallback((ae,Le)=>{const Je=ae.trim();Je&&(I(tt=>{const at=tt.filter(gt=>gt.name!==Je);return at.push({name:Je,fields:Le,isCustom:!0}),at.sort((gt,Nt)=>gt.name.localeCompare(Nt.name))}),z(!1),Ae(Je))},[Ae]),Qt=v.useCallback(async ae=>{if(!He)return;const Le=He.fields.includes("capacity"),Je=He.fields.includes("information"),tt=He.fields.includes("note"),at=He.fields.includes("supplier"),gt=He.fields.includes("import"),Nt=Gs(ae.slot),ir=Nt!==null&&Nt>0?Math.floor(Nt):oc,Dt=Gs(ae.capacity),rr=Dt!==null&&Dt>0?Math.floor(Dt):lc,L=Je?Hk(ae.informationUser||null,ae.informationPass||null,ae.informationMail||null):"",Y={packageName:He.name,informationUser:Je&&ae.informationUser||null,informationPass:Je&&ae.informationPass||null,informationMail:Je&&ae.informationMail||null,note:tt&&ae.note||null,supplier:at&&ae.supplier||null,importPrice:gt?Number(ae.import||0)||0:null,accountUser:Le&&ae.accountUser||null,accountPass:Le&&ae.accountPass||null,accountMail:Le&&ae.accountMail||null,accountNote:Le&&ae.accountNote||null,capacity:Le?rr:null,hasCapacityField:Le,expired:ae.expired||null,slotLimit:ir,matchMode:p0(ae.slotLinkMode)};try{const C=await Xt("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)});if(!C.ok)throw new Error(`HTTP ${C.status}`);const P=await C.json(),M=fv({...P,slot:ir,slotUsed:0,capacity:Le?rr:P.capacity,information:Je?L||null:P.information,match:P.match??p0(ae.slotLinkMode),hasCapacityField:Le},D.current);c(E=>[...E,M]),P.id!==void 0&&P.id!==null&&_e(P.id,ae.slotLinkMode),Ie(!1)}catch(C){console.error("Li khi to gi sn phm:",C)}},[_e,He]),Ut=()=>{if(je&&He){dt({name:je,fields:He.fields,mode:"edit"});return}dt()},Dr=()=>{if(je){if(!He){dt({name:je,fields:Me,mode:"create"});return}Ie(!0)}},en=v.useCallback(ae=>{const Le=O.find(Je=>Je.name===ae)??null;dt({name:ae,fields:Le?.fields??Me,mode:"edit"})},[O,dt,Me]),Ur=v.useCallback(()=>{Ge(!1),X(new Set)},[]),ca=v.useCallback(ae=>{const Le=ae.trim();Le&&X(Je=>{const tt=new Set(Je);return tt.has(Le)?tt.delete(Le):tt.add(Le),tt})},[]),Yn=v.useCallback(async()=>{if(H.size===0){Ur();return}U(!0);const ae=Array.from(H);try{const Le=await Xt("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:ae})});if(!Le.ok){const at=await Le.text();throw new Error(at||`HTTP ${Le.status}`)}const Je=await Le.json().catch(()=>({})),tt=Array.isArray(Je.deletedNames)?Je.deletedNames:ae;c(at=>at.filter(gt=>!tt.includes((gt.package||"").trim()))),I(at=>at.filter(gt=>!tt.includes(gt.name))),je&&tt.includes(je)&&Ae("all")}catch(Le){console.error("Xa nhm tht bi:",Le),alert(`Xa nhm tht bi: ${Le instanceof Error?Le.message:"Li khng xc nh"}`)}finally{U(!1),Ur()}},[H,Ur,je,Ae]),Xe=v.useCallback(ae=>{const Le=O.find(Je=>Je.name===ae.package)??{name:ae.package,fields:ae.hasCapacityField?Me:uv(Me),isCustom:!1};Oe({rowId:ae.id,template:Le,initialValues:vZ(ae),accountStorageId:ae.accountStorageId??null}),ye(!0)},[O,Me]),St=v.useCallback(()=>{ye(!1),Oe(null)},[]),Ht=v.useCallback(ae=>{We(ae),he(!0)},[]),Rt=v.useCallback(()=>{he(!1),We(null)},[]),tn=v.useCallback(ae=>{m(Le=>Le===ae?null:ae)},[]),zr=v.useCallback(async ae=>{if(!ge)return;const{template:Le,rowId:Je,accountStorageId:tt}=ge,at=Le.fields.includes("capacity"),gt=Le.fields.includes("information"),Nt=Le.fields.includes("note"),ir=Le.fields.includes("supplier"),Dt=Le.fields.includes("import"),rr=Gs(ae.slot),L=rr!==null&&rr>0?Math.floor(rr):oc,Y=Gs(ae.capacity),C=Y!==null&&Y>0?Math.floor(Y):lc,P=gt?Hk(ae.informationUser||null,ae.informationPass||null,ae.informationMail||null):"",M={packageName:Le.name,informationUser:gt&&ae.informationUser||null,informationPass:gt&&ae.informationPass||null,informationMail:gt&&ae.informationMail||null,note:Nt&&ae.note||null,supplier:ir&&ae.supplier||null,importPrice:Dt?Number(ae.import||0)||0:null,expired:ae.expired||null,slotLimit:L,accountStorageId:tt??null,accountUser:at&&ae.accountUser||null,accountPass:at&&ae.accountPass||null,accountMail:at&&ae.accountMail||null,accountNote:at&&ae.accountNote||null,capacity:at?C:null,hasCapacityField:at,matchMode:p0(ae.slotLinkMode)};try{const E=await Xt(`/api/package-products/${Je}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!E.ok)throw new Error(`HTTP ${E.status}`);const F=await E.json(),W=fv({...F,slot:L,capacity:at?C:F.capacity,information:gt?P||null:F.information,match:F.match??p0(ae.slotLinkMode),hasCapacityField:at},D.current);c(K=>K.map(G=>G.id===Je?W:G)),_e(Je,ae.slotLinkMode),St()}catch(E){console.error(`Cp nht Gi Sn Phm ${Je} Li:`,E)}},[ge,St,_e]);return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun l Gi Sn phm"}),u.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Qun l cc loi gi sn phm v cc gi con."})]}),u.jsxs("div",{className:"mt-4 sm:mt-0 flex flex-wrap gap-3",children:[Ve?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:Yn,className:"flex items-center justify-center gap-1 rounded-lg bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-600 transition disabled:opacity-60",disabled:Te,title:"Xc nhn xa",children:u.jsx(tl,{className:"h-5 w-5"})}),u.jsx("button",{type:"button",onClick:Ur,className:"flex items-center justify-center gap-1 rounded-lg bg-white/20 px-3 py-2 text-sm font-semibold text-gray-800 shadow hover:bg-gray-300 transition disabled:opacity-60",disabled:Te,title:"Hy xa",children:u.jsx(Tn,{className:"h-5 w-5"})})]}):u.jsx(Bi,{icon:rl,onClick:()=>{Ge(!0),X(new Set)},disabled:Te,children:"Xa Loi gi"}),u.jsx(Bi,{icon:Mi,onClick:Ut,children:"To Loi Gi"}),u.jsx(Bi,{icon:Mi,onClick:Dr,disabled:!je,children:"Thm Gi"})]})]}),u.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-white/5 via-indigo-900/35 to-indigo-950/55 border border-white/10 p-6 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:yt.map(ae=>u.jsx(Oc,{title:ae.name,value:ae.value,icon:ae.icon,accent:ae.accent},ae.name))})}),u.jsxs("div",{className:"bg-white/10 rounded-xl shadow-sm p-6 text-white",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tng quan cc loi gi"}),u.jsx("p",{className:"text-sm text-white/80",children:"Chn mt loi gi  xem chi tit hoc xa."})]})}),Tt.length===0?u.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Khng c loi gi no  hin th."}):u.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:Tt.map((ae,Le)=>{const Je=ae.name===je,tt=Lk[Le%Lk.length],at=H.has(ae.name.trim());return u.jsxs("div",{className:`relative isolate rounded-3xl border ${tt.border} bg-white/80 p-5 text-white shadow-[0_20px_50px_-35px_rgba(15,23,42,0.7)] backdrop-blur transition duration-200 ${Je?"ring-2 ring-blue-400 shadow-[0_25px_65px_-35px_rgba(37,99,235,0.7)]":"hover:shadow-[0_30px_75px_-40px_rgba(15,23,42,0.55)]"}`,children:[u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/70",children:"Loi Gi"}),u.jsx("h3",{className:"text-lg font-semibold",children:ae.name}),u.jsxs("p",{className:"mt-1 text-sm text-white/80",children:["S lng gi: ",ae.total]})]}),Ve?u.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[u.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:at,disabled:Te,onChange:()=>ca(ae.name)}),"Chn  xa"]}):u.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Ae(ae.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${Je?"text-blue-300":"text-white/80"}`,title:"Xem chi tit",children:u.jsx(nf,{className:"h-5 w-5"})}),u.jsx("button",{type:"button",onClick:()=>en(ae.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chnh sa Loi Gi",children:u.jsx(cc,{className:"h-5 w-5"})})]})})]}),u.jsxs("dl",{className:"mt-5 grid grid-cols-3 gap-4 text-sm",children:[u.jsxs("div",{className:"rounded-2xl border border-white/60 bg-white/70 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tng"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-white",children:ae.total})]}),u.jsxs("div",{className:"rounded-2xl border border-amber-100/70 bg-amber-50/60 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-amber-600",children:"Sp ht"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-amber-500",children:ae.low})]}),u.jsxs("div",{className:"rounded-2xl border border-rose-100/70 bg-rose-50/60 p-3 text-center shadow-inner",children:[u.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-rose-600",children:"Ht"}),u.jsx("dd",{className:"mt-1 text-2xl font-bold text-rose-500",children:ae.out})]})]})]},ae.name)})})]}),je&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx(gl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/70"}),u.jsx("input",{type:"text",placeholder:`Tm kim trong cc gi ca ${je}...`,className:"w-full pl-10 pr-4 py-2 border border-white/40 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:e,onChange:ae=>t(ae.target.value)})]}),u.jsx("select",{className:"w-full px-4 py-2 border border-white/40 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-700",value:a,onChange:ae=>i(ae.target.value),children:zk.map(ae=>u.jsx("option",{value:ae.value,children:ae.label},ae.value))}),u.jsx("button",{className:`px-4 py-2 rounded-lg transition-colors ${Ue.length?"bg-gray-100 text-gray-700 hover:bg-indigo-500/20":"bg-gray-100 text-white/70 cursor-not-allowed"}`,disabled:!Ue.length,children:"Xut Excel"})]}),u.jsxs("div",{className:"text-sm text-white/80",children:["ang xem loi gi:"," ",u.jsx("span",{className:"font-medium text-white",children:je??"Tt c"}),a!=="all"&&u.jsxs(u.Fragment,{children:[" ",""," ",u.jsx("span",{className:"font-medium text-white",children:zk.find(ae=>ae.value===a)?.label})]})]})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Tn gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thng tin gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"S lng"}),rt&&u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Dung lng"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"NCC"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Gi nhp"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ngy ht hn"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ghi Ch"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thao tc"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Fe?u.jsx("tr",{children:u.jsx("td",{colSpan:_t,className:"px-6 py-8 text-center text-white/80 text-sm",children:"ang ti d liu..."})}):Ue.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:_t,className:"px-6 py-8 text-center text-white/80 text-sm",children:"Khng c gi no  hin th."})}):fe.map((ae,Le)=>{const Je=ae.slotLimit||oc,tt=ae.slotUsed,at=ae.remainingSlots,gt=Je>0?Math.min(at/Je*100,100):0,Nt=$u(at),ir=Nt==="out"?"bg-red-500":Nt==="low"?"bg-yellow-500":"bg-green-500",Dt=ae.capacityLimit||lc,rr=ae.capacityUsed,L=ae.remainingCapacity,Y=Dt>0?Math.min(L/Dt*100,100):0,C=dO(L,Dt),P=C==="out"?"bg-red-500":C==="low"?"bg-yellow-500":"bg-green-500",M=Math.min(tt,Je),E=ae.slotAssignments??[],F=Array.from({length:Math.max(Je,0)},(G,re)=>{const se=re+1,de=se<=M,Pe=E[se-1]??null;return{slotNumber:se,isUsed:de,assignment:Pe}}),W=rt&&!!ae.hasCapacityField,K=d===ae.id;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{onClick:()=>tn(ae.id),className:`hover:bg-indigo-500/20 ${K?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:ae.package}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:ae.informationUser||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-medium",children:tt})," ","/ ",Je," v tr"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:u.jsx("div",{className:`h-2 rounded-full ${ir}`,style:{width:`${gt}%`}})}),u.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",at]})]}),rt&&u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:W?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-medium",children:rr})," ","/ ",Dt," GB"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:u.jsx("div",{className:`h-2 rounded-full ${P}`,style:{width:`${Y}%`}})}),u.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",L," GB"]})]}):u.jsx("div",{className:"text-sm text-white/70 italic",children:"Khng c"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:ae.supplier||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[Number(ae.import||0).toLocaleString("vi-VN")," ","VND"]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:hO(ae.expired)}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:ae.note||""}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition",type:"button","aria-label":"Sa",onClick:G=>{G.stopPropagation(),Xe(ae)},children:u.jsx(cc,{className:"h-4 w-4"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-purple-50 text-purple-600 hover:bg-purple-100 transition",type:"button","aria-label":"Xem",onClick:G=>{G.stopPropagation(),Ht(ae)},children:u.jsx(nf,{className:"h-4 w-4"})})]})]}),K&&u.jsx("tr",{children:u.jsx("td",{colSpan:_t,className:"bg-indigo-900/30 px-6 py-4 text-white",children:u.jsxs("div",{className:"border border-dashed border-white/40 rounded-lg p-4 space-y-4 text-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi Tit Cc v tr"}),u.jsxs("p",{className:"text-xs text-white/80",children:["Hin th ",Je," v tr  ",tt," "," dng, ",at," cn trng"]})]}),u.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:F.map(G=>u.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border px-3 py-2 basis-1/2 sm:basis-1/3 lg:basis-1/5 min-w-[120px] ${G.isUsed?"border-yellow-300 bg-yellow-50":"border-green-200 bg-green-50"}`,title:G.assignment?.matchValue||G.assignment?.slotLabel||void 0,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Q6,{className:`h-5 w-5 ${G.isUsed?"text-yellow-500":"text-green-500"}`}),u.jsx("span",{className:"text-sm font-semibold text-gray-900 max-w-[170px] truncate",title:G.assignment?.slotLabel||(G.assignment?void 0:`v tr ${G.slotNumber}`),children:G.assignment?.slotLabel?G.assignment.slotLabel:`v tr ${G.slotNumber}`})]}),u.jsx("p",{className:`text-xs mt-1 ${G.isUsed?"text-yellow-700":"text-green-700"}`,children:G.assignment&&W?dZ(G.assignment.capacityUnits):G.isUsed?" dng":"Cn trng"})]},G.slotNumber))})]})})})]},`${ae.id}-${Le}`)})})]})})})]}),u.jsx(wZ,{open:j,initialName:R,initialFields:V,mode:ue,onClose:()=>z(!1),onSubmit:$t}),He&&u.jsx(Wk,{mode:"add",open:pe,template:He,onClose:()=>Ie(!1),onSubmit:Qt}),xe&&ge&&u.jsx(Wk,{mode:"edit",open:xe,template:ge.template,initialValues:ge.initialValues,onClose:St,onSubmit:zr}),u.jsx(bZ,{open:ie,row:De,onClose:Rt})]})}function xb({open:e,title:t,onClose:r,children:n,footer:a}){return e?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[u.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),u.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"ng",children:u.jsx(Tn,{className:"h-5 w-5"})})]}),u.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),u.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:a})]})}):null}function wZ({open:e,initialName:t,initialFields:r,onClose:n,onSubmit:a,mode:i}){const[s,c]=v.useState(t),[f,h]=v.useState(new Set(r)),[d,m]=v.useState(null);v.useEffect(()=>{e&&(c(t),h(new Set(r)),m(null))},[e,r,t]);const x=w=>{h(S=>{const A=new Set(S);return A.has(w)?A.delete(w):A.add(w),A})},g=()=>h(new Set(Ch.map(w=>w.value))),b=()=>h(new Set),_=w=>{w.preventDefault();const S=s.trim();if(!S){m("Vui lng nhp tn loi gi.");return}if(f.size===0){m("Vui lng chn t nht mt trng d liu.");return}a(S,Array.from(f))};return u.jsx(xb,{open:e,title:i==="edit"&&t?`Chnh sa loi gi: ${t}`:"To loi gi sn phm mi",onClose:n,footer:u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy b"}),u.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:i==="create"?"To Loi":"Lu Thay i"})]}),children:u.jsxs("form",{onSubmit:_,className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn Loi Gi"}),u.jsx("input",{type:"text",value:s,onChange:w=>c(w.target.value),placeholder:"V d: Google One, Netflix, Spotify...",className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${i==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:i==="edit"}),i==="edit"&&u.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bn ch c th chnh sa cc trng d liu, tn loi gi gi nguyn."})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Cc trng d liu ca loi gi ny"}),u.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[u.jsx("button",{type:"button",onClick:g,className:"text-blue-600 hover:text-blue-700",children:"Chn tt c"}),u.jsx("button",{type:"button",onClick:b,className:"text-rose-600 hover:text-rose-700",children:"B chn tt c"})]})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Ch.map(w=>u.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${f.has(w.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[u.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:f.has(w.value),onChange:()=>x(w.value)}),u.jsx("span",{className:"text-sm font-medium text-gray-800",children:w.label})]},w.value))})]}),d&&u.jsx("p",{className:"text-sm text-red-600",children:d})]})})}function bZ({open:e,row:t,onClose:r}){if(!e||!t)return null;const n=[{label:"Ti khon",value:t.informationUser},{label:"Mt khu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi ch",value:t.note},{label:"Ngun",value:t.supplier},{label:"Gi nhp",value:t.import},{label:"Ngy ht hn",value:hO(t.expired)}],a=[{label:"Ti khon",value:t.accountUser},{label:"Mt khu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi ch",value:t.accountNote}],i=!!t.hasCapacityField,s=t.capacityLimit||lc,c=t.capacityUsed||0,f=t.remainingCapacity||0,h=s>0?Math.min(f/s*100,100):0,d=dO(f,s),m=d==="out"?"bg-red-500":d==="low"?"bg-yellow-500":"bg-green-500";return u.jsx(xb,{open:e,title:`Chi Tit Gi: ${t.package}`,onClose:r,footer:u.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"ng"}),children:u.jsxs("div",{className:`grid grid-cols-1 gap-4 ${i?"md:grid-cols-2":""}`,children:[u.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thng tin gi"}),u.jsx("p",{className:"text-xs text-white/80",children:"Cc trng d liu c lu cho gi ny."})]}),u.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(x=>u.jsxs("div",{children:[u.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),u.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))})]}),i&&u.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),u.jsx("p",{className:"text-xs text-white/80",children:"Tng quan v ti khon dung lng."})]}),u.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:a.map(x=>u.jsxs("div",{children:[u.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),u.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"text-sm text-white",children:[u.jsx("span",{className:"font-semibold",children:c})," /"," ",s," GB"]}),u.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:u.jsx("div",{className:`h-2 rounded-full ${m}`,style:{width:`${h}%`}})}),u.jsxs("div",{className:"text-xs text-white/80",children:["Cn trng: ",f," GB"]})]})]})]})})}function Wk({open:e,mode:t,template:r,initialValues:n,onClose:a,onSubmit:i}){const s=v.useMemo(()=>({...iZ,...n??{}}),[n]),[c,f]=v.useState(s);v.useEffect(()=>{e&&f(s)},[e,s]);const h=(S,A)=>{const T=A.target.value;f(D=>({...D,[S]:T}))},d=S=>{S.preventDefault(),i(c)},m=S=>{f(A=>({...A,slotLinkMode:S}))},g=["information","note","supplier","import","expired"].some(S=>r.fields.includes(S)),b=r.fields.includes("capacity"),_=g||b,w=g&&b;return u.jsx(xb,{open:e,title:`${t==="add"?"Thm Gi":"Sa Gi"} - ${r.name}`,onClose:a,footer:u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy"}),u.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:t==="add"?"Lu gi":"Lu thay i"})]}),children:u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[_&&u.jsxs("div",{className:`grid grid-cols-1 gap-4 ${w?"md:grid-cols-2":""}`,children:[g&&u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tit gi"}),u.jsx("p",{className:"text-xs text-white/80",children:"Nhp cc trng m t lin quan n gi ny."})]}),r.fields.includes("information")&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),u.jsx("input",{type:"text",value:c.informationUser,onChange:S=>h("informationUser",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),u.jsx("input",{type:"text",value:c.informationPass,onChange:S=>h("informationPass",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),u.jsx("input",{type:"email",value:c.informationMail,onChange:S=>h("informationMail",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),u.jsx("input",{type:"text",value:c.note,onChange:S=>h("note",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi ch cho gi ny"})]}),r.fields.includes("supplier")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nh cung cp"}),u.jsx("input",{type:"text",value:c.supplier,onChange:S=>h("supplier",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi nhp (VND)"}),u.jsx("input",{type:"number",min:0,value:c.import,onChange:S=>h("import",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy ht hn"}),u.jsx("input",{type:"date",value:c.expired,onChange:S=>h("expired",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),b&&u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),u.jsx("p",{className:"text-xs text-white/80",children:"Cung cp thng tin ti khon dung lng."})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),u.jsx("input",{type:"text",value:c.accountUser,onChange:S=>h("accountUser",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),u.jsx("input",{type:"text",value:c.accountPass,onChange:S=>h("accountPass",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),u.jsx("input",{type:"email",value:c.accountMail,onChange:S=>h("accountMail",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),u.jsx("textarea",{value:c.accountNote,onChange:S=>h("accountNote",S),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi ch cho ti khon dung lng"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lng (GB)"}),u.jsx("input",{type:"number",min:0,value:c.capacity,onChange:S=>h("capacity",S),placeholder:`Mc nh: ${lc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S v tr (slot)"}),u.jsx("input",{type:"number",min:0,value:c.slot,onChange:S=>h("slot",S),placeholder:`Mc nh: ${oc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"flex items-center justify-between mb-2",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"C ch khp lnh"}),u.jsx("p",{className:"text-xs text-white/80",children:"Chn cch cc v tr c tnh t n hng."})]})}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:mZ.map(S=>{const A=c.slotLinkMode===S.value;return u.jsxs("button",{type:"button",onClick:()=>m(S.value),className:`border rounded-lg p-3 text-left transition ${A?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[u.jsx("span",{className:"block text-sm font-semibold",children:S.label}),u.jsx("span",{className:"block text-xs text-white/70 mt-1",children:S.helper})]},S.value)})}),u.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[u.jsx("b",{children:"Lin kt theo thng tin n hng:"})," So khp thng tin ca gi ny (ti khon, mail, v.v.) vi cc chi tit trong n hng ca khch.",u.jsx("br",{}),u.jsx("b",{children:"Lin kt theo v tr:"})," So khp thng tin ca gi ny vi mt m v tr (slot) c th c ch nh trong n hng.",u.jsx("br",{})]})]}),r.fields.length===0&&u.jsx("p",{className:"text-sm text-white/80",children:"Loi gi ny khng c trng d liu no c cu hnh."})]})})}const Y1=(e,t,r)=>Math.min(Math.max(e,t),r),_Z=(e,t)=>{const r=[];if(e<=5){for(let i=1;i<=e;i++)r.push(i);return r}const n=Y1(t-1,2,e-3),a=Y1(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let i=n;i<=a;i++)r.push(i);return a<e-1&&r.push("..."),r.push(e),r};function SZ({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:a=""}){const i=r>0?r:10,s=Math.max(1,Math.ceil(t/i)),c=Y1(e,1,s),f=c>1,h=c<s,d=t===0?0:(c-1)*i+1,m=Math.min(c*i,t),x=_Z(s,c);return u.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${a}`,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(1),disabled:!f,children:"<<"}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(c-1),disabled:!f,children:"<"}),u.jsx("div",{className:"flex items-center gap-1",children:x.map((g,b)=>g==="..."?u.jsx("span",{className:"px-2 text-white/50",children:"..."},`ellipsis-${b}`):u.jsx("button",{className:`px-3 py-1 rounded font-semibold transition ${g===c?"bg-blue-600 text-white":"bg-white/5 text-white/80 hover:bg-white/10"}`,onClick:()=>n(g),disabled:g===c,children:g},g))}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(c+1),disabled:!h,children:">"}),u.jsx("button",{className:"px-2 py-1 rounded bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40",onClick:()=>n(s),disabled:!h,children:">>"})]}),u.jsx("div",{className:"text-white/70",children:t===0?"0 mc":`${d}-${m} trong ${t}`})]})}const NZ=async e=>{const t=await Xt("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(fo(n,{fallback:"Khong the luu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phan hoi khong hop le tu server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},EZ=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Xt(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const c=await n.text().catch(()=>"");throw new Error(fo(c,{fallback:"Khong the tai thong tin san pham."}))}const a=await n.json().catch(()=>null);if(!a||!Array.isArray(a.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const i=typeof a.count=="number"&&Number.isFinite(a.count)?a.count:a.items.length,s=typeof a.total=="number"&&Number.isFinite(a.total)?a.total:i;return{...a,count:i,total:s,offset:typeof a.offset=="number"&&Number.isFinite(a.offset)?a.offset:e.offset??0,limit:typeof a.limit=="number"&&Number.isFinite(a.limit)?a.limit:e.limit??a.items.length}},m0=10,TZ=e=>{const t=e.trim();return t?t.slice(0,2).toUpperCase():"--"},ba=e=>e?e.replace(/--\d+m$/i,"").trim():"",va=e=>(e||"").replace(/\n/g,"<br/>"),Qs=e=>ba(e).toLowerCase(),hv=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Gu=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),a=s=>{if(s.nodeType===Node.TEXT_NODE)return hv(s.textContent||"");if(s.nodeType===Node.ELEMENT_NODE){const c=s;if(c.tagName==="BR")return"<br/>";if(c.tagName==="A"){const h=c.getAttribute("href")||"#",d=hv(h),m=Array.from(c.childNodes).map(a).join("");return`<a href="${d}" title="${d}" target="_blank" rel="noopener noreferrer">${m}</a>`}const f=Array.from(c.childNodes).map(a).join("");return n.has(c.tagName)?`${f}<br/>`:f}return""};return Array.from(r.body.childNodes).map(a).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return hv(e)}},kZ=e=>e?Gu(e):"",pv=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=/(thng tin\s*&\s*tnh nng|thng tin sn phm|m t|ni dung|tnh nng)/i,i=n.match(a),s=c=>c.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(i&&(i.index??0)>=3){const c=i.index??0,f=r.slice(0,c).trim(),h=r.slice(c).trim();return{rulesHtml:s(f),descriptionHtml:s(h)}}return{rulesHtml:e||"",descriptionHtml:t||""}};function CZ(e,t,r){const n=(r||"").toLowerCase().trim(),a=new Map;t.forEach(c=>{const f=Qs(c.san_pham||""),h=Qs(c.package_product||"");[f,h].filter(Boolean).forEach(m=>{a.has(m)||a.set(m,c)})});const i=new Map;for(const c of e){const f=Qs(c.productId||""),h=f?a.get(f):null,d={...c,productId:ba(c.productId||""),productName:c.productName||(h?ba(h.package_product||h.san_pham||""):null)||c.productId,packageProduct:h?ba(h.package_product||h.san_pham||""):null,packageName:h?ba(h.package||h.san_pham||""):null,rulesHtml:c.rulesHtml||va(c.rules||""),descriptionHtml:c.descriptionHtml||va(c.description||"")},m=f||Qs(d.productName||"");m&&(i.has(m)||i.set(m,d))}for(const c of t){const f=Qs(c.san_pham||""),h=Qs(c.package_product||""),d=f||h,m=f&&i.has(f)||h&&i.has(h);!d||m||i.set(d,{id:c.id,productId:ba(c.san_pham||""),productName:ba(c.package_product||c.san_pham||""),packageProduct:ba(c.package_product||c.san_pham||""),packageName:ba(c.package||""),rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:null})}let s=Array.from(i.values());return n&&(s=s.filter(c=>`${c.productId||""} ${c.productName||""} ${c.description||""} ${c.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),s}function AZ(){const[e,t]=v.useState(null),[r,n]=v.useState(1),[a,i]=v.useState([]),[s,c]=v.useState([]),[f,h]=v.useState(""),[d,m]=v.useState(!1),[x,g]=v.useState(null),[b,_]=v.useState(null),[w,S]=v.useState({productId:"",productName:"",rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:""}),[A,T]=v.useState(!1),[D,O]=v.useState(null),I=v.useRef(null),j=v.useRef(null),[z,R]=v.useState(!1),[q,V]=v.useState("https://"),[J,ue]=v.useState(null),Ne=v.useRef(null),pe=v.useRef(!1),[Ie,xe]=v.useState(null),[ye,ge]=v.useState("#38bdf8"),Oe=v.useRef(null),ie=v.useRef(null),he=v.useRef(null),De=v.useMemo(()=>CZ(a,s,f),[a,s,f]),We=v.useMemo(()=>Math.max(1,Math.ceil(De.length/m0)),[De.length]),Ve=v.useMemo(()=>{const fe=(r-1)*m0,ce=fe+m0;return De.slice(fe,ce)},[De,r]),Ge=v.useCallback(async()=>{m(!0),g(null);try{const[fe,ce]=await Promise.all([EZ({}),Xt("/api/products")]),rt=await ce.json().catch(()=>[]);i(Array.isArray(fe.items)?fe.items:[]),c(Array.isArray(rt)?rt:[])}catch(fe){i([]),c([]),g(fo(fe instanceof Error?fe.message:String(fe??""),{fallback:"Khng th ti danh sch sn phm."}))}finally{m(!1)}},[]);v.useEffect(()=>{Ge()},[Ge]),v.useEffect(()=>{r>We&&n(We)},[r,We]);const Te=fe=>{h(fe),n(1)},U=fe=>{_(fe),S({productId:ba(fe.productId||""),productName:ba(fe.packageProduct||fe.productName||"")||"",rules:fe.rules||"",rulesHtml:fe.rulesHtml||va(fe.rules||""),description:fe.description||"",descriptionHtml:fe.descriptionHtml||va(fe.description||""),imageUrl:fe.imageUrl||""})},H=()=>{_(null),S({productId:"",productName:"",rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:""}),T(!1),O(null),R(!1),V("https://"),ue(null),Ne.current=null},X=(fe,ce)=>{S(rt=>({...rt,[fe]:ce}))},Z=async()=>{if(!b)return;T(!0);const fe={productId:w.productId.trim()||b.productId||"",rules:w.rulesHtml||w.rules,description:w.descriptionHtml||w.description,imageUrl:w.imageUrl||null};try{const ce=await NZ(fe),rt={...b,id:ce.id||b.id,productId:ce.productId,rules:ce.rules||"",rulesHtml:ce.rulesHtml||ce.rules||w.rulesHtml||w.rules||"",description:ce.description||"",descriptionHtml:ce.descriptionHtml||ce.description||w.descriptionHtml||w.description||"",imageUrl:ce.imageUrl||null};i(_t=>{const yt=Qs(ce.productId||b.productId||""),Bt=_t.findIndex(dt=>Qs(dt.productId||"")===yt);if(Bt===-1)return[..._t,{id:ce.id||b.id,productId:ce.productId,productName:b.productName||null,rules:ce.rules||"",rulesHtml:ce.rulesHtml||ce.rules||w.rulesHtml||w.rules||"",description:ce.description||"",descriptionHtml:ce.descriptionHtml||ce.description||w.descriptionHtml||w.description||"",imageUrl:ce.imageUrl||null}];const Tt=[..._t];return Tt[Bt]={...Tt[Bt],id:ce.id||Tt[Bt].id,productId:ce.productId,rules:ce.rules||"",rulesHtml:ce.rulesHtml||ce.rules||w.rulesHtml||w.rules||"",description:ce.description||"",descriptionHtml:ce.descriptionHtml||ce.description||w.descriptionHtml||w.description||"",imageUrl:ce.imageUrl||null},Tt}),_(rt),H()}catch(ce){g(fo(ce instanceof Error?ce.message:String(ce??""),{fallback:"Khng th lu thng tin sn phm."}))}finally{T(!1)}},ee=(fe,ce)=>{if(!ce)return;const rt=document.getSelection(),_t=rt&&rt.rangeCount>0?rt.getRangeAt(0).cloneRange():null,yt=kZ(ce.innerHTML),Bt=ce.innerText;pe.current=!0,S(dt=>({...dt,[fe]:Bt,[`${fe}Html`]:yt}));const Tt=document.activeElement===ce;_t&&Tt&&(rt?.removeAllRanges(),rt?.addRange(_t))},Fe=()=>D==="rules"?I.current:j.current;v.useEffect(()=>{const fe=I.current;if(fe){if(pe.current){pe.current=!1;return}fe.innerHTML=w.rulesHtml||va(w.rules)}},[w.rules,w.rulesHtml,b]),v.useEffect(()=>{const fe=j.current;if(fe){if(pe.current){pe.current=!1;return}fe.innerHTML=w.descriptionHtml||va(w.description)}},[w.description,w.descriptionHtml,b]),v.useEffect(()=>{if(!Ie)return;const fe=he.current;fe&&requestAnimationFrame(()=>{typeof fe.showPicker=="function"?fe.showPicker():fe.click()})},[Ie]);const _e=()=>{const fe=Fe();if(!fe){Ne.current=null;return}const ce=document.getSelection();ce&&ce.rangeCount>0&&fe.contains(ce.focusNode)?Ne.current=ce.getRangeAt(0).cloneRange():Ne.current=null},Me=(fe,ce,rt=!1)=>{const _t=Fe();if(_t){if(rt&&Ne.current){const yt=document.getSelection();yt&&(yt.removeAllRanges(),yt.addRange(Ne.current))}else _e();_t.focus(),document.execCommand(fe,!1,ce),ee(D||"rules",_t)}},Re=()=>{Fe()&&(_e(),V("https://"),ue(null),R(!0))},ne=()=>{R(!1),ue(null),V("https://")},Ae=()=>{const fe=Fe();if(!fe){ue("Vui lng chn ni dung trc khi chn link.");return}const ce=q.trim();if(!/^https?:\/\//i.test(ce)){ue("URL phi bt u bng http:// hoc https://");return}fe.focus();const rt=document.getSelection();rt&&Ne.current&&(rt.removeAllRanges(),rt.addRange(Ne.current)),document.execCommand("createLink",!1,ce),ee(D||"rules",fe),ne()},me=(fe,ce)=>{O(ce),_e(),xe(fe),ge(fe==="hiliteColor"?"#fef08a":"#38bdf8")},je=fe=>{const ce=Ie;ce&&(ge(fe),xe(null),Me(ce,fe,!0))},He=fe=>{if(!fe){xe(null);return}ge(fe),je(fe)},et=fe=>u.jsx("div",{className:"rich-toolbar-wrapper",children:u.jsxs("div",{className:"rich-toolbar mb-2",ref:fe==="rules"?Oe:ie,children:[u.jsx("button",{type:"button",onClick:()=>Me("bold"),children:"B"}),u.jsx("button",{type:"button",onClick:()=>Me("italic"),children:"I"}),u.jsx("button",{type:"button",onClick:()=>Me("underline"),children:"U"}),u.jsx("button",{type:"button",onClick:Re,children:u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[u.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),u.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.71"})]})}),u.jsx("button",{type:"button","data-color-button":"true",onClick:()=>me("foreColor",fe),children:"A"}),u.jsx("button",{type:"button","data-color-button":"true",onClick:()=>me("hiliteColor",fe),children:"Bg"}),u.jsx("button",{type:"button",className:"rich-toolbar-heading",onClick:()=>{const ce=window.prompt("Chon heading (1-6):","2"),rt=Number(ce);Number.isInteger(rt)&&rt>=1&&rt<=6&&Me("formatBlock",`h${rt}`)},children:"H"}),u.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:ce=>{const rt=ce.target.value;ce.target.value="",rt&&Me("fontName",rt)},children:[u.jsx("option",{value:"",children:"Font"}),u.jsx("option",{value:"Arial",children:"Arial"}),u.jsx("option",{value:"Georgia",children:"Georgia"}),u.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),u.jsx("option",{value:"Verdana",children:"Verdana"}),u.jsx("option",{value:"Tahoma",children:"Tahoma"}),u.jsx("option",{value:"Roboto",children:"Roboto"}),u.jsx("option",{value:"Inter",children:"Inter"}),u.jsx("option",{value:"Poppins",children:"Poppins"}),u.jsx("option",{value:"Montserrat",children:"Montserrat"}),u.jsx("option",{value:"Open Sans",children:"Open Sans"}),u.jsx("option",{value:"Nunito",children:"Nunito"}),u.jsx("option",{value:"Raleway",children:"Raleway"}),u.jsx("option",{value:"Merriweather",children:"Merriweather"}),u.jsx("option",{value:"Playfair Display",children:"Playfair Display"}),u.jsx("option",{value:"Courier New",children:"Courier New"}),u.jsx("option",{value:"Fira Code",children:"Fira Code"}),u.jsx("option",{value:"Source Sans Pro",children:"Source Sans Pro"})]}),u.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:ce=>{const rt=ce.target.value;ce.target.value="",rt&&Me("fontSize",rt)},children:[u.jsx("option",{value:"",children:"Size"}),u.jsx("option",{value:"2",children:"12px"}),u.jsx("option",{value:"3",children:"16px"}),u.jsx("option",{value:"4",children:"18px"}),u.jsx("option",{value:"5",children:"24px"}),u.jsx("option",{value:"6",children:"32px"}),u.jsx("option",{value:"7",children:"48px"})]})]})}),Ue=(fe,ce="small")=>{const rt=fe.productName||fe.productId||"--",_t=TZ(rt),yt="rounded-md bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold",Bt=ce==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs";return fe.imageUrl?u.jsx("img",{src:fe.imageUrl,alt:rt,className:`${Bt} rounded-md object-cover`,onError:Tt=>{Tt.currentTarget.style.display="none"}}):u.jsx("div",{className:`${Bt} ${yt}`,children:u.jsx("span",{children:_t})})};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thng Tin Sn Phm"}),u.jsx("p",{className:"text-sm text-white/70",children:"ng b vi bng product_desc trong database."})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[u.jsxs("div",{className:"relative flex-1 min-w-[220px] max-w-xl",children:[u.jsx("input",{type:"text",placeholder:"Tm kim theo tn hoc m sn phm...",className:"w-full bg-[#0f1729] border border-white/10 text-white placeholder:text-white/50 rounded-lg pl-10 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:f,onChange:fe=>Te(fe.target.value)}),u.jsx(gl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"})]}),u.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold rounded-lg shadow",children:"Thm Sn Phm Mi"})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-[#0b1220] shadow-xl overflow-hidden",children:[u.jsxs("div",{className:"border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sn Phm"}),d&&u.jsx("span",{className:"text-xs text-white/60",children:"ang ti..."})]}),x&&u.jsx("div",{className:"border-b border-white/10 px-4 py-2 text-sm text-rose-300",children:x}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[u.jsxs("colgroup",{children:[u.jsx("col",{style:{width:"8%"}}),u.jsx("col",{style:{width:"14%"}}),u.jsx("col",{style:{width:"17%"}}),u.jsx("col",{style:{width:"25%",minWidth:"240px"}}),u.jsx("col",{style:{width:"25%",minWidth:"240px"}}),u.jsx("col",{style:{width:"11%",minWidth:"120px"}})]}),u.jsx("thead",{className:"bg-white/5 text-white",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"nh"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"M Sn Phm"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Tn Sn Phm"}),u.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy Tc"}),u.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"M T"}),u.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao Tc"})]})}),u.jsxs("tbody",{className:"divide-y divide-white/5",children:[Ve.map(fe=>{const ce=fe.packageProduct||fe.productName||fe.productId||"--",rt=e===fe.id,_t=fe.rulesHtml||va(fe.rules||""),yt=fe.descriptionHtml||va(fe.description||""),{rulesHtml:Bt,descriptionHtml:Tt}=pv(_t,yt),dt=Gu(Bt)||"Cha cp nht",$t=Gu(Tt||va(fe.description||""))||"Cha cp nht";return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{className:`hover:bg-white/5 cursor-pointer ${rt?"bg-white/5":""}`,onClick:()=>t(rt?null:Number(fe.id)),children:[u.jsx("td",{className:"px-4 py-3",children:Ue(fe)}),u.jsx("td",{className:"px-4 py-3 text-white",children:u.jsx("div",{className:"flex flex-col",children:u.jsx("span",{className:"font-semibold text-white",children:ba(fe.productId||"")||"--"})})}),u.jsx("td",{className:"px-4 py-3 text-white",children:ba(ce)||"--"}),u.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:u.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:fe.rulesHtml?void 0:fe.rules||"",dangerouslySetInnerHTML:{__html:dt}})}),u.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:u.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:fe.descriptionHtml?void 0:fe.description||"",dangerouslySetInnerHTML:{__html:$t}})}),u.jsxs("td",{className:"px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",children:u.jsx(nf,{className:"h-5 w-5 text-blue-400"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Sa",onClick:Qt=>{Qt.stopPropagation(),U(fe)},children:u.jsx(U0,{className:"h-5 w-5 text-green-400"})}),u.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xa",children:u.jsx(rl,{className:"h-5 w-5 text-red-400"})})]})]}),rt&&u.jsx("tr",{className:"bg-white/5",children:u.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Thng tin chi tit"}),u.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:ba(fe.packageProduct||fe.productName||fe.productId||"")||"Cha c m t chi tit."})]}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[u.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:Ue(fe,"large")}),u.jsxs("div",{className:"flex-1 space-y-3",children:[u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy tc bo hnh"}),u.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Gu(pv(fe.rulesHtml||va(fe.rules||""),fe.descriptionHtml||va(fe.description||"")).rulesHtml)||"Cha c quy tc."}})]}),u.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Thng tin sn phm"}),u.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Gu(pv(fe.rulesHtml||va(fe.rules||""),fe.descriptionHtml||va(fe.description||"")).descriptionHtml||va(fe.description||""))||"Cha c ni dung."}})]})]})]})]})})]},`${fe.id}-${fe.productId}`)}),!d&&Ve.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/70",children:"Khng c d liu product_desc."})}),d&&Ve.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/80",children:"ang ti danh sch..."})})]})]})}),u.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:u.jsx(SZ,{currentPage:r,totalItems:De.length,pageSize:m0,onPageChange:n})})]}),b&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:u.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl custom-scroll",children:[u.jsx("input",{ref:he,type:"color",className:"rich-color-native",value:ye,onChange:fe=>He(fe.target.value),onBlur:()=>{xe(null)}}),u.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chnh sa thng tin sn phm"}),u.jsx("button",{className:"text-white/70 hover:text-white",onClick:H,disabled:A,children:""})]}),u.jsxs("div",{className:"space-y-4 px-5 py-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"M sn phm"}),u.jsx("input",{type:"text",value:w.productId,onChange:fe=>X("productId",fe.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Tn sn phm / Package product"}),u.jsx("input",{type:"text",value:w.productName,onChange:fe=>X("productName",fe.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Quy tc"}),et("rules"),u.jsx("div",{ref:I,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>O("rules"),onInput:fe=>ee("rules",fe.currentTarget),onBlur:fe=>ee("rules",fe.currentTarget)},(b?.id??"rules")+"-editor")]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"M t"}),et("description"),u.jsx("div",{ref:j,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>O("description"),onInput:fe=>ee("description",fe.currentTarget),onBlur:fe=>ee("description",fe.currentTarget)},(b?.id??"description")+"-editor")]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Image URL"}),u.jsx("input",{type:"text",value:w.imageUrl,onChange:fe=>X("imageUrl",fe.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."})]})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-3",children:[u.jsx("button",{className:"px-4 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:H,disabled:A,children:"Hy"}),u.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:Z,disabled:A,children:A?"ang lu...":"Lu thay i"})]})]})}),b&&z&&u.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 px-4",children:u.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-[#0b1220] border border-white/10 p-5 shadow-2xl space-y-4",children:[u.jsx("h4",{className:"text-white font-semibold",children:"Chn lin kt"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70",children:"URL"}),u.jsx("input",{type:"text",value:q,onChange:fe=>{V(fe.target.value),ue(null)},className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."}),J&&u.jsx("div",{className:"text-xs text-rose-300",children:J})]}),u.jsxs("div",{className:"flex items-center justify-end gap-3",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:ne,type:"button",children:"Hy"}),u.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:Ae,type:"button",children:"Chn link"})]})]})})]})}const jZ=async e=>{const t=await Xt(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(fo(n,{fallback:"Khng th xa sn phm khi bng gi.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},PZ={};var OZ={};const mi=typeof import.meta<"u"&&PZ?.VITE_API_BASE_URL||OZ.VITE_API_BASE_URL||"http://localhost:3001",X1=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),Ah=0,gO=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},q1=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),DZ=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",IZ=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Thng`},RZ=(e,t)=>{const r=IZ(t);return e&&r?`${e} ${r}`:e||r||DZ(t)||"Khng Xc nh"},ts=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},FZ=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},vO=(e,t)=>{if(typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t))return null;const r=e-t;return!Number.isFinite(r)||r<=0?null:r},R0=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e)||e<Ah||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0)return!1;const n=t-1;return!Number.isFinite(n)||n<Ah||e>n?!1:vO(t,e)!==null},x0=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(n!==a)return n-a;const i=Date.parse(t.lastOrderDate??"")||0,s=Date.parse(r.lastOrderDate??"")||0;return i!==s?s-i:t.sourceName.localeCompare(r.sourceName)}),MZ=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",LZ=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${MZ(r.sourceName)}`,a=t.get(n);if(!a){t.set(n,r);continue}const i=a.price??Number.POSITIVE_INFINITY,s=r.price??Number.POSITIVE_INFINITY,c=Date.parse(a.lastOrderDate??"")||0,f=Date.parse(r.lastOrderDate??"")||0;(s<i||s===i&&f>c)&&t.set(n,r)}return Array.from(t.values())},ec=(e,t)=>`${e}-${t}`,mv=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=yO(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,a=dc(n??t,e.pctKhach),i=wO(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.retailPrice,promoPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.promoPrice}},xv=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},gv=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},Vk=e=>{if(e==null)return"";const t=String(e).replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?new Intl.NumberFormat("vi-VN").format(r):""},Kk=({multiplier:e,price:t,basePrice:r})=>"",ga=e=>{const t=gO(e);return t===null||t<=0?"-":X1.format(t)},vv=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},BZ=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},Uu=e=>(e||"").trim(),Gk=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=gO(e)??0;return t===0?X1.format(0):X1.format(t)},$Z=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,a=typeof r=="number"&&Number.isFinite(r)?r-e:null,i=Gk(n),s=Gk(a);return`${i} - ${s}`},jh=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},UZ=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(a<n)return r;if(a>n)return t;const i=jh(t.lastOrderDate);return jh(r.lastOrderDate)>i?r:t},null):null,$o=(e,t)=>{const r=e.reduce((n,a)=>{const i=typeof a.price=="number"&&Number.isFinite(a.price)?a.price:Number.NEGATIVE_INFINITY;return i>n?i:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},dc=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,yO=(e,t)=>dc(t,e),wO=(e,t,r,n,a)=>{const i=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof a=="number"&&Number.isFinite(a)&&a>0&&a||null;if(i===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!R0(t,e,r))return null;const s=vO(e,t);return s===null?null:dc(i,s)},Yk=(e,t)=>{const r=q1(e?.[mn.package]??e?.package_label),n=q1(e?.[mn.packageProduct]??e?.package_product_label),a=(e?.[mn.product]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Khng xc nh",packageProduct:n,sanPhamRaw:a,variantLabel:RZ(n,a),pctCtv:ts(e?.[mn.pctCtv]),pctKhach:ts(e?.[mn.pctKhach]),pctPromo:ts(e?.[mn.pctPromo]),isActive:FZ(e?.[mn.isActive]),baseSupplyPrice:ts(e?.max_supply_price),wholesalePrice:ts(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:ts(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:ts(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[mn.updateDate]=="string"?e[mn.updateDate]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:null}};function zZ(){const[e,t]=v.useState(""),[r,n]=v.useState("all"),[a,i]=v.useState([]),[s,c]=v.useState(!1),[f,h]=v.useState(null),[d,m]=v.useState(null),[x,g]=v.useState({}),[b,_]=v.useState({}),[w,S]=v.useState({}),[A,T]=v.useState({}),[D,O]=v.useState({}),[I,j]=v.useState({}),[z,R]=v.useState(null),[q,V]=v.useState(null),[J,ue]=v.useState(null),[Ne,pe]=v.useState(!1),[Ie,xe]=v.useState(!1),[ye,ge]=v.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[Oe,ie]=v.useState([xv()]),[he,De]=v.useState(null),[We,Ve]=v.useState(!1),[Ge,Te]=v.useState([]),[U,H]=v.useState(!1),[X,Z]=v.useState([]),[ee,Fe]=v.useState(!1),[_e,Me]=v.useState({}),[Re,ne]=v.useState({}),[Ae,me]=v.useState(!1),[je,He]=v.useState({product:null,loading:!1,error:null}),et=v.useCallback(async()=>{c(!0),h(null);try{const E=await fetch(`${mi}${It.PRODUCT_PRICES}`,{credentials:"include"});if(E.status===401){window.location.href="/login";return}if(!E.ok)throw new Error("Khng th ti d liu sn phm.");const F=await E.json(),K=(Array.isArray(F)?F:Array.isArray(F?.items)?F.items:[]).map((re,se)=>Yk(re,se)),G=K.reduce((re,se)=>(se.lastUpdated&&(re[se.id]=se.lastUpdated),re),{});i(K),Me({}),ne(G)}catch(E){console.error("Li khi ti d liu:",E),i([]),h(E instanceof Error?E.message:"Khng th ti d liu product_price.")}finally{c(!1)}},[]),Ue=v.useCallback(async E=>{const F=Uu(E);if(F){g(W=>({...W,[F]:{items:W[F]?.items??[],loading:!0,error:null,productName:W[F]?.productName??E}}));try{const W=await fetch(`${mi}${It.SUPPLY_PRICES_BY_PRODUCT_NAME(E)}`,{credentials:"include"});if(!W.ok)throw new Error("Khng th ti gi nhp");const K=await W.json(),G=Array.isArray(K)?K.map((se,de)=>({sourceId:Number.isFinite(Number(se?.[Xo.sourceId]))?Number(se[Xo.sourceId]):de,sourceName:q1(se?.[La.sourceName])||`Nh Cung Cp #${Number(se?.[Xo.sourceId])||de+1}`,price:ts(se?.[Xo.price]),lastOrderDate:typeof se?.last_order_date=="string"?se.last_order_date:null})):[],re=x0(LZ(G));g(se=>({...se,[F]:{loading:!1,error:null,items:re,productName:E}}))}catch(W){g(K=>({...K,[F]:{loading:!1,items:K[F]?.items??[],error:W instanceof Error?W.message:"Khng th ti gi nhp ca NCC",productName:K[F]?.productName??E}}))}}},[]),fe=v.useCallback(async()=>{if(!(ee||X.length>0)){Fe(!0);try{const E=await fetch(`${mi}${It.BANK_LIST}`,{credentials:"include"});if(!E.ok)throw new Error("Khng th ti danh sch ngn hng.");const F=await E.json(),W=Array.isArray(F)?F.map(K=>({bin:K?.bin?.toString().trim()??"",name:K?.bank_name?.toString().trim()??K?.name??""})).filter(K=>K.bin&&K.name):[];Z(W)}catch(E){console.error("Li khi ti danh sch ngn hng:",E)}finally{Fe(!1)}}},[X.length,ee]),ce=v.useCallback(async()=>{if(!(U||Ge.length>0)){H(!0);try{const E=await fetch(`${mi}${It.SUPPLIES}`,{credentials:"include"});if(!E.ok)throw new Error("Khng th ti danh sch NCC.");const F=await E.json().catch(()=>null),K=(Array.isArray(F?.items)?F.items:Array.isArray(F)?F:[]).map(se=>{const de=se?.[La.id]??se?.id,Pe=typeof de=="number"&&Number.isFinite(de)?de:Number.isFinite(Number(de))?Number(de):null,we=se?.[La.sourceName]??se?.source_name??se?.name??"";return{id:Pe??null,name:(we||"").trim(),numberBank:se?.[La.numberBank]??se?.number_bank??se?.numberBank??"",binBank:se?.[La.binBank]??se?.bin_bank??se?.binBank??""}}).filter(se=>se.name.length>0),G=[],re=new Set;for(const se of K){const de=se.id!==null?`id:${se.id}`:`name:${se.name.toLowerCase().trim()}`;re.has(de)||(re.add(de),G.push(se))}Te(G)}catch(E){console.error("Li khi ti danh sch NCC:",E)}finally{H(!1)}}},[U,Ge.length]);v.useEffect(()=>{et()},[et]),v.useEffect(()=>{Ie&&X.length===0&&!ee&&fe(),Ie&&Ge.length===0&&!U&&ce()},[Ie,X.length,ee,fe,Ge.length,U,ce]);const rt=v.useCallback(async()=>{if(!Ae){me(!0);try{await et();const E=new Set;Object.values(x).forEach(F=>{F?.productName&&E.add(F.productName)}),await Promise.all(Array.from(E).map(F=>Ue(F)))}catch(E){console.error("Failed to refresh pricing data:",E)}finally{me(!1)}}},[et,Ue,x,Ae]),_t=v.useCallback(()=>{He({product:null,loading:!1,error:null})},[]),yt=v.useCallback((E,F)=>{E.stopPropagation(),He({product:F,loading:!1,error:null})},[]),Bt=v.useCallback(async()=>{const E=je.product;if(E){He(F=>({...F,loading:!0,error:null}));try{const F=await jZ(E.id);if(!F.success)throw new Error(F.message||"Khng th xa sn phm.");i(W=>W.filter(K=>K.id!==E.id)),g(W=>{const K={...W};return[E.sanPhamRaw,E.packageName,E.packageProduct].forEach(re=>{const se=Uu(re||"");se&&K[se]&&delete K[se]}),K}),_t()}catch(F){console.error("Failed to delete product price:",F),He(W=>({...W,loading:!1,error:F instanceof Error?F.message:"Khng th xa sn phm. Vui lng th li."}))}}},[mi,_t,je.product]),Tt=E=>{const F=d===E.id?null:E.id;if(m(F),F===E.id){const W=Uu(E.sanPhamRaw),K=x[W];(!K||!K.loading&&K.items.length===0)&&Ue(E.sanPhamRaw)}},dt=E=>({packageName:E.packageName||"",packageProduct:E.packageProduct||"",sanPham:E.sanPhamRaw||"",pctCtv:E.pctCtv!==null&&E.pctCtv!==void 0?String(E.pctCtv):"",pctKhach:E.pctKhach!==null&&E.pctKhach!==void 0?String(E.pctKhach):"",pctPromo:E.pctPromo!==null&&E.pctPromo!==void 0?String(E.pctPromo):""}),$t=(E,F)=>{if(E.stopPropagation(),pe(!1),z===F.id){R(null),V(null),ue(null);return}ue(null),R(F.id),V(dt(F))},Qt=E=>{_(F=>{const W={...F};return delete W[E],W}),S(F=>{const W={...F};return delete W[E],W}),O(F=>{const W={...F};return delete W[E],W})},Ut=(E,F,W)=>{const K=ec(E,F);_(G=>({...G,[K]:!0})),S(G=>({...G,[K]:W==null?"":Vk(W)})),O(G=>({...G,[K]:null}))},Dr=(E,F,W)=>{const K=ec(E,F),G=gv(W);S(re=>({...re,[K]:G})),O(re=>({...re,[K]:null}))},en=(E,F)=>{const W=ec(E,F);Qt(W),T(K=>{const G={...K};return delete G[W],G})},Ur=async(E,F,W,K)=>{const G=ec(E,F),se=w[G]?.toString().trim()??"";if(!se){O(Pe=>({...Pe,[G]:"Vui lng nhp gi hp l"}));return}const de=Number(se.replace(/\D+/g,""));if(!Number.isFinite(de)||de<0){O(Pe=>({...Pe,[G]:"Gi nhp khng c thp hn 0."}));return}T(Pe=>({...Pe,[G]:!0}));try{const Pe=await fetch(`${mi}${It.UPDATE_SUPPLY_PRICE(E,F)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:de}),credentials:"include"}),we=await Pe.json().catch(()=>null);if(!Pe.ok)throw new Error(we?.error||"Khng th cp nht gi nhp");const ke=Number.isFinite(Number(we?.price))?Number(we?.price):de;let $e=null,ht=!1;if(g(xt=>{const kt=xt[W];if(!kt)return xt;const kr=$o(kt.items,null),Cr=kt.items.find(Wi=>Wi.sourceId===F),jt=typeof Cr?.price=="number"?Cr.price:null,Ot=typeof jt=="number"&&typeof kr=="number"&&Math.abs(jt-kr)<1e-5,vr=x0(kt.items.map(Wi=>Wi.sourceId===F?{...Wi,price:ke}:Wi)),Ft=$o(vr,null),Nl=jt===null||jt!==ke;return typeof Ft=="number"&&Number.isFinite(Ft)&&Ft>0?($e=Ft,(Ft!==kr||Ot&&Nl)&&(ht=!0)):Ot&&Nl&&($e=Ft??null,ht=!0),{...xt,[W]:{...kt,items:vr}}}),ht&&i(xt=>xt.map(kt=>kt.id===E?mv(kt,$e):kt)),Qt(G),await Ue(K),ht)try{await et()}catch(xt){console.error("Failed to refresh product pricing:",xt)}}catch(Pe){O(we=>({...we,[G]:Pe instanceof Error?Pe.message:"Khng th cp nht gi nhp."}))}finally{T(Pe=>{const we={...Pe};return delete we[G],we})}},ca=E=>{j(F=>F[E]?F:{...F,[E]:{sourceName:"",price:"",error:null,isSaving:!1}})},Yn=(E,F,W)=>{const K=F==="price"?gv(W):W;j(G=>{const re=G[E];return re?{...G,[E]:{...re,[F]:K,error:null}}:G})},Xe=E=>{j(F=>{const W={...F};return delete W[E],W})},St=async E=>{const F=I[E.id];if(!F)return;const W=F.sourceName.trim(),K=Number((F.price||"").replace(/\D+/g,""));if(!W){j(G=>({...G,[E.id]:{...F,error:"Vui lng nhp tn ngun hp l."}}));return}if(!Number.isFinite(K)||K<=0){j(G=>({...G,[E.id]:{...F,error:"Gi nhp phi ln hn 0."}}));return}j(G=>({...G,[E.id]:{...F,isSaving:!0,error:null}}));try{const G=await fetch(`${mi}${It.CREATE_SUPPLY_PRICE(E.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:W,price:K}),credentials:"include"}),re=await G.json().catch(()=>null);if(!G.ok)throw new Error(re?.error||"Khng th thm ngun mi.");const se=Uu(E.sanPhamRaw),de=Number(re?.sourceId),Pe=Number.isFinite(Number(re?.price))?Number(re?.price):K;let we=null,ke=!1;if(g($e=>{const ht=$e[se],xt=ht?.items??[],kt=xt.some(vr=>typeof vr.sourceId=="number"&&vr.sourceId===de),kr=x0(kt?xt.map(vr=>vr.sourceId===de?{...vr,price:Pe}:vr):[...xt,{sourceId:Number.isFinite(de)&&de>0?de:Date.now(),sourceName:W,price:Pe,lastOrderDate:null}]),Cr=$o(xt,null),jt=$o(kr,null);return(typeof Cr=="number"&&typeof jt=="number"?Math.abs(jt-Cr)>1e-5:Cr!==jt)&&(ke=!0),we=jt,{...$e,[se]:{loading:ht?.loading??!1,error:null,items:kr}}}),ke&&i($e=>$e.map(ht=>ht.id===E.id?mv(ht,we):ht)),await Ue(E.sanPhamRaw),Xe(E.id),ke)try{await et()}catch($e){console.error("Failed to refresh product pricing:",$e)}}catch(G){j(re=>({...re,[E.id]:{...F,isSaving:!1,error:G instanceof Error?G.message:"Khng th thm ngun mi."}}))}},Ht=async(E,F,W,K)=>{const G=ec(E,F);O(de=>({...de,[G]:null})),T(de=>({...de,[G]:!0}));let re=null,se=!1;try{const de=await fetch(`${mi}${It.DELETE_SUPPLY_PRICE(E,F)}`,{method:"DELETE",credentials:"include"}),Pe=await de.json().catch(()=>null);if(!de.ok)throw new Error(Pe?.error||"Khng th xa ngun ny.");if(g(we=>{const ke=we[W];if(!ke)return we;const $e=x0(ke.items.filter(kr=>kr.sourceId!==F)),ht=$o(ke.items,null),xt=$o($e,null);return(typeof ht=="number"&&typeof xt=="number"?Math.abs(xt-ht)>1e-5:ht!==xt)&&(se=!0),re=xt,{...we,[W]:{...ke,items:$e}}}),Qt(G),se&&i(we=>we.map(ke=>ke.id===E?mv(ke,re):ke)),await Ue(K),se)try{await et()}catch(we){console.error("Failed to refresh product pricing:",we)}}catch(de){O(Pe=>({...Pe,[G]:de instanceof Error?de.message:"Khng th xa ngun ny."}))}finally{T(de=>{const Pe={...de};return delete Pe[G],Pe})}},Rt=(E,F)=>{V(W=>W&&{...W,[E]:F})},tn=()=>{ge({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),ie([xv()]),De(null),Ve(!1)},zr=()=>{R(null),V(null),ue(null),pe(!1)},ae=E=>{if(E==null)return null;const F=E.toString().replace(",",".").trim();return F?ts(F):null},Le=()=>{tn(),xe(!0),X.length===0&&!ee&&fe(),Ge.length===0&&!U&&ce()},Je=()=>{xe(!1),tn()},tt=(E,F)=>{ge(W=>({...W,[E]:F}))},at=(E,F,W)=>{ie(K=>K.map(G=>G.id===E?{...G,[F]:F==="sourceId"?W&&Number(W)||null:F==="useCustomName"?W==="true":W}:G))},gt=(E,F)=>{const W=Ge.find(K=>K.id!==null&&F===String(K.id)||K.id===null&&F===K.name)||null;ie(K=>K.map(G=>G.id===E?{...G,sourceId:W?.id??null,sourceName:W?.name??"",numberBank:W?.numberBank??"",bankBin:W?.binBank??"",useCustomName:!1}:G))},Nt=(E,F)=>{const W=gv(F);ie(K=>K.map(G=>G.id===E?{...G,price:W}:G))},ir=E=>{ie(F=>F.map(W=>W.id===E?{...W,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:W))},Dt=()=>{ie(E=>[...E,xv()])},rr=E=>{ie(F=>F.length===1?F:F.filter(W=>W.id!==E))},L=async()=>{if(!q||z===null)return;const E=q.packageName?.trim()??"",F=q.packageProduct?.trim()??"",W=q.sanPham?.trim()??"";if(!W){ue("Vui lng nhp m sn phm hp l");return}const K=ae(q.pctCtv),G=ae(q.pctKhach),re=ae(q.pctPromo);if(!K||K<=0){ue("T gi CTV phi ln hn 0");return}if(!G||G<=0){ue("T gi Khch phi ln hn 0");return}if(re!==null){if(re<Ah){ue("T gi khuyn mi khng c m.");return}const se=Math.max(0,G-1);if(se===0&&re>0){ue("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(re>se){ue(`T gi khuyn mi khng c vt ${se.toFixed(2)}`);return}}pe(!0),ue(null);try{const se=await fetch(`${mi}${It.PRODUCT_PRICE_DETAIL(z)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:E,packageProduct:F,sanPham:W,pctCtv:K,pctKhach:G,pctPromo:re}),credentials:"include"}),de=await se.text();let Pe=null;if(de)try{Pe=JSON.parse(de)}catch{Pe=null}if(!se.ok){const ke=Pe?.error||de?.trim()||"Khng th cp nht gi sn phm";throw new Error(ke)}const we=Yk(Pe,z);i(ke=>ke.map($e=>$e.id===z?we:$e)),we?.id!==void 0&&ne(ke=>({...ke,[we.id]:we.lastUpdated||new Date().toISOString()})),await et(),R(null),V(null)}catch(se){console.error("Li khi cp nht gi sn phm:",se),ue(se instanceof Error?se.message:"Khng th cp nht gi sn phm")}finally{pe(!1)}},Y=async()=>{const E=ye.packageName.trim(),F=ye.packageProduct.trim(),W=ye.sanPham.trim(),K=ae(ye.pctCtv),G=ae(ye.pctKhach),re=ae(ye.pctPromo);if(!W){De("Vui lng nhp m sn phm");return}if(K!==null&&K<=0){De("T gi CTV phi ln hn 0.");return}if(G!==null&&G<=0){De("T gi khch phi ln hn 0.");return}if(re!==null){if(re<Ah){De("T gi khuyn mi khng c m.");return}if(G!==null&&G>0){const de=Math.max(0,G-1);if(de===0&&re>0){De("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(re>de){De(`T gi khuyn mi khng c vt ${de.toFixed(2)}`);return}}}const se=Oe.map(de=>{const Pe=de.sourceName.trim(),we=Number((de.price||"").replace(/\D+/g,"")),ke=Number.isFinite(we)&&we>0?we:null;return!Pe&&ke===null?null:{sourceId:de.sourceId!==null&&Number.isFinite(de.sourceId)?de.sourceId:void 0,sourceName:Pe||void 0,price:ke,numberBank:de.numberBank.trim()||void 0,binBank:de.bankBin.trim()||void 0}}).filter(de=>!!(de&&(de.sourceId||de.sourceName)));Ve(!0),De(null);try{const de=await fetch(`${mi}${It.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:E,packageProduct:F,sanPham:W,pctCtv:K,pctKhach:G,pctPromo:re,suppliers:se}),credentials:"include"}),Pe=await de.text();let we=null;if(Pe)try{we=JSON.parse(Pe)}catch{we=null}if(!de.ok){const ke=we?.error||Pe?.trim()||"Khng th to sn phm";throw new Error(ke)}await et(),Je()}catch(de){console.error("Li khi to sn phm:",de),De(de instanceof Error?de.message:"Khng th to sn phm")}finally{Ve(!1)}},C=async E=>{const W=!(_e[E.id]??E.isActive??!1),K=_e[E.id],G=Re[E.id],re=new Date().toISOString();Me(se=>({...se,[E.id]:W})),i(se=>se.map(de=>de.id===E.id?{...de,isActive:W}:de)),ne(se=>({...se,[E.id]:re}));try{const se=await fetch(`${mi}${It.PRODUCT_PRICES}/${E.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:W}),credentials:"include"});if(!se.ok)throw new Error("Li khi cp nht trng thi");const de=await se.json(),Pe=de?.is_active??W,we=typeof de?.update=="string"?de.update:re;Me(ke=>({...ke,[E.id]:Pe})),i(ke=>ke.map($e=>$e.id===E.id?{...$e,isActive:Pe,lastUpdated:we}:$e)),ne(ke=>({...ke,[E.id]:we}))}catch(se){console.error("Failed to toggle product status:",se),Me(de=>{const Pe={...de};return K===void 0?delete Pe[E.id]:Pe[E.id]=K,Pe}),i(de=>de.map(Pe=>Pe.id===E.id?{...Pe,isActive:K??E.isActive??!1}:Pe)),ne(de=>{const Pe={...de};return G?Pe[E.id]=G:delete Pe[E.id],Pe}),alert("Cp nht tht bi. Vui lng th li")}},P=v.useMemo(()=>{const E=e.trim().toLowerCase();return a.filter(F=>r==="active"&&!F.isActive||r==="inactive"&&F.isActive?!1:E?[F.packageName,F.packageProduct,F.sanPhamRaw,F.variantLabel].join(" ").toLowerCase().includes(E):!0).sort((F,W)=>{const K=!(_e[F.id]??F.isActive),G=!(_e[W.id]??W.isActive);if(K!==G)return K?1:-1;const re=jh(Re[F.id]??F.lastUpdated),se=jh(Re[W.id]??W.lastUpdated);return re!==se?se-re:F.id-W.id})},[a,e,r,_e,Re]),M=v.useMemo(()=>{const E=a.length,F=a.filter(K=>K.isActive).length,W=E-F;return[{name:"Tng Sn Phm",value:E.toString(),icon:$0,accent:"emerald"},{name:"ang Hot ng",value:F.toString(),icon:B0,accent:"sky"},{name:"Tm Dng",value:W.toString(),icon:cc,accent:"violet"}]},[a]);return u.jsxs(u.Fragment,{children:[je.product&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:()=>{je.loading||_t()},children:u.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:E=>E.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xc nh Xa"}),u.jsx("p",{className:"text-sm text-sky-200/90",children:"Hnh ng ny s Xa Sn Phm khi bng Gi."})]}),u.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:_t,disabled:je.loading,children:""})]}),u.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-sky-100",children:je.product.packageName||je.product.packageProduct||je.product.sanPhamRaw||`Sn Phm #${je.product.id}`}),u.jsxs("p",{className:"text-sm text-sky-200/90",children:["M:"," ",je.product.sanPhamRaw||"Khng xc nh"]})]}),u.jsx("p",{children:"Bn c chc chn mun xa sn phm ny? Hnh ng khng th hon tc v d liu lin quan s c cp nht."})]}),je.error&&u.jsx("p",{className:"mt-4 text-xs text-red-500",children:je.error}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-white/70 rounded-lg border border-gray-200 hover:bg-indigo-500/10 disabled:opacity-50",onClick:_t,disabled:je.loading,children:"Hy"}),u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white bg-rose-600 rounded-lg hover:bg-rose-700 disabled:opacity-60",onClick:Bt,disabled:je.loading,children:je.loading?"ang Xa...":"Xa Sn Phm"})]})]})}),Ie&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-black/40 px-2 py-4 sm:px-4 sm:py-6",children:u.jsxs("div",{className:"relative flex w-full max-w-5xl flex-col rounded-2xl bg-white shadow-2xl max-h-[95vh]",children:[u.jsx("button",{className:"absolute right-4 top-4 text-white/60 hover:text-white/70",onClick:Je,children:u.jsx(Tn,{className:"h-6 w-6"})}),u.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-6 space-y-6 sm:px-6 sm:py-8",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-sky-100",children:"Thm Sn Phm mi"}),u.jsx("p",{className:"text-base text-sky-200/90",children:"Nhp Thng tin Sn Phm, Nh Cung Cp, T Gi"})]}),u.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-sky-100 bg-gradient-to-br from-white via-sky-50 to-sky-100/40 p-5 shadow-sm",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-600",children:"Thng Tin Sn Phm"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:ye.packageName,onChange:E=>tt("packageName",E.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:ye.packageProduct,onChange:E=>tt("packageProduct",E.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"M Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:ye.sanPham,onChange:E=>tt("sanPham",E.target.value)})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-purple-100 bg-gradient-to-br from-white via-purple-50 to-purple-100/40 p-5 shadow-sm",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-600",children:"T Gi"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi CTV"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:ye.pctCtv,onChange:E=>tt("pctCtv",E.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khch"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:ye.pctKhach,onChange:E=>tt("pctKhach",E.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khuyn Mi"}),u.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:ye.pctPromo,onChange:E=>tt("pctPromo",E.target.value)})]})]})]})]}),u.jsx("div",{className:"rounded-2xl border border-gray-100 bg-gradient-to-br from-white via-gray-50 to-gray-100/40 p-5 shadow-sm",children:u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Thng Tin Nh Cung Cp"}),u.jsx("div",{className:"space-y-4",children:Oe.map((E,F)=>u.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/80 p-4 shadow-inner",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("p",{className:"text-sm font-semibold text-white",children:["Nh Cung Cp #",F+1]}),Oe.length>1&&u.jsx("button",{type:"button",className:"text-xs text-red-500 hover:text-red-600",onClick:()=>rr(E.id),children:"Xa"})]}),u.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tn NCC"}),u.jsxs("div",{className:"mt-1 flex items-stretch gap-2",children:[u.jsx("div",{className:"flex-1",children:E.useCustomName?u.jsx("input",{type:"text",className:"w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",placeholder:"Nhp tn NCC",value:E.sourceName,onChange:W=>at(E.id,"sourceName",W.target.value)}):u.jsxs("select",{className:"supplier-select w-full rounded-xl border border-gray-200 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:E.sourceId!==null?String(E.sourceId):E.sourceName,onChange:W=>gt(E.id,W.target.value),children:[u.jsx("option",{value:"",children:U?"ang ti NCC...":"Chn NCC"}),Ge.map(W=>{const K=W.id!==null?String(W.id):W.name;return u.jsx("option",{value:K,children:W.name},K)})]})}),u.jsx("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-xl border border-blue-300/70 bg-white/90 text-blue-600 hover:bg-blue-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-60",onClick:()=>E.useCustomName?gt(E.id,""):ir(E.id),title:E.useCustomName?"Quay li chn NCC c sn":"Thm NCC mi (in tn th cng)",children:E.useCustomName?u.jsx(kR,{className:"h-5 w-5"}):u.jsx(Mi,{className:"h-5 w-5"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Nhp"}),(()=>{const W=Vk(E.price);return u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:W,onChange:K=>Nt(E.id,K.target.value),placeholder:"0"})})()]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"S Ti Khon"}),(()=>{const W=!E.useCustomName&&!!E.sourceId&&!!(E.bankBin||E.numberBank);return u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:E.numberBank,onChange:K=>at(E.id,"numberBank",K.target.value),disabled:W,style:W?{opacity:.7,cursor:"not-allowed"}:void 0})})()]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Ngn Hng"}),(()=>{const W=!E.useCustomName&&!!E.sourceId&&!!(E.bankBin||E.numberBank);return u.jsxs("select",{className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:E.bankBin,onChange:K=>at(E.id,"bankBin",K.target.value),disabled:W,style:W?{opacity:.7,cursor:"not-allowed"}:void 0,children:[u.jsx("option",{value:"",children:"Chn Ngn Hng"}),X.map(K=>u.jsx("option",{value:K.bin,children:K.name},K.bin))]})})(),ee&&u.jsx("p",{className:"mt-1 text-[11px] text-white/60",children:"ang Ti Danh Sch Ngn Hng..."})]}),u.jsx("div",{className:"md:col-span-2",children:(()=>{const W=Number((E.price||"").replace(/\D+/g,"")),K=ae(ye.pctCtv),G=ae(ye.pctKhach),re=W&&K?dc(W,K):null,se=G&&(re||W)?dc(re||W,G):null;return u.jsxs("div",{className:"mt-3 rounded-xl border border-white/20 bg-white/10 px-4 py-3 shadow-inner",children:[u.jsx("p",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Xem trc gi"}),u.jsxs("div",{className:"mt-2 grid gap-3 md:grid-cols-2",children:[u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi s (theo T gi CTV)"}),u.jsx("span",{className:"text-sm font-semibold text-white",children:re?ga(re):"-"})]}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi l (theo T gi Khch)"}),u.jsx("span",{className:"text-sm font-semibold text-white",children:se?ga(se):"-"})]})]})]})})()})]})]},E.id))}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{type:"button",className:"inline-flex items-center rounded-full border border-dashed border-blue-300 px-4 py-2 text-sm font-semibold text-blue-600 hover:border-blue-400 hover:text-blue-700",onClick:Dt,children:[u.jsx($R,{className:"mr-2 h-4 w-4"}),"Thm NCC"]})})]})}),he&&u.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:he}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:Je,disabled:We,children:"Hy B"}),u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:Y,disabled:We,children:We?"ang Lu...":"Lu Sn Phm"})]})]})]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsx("div",{children:u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bng Gi Sn Phm"})}),u.jsx("div",{className:"mt-4 sm:mt-0",children:u.jsx(Bi,{icon:Mi,onClick:Le,children:"Thm Sn Phm"})})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.map(E=>u.jsx(Oc,{title:E.name,value:E.value,icon:E.icon,subtitle:E.subtitle,accent:Yr[E.accent]},E.name))})}),u.jsxs("div",{className:"bg-gradient-to-br from-indigo-950/70 via-slate-900/60 to-indigo-950/70 border border-white/10 rounded-2xl shadow-lg p-6 text-white backdrop-blur",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"relative md:col-span-2",children:[u.jsx(gl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"}),u.jsx("input",{type:"text",placeholder:"Tm Kim Sn Phm...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-white/20 bg-white/10 text-white placeholder:text-white/60 focus:ring-2 focus:ring-blue-500/60 focus:border-blue-400/60",value:e,onChange:E=>t(E.target.value)})]}),u.jsxs("select",{className:"w-full px-4 py-2 rounded-lg border border-white/20 bg-white/10 text-white focus:ring-2 focus:ring-blue-500/60 focus:border-blue-400/60",value:r,onChange:E=>n(E.target.value),children:[u.jsx("option",{value:"all",children:"Trng Thi"}),u.jsx("option",{value:"active",children:"ang Hot ng"}),u.jsx("option",{value:"inactive",children:"Tm Dng"})]}),u.jsx(Bi,{className:"w-full justify-center",type:"button",onClick:rt,disabled:s||Ae,children:s||Ae?"ang ng B...":"ng B Li"})]}),f&&u.jsx("div",{className:"mt-4 rounded-lg border border-red-400/40 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:f})]}),u.jsx("div",{className:"bg-white/10 border border-white/10 rounded-2xl shadow-lg overflow-hidden backdrop-blur",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Sn Phm"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Gi S"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Gi L"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Gi Khuyn Mi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Tnh Trng"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Cp Nht"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase",children:"Thao Tc"})]})}),u.jsx("tbody",{className:"bg-white/5 divide-y divide-white/10",children:s?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"ang ti d liu..."})}):P.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:f?"Khng th ti d liu. Vui lng th li.":"Khng c sn phm."})}):P.map(E=>{const F=d===E.id,W=Uu(E.sanPhamRaw),K=x[W],G=K?.items??[],re=I[E.id]||null,se=[...G.map(cr=>({kind:"existing",supplier:cr})),...re?[{kind:"new"}]:[]],de=UZ(G),Pe=de?.price??E.baseSupplyPrice,we=de?.sourceName??"-",ke=$o(G,E.baseSupplyPrice),$e=()=>{Ue(E.sanPhamRaw)},ht=_e[E.id]??E.isActive??!1,xt=Re[E.id]??E.lastUpdated??"",kt=cr=>{cr.stopPropagation(),C(E)},kr=xt?BZ(xt):"-",Cr=z===E.id,jt=Cr?q:null,Ot=jt?{pctCtv:ae(jt.pctCtv),pctKhach:ae(jt.pctKhach),pctPromo:ae(jt.pctPromo)}:null,vr=Ot?yO(Ot.pctCtv,ke):null,Ft=typeof vr=="number"&&Number.isFinite(vr)&&vr>0?vr:ke,Nl=Ot?dc(Ft,Ot.pctKhach):null,qc=Ot?wO(Ot.pctKhach,Ot.pctPromo,Ot.pctCtv,vr,ke):null,Wi=vv(Ot?.pctPromo??null),Eo=R0(Ot?.pctPromo??null,Ot?.pctKhach??null,Ot?.pctCtv??null)&&Number.isFinite(qc??NaN),El=typeof ke=="number"&&Number.isFinite(ke)&&ke>0?ga(ke):"Cha c d liu",Ts=R0(E.pctPromo,E.pctKhach,E.pctCtv),To=je.product?.id===E.id&&je.loading;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70 cursor-pointer transition",onClick:()=>Tt(E),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(l4,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${F?"rotate-180":""}`}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm font-semibold text-white",children:E.packageName}),u.jsx("div",{className:"text-xs text-white/70",children:E.variantLabel})]})]})}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsx("div",{className:"text-sm font-semibold text-white",children:ga(E.wholesalePrice)}),u.jsx("div",{className:"text-xs text-white/70",children:Kk({multiplier:E.pctCtv,price:E.wholesalePrice,basePrice:E.baseSupplyPrice})})]}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[u.jsx("div",{className:"text-sm font-semibold text-amber-300",children:ga(E.retailPrice)}),u.jsx("div",{className:"text-xs text-white/70",children:Kk({multiplier:E.pctKhach,price:E.retailPrice,basePrice:E.baseSupplyPrice})})]}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:R0(E.pctPromo,E.pctKhach,E.pctCtv)?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-sm font-semibold text-pink-200",children:ga(E.promoPrice)}),u.jsx("div",{className:"text-xs text-white/70",children:vv(E.pctPromo)??"-"})]}):u.jsx("div",{className:"text-sm text-white/60",children:"-"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"flex flex-col items-center",children:u.jsx("button",{type:"button",onClick:kt,className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${ht?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":ht,children:u.jsx(u4,{className:"h-4 w-4"})})})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm text-white",children:kr})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:u.jsxs("div",{className:"flex items-center justify-end gap-3",children:[u.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:cr=>$t(cr,E),children:u.jsx(cc,{className:"h-4 w-4"})}),u.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${To?"opacity-60 cursor-not-allowed":""}`,onClick:cr=>yt(cr,E),disabled:To,children:u.jsx(rl,{className:"h-4 w-4"})})]})})]}),Cr&&jt&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 pb-6",children:u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 shadow-lg px-6 py-5 space-y-6 text-white",children:[u.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thng Tin Sn Phm"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tn Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:jt.packageName,onChange:cr=>Rt("packageName",cr.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:jt.packageProduct,onChange:cr=>Rt("packageProduct",cr.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"M Sn Phm"}),u.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:jt.sanPham,onChange:cr=>Rt("sanPham",cr.target.value)})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"T Gi"}),u.jsxs("div",{className:"mt-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi CTV"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:jt.pctCtv,onChange:cr=>Rt("pctCtv",cr.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khch"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:jt.pctKhach,onChange:cr=>Rt("pctKhach",cr.target.value)})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T gi khuyn mi"}),u.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:jt.pctPromo,onChange:cr=>Rt("pctPromo",cr.target.value)})]})]})]})]}),jt&&u.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-4 shadow-lg backdrop-blur",children:[u.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[u.jsx("span",{children:"Gi d kin theo t gi"}),u.jsxs("span",{className:"text-amber-200 normal-case font-medium",children:["Gi ngun cao nht:"," ",u.jsx("span",{className:"font-semibold",children:El})]})]}),u.jsxs("div",{className:`mt-4 grid gap-3 text-center text-sm ${Eo?"md:grid-cols-3":"md:grid-cols-2"}`,children:[u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi S d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(vr)}),u.jsx("p",{className:"text-[11px] text-white/70",children:jt.pctCtv?`T gi: ${jt.pctCtv}`:"Nhp t gi CTV"})]}),u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khch d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(Nl)}),u.jsx("p",{className:"text-[11px] text-white/70",children:jt.pctKhach?`T gi: ${jt.pctKhach}`:"Nhp t gi khch"})]}),Eo&&u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khuyn mi d kin"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(qc)}),u.jsx("p",{className:"text-[11px] text-white/70",children:Wi??"Nhp t gi khuyn mi"})]})]})]}),J&&u.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:J}),u.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:zr,disabled:Ne,children:"Hy B"}),u.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:L,disabled:Ne,children:Ne?"ang Lu...":"Lu Thay i"})]})]})})}),F&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 pb-6",children:u.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 text-white p-4",children:u.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 shadow-lg text-white px-6 py-5 space-y-4",children:[u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tit Gi Sn Phm"})}),u.jsxs("div",{className:`grid gap-4 text-sm text-center ${Ts?"md:grid-cols-4":"md:grid-cols-3"}`,children:[u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 flex flex-col items-center",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Ngun Thp Nht"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(Pe)}),u.jsx("p",{className:"text-xs text-white/70",children:we})]}),u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 flex flex-col items-center",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi S Hin Ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(E.wholesalePrice)})]}),u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 flex flex-col items-center",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khch Hin Ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(E.retailPrice)})]}),Ts&&u.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 flex flex-col items-center",children:[u.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khuyn Mi Hin Ti"}),u.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:ga(E.promoPrice)}),u.jsx("p",{className:"text-xs text-white/70",children:vv(E.pctPromo)??"-"})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/15 overflow-hidden",children:[u.jsx("div",{className:"flex justify-end bg-white/5 px-4 py-2 border-b border-white/10",children:u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>ca(E.id),disabled:!!re,children:[u.jsx(py,{className:"h-4 w-4"}),"Thm Ngun"]})}),u.jsxs("table",{className:"w-full text-sm",children:[u.jsx("thead",{className:"bg-white/5 text-[11px] uppercase text-white/70 tracking-wide",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 text-left",children:"NCC"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Gi Nhp"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Li Nhun"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Thao Tc"})]})}),u.jsx("tbody",{children:K?.loading?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"ang Ti D Liu"})}):K?.error?u.jsx("tr",{children:u.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white space-x-2",children:[u.jsx("span",{children:K.error}),u.jsx("button",{type:"button",className:"text-red-400 hover:text-red-200 hover:underline text-xs",onClick:$e,children:"Th Li"})]})}):G.length===0&&se.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Cha c d liu t NCC"})}):se.map(cr=>{if(cr.kind==="existing"&&cr.supplier){const Ir=cr.supplier,Na=ec(E.id,Ir.sourceId),Tl=!!b[Na],Vi=!!A[Na],ko=w[Na]??(Ir.price??"").toString(),Zc=D[Na],kl=!Tl||Vi,Gt=ga(Ir.price);return u.jsxs("tr",{className:"border-t border-white/15",children:[u.jsx("td",{className:"px-4 py-3 text-sm text-white text-center",children:Ir.sourceName}),u.jsx("td",{className:"px-4 py-3",children:Tl?u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"text",value:ko,disabled:kl,onChange:Xf=>Dr(E.id,Ir.sourceId,Xf.target.value),className:`w-28 rounded-lg border px-2 py-1 text-center text-sm focus:outline-none focus:ring-2 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none ${kl?"border-white/25 bg-white/10 text-white/70":"border-blue-300/50 focus:border-blue-400 focus:ring-blue-300/40"} ${Zc?"border-red-400 focus:border-red-500 focus:ring-red-200":""}`}),u.jsx("span",{className:"text-xs text-white/70",children:""})]}),Zc&&u.jsx("p",{className:"mt-1 text-[11px] text-red-500",children:Zc})]}):u.jsx("div",{className:"flex justify-center",children:u.jsx("span",{className:"inline-flex min-w-[112px] justify-center rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white",children:Gt})})}),u.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:$Z(Ir.price,E.wholesalePrice,E.retailPrice)}),u.jsx("td",{className:"px-4 py-3",children:Tl?u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:Vi,onClick:()=>Ur(E.id,Ir.sourceId,W,E.sanPhamRaw),children:u.jsx(tl,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:Vi,onClick:()=>en(E.id,Ir.sourceId),children:u.jsx(Tn,{className:"h-4 w-4"})})]}):u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:Vi,onClick:()=>Ut(E.id,Ir.sourceId,Ir.price),children:u.jsx(cc,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:Vi,onClick:()=>Ht(E.id,Ir.sourceId,W,E.sanPhamRaw),children:u.jsx(xy,{className:"h-4 w-4"})})]})})]},Na)}if(cr.kind==="new"&&re){const Ir=re;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{className:"border-t border-dashed border-sky-100 bg-sky-50/40",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsx("input",{type:"text",className:"w-full rounded-lg border border-sky-200 bg-white px-3 py-2 text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200",placeholder:"Tn Ngun",value:Ir.sourceName,onChange:Na=>Yn(E.id,"sourceName",Na.target.value),disabled:Ir.isSaving})}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center gap-1",children:[u.jsx("input",{type:"text",className:"w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Gi Nhp",value:Ir.price,onChange:Na=>Yn(E.id,"price",Na.target.value),disabled:Ir.isSaving}),u.jsx("span",{className:"text-xs text-white/70",children:""})]})}),u.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:"-"}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:Ir.isSaving,onClick:()=>St(E),children:u.jsx(tl,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:Ir.isSaving,onClick:()=>Xe(E.id),children:u.jsx(Tn,{className:"h-4 w-4"})})]})})]}),Ir.error&&u.jsx("tr",{children:u.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:Ir.error})})]},`new-${E.id}`)}return null})})]})]})]})})})})]},E.id)})})]})})})]})]})}function HZ(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[a,i]=v.useState(null),[s,c]=v.useState(!1),f=v.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]),{setUser:h}=gy(),d=Zh();return u.jsxs("div",{className:"retro-login",children:[u.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:u.jsxs("linearGradient",{id:f,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[u.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),u.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),u.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),u.jsxs("div",{className:"retro-shell",children:[u.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[u.jsx("div",{className:"retro-grid"}),u.jsx("div",{className:"retro-sun"}),u.jsx("div",{className:"retro-planet"}),u.jsx("div",{className:"retro-glow"})]}),u.jsxs("div",{className:"retro-card",children:[u.jsx("div",{className:"card-top",children:u.jsxs("div",{className:"title",children:[u.jsx("p",{className:"eyebrow",children:"Cho mng tr li"}),u.jsx("h1",{className:"gradient-title",children:"Mavryk Premium"}),u.jsx("p",{className:"subtitle",children:"Nhp thng tin ca bn  vo trang qun tr."})]})}),u.jsxs("form",{className:"form",onSubmit:m=>{m.preventDefault(),i(null),c(!0),Xt("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async x=>{if(!x.ok){const b=await x.json().catch(()=>({}));throw new Error(b.error||"Login failed")}const g=await x.json();h(g.user||null),d("/dashboard",{replace:!0})}).catch(x=>{i(x instanceof Error?x.message:"Login failed")}).finally(()=>c(!1))},children:[u.jsxs("label",{className:"field",children:[u.jsx("span",{children:"Ti khon"}),u.jsx("input",{type:"text",required:!0,value:e,onChange:m=>t(m.target.value),placeholder:"Nhp tn ng nhp"})]}),u.jsxs("label",{className:"field",children:[u.jsx("span",{children:"Mt khu"}),u.jsx("input",{type:"password",required:!0,value:r,onChange:m=>n(m.target.value),placeholder:"Nhp mt khu"})]}),u.jsxs("div",{className:"controls",children:[u.jsxs("label",{className:"remember",children:[u.jsx("input",{type:"checkbox",defaultChecked:!0}),u.jsx("span",{children:"Ghi nh ng nhp"})]}),u.jsx("button",{type:"button",className:"ghost",children:"Qun mt khu?"})]}),u.jsx("button",{type:"submit",className:"cta",disabled:s,children:s?"ang ng nhp...":"ng nhp"}),a&&u.jsx("p",{className:"error-msg",children:a})]})]})]}),u.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Vast+Shadow&display=swap');

        :root {
          --retro-bg: #0b0b14;
          --retro-card: rgba(13, 14, 26, 0.8);
          --retro-border: rgba(255, 255, 255, 0.08);
          --retro-text: #e5e7ff;
          --retro-muted: #9aa4c2;
          --retro-accent: #ff6ec7;
          --retro-accent-2: #7c5cff;
          --retro-glow: 0 10px 50px rgba(124, 92, 255, 0.5);
          --glass: rgba(255, 255, 255, 0.04);
          color-scheme: dark;
        }

        .retro-login {
          min-height: 100vh;
          background: radial-gradient(circle at 20% 20%, rgba(255, 110, 199, 0.12), transparent 30%),
                      radial-gradient(circle at 80% 0%, rgba(77, 225, 236, 0.12), transparent 32%),
                      var(--retro-bg);
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 32px;
          position: relative;
          overflow: hidden;
          font-family: "Inter", "Space Grotesk", system-ui, -apple-system, sans-serif;
        }

        .retro-shell {
          position: relative;
          width: min(1100px, 100%);
          min-height: 620px;
          border: 1px solid var(--retro-border);
          border-radius: 24px;
          overflow: hidden;
          background: linear-gradient(135deg, rgba(255, 110, 199, 0.06), rgba(77, 225, 236, 0.05));
          box-shadow: 0 30px 120px rgba(0, 0, 0, 0.45);
        }

        .retro-bg {
          position: absolute;
          inset: 0;
          overflow: hidden;
          pointer-events: none;
        }

        .retro-grid {
          position: absolute;
          inset: 0;
          background-image: linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
          background-size: 80px 80px;
          transform: perspective(600px) rotateX(70deg) translateY(-20%);
          transform-origin: center;
          filter: blur(0.3px);
        }

        .retro-sun {
          position: absolute;
          width: 340px;
          height: 340px;
          border-radius: 50%;
          background: conic-gradient(from 120deg, rgba(255, 110, 199, 0.3), rgba(124, 92, 255, 0.35), rgba(77, 225, 236, 0.3));
          top: -80px;
          left: 50%;
          transform: translateX(-50%);
          filter: blur(10px);
          opacity: 0.9;
        }

        .retro-planet {
          position: absolute;
          width: 120px;
          height: 120px;
          border-radius: 50%;
          background: radial-gradient(circle at 30% 30%, #fff, #7c5cff 45%, #0b0b14 75%);
          top: 60px;
          right: 140px;
          box-shadow: 0 0 40px rgba(124, 92, 255, 0.7);
          opacity: 0.7;
        }

        .retro-glow {
          position: absolute;
          inset: 0;
          background: radial-gradient(circle at 50% 70%, rgba(255, 110, 199, 0.1), transparent 45%);
          mix-blend-mode: screen;
        }

        .retro-card {
          position: relative;
          z-index: 1;
          margin: 48px;
          padding: 36px;
          border-radius: 18px;
          background: var(--retro-card);
          border: 1px solid var(--retro-border);
          backdrop-filter: blur(16px);
          box-shadow: var(--retro-glow);
          color: var(--retro-text);
          display: grid;
          gap: 24px;
          max-width: 640px;
          overflow: hidden;
        }
        .retro-card::before {
          content: "";
          position: absolute;
          inset: -60px;
          background: conic-gradient(#ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          filter: blur(40px);
          opacity: 0.45;
          animation: spinGlow 12s linear infinite;
          z-index: 0;
          pointer-events: none;
        }
        .retro-card > * { position: relative; z-index: 1; }

        .card-top {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }

        .badge {
          align-self: flex-start;
          padding: 6px 12px;
          border-radius: 999px;
          background: linear-gradient(90deg, rgba(255, 110, 199, 0.2), rgba(77, 225, 236, 0.2));
          border: 1px solid rgba(255, 255, 255, 0.12);
          text-transform: uppercase;
          letter-spacing: 0.08em;
          font-size: 11px;
          color: var(--retro-text);
        }

        .title h1 {
          font-size: 36px;
          line-height: 1.2;
          margin: 6px 0 6px;
          letter-spacing: -0.01em;
        }
        .gradient-title {
          background: linear-gradient(120deg, #ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          animation: gradientShift 4s ease-in-out infinite;
          font-family: "Vast Shadow", "Cinzel Decorative", "Inter", system-ui, -apple-system, sans-serif;
          letter-spacing: 0.5px;
        }
        .title .eyebrow {
          text-transform: uppercase;
          letter-spacing: 0.12em;
          font-size: 12px;
          color: var(--retro-muted);
          margin: 0;
        }
        .title .subtitle {
          margin: 0;
          color: var(--retro-muted);
          font-size: 14px;
        }

        .form {
          display: grid;
          gap: 16px;
        }
        .field {
          display: grid;
          gap: 6px;
          font-size: 14px;
          color: var(--retro-text);
        }
        .field input {
          width: 100%;
          border-radius: 12px;
          border: 1px solid var(--retro-border);
          background: var(--glass);
          padding: 12px 14px;
          color: var(--retro-text);
          transition: border-color 0.2s, box-shadow 0.2s;
        }
        .field input:focus {
          outline: none;
          border-color: rgba(255, 110, 199, 0.6);
          box-shadow: 0 0 0 3px rgba(124, 92, 255, 0.25);
        }

        .controls {
          display: flex;
          align-items: center;
          justify-content: space-between;
          font-size: 13px;
          color: var(--retro-muted);
        }
        .remember {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          cursor: pointer;
        }
        .remember input { accent-color: #7c5cff; }
        .ghost {
          background: transparent;
          border: none;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          padding: 4px 8px;
        }

        .cta {
          width: 100%;
          border: none;
          border-radius: 14px;
          padding: 14px;
          font-weight: 700;
          letter-spacing: 0.01em;
          color: #0b0b14;
          background: linear-gradient(90deg, #ff6ec7, #7c5cff, #4de1ec);
          box-shadow: 0 15px 40px rgba(124, 92, 255, 0.45);
          cursor: pointer;
          transition: transform 0.15s ease, box-shadow 0.15s ease;
        }
        .cta:hover {
          transform: translateY(-1px);
          box-shadow: 0 18px 50px rgba(124, 92, 255, 0.55);
        }
        .cta:active { transform: translateY(0); }

        .divider {
          display: grid;
          grid-template-columns: 1fr auto 1fr;
          align-items: center;
          gap: 10px;
          color: var(--retro-muted);
          font-size: 12px;
        }
        .divider span {
          height: 1px;
          background: linear-gradient(90deg, rgba(255, 255, 255, 0), rgba(255,255,255,0.25), rgba(255,255,255,0));
        }

        .social {
          display: grid;
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 10px;
        }
        .social button {
          border: 1px solid var(--retro-border);
          background: var(--glass);
          border-radius: 12px;
          padding: 10px 12px;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          transition: border-color 0.2s, transform 0.2s;
        }
        .social button:hover {
          border-color: rgba(255, 110, 199, 0.5);
          transform: translateY(-1px);
        }
        .cta:disabled { opacity: 0.6; cursor: not-allowed; }
        .error-msg { margin-top: 8px; color: #ff9b9b; font-size: 13px; }
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        @keyframes spinBorder {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes spinGlow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .retro-shell { margin: 16px; }
          .retro-card { margin: 32px 20px; padding: 28px; }
        }
      `})]})}const WZ=[{title:"Tng chi tiu",value:"89,935",delta:"+1.01% thng ny",trend:"up",accent:"amber",icon:B0},{title:"Tng thu nhp",value:"23,283.5",delta:"+0.49% thng ny",trend:"up",accent:"emerald",icon:B0}],g0=[{name:"Nh ca & Tin ch",value:8e6,color:"#F8C573"},{name:"Thc phm",value:512e4,color:"#9BE7C4"},{name:"Chm sc c nhn",value:538e4,color:"#7CB3FF"},{name:"Ph kin",value:412e4,color:"#F48FB1"},{name:"Dch v khc",value:303e4,color:"#C7D2FE"}],VZ=[{name:"Nh ca & Tin ch",used:315e4,total:45e5},{name:"Thc phm & Thit yu",used:226e4,total:45e5},{name:"Chm sc c nhn",used:189e4,total:45e5},{name:"Ph kin",used:152e4,total:45e5}],KZ=[{name:"Laptop mi",progress:50,saved:3375e3,target:675e4,accent:"#f8c573"},{name:"Du lch",progress:70,saved:474e4,target:675e4,accent:"#9be7c4"}],GZ=[{time:"01/12/2025",momo:15e5,bank:325e4,supper:22e5,gold:18e5},{time:"05/12/2025",momo:9e5,bank:2e6,supper:16e5,gold:145e4},{time:"10/12/2025",momo:125e4,bank:28e5,supper:21e5,gold:17e5},{time:"14/12/2025",momo:11e5,bank:26e5,supper:185e4,gold:15e5}],xi=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),YZ=new Intl.NumberFormat("vi-VN",{maximumFractionDigits:1}),XZ={amber:{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"},emerald:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"}},qZ=({title:e,value:t,delta:r,trend:n,accent:a,icon:i})=>{const s=XZ[a],c=n==="up"?B0:W6;return u.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.12em] text-slate-500",children:e}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t}),u.jsxs("div",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold ${s.chip}`,children:[u.jsx(c,{className:"h-4 w-4"}),u.jsx("span",{children:r})]})]}),u.jsx("div",{className:`h-12 w-12 rounded-2xl flex items-center justify-center ${s.iconBg}`,children:u.jsx(i,{className:"h-6 w-6"})})]})},ZZ=({name:e,used:t,total:r})=>{const n=Math.min(100,Math.round(t/r*100)),a=r-t;return u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-slate-900",children:[u.jsx("span",{children:e}),u.jsxs("span",{children:[n,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-slate-200",children:u.jsx("div",{className:"h-full rounded-full bg-slate-900",style:{width:`${n}%`}})}),u.jsxs("p",{className:"text-xs text-slate-500",children:["Cn li ",xi.format(a)," /"," ",xi.format(r)]})]})},QZ=({progress:e,color:t})=>u.jsxs("div",{className:"relative h-14 w-14",children:[u.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`conic-gradient(${t} ${e}%, #e2e8f0 ${e}%)`}}),u.jsxs("div",{className:"absolute inset-[6px] rounded-full bg-slate-900 border border-white/10 flex items-center justify-center text-xs font-semibold text-white shadow-inner shadow-black/30",children:[Math.round(e),"%"]})]});function JZ(){const e=v.useMemo(()=>g0.reduce((t,r)=>t+r.value,0),[]);return u.jsx("div",{className:"stats-shell min-h-screen",children:u.jsxs("div",{className:"mx-auto max-w-6xl px-4 py-6 space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:WZ.map(t=>u.jsx(qZ,{...t},t.title))}),u.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[u.jsxs("div",{className:"stats-card p-6 space-y-6",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Chi tiu hng thng"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Tng quan thng hin ti"})]})}),u.jsxs("div",{className:"grid items-center gap-6 lg:grid-cols-[1.1fr_1fr]",children:[u.jsxs("div",{className:"relative h-72 w-full",children:[u.jsx(o1,{width:"100%",height:"100%",children:u.jsxs(Dq,{children:[u.jsx(_5,{data:g0,dataKey:"value",nameKey:"name",innerRadius:"60%",outerRadius:"85%",paddingAngle:4,cornerRadius:12,stroke:"none",children:g0.map(t=>u.jsx(Hf,{fill:t.color},t.name))}),u.jsx(A1,{formatter:t=>xi.format(t),contentStyle:{background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:12,color:"#0f172a"}})]})}),u.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center text-center",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-slate-900",children:xi.format(e)}),u.jsx("p",{className:"text-sm text-slate-500",children:"Tng"})]})})]}),u.jsxs("div",{className:"space-y-2 rounded-2xl border border-white/10 bg-white/5 p-3 shadow-[0_14px_40px_-28px_rgba(0,0,0,0.7)] backdrop-blur-sm",children:[u.jsxs("div",{className:"grid grid-cols-12 text-xs font-semibold text-white/70",children:[u.jsx("span",{className:"col-span-6",children:"Nhn"}),u.jsx("span",{className:"col-span-4 text-right",children:"Gi tr"}),u.jsx("span",{className:"col-span-2 text-right",children:"%"})]}),g0.map(t=>{const r=t.value/e*100;return u.jsxs("div",{className:"grid grid-cols-12 items-center rounded-xl px-3 py-2 transition-colors hover:bg-white/5",children:[u.jsxs("div",{className:"col-span-6 flex items-center gap-2 text-sm font-semibold text-white",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:t.color}}),t.name]}),u.jsx("div",{className:"col-span-4 text-right text-sm font-semibold text-white",children:xi.format(t.value)}),u.jsxs("div",{className:"col-span-2 text-right text-xs text-white/70",children:[YZ.format(r),"%"]})]},t.name)})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 shadow-[0_16px_42px_-26px_rgba(0,0,0,0.75)] space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Dng tin"}),u.jsx("span",{className:"text-xs text-white/60",children:"Tng hp theo ngun"})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full text-sm",children:[u.jsx("thead",{className:"bg-white/5 text-white/70 text-xs uppercase tracking-[0.08em]",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Thi gian"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Momo"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Ngn Hng"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Supper Sinh Li"}),u.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Vng"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10 text-white",children:GZ.map((t,r)=>u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-3 py-2 font-semibold",children:t.time}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:xi.format(t.momo)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:xi.format(t.bank)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:xi.format(t.supper)}),u.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:xi.format(t.gold)})]},`${t.time}-${r}`))})]})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"stats-card stats-alert p-4 flex items-start gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-white flex items-center justify-center border border-amber-100",children:u.jsx(q6,{className:"h-5 w-5 text-amber-700"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold",children:"Chi tiu thc phm tng 20% trong thng ny"}),u.jsx("p",{className:"text-xs text-amber-700",children:"Xem li hn mc  trnh vt ngn sch."})]})]}),u.jsxs("div",{className:"stats-card p-5 space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Ngn sch"}),u.jsx(gR,{className:"h-5 w-5 text-slate-400"})]}),u.jsx("div",{className:"space-y-3",children:VZ.map(t=>u.jsx(ZZ,{...t},t.name))}),u.jsx("button",{type:"button",className:"w-full rounded-xl bg-slate-900 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-18px_rgba(15,23,42,0.45)] hover:bg-slate-800 transition-colors",children:"To ngn sch"})]}),u.jsxs("div",{className:"stats-card p-5 space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-sm font-semibold text-slate-900",children:"Mc tiu tit kim"}),u.jsx(aR,{className:"h-5 w-5 text-emerald-500"})]}),u.jsx("div",{className:"space-y-3",children:KZ.map(t=>u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/10 bg-white/5 px-3 py-2 shadow-[0_12px_32px_-26px_rgba(0,0,0,0.65)] backdrop-blur-sm",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(QZ,{progress:t.progress,color:t.accent}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:t.name}),u.jsxs("p",{className:"text-xs text-white/70",children:[xi.format(t.saved)," /"," ",xi.format(t.target)]})]})]}),u.jsx(IR,{className:"h-5 w-5 text-white/60"})]},t.name))}),u.jsx("button",{type:"button",className:"w-full rounded-xl bg-white/10 py-3 text-sm font-semibold text-white border border-white/15 hover:bg-white/15 transition-colors shadow-[0_12px_30px_-24px_rgba(0,0,0,0.65)]",children:"t mc tiu mi"})]})]})]})]})})}const eQ=async e=>{const t=await Xt(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Ngun  c xa trc ."};if(!t.ok){const n=await t.text();throw new Error(n||"Khng th xa ngun.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},tQ={totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0},rQ=Lq,Ys=to,bO="ang Hot ng",_O="Tm Dng",SO=e=>{if(!e)return"active";const t=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toLowerCase();return["inactive","tam dung","tam ngung","pause","paused"].includes(t)?"inactive":"active"},gb=e=>typeof e=="boolean"?e:SO(e)!=="inactive",F0=e=>e!==null&&typeof e=="object",sr=(e,t,r)=>{if(!F0(e))return r;for(const n of t)if(Object.prototype.hasOwnProperty.call(e,n))return e[n];return r},yv=e=>{if(typeof e=="number")return Number.isFinite(e)?e:0;if(typeof e!="string")return 0;const t=e.replace(/[^\d-]/g,"");if(!t)return 0;const r=Number(t);return Number.isFinite(r)?r:0},Z1="C li xy ra khi xa ngun, Vui lng th li sau.",nQ=e=>fo(e,{fallback:Z1,blockPatterns:[/(cannot\s+delete)/i]}),Xk=e=>gb(e)?bO:_O,aQ=e=>gb(e)?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",iQ=e=>e&&Kr(e)||"--",sQ=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():"").filter(t=>t.length>0):[],oQ=e=>e.trim().toLowerCase(),tc=e=>gb(typeof e.isActive=="boolean"?e.isActive:e.status),wv=[{value:"active",label:bO},{value:"inactive",label:_O}],qk={sky:{iconBg:"from-sky-500 via-sky-400 to-blue-500",glow:"from-sky-100/80 via-white/80 to-blue-50/70"},rose:{iconBg:"from-rose-500 via-pink-500 to-red-500",glow:"from-rose-100/80 via-white/80 to-red-50/70"},violet:{iconBg:"from-purple-500 via-violet-500 to-indigo-500",glow:"from-violet-100/80 via-white/80 to-indigo-50/70"},emerald:{iconBg:"from-emerald-500 via-emerald-400 to-lime-500",glow:"from-emerald-100/80 via-white/80 to-lime-50/70"}},Zk=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},lQ=(e,t)=>{const r=e.status==="inactive",n=t.status==="inactive";if(r!==n)return r?1:-1;const a=e.totalUnpaidImport>0?1:0,i=t.totalUnpaidImport>0?1:0;if(a!==i)return i-a;if(a===1&&i===1){if(e.totalUnpaidImport!==t.totalUnpaidImport)return t.totalUnpaidImport-e.totalUnpaidImport}else{const s=Zk(e.lastOrderDate),c=Zk(t.lastOrderDate);if(s!==c)return c-s}return e.sourceName.localeCompare(t.sourceName)},cQ=3,uQ=5,fQ=()=>({pages:[[]],currentPage:0,nextOffset:0,hasMore:!1,loading:!1,error:null,initialized:!1}),dQ=e=>({sourceName:"",numberBank:"",bankBin:"",status:e}),NO=e=>{const t=sr(e,["sourceName",La.sourceName],""),r=sr(e,["numberBank",La.numberBank],null),n=sr(e,["binBank",La.binBank],null),a=sr(e,["bankName",H1.bankName],null),i=sr(e,["rawStatus","raw_status","status"],null),s=sr(e,["isActive",La.activeSupply,"active_supply"],null),c=typeof s=="boolean"?s:SO(i)!=="inactive";return{id:Number(sr(e,["id",La.id],0))||0,sourceName:t,numberBank:r,binBank:n,bankName:a,rawStatus:i,isActive:c}},hQ=e=>{const t=F0(e)?e:{},r=F0(t.supply)?t.supply:e??{},n=NO(r),a=F0(t.stats)?t.stats:{},i=Array.isArray(t.unpaidPayments)?t.unpaidPayments:[];return{supply:{...n,status:n.isActive?"active":"inactive"},stats:{totalOrders:Number(sr(a,["totalOrders","total_orders"],0))||0,canceledOrders:Number(sr(a,["canceledOrders","canceled_orders"],0))||0,monthlyOrders:Number(sr(a,["monthlyOrders","monthly_orders"],0))||0,totalPaidAmount:Number(sr(a,["totalPaidAmount","total_paid_amount"],0))||0},unpaidPayments:i.map(s=>({id:Number(sr(s,["id"],0))||0,round:sr(s,["round"],""),totalImport:Number(sr(s,["totalImport","import_value"],0))||0,paid:Number(sr(s,["paid","paid_value"],0))||0,status:sr(s,["status","status_label"],"")}))}};function pQ(){const[e,t]=v.useState(""),[r,n]=v.useState("all"),[a,i]=v.useState([]),[s,c]=v.useState(tQ),[f,h]=v.useState(!1),[d,m]=v.useState(null),[x,g]=v.useState(null),[b,_]=v.useState({}),[w,S]=v.useState({}),[A,T]=v.useState({}),[D,O]=v.useState({}),[I,j]=v.useState({}),z=C=>{const P=(C||"").replace(/[^\d]/g,"");if(!P)return"";const M=Number(P);return Number.isFinite(M)?M.toLocaleString("vi-VN"):P},[R,q]=v.useState([]),[V,J]=v.useState(!1),[ue,Ne]=v.useState(null),[pe,Ie]=v.useState(!1),[xe,ye]=v.useState(dQ(wv[0].value)),[ge,Oe]=v.useState({isOpen:!1,loading:!1,error:null,supplyId:null,data:null,selectedPaymentId:null,confirming:!1,confirmError:null}),[ie,he]=v.useState(null),[De,We]=v.useState({sourceName:"",paymentInfo:"",bankBin:""}),[Ve,Ge]=v.useState(null),[Te,U]=v.useState(!1),[H,X]=v.useState({}),[Z,ee]=v.useState(null),[Fe,_e]=v.useState({supply:null,loading:!1,error:null}),Me=v.useCallback(async()=>{try{h(!0),m(null);const C=await Xt("/api/supply-insights");if(!C.ok)throw new Error("Khng th ti d liu nh cung cp");const P=await C.json(),M=Array.isArray(P.supplies)?P.supplies.map(F=>{const W=NO(F),K=yv(sr(F,["monthlyImportValue","monthly_import_value"],0)),G=yv(sr(F,["totalPaidImport","total_paid_import"],0)),se=yv(sr(F,["totalUnpaidImport","total_unpaid_import"],0));return{...F,...W,status:W.isActive?"active":"inactive",products:sQ(F.products),monthlyOrders:Number(sr(F,["monthlyOrders","monthly_orders"],0))||0,monthlyImportValue:K,totalOrders:Number(sr(F,["totalOrders","total_orders"],0))||0,totalPaidImport:G,totalUnpaidImport:se}}):[];i(M);const E=P.stats??{};c({totalSuppliers:Number(sr(E,["totalSuppliers","total_suppliers"],0))||0,activeSuppliers:Number(sr(E,["activeSuppliers","active_suppliers"],0))||M.filter(F=>tc(F)).length,monthlyOrders:Number(sr(E,["monthlyOrders","monthly_orders"],0))||0,totalImportValue:Number(sr(E,["totalImportValue","total_import_value"],0))||0})}catch(C){console.error(C),m(C instanceof Error?C.message:"C li xy ra khi ti d liu.")}finally{h(!1)}},[]),Re=C=>{g(P=>P===C?null:C)},ne=v.useCallback((C,P)=>{_(M=>{const E=M[C]??fQ(),F=P(E);return F===E?M:{...M,[C]:F}})},[]),Ae=v.useCallback(async(C,P,M)=>{const E=new URLSearchParams({offset:P.toString(),limit:M.toString()}),F=await Xt(`/api/supplies/${C}/payments?${E.toString()}`);if(!F.ok){const G=(await F.json().catch(()=>null))?.error||"Khng th ti lch s thanh ton.";throw new Error(G)}return await F.json()},[]),me=v.useCallback(async C=>{ne(C,P=>({...P,loading:!0,error:null}));try{const P=await Ae(C,0,cQ);ne(C,M=>({...M,pages:[P.payments||[]],currentPage:0,nextOffset:typeof P.nextOffset=="number"?P.nextOffset:P.payments?.length||0,hasMore:!!P.hasMore,loading:!1,error:null,initialized:!0}))}catch(P){console.error(P),ne(C,M=>({...M,loading:!1,error:P instanceof Error?P.message:"Khng th ti lch s thanh ton."}))}},[Ae,ne]),je=v.useCallback(async C=>{const P=b[C];if(!(!P||P.loading||!P.hasMore)){ne(C,M=>({...M,loading:!0,error:null}));try{const M=await Ae(C,Math.max(P.nextOffset,0),uQ);ne(C,E=>{const F=[...E.pages,M.payments||[]];return{...E,pages:F,currentPage:F.length-1,nextOffset:typeof M.nextOffset=="number"?M.nextOffset:E.nextOffset+(M.payments?.length||0),hasMore:!!M.hasMore,loading:!1,error:null}})}catch(M){console.error(M),ne(C,E=>({...E,loading:!1,error:M instanceof Error?M.message:"Khng th ti lch s thanh ton."}))}}},[Ae,b,ne]);v.useEffect(()=>{x!==null&&(b[x]||me(x))},[x,b,me]);const He=v.useCallback((C,P)=>{const M=b[C];if(!M)return;const E=Math.max(0,P);if(E<M.pages.length){ne(C,F=>({...F,currentPage:E}));return}E===M.pages.length&&M.hasMore&&!M.loading&&je(C)},[b,je,ne]),et=v.useCallback(C=>{S(P=>({...P,[C]:{round:P[C]?.round||"",totalImport:P[C]?.totalImport||"",paid:P[C]?.paid||"",status:P[C]?.status||"Cha Thanh Ton",isEditing:!0}}))},[]),Ue=v.useCallback(C=>{S(P=>({...P,[C]:{round:"",totalImport:"",paid:"",status:"Cha Thanh Ton",isEditing:!1}}))},[]),fe=v.useCallback((C,P,M)=>{S(E=>({...E,[C]:{round:E[C]?.round||"",totalImport:E[C]?.totalImport||"",paid:E[C]?.paid||"",status:E[C]?.status||"Cha Thanh Ton",isEditing:!0,[P]:M}}))},[]),ce=v.useCallback((C,P,M)=>{const F=z(M).replace(/[^\d]/g,"");fe(C,P,F)},[fe]),rt=v.useCallback(C=>{O(P=>({...P,[C.id]:String(Number.isFinite(C.totalImport)?C.totalImport:0)||"0"}))},[]),_t=v.useCallback((C,P)=>{const E=z(P).replace(/[^\d]/g,"");O(F=>({...F,[C]:E}))},[z]),yt=v.useCallback(C=>{O(P=>{const M={...P};return delete M[C],M}),j(P=>{const M={...P};return delete M[C],M})},[]),Bt=v.useCallback(async(C,P)=>{const M=D[P.id],E=Number((M||"").replace(/[^\d]/g,""));if(Number.isFinite(E)){j(F=>({...F,[P.id]:!0})),ne(C,F=>({...F,error:null}));try{const F=await Xt(`/api/supplies/${C}/payments/${P.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:E})});if(!F.ok){const G=await F.text().catch(()=>"");throw new Error(G?.trim()||"Khng th cp nht chu k thanh ton.")}const W=await F.json().catch(()=>({})),K=Number(W?.totalImport??W?.importValue??W?.import_value)||E;ne(C,G=>({...G,pages:G.pages.map(re=>re.map(se=>se.id===P.id?{...se,totalImport:K}:se))})),yt(P.id)}catch(F){console.error(F),ne(C,W=>({...W,error:F instanceof Error?F.message:"Khng th cp nht chu k thanh ton."}))}finally{j(F=>{const W={...F};return delete W[P.id],W})}}},[yt,D,ne]),Tt=v.useCallback(async C=>{const P=w[C];if(!P||!P.isEditing)return;const M=Number((P.totalImport||"").replace(/[^\d.-]/g,"")),E=Number((P.paid||"").replace(/[^\d.-]/g,"")),F={round:P.round.trim()||"Chu K Mi",totalImport:Number.isFinite(M)?M:0,paid:Number.isFinite(E)?E:0,status:P.status.trim()||"Cha Thanh Ton"};T(W=>({...W,[C]:!0})),ne(C,W=>({...W,error:null}));try{const W=await Xt(`/api/supplies/${C}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});if(!W.ok){const re=await W.text().catch(()=>"");throw new Error(re?.trim()||"Khng th ti lch s thanh ton.")}const K=await W.json(),G={id:K.id??Date.now(),round:K.round??F.round,totalImport:Number(K.totalImport)||F.totalImport,paid:Number(K.paid)||F.paid,status:K.status??F.status};ne(C,re=>{const se=re.pages.length?re.pages.map(Pe=>[...Pe]):[[]],de=se[0]?[...se[0]]:[];return se[0]=[G,...de],{...re,pages:se,currentPage:0,initialized:!0,error:null}}),S(re=>({...re,[C]:{round:"",totalImport:"",paid:"",status:"Cha Thanh Ton",isEditing:!1}}))}catch(W){console.error(W),ne(C,K=>({...K,error:W instanceof Error?W.message:"Khng th ti lch s thanh ton."}))}finally{T(W=>{const K={...W};return delete K[C],K})}},[w,ne]),dt=v.useCallback(()=>{ye({sourceName:"",numberBank:"",bankBin:R[0]?.bin||"",status:wv[0].value}),Ne(null),J(!0)},[R]),$t=v.useCallback(()=>{pe||J(!1)},[pe]),Qt=v.useCallback((C,P)=>{ye(M=>({...M,[C]:P}))},[]),Ut=v.useCallback(async C=>{C.preventDefault();const P=xe.sourceName.trim();if(!P){Ne("Vui lng nhp tn nh cung cp");return}if(!xe.bankBin){Ne("Vui lng chn ngn hng");return}Ie(!0),Ne(null);try{const M={sourceName:P,numberBank:xe.numberBank.trim(),bankBin:xe.bankBin,status:xe.status},E=await Xt("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!E.ok){let F="Khng th to nh cung cp.";try{const W=await E.json();W?.error&&(F=W.error)}catch{}throw new Error(F)}await Me(),$t()}catch(M){console.error(M),Ne(M instanceof Error?M.message:"Khng th to nh cung cp")}finally{Ie(!1)}},[$t,Me,xe]),Dr=v.useCallback(async C=>{Oe(P=>({...P,loading:!0,error:null}));try{const P=await Xt(`/api/supplies/${C}/overview`);if(!P.ok){const F=await P.text();throw new Error(F||"Khng th ti thng tin chi tit nh cung cp")}const M=await P.json(),E=hQ(M);Oe(F=>({...F,loading:!1,data:E,selectedPaymentId:E.unpaidPayments[0]?.id??null}))}catch(P){console.error(P),Oe(M=>({...M,loading:!1,error:P instanceof Error?P.message:"Khng th ti thng tin chi tit nh cung cp"}))}},[]),en=v.useCallback(C=>{Oe({isOpen:!0,loading:!0,error:null,supplyId:C,data:null,selectedPaymentId:null,confirming:!1,confirmError:null}),Dr(C)},[Dr]),Ur=v.useCallback(()=>{Oe({isOpen:!1,loading:!1,error:null,supplyId:null,data:null,selectedPaymentId:null,confirming:!1,confirmError:null})},[]),ca=v.useCallback(C=>{Oe(P=>({...P,selectedPaymentId:C,confirmError:null}))},[]),Yn=v.useCallback(async()=>{Oe(P=>({...P,confirmError:null,confirming:!0}));const C="Khng th ti lch s thanh ton.";try{const{supplyId:P,data:M,selectedPaymentId:E}=ge;if(!P||!M||!E)throw new Error(C);const F=M.unpaidPayments.find(K=>K.id===E);if(!F)throw new Error(C);const W=await Xt(`/api/payment-supply/${F.id}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paidAmount:F.totalImport})});if(!W.ok){const K=await W.text();throw new Error(K||"Khng th xc nhn  thanh ton")}await Dr(P),await Me()}catch(P){console.error(P),Oe(M=>({...M,confirmError:P instanceof Error?P.message:"Khng th xc nhn  thanh ton"}))}finally{Oe(P=>({...P,confirming:!1}))}},[Dr,Me,ge]),Xe=v.useCallback(C=>{he(C.id),Ge(null),U(!1),We({sourceName:C.sourceName||"",paymentInfo:C.numberBank||"",bankBin:C.binBank||""})},[]),St=v.useCallback(()=>{Te||(he(null),Ge(null))},[Te]),Ht=v.useCallback((C,P)=>{We(M=>({...M,[C]:P})),Ge(null)},[]),Rt=v.useMemo(()=>{const C=new Map;return R.forEach(P=>{P.bin&&C.set(P.bin.trim(),P.name||"")}),C},[R]),tn=v.useCallback(async C=>{if(C.preventDefault(),ie===null||Te)return;const P=a.find(K=>K.id===ie);if(!P){Ge("Khng tm thy nh cung cp.");return}const M=De.sourceName.trim();if(!M){Ge("Vui lng nhp tn ngun.");return}const E=De.paymentInfo.trim(),W=De.bankBin.trim()||P.binBank||"";U(!0),Ge(null);try{const K={sourceName:M,numberBank:E,bankBin:W,bankName:W&&Rt.has(W)?Rt.get(W):P.bankName},G=await Xt(`/api/supplies/${ie}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)});if(!G.ok){const de=await G.text();throw new Error(de||"Khng th cp nht thng tin nh cung cp.")}const re=await G.json().catch(()=>({})),se=re&&typeof re=="object"?re:{};i(de=>de.map(Pe=>Pe.id===ie?{...Pe,sourceName:se.sourceName??M,numberBank:"numberBank"in se?se.numberBank:E||null,binBank:"binBank"in se?se.binBank:W||null,bankName:"bankName"in se?se.bankName:W?Rt.get(W)||Pe.bankName||`BIN ${W}`:Pe.bankName??null}:Pe)),St()}catch(K){console.error(K),Ge(K instanceof Error?K.message:"Khng th cp nht nh cung cp.")}finally{U(!1)}},[Rt,St,De.bankBin,De.paymentInfo,De.sourceName,ie,Te,i,a]),zr=v.useCallback(async C=>{const P=tc(C),M=!P;X(E=>({...E,[C.id]:!0})),i(E=>E.map(F=>F.id===C.id?{...F,isActive:M,status:M?"active":"inactive"}:F));try{const E=await Xt(`/api/supplies/${C.id}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:M})});if(!E.ok){const K=await E.text();throw new Error(K||"Khng th cp nht trng thi")}const F=await E.json(),W=typeof F?.isActive=="boolean"?F.isActive:M;i(K=>K.map(G=>G.id===C.id?{...G,isActive:W,status:W?"active":"inactive"}:G))}catch(E){console.error("Khng th thay i trng thi:",E),alert(E instanceof Error?E.message:"Khng th cp nht trng thi"),i(F=>F.map(W=>W.id===C.id?{...W,isActive:P,status:P?"active":"inactive"}:W))}finally{X(E=>{const F={...E};return delete F[C.id],F})}},[]),ae=v.useCallback(C=>{_e({supply:C,loading:!1,error:null})},[]),Le=v.useCallback(()=>{_e({supply:null,loading:!1,error:null})},[]),Je=v.useCallback(async()=>{const C=Fe.supply;if(C){_e(P=>({...P,loading:!0,error:null})),ee(C.id);try{const P=await eQ(C.id);if(!P.success)throw new Error(P.message||Z1);i(M=>M.filter(E=>E.id!==C.id)),Le()}catch(P){console.error("Khng th xa:",P),_e(M=>({...M,loading:!1,error:P instanceof Error?nQ(P.message):Z1}))}finally{ee(null)}}},[Le,Fe.supply,i]),tt=(C,P,M=!1,E)=>{if(!P&&!M)return u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"px-6 py-4 text-sm text-white/80 text-center",children:"ang ti lch s thanh ton..."})});if(!C.length&&!M)return u.jsxs("tr",{children:[u.jsx("td",{colSpan:4,className:"px-6 py-4 text-sm text-white/80 text-center",children:"Cha c lch s thanh ton."}),u.jsx("td",{className:"px-4 py-4 text-center",children:u.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-dashed border-white/40 text-white/80 hover:border-blue-400 hover:text-blue-200 transition",title:"Thm chu k thanh ton",onClick:()=>E!==void 0&&et(E),children:u.jsx(Mi,{className:"h-5 w-5"})})})]});if(!C.length&&M)return null;const F=C.map(W=>{const K=D[W.id]!==void 0,G=D[W.id]??String(W.totalImport||""),re=z(G),se=I[W.id]===!0;return u.jsxs("tr",{className:"border-t border-white/10 text-sm text-white align-middle",children:[u.jsx("td",{className:"px-4 py-4 font-medium text-white text-left sm:text-center",children:W.round||"--"}),u.jsx("td",{className:"px-4 py-4 text-center",children:K?u.jsx("input",{type:"text",inputMode:"numeric",className:"w-full max-w-[180px] rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white focus:border-blue-400 focus:outline-none focus:ring-1 focus:ring-blue-300/60",value:re,onChange:de=>_t(W.id,de.target.value),disabled:se}):Ys(W.totalImport)}),u.jsx("td",{className:"px-4 py-4 text-center",children:Ys(W.paid)}),u.jsx("td",{className:"px-4 py-4 text-center text-white",children:W.status||"--"}),u.jsx("td",{className:"px-4 py-4 text-center",children:K?u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"h-9 w-9 rounded-full bg-emerald-500 text-white shadow hover:bg-emerald-600 transition disabled:opacity-60",title:"Xc nhn",disabled:se||E===void 0,onClick:()=>E!==void 0&&Bt(E,W),children:u.jsx(tl,{className:"h-5 w-5 mx-auto"})}),u.jsx("button",{type:"button",className:"h-9 w-9 rounded-full bg-rose-500 text-white shadow hover:bg-rose-600 transition disabled:opacity-60",title:"Hy",disabled:se,onClick:()=>yt(W.id),children:u.jsx(Tn,{className:"h-5 w-5 mx-auto"})})]}):u.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-white/40 text-white/80 hover:border-blue-400 hover:text-blue-200 transition disabled:opacity-60",title:"Sa tng tin nhp",disabled:E===void 0,onClick:()=>rt(W),children:u.jsx(U0,{className:"h-5 w-5"})})})]},W.id)});return!M&&E!==void 0&&F.push(u.jsxs("tr",{className:"border-t border-white/10 text-sm text-white",children:[u.jsx("td",{className:"px-4 py-4 text-left sm:text-center",colSpan:4,children:u.jsx("span",{className:"text-white/70",children:"Thm chu k thanh ton mi"})}),u.jsx("td",{className:"px-4 py-4 text-center",children:u.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-dashed border-white/40 text-white/80 hover:border-blue-400 hover:text-blue-200 transition",title:"Thm chu k thanh ton",onClick:()=>et(E),children:u.jsx(Mi,{className:"h-5 w-5"})})})]},"add-payment-row")),F},at=(C,P)=>{if(!P||!P.isEditing)return null;const M=A[C]===!0;return u.jsxs("tr",{className:"border-t border-white/10 text-sm text-white bg-gray-50/60",children:[u.jsx("td",{className:"px-4 py-3",children:u.jsx("input",{type:"text",className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-200",placeholder:"VD: Chu K 1",value:P.round,disabled:M,onChange:E=>fe(C,"round",E.target.value)})}),u.jsx("td",{className:"px-4 py-3",children:u.jsx("input",{type:"text",inputMode:"numeric",className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-200",placeholder:"Tng Tin Nhp",value:z(P.totalImport),disabled:M,onChange:E=>ce(C,"totalImport",E.target.value)})}),u.jsx("td",{className:"px-4 py-3",children:u.jsx("input",{type:"text",inputMode:"numeric",className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-200",placeholder:" Thanh Ton",value:z(P.paid),disabled:M,onChange:E=>ce(C,"paid",E.target.value)})}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("select",{className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-200",value:P.status,disabled:M,onChange:E=>fe(C,"status",E.target.value),children:[u.jsx("option",{value:"Chua Thanh To?n",children:"Chua Thanh To?n"}),u.jsx("option",{value:"Da Thanh To?n",children:"Da Thanh To?n"}),u.jsx("option",{value:"C?n Gia H?n",children:"C?n Gia H?n"})]})}),u.jsx("td",{className:"px-4 py-3",children:u.jsxs("div",{className:"flex items-center justify-center gap-2",children:[u.jsx("button",{type:"button",className:"h-9 w-9 rounded-full bg-emerald-500 text-white shadow hover:bg-emerald-600 transition",title:"X?c Nh?n",disabled:M,onClick:()=>Tt(C),children:u.jsx(tl,{className:"h-5 w-5 mx-auto"})}),u.jsx("button",{type:"button",className:"h-9 w-9 rounded-full bg-rose-500 text-white shadow hover:bg-rose-600 transition",title:"H?y",disabled:M,onClick:()=>Ue(C),children:u.jsx(Tn,{className:"h-5 w-5 mx-auto"})})]})})]})},gt=C=>{const P=b[C],M=P&&P.pages[P.currentPage]?P.pages[P.currentPage]:[],E=w[C],F=at(C,E),W=!!F,K=()=>{if(!P||!P.initialized)return null;const G=P.pages.length,re=P.currentPage>0,se=P.hasMore||P.currentPage<G-1;if(G<=1&&!P.hasMore)return null;const de=P.pages.map((Pe,we)=>u.jsx("button",{className:`w-9 h-9 rounded-lg text-sm font-medium transition ${P.currentPage===we?"bg-orange-500 text-white":"text-gray-600 hover:bg-indigo-500/15"}`,onClick:()=>He(C,we),disabled:P.loading&&P.currentPage===we,children:we+1},we));return u.jsxs("div",{className:"flex items-center justify-center gap-2 pt-4",children:[u.jsx("button",{className:"w-9 h-9 rounded-lg text-gray-500 hover:bg-indigo-500/15 disabled:opacity-40",onClick:()=>He(C,P.currentPage-1),disabled:!re,children:"<"}),de,P.hasMore&&u.jsx(u.Fragment,{children:u.jsx("span",{className:"text-gray-400 px-1",children:"..."})}),u.jsx("button",{className:"w-9 h-9 rounded-lg text-gray-500 hover:bg-indigo-500/15 disabled:opacity-40",onClick:()=>He(C,P.currentPage+1),disabled:!se,children:">"})]})};return u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-start justify-between gap-3",children:u.jsxs("div",{className:"flex-1 text-center text-white",children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Lch s thanh ton"}),u.jsx("p",{className:"text-xs text-white/80",children:"Theo di cc chu k thanh ton ca nh cung cp"})]})}),P?.loading&&u.jsx("div",{className:"text-center text-xs text-white/80",children:"ang ti..."}),P?.error&&u.jsx("div",{className:"text-center text-xs text-red-200",children:P.error}),u.jsx("div",{className:"flex justify-center",children:u.jsx("div",{className:"w-full max-w-4xl rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 shadow-lg overflow-hidden text-white backdrop-blur",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-white/5 text-[11px] uppercase text-white/80 tracking-wide",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left sm:text-center",children:"Chu K"}),u.jsx("th",{className:"px-6 py-3 text-center",children:"Tng Tin Nhp"}),u.jsx("th",{className:"px-6 py-3 text-center",children:" Thanh Ton"}),u.jsx("th",{className:"px-6 py-3 text-center",children:"Trng Thi"}),u.jsx("th",{className:"px-6 py-3 text-center",children:"Thao Tc"})]})}),u.jsxs("tbody",{children:[F,tt(M,!!P?.initialized,W,C)]})]})})}),K()]})},Nt=()=>{if(ie===null)return null;const C=a.find(F=>F.id===ie),P=De.bankBin.trim(),E=!!P&&R.some(F=>F.bin.trim()===P.trim())||!P?R:[{bin:P,name:C?.bankName||Rt.get(P)||`BIN ${P}`},...R];return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:St,children:u.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",onClick:F=>F.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Chnh Sa Nh Cung Cp"}),u.jsx("p",{className:"text-xs text-white/80",children:"Cp nht tn, ti khon v ngn hng"})]}),u.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:St,children:""})]}),u.jsxs("form",{className:"space-y-4",onSubmit:tn,children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn Ngun"}),u.jsx("input",{type:"text",value:De.sourceName,onChange:F=>Ht("sourceName",F.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"Nhp Tn Ngun",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S Ti Khon"}),u.jsx("input",{type:"text",value:De.paymentInfo,onChange:F=>Ht("paymentInfo",F.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"Nhp S Ti Khon"}),(C?.bankName||(C?.binBank?Rt.get(C.binBank.trim()):null))&&u.jsxs("p",{className:"mt-1 text-xs text-white/80",children:["Ngn Hng:"," ",C?.bankName||(C?.binBank?Rt.get(C.binBank.trim()):"")]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngn Hng"}),u.jsxs("select",{value:De.bankBin,onChange:F=>Ht("bankBin",F.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",children:[u.jsx("option",{value:"",disabled:!0,children:"Chn Ngn Hng"}),E.map(F=>u.jsx("option",{value:F.bin,children:F.name||`BIN ${F.bin}`},F.bin))]})]}),Ve&&u.jsx("p",{className:"text-sm text-red-500",children:Ve}),u.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-600 rounded-lg border border-gray-200 hover:bg-indigo-500/10",onClick:St,disabled:Te,children:"Hy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700",disabled:Te,children:Te?"ang Lu...":"Lu Thng Tin"})]})]})]})})},ir=()=>{const{supply:C,loading:P,error:M}=Fe;return C?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:()=>{P||Le()},children:u.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:E=>E.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-rose-500",children:"Xc Nhn Xa"}),u.jsx("p",{className:"text-xs text-slate-200",children:"Hnh ng ny s xa ngun khi d liu."})]}),u.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600 disabled:opacity-50",onClick:Le,disabled:P,children:""})]}),u.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-white",children:C.sourceName||"Ngun Khng Tn"}),u.jsx("p",{className:"text-xs text-slate-200",children:C.numberBank?`S Ti Khon: ${C.numberBank}`:"Cha C Thng Tin Thanh Ton"})]}),u.jsx("p",{children:"Bn chc chn mun xa ngun ny? Hnh ng khng th hon tc v nhng danh sch lin quan cng s b cp nht."})]}),M&&u.jsx("p",{className:"mt-4 text-xs text-red-500",children:M}),u.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-600 rounded-lg border border-gray-200 hover:bg-indigo-500/10 disabled:opacity-50",onClick:Le,disabled:P,children:"Hy"})," ",u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white bg-rose-600 rounded-lg hover:bg-rose-700 disabled:opacity-60",onClick:Je,disabled:P,children:P?"ang Xa...":"Xa NCC"})]})]})}):null},Dt=()=>{if(!ge.isOpen)return null;const C=ge.data?.supply,P=ge.data?.stats,M=ge.data?.unpaidPayments||[],E=M.find(we=>we.id===ge.selectedPaymentId)||null,F=C?.bankName||(C?.binBank?Rt.get(C.binBank.trim())||`BIN ${C.binBank}`:"Cha C Ngn Hng"),W=C?.numberBank||"",K=C?.sourceName||"",G=C?.binBank||"",re=E?.totalImport||0,se=E?.round||`SUPPLIER-${C?.id??""}`,de=W&&G?pb({accountNumber:W,bankCode:G,amount:Math.max(0,re),description:se}):null,Pe=[{title:"Tng n Hng",value:P?.totalOrders??0,accent:"sky",Icon:cR},{title:"n Hng Hy",value:P?.canceledOrders??0,accent:"rose",Icon:xy},{title:"n Thng Ny",value:P?.monthlyOrders??0,accent:"violet",Icon:dy},{title:"Tng Tin Thanh Ton",value:Ys(P?.totalPaidAmount??0),accent:"emerald",Icon:$0}];return u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 px-4 py-6",children:u.jsxs("div",{className:"w-full max-w-6xl bg-gradient-to-b from-[#0f132c] via-[#11183a] to-[#0b1025] border border-white/10 rounded-3xl shadow-2xl shadow-indigo-900/40 max-h-[95vh] flex flex-col overflow-hidden backdrop-blur-xl text-white",children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10 bg-white/5 backdrop-blur",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-white",children:"Thng tin NCC"}),C&&u.jsxs("p",{className:"text-xs text-white/60",children:["ID: ",C.id," | ",C.sourceName]})]}),u.jsx("button",{type:"button",className:"text-white/60 hover:text-white",onClick:Ur,children:u.jsx(Tn,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"px-6 py-5 overflow-y-auto space-y-6",children:[ge.loading&&u.jsx("div",{className:"text-center text-sm text-white/70",children:"ang ti thng tin..."}),ge.error&&!ge.loading&&u.jsx("div",{className:"text-center text-sm text-rose-400",children:ge.error}),!ge.loading&&!ge.error&&C&&u.jsxs(_i.Fragment,{children:[u.jsx("section",{className:"bg-white/5 border border-white/10 rounded-3xl p-6 shadow-xl backdrop-blur",children:u.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-stretch",children:[u.jsxs("div",{className:"flex-1 bg-white/5 rounded-3xl p-5 text-sm grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4 border border-white/10 shadow-lg",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Tn NCC"}),u.jsx("p",{className:"text-lg font-semibold text-white",children:C.sourceName||"Cha t Tn"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Trng Thi"}),u.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full mt-1 shadow ${aQ(C.isActive??C.status)}`,children:Xk(C.isActive??C.status)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"S Ti Khon"}),u.jsx("p",{className:"text-base font-semibold text-white",children:W||"Cha Cung Cp"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Ngn Hng"}),u.jsx("p",{className:"text-base font-semibold text-white",children:F})]})]}),u.jsx("div",{className:"flex-[1.4] rounded-3xl p-5 border border-white/10 shadow-lg bg-gradient-to-br from-white/5 via-white/0 to-white/5",children:u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Pe.map(we=>{const ke=we.Icon,$e=qk[we.accent]||qk.sky;return u.jsx("div",{className:"relative isolate rounded-3xl border border-white/10 bg-gradient-to-br from-white/10 via-white/5 to-white/10 px-5 py-4 shadow-[0_25px_65px_-40px_rgba(15,23,42,0.65)]",children:u.jsxs("div",{className:"relative flex items-center gap-4",children:[u.jsx("div",{className:`rounded-2xl bg-gradient-to-br ${$e.iconBg} p-3 text-white shadow-inner shadow-black/10`,children:u.jsx(ke,{className:"h-5 w-5"})}),u.jsxs("div",{className:"text-right flex-1",children:[u.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-white/60",children:we.title}),u.jsx("p",{className:"text-xl font-extrabold text-white",children:typeof we.value=="number"?we.value.toLocaleString("vi-VN"):we.value})]})]})},we.title)})})})]})}),u.jsxs("section",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:"Cc chu k cha thanh ton"}),u.jsx("p",{className:"text-xs text-white/80",children:"Chn mt chu k  xem chi tit v xc nhn"})]})}),M.length===0?u.jsx("div",{className:"text-sm text-white/70",children:"Khng c chu k cha thanh ton."}):u.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"space-y-3",children:M.map(we=>u.jsxs("button",{className:`w-full text-left rounded-2xl border px-4 py-3 transition backdrop-blur ${we.id===ge.selectedPaymentId?"border-indigo-400 bg-indigo-500/20 shadow-lg shadow-indigo-900/30 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/80"}`,onClick:()=>ca(we.id),children:[u.jsx("p",{className:"text-sm font-semibold text-white",children:we.round||"Chu k khng tn"}),u.jsxs("p",{className:"text-xs text-white/80",children:["Tin Nhp:"," ",Ys(we.totalImport)]})]},we.id))}),u.jsx("div",{className:"lg:col-span-2",children:E?u.jsxs("div",{className:"border border-white/15 rounded-2xl p-6 space-y-4 bg-white/5 shadow-xl backdrop-blur",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-white/70",children:"Thng tin chu k"}),u.jsx("p",{className:"text-lg font-semibold text-white",children:E.round||"Chu k khng tn"})]}),de?u.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[u.jsx("img",{src:de,alt:"M QR Thanh Ton",className:"w-60 h-auto rounded-lg shadow-lg shadow-black/30"}),u.jsx("p",{className:"text-xs text-white/80",children:"Qut m QR  thanh ton"})]}):u.jsx("div",{className:"text-sm text-white/70 text-center",children:"Cha  thng tin  to m QR (thiu ti khon hoc ngn hng)."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-white",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Ngn Hng"}),u.jsx("p",{className:"font-semibold text-white",children:F})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"S Ti Khon"}),u.jsx("p",{className:"font-semibold text-white",children:W||"Cha Cung Cp"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Ch ti khon / Ni dung"}),u.jsx("p",{className:"font-semibold text-white",children:K}),u.jsxs("p",{className:"text-xs text-white/70",children:["Ni dung: ",se]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white/60",children:"Tng Thanh Ton"}),u.jsx("p",{className:"font-semibold text-rose-300",children:Ys(re)})]})]}),ge.confirmError&&u.jsx("div",{className:"text-xs text-rose-400",children:ge.confirmError}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{className:"px-5 py-2 bg-gradient-to-r from-indigo-500 to-blue-500 text-white text-sm font-semibold rounded-lg hover:from-indigo-600 hover:to-blue-600 disabled:opacity-60 shadow-lg shadow-indigo-900/30",onClick:Yn,disabled:ge.confirming,children:ge.confirming?"ang Xc Nhn...":"Xc nhn Thanh Ton"})})]}):u.jsx("div",{className:"border border-dashed border-white/20 rounded-2xl p-8 text-center text-sm text-white/70 bg-white/5",children:"Chn mt chu k thanh ton  xem chi tit."})})]})]})]})]})]})})},rr=()=>V?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:$t,children:u.jsxs("div",{className:"w-full max-w-lg rounded-2xl bg-white p-6 shadow-2xl",onClick:C=>C.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Thm NCC"}),u.jsx("p",{className:"text-xs text-white/80",children:"Nhp thng tin NCC mi"})]}),u.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:$t,children:""})]}),u.jsxs("form",{className:"space-y-4",onSubmit:Ut,children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn NCC"}),u.jsx("input",{type:"text",value:xe.sourceName,onChange:C=>Qt("sourceName",C.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"Nhp Tn NCC",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S Ti Khon"}),u.jsx("input",{type:"text",value:xe.numberBank,onChange:C=>Qt("numberBank",C.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",placeholder:"Nhp S Ti Khon"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngn Hng"}),u.jsxs("select",{value:xe.bankBin,onChange:C=>Qt("bankBin",C.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",children:[u.jsx("option",{value:"",disabled:!0,children:"Chn Ngn Hng"}),R.map(C=>{const P=C.name||`BIN ${C.bin}`;return u.jsx("option",{value:C.bin,children:P},C.bin)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trng Thi"}),u.jsx("select",{value:xe.status,onChange:C=>Qt("status",C.target.value),className:"w-full rounded-lg border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-200",children:wv.map(C=>u.jsx("option",{value:C.value,children:C.label},C.value))})]}),ue&&u.jsx("div",{className:"text-xs text-red-500",children:ue}),u.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[u.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-600 rounded-lg border border-gray-200 hover:bg-indigo-500/10",onClick:$t,disabled:pe,children:"Hy"}),u.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-70",disabled:pe,children:pe?"ang Lu...":"Thm NCC"})]})]})]})}):null;v.useEffect(()=>{Me()},[Me]),v.useEffect(()=>{(async()=>{try{const P=await Xt("/api/banks");if(!P.ok)throw new Error("Khng th ti danh sch ngn hng");const M=await P.json(),E=Array.isArray(M)?M.map(F=>({bin:sr(F,["bin",H1.bin],""),name:sr(F,["name",H1.bankName],"")})):[];q(E),ye(F=>({...F,bankBin:F.bankBin||E[0]?.bin||""}))}catch(P){console.error(P)}})()},[]);const L=v.useMemo(()=>{const C=oQ(e);return a.filter(M=>{const E=!C||M.sourceName.toLowerCase().includes(C)||(M.bankName||"").toLowerCase().includes(C)||(M.numberBank||"").toLowerCase().includes(C)||M.products.some(W=>W.toLowerCase().includes(C)),F=r==="all"||(r==="active"?tc(M):!tc(M));return E&&F}).sort(lQ)},[a,e,r]),Y=v.useMemo(()=>[{name:"Tng",value:s.totalSuppliers.toString(),accent:Yr.sky,Icon:LR},{name:"Hnh ng",value:s.activeSuppliers.toString(),accent:Yr.emerald,Icon:wc},{name:"Tng n",value:s.monthlyOrders.toString(),accent:Yr.violet,Icon:my},{name:"Tng Thanh Ton",value:rQ(s.totalImportValue),accent:Yr.amber,Icon:$0}],[s]);return u.jsxs(_i.Fragment,{children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bng Thng Tin Ngun"}),u.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Qun l thng tin nh cung cp"})]}),u.jsx("div",{className:"mt-4 sm:mt-0",children:u.jsx(Bi,{icon:Mi,onClick:dt,children:"Thm NCC"})})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Y.map(C=>u.jsx(Oc,{title:C.name,value:C.value,icon:C.Icon,accent:C.accent},C.name))})}),u.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-gradient-to-r from-white/5 via-white/0 to-white/5 p-5 shadow-[0_30px_80px_-45px_rgba(0,0,0,0.8)]",children:[u.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-r from-indigo-400/10 via-transparent to-blue-400/10 blur-3xl"}),u.jsxs("div",{className:"relative grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx(gl,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"}),u.jsx("input",{type:"text",placeholder:"Tm kim nh cung cp...",className:"w-full rounded-full border border-white/15 bg-white/10 px-4 py-3 pl-10 text-sm text-white placeholder:text-white/50 shadow-inner shadow-black/20 focus:outline-none focus:ring-2 focus:ring-indigo-400/60 focus:border-indigo-300",value:e,onChange:C=>t(C.target.value)})]}),u.jsxs("select",{className:"w-full rounded-full border border-white/15 bg-white/10 px-4 py-3 text-sm text-white shadow-inner shadow-black/20 focus:outline-none focus:ring-2 focus:ring-indigo-400/60 focus:border-indigo-300",value:r,onChange:C=>n(C.target.value),children:[u.jsx("option",{value:"all",children:"Trng Thi"}),u.jsx("option",{value:"active",children:"ang Hot ng"}),u.jsx("option",{value:"inactive",children:"Tm Dng"})]}),u.jsx(Bi,{className:"w-full justify-center rounded-full shadow-lg shadow-indigo-900/30",type:"button",children:"Xut Danh Sch"})]}),d&&u.jsx("div",{className:"relative mt-2 text-sm text-rose-400",children:d})]}),u.jsx("div",{className:"bg-white/10 border border-white/10 rounded-xl shadow-lg overflow-hidden w-full backdrop-blur",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"Nh Cung Cp"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"Ti Khon"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"S n thng"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"n hng cui"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:" Thanh Ton"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"Cn N"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap "}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider whitespace-nowrap",children:"Thao Tc"})]})}),u.jsxs("tbody",{className:"bg-white/5 divide-y divide-white/10",children:[f&&u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/80",children:"ang ti d liu"})}),!f&&L.map(C=>{const P=x===C.id;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70 cursor-pointer transition",onClick:()=>Re(C.id),children:[u.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[u.jsx("div",{className:"text-sm font-medium text-white",children:C.sourceName||"Cha C Tn"}),u.jsxs("div",{className:"text-xs text-white/70",children:["Tng n: ",C.totalOrders]})]}),u.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[u.jsx("div",{className:"text-sm text-white",children:C.numberBank||"Cha C Ti Khon"}),u.jsx("div",{className:"text-xs text-white/70",children:C.bankName||(C.binBank?Rt.get(C.binBank.trim())||`BIN ${C.binBank}`:"Cha C Ngn Hng")})]}),u.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[u.jsxs("div",{className:"text-sm text-white",children:[C.monthlyOrders," n"]}),u.jsx("div",{className:"text-xs text-white/70",children:Ys(C.monthlyImportValue)})]}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white/80",children:iQ(C.lastOrderDate)}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white/80",children:Ys(C.totalPaidImport)}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white/80",children:Ys(C.totalUnpaidImport)}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:u.jsx("div",{className:"flex justify-center",children:u.jsx("button",{type:"button",onClick:M=>{M.stopPropagation(),zr(C)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${tc(C)?"border-emerald-200 bg-emerald-500 text-white":"border-gray-200 bg-gray-200 text-gray-500"} ${H[C.id]?"opacity-60 cursor-not-allowed":""}`,"aria-pressed":tc(C),disabled:!!H[C.id],title:Xk(C.isActive??C.status),children:u.jsx(u4,{className:"h-4 w-4"})})})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center justify-end gap-3 text-sm font-medium",children:[u.jsxs("button",{className:"text-blue-600 hover:text-blue-900",onClick:M=>{M.stopPropagation(),en(C.id)},"aria-label":"Xem chi tit",children:[u.jsx(nf,{className:"h-5 w-5"}),u.jsx("span",{className:"sr-only",children:"Xem"})]}),u.jsxs("button",{className:"text-green-600 hover:text-green-900",onClick:M=>{M.stopPropagation(),Xe(C)},"aria-label":"Chnh Sa",children:[u.jsx(U0,{className:"h-5 w-5"}),u.jsx("span",{className:"sr-only",children:"Chnh Sa"})]}),u.jsxs("button",{className:`text-rose-500 hover:text-rose-700 ${Z===C.id?"opacity-60 cursor-not-allowed":""}`,onClick:M=>{M.stopPropagation(),ae(C)},"aria-label":"Xa Nh Cung Cp",disabled:Z===C.id,children:[u.jsx(rl,{className:"h-5 w-5"}),u.jsx("span",{className:"sr-only",children:"Xa"})]})]})})]}),P&&u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"px-4 pb-6",children:u.jsx("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-gray-50 p-4",children:u.jsx("div",{className:"rounded-2xl border border-gray-100 bg-white shadow-sm px-6 py-5",children:gt(C.id)})})})})]},C.id)})]})]})})})]}),Dt(),rr(),Nt(),ir()]})}const mQ="/assets/sign-DzA7EGyE.png",xQ={};var gQ={};const vQ="/mavryk-logo.png",bv=e=>e.toLocaleString("vi-VN"),yQ=e=>{const t=Number(e);return Number.isFinite(t)?t:0},wQ=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},v0=e=>(e||"").trim().toLowerCase(),y0=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},Qk=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),a=[],i=(c,f)=>{if(c.nodeType===Node.TEXT_NODE){f.push((c.textContent||"").replace(/\u00a0/g," "));return}if(c.nodeType===Node.ELEMENT_NODE){const h=c;if(h.tagName==="BR"){f.push(`
`);return}const d=[];h.childNodes.forEach(x=>i(x,d));const m=d.join("");f.push(m),n.has(h.tagName)&&f.push(`
`)}},s=[];return r.body.childNodes.forEach(c=>i(c,s)),s.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e}},Jk=typeof import.meta<"u"&&xQ?.VITE_API_BASE_URL||gQ.VITE_API_BASE_URL||"http://localhost:3001",bQ=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},zu="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60";function _Q(){v.useEffect(()=>{const j=document.title;return document.title="Mavryk Premium Store",()=>{document.title=j}},[]);const[e,t]=v.useState(new Date().toISOString().slice(0,10)),[r,n]=v.useState("Ms. Diu Nguyen"),[a,i]=v.useState(""),[s,c]=v.useState([]),[f,h]=v.useState([]),[d,m]=v.useState([]),[x,g]=v.useState([]),b=v.useMemo(()=>{const j=x.map(R=>({...R,total:(R.unitPrice-(R.discount||0))*R.quantity})),z=j.reduce((R,q)=>R+q.total,0);return{rows:j,grandTotal:z}},[x]);v.useEffect(()=>{let j=!0;return(async()=>{try{const q=await fetch(`${Jk}${It.PRODUCT_PRICES}`,{credentials:"include"});if(!q.ok)throw new Error("Failed to load product_price");const V=await q.json();j&&V?.items&&Array.isArray(V.items)&&c(V.items)}catch(q){console.error("Khng th ti product_price:",q)}})(),(async()=>{try{const q=await fetch(`${Jk}${It.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!q.ok)throw new Error("Failed to load product_desc");const V=await q.json();j&&V?.items&&Array.isArray(V.items)&&h(V.items.map(J=>({productId:J.productId||J.product_id||"",rules:J.rules??"",description:J.description??""})))}catch(q){console.error("Khng th ti product_desc:",q)}})(),()=>{j=!1}},[]);const _=v.useMemo(()=>{const j=new Set,z=[];return s.forEach(R=>{const V=(R?.[mn.product]||R?.san_pham||"").trim();if(!V)return;const J=V.toLowerCase();if(j.has(J))return;j.add(J);const ue=wQ(V),Ne=yQ(R?.computed_retail_price??R?.retail_price??R?.gia_le??R?.gia_ban)||0,pe=R?.[mn.packageProduct]||R?.package_product||R?.package_product_label||"",Ie=pe?`${pe} (${V})`:R?.package?`${R?.package} (${V})`:V;z.push({productId:V,value:V,productDisplay:R?.package||V,packageDisplay:pe||R?.package||V,label:Ie,durationMonths:ue.months,durationDays:ue.days,term:ue.days?`${ue.days} ngy`:"",unitPrice:Ne})}),z.sort((R,q)=>R.label.localeCompare(q.label,"vi"))},[s]),w=v.useMemo(()=>{const j=new Map;return _.forEach(z=>{j.set(z.value.toLowerCase(),z)}),j},[_]),S=v.useMemo(()=>{const j=new Map;return s.forEach(z=>{const R=z?.[mn.product]||z?.san_pham||"",q=z?.[mn.packageProduct]||z?.package_product||z?.package_product_label||"",V=v0(y0(R));V&&q&&j.set(V,q)}),j},[s]),A=v.useMemo(()=>{const j=new Map;return f.forEach(z=>{const R=v0(y0(z.productId));R&&j.set(R,z)}),j},[f]),T=v.useMemo(()=>{const j=new Set,z=[];return x.forEach(R=>{const q=R.productCode||R.product||"",V=v0(y0(q));if(!V||j.has(V))return;j.add(V);const J=A.get(V);S.get(V)||R.packageName||R.product,z.push({name:R.product,rules:Qk(J?.rules),description:Qk(J?.description)})}),z},[x,A,S]),D=()=>{if(!d.length)return;const j=d.map(z=>z.trim()).filter(Boolean);j.length&&(g(z=>{const R=[...z];return j.forEach(q=>{const V=w.get(q.toLowerCase())??w.get(q.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),J=(R.length+1).toString(),ue=V?.durationDays?`${V.durationDays} ngy`:V?.term||"";R.push({id:J,productCode:q,product:V?.productDisplay||q,packageName:V?.packageDisplay||S.get(v0(y0(q)))||"",term:ue,durationMonths:V?.durationMonths??null,durationDays:V?.durationDays??null,unitPrice:V?.unitPrice??0,quantity:1,discount:0})}),R}),m([]))},O=j=>g(z=>z.filter(R=>R.id!==j)),I=`BG-${(e||"").replaceAll("-","")||"----"}`;return u.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[u.jsx("style",{children:SQ}),u.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[u.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thng tin bo gi"})}),u.jsxs("div",{className:"px-6 py-5 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Knh gi"}),u.jsx("input",{type:"text",value:r,onChange:j=>n(j.target.value),className:zu})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Ngy"}),u.jsx("input",{type:"date",value:e,onChange:j=>t(j.target.value),className:zu})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"M bo gi"}),u.jsx("input",{value:I,readOnly:!0,className:`${zu} opacity-80`})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Lin h"}),u.jsx("input",{type:"text",value:a,onChange:j=>i(j.target.value),className:zu,placeholder:"Email / SDT"})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi ch (ty chn)"}),u.jsx("input",{type:"text",className:zu,placeholder:"Thng tin thm cho bo gi"})]})]}),u.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[u.jsx("label",{className:"text-sm font-semibold text-white block",children:"M sn phm"}),u.jsx("p",{className:"text-xs text-white/70",children:"Click  chn / b chn, khng cn gi Ctrl / Cmd."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:_.map(j=>{const z=d.includes(j.value);return u.jsx("button",{type:"button",onClick:()=>m(R=>R.includes(j.value)?R.filter(q=>q!==j.value):[...R,j.value]),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${z?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:j.label,children:j.label},j.value)})}),u.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[u.jsx("button",{type:"button",onClick:D,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!d.length,children:"Thm"}),u.jsx("button",{type:"button",onClick:()=>window.print(),className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),x.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.map(j=>u.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[j.product,u.jsx("button",{type:"button",onClick:()=>O(j.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xa",children:""})]},j.id))})]})]})]}),u.jsx("div",{className:"print-wrapper flex justify-center",children:u.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[u.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:u.jsx("img",{src:vQ,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:j=>{j.currentTarget.style.display="none"}})}),u.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),u.jsx("p",{children:"SDT: 0378.304.963"}),u.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),u.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BNG BO GI"}),u.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800",children:[u.jsxs("p",{children:["Ngy: ",u.jsx("strong",{children:bQ(e)||"..."})]}),u.jsxs("p",{children:["Knh gi: ",u.jsx("strong",{children:r})]}),a?u.jsxs("p",{children:["Thng tin lin h: ",u.jsx("strong",{children:a})]}):null,u.jsx("p",{className:"mt-3 italic",children:"Li u tin, xin trn trng cm n qu khch hng  quan tm n sn phm ca chng ti. Chng ti xin gi n qu khch hng bng bo gi chi tit nh sau:"})]}),u.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[u.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),u.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TN SN PHM"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THI GIAN"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"N GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIM GI"}),u.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THNH TIN"}),u.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CH"})]})}),u.jsx("tbody",{children:b.rows.map((j,z)=>u.jsxs("tr",{className:"align-top",children:[u.jsx("td",{className:"border border-slate-600 text-center py-2",children:z+1}),u.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:j.product,children:j.product}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:j.packageName||j.term}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:j.durationMonths?`${j.durationMonths} thng`:j.durationDays?`${j.durationDays} ngy`:j.term||"--"}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:bv(j.unitPrice)}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:bv(j.discount||0)}),u.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:bv(j.total)}),u.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:j.note||""})]},j.id))})]}),u.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[T.length===0?u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Quy Tc"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Cha cp nht."}),u.jsx("p",{className:"font-semibold mt-3",children:"Thng tin sn phm"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Cha cp nht."})]}):T.map(j=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"font-semibold",children:j.name}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Quy Tc"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:j.rules||"Cha cp nht."})]}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"Thng tin sn phm"}),u.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:j.description||"Cha cp nht."})]})]},j.name)),u.jsxs("div",{className:"pt-2 text-sm",children:[u.jsx("p",{className:"font-semibold",children:"Mi thng tin chi tit c th lin h:"}),u.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Ti Khon Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]}),u.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:u.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[u.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),u.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(K, ghi r h tn)"}),u.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:u.jsx("img",{src:mQ,alt:"Ch k",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:j=>{j.currentTarget.style.display="none"}})})]})})]})})})]})}const SQ=`
  /* Hide scrollbars while keeping scroll functionality */
  body {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  body::-webkit-scrollbar {
    display: none;
  }

  @media print {
    /* Hide everything except the printable quote */
    body { background: white !important; margin: 0 !important; padding: 0 !important; }
    body * { visibility: hidden !important; }
    #quote-print-area,
    #quote-print-area * { visibility: visible !important; }
    #quote-print-area {
      position: absolute;
      left: 0;
      top: 0;
      box-shadow: none !important;
      border: none !important;
    }
    .no-print { display: none !important; }
    .print-wrapper { margin: 0 !important; padding: 0 !important; }
  }
`,NQ={};var EQ={};let eC=0;const TQ=e=>(eC+=1,{id:`inv-${Date.now().toString(36)}-${eC.toString(36)}`,code:e}),tC=typeof import.meta<"u"&&NQ?.VITE_API_BASE_URL||EQ.VITE_API_BASE_URL||"http://localhost:3001",w0=e=>(e||"").trim().toLowerCase(),rC=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},kQ=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith("MAVC")?"MAVC":t.startsWith("MAVL")?"MAVL":t.startsWith("MAVK")?"MAVK":t.startsWith("MAVT")?"MAVT":null},_v=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},CQ=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},rc={name:"MAVRYK PREMIUM",address:"Phan Vn Tr, Phng 11, Qun Bnh Thnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ng L Ngc Hng"},AQ={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},Sv="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",Nv=e=>`${e.toLocaleString("vi-VN")} `;function jQ(){v.useEffect(()=>{const R=document.title;return document.title="Mavryk Premium Store",()=>{document.title=R}},[]);const[e,t]=v.useState(AQ),[r,n]=v.useState([]),[a,i]=v.useState(null),[s,c]=v.useState([]),[f,h]=v.useState([]),d=v.useId(),m="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",x="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",g="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",b=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${Sv};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${Sv} !important;
      }
    }
  `;v.useEffect(()=>{let R=!0;const q=async()=>{try{const J=await fetch(`${tC}${It.ORDERS}`,{credentials:"include"});if(!J.ok)throw new Error("Failed to load orders");const ue=await J.json();R&&Array.isArray(ue)&&c(ue)}catch(J){console.error("Khng th ti d liu order_list:",J)}},V=async()=>{try{const J=await fetch(`${tC}${It.PRODUCT_PRICES}`,{credentials:"include"});if(!J.ok)throw new Error("Failed to load product_price");const ue=await J.json();R&&ue?.items&&Array.isArray(ue.items)&&h(ue.items)}catch(J){console.error("Khng th ti d liu product_price:",J)}};return q(),V(),()=>{R=!1}},[]);const _=v.useMemo(()=>{const R=new Map;return s.forEach(q=>{const V=w0(q?.[wr.idOrder]);V&&R.set(V,q)}),R},[s]),w=v.useMemo(()=>{const R=new Map;return f.forEach(q=>{const V=w0(q?.[mn.product]);V&&R.set(V,q)}),R},[f]),S=v.useMemo(()=>r.map(R=>{const q=_.get(w0(R.code)),V=w0(q?.[wr.idProduct]),J=w.get(V),ue=kQ(q?.[wr.idOrder]||R.code),Ne=rC(q?.[wr.idProduct])||rC(J?.[mn.product]),pe=Ne?`${Ne} thng`:"",Ie=J?.[mn.packageProduct]||J?.[mn.package]||q?.[wr.idProduct]||R.code,xe=pe?`${Ie} ${pe}`:Ie,ye=_v(J?.computed_wholesale_price)||_v(q?.[wr.price]),ge=_v(J?.computed_retail_price)||ye;let Oe=ge;ue==="MAVC"?Oe=ye:ue==="MAVT"?Oe=0:ue==="MAVL"||ue==="MAVK"?Oe=ge:Oe=ge||ye;const ie=ue==="MAVK"?CQ(J?.[mn.pctPromo]):0,he=Number((ie*100).toFixed(2)),De=1,We=Math.max(0,Oe*De*(1-ie));return{id:R.id,code:R.code,description:xe,unitPrice:Oe,quantity:De,discountPct:he,total:We}}),[r,_,w]),A=v.useMemo(()=>({subtotal:S.reduce((q,V)=>q+V.total,0)}),[S]),T=v.useMemo(()=>{if(!e.invoiceDate)return"..... thng ..... nm 20..";const R=new Date(e.invoiceDate);return Number.isNaN(R.getTime())?"..... thng ..... nm 20..":new Intl.DateTimeFormat("vi-VN").format(R)},[e.invoiceDate]),D=(R,q)=>{t(V=>({...V,[R]:q}))},O=()=>{const R=e.invoiceCode.trim();R&&(n(q=>q.some(V=>V.code===R)?q:[...q,TQ(R)]),t(q=>({...q,invoiceCode:""})))},I=R=>{n(q=>q.filter(V=>V.id!==R))},j=R=>{R.preventDefault()},z=()=>{window.print()};return u.jsxs("div",{className:"space-y-6 print-wrapper",children:[u.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[u.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thng tin ha n"})}),u.jsxs("form",{className:"px-6 py-5 space-y-4",onSubmit:j,children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{htmlFor:d,className:"text-sm font-medium text-slate-100",children:"Ha n"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:x,onMouseLeave:()=>i(null),children:r.map(R=>u.jsxs("button",{type:"button",onClick:()=>I(R.id),onMouseEnter:()=>i(R.id),onMouseLeave:()=>i(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xa ha n ${R.code}`,children:[u.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:R.code}),u.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${a===R.id?"bg-white/20 text-red-500":""}`,children:u.jsx(Tn,{className:"h-4 w-4"})})]},R.id))}),u.jsx("div",{className:g,children:u.jsx("input",{id:d,type:"text",onMouseEnter:()=>i(null),onFocus:()=>i(null),onBlur:()=>i(null),value:e.invoiceCode,onChange:R=>D("invoiceCode",R.target.value),onKeyDown:R=>{R.key==="Enter"&&(R.preventDefault(),O())},className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhp m ha n v nhn Enter"})})]})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngy"}),u.jsx("input",{type:"date",value:e.invoiceDate,onChange:R=>D("invoiceDate",R.target.value),className:m})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"M s thu"}),u.jsx("input",{type:"text",value:e.taxCode,onChange:R=>D("taxCode",R.target.value),className:m})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khch hng / Cng ty"}),u.jsx("input",{type:"text",value:e.customerName,onChange:R=>D("customerName",R.target.value),className:m})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),u.jsx("input",{type:"text",value:e.fax,onChange:R=>D("fax",R.target.value),className:m})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"a ch"}),u.jsx("textarea",{value:e.address,onChange:R=>D("address",R.target.value),rows:2,className:`${m} resize-none`})]}),u.jsxs("label",{className:"space-y-1",children:[u.jsx("span",{className:"text-sm font-medium text-slate-100",children:"ST"}),u.jsx("input",{type:"text",value:e.phone,onChange:R=>D("phone",R.target.value),className:m})]})]}),u.jsx("div",{className:"pt-2",children:u.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cp nht thng tin"})})]})]}),u.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[u.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trc & ti v"})}),u.jsxs("div",{className:"p-6",children:[u.jsx("style",{children:b}),u.jsx("div",{id:"invoice-print-area",children:u.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:Sv},children:[u.jsxs("div",{className:"text-center leading-7",children:[u.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:rc.name}),u.jsxs("p",{children:["a ch: ",rc.address]}),u.jsxs("p",{children:["in thoi: ",rc.phone]}),u.jsxs("p",{children:["Ngn hng: ",rc.bank]}),u.jsxs("p",{children:["STK: ",rc.accountNumber]}),u.jsxs("p",{children:["Tn ngi nhn: ",rc.receiver]})]}),u.jsx("div",{className:"my-4 h-px bg-slate-300"}),u.jsxs("div",{className:"text-center space-y-2 leading-7",children:[u.jsx("h2",{className:"text-xl font-bold uppercase",children:"HA N BN HNG"}),u.jsx("div",{className:"text-sm",children:u.jsxs("p",{children:["Ngy: ",T]})})]}),u.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"Khch hng: "}),e.customerName||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"a ch: "}),e.address||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",u.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"M s Thu: "}),e.taxCode||"---"]})]}),u.jsx("div",{className:"mt-8 px-2",children:u.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:u.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tn hng ha / Dch v"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"n gi"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chit khu"}),u.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thnh tin"})]})}),u.jsx("tbody",{children:S.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Cha c m ha n no c chn."})}):S.map(R=>u.jsxs("tr",{children:[u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:u.jsx("div",{className:"font-semibold",children:R.description})}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Nv(R.unitPrice)}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:R.quantity}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${R.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),u.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Nv(R.total)})]},R.id))})]})})}),u.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tng tin hng: ",Nv(A.subtotal)]}),u.jsx("div",{className:"mt-8 text-center text-sm italic",children:"Cm n v hn gp li!"})]})}),u.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:u.jsxs("button",{type:"button",onClick:z,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[u.jsx(B6,{className:"h-5 w-5"}),"Download PDF"]})})]})]})]})}var Ph={};Ph.version="0.20.3";var as=1200,gf=function(e){as=e};function PQ(){gf(1200)}var b0=function(t){return String.fromCharCode(t)},nC=function(t){return String.fromCharCode(t)},zn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Oh(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0,h=0;h<e.length;)r=e.charCodeAt(h++),i=r>>2,n=e.charCodeAt(h++),s=(r&3)<<4|n>>4,a=e.charCodeAt(h++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=zn.charAt(i)+zn.charAt(s)+zn.charAt(c)+zn.charAt(f);return t}function OQ(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0,h=0;h<e.length;)r=e.charCodeAt(h++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(h++),n>255&&(n=95),s=(r&3)<<4|n>>4,a=e.charCodeAt(h++),a>255&&(a=95),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=zn.charAt(i)+zn.charAt(s)+zn.charAt(c)+zn.charAt(f);return t}function DQ(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0,h=0;h<e.length;)r=e[h++],i=r>>2,n=e[h++],s=(r&3)<<4|n>>4,a=e[h++],c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=zn.charAt(i)+zn.charAt(s)+zn.charAt(c)+zn.charAt(f);return t}function ho(e){var t="",r=0,n=0,a=0,i=0,s=0,c=0,f=0;if(e.slice(0,5)=="data:"){var h=e.slice(0,1024).indexOf(";base64,");h>-1&&(e=e.slice(h+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)i=zn.indexOf(e.charAt(h++)),s=zn.indexOf(e.charAt(h++)),r=i<<2|s>>4,t+=String.fromCharCode(r),c=zn.indexOf(e.charAt(h++)),n=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),f=zn.indexOf(e.charAt(h++)),a=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var qt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Hi=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),Dh=(function(){if(typeof Buffer>"u")return!1;var e=Hi([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function dl(e){return qt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function aC(e){return qt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ia=function(t){return qt?Hi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Lp(e){if(typeof ArrayBuffer>"u")return Ia(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function hl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function IQ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Gr=qt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Hi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(Ia(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function RQ(e){for(var t=[],r=0,n=e.length+250,a=dl(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|c>>6&15|(s&3)<<4,a[r++]=128|c&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=dl(65535),n=65530)}return t.push(a.slice(0,r)),Gr(t)}var qu=/\u0000/g,_0=/[\u0001-\u0006]/g;function hc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function bi(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}function vb(e,t){var r=""+e;return r.length>=t?r:_r(" ",t-r.length)+r}function Ih(e,t){var r=""+e;return r.length>=t?r:r+_r(" ",t-r.length)}function FQ(e,t){var r=""+Math.round(e);return r.length>=t?r:_r("0",t-r.length)+r}function MQ(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}var iC=Math.pow(2,32);function nc(e,t){if(e>iC||e<-iC)return FQ(e,t);var r=Math.round(e);return MQ(r,t)}function Rh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ev=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function LQ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var xr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},BQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Fh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,c=0,f=1,h=0,d=0,m=Math.floor(a);h<t&&(m=Math.floor(a),c=m*s+i,d=m*h+f,!(a-m<5e-8));)a=1/(a-m),i=s,s=c,f=h,h=d;if(d>t&&(h>t?(d=f,c=i):(d=h,c=s)),!r)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function $Q(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+_r("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+_r("0",t.length-15);return Number(n)}function ac(e,t,r){if(e>2958465||e<0)return null;e=$Q(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),s=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=VQ(f,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}function yb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function UQ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zQ(e){var t=e<0?12:11,r=yb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function HQ(e){var t=yb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function WQ(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=zQ(e):t===10?r=e.toFixed(10).substr(0,12):r=HQ(e),yb(UQ(r.toUpperCase()))}function Q1(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):WQ(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gs(14,An(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function VQ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function KQ(e,t,r,n){var a="",i=0,s=0,c=r.y,f,h=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,h=t.length;break;case 3:return Ev[r.m-1][1];case 5:return Ev[r.m-1][0];default:return Ev[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,h=t.length;break;case 3:return sC[r.q][0];default:return sC[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?bi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=bi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:f=c,h=1;break}var d=h>0?bi(f,h):"";return d}function ro(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var EO=/%/g;function GQ(e,t,r){var n=t.replace(EO,""),a=t.length-n.length;return cs(e,n,r*Math.pow(10,2*a))+_r("%",a)}function YQ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function TO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+TO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var kO=/# (\?+)( ?)\/( ?)(\d+)/;function XQ(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(s===0?_r(" ",e[1].length+1+e[4].length):vb(s,e[1].length)+e[2]+"/"+e[3]+bi(c,e[4].length))}function qQ(e,t,r){return r+(t===0?"":""+t)+_r(" ",e[1].length+2+e[4].length)}var CO=/^#*0*\.([0#]+)/,AO=/\)[^)]*[0#]/,jO=/\(###\) ###\\?-####/;function ea(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function lC(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function cC(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ZQ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function QQ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ja(e,t,r){if(e.charCodeAt(0)===40&&!t.match(AO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ja("n",n,r):"("+Ja("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YQ(e,t,r);if(t.indexOf("%")!==-1)return GQ(e,t,r);if(t.indexOf("E")!==-1)return TO(t,r);if(t.charCodeAt(0)===36)return"$"+Ja(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+nc(f,t.length);if(t.match(/^[#?]+$/))return a=nc(r,0),a==="0"&&(a=""),a.length>t.length?a:ea(t.substr(0,t.length-a.length))+a;if(i=t.match(kO))return XQ(i,f,h);if(t.match(/^#+0+$/))return h+nc(f,t.length-t.indexOf("0"));if(i=t.match(CO))return a=lC(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ea(i[1])).replace(/\.$/,"."+ea(i[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+_r("0",ea(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+lC(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+ro(nc(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ja(e,t,-r):ro(""+(Math.floor(r)+ZQ(r,i[1].length)))+"."+bi(cC(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ja(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hc(Ja(e,t.replace(/[\\-]/g,""),r)),s=0,hc(hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(jO))return a=Ja(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=Fh(f,Math.pow(10,s)-1,!1),a=""+h,d=cs("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Ih(c[2],s),d.length<i[4].length&&(d=ea(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=Fh(f,Math.pow(10,s)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?vb(c[1],s)+i[2]+"/"+i[3]+Ih(c[2],s):_r(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=nc(r,0),t.length<=a.length?a:ea(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return ea(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=cC(r,i[1].length),r<0?"-"+Ja(e,t,-r):ro(QQ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?bi(0,3-b.length):"")+b})+"."+bi(s,i[1].length);switch(t){case"###,##0.00":return Ja(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=ro(nc(f,0));return g!=="0"?h+g:"";case"###,###.00":return Ja(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ja(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function JQ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return cs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function eJ(e,t,r){var n=t.replace(EO,""),a=t.length-n.length;return cs(e,n,r*Math.pow(10,2*a))+_r("%",a)}function PO(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+PO(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(AO)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pi("n",n,r):"("+Pi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return JQ(e,t,r);if(t.indexOf("%")!==-1)return eJ(e,t,r);if(t.indexOf("E")!==-1)return PO(t,r);if(t.charCodeAt(0)===36)return"$"+Pi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+bi(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:ea(t.substr(0,t.length-a.length))+a;if(i=t.match(kO))return qQ(i,f,h);if(t.match(/^#+0+$/))return h+bi(f,t.length-t.indexOf("0"));if(i=t.match(CO))return a=(""+r).replace(/^([^\.]+)$/,"$1."+ea(i[1])).replace(/\.$/,"."+ea(i[1])),a=a.replace(/\.(\d*)$/,function(b,_){return"."+_+_r("0",ea(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+ro(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pi(e,t,-r):ro(""+r)+"."+_r("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Pi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hc(Pi(e,t.replace(/[\\-]/g,""),r)),s=0,hc(hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(jO))return a=Pi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=Fh(f,Math.pow(10,s)-1,!1),a=""+h,d=cs("n",i[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Ih(c[2],s),d.length<i[4].length&&(d=ea(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=Fh(f,Math.pow(10,s)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?vb(c[1],s)+i[2]+"/"+i[3]+Ih(c[2],s):_r(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:ea(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var m=t.indexOf(".")-s,x=t.length-a.length-m;return ea(t.substr(0,m)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pi(e,t,-r):ro(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?bi(0,3-b.length):"")+b})+"."+bi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=ro(""+f);return g!=="0"?h+g:"";default:if(t.match(/\.[0#?]*$/))return Pi(e,t.slice(0,t.lastIndexOf(".")),r)+ea(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function cs(e,t,r){return(r|0)===r?Pi(e,t,r):Ja(e,t,r)}function tJ(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var OO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Rh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(OO))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function rJ(e,t,r,n){for(var a=[],i="",s=0,c="",f="t",h,d,m,x="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!Rh(e,s))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(m=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(m);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=e.charAt(++s),b=g==="("||g===")"?g:"t";a[a.length]={t:b,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(h==null&&(h=ac(t,r,e.charAt(s+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},f=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=ac(t,r),h==null))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),a[a.length]={t:c,v:i},f=c;break;case"A":case"a":case"":var _={t:c,v:c};if(h==null&&(h=ac(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?e.charAt(s+2):c),_.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",s+=5,x="h"):(_.t="t",++s),h==null&&_.t==="T")return"";a[a.length]=_,f=c;break;case"[":for(i=c;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(OO)){if(h==null&&(h=ac(t,r),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",pl(e)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=c;++s<e.length&&(c=e.charAt(s))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;a[a.length]={t:c,v:i},f=c;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++s;break}var w=0,S=0,A;for(s=a.length-1,f="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=x,f="h",w<1&&(w=1);break;case"s":(A=a[s].v.match(/\.0+$/))&&(S=Math.max(S,A[0].length-1),w=4),w<3&&(w=3);case"d":case"y":case"e":f=a[s].t;break;case"M":f=a[s].t,w<2&&(w=2);break;case"m":f==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}var T;switch(w){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=ac(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break;case 4:switch(S){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=ac(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break}var D="",O;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=KQ(a[s].t.charCodeAt(0),a[s].v,h,S),a[s].t="t";break;case"n":case"?":for(O=s+1;a[O]!=null&&((c=a[O].t)==="?"||c==="D"||(c===" "||c==="t")&&a[O+1]!=null&&(a[O+1].t==="?"||a[O+1].t==="t"&&a[O+1].v==="/")||a[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[O].v==="/"||a[O].v===" "&&a[O+1]!=null&&a[O+1].t=="?"));)a[s].v+=a[O].v,a[O]={v:"",t:";"},++O;D+=a[s].v,s=O-1;break;case"G":a[s].t="t",a[s].v=Q1(t,r);break}var I="",j,z;if(D.length>0){D.charCodeAt(0)==40?(j=t<0&&D.charCodeAt(0)===45?-t:t,z=cs("n",D,j)):(j=t<0&&n>1?-t:t,z=cs("n",D,j),j<0&&a[0]&&a[0].t=="t"&&(z=z.substr(1),a[0].v="-"+a[0].v)),O=z.length-1;var R=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){R=s;break}var q=a.length;if(R===a.length&&z.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(O>=a[s].v.length-1?(O-=a[s].v.length,a[s].v=z.substr(O+1,a[s].v.length)):O<0?a[s].v="":(a[s].v=z.substr(0,O+1),O=-1),a[s].t="t",q=s);O>=0&&q<a.length&&(a[q].v=z.substr(0,O+1)+a[q].v)}else if(R!==a.length&&z.indexOf("E")===-1){for(O=z.indexOf(".")-1,s=R;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===R?a[s].v.indexOf(".")-1:a[s].v.length-1,I=a[s].v.substr(d+1);d>=0;--d)O>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(I=z.charAt(O--)+I);a[s].v=I,a[s].t="t",q=s}for(O>=0&&q<a.length&&(a[q].v=z.substr(0,O+1)+a[q].v),O=z.indexOf(".")+1,s=R;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==R)){for(d=a[s].v.indexOf(".")>-1&&s===R?a[s].v.indexOf(".")+1:0,I=a[s].v.substr(0,d);d<a[s].v.length;++d)O<z.length&&(I+=z.charAt(O++));a[s].v=I,a[s].t="t",q=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(j=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=cs(a[s].t,a[s].v,j),a[s].t="t");var V="";for(s=0;s!==a.length;++s)a[s]!=null&&(V+=a[s].v);return V}var uC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function fC(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function nJ(e,t){var r=tJ(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(uC),c=r[1].match(uC);return fC(t,s)?[n,r[0]]:fC(t,c)?[n,r[1]]:[n,r[s!=null&&c!=null?2:1]]}return[n,i]}function gs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xr)[e],n==null&&(n=r.table&&r.table[oC[e]]||xr[oC[e]]),n==null&&(n=BQ[e]||"General");break}if(Rh(n,0))return Q1(t,r);t instanceof Date&&(t=An(t,r.date1904));var a=nJ(n,t);if(Rh(a[1]))return Q1(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return rJ(a[1],t,r,a[0])}function DO(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xr[r]==null){t<0&&(t=r);continue}if(xr[r]==e){t=r;break}}t<0&&(t=391)}return xr[t]=e,t}function Bp(e){for(var t=0;t!=392;++t)e[t]!==void 0&&DO(e[t],t)}function $p(){xr=LQ()}var Mh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aJ(e){var t=typeof e=="number"?xr[e]:e;return t=t.replace(Mh,"(\\d+)"),Mh.lastIndex=0,new RegExp("^"+t+"$")}function iJ(e,t,r){var n=-1,a=-1,i=-1,s=-1,c=-1,f=-1;(t.match(Mh)||[]).forEach(function(m,x){var g=parseInt(r[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":f=g;break;case"m":s>=0?c=g:a=g;break}}),Mh.lastIndex=0,f>=0&&c==-1&&a>=0&&(c=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return s==-1&&c==-1&&f==-1?h:n==-1&&a==-1&&i==-1?d:h+"T"+d}var sJ={"d.m":"d\\.m"};function oJ(e,t){return DO(sJ[e]||e,t)}var dC=(function(){var e={};e.version="1.2.0";function t(){for(var j=0,z=new Array(256),R=0;R!=256;++R)j=R,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,z[R]=j;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(j){var z=0,R=0,q=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)V[q]=j[q];for(q=0;q!=256;++q)for(R=j[q],z=256+q;z<4096;z+=256)R=V[z]=R>>>8^j[R&255];var J=[];for(q=1;q!=16;++q)J[q-1]=typeof Int32Array<"u"&&typeof V.subarray=="function"?V.subarray(q*256,q*256+256):V.slice(q*256,q*256+256);return J}var a=n(r),i=a[0],s=a[1],c=a[2],f=a[3],h=a[4],d=a[5],m=a[6],x=a[7],g=a[8],b=a[9],_=a[10],w=a[11],S=a[12],A=a[13],T=a[14];function D(j,z){for(var R=z^-1,q=0,V=j.length;q<V;)R=R>>>8^r[(R^j.charCodeAt(q++))&255];return~R}function O(j,z){for(var R=z^-1,q=j.length-15,V=0;V<q;)R=T[j[V++]^R&255]^A[j[V++]^R>>8&255]^S[j[V++]^R>>16&255]^w[j[V++]^R>>>24]^_[j[V++]]^b[j[V++]]^g[j[V++]]^x[j[V++]]^m[j[V++]]^d[j[V++]]^h[j[V++]]^f[j[V++]]^c[j[V++]]^s[j[V++]]^i[j[V++]]^r[j[V++]];for(q+=15;V<q;)R=R>>>8^r[(R^j[V++])&255];return~R}function I(j,z){for(var R=z^-1,q=0,V=j.length,J=0,ue=0;q<V;)J=j.charCodeAt(q++),J<128?R=R>>>8^r[(R^J)&255]:J<2048?(R=R>>>8^r[(R^(192|J>>6&31))&255],R=R>>>8^r[(R^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,ue=j.charCodeAt(q++)&1023,R=R>>>8^r[(R^(240|J>>8&7))&255],R=R>>>8^r[(R^(128|J>>2&63))&255],R=R>>>8^r[(R^(128|ue>>6&15|(J&3)<<4))&255],R=R>>>8^r[(R^(128|ue&63))&255]):(R=R>>>8^r[(R^(224|J>>12&15))&255],R=R>>>8^r[(R^(128|J>>6&63))&255],R=R>>>8^r[(R^(128|J&63))&255]);return~R}return e.table=r,e.bstr=D,e.buf=O,e.str=I,e})(),or=(function(){var t={};t.version="1.2.2";function r(L,Y){for(var C=L.split("/"),P=Y.split("/"),M=0,E=0,F=Math.min(C.length,P.length);M<F;++M){if(E=C[M].length-P[M].length)return E;if(C[M]!=P[M])return C[M]<P[M]?-1:1}return C.length-P.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(0,Y+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var Y=L.lastIndexOf("/");return Y===-1?L:L.slice(Y+1)}function i(L,Y){typeof Y=="string"&&(Y=new Date(Y));var C=Y.getHours();C=C<<6|Y.getMinutes(),C=C<<5|Y.getSeconds()>>>1,L.write_shift(2,C);var P=Y.getFullYear()-1980;P=P<<4|Y.getMonth()+1,P=P<<5|Y.getDate(),L.write_shift(2,P)}function s(L){var Y=L.read_shift(2)&65535,C=L.read_shift(2)&65535,P=new Date,M=C&31;C>>>=5;var E=C&15;C>>>=4,P.setMilliseconds(0),P.setFullYear(C+1980),P.setMonth(E-1),P.setDate(M);var F=Y&31;Y>>>=5;var W=Y&63;return Y>>>=6,P.setHours(Y),P.setMinutes(W),P.setSeconds(F<<1),P}function c(L){ta(L,0);for(var Y={},C=0;L.l<=L.length-4;){var P=L.read_shift(2),M=L.read_shift(2),E=L.l+M,F={};switch(P){case 21589:C=L.read_shift(1),C&1&&(F.mtime=L.read_shift(4)),M>5&&(C&2&&(F.atime=L.read_shift(4)),C&4&&(F.ctime=L.read_shift(4))),F.mtime&&(F.mt=new Date(F.mtime*1e3));break;case 1:{var W=L.read_shift(4),K=L.read_shift(4);F.usz=K*Math.pow(2,32)+W,W=L.read_shift(4),K=L.read_shift(4),F.csz=K*Math.pow(2,32)+W}break}L.l=E,Y[P]=F}return Y}var f;function h(){return f||(f=lJ)}function d(L,Y){if(L[0]==80&&L[1]==75)return Xe(L,Y);if((L[0]|32)==109&&(L[1]|32)==105)return tt(L,Y);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var C=3,P=512,M=0,E=0,F=0,W=0,K=0,G=[],re=L.slice(0,512);ta(re,0);var se=m(re);switch(C=se[0],C){case 3:P=512;break;case 4:P=4096;break;case 0:if(se[1]==0)return Xe(L,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}P!==512&&(re=L.slice(0,P),ta(re,28));var de=L.slice(0,P);x(re,C);var Pe=re.read_shift(4,"i");if(C===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);re.l+=4,F=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),W=re.read_shift(4,"i"),M=re.read_shift(4,"i"),K=re.read_shift(4,"i"),E=re.read_shift(4,"i");for(var we=-1,ke=0;ke<109&&(we=re.read_shift(4,"i"),!(we<0));++ke)G[ke]=we;var $e=g(L,P);w(K,E,$e,P,G);var ht=A($e,F,G,P);F<ht.length&&(ht[F].name="!Directory"),M>0&&W!==ue&&(ht[W].name="!MiniFAT"),ht[G[0]].name="!FAT",ht.fat_addrs=G,ht.ssz=P;var xt={},kt=[],kr=[],Cr=[];T(F,ht,$e,kt,M,xt,kr,W),b(kr,Cr,kt),kt.shift();var jt={FileIndex:kr,FullPaths:Cr};return Y&&Y.raw&&(jt.raw={header:de,sectors:$e}),jt}function m(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(Ne,"Header Signature: "),L.l+=16;var Y=L.read_shift(2,"u");return[L.read_shift(2,"u"),Y]}function x(L,Y){var C=9;switch(L.l+=2,C=L.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function g(L,Y){for(var C=Math.ceil(L.length/Y)-1,P=[],M=1;M<C;++M)P[M-1]=L.slice(M*Y,(M+1)*Y);return P[C-1]=L.slice(C*Y),P}function b(L,Y,C){for(var P=0,M=0,E=0,F=0,W=0,K=C.length,G=[],re=[];P<K;++P)G[P]=re[P]=P,Y[P]=C[P];for(;W<re.length;++W)P=re[W],M=L[P].L,E=L[P].R,F=L[P].C,G[P]===P&&(M!==-1&&G[M]!==M&&(G[P]=G[M]),E!==-1&&G[E]!==E&&(G[P]=G[E])),F!==-1&&(G[F]=P),M!==-1&&P!=G[P]&&(G[M]=G[P],re.lastIndexOf(M)<W&&re.push(M)),E!==-1&&P!=G[P]&&(G[E]=G[P],re.lastIndexOf(E)<W&&re.push(E));for(P=1;P<K;++P)G[P]===P&&(E!==-1&&G[E]!==E?G[P]=G[E]:M!==-1&&G[M]!==M&&(G[P]=G[M]));for(P=1;P<K;++P)if(L[P].type!==0){if(W=P,W!=G[W])do W=G[W],Y[P]=Y[W]+"/"+Y[P];while(W!==0&&G[W]!==-1&&W!=G[W]);G[P]=-1}for(Y[0]+="/",P=1;P<K;++P)L[P].type!==2&&(Y[P]+="/")}function _(L,Y,C){for(var P=L.start,M=L.size,E=[],F=P;C&&M>0&&F>=0;)E.push(Y.slice(F*J,F*J+J)),M-=J,F=Vo(C,F*4);return E.length===0?be(0):Gr(E).slice(0,L.size)}function w(L,Y,C,P,M){var E=ue;if(L===ue){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var F=C[L],W=(P>>>2)-1;if(!F)return;for(var K=0;K<W&&(E=Vo(F,K*4))!==ue;++K)M.push(E);Y>=1&&w(Vo(F,P-4),Y-1,C,P,M)}}function S(L,Y,C,P,M){var E=[],F=[];M||(M=[]);var W=P-1,K=0,G=0;for(K=Y;K>=0;){M[K]=!0,E[E.length]=K,F.push(L[K]);var re=C[Math.floor(K*4/P)];if(G=K*4&W,P<4+G)throw new Error("FAT boundary crossed: "+K+" 4 "+P);if(!L[re])break;K=Vo(L[re],G)}return{nodes:E,data:yC([F])}}function A(L,Y,C,P){var M=L.length,E=[],F=[],W=[],K=[],G=P-1,re=0,se=0,de=0,Pe=0;for(re=0;re<M;++re)if(W=[],de=re+Y,de>=M&&(de-=M),!F[de]){K=[];var we=[];for(se=de;se>=0;){we[se]=!0,F[se]=!0,W[W.length]=se,K.push(L[se]);var ke=C[Math.floor(se*4/P)];if(Pe=se*4&G,P<4+Pe)throw new Error("FAT boundary crossed: "+se+" 4 "+P);if(!L[ke]||(se=Vo(L[ke],Pe),we[se]))break}E[de]={nodes:W,data:yC([K])}}return E}function T(L,Y,C,P,M,E,F,W){for(var K=0,G=P.length?2:0,re=Y[L].data,se=0,de=0,Pe;se<re.length;se+=128){var we=re.slice(se,se+128);ta(we,64),de=we.read_shift(2),Pe=Eb(we,0,de-G),P.push(Pe);var ke={name:Pe,type:we.read_shift(1),color:we.read_shift(1),L:we.read_shift(4,"i"),R:we.read_shift(4,"i"),C:we.read_shift(4,"i"),clsid:we.read_shift(16),state:we.read_shift(4,"i"),start:0,size:0},$e=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);$e!==0&&(ke.ct=D(we,we.l-8));var ht=we.read_shift(2)+we.read_shift(2)+we.read_shift(2)+we.read_shift(2);ht!==0&&(ke.mt=D(we,we.l-8)),ke.start=we.read_shift(4,"i"),ke.size=we.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=ue,ke.name=""),ke.type===5?(K=ke.start,M>0&&K!==ue&&(Y[K].name="!StreamData")):ke.size>=4096?(ke.storage="fat",Y[ke.start]===void 0&&(Y[ke.start]=S(C,ke.start,Y.fat_addrs,Y.ssz)),Y[ke.start].name=ke.name,ke.content=Y[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:K!==ue&&ke.start!==ue&&Y[K]&&(ke.content=_(ke,Y[K].data,(Y[W]||{}).data))),ke.content&&ta(ke.content,0),E[Pe]=ke,F.push(ke)}}function D(L,Y){return new Date((Fa(L,Y+4)/1e7*Math.pow(2,32)+Fa(L,Y)/1e7-11644473600)*1e3)}function O(L,Y){return h(),d(f.readFileSync(L),Y)}function I(L,Y){var C=Y&&Y.type;switch(C||qt&&Buffer.isBuffer(L)&&(C="buffer"),C||"base64"){case"file":return O(L,Y);case"base64":return d(Ia(ho(L)),Y);case"binary":return d(Ia(L),Y)}return d(L,Y)}function j(L,Y){var C=Y||{},P=C.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=P+"/",L.FileIndex[0]={name:P,type:5}),C.CLSID&&(L.FileIndex[0].clsid=C.CLSID),z(L)}function z(L){var Y="Sh33tJ5";if(!or.find(L,"/"+Y)){var C=be(4);C[0]=55,C[1]=C[3]=50,C[2]=54,L.FileIndex.push({name:Y,type:2,content:C,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+Y),R(L)}}function R(L,Y){j(L);for(var C=!1,P=!1,M=L.FullPaths.length-1;M>=0;--M){var E=L.FileIndex[M];switch(E.type){case 0:P?C=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(E.R*E.L*E.C)&&(C=!0),E.R>-1&&E.L>-1&&E.R==E.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!Y)){var F=new Date(1987,1,19),W=0,K=Object.create?Object.create(null):{},G=[];for(M=0;M<L.FullPaths.length;++M)K[L.FullPaths[M]]=!0,L.FileIndex[M].type!==0&&G.push([L.FullPaths[M],L.FileIndex[M]]);for(M=0;M<G.length;++M){var re=n(G[M][0]);for(P=K[re];!P;){for(;n(re)&&!K[n(re)];)re=n(re);G.push([re,{name:a(re).replace("/",""),type:1,clsid:Ie,ct:F,mt:F,content:null}]),K[re]=!0,re=n(G[M][0]),P=K[re]}}for(G.sort(function(Pe,we){return r(Pe[0],we[0])}),L.FullPaths=[],L.FileIndex=[],M=0;M<G.length;++M)L.FullPaths[M]=G[M][0],L.FileIndex[M]=G[M][1];for(M=0;M<G.length;++M){var se=L.FileIndex[M],de=L.FullPaths[M];if(se.name=a(de).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||Ie,M===0)se.C=G.length>1?1:-1,se.size=0,se.type=5;else if(de.slice(-1)=="/"){for(W=M+1;W<G.length&&n(L.FullPaths[W])!=de;++W);for(se.C=W>=G.length?-1:W,W=M+1;W<G.length&&n(L.FullPaths[W])!=n(de);++W);se.R=W>=G.length?-1:W,se.type=1}else n(L.FullPaths[M+1]||"")==n(de)&&(se.R=M+1),se.type=2}}}function q(L,Y){var C=Y||{};if(C.fileType=="mad")return at(L,C);switch(R(L),C.fileType){case"zip":return Ht(L,C)}var P=(function(Pe){for(var we=0,ke=0,$e=0;$e<Pe.FileIndex.length;++$e){var ht=Pe.FileIndex[$e];if(ht.content){var xt=ht.content.length;xt>0&&(xt<4096?we+=xt+63>>6:ke+=xt+511>>9)}}for(var kt=Pe.FullPaths.length+3>>2,kr=we+7>>3,Cr=we+127>>7,jt=kr+ke+kt+Cr,Ot=jt+127>>7,vr=Ot<=109?0:Math.ceil((Ot-109)/127);jt+Ot+vr+127>>7>Ot;)vr=++Ot<=109?0:Math.ceil((Ot-109)/127);var Ft=[1,vr,Ot,Cr,kt,ke,we,0];return Pe.FileIndex[0].size=we<<6,Ft[7]=(Pe.FileIndex[0].start=Ft[0]+Ft[1]+Ft[2]+Ft[3]+Ft[4]+Ft[5])+(Ft[6]+7>>3),Ft})(L),M=be(P[7]<<9),E=0,F=0;{for(E=0;E<8;++E)M.write_shift(1,pe[E]);for(E=0;E<8;++E)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),E=0;E<3;++E)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,P[2]),M.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:ue),M.write_shift(4,P[3]),M.write_shift(-4,P[1]?P[0]-1:ue),M.write_shift(4,P[1]),E=0;E<109;++E)M.write_shift(-4,E<P[2]?P[1]+E:-1)}if(P[1])for(F=0;F<P[1];++F){for(;E<236+F*127;++E)M.write_shift(-4,E<P[2]?P[1]+E:-1);M.write_shift(-4,F===P[1]-1?ue:F+1)}var W=function(Pe){for(F+=Pe;E<F-1;++E)M.write_shift(-4,E+1);Pe&&(++E,M.write_shift(-4,ue))};for(F=E=0,F+=P[1];E<F;++E)M.write_shift(-4,xe.DIFSECT);for(F+=P[2];E<F;++E)M.write_shift(-4,xe.FATSECT);W(P[3]),W(P[4]);for(var K=0,G=0,re=L.FileIndex[0];K<L.FileIndex.length;++K)re=L.FileIndex[K],re.content&&(G=re.content.length,!(G<4096)&&(re.start=F,W(G+511>>9)));for(W(P[6]+7>>3);M.l&511;)M.write_shift(-4,xe.ENDOFCHAIN);for(F=E=0,K=0;K<L.FileIndex.length;++K)re=L.FileIndex[K],re.content&&(G=re.content.length,!(!G||G>=4096)&&(re.start=F,W(G+63>>6)));for(;M.l&511;)M.write_shift(-4,xe.ENDOFCHAIN);for(E=0;E<P[4]<<2;++E){var se=L.FullPaths[E];if(!se||se.length===0){for(K=0;K<17;++K)M.write_shift(4,0);for(K=0;K<3;++K)M.write_shift(4,-1);for(K=0;K<12;++K)M.write_shift(4,0);continue}re=L.FileIndex[E],E===0&&(re.start=re.size?re.start-1:ue);var de=E===0&&C.root||re.name;if(de.length>31&&(console.error("Name "+de+" will be truncated to "+de.slice(0,31)),de=de.slice(0,31)),G=2*(de.length+1),M.write_shift(64,de,"utf16le"),M.write_shift(2,G),M.write_shift(1,re.type),M.write_shift(1,re.color),M.write_shift(-4,re.L),M.write_shift(-4,re.R),M.write_shift(-4,re.C),re.clsid)M.write_shift(16,re.clsid,"hex");else for(K=0;K<4;++K)M.write_shift(4,0);M.write_shift(4,re.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,re.start),M.write_shift(4,re.size),M.write_shift(4,0)}for(E=1;E<L.FileIndex.length;++E)if(re=L.FileIndex[E],re.size>=4096)if(M.l=re.start+1<<9,qt&&Buffer.isBuffer(re.content))re.content.copy(M,M.l,0,re.size),M.l+=re.size+511&-512;else{for(K=0;K<re.size;++K)M.write_shift(1,re.content[K]);for(;K&511;++K)M.write_shift(1,0)}for(E=1;E<L.FileIndex.length;++E)if(re=L.FileIndex[E],re.size>0&&re.size<4096)if(qt&&Buffer.isBuffer(re.content))re.content.copy(M,M.l,0,re.size),M.l+=re.size+63&-64;else{for(K=0;K<re.size;++K)M.write_shift(1,re.content[K]);for(;K&63;++K)M.write_shift(1,0)}if(qt)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function V(L,Y){var C=L.FullPaths.map(function(K){return K.toUpperCase()}),P=C.map(function(K){var G=K.split("/");return G[G.length-(K.slice(-1)=="/"?2:1)]}),M=!1;Y.charCodeAt(0)===47?(M=!0,Y=C[0].slice(0,-1)+Y):M=Y.indexOf("/")!==-1;var E=Y.toUpperCase(),F=M===!0?C.indexOf(E):P.indexOf(E);if(F!==-1)return L.FileIndex[F];var W=!E.match(_0);for(E=E.replace(qu,""),W&&(E=E.replace(_0,"!")),F=0;F<C.length;++F)if((W?C[F].replace(_0,"!"):C[F]).replace(qu,"")==E||(W?P[F].replace(_0,"!"):P[F]).replace(qu,"")==E)return L.FileIndex[F];return null}var J=64,ue=-2,Ne="d0cf11e0a1b11ae1",pe=[208,207,17,224,161,177,26,225],Ie="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(L,Y,C){h();var P=q(L,C);f.writeFileSync(Y,P)}function ge(L){for(var Y=new Array(L.length),C=0;C<L.length;++C)Y[C]=String.fromCharCode(L[C]);return Y.join("")}function Oe(L,Y){var C=q(L,Y);switch(Y&&Y.type||"buffer"){case"file":return h(),f.writeFileSync(Y.filename,C),C;case"binary":return typeof C=="string"?C:ge(C);case"base64":return Oh(typeof C=="string"?C:ge(C));case"buffer":if(qt)return Buffer.isBuffer(C)?C:Hi(C);case"array":return typeof C=="string"?Ia(C):C}return C}var ie;function he(L){try{var Y=L.InflateRaw,C=new Y;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)ie=L;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function De(L,Y){if(!ie)return ca(L,Y);var C=ie.InflateRaw,P=new C,M=P._processChunk(L.slice(L.l),P._finishFlushFlag);return L.l+=P.bytesRead,M}function We(L){return ie?ie.deflateRawSync(L):Tt(L)}var Ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(L){var Y=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var H=typeof Uint8Array<"u",X=H?new Uint8Array(256):[],Z=0;Z<256;++Z)X[Z]=U(Z);function ee(L,Y){var C=X[L&255];return Y<=8?C>>>8-Y:(C=C<<8|X[L>>8&255],Y<=16?C>>>16-Y:(C=C<<8|X[L>>16&255],C>>>24-Y))}function Fe(L,Y){var C=Y&7,P=Y>>>3;return(L[P]|(C<=6?0:L[P+1]<<8))>>>C&3}function _e(L,Y){var C=Y&7,P=Y>>>3;return(L[P]|(C<=5?0:L[P+1]<<8))>>>C&7}function Me(L,Y){var C=Y&7,P=Y>>>3;return(L[P]|(C<=4?0:L[P+1]<<8))>>>C&15}function Re(L,Y){var C=Y&7,P=Y>>>3;return(L[P]|(C<=3?0:L[P+1]<<8))>>>C&31}function ne(L,Y){var C=Y&7,P=Y>>>3;return(L[P]|(C<=1?0:L[P+1]<<8))>>>C&127}function Ae(L,Y,C){var P=Y&7,M=Y>>>3,E=(1<<C)-1,F=L[M]>>>P;return C<8-P||(F|=L[M+1]<<8-P,C<16-P)||(F|=L[M+2]<<16-P,C<24-P)||(F|=L[M+3]<<24-P),F&E}function me(L,Y,C){var P=Y&7,M=Y>>>3;return P<=5?L[M]|=(C&7)<<P:(L[M]|=C<<P&255,L[M+1]=(C&7)>>8-P),Y+3}function je(L,Y,C){var P=Y&7,M=Y>>>3;return C=(C&1)<<P,L[M]|=C,Y+1}function He(L,Y,C){var P=Y&7,M=Y>>>3;return C<<=P,L[M]|=C&255,C>>>=8,L[M+1]=C,Y+8}function et(L,Y,C){var P=Y&7,M=Y>>>3;return C<<=P,L[M]|=C&255,C>>>=8,L[M+1]=C&255,L[M+2]=C>>>8,Y+16}function Ue(L,Y){var C=L.length,P=2*C>Y?2*C:Y+5,M=0;if(C>=Y)return L;if(qt){var E=aC(P);if(L.copy)L.copy(E);else for(;M<L.length;++M)E[M]=L[M];return E}else if(H){var F=new Uint8Array(P);if(F.set)F.set(L);else for(;M<C;++M)F[M]=L[M];return F}return L.length=P,L}function fe(L){for(var Y=new Array(L),C=0;C<L;++C)Y[C]=0;return Y}function ce(L,Y,C){var P=1,M=0,E=0,F=0,W=0,K=L.length,G=H?new Uint16Array(32):fe(32);for(E=0;E<32;++E)G[E]=0;for(E=K;E<C;++E)L[E]=0;K=L.length;var re=H?new Uint16Array(K):fe(K);for(E=0;E<K;++E)G[M=L[E]]++,P<M&&(P=M),re[E]=0;for(G[0]=0,E=1;E<=P;++E)G[E+16]=W=W+G[E-1]<<1;for(E=0;E<K;++E)W=L[E],W!=0&&(re[E]=G[W+16]++);var se=0;for(E=0;E<K;++E)if(se=L[E],se!=0)for(W=ee(re[E],P)>>P-se,F=(1<<P+4-se)-1;F>=0;--F)Y[W|F<<se]=se&15|E<<4;return P}var rt=H?new Uint16Array(512):fe(512),_t=H?new Uint16Array(32):fe(32);if(!H){for(var yt=0;yt<512;++yt)rt[yt]=0;for(yt=0;yt<32;++yt)_t[yt]=0}(function(){for(var L=[],Y=0;Y<32;Y++)L.push(5);ce(L,_t,32);var C=[];for(Y=0;Y<=143;Y++)C.push(8);for(;Y<=255;Y++)C.push(9);for(;Y<=279;Y++)C.push(7);for(;Y<=287;Y++)C.push(8);ce(C,rt,288)})();var Bt=(function(){for(var Y=H?new Uint8Array(32768):[],C=0,P=0;C<Te.length-1;++C)for(;P<Te[C+1];++P)Y[P]=C;for(;P<32768;++P)Y[P]=29;var M=H?new Uint8Array(259):[];for(C=0,P=0;C<Ge.length-1;++C)for(;P<Ge[C+1];++P)M[P]=C;function E(W,K){for(var G=0;G<W.length;){var re=Math.min(65535,W.length-G),se=G+re==W.length;for(K.write_shift(1,+se),K.write_shift(2,re),K.write_shift(2,~re&65535);re-- >0;)K[K.l++]=W[G++]}return K.l}function F(W,K){for(var G=0,re=0,se=H?new Uint16Array(32768):[];re<W.length;){var de=Math.min(65535,W.length-re);if(de<10){for(G=me(K,G,+(re+de==W.length)),G&7&&(G+=8-(G&7)),K.l=G/8|0,K.write_shift(2,de),K.write_shift(2,~de&65535);de-- >0;)K[K.l++]=W[re++];G=K.l*8;continue}G=me(K,G,+(re+de==W.length)+2);for(var Pe=0;de-- >0;){var we=W[re];Pe=(Pe<<5^we)&32767;var ke=-1,$e=0;if((ke=se[Pe])&&(ke|=re&-32768,ke>re&&(ke-=32768),ke<re))for(;W[ke+$e]==W[re+$e]&&$e<250;)++$e;if($e>2){we=M[$e],we<=22?G=He(K,G,X[we+1]>>1)-1:(He(K,G,3),G+=5,He(K,G,X[we-23]>>5),G+=3);var ht=we<8?0:we-4>>2;ht>0&&(et(K,G,$e-Ge[we]),G+=ht),we=Y[re-ke],G=He(K,G,X[we]>>3),G-=3;var xt=we<4?0:we-2>>1;xt>0&&(et(K,G,re-ke-Te[we]),G+=xt);for(var kt=0;kt<$e;++kt)se[Pe]=re&32767,Pe=(Pe<<5^W[re])&32767,++re;de-=$e-1}else we<=143?we=we+48:G=je(K,G,1),G=He(K,G,X[we]),se[Pe]=re&32767,++re}G=He(K,G,0)-1}return K.l=(G+7)/8|0,K.l}return function(K,G){return K.length<8?E(K,G):F(K,G)}})();function Tt(L){var Y=be(50+Math.floor(L.length*1.1)),C=Bt(L,Y);return Y.slice(0,C)}var dt=H?new Uint16Array(32768):fe(32768),$t=H?new Uint16Array(32768):fe(32768),Qt=H?new Uint16Array(128):fe(128),Ut=1,Dr=1;function en(L,Y){var C=Re(L,Y)+257;Y+=5;var P=Re(L,Y)+1;Y+=5;var M=Me(L,Y)+4;Y+=4;for(var E=0,F=H?new Uint8Array(19):fe(19),W=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,G=H?new Uint8Array(8):fe(8),re=H?new Uint8Array(8):fe(8),se=F.length,de=0;de<M;++de)F[Ve[de]]=E=_e(L,Y),K<E&&(K=E),G[E]++,Y+=3;var Pe=0;for(G[0]=0,de=1;de<=K;++de)re[de]=Pe=Pe+G[de-1]<<1;for(de=0;de<se;++de)(Pe=F[de])!=0&&(W[de]=re[Pe]++);var we=0;for(de=0;de<se;++de)if(we=F[de],we!=0){Pe=X[W[de]]>>8-we;for(var ke=(1<<7-we)-1;ke>=0;--ke)Qt[Pe|ke<<we]=we&7|de<<3}var $e=[];for(K=1;$e.length<C+P;)switch(Pe=Qt[ne(L,Y)],Y+=Pe&7,Pe>>>=3){case 16:for(E=3+Fe(L,Y),Y+=2,Pe=$e[$e.length-1];E-- >0;)$e.push(Pe);break;case 17:for(E=3+_e(L,Y),Y+=3;E-- >0;)$e.push(0);break;case 18:for(E=11+ne(L,Y),Y+=7;E-- >0;)$e.push(0);break;default:$e.push(Pe),K<Pe&&(K=Pe);break}var ht=$e.slice(0,C),xt=$e.slice(C);for(de=C;de<286;++de)ht[de]=0;for(de=P;de<30;++de)xt[de]=0;return Ut=ce(ht,dt,286),Dr=ce(xt,$t,30),Y}function Ur(L,Y){if(L[0]==3&&!(L[1]&3))return[dl(Y),2];for(var C=0,P=0,M=aC(Y||1<<18),E=0,F=M.length>>>0,W=0,K=0;(P&1)==0;){if(P=_e(L,C),C+=3,P>>>1)P>>1==1?(W=9,K=5):(C=en(L,C),W=Ut,K=Dr);else{C&7&&(C+=8-(C&7));var G=L[C>>>3]|L[(C>>>3)+1]<<8;if(C+=32,G>0)for(!Y&&F<E+G&&(M=Ue(M,E+G),F=M.length);G-- >0;)M[E++]=L[C>>>3],C+=8;continue}for(;;){!Y&&F<E+32767&&(M=Ue(M,E+32767),F=M.length);var re=Ae(L,C,W),se=P>>>1==1?rt[re]:dt[re];if(C+=se&15,se>>>=4,(se>>>8&255)===0)M[E++]=se;else{if(se==256)break;se-=257;var de=se<8?0:se-4>>2;de>5&&(de=0);var Pe=E+Ge[se];de>0&&(Pe+=Ae(L,C,de),C+=de),re=Ae(L,C,K),se=P>>>1==1?_t[re]:$t[re],C+=se&15,se>>>=4;var we=se<4?0:se-2>>1,ke=Te[se];for(we>0&&(ke+=Ae(L,C,we),C+=we),!Y&&F<Pe&&(M=Ue(M,Pe+100),F=M.length);E<Pe;)M[E]=M[E-ke],++E}}}return Y?[M,C+7>>>3]:[M.slice(0,E),C+7>>>3]}function ca(L,Y){var C=L.slice(L.l||0),P=Ur(C,Y);return L.l+=P[1],P[0]}function Yn(L,Y){if(L)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Xe(L,Y){var C=L;ta(C,0);var P=[],M=[],E={FileIndex:P,FullPaths:M};j(E,{root:Y.root});for(var F=C.length-4;(C[F]!=80||C[F+1]!=75||C[F+2]!=5||C[F+3]!=6)&&F>=0;)--F;C.l=F+4,C.l+=4;var W=C.read_shift(2);C.l+=6;var K=C.read_shift(4);for(C.l=K,F=0;F<W;++F){C.l+=20;var G=C.read_shift(4),re=C.read_shift(4),se=C.read_shift(2),de=C.read_shift(2),Pe=C.read_shift(2);C.l+=8;var we=C.read_shift(4),ke=c(C.slice(C.l+se,C.l+se+de));C.l+=se+de+Pe;var $e=C.l;C.l=we+4,ke&&ke[1]&&((ke[1]||{}).usz&&(re=ke[1].usz),(ke[1]||{}).csz&&(G=ke[1].csz)),St(C,G,re,E,ke),C.l=$e}return E}function St(L,Y,C,P,M){L.l+=2;var E=L.read_shift(2),F=L.read_shift(2),W=s(L);if(E&8257)throw new Error("Unsupported ZIP encryption");for(var K=L.read_shift(4),G=L.read_shift(4),re=L.read_shift(4),se=L.read_shift(2),de=L.read_shift(2),Pe="",we=0;we<se;++we)Pe+=String.fromCharCode(L[L.l++]);if(de){var ke=c(L.slice(L.l,L.l+de));(ke[21589]||{}).mt&&(W=ke[21589].mt),(ke[1]||{}).usz&&(re=ke[1].usz),(ke[1]||{}).csz&&(G=ke[1].csz),M&&((M[21589]||{}).mt&&(W=M[21589].mt),(M[1]||{}).usz&&(re=M[1].usz),(M[1]||{}).csz&&(G=M[1].csz))}L.l+=de;var $e=L.slice(L.l,L.l+G);switch(F){case 8:$e=De(L,re);break;case 0:L.l+=G;break;default:throw new Error("Unsupported ZIP Compression method "+F)}var ht=!1;E&8&&(K=L.read_shift(4),K==134695760&&(K=L.read_shift(4),ht=!0),G=L.read_shift(4),re=L.read_shift(4)),G!=Y&&Yn(ht,"Bad compressed size: "+Y+" != "+G),re!=C&&Yn(ht,"Bad uncompressed size: "+C+" != "+re),Nt(P,Pe,$e,{unsafe:!0,mt:W})}function Ht(L,Y){var C=Y||{},P=[],M=[],E=be(1),F=C.compression?8:0,W=0,K=0,G=0,re=0,se=0,de=L.FullPaths[0],Pe=de,we=L.FileIndex[0],ke=[],$e=0;for(K=1;K<L.FullPaths.length;++K)if(Pe=L.FullPaths[K].slice(de.length),we=L.FileIndex[K],!(!we.size||!we.content||Array.isArray(we.content)&&we.content.length==0||Pe=="Sh33tJ5")){var ht=re,xt=be(Pe.length);for(G=0;G<Pe.length;++G)xt.write_shift(1,Pe.charCodeAt(G)&127);xt=xt.slice(0,xt.l),ke[se]=typeof we.content=="string"?dC.bstr(we.content,0):dC.buf(we.content,0);var kt=typeof we.content=="string"?Ia(we.content):we.content;F==8&&(kt=We(kt)),E=be(30),E.write_shift(4,67324752),E.write_shift(2,20),E.write_shift(2,W),E.write_shift(2,F),we.mt?i(E,we.mt):E.write_shift(4,0),E.write_shift(-4,ke[se]),E.write_shift(4,kt.length),E.write_shift(4,we.content.length),E.write_shift(2,xt.length),E.write_shift(2,0),re+=E.length,P.push(E),re+=xt.length,P.push(xt),re+=kt.length,P.push(kt),E=be(46),E.write_shift(4,33639248),E.write_shift(2,0),E.write_shift(2,20),E.write_shift(2,W),E.write_shift(2,F),E.write_shift(4,0),E.write_shift(-4,ke[se]),E.write_shift(4,kt.length),E.write_shift(4,we.content.length),E.write_shift(2,xt.length),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(4,0),E.write_shift(4,ht),$e+=E.l,M.push(E),$e+=xt.length,M.push(xt),++se}return E=be(22),E.write_shift(4,101010256),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,se),E.write_shift(2,se),E.write_shift(4,$e),E.write_shift(4,re),E.write_shift(2,0),Gr([Gr(P),Gr(M),E])}var Rt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function tn(L,Y){if(L.ctype)return L.ctype;var C=L.name||"",P=C.match(/\.([^\.]+)$/);return P&&Rt[P[1]]||Y&&(P=(C=Y).match(/[\.\\]([^\.\\])+$/),P&&Rt[P[1]])?Rt[P[1]]:"application/octet-stream"}function zr(L){for(var Y=Oh(L),C=[],P=0;P<Y.length;P+=76)C.push(Y.slice(P,P+76));return C.join(`\r
`)+`\r
`}function ae(L){var Y=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(G){var re=G.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],P=Y.split(`\r
`),M=0;M<P.length;++M){var E=P[M];if(E.length==0){C.push("");continue}for(var F=0;F<E.length;){var W=76,K=E.slice(F,F+W);K.charAt(W-1)=="="?W--:K.charAt(W-2)=="="?W-=2:K.charAt(W-3)=="="&&(W-=3),K=E.slice(F,F+W),F+=W,F<E.length&&(K+="="),C.push(K)}}return C.join(`\r
`)}function Le(L){for(var Y=[],C=0;C<L.length;++C){for(var P=L[C];C<=L.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+L[++C];Y.push(P)}for(var M=0;M<Y.length;++M)Y[M]=Y[M].replace(/[=][0-9A-Fa-f]{2}/g,function(E){return String.fromCharCode(parseInt(E.slice(1),16))});return Ia(Y.join(`\r
`))}function Je(L,Y,C){for(var P="",M="",E="",F,W=0;W<10;++W){var K=Y[W];if(!K||K.match(/^\s*$/))break;var G=K.match(/^([^:]*?):\s*([^\s].*)$/);if(G)switch(G[1].toLowerCase()){case"content-location":P=G[2].trim();break;case"content-type":E=G[2].trim();break;case"content-transfer-encoding":M=G[2].trim();break}}switch(++W,M.toLowerCase()){case"base64":F=Ia(ho(Y.slice(W).join("")));break;case"quoted-printable":F=Le(Y.slice(W));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var re=Nt(L,P.slice(C.length),F,{unsafe:!0});E&&(re.ctype=E)}function tt(L,Y){if(ge(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=Y&&Y.root||"",P=(qt&&Buffer.isBuffer(L)?L.toString("binary"):ge(L)).split(`\r
`),M=0,E="";for(M=0;M<P.length;++M)if(E=P[M],!!/^Content-Location:/i.test(E)&&(E=E.slice(E.indexOf("file")),C||(C=E.slice(0,E.lastIndexOf("/")+1)),E.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),E.slice(0,C.length)!=C););var F=(P[1]||"").match(/boundary="(.*?)"/);if(!F)throw new Error("MAD cannot find boundary");var W="--"+(F[1]||""),K=[],G=[],re={FileIndex:K,FullPaths:G};j(re);var se,de=0;for(M=0;M<P.length;++M){var Pe=P[M];Pe!==W&&Pe!==W+"--"||(de++&&Je(re,P.slice(se,M),C),se=M)}return re}function at(L,Y){var C=Y||{},P=C.boundary||"SheetJS";P="------="+P;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],E=L.FullPaths[0],F=E,W=L.FileIndex[0],K=1;K<L.FullPaths.length;++K)if(F=L.FullPaths[K].slice(E.length),W=L.FileIndex[K],!(!W.size||!W.content||F=="Sh33tJ5")){F=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var G=W.content,re=qt&&Buffer.isBuffer(G)?G.toString("binary"):ge(G),se=0,de=Math.min(1024,re.length),Pe=0,we=0;we<=de;++we)(Pe=re.charCodeAt(we))>=32&&Pe<128&&++se;var ke=se>=de*4/5;M.push(P),M.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+F),M.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),M.push("Content-Type: "+tn(W,F)),M.push(""),M.push(ke?ae(re):zr(re))}return M.push(P+`--\r
`),M.join(`\r
`)}function gt(L){var Y={};return j(Y,L),Y}function Nt(L,Y,C,P){var M=P&&P.unsafe;M||j(L);var E=!M&&or.find(L,Y);if(!E){var F=L.FullPaths[0];Y.slice(0,F.length)==F?F=Y:(F.slice(-1)!="/"&&(F+="/"),F=(F+Y).replace("//","/")),E={name:a(Y),type:2},L.FileIndex.push(E),L.FullPaths.push(F),M||or.utils.cfb_gc(L)}return E.content=C,E.size=C?C.length:0,P&&(P.CLSID&&(E.clsid=P.CLSID),P.mt&&(E.mt=P.mt),P.ct&&(E.ct=P.ct)),E}function ir(L,Y){j(L);var C=or.find(L,Y);if(C){for(var P=0;P<L.FileIndex.length;++P)if(L.FileIndex[P]==C)return L.FileIndex.splice(P,1),L.FullPaths.splice(P,1),!0}return!1}function Dt(L,Y,C){j(L);var P=or.find(L,Y);if(P){for(var M=0;M<L.FileIndex.length;++M)if(L.FileIndex[M]==P)return L.FileIndex[M].name=a(C),L.FullPaths[M]=C,!0}return!1}function rr(L){R(L,!0)}return t.find=V,t.read=I,t.parse=d,t.write=Oe,t.writeFile=ye,t.utils={cfb_new:gt,cfb_add:Nt,cfb_del:ir,cfb_mov:Dt,cfb_gc:rr,ReadShift:Zu,CheckField:qO,prep_blob:ta,bconcat:Gr,use_zlib:he,_deflateRaw:Tt,_inflateRaw:ca,consts:xe},t})(),lJ;function hC(e){return typeof e=="string"?Lp(e):Array.isArray(e)?IQ(e):e}function Vf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Lp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?vf(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([hC(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var c="data:application/octet-stream;base64,"+DQ(new Uint8Array(hC(n)));return chrome.downloads.download({url:c,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=hl(t)),f.write(t),f.close(),t}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+e)}function qr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function pC(e,t){for(var r=[],n=qr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function wb(e){for(var t=[],r=qr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Up(e){for(var t=[],r=qr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function cJ(e){for(var t=[],r=qr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var IO=Date.UTC(1899,11,30,0,0,0),uJ=Date.UTC(1899,11,31,0,0,0),fJ=Date.UTC(1904,0,1,0,0,0);function An(e,t){var r=e.getTime(),n=(r-IO)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function pc(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+IO),t}var dJ=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,hJ=/^(\d+)-(\d+)-(\d+)$/,RO=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Sa(e,t){if(e instanceof Date)return e;var r=e.match(dJ);if(r)return new Date((t?fJ:uJ)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(hJ),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(RO),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function bb(e,t){if(qt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function Gn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gn(e[r]));return t}function _r(e,t){for(var r="";r.length<t;)r+=e;return r}function us(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var pJ=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,mJ=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,xJ=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,gJ=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function vJ(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function yJ(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var wJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lh(e){if(xJ.test(e))return e.indexOf("Z")==-1?zp(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(pJ);if(n)return vJ(n);if(n=r.match(mJ),n)return yJ(n);if(n=r.match(RO),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(gJ&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear();a.getMonth();var c=a.getDate();if(isNaN(c))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&wJ.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}function kc(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function zp(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function Ct(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return qt?n=Hi(r):n=RQ(r),or.utils.cfb_add(e,t,n)}or.utils.cfb_add(e,t,r)}else e.file(t,r)}function _b(){return or.utils.cfb_new()}var Jr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bJ={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Sb=wb(bJ),Nb=/[&<>'"]/g,_J=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function At(e){var t=e+"";return t.replace(Nb,function(r){return Sb[r]}).replace(_J,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function mC(e){return At(e).replace(/ /g,"_x0020_")}var FO=/[\u0000-\u001f]/g;function Tv(e){var t=e+"";return t.replace(Nb,function(r){return Sb[r]}).replace(/\n/g,"<br/>").replace(FO,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function SJ(e){var t=e+"";return t.replace(Nb,function(r){return Sb[r]}).replace(FO,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function NJ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function EJ(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function kv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function xC(e){var t=dl(2*e.length),r,n,a=1,i=0,s=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function gC(e){return Hi(e,"binary").toString("utf8")}var S0="foo bar baz",mc=qt&&(gC(S0)==kv(S0)&&gC||xC(S0)==kv(S0)&&xC)||kv,vf=qt?function(e){return Hi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},TJ=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),MO=/(^\s|\s$|\n)/;function En(e,t){return"<"+e+(t.match(MO)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function yf(e){return qr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ze(e,t,r){return"<"+e+(r!=null?yf(r):"")+(t!=null?(t.match(MO)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function J1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function kJ(e,t){switch(typeof e){case"string":var r=Ze("vt:lpwstr",At(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",At(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",J1(e));throw new Error("Unable to serialize "+e)}var xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Vc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ra={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function CJ(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function AJ(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var vC=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},yC=qt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Hi(t)})):vC(e)}:vC,wC=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Yu(e,a)));return n.join("").replace(qu,"")},Eb=qt?function(e,t,r){return!Buffer.isBuffer(e)||!Dh?wC(e,t,r):e.toString("utf16le",t,r).replace(qu,"")}:wC,bC=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},LO=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):bC(e,t,r)}:bC,_C=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ic(e,a)));return n.join("")},Kf=qt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_C(t,r,n)}:_C,BO=function(e,t){var r=Fa(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},$O=BO,UO=function(e,t){var r=Fa(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},zO=UO,HO=function(e,t){var r=2*Fa(e,t);return r>0?Kf(e,t+4,t+4+r-1):""},WO=HO,VO=function(t,r){var n=Fa(t,r);return n>0?Eb(t,r+4,r+4+n):""},KO=VO,GO=function(e,t){var r=Fa(e,t);return r>0?Kf(e,t+4,t+4+r):""},YO=GO,XO=function(e,t){return CJ(e,t)},Bh=XO,Tb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};qt&&($O=function(t,r){if(!Buffer.isBuffer(t))return BO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},zO=function(t,r){if(!Buffer.isBuffer(t))return UO(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},WO=function(t,r){if(!Buffer.isBuffer(t)||!Dh)return HO(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},KO=function(t,r){if(!Buffer.isBuffer(t)||!Dh)return VO(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},YO=function(t,r){if(!Buffer.isBuffer(t))return GO(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Bh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):XO(t,r)},Tb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ic=function(e,t){return e[t]},Yu=function(e,t){return e[t+1]*256+e[t]},jJ=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Fa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Vo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},PJ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Zu(e,t){var r="",n,a,i=[],s,c,f,h;switch(t){case"dbcs":if(h=this.l,qt&&Buffer.isBuffer(this)&&Dh)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(Yu(this,h)),h+=2;e*=2;break;case"utf8":r=Kf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Eb(this,this.l,this.l+e);break;case"wstr":return Zu.call(this,e,"dbcs");case"lpstr-ansi":r=$O(this,this.l),e=4+Fa(this,this.l);break;case"lpstr-cp":r=zO(this,this.l),e=4+Fa(this,this.l);break;case"lpwstr":r=WO(this,this.l),e=4+2*Fa(this,this.l);break;case"lpp4":e=4+Fa(this,this.l),r=KO(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Fa(this,this.l),r=YO(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=ic(this,this.l+e++))!==0;)i.push(b0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Yu(this,this.l+e))!==0;)i.push(b0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return s=ic(this,h),this.l=h+1,c=Zu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(b0(Yu(this,h))),h+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return s=ic(this,h),this.l=h+1,c=Zu.call(this,e-f,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(b0(ic(this,h))),h+=1}r=i.join("");break;default:switch(e){case 1:return n=ic(this,this.l),this.l++,n;case 2:return n=(t==="i"?jJ:Yu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Vo:PJ)(this,this.l),this.l+=4,n):(a=Fa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Bh(this,this.l):a=Bh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=LO(this,this.l,e);break}}return this.l+=e,r}var OJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},DJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},IJ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function RJ(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)IJ(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,OJ(this,t,this.l);break;case 8:if(n=8,r==="f"){AJ(this,t,this.l);break}case 16:break;case-4:n=4,DJ(this,t,this.l);break}return this.l+=n,this}function qO(e,t){var r=LO(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ta(e,t){e.l=t,e.read_shift=Zu,e.chk=qO,e.write_shift=RJ}function zi(e,t){e.l+=t}function be(e){var t=dl(e);return ta(t,0),t}function Wn(){var e=[],t=qt?16384:2048;qt&&be(t).copy;var r=function(d){var m=be(d);return ta(m,0),m},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Gr(e)},c=function(){return a(),e},f=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:f,end:s,_bufs:e,end2:c}}function Be(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=zie[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Tb(r)&&e.push(r)}}function Qu(e,t,r){var n=Gn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function SC(e,t,r){var n=Gn(e);return n.s=Qu(n.s,t.s,r),n.e=Qu(n.e,t.s,r),n}function Ju(e,t){if(e.cRel&&e.c<0)for(e=Gn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Pr(e);return!e.cRel&&e.cRel!=null&&(r=LJ(r)),!e.rRel&&e.rRel!=null&&(r=FJ(r)),r}function Cv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tr(e.s.c)+":"+(e.e.cRel?"":"$")+tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ar(e.s.r)+":"+(e.e.rRel?"":"$")+ar(e.e.r):Ju(e.s,t.biff)+":"+Ju(e.e,t.biff)}function kb(e){return parseInt(MJ(e),10)-1}function ar(e){return""+(e+1)}function FJ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MJ(e){return e.replace(/\$(\d+)$/,"$1")}function Cb(e){for(var t=BJ(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function LJ(e){return e.replace(/^([A-Z])/,"$$$1")}function BJ(e){return e.replace(/^\$([A-Z])/,"$1")}function $J(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Pr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function kn(e){var t=e.indexOf(":");return t==-1?{s:Nr(e),e:Nr(e)}:{s:Nr(e.slice(0,t)),e:Nr(e.slice(t+1))}}function Zr(e,t){return typeof t>"u"||typeof t=="number"?Zr(e.s,e.e):(typeof e!="string"&&(e=Pr(e)),typeof t!="string"&&(t=Pr(t)),e==t?e:e+":"+t)}function wf(e){var t=kn(e);return"$"+tr(t.s.c)+"$"+ar(t.s.r)+":$"+tr(t.e.c)+"$"+ar(t.e.r)}function bf(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function gr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function NC(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gs(e.z,r?An(t):t)}catch{}try{return e.w=gs((e.XF||{}).numFmtId||(r?14:0),r?An(t):t)}catch{return""+t}}function vs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?sa[e.v]||e.v:t==null?NC(e,e.v):NC(e,t))}function Kc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function UJ(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function ZO(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;s=f.r,c=f.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=gr(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),s==-1&&(h.e.r=s=i["!ref"]?d.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var m=[],x=!1,g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");var b=s+g;a&&(i["!data"][b]||(i["!data"][b]=[]),m=i["!data"][b]);for(var _=t[g],w=0;w!=_.length;++w)if(!(typeof _[w]>"u")){var S={v:_[w],t:""},A=c+w;if(h.s.r>b&&(h.s.r=b),h.s.c>A&&(h.s.c=A),h.e.r<b&&(h.e.r=b),h.e.c<A&&(h.e.c=A),x=!0,_[w]&&typeof _[w]=="object"&&!Array.isArray(_[w])&&!(_[w]instanceof Date))S=_[w];else if(Array.isArray(S.v)&&(S.f=_[w][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?isFinite(S.v)?S.t="n":isNaN(S.v)?(S.t="e",S.v=15):(S.t="e",S.v=7):typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||xr[14],n.UTC||(S.v=zp(S.v)),n.cellDates?(S.t="d",S.w=gs(S.z,An(S.v,n.date1904))):(S.t="n",S.v=An(S.v,n.date1904),S.w=gs(S.z,S.v))):S.t="s";if(a)m[A]&&m[A].z&&(S.z=m[A].z),m[A]=S;else{var T=tr(A)+(b+1);i[T]&&i[T].z&&(S.z=i[T].z),i[T]=S}}}return x&&h.s.c<104e5&&(i["!ref"]=Zr(h)),i}function Gc(e,t){return ZO(null,e,t)}function zJ(e){return e.read_shift(4,"i")}function Si(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function Vn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function sn(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function HJ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function WJ(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ab(e,t){var r=e.l,n=e.read_shift(1),a=Vn(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)i.push(HJ(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function VJ(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),sn(e.t,t),r?t.slice(0,t.l):t}var KJ=Ab;function GJ(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),sn(e.t,t),t.write_shift(4,1),WJ({},t),r?t.slice(0,t.l):t}function li(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function wl(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function bl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function _l(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var YJ=Vn,QO=sn;function Hp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function _f(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var XJ=Vn,ey=Hp,jb=_f;function Pb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Bh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Vo(t,0)>>2;return r?a/100:a}function JO(e,t){t==null&&(t=be(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function e3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function qJ(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Sl=e3,Yc=qJ;function Xc(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ml(e,t){return(t||be(8)).write_shift(8,e,"f")}function ZJ(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var h=see[a];h&&(t.rgb=FC(h));break;case 2:t.rgb=FC([s,c,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function $h(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function QJ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function JJ(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var t3=2,Pa=3,N0=11,Uh=19,E0=64,eee=65,tee=71,ree=4108,nee=4126,Sn=80,EC={1:{n:"CodePage",t:t3},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:Pa},5:{n:"LineCount",t:Pa},6:{n:"ParagraphCount",t:Pa},7:{n:"SlideCount",t:Pa},8:{n:"NoteCount",t:Pa},9:{n:"HiddenCount",t:Pa},10:{n:"MultimediaClipCount",t:Pa},11:{n:"ScaleCrop",t:N0},12:{n:"HeadingPairs",t:ree},13:{n:"TitlesOfParts",t:nee},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:N0},17:{n:"CharacterCount",t:Pa},19:{n:"SharedDoc",t:N0},22:{n:"HyperlinksChanged",t:N0},23:{n:"AppVersion",t:Pa,p:"version"},24:{n:"DigSig",t:eee},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}},TC={1:{n:"CodePage",t:t3},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:E0},11:{n:"LastPrinted",t:E0},12:{n:"CreatedDate",t:E0},13:{n:"ModifiedDate",t:E0},14:{n:"PageCount",t:Pa},15:{n:"WordCount",t:Pa},16:{n:"CharCount",t:Pa},17:{n:"Thumbnail",t:tee},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:Pa},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}};function aee(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var iee=aee([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),see=Gn(iee),sa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Fi={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},oee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],lee={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},T0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function r3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function n3(e,t,r){var n=cJ(lee),a=[],i;a[a.length]=Jr,a[a.length]=Ze("Types",null,{xmlns:xn.CT,"xmlns:xsd":xn.xsd,"xmlns:xsi":xn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ze("Default",null,{Extension:h[0],ContentType:h[1]})}));var s=function(h){e[h]&&e[h].length>0&&(i=e[h][0],a[a.length]=Ze("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:T0[h][t.bookType]||T0[h].xlsx}))},c=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:T0[h][t.bookType]||T0[h].xlsx})})},f=function(h){(e[h]||[]).forEach(function(d){a[a.length]=Ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[h][0]})})};return s("workbooks"),c("sheets"),c("charts"),f("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),c("metadata"),f("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Mt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function a3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function xc(e){var t=[Jr,Ze("Relationships",null,{xmlns:xn.RELS})];return qr(e["!id"]).forEach(function(r){t[t.length]=Ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Yt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Mt.HLINK,Mt.XPATH,Mt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function cee(e){var t=[Jr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function kC(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function uee(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function fee(e){var t=[Jr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(kC(e[r][0],e[r][1])),t.push(uee("",e[r][0]));return t.push(kC("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function i3(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ph.version+"</meta:generator></office:meta></office:document-meta>"}var el=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Av(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=At(t),n[n.length]=r?Ze(e,t,r):En(e,t))}function s3(e,t){var r=t||{},n=[Jr,Ze("cp:coreProperties",null,{"xmlns:cp":xn.CORE_PROPS,"xmlns:dc":xn.dc,"xmlns:dcterms":xn.dcterms,"xmlns:dcmitype":xn.dcmitype,"xmlns:xsi":xn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Av("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:J1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Av("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:J1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=el.length;++i){var s=el[i],c=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Av(s[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var gc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],o3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function l3(e){var t=[],r=Ze;return e||(e={}),e.Application="SheetJS",t[t.length]=Jr,t[t.length]=Ze("Properties",null,{xmlns:xn.EXT_PROPS,"xmlns:vt":xn.vt}),gc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=At(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+At(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function c3(e){var t=[Jr,Ze("Properties",null,{xmlns:xn.CUST_PROPS,"xmlns:vt":xn.vt})];if(!e)return t.join("");var r=1;return qr(e).forEach(function(a){++r,t[t.length]=Ze("property",kJ(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:At(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var CC={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dee(e,t){var r=[];return qr(CC).map(function(n){for(var a=0;a<el.length;++a)if(el[a][1]==n)return el[a];for(a=0;a<gc.length;++a)if(gc[a][1]==n)return gc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(En(CC[n[1]]||n[1],a))}}),Ze("DocumentProperties",r.join(""),{xmlns:Ra.o})}function hee(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&qr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<el.length;++s)if(i==el[s][1])return;for(s=0;s<gc.length;++s)if(i==gc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var c=e[i],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(Ze(mC(i),c,{"dt:dt":f}))}}),t&&qr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],c="string";typeof s=="number"?(c="float",s=String(s)):s===!0||s===!1?(c="boolean",s=s?"1":"0"):s instanceof Date?(c="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ze(mC(i),s,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Ra.o+'">'+a.join("")+"</"+n+">"}function pee(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=be(8);return s.write_shift(4,n),s.write_shift(4,a),s}function AC(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=pee(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Gr([r,n])}var u3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mee(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function jC(e,t,r){var n=be(8),a=[],i=[],s=8,c=0,f=be(8),h=be(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),i.push(f),a.push(h),s+=8+f.length,!t){h=be(8),h.write_shift(4,0),a.unshift(h);var d=[be(4)];for(d[0].write_shift(4,e.length),c=0;c<e.length;++c){var m=e[c][0];for(f=be(8+2*(m.length+1)+(m.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,m.length+1),f.write_shift(0,m,"dbcs");f.l!=f.length;)f.write_shift(1,0);d.push(f)}f=Gr(d),i.unshift(f),s+=8+f.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(u3.indexOf(e[c][0])>-1||o3.indexOf(e[c][0])>-1)&&e[c][1]!=null){var x=e[c][1],g=0;if(t){g=+t[e[c][0]];var b=r[g];if(b.p=="version"&&typeof x=="string"){var _=x.split(".");x=(+_[0]<<16)+(+_[1]||0)}f=AC(b.t,x)}else{var w=mee(x);w==-1&&(w=31,x=String(x)),f=AC(w,x)}i.push(f),h=be(8),h.write_shift(4,t?g:2+c),a.push(h),s+=8+f.length}var S=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,S),S+=i[c].length;return n.write_shift(4,s),n.write_shift(4,i.length),Gr([n].concat(a).concat(i))}function PC(e,t,r,n,a,i){var s=be(a?68:48),c=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,or.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var f=jC(e,r,n);if(c.push(f),a){var h=jC(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+f.length),c.push(h)}return Gr(c)}function xee(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function gee(e,t){return e.read_shift(t)===1}function $n(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function M0(e){return e.read_shift(2,"u")}function ti(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function f3(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function d3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=as;if(r&&r.biff>=8&&(as=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var c=n?e.read_shift(n,a):"";return as=i,c}function vee(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Gr(a)}function yee(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function wee(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yee(e,n,r)}function bee(e,t,r){if(r.biff>5)return wee(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function h3(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function OC(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _ee(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),OC(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&OC(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function xl(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function See(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function Nee(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function p3(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Ob(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=be(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Eee(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Tee(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function kee(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=vee(e[a]);var i=Gr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Cee(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Aee(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function jee(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=be(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Pee(e,t,r,n){var a=be(10);return xl(e,t,n,a),a.write_shift(4,r),a}function Oee(e,t,r,n,a){var i=!a||a.biff==8,s=be(8+ +i+(1+i)*r.length);return xl(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function Dee(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Iee(e){var t=be(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function Ree(e){var t=be(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function Fee(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function DC(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Mee(e){var t=be(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function m3(e){var t=be(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var Lee=m3;function Bee(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function jv(e,t,r,n,a,i){var s=be(8);return xl(e,t,n,s),f3(r,i,s),s}function $ee(e,t,r,n){var a=be(14);return xl(e,t,n,a),ml(r,a),a}function Uee(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return IC(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(See(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function IC(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=d3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Pv(e,t,r,n){var a=be(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function zee(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)p3(e[r],t);return t}function Hee(e){var t=be(24),r=Nr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Gr([t,_ee(e[1])])}function Wee(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=Nr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Vee(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Kee(e,t,r){if(!r.cellStyles)return zi(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var h={s:a,e:i,w:s,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function Gee(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Yee(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Gf(e,t,r,n,a){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function Xee(e,t,r,n,a){var i=be(15);return Gf(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function qee(e,t,r,n,a){var i=be(9);return Gf(i,e,t,n||0,a||0),i.write_shift(2,r),i}var Zee=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=wb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var h=[],d=dl(1);switch(f.type){case"base64":d=Ia(ho(c));break;case"binary":d=Ia(c);break;case"buffer":case"array":d=c;break}ta(d,0);var m=d.read_shift(1),x=!!(m&136),g=!1,b=!1;switch(m){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var _=0,w=521;m==2&&(_=d.read_shift(2)),d.l+=3,m!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),m!=2&&(w=d.read_shift(2));var S=d.read_shift(2);f.codepage,m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&e[d[d.l]],d.l+=1,d.l+=2),b&&(d.l+=36);for(var A=[],T={},D=Math.min(d.length,m==2?521:w-10-(g?264:0)),O=b?32:11;d.l<D&&d[d.l]!=13;)switch(T={},T.name=hl(d.slice(d.l,d.l+O)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=O,T.type=String.fromCharCode(d.read_shift(1)),m!=2&&!b&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),m==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&A.push(T),m!=2&&(d.l+=b?13:14),T.type){case"B":(!g||T.len!=8)&&f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var I=0,j=0;for(h[0]=[],j=0;j!=A.length;++j)h[0][j]=A[j].name;for(;_-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,h[++I]=[],j=0,j=0;j!=A.length;++j){var z=d.slice(d.l,d.l+A[j].len);d.l+=A[j].len,ta(z,0);var R=hl(z);switch(A[j].type){case"C":R.trim().length&&(h[I][j]=R.replace(/([^\s])\s+$/,"$1"));break;case"D":R.length===8?(h[I][j]=new Date(Date.UTC(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8),0,0,0,0)),f&&f.UTC||(h[I][j]=kc(h[I][j]))):h[I][j]=R;break;case"F":h[I][j]=parseFloat(R.trim());break;case"+":case"I":h[I][j]=b?z.read_shift(-4,"i")^2147483648:z.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":h[I][j]=!0;break;case"N":case"F":h[I][j]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));h[I][j]="##MEMO##"+(b?parseInt(R.trim(),10):z.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(h[I][j]=+R||0);break;case"@":h[I][j]=new Date(z.read_shift(-8,"f")-621356832e5);break;case"T":{var q=z.read_shift(4),V=z.read_shift(4);if(q==0&&V==0)break;h[I][j]=new Date((q-2440588)*864e5+V),f&&f.UTC||(h[I][j]=kc(h[I][j]))}break;case"Y":h[I][j]=z.read_shift(4,"i")/1e4+z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[I][j]=-z.read_shift(-8,"f");break;case"B":if(g&&A[j].len==8){h[I][j]=z.read_shift(8,"f");break}case"G":case"P":z.l+=A[j].len;break;case"0":if(A[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[j].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=A,h}function n(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var d=Gc(r(c,h),h);return d["!cols"]=h.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete h.DBF,d}function a(c,f){try{var h=Kc(n(c,f),f);return h.bookType="dbf",h}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,f){if(!c["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=f||{},d=as;if(+h.codepage>=0&&gf(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Wn(),x=ay(c,{header:1,raw:!0,cellDates:!0}),g=x[0],b=x.slice(1),_=c["!cols"]||[],w=0,S=0,A=0,T=1;for(w=0;w<g.length;++w){if(((_[w]||{}).DBF||{}).name){g[w]=_[w].DBF.name,++A;continue}if(g[w]!=null){if(++A,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(S=0;S<1024;++S)if(g.indexOf(g[w]+"_"+S)==-1){g[w]+="_"+S;break}}}}var D=gr(c["!ref"]),O=[],I=[],j=[];for(w=0;w<=D.e.c-D.s.c;++w){var z="",R="",q=0,V=[];for(S=0;S<b.length;++S)b[S][w]!=null&&V.push(b[S][w]);if(V.length==0||g[w]==null){O[w]="?";continue}for(S=0;S<V.length;++S){switch(typeof V[S]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=V[S]instanceof Date?"D":"C";break;default:R="C"}q=Math.max(q,String(V[S]).length),z=z&&z!=R?"C":R}q>250&&(q=250),R=((_[w]||{}).DBF||{}).type,R=="C"&&_[w].DBF.len>q&&(q=_[w].DBF.len),z=="B"&&R=="N"&&(z="N",j[w]=_[w].DBF.dec,q=_[w].DBF.len),I[w]=z=="C"||R=="N"?q:i[z]||0,T+=I[w],O[w]=z}var J=m.next(32);for(J.write_shift(4,318902576),J.write_shift(4,b.length),J.write_shift(2,296+32*A),J.write_shift(2,T),w=0;w<4;++w)J.write_shift(4,0);var ue=+t[as]||3;for(J.write_shift(4,0|ue<<8),e[ue]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+as+", using 1252"),as=1252),w=0,S=0;w<g.length;++w)if(g[w]!=null){var Ne=m.next(32),pe=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ne.write_shift(1,pe,"sbcs"),Ne.write_shift(1,O[w]=="?"?"C":O[w],"sbcs"),Ne.write_shift(4,S),Ne.write_shift(1,I[w]||i[O[w]]||0),Ne.write_shift(1,j[w]||0),Ne.write_shift(1,2),Ne.write_shift(4,0),Ne.write_shift(1,0),Ne.write_shift(4,0),Ne.write_shift(4,0),S+=I[w]||i[O[w]]||0}var Ie=m.next(264);for(Ie.write_shift(4,13),w=0;w<65;++w)Ie.write_shift(4,0);for(w=0;w<b.length;++w){var xe=m.next(T);for(xe.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(O[S]){case"L":xe.write_shift(1,b[w][S]==null?63:b[w][S]?84:70);break;case"B":xe.write_shift(8,b[w][S]||0,"f");break;case"N":var ye="0";for(typeof b[w][S]=="number"&&(ye=b[w][S].toFixed(j[S]||0)),ye.length>I[S]&&(ye=ye.slice(0,I[S])),A=0;A<I[S]-ye.length;++A)xe.write_shift(1,32);xe.write_shift(1,ye,"sbcs");break;case"D":b[w][S]?(xe.write_shift(4,("0000"+b[w][S].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(b[w][S].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+b[w][S].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var ge=xe.l,Oe=String(b[w][S]!=null?b[w][S]:"").slice(0,I[S]);for(xe.write_shift(1,Oe,"cpstr"),ge+=I[S]-xe.l,A=0;A<ge;++A)xe.write_shift(1,32);break}}return as=d,m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),Qee=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+qr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+qr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(g,b){var _=e[b];return typeof _=="number"?nC(_):_},n=function(g,b,_){var w=b.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return w==59?g:nC(w)};e["|"]=254;var a=function(g){return g.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(g,b){switch(b.type){case"base64":return s(ho(g),b);case"binary":return s(g,b);case"buffer":return s(qt&&Buffer.isBuffer(g)?g.toString("binary"):hl(g),b);case"array":return s(bb(g),b)}throw new Error("Unrecognized type "+b.type)}function s(g,b){var _=g.split(/[\n\r]+/),w=-1,S=-1,A=0,T=0,D=[],O=[],I=null,j={},z=[],R=[],q=[],V=0,J,ue={Workbook:{WBProps:{},Names:[]}};for(+b.codepage>=0&&gf(+b.codepage);A!==_.length;++A){V=0;var Ne=_[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),pe=Ne.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Ie=pe[0],xe;if(Ne.length>0)switch(Ie){case"ID":break;case"E":break;case"B":break;case"O":for(T=1;T<pe.length;++T)switch(pe[T].charAt(0)){case"V":{var ye=parseInt(pe[T].slice(1),10);ye>=1&&ye<=4&&(ue.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(pe[1].charAt(0)){case"P":O.push(Ne.slice(3).replace(/;;/g,";"));break}break;case"NN":{var ge={Sheet:0};for(T=1;T<pe.length;++T)switch(pe[T].charAt(0)){case"N":ge.Name=pe[T].slice(1);break;case"E":ge.Ref=(b&&b.sheet||"Sheet1")+"!"+BC(pe[T].slice(1));break}ue.Workbook.Names.push(ge)}break;case"C":var Oe=!1,ie=!1,he=!1,De=!1,We=-1,Ve=-1,Ge="",Te="z",U="";for(T=1;T<pe.length;++T)switch(pe[T].charAt(0)){case"A":U=pe[T].slice(1);break;case"X":S=parseInt(pe[T].slice(1),10)-1,ie=!0;break;case"Y":for(w=parseInt(pe[T].slice(1),10)-1,ie||(S=0),J=D.length;J<=w;++J)D[J]=[];break;case"K":xe=pe[T].slice(1),xe.charAt(0)==='"'?(xe=xe.slice(1,xe.length-1),Te="s"):xe==="TRUE"||xe==="FALSE"?(xe=xe==="TRUE",Te="b"):xe.charAt(0)=="#"&&Fi[xe]!=null?(Te="e",xe=Fi[xe]):isNaN(us(xe))||(xe=us(xe),Te="n",I!==null&&pl(I)&&b.cellDates&&(xe=pc(ue.Workbook.WBProps.date1904?xe+1462:xe),Te=typeof xe=="number"?"n":"d")),Oe=!0;break;case"E":De=!0,Ge=BC(pe[T].slice(1),{r:w,c:S});break;case"S":he=!0;break;case"G":break;case"R":We=parseInt(pe[T].slice(1),10)-1;break;case"C":Ve=parseInt(pe[T].slice(1),10)-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Ne)}if(Oe&&(D[w][S]?(D[w][S].t=Te,D[w][S].v=xe):D[w][S]={t:Te,v:xe},I&&(D[w][S].z=I),b.cellText!==!1&&I&&(D[w][S].w=gs(D[w][S].z,D[w][S].v,{date1904:ue.Workbook.WBProps.date1904})),I=null),he){if(De)throw new Error("SYLK shared formula cannot have own formula");var H=We>-1&&D[We][Ve];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");Ge=Jte(H[1],{r:w-We,c:S-Ve})}Ge&&(D[w][S]?D[w][S].f=Ge:D[w][S]={t:"n",f:Ge}),U&&(D[w][S]||(D[w][S]={t:"z"}),D[w][S].c=[{a:"SheetJSYLK",t:U}]);break;case"F":var X=0;for(T=1;T<pe.length;++T)switch(pe[T].charAt(0)){case"X":S=parseInt(pe[T].slice(1),10)-1,++X;break;case"Y":for(w=parseInt(pe[T].slice(1),10)-1,J=D.length;J<=w;++J)D[J]=[];break;case"M":V=parseInt(pe[T].slice(1),10)/20;break;case"F":break;case"G":break;case"P":I=O[parseInt(pe[T].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(q=pe[T].slice(1).split(" "),J=parseInt(q[0],10);J<=parseInt(q[1],10);++J)V=parseInt(q[2],10),R[J-1]=V===0?{hidden:!0}:{wch:V};break;case"C":S=parseInt(pe[T].slice(1),10)-1,R[S]||(R[S]={});break;case"R":w=parseInt(pe[T].slice(1),10)-1,z[w]||(z[w]={}),V>0?(z[w].hpt=V,z[w].hpx=y3(V)):V===0&&(z[w].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Ne)}X<1&&(I=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+Ne)}}return z.length>0&&(j["!rows"]=z),R.length>0&&(j["!cols"]=R),R.forEach(function(Z){Db(Z)}),b&&b.sheetRows&&(D=D.slice(0,b.sheetRows)),[D,j,ue]}function c(g,b){var _=i(g,b),w=_[0],S=_[1],A=_[2],T=Gn(b);T.date1904=(((A||{}).Workbook||{}).WBProps||{}).date1904;var D=Gc(w,T);qr(S).forEach(function(I){D[I]=S[I]});var O=Kc(D,b);return qr(A).forEach(function(I){O[I]=A[I]}),O.bookType="sylk",O}function f(g,b,_,w,S,A){var T="C;Y"+(_+1)+";X"+(w+1)+";K";switch(g.t){case"n":T+=isFinite(g.v)?g.v||0:sa[isNaN(g.v)?36:7],g.f&&!g.F&&(T+=";E"+Vp(g.f,{r:_,c:w}));break;case"b":T+=g.v?"TRUE":"FALSE";break;case"e":T+=g.w||sa[g.v]||g.v;break;case"d":T+=An(Sa(g.v,A),A);break;case"s":T+='"'+(g.v==null?"":String(g.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function h(g,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";A";return w+=a(g.map(function(S){return S.t}).join("")),w}function d(g,b){b.forEach(function(_,w){var S="F;W"+(w+1)+" "+(w+1)+" ";_.hidden?S+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=zh(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Hh(_.wpx)),typeof _.wch=="number"&&(S+=Math.round(_.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function m(g,b){b.forEach(function(_,w){var S="F;";_.hidden?S+="M0;":_.hpt?S+="M"+20*_.hpt+";":_.hpx&&(S+="M"+20*Wh(_.hpx)+";"),S.length>2&&g.push(S+"R"+(w+1))})}function x(g,b,_){b||(b={}),b._formats=["General"];var w=["ID;PSheetJS;N;E"],S=[],A=gr(g["!ref"]||"A1"),T,D=g["!data"]!=null,O=`\r
`,I=(((_||{}).Workbook||{}).WBProps||{}).date1904,j="General";w.push("P;PGeneral");var z=A.s.r,R=A.s.c,q=[];if(g["!ref"]){for(z=A.s.r;z<=A.e.r;++z)if(!(D&&!g["!data"][z])){for(q=[],R=A.s.c;R<=A.e.c;++R)T=D?g["!data"][z][R]:g[tr(R)+ar(z)],!(!T||!T.c)&&q.push(h(T.c,z,R));q.length&&S.push(q.join(O))}}if(g["!ref"]){for(z=A.s.r;z<=A.e.r;++z)if(!(D&&!g["!data"][z])){for(q=[],R=A.s.c;R<=A.e.c;++R)if(T=D?g["!data"][z][R]:g[tr(R)+ar(z)],!(!T||T.v==null&&(!T.f||T.F))){if((T.z||(T.t=="d"?xr[14]:"General"))!=j){var V=b._formats.indexOf(T.z);V==-1&&(b._formats.push(T.z),V=b._formats.length-1,w.push("P;P"+T.z.replace(/;/g,";;"))),q.push("F;P"+V+";Y"+(z+1)+";X"+(R+1))}q.push(f(T,g,z,R,b,I))}S.push(q.join(O))}}return w.push("F;P0;DG0G8;M255"),g["!cols"]&&d(w,g["!cols"]),g["!rows"]&&m(w,g["!rows"]),g["!ref"]&&w.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" ")),w.push("O;L;D;B"+(I?";V4":"")+";K47;G100 0.001"),delete b._formats,w.join(O)+O+S.join(O)+O+"E"+O}return{to_workbook:c,from_sheet:x}})(),Jee=(function(){function e(c,f){switch(f.type){case"base64":return t(ho(c),f);case"binary":return t(c,f);case"buffer":return t(qt&&Buffer.isBuffer(c)?c.toString("binary"):hl(c),f);case"array":return t(bb(c),f)}throw new Error("Unrecognized type "+f.type)}function t(c,f){for(var h=c.split(`
`),d=-1,m=-1,x=0,g=[];x!==h.length;++x){if(h[x].trim()==="BOT"){g[++d]=[],m=0;continue}if(!(d<0)){var b=h[x].trim().split(","),_=b[0],w=b[1];++x;for(var S=h[x]||"";(S.match(/["]/g)||[]).length&1&&x<h.length-1;)S+=`
`+h[++x];switch(S=S.trim(),+_){case-1:if(S==="BOT"){g[++d]=[],m=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?g[d][m]=!0:S==="FALSE"?g[d][m]=!1:isNaN(us(w))?isNaN(Lh(w).getDate())?g[d][m]=w:(g[d][m]=Sa(w),f&&f.UTC||(g[d][m]=kc(g[d][m]))):g[d][m]=us(w),++m;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),g[d][m++]=S!==""?S:null;break}if(S==="EOD")break}}return f&&f.sheetRows&&(g=g.slice(0,f.sheetRows)),g}function r(c,f){return Gc(e(c,f),f)}function n(c,f){var h=Kc(r(c,f),f);return h.bookType="dif",h}function a(c,f){return"0,"+String(c)+`\r
`+f}function i(c){return`1,0\r
"`+c.replace(/"/g,'""')+'"'}function s(c){if(!c["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var f=gr(c["!ref"]),h=c["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(f.e.r-f.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(f.e.c-f.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],m=f.s.r;m<=f.e.r;++m){for(var x=h?c["!data"][m]:[],g=`-1,0\r
BOT\r
`,b=f.s.c;b<=f.e.c;++b){var _=h?x&&x[b]:c[Pr({r:m,c:b})];if(_==null){g+=`1,0\r
""\r
`;continue}switch(_.t){case"n":_.w!=null?g+="0,"+_.w+`\r
V`:_.v!=null?g+=a(_.v,"V"):_.f!=null&&!_.F?g+=i("="+_.f):g+=`1,0\r
""`;break;case"b":g+=_.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":g+=i(isNaN(+_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=gs(_.z||xr[14],An(Sa(_.v)))),g+=a(_.w,"V");break;default:g+=`1,0\r
""`}g+=`\r
`}d.push(g)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),x3=(function(){function e(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,x){for(var g=m.split(`
`),b=-1,_=-1,w=0,S=[];w!==g.length;++w){var A=g[w].trim().split(":");if(A[0]==="cell"){var T=Nr(A[1]);if(S.length<=T.r)for(b=S.length;b<=T.r;++b)S[b]||(S[b]=[]);switch(b=T.r,_=T.c,A[2]){case"t":S[b][_]=e(A[3]);break;case"v":S[b][_]=+A[3];break;case"vtf":var D=A[A.length-1];case"vtc":switch(A[3]){case"nl":S[b][_]=!!+A[4];break;default:S[b][_]=A[A.length-1].charAt(0)=="#"?{t:"e",v:Fi[A[A.length-1]]}:+A[4];break}A[2]=="vtf"&&(S[b][_]=[S[b][_],D])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(m,x){return Gc(r(m,x),x)}function a(m,x){return Kc(n(m,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(m){if(!m||!m["!ref"])return"";for(var x=[],g=[],b,_="",w=kn(m["!ref"]),S=m["!data"]!=null,A=w.s.r;A<=w.e.r;++A)for(var T=w.s.c;T<=w.e.c;++T)if(_=Pr({r:A,c:T}),b=S?(m["!data"][A]||[])[T]:m[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":g.push(t(b.v));break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var D=An(Sa(b.v));g[2]="vtc",g[3]="nd",g[4]=""+D,g[5]=b.w||gs(b.z||xr[14],D);break;case"n":isFinite(b.v)?b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=t(b.f)):(g[2]="v",g[3]=b.v):(g[2]="vt"+(b.f?"f":"c"),g[3]="e"+sa[isNaN(b.v)?36:7],g[4]="0",g[5]=b.f||g[3].slice(1),g[6]="e",g[7]=g[3].slice(1));break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[i,s,c,s,h(m),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),ete=(function(){function e(d,m,x,g,b){b.raw?m[x][g]=d:d===""||(d==="TRUE"?m[x][g]=!0:d==="FALSE"?m[x][g]=!1:isNaN(us(d))?isNaN(Lh(d).getDate())?d.charCodeAt(0)==35&&Fi[d]!=null?m[x][g]={t:"e",v:Fi[d],w:d}:m[x][g]=d:m[x][g]=Sa(d):m[x][g]=us(d))}function t(d,m){var x=m||{},g=[];if(!d||d.length===0)return g;for(var b=d.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,S=0,A=0;A<=_;++A)S=b[A].indexOf(" "),S==-1?S=b[A].length:S++,w=Math.max(w,S);for(A=0;A<=_;++A){g[A]=[];var T=0;for(e(b[A].slice(0,w).trim(),g,A,T,x),T=1;T<=(b[A].length-w)/10+1;++T)e(b[A].slice(w+(T-1)*10,w+T*10).trim(),g,A,T,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var m={},x=!1,g=0,b=0;g<d.length;++g)(b=d.charCodeAt(g))==34?x=!x:!x&&b in r&&(m[b]=(m[b]||0)+1);b=[];for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&b.push([m[g],g]);if(!b.length){m=n;for(g in m)Object.prototype.hasOwnProperty.call(m,g)&&b.push([m[g],g])}return b.sort(function(_,w){return _[0]-w[0]||n[_[1]]-n[w[1]]}),r[b.pop()[1]]||44}function i(d,m){var x=m||{},g="",b={};x.dense&&(b["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=a(d.slice(0,1024)):x&&x.FS?g=x.FS:g=a(d.slice(0,1024));var w=0,S=0,A=0,T=0,D=0,O=g.charCodeAt(0),I=!1,j=0,z=d.charCodeAt(0),R=x.dateNF!=null?aJ(x.dateNF):null;function q(){var V=d.slice(T,D);V.slice(-1)=="\r"&&(V=V.slice(0,-1));var J={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),x.cellText!==!1&&(J.w=V),V.length===0)J.t="z";else if(x.raw)J.t="s",J.v=V;else if(V.trim().length===0)J.t="s",J.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(J.t="s",J.v=V.slice(2,-1).replace(/""/g,'"')):ere(V)?(J.t="s",J.f=V.slice(1),J.v=V):(J.t="s",J.v=V);else if(V=="TRUE")J.t="b",J.v=!0;else if(V=="FALSE")J.t="b",J.v=!1;else if(!isNaN(A=us(V)))J.t="n",J.v=A;else if(!isNaN((A=Lh(V)).getDate())||R&&V.match(R)){if(J.z=x.dateNF||xr[14],R&&V.match(R)){var ue=iJ(V,x.dateNF,V.match(R)||[]);A=Sa(ue),x&&x.UTC===!1&&(A=kc(A))}else x&&x.UTC===!1?A=kc(A):x.cellText!==!1&&x.dateNF&&(J.w=gs(J.z,A));x.cellDates?(J.t="d",J.v=A):(J.t="n",J.v=An(A)),x.cellNF||delete J.z}else V.charCodeAt(0)==35&&Fi[V]!=null?(J.t="e",J.w=V,J.v=Fi[V]):(J.t="s",J.v=V);if(J.t=="z"||(x.dense?(b["!data"][w]||(b["!data"][w]=[]),b["!data"][w][S]=J):b[Pr({c:S,r:w})]=J),T=D+1,z=d.charCodeAt(T),_.e.c<S&&(_.e.c=S),_.e.r<w&&(_.e.r=w),j==O)++S;else if(S=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;D<d.length;++D)switch(j=d.charCodeAt(D)){case 34:z===34&&(I=!I);break;case 13:if(I)break;d.charCodeAt(D+1)==10&&++D;case O:case 10:if(!I&&q())break e;break}return D-T>0&&q(),b["!ref"]=Zr(_),b}function s(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,m):Gc(t(d,m),m)}function c(d,m){var x="",g=m.type=="string"?[0,0,0,0]:kse(d,m);switch(m.type){case"base64":x=ho(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):(m.codepage,x=qt&&Buffer.isBuffer(d)?d.toString("binary"):hl(d));break;case"array":x=bb(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=mc(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=mc(x):m.type=="binary",x.slice(0,19)=="socialcalc:version:"?x3.to_sheet(m.type=="string"?x:mc(x),m):s(x,m)}function f(d,m){return Kc(c(d,m),m)}function h(d){var m=[];if(!d["!ref"])return"";for(var x=gr(d["!ref"]),g,b=d["!data"]!=null,_=x.s.r;_<=x.e.r;++_){for(var w=[],S=x.s.c;S<=x.e.c;++S){var A=Pr({r:_,c:S});if(g=b?(d["!data"][_]||[])[S]:d[A],!g||g.v==null){w.push("          ");continue}for(var T=(g.w||(vs(g),g.w)||"").slice(0,10);T.length<10;)T+=" ";w.push(T+(S===0?" ":""))}m.push(w.join(""))}return m.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}})(),RC=(function(){function e(U,H,X){if(U){ta(U,U.l||0);for(var Z=X.Enum||De;U.l<U.length;){var ee=U.read_shift(2),Fe=Z[ee]||Z[65535],_e=U.read_shift(2),Me=U.l+_e,Re=Fe.f&&Fe.f(U,_e,X);if(U.l=Me,H(Re,Fe,ee))return}}}function t(U,H){switch(H.type){case"base64":return n(Ia(ho(U)),H);case"binary":return n(Ia(U),H);case"buffer":case"array":return n(U,H)}throw"Unsupported type "+H.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(U,H){if(!U)return U;var X=H||{},Z={},ee="Sheet1",Fe="",_e=0,Me={},Re=[],ne=[],Ae=[];X.dense&&(Ae=Z["!data"]=[]);var me={s:{r:0,c:0},e:{r:0,c:0}},je=X.sheetRows||0,He={};if(U[4]==81&&U[5]==80&&U[6]==87)return Te(U,H);if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)X.Enum=De,e(U,function(ce,rt,_t){switch(_t){case 0:X.vers=ce,ce>=4096&&(X.qpro=!0);break;case 255:X.vers=ce,X.works=!0;break;case 6:me=ce;break;case 204:ce&&(Fe=ce);break;case 222:Fe=ce;break;case 15:case 51:(!X.qpro&&!X.works||_t==51)&&ce[1].v.charCodeAt(0)<48&&(ce[1].v=ce[1].v.slice(1)),(X.works||X.works2)&&(ce[1].v=ce[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=X.dateNF||r[(ce[2]&15)-1]||xr[14],X.cellDates&&(ce[1].v=pc(ce[1].v),ce[1].t=typeof ce[1].v=="number"?"n":"d")),X.qpro&&ce[3]>_e&&(Z["!ref"]=Zr(me),Me[ee]=Z,Re.push(ee),Z={},X.dense&&(Ae=Z["!data"]=[]),me={s:{r:0,c:0},e:{r:0,c:0}},_e=ce[3],ee=Fe||"Sheet"+(_e+1),Fe="");var yt=X.dense?(Ae[ce[0].r]||[])[ce[0].c]:Z[Pr(ce[0])];if(yt){yt.t=ce[1].t,yt.v=ce[1].v,ce[1].z!=null&&(yt.z=ce[1].z),ce[1].f!=null&&(yt.f=ce[1].f),He=yt;break}X.dense?(Ae[ce[0].r]||(Ae[ce[0].r]=[]),Ae[ce[0].r][ce[0].c]=ce[1]):Z[Pr(ce[0])]=ce[1],He=ce[1];break;case 21509:X.works2=!0;break;case 21506:ce==5281&&(He.z="hh:mm:ss",X.cellDates&&He.t=="n"&&(He.v=pc(He.v),He.t=typeof He.v=="number"?"n":"d"));break}},X);else if(U[2]==26||U[2]==14)X.Enum=We,U[2]==14&&(X.qpro=!0,U.l=0),e(U,function(ce,rt,_t){switch(_t){case 204:ee=ce;break;case 22:ce[1].v.charCodeAt(0)<48&&(ce[1].v=ce[1].v.slice(1)),ce[1].v=ce[1].v.replace(/\x0F./g,function(yt){return String.fromCharCode(yt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>_e&&(Z["!ref"]=Zr(me),Me[ee]=Z,Re.push(ee),Z={},X.dense&&(Ae=Z["!data"]=[]),me={s:{r:0,c:0},e:{r:0,c:0}},_e=ce[3],ee="Sheet"+(_e+1)),je>0&&ce[0].r>=je)break;X.dense?(Ae[ce[0].r]||(Ae[ce[0].r]=[]),Ae[ce[0].r][ce[0].c]=ce[1]):Z[Pr(ce[0])]=ce[1],me.e.c<ce[0].c&&(me.e.c=ce[0].c),me.e.r<ce[0].r&&(me.e.r=ce[0].r);break;case 27:ce[14e3]&&(ne[ce[14e3][0]]=ce[14e3][1]);break;case 1537:ne[ce[0]]=ce[1],ce[0]==_e&&(ee=ce[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(Z["!ref"]=Zr(me),Me[Fe||ee]=Z,Re.push(Fe||ee),!ne.length)return{SheetNames:Re,Sheets:Me};for(var et={},Ue=[],fe=0;fe<ne.length;++fe)Me[Re[fe]]?(Ue.push(ne[fe]||Re[fe]),et[ne[fe]]=Me[ne[fe]]||Me[Re[fe]]):(Ue.push(ne[fe]),et[ne[fe]]={"!ref":"A1"});return{SheetNames:Ue,Sheets:et}}function a(U,H){var X=H||{};if(+X.codepage>=0&&gf(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Wn();if(!U["!ref"])throw new Error("Cannot export empty sheet to WK1");var ee=gr(U["!ref"]),Fe=U["!data"]!=null,_e=[];ze(Z,0,s(1030)),ze(Z,6,h(ee));for(var Me=Math.min(ee.e.r,8191),Re=ee.s.c;Re<=ee.e.c;++Re)_e[Re]=tr(Re);for(var ne=ee.s.r;ne<=Me;++ne){var Ae=ar(ne);for(Re=ee.s.c;Re<=ee.e.c;++Re){var me=Fe?(U["!data"][ne]||[])[Re]:U[_e[Re]+Ae];if(!(!me||me.t=="z"))switch(me.t){case"n":(me.v|0)==me.v&&me.v>=-32768&&me.v<=32767?ze(Z,13,w(ne,Re,me)):ze(Z,14,A(ne,Re,me));break;case"d":var je=An(me.v);(je|0)==je&&je>=-32768&&je<=32767?ze(Z,13,w(ne,Re,{v:je,z:me.z||xr[14]})):ze(Z,14,A(ne,Re,{v:je,z:me.z||xr[14]}));break;default:var He=vs(me);ze(Z,15,g(ne,Re,He.slice(0,239)))}}}return ze(Z,1),Z.end()}function i(U,H){var X=H||{};if(+X.codepage>=0&&gf(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Wn();ze(Z,0,c(U));for(var ee=0,Fe=0;ee<U.SheetNames.length;++ee)(U.Sheets[U.SheetNames[ee]]||{})["!ref"]&&ze(Z,27,he(U.SheetNames[ee],Fe++));var _e=0;for(ee=0;ee<U.SheetNames.length;++ee){var Me=U.Sheets[U.SheetNames[ee]];if(!(!Me||!Me["!ref"])){for(var Re=gr(Me["!ref"]),ne=Me["!data"]!=null,Ae=[],me=Math.min(Re.e.r,8191),je=Re.s.r;je<=me;++je)for(var He=ar(je),et=Re.s.c;et<=Re.e.c;++et){je===Re.s.r&&(Ae[et]=tr(et));var Ue=Ae[et]+He,fe=ne?(Me["!data"][je]||[])[et]:Me[Ue];if(!(!fe||fe.t=="z"))if(fe.t=="n")ze(Z,23,ue(je,et,_e,fe.v));else{var ce=vs(fe);ze(Z,22,q(je,et,_e,ce.slice(0,239)))}}++_e}}return ze(Z,1),Z.end()}function s(U){var H=be(2);return H.write_shift(2,U),H}function c(U){var H=be(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var X=0,Z=0,ee=0,Fe=0;Fe<U.SheetNames.length;++Fe){var _e=U.SheetNames[Fe],Me=U.Sheets[_e];if(!(!Me||!Me["!ref"])){++ee;var Re=kn(Me["!ref"]);X<Re.e.r&&(X=Re.e.r),Z<Re.e.c&&(Z=Re.e.c)}}return X>8191&&(X=8191),H.write_shift(2,X),H.write_shift(1,ee),H.write_shift(1,Z),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function f(U,H,X){var Z={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&X.qpro?(Z.s.c=U.read_shift(1),U.l++,Z.s.r=U.read_shift(2),Z.e.c=U.read_shift(1),U.l++,Z.e.r=U.read_shift(2),Z):(Z.s.c=U.read_shift(2),Z.s.r=U.read_shift(2),H==12&&X.qpro&&(U.l+=2),Z.e.c=U.read_shift(2),Z.e.r=U.read_shift(2),H==12&&X.qpro&&(U.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(U){var H=be(8);return H.write_shift(2,U.s.c),H.write_shift(2,U.s.r),H.write_shift(2,U.e.c),H.write_shift(2,U.e.r),H}function d(U,H,X){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(Z[0].c=U.read_shift(1),Z[3]=U.read_shift(1),Z[0].r=U.read_shift(2),U.l+=2):X.works?(Z[0].c=U.read_shift(2),Z[0].r=U.read_shift(2),Z[2]=U.read_shift(2)):(Z[2]=U.read_shift(1),Z[0].c=U.read_shift(2),Z[0].r=U.read_shift(2)),Z}function m(U){return U.z&&pl(U.z)?240|(r.indexOf(U.z)+1||2):255}function x(U,H,X){var Z=U.l+H,ee=d(U,H,X);if(ee[1].t="s",(X.vers&65534)==20768){U.l++;var Fe=U.read_shift(1);return ee[1].v=U.read_shift(Fe,"utf8"),ee}return X.qpro&&U.l++,ee[1].v=U.read_shift(Z-U.l,"cstr"),ee}function g(U,H,X){var Z=be(7+X.length);Z.write_shift(1,255),Z.write_shift(2,H),Z.write_shift(2,U),Z.write_shift(1,39);for(var ee=0;ee<Z.length;++ee){var Fe=X.charCodeAt(ee);Z.write_shift(1,Fe>=128?95:Fe)}return Z.write_shift(1,0),Z}function b(U,H,X){var Z=U.l+H,ee=d(U,H,X);if(ee[1].t="s",X.vers==20768){var Fe=U.read_shift(1);return ee[1].v=U.read_shift(Fe,"utf8"),ee}return ee[1].v=U.read_shift(Z-U.l,"cstr"),ee}function _(U,H,X){var Z=d(U,H,X);return Z[1].v=U.read_shift(2,"i"),Z}function w(U,H,X){var Z=be(7);return Z.write_shift(1,m(X)),Z.write_shift(2,H),Z.write_shift(2,U),Z.write_shift(2,X.v,"i"),Z}function S(U,H,X){var Z=d(U,H,X);return Z[1].v=U.read_shift(8,"f"),Z}function A(U,H,X){var Z=be(13);return Z.write_shift(1,m(X)),Z.write_shift(2,H),Z.write_shift(2,U),Z.write_shift(8,X.v,"f"),Z}function T(U,H,X){var Z=U.l+H,ee=d(U,H,X);if(ee[1].v=U.read_shift(8,"f"),X.qpro)U.l=Z;else{var Fe=U.read_shift(2);j(U.slice(U.l,U.l+Fe),ee),U.l+=Fe}return ee}function D(U,H,X){var Z=H&32768;return H&=-32769,H=(Z?U:0)+(H>=8192?H-16384:H),(Z?"":"$")+(X?tr(H):ar(H))}var O={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(U,H){ta(U,0);for(var X=[],Z=0,ee="",Fe="",_e="",Me="";U.l<U.length;){var Re=U[U.l++];switch(Re){case 0:X.push(U.read_shift(8,"f"));break;case 1:Fe=D(H[0].c,U.read_shift(2),!0),ee=D(H[0].r,U.read_shift(2),!1),X.push(Fe+ee);break;case 2:{var ne=D(H[0].c,U.read_shift(2),!0),Ae=D(H[0].r,U.read_shift(2),!1);Fe=D(H[0].c,U.read_shift(2),!0),ee=D(H[0].r,U.read_shift(2),!1),X.push(ne+Ae+":"+Fe+ee)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(U.read_shift(2));break;case 6:{for(var me="";Re=U[U.l++];)me+=String.fromCharCode(Re);X.push('"'+me.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Me=X.pop(),_e=X.pop(),X.push(["AND","OR"][Re-20]+"("+_e+","+Me+")");break;default:if(Re<32&&I[Re])Me=X.pop(),_e=X.pop(),X.push(_e+I[Re]+Me);else if(O[Re]){if(Z=O[Re][1],Z==69&&(Z=U[U.l++]),Z>X.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+X.join("|")+"|");return}var je=X.slice(-Z);X.length-=Z,X.push(O[Re][0]+"("+je.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}X.length==1?H[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function z(U){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=U.read_shift(2),H[3]=U[U.l++],H[0].c=U[U.l++],H}function R(U,H){var X=z(U);return X[1].t="s",X[1].v=U.read_shift(H-4,"cstr"),X}function q(U,H,X,Z){var ee=be(6+Z.length);ee.write_shift(2,U),ee.write_shift(1,X),ee.write_shift(1,H),ee.write_shift(1,39);for(var Fe=0;Fe<Z.length;++Fe){var _e=Z.charCodeAt(Fe);ee.write_shift(1,_e>=128?95:_e)}return ee.write_shift(1,0),ee}function V(U,H){var X=z(U);X[1].v=U.read_shift(2);var Z=X[1].v>>1;if(X[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return X[1].v=Z,X}function J(U,H){var X=z(U),Z=U.read_shift(4),ee=U.read_shift(4),Fe=U.read_shift(2);if(Fe==65535)return Z===0&&ee===3221225472?(X[1].t="e",X[1].v=15):Z===0&&ee===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var _e=Fe&32768;return Fe=(Fe&32767)-16446,X[1].v=(1-_e*2)*(ee*Math.pow(2,Fe+32)+Z*Math.pow(2,Fe)),X}function ue(U,H,X,Z){var ee=be(14);if(ee.write_shift(2,U),ee.write_shift(1,X),ee.write_shift(1,H),Z==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var Fe=0,_e=0,Me=0,Re=0;return Z<0&&(Fe=1,Z=-Z),_e=Math.log2(Z)|0,Z/=Math.pow(2,_e-31),Re=Z>>>0,(Re&2147483648)==0&&(Z/=2,++_e,Re=Z>>>0),Z-=Re,Re|=2147483648,Re>>>=0,Z*=Math.pow(2,32),Me=Z>>>0,ee.write_shift(4,Me),ee.write_shift(4,Re),_e+=16383+(Fe?32768:0),ee.write_shift(2,_e),ee}function Ne(U,H){var X=J(U);return U.l+=H-14,X}function pe(U,H){var X=z(U),Z=U.read_shift(4);return X[1].v=Z>>6,X}function Ie(U,H){var X=z(U),Z=U.read_shift(8,"f");return X[1].v=Z,X}function xe(U,H){var X=Ie(U);return U.l+=H-12,X}function ye(U,H){return U[U.l+H-1]==0?U.read_shift(H,"cstr"):""}function ge(U,H){var X=U[U.l++];X>H-1&&(X=H-1);for(var Z="";Z.length<X;)Z+=String.fromCharCode(U[U.l++]);return Z}function Oe(U,H,X){if(!(!X.qpro||H<21)){var Z=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ee=U.read_shift(H-21,"cstr");return[Z,ee]}}function ie(U,H){for(var X={},Z=U.l+H;U.l<Z;){var ee=U.read_shift(2);if(ee==14e3){for(X[ee]=[0,""],X[ee][0]=U.read_shift(2);U[U.l];)X[ee][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return X}function he(U,H){var X=be(5+U.length);X.write_shift(2,14e3),X.write_shift(2,H);for(var Z=0;Z<U.length;++Z){var ee=U.charCodeAt(Z);X[X.l++]=ee>127?95:ee}return X[X.l++]=0,X}var De={0:{n:"BOF",f:M0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:ge},255:{n:"BOF",f:M0},21506:{n:"WKSNF",f:M0},65535:{n:""}},We={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:J},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:Ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:pe},38:{n:"??"},39:{n:"NUMBER27",f:Ie},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ve={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Ge(U){var H=U.read_shift(2),X=U.read_shift(1);if(X!=0)throw"unsupported QPW string type "+X.toString(16);return U.read_shift(H,"sbcs-cont")}function Te(U,H){ta(U,0);var X=H||{},Z={};X.dense&&(Z["!data"]=[]);var ee=[],Fe="",_e={s:{r:-1,c:-1},e:{r:-1,c:-1}},Me=0,Re=0,ne=0,Ae=0,me={SheetNames:[],Sheets:{}},je=[];e:for(;U.l<U.length;){var He=U.read_shift(2),et=U.read_shift(2),Ue=U.slice(U.l,U.l+et);switch(ta(Ue,0),He){case 1:if(Ue.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var fe=Ue.read_shift(4),ce=(Ue.length-Ue.l)/fe|0,rt=0;rt<fe;++rt){var _t=Ue.l+ce,yt={};Ue.l+=2,yt.numFmtId=Ue.read_shift(2),Ve[yt.numFmtId]&&(yt.z=Ve[yt.numFmtId]),Ue.l=_t,je.push(yt)}break;case 1025:break;case 1026:break;case 1031:for(Ue.l+=12;Ue.l<Ue.length;)Me=Ue.read_shift(2),Re=Ue.read_shift(1),ee.push(Ue.read_shift(Me,"cstr"));break;case 1032:break;case 1537:{var Bt=Ue.read_shift(2);Z={},X.dense&&(Z["!data"]=[]),_e.s.c=Ue.read_shift(2),_e.e.c=Ue.read_shift(2),_e.s.r=Ue.read_shift(4),_e.e.r=Ue.read_shift(4),Ue.l+=4,Ue.l+2<Ue.length&&(Me=Ue.read_shift(2),Re=Ue.read_shift(1),Fe=Me==0?"":Ue.read_shift(Me,"cstr")),Fe||(Fe=tr(Bt))}break;case 1538:{if(_e.s.c>255||_e.s.r>999999)break;_e.e.c<_e.s.c&&(_e.e.c=_e.s.c),_e.e.r<_e.s.r&&(_e.e.r=_e.s.r),Z["!ref"]=Zr(_e),Lb(me,Z,Fe)}break;case 2561:ne=Ue.read_shift(2),_e.e.c<ne&&(_e.e.c=ne),_e.s.c>ne&&(_e.s.c=ne),Ae=Ue.read_shift(4),_e.s.r>Ae&&(_e.s.r=Ae),Ae=Ue.read_shift(4),_e.e.r<Ae&&(_e.e.r=Ae);break;case 3073:{Ae=Ue.read_shift(4),Me=Ue.read_shift(4),_e.s.r>Ae&&(_e.s.r=Ae),_e.e.r<Ae+Me-1&&(_e.e.r=Ae+Me-1);for(var Tt=tr(ne);Ue.l<Ue.length;){var dt={t:"z"},$t=Ue.read_shift(1),Qt=-1;$t&128&&(Qt=Ue.read_shift(2));var Ut=$t&64?Ue.read_shift(2)-1:0;switch($t&31){case 0:break;case 1:break;case 2:dt={t:"n",v:Ue.read_shift(2)};break;case 3:dt={t:"n",v:Ue.read_shift(2,"i")};break;case 4:dt={t:"n",v:Pb(Ue)};break;case 5:dt={t:"n",v:Ue.read_shift(8,"f")};break;case 7:dt={t:"s",v:ee[Re=Ue.read_shift(4)-1]};break;case 8:dt={t:"n",v:Ue.read_shift(8,"f")},Ue.l+=2,Ue.l+=4,isNaN(dt.v)&&(dt={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+($t&31)}Qt!=-1&&(je[Qt-1]||{}).z&&(dt.z=je[Qt-1].z);var Dr=0;if($t&32)switch($t&31){case 2:Dr=Ue.read_shift(2);break;case 3:Dr=Ue.read_shift(2,"i");break;case 7:Dr=Ue.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+($t&31)}if(!(!X.sheetStubs&&dt.t=="z")){var en=Gn(dt);dt.t=="n"&&dt.z&&pl(dt.z)&&X.cellDates&&(en.v=pc(dt.v),en.t=typeof en.v=="number"?"n":"d"),Z["!data"]!=null?(Z["!data"][Ae]||(Z["!data"][Ae]=[]),Z["!data"][Ae][ne]=en):Z[Tt+ar(Ae)]=en}for(++Ae,--Me;Ut-- >0&&Me>=0;){if($t&32)switch($t&31){case 2:dt={t:"n",v:dt.v+Dr&65535};break;case 3:dt={t:"n",v:dt.v+Dr&65535},dt.v>32767&&(dt.v-=65536);break;case 7:dt={t:"s",v:ee[Re=Re+Dr>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+($t&31)}else switch($t&31){case 1:dt={t:"z"};break;case 2:dt={t:"n",v:Ue.read_shift(2)};break;case 7:dt={t:"s",v:ee[Re=Ue.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+($t&31)}!X.sheetStubs&&dt.t=="z"||(Z["!data"]!=null?(Z["!data"][Ae]||(Z["!data"][Ae]=[]),Z["!data"][Ae][ne]=dt):Z[Tt+ar(Ae)]=dt),++Ae,--Me}}}break;case 3074:{ne=Ue.read_shift(2),Ae=Ue.read_shift(4);var Ur=Ge(Ue);Z["!data"]!=null?(Z["!data"][Ae]||(Z["!data"][Ae]=[]),Z["!data"][Ae][ne]={t:"s",v:Ur}):Z[tr(ne)+ar(Ae)]={t:"s",v:Ur}}break}U.l+=et}return me}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})(),tte=/^\s|\s$|[\t\n\r]/;function rte(e,t){if(!t.bookSST)return"";var r=[Jr];r[r.length]=Ze("sst",null,{xmlns:Vc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(tte)&&(i+=' xml:space="preserve"'),i+=">"+At(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function nte(e){return[e.read_shift(4),e.read_shift(4)]}function ate(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ite=VJ;function ste(e){var t=Wn();Be(t,159,ate(e));for(var r=0;r<e.length;++r)Be(t,19,ite(e[r]));return Be(t,160),t.end()}function ote(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function g3(e){var t=0,r,n=ote(e),a=n.length+1,i,s,c,f,h;for(r=dl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],c=(t&16384)===0?0:1,f=t<<1&32767,h=c|f,t=h^s;return t^52811}function lte(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=gr(e["!ref"]),a,i=e["!data"]!=null,s=[],c=n.s.r;c<=n.e.r;++c){r.push("\\trowd\\trautofit1");for(var f=n.s.c;f<=n.e.c;++f)r.push("\\cellx"+(f+1));for(r.push("\\pard\\intbl"),i&&(s=e["!data"][c]||[]),f=n.s.c;f<=n.e.c;++f){var h=Pr({r:c,c:f});if(a=i?s[f]:e[h],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(vs(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function FC(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var cte=6,fs=cte;function zh(e){return Math.floor((e+Math.round(128/fs)/256)*fs)}function Hh(e){return Math.floor((e-5)/fs*100+.5)/100}function ty(e){return Math.round((e*fs+5)/fs*256)/256}function Db(e){e.width?(e.wpx=zh(e.width),e.wch=Hh(e.wpx),e.MDW=fs):e.wpx?(e.wch=Hh(e.wpx),e.width=ty(e.wch),e.MDW=fs):typeof e.wch=="number"&&(e.width=ty(e.wch),e.wpx=zh(e.width),e.MDW=fs),e.customWidth&&delete e.customWidth}var ute=96,v3=ute;function Wh(e){return e*96/v3}function y3(e){return e*v3/96}function fte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ze("numFmt",null,{numFmtId:n,formatCode:At(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function dte(e){var t=[];return t[t.length]=Ze("cellXfs",null),e.forEach(function(r){t[t.length]=Ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function hte(e,t){var r=[Jr,Ze("styleSheet",null,{xmlns:Vc[0],"xmlns:vt":xn.vt})],n;return e.SSF&&(n=fte(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=dte(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function pte(e,t){var r=e.read_shift(2),n=Vn(e);return[r,n]}function mte(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),sn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function xte(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=QJ(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=ZJ(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vn(e),n}function gte(e,t){t||(t=be(153)),t.write_shift(2,e.sz*20),JJ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),$h(e.color,t);var n=0;return n=2,t.write_shift(1,n),sn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var vte=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ov,yte=zi;function MC(e,t){t||(t=be(84)),Ov||(Ov=wb(vte));var r=Ov[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for($h({auto:1},t),$h({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function wte(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function w3(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hu(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var bte=zi;function _te(e,t){return t||(t=be(51)),t.write_shift(1,0),Hu(null,t),Hu(null,t),Hu(null,t),Hu(null,t),Hu(null,t),t.length>t.l?t.slice(0,t.l):t}function Ste(e,t){return t||(t=be(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_f(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Nte(e,t,r){var n=be(2052);return n.write_shift(4,e),_f(t,n),_f(r,n),n.length>n.l?n.slice(0,n.l):n}function Ete(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Be(e,615,Si(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Be(e,44,mte(a,t[a]))}),Be(e,616))}}function Tte(e){var t=1;Be(e,611,Si(t)),Be(e,43,gte({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function kte(e){var t=2;Be(e,603,Si(t)),Be(e,45,MC({patternType:"none"})),Be(e,45,MC({patternType:"gray125"})),Be(e,604)}function Cte(e){var t=1;Be(e,613,Si(t)),Be(e,46,_te()),Be(e,614)}function Ate(e){var t=1;Be(e,626,Si(t)),Be(e,47,w3({numFmtId:0},65535)),Be(e,627)}function jte(e,t){Be(e,617,Si(t.length)),t.forEach(function(r){Be(e,47,w3(r,0))}),Be(e,618)}function Pte(e){var t=1;Be(e,619,Si(t)),Be(e,48,Ste({xfId:0,name:"Normal"})),Be(e,620)}function Ote(e){var t=0;Be(e,505,Si(t)),Be(e,506)}function Dte(e){var t=0;Be(e,508,Nte(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function Ite(e,t){var r=Wn();return Be(r,278),Ete(r,e.SSF),Tte(r),kte(r),Cte(r),Ate(r),jte(r,t.cellXfs),Pte(r),Ote(r),Dte(r),Be(r,279),r.end()}function b3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Jr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Rte(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Vn(e)}}function Fte(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),sn(e.name,t),t.slice(0,t.l)}function Mte(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Lte(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Bte(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),sn(t,r),r.slice(0,r.l)}function $te(e){return e.l+=4,e.read_shift(4)!=0}function Ute(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function zte(){var e=Wn();return Be(e,332),Be(e,334,Si(1)),Be(e,335,Fte({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,Bte(1,"XLDAPR")),Be(e,52),Be(e,35,Si(514)),Be(e,4096,Si(0)),Be(e,4097,ti(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,Ute(1)),Be(e,51,Lte([[1,0]])),Be(e,338),Be(e,333),e.end()}function Hte(){var e=[Jr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Wte(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _3(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Ze("xml",null,{"xmlns:v":Ra.v,"xmlns:o":Ra.o,"xmlns:x":Ra.x,"xmlns:mv":Ra.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,c=t||[];return c.length>0&&i.push(Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),c.forEach(function(f){++s,i.push(Vte(f,s))}),i.push("</xml>"),i.join("")}function Vte(e,t,r){var n=Nr(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Ze("v:fill",i,a),c={on:"t",obscured:"t"};return["<v:shape"+yf({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Ze("v:shadow",null,c),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",En("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),En("x:AutoFill","False"),En("x:Row",String(n.r)),En("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function Kte(e){var t=[Jr,Ze("comments",null,{xmlns:Vc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=At(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(h){h.a&&(a=r.indexOf(At(h.a))),h.T&&++s,i.push(h.t==null?"":At(h.t))}),s===0)n[1].forEach(function(h){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(At(h.a))+'"><text>'),t.push(En("t",h.t==null?"":At(h.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var c=`Comment:
    `+i[0]+`
`,f=1;f<i.length;++f)c+=`Reply:
    `+i[f]+`
`;t.push(En("t",At(c))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function S3(e,t,r){var n=[Jr,Ze("ThreadedComments",null,{xmlns:xn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,c){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=f.id:f.parentId=i,s.ID=f.id,s.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ze("threadedComment",En("text",s.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function N3(e){var t=[Jr,Ze("personList",null,{xmlns:xn.TCMNT,"xmlns:x":Vc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Gte(e){var t={};t.iauthor=e.read_shift(4);var r=Sl(e);return t.rfx=r.s,t.ref=Pr(r.s),e.l+=16,t}function Yte(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),Yc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Xte=Vn;function LC(e){return sn(e.slice(0,54))}function qte(e){var t=Wn(),r=[];return Be(t,628),Be(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Be(t,632,LC(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),Be(t,632,LC("tc="+a.ID))))})}),Be(t,631),Be(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var s={s:Nr(n[0]),e:Nr(n[0])};Be(t,635,Yte([s,a])),a.t&&a.t.length>0&&Be(t,637,GJ(a)),Be(t,636),delete a.iauthor})}),Be(t,634),Be(t,629),t.end()}function Zte(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&or.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Qte=["xlsb","xlsm","xlam","biff8","xla"],BC=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return c?d+=t.c:--d,f?h+=t.r:--h,a+(c?"":"$")+tr(d)+(f?"":"$")+ar(h)}return function(a,i){return t=i,a.replace(e,r)}})(),Wp=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Wp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Vp=(function(){return function(t,r){return t.replace(Wp,function(n,a,i,s,c,f){var h=Cb(s)-(i?0:r.c),d=kb(f)-(c?0:r.r),m=c=="$"?d+1:d==0?"":"["+d+"]",x=i=="$"?h+1:h==0?"":"["+h+"]";return a+"R"+m+"C"+x})}})();function Jte(e,t){return e.replace(Wp,function(r,n,a,i,s,c){return n+(a=="$"?a+i:tr(Cb(i)+t.c))+(s=="$"?s+c:ar(kb(c)+t.r))})}function ere(e){return e.length!=1}function Wr(e){e.l+=1}function po(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function E3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return T3(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=po(e),c=po(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function T3(e){var t=po(e),r=po(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function tre(e,t,r){if(r.biff<8)return T3(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=po(e),s=po(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function k3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return rre(e);var n=e.read_shift(r&&r.biff==12?4:2),a=po(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function rre(e){var t=po(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function nre(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function are(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ire(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:c}}function ire(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function sre(e,t,r){var n=(e[e.l++]&96)>>5,a=E3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function ore(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=E3(e,i,r);return[n,a,s]}function lre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cre(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function ure(e,t,r){var n=(e[e.l++]&96)>>5,a=tre(e,t-1,r);return[n,a]}function fre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function $C(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function dre(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function hre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function pre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function mre(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function xre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function C3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gre(e){return e.read_shift(2),C3(e)}function vre(e){return e.read_shift(2),C3(e)}function yre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=k3(e,0,r);return[n,a]}function wre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=are(e,0,r);return[n,a]}function bre(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=k3(e,0,r);return[n,a,i]}function _re(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Dne[a],P3[a],n]}function Sre(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Nre(e);return[a,(i[0]===0?P3:One)[i[1]]]}function Nre(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Ere(e,t,r){e.l+=r&&r.biff==2?3:4}function Tre(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kre(e){return e.l++,sa[e.read_shift(1)]}function Cre(e){return e.l++,e.read_shift(2)}function Are(e){return e.l++,e.read_shift(1)!==0}function jre(e){return e.l++,Xc(e)}function Pre(e,t,r){return e.l++,d3(e,t-1,r)}function Ore(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gee(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=sa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Xc(e);break;case 2:r[1]=bee(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Dre(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Sl:Nee)(e));return a}function Ire(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var c=0;c!=a;++c)s[i][c]=Ore(e,r.biff);return s}function Rre(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Fre(e,t,r){if(r.biff==5)return Mre(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Mre(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Lre(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Bre(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $re(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ure(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var zre=zi,Hre=zi,Wre=zi;function Yf(e,t,r){return e.l+=2,[nre(e)]}function Ib(e){return e.l+=6,[]}var Vre=Yf,Kre=Ib,Gre=Ib,Yre=Yf;function A3(e){return e.l+=2,[M0(e),e.read_shift(2)&1]}var Xre=Yf,qre=A3,Zre=Ib,Qre=Yf,Jre=Yf,ene=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tne(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=ene[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function rne(e){return e.l+=2,[e.read_shift(4)]}function nne(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ane(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ine(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function sne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function one(e){return e.l+=4,[0,0]}var UC={1:{n:"PtgExp",f:Tre},2:{n:"PtgTbl",f:Wre},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:Pre},26:{n:"PtgSheet",f:nne},27:{n:"PtgEndSheet",f:ane},28:{n:"PtgErr",f:kre},29:{n:"PtgBool",f:Are},30:{n:"PtgInt",f:Cre},31:{n:"PtgNum",f:jre},32:{n:"PtgArray",f:fre},33:{n:"PtgFunc",f:_re},34:{n:"PtgFuncVar",f:Sre},35:{n:"PtgName",f:Rre},36:{n:"PtgRef",f:yre},37:{n:"PtgArea",f:sre},38:{n:"PtgMemArea",f:Lre},39:{n:"PtgMemErr",f:zre},40:{n:"PtgMemNoMem",f:Hre},41:{n:"PtgMemFunc",f:Bre},42:{n:"PtgRefErr",f:$re},43:{n:"PtgAreaErr",f:lre},44:{n:"PtgRefN",f:wre},45:{n:"PtgAreaN",f:ure},46:{n:"PtgMemAreaN",f:ine},47:{n:"PtgMemNoMemN",f:sne},57:{n:"PtgNameX",f:Fre},58:{n:"PtgRef3d",f:bre},59:{n:"PtgArea3d",f:ore},60:{n:"PtgRefErr3d",f:Ure},61:{n:"PtgAreaErr3d",f:cre},255:{}},lne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cne={1:{n:"PtgElfLel",f:A3},2:{n:"PtgElfRw",f:Qre},3:{n:"PtgElfCol",f:Vre},6:{n:"PtgElfRwV",f:Jre},7:{n:"PtgElfColV",f:Yre},10:{n:"PtgElfRadical",f:Xre},11:{n:"PtgElfRadicalS",f:Zre},13:{n:"PtgElfColS",f:Kre},15:{n:"PtgElfColSV",f:Gre},16:{n:"PtgElfRadicalLel",f:qre},25:{n:"PtgList",f:tne},29:{n:"PtgSxName",f:rne},255:{}},une={0:{n:"PtgAttrNoop",f:one},1:{n:"PtgAttrSemi",f:xre},2:{n:"PtgAttrIf",f:pre},4:{n:"PtgAttrChoose",f:dre},8:{n:"PtgAttrGoto",f:hre},16:{n:"PtgAttrSum",f:Ere},32:{n:"PtgAttrBaxcel",f:$C},33:{n:"PtgAttrBaxcel",f:$C},64:{n:"PtgAttrSpace",f:gre},65:{n:"PtgAttrSpaceSemi",f:vre},128:{n:"PtgAttrIfError",f:mre},255:{}};function fne(e,t,r,n){if(n.biff<8)return zi(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Ire(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Dre(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(zi(e,t)),i}function dne(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=UC[i]||UC[lne[i]],(i===24||i===25)&&(a=(i===24?cne:une)[e[e.l+1]]),!a||!a.f?zi(e,t):s.push([a.n,a.f(e,t,r)]);return s}function hne(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var pne={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mne(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function j3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function zC(e,t,r){var n=j3(e,t,r);return n=="#REF"?n:bf(n,r)}function Cc(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},c=[],f,h,d,m=0,x=0,g,b="";if(!e[0]||!e[0][0])return"";for(var _=-1,w="",S=0,A=e[0].length;S<A;++S){var T=e[0][S];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),_>=0){switch(e[0][_][1][0]){case 0:w=_r(" ",e[0][_][1][1]);break;case 1:w=_r("\r",e[0][_][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}h=h+w,_=-1}c.push(h+pne[T[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(mne(h,f));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Qu(T[1][1],s,a),c.push(Ju(d,i));break;case"PtgRefN":d=r?Qu(T[1][1],r,a):T[1][1],c.push(Ju(d,i));break;case"PtgRef3d":m=T[1][1],d=Qu(T[1][2],s,a),b=zC(n,m,a),c.push(b+"!"+Ju(d,i));break;case"PtgFunc":case"PtgFuncVar":var D=T[1][0],O=T[1][1];D||(D=0),D&=127;var I=D==0?[]:c.slice(-D);c.length-=D,O==="User"&&(O=I.shift()),c.push(O+"("+I.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":g=SC(T[1][1],r?{s:r}:s,a),c.push(Cv(g,a));break;case"PtgArea":g=SC(T[1][1],s,a),c.push(Cv(g,a));break;case"PtgArea3d":m=T[1][1],g=T[1][2],b=zC(n,m,a),c.push(b+"!"+Cv(g,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=T[1][2];var j=(n.names||[])[x-1]||(n[0]||[])[x],z=j?j.Name:"SH33TJSNAME"+String(x);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),c.push(z);break;case"PtgNameX":var R=T[1][1];x=T[1][2];var q;if(a.biff<=5)R<0&&(R=-R),n[R]&&(q=n[R][x]);else{var V="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][x]&&n[R][x].itab>0&&(V=n.SheetNames[n[R][x].itab-1]+"!"):V=n.SheetNames[x-1]+"!"),n[R]&&n[R][x])V+=n[R][x].Name;else if(n[0]&&n[0][x])V+=n[0][x].Name;else{var J=(j3(n,R,a)||"").split(";;");J[x-1]?V=J[x-1]:V+="SH33TJSERRX"}c.push(V);break}q||(q={Name:"SH33TJSERRY"}),c.push(q.Name);break;case"PtgParen":var ue="(",Ne=")";if(_>=0){switch(w="",e[0][_][1][0]){case 2:ue=_r(" ",e[0][_][1][1])+ue;break;case 3:ue=_r("\r",e[0][_][1][1])+ue;break;case 4:Ne=_r(" ",e[0][_][1][1])+Ne;break;case 5:Ne=_r("\r",e[0][_][1][1])+Ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}c.push(ue+c.pop()+Ne);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var pe={c:r.c,r:r.r};if(n.sharedf[Pr(d)]){var Ie=n.sharedf[Pr(d)];c.push(Cc(Ie,s,pe,n,a))}else{var xe=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Cc(h[1],s,pe,n,a)),xe=!0;break}xe||c.push(T[1])}break;case"PtgArray":c.push("{"+hne(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&_>=0&&ye.indexOf(e[0][S][0])==-1){T=e[0][_];var ge=!0;switch(T[1][0]){case 4:ge=!1;case 0:w=_r(" ",T[1][1]);break;case 5:ge=!1;case 1:w=_r("\r",T[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((ge?w:"")+c.pop()+(ge?"":w)),_=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]=="TRUE"?!0:c[0]=="FALSE"?!1:c[0]}function xne(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ml(e);return ml(0)}function gne(e,t,r,n,a){var i=xl(t,r,a),s=xne(e.v),c=be(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var h=be(e.bf.length),d=0;d<e.bf.length;++d)h[d]=e.bf[d];var m=Gr([i,s,c,h]);return m}function Kp(e,t,r){var n=e.read_shift(4),a=dne(e,n,r),i=e.read_shift(4),s=i>0?fne(e,i,a,r):null;return[a,s]}var vne=Kp,Gp=Kp,yne=Kp,wne=Kp;function HC(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=be(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=be(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function bne(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function _ne(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function Sne(e){var t=be(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=be(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=be(4);return n.write_shift(4,0),Gr([t,r,n])}function Nne(e){var t=Nr(e),r=be(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function Ene(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=Nr(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=be(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function Tne(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=be(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function kne(e){var t=e.split(":"),r=t[0],n=be(23);n.write_shift(4,15),r=t[0];var a=Nr(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=Nr(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function Cne(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=be(27);i.write_shift(4,19);var s=a[0],c=Nr(s);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,c.r),i.write_shift(2,c.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=a[1],c=Nr(s),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,c.r),i.write_shift(2,c.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function Ane(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=kn(e),i=be(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function jne(e,t){if(typeof e=="number")return HC(e);if(typeof e=="boolean")return _ne(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return bne(+Fi[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Nne(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kne(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Ane(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Ene(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Cne(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return Tne(e,t);if(/^".*"$/.test(e))return Sne(e);if(/^[+-]\d+$/.test(e))return HC(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var Pne=jne,One={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},P3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Dne={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ine(e){var t="of:="+e.replace(Wp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function O3(e){return e.replace(/!/,".").replace(/:/,":.")}var ef=typeof Map<"u";function Rb(e,t,r){var n=0,a=e.length;if(r){if(ef?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ef?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(ef?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Yp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(fs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Hh(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ty(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function D3(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function No(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){oJ(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Rne(e,t,r){if(e&&e["!ref"]){var n=gr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Fne(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zr(e[r])+'"/>';return t+"</mergeCells>"}function Mne(e,t,r,n,a){var i=!1,s={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,s.codeName=vf(At(f))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),c=(c||"")+Ze("outlinePr",null,h)}!i&&!c||(a[a.length]=Ze("sheetPr",c,s))}var Lne=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Bne=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $ne(e){var t={sheet:1};return Lne.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Bne.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=g3(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,t)}function Une(e){return D3(e),Ze("pageMargins",null,e)}function zne(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ze("col",null,Yp(a,n)));return r[r.length]="</cols>",r.join("")}function Hne(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Zr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=kn(a);s.s.r==s.e.r&&(s.e.r=kn(t["!ref"]).e.r,a=Zr(s));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref=bf(r.SheetNames[n])+"!"+wf(a);break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ze("autoFilter",null,{ref:a})}function Wne(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,a),{})}function Vne(e,t,r,n,a,i,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var c="",f=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":c=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",c=sa[e.v=36]):isFinite(e.v)?c=""+e.v:(e.t="e",c=sa[e.v=7]);break;case"e":c=sa[e.v];break;case"d":if(n&&n.cellDates){var d=Sa(e.v,s);c=d.toISOString(),d.getUTCFullYear()<1900&&(c=c.slice(c.indexOf("T")+1).replace("Z",""))}else e=Gn(e),e.t="n",c=""+(e.v=An(Sa(e.v,s),s));typeof e.z>"u"&&(e.z=xr[14]);break;default:c=e.v;break}var m=e.t=="z"||e.v==null?"":En("v",At(c)),x={r:t},g=No(n.cellXfs,e,n);switch(g!==0&&(x.s=g),e.t){case"n":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){m=En("v",""+Rb(n.Strings,e.v,n.revStrings)),x.t="s";break}else x.t="str";break}if(e.t!=f&&(e.t=f,e.v=h),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;m=Ze("f",At(e.f),b)+(e.v!=null?m:"")}return e.l&&(e.l.display=At(c),r["!links"].push([t,e.l])),e.D&&(x.cm=1),Ze("c",m,x)}function Kne(e,t,r,n){var a=[],i=[],s=gr(e["!ref"]),c="",f,h="",d=[],m=0,x=0,g=e["!rows"],b=e["!data"]!=null,_=b?e["!data"]:[],w={r:h},S,A=-1,T=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(x=s.s.c;x<=s.e.c;++x)d[x]=tr(x);for(m=s.s.r;m<=s.e.r;++m){i=[],h=ar(m);var D=b?_[m]:[];for(x=s.s.c;x<=s.e.c;++x){f=d[x]+h;var O=b?D[x]:e[f];O!==void 0&&(c=Vne(O,f,e,t,r,n,T))!=null&&i.push(c)}(i.length>0||g&&g[m])&&(w={r:h},g&&g[m]&&(S=g[m],S.hidden&&(w.hidden=1),A=-1,S.hpx?A=Wh(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(w.ht=A,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),a[a.length]=Ze("row",i.join(""),w))}if(g)for(;m<g.length;++m)g&&g[m]&&(w={r:m+1},S=g[m],S.hidden&&(w.hidden=1),A=-1,S.hpx?A=Wh(S.hpx):S.hpt&&(A=S.hpt),A>-1&&(w.ht=A,w.customHeight=1),S.level&&(w.outlineLevel=S.level),a[a.length]=Ze("row","",w));return a.join("")}function Gne(e,t,r,n){var a=[Jr,Ze("worksheet",null,{xmlns:Vc[0],"xmlns:r":xn.r})],i=r.SheetNames[e],s=0,c="",f=r.Sheets[i];f==null&&(f={});var h=f["!ref"]||"A1",d=gr(h);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=Zr(d)}n||(n={}),f["!comments"]=[];var m=[];Mne(f,r,e,t,a),a[a.length]=Ze("dimension",null,{ref:h}),a[a.length]=Wne(f,t,e,r),t.sheetFormat&&(a[a.length]=Ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=zne(f,f["!cols"])),a[s=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=Kne(f,t,e,r),c.length>0&&(a[a.length]=c)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),f["!protect"]&&(a[a.length]=$ne(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=Hne(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Fne(f["!merges"]));var x=-1,g,b=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=Yt(n,-1,At(_[1].Target).replace(/#[\s\S]*$/,""),Mt.HLINK),g["r:id"]="rId"+b),(x=_[1].Target.indexOf("#"))>-1&&(g.location=At(_[1].Target.slice(x+1))),_[1].Tooltip&&(g.tooltip=At(_[1].Tooltip)),g.display=_[1].display,a[a.length]=Ze("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Une(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=En("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:h}))),m.length>0&&(b=Yt(n,-1,"../drawings/drawing"+(e+1)+".xml",Mt.DRAW),a[a.length]=Ze("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=m),f["!comments"].length>0&&(b=Yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Mt.VML),a[a.length]=Ze("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Yne(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Xne(e,t,r){var n=be(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Wh(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var h={r:e,c:0},d=r["!data"]!=null,m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,g=-1,b=m<<10;b<m+1<<10;++b){h.c=b;var _=d?(r["!data"][h.r]||[])[h.c]:r[Pr(h)];_&&(x<0&&(x=b),g=b)}x<0||(++c,n.write_shift(4,x),n.write_shift(4,g))}var w=n.l;return n.l=f,n.write_shift(4,c),n.l=w,n.length>n.l?n.slice(0,n.l):n}function qne(e,t,r,n){var a=Xne(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Be(e,0,a)}var Zne=Sl,Qne=Yc;function Jne(){}function eae(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=YJ(e),r}function tae(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return $h({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),QO(e,r),r.slice(0,r.l)}function rae(e){var t=li(e);return[t]}function nae(e,t,r){return r==null&&(r=be(8)),wl(t,r)}function aae(e){var t=bl(e);return[t]}function iae(e,t,r){return r==null&&(r=be(4)),_l(t,r)}function sae(e){var t=li(e),r=e.read_shift(1);return[t,r,"b"]}function oae(e,t,r){return r==null&&(r=be(9)),wl(t,r),r.write_shift(1,e.v?1:0),r}function lae(e){var t=bl(e),r=e.read_shift(1);return[t,r,"b"]}function cae(e,t,r){return r==null&&(r=be(5)),_l(t,r),r.write_shift(1,e.v?1:0),r}function uae(e){var t=li(e),r=e.read_shift(1);return[t,r,"e"]}function Dv(e,t,r){return r==null&&(r=be(9)),wl(t,r),r.write_shift(1,e.v),r}function fae(e){var t=bl(e),r=e.read_shift(1);return[t,r,"e"]}function Iv(e,t,r){return r==null&&(r=be(8)),_l(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function dae(e){var t=li(e),r=e.read_shift(4);return[t,r,"s"]}function hae(e,t,r){return r==null&&(r=be(12)),wl(t,r),r.write_shift(4,t.v),r}function pae(e){var t=bl(e),r=e.read_shift(4);return[t,r,"s"]}function mae(e,t,r){return r==null&&(r=be(8)),_l(t,r),r.write_shift(4,t.v),r}function xae(e){var t=li(e),r=Xc(e);return[t,r,"n"]}function gae(e,t,r){return r==null&&(r=be(16)),wl(t,r),ml(e.v,r),r}function vae(e){var t=bl(e),r=Xc(e);return[t,r,"n"]}function yae(e,t,r){return r==null&&(r=be(12)),_l(t,r),ml(e.v,r),r}function wae(e){var t=li(e),r=Pb(e);return[t,r,"n"]}function bae(e,t,r){return r==null&&(r=be(12)),wl(t,r),JO(e.v,r),r}function _ae(e){var t=bl(e),r=Pb(e);return[t,r,"n"]}function Sae(e,t,r){return r==null&&(r=be(8)),_l(t,r),JO(e.v,r),r}function Nae(e){var t=li(e),r=Ab(e);return[t,r,"is"]}function Eae(e){var t=li(e),r=Vn(e);return[t,r,"str"]}function Tae(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(12+4*e.v.length)),wl(t,r),sn(n,r),r.length>r.l?r.slice(0,r.l):r}function kae(e){var t=bl(e),r=Vn(e);return[t,r,"str"]}function Cae(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(8+4*n.length)),_l(t,r),sn(n,r),r.length>r.l?r.slice(0,r.l):r}function Aae(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=Gp(e,n-e.l,r);s[3]=Cc(c,null,a,r.supbooks,r)}else e.l=n;return s}function jae(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=Gp(e,n-e.l,r);s[3]=Cc(c,null,a,r.supbooks,r)}else e.l=n;return s}function Pae(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=Xc(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=Gp(e,n-e.l,r);s[3]=Cc(c,null,a,r.supbooks,r)}else e.l=n;return s}function Oae(e,t,r){var n=e.l+t,a=li(e);a.r=r["!row"];var i=Vn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=Gp(e,n-e.l,r);s[3]=Cc(c,null,a,r.supbooks,r)}else e.l=n;return s}var Dae=Sl,Iae=Yc;function Rae(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function Fae(e,t){var r=e.l+t,n=Sl(e),a=Hp(e),i=Vn(e),s=Vn(e),c=Vn(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:c};return s&&(f.Tooltip=s),f}function Mae(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Yc({s:Nr(e[0]),e:Nr(e[0])},r),jb("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return sn(a||"",r),sn(e[1].Tooltip||"",r),sn("",r),r.slice(0,r.l)}function Lae(){}function Bae(e,t,r){var n=e.l+t,a=e3(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var c=vne(e,n-e.l,r);s[1]=c}else e.l=n;return s}function $ae(e,t,r){var n=e.l+t,a=Sl(e),i=[a];if(r.cellFormula){var s=wne(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Uae(e,t,r){r==null&&(r=be(18));var n=Yp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var I3=["left","right","top","bottom","header","footer"];function zae(e){var t={};return I3.forEach(function(r){t[r]=Xc(e)}),t}function Hae(e,t){return t==null&&(t=be(48)),D3(e),I3.forEach(function(r){ml(e[r],t)}),t}function Wae(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Vae(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Kae(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),Yc(e,t),t}function Gae(e,t){return t==null&&(t=be(66)),t.write_shift(2,e.password?g3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Yae(){}function Xae(){}function qae(e,t,r,n,a,i,s,c){var f={r,c:n};if(t.c&&i["!comments"].push([Pr(f),t.c]),t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=Gn(t),t.z=t.z||xr[14],t.v=An(Sa(t.v,c),c),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}switch(f.s=No(a.cellXfs,t,a),t.l&&i["!links"].push([Pr(f),t.l]),t.t){case"s":case"str":return a.bookSST?(h=Rb(a.Strings,t.v==null?"":String(t.v),a.revStrings),f.t="s",f.v=h,s?Be(e,18,mae(t,f)):Be(e,7,hae(t,f))):(f.t="str",s?Be(e,17,Cae(t,f)):Be(e,6,Tae(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Be(e,13,Sae(t,f)):Be(e,2,bae(t,f)):isFinite(t.v)?s?Be(e,16,yae(t,f)):Be(e,5,gae(t,f)):(f.t="e",isNaN(t.v)?s?Be(e,14,Iv({v:36},f)):Be(e,3,Dv({v:36},f)):s?Be(e,14,Iv({v:7},f)):Be(e,3,Dv({v:7},f))),!0;case"b":return f.t="b",s?Be(e,15,cae(t,f)):Be(e,4,oae(t,f)),!0;case"e":return f.t="e",s?Be(e,14,Iv(t,f)):Be(e,3,Dv(t,f)),!0}return s?Be(e,12,iae(t,f)):Be(e,1,nae(t,f)),!0}function Zae(e,t,r,n,a){var i=gr(t["!ref"]||"A1"),s="",c=[],f=(((a||{}).Workbook||{}).WBProps||{}).date1904;Be(e,145);var h=t["!data"]!=null,d=h?t["!data"][i.s.r]:[],m=i.e.r;t["!rows"]&&(m=Math.max(i.e.r,t["!rows"].length-1));for(var x=i.s.r;x<=m;++x)if(s=ar(x),h&&(d=t["!data"][x]),qne(e,t,i,x),!(h&&!d)){var g=!1;if(x<=i.e.r)for(var b=i.s.c;b<=i.e.c;++b){x===i.s.r&&(c[b]=tr(b));var _=h?d[b]:t[c[b]+s];if(!_){g=!1;continue}g=qae(e,_,x,b,n,t,g,f)}}Be(e,146)}function Qae(e,t){!t||!t["!merges"]||(Be(e,177,Rae(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,Iae(r))}),Be(e,178))}function Jae(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,n){r&&Be(e,60,Uae(n,r))}),Be(e,391))}function eie(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,Kae(gr(t["!ref"]))),Be(e,650))}function tie(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Yt(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),Mt.HLINK);Be(e,494,Mae(n,a))}}),delete t["!links"]}function rie(e,t,r,n){if(t["!comments"].length>0){var a=Yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Mt.VML);Be(e,551,jb("rId"+a)),t["!legacy"]=a}}function nie(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Zr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,c=kn(i);c.s.r==c.e.r&&(c.e.r=kn(t["!ref"]).e.r,i=Zr(c));for(var f=0;f<s.length;++f){var h=s[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref=bf(r.SheetNames[n])+"!"+wf(i);break}}f==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:bf(r.SheetNames[n])+"!"+wf(i)}),Be(e,161,Yc(gr(i))),Be(e,162)}}function aie(e,t,r){Be(e,133),Be(e,137,Vae(t,r)),Be(e,138),Be(e,134)}function iie(e,t){t["!protect"]&&Be(e,535,Gae(t["!protect"]))}function sie(e,t,r,n){var a=Wn(),i=r.SheetNames[e],s=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var f=gr(s["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Be(a,129),(r.vbaraw||s["!outline"])&&Be(a,147,tae(c,s["!outline"])),Be(a,148,Qne(f)),aie(a,s,r.Workbook),Jae(a,s),Zae(a,s,e,t,r),iie(a,s),nie(a,s,r,e),Qae(a,s),tie(a,s,n),s["!margins"]&&Be(a,476,Hae(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&eie(a,s),rie(a,s,e,n),Be(a,130),a.end()}function oie(e,t){e.l+=10;var r=Vn(e);return{name:r}}var lie=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function cie(e){return!e.Workbook||!e.Workbook.WBProps?"false":EJ(e.Workbook.WBProps.date1904)?"true":"false"}var uie=":][*?/\\".split("");function R3(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");uie.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function fie(e,t,r){e.forEach(function(n,a){R3(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function die(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];fie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Rne(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(f){f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a&&(s=f)});var c=bf(n)+"!"+wf(i["!autofilter"].ref);s?s.Ref=c:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:c})}})}function hie(e){var t=[Jr];t[t.length]=Ze("workbook",null,{xmlns:Vc[0],"xmlns:r":xn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(lie.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ze("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:At(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ze("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(t[t.length]=Ze("definedName",At(c.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function pie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ey(e),r.name=Vn(e),r}function mie(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),jb(e.strRelID,t),sn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function xie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Vn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function gie(e,t){t||(t=be(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),QO(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function vie(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=XJ(e),c,f="";try{c=yne(e,0,r);try{f=Hp(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var h={Name:s,Ptg:c,Flags:a};return i<268435455&&(h.Sheet=i),f&&(h.Comment=f),h}function yie(e,t){var r=be(9),n=0,a=e.Name;oee.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,sn(a),Pne(e.Ref,t)];if(e.Comment)i.push(_f(e.Comment));else{var s=be(4);s.write_shift(4,4294967295),i.push(s)}return Gr(i)}function wie(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,mie(a))}Be(e,144)}function bie(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return sn("SheetJS",t),sn(Ph.version,t),sn(Ph.version,t),sn("7262",t),t.length>t.l?t.slice(0,t.l):t}function _ie(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Sie(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Be(e,135),Be(e,158,_ie(a)),Be(e,136))}}function Nie(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;Be(e,39,yie(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function Eie(e){var t=e.SheetNames.length,r=be(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function Tie(e,t){Be(e,353),Be(e,357),Be(e,362,Eie(t)),Be(e,354)}function kie(e,t){var r=Wn();return Be(r,131),Be(r,128,bie()),Be(r,153,gie(e.Workbook&&e.Workbook.WBProps||null)),Sie(r,e),wie(r,e),Tie(r,e),(e.Workbook||{}).Names&&Nie(r,e),Be(r,132),r.end()}function Cie(e,t){var r=[];return e.Props&&r.push(dee(e.Props,t)),e.Custprops&&r.push(hee(e.Props,e.Custprops)),r.join("")}function Aie(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function jie(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ze("NumberFormat",null,{"ss:Format":At(xr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ze("Style",i.join(""),s))}),Ze("Styles",r.join(""))}function F3(e){return Ze("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+Vp(e.Ref,{r:0,c:0})})}function Pie(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(F3(a)))}return Ze("Names",r.join(""))}function Oie(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var c=a[s];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(F3(c)))}return i.join("")}function Die(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(En("ProtectContents","True")),e["!protect"].objects&&a.push(En("ProtectObjects","True")),e["!protect"].scenarios&&a.push(En("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(En("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(En("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ze("WorksheetOptions",a.join(""),{xmlns:Ra.x})}function Iie(e){return e.map(function(t){var r=NJ(t.t||""),n=Ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Ze("Comment",n,a)}).join("")}function Rie(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+At(Vp(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var f=Nr(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==s.r?"":"["+(f.r-s.r)+"]")+"C"+(f.c==s.c?"":"["+(f.c-s.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=At(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=At(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=s.c||h[d].s.r!=s.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var m="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(m="Number",x=String(e.v)):(m="Error",x=sa[isNaN(e.v)?36:7]);break;case"b":m="Boolean",x=e.v?"1":"0";break;case"e":m="Error",x=sa[e.v];break;case"d":m="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xr[14]);break;case"s":m="String",x=SJ(e.v||"");break}var g=No(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=s.c+1;var b=e.v!=null?x:"",_=e.t=="z"?"":'<Data ss:Type="'+m+'">'+b+"</Data>";return(e.c||[]).length>0&&(_+=Iie(e.c)),Ze("Cell",_,c)}function Fie(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=y3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Mie(e,t,r,n){if(!e["!ref"])return"";var a=gr(e["!ref"]),i=e["!merges"]||[],s=0,c=[];e["!cols"]&&e["!cols"].forEach(function(w,S){Db(w);var A=!!w.width,T=Yp(S,w),D={"ss:Index":S+1};A&&(D["ss:Width"]=zh(T.width)),w.hidden&&(D["ss:Hidden"]="1"),c.push(Ze("Column",null,D))});for(var f=e["!data"]!=null,h={r:0,c:0},d=a.s.r;d<=a.e.r;++d){var m=[Fie(d,(e["!rows"]||[])[d])];h.r=d;for(var x=a.s.c;x<=a.e.c;++x){h.c=x;var g=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>x)&&!(i[s].s.r>d)&&!(i[s].e.c<x)&&!(i[s].e.r<d)){(i[s].s.c!=x||i[s].s.r!=d)&&(g=!0);break}if(!g){var b=tr(x)+ar(d),_=f?(e["!data"][d]||[])[x]:e[b];m.push(Rie(_,b,e,t,r,n,h))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function Lie(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Oie(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Mie(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Die(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+Vp(wf(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function Bie(e,t){t||(t={}),e.SSF||(e.SSF=Gn(xr)),e.SSF&&($p(),Bp(e.SSF),t.revssf=Up(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Cie(e,t)),r.push(Aie(e)),r.push(""),r.push(Pie(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Ze("Worksheet",Lie(n,t,e),{"ss:Name":At(e.SheetNames[n])}));return r[2]=jie(e,t),Jr+Ze("Workbook",r.join(""),{xmlns:Ra.ss,"xmlns:o":Ra.o,"xmlns:x":Ra.x,"xmlns:ss":Ra.ss,"xmlns:dt":Ra.dt,"xmlns:html":Ra.html})}var Rv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $ie(e,t){var r=[],n=[],a=[],i=0,s,c=pC(EC,"n"),f=pC(TC,"n");if(e.Props)for(s=qr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=qr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(f,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var h=[];for(i=0;i<a.length;++i)u3.indexOf(a[i][0])>-1||o3.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);n.length&&or.utils.cfb_add(t,"/SummaryInformation",PC(n,Rv.SI,f,TC)),(r.length||h.length)&&or.utils.cfb_add(t,"/DocumentSummaryInformation",PC(r,Rv.DSI,c,EC,h.length?h:null,Rv.UDI))}function Uie(e,t){var r=t||{},n=or.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return or.utils.cfb_add(n,a,L3(e,r)),r.biff==8&&(e.Props||e.Custprops)&&$ie(e,n),r.biff==8&&e.vbaraw&&Zte(n,or.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var zie={0:{f:Yne},1:{f:rae},2:{f:wae},3:{f:uae},4:{f:sae},5:{f:xae},6:{f:Eae},7:{f:dae},8:{f:Oae},9:{f:Pae},10:{f:Aae},11:{f:jae},12:{f:aae},13:{f:_ae},14:{f:fae},15:{f:lae},16:{f:vae},17:{f:kae},18:{f:pae},19:{f:Ab},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vie},40:{},42:{},43:{f:xte},44:{f:pte},45:{f:yte},46:{f:bte},47:{f:wte},48:{},49:{f:zJ},50:{},51:{f:Mte},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Kee},62:{f:Nae},63:{f:Wte},64:{f:Yae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Wae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:eae},148:{f:Zne,p:16},151:{f:Lae},152:{},153:{f:xie},154:{},155:{},156:{f:pie},157:{},158:{},159:{T:1,f:nte},160:{T:-1},161:{T:1,f:Sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Dae},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Rte},336:{T:-1},337:{f:$te,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ey},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Uee},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Bae},427:{f:$ae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jne},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Fae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ey},551:{f:Hp},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Xte},633:{T:1},634:{T:-1},635:{T:1,f:Gte},636:{T:-1},637:{f:KJ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Xae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ze(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Tb(r)&&e.push(r)}}function Hie(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],c=0,f=0,h=0;h+(s[c]||8224)<=8224;)h+=s[c]||8224,c++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h;f<a;){for(d=e.next(4),d.write_shift(2,60),h=0;h+(s[c]||8224)<=8224;)h+=s[c]||8224,c++;d.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h}}}function Fv(e,t,r,n){var a=be(9);return Gf(a,e,t),f3(r,n||"b",a),a}function Wie(e,t,r){var n=be(8+2*r.length);return Gf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function M3(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return ze(e,28,Pv(n,r[1],r[2]));ze(e,28,Pv(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)ze(e,28,Pv(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function Vie(e,t,r,n,a,i){var s=0;t.z!=null&&(s=a._BIFF2FmtTable.indexOf(t.z),s==-1&&(a._BIFF2FmtTable.push(t.z),s=a._BIFF2FmtTable.length-1));var c=0;if(t.z!=null){for(;c<a.cellXfs.length&&a.cellXfs[c].numFmtId!=s;++c);c==a.cellXfs.length&&a.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var f=t.t=="d"?An(Sa(t.v,i),i):t.v;a.biff==2&&f==(f|0)&&f>=0&&f<65536?ze(e,2,qee(r,n,f,c,s)):isNaN(f)?ze(e,5,Fv(r,n,36,"e")):isFinite(f)?ze(e,3,Xee(r,n,f,c,s)):ze(e,5,Fv(r,n,7,"e"));return;case"b":case"e":ze(e,5,Fv(r,n,t.v,t.t));return;case"s":case"str":ze(e,4,Wie(r,n,t.v==null?"":String(t.v).slice(0,255)));return}ze(e,1,Gf(null,r,n))}function Kie(e,t,r,n,a){var i=t["!data"]!=null,s=gr(t["!ref"]||"A1"),c="",f=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var h=(((a||{}).Workbook||{}).WBProps||{}).date1904,d=[],m=[],x=s.s.c;x<=s.e.c;++x)f[x]=tr(x);for(var g=s.s.r;g<=s.e.r;++g)for(i&&(d=t["!data"][g]||[]),c=ar(g),x=s.s.c;x<=s.e.c;++x){var b=i?d[x]:t[f[x]+c];b&&(Vie(e,b,g,x,n,h),b.c&&m.push([b.c,g,x]))}M3(e,m)}function Gie(e,t){for(var r=t||{},n=Wn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);ze(n,r.biff==4?1033:r.biff==3?521:9,Ob(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&ze(n,34,$n(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=Wn();return Kie(s,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(c){r.biff<=3?ze(n,30,Iee(c)):ze(n,1054,Ree(c))}),r.cellXfs.forEach(function(c){switch(r.biff){case 2:ze(n,67,Mee(c));break;case 3:ze(n,579,m3(c));break;case 4:ze(n,1091,Lee(c));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),ze(n,10),n.end()}var gi=1,ei=[];function Yie(){var e=be(82+8*ei.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*ei.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*ei.length);{e.write_shift(4,gi),e.write_shift(4,ei.length+1);for(var t=0,r=0;r<ei.length;++r)t+=ei[r]&&ei[r][1]||0;e.write_shift(4,t),e.write_shift(4,ei.length)}ei.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function Xie(e,t){var r=[],n=0,a=Wn(),i=gi,s;t.forEach(function(f,h){var d="",m=f[0].map(function(T){return T.a&&!d&&(d=T.a),T.t}).join("");++gi;{var x=be(150);x.write_shift(2,15),x.write_shift(2,61444),x.write_shift(4,150),x.write_shift(2,3234),x.write_shift(2,61450),x.write_shift(4,8),x.write_shift(4,gi),x.write_shift(4,2560),x.write_shift(2,227),x.write_shift(2,61451),x.write_shift(4,84),x.write_shift(2,128),x.write_shift(4,0),x.write_shift(2,139),x.write_shift(4,2),x.write_shift(2,191),x.write_shift(4,524296),x.write_shift(2,344),x.l+=4,x.write_shift(2,385),x.write_shift(4,134217808),x.write_shift(2,387),x.write_shift(4,134217808),x.write_shift(2,389),x.write_shift(4,268435700),x.write_shift(2,447),x.write_shift(4,1048592),x.write_shift(2,448),x.write_shift(4,134217809),x.write_shift(2,451),x.write_shift(4,268435700),x.write_shift(2,513),x.write_shift(4,134217809),x.write_shift(2,515),x.write_shift(4,268435700),x.write_shift(2,575),x.write_shift(4,196609),x.write_shift(2,959),x.write_shift(4,131072|(f[0].hidden?2:0)),x.l+=2,x.write_shift(2,61456),x.write_shift(4,18),x.write_shift(2,3),x.write_shift(2,f[2]+2),x.l+=2,x.write_shift(2,f[1]+1),x.l+=2,x.write_shift(2,f[2]+4),x.l+=2,x.write_shift(2,f[1]+5),x.l+=2,x.l+=2,x.write_shift(2,61457),x.l+=4,x.l=150,h==0?s=x:ze(a,236,x)}n+=150;{var g=be(52);g.write_shift(2,21),g.write_shift(2,18),g.write_shift(2,25),g.write_shift(2,gi),g.write_shift(2,0),g.l=22,g.write_shift(2,13),g.write_shift(2,22),g.write_shift(4,1651663474),g.write_shift(4,2503426821),g.write_shift(4,2150634280),g.write_shift(4,1768515844+gi*256),g.write_shift(2,0),g.write_shift(4,0),g.l+=4,ze(a,93,g)}{var b=be(8);b.l+=2,b.write_shift(2,61453),b.l+=4,ze(a,236,b)}n+=8;{var _=be(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,m.length),_.write_shift(2,16),_.l+=4,ze(a,438,_);{var w=be(1+m.length);w.write_shift(1,0),w.write_shift(m.length,m,"sbcs"),ze(a,60,w)}{var S=be(16);S.l+=8,S.write_shift(2,m.length),S.l+=6,ze(a,60,S)}}{var A=be(12+d.length);A.write_shift(2,f[1]),A.write_shift(2,f[2]),A.write_shift(2,0|(f[0].hidden?0:2)),A.write_shift(2,gi),A.write_shift(2,d.length),A.write_shift(1,0),A.write_shift(d.length,d,"sbcs"),A.l++,r.push(A)}});{var c=be(80);c.write_shift(2,15),c.write_shift(2,61442),c.write_shift(4,n+c.length-8),c.write_shift(2,16),c.write_shift(2,61448),c.write_shift(4,8),c.write_shift(4,t.length+1),c.write_shift(4,gi),c.write_shift(2,15),c.write_shift(2,61443),c.write_shift(4,n+48),c.write_shift(2,15),c.write_shift(2,61444),c.write_shift(4,40),c.write_shift(2,1),c.write_shift(2,61449),c.write_shift(4,16),c.l+=16,c.write_shift(2,2),c.write_shift(2,61450),c.write_shift(4,8),c.write_shift(4,i),c.write_shift(4,5),ze(e,236,s?Gr([c,s]):c)}e.push(a.end()),r.forEach(function(f){ze(e,28,f)}),ei.push([i,t.length+1,gi]),++gi}function qie(e,t,r){ze(e,49,jee({sz:12,name:"Arial"},r))}function Zie(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,1054,Dee(a,t[a],r))})}function Qie(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),p3(gr(t["!ref"]||"A1"),r),r.write_shift(4,4),ze(e,2152,r)}function Jie(e,t){for(var r=0;r<16;++r)ze(e,224,DC({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ze(e,224,DC(n,0,t))})}function ese(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ze(e,440,Hee(n)),n[1].Tooltip&&ze(e,2048,Wee(n))}delete t["!links"]}function tse(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ze(e,125,Gee(Yp(a,n),a))})}}function rse(e,t,r,n,a,i){var s=16+No(a.cellXfs,t,a);if(t.v==null&&!t.bf){ze(e,513,xl(r,n,s));return}if(t.bf)ze(e,6,gne(t,r,n,a,s));else switch(t.t){case"d":case"n":var c=t.t=="d"?An(Sa(t.v,i),i):t.v;isNaN(c)?ze(e,517,jv(r,n,36,s,a,"e")):isFinite(c)?ze(e,515,$ee(r,n,c,s)):ze(e,517,jv(r,n,7,s,a,"e"));break;case"b":case"e":ze(e,517,jv(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var f=Rb(a.Strings,t.v==null?"":String(t.v),a.revStrings);ze(e,253,Pee(r,n,f,s))}else ze(e,516,Oee(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,a));break;default:ze(e,513,xl(r,n,s))}}function nse(e,t,r){var n=Wn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},c=(s.Sheets||[])[e]||{},f=i["!data"]!=null,h=t.biff==8,d="",m=[],x=gr(i["!ref"]||"A1"),g=h?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+g);x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.r,g-1)}ze(n,2057,Ob(r,16,t)),ze(n,13,ti(1)),ze(n,12,ti(100)),ze(n,15,$n(!0)),ze(n,17,$n(!1)),ze(n,16,ml(.001)),ze(n,95,$n(!0)),ze(n,42,$n(!1)),ze(n,43,$n(!1)),ze(n,130,ti(1)),ze(n,128,Bee()),ze(n,131,$n(!1)),ze(n,132,$n(!1)),h&&tse(n,i["!cols"]),ze(n,512,Fee(x,t));var b=(((r||{}).Workbook||{}).WBProps||{}).date1904;h&&(i["!links"]=[]);for(var _=x.s.c;_<=x.e.c;++_)m[_]=tr(_);for(var w=[],S=[],A=x.s.r;A<=x.e.r;++A)for(f&&(S=i["!data"][A]||[]),d=ar(A),_=x.s.c;_<=x.e.c;++_){var T=f?S[_]:i[m[_]+d];T&&(rse(n,T,A,_,t,b),h&&T.l&&i["!links"].push([m[_]+d,T.l]),T.c&&w.push([T.c,A,_]))}var D=c.CodeName||c.name||a;return h?Xie(n,w):M3(n,w),h&&ze(n,574,Aee((s.Views||[])[0])),h&&(i["!merges"]||[]).length&&ze(n,229,zee(i["!merges"])),h&&ese(n,i),ze(n,442,h3(D)),h&&Qie(n,i),ze(n,10),n.end()}function ase(e,t,r){var n=Wn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},c=r.biff==8,f=r.biff==5;if(ze(n,2057,Ob(e,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,c?ti(1200):null),ze(n,193,xee(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,Eee("SheetJS",r)),ze(n,66,ti(c?1200:1252)),c&&ze(n,353,ti(0)),c&&ze(n,448),ze(n,317,Yee(e.SheetNames.length)),c&&e.vbaraw&&ze(n,211),c&&e.vbaraw){var h=s.CodeName||"ThisWorkbook";ze(n,442,h3(h))}ze(n,156,ti(17)),ze(n,25,$n(!1)),ze(n,18,$n(!1)),ze(n,19,ti(0)),c&&ze(n,431,$n(!1)),c&&ze(n,444,ti(0)),ze(n,61,Cee()),ze(n,64,$n(!1)),ze(n,141,ti(0)),ze(n,34,$n(cie(e)=="true")),ze(n,14,$n(!0)),c&&ze(n,439,$n(!1)),ze(n,218,ti(0)),qie(n,e,r),Zie(n,e.SSF,r),Jie(n,r),c&&ze(n,352,$n(!1));var d=n.end(),m=Wn();c&&ze(m,140,Vee()),c&&ei.length&&ze(m,235,Yie()),c&&r.Strings&&Hie(m,252,kee(r.Strings)),ze(m,10);var x=m.end(),g=Wn(),b=0,_=0;for(_=0;_<e.SheetNames.length;++_)b+=(c?12:11)+(c?2:1)*e.SheetNames[_].length;var w=d.length+b+x.length;for(_=0;_<e.SheetNames.length;++_){var S=i[_]||{};ze(g,133,Tee({pos:w,hs:S.Hidden||0,dt:0,name:e.SheetNames[_]},r)),w+=t[_].length}var A=g.end();if(b!=A.length)throw new Error("BS8 "+b+" != "+A.length);var T=[];return d.length&&T.push(d),A.length&&T.push(A),x.length&&T.push(x),Gr(T)}function ise(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Gn(xr)),e&&e.SSF&&($p(),Bp(e.SSF),r.revssf=Up(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),gi=1,ei=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Fb(r),r.cellXfs=[],No(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=nse(a,r,e);return n.unshift(ase(e,n,r)),Gr(n)}function L3(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=kn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ise(e,t);case 4:case 3:case 2:return Gie(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function sse(e,t,r,n){for(var a=e["!merges"]||[],i=[],s={},c=e["!data"]!=null,f=t.s.c;f<=t.e.c;++f){for(var h=0,d=0,m=0;m<a.length;++m)if(!(a[m].s.r>r||a[m].s.c>f)&&!(a[m].e.r<r||a[m].e.c<f)){if(a[m].s.r<r||a[m].s.c<f){h=-1;break}h=a[m].e.r-a[m].s.r+1,d=a[m].e.c-a[m].s.c+1;break}if(!(h<0)){var x=tr(f)+ar(r),g=c?(e["!data"][r]||[])[f]:e[x];g&&g.t=="n"&&g.v!=null&&!isFinite(g.v)&&(isNaN(g.v)?g={t:"e",v:36,w:sa[36]}:g={t:"e",v:7,w:sa[7]});var b=g&&g.v!=null&&(g.h||Tv(g.w||(vs(g),g.w)||""))||"";s={},h>1&&(s.rowspan=h),d>1&&(s.colspan=d),n.editable?b='<span contenteditable="true">'+b+"</span>":g&&(s["data-t"]=g&&g.t||"z",g.v!=null&&(s["data-v"]=Tv(g.v instanceof Date?g.v.toISOString():g.v)),g.z!=null&&(s["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+Tv(g.l.Target)+'">'+b+"</a>")),s.id=(n.id||"sjs")+"-"+x,i.push(Ze("td",b,s))}}var _="<tr>";return _+i.join("")+"</tr>"}var ose='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lse="</body></html>";function cse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function B3(e,t){var r=t||{},n=r.header!=null?r.header:ose,a=r.footer!=null?r.footer:lse,i=[n],s=kn(e["!ref"]||"A1");if(i.push(cse(e,s,r)),e["!ref"])for(var c=s.s.r;c<=s.e.r;++c)i.push(sse(e,s,c,r));return i.push("</table>"+a),i.join("")}function $3(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,s=0,c=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var f=typeof a.origin=="string"?Nr(a.origin):a.origin;s=f.r,c=f.c}var h=Math.min(a.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var m=kn(e["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),s==-1&&(d.e.r=s=m.e.r+1)}var x=[],g=0,b=e["!rows"]||(e["!rows"]=[]),_=0,w=0,S=0,A=0,T=0,D=0;for(e["!cols"]||(e["!cols"]=[]);_<n.length&&w<h;++_){var O=n[_];if(WC(O)){if(a.display)continue;b[w]={hidden:!0}}var I=O.cells;for(S=A=0;S<I.length;++S){var j=I[S];if(!(a.display&&WC(j))){var z=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):TJ(j.innerHTML),R=j.getAttribute("data-z")||j.getAttribute("z");for(g=0;g<x.length;++g){var q=x[g];q.s.c==A+c&&q.s.r<w+s&&w+s<=q.e.r&&(A=q.e.c+1-c,g=-1)}D=+j.getAttribute("colspan")||1,((T=+j.getAttribute("rowspan")||1)>1||D>1)&&x.push({s:{r:w+s,c:A+c},e:{r:w+s+(T||1)-1,c:A+c+(D||1)-1}});var V={t:"s",v:z},J=j.getAttribute("data-t")||j.getAttribute("t")||"";z!=null&&(z.length==0?V.t=J||"z":a.raw||z.trim().length==0||J=="s"||(J=="e"&&sa[+z]?V={t:"e",v:+z,w:sa[+z]}:z==="TRUE"?V={t:"b",v:!0}:z==="FALSE"?V={t:"b",v:!1}:isNaN(us(z))?isNaN(Lh(z).getDate())?z.charCodeAt(0)==35&&Fi[z]!=null&&(V={t:"e",v:Fi[z],w:z}):(V={t:"d",v:Sa(z)},a.UTC&&(V.v=zp(V.v)),a.cellDates||(V={t:"n",v:An(V.v)}),V.z=a.dateNF||xr[14]):V={t:"n",v:us(z)})),V.z===void 0&&R!=null&&(V.z=R);var ue="",Ne=j.getElementsByTagName("A");if(Ne&&Ne.length)for(var pe=0;pe<Ne.length&&!(Ne[pe].hasAttribute("href")&&(ue=Ne[pe].getAttribute("href"),ue.charAt(0)!="#"));++pe);ue&&ue.charAt(0)!="#"&&ue.slice(0,11).toLowerCase()!="javascript:"&&(V.l={Target:ue}),i?(e["!data"][w+s]||(e["!data"][w+s]=[]),e["!data"][w+s][A+c]=V):e[Pr({c:A+c,r:w+s})]=V,d.e.c<A+c&&(d.e.c=A+c),A+=D}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,w-1+s),e["!ref"]=Zr(d),w>=h&&(e["!fullref"]=Zr((d.e.r=n.length-_+w-1+s,d))),e}function U3(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),$3(n,e,t)}function use(e,t){var r=Kc(U3(e,t),t);return r}function WC(e){var t="",r=fse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function fse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var dse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+yf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Jr+t}})();function hse(e,t){var r="number",n="",a={"style:name":t},i="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+At(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+At(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var c=e.match(/# (\?+)\/(\?+)/);if(c){n+=Ze("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:max-denominator-value":Math.max(+c[1].replace(/./g,"9"),+c[2].replace(/./g,"9"))});break e}if(c=e.match(/# (\?+)\/(\d+)/)){n+=Ze("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:denominator-value":+c[2]});break e}if(c=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Ze("number:number",null,{"number:decimal-places":c[2]&&c.length-1||0,"number:min-decimal-places":c[2]&&c.length-1||0,"number:min-integer-digits":c[1].length})+"<number:text>%</number:text>";break e}var f=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"s":f=!0,--s;break t;case"m":r:for(var h=s+1;h<e.length;++h)switch(e[h]){case"y":case"d":break r;case"h":case"s":f=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+At(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++s],n+="<number:text>"+At(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+At(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!f)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do i+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+At(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+At(i)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+At(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+At(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+e);else{var m=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(m.indexOf("0")==-1?"0":m.length-m.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",s=d.index+d[0].length}if(e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+At(i.replace(/""/g,'"'))+"</number:text>"}}return n?Ze("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function VC(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var c=(r==-1?"$":"")+O3(s.Ref);return"        "+Ze("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":c,"table:base-cell-address":c.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var KC=(function(){var e=function(a,i){return At(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,s,c,f,h){var d=[];d.push('      <table:table table:name="'+At(i.SheetNames[s])+`" table:style-name="ta1">
`);var m=0,x=0,g=kn(a["!ref"]||"A1"),b=a["!merges"]||[],_=0,w=a["!data"]!=null;if(a["!cols"])for(x=0;x<=g.e.c;++x)d.push("        <table:table-column"+(a["!cols"][x]?' table:style-name="co'+a["!cols"][x].ods+'"':"")+`></table:table-column>
`);var S="",A=a["!rows"]||[];for(m=0;m<g.s.r;++m)S=A[m]?' table:style-name="ro'+A[m].ods+'"':"",d.push("        <table:table-row"+S+`></table:table-row>
`);for(;m<=g.e.r;++m){for(S=A[m]?' table:style-name="ro'+A[m].ods+'"':"",d.push("        <table:table-row"+S+`>
`),x=0;x<g.s.c;++x)d.push(t);for(;x<=g.e.c;++x){var T=!1,D={},O="";for(_=0;_!=b.length;++_)if(!(b[_].s.c>x)&&!(b[_].s.r>m)&&!(b[_].e.c<x)&&!(b[_].e.r<m)){(b[_].s.c!=x||b[_].s.r!=m)&&(T=!0),D["table:number-columns-spanned"]=b[_].e.c-b[_].s.c+1,D["table:number-rows-spanned"]=b[_].e.r-b[_].s.r+1;break}if(T){d.push(`          <table:covered-table-cell/>
`);continue}var I=Pr({r:m,c:x}),j=w?(a["!data"][m]||[])[x]:a[I];if(j&&j.f&&(D["table:formula"]=At(Ine(j.f)),j.F&&j.F.slice(0,I.length)==I)){var z=kn(j.F);D["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,D["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!j){d.push(t);continue}switch(j.t){case"b":O=j.v?"TRUE":"FALSE",D["office:value-type"]="boolean",D["office:boolean-value"]=j.v?"true":"false";break;case"n":isFinite(j.v)?(O=j.w||String(j.v||0),D["office:value-type"]="float",D["office:value"]=j.v||0):(isNaN(j.v)?(O="#NUM!",D["table:formula"]="of:=#NUM!"):(O="#DIV/0!",D["table:formula"]="of:="+(j.v<0?"-":"")+"1/0"),D["office:string-value"]="",D["office:value-type"]="string",D["calcext:value-type"]="error");break;case"s":case"str":O=j.v==null?"":j.v,D["office:value-type"]="string";break;case"d":O=j.w||Sa(j.v,h).toISOString(),D["office:value-type"]="date",D["office:date-value"]=Sa(j.v,h).toISOString(),D["table:style-name"]="ce1";break;default:d.push(t);continue}var R=e(O);if(j.l&&j.l.Target){var q=j.l.Target;q=q.charAt(0)=="#"?"#"+O3(q.slice(1)):q,q.charAt(0)!="#"&&!q.match(/^\w+:/)&&(q="../"+q),R=Ze("text:a",R,{"xlink:href":q.replace(/&/g,"&amp;")})}f[j.z]&&(D["table:style-name"]="ce"+f[j.z].slice(1));var V=Ze("text:p",R,{});if(j.c){for(var J="",ue="",Ne={},pe=0;pe<j.c.length;++pe)!J&&j.c[pe].a&&(J=j.c[pe].a),ue+="<text:p>"+e(j.c[pe].t)+"</text:p>";j.c.hidden||(Ne["office:display"]=!0),V=Ze("office:annotation",ue,Ne)+V}d.push("          "+Ze("table:table-cell",V,D)+`
`)}d.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&d.push(VC(i.Workbook.Names,i.SheetNames,s)),d.push(`      </table:table>
`),d.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var s=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var x=d["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Db(x),x.ods=s;var g=d["!cols"][m].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++s}}});var c=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=c;var x=d["!rows"][m].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var f={},h=69;return i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d){var m=d["!data"]!=null;if(d["!ref"])for(var x=kn(d["!ref"]),g=0;g<=x.e.r;++g)for(var b=0;b<=x.e.c;++b){var _=m?(d["!data"][g]||[])[b]:d[Pr({r:g,c:b})];if(!(!_||!_.z||_.z.toLowerCase()=="general")&&!f[_.z]){var w=hse(_.z,"N"+h);w&&(f[_.z]="N"+h,++h,a.push(w+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),qr(f).forEach(function(d){a.push('<style:style style:name="ce'+f[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+f[d]+`"/>
`)}),a.push(` </office:automatic-styles>
`),f};return function(i,s){var c=[Jr],f=yf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=yf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(c.push("<office:document"+f+h+`>
`),c.push(i3().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):c.push("<office:document-content"+f+`>
`);var d=n(c,i);c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&c.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var m=0;m!=i.SheetNames.length;++m)c.push(r(i.Sheets[i.SheetNames[m]],i,m,s,d,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&c.push(VC(i.Workbook.Names,i.SheetNames,-1)),c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),s.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function z3(e,t){if(t.bookType=="fods")return KC(e,t);var r=_b(),n="",a=[],i=[];return n="mimetype",Ct(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ct(r,n,KC(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ct(r,n,dse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ct(r,n,Jr+i3()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ct(r,n,fee(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ct(r,n,cee(a)),r}var ia=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function Vh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Sf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):mc(hl(e))}function Jn(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ia(vf(e))}function mo(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],s=i.length;if(s<250)for(var c=0;c<s;++c)n[a++]=i[c];else n.set(i,a),a+=s}return n}function pse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Nf(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function ct(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[ia](0,r)}function H3(e){for(var t={l:0},r=[];t.l<e.length;)r.push(Nf(e,t));return r}function W3(e){return mo(e.map(function(t){return ct(t)}))}function Ba(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function vt(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=Nf(e,r),i=a&7;a=a/8|0;var s,c=r.l;switch(i){case 0:{for(;e[c++]>=128;);s=e[ia](r.l,c),r.l=c}break;case 1:s=e[ia](c,c+8),r.l=c+8;break;case 2:{var f=Nf(e,r);s=e[ia](r.l,r.l+f),r.l+=f}break;case 5:s=e[ia](c,c+4),r.l=c+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var h={data:s,type:i};t[a]==null&&(t[a]=[]),t[a].push(h)}return t}function pt(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push(ct(n*8+a.type)),a.type==2&&t.push(ct(a.data.length)),t.push(a.data))})}),mo(t)}function Kh(e,t){return e?.map(function(r){return t(r.data)})||[]}function Gh(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Nf(e,n),i=vt(e[ia](n.l,n.l+a));n.l+=a;var s={id:Ba(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=vt(c.data),h=Ba(f[3][0].data);s.messages.push({meta:f,data:e[ia](n.l,n.l+h)}),n.l+=h}),(t=i[3])!=null&&t[0]&&(s.merge=Ba(i[3][0].data)>>>0>0),r.push(s)}return r}function vc(e){var t=[];return e.forEach(function(r){var n=[[],[{data:ct(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:ct(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ct(s.data.length)}],n[2].push({data:pt(s.meta),type:2})});var i=pt(n);t.push(ct(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),mo(t)}function mse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Nf(t,r),a=[],i=r.l;i<t.length;){var s=t[i]&3;if(s==0){var c=t[i++]>>2;if(c<60)++c;else{var f=c-59;c=t[i],f>1&&(c|=t[i+1]<<8),f>2&&(c|=t[i+2]<<16),f>3&&(c|=t[i+3]<<24),c>>>=0,c++,i+=f}a.push(t[ia](i,i+c)),i+=c;continue}else{var h=0,d=0;if(s==1?(d=(t[i]>>2&7)+4,h=(t[i++]&224)<<3,h|=t[i++]):(d=(t[i++]>>2)+1,s==2?(h=t[i]|t[i+1]<<8,i+=2):(h=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),h==0)throw new Error("Invalid offset 0");for(var m=a.length-1,x=h;m>=0&&x>=a[m].length;)x-=a[m].length,--m;if(m<0)if(x==0)x=a[m=0].length;else throw new Error("Invalid offset beyond length");if(d<x)a.push(a[m][ia](a[m].length-x,a[m].length-x+d));else{for(x>0&&(a.push(a[m][ia](a[m].length-x)),d-=x),++m;d>=a[m].length;)a.push(a[m]),d-=a[m].length,++m;d&&a.push(a[m][ia](0,d))}a.length>25&&(a=[mo(a)])}}for(var g=0,b=0;b<a.length;++b)g+=a[b].length;if(g!=n)throw new Error("Unexpected length: ".concat(g," != ").concat(n));return a}function Yh(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,mse(n,e[ia](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:mo(t)}function yc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ct(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[ia](r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return mo(t)}function Mv(e,t){var r=new Uint8Array(32),n=Vh(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&pl(e.z)){r[1]=5,n.setFloat64(a,(pc(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,pse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var c=t.rsst.findIndex(function(h){var d;return h.v==s&&h.l==((d=e.l)==null?void 0:d.Target)});c==-1&&(t.rsst[c=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,c,!0),i|=16,a+=4}else{var f=t.sst.indexOf(s);f==-1&&(t.sst[f=t.sst.length]=s),r[1]=3,n.setUint32(a,f,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(xse(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[ia](0,a)}function Lv(e,t){var r=new Uint8Array(32),n=Vh(r),a=12,i=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var c=t.rsst.findIndex(function(h){var d;return h.v==s&&h.l==((d=e.l)==null?void 0:d.Target)});c==-1&&(t.rsst[c=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,c,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var f=t.sst.indexOf(s);f==-1&&(t.sst[f=t.sst.length]=s),r[1]=3,n.setUint32(a,f,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[ia](0,a)}function Vr(e){var t=vt(e);return Ba(t[1][0].data)}function Bn(e){return pt([[],[{type:0,data:ct(e)}]])}function Ln(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?H3(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:W3(n)}])}function es(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?H3(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:W3(n.filter(function(a){return a!=t}))}]}function xse(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function gse(e,t,r){var n,a,i,s=[[],[{type:0,data:ct(0)}],[{type:0,data:ct(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ct(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ct(1)}]];if(!((n=s[6])!=null&&n[0])||!((a=s[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=0;if(s[7][0].data.length<2*e.length){var f=new Uint8Array(2*e.length);f.set(s[7][0].data),s[7][0].data=f}if(s[4][0].data.length<2*e.length){var h=new Uint8Array(2*e.length);h.set(s[4][0].data),s[4][0].data=h}for(var d=Vh(s[7][0].data),m=0,x=[],g=Vh(s[4][0].data),b=0,_=[],w=4,S=0;S<e.length;++S){if(e[S]==null||e[S].t=="z"&&!((i=e[S].c)!=null&&i.length)||e[S].t=="e"){d.setUint16(S*2,65535,!0),g.setUint16(S*2,65535);continue}d.setUint16(S*2,m/w,!0),g.setUint16(S*2,b/w,!0);var A,T;switch(e[S].t){case"d":if(e[S].v instanceof Date){A=Mv(e[S],t),T=Lv(e[S],t);break}A=Mv(e[S],t),T=Lv(e[S],t);break;case"s":case"n":case"b":case"z":A=Mv(e[S],t),T=Lv(e[S],t);break;default:throw new Error("Unsupported value "+e[S])}x.push(A),m+=A.length,_.push(T),b+=T.length,++c}for(s[2][0].data=ct(c),s[5][0].data=ct(5);S<s[7][0].data.length/2;++S)d.setUint16(S*2,65535,!0),g.setUint16(S*2,65535,!0);return s[6][0].data=mo(x),s[3][0].data=mo(_),s[8]=[{type:0,data:ct(1)}],s}function ry(e,t){return{meta:[[],[{type:0,data:ct(e)}]],data:t}}function Di(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function vse(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&Gh(Yh(a.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:i,type:Ba(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&Gh(Yh(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(s){i.meta[s]&&i.meta[s].forEach(function(c){t[a.id].deps.push(Ba(c.data))})})})})}),t}function k0(e,t,r){return pt([[],[{type:0,data:ct(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ct(1)}]])}function GC(e){switch(e){case 0:return k0(99,222,171);case 1:return k0(162,197,240);case 2:return k0(255,189,189)}return k0(Math.random()*255,Math.random()*255,Math.random()*255)}function yse(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=or.read(t.numbers,{type:"base64"}),n=vse(r),a=Ii(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=Kh(vt(a.messages[0].data)[1],Vr);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,c){c>=1&&(bse(r,n,c+1),a=Ii(r,n,1),i=Kh(vt(a.messages[0].data)[1],Vr)),_se(r,n,e.Sheets[s],s,c,i[c])}),r}function Jt(e,t,r,n){var a=or.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=Gh(Yh(a.content)),s=i.find(function(c){return c.id==r});n(s,i),a.content=yc(vc(i)),a.size=a.content.length}function Ii(e,t,r){var n=or.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=Gh(Yh(n.content)),i=a.find(function(s){return s.id==r});return i}function ny(e,t,r){e[3].push({type:2,data:pt([[],[{type:0,data:ct(t)}],[{type:2,data:Jn(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:Jn(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ct(0)}],[],[{type:0,data:ct(0)}]])}),e[1]=[{type:0,data:ct(Math.max(t+1,Ba(e[1][0].data)))}]}function Uo(e,t,r,n,a,i){i||(i=Di({deps:[],location:"",type:t},a));var s="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+s,or.utils.cfb_add(e,s,yc(vc([{id:i,messages:[ry(t,pt(r))]}])));var c=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Jt(e,a,2,function(f){var h=vt(f.messages[0].data);ny(h,i||0,c),f.messages[0].data=pt(h)}),i}function ya(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(c){var f,h,d=vt(c.data);return(f=d[3])!=null&&f[0]?Sf(d[3][0].data)==a:!!((h=d[2])!=null&&h[0]&&Sf(d[2][0].data)==a)}),s=vt(e[3][i].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(c){s[6].push({type:2,data:pt([[],[{type:0,data:ct(c)}]])})}),e[3][i].data=pt(s)}function wse(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(c){var f,h,d=vt(c.data);return(f=d[3])!=null&&f[0]?Sf(d[3][0].data)==a:!!((h=d[2])!=null&&h[0]&&Sf(d[2][0].data)==a)}),s=vt(e[3][i].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(c){return Ba(vt(c.data)[1][0].data)!=n}),e[3][i].data=pt(s)}function bse(e,t,r){var n=-1,a=-1,i={};Jt(e,t,1,function(f,h){var d=vt(f.messages[0].data);n=Vr(vt(f.messages[0].data)[1][0].data),a=Di({deps:[1],location:t[n].location,type:2},t),i[n]=a,Ln(f,a),d[1].push({type:2,data:Bn(a)});var m=Ii(e,t,n);m.id=a,t[1].location==t[a].location?h.push(m):Jt(e,t,a,function(x,g){return g.push(m)}),f.messages[0].data=pt(d)});var s=-1;Jt(e,t,a,function(f,h){for(var d=vt(f.messages[0].data),m=3;m<=69;++m)delete d[m];var x=Kh(d[2],Vr);x.forEach(function(b){return es(f,b)}),s=Di({deps:[a],location:t[x[0]].location,type:t[x[0]].type},t),Ln(f,s),i[x[0]]=s,d[2]=[{type:2,data:Bn(s)}];var g=Ii(e,t,x[0]);g.id=s,t[x[0]].location==t[a].location?h.push(g):(Jt(e,t,2,function(b){var _=vt(b.messages[0].data);ya(_,t,a,s),b.messages[0].data=pt(_)}),Jt(e,t,s,function(b,_){return _.push(g)})),f.messages[0].data=pt(d)});var c=-1;Jt(e,t,s,function(f,h){for(var d=vt(f.messages[0].data),m=vt(d[1][0].data),x=3;x<=69;++x)delete m[x];var g=Vr(m[2][0].data);m[2][0].data=Bn(i[g]),d[1][0].data=pt(m);var b=Vr(d[2][0].data);es(f,b),c=Di({deps:[s],location:t[b].location,type:t[b].type},t),Ln(f,c),i[b]=c,d[2][0].data=Bn(c);var _=Ii(e,t,b);_.id=c,t[s].location==t[c].location?h.push(_):Jt(e,t,c,function(w,S){return S.push(_)}),f.messages[0].data=pt(d)}),Jt(e,t,c,function(f,h){var d,m,x=vt(f.messages[0].data),g=Sf(x[1][0].data),b=g.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(x[1][0].data=Jn(b),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(O){return delete x[O]}),x[45]){var _=vt(x[45][0].data),w=Vr(_[1][0].data);es(f,w),delete x[45]}if(x[70]){var S=vt(x[70][0].data);(d=S[2])==null||d.forEach(function(O){var I=vt(O.data);[2,3].map(function(j){return I[j][0]}).forEach(function(j){var z=vt(j.data);if(z[8]){var R=Vr(z[8][0].data);es(f,R)}})}),delete x[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(O){if(x[O]){var I=Vr(x[O][0].data);delete x[O],es(f,I)}});var A=vt(x[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(O){var I;if((I=A[O])!=null&&I[0]){var j=Vr(A[O][0].data),z=Di({deps:[c],location:t[j].location,type:t[j].type},t);es(f,j),Ln(f,z),i[j]=z;var R=Ii(e,t,j);if(R.id=z,t[j].location==t[c].location)h.push(R);else{t[z].location=t[j].location.replace(j.toString(),z.toString()),t[z].location==t[j].location&&(t[z].location=t[z].location.replace(/\.iwa/,"-".concat(z,".iwa"))),or.utils.cfb_add(e,t[z].location,yc(vc([R])));var q=t[z].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Jt(e,t,2,function(V){var J=vt(V.messages[0].data);ny(J,z,q),ya(J,t,c,z),V.messages[0].data=pt(J)})}A[O][0].data=Bn(z)}});var T=vt(A[1][0].data);(m=T[2])==null||m.forEach(function(O){var I=Vr(O.data),j=Di({deps:[c],location:t[I].location,type:t[I].type},t);es(f,I),Ln(f,j),i[I]=j;var z=Ii(e,t,I);if(z.id=j,t[I].location==t[c].location)h.push(z);else{t[j].location=t[I].location.replace(I.toString(),j.toString()),t[j].location==t[I].location&&(t[j].location=t[j].location.replace(/\.iwa/,"-".concat(j,".iwa"))),or.utils.cfb_add(e,t[j].location,yc(vc([z])));var R=t[j].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Jt(e,t,2,function(q){var V=vt(q.messages[0].data);ny(V,j,R),ya(V,t,c,j),q.messages[0].data=pt(V)})}O.data=Bn(j)}),A[1][0].data=pt(T);var D=vt(A[3][0].data);D[1].forEach(function(O){var I=vt(O.data),j=Vr(I[2][0].data),z=i[j];if(!i[j]){z=Di({deps:[c],location:"",type:t[j].type},t),t[z].location="Root Entry/Index/Tables/Tile-".concat(z,".iwa"),i[j]=z;var R=Ii(e,t,j);R.id=z,es(f,j),Ln(f,z),or.utils.cfb_add(e,"/Index/Tables/Tile-".concat(z,".iwa"),yc(vc([R]))),Jt(e,t,2,function(q){var V=vt(q.messages[0].data);V[3].push({type:2,data:pt([[],[{type:0,data:ct(z)}],[{type:2,data:Jn("Tables/Tile")}],[{type:2,data:Jn("Tables/Tile-".concat(z))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ct(0)}],[],[{type:0,data:ct(0)}]])}),V[1]=[{type:0,data:ct(Math.max(z+1,Ba(V[1][0].data)))}],ya(V,t,c,z),q.messages[0].data=pt(V)})}I[2][0].data=Bn(z),O.data=pt(I)}),A[3][0].data=pt(D)}x[4][0].data=pt(A),f.messages[0].data=pt(x)})}function _se(e,t,r,n,a,i){var s=[];Jt(e,t,i,function(h){var d=vt(h.messages[0].data);d[1]=[{type:2,data:Jn(n)}],s=Kh(d[2],Vr),h.messages[0].data=pt(d)});var c=Ii(e,t,s[0]),f=Vr(vt(c.messages[0].data)[2][0].data);Jt(e,t,f,function(h,d){return Sse(e,t,r,h,d,f)})}function Sse(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=kn(r["!ref"]);s.s.r=s.s.c=0;var c=!1;s.e.c>999&&(c=!0,s.e.c=999),s.e.r>999999&&(c=!0,s.e.r=999999),c&&console.error("Truncating to ".concat(Zr(s)));var f=[];if(r["!data"])f=r["!data"];else{for(var h=[],d=0;d<=s.e.c;++d)h[d]=tr(d);for(var m=0;m<=s.e.r;++m){f[m]=[];var x=""+(m+1);for(d=0;d<=s.e.c;++d){var g=r[h[d]+x];g&&(f[m][d]=g)}}}var b={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=vt(n.messages[0].data);{_[6][0].data=ct(s.e.r+1),_[7][0].data=ct(s.e.c+1),delete _[46];var w=vt(_[4][0].data);{var S=Vr(vt(w[1][0].data)[2][0].data);Jt(e,t,S,function(he,De){var We,Ve=vt(he.messages[0].data);if((We=Ve?.[2])!=null&&We[0])for(var Ge=0;Ge<f.length;++Ge){var Te=vt(Ve[2][0].data);Te[1][0].data=ct(Ge),Te[4][0].data=ct(f[Ge].length),Ve[2][Ge]={type:Ve[2][0].type,data:pt(Te)}}he.messages[0].data=pt(Ve)});var A=Vr(w[2][0].data);Jt(e,t,A,function(he,De){for(var We=vt(he.messages[0].data),Ve=0;Ve<=s.e.c;++Ve){var Ge=vt(We[2][0].data);Ge[1][0].data=ct(Ve),Ge[4][0].data=ct(s.e.r+1),We[2][Ve]={type:We[2][0].type,data:pt(Ge)}}he.messages[0].data=pt(We)});var T=vt(w[9][0].data);T[1]=[];var D=vt(w[3][0].data);{var O=256;D[2]=[{type:0,data:ct(O)}];var I=Vr(vt(D[1][0].data)[2][0].data),j=(function(){var he=Ii(e,t,2),De=vt(he.messages[0].data),We=De[3].filter(function(Ve){return Ba(vt(Ve.data)[1][0].data)==I});return We?.length?Ba(vt(We[0].data)[12][0].data):0})();or.utils.cfb_del(e,t[I].location),Jt(e,t,2,function(he){var De=vt(he.messages[0].data);De[3]=De[3].filter(function(We){return Ba(vt(We.data)[1][0].data)!=I}),wse(De,t,i,I),he.messages[0].data=pt(De)}),es(n,I),D[1]=[];for(var z=Math.ceil((s.e.r+1)/O),R=0;R<z;++R){var q=Di({deps:[],location:"",type:6002},t);t[q].location="Root Entry/Index/Tables/Tile-".concat(q,".iwa");for(var V=[[],[{type:0,data:ct(0)}],[{type:0,data:ct(Math.min(s.e.r+1,(R+1)*O))}],[{type:0,data:ct(0)}],[{type:0,data:ct(Math.min((R+1)*O,s.e.r+1)-R*O)}],[],[{type:0,data:ct(5)}],[{type:0,data:ct(1)}],[{type:0,data:ct(1)}]],J=R*O;J<=Math.min(s.e.r,(R+1)*O-1);++J){var ue=gse(f[J],b);ue[1][0].data=ct(J-R*O),V[5].push({data:pt(ue),type:2})}D[1].push({type:2,data:pt([[],[{type:0,data:ct(R)}],[{type:2,data:Bn(q)}]])});var Ne={id:q,messages:[ry(6002,pt(V))]},pe=yc(vc([Ne]));or.utils.cfb_add(e,"/Index/Tables/Tile-".concat(q,".iwa"),pe),Jt(e,t,2,function(he){var De=vt(he.messages[0].data);De[3].push({type:2,data:pt([[],[{type:0,data:ct(q)}],[{type:2,data:Jn("Tables/Tile")}],[{type:2,data:Jn("Tables/Tile-".concat(q))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ct(0)}],[],[{type:0,data:ct(j)}]])}),De[1]=[{type:0,data:ct(Math.max(q+1,Ba(De[1][0].data)))}],ya(De,t,i,q),he.messages[0].data=pt(De)}),Ln(n,q),T[1].push({type:2,data:pt([[],[{type:0,data:ct(R*O)}],[{type:0,data:ct(R)}]])})}}if(w[3][0].data=pt(D),w[9][0].data=pt(T),w[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var Ie=Di({type:6144,deps:[i],location:t[i].location},t);a.push({id:Ie,messages:[ry(6144,pt([[],r["!merges"].map(function(he){return{type:2,data:pt([[],[{type:2,data:pt([[],[{type:5,data:new Uint8Array(new Uint16Array([he.s.r,he.s.c]).buffer)}]])}],[{type:2,data:pt([[],[{type:5,data:new Uint8Array(new Uint16Array([he.e.r-he.s.r+1,he.e.c-he.s.c+1]).buffer)}]])}]])}})]))]}),w[13]=[{type:2,data:Bn(Ie)}],Jt(e,t,2,function(he){var De=vt(he.messages[0].data);ya(De,t,i,Ie),he.messages[0].data=pt(De)}),Ln(n,Ie)}else delete w[13];var xe=Vr(w[4][0].data);Jt(e,t,xe,function(he){var De=vt(he.messages[0].data);De[3]=[],b.sst.forEach(function(We,Ve){Ve!=0&&De[3].push({type:2,data:pt([[],[{type:0,data:ct(Ve)}],[{type:0,data:ct(1)}],[{type:2,data:Jn(We)}]])})}),he.messages[0].data=pt(De)});var ye=Vr(w[17][0].data);if(Jt(e,t,ye,function(he){var De=vt(he.messages[0].data);De[3]=[];var We=[904980,903835,903815,903845];b.rsst.forEach(function(Ve,Ge){if(Ge!=0){var Te=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Jn(Ve.v)}]];Te[10]=[{type:0,data:new Uint8Array([1])}],Te[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Te[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Te[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Te[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Te[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Te[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Te[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Te[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var U=Di({deps:[],location:"",type:2001},t),H=[];if(Ve.l){var X=Uo(e,2032,[[],[],[{type:2,data:Jn(Ve.l)}]],"/Index/Tables/DataList",t);Te[11]=[];var Z=[[],[]];Z[1]||(Z[1]=[]),Z[1].push({type:2,data:pt([[],[{type:0,data:ct(0)}],[{type:2,data:Bn(X)}]])}),Te[11][0]={type:2,data:pt(Z)},H.push(X)}Uo(e,2001,Te,"/Index/Tables/DataList",t,U),Jt(e,t,U,function(Fe){We.forEach(function(_e){return Ln(Fe,_e)}),H.forEach(function(_e){return Ln(Fe,_e)})});var ee=Uo(e,6218,[[],[{type:2,data:Bn(U)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);Jt(e,t,ee,function(Fe){return Ln(Fe,U)}),De[3].push({type:2,data:pt([[],[{type:0,data:ct(Ge)}],[{type:0,data:ct(1)}],[],[],[],[],[],[],[{type:2,data:Bn(ee)}]])}),Ln(he,ee),Jt(e,t,2,function(Fe){var _e=vt(Fe.messages[0].data);ya(_e,t,ye,ee),ya(_e,t,ee,U),ya(_e,t,U,H),ya(_e,t,U,We),Fe.messages[0].data=pt(_e)})}}),he.messages[0].data=pt(De)}),b.cmnt.length>1){var ge=Vr(w[19][0].data),Oe={},ie=0;Jt(e,t,ge,function(he){var De=vt(he.messages[0].data);De[3]=[],b.cmnt.forEach(function(We,Ve){if(Ve!=0){var Ge=[];We.replies&&We.replies.forEach(function(H){Oe[H.a||""]||(Oe[H.a||""]=Uo(e,212,[[],[{type:2,data:Jn(H.a||"")}],[{type:2,data:GC(++ie)}],[],[{type:0,data:ct(0)}]],"/Index/Tables/DataList",t));var X=Oe[H.a||""],Z=Uo(e,3056,[[],[{type:2,data:Jn(H.t||"")}],[{type:2,data:pt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Bn(X)}]],"/Index/Tables/DataList",t);Jt(e,t,Z,function(ee){return Ln(ee,X)}),Ge.push(Z),Jt(e,t,2,function(ee){var Fe=vt(ee.messages[0].data);ya(Fe,t,Z,X),ee.messages[0].data=pt(Fe)})}),Oe[We.a||""]||(Oe[We.a||""]=Uo(e,212,[[],[{type:2,data:Jn(We.a||"")}],[{type:2,data:GC(++ie)}],[],[{type:0,data:ct(0)}]],"/Index/Tables/DataList",t));var Te=Oe[We.a||""],U=Uo(e,3056,[[],[{type:2,data:Jn(We.t||"")}],[{type:2,data:pt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Bn(Te)}],Ge.map(function(H){return{type:2,data:Bn(H)}}),[{type:2,data:pt([[],[{type:0,data:ct(Ve)}],[{type:0,data:ct(0)}]])}]],"/Index/Tables/DataList",t);Jt(e,t,U,function(H){Ln(H,Te),Ge.forEach(function(X){return Ln(H,X)})}),De[3].push({type:2,data:pt([[],[{type:0,data:ct(Ve)}],[{type:0,data:ct(1)}],[],[],[],[],[],[],[],[{type:2,data:Bn(U)}]])}),Ln(he,U),Jt(e,t,2,function(H){var X=vt(H.messages[0].data);ya(X,t,ge,U),ya(X,t,U,Te),Ge.length&&ya(X,t,U,Ge),H.messages[0].data=pt(X)})}}),De[2][0].data=ct(b.cmnt.length+1),he.messages[0].data=pt(De)})}}_[4][0].data=pt(w)}n.messages[0].data=pt(_)}function Nse(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Fb(e){Nse([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ese(e,t){e&&!e.SSF&&(e.SSF=Gn(xr)),e&&e.SSF&&($p(),Bp(e.SSF),t.revssf=Up(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ef?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=r3();Fb(t=t||{});var i=_b(),s="",c=0;if(t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ct(i,s,s3(e.Props,t)),a.coreprops.push(s),Yt(t.rels,2,s,Mt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,s,l3(e.Props)),a.extprops.push(s),Yt(t.rels,3,s,Mt.EXT_PROPS),e.Custprops!==e.Props&&qr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ct(i,s,c3(e.Custprops)),a.custprops.push(s),Yt(t.rels,4,s,Mt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var m={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,Ct(i,s,sie(c-1,t,e,m)),a.sheets.push(s),Yt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Mt.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(T){T[1].forEach(function(D){D.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+c+".xml",Ct(i,w,S3(b,d,t)),a.threadedcomments.push(w),Yt(m,-1,"../threadedComments/threadedComment"+c+".xml",Mt.TCMNT)),w="xl/comments"+c+"."+r,Ct(i,w,qte(b)),a.comments.push(w),Yt(m,-1,"../comments"+c+"."+r,Mt.CMNT),_=!0}x["!legacy"]&&_&&Ct(i,"xl/drawings/vmlDrawing"+c+".vml",_3(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&Ct(i,a3(s),xc(m))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ct(i,s,ste(t.Strings)),a.strs.push(s),Yt(t.wbrels,-1,"sharedStrings."+r,Mt.SST)),s="xl/workbook."+r,Ct(i,s,kie(e)),a.workbooks.push(s),Yt(t.rels,1,s,Mt.WB),s="xl/theme/theme1.xml";var A=b3(e.Themes,t);return Ct(i,s,A),a.themes.push(s),Yt(t.wbrels,-1,"theme/theme1.xml",Mt.THEME),s="xl/styles."+r,Ct(i,s,Ite(e,t)),a.styles.push(s),Yt(t.wbrels,-1,"styles."+r,Mt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ct(i,s,e.vbaraw),a.vba.push(s),Yt(t.wbrels,-1,"vbaProject.bin",Mt.VBA)),s="xl/metadata."+r,Ct(i,s,zte()),a.metadata.push(s),Yt(t.wbrels,-1,"metadata."+r,Mt.XLMETA),d.length>1&&(s="xl/persons/person.xml",Ct(i,s,N3(d)),a.people.push(s),Yt(t.wbrels,-1,"persons/person.xml",Mt.PEOPLE)),Ct(i,"[Content_Types].xml",n3(a,t)),Ct(i,"_rels/.rels",xc(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",xc(t.wbrels)),delete t.revssf,delete t.ssf,i}function Tse(e,t){e&&!e.SSF&&(e.SSF=Gn(xr)),e&&e.SSF&&($p(),Bp(e.SSF),t.revssf=Up(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ef?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Qte.indexOf(t.bookType)>-1,a=r3();Fb(t=t||{});var i=_b(),s="",c=0;if(t.cellXfs=[],No(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ct(i,s,s3(e.Props,t)),a.coreprops.push(s),Yt(t.rels,2,s,Mt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,Ct(i,s,l3(e.Props)),a.extprops.push(s),Yt(t.rels,3,s,Mt.EXT_PROPS),e.Custprops!==e.Props&&qr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ct(i,s,c3(e.Custprops)),a.custprops.push(s),Yt(t.rels,4,s,Mt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var m={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,Ct(i,s,Gne(c-1,t,e,m)),a.sheets.push(s),Yt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Mt.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(A){A[1].forEach(function(T){T.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+c+".xml",Ct(i,w,S3(b,d,t)),a.threadedcomments.push(w),Yt(m,-1,"../threadedComments/threadedComment"+c+".xml",Mt.TCMNT)),w="xl/comments"+c+"."+r,Ct(i,w,Kte(b)),a.comments.push(w),Yt(m,-1,"../comments"+c+"."+r,Mt.CMNT),_=!0}x["!legacy"]&&_&&Ct(i,"xl/drawings/vmlDrawing"+c+".vml",_3(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&Ct(i,a3(s),xc(m))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ct(i,s,rte(t.Strings,t)),a.strs.push(s),Yt(t.wbrels,-1,"sharedStrings."+r,Mt.SST)),s="xl/workbook."+r,Ct(i,s,hie(e)),a.workbooks.push(s),Yt(t.rels,1,s,Mt.WB),s="xl/theme/theme1.xml",Ct(i,s,b3(e.Themes,t)),a.themes.push(s),Yt(t.wbrels,-1,"theme/theme1.xml",Mt.THEME),s="xl/styles."+r,Ct(i,s,hte(e,t)),a.styles.push(s),Yt(t.wbrels,-1,"styles."+r,Mt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ct(i,s,e.vbaraw),a.vba.push(s),Yt(t.wbrels,-1,"vbaProject.bin",Mt.VBA)),s="xl/metadata."+r,Ct(i,s,Hte()),a.metadata.push(s),Yt(t.wbrels,-1,"metadata."+r,Mt.XLMETA),d.length>1&&(s="xl/persons/person.xml",Ct(i,s,N3(d)),a.people.push(s),Yt(t.wbrels,-1,"persons/person.xml",Mt.PEOPLE)),Ct(i,"[Content_Types].xml",n3(a,t)),Ct(i,"_rels/.rels",xc(t.rels)),Ct(i,"xl/_rels/workbook."+r+".rels",xc(t.wbrels)),delete t.revssf,delete t.ssf,i}function kse(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ho(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function V3(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vf(t.file,or.write(e,{type:qt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return or.write(e,t)}function Cse(e,t){switch(t.bookType){case"ods":return z3(e,t);case"numbers":return yse(e,t);case"xlsb":return Ese(e,t);default:return Tse(e,t)}}function Ase(e,t){var r=Gn(t||{}),n=Cse(e,r);return jse(n,r)}function jse(e,t){var r={},n=qt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?or.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Lp(a))}return t.password&&typeof encrypt_agile<"u"?V3(encrypt_agile(a,t.password),t):t.type==="file"?Vf(t.file,a):t.type=="string"?mc(a):a}function Pse(e,t){var r=t||{},n=Uie(e,r);return V3(n,r)}function Oi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Oh(vf(n));case"binary":return vf(n);case"string":return e;case"file":return Vf(t.file,n,"utf8");case"buffer":return qt?Hi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Oi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ose(e,t){switch(t.type){case"base64":return OQ(e);case"binary":return e;case"string":return e;case"file":return Vf(t.file,e,"binary");case"buffer":return qt?Hi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function C0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Oh(r):t.type=="string"?mc(r):r;case"file":return Vf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function K3(e,t){PQ(),die(e);var r=Gn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=K3(e,r);return r.type="array",Lp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Oi(Bie(e,r),r);case"slk":case"sylk":return Oi(Qee.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return Oi(B3(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Ose(G3(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Oi(Mb(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Oi(Jee.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return C0(Zee.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Oi(ete.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Oi(lte(e.Sheets[e.SheetNames[a]]),r);case"eth":return Oi(x3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Oi(z3(e,r),r);case"wk1":return C0(RC.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return C0(RC.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),C0(L3(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Pse(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ase(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Dse(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ise(e,t,r){var n=r||{};return n.type="file",n.file=t,Dse(n),K3(e,n)}function Rse(e,t,r,n,a,i,s){var c=ar(r),f=s.defval,h=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,m=e["!data"]!=null,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!m||e["!data"][r])for(var g=t.s.c;g<=t.e.c;++g){var b=m?(e["!data"][r]||[])[g]:e[n[g]+c];if(b==null||b.t===void 0){if(f===void 0)continue;i[g]!=null&&(x[i[g]]=f);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"b":case"n":if(!b.z||!pl(b.z)||(_=pc(_),typeof _=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(_=kc(new Date(_)));break;default:throw new Error("unrecognized type "+b.t)}if(i[g]!=null){if(_==null)if(b.t=="e"&&_===null)x[i[g]]=null;else if(f!==void 0)x[i[g]]=f;else if(h&&_===null)x[i[g]]=null;else continue;else x[i[g]]=(b.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:h)?_:vs(b,_,s);_!=null&&(d=!1)}}return{row:x,isempty:d}}function ay(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},d=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":f=gr(d);break;case"number":f=gr(e["!ref"]),f.s.r=d;break;default:f=d}n>0&&(a=0);var m=ar(f.s.r),x=[],g=[],b=0,_=0,w=e["!data"]!=null,S=f.s.r,A=0,T={};w&&!e["!data"][S]&&(e["!data"][S]=[]);var D=h.skipHidden&&e["!cols"]||[],O=h.skipHidden&&e["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(D[A]||{}).hidden)switch(x[A]=tr(A),r=w?e["!data"][S][A]:e[x[A]+m],n){case 1:i[A]=A-f.s.c;break;case 2:i[A]=x[A];break;case 3:i[A]=h.header[A-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=s=vs(r,null,h),_=T[s]||0,!_)T[s]=1;else{do c=s+"_"+_++;while(T[c]);T[s]=_,T[c]=1}i[A]=c}for(S=f.s.r+a;S<=f.e.r;++S)if(!(O[S]||{}).hidden){var I=Rse(e,f,S,x,n,i,h);(I.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(g[b++]=I.row)}return g.length=b,g}var YC=/"/g;function Fse(e,t,r,n,a,i,s,c,f){for(var h=!0,d=[],m="",x=ar(r),g=e["!data"]!=null,b=g&&e["!data"][r]||[],_=t.s.c;_<=t.e.c;++_)if(n[_]){var w=g?b[_]:e[n[_]+x];if(w==null)m="";else if(w.v!=null){h=!1,m=""+(f.rawNumbers&&w.t=="n"?w.v:vs(w,null,f));for(var S=0,A=0;S!==m.length;++S)if((A=m.charCodeAt(S))===a||A===i||A===34||f.forceQuotes){m='"'+m.replace(YC,'""')+'"';break}m=="ID"&&c==0&&d.length==0&&(m='"ID"')}else w.f!=null&&!w.F?(h=!1,m="="+w.f,m.indexOf(",")>=0&&(m='"'+m.replace(YC,'""')+'"')):m="";d.push(m)}if(f.strip)for(;d[d.length-1]==="";)--d.length;return f.blankrows===!1&&h?null:d.join(s)}function Mb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=gr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),h="",d=[],m=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(m[g]||{}).hidden||(d[g]=tr(g));for(var b=0,_=a.s.r;_<=a.e.r;++_)(x[_]||{}).hidden||(h=Fse(e,a,_,d,s,f,i,b,n),h!=null&&(h||n.blankrows!==!1)&&r.push((b++?c:"")+h));return r.join("")}function G3(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Mb(e,t);return r}function Mse(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=gr(e["!ref"]),s="",c=[],f,h=[],d=e["!data"]!=null;for(f=i.s.c;f<=i.e.c;++f)c[f]=tr(f);for(var m=i.s.r;m<=i.e.r;++m)for(s=ar(m),f=i.s.c;f<=i.e.c;++f)if(r=c[f]+s,n=d?(e["!data"][m]||[])[f]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}h[h.length]=r+"="+a}return h}function Y3(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var c=0,f=0;if(s&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Nr(n.origin):n.origin;c=h.r,f=h.c}var d={s:{c:0,r:0},e:{c:f,r:c+t.length-1+i}};if(s["!ref"]){var m=gr(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),c==-1&&(c=m.e.r+1,d.e.r=c+t.length-1+i)}else c==-1&&(c=0,d.e.r=t.length-1+i);var x=n.header||[],g=0,b=[];t.forEach(function(w,S){a&&!s["!data"][c+S+i]&&(s["!data"][c+S+i]=[]),a&&(b=s["!data"][c+S+i]),qr(w).forEach(function(A){(g=x.indexOf(A))==-1&&(x[g=x.length]=A);var T=w[A],D="z",O="",I=a?"":tr(f+g)+ar(c+S+i),j=a?b[f+g]:s[I];T&&typeof T=="object"&&!(T instanceof Date)?a?b[f+g]=T:s[I]=T:(typeof T=="number"?D="n":typeof T=="boolean"?D="b":typeof T=="string"?D="s":T instanceof Date?(D="d",n.UTC||(T=zp(T)),n.cellDates||(D="n",T=An(T)),O=j!=null&&j.z&&pl(j.z)?j.z:n.dateNF||xr[14]):T===null&&n.nullError&&(D="e",T=0),j?(j.t=D,j.v=T,delete j.w,delete j.R,O&&(j.z=O)):a?b[f+g]=j={t:D,v:T}:s[I]=j={t:D,v:T},O&&(j.z=O))})}),d.e.c=Math.max(d.e.c,f+x.length-1);var _=ar(c);if(a&&!s["!data"][c]&&(s["!data"][c]=[]),i)for(g=0;g<x.length;++g)a?s["!data"][c][g+f]={t:"s",v:x[g]}:s[tr(g+f)+_]={t:"s",v:x[g]};return s["!ref"]=Zr(d),s}function Lse(e,t){return Y3(null,e,t)}function Xh(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=Nr(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Xh(e,Pr(t)):Xh(e,tr(r||0)+ar(t))}function Bse(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $se(e,t){var r={SheetNames:[],Sheets:{}};return e&&Lb(r,e,t||"Sheet1"),r}function Lb(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var s=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(R3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Use(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Bse(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function zse(e,t){return e.z=t,e}function X3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Hse(e,t,r){return X3(e,"#"+t,r)}function Wse(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Vse(e,t,r,n){for(var a=typeof t!="string"?t:gr(t),i=typeof t=="string"?t:Zr(t),s=a.s.r;s<=a.e.r;++s)for(var c=a.s.c;c<=a.e.c;++c){var f=Xh(e,s,c);f.t="n",f.F=i,delete f.v,s==a.s.r&&c==a.s.c&&(f.f=r,n&&(f.D=!0))}var h=kn(e["!ref"]);return h.s.r>a.s.r&&(h.s.r=a.s.r),h.s.c>a.s.c&&(h.s.c=a.s.c),h.e.r<a.e.r&&(h.e.r=a.e.r),h.e.c<a.e.c&&(h.e.c=a.e.c),e["!ref"]=Zr(h),e}var Bv={encode_col:tr,encode_row:ar,encode_cell:Pr,encode_range:Zr,decode_col:Cb,decode_row:kb,split_cell:$J,decode_cell:Nr,decode_range:kn,format_cell:vs,sheet_new:UJ,sheet_add_aoa:ZO,sheet_add_json:Y3,sheet_add_dom:$3,aoa_to_sheet:Gc,json_to_sheet:Lse,table_to_sheet:U3,table_to_book:use,sheet_to_csv:Mb,sheet_to_txt:G3,sheet_to_json:ay,sheet_to_html:B3,sheet_to_formulae:Mse,sheet_to_row_object_array:ay,sheet_get_cell:Xh,book_new:$se,book_append_sheet:Lb,book_set_sheet_visibility:Use,cell_set_number_format:zse,cell_set_hyperlink:X3,cell_set_internal_link:Hse,cell_add_comment:Wse,sheet_set_array_formula:Vse,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const A0=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",Kse=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")}`:"0",Gse=e=>{if(!e)return null;const t=e.match(/nhn t\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},Wu=e=>Gse(e.note)||e.sender||"",$v=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},Yse=[{value:"receipt",label:"Bin Nhn",description:"M n bt u bng MAV"},{value:"refund",label:"Hon tin",description:"Cc bin nhn khc"}],ji={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankBin:"970422"};function Xse(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[a,i]=v.useState(""),[s,c]=v.useState("receipt"),[f,h]=v.useState([]),[d,m]=v.useState(!1),[x,g]=v.useState(null),[b,_]=v.useState(!1),[w,S]=v.useState(null),[A,T]=v.useState(!1),[D,O]=v.useState(!1),[I,j]=v.useState(!1),[z,R]=v.useState(!1),[q,V]=v.useState(null),[J,ue]=v.useState(""),[Ne,pe]=v.useState(""),[Ie,xe]=v.useState(""),[ye,ge]=v.useState(""),Oe=v.useRef(null),ie=v.useMemo(()=>{const me=J.replace(/[^\d]/g,"");if(!me)return 0;const je=Number(me);return Number.isFinite(je)?je:0},[J]),he=ie>0?`${ie.toLocaleString("vi-VN")} VND`:"Cha cp nht",De=v.useMemo(()=>pb({accountNumber:ji.accountNumber,bankCode:ji.bankBin,amount:ie,description:Ne.trim()}),[ie,Ne]),We=()=>{O(!0),xe(J),ge(Ne)},Ve=()=>{O(!1),j(!1),R(!1)},Ge=()=>{const me=Ie.replace(/[^\d]/g,"");ue(me),j(!1)},Te=()=>{pe(ye.trim()),R(!1)},U=Ne.trim()||"Cha c ni dung",H=v.useMemo(()=>{const me=e.trim().toLowerCase(),je=Ue=>{const fe=Ue.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!fe)return null;const[,ce,rt,_t]=fe.map(Number);return new Date(_t,rt-1,ce).getTime()},He=je(r),et=je(a);return f.filter(Ue=>{const fe=$v(Ue.orderCode),ce=!me||[Ue.orderCode,Ue.note,Wu(Ue)].map(Tt=>Tt?.toLowerCase()??"").some(Tt=>Tt.includes(me)),rt=je(Kr(Ue.paidAt)||""),_t=He===null||rt===null||rt>=He,yt=et===null||rt===null||rt<=et;return ce&&_t&&yt&&fe===s})},[f,e,r,a,s]),X=v.useMemo(()=>{const me=f.reduce((He,et)=>(et.orderCode||"").toUpperCase().startsWith("MAV")?He+et.amount:He,0),je=f.length>0?f[0].paidAt??"":"";return[{name:"Tng Bin Nhn",value:f.length.toString(),icon:wc,accent:Yr.sky},{name:"Tng S Tin",value:Kse(me),icon:wc,accent:Yr.emerald},{name:"Bin Lai Gn Nht",value:je?Kr(je)??"--":"--",icon:xy,accent:Yr.violet}]},[f]),Z=v.useMemo(()=>f.reduce((me,je)=>{const He=$v(je.orderCode);return me[He]+=1,me},{receipt:0,refund:0}),[f]);v.useEffect(()=>{(async()=>{try{m(!0),g(null);const je=await Xt("/api/payment-receipts");if(!je.ok)throw new Error("Khng th ti bin nhn.");const He=await je.json(),et=ce=>typeof ce=="string"?ce:"",Ue=ce=>({id:Number(ce?.id)||0,orderCode:et(ce?.orderCode??ce?.[Ql.orderCode]),paidAt:et(ce?.paidAt??ce?.[Ql.paidDate]),amount:Number(ce?.amount??ce?.[Ql.amount])||0,sender:et(ce?.sender??ce?.[Ql.sender]),receiver:et(ce?.receiver??ce?.[Ql.receiver]),note:et(ce?.note??ce?.[Ql.note])}),fe=Array.isArray(He?.receipts)?He.receipts:Array.isArray(He)?He:[];h(fe.map(Ue))}catch(je){console.error(je),g(je instanceof Error?je.message:"Khng th ti bin nhn.")}finally{m(!1)}})()},[]);const ee=me=>{V(je=>je===me?null:me)},Fe=()=>{S(null),_(!1)},_e=()=>{if(!H.length)return;const me=["#","M n","Ngi gi","Ngi nhn","S tin gc","S tin nh dng","Ni dung chuyn khon","Ngy thanh ton","Nhm"],je=H.map((fe,ce)=>[ce+1,fe.orderCode||"",Wu(fe),fe.receiver||"",fe.amount,A0(fe.amount),fe.note||"",fe.paidAt?Kr(fe.paidAt):"",$v(fe.orderCode)==="receipt"?"Bin nhn":"Hon tin"]),He=Bv.aoa_to_sheet([me,...je]);He["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}];const et=Bv.book_new();Bv.book_append_sheet(et,He,"Bin nhn thanh ton");const Ue=new Date().toISOString().slice(0,10).replace(/-/g,"");Ise(et,`payment_receipts_${Ue}.xlsx`)},Me=d||H.length===0;v.useEffect(()=>{const me=je=>{Oe.current&&!Oe.current.contains(je.target)&&T(!1)};return document.addEventListener("mousedown",me),()=>document.removeEventListener("mousedown",me)},[]);const Re=me=>{const je=me.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!je)return me;const[,He,et,Ue]=je;return`${Ue}/${et}/${He}`},ne=r&&a?`${r} - ${a}`:"dd/mm/yyyy - dd/mm/yyyy",Ae=me=>{const je=me.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!je)return"";const[,He,et,Ue]=je;return`${Ue}-${et}-${He}`};return u.jsxs(u.Fragment,{children:[D&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:u.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative",children:[u.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:Ve,children:u.jsx(Tn,{className:"h-6 w-6"})}),u.jsxs("div",{className:"px-6 py-10 space-y-6",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("h2",{className:"text-2xl font-semibold",children:"To thng tin thanh ton qua QR Code"}),u.jsx("p",{className:"text-sm text-slate-300",children:"Qut m QR  chuyn khon nhanh chng. in s tin v ni dung  cp nht chi tit."})]}),u.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[u.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[u.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Qut m QR  thanh ton"}),u.jsx("div",{className:"rounded-2xl bg-white p-4",children:u.jsx("img",{src:De,alt:"QR thanh ton",className:"h-64 w-64 object-contain"})}),u.jsx("a",{href:De,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400",children:"Ti nh QR"}),u.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[u.jsxs("p",{children:["Ngn hng:"," ",u.jsx("span",{className:"font-semibold",children:ji.bankName})]}),u.jsxs("p",{children:["S ti khon:"," ",u.jsx("span",{className:"font-semibold",children:ji.accountNumber})]}),u.jsxs("p",{children:["Ch ti khon:"," ",u.jsx("span",{className:"font-semibold uppercase",children:ji.accountHolder})]}),u.jsxs("p",{children:["S tin:"," ",u.jsx("span",{className:"font-semibold text-rose-200",children:he})]}),u.jsxs("p",{children:["Ni dung:"," ",u.jsx("span",{className:"font-semibold text-violet-200",children:U})]})]})]}),u.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[u.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[u.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngn hng"}),u.jsx("p",{className:"text-lg font-semibold text-white",children:ji.bankName})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[u.jsx("span",{children:"Th hng"}),u.jsx("span",{className:"font-semibold text-white",children:ji.accountHolder})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"text-sm text-slate-300",children:"S Ti Khon"}),u.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:ji.accountNumber})]})]}),u.jsxs("div",{className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:()=>{j(!0),xe(J||"")},children:"+ Thm s tin"}),I&&u.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[u.jsx("input",{type:"text",placeholder:"V d: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:Ie,onChange:me=>xe(me.target.value),onBlur:Ge}),u.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:Ge,children:"OK"})]})]}),u.jsxs("div",{children:[u.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:()=>{R(!0),ge(Ne||"")},children:"+ Thm ni dung"}),z&&u.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[u.jsx("input",{type:"text",placeholder:"Nhp ni dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:ye,onChange:me=>ge(me.target.value),onBlur:Te}),u.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:Te,children:"OK"})]})]})]}),u.jsxs("div",{className:"rounded-2xl bg-slate-900/60 p-4 text-sm text-slate-200 space-y-2",children:[u.jsxs("p",{children:[u.jsx("span",{className:"text-slate-400",children:"S tin hin ti:"})," ",u.jsx("span",{className:"font-semibold text-white",children:he})]}),u.jsxs("p",{children:[u.jsx("span",{className:"text-slate-400",children:"Ni dung hin ti:"})," ",u.jsx("span",{className:"font-semibold text-white",children:U})]}),u.jsx("p",{className:"text-xs text-slate-500",children:"* Nhn OK hoc ri khi  nhp  cp nht thng tin vo QR."})]})]})]})]})]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-white drop-shadow-sm",children:"Bin nhn thanh ton"}),u.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Theo di giao dch chuyn n c lu trong h thng"})]}),u.jsx(Bi,{icon:Mi,className:"mt-4 sm:mt-0",onClick:We,children:"Thm bin nhn"})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:X.map(me=>u.jsx(Oc,{title:me.name,value:me.value,icon:me.icon,accent:me.accent},me.name))})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4 relative z-50",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(gl,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Tm m n ngi gi hoc ghi ch...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 bg-gray-50/60 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:e,onChange:me=>t(me.target.value)})]}),u.jsxs("div",{className:"relative z-[120] flex items-stretch",ref:Oe,children:[u.jsxs("button",{type:"button",onClick:()=>T(me=>!me),className:`flex items-center justify-between gap-3 px-4 py-3 rounded-2xl border transition w-full lg:w-64 ${A?"border-indigo-400/70 bg-indigo-900/60 shadow-[0_10px_30px_-18px_rgba(79,70,229,0.65)]":"border-white/15 bg-slate-900/70 text-white hover:bg-slate-800/70 shadow-[0_10px_26px_-18px_rgba(0,0,0,0.65)]"} text-white`,children:[u.jsx("div",{className:"flex flex-col text-left",children:u.jsx("span",{className:"text-sm font-medium",children:ne})}),u.jsx(dy,{className:`w-5 h-5 ${A?"text-indigo-300":"text-slate-200"}`})]}),A&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-80 bg-white border border-gray-200 rounded-2xl shadow-xl z-[150] p-4 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"T Ngy"}),u.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:Ae(r),onChange:me=>n(me.target.value?Re(me.target.value):"")})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"n Ngy"}),u.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:Ae(a),onChange:me=>i(me.target.value?Re(me.target.value):"")})]})]}),u.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[u.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-800",onClick:()=>{n(""),i("")},children:"Xa Khong"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 border border-gray-200 rounded-lg hover:bg-indigo-500/10",onClick:()=>T(!1),children:"ng"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",onClick:()=>T(!1),children:"p Dng"})]})]})]})]}),u.jsx("button",{type:"button",onClick:_e,disabled:Me,className:`px-5 py-3 rounded-2xl bg-gray-900 text-white text-sm font-semibold transition-colors shadow-sm ${Me?"opacity-60 cursor-not-allowed":"hover:bg-gray-700"}`,children:"Ti V"})]}),x&&u.jsx("div",{className:"text-sm text-red-600",children:x})]}),u.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-slate-800/75 via-slate-800/60 to-slate-900/80 border border-white/12 p-4 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.8),0_14px_36px_-28px_rgba(255,255,255,0.18)] backdrop-blur-sm flex flex-col sm:flex-row gap-3 text-slate-200",children:Yse.map(me=>{const je=s===me.value;return u.jsx("button",{type:"button",onClick:()=>c(me.value),className:`flex-1 min-w-[180px] text-left rounded-2xl border p-4 transition shadow-[0_12px_28px_-18px_rgba(0,0,0,0.65)] ${je?"bg-gradient-to-r from-indigo-500 to-violet-500 text-white border-white/50 shadow-[0_16px_45px_-22px_rgba(79,70,229,0.65)]":"bg-slate-800/70 text-slate-100 border-white/12 hover:bg-slate-700/70 hover:border-white/20"}`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-semibold drop-shadow-sm",children:me.label}),u.jsx("p",{className:"text-xs text-slate-300 mt-1",children:me.description})]}),u.jsx("span",{className:`text-lg font-semibold ${je?"text-white":"text-slate-100"}`,children:Z[me.value]})]})},me.value)})}),u.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[u.jsx("thead",{className:"bg-slate-900/90",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"M n"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Gi"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Nhn"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"S Tin"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ni Dung Chuyn Khon"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngy Thanh Ton"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:H.map((me,je)=>{const He=q===me.id;return u.jsxs(_i.Fragment,{children:[u.jsxs("tr",{className:`transition ${je%2===0?"bg-slate-900/55":"bg-indigo-950/40"} hover:bg-indigo-600/25 ${He?"ring-2 ring-indigo-400/60":""} cursor-pointer`,onClick:()=>ee(me.id),children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-semibold",children:me.orderCode||"--"}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-white",children:Wu(me)||"--"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-white",children:me.receiver||ji.accountNumber})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-white",children:A0(me.amount)}),u.jsx("td",{className:"px-6 py-4 text-sm text-white/90 max-w-xs",children:u.jsx("span",{className:"block truncate text-white/90",children:me.note||"--"})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:me.paidAt?Kr(me.paidAt):"--"})]}),He&&u.jsx("tr",{className:"bg-indigo-900/35",children:u.jsx("td",{colSpan:6,className:"px-6 pb-5 pt-2",children:u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-900/70 p-4 text-sm text-white/90 space-y-2",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"M n"}),u.jsx("p",{className:"font-semibold text-white",children:me.orderCode||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngi gi"}),u.jsx("p",{className:"font-semibold text-white",children:Wu(me)||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngi nhn"}),u.jsx("p",{className:"font-semibold text-white",children:ji.accountNumber})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"S tin"}),u.jsx("p",{className:"font-semibold text-emerald-200",children:A0(me.amount)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ngy thanh ton"}),u.jsx("p",{className:"font-semibold text-white",children:me.paidAt?Kr(me.paidAt):"--"})]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-white/60",children:"Ni dung chuyn khon"}),u.jsx("p",{className:"mt-1 rounded-xl bg-white/5 px-3 py-2 text-white",children:me.note||"Khng c ghi ch"})]})]})})})]},me.id)})})]})}),!d&&H.length===0&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng C Bin Nhn"}),u.jsx("div",{className:"text-white/60",children:"Th t kha khc"})]}),d&&u.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"ang ti d liu..."})]}),b&&w&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl",children:[u.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tit bin nhn"}),u.jsx("button",{onClick:Fe,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"ng",children:u.jsx(Tn,{className:"h-5 w-5"})})]}),u.jsxs("div",{className:"px-5 py-4 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"M n"}),u.jsx("p",{className:"font-semibold text-gray-900",children:w.orderCode||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngy Thanh Ton"}),u.jsx("p",{className:"font-semibold text-gray-900",children:w.paidAt?Kr(w.paidAt):"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Gi"}),u.jsx("p",{className:"font-semibold text-gray-900",children:Wu(w)||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Nhn"}),u.jsx("p",{className:"font-semibold text-gray-900",children:w.receiver||"--"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1",children:"S Tin"}),u.jsx("p",{className:"font-semibold text-gray-900",children:A0(w.amount)})]})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Ni Dung Chuyn Khon"}),u.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:w.note||"Khng c ghi ch"})]})]}),u.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:u.jsx("button",{onClick:Fe,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"ng"})})]})})]})]})}const Qn="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",j0=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();function qse(){const[e,t]=v.useState([]),[r,n]=v.useState(!1),[a,i]=v.useState(null),[s,c]=v.useState(""),[f,h]=v.useState(null),[d,m]=v.useState(null);v.useEffect(()=>{let T=!0;const D=I=>I?Array.isArray(I)?I:Array.isArray(I.items)?I.items:[]:[];return(async()=>{n(!0),i(null);try{let I=await Xt(It.WAREHOUSE);if(I.status===404&&(I=await Xt("/api/warehouses")),!I.ok)throw new Error(`Khng ti c d liu (${I.status})`);const j=await I.json(),z=D(j);T&&t(z)}catch(I){T&&i(I?.message||"Li khng xc nh")}finally{T&&n(!1)}})(),()=>{T=!1}},[]);const x=T=>{h(T.id??null),m({...T})},g=()=>{h(null),m(null)},b=(T,D)=>{m(O=>({...O||{},[T]:D}))},_=async T=>{if(!(!T&&f!=="new"||!d)){n(!0),i(null);try{if(f==="new"){const D=await Xt(It.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!D.ok)throw new Error(`To mi tht bi (${D.status})`);const O=await D.json();t(I=>[...I,O]),g()}else{const D=await Xt(`${It.WAREHOUSE}/${T}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!D.ok)throw new Error(`Cp nht tht bi (${D.status})`);const O=await D.json();t(I=>I.map(j=>j.id===T?{...j,...O}:j)),g()}}catch(D){i(D?.message||"Li khi cp nht")}finally{n(!1)}}},w=async T=>{if(T&&confirm("Bn c chc mun xa bn ghi ny?")){n(!0),i(null);try{const D=await Xt(`${It.WAREHOUSE}/${T}`,{method:"DELETE"});if(!D.ok)throw new Error(`Xa tht bi (${D.status})`);t(O=>O.filter(I=>I.id!==T)),f===T&&g()}catch(D){i(D?.message||"Li khi xa")}finally{n(!1)}}},S=()=>{h("new"),m({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Tn"})},A=v.useMemo(()=>({filtered:e.filter(D=>{if(!s.trim())return!0;const O=j0(s);return[D.category,D.account,D.password,D.backup_email,D.two_fa,D.note,D.status].some(I=>j0(I).includes(O))}).sort((D,O)=>{const I=j0(D.category),j=j0(O.category);return I.localeCompare(j,"vi")})}),[e,s]);return u.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(cy,{className:"h-7 w-7 text-indigo-300"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-semibold text-white",children:"Lu tr"}),u.jsx("p",{className:"text-sm text-white/70",children:"Hng ang cn tn kho (cha ghp vo n hng)"})]})]}),u.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 shadow-lg shadow-indigo-900/40 p-4 space-y-3",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(gl,{className:"h-5 w-5 text-white/60 absolute left-3 top-2.5"}),u.jsx("input",{className:`${Qn} pl-10`,placeholder:"Tm theo gi, ti khon, nh cung cp...",value:s,onChange:T=>c(T.target.value)})]}),u.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm font-semibold disabled:opacity-60",disabled:r,children:[u.jsx(Mi,{className:"h-4 w-4"}),"Thm"]}),r&&u.jsxs("div",{className:"text-sm text-white/80 flex items-center gap-2",children:[u.jsx("span",{className:"animate-spin h-4 w-4 rounded-full border-2 border-white/40 border-t-transparent"}),"ang ti..."]}),a&&u.jsxs("div",{className:"text-sm text-rose-200 flex items-center gap-2",children:[u.jsx(hy,{className:"h-5 w-5"}),a]})]}),u.jsx("div",{className:"overflow-auto rounded-xl border border-white/10 bg-white/5",children:u.jsxs("table",{className:"min-w-full text-sm text-white",children:[u.jsx("thead",{className:"bg-white/10 text-left",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Loi"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ti khon"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mt khu"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mail d phng"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"2FA"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Trng thi"}),u.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ghi ch"}),u.jsx("th",{className:"px-4 py-2 font-semibold text-center",children:"Thao tc"})]})}),u.jsxs("tbody",{children:[f==="new"&&d&&u.jsxs("tr",{className:"border-t border-white/5 bg-white/5",children:[u.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.category||"",onChange:T=>b("category",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20 font-medium`,value:d.account||"",onChange:T=>b("account",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.password||"",onChange:T=>b("password",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.backup_email||"",onChange:T=>b("backup_email",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.two_fa||"",onChange:T=>b("two_fa",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.status||"",onChange:T=>b("status",T.target.value)})}),u.jsx("td",{className:"px-4 py-2",children:u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:d.note||"",onChange:T=>b("note",T.target.value)})}),u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsxs("div",{className:"inline-flex items-center gap-2",children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>_(void 0),disabled:r,title:"Lu",children:u.jsx(tl,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:g,disabled:r,title:"Hy",children:u.jsx(Tn,{className:"h-4 w-4"})})]})})]}),A.filtered.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-white/70",children:r?"ang ti d liu...":"Khng c hng tn kho"})}):A.filtered.map(T=>{const D=f===T.id,O=D&&d||T;return u.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[u.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.category||"",onChange:I=>b("category",I.target.value)}):T.category||"N/A"}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20 font-medium`,value:O.account||"",onChange:I=>b("account",I.target.value)}):u.jsx("div",{className:"font-medium",children:T.account||"Cha c ti khon"})}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.password||"",onChange:I=>b("password",I.target.value)}):T.password||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.backup_email||"",onChange:I=>b("backup_email",I.target.value)}):T.backup_email||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.two_fa||"",onChange:I=>b("two_fa",I.target.value)}):T.two_fa||u.jsx("span",{className:"text-white/60",children:"--"})}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.status||"",onChange:I=>b("status",I.target.value)}):u.jsx("span",{className:"inline-flex rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white",children:T.status||"--"})}),u.jsx("td",{className:"px-4 py-2",children:D?u.jsx("input",{className:`${Qn} bg-white/10 border-white/20`,value:O.note||"",onChange:I=>b("note",I.target.value)}):u.jsx("div",{className:"text-white/80 whitespace-pre-wrap break-words",children:T.note||"--"})}),u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsx("div",{className:"inline-flex items-center gap-2",children:D?u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>_(T.id),disabled:r,title:"Lu",children:u.jsx(tl,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-rose-600/70 hover:bg-rose-600 text-white transition disabled:opacity-60",onClick:()=>w(T.id),disabled:r,title:"Xa",children:u.jsx(rl,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:g,disabled:r,title:"Hy",children:u.jsx(Tn,{className:"h-4 w-4"})})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-indigo-100 hover:text-white transition disabled:opacity-60",onClick:()=>x(T),disabled:r,title:"Sa",children:u.jsx(U0,{className:"h-4 w-4"})}),u.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-rose-200 hover:text-rose-100 transition disabled:opacity-60",onClick:()=>w(T.id),disabled:r,title:"Xa",children:u.jsx(rl,{className:"h-4 w-4"})})]})})})]},T.id??`${T.category??""}-${T.account??""}`)})]})]})})]})]})}function Zse({children:e}){const{user:t,loading:r}=gy(),n=vo();return r?null:t?u.jsx(u.Fragment,{children:e}):u.jsx(zv,{to:"/login",replace:!0,state:{from:n.pathname}})}function Qse(){const[e,t]=v.useState(!1);return u.jsx(D6,{children:u.jsx(qR,{children:u.jsxs(wS,{children:[u.jsx(Fn,{path:"/login",element:u.jsx(HZ,{})}),u.jsx(Fn,{path:"/*",element:u.jsx(Zse,{children:u.jsxs("div",{className:"min-h-screen app-aurora",children:[u.jsx(ZR,{isOpen:e,setIsOpen:t}),u.jsxs("div",{className:"transition-all duration-300 ease-in-out lg:ml-64 print-shell",children:[u.jsx("div",{className:"h-16 lg:hidden"}),u.jsx("main",{className:"p-0 pt-[10px] pl-[10px] max-w-none",children:u.jsxs(wS,{children:[u.jsx(Fn,{path:"/",element:u.jsx(zv,{to:"/dashboard",replace:!0})}),u.jsx(Fn,{path:"/dashboard",element:u.jsx($q,{})}),u.jsx(Fn,{path:"/orders",element:u.jsx(aZ,{})}),u.jsx(Fn,{path:"/package-products",element:u.jsx(yZ,{})}),u.jsx(Fn,{path:"/product-info",element:u.jsx(AZ,{})}),u.jsx(Fn,{path:"/stats",element:u.jsx(JZ,{})}),u.jsx(Fn,{path:"/sources",element:u.jsx(pQ,{})}),u.jsx(Fn,{path:"/pricing",element:u.jsx(zZ,{})}),u.jsx(Fn,{path:"/bill-order",element:u.jsx(jQ,{})}),u.jsx(Fn,{path:"/show-price",element:u.jsx(_Q,{})}),u.jsx(Fn,{path:"/invoices",element:u.jsx(Xse,{})}),u.jsx(Fn,{path:"/warehouse",element:u.jsx(qse,{})}),u.jsx(Fn,{path:"*",element:u.jsx(zv,{to:"/dashboard",replace:!0})})]})})]})]})})})]})})})}FI.createRoot(document.getElementById("root")).render(u.jsx(Qse,{}));
