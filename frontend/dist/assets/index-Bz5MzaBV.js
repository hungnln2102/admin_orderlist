import{r as ud,a as z4,b as m,L as Kg,u as sm,g as bi,c as CN,R as W4,d as V4,e as la,f as kN,B as K4,h as Gg,i as Yr,N as Lh}from"./vendor-5Jy31MTB.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var y0={exports:{}},So={};var Xg;function G4(){if(Xg)return So;Xg=1;var e=ud(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,c,u){var d,f={},h=null,p=null;u!==void 0&&(h=""+u),c.key!==void 0&&(h=""+c.key),c.ref!==void 0&&(p=c.ref);for(d in c)n.call(c,d)&&!i.hasOwnProperty(d)&&(f[d]=c[d]);if(l&&l.defaultProps)for(d in c=l.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:l,key:h,ref:p,props:f,_owner:a.current}}return So.Fragment=r,So.jsx=s,So.jsxs=s,So}var Yg;function X4(){return Yg||(Yg=1,y0.exports=G4()),y0.exports}var o=X4(),Jl={},qg;function Y4(){if(qg)return Jl;qg=1;var e=z4();return Jl.createRoot=e.createRoot,Jl.hydrateRoot=e.hydrateRoot,Jl}var q4=Y4();const Z4={};var J4={};const Q4=(()=>{const e=typeof import.meta<"u"&&Z4?.VITE_API_BASE_URL||"";if(e)return e;const t=typeof process<"u"&&J4?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function eC(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const Sl=eC(Q4),tC=e=>{if(e.startsWith("http"))return e;const t=Sl.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Ue(e,t){const r=tC(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(a){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw a}}async function rC(e=new Date().getFullYear()){const t=await Ue(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Không thể tải dữ liệu biểu đồ dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],a=l=>{const c=l.month||l.month_label||(Number.isFinite(l.month_num)?`T${l.month_num}`:"");return String(c||"").trim()},i=n.map(l=>({month:a(l),total_sales:Number(l.total_revenue??l.total_sales)||0})),s=n.map(l=>({month:a(l),total_orders:Number(l.total_orders)||0,total_canceled:Number(l.total_canceled)||0}));return{revenueData:i,orderStatusData:s,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function nC(){const e=await Ue("/api/dashboard/years");if(!e.ok)throw new Error("Lỗi khi tải danh sách năm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const AN=m.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),om=()=>m.useContext(AN),aC=({children:e})=>{const[t,r]=m.useState(null),[n,a]=m.useState(!0),i=async()=>{try{const s=await Ue("/api/auth/me");if(!s.ok){r(null);return}const l=await s.json();r(l.user||null)}catch{r(null)}finally{a(!1)}};return m.useEffect(()=>{i()},[]),o.jsx(AN.Provider,{value:{user:t,setUser:r,loading:n,refresh:i},children:e})};function iC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const PN=m.forwardRef(iC);function sC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const oC=m.forwardRef(sC);function lC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const lm=m.forwardRef(lC);function cC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const uC=m.forwardRef(cC);function dC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const cm=m.forwardRef(dC);function fC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const um=m.forwardRef(fC);function hC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const Yo=m.forwardRef(hC);function pC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"}))}const mC=m.forwardRef(pC);function xC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const gC=m.forwardRef(xC);function vC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinejoin:"round",d:"M6.75 3.744h-.753v8.25h7.125a4.125 4.125 0 0 0 0-8.25H6.75Zm0 0v.38m0 16.122h6.747a4.5 4.5 0 0 0 0-9.001h-7.5v9h.753Zm0 0v-.37m0-15.751h6a3.75 3.75 0 1 1 0 7.5h-6m0-7.5v7.5m0 0v8.25m0-8.25h6.375a4.125 4.125 0 0 1 0 8.25H6.75m.747-15.38h4.875a3.375 3.375 0 0 1 0 6.75H7.497v-6.75Zm0 7.5h5.25a3.75 3.75 0 0 1 0 7.5h-5.25v-7.5Z"}))}const bC=m.forwardRef(vC);function yC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const wC=m.forwardRef(yC);function NC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const ON=m.forwardRef(NC);function _C({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const DN=m.forwardRef(_C);function SC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const EC=m.forwardRef(SC);function jC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ui=m.forwardRef(jC);function TC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Hn=m.forwardRef(TC);function CC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const dm=m.forwardRef(CC);function kC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const AC=m.forwardRef(kC);function PC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const OC=m.forwardRef(PC);function DC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const dd=m.forwardRef(DC);function IC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const RC=m.forwardRef(IC);function MC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const w0=m.forwardRef(MC);function FC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const fm=m.forwardRef(FC);function LC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ma=m.forwardRef(LC);function BC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const $C=m.forwardRef(BC);function UC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.248 20.246H9.05m0 0h3.696m-3.696 0 5.893-16.502m0 0h-3.697m3.697 0h3.803"}))}const HC=m.forwardRef(UC);function zC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"}))}const WC=m.forwardRef(zC);function VC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const KC=m.forwardRef(VC);function GC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const as=m.forwardRef(GC);function XC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const IN=m.forwardRef(XC);function YC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const qC=m.forwardRef(YC);function ZC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const is=m.forwardRef(ZC);function JC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const ca=m.forwardRef(JC);function QC({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const RN=m.forwardRef(QC);function ek({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const hm=m.forwardRef(ek);function tk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const di=m.forwardRef(tk);function rk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const fd=m.forwardRef(rk);function nk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const Zg=m.forwardRef(nk);function ak({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0 0 12 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 0 1-2.031.352 5.988 5.988 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971Zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 0 1-2.031.352 5.989 5.989 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971Z"}))}const ik=m.forwardRef(ak);function sk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const hd=m.forwardRef(sk);function ok({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Kr=m.forwardRef(ok);function lk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.995 3.744v7.5a6 6 0 1 1-12 0v-7.5m-2.25 16.502h16.5"}))}const ck=m.forwardRef(lk);function uk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const dk=m.forwardRef(uk);function fk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const hk=m.forwardRef(fk);function pk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 0 0-2.25-2.25H15a3 3 0 1 1-6 0H5.25A2.25 2.25 0 0 0 3 12m18 0v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 9m18 0V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v3"}))}const mk=m.forwardRef(pk);function xk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const MN=m.forwardRef(xk);function gk({title:e,titleId:t,...r},n){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?m.createElement("title",{id:t},e):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Pt=m.forwardRef(gk),Jg=[{title:"Tổng Quan",items:[{name:"Tổng Quan",href:"/dashboard",icon:DN}]},{title:"Sản Phẩm",items:[{name:"Đơn Hàng",href:"/orders",icon:hd},{name:"Gói Sản Phẩm",href:"/package-products",icon:OC},{name:"Bảng Giá",href:"/pricing",icon:dd},{name:"Thông Tin Sản Phẩm",href:"/product-info",icon:$C}]},{title:"Cung Cấp",items:[{name:"Nhà Cung Cấp",href:"/sources",icon:RC},{name:"Báo Giá",href:"/show-price",icon:w0},{name:"Hóa Đơn",href:"/bill-order",icon:w0},{name:"Biên Lai",href:"/invoices",icon:w0},{name:"Lô Hàng",href:"/warehouse",icon:PN}]}],Qg=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,a])=>`${n}=${a}`).sort().join("&")},N0=(e,t,r)=>{const[n,a]=r.split("?"),i=a?`?${a}`:"";return e!==n?!1:Qg(t)===Qg(i)},vk=({section:e,isStaticSection:t,isOpenSection:r,currentPath:n,currentSearch:a,onToggle:i,onNavigate:s})=>{const l=e.items.some(c=>n===c.href||N0(n,a,c.href));return o.jsx("div",{className:`w-full rounded-2xl border border-white/5 bg-white/0 mb-3 transition-all duration-500 ${l?"ring-1 ring-indigo-500/30 bg-indigo-500/5 shadow-[0_20px_40px_-15px_rgba(79,70,229,0.15)]":""}`,children:t?o.jsx("div",{className:"space-y-1 px-2 py-1",children:e.items.map(c=>{const u=n===c.href||N0(n,a,c.href);return o.jsx("div",{className:"space-y-2",children:o.jsxs(Kg,{to:c.href,onClick:s,className:`
                    group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-300 ease-[cubic-bezier(0.23,1,0.32,1)]
                    ${u?"bg-indigo-500/20 text-white border border-indigo-500/30 shadow-[0_0_20px_rgba(99,102,241,0.2)]":"text-indigo-100/70 hover:bg-white/5 hover:text-white border border-transparent"}
                  `,children:[o.jsx(c.icon,{className:`h-5 w-5 transition-colors ${u?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{type:"button",onClick:()=>i(e.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[o.jsx("span",{children:e.title}),o.jsx(dm,{className:`h-4 w-4 transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"space-y-1 px-2.5 py-2",children:e.items.map(c=>{const u=n===c.href||N0(n,a,c.href);return o.jsx("div",{className:"space-y-2",children:o.jsxs(Kg,{to:c.href,onClick:s,className:`
                        group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-300 ease-[cubic-bezier(0.23,1,0.32,1)]
                        ${u?"bg-indigo-500/20 text-white border border-indigo-500/30 shadow-[0_0_20px_rgba(99,102,241,0.2)]":"text-indigo-100/70 hover:bg-white/5 hover:text-white border border-transparent"}
                      `,children:[o.jsx(c.icon,{className:`h-5 w-5 transition-colors ${u?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})})]})})},bk=({user:e,onLogout:t,onChangePassword:r})=>{const[n,a]=m.useState(!1);return o.jsxs("div",{className:"relative p-5 mt-auto border-t border-white/5 bg-white/0 backdrop-blur-md rounded-b-[32px]",children:[o.jsxs("div",{className:"w-full flex items-center justify-between",children:[o.jsxs("button",{type:"button",onClick:()=>a(i=>!i),className:"flex items-center flex-1",children:[o.jsxs("div",{className:"group/avatar relative w-11 h-11 transition-all duration-300 transform group-hover/account:scale-105",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-indigo-500 to-purple-500 rounded-full blur-[2px] opacity-40 group-hover/avatar:opacity-60 transition-opacity"}),o.jsx("div",{className:"relative w-full h-full bg-slate-900 border border-white/20 rounded-full flex items-center justify-center overflow-hidden shadow-[inset_0_2px_4px_rgba(255,255,255,0.1)]",children:o.jsx("span",{className:"text-white text-base font-black tracking-tighter",children:(e?.username||"A").slice(0,1).toUpperCase()})})]}),o.jsxs("div",{className:"ml-3 flex-1 text-left",children:[o.jsx("p",{className:"text-sm font-semibold text-white truncate",children:e?.username||"Tài Khoản"}),o.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:e?.role?`Role: ${e.role}`:"Chưa đăng nhập"})]})]}),o.jsx("button",{type:"button",onClick:t,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"Đăng Xuất",children:o.jsx(uC,{className:"h-5 w-5"})})]}),n&&o.jsx("div",{className:"absolute bottom-[calc(100%+8px)] left-4 right-4 glass-panel rounded-2xl shadow-2xl z-50 overflow-hidden animate-in fade-in slide-in-from-bottom-2 duration-300",children:o.jsx("ul",{className:"py-2 text-[13px] font-medium text-indigo-100/90 divide-y divide-white/5",children:["Thông Tin","Thông Tin Admin","Thông Tin Quản Lý","Thay Đổi Mật Khẩu"].map((i,s)=>o.jsx("li",{children:o.jsx("button",{type:"button",className:"w-full text-left px-4 py-2.5 hover:bg-indigo-500/10 hover:text-white transition-colors",onClick:()=>{a(!1),s===3&&r()},children:i})},i))})})]})},yk=({isOpen:e,onClose:t})=>{const[r,n]=m.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,i]=m.useState(null),[s,l]=m.useState(null),[c,u]=m.useState(!1),d=()=>{n({currentPassword:"",newPassword:"",confirmPassword:""}),i(null),l(null)};m.useEffect(()=>{e&&d()},[e]);const f=()=>{t(),d()},h=async p=>{if(p.preventDefault(),i(null),l(null),!r.currentPassword||!r.newPassword||!r.confirmPassword){i("Vui lòng nhập đủ thông tin.");return}if(r.newPassword!==r.confirmPassword){i("Mật khẩu mới không khớp.");return}u(!0);try{const x=await Ue("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:r.currentPassword,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!x.ok){const g=await x.json().catch(()=>null);i(g?.error||"Không thay đổi được mật khẩu.");return}l("Thay đổi mật khẩu thành công."),n({currentPassword:"",newPassword:"",confirmPassword:""})}catch{i("Không thay đổi được mật khẩu.")}finally{u(!1)}};return e?o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/60 px-4",onClick:f,children:o.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",onClick:p=>p.stopPropagation(),role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Thay đổi mật khẩu"}),o.jsx("button",{type:"button",onClick:f,className:"text-white/70 hover:text-white transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-indigo-400/60","aria-label":"Đóng",children:o.jsx(Pt,{className:"h-5 w-5"})})]}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Mật khẩu cũ"}),o.jsx("input",{type:"password",autoComplete:"current-password",value:r.currentPassword,onChange:p=>n(x=>({...x,currentPassword:p.target.value})),placeholder:"Nhập mật khẩu cũ",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Mật khẩu mới"}),o.jsx("input",{type:"password",autoComplete:"new-password",value:r.newPassword,onChange:p=>n(x=>({...x,newPassword:p.target.value})),placeholder:"Nhập mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Nhập lại mật khẩu mới"}),o.jsx("input",{type:"password",autoComplete:"new-password",value:r.confirmPassword,onChange:p=>n(x=>({...x,confirmPassword:p.target.value})),placeholder:"Nhập lại mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),a&&o.jsx("p",{className:"text-sm text-rose-300",children:a}),s&&o.jsx("p",{className:"text-sm text-emerald-200",children:s}),o.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:f,disabled:c,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:"Hủy bỏ"}),o.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 rounded-md bg-indigo-500 text-white hover:bg-indigo-600 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang xử lý...":"Xác nhận"})]})]})]})}):null};function wk({isOpen:e,setIsOpen:t}){const r=sm(),{user:n,setUser:a}=om(),[i,s]=m.useState(()=>Object.fromEntries(Jg.map(p=>[p.title,!0]))),[l,c]=m.useState(!1),u=p=>{s(x=>({...x,[p]:!x[p]}))},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{a(null),window.location.href="/login"}},f=()=>{c(!0)},h=()=>{c(!1)};return o.jsxs(o.Fragment,{children:[e&&o.jsx("div",{className:"sidebar__backdrop lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>t(!1)}),o.jsx("div",{className:`sidebar ${e?"sidebar--open":"sidebar--closed"}
          fixed top-4 left-4 bottom-4 z-40 w-64 glass-panel rounded-[32px] 
          transform transition-all duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)]
          ${e?"translate-x-0 opacity-100":"-translate-x-[110%] lg:translate-x-0 opacity-0 lg:opacity-100"}
          border border-white/10 shadow-[0_32px_64px_-16px_rgba(0,0,0,0.6)]
        `,children:o.jsxs("div",{className:"sidebar__inner flex flex-col h-full",children:[o.jsx("div",{className:"sidebar__brand px-5 pt-6 pb-2",children:o.jsxs("div",{className:"group relative overflow-hidden rounded-xl bg-gradient-to-tr from-indigo-500/10 to-purple-500/10 p-[1px] transition-all hover:scale-[1.02]",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-indigo-600 to-purple-600 opacity-10 group-hover:opacity-20 transition-opacity"}),o.jsx("div",{className:"relative rounded-[11px] bg-[#0c1222]/80 py-3 backdrop-blur-md border border-white/5 overflow-hidden [mask-image:linear-gradient(to_right,transparent,black_20%,black_80%,transparent)]",children:o.jsxs("div",{className:"animate-marquee-seamless",style:{animationDuration:"25s"},children:[o.jsxs("h1",{className:"text-[11px] font-bold text-white uppercase tracking-[0.2em] whitespace-nowrap px-6",children:["Mavryk ",o.jsx("span",{className:"text-indigo-400",children:"Store"})]}),o.jsxs("h1",{className:"text-[11px] font-bold text-white uppercase tracking-[0.2em] whitespace-nowrap px-6",children:["Mavryk ",o.jsx("span",{className:"text-indigo-400",children:"Store"})]})]})})]})}),o.jsx("nav",{className:"sidebar__nav flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:Jg.map((p,x)=>o.jsx(vk,{section:p,isStaticSection:x===0,isOpenSection:i[p.title]??!0,currentPath:r.pathname,currentSearch:r.search,onToggle:u,onNavigate:()=>t(!1)},p.title))}),o.jsx(bk,{user:n,onLogout:d,onChangePassword:f})]})}),o.jsx(yk,{isOpen:l,onClose:h})]})}const Nk=({title:e,value:t,delta:r,trend:n,accent:a,icon:i})=>{const s=a==="amber"?{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"}:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"},l=n==="up"?um:cm;return o.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4 bg-white/70 border border-white/40 shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`h-10 w-10 rounded-xl ${s.iconBg} flex items-center justify-center`,children:o.jsx(i,{className:"h-5 w-5"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:e}),o.jsx("p",{className:"text-xl font-bold text-white",children:t})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-semibold ${s.chip}`,children:[o.jsx(l,{className:"h-3.5 w-3.5"}),r]})})]})},_k=({loading:e,error:t,rows:r,onRefresh:n})=>o.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/60 via-slate-700/50 to-slate-900/60 p-6 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.75),0_14px_36px_-24px_rgba(255,255,255,0.2)]",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Bảng giá HanaGold"}),o.jsx("p",{className:"text-xs text-white/70",children:"Mua/Bán theo ngày"})]}),o.jsx("button",{type:"button",onClick:n,className:"rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20 border border-white/20",children:"Làm mới"})]}),t&&o.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/60 bg-amber-50/10 px-3 py-2 text-sm text-amber-200",children:t}),o.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:o.jsxs("table",{className:"min-w-full text-sm text-white",children:[o.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-left",children:"Mục"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Mua"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng tiền mua vàng"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng vàng (chỉ)"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Lợi nhuận"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Bán"}),o.jsx("th",{className:"px-3 py-2 text-center",children:"Xu hướng"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/10",children:[e&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Đang tải giá vàng..."})}),!e&&r.length===0&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Chưa có dữ liệu."})}),!e&&r.map((a,i)=>o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 font-semibold",children:a.displayName||"Không tên"}),o.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.bid/10).toLocaleString("vi-VN")," đ"]}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldValue!==void 0?a.totalGoldValue.toLocaleString("vi-VN"):"—"}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldAmount!==void 0?a.totalGoldAmount.toFixed(4):"—"}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.profit!==void 0?a.profit.toLocaleString("vi-VN"):"—"}),o.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.ask/10).toLocaleString("vi-VN")," đ"]}),o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-[11px] font-semibold ${a.trendBid==="up"?"bg-emerald-500/20 text-emerald-200":a.trendBid==="down"?"bg-rose-500/20 text-rose-200":"bg-white/10 text-white/80"}`,children:a.trendBid==="up"?"Tăng":a.trendBid==="down"?"Giảm":"Ổn định"})})]},`${a.displayName}-${a.time}-${i}`))]})]})})]}),Sk="modulepreload",Ek=function(e){return"/"+e},ev={},Vc=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let c=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=s?.nonce||s?.getAttribute("nonce");a=c(r.map(u=>{if(u=Ek(u),u in ev)return;ev[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Sk,d||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((p,x)=>{h.addEventListener("load",p),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return a.then(s=>{for(const l of s||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function FN(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=FN(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=FN(e))&&(n&&(n+=" "),n+=t);return n}var jk=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function pm(e){if(typeof e!="string")return!1;var t=jk;return t.includes(e)}var Tk=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Ck=new Set(Tk);function LN(e){return typeof e!="string"?!1:Ck.has(e)}function BN(e){return typeof e=="string"&&e.startsWith("data-")}function xn(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(LN(r)||BN(r))&&(t[r]=e[r]);return t}function Hi(e){if(e==null)return null;if(m.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return xn(t)}return typeof e=="object"&&!Array.isArray(e)?xn(e):null}function Gr(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(LN(r)||BN(r)||pm(r))&&(t[r]=e[r]);return t}function kk(e){return e==null?null:m.isValidElement(e)?Gr(e.props):typeof e=="object"&&!Array.isArray(e)?Gr(e):null}var Ak=["children","width","height","viewBox","className","style","title","desc"];function Bh(){return Bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bh.apply(null,arguments)}function Pk(e,t){if(e==null)return{};var r,n,a=Ok(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ok(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $N=m.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:c,desc:u}=e,d=Pk(e,Ak),f=i||{width:n,height:a,x:0,y:0},h=lt("recharts-surface",s);return m.createElement("svg",Bh({},Gr(d),{className:h,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),m.createElement("title",null,c),m.createElement("desc",null,u),r)}),Dk=["children","className"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$h.apply(null,arguments)}function Ik(e,t){if(e==null)return{};var r,n,a=Rk(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Rk(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cr=m.forwardRef((e,t)=>{var{children:r,className:n}=e,a=Ik(e,Dk),i=lt("recharts-layer",n);return m.createElement("g",$h({className:i},Gr(a),{ref:t}),r)}),Mk=m.createContext(null);function bt(e){return function(){return e}}const UN=Math.cos,Kc=Math.sin,Kn=Math.sqrt,Gc=Math.PI,pd=2*Gc,Uh=Math.PI,Hh=2*Uh,Ci=1e-6,Fk=Hh-Ci;function HN(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Lk(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return HN;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Bk{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?HN:Lk(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,u=a-r,d=s-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Ci)if(!(Math.abs(f*c-u*d)>Ci)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,x=a-l,g=c*c+u*u,v=p*p+x*x,b=Math.sqrt(g),w=Math.sqrt(h),y=i*Math.tan((Uh-Math.acos((g+h-v)/(2*b*w)))/2),N=y/w,S=y/b;Math.abs(N-1)>Ci&&this._append`L${t+N*d},${r+N*f}`,this._append`A${i},${i},0,0,${+(f*p>d*x)},${this._x1=t+S*c},${this._y1=r+S*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Ci||Math.abs(this._y1-d)>Ci)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%Hh+Hh),h>Fk?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Ci&&this._append`A${n},${n},0,${+(h>=Uh)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function mm(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Bk(t)}function xm(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function zN(e){this._context=e}zN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function md(e){return new zN(e)}function WN(e){return e[0]}function VN(e){return e[1]}function KN(e,t){var r=bt(!0),n=null,a=md,i=null,s=mm(l);e=typeof e=="function"?e:e===void 0?WN:bt(e),t=typeof t=="function"?t:t===void 0?VN:bt(t);function l(c){var u,d=(c=xm(c)).length,f,h=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,c),+t(f,u,c));if(p)return i=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:bt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:bt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:bt(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function Ql(e,t,r){var n=null,a=bt(!0),i=null,s=md,l=null,c=mm(u);e=typeof e=="function"?e:e===void 0?WN:bt(+e),t=typeof t=="function"?t:bt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?VN:bt(+r);function u(f){var h,p,x,g=(f=xm(f)).length,v,b=!1,w,y=new Array(g),N=new Array(g);for(i==null&&(l=s(w=c())),h=0;h<=g;++h){if(!(h<g&&a(v=f[h],h,f))===b)if(b=!b)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=h-1;x>=p;--x)l.point(y[x],N[x]);l.lineEnd(),l.areaEnd()}b&&(y[h]=+e(v,h,f),N[h]=+t(v,h,f),l.point(n?+n(v,h,f):y[h],r?+r(v,h,f):N[h]))}if(w)return l=null,w+""||null}function d(){return KN().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:bt(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:bt(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:bt(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),u):i},u}class GN{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function $k(e){return new GN(e,!0)}function Uk(e){return new GN(e,!1)}const gm={draw(e,t){const r=Kn(t/Gc);e.moveTo(r,0),e.arc(0,0,r,0,pd)}},Hk={draw(e,t){const r=Kn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},XN=Kn(1/3),zk=XN*2,Wk={draw(e,t){const r=Kn(t/zk),n=r*XN;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Vk={draw(e,t){const r=Kn(t),n=-r/2;e.rect(n,n,r,r)}},Kk=.8908130915292852,YN=Kc(Gc/10)/Kc(7*Gc/10),Gk=Kc(pd/10)*YN,Xk=-UN(pd/10)*YN,Yk={draw(e,t){const r=Kn(t*Kk),n=Gk*r,a=Xk*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=pd*i/5,l=UN(s),c=Kc(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},_0=Kn(3),qk={draw(e,t){const r=-Kn(t/(_0*3));e.moveTo(0,r*2),e.lineTo(-_0*r,-r),e.lineTo(_0*r,-r),e.closePath()}},yn=-.5,wn=Kn(3)/2,zh=1/Kn(12),Zk=(zh/2+1)*3,Jk={draw(e,t){const r=Kn(t/Zk),n=r/2,a=r*zh,i=n,s=r*zh+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(yn*n-wn*a,wn*n+yn*a),e.lineTo(yn*i-wn*s,wn*i+yn*s),e.lineTo(yn*l-wn*c,wn*l+yn*c),e.lineTo(yn*n+wn*a,yn*a-wn*n),e.lineTo(yn*i+wn*s,yn*s-wn*i),e.lineTo(yn*l+wn*c,yn*c-wn*l),e.closePath()}};function Qk(e,t){let r=null,n=mm(a);e=typeof e=="function"?e:bt(e||gm),t=typeof t=="function"?t:bt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:bt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:bt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Xc(){}function Yc(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function qN(e){this._context=e}qN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Yc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Yc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eA(e){return new qN(e)}function ZN(e){this._context=e}ZN.prototype={areaStart:Xc,areaEnd:Xc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Yc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tA(e){return new ZN(e)}function JN(e){this._context=e}JN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Yc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rA(e){return new JN(e)}function QN(e){this._context=e}QN.prototype={areaStart:Xc,areaEnd:Xc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function nA(e){return new QN(e)}function tv(e){return e<0?-1:1}function rv(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(tv(i)+tv(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function nv(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function S0(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function qc(e){this._context=e}qc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:S0(this,this._t0,nv(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,S0(this,nv(this,r=rv(this,e,t)),r);break;default:S0(this,this._t0,r=rv(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function e_(e){this._context=new t_(e)}(e_.prototype=Object.create(qc.prototype)).point=function(e,t){qc.prototype.point.call(this,t,e)};function t_(e){this._context=e}t_.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function aA(e){return new qc(e)}function iA(e){return new e_(e)}function r_(e){this._context=e}r_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=av(e),a=av(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function av(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function sA(e){return new r_(e)}function xd(e,t){this._context=e,this._t=t}xd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function oA(e){return new xd(e,.5)}function lA(e){return new xd(e,0)}function cA(e){return new xd(e,1)}function zi(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Wh(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function uA(e,t){return e[t]}function dA(e){const t=[];return t.key=e,t}function fA(){var e=bt([]),t=Wh,r=zi,n=uA;function a(i){var s=Array.from(e.apply(this,arguments),dA),l,c=s.length,u=-1,d;for(const f of i)for(l=0,++u;l<c;++l)(s[l][u]=[0,+n(f,s[l].key,u,i)]).data=f;for(l=0,d=xm(t(s));l<c;++l)s[d[l]].index=l;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:bt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:bt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Wh:typeof i=="function"?i:bt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??zi,a):r},a}function hA(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}zi(e,t)}}function pA(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}zi(e,t)}}function mA(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,u=0;l<s;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,x=0;x<l;++x){var g=e[t[x]],v=g[n][1]||0,b=g[n-1][1]||0;p+=v-b}c+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,zi(e,t)}}var E0={},j0={},iv;function xA(){return iv||(iv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(j0)),j0}var T0={},sv;function n_(){return sv||(sv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(T0)),T0}var C0={},ov;function vm(){return ov||(ov=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(C0)),C0}var k0={},A0={},lv;function gA(){return lv||(lv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(A0)),A0}var cv;function bm(){return cv||(cv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gA(),r=vm();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),l++);l<s;){const f=a[l];u?f==="\\"&&l+1<s?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,i.push(c),c=""):c+=f:f==="["?(d=!0,c&&(i.push(c),c="")):f==="."?c&&(i.push(c),c=""):c+=f,l++}return c&&i.push(c),i}e.toPath=n})(k0)),k0}var uv;function ym(){return uv||(uv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xA(),r=n_(),n=vm(),a=bm();function i(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?i(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return s(l,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function s(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=i})(E0)),E0}var P0,dv;function vA(){return dv||(dv=1,P0=ym().get),P0}var bA=vA();const Wi=bi(bA);var yA=4;function si(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yA,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function $t(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,i,s)=>{var l=r[s-1];return typeof l=="string"?a+l+i:l!==void 0?a+si(l)+i:a+i},"")}var lr=e=>e===0?0:e>0?1:-1,ua=e=>typeof e=="number"&&e!=+e,Vi=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ie=e=>(typeof e=="number"||e instanceof Number)&&!ua(e),da=e=>Ie(e)||typeof e=="string",wA=0,qo=e=>{var t=++wA;return"".concat(e||"").concat(t)},Ar=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ie(t)&&typeof t!="string")return n;var i;if(Vi(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ua(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},a_=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Tt(e,t,r){return Ie(e)&&Ie(t)?si(e+r*(t-e)):t}function i_(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Wi(n,t))===r)}var Ft=e=>e===null||typeof e>"u",El=e=>Ft(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function en(e){return e!=null}function ss(){}var NA=["type","size","sizeType"];function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vh.apply(null,arguments)}function fv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fv(Object(r),!0).forEach(function(n){_A(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _A(e,t,r){return(t=SA(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SA(e){var t=EA(e,"string");return typeof t=="symbol"?t:t+""}function EA(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jA(e,t){if(e==null)return{};var r,n,a=TA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function TA(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var s_={symbolCircle:gm,symbolCross:Hk,symbolDiamond:Wk,symbolSquare:Vk,symbolStar:Yk,symbolTriangle:qk,symbolWye:Jk},CA=Math.PI/180,kA=e=>{var t="symbol".concat(El(e));return s_[t]||gm},AA=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*CA;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},PA=(e,t)=>{s_["symbol".concat(El(e))]=t},o_=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=jA(e,NA),i=hv(hv({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var h=kA(s),p=Qk().type(h).size(AA(r,n,s)),x=p();if(x!==null)return x},{className:c,cx:u,cy:d}=i,f=Gr(i);return Ie(u)&&Ie(d)&&Ie(r)?m.createElement("path",Vh({},f,{className:lt("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};o_.registerSymbol=PA;var l_=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,wm=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(m.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{pm(a)&&(n[a]=(i=>r[a](r,i)))}),n},OA=(e,t,r)=>n=>(e(t,r,n),null),gd=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];pm(a)&&typeof i=="function"&&(n||(n={}),n[a]=OA(i,t,r))}),n};function pv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pv(Object(r),!0).forEach(function(n){IA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IA(e,t,r){return(t=RA(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RA(e){var t=MA(e,"string");return typeof t=="symbol"?t:t+""}function MA(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ur(e,t){var r=DA({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}var O0={},D0={},mv;function FA(){return mv||(mv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s,i,r);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(D0)),D0}var I0={},xv;function LA(){return xv||(xv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(I0)),I0}var R0={},gv;function c_(){return gv||(gv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(R0)),R0}var M0={},F0={},L0={},vv;function BA(){return vv||(vv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(L0)),L0}var bv;function Nm(){return bv||(bv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BA();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(F0)),F0}var B0={},yv;function $A(){return yv||(yv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(B0)),B0}var wv;function UA(){return wv||(wv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Nm(),r=$A();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(M0)),M0}var $0={},U0={},Nv;function HA(){return Nv||(Nv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ym();function r(n){return function(a){return t.get(a,n)}}e.property=r})(U0)),U0}var H0={},z0={},W0={},V0={},_v;function u_(){return _v||(_v=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(V0)),V0}var K0={},Sv;function d_(){return Sv||(Sv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(K0)),K0}var G0={},Ev;function f_(){return Ev||(Ev=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(G0)),G0}var jv;function zA(){return jv||(jv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u_(),r=d_(),n=f_();function a(d,f,h){return typeof h!="function"?a(d,f,()=>{}):i(d,f,function p(x,g,v,b,w,y){const N=h(x,g,v,b,w,y);return N!==void 0?!!N:i(x,g,p,y)},new Map)}function i(d,f,h,p){if(f===d)return!0;switch(typeof f){case"object":return s(d,f,h,p);case"function":return Object.keys(f).length>0?i(d,{...f},h,p):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function s(d,f,h,p){if(f==null)return!0;if(Array.isArray(f))return c(d,f,h,p);if(f instanceof Map)return l(d,f,h,p);if(f instanceof Set)return u(d,f,h,p);const x=Object.keys(f);if(d==null||r.isPrimitive(d))return x.length===0;if(x.length===0)return!0;if(p?.has(f))return p.get(f)===d;p?.set(f,d);try{for(let g=0;g<x.length;g++){const v=x[g];if(!r.isPrimitive(d)&&!(v in d)||f[v]===void 0&&d[v]!==void 0||f[v]===null&&d[v]!==null||!h(d[v],f[v],v,d,f,p))return!1}return!0}finally{p?.delete(f)}}function l(d,f,h,p){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[x,g]of f.entries()){const v=d.get(x);if(h(v,g,x,d,f,p)===!1)return!1}return!0}function c(d,f,h,p){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const x=new Set;for(let g=0;g<f.length;g++){const v=f[g];let b=!1;for(let w=0;w<d.length;w++){if(x.has(w))continue;const y=d[w];let N=!1;if(h(y,v,g,d,f,p)&&(N=!0),N){x.add(w),b=!0;break}}if(!b)return!1}return!0}function u(d,f,h,p){return f.size===0?!0:d instanceof Set?c([...d],[...f],h,p):!1}e.isMatchWith=a,e.isSetMatch=u})(W0)),W0}var Tv;function h_(){return Tv||(Tv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zA();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(z0)),z0}var X0={},Y0={},q0={},Cv;function WA(){return Cv||(Cv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(q0)),q0}var Z0={},kv;function _m(){return kv||(kv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Z0)),Z0}var J0={},Av;function p_(){return Av||(Av=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",p="[object Object]",x="[object Error]",g="[object DataView]",v="[object Uint8Array]",b="[object Uint8ClampedArray]",w="[object Uint16Array]",y="[object Uint32Array]",N="[object BigUint64Array]",S="[object Int8Array]",E="[object Int16Array]",_="[object Int32Array]",j="[object BigInt64Array]",A="[object Float32Array]",T="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=j,e.bigUint64ArrayTag=N,e.booleanTag=a,e.dataViewTag=g,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=A,e.float64ArrayTag=T,e.functionTag=f,e.int16ArrayTag=E,e.int32ArrayTag=_,e.int8ArrayTag=S,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=w,e.uint32ArrayTag=y,e.uint8ArrayTag=v,e.uint8ClampedArrayTag=b})(J0)),J0}var Q0={},Pv;function VA(){return Pv||(Pv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Q0)),Q0}var Ov;function m_(){return Ov||(Ov=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WA(),r=_m(),n=p_(),a=d_(),i=VA();function s(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,h,p=new Map,x=void 0){const g=x?.(d,f,h,p);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const v=new Array(d.length);p.set(d,v);for(let b=0;b<d.length;b++)v[b]=l(d[b],b,h,p,x);return Object.hasOwn(d,"index")&&(v.index=d.index),Object.hasOwn(d,"input")&&(v.input=d.input),v}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const v=new RegExp(d.source,d.flags);return v.lastIndex=d.lastIndex,v}if(d instanceof Map){const v=new Map;p.set(d,v);for(const[b,w]of d)v.set(b,l(w,b,h,p,x));return v}if(d instanceof Set){const v=new Set;p.set(d,v);for(const b of d)v.add(l(b,void 0,h,p,x));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const v=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,v);for(let b=0;b<d.length;b++)v[b]=l(d[b],b,h,p,x);return v}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const v=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,v),c(v,d,h,p,x),v}if(typeof File<"u"&&d instanceof File){const v=new File([d],d.name,{type:d.type});return p.set(d,v),c(v,d,h,p,x),v}if(typeof Blob<"u"&&d instanceof Blob){const v=new Blob([d],{type:d.type});return p.set(d,v),c(v,d,h,p,x),v}if(d instanceof Error){const v=new d.constructor;return p.set(d,v),v.message=d.message,v.name=d.name,v.stack=d.stack,v.cause=d.cause,c(v,d,h,p,x),v}if(d instanceof Boolean){const v=new Boolean(d.valueOf());return p.set(d,v),c(v,d,h,p,x),v}if(d instanceof Number){const v=new Number(d.valueOf());return p.set(d,v),c(v,d,h,p,x),v}if(d instanceof String){const v=new String(d.valueOf());return p.set(d,v),c(v,d,h,p,x),v}if(typeof d=="object"&&u(d)){const v=Object.create(Object.getPrototypeOf(d));return p.set(d,v),c(v,d,h,p,x),v}return d}function c(d,f,h=d,p,x){const g=[...Object.keys(f),...t.getSymbols(f)];for(let v=0;v<g.length;v++){const b=g[v],w=Object.getOwnPropertyDescriptor(d,b);(w==null||w.writable)&&(d[b]=l(f[b],b,h,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=c})(Y0)),Y0}var Dv;function KA(){return Dv||(Dv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m_();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(X0)),X0}var Iv;function GA(){return Iv||(Iv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h_(),r=KA();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(H0)),H0}var ef={},tf={},rf={},Rv;function XA(){return Rv||(Rv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m_(),r=_m(),n=p_();function a(i,s){return t.cloneDeepWith(i,(l,c,u,d)=>{const f=s?.(l,c,u,d);if(f!==void 0)return f;if(typeof i=="object"){if(r.getTag(i)===n.objectTag&&typeof i.constructor!="function"){const h={};return d.set(i,h),t.copyProperties(h,i,u,d),h}switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new i.constructor(i?.valueOf());return t.copyProperties(h,i),h}case n.argumentsTag:{const h={};return t.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}}})}e.cloneDeepWith=a})(rf)),rf}var Mv;function YA(){return Mv||(Mv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=XA();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(tf)),tf}var nf={},af={},Fv;function x_(){return Fv||(Fv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(af)),af}var sf={},Lv;function qA(){return Lv||(Lv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_m();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(sf)),sf}var Bv;function ZA(){return Bv||(Bv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n_(),r=x_(),n=qA(),a=bm();function i(s,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=s;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=i})(nf)),nf}var $v;function JA(){return $v||($v=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h_(),r=vm(),n=YA(),a=ym(),i=ZA();function s(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?i.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=s})(ef)),ef}var Uv;function QA(){return Uv||(Uv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c_(),r=HA(),n=GA(),a=JA();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})($0)),$0}var Hv;function eP(){return Hv||(Hv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FA(),r=LA(),n=c_(),a=UA(),i=QA();function s(l,c=n.identity){return a.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(i.iteratee(c),1)):[]}e.uniqBy=s})(O0)),O0}var of,zv;function tP(){return zv||(zv=1,of=eP().uniqBy),of}var rP=tP();const Wv=bi(rP);function nP(e,t,r){return t===!0?Wv(e,r):typeof t=="function"?Wv(e,t):e}var lf={exports:{}},cf={},uf={exports:{}},df={};var Vv;function aP(){if(Vv)return df;Vv=1;var e=ud();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(f,h){var p=h(),x=n({inst:{value:p,getSnapshot:h}}),g=x[0].inst,v=x[1];return i(function(){g.value=p,g.getSnapshot=h,c(g)&&v({inst:g})},[f,p,h]),a(function(){return c(g)&&v({inst:g}),f(function(){c(g)&&v({inst:g})})},[f]),s(p),p}function c(f){var h=f.getSnapshot;f=f.value;try{var p=h();return!r(f,p)}catch{return!0}}function u(f,h){return h()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return df.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,df}var Kv;function iP(){return Kv||(Kv=1,uf.exports=aP()),uf.exports}var Gv;function sP(){if(Gv)return cf;Gv=1;var e=ud(),t=iP();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,c=e.useDebugValue;return cf.useSyncExternalStoreWithSelector=function(u,d,f,h,p){var x=i(null);if(x.current===null){var g={hasValue:!1,value:null};x.current=g}else g=x.current;x=l(function(){function b(E){if(!w){if(w=!0,y=E,E=h(E),p!==void 0&&g.hasValue){var _=g.value;if(p(_,E))return N=_}return N=E}if(_=N,n(y,E))return _;var j=h(E);return p!==void 0&&p(_,j)?(y=E,_):(y=E,N=j)}var w=!1,y,N,S=f===void 0?null:f;return[function(){return b(d())},S===null?void 0:function(){return b(S())}]},[d,f,h,p]);var v=a(u,x[0],x[1]);return s(function(){g.hasValue=!0,g.value=v},[v]),c(v),v},cf}var Xv;function oP(){return Xv||(Xv=1,lf.exports=sP()),lf.exports}var lP=oP(),Sm=m.createContext(null),cP=e=>e,Ot=()=>{var e=m.useContext(Sm);return e?e.store.dispatch:cP},Rc=()=>{},uP=()=>Rc,dP=(e,t)=>e===t;function Fe(e){var t=m.useContext(Sm),r=m.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Rc,[t,e]);return lP.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:uP,t?t.store.getState:Rc,t?t.store.getState:Rc,r,dP)}function fP(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function hP(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function pP(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var Yv=e=>Array.isArray(e)?e:[e];function mP(e){const t=Array.isArray(e[0])?e[0]:e;return pP(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function xP(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var gP=class{constructor(e){this.value=e}deref(){return this.value}},vP=typeof WeakRef<"u"?WeakRef:gP,bP=0,qv=1;function ec(){return{s:bP,v:void 0,o:null,p:null}}function g_(e,t={}){let r=ec();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let l=r;const{length:c}=arguments;for(let f=0,h=c;f<h;f++){const p=arguments[f];if(typeof p=="function"||typeof p=="object"&&p!==null){let x=l.o;x===null&&(l.o=x=new WeakMap);const g=x.get(p);g===void 0?(l=ec(),x.set(p,l)):l=g}else{let x=l.p;x===null&&(l.p=x=new Map);const g=x.get(p);g===void 0?(l=ec(),x.set(p,l)):l=g}}const u=l;let d;if(l.s===qv)d=l.v;else if(d=e.apply(null,arguments),i++,n){const f=a?.deref?.()??a;f!=null&&n(f,d)&&(d=f,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new vP(d):d}return u.s=qv,u.v=d,d}return s.clearCache=()=>{r=ec(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function yP(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),fP(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:p=g_,argsMemoizeOptions:x=[]}=d,g=Yv(h),v=Yv(x),b=mP(a),w=f(function(){return i++,u.apply(null,arguments)},...g),y=p(function(){s++;const S=xP(b,arguments);return l=w.apply(null,S),l},...v);return Object.assign(y,{resultFunc:u,memoizedResultFunc:w,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var Q=yP(g_),wP=Object.assign((e,t=Q)=>{hP(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,c)=>(s[r[c]]=l,s),{}))},{withTypes:()=>wP}),ff={},hf={},pf={},Zv;function NP(){return Zv||(Zv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(pf)),pf}var mf={},xf={},Jv;function v_(){return Jv||(Jv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(xf)),xf}var Qv;function _P(){return Qv||(Qv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=v_(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(mf)),mf}var e1;function SP(){return e1||(e1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NP(),r=_P(),n=bm();function a(i,s,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const u=(p,x)=>{let g=p;for(let v=0;v<x.length&&g!=null;++v)g=g[x[v]];return g},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,f=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return i.map(p=>({original:p,criteria:f.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let g=0;g<f.length;g++){const v=t.compareValues(p.criteria[g],x.criteria[g],l[g]);if(v!==0)return v}return 0}).map(p=>p.original)}e.orderBy=a})(hf)),hf}var gf={},t1;function EP(){return t1||(t1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<i?s(d,c+1):a.push(d)}};return s(r,0),a}e.flatten=t})(gf)),gf}var vf={},r1;function b_(){return r1||(r1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=x_(),r=Nm(),n=u_(),a=f_();function i(s,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.isEqualsSameValueZero(c[l],s):!1}e.isIterateeCall=i})(vf)),vf}var n1;function jP(){return n1||(n1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SP(),r=EP(),n=b_();function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(ff)),ff}var bf,a1;function TP(){return a1||(a1=1,bf=jP().sortBy),bf}var CP=TP();const vd=bi(CP);var y_=e=>e.legend.settings,kP=e=>e.legend.size,AP=e=>e.legend.payload;Q([AP,y_],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?vd(n,r):n});var tc=1;function PP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=m.useState({height:0,left:0,top:0,width:0}),n=m.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>tc||Math.abs(s.left-t.left)>tc||Math.abs(s.top-t.top)>tc||Math.abs(s.width-t.width)>tc)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function pr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var OP=typeof Symbol=="function"&&Symbol.observable||"@@observable",i1=OP,yf=()=>Math.random().toString(36).substring(7).split("").join("."),DP={INIT:`@@redux/INIT${yf()}`,REPLACE:`@@redux/REPLACE${yf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${yf()}`},Zc=DP;function Em(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function w_(e,t,r){if(typeof e!="function")throw new Error(pr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pr(1));return r(w_)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((v,b)=>{s.set(b,v)}))}function d(){if(c)throw new Error(pr(3));return a}function f(v){if(typeof v!="function")throw new Error(pr(4));if(c)throw new Error(pr(5));let b=!0;u();const w=l++;return s.set(w,v),function(){if(b){if(c)throw new Error(pr(6));b=!1,u(),s.delete(w),i=null}}}function h(v){if(!Em(v))throw new Error(pr(7));if(typeof v.type>"u")throw new Error(pr(8));if(typeof v.type!="string")throw new Error(pr(17));if(c)throw new Error(pr(9));try{c=!0,a=n(a,v)}finally{c=!1}return(i=s).forEach(w=>{w()}),v}function p(v){if(typeof v!="function")throw new Error(pr(10));n=v,h({type:Zc.REPLACE})}function x(){const v=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(pr(11));function w(){const N=b;N.next&&N.next(d())}return w(),{unsubscribe:v(w)}},[i1](){return this}}}return h({type:Zc.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:p,[i1]:x}}function IP(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Zc.INIT})>"u")throw new Error(pr(12));if(typeof r(void 0,{type:Zc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(pr(13))})}function N_(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{IP(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],p=s[f],x=h(p,l);if(typeof x>"u")throw l&&l.type,new Error(pr(14));u[f]=x,c=c||x!==p}return c=c||n.length!==Object.keys(s).length,c?u:s}}function Jc(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function RP(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(pr(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},l=e.map(c=>c(s));return i=Jc(...l)(a.dispatch),{...a,dispatch:i}}}function __(e){return Em(e)&&"type"in e&&typeof e.type=="string"}var S_=Symbol.for("immer-nothing"),s1=Symbol.for("immer-draftable"),Xr=Symbol.for("immer-state");function Ln(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var hn=Object,qs=hn.getPrototypeOf,Qc="constructor",bd="prototype",Kh="configurable",eu="enumerable",Mc="writable",Zo="value",Ra=e=>!!e&&!!e[Xr];function Vn(e){return e?E_(e)||wd(e)||!!e[s1]||!!e[Qc]?.[s1]||Nd(e)||_d(e):!1}var MP=hn[bd][Qc].toString(),o1=new WeakMap;function E_(e){if(!e||!jm(e))return!1;const t=qs(e);if(t===null||t===hn[bd])return!0;const r=hn.hasOwnProperty.call(t,Qc)&&t[Qc];if(r===Object)return!0;if(!Ps(r))return!1;let n=o1.get(r);return n===void 0&&(n=Function.toString.call(r),o1.set(r,n)),n===MP}function yd(e,t,r=!0){jl(e)===0?(r?Reflect.ownKeys(e):hn.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function jl(e){const t=e[Xr];return t?t.type_:wd(e)?1:Nd(e)?2:_d(e)?3:0}var l1=(e,t,r=jl(e))=>r===2?e.has(t):hn[bd].hasOwnProperty.call(e,t),Gh=(e,t,r=jl(e))=>r===2?e.get(t):e[t],tu=(e,t,r,n=jl(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function FP(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var wd=Array.isArray,Nd=e=>e instanceof Map,_d=e=>e instanceof Set,jm=e=>typeof e=="object",Ps=e=>typeof e=="function",wf=e=>typeof e=="boolean";function LP(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Na=e=>e.copy_||e.base_,Tm=e=>e.modified_?e.copy_:e.base_;function Xh(e,t){if(Nd(e))return new Map(e);if(_d(e))return new Set(e);if(wd(e))return Array[bd].slice.call(e);const r=E_(e);if(t===!0||t==="class_only"&&!r){const n=hn.getOwnPropertyDescriptors(e);delete n[Xr];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l[Mc]===!1&&(l[Mc]=!0,l[Kh]=!0),(l.get||l.set)&&(n[s]={[Kh]:!0,[Mc]:!0,[eu]:l[eu],[Zo]:e[s]})}return hn.create(qs(e),n)}else{const n=qs(e);if(n!==null&&r)return{...e};const a=hn.create(n);return hn.assign(a,e)}}function Cm(e,t=!1){return Sd(e)||Ra(e)||!Vn(e)||(jl(e)>1&&hn.defineProperties(e,{set:rc,add:rc,clear:rc,delete:rc}),hn.freeze(e),t&&yd(e,(r,n)=>{Cm(n,!0)},!1)),e}function BP(){Ln(2)}var rc={[Zo]:BP};function Sd(e){return e===null||!jm(e)?!0:hn.isFrozen(e)}var ru="MapSet",Yh="Patches",c1="ArrayMethods",j_={};function Ki(e){const t=j_[e];return t||Ln(0,e),t}var u1=e=>!!j_[e],Jo,T_=()=>Jo,$P=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:u1(ru)?Ki(ru):void 0,arrayMethodsPlugin_:u1(c1)?Ki(c1):void 0});function d1(e,t){t&&(e.patchPlugin_=Ki(Yh),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function qh(e){Zh(e),e.drafts_.forEach(UP),e.drafts_=null}function Zh(e){e===Jo&&(Jo=e.parent_)}var f1=e=>Jo=$P(Jo,e);function UP(e){const t=e[Xr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function h1(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[Xr].modified_&&(qh(t),Ln(4)),Vn(e)&&(e=p1(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[Xr].base_,e,t)}else e=p1(t,r);return HP(t,e,!0),qh(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==S_?e:void 0}function p1(e,t){if(Sd(t))return t;const r=t[Xr];if(!r)return nu(t,e.handledSet_,e);if(!Ed(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);A_(r,e)}return r.copy_}function HP(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Cm(t,r)}function C_(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Ed=(e,t)=>e.scope_===t,zP=[];function k_(e,t,r,n){const a=Na(e),i=e.type_;if(n!==void 0&&Gh(a,n,i)===t){tu(a,n,r,i);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;yd(a,(c,u)=>{if(Ra(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const s=e.draftLocations_.get(t)??zP;for(const l of s)tu(a,l,r,i)}function WP(e,t,r){e.callbacks_.push(function(a){const i=t;if(!i||!Ed(i,a))return;a.mapSetPlugin_?.fixSetContents(i);const s=Tm(i);k_(e,i.draft_??i,s,r),A_(i,a)})}function A_(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const a=n.getPath(e);a&&n.generatePatches_(e,a,t)}C_(e)}}function VP(e,t,r){const{scope_:n}=e;if(Ra(r)){const a=r[Xr];Ed(a,n)&&a.callbacks_.push(function(){Fc(e);const s=Tm(a);k_(e,r,s,t)})}else Vn(r)&&e.callbacks_.push(function(){const i=Na(e);e.type_===3?i.has(r)&&nu(r,n.handledSet_,n):Gh(i,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&nu(Gh(e.copy_,t,e.type_),n.handledSet_,n)})}function nu(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Ra(e)||t.has(e)||!Vn(e)||Sd(e)||(t.add(e),yd(e,(n,a)=>{if(Ra(a)){const i=a[Xr];if(Ed(i,r)){const s=Tm(i);tu(e,n,s,e.type_),C_(i)}}else Vn(a)&&nu(a,t,r)})),e}function KP(e,t){const r=wd(e),n={type_:r?1:0,scope_:t?t.scope_:T_(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=au;r&&(a=[n],i=Qo);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,[l,n]}var au={get(e,t){if(t===Xr)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r?.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=Na(e);if(!l1(a,t,e.type_))return GP(e,a,t);const i=a[t];if(e.finalized_||!Vn(i)||n&&e.operationMethod&&r?.isMutatingArrayMethod(e.operationMethod)&&LP(t))return i;if(i===Nf(e.base_,t)){Fc(e);const s=e.type_===1?+t:t,l=Qh(e.scope_,i,e,s);return e.copy_[s]=l}return i},has(e,t){return t in Na(e)},ownKeys(e){return Reflect.ownKeys(Na(e))},set(e,t,r){const n=P_(Na(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Nf(Na(e),t),i=a?.[Xr];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(FP(r,a)&&(r!==void 0||l1(e.base_,t,e.type_)))return!0;Fc(e),Jh(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),VP(e,t,r)),!0},deleteProperty(e,t){return Fc(e),Nf(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),Jh(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Na(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Mc]:!0,[Kh]:e.type_!==1||t!=="length",[eu]:n[eu],[Zo]:r[t]}},defineProperty(){Ln(11)},getPrototypeOf(e){return qs(e.base_)},setPrototypeOf(){Ln(12)}},Qo={};for(let e in au){let t=au[e];Qo[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}Qo.deleteProperty=function(e,t){return Qo.set.call(this,e,t,void 0)};Qo.set=function(e,t,r){return au.set.call(this,e[0],t,r,e[0])};function Nf(e,t){const r=e[Xr];return(r?Na(r):e)[t]}function GP(e,t,r){const n=P_(t,r);return n?Zo in n?n[Zo]:n.get?.call(e.draft_):void 0}function P_(e,t){if(!(t in e))return;let r=qs(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=qs(r)}}function Jh(e){e.modified_||(e.modified_=!0,e.parent_&&Jh(e.parent_))}function Fc(e){e.copy_||(e.assigned_=new Map,e.copy_=Xh(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var XP=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Ps(r)&&!Ps(n)){const s=n;n=r;const l=this;return function(u=s,...d){return l.produce(u,f=>n.call(this,f,...d))}}Ps(n)||Ln(6),a!==void 0&&!Ps(a)&&Ln(7);let i;if(Vn(r)){const s=f1(this),l=Qh(s,r,void 0);let c=!0;try{i=n(l),c=!1}finally{c?qh(s):Zh(s)}return d1(s,a),h1(i,s)}else if(!r||!jm(r)){if(i=n(r),i===void 0&&(i=r),i===S_&&(i=void 0),this.autoFreeze_&&Cm(i,!0),a){const s=[],l=[];Ki(Yh).generateReplacementPatches_(r,i,{patches_:s,inversePatches_:l}),a(s,l)}return i}else Ln(1,r)},this.produceWithPatches=(r,n)=>{if(Ps(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,i;return[this.produce(r,n,(l,c)=>{a=l,i=c}),a,i]},wf(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),wf(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),wf(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Vn(t)||Ln(8),Ra(t)&&(t=zn(t));const r=f1(this),n=Qh(r,t,void 0);return n[Xr].isManual_=!0,Zh(r),n}finishDraft(t,r){const n=t&&t[Xr];(!n||!n.isManual_)&&Ln(9);const{scope_:a}=n;return d1(a,r),h1(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const i=r[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(r=r.slice(n+1));const a=Ki(Yh).applyPatches_;return Ra(t)?a(t,r):this.produce(t,i=>a(i,r))}};function Qh(e,t,r,n){const[a,i]=Nd(t)?Ki(ru).proxyMap_(t,r):_d(t)?Ki(ru).proxySet_(t,r):KP(t,r);return(r?.scope_??T_()).drafts_.push(a),i.callbacks_=r?.callbacks_??[],i.key_=n,r&&n!==void 0?WP(r,i,n):i.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:u}=c;i.modified_&&u&&u.generatePatches_(i,[],c)}),a}function zn(e){return Ra(e)||Ln(10,e),O_(e)}function O_(e){if(!Vn(e)||Sd(e))return e;const t=e[Xr];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Xh(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Xh(e,!0);return yd(r,(a,i)=>{tu(r,a,O_(i))},n),t&&(t.finalized_=!1),r}var YP=new XP,D_=YP.produce;function I_(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var qP=I_(),ZP=I_,JP=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Jc:Jc.apply(null,arguments)};function Pn(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(mn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>__(n)&&n.type===e,r}var R_=class Fo extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Fo.prototype)}static get[Symbol.species](){return Fo}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Fo(...t[0].concat(this)):new Fo(...t.concat(this))}};function m1(e){return Vn(e)?D_(e,()=>{}):e}function nc(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function QP(e){return typeof e=="boolean"}var eO=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new R_;return r&&(QP(r)?s.push(qP):s.push(ZP(r.extraArgument))),s},M_="RTK_autoBatch",jt=()=>e=>({payload:e,meta:{[M_]:!0}}),x1=e=>t=>{setTimeout(t,e)},F_=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:x1(10):e.type==="callback"?e.queueNotification:x1(e.timeout),u=()=>{s=!1,i&&(i=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),h=n.subscribe(f);return l.add(d),()=>{h(),l.delete(d)}},dispatch(d){try{return a=!d?.meta?.[M_],i=!a,i&&(s||(s=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},tO=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new R_(e);return n&&a.push(F_(typeof n=="object"?n:void 0)),a};function rO(e){const t=eO(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(Em(r))l=N_(r);else throw new Error(mn(1));let c;typeof n=="function"?c=n(t):c=t();let u=Jc;a&&(u=JP({trace:!1,...typeof a=="object"&&a}));const d=RP(...c),f=tO(d);let h=typeof s=="function"?s(f):f();const p=u(...h);return w_(l,i,p)}function L_(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(mn(28));if(l in t)throw new Error(mn(29));return t[l]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function nO(e){return typeof e=="function"}function aO(e,t){let[r,n,a]=L_(t),i;if(nO(e))i=()=>m1(e());else{const l=m1(e);i=()=>l}function s(l=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(Ra(d)){const p=f(d,c);return p===void 0?d:p}else{if(Vn(d))return D_(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},l)}return s.getInitialState=i,s}var iO="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",sO=(e=21)=>{let t="",r=e;for(;r--;)t+=iO[Math.random()*64|0];return t},oO=Symbol.for("rtk-slice-createasyncthunk");function lO(e,t){return`${e}/${t}`}function cO({creators:e}={}){const t=e?.asyncThunk?.[oO];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(mn(11));const s=(typeof n.reducers=="function"?n.reducers(dO()):n.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(y,N){const S=typeof y=="string"?y:y.type;if(!S)throw new Error(mn(12));if(S in c.sliceCaseReducersByType)throw new Error(mn(13));return c.sliceCaseReducersByType[S]=N,u},addMatcher(y,N){return c.sliceMatchers.push({matcher:y,reducer:N}),u},exposeAction(y,N){return c.actionCreators[y]=N,u},exposeCaseReducer(y,N){return c.sliceCaseReducersByName[y]=N,u}};l.forEach(y=>{const N=s[y],S={reducerName:y,type:lO(a,y),createNotation:typeof n.reducers=="function"};hO(N)?mO(S,N,u,t):fO(S,N,u)});function d(){const[y={},N=[],S=void 0]=typeof n.extraReducers=="function"?L_(n.extraReducers):[n.extraReducers],E={...y,...c.sliceCaseReducersByType};return aO(n.initialState,_=>{for(let j in E)_.addCase(j,E[j]);for(let j of c.sliceMatchers)_.addMatcher(j.matcher,j.reducer);for(let j of N)_.addMatcher(j.matcher,j.reducer);S&&_.addDefaultCase(S)})}const f=y=>y,h=new Map,p=new WeakMap;let x;function g(y,N){return x||(x=d()),x(y,N)}function v(){return x||(x=d()),x.getInitialState()}function b(y,N=!1){function S(_){let j=_[y];return typeof j>"u"&&N&&(j=nc(p,S,v)),j}function E(_=f){const j=nc(h,N,()=>new WeakMap);return nc(j,_,()=>{const A={};for(const[T,k]of Object.entries(n.selectors??{}))A[T]=uO(k,_,()=>nc(p,_,v),N);return A})}return{reducerPath:y,getSelectors:E,get selectors(){return E(S)},selectSlice:S}}const w={name:a,reducer:g,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...b(i),injectInto(y,{reducerPath:N,...S}={}){const E=N??i;return y.inject({reducerPath:E,reducer:g},S),{...w,...b(E,!0)}}};return w}}function uO(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var nn=cO();function dO(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function fO({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!pO(n))throw new Error(mn(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Pn(e,s):Pn(e))}function hO(e){return e._reducerDefinitionType==="asyncThunk"}function pO(e){return e._reducerDefinitionType==="reducerWithPrepare"}function mO({type:e,reducerName:t},r,n,a){if(!a)throw new Error(mn(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:c,settled:u,options:d}=r,f=a(e,i,d);n.exposeAction(t,f),s&&n.addCase(f.fulfilled,s),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:s||ac,pending:l||ac,rejected:c||ac,settled:u||ac})}function ac(){}var xO="task",B_="listener",$_="completed",km="cancelled",gO=`task-${km}`,vO=`task-${$_}`,ep=`${B_}-${km}`,bO=`${B_}-${$_}`,jd=class{constructor(e){this.code=e,this.message=`${xO} ${km} (reason: ${e})`}name="TaskAbortError";message},Am=(e,t)=>{if(typeof e!="function")throw new TypeError(mn(32))},iu=()=>{},U_=(e,t=iu)=>(e.catch(t),e),H_=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Fi=e=>{if(e.aborted)throw new jd(e.reason)};function z_(e,t){let r=iu;return new Promise((n,a)=>{const i=()=>a(new jd(e.reason));if(e.aborted){i();return}r=H_(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=iu})}var yO=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof jd?"cancelled":"rejected",error:r}}finally{t?.()}},su=e=>t=>U_(z_(e,t).then(r=>(Fi(e),r))),W_=e=>{const t=su(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:$s}=Object,g1={},Td="listenerMiddleware",wO=(e,t)=>{const r=n=>H_(e,()=>n.abort(e.reason));return(n,a)=>{Am(n);const i=new AbortController;r(i);const s=yO(async()=>{Fi(e),Fi(i.signal);const l=await n({pause:su(i.signal),delay:W_(i.signal),signal:i.signal});return Fi(i.signal),l},()=>i.abort(vO));return a?.autoJoin&&t.push(s.catch(iu)),{result:su(e)(s),cancel(){i.abort(gO)}}}},NO=(e,t)=>{const r=async(n,a)=>{Fi(t);let i=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});i=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await z_(t,Promise.race(l));return Fi(t),c}finally{i()}};return(n,a)=>U_(r(n,a))},V_=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Pn(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(mn(21));return Am(i),{predicate:a,type:t,effect:i}},K_=$s(e=>{const{type:t,predicate:r,effect:n}=V_(e);return{id:sO(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(mn(22))}}},{withTypes:()=>K_}),v1=(e,t)=>{const{type:r,effect:n,predicate:a}=V_(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},tp=e=>{e.pending.forEach(t=>{t.abort(ep)})},_O=(e,t)=>()=>{for(const r of t.keys())tp(r);e.clear()},b1=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},G_=$s(Pn(`${Td}/add`),{withTypes:()=>G_}),SO=Pn(`${Td}/removeAll`),X_=$s(Pn(`${Td}/remove`),{withTypes:()=>X_}),EO=(...e)=>{console.error(`${Td}/error`,...e)},Tl=(e={})=>{const t=new Map,r=new Map,n=p=>{const x=r.get(p)??0;r.set(p,x+1)},a=p=>{const x=r.get(p)??1;x===1?r.delete(p):r.set(p,x-1)},{extra:i,onError:s=EO}=e;Am(s);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),x=>{p.unsubscribe(),x?.cancelActive&&tp(p)}),c=p=>{const x=v1(t,p)??K_(p);return l(x)};$s(c,{withTypes:()=>c});const u=p=>{const x=v1(t,p);return x&&(x.unsubscribe(),p.cancelActive&&tp(x)),!!x};$s(u,{withTypes:()=>u});const d=async(p,x,g,v)=>{const b=new AbortController,w=NO(c,b.signal),y=[];try{p.pending.add(b),n(p),await Promise.resolve(p.effect(x,$s({},g,{getOriginalState:v,condition:(N,S)=>w(N,S).then(Boolean),take:w,delay:W_(b.signal),pause:su(b.signal),extra:i,signal:b.signal,fork:wO(b.signal,y),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((N,S,E)=>{N!==b&&(N.abort(ep),E.delete(N))})},cancel:()=>{b.abort(ep),p.pending.delete(b)},throwIfCancelled:()=>{Fi(b.signal)}})))}catch(N){N instanceof jd||b1(s,N,{raisedBy:"effect"})}finally{await Promise.all(y),b.abort(bO),a(p),p.pending.delete(b)}},f=_O(t,r);return{middleware:p=>x=>g=>{if(!__(g))return x(g);if(G_.match(g))return c(g.payload);if(SO.match(g)){f();return}if(X_.match(g))return u(g.payload);let v=p.getState();const b=()=>{if(v===g1)throw new Error(mn(23));return v};let w;try{if(w=x(g),t.size>0){const y=p.getState(),N=Array.from(t.values());for(const S of N){let E=!1;try{E=S.predicate(g,y,v)}catch(_){E=!1,b1(s,_,{raisedBy:"predicate"})}E&&d(S,g,p,b)}}}finally{v=g1}return w},startListening:c,stopListening:u,clearListeners:f}};function mn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var jO={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Y_=nn({name:"chartLayout",initialState:jO,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:TO,setLayout:CO,setChartSize:kO,setScale:AO}=Y_.actions,PO=Y_.reducer;function q_(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function et(e){return Number.isFinite(e)}function fa(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function y1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y1(Object(r),!0).forEach(function(n){OO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OO(e,t,r){return(t=DO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DO(e){var t=IO(e,"string");return typeof t=="symbol"?t:t+""}function IO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xt(e,t,r){return Ft(e)||Ft(t)?r:da(t)?Wi(e,t,r):typeof t=="function"?t(e):r}var RO=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&Ie(e[i]))return Rs(Rs({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&Ie(e[s]))return Rs(Rs({},e),{},{[s]:e[s]+(a||0)})}return e},Va=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Z_=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},J_=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:p}=e;if(!s)return null;var x=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=a==="category"&&s.bandwidth?s.bandwidth()/x:0;if(g=p==="angleAxis"&&i&&i.length>=2?lr(i[0]-i[1])*2*g:g,f||h){var v=(f||h||[]).map((b,w)=>{var y=n?n.indexOf(b):b,N=s.map(y);return et(N)?{coordinate:N+g,value:b,offset:g,index:w}:null}).filter(en);return v}return c&&u?u.map((b,w)=>{var y=s.map(b);return et(y)?{coordinate:y+g,value:b,index:w,offset:g}:null}).filter(en):s.ticks&&d!=null?s.ticks(d).map((b,w)=>{var y=s.map(b);return et(y)?{coordinate:y+g,value:b,index:w,offset:g}:null}).filter(en):s.domain().map((b,w)=>{var y=s.map(b);return et(y)?{coordinate:y+g,value:n?n[b]:b,index:w,offset:g}:null}).filter(en)},MO=(e,t)=>{if(!t||t.length!==2||!Ie(t[0])||!Ie(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Ie(e[0])||e[0]<r)&&(a[0]=r),(!Ie(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},FO=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0,l=0;l<r;++l){var c=e[l],u=c?.[a];if(u!=null){var d=u[1],f=u[0],h=ua(d)?f:d;h>=0?(u[0]=i,i+=h,u[1]=i):(u[0]=s,s+=h,u[1]=s)}}}},LO=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0;s<r;++s){var l=e[s],c=l?.[a];if(c!=null){var u=ua(c[1])?c[0]:c[1];u>=0?(c[0]=i,i+=u,c[1]=i):(c[0]=0,c[1]=0)}}}},BO={sign:FO,expand:hA,none:zi,silhouette:pA,wiggle:mA,positive:LO},$O=(e,t,r)=>{var n,a=(n=BO[r])!==null&&n!==void 0?n:zi,i=fA().keys(t).value((l,c)=>Number(xt(l,c,0))).order(Wh).offset(a),s=i(e);return s.forEach((l,c)=>{l.forEach((u,d)=>{var f=xt(e[d],t[c],0);Array.isArray(f)&&f.length===2&&Ie(f[0])&&Ie(f[1])&&(u[0]=f[0],u[1]=f[1])})}),s};function UO(e){return e==null?void 0:String(e)}function w1(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ft(a[t.dataKey])){var l=i_(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[i]?r[i].coordinate+n/2:null}var c=xt(a,Ft(s)?t.dataKey:s),u=t.scale.map(c);return Ie(u)?u:null}var N1=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=xt(i,t.dataKey,t.scale.domain()[s]);if(Ft(l))return null;var c=t.scale.map(l);return Ie(c)?c-a/2+n:null},HO=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},zO=e=>{var t=e.flat(2).filter(Ie);return[Math.min(...t),Math.max(...t)]},WO=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],VO=(e,t,r)=>{if(e!=null)return WO(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:s}=i,l=s.reduce((c,u)=>{var d=q_(u,t,r),f=zO(d);return!et(f[0])||!et(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},_1=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,S1=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Zs=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=vd(t,d=>d.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var c=a[s],u=a[s-1];i=Math.min((c?.coordinate||0)-(u?.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function E1(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Rs(Rs({},t),{},{dataKey:r,payload:n,value:a,name:i})}function ao(e,t){if(e)return String(e);if(typeof t=="string")return t}var KO=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},GO=(e,t)=>t==="centric"?e.angle:e.radius,Ka=e=>e.layout.width,Ga=e=>e.layout.height,XO=e=>e.layout.scale,Q_=e=>e.layout.margin,Cd=Q(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),kd=Q(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),eS="data-recharts-item-index",tS="data-recharts-item-id",Cl=60;function j1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ic(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j1(Object(r),!0).forEach(function(n){YO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YO(e,t,r){return(t=qO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qO(e){var t=ZO(e,"string");return typeof t=="symbol"?t:t+""}function ZO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JO=e=>e.brush.height;function QO(e){var t=kd(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Cl;return r+a}return r},0)}function e3(e){var t=kd(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Cl;return r+a}return r},0)}function t3(e){var t=Cd(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function r3(e){var t=Cd(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var tr=Q([Ka,Ga,Q_,JO,QO,e3,t3,r3,y_,kP],(e,t,r,n,a,i,s,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+i},f={top:(r.top||0)+s,bottom:(r.bottom||0)+l},h=ic(ic({},f),d),p=h.bottom;h.bottom+=n,h=RO(h,c,u);var x=e-h.left-h.right,g=t-h.top-h.bottom;return ic(ic({brushBottom:p},h),{},{width:Math.max(x,0),height:Math.max(g,0)})}),n3=Q(tr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Pm=Q(Ka,Ga,(e,t)=>({x:0,y:0,width:e,height:t})),a3=m.createContext(null),Ir=()=>m.useContext(a3)!=null,Ad=e=>e.brush,Pd=Q([Ad,tr,Q_],(e,t,r)=>({height:e.height,x:Ie(e.x)?e.x:t.left,y:Ie(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ie(e.width)?e.width:t.width})),_f={},Sf={},Ef={},T1;function i3(){return T1||(T1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,l=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},f=()=>{u&&d(),g()};let h=null;const p=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},x=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{x(),s=void 0,l=null},v=()=>{d()},b=function(...w){if(a?.aborted)return;s=this,l=w;const y=h==null;p(),c&&y&&d()};return b.schedule=p,b.cancel=g,b.flush=v,a?.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Ef)),Ef}var C1;function s3(){return C1||(C1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i3();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:l=!0,maxWait:c}=i,u=Array(2);s&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,g),d)},x=()=>(h.flush(),d);return p.cancel=h.cancel,p.flush=x,p}e.debounce=r})(Sf)),Sf}var k1;function o3(){return k1||(k1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s3();function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(_f)),_f}var jf,A1;function l3(){return A1||(A1=1,jf=o3().throttle),jf}var c3=l3();const u3=bi(c3);var ou=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;console.warn(r.replace(/%s/g,()=>a[s++]))}},aa={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},rS=(e,t,r)=>{var{width:n=aa.width,height:a=aa.height,aspect:i,maxHeight:s}=r,l=Vi(n)?e:Number(n),c=Vi(a)?t:Number(a);return i&&i>0&&(l?c=l/i:c&&(l=c*i),s&&c!=null&&c>s&&(c=s)),{calculatedWidth:l,calculatedHeight:c}},d3={width:0,height:0,overflow:"visible"},f3={width:0,overflowX:"visible"},h3={height:0,overflowY:"visible"},p3={},m3=e=>{var{width:t,height:r}=e,n=Vi(t),a=Vi(r);return n&&a?d3:n?f3:a?h3:p3};function x3(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a=aa.width,i=aa.height):a===void 0?a=n&&n>0?void 0:aa.width:i===void 0&&(i=n&&n>0?void 0:aa.height),{width:a,height:i}}function rp(){return rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rp.apply(null,arguments)}function P1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P1(Object(r),!0).forEach(function(n){g3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g3(e,t,r){return(t=v3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v3(e){var t=b3(e,"string");return typeof t=="symbol"?t:t+""}function b3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nS=m.createContext(aa.initialDimension);function y3(e){return fa(e.width)&&fa(e.height)}function aS(e){var{children:t,width:r,height:n}=e,a=m.useMemo(()=>({width:r,height:n}),[r,n]);return y3(a)?m.createElement(nS.Provider,{value:a},t):null}var Om=()=>m.useContext(nS),w3=m.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=aa.initialDimension,width:a,height:i,minWidth:s=aa.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=aa.debounce,id:f,className:h,onResize:p,style:x={}}=e,g=m.useRef(null),v=m.useRef();v.current=p,m.useImperativeHandle(t,()=>g.current);var[b,w]=m.useState({containerWidth:n.width,containerHeight:n.height}),y=m.useCallback((j,A)=>{w(T=>{var k=Math.round(j),C=Math.round(A);return T.containerWidth===k&&T.containerHeight===C?T:{containerWidth:k,containerHeight:C}})},[]);m.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return ss;var j=C=>{var L,G=C[0];if(G!=null){var{width:V,height:X}=G.contentRect;y(V,X),(L=v.current)===null||L===void 0||L.call(v,V,X)}};d>0&&(j=u3(j,d,{trailing:!0,leading:!1}));var A=new ResizeObserver(j),{width:T,height:k}=g.current.getBoundingClientRect();return y(T,k),A.observe(g.current),()=>{A.disconnect()}},[y,d]);var{containerWidth:N,containerHeight:S}=b;ou(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:E,calculatedHeight:_}=rS(N,S,{width:a,height:i,aspect:r,maxHeight:c});return ou(E!=null&&E>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,E,_,a,i,s,l,r),m.createElement("div",{id:f?"".concat(f):void 0,className:lt("recharts-responsive-container",h),style:O1(O1({},x),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:c}),ref:g},m.createElement("div",{style:m3({width:a,height:i})},m.createElement(aS,{width:E,height:_},u)))}),Dm=m.forwardRef((e,t)=>{var r=Om();if(fa(r.width)&&fa(r.height))return e.children;var{width:n,height:a}=x3({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=rS(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Ie(i)&&Ie(s)?m.createElement(aS,{width:i,height:s},e.children):m.createElement(w3,rp({},e,{width:n,height:a,ref:t}))});function Im(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Od=()=>{var e,t=Ir(),r=Fe(n3),n=Fe(Pd),a=(e=Fe(Ad))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},N3={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},iS=()=>{var e;return(e=Fe(tr))!==null&&e!==void 0?e:N3},sS=()=>Fe(Ka),oS=()=>Fe(Ga),at=e=>e.layout.layoutType,os=()=>Fe(at),lS=()=>{var e=os();if(e==="horizontal"||e==="vertical")return e},cS=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},_3=()=>{var e=os();return e!==void 0},kl=e=>{var t=Ot(),r=Ir(),{width:n,height:a}=e,i=Om(),s=n,l=a;return i&&(s=i.width>0?i.width:n,l=i.height>0?i.height:a),m.useEffect(()=>{!r&&fa(s)&&fa(l)&&t(kO({width:s,height:l}))},[t,r,s,l]),null},uS=Symbol.for("immer-nothing"),D1=Symbol.for("immer-draftable"),gn=Symbol.for("immer-state");function Bn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var el=Object.getPrototypeOf;function Js(e){return!!e&&!!e[gn]}function Gi(e){return e?dS(e)||Array.isArray(e)||!!e[D1]||!!e.constructor?.[D1]||Al(e)||Id(e):!1}var S3=Object.prototype.constructor.toString(),I1=new WeakMap;function dS(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=I1.get(r);return n===void 0&&(n=Function.toString.call(r),I1.set(r,n)),n===S3}function lu(e,t,r=!0){Dd(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Dd(e){const t=e[gn];return t?t.type_:Array.isArray(e)?1:Al(e)?2:Id(e)?3:0}function np(e,t){return Dd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function fS(e,t,r){const n=Dd(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function E3(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Al(e){return e instanceof Map}function Id(e){return e instanceof Set}function ki(e){return e.copy_||e.base_}function ap(e,t){if(Al(e))return new Map(e);if(Id(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=dS(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[gn];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(el(e),n)}else{const n=el(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Rm(e,t=!1){return Rd(e)||Js(e)||!Gi(e)||(Dd(e)>1&&Object.defineProperties(e,{set:sc,add:sc,clear:sc,delete:sc}),Object.freeze(e),t&&Object.values(e).forEach(r=>Rm(r,!0))),e}function j3(){Bn(2)}var sc={value:j3};function Rd(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var T3={};function Xi(e){const t=T3[e];return t||Bn(0,e),t}var tl;function hS(){return tl}function C3(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function R1(e,t){t&&(Xi("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ip(e){sp(e),e.drafts_.forEach(k3),e.drafts_=null}function sp(e){e===tl&&(tl=e.parent_)}function M1(e){return tl=C3(tl,e)}function k3(e){const t=e[gn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function F1(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[gn].modified_&&(ip(t),Bn(4)),Gi(e)&&(e=cu(t,e),t.parent_||uu(t,e)),t.patches_&&Xi("Patches").generateReplacementPatches_(r[gn].base_,e,t.patches_,t.inversePatches_)):e=cu(t,r,[]),ip(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==uS?e:void 0}function cu(e,t,r){if(Rd(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[gn];if(!a)return lu(t,(i,s)=>L1(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return uu(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,l=!1;a.type_===3&&(s=new Set(i),i.clear(),l=!0),lu(s,(c,u)=>L1(e,a,i,c,u,r,l),n),uu(e,i,!1),r&&e.patches_&&Xi("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function L1(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const l=Rd(a);if(!(l&&!s)){if(Js(a)){const c=i&&t&&t.type_!==3&&!np(t.assigned_,n)?i.concat(n):void 0,u=cu(e,a,c);if(fS(r,n,u),Js(u))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Gi(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&l)return;cu(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Al(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&uu(e,a)}}}function uu(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Rm(t,r)}function A3(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:hS(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Mm;r&&(a=[n],i=rl);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var Mm={get(e,t){if(t===gn)return e;const r=ki(e);if(!np(r,t))return P3(e,r,t);const n=r[t];return e.finalized_||!Gi(n)?n:n===Tf(e.base_,t)?(Cf(e),e.copy_[t]=lp(n,e)):n},has(e,t){return t in ki(e)},ownKeys(e){return Reflect.ownKeys(ki(e))},set(e,t,r){const n=pS(ki(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Tf(ki(e),t),i=a?.[gn];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(E3(r,a)&&(r!==void 0||np(e.base_,t)))return!0;Cf(e),op(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Tf(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Cf(e),op(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ki(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Bn(11)},getPrototypeOf(e){return el(e.base_)},setPrototypeOf(){Bn(12)}},rl={};lu(Mm,(e,t)=>{rl[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});rl.deleteProperty=function(e,t){return rl.set.call(this,e,t,void 0)};rl.set=function(e,t,r){return Mm.set.call(this,e[0],t,r,e[0])};function Tf(e,t){const r=e[gn];return(r?ki(r):e)[t]}function P3(e,t,r){const n=pS(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function pS(e,t){if(!(t in e))return;let r=el(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=el(r)}}function op(e){e.modified_||(e.modified_=!0,e.parent_&&op(e.parent_))}function Cf(e){e.copy_||(e.copy_=ap(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var O3=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Bn(6),n!==void 0&&typeof n!="function"&&Bn(7);let a;if(Gi(t)){const i=M1(this),s=lp(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?ip(i):sp(i)}return R1(i,n),F1(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===uS&&(a=void 0),this.autoFreeze_&&Rm(a,!0),n){const i=[],s=[];Xi("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Bn(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,c=>t(c,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Gi(e)||Bn(8),Js(e)&&(e=D3(e));const t=M1(this),r=lp(e,void 0);return r[gn].isManual_=!0,sp(t),r}finishDraft(e,t){const r=e&&e[gn];(!r||!r.isManual_)&&Bn(9);const{scope_:n}=r;return R1(n,t),F1(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Xi("Patches").applyPatches_;return Js(e)?n(e,t):this.produce(e,a=>n(a,t))}};function lp(e,t){const r=Al(e)?Xi("MapSet").proxyMap_(e,t):Id(e)?Xi("MapSet").proxySet_(e,t):A3(e,t);return(t?t.scope_:hS()).drafts_.push(r),r}function D3(e){return Js(e)||Bn(10,e),mS(e)}function mS(e){if(!Gi(e)||Rd(e))return e;const t=e[gn];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ap(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=ap(e,!0);return lu(r,(a,i)=>{fS(r,a,mS(i))},n),t&&(t.finalized_=!1),r}var I3=new O3;I3.produce;var R3={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},xS=nn({name:"legend",initialState:R3,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:jt()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=zn(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:jt()},removeLegendPayload:{reducer(e,t){var r=zn(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:jt()}}}),{setLegendSize:yre,setLegendSettings:wre,addLegendPayload:gS,replaceLegendPayload:vS,removeLegendPayload:bS}=xS.actions,M3=xS.reducer;function cp(){return cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cp.apply(null,arguments)}function B1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B1(Object(r),!0).forEach(function(n){F3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F3(e,t,r){return(t=L3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L3(e){var t=B3(e,"string");return typeof t=="symbol"?t:t+""}function B3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $3(e){return Array.isArray(e)&&da(e[0])&&da(e[1])?e.join(" ~ "):e}var bs={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},U3=e=>{var{separator:t=bs.separator,contentStyle:r,itemStyle:n,labelStyle:a=bs.labelStyle,payload:i,formatter:s,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=bs.accessibilityLayer}=e,p=()=>{if(i&&i.length){var S={padding:0,margin:0},E=(l?vd(i,l):i).map((_,j)=>{if(_.type==="none")return null;var A=_.formatter||s||$3,{value:T,name:k}=_,C=T,L=k;if(A){var G=A(T,k,_,j,i);if(Array.isArray(G))[C,L]=G;else if(G!=null)C=G;else return null}var V=Eo(Eo({},bs.itemStyle),{},{color:_.color||bs.itemStyle.color},n);return m.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(j),style:V},da(L)?m.createElement("span",{className:"recharts-tooltip-item-name"},L):null,da(L)?m.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,m.createElement("span",{className:"recharts-tooltip-item-value"},C),m.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return m.createElement("ul",{className:"recharts-tooltip-item-list",style:S},E)}return null},x=Eo(Eo({},bs.contentStyle),r),g=Eo({margin:0},a),v=!Ft(d),b=v?d:"",w=lt("recharts-default-tooltip",c),y=lt("recharts-tooltip-label",u);v&&f&&i!==void 0&&i!==null&&(b=f(d,i));var N=h?{role:"status","aria-live":"assertive"}:{};return m.createElement("div",cp({className:w,style:x},N),m.createElement("p",{className:y,style:g},m.isValidElement(b)?b:"".concat(b)),p())},jo="recharts-tooltip-wrapper",H3={visibility:"hidden"};function z3(e){var{coordinate:t,translateX:r,translateY:n}=e;return lt(jo,{["".concat(jo,"-right")]:Ie(r)&&t&&Ie(t.x)&&r>=t.x,["".concat(jo,"-left")]:Ie(r)&&t&&Ie(t.x)&&r<t.x,["".concat(jo,"-bottom")]:Ie(n)&&t&&Ie(t.y)&&n>=t.y,["".concat(jo,"-top")]:Ie(n)&&t&&Ie(t.y)&&n<t.y})}function $1(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(i&&Ie(i[n]))return i[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return s[n]?d:f;var h=c[n];if(h==null)return 0;if(s[n]){var p=d,x=h;return p<x?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var g=f+l,v=h+u;return g>v?Math.max(d,h):Math.max(f,h)}function W3(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function V3(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:a,position:i,reverseDirection:s,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,h;return l.height>0&&l.width>0&&r?(f=$1({allowEscapeViewBox:t,coordinate:r,key:"x",offset:a,position:i,reverseDirection:s,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),h=$1({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:i,reverseDirection:s,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=W3({translateX:f,translateY:h,useTranslate3d:c})):d=H3,{cssProperties:d,cssClasses:z3({translateX:f,translateY:h,coordinate:r})}}function U1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U1(Object(r),!0).forEach(function(n){up(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function up(e,t,r){return(t=K3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K3(e){var t=G3(e,"string");return typeof t=="symbol"?t:t+""}function G3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class X3 extends m.PureComponent{constructor(){super(...arguments),up(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),up(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:p,wrapperStyle:x,lastBoundingBox:g,innerRef:v,hasPortalFromProps:b}=this.props,w=typeof u=="number"?u:u.x,y=typeof u=="number"?u:u.y,{cssClasses:N,cssProperties:S}=V3({allowEscapeViewBox:r,coordinate:s,offsetLeft:w,offsetTop:y,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:p}),E=b?{}:oc(oc({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),_=oc(oc({},E),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:N,style:_,ref:v},i)}}var yS=()=>{var e;return(e=Fe(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function dp(){return dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dp.apply(null,arguments)}function H1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function z1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H1(Object(r),!0).forEach(function(n){Y3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y3(e,t,r){return(t=q3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q3(e){var t=Z3(e,"string");return typeof t=="symbol"?t:t+""}function Z3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W1={curveBasisClosed:tA,curveBasisOpen:rA,curveBasis:eA,curveBumpX:$k,curveBumpY:Uk,curveLinearClosed:nA,curveLinear:md,curveMonotoneX:aA,curveMonotoneY:iA,curveNatural:sA,curveStep:oA,curveStepAfter:cA,curveStepBefore:lA},du=e=>et(e.x)&&et(e.y),V1=e=>e.base!=null&&du(e.base)&&du(e),To=e=>e.x,Co=e=>e.y,J3=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(El(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=W1["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return W1[r]||md},K1={connectNulls:!1,type:"linear"},Q3=e=>{var{type:t=K1.type,points:r=[],baseLine:n,layout:a,connectNulls:i=K1.connectNulls}=e,s=J3(t,a),l=i?r.filter(du):r;if(Array.isArray(n)){var c,u=r.map((x,g)=>z1(z1({},x),{},{base:n[g]}));a==="vertical"?c=Ql().y(Co).x1(To).x0(x=>x.base.x):c=Ql().x(To).y1(Co).y0(x=>x.base.y);var d=c.defined(V1).curve(s),f=i?u.filter(V1):u;return d(f)}var h;a==="vertical"&&Ie(n)?h=Ql().y(Co).x1(To).x0(n):Ie(n)?h=Ql().x(To).y1(Co).y0(n):h=KN().x(To).y(Co);var p=h.defined(du).curve(s);return p(l)},Fm=e=>{var{className:t,points:r,path:n,pathRef:a}=e,i=os();if((!r||!r.length)&&!n)return null;var s={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},l=r&&r.length?Q3(s):n;return m.createElement("path",dp({},xn(e),wm(e),{className:lt("recharts-curve",t),d:l===null?void 0:l,ref:a}))},eD=["x","y","top","left","width","height","className"];function fp(){return fp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fp.apply(null,arguments)}function G1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G1(Object(r),!0).forEach(function(n){rD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rD(e,t,r){return(t=nD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nD(e){var t=aD(e,"string");return typeof t=="symbol"?t:t+""}function aD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iD(e,t){if(e==null)return{};var r,n,a=sD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var oD=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),lD=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,c=iD(e,eD),u=tD({x:t,y:r,top:n,left:a,width:i,height:s},c);return!Ie(t)||!Ie(r)||!Ie(i)||!Ie(s)||!Ie(n)||!Ie(a)?null:m.createElement("path",fp({},Gr(u),{className:lt("recharts-cross",l),d:oD(t,r,i,s,n,a)}))};function cD(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function X1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X1(Object(r),!0).forEach(function(n){uD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uD(e,t,r){return(t=dD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dD(e){var t=fD(e,"string");return typeof t=="symbol"?t:t+""}function fD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hD=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),wS=(e,t,r)=>e.map(n=>"".concat(hD(n)," ").concat(t,"ms ").concat(r)).join(","),pD=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),nl=(e,t)=>Object.keys(t).reduce((r,n)=>Y1(Y1({},r),{},{[n]:e(n,t[n])}),{});function q1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q1(Object(r),!0).forEach(function(n){mD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mD(e,t,r){return(t=xD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xD(e){var t=gD(e,"string");return typeof t=="symbol"?t:t+""}function gD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fu=(e,t,r)=>e+(t-e)*r,hp=e=>{var{from:t,to:r}=e;return t!==r},NS=(e,t,r)=>{var n=nl((a,i)=>{if(hp(i)){var[s,l]=e(i.from,i.to,i.velocity);return Qt(Qt({},i),{},{from:s,velocity:l})}return i},t);return r<1?nl((a,i)=>hp(i)&&n[a]!=null?Qt(Qt({},i),{},{velocity:fu(i.velocity,n[a].velocity,r),from:fu(i.from,n[a].from,r)}):i,t):NS(e,n,r-1)};function vD(e,t,r,n,a,i){var s,l=n.reduce((h,p)=>Qt(Qt({},h),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>nl((h,p)=>p.from,l),u=()=>!Object.values(l).filter(hp).length,d=null,f=h=>{s||(s=h);var p=h-s,x=p/r.dt;l=NS(r,l,x),a(Qt(Qt(Qt({},e),t),c())),s=h,u()||(d=i.setTimeout(f))};return()=>(d=i.setTimeout(f),()=>{var h;(h=d)===null||h===void 0||h()})}function bD(e,t,r,n,a,i,s){var l=null,c=a.reduce((f,h)=>{var p=e[h],x=t[h];return p==null||x==null?f:Qt(Qt({},f),{},{[h]:[p,x]})},{}),u,d=f=>{u||(u=f);var h=(f-u)/n,p=nl((g,v)=>fu(...v,r(h)),c);if(i(Qt(Qt(Qt({},e),t),p)),h<1)l=s.setTimeout(d);else{var x=nl((g,v)=>fu(...v,r(1)),c);i(Qt(Qt(Qt({},e),t),x))}};return()=>(l=s.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const yD=(e,t,r,n,a,i)=>{var s=pD(e,t);return r==null?()=>(a(Qt(Qt({},e),t)),()=>{}):r.isStepper===!0?vD(e,t,r,s,a,i):bD(e,t,r,n,s,a,i)};var hu=1e-4,_S=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],SS=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Z1=(e,t)=>r=>{var n=_S(e,t);return SS(n,r)},wD=(e,t)=>r=>{var n=_S(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return SS(a,r)},ND=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},_D=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=ND(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},SD=(e,t,r,n)=>{var a=Z1(e,r),i=Z1(t,n),s=wD(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,h=0;h<8;++h){var p=a(f)-d,x=s(f);if(Math.abs(p-d)<hu||x<hu)return i(f);f=l(f-p/x)}return i(f)};return c.isStepper=!1,c},J1=function(){return SD(..._D(...arguments))},ED=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,c)=>{var u=-(s-l)*r,d=c*n,f=c+(u-d)*a/1e3,h=c*a/1e3+s;return Math.abs(h-l)<hu&&Math.abs(f)<hu?[l,0]:[h,f]};return i.isStepper=!0,i.dt=a,i},jD=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return J1(e);case"spring":return ED();default:if(e.split("(")[0]==="cubic-bezier")return J1(e)}return typeof e=="function"?e:null};function TD(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[c,...u]=l;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class CD{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function kD(){return TD(new CD)}var AD=m.createContext(kD);function PD(e,t){var r=m.useContext(AD);return m.useMemo(()=>t??r(e),[e,t,r])}var OD=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Md={isSsr:OD()},DD={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Q1={t:0},kf={t:1};function Pl(e){var t=ur(e,DD),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!Md.isSsr:r,f=PD(t.animationId,t.animationManager),[h,p]=m.useState(d?Q1:kf),x=m.useRef(null);return m.useEffect(()=>{d||p(kf)},[d]),m.useEffect(()=>{if(!d||!n)return ss;var g=yD(Q1,kf,jD(i),a,p,f.getTimeoutController()),v=()=>{x.current=g()};return f.start([c,s,v,a,l]),()=>{f.stop(),x.current&&x.current(),l()}},[d,n,a,i,s,c,l,f]),u(h.t)}function Ol(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=m.useRef(qo(t)),n=m.useRef(e);return n.current!==e&&(r.current=qo(t),n.current=e),r.current}var ID=["radius"],RD=["radius"],eb,tb,rb,nb,ab,ib,sb,ob,lb,cb;function ub(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function db(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ub(Object(r),!0).forEach(function(n){MD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ub(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MD(e,t,r){return(t=FD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FD(e){var t=LD(e,"string");return typeof t=="symbol"?t:t+""}function LD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pu(){return pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pu.apply(null,arguments)}function fb(e,t){if(e==null)return{};var r,n,a=BD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Xn(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var hb=(e,t,r,n,a)=>{var i=si(r),s=si(n),l=Math.min(Math.abs(i)/2,Math.abs(s)/2),c=s>=0?1:-1,u=i>=0?1:-1,d=s>=0&&i>=0||s<0&&i<0?1:0,f;if(l>0&&Array.isArray(a)){for(var h=[0,0,0,0],p=0,x=4;p<x;p++){var g,v=(g=a[p])!==null&&g!==void 0?g:0;h[p]=v>l?l:v}f=$t(eb||(eb=Xn(["M",",",""])),e,t+c*h[0]),h[0]>0&&(f+=$t(tb||(tb=Xn(["A ",",",",0,0,",",",",",""])),h[0],h[0],d,e+u*h[0],t)),f+=$t(rb||(rb=Xn(["L ",",",""])),e+r-u*h[1],t),h[1]>0&&(f+=$t(nb||(nb=Xn(["A ",",",",0,0,",`,
        `,",",""])),h[1],h[1],d,e+r,t+c*h[1])),f+=$t(ab||(ab=Xn(["L ",",",""])),e+r,t+n-c*h[2]),h[2]>0&&(f+=$t(ib||(ib=Xn(["A ",",",",0,0,",`,
        `,",",""])),h[2],h[2],d,e+r-u*h[2],t+n)),f+=$t(sb||(sb=Xn(["L ",",",""])),e+u*h[3],t+n),h[3]>0&&(f+=$t(ob||(ob=Xn(["A ",",",",0,0,",`,
        `,",",""])),h[3],h[3],d,e,t+n-c*h[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var b=Math.min(l,a);f=$t(lb||(lb=Xn(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,d,e+u*b,t,e+r-u*b,t,b,b,d,e+r,t+c*b,e+r,t+n-c*b,b,b,d,e+r-u*b,t+n,e+u*b,t+n,b,b,d,e,t+n-c*b)}else f=$t(cb||(cb=Xn(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},pb={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},ES=e=>{var t=ur(e,pb),r=m.useRef(null),[n,a]=m.useState(-1);m.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&a(K)}catch{}},[]);var{x:i,y:s,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:g}=t,v=m.useRef(l),b=m.useRef(c),w=m.useRef(i),y=m.useRef(s),N=m.useMemo(()=>({x:i,y:s,width:l,height:c,radius:u}),[i,s,l,c,u]),S=Ol(N,"rectangle-");if(i!==+i||s!==+s||l!==+l||c!==+c||l===0||c===0)return null;var E=lt("recharts-rectangle",d);if(!g){var _=Gr(t),{radius:j}=_,A=fb(_,ID);return m.createElement("path",pu({},A,{x:si(i),y:si(s),width:si(l),height:si(c),radius:typeof u=="number"?u:void 0,className:E,d:hb(i,s,l,c,u)}))}var T=v.current,k=b.current,C=w.current,L=y.current,G="0px ".concat(n===-1?1:n,"px"),V="".concat(n,"px 0px"),X=wS(["strokeDasharray"],h,typeof f=="string"?f:pb.animationEasing);return m.createElement(Pl,{animationId:S,key:S,canBegin:n>0,duration:h,easing:f,isActive:g,begin:p},K=>{var Y=Tt(T,l,K),q=Tt(k,c,K),Z=Tt(C,i,K),le=Tt(L,s,K);r.current&&(v.current=Y,b.current=q,w.current=Z,y.current=le);var ce;x?K>0?ce={transition:X,strokeDasharray:V}:ce={strokeDasharray:G}:ce={strokeDasharray:V};var me=Gr(t),{radius:Ne}=me,ee=fb(me,RD);return m.createElement("path",pu({},ee,{radius:typeof u=="number"?u:void 0,className:E,d:hb(Z,le,Y,q,u),ref:r,style:db(db({},ce),t.style)}))})};function mb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mb(Object(r),!0).forEach(function(n){$D(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $D(e,t,r){return(t=UD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UD(e){var t=HD(e,"string");return typeof t=="symbol"?t:t+""}function HD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mu=Math.PI/180,zD=e=>e*180/Math.PI,Gt=(e,t,r,n)=>({x:e+Math.cos(-mu*n)*r,y:t+Math.sin(-mu*n)*r}),jS=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},WD=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},VD=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=WD({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,c=Math.acos(l);return n>i&&(c=2*Math.PI-c),{radius:s,angle:zD(c),angleInRadian:c}},KD=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},GD=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},XD=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:i}=VD({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:c,endAngle:u}=KD(t),d=i,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?xb(xb({},t),{},{radius:a,angle:GD(d,t)}):null};function TS(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Gt(t,r,n,a),l=Gt(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}var gb,vb,bb,yb,wb,Nb,_b;function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pp.apply(null,arguments)}function Di(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var YD=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},lc=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:c}=e,u=l*(s?1:-1)+n,d=Math.asin(l/u)/mu,f=c?a:a+i*d,h=Gt(t,r,u,f),p=Gt(t,r,n,f),x=c?a-i*d:a,g=Gt(t,r,u*Math.cos(d*mu),x);return{center:h,circleTangency:p,lineTangency:g,theta:d}},CS=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=YD(i,s),c=i+l,u=Gt(t,r,a,i),d=Gt(t,r,a,c),f=$t(gb||(gb=Di(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(i>c),d.x,d.y);if(n>0){var h=Gt(t,r,n,i),p=Gt(t,r,n,c);f+=$t(vb||(vb=Di(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),p.x,p.y,n,n,+(Math.abs(l)>180),+(i<=c),h.x,h.y)}else f+=$t(bb||(bb=Di(["L ",","," Z"])),t,r);return f},qD=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=lr(u-c),{circleTangency:f,lineTangency:h,theta:p}=lc({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:i,cornerIsExternal:l}),{circleTangency:x,lineTangency:g,theta:v}=lc({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-p-v;if(b<0)return s?$t(yb||(yb=Di(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),h.x,h.y,i,i,i*2,i,i,-i*2):CS({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var w=$t(wb||(wb=Di(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),h.x,h.y,i,i,+(d<0),f.x,f.y,a,a,+(b>180),+(d<0),x.x,x.y,i,i,+(d<0),g.x,g.y);if(n>0){var{circleTangency:y,lineTangency:N,theta:S}=lc({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:E,lineTangency:_,theta:j}=lc({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),A=l?Math.abs(c-u):Math.abs(c-u)-S-j;if(A<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+=$t(Nb||(Nb=Di(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),_.x,_.y,i,i,+(d<0),E.x,E.y,n,n,+(A>180),+(d>0),y.x,y.y,i,i,+(d<0),N.x,N.y)}else w+=$t(_b||(_b=Di(["L",",","Z"])),t,r);return w},ZD={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},kS=e=>{var t=ur(e,ZD),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(i<a||u===d)return null;var h=lt("recharts-sector",f),p=i-a,x=Ar(s,p,0,!0),g;return x>0&&Math.abs(u-d)<360?g=qD({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=CS({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d}),m.createElement("path",pp({},Gr(t),{className:h,d:g}))};function JD(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(l_(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:s,angle:l}=t,c=Gt(n,a,i,l),u=Gt(n,a,s,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return TS(t)}}var Af={},Pf={},Of={},Sb;function QD(){return Sb||(Sb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=v_();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Of)),Of}var Eb;function eI(){return Eb||(Eb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QD();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Pf)),Pf}var jb;function tI(){return jb||(jb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=b_(),r=eI();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=s;return c}e.range=n})(Af)),Af}var Df,Tb;function rI(){return Tb||(Tb=1,Df=tI().range),Df}var nI=rI();const AS=bi(nI);function li(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function aI(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Lm(e){let t,r,n;e.length!==2?(t=li,r=(l,c)=>li(e(l),c),n=(l,c)=>e(l)-c):(t=e===li||e===aI?e:iI,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function iI(){return 0}function PS(e){return e===null?NaN:+e}function*sI(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const oI=Lm(li),Dl=oI.right;Lm(PS).center;class Cb extends Map{constructor(t,r=uI){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(kb(this,t))}has(t){return super.has(kb(this,t))}set(t,r){return super.set(lI(this,t),r)}delete(t){return super.delete(cI(this,t))}}function kb({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function lI({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function cI({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function uI(e){return e!==null&&typeof e=="object"?e.valueOf():e}function dI(e=li){if(e===li)return OS;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function OS(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const fI=Math.sqrt(50),hI=Math.sqrt(10),pI=Math.sqrt(2);function xu(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=fI?10:i>=hI?5:i>=pI?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/s,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?xu(e,t,r*2):[l,c,u]}function mp(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?xu(t,e,r):xu(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let u=0;u<l;++u)c[u]=(i-u)/-s;else for(let u=0;u<l;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<l;++u)c[u]=(a+u)/-s;else for(let u=0;u<l;++u)c[u]=(a+u)*s;return c}function xp(e,t,r){return t=+t,e=+e,r=+r,xu(e,t,r)[2]}function gp(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?xp(t,e,r):xp(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Ab(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Pb(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function DS(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?OS:dI(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),x=Math.min(n,Math.floor(t+(c-u)*f/c+h));DS(e,t,p,x,a)}const i=e[t];let s=r,l=n;for(ko(e,r,t),a(e[n],i)>0&&ko(e,r,n);s<l;){for(ko(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?ko(e,r,l):(++l,ko(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function ko(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function mI(e,t,r){if(e=Float64Array.from(sI(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Pb(e);if(t>=1)return Ab(e);var n,a=(n-1)*t,i=Math.floor(a),s=Ab(DS(e,i).subarray(0,i+1)),l=Pb(e.subarray(i+1));return s+(l-s)*(a-i)}}function xI(e,t,r=PS){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function gI(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Dn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Xa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const vp=Symbol("implicit");function Bm(){var e=new Cb,t=[],r=[],n=vp;function a(i){let s=e.get(i);if(s===void 0){if(n!==vp)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Cb;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Bm(t,r).unknown(n)},Dn.apply(a,arguments),a}function $m(){var e=Bm().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=a<n,x=p?a:n,g=p?n:a;i=(g-x)/Math.max(1,h-c+u*2),l&&(i=Math.floor(i)),x+=(g-x-i*(h-c))*d,s=i*(1-c),l&&(x=Math.round(x),s=Math.round(s));var v=gI(h).map(function(b){return x+i*b});return r(p?v.reverse():v)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return $m(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Dn.apply(f(),arguments)}function IS(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return IS(t())},e}function vI(){return IS($m.apply(null,arguments).paddingInner(1))}function Um(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function RS(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Il(){}var al=.7,gu=1/al,Us="\\s*([+-]?\\d+)\\s*",il="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",oa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bI=/^#([0-9a-f]{3,8})$/,yI=new RegExp(`^rgb\\(${Us},${Us},${Us}\\)$`),wI=new RegExp(`^rgb\\(${oa},${oa},${oa}\\)$`),NI=new RegExp(`^rgba\\(${Us},${Us},${Us},${il}\\)$`),_I=new RegExp(`^rgba\\(${oa},${oa},${oa},${il}\\)$`),SI=new RegExp(`^hsl\\(${il},${oa},${oa}\\)$`),EI=new RegExp(`^hsla\\(${il},${oa},${oa},${il}\\)$`),Ob={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Um(Il,sl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Db,formatHex:Db,formatHex8:jI,formatHsl:TI,formatRgb:Ib,toString:Ib});function Db(){return this.rgb().formatHex()}function jI(){return this.rgb().formatHex8()}function TI(){return MS(this).formatHsl()}function Ib(){return this.rgb().formatRgb()}function sl(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=bI.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Rb(t):r===3?new tn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?cc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?cc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yI.exec(e))?new tn(t[1],t[2],t[3],1):(t=wI.exec(e))?new tn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=NI.exec(e))?cc(t[1],t[2],t[3],t[4]):(t=_I.exec(e))?cc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=SI.exec(e))?Lb(t[1],t[2]/100,t[3]/100,1):(t=EI.exec(e))?Lb(t[1],t[2]/100,t[3]/100,t[4]):Ob.hasOwnProperty(e)?Rb(Ob[e]):e==="transparent"?new tn(NaN,NaN,NaN,0):null}function Rb(e){return new tn(e>>16&255,e>>8&255,e&255,1)}function cc(e,t,r,n){return n<=0&&(e=t=r=NaN),new tn(e,t,r,n)}function CI(e){return e instanceof Il||(e=sl(e)),e?(e=e.rgb(),new tn(e.r,e.g,e.b,e.opacity)):new tn}function bp(e,t,r,n){return arguments.length===1?CI(e):new tn(e,t,r,n??1)}function tn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Um(tn,bp,RS(Il,{brighter(e){return e=e==null?gu:Math.pow(gu,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tn(Li(this.r),Li(this.g),Li(this.b),vu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mb,formatHex:Mb,formatHex8:kI,formatRgb:Fb,toString:Fb}));function Mb(){return`#${Ii(this.r)}${Ii(this.g)}${Ii(this.b)}`}function kI(){return`#${Ii(this.r)}${Ii(this.g)}${Ii(this.b)}${Ii((isNaN(this.opacity)?1:this.opacity)*255)}`}function Fb(){const e=vu(this.opacity);return`${e===1?"rgb(":"rgba("}${Li(this.r)}, ${Li(this.g)}, ${Li(this.b)}${e===1?")":`, ${e})`}`}function vu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Li(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ii(e){return e=Li(e),(e<16?"0":"")+e.toString(16)}function Lb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new $n(e,t,r,n)}function MS(e){if(e instanceof $n)return new $n(e.h,e.s,e.l,e.opacity);if(e instanceof Il||(e=sl(e)),!e)return new $n;if(e instanceof $n)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new $n(s,l,c,e.opacity)}function AI(e,t,r,n){return arguments.length===1?MS(e):new $n(e,t,r,n??1)}function $n(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Um($n,AI,RS(Il,{brighter(e){return e=e==null?gu:Math.pow(gu,e),new $n(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?al:Math.pow(al,e),new $n(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new tn(If(e>=240?e-240:e+120,a,n),If(e,a,n),If(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new $n(Bb(this.h),uc(this.s),uc(this.l),vu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=vu(this.opacity);return`${e===1?"hsl(":"hsla("}${Bb(this.h)}, ${uc(this.s)*100}%, ${uc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Bb(e){return e=(e||0)%360,e<0?e+360:e}function uc(e){return Math.max(0,Math.min(1,e||0))}function If(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Hm=e=>()=>e;function PI(e,t){return function(r){return e+r*t}}function OI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function DI(e){return(e=+e)==1?FS:function(t,r){return r-t?OI(t,r,e):Hm(isNaN(t)?r:t)}}function FS(e,t){var r=t-e;return r?PI(e,r):Hm(isNaN(e)?t:e)}const $b=(function e(t){var r=DI(t);function n(a,i){var s=r((a=bp(a)).r,(i=bp(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),u=FS(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n})(1);function II(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function RI(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function MI(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=io(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function FI(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function bu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function LI(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=io(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var yp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Rf=new RegExp(yp.source,"g");function BI(e){return function(){return e}}function $I(e){return function(t){return e(t)+""}}function UI(e,t){var r=yp.lastIndex=Rf.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=yp.exec(e))&&(a=Rf.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:bu(n,a)})),r=Rf.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?$I(c[0].x):BI(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function io(e,t){var r=typeof t,n;return t==null||r==="boolean"?Hm(t):(r==="number"?bu:r==="string"?(n=sl(t))?(t=n,$b):UI:t instanceof sl?$b:t instanceof Date?FI:RI(t)?II:Array.isArray(t)?MI:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?LI:bu)(e,t)}function zm(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function HI(e,t){t===void 0&&(t=e,e=io);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function zI(e){return function(){return e}}function yu(e){return+e}var Ub=[0,1];function Hr(e){return e}function wp(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:zI(isNaN(t)?NaN:.5)}function WI(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function VI(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=wp(a,n),i=r(s,i)):(n=wp(n,a),i=r(i,s)),function(l){return i(n(l))}}function KI(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=wp(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=Dl(e,l,1,n)-1;return i[c](a[c](l))}}function Rl(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Fd(){var e=Ub,t=Ub,r=io,n,a,i,s=Hr,l,c,u;function d(){var h=Math.min(e.length,t.length);return s!==Hr&&(s=WI(e[0],e[h-1])),l=h>2?KI:VI,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(n),t,r)))(n(s(h)))}return f.invert=function(h){return s(a((u||(u=l(t,e.map(n),bu)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,yu),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=zm,d()},f.clamp=function(h){return arguments.length?(s=h?!0:Hr,d()):s!==Hr},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,p){return n=h,a=p,d()}}function Wm(){return Fd()(Hr,Hr)}function GI(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wu(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Qs(e){return e=wu(Math.abs(e)),e?e[1]:NaN}function XI(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function YI(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var qI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ol(e){if(!(t=qI.exec(e)))throw new Error("invalid format: "+e);var t;return new Vm({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ol.prototype=Vm.prototype;function Vm(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Vm.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ZI(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Nu;function JI(e,t){var r=wu(e,t);if(!r)return Nu=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(Nu=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wu(e,Math.max(0,t+i-1))[0]}function Hb(e,t){var r=wu(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const zb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:GI,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Hb(e*100,t),r:Hb,s:JI,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Wb(e){return e}var Vb=Array.prototype.map,Kb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function QI(e){var t=e.grouping===void 0||e.thousands===void 0?Wb:XI(Vb.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Wb:YI(Vb.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=ol(f);var p=f.fill,x=f.align,g=f.sign,v=f.symbol,b=f.zero,w=f.width,y=f.comma,N=f.precision,S=f.trim,E=f.type;E==="n"?(y=!0,E="g"):zb[E]||(N===void 0&&(N=12),S=!0,E="g"),(b||p==="0"&&x==="=")&&(b=!0,p="0",x="=");var _=(h&&h.prefix!==void 0?h.prefix:"")+(v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():""),j=(v==="$"?n:/[%p]/.test(E)?s:"")+(h&&h.suffix!==void 0?h.suffix:""),A=zb[E],T=/[defgprs%]/.test(E);N=N===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function k(C){var L=_,G=j,V,X,K;if(E==="c")G=A(C)+G,C="";else{C=+C;var Y=C<0||1/C<0;if(C=isNaN(C)?c:A(Math.abs(C),N),S&&(C=ZI(C)),Y&&+C==0&&g!=="+"&&(Y=!1),L=(Y?g==="("?g:l:g==="-"||g==="("?"":g)+L,G=(E==="s"&&!isNaN(C)&&Nu!==void 0?Kb[8+Nu/3]:"")+G+(Y&&g==="("?")":""),T){for(V=-1,X=C.length;++V<X;)if(K=C.charCodeAt(V),48>K||K>57){G=(K===46?a+C.slice(V+1):C.slice(V))+G,C=C.slice(0,V);break}}}y&&!b&&(C=t(C,1/0));var q=L.length+C.length+G.length,Z=q<w?new Array(w-q+1).join(p):"";switch(y&&b&&(C=t(Z+C,Z.length?w-G.length:1/0),Z=""),x){case"<":C=L+C+G+Z;break;case"=":C=L+Z+C+G;break;case"^":C=Z.slice(0,q=Z.length>>1)+L+C+G+Z.slice(q);break;default:C=Z+L+C+G;break}return i(C)}return k.toString=function(){return f+""},k}function d(f,h){var p=Math.max(-8,Math.min(8,Math.floor(Qs(h)/3)))*3,x=Math.pow(10,-p),g=u((f=ol(f),f.type="f",f),{suffix:Kb[8+p/3]});return function(v){return g(x*v)}}return{format:u,formatPrefix:d}}var dc,Km,LS;eR({thousands:",",grouping:[3],currency:["$",""]});function eR(e){return dc=QI(e),Km=dc.format,LS=dc.formatPrefix,dc}function tR(e){return Math.max(0,-Qs(Math.abs(e)))}function rR(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qs(t)/3)))*3-Qs(Math.abs(e)))}function nR(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Qs(t)-Qs(e))+1}function BS(e,t,r,n){var a=gp(e,t,r),i;switch(n=ol(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=rR(a,s))&&(n.precision=i),LS(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=nR(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=tR(a))&&(n.precision=i-(n.type==="%")*2);break}}return Km(n)}function yi(e){var t=e.domain;return e.ticks=function(r){var n=t();return mp(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return BS(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,u,d=10;for(l<s&&(u=s,s=l,l=u,u=a,a=i,i=u);d-- >0;){if(u=xp(s,l,r),u===c)return n[a]=s,n[i]=l,t(n);if(u>0)s=Math.floor(s/u)*u,l=Math.ceil(l/u)*u;else if(u<0)s=Math.ceil(s*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function $S(){var e=Wm();return e.copy=function(){return Rl(e,$S())},Dn.apply(e,arguments),yi(e)}function US(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,yu),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return US(e).unknown(t)},e=arguments.length?Array.from(e,yu):[0,1],yi(r)}function HS(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Gb(e){return Math.log(e)}function Xb(e){return Math.exp(e)}function aR(e){return-Math.log(-e)}function iR(e){return-Math.exp(-e)}function sR(e){return isFinite(e)?+("1e"+e):e<0?0:e}function oR(e){return e===10?sR:e===Math.E?Math.exp:t=>Math.pow(e,t)}function lR(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Yb(e){return(t,r)=>-e(-t,r)}function Gm(e){const t=e(Gb,Xb),r=t.domain;let n=10,a,i;function s(){return a=lR(n),i=oR(n),r()[0]<0?(a=Yb(a),i=Yb(i),e(aR,iR)):e(Gb,Xb),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),p=a(d),x,g;const v=l==null?10:+l;let b=[];if(!(n%1)&&p-h<v){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(x=1;x<n;++x)if(g=h<0?x/i(-h):x*i(h),!(g<u)){if(g>d)break;b.push(g)}}else for(;h<=p;++h)for(x=n-1;x>=1;--x)if(g=h>0?x/i(-h):x*i(h),!(g<u)){if(g>d)break;b.push(g)}b.length*2<v&&(b=mp(u,d,v))}else b=mp(h,p,Math.min(p-h,v)).map(i);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ol(c)).precision==null&&(c.trim=!0),c=Km(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(HS(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function zS(){const e=Gm(Fd()).domain([1,10]);return e.copy=()=>Rl(e,zS()).base(e.base()),Dn.apply(e,arguments),e}function qb(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Zb(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Xm(e){var t=1,r=e(qb(t),Zb(t));return r.constant=function(n){return arguments.length?e(qb(t=+n),Zb(t)):t},yi(r)}function WS(){var e=Xm(Fd());return e.copy=function(){return Rl(e,WS()).constant(e.constant())},Dn.apply(e,arguments)}function Jb(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function cR(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function uR(e){return e<0?-e*e:e*e}function Ym(e){var t=e(Hr,Hr),r=1;function n(){return r===1?e(Hr,Hr):r===.5?e(cR,uR):e(Jb(r),Jb(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},yi(t)}function qm(){var e=Ym(Fd());return e.copy=function(){return Rl(e,qm()).exponent(e.exponent())},Dn.apply(e,arguments),e}function dR(){return qm.apply(null,arguments).exponent(.5)}function Qb(e){return Math.sign(e)*e*e}function fR(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function VS(){var e=Wm(),t=[0,1],r=!1,n;function a(i){var s=fR(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(Qb(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,yu)).map(Qb)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return VS(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Dn.apply(a,arguments),yi(a)}function KS(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=xI(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Dl(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(li),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return KS().domain(e).range(t).unknown(n)},Dn.apply(i,arguments)}function GS(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Dl(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return GS().domain([e,t]).range(a).unknown(i)},Dn.apply(yi(s),arguments)}function XS(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Dl(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return XS().domain(e).range(t).unknown(r)},Dn.apply(a,arguments)}const Mf=new Date,Ff=new Date;function rr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<s);return c},a.filter=i=>rr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Mf.setTime(+i),Ff.setTime(+s),e(Mf),e(Ff),Math.floor(r(Mf,Ff))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const _u=rr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_u.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?rr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):_u);_u.range;const Ea=1e3,Cn=Ea*60,ja=Cn*60,Ma=ja*24,Zm=Ma*7,ey=Ma*30,Lf=Ma*365,Ri=rr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ea)},(e,t)=>(t-e)/Ea,e=>e.getUTCSeconds());Ri.range;const Jm=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ea)},(e,t)=>{e.setTime(+e+t*Cn)},(e,t)=>(t-e)/Cn,e=>e.getMinutes());Jm.range;const Qm=rr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Cn)},(e,t)=>(t-e)/Cn,e=>e.getUTCMinutes());Qm.range;const ex=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ea-e.getMinutes()*Cn)},(e,t)=>{e.setTime(+e+t*ja)},(e,t)=>(t-e)/ja,e=>e.getHours());ex.range;const tx=rr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ja)},(e,t)=>(t-e)/ja,e=>e.getUTCHours());tx.range;const Ml=rr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Cn)/Ma,e=>e.getDate()-1);Ml.range;const Ld=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ma,e=>e.getUTCDate()-1);Ld.range;const YS=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ma,e=>Math.floor(e/Ma));YS.range;function ls(e){return rr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Cn)/Zm)}const Bd=ls(0),Su=ls(1),hR=ls(2),pR=ls(3),eo=ls(4),mR=ls(5),xR=ls(6);Bd.range;Su.range;hR.range;pR.range;eo.range;mR.range;xR.range;function cs(e){return rr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Zm)}const $d=cs(0),Eu=cs(1),gR=cs(2),vR=cs(3),to=cs(4),bR=cs(5),yR=cs(6);$d.range;Eu.range;gR.range;vR.range;to.range;bR.range;yR.range;const rx=rr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());rx.range;const nx=rr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());nx.range;const Fa=rr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Fa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Fa.range;const La=rr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());La.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});La.range;function qS(e,t,r,n,a,i){const s=[[Ri,1,Ea],[Ri,5,5*Ea],[Ri,15,15*Ea],[Ri,30,30*Ea],[i,1,Cn],[i,5,5*Cn],[i,15,15*Cn],[i,30,30*Cn],[a,1,ja],[a,3,3*ja],[a,6,6*ja],[a,12,12*ja],[n,1,Ma],[n,2,2*Ma],[r,1,Zm],[t,1,ey],[t,3,3*ey],[e,1,Lf]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),x=p?p.range(u,+d+1):[];return h?x.reverse():x}function c(u,d,f){const h=Math.abs(d-u)/f,p=Lm(([,,v])=>v).right(s,h);if(p===s.length)return e.every(gp(u/Lf,d/Lf,f));if(p===0)return _u.every(Math.max(gp(u,d,f),1));const[x,g]=s[h/s[p-1][2]<s[p][2]/h?p-1:p];return x.every(g)}return[l,c]}const[wR,NR]=qS(La,nx,$d,YS,tx,Qm),[_R,SR]=qS(Fa,rx,Bd,Ml,ex,Jm);function Bf(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $f(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ao(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function ER(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,u=Po(a),d=Oo(a),f=Po(i),h=Oo(i),p=Po(s),x=Oo(s),g=Po(l),v=Oo(l),b=Po(c),w=Oo(c),y={a:K,A:Y,b:q,B:Z,c:null,d:sy,e:sy,f:XR,g:a6,G:s6,H:VR,I:KR,j:GR,L:ZS,m:YR,M:qR,p:le,q:ce,Q:cy,s:uy,S:ZR,u:JR,U:QR,V:e6,w:t6,W:r6,x:null,X:null,y:n6,Y:i6,Z:o6,"%":ly},N={a:me,A:Ne,b:ee,B:oe,c:null,d:oy,e:oy,f:d6,g:w6,G:_6,H:l6,I:c6,j:u6,L:QS,m:f6,M:h6,p:fe,q:O,Q:cy,s:uy,S:p6,u:m6,U:x6,V:g6,w:v6,W:b6,x:null,X:null,y:y6,Y:N6,Z:S6,"%":ly},S={a:T,A:k,b:C,B:L,c:G,d:ay,e:ay,f:UR,g:ny,G:ry,H:iy,I:iy,j:FR,L:$R,m:MR,M:LR,p:A,q:RR,Q:zR,s:WR,S:BR,u:AR,U:PR,V:OR,w:kR,W:DR,x:V,X,y:ny,Y:ry,Z:IR,"%":HR};y.x=E(r,y),y.X=E(n,y),y.c=E(t,y),N.x=E(r,N),N.X=E(n,N),N.c=E(t,N);function E(I,F){return function(M){var W=[],J=-1,se=0,ke=I.length,ye,Pe,ue;for(M instanceof Date||(M=new Date(+M));++J<ke;)I.charCodeAt(J)===37&&(W.push(I.slice(se,J)),(Pe=ty[ye=I.charAt(++J)])!=null?ye=I.charAt(++J):Pe=ye==="e"?" ":"0",(ue=F[ye])&&(ye=ue(M,Pe)),W.push(ye),se=J+1);return W.push(I.slice(se,J)),W.join("")}}function _(I,F){return function(M){var W=Ao(1900,void 0,1),J=j(W,I,M+="",0),se,ke;if(J!=M.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(F&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(se=$f(Ao(W.y,0,1)),ke=se.getUTCDay(),se=ke>4||ke===0?Eu.ceil(se):Eu(se),se=Ld.offset(se,(W.V-1)*7),W.y=se.getUTCFullYear(),W.m=se.getUTCMonth(),W.d=se.getUTCDate()+(W.w+6)%7):(se=Bf(Ao(W.y,0,1)),ke=se.getDay(),se=ke>4||ke===0?Su.ceil(se):Su(se),se=Ml.offset(se,(W.V-1)*7),W.y=se.getFullYear(),W.m=se.getMonth(),W.d=se.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),ke="Z"in W?$f(Ao(W.y,0,1)).getUTCDay():Bf(Ao(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(ke+5)%7:W.w+W.U*7-(ke+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,$f(W)):Bf(W)}}function j(I,F,M,W){for(var J=0,se=F.length,ke=M.length,ye,Pe;J<se;){if(W>=ke)return-1;if(ye=F.charCodeAt(J++),ye===37){if(ye=F.charAt(J++),Pe=S[ye in ty?F.charAt(J++):ye],!Pe||(W=Pe(I,M,W))<0)return-1}else if(ye!=M.charCodeAt(W++))return-1}return W}function A(I,F,M){var W=u.exec(F.slice(M));return W?(I.p=d.get(W[0].toLowerCase()),M+W[0].length):-1}function T(I,F,M){var W=p.exec(F.slice(M));return W?(I.w=x.get(W[0].toLowerCase()),M+W[0].length):-1}function k(I,F,M){var W=f.exec(F.slice(M));return W?(I.w=h.get(W[0].toLowerCase()),M+W[0].length):-1}function C(I,F,M){var W=b.exec(F.slice(M));return W?(I.m=w.get(W[0].toLowerCase()),M+W[0].length):-1}function L(I,F,M){var W=g.exec(F.slice(M));return W?(I.m=v.get(W[0].toLowerCase()),M+W[0].length):-1}function G(I,F,M){return j(I,t,F,M)}function V(I,F,M){return j(I,r,F,M)}function X(I,F,M){return j(I,n,F,M)}function K(I){return s[I.getDay()]}function Y(I){return i[I.getDay()]}function q(I){return c[I.getMonth()]}function Z(I){return l[I.getMonth()]}function le(I){return a[+(I.getHours()>=12)]}function ce(I){return 1+~~(I.getMonth()/3)}function me(I){return s[I.getUTCDay()]}function Ne(I){return i[I.getUTCDay()]}function ee(I){return c[I.getUTCMonth()]}function oe(I){return l[I.getUTCMonth()]}function fe(I){return a[+(I.getUTCHours()>=12)]}function O(I){return 1+~~(I.getUTCMonth()/3)}return{format:function(I){var F=E(I+="",y);return F.toString=function(){return I},F},parse:function(I){var F=_(I+="",!1);return F.toString=function(){return I},F},utcFormat:function(I){var F=E(I+="",N);return F.toString=function(){return I},F},utcParse:function(I){var F=_(I+="",!0);return F.toString=function(){return I},F}}}var ty={"-":"",_:" ",0:"0"},dr=/^\s*\d+/,jR=/^%/,TR=/[\\^$*+?|[\]().{}]/g;function nt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function CR(e){return e.replace(TR,"\\$&")}function Po(e){return new RegExp("^(?:"+e.map(CR).join("|")+")","i")}function Oo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function kR(e,t,r){var n=dr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function AR(e,t,r){var n=dr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function PR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function OR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function DR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ry(e,t,r){var n=dr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function ny(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function IR(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function RR(e,t,r){var n=dr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function MR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function ay(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function FR(e,t,r){var n=dr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function iy(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function LR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function BR(e,t,r){var n=dr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function $R(e,t,r){var n=dr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function UR(e,t,r){var n=dr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function HR(e,t,r){var n=jR.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function zR(e,t,r){var n=dr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function WR(e,t,r){var n=dr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function sy(e,t){return nt(e.getDate(),t,2)}function VR(e,t){return nt(e.getHours(),t,2)}function KR(e,t){return nt(e.getHours()%12||12,t,2)}function GR(e,t){return nt(1+Ml.count(Fa(e),e),t,3)}function ZS(e,t){return nt(e.getMilliseconds(),t,3)}function XR(e,t){return ZS(e,t)+"000"}function YR(e,t){return nt(e.getMonth()+1,t,2)}function qR(e,t){return nt(e.getMinutes(),t,2)}function ZR(e,t){return nt(e.getSeconds(),t,2)}function JR(e){var t=e.getDay();return t===0?7:t}function QR(e,t){return nt(Bd.count(Fa(e)-1,e),t,2)}function JS(e){var t=e.getDay();return t>=4||t===0?eo(e):eo.ceil(e)}function e6(e,t){return e=JS(e),nt(eo.count(Fa(e),e)+(Fa(e).getDay()===4),t,2)}function t6(e){return e.getDay()}function r6(e,t){return nt(Su.count(Fa(e)-1,e),t,2)}function n6(e,t){return nt(e.getFullYear()%100,t,2)}function a6(e,t){return e=JS(e),nt(e.getFullYear()%100,t,2)}function i6(e,t){return nt(e.getFullYear()%1e4,t,4)}function s6(e,t){var r=e.getDay();return e=r>=4||r===0?eo(e):eo.ceil(e),nt(e.getFullYear()%1e4,t,4)}function o6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+nt(t/60|0,"0",2)+nt(t%60,"0",2)}function oy(e,t){return nt(e.getUTCDate(),t,2)}function l6(e,t){return nt(e.getUTCHours(),t,2)}function c6(e,t){return nt(e.getUTCHours()%12||12,t,2)}function u6(e,t){return nt(1+Ld.count(La(e),e),t,3)}function QS(e,t){return nt(e.getUTCMilliseconds(),t,3)}function d6(e,t){return QS(e,t)+"000"}function f6(e,t){return nt(e.getUTCMonth()+1,t,2)}function h6(e,t){return nt(e.getUTCMinutes(),t,2)}function p6(e,t){return nt(e.getUTCSeconds(),t,2)}function m6(e){var t=e.getUTCDay();return t===0?7:t}function x6(e,t){return nt($d.count(La(e)-1,e),t,2)}function eE(e){var t=e.getUTCDay();return t>=4||t===0?to(e):to.ceil(e)}function g6(e,t){return e=eE(e),nt(to.count(La(e),e)+(La(e).getUTCDay()===4),t,2)}function v6(e){return e.getUTCDay()}function b6(e,t){return nt(Eu.count(La(e)-1,e),t,2)}function y6(e,t){return nt(e.getUTCFullYear()%100,t,2)}function w6(e,t){return e=eE(e),nt(e.getUTCFullYear()%100,t,2)}function N6(e,t){return nt(e.getUTCFullYear()%1e4,t,4)}function _6(e,t){var r=e.getUTCDay();return e=r>=4||r===0?to(e):to.ceil(e),nt(e.getUTCFullYear()%1e4,t,4)}function S6(){return"+0000"}function ly(){return"%"}function cy(e){return+e}function uy(e){return Math.floor(+e/1e3)}var ys,tE,rE;E6({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function E6(e){return ys=ER(e),tE=ys.format,ys.parse,rE=ys.utcFormat,ys.utcParse,ys}function j6(e){return new Date(e)}function T6(e){return e instanceof Date?+e:+new Date(+e)}function ax(e,t,r,n,a,i,s,l,c,u){var d=Wm(),f=d.invert,h=d.domain,p=u(".%L"),x=u(":%S"),g=u("%I:%M"),v=u("%I %p"),b=u("%a %d"),w=u("%b %d"),y=u("%B"),N=u("%Y");function S(E){return(c(E)<E?p:l(E)<E?x:s(E)<E?g:i(E)<E?v:n(E)<E?a(E)<E?b:w:r(E)<E?y:N)(E)}return d.invert=function(E){return new Date(f(E))},d.domain=function(E){return arguments.length?h(Array.from(E,T6)):h().map(j6)},d.ticks=function(E){var _=h();return e(_[0],_[_.length-1],E??10)},d.tickFormat=function(E,_){return _==null?S:u(_)},d.nice=function(E){var _=h();return(!E||typeof E.range!="function")&&(E=t(_[0],_[_.length-1],E??10)),E?h(HS(_,E)):d},d.copy=function(){return Rl(d,ax(e,t,r,n,a,i,s,l,c,u))},d}function C6(){return Dn.apply(ax(_R,SR,Fa,rx,Bd,Ml,ex,Jm,Ri,tE).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function k6(){return Dn.apply(ax(wR,NR,La,nx,$d,Ld,tx,Qm,Ri,rE).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ud(){var e=0,t=1,r,n,a,i,s=Hr,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(h){var p,x;return arguments.length?([p,x]=h,s=f(p,x),u):[s(0),s(1)]}}return u.range=d(io),u.rangeRound=d(zm),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function wi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nE(){var e=yi(Ud()(Hr));return e.copy=function(){return wi(e,nE())},Xa.apply(e,arguments)}function aE(){var e=Gm(Ud()).domain([1,10]);return e.copy=function(){return wi(e,aE()).base(e.base())},Xa.apply(e,arguments)}function iE(){var e=Xm(Ud());return e.copy=function(){return wi(e,iE()).constant(e.constant())},Xa.apply(e,arguments)}function ix(){var e=Ym(Ud());return e.copy=function(){return wi(e,ix()).exponent(e.exponent())},Xa.apply(e,arguments)}function A6(){return ix.apply(null,arguments).exponent(.5)}function sE(){var e=[],t=Hr;function r(n){if(n!=null&&!isNaN(n=+n))return t((Dl(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(li),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>mI(e,i/n))},r.copy=function(){return sE(t).domain(e)},Xa.apply(r,arguments)}function Hd(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,u=Hr,d,f=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+d(g))-i)*(n*g<n*i?l:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,a=d(e=+e),i=d(t=+t),s=d(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function x(g){return function(v){var b,w,y;return arguments.length?([b,w,y]=v,u=HI(g,[b,w,y]),p):[u(0),u(.5),u(1)]}}return p.range=x(io),p.rangeRound=x(zm),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return d=g,a=g(e),i=g(t),s=g(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function oE(){var e=yi(Hd()(Hr));return e.copy=function(){return wi(e,oE())},Xa.apply(e,arguments)}function lE(){var e=Gm(Hd()).domain([.1,1,10]);return e.copy=function(){return wi(e,lE()).base(e.base())},Xa.apply(e,arguments)}function cE(){var e=Xm(Hd());return e.copy=function(){return wi(e,cE()).constant(e.constant())},Xa.apply(e,arguments)}function sx(){var e=Ym(Hd());return e.copy=function(){return wi(e,sx()).exponent(e.exponent())},Xa.apply(e,arguments)}function P6(){return sx.apply(null,arguments).exponent(.5)}const Lo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:$m,scaleDiverging:oE,scaleDivergingLog:lE,scaleDivergingPow:sx,scaleDivergingSqrt:P6,scaleDivergingSymlog:cE,scaleIdentity:US,scaleImplicit:vp,scaleLinear:$S,scaleLog:zS,scaleOrdinal:Bm,scalePoint:vI,scalePow:qm,scaleQuantile:KS,scaleQuantize:GS,scaleRadial:VS,scaleSequential:nE,scaleSequentialLog:aE,scaleSequentialPow:ix,scaleSequentialQuantile:sE,scaleSequentialSqrt:A6,scaleSequentialSymlog:iE,scaleSqrt:dR,scaleSymlog:WS,scaleThreshold:XS,scaleTime:C6,scaleUtc:k6,tickFormat:BS},Symbol.toStringTag,{value:"Module"}));var Ya=e=>e.chartData,zd=Q([Ya],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),ox=(e,t,r,n)=>n?zd(e):Ya(e),O6=(e,t,r)=>r?zd(e):Ya(e);function Ba(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(et(t)&&et(r))return!0}return!1}function dy(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function uE(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(et(r))a=r;else if(typeof r=="function")return;if(et(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Ba(s))return s}}function D6(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Ba(n))return dy(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Ie(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&_1.test(a)){var c=_1.exec(a);if(c==null||c[1]==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ie(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&S1.test(i)){var d=S1.exec(i);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t?.[1];var h=[s,l];if(Ba(h))return t==null?h:dy(h,t,r)}}}var so=1e9,I6={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cx,kt=!0,On="[DecimalError] ",Bi=On+"Invalid argument: ",lx=On+"Exponent out of range: ",oo=Math.floor,Ai=Math.pow,R6=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fn,sr=1e7,Nt=7,dE=9007199254740991,ju=oo(dE/Nt),Re={};Re.absoluteValue=Re.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Re.comparedTo=Re.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Re.decimalPlaces=Re.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Nt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Re.dividedBy=Re.div=function(e){return Aa(this,new this.constructor(e))};Re.dividedToIntegerBy=Re.idiv=function(e){var t=this,r=t.constructor;return vt(Aa(t,new r(e),0,1),r.precision)};Re.equals=Re.eq=function(e){return!this.cmp(e)};Re.exponent=function(){return Zt(this)};Re.greaterThan=Re.gt=function(e){return this.cmp(e)>0};Re.greaterThanOrEqualTo=Re.gte=function(e){return this.cmp(e)>=0};Re.isInteger=Re.isint=function(){return this.e>this.d.length-2};Re.isNegative=Re.isneg=function(){return this.s<0};Re.isPositive=Re.ispos=function(){return this.s>0};Re.isZero=function(){return this.s===0};Re.lessThan=Re.lt=function(e){return this.cmp(e)<0};Re.lessThanOrEqualTo=Re.lte=function(e){return this.cmp(e)<1};Re.logarithm=Re.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(fn))throw Error(On+"NaN");if(r.s<1)throw Error(On+(r.s?"NaN":"-Infinity"));return r.eq(fn)?new n(0):(kt=!1,t=Aa(ll(r,i),ll(e,i),i),kt=!0,vt(t,a))};Re.minus=Re.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?pE(t,e):fE(t,(e.s=-e.s,e))};Re.modulo=Re.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(On+"NaN");return r.s?(kt=!1,t=Aa(r,e,0,1).times(e),kt=!0,r.minus(t)):vt(new n(r),a)};Re.naturalExponential=Re.exp=function(){return hE(this)};Re.naturalLogarithm=Re.ln=function(){return ll(this)};Re.negated=Re.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Re.plus=Re.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?fE(t,e):pE(t,(e.s=-e.s,e))};Re.precision=Re.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Bi+e);if(t=Zt(a)+1,n=a.d.length-1,r=n*Nt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Re.squareRoot=Re.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(On+"NaN")}for(e=Zt(l),kt=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=ia(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=oo((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Aa(l,i,s+2)).times(.5),ia(i.d).slice(0,s)===(t=ia(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(vt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return kt=!0,vt(n,r)};Re.times=Re.mul=function(e){var t,r,n,a,i,s,l,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(i=h,h=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+p[n]*h[a-n-1]+t,i[a--]=l%sr|0,t=l/sr|0;i[a]=(i[a]+t)%sr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,kt?vt(e,f.precision):e};Re.toDecimalPlaces=Re.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ha(e,0,so),t===void 0?t=n.rounding:ha(t,0,8),vt(r,e+Zt(r)+1,t))};Re.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Yi(n,!0):(ha(e,0,so),t===void 0?t=a.rounding:ha(t,0,8),n=vt(new a(n),e+1,t),r=Yi(n,!0,e+1)),r};Re.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Yi(a):(ha(e,0,so),t===void 0?t=i.rounding:ha(t,0,8),n=vt(new i(a),e+Zt(a)+1,t),r=Yi(n.abs(),!1,e+Zt(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Re.toInteger=Re.toint=function(){var e=this,t=e.constructor;return vt(new t(e),Zt(e)+1,t.rounding)};Re.toNumber=function(){return+this};Re.toPower=Re.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(fn);if(l=new c(l),!l.s){if(e.s<1)throw Error(On+"Infinity");return l}if(l.eq(fn))return l;if(n=c.precision,e.eq(fn))return vt(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=d<0?-d:d)<=dE){for(a=new c(fn),t=Math.ceil(n/Nt+4),kt=!1;r%2&&(a=a.times(l),hy(a.d,t)),r=oo(r/2),r!==0;)l=l.times(l),hy(l.d,t);return kt=!0,e.s<0?new c(fn).div(a):vt(a,n)}}else if(i<0)throw Error(On+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,kt=!1,a=e.times(ll(l,n+u)),kt=!0,a=hE(a),a.s=i,a};Re.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Zt(a),n=Yi(a,r<=i.toExpNeg||r>=i.toExpPos)):(ha(e,1,so),t===void 0?t=i.rounding:ha(t,0,8),a=vt(new i(a),e,t),r=Zt(a),n=Yi(a,e<=r||r<=i.toExpNeg,e)),n};Re.toSignificantDigits=Re.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ha(e,1,so),t===void 0?t=n.rounding:ha(t,0,8)),vt(new n(r),e,t)};Re.toString=Re.valueOf=Re.val=Re.toJSON=Re[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Zt(e),r=e.constructor;return Yi(e,t<=r.toExpNeg||t>=r.toExpPos)};function fE(e,t){var r,n,a,i,s,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),kt?vt(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=u.length):(n=u,a=s,l=c.length),s=Math.ceil(f/Nt),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/sr|0,c[i]%=sr;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,kt?vt(t,f):t}function ha(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Bi+e)}function ia(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Nt-n.length,r&&(i+=ni(r)),i+=n;s=e[t],n=s+"",r=Nt-n.length,r&&(i+=ni(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Aa=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%sr|0,s=i/sr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*sr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,u,d,f,h,p,x,g,v,b,w,y,N,S,E,_,j,A=n.constructor,T=n.s==a.s?1:-1,k=n.d,C=a.d;if(!n.s)return new A(n);if(!a.s)throw Error(On+"Division by zero");for(c=n.e-a.e,_=C.length,S=k.length,p=new A(T),x=p.d=[],u=0;C[u]==(k[u]||0);)++u;if(C[u]>(k[u]||0)&&--c,i==null?w=i=A.precision:s?w=i+(Zt(n)-Zt(a))+1:w=i,w<0)return new A(0);if(w=w/Nt+2|0,u=0,_==1)for(d=0,C=C[0],w++;(u<S||d)&&w--;u++)y=d*sr+(k[u]||0),x[u]=y/C|0,d=y%C|0;else{for(d=sr/(C[0]+1)|0,d>1&&(C=e(C,d),k=e(k,d),_=C.length,S=k.length),N=_,g=k.slice(0,_),v=g.length;v<_;)g[v++]=0;j=C.slice(),j.unshift(0),E=C[0],C[1]>=sr/2&&++E;do d=0,l=t(C,g,_,v),l<0?(b=g[0],_!=v&&(b=b*sr+(g[1]||0)),d=b/E|0,d>1?(d>=sr&&(d=sr-1),f=e(C,d),h=f.length,v=g.length,l=t(f,g,h,v),l==1&&(d--,r(f,_<h?j:C,h))):(d==0&&(l=d=1),f=C.slice()),h=f.length,h<v&&f.unshift(0),r(g,f,v),l==-1&&(v=g.length,l=t(C,g,_,v),l<1&&(d++,r(g,_<v?j:C,v))),v=g.length):l===0&&(d++,g=[0]),x[u++]=d,l&&g[0]?g[v++]=k[N]||0:(g=[k[N]],v=1);while((N++<S||g[0]!==void 0)&&w--)}return x[0]||x.shift(),p.e=c,vt(p,s?i+Zt(p)+1:i)}})();function hE(e,t){var r,n,a,i,s,l,c=0,u=0,d=e.constructor,f=d.precision;if(Zt(e)>16)throw Error(lx+Zt(e));if(!e.s)return new d(fn);for(kt=!1,l=f,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(Ai(2,u))/Math.LN10*2+5|0,l+=n,r=a=i=new d(fn),d.precision=l;;){if(a=vt(a.times(e),l),r=r.times(++c),s=i.plus(Aa(a,r,l)),ia(s.d).slice(0,l)===ia(i.d).slice(0,l)){for(;u--;)i=vt(i.times(i),l);return d.precision=f,t==null?(kt=!0,vt(i,f)):i}i=s}}function Zt(e){for(var t=e.e*Nt,r=e.d[0];r>=10;r/=10)t++;return t}function Uf(e,t,r){if(t>e.LN10.sd())throw kt=!0,r&&(e.precision=r),Error(On+"LN10 precision limit exceeded");return vt(new e(e.LN10),t)}function ni(e){for(var t="";e--;)t+="0";return t}function ll(e,t){var r,n,a,i,s,l,c,u,d,f=1,h=10,p=e,x=p.d,g=p.constructor,v=g.precision;if(p.s<1)throw Error(On+(p.s?"NaN":"-Infinity"));if(p.eq(fn))return new g(0);if(t==null?(kt=!1,u=v):u=t,p.eq(10))return t==null&&(kt=!0),Uf(g,u);if(u+=h,g.precision=u,r=ia(x),n=r.charAt(0),i=Zt(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=ia(p.d),n=r.charAt(0),f++;i=Zt(p),n>1?(p=new g("0."+r),i++):p=new g(n+"."+r.slice(1))}else return c=Uf(g,u+2,v).times(i+""),p=ll(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=v,t==null?(kt=!0,vt(p,v)):p;for(l=s=p=Aa(p.minus(fn),p.plus(fn),u),d=vt(p.times(p),u),a=3;;){if(s=vt(s.times(d),u),c=l.plus(Aa(s,new g(a),u)),ia(c.d).slice(0,u)===ia(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(Uf(g,u+2,v).times(i+""))),l=Aa(l,new g(f),u),g.precision=v,t==null?(kt=!0,vt(l,v)):l;l=c,a+=2}}function fy(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=oo(r/Nt),e.d=[],n=(r+1)%Nt,r<0&&(n+=Nt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Nt;n<a;)e.d.push(+t.slice(n,n+=Nt));t=t.slice(n),n=Nt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),kt&&(e.e>ju||e.e<-ju))throw Error(lx+r)}else e.s=0,e.e=0,e.d=[0];return e}function vt(e,t,r){var n,a,i,s,l,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Nt,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Nt),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=Nt,a=n-Nt+s}if(r!==void 0&&(i=Ai(10,s-a-1),l=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/Ai(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Zt(e),f.length=1,t=t-i-1,f[0]=Ai(10,(Nt-t%Nt)%Nt),e.e=oo(-t/Nt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=Ai(10,Nt-n),f[d]=a>0?(u/Ai(10,s-a)%Ai(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==sr&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=sr)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(kt&&(e.e>ju||e.e<-ju))throw Error(lx+Zt(e));return e}function pE(e,t){var r,n,a,i,s,l,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),kt?vt(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(p/Nt),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=sr-1;--c[i],c[a]+=sr}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,kt?vt(t,p):t):new h(0)}function Yi(e,t,r){var n,a=Zt(e),i=ia(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+ni(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ni(-a-1)+i,r&&(n=r-s)>0&&(i+=ni(n))):a>=s?(i+=ni(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+ni(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=ni(n))),e.s<0?"-"+i:i}function hy(e,t){if(e.length>t)return e.length=t,!0}function mE(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Bi+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return fy(s,i.toString())}else if(typeof i!="string")throw Error(Bi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,R6.test(i))fy(s,i);else throw Error(Bi+i)}if(a.prototype=Re,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=mE,a.config=a.set=M6,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function M6(e){if(!e||typeof e!="object")throw Error(On+"Object expected");var t,r,n,a=["precision",1,so,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(oo(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Bi+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Bi+r+": "+n);return this}var cx=mE(I6);fn=new cx(1);const ft=cx;function xE(e){var t;return e===0?t=1:t=Math.floor(new ft(e).abs().log(10).toNumber())+1,t}function gE(e,t,r){for(var n=new ft(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var vE=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},bE=(e,t,r)=>{if(e.lte(0))return new ft(0);var n=xE(e.toNumber()),a=new ft(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new ft(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?new ft(c.toNumber()):new ft(Math.ceil(c.toNumber()))},F6=(e,t,r)=>{var n=new ft(1),a=new ft(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ft(10).pow(xE(e)-1),a=new ft(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ft(Math.floor(e)))}else e===0?a=new ft(Math.floor((t-1)/2)):r||(a=new ft(Math.floor(e)));for(var s=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(a.add(new ft(c-s).mul(n)).toNumber());return l},yE=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ft(0),tickMin:new ft(0),tickMax:new ft(0)};var s=bE(new ft(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new ft(0):(l=new ft(t).add(r).div(2),l=l.sub(new ft(l).mod(s)));var c=Math.ceil(l.sub(t).div(s).toNumber()),u=Math.ceil(new ft(r).sub(l).div(s).toNumber()),d=c+u+1;return d>n?yE(t,r,n,a,i+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:s,tickMin:l.sub(new ft(c).mul(s)),tickMax:l.add(new ft(u).mul(s))})},L6=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[l,c]=vE([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(a-1).fill(1/0)]:[...Array(a-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return F6(l,a,i);var{step:d,tickMin:f,tickMax:h}=yE(l,c,s,i,0),p=gE(f,h.add(new ft(.1).mul(d)),d);return r>n?p.reverse():p},B6=function(t,r){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,l]=vE([n,a]);if(s===-1/0||l===1/0)return[n,a];if(s===l)return[s];var c=Math.max(r,2),u=bE(new ft(l).sub(s).div(c-1),i,0),d=[...gE(new ft(s),new ft(l),u),l];return i===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},wE=e=>e.rootProps.maxBarSize,$6=e=>e.rootProps.barGap,NE=e=>e.rootProps.barCategoryGap,U6=e=>e.rootProps.barSize,Fl=e=>e.rootProps.stackOffset,_E=e=>e.rootProps.reverseStackOrder,ux=e=>e.options.chartName,dx=e=>e.rootProps.syncId,SE=e=>e.rootProps.syncMethod,fx=e=>e.options.eventEmitter,Xt={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},ji={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Yn={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Wd=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Vd(e,t,r){if(r!=="auto")return r;if(e!=null)return Va(e,t)?"category":"number"}function py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?py(Object(r),!0).forEach(function(n){H6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):py(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H6(e,t,r){return(t=z6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z6(e){var t=W6(e,"string");return typeof t=="symbol"?t:t+""}function W6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var my={allowDataOverflow:ji.allowDataOverflow,allowDecimals:ji.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ji.angleAxisId,includeHidden:!1,name:void 0,reversed:ji.reversed,scale:ji.scale,tick:ji.tick,tickCount:void 0,ticks:void 0,type:ji.type,unit:void 0},xy={allowDataOverflow:Yn.allowDataOverflow,allowDecimals:Yn.allowDecimals,allowDuplicatedCategory:Yn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Yn.radiusAxisId,includeHidden:Yn.includeHidden,name:void 0,reversed:Yn.reversed,scale:Yn.scale,tick:Yn.tick,tickCount:Yn.tickCount,ticks:void 0,type:Yn.type,unit:void 0},V6=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},hx=Q([V6,cS],(e,t)=>{var r;if(e!=null)return e;var n=(r=Vd(t,"angleAxis",my.type))!==null&&r!==void 0?r:"category";return Tu(Tu({},my),{},{type:n})}),K6=(e,t)=>e.polarAxis.radiusAxis[t],px=Q([K6,cS],(e,t)=>{var r;if(e!=null)return e;var n=(r=Vd(t,"radiusAxis",xy.type))!==null&&r!==void 0?r:"category";return Tu(Tu({},xy),{},{type:n})}),Kd=e=>e.polarOptions,mx=Q([Ka,Ga,tr],jS),EE=Q([Kd,mx],(e,t)=>{if(e!=null)return Ar(e.innerRadius,t,0)}),jE=Q([Kd,mx],(e,t)=>{if(e!=null)return Ar(e.outerRadius,t,t*.8)}),G6=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},TE=Q([Kd],G6);Q([hx,TE],Wd);var CE=Q([mx,EE,jE],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Q([px,CE],Wd);var kE=Q([at,Kd,EE,jE,Ka,Ga],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:c,endAngle:u}=t;return{cx:Ar(s,a,a/2),cy:Ar(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Lt=(e,t)=>t,Ll=(e,t,r)=>r;function xx(e){return e?.id}function AE(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=xx(l);u.forEach((f,h)=>{var p=i==null||a?h:String(xt(f,i,null)),x=xt(f,l.dataKey,0),g;s.has(p)?g=s.get(p):g={},Object.assign(g,{[d]:x}),s.set(p,g)})}}),Array.from(s.values())}function Gd(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Xd=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Yd(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function X6(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var fr=e=>{var t=at(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},lo=e=>e.tooltip.settings.axisId;function Y6(e){if(e in Lo)return Lo[e]();var t="scale".concat(El(e));if(t in Lo)return Lo[t]()}function gy(e){var t=e.ticks,r=e.bandwidth,n=e.range(),a=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:(function(i){function s(){return i.apply(this,arguments)}return s.toString=function(){return i.toString()},s})(()=>a),rangeMin:()=>a[0],rangeMax:()=>a[1],isInRange(i){var s=a[0],l=a[1];return s<=l?i>=s&&i<=l:i>=l&&i<=s},bandwidth:r?()=>r.call(e):void 0,ticks:t?i=>t.call(e,i):void 0,map:(i,s)=>{var l=e(i);if(l!=null){if(e.bandwidth&&s!==null&&s!==void 0&&s.position){var c=e.bandwidth();switch(s.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function vy(e,t,r){if(typeof e=="function")return gy(e.copy().domain(t).range(r));if(e!=null){var n=Y6(e);if(n!=null)return n.domain(t).range(r),gy(n)}}var PE=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!Ba(t)){for(var r,n,a=0;a<t.length;a++){var i=t[a];et(i)&&((r===void 0||i<r)&&(r=i),(n===void 0||i>n)&&(n=i))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function by(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?by(Object(r),!0).forEach(function(n){q6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):by(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q6(e,t,r){return(t=Z6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z6(e){var t=J6(e,"string");return typeof t=="symbol"?t:t+""}function J6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Np=[0,"auto"],ar={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},OE=(e,t)=>e.cartesianAxis.xAxis[t],qa=(e,t)=>{var r=OE(e,t);return r??ar},ir={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Np,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Cl},DE=(e,t)=>e.cartesianAxis.yAxis[t],Za=(e,t)=>{var r=DE(e,t);return r??ir},Q6={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},gx=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Q6},Ht=(e,t,r)=>{switch(t){case"xAxis":return qa(e,r);case"yAxis":return Za(e,r);case"zAxis":return gx(e,r);case"angleAxis":return hx(e,r);case"radiusAxis":return px(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},eM=(e,t,r)=>{switch(t){case"xAxis":return qa(e,r);case"yAxis":return Za(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},co=(e,t,r)=>{switch(t){case"xAxis":return qa(e,r);case"yAxis":return Za(e,r);case"angleAxis":return hx(e,r);case"radiusAxis":return px(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},IE=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function vx(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var qd=e=>e.graphicalItems.cartesianItems,tM=Q([Lt,Ll],vx),bx=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Bl=Q([qd,Ht,tM],bx,{memoizeOptions:{resultEqualityCheck:Yd}}),RE=Q([Bl],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Gd)),ME=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),rM=Q([Bl],ME),yx=e=>e.map(t=>t.data).filter(Boolean).flat(1),nM=Q([Bl],yx,{memoizeOptions:{resultEqualityCheck:Yd}}),wx=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Nx=Q([nM,ox],wx),_x=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:xt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:xt(a,n)}))):e.map(n=>({value:n})),Zd=Q([Nx,Ht,Bl],_x);function FE(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Lc(e){if(da(e)||e instanceof Date){var t=Number(e);if(et(t))return t}}function yy(e){if(Array.isArray(e)){var t=[Lc(e[0]),Lc(e[1])];return Ba(t)?t:void 0}var r=Lc(e);if(r!=null)return[r,r]}function $a(e){return e.map(Lc).filter(en)}function aM(e,t,r){return!r||typeof t!="number"||ua(t)?[]:r.length?$a(r.flatMap(n=>{var a=xt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!et(i)||!et(s)))return[t-i,t+s]})):[]}var nr=e=>{var t=fr(e),r=lo(e);return co(e,t,r)},$l=Q([nr],e=>e?.dataKey),iM=Q([RE,ox,nr],AE),LE=(e,t,r,n)=>{var a={},i=t.reduce((s,l)=>{if(l.stackId==null)return s;var c=s[l.stackId];return c==null&&(c=[]),c.push(l),s[l.stackId]=c,s},a);return Object.fromEntries(Object.entries(i).map(s=>{var[l,c]=s,u=n?[...c].reverse():c,d=u.map(xx);return[l,{stackedData:$O(e,d,r),graphicalItems:u}]}))},_p=Q([iM,RE,Fl,_E],LE),BE=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=VO(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},sM=Q([Ht],e=>e.allowDataOverflow),Sx=e=>{var t;if(e==null||!("domain"in e))return Np;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=$a(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Np},Ex=Q([Ht],Sx),jx=Q([Ex,sM],uE),oM=Q([_p,Ya,Lt,jx],BE,{memoizeOptions:{resultEqualityCheck:Xd}}),Jd=e=>e.errorBars,lM=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>FE(r,n)),ku=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},Tx=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>FE(a,b)),h=xt(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=aM(l,h,f);if(p.length>=2){var x=Math.min(...p),g=Math.max(...p);(i==null||x<i)&&(i=x),(s==null||g>s)&&(s=g)}var v=yy(h);v!=null&&(i=i==null?v[0]:Math.min(i,v[0]),s=s==null?v[1]:Math.max(s,v[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var c=yy(xt(l,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),s=s==null?c[1]:Math.max(s,c[1]))}),et(i)&&et(s))return[i,s]},cM=Q([Nx,Ht,rM,Jd,Lt],Tx,{memoizeOptions:{resultEqualityCheck:Xd}});function uM(e){var{value:t}=e;if(da(t)||t instanceof Date)return t}var dM=(e,t,r)=>{var n=e.map(uM).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&a_(n))?AS(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},$E=e=>e.referenceElements.dots,uo=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),fM=Q([$E,Lt,Ll],uo),UE=e=>e.referenceElements.areas,hM=Q([UE,Lt,Ll],uo),HE=e=>e.referenceElements.lines,pM=Q([HE,Lt,Ll],uo),zE=(e,t)=>{if(e!=null){var r=$a(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},mM=Q(fM,Lt,zE),WE=(e,t)=>{if(e!=null){var r=$a(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},xM=Q([hM,Lt],WE);function gM(e){var t;if(e.x!=null)return $a([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:$a(r)}function vM(e){var t;if(e.y!=null)return $a([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:$a(r)}var VE=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?gM(n):vM(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},bM=Q([pM,Lt],VE),yM=Q(mM,bM,xM,(e,t,r)=>ku(e,r,t)),Cx=(e,t,r,n,a,i,s,l)=>{if(r!=null)return r;var c=s==="vertical"&&l==="xAxis"||s==="horizontal"&&l==="yAxis",u=c?ku(n,i,a):ku(i,a);return D6(t,u,e.allowDataOverflow)},wM=Q([Ht,Ex,jx,oM,cM,yM,at,Lt],Cx,{memoizeOptions:{resultEqualityCheck:Xd}}),NM=[0,1],kx=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:c}=e,u=Va(t,i);if(u&&l==null){var d;return AS(0,(d=r?.length)!==null&&d!==void 0?d:0)}return c==="category"?dM(n,e,u):a==="expand"?NM:s}},Ax=Q([Ht,at,Nx,Zd,Fl,Lt,wM],kx);function _M(e){return e in Lo}var KE=(e,t,r)=>{if(e!=null){var{scale:n,type:a}=e;if(n==="auto")return a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":a==="category"?"band":"linear";if(typeof n=="string"){var i="scale".concat(El(n));return _M(i)?i:"point"}}},Ni=Q([Ht,IE,ux],KE);function Px(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?vy(e.scale,r,n):vy(t,r,n)}var Ox=(e,t,r)=>{var n=Sx(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Ba(e))return L6(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Ba(e))return B6(e,t.tickCount,t.allowDecimals)}},Dx=Q([Ax,co,Ni],Ox),Ix=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Ba(t)&&Array.isArray(r)&&r.length>0){var a,i,s=t[0],l=(a=r[0])!==null&&a!==void 0?a:0,c=t[1],u=(i=r[r.length-1])!==null&&i!==void 0?i:0;return[Math.min(s,l),Math.max(c,u)]}return t},SM=Q([Ht,Ax,Dx,Lt],Ix),EM=Q(Zd,Ht,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from($a(e.map(f=>f.value))).sort((f,h)=>f-h),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var s=i-a;if(s===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/s}}),GE=Q(EM,at,NE,tr,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!et(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=Ar(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),jM=(e,t,r)=>{var n=qa(e,t);return n==null||typeof n.padding!="string"?0:GE(e,"xAxis",t,r,n.padding)},TM=(e,t,r)=>{var n=Za(e,t);return n==null||typeof n.padding!="string"?0:GE(e,"yAxis",t,r,n.padding)},CM=Q(qa,jM,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),kM=Q(Za,TM,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),AM=Q([tr,CM,Pd,Ad,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),PM=Q([tr,at,kM,Pd,Ad,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ul=(e,t,r,n)=>{var a;switch(t){case"xAxis":return AM(e,r,n);case"yAxis":return PM(e,r,n);case"zAxis":return(a=gx(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return TE(e);case"radiusAxis":return CE(e,r);default:return}},XE=Q([Ht,Ul],Wd),OM=Q([Ni,SM],PE),Qd=Q([Ht,Ni,OM,XE],Px);Q([Bl,Jd,Lt],lM);function YE(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var e0=(e,t)=>t,t0=(e,t,r)=>r,DM=Q(Cd,e0,t0,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(YE)),IM=Q(kd,e0,t0,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(YE)),qE=(e,t)=>({width:e.width,height:t.height}),RM=(e,t)=>{var r=typeof t.width=="number"?t.width:Cl;return{width:r,height:e.height}},ZE=Q(tr,qa,qE),MM=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},FM=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},LM=Q(Ga,tr,DM,e0,t0,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=qE(t,l);s==null&&(s=MM(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i}),BM=Q(Ka,tr,IM,e0,t0,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=RM(t,l);s==null&&(s=FM(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i}),$M=(e,t)=>{var r=qa(e,t);if(r!=null)return LM(e,r.orientation,r.mirror)},UM=Q([tr,qa,$M,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),HM=(e,t)=>{var r=Za(e,t);if(r!=null)return BM(e,r.orientation,r.mirror)},zM=Q([tr,Za,HM,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),JE=Q(tr,Za,(e,t)=>{var r=typeof t.width=="number"?t.width:Cl;return{width:r,height:e.height}}),wy=(e,t,r)=>{switch(t){case"xAxis":return ZE(e,r).width;case"yAxis":return JE(e,r).height;default:return}},QE=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=Va(e,n),c=t.map(u=>u.value);if(s&&l&&i==="category"&&a&&a_(c))return c}},Rx=Q([at,Zd,Ht,Lt],QE),ej=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Va(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},Mx=Q([at,Zd,co,Lt],ej),Ny=Q([at,eM,Ni,Qd,Rx,Mx,Ul,Dx,Lt],(e,t,r,n,a,i,s,l,c)=>{if(t!=null){var u=Va(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:l,range:s,realScaleType:r,scale:n}}}),WM=(e,t,r,n,a,i,s,l,c)=>{if(!(t==null||n==null)){var u=Va(e,c),{type:d,ticks:f,tickCount:h}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&i!=null&&i.length>=2?lr(i[0]-i[1])*2*x:x;var g=f||a;return g?g.map((v,b)=>{var w=s?s.indexOf(v):v,y=n.map(w);return et(y)?{index:b,coordinate:y+x,value:v,offset:x}:null}).filter(en):u&&l?l.map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:v,index:b,offset:x}:null}).filter(en):n.ticks?n.ticks(h).map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:v,index:b,offset:x}:null}).filter(en):n.domain().map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:s?s[v]:v,index:b,offset:x}:null}).filter(en)}},tj=Q([at,co,Ni,Qd,Dx,Ul,Rx,Mx,Lt],WM),VM=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=Va(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&n?.length>=2?lr(n[0]-n[1])*2*u:u,l&&i?i.map((d,f)=>{var h=r.map(d);return et(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(en):r.ticks?r.ticks(c).map((d,f)=>{var h=r.map(d);return et(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(en):r.domain().map((d,f)=>{var h=r.map(d);return et(h)?{coordinate:h+u,value:a?a[d]:d,index:f,offset:u}:null}).filter(en)}},fi=Q([at,co,Qd,Ul,Rx,Mx,Lt],VM),hi=Q(Ht,Qd,(e,t)=>{if(!(e==null||t==null))return Cu(Cu({},e),{},{scale:t})}),KM=Q([Ht,Ni,Ax,XE],Px);Q((e,t,r)=>gx(e,r),KM,(e,t)=>{if(!(e==null||t==null))return Cu(Cu({},e),{},{scale:t})});var GM=Q([at,Cd,kd],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),rj=e=>e.options.defaultTooltipEventType,nj=e=>e.options.validateTooltipEventTypes;function aj(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Fx(e,t){var r=rj(e),n=nj(e);return aj(t,r,n)}function XM(e){return Fe(t=>Fx(t,e))}var ij=(e,t)=>{var r,n=Number(t);if(!(ua(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},YM=e=>e.tooltip.settings,ii={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},qM={itemInteraction:{click:ii,hover:ii},axisInteraction:{click:ii,hover:ii},keyboardInteraction:ii,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},sj=nn({name:"tooltip",initialState:qM,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:jt()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=zn(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:jt()},removeTooltipEntrySettings:{reducer(e,t){var r=zn(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:jt()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:ZM,replaceTooltipEntrySettings:JM,removeTooltipEntrySettings:QM,setTooltipSettingsState:eF,setActiveMouseOverItemIndex:oj,mouseLeaveItem:tF,mouseLeaveChart:lj,setActiveClickItemIndex:rF,setMouseOverAxisIndex:cj,setMouseClickAxisIndex:nF,setSyncInteraction:Sp,setKeyboardInteraction:Ep}=sj.actions,aF=sj.reducer;function _y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_y(Object(r),!0).forEach(function(n){iF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_y(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iF(e,t,r){return(t=sF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sF(e){var t=oF(e,"string");return typeof t=="symbol"?t:t+""}function oF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lF(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function cF(e){return e.index!=null}var uj=(e,t,r,n)=>{if(t==null)return ii;var a=lF(e,t,r);if(a==null)return ii;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(cF(a)){if(i)return fc(fc({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return fc(fc({},ii),{},{coordinate:a.coordinate})};function uF(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function dF(e,t){var r=uF(e),n=t[0],a=t[1];if(r===void 0)return!1;var i=Math.min(n,a),s=Math.max(n,a);return r>=i&&r<=s}function fF(e,t,r){if(r==null||t==null)return!0;var n=xt(e,t);return n==null||!Ba(r)?!0:dF(n,r)}var Lx=(e,t,r,n)=>{var a=e?.index;if(a==null)return null;var i=Number(a);if(!et(i))return a;var s=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(s,Math.min(i,l)),u=t[c];return u==null||fF(u,r,n)?String(c):null},dj=(e,t,r,n,a,i,s)=>{if(i!=null){var l=s[0],c=l?.getPosition(i);if(c!=null)return c;var u=a?.[Number(i)];if(u)return r==="horizontal"?{x:u.coordinate,y:(n.top+t)/2}:{x:(n.left+e)/2,y:u.coordinate}}},fj=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(s=>{var l;return((l=s.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},hj=e=>e.options.tooltipPayloadSearcher,fo=e=>e.tooltip;function Sy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ey(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sy(Object(r),!0).forEach(function(n){hF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hF(e,t,r){return(t=pF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pF(e){var t=mF(e,"string");return typeof t=="symbol"?t:t+""}function mF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xF(e,t){return e??t}var pj=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,p)=>{var x,{dataDefinedOnItem:g,settings:v}=p,b=xF(g,l),w=Array.isArray(b)?q_(b,u,d):b,y=(x=v?.dataKey)!==null&&x!==void 0?x:n,N=v?.nameKey,S;if(n&&Array.isArray(w)&&!Array.isArray(w[0])&&s==="axis"?S=i_(w,n,a):S=i(w,t,c,N),Array.isArray(S))S.forEach(_=>{var j=Ey(Ey({},v),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});h.push(E1({tooltipEntrySettings:j,dataKey:_.dataKey,payload:_.payload,value:xt(_.payload,_.dataKey),name:_.name}))});else{var E;h.push(E1({tooltipEntrySettings:v,dataKey:y,payload:S,value:xt(S,y),name:(E=xt(S,N))!==null&&E!==void 0?E:v?.name}))}return h},f)}},Bx=Q([nr,IE,ux],KE),gF=Q([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),vF=Q([fr,lo],vx),ho=Q([gF,nr,vF],bx,{memoizeOptions:{resultEqualityCheck:Yd}}),bF=Q([ho],e=>e.filter(Gd)),yF=Q([ho],yx,{memoizeOptions:{resultEqualityCheck:Yd}}),po=Q([yF,Ya],wx),wF=Q([bF,Ya,nr],AE),$x=Q([po,nr,ho],_x),mj=Q([nr],Sx),NF=Q([nr],e=>e.allowDataOverflow),xj=Q([mj,NF],uE),_F=Q([ho],e=>e.filter(Gd)),SF=Q([wF,_F,Fl,_E],LE),EF=Q([SF,Ya,fr,xj],BE),jF=Q([ho],ME),TF=Q([po,nr,jF,Jd,fr],Tx,{memoizeOptions:{resultEqualityCheck:Xd}}),CF=Q([$E,fr,lo],uo),kF=Q([CF,fr],zE),AF=Q([UE,fr,lo],uo),PF=Q([AF,fr],WE),OF=Q([HE,fr,lo],uo),DF=Q([OF,fr],VE),IF=Q([kF,DF,PF],ku),RF=Q([nr,mj,xj,EF,TF,IF,at,fr],Cx),Hl=Q([nr,at,po,$x,Fl,fr,RF],kx),MF=Q([Hl,nr,Bx],Ox),FF=Q([nr,Hl,MF,fr],Ix),gj=e=>{var t=fr(e),r=lo(e),n=!1;return Ul(e,t,r,n)},vj=Q([nr,gj],Wd),bj=Q([nr,Bx,FF,vj],Px),LF=Q([at,$x,nr,fr],QE),BF=Q([at,$x,nr,fr],ej),$F=(e,t,r,n,a,i,s,l)=>{if(t){var{type:c}=t,u=Va(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&a?.length>=2?lr(a[0]-a[1])*2*f:f,u&&s?s.map((h,p)=>{var x=n.map(h);return et(x)?{coordinate:x+f,value:h,index:p,offset:f}:null}).filter(en):n.domain().map((h,p)=>{var x=n.map(h);return et(x)?{coordinate:x+f,value:i?i[h]:h,index:p,offset:f}:null}).filter(en)}}},Ja=Q([at,nr,Bx,bj,gj,LF,BF,fr],$F),Ux=Q([rj,nj,YM],(e,t,r)=>aj(r.shared,e,t)),yj=e=>e.tooltip.settings.trigger,Hx=e=>e.tooltip.settings.defaultIndex,zl=Q([fo,Ux,yj,Hx],uj),pi=Q([zl,po,$l,Hl],Lx),wj=Q([Ja,pi],ij),zx=Q([zl],e=>{if(e)return e.dataKey}),UF=Q([zl],e=>{if(e)return e.graphicalItemId}),Nj=Q([fo,Ux,yj,Hx],fj),HF=Q([Ka,Ga,at,tr,Ja,Hx,Nj],dj),zF=Q([zl,HF],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),WF=Q([zl],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),VF=Q([Nj,pi,Ya,$l,wj,hj,Ux],pj),KF=Q([VF],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function jy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jy(Object(r),!0).forEach(function(n){GF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GF(e,t,r){return(t=XF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XF(e){var t=YF(e,"string");return typeof t=="symbol"?t:t+""}function YF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qF=()=>Fe(nr),ZF=()=>{var e=qF(),t=Fe(Ja),r=Fe(bj);return Zs(!e||!r?void 0:Ty(Ty({},e),{},{scale:r}),t)};function Cy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ws(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cy(Object(r),!0).forEach(function(n){JF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JF(e,t,r){return(t=QF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QF(e){var t=e8(e,"string");return typeof t=="symbol"?t:t+""}function e8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t8=(e,t,r,n)=>{var a=t.find(i=>i&&i.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},r8=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="centric"){var i=a.coordinate,{radius:s}=n;return ws(ws(ws({},n),Gt(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:c}=n;return ws(ws(ws({},n),Gt(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function n8(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var _j=(e,t,r,n,a)=>{var i,s=(i=t?.length)!==null&&i!==void 0?i:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<s;l++){var c,u,d,f,h,p=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[s-1])===null||u===void 0?void 0:u.coordinate,x=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=s-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(h=r[l+1])===null||h===void 0?void 0:h.coordinate,v=void 0;if(!(p==null||x==null||g==null))if(lr(x-p)!==lr(g-x)){var b=[];if(lr(g-x)===lr(a[1]-a[0])){v=g;var w=x+a[1]-a[0];b[0]=Math.min(w,(w+p)/2),b[1]=Math.max(w,(w+p)/2)}else{v=p;var y=g+a[1]-a[0];b[0]=Math.min(x,(y+x)/2),b[1]=Math.max(x,(y+x)/2)}var N=[Math.min(x,(v+x)/2),Math.max(x,(v+x)/2)];if(e>N[0]&&e<=N[1]||e>=b[0]&&e<=b[1]){var S;return(S=r[l])===null||S===void 0?void 0:S.index}}else{var E=Math.min(p,g),_=Math.max(p,g);if(e>(E+x)/2&&e<=(_+x)/2){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}}else if(t)for(var A=0;A<s;A++){var T=t[A];if(T!=null){var k=t[A+1],C=t[A-1];if(A===0&&k!=null&&e<=(T.coordinate+k.coordinate)/2||A===s-1&&C!=null&&e>(T.coordinate+C.coordinate)/2||A>0&&A<s-1&&C!=null&&k!=null&&e>(T.coordinate+C.coordinate)/2&&e<=(T.coordinate+k.coordinate)/2)return T.index}}return-1},a8=()=>Fe(ux),Wx=(e,t)=>t,Sj=(e,t,r)=>r,Vx=(e,t,r,n)=>n,i8=Q(Ja,e=>vd(e,t=>t.coordinate)),Kx=Q([fo,Wx,Sj,Vx],uj),Gx=Q([Kx,po,$l,Hl],Lx),s8=(e,t,r)=>{if(t!=null){var n=fo(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Ej=Q([fo,Wx,Sj,Vx],fj),Au=Q([Ka,Ga,at,tr,Ja,Vx,Ej],dj),o8=Q([Kx,Au],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),jj=Q([Ja,Gx],ij),l8=Q([Ej,Gx,Ya,$l,jj,hj,Wx],pj),c8=Q([Kx,Gx],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),u8=(e,t,r,n,a,i,s)=>{if(!(!e||!r||!n||!a)&&n8(e,s)){var l=KO(e,t),c=_j(l,i,a,r,n),u=t8(t,a,c,e);return{activeIndex:String(c),activeCoordinate:u}}},d8=(e,t,r,n,a,i,s)=>{if(!(!e||!n||!a||!i||!r)){var l=XD(e,r);if(l){var c=GO(l,t),u=_j(c,s,i,n,a),d=r8(t,i,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},f8=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i))return t==="horizontal"||t==="vertical"?u8(e,t,n,a,i,s,l):d8(e,t,r,n,a,i,s)},h8=Q(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),p8=Q(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Xt)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:X6}});function ky(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ay(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ky(Object(r),!0).forEach(function(n){m8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ky(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m8(e,t,r){return(t=x8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x8(e){var t=g8(e,"string");return typeof t=="symbol"?t:t+""}function g8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v8={},b8={zIndexMap:Object.values(Xt).reduce((e,t)=>Ay(Ay({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),v8)},y8=new Set(Object.values(Xt));function w8(e){return y8.has(e)}var Tj=nn({name:"zIndex",initialState:b8,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:jt()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!w8(r)&&delete e.zIndexMap[r])},prepare:jt()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:jt()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:jt()}}}),{registerZIndexPortal:N8,unregisterZIndexPortal:_8,registerZIndexPortalElement:S8,unregisterZIndexPortalElement:E8}=Tj.actions,j8=Tj.reducer;function an(e){var{zIndex:t,children:r}=e,n=_3(),a=n&&t!==void 0&&t!==0,i=Ir(),s=Ot();m.useLayoutEffect(()=>a?(s(N8({zIndex:t})),()=>{s(_8({zIndex:t}))}):ss,[s,t,a]);var l=Fe(c=>h8(c,t,i));return a?l?CN.createPortal(r,l):null:r}function jp(){return jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jp.apply(null,arguments)}function Py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Py(Object(r),!0).forEach(function(n){T8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Py(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T8(e,t,r){return(t=C8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C8(e){var t=k8(e,"string");return typeof t=="symbol"?t:t+""}function k8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A8(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return m.isValidElement(t)?m.cloneElement(t,n):m.createElement(r,n)}function P8(e){var t,{coordinate:r,payload:n,index:a,offset:i,tooltipAxisBandSize:s,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,h=n,p=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var x,g,v;if(d==="ScatterChart")x=f,g=lD,v=Xt.cursorLine;else if(d==="BarChart")x=cD(l,f,i,s),g=ES,v=Xt.cursorRectangle;else if(l==="radial"&&l_(f)){var{cx:b,cy:w,radius:y,startAngle:N,endAngle:S}=TS(f);x={cx:b,cy:w,startAngle:N,endAngle:S,innerRadius:y,outerRadius:y},g=kS,v=Xt.cursorLine}else x={points:JD(l,f,i)},g=Fm,v=Xt.cursorLine;var E=typeof c=="object"&&"className"in c?c.className:void 0,_=hc(hc(hc(hc({stroke:"#ccc",pointerEvents:"none"},i),x),Hi(c)),{},{payload:h,payloadIndex:p,className:lt("recharts-tooltip-cursor",E)});return m.createElement(an,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:v},m.createElement(A8,{cursor:c,cursorComp:g,cursorProps:_}))}function O8(e){var t=ZF(),r=iS(),n=os(),a=a8();return t==null||r==null||n==null||a==null?null:m.createElement(P8,jp({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var Cj=m.createContext(null),D8=()=>m.useContext(Cj),Hf={exports:{}},Oy;function I8(){return Oy||(Oy=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||c,h),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,x=new Array(p);h<p;h++)x[h]=f[h].fn;return x},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,p,x){var g=r?r+u:u;if(!this._events[g])return!1;var v=this._events[g],b=arguments.length,w,y;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),b){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,h),!0;case 5:return v.fn.call(v.context,d,f,h,p),!0;case 6:return v.fn.call(v.context,d,f,h,p,x),!0}for(y=1,w=new Array(b-1);y<b;y++)w[y-1]=arguments[y];v.fn.apply(v.context,w)}else{var N=v.length,S;for(y=0;y<N;y++)switch(v[y].once&&this.removeListener(u,v[y].fn,void 0,!0),b){case 1:v[y].fn.call(v[y].context);break;case 2:v[y].fn.call(v[y].context,d);break;case 3:v[y].fn.call(v[y].context,d,f);break;case 4:v[y].fn.call(v[y].context,d,f,h);break;default:if(!w)for(S=1,w=new Array(b-1);S<b;S++)w[S-1]=arguments[S];v[y].fn.apply(v[y].context,w)}}return!0},l.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return s(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!h||x.once)&&(!f||x.context===f)&&s(this,p);else{for(var g=0,v=[],b=x.length;g<b;g++)(x[g].fn!==d||h&&!x[g].once||f&&x[g].context!==f)&&v.push(x[g]);v.length?this._events[p]=v.length===1?v[0]:v:s(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Hf)),Hf.exports}var R8=I8();const M8=bi(R8);var cl=new M8,Tp="recharts.syncEvent.tooltip",Dy="recharts.syncEvent.brush",Xx=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!ua(r))return e[r]}},F8={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},kj=nn({name:"options",initialState:F8,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),L8=kj.reducer,{createEventEmitter:B8}=kj.actions;function $8(e){return e.tooltip.syncInteraction}var U8={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Aj=nn({name:"chartData",initialState:U8,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Iy,setDataStartEndIndexes:H8,setComputedData:Nre}=Aj.actions,z8=Aj.reducer,W8=["x","y"];function Ry(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ry(Object(r),!0).forEach(function(n){V8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ry(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V8(e,t,r){return(t=K8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K8(e){var t=G8(e,"string");return typeof t=="symbol"?t:t+""}function G8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X8(e,t){if(e==null)return{};var r,n,a=Y8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Y8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function q8(){var e=Fe(dx),t=Fe(fx),r=Ot(),n=Fe(SE),a=Fe(Ja),i=os(),s=Od(),l=Fe(c=>c.rootProps.className);m.useEffect(()=>{if(e==null)return ss;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(s&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x,y:g}=p,v=X8(p,W8),{x:b,y:w,width:y,height:N}=d.payload.sourceViewBox,S=Ns(Ns({},v),{},{x:s.x+(y?(x-b)/y:0)*s.width,y:s.y+(N?(g-w)/N:0)*s.height});r(Ns(Ns({},d),{},{payload:Ns(Ns({},d.payload),{},{coordinate:S})}))}else r(d);return}if(a!=null){var E;if(typeof n=="function"){var _={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},j=n(a,_);E=a[j]}else n==="value"&&(E=a.find(X=>String(X.value)===d.payload.label));var{coordinate:A}=d.payload;if(E==null||d.payload.active===!1||A==null||s==null){r(Sp({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:T,y:k}=A,C=Math.min(T,s.x+s.width),L=Math.min(k,s.y+s.height),G={x:i==="horizontal"?E.coordinate:C,y:i==="horizontal"?L:E.coordinate},V=Sp({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(E.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(V)}}};return cl.on(Tp,c),()=>{cl.off(Tp,c)}},[l,r,t,e,n,a,i,s])}function Z8(){var e=Fe(dx),t=Fe(fx),r=Ot();m.useEffect(()=>{if(e==null)return ss;var n=(a,i,s)=>{t!==s&&e===a&&r(H8(i))};return cl.on(Dy,n),()=>{cl.off(Dy,n)}},[r,t,e])}function J8(){var e=Ot();m.useEffect(()=>{e(B8())},[e]),q8(),Z8()}function Q8(e,t,r,n,a,i){var s=Fe(p=>s8(p,e,t)),l=Fe(fx),c=Fe(dx),u=Fe(SE),d=Fe($8),f=d?.active,h=Od();m.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=Sp({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:h,graphicalItemId:void 0});cl.emit(Tp,c,p,l)}},[f,r,s,a,n,l,c,u,i,h])}function My(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?My(Object(r),!0).forEach(function(n){eL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):My(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eL(e,t,r){return(t=tL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tL(e){var t=rL(e,"string");return typeof t=="symbol"?t:t+""}function rL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nL(e){return e.dataKey}function aL(e,t){return m.isValidElement(e)?m.cloneElement(e,t):typeof e=="function"?m.createElement(e,t):m.createElement(U3,t)}var Ly=[],iL={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Yx(e){var t,r,n=ur(e,iL),{active:a,allowEscapeViewBox:i,animationDuration:s,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:h,position:p,reverseDirection:x,useTranslate3d:g,wrapperStyle:v,cursor:b,shared:w,trigger:y,defaultIndex:N,portal:S,axisId:E}=n,_=Ot(),j=typeof N=="number"?String(N):N;m.useEffect(()=>{_(eF({shared:w,trigger:y,axisId:E,active:a,defaultIndex:j}))},[_,w,y,E,a,j]);var A=Od(),T=yS(),k=XM(w),{activeIndex:C,isActive:L}=(t=Fe(fe=>c8(fe,k,y,j)))!==null&&t!==void 0?t:{},G=Fe(fe=>l8(fe,k,y,j)),V=Fe(fe=>jj(fe,k,y,j)),X=Fe(fe=>o8(fe,k,y,j)),K=G,Y=D8(),q=(r=a??L)!==null&&r!==void 0?r:!1,[Z,le]=PP([K,q]),ce=k==="axis"?V:void 0;Q8(k,y,X,ce,C,q);var me=S??Y;if(me==null||A==null||k==null)return null;var Ne=K??Ly;q||(Ne=Ly),u&&Ne.length&&(Ne=nP(Ne.filter(fe=>fe.value!=null&&(fe.hide!==!0||n.includeHidden)),h,nL));var ee=Ne.length>0,oe=m.createElement(X3,{allowEscapeViewBox:i,animationDuration:s,animationEasing:l,isAnimationActive:d,active:q,coordinate:X,hasPayload:ee,offset:f,position:p,reverseDirection:x,useTranslate3d:g,viewBox:A,wrapperStyle:v,lastBoundingBox:Z,innerRef:le,hasPortalFromProps:!!S},aL(c,Fy(Fy({},n),{},{payload:Ne,label:ce,active:q,activeIndex:C,coordinate:X,accessibilityLayer:T})));return m.createElement(m.Fragment,null,CN.createPortal(oe,me),q&&m.createElement(O8,{cursor:b,tooltipEventType:k,coordinate:X,payload:Ne,index:C}))}var Wl=e=>null;Wl.displayName="Cell";function sL(e,t,r){return(t=oL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oL(e){var t=lL(e,"string");return typeof t=="symbol"?t:t+""}function lL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class cL{constructor(t){sL(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function By(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?By(Object(r),!0).forEach(function(n){dL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):By(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dL(e,t,r){return(t=fL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fL(e){var t=hL(e,"string");return typeof t=="symbol"?t:t+""}function hL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pL={cacheSize:2e3,enableCache:!0},Pj=uL({},pL),$y=new cL(Pj.cacheSize),mL={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Uy="recharts_measurement_span";function xL(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l)}var Hy=(e,t)=>{try{var r=document.getElementById(Uy);r||(r=document.createElement("span"),r.setAttribute("id",Uy),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,mL,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ho=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Md.isSsr)return{width:0,height:0};if(!Pj.enableCache)return Hy(t,r);var n=xL(t,r),a=$y.get(n);if(a)return a;var i=Hy(t,r);return $y.set(n,i),i},Oj;function gL(e,t,r){return(t=vL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vL(e){var t=bL(e,"string");return typeof t=="symbol"?t:t+""}function bL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Wy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yL=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,wL=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,NL={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},_L=["cm","mm","pt","pc","in","Q","px"];function SL(e){return _L.includes(e)}var Ms="NaN";function EL(e,t){return e*NL[t]}class mr{static parse(t){var r,[,n,a]=(r=wL.exec(t))!==null&&r!==void 0?r:[];return n==null?mr.NaN:new mr(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ua(t)&&(this.unit=""),r!==""&&!yL.test(r)&&(this.num=NaN,this.unit=""),SL(r)&&(this.num=EL(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new mr(NaN,""):new mr(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new mr(NaN,""):new mr(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new mr(NaN,""):new mr(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new mr(NaN,""):new mr(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ua(this.num)}}Oj=mr;gL(mr,"NaN",new Oj(NaN,""));function Dj(e){if(e==null||e.includes(Ms))return Ms;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=zy.exec(t))!==null&&r!==void 0?r:[],s=mr.parse(n??""),l=mr.parse(i??""),c=a==="*"?s.multiply(l):s.divide(l);if(c.isNaN())return Ms;t=t.replace(zy,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=Wy.exec(t))!==null&&u!==void 0?u:[],p=mr.parse(d??""),x=mr.parse(h??""),g=f==="+"?p.add(x):p.subtract(x);if(g.isNaN())return Ms;t=t.replace(Wy,g.toString())}return t}var Vy=/\(([^()]*)\)/;function jL(e){for(var t=e,r;(r=Vy.exec(t))!=null;){var[,n]=r;t=t.replace(Vy,Dj(n))}return t}function TL(e){var t=e.replace(/\s+/g,"");return t=jL(t),t=Dj(t),t}function CL(e){try{return TL(e)}catch{return Ms}}function zf(e){var t=CL(e.slice(5,-1));return t===Ms?"":t}var kL=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],AL=["dx","dy","angle","className","breakAll"];function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(null,arguments)}function Ky(e,t){if(e==null)return{};var r,n,a=PL(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PL(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ij=/[ \f\n\r\t\v\u2028\u2029]+/,Rj=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Ft(t)||(r?a=t.toString().split(""):a=t.toString().split(Ij));var i=a.map(l=>({word:l,width:Ho(l,n).width})),s=r?0:Ho(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}};function OL(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var Mj=(e,t,r,n)=>e.reduce((a,i)=>{var{word:s,width:l}=i,c=a[a.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(s),c.width+=l+r;else{var u={words:[s],width:l};a.push(u)}return a},[]),Fj=e=>e.reduce((t,r)=>t.width>r.width?t:r),DL="…",Gy=(e,t,r,n,a,i,s,l)=>{var c=e.slice(0,t),u=Rj({breakAll:r,style:n,children:c+DL});if(!u)return[!1,[]];var d=Mj(u.wordsWithComputedWidth,i,s,l),f=d.length>a||Fj(d).width>Number(i);return[f,d]},IL=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:c}=e,u=Ie(i),d=String(s),f=Mj(t,n,r,a);if(!u||a)return f;var h=f.length>i||Fj(f).width>Number(n);if(!h)return f;for(var p=0,x=d.length-1,g=0,v;p<=x&&g<=d.length-1;){var b=Math.floor((p+x)/2),w=b-1,[y,N]=Gy(d,w,c,l,i,n,r,a),[S]=Gy(d,b,c,l,i,n,r,a);if(!y&&!S&&(p=b+1),y&&S&&(x=b-1),!y&&S){v=N;break}g++}return v||f},Xy=e=>{var t=Ft(e)?[]:e.toString().split(Ij);return[{words:t,width:void 0}]},RL=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!Md.isSsr){var l,c,u=Rj({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return Xy(n);return IL({breakAll:i,children:n,maxLines:s,style:a},l,c,t,!!r)}return Xy(n)},Lj="#808080",ML={angle:0,breakAll:!1,capHeight:"0.71em",fill:Lj,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},r0=m.forwardRef((e,t)=>{var r=ur(e,ML),{x:n,y:a,lineHeight:i,capHeight:s,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=Ky(r,kL),h=m.useMemo(()=>RL({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:p,dy:x,angle:g,className:v,breakAll:b}=f,w=Ky(f,AL);if(!da(n)||!da(a)||h.length===0)return null;var y=Number(n)+(Ie(p)?p:0),N=Number(a)+(Ie(x)?x:0);if(!et(y)||!et(N))return null;var S;switch(d){case"start":S=zf("calc(".concat(s,")"));break;case"middle":S=zf("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(s," / 2))"));break;default:S=zf("calc(".concat(h.length-1," * -").concat(i,")"));break}var E=[],_=h[0];if(c&&_!=null){var j=_.width,{width:A}=f;E.push("scale(".concat(Ie(A)&&Ie(j)?A/j:1,")"))}return g&&E.push("rotate(".concat(g,", ").concat(y,", ").concat(N,")")),E.length&&(w.transform=E.join(" ")),m.createElement("text",Cp({},Gr(w),{ref:t,x:y,y:N,className:lt("recharts-text",v),textAnchor:u,fill:l.includes("url")?Lj:l}),h.map((T,k)=>{var C=T.words.join(b?"":" ");return m.createElement("tspan",{x:y,dy:k===0?S:i,key:"".concat(C,"-").concat(k)},C)}))});r0.displayName="Text";function Yy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yy(Object(r),!0).forEach(function(n){FL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FL(e,t,r){return(t=LL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LL(e){var t=BL(e,"string");return typeof t=="symbol"?t:t+""}function BL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $L=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:a}=e,{x:i,y:s,height:l,upperWidth:c,lowerWidth:u}=Im(t),d=i,f=i+(c-u)/2,h=(d+f)/2,p=(c+u)/2,x=d+c/2,g=l>=0?1:-1,v=g*n,b=g>0?"end":"start",w=g>0?"start":"end",y=c>=0?1:-1,N=y*n,S=y>0?"end":"start",E=y>0?"start":"end",_=a;if(r==="top"){var j={x:d+c/2,y:s-v,horizontalAnchor:"middle",verticalAnchor:b};return _&&(j.height=Math.max(s-_.y,0),j.width=c),j}if(r==="bottom"){var A={x:f+u/2,y:s+l+v,horizontalAnchor:"middle",verticalAnchor:w};return _&&(A.height=Math.max(_.y+_.height-(s+l),0),A.width=u),A}if(r==="left"){var T={x:h-N,y:s+l/2,horizontalAnchor:S,verticalAnchor:"middle"};return _&&(T.width=Math.max(T.x-_.x,0),T.height=l),T}if(r==="right"){var k={x:h+p+N,y:s+l/2,horizontalAnchor:E,verticalAnchor:"middle"};return _&&(k.width=Math.max(_.x+_.width-k.x,0),k.height=l),k}var C=_?{width:p,height:l}:{};return r==="insideLeft"?qn({x:h+N,y:s+l/2,horizontalAnchor:E,verticalAnchor:"middle"},C):r==="insideRight"?qn({x:h+p-N,y:s+l/2,horizontalAnchor:S,verticalAnchor:"middle"},C):r==="insideTop"?qn({x:d+c/2,y:s+v,horizontalAnchor:"middle",verticalAnchor:w},C):r==="insideBottom"?qn({x:f+u/2,y:s+l-v,horizontalAnchor:"middle",verticalAnchor:b},C):r==="insideTopLeft"?qn({x:d+N,y:s+v,horizontalAnchor:E,verticalAnchor:w},C):r==="insideTopRight"?qn({x:d+c-N,y:s+v,horizontalAnchor:S,verticalAnchor:w},C):r==="insideBottomLeft"?qn({x:f+N,y:s+l-v,horizontalAnchor:E,verticalAnchor:b},C):r==="insideBottomRight"?qn({x:f+u-N,y:s+l-v,horizontalAnchor:S,verticalAnchor:b},C):r&&typeof r=="object"&&(Ie(r.x)||Vi(r.x))&&(Ie(r.y)||Vi(r.y))?qn({x:i+Ar(r.x,p),y:s+Ar(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},C):qn({x,y:s+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},C)},UL=["labelRef"],HL=["content"];function qy(e,t){if(e==null)return{};var r,n,a=zL(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zL(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Zy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zy(Object(r),!0).forEach(function(n){WL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WL(e,t,r){return(t=VL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VL(e){var t=KL(e,"string");return typeof t=="symbol"?t:t+""}function KL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return _a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_a.apply(null,arguments)}var Bj=m.createContext(null),GL=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s,children:l}=e,c=m.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s}),[t,r,n,a,i,s]);return m.createElement(Bj.Provider,{value:c},l)},$j=()=>{var e=m.useContext(Bj),t=Od();return e||(t?Im(t):void 0)},XL=m.createContext(null),YL=()=>{var e=m.useContext(XL),t=Fe(kE);return e||t},qL=e=>{var{value:t,formatter:r}=e,n=Ft(e.children)?t:e.children;return typeof r=="function"?r(n):n},qx=e=>e!=null&&typeof e=="function",ZL=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},JL=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:p}=a,x=(u+d)/2,g=ZL(f,h),v=g>=0?1:-1,b,w;switch(t){case"insideStart":b=f+v*i,w=p;break;case"insideEnd":b=h-v*i,w=!p;break;case"end":b=h+v*i,w=p;break;default:throw new Error("Unsupported position ".concat(t))}w=g<=0?w:!w;var y=Gt(l,c,x,b),N=Gt(l,c,x,b+(w?1:-1)*359),S="M".concat(y.x,",").concat(y.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(w?0:1,`,
    `).concat(N.x,",").concat(N.y),E=Ft(e.id)?qo("recharts-radial-line-"):e.id;return m.createElement("text",_a({},n,{dominantBaseline:"central",className:lt("recharts-radial-bar-label",s)}),m.createElement("defs",null,m.createElement("path",{id:E,d:S})),m.createElement("textPath",{xlinkHref:"#".concat(E)},r))},QL=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=Gt(n,a,s+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(i+s)/2,{x:p,y:x}=Gt(n,a,h,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},Bc=e=>e!=null&&"cx"in e&&Ie(e.cx),e7={angle:0,offset:5,zIndex:Xt.label,position:"middle",textBreakAll:!1};function t7(e){if(!Bc(e))return e;var{cx:t,cy:r,outerRadius:n}=e,a=n*2;return{x:t-n,y:r-n,width:a,upperWidth:a,lowerWidth:a,height:a}}function ai(e){var t=ur(e,e7),{viewBox:r,parentViewBox:n,position:a,value:i,children:s,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=YL(),h=$j(),p=a==="center"?h:f??h,x,g,v;r==null?x=p:Bc(r)?x=r:x=Im(r);var b=t7(x);if(!x||Ft(i)&&Ft(s)&&!m.isValidElement(l)&&typeof l!="function")return null;var w=Bo(Bo({},t),{},{viewBox:x});if(m.isValidElement(l)){var{labelRef:y}=w,N=qy(w,UL);return m.cloneElement(l,N)}if(typeof l=="function"){var{content:S}=w,E=qy(w,HL);if(g=m.createElement(l,E),m.isValidElement(g))return g}else g=qL(t);var _=Gr(t);if(Bc(x)){if(a==="insideStart"||a==="insideEnd"||a==="end")return JL(t,a,g,_,x);v=QL(x,t.offset,t.position)}else{if(!b)return null;var j=$L({viewBox:b,position:a,offset:t.offset,parentViewBox:Bc(n)?void 0:n});v=Bo(Bo({x:j.x,y:j.y,textAnchor:j.horizontalAnchor,verticalAnchor:j.verticalAnchor},j.width!==void 0?{width:j.width}:{}),j.height!==void 0?{height:j.height}:{})}return m.createElement(an,{zIndex:t.zIndex},m.createElement(r0,_a({ref:d,className:lt("recharts-label",c)},_,v,{textAnchor:OL(_.textAnchor)?_.textAnchor:v.textAnchor,breakAll:u}),g))}ai.displayName="Label";var r7=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?m.createElement(ai,_a({key:"label-implicit"},n)):da(e)?m.createElement(ai,_a({key:"label-implicit",value:e},n)):m.isValidElement(e)?e.type===ai?m.cloneElement(e,Bo({key:"label-implicit"},n)):m.createElement(ai,_a({key:"label-implicit",content:e},n)):qx(e)?m.createElement(ai,_a({key:"label-implicit",content:e},n)):e&&typeof e=="object"?m.createElement(ai,_a({},e,{key:"label-implicit"},n)):null};function n7(e){var{label:t,labelRef:r}=e,n=$j();return r7(t,n,r)||null}var Wf={},Vf={},Jy;function a7(){return Jy||(Jy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Vf)),Vf}var Kf={},Qy;function i7(){return Qy||(Qy=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Kf)),Kf}var ew;function s7(){return ew||(ew=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a7(),r=i7(),n=Nm();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Wf)),Wf}var Gf,tw;function o7(){return tw||(tw=1,Gf=s7().last),Gf}var l7=o7();const c7=bi(l7);var u7=["valueAccessor"],d7=["dataKey","clockWise","id","textBreakAll","zIndex"];function Pu(){return Pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pu.apply(null,arguments)}function rw(e,t){if(e==null)return{};var r,n,a=f7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function f7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h7=e=>Array.isArray(e.value)?c7(e.value):e.value,Uj=m.createContext(void 0),Hj=Uj.Provider,zj=m.createContext(void 0),p7=zj.Provider;function m7(){return m.useContext(Uj)}function x7(){return m.useContext(zj)}function $c(e){var{valueAccessor:t=h7}=e,r=rw(e,u7),{dataKey:n,clockWise:a,id:i,textBreakAll:s,zIndex:l}=r,c=rw(r,d7),u=m7(),d=x7(),f=u||d;return!f||!f.length?null:m.createElement(an,{zIndex:l??Xt.label},m.createElement(cr,{className:"recharts-label-list"},f.map((h,p)=>{var x,g=Ft(n)?t(h,p):xt(h.payload,n),v=Ft(i)?{}:{id:"".concat(i,"-").concat(p)};return m.createElement(ai,Pu({key:"label-".concat(p)},Gr(h),c,v,{fill:(x=r.fill)!==null&&x!==void 0?x:h.fill,parentViewBox:h.parentViewBox,value:g,textBreakAll:s,viewBox:h.viewBox,index:p,zIndex:0}))})))}$c.displayName="LabelList";function Zx(e){var{label:t}=e;return t?t===!0?m.createElement($c,{key:"labelList-implicit"}):m.isValidElement(t)||qx(t)?m.createElement($c,{key:"labelList-implicit",content:t}):typeof t=="object"?m.createElement($c,Pu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function kp(){return kp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kp.apply(null,arguments)}var Wj=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=lt("recharts-dot",a);return Ie(t)&&Ie(r)&&Ie(n)?m.createElement("circle",kp({},xn(e),wm(e),{className:i,cx:t,cy:r,r:n})):null},Vj=e=>e.graphicalItems.polarItems,g7=Q([Lt,Ll],vx),n0=Q([Vj,Ht,g7],bx),v7=Q([n0],yx),a0=Q([v7,zd],wx),b7=Q([a0,Ht,n0],_x);Q([a0,Ht,n0],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=xt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:xt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var nw=()=>{},y7=Q([a0,Ht,n0,Jd,Lt],Tx),w7=Q([Ht,Ex,jx,nw,y7,nw,at,Lt],Cx),Kj=Q([Ht,at,a0,b7,Fl,Lt,w7],kx),N7=Q([Kj,co,Ni],Ox),_7=Q([Ht,Kj,N7,Lt],Ix);Q([Ni,_7],PE);var S7={radiusAxis:{},angleAxis:{}},Gj=nn({name:"polarAxis",initialState:S7,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:_re,removeRadiusAxis:Sre,addAngleAxis:Ere,removeAngleAxis:jre}=Gj.actions,E7=Gj.reducer;function Xj(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aw(Object(r),!0).forEach(function(n){j7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j7(e,t,r){return(t=T7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T7(e){var t=C7(e,"string");return typeof t=="symbol"?t:t+""}function C7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k7=(e,t)=>t,Jx=Q([Vj,k7],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),A7=[],Qx=(e,t,r)=>r?.length===0?A7:r,Yj=Q([zd,Jx,Qx],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>iw(iw({},t.presentationProps),i.props))),a!=null)return a}}),P7=Q([Yj,Jx,Qx],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=xt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:ao(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),O7=Q([Yj,Jx,Qx,tr],(e,t,r,n)=>{if(!(t==null||e==null))return D9({offset:n,pieSettings:t,displayedData:e,cells:r})}),Xf={exports:{}},pt={};var sw;function D7(){if(sw)return pt;sw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.view_transition"),p=Symbol.for("react.client.reference");function x(g){if(typeof g=="object"&&g!==null){var v=g.$$typeof;switch(v){case e:switch(g=g.type,g){case r:case a:case n:case c:case u:case h:return g;default:switch(g=g&&g.$$typeof,g){case s:case l:case f:case d:return g;case i:return g;default:return v}}case t:return v}}}return pt.ContextConsumer=i,pt.ContextProvider=s,pt.Element=e,pt.ForwardRef=l,pt.Fragment=r,pt.Lazy=f,pt.Memo=d,pt.Portal=t,pt.Profiler=a,pt.StrictMode=n,pt.Suspense=c,pt.SuspenseList=u,pt.isContextConsumer=function(g){return x(g)===i},pt.isContextProvider=function(g){return x(g)===s},pt.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},pt.isForwardRef=function(g){return x(g)===l},pt.isFragment=function(g){return x(g)===r},pt.isLazy=function(g){return x(g)===f},pt.isMemo=function(g){return x(g)===d},pt.isPortal=function(g){return x(g)===t},pt.isProfiler=function(g){return x(g)===a},pt.isStrictMode=function(g){return x(g)===n},pt.isSuspense=function(g){return x(g)===c},pt.isSuspenseList=function(g){return x(g)===u},pt.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===c||g===u||typeof g=="object"&&g!==null&&(g.$$typeof===f||g.$$typeof===d||g.$$typeof===s||g.$$typeof===i||g.$$typeof===l||g.$$typeof===p||g.getModuleId!==void 0)},pt.typeOf=x,pt}var ow;function I7(){return ow||(ow=1,Xf.exports=D7()),Xf.exports}var R7=I7(),lw=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",cw=null,Yf=null,qj=e=>{if(e===cw&&Array.isArray(Yf))return Yf;var t=[];return m.Children.forEach(e,r=>{Ft(r)||(R7.isFragment(r)?t=t.concat(qj(r.props.children)):t.push(r))}),Yf=t,cw=e,t};function eg(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>lw(a)):n=[lw(t)],qj(e).forEach(a=>{var i=Wi(a,"type.displayName")||Wi(a,"type.name");i&&n.indexOf(i)!==-1&&r.push(a)}),r}var Zj=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,qf={},uw;function M7(){return uw||(uw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(qf)),qf}var Zf,dw;function F7(){return dw||(dw=1,Zf=M7().isPlainObject),Zf}var L7=F7();const B7=bi(L7);var fw,hw,pw,mw,xw;function gw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gw(Object(r),!0).forEach(function(n){$7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $7(e,t,r){return(t=U7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U7(e){var t=H7(e,"string");return typeof t=="symbol"?t:t+""}function H7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ou(){return Ou=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ou.apply(null,arguments)}function Do(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var bw=(e,t,r,n,a)=>{var i=r-n,s;return s=$t(fw||(fw=Do(["M ",",",""])),e,t),s+=$t(hw||(hw=Do(["L ",",",""])),e+r,t),s+=$t(pw||(pw=Do(["L ",",",""])),e+r-i/2,t+a),s+=$t(mw||(mw=Do(["L ",",",""])),e+r-i/2-n,t+a),s+=$t(xw||(xw=Do(["L ",","," Z"])),e,t),s},z7={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},W7=e=>{var t=ur(e,z7),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,h=m.useRef(null),[p,x]=m.useState(-1),g=m.useRef(a),v=m.useRef(i),b=m.useRef(s),w=m.useRef(r),y=m.useRef(n),N=Ol(e,"trapezoid-");if(m.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var G=h.current.getTotalLength();G&&x(G)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var S=lt("recharts-trapezoid",l);if(!f)return m.createElement("g",null,m.createElement("path",Ou({},Gr(t),{className:S,d:bw(r,n,a,i,s)})));var E=g.current,_=v.current,j=b.current,A=w.current,T=y.current,k="0px ".concat(p===-1?1:p,"px"),C="".concat(p,"px 0px"),L=wS(["strokeDasharray"],u,c);return m.createElement(Pl,{animationId:N,key:N,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},G=>{var V=Tt(E,a,G),X=Tt(_,i,G),K=Tt(j,s,G),Y=Tt(A,r,G),q=Tt(T,n,G);h.current&&(g.current=V,v.current=X,b.current=K,w.current=Y,y.current=q);var Z=G>0?{transition:L,strokeDasharray:C}:{strokeDasharray:k};return m.createElement("path",Ou({},Gr(t),{className:S,d:bw(Y,q,V,X,K),ref:h,style:vw(vw({},Z),t.style)}))})},V7=["option","shapeType","activeClassName"];function K7(e,t){if(e==null)return{};var r,n,a=G7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function G7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Du(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yw(Object(r),!0).forEach(function(n){X7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X7(e,t,r){return(t=Y7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y7(e){var t=q7(e,"string");return typeof t=="symbol"?t:t+""}function q7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z7(e,t){return Du(Du({},t),e)}function J7(e,t){return e==="symbols"}function ww(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return m.createElement(ES,r);case"trapezoid":return m.createElement(W7,r);case"sector":return m.createElement(kS,r);case"symbols":if(J7(t))return m.createElement(o_,r);break;case"curve":return m.createElement(Fm,r);default:return null}}function Q7(e){return m.isValidElement(e)?e.props:e}function tg(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=K7(e,V7),i;if(m.isValidElement(t))i=m.cloneElement(t,Du(Du({},a),Q7(t)));else if(typeof t=="function")i=t(a,a.index);else if(B7(t)&&typeof t!="boolean"){var s=Z7(t,a);i=m.createElement(ww,{shapeType:r,elementProps:s})}else{var l=a;i=m.createElement(ww,{shapeType:r,elementProps:l})}return a.isActive?m.createElement(cr,{className:n},i):i}var rg=(e,t,r)=>{var n=Ot();return(a,i)=>s=>{e?.(a,i,s),n(oj({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},ng=e=>{var t=Ot();return(r,n)=>a=>{e?.(r,n,a),t(tF())}},ag=(e,t,r)=>{var n=Ot();return(a,i)=>s=>{e?.(a,i,s),n(rF({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function ig(e){var{tooltipEntrySettings:t}=e,r=Ot(),n=Ir(),a=m.useRef(null);return m.useLayoutEffect(()=>{n||(a.current===null?r(ZM(t)):a.current!==t&&r(JM({prev:a.current,next:t})),a.current=t)},[t,r,n]),m.useLayoutEffect(()=>()=>{a.current&&(r(QM(a.current)),a.current=null)},[r]),null}function Jj(e){var{legendPayload:t}=e,r=Ot(),n=Ir(),a=m.useRef(null);return m.useLayoutEffect(()=>{n||(a.current===null?r(gS(t)):a.current!==t&&r(vS({prev:a.current,next:t})),a.current=t)},[r,n,t]),m.useLayoutEffect(()=>()=>{a.current&&(r(bS(a.current)),a.current=null)},[r]),null}function e9(e){var{legendPayload:t}=e,r=Ot(),n=Fe(at),a=m.useRef(null);return m.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(gS(t)):a.current!==t&&r(vS({prev:a.current,next:t})),a.current=t)},[r,n,t]),m.useLayoutEffect(()=>()=>{a.current&&(r(bS(a.current)),a.current=null)},[r]),null}var Jf,t9=()=>{var[e]=m.useState(()=>qo("uid-"));return e},r9=(Jf=W4.useId)!==null&&Jf!==void 0?Jf:t9;function n9(e,t){var r=r9();return t||(e?"".concat(e,"-").concat(r):r)}var a9=m.createContext(void 0),sg=e=>{var{id:t,type:r,children:n}=e,a=n9("recharts-".concat(r),t);return m.createElement(a9.Provider,{value:a},n(a))},i9={cartesianItems:[],polarItems:[]},Qj=nn({name:"graphicalItems",initialState:i9,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:jt()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=zn(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:jt()},removeCartesianGraphicalItem:{reducer(e,t){var r=zn(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:jt()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:jt()},removePolarGraphicalItem:{reducer(e,t){var r=zn(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:jt()}}}),{addCartesianGraphicalItem:s9,replaceCartesianGraphicalItem:o9,removeCartesianGraphicalItem:l9,addPolarGraphicalItem:c9,removePolarGraphicalItem:u9}=Qj.actions,d9=Qj.reducer,f9=e=>{var t=Ot(),r=m.useRef(null);return m.useLayoutEffect(()=>{r.current===null?t(s9(e)):r.current!==e&&t(o9({prev:r.current,next:e})),r.current=e},[t,e]),m.useLayoutEffect(()=>()=>{r.current&&(t(l9(r.current)),r.current=null)},[t]),null},e5=m.memo(f9);function h9(e){var t=Ot();return m.useLayoutEffect(()=>(t(c9(e)),()=>{t(u9(e))}),[t,e]),null}var p9=["key"],m9=["onMouseEnter","onClick","onMouseLeave"],x9=["id"],g9=["id"];function Nw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nw(Object(r),!0).forEach(function(n){v9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v9(e,t,r){return(t=b9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b9(e){var t=y9(e,"string");return typeof t=="symbol"?t:t+""}function y9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mi(){return mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mi.apply(null,arguments)}function i0(e,t){if(e==null)return{};var r,n,a=w9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function N9(e){var t=m.useMemo(()=>eg(e.children,Wl),[e.children]),r=Fe(n=>P7(n,e.id,t));return r==null?null:m.createElement(e9,{legendPayload:r})}var _9=m.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(h=>h.tooltipPayload),getPosition:h=>{var p;return(p=n[Number(h)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:ao(l,t),hide:c,type:u,color:s,unit:"",graphicalItemId:d}};return m.createElement(ig,{tooltipEntrySettings:f})}),S9=(e,t)=>e>t?"start":e<t?"end":"middle",E9=(e,t,r)=>Ar(typeof t=="function"?t(e):t,r,r*.8),j9=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=jS(i,s),c=a+Ar(e.cx,i,i/2),u=n+Ar(e.cy,s,s/2),d=Ar(e.innerRadius,l,0),f=E9(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:h}},T9=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},C9=(e,t)=>{if(m.isValidElement(e))return m.cloneElement(e,t);if(typeof e=="function")return e(t);var r=lt("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=i0(t,p9);return m.createElement(Fm,mi({},a,{type:"linear",className:r}))},k9=(e,t,r)=>{if(m.isValidElement(e))return m.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),m.isValidElement(n)))return n;var a=lt("recharts-pie-label-text",Xj(e));return m.createElement(r0,mi({},t,{alignmentBaseline:"middle",className:a}),n)};function A9(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=xn(r),c=Hi(a),u=Hi(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((h,p)=>{var x=(h.startAngle+h.endAngle)/2,g=Gt(h.cx,h.cy,h.outerRadius+d,x),v=Ut(Ut(Ut(Ut({},l),h),{},{stroke:"none"},c),{},{index:p,textAnchor:S9(g.x,h.cx)},g),b=Ut(Ut(Ut(Ut({},l),h),{},{fill:"none",stroke:h.fill},u),{},{index:p,points:[Gt(h.cx,h.cy,h.outerRadius,x),g],key:"line"});return m.createElement(an,{zIndex:Xt.label,key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(p)},m.createElement(cr,null,i&&C9(i,b),k9(a,v,xt(h,s))))});return m.createElement(cr,{className:"recharts-pie-labels"},f)}function P9(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?m.createElement(Zx,{label:a}):m.createElement(A9,{sectors:t,props:r,showLabels:n})}function O9(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:i,id:s}=e,l=Fe(pi),c=Fe(zx),u=Fe(UF),{onMouseEnter:d,onClick:f,onMouseLeave:h}=a,p=i0(a,m9),x=rg(d,a.dataKey,s),g=ng(h),v=ag(f,a.dataKey,s);return t==null||t.length===0?null:m.createElement(m.Fragment,null,t.map((b,w)=>{if(b?.startAngle===0&&b?.endAngle===0&&t.length!==1)return null;var y=u==null||u===s,N=String(w)===l&&(c==null||a.dataKey===c)&&y,S=l?n:null,E=r&&N?r:S,_=Ut(Ut({},b),{},{stroke:b.stroke,tabIndex:-1,[eS]:w,[tS]:s});return m.createElement(cr,mi({key:"sector-".concat(b?.startAngle,"-").concat(b?.endAngle,"-").concat(b.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},gd(p,b,w),{onMouseEnter:x(b,w),onMouseLeave:g(b,w),onClick:v(b,w)}),m.createElement(tg,mi({option:i??E,index:w,shapeType:"sector",isActive:N},_)))}))}function D9(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,h=Math.abs(r.minAngle),p=T9(l,c),x=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,v=n.filter(E=>xt(E,u,0)!==0).length,b=(x>=360?v:v-1)*g,w=x-v*h-b,y=n.reduce((E,_)=>{var j=xt(_,u,0);return E+(Ie(j)?j:0)},0),N;if(y>0){var S;N=n.map((E,_)=>{var j=xt(E,u,0),A=xt(E,d,_),T=j9(r,i,E),k=(Ie(j)?j:0)/y,C,L=Ut(Ut({},E),a&&a[_]&&a[_].props);_?C=S.endAngle+lr(p)*g*(j!==0?1:0):C=l;var G=C+lr(p)*((j!==0?h:0)+k*w),V=(C+G)/2,X=(T.innerRadius+T.outerRadius)/2,K=[{name:A,value:j,payload:L,dataKey:u,type:f,graphicalItemId:r.id}],Y=Gt(T.cx,T.cy,X,V);return S=Ut(Ut(Ut(Ut({},r.presentationProps),{},{percent:k,cornerRadius:typeof s=="string"?parseFloat(s):s,name:A,tooltipPayload:K,midAngle:V,middleRadius:X,tooltipPosition:Y},L),T),{},{value:j,dataKey:u,startAngle:C,endAngle:G,payload:L,paddingAngle:lr(p)*g}),S})}return N}function I9(e){var{showLabels:t,sectors:r,children:n}=e,a=m.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return m.createElement(p7,{value:t?a:void 0},n)}function R9(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:h}=t,p=Ol(t,"recharts-pie-"),x=r.current,[g,v]=m.useState(!1),b=m.useCallback(()=>{typeof h=="function"&&h(),v(!1)},[h]),w=m.useCallback(()=>{typeof f=="function"&&f(),v(!0)},[f]);return m.createElement(I9,{showLabels:!g,sectors:a},m.createElement(Pl,{animationId:p,begin:s,duration:l,isActive:i,easing:c,onAnimationStart:w,onAnimationEnd:b,key:p},y=>{var N,S=[],E=a&&a[0],_=(N=E?.startAngle)!==null&&N!==void 0?N:0;return a?.forEach((j,A)=>{var T=x&&x[A],k=A>0?Wi(j,"paddingAngle",0):0;if(T){var C=Tt(T.endAngle-T.startAngle,j.endAngle-j.startAngle,y),L=Ut(Ut({},j),{},{startAngle:_+k,endAngle:_+C+k});S.push(L),_=L.endAngle}else{var{endAngle:G,startAngle:V}=j,X=Tt(0,G-V,y),K=Ut(Ut({},j),{},{startAngle:_+k,endAngle:_+X+k});S.push(K),_=K.endAngle}}),r.current=S,m.createElement(cr,null,m.createElement(O9,{sectors:S,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),m.createElement(P9,{showLabels:!g,sectors:a,props:t}),t.children)}var M9={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Xt.area};function F9(e){var{id:t}=e,r=i0(e,x9),{hide:n,className:a,rootTabIndex:i}=e,s=m.useMemo(()=>eg(e.children,Wl),[e.children]),l=Fe(d=>O7(d,t,s)),c=m.useRef(null),u=lt("recharts-pie",a);return n||l==null?(c.current=null,m.createElement(cr,{tabIndex:i,className:u})):m.createElement(an,{zIndex:e.zIndex},m.createElement(_9,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),m.createElement(cr,{tabIndex:i,className:u},m.createElement(R9,{props:Ut(Ut({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function t5(e){var t=ur(e,M9),{id:r}=t,n=i0(t,g9),a=xn(n);return m.createElement(sg,{id:r,type:"pie"},i=>m.createElement(m.Fragment,null,m.createElement(h9,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),m.createElement(N9,mi({},n,{id:i})),m.createElement(F9,mi({},n,{id:i}))))}t5.displayName="Pie";var L9=["points"];function _w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_w(Object(r),!0).forEach(function(n){B9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_w(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B9(e,t,r){return(t=$9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $9(e){var t=U9(e,"string");return typeof t=="symbol"?t:t+""}function U9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iu(){return Iu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iu.apply(null,arguments)}function H9(e,t){if(e==null)return{};var r,n,a=z9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function z9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function W9(e){var{option:t,dotProps:r,className:n}=e;if(m.isValidElement(t))return m.cloneElement(t,r);if(typeof t=="function")return t(r);var a=lt(n,typeof t!="boolean"?t.className:""),i=r??{},{points:s}=i,l=H9(i,L9);return m.createElement(Wj,Iu({},l,{className:a}))}function V9(e,t){return e==null?!1:t?!0:e.length===1}function K9(e){var{points:t,dot:r,className:n,dotClassName:a,dataKey:i,baseProps:s,needClip:l,clipPathId:c,zIndex:u=Xt.scatter}=e;if(!V9(t,r))return null;var d=Zj(r),f=kk(r),h=t.map((x,g)=>{var v,b,w=Qf(Qf(Qf({r:3},s),f),{},{index:g,cx:(v=x.x)!==null&&v!==void 0?v:void 0,cy:(b=x.y)!==null&&b!==void 0?b:void 0,dataKey:i,value:x.value,payload:x.payload,points:t});return m.createElement(W9,{key:"dot-".concat(g),option:r,dotProps:w,className:a})}),p={};return l&&c!=null&&(p.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),m.createElement(an,{zIndex:u},m.createElement(cr,Iu({className:n},p),h))}function Sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ew(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sw(Object(r),!0).forEach(function(n){G9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G9(e,t,r){return(t=X9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X9(e){var t=Y9(e,"string");return typeof t=="symbol"?t:t+""}function Y9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var r5=0,q9={xAxis:{},yAxis:{},zAxis:{}},n5=nn({name:"cartesianAxis",initialState:q9,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:jt()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:jt()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:jt()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:jt()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:jt()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:jt()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:jt()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:jt()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:jt()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i,s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&n===s[1]&&n!==a.width&&Math.abs(n-((i=s[0])!==null&&i!==void 0?i:0))<=1)return;var l=[...s,n].slice(-3);e.yAxis[r]=Ew(Ew({},a),{},{width:n,widthHistory:l})}}}}),{addXAxis:Z9,replaceXAxis:J9,removeXAxis:Q9,addYAxis:eB,replaceYAxis:tB,removeYAxis:rB,addZAxis:Tre,replaceZAxis:Cre,removeZAxis:kre,updateYAxisWidth:nB}=n5.actions,aB=n5.reducer,iB=Q([tr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),sB=Q([iB,Ka,Ga],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),og=()=>Fe(sB),oB=()=>Fe(KF);function jw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jw(Object(r),!0).forEach(function(n){lB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lB(e,t,r){return(t=cB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cB(e){var t=uB(e,"string");return typeof t=="symbol"?t:t+""}function uB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dB=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i,clipPath:s}=e;if(a===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=eh(eh(eh({},l),Hi(a)),wm(a)),u;return m.isValidElement(a)?u=m.cloneElement(a,c):typeof a=="function"?u=a(c):u=m.createElement(Wj,c),m.createElement(cr,{className:"recharts-active-dot",clipPath:s},u)};function fB(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a,clipPath:i,zIndex:s=Xt.activeDot}=e,l=Fe(pi),c=oB();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Ft(u)?null:m.createElement(an,{zIndex:s},m.createElement(dB,{point:u,childIndex:Number(l),mainColor:r,dataKey:a,activeDot:n,clipPath:i}))}var Tw=(e,t,r)=>{var n=r??e;if(!Ft(n))return Ar(n,t,0)},hB=(e,t,r)=>{var n={},a=e.filter(Gd),i=e.filter(u=>u.stackId==null),s=a.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(s).map(u=>{var d,[f,h]=u,p=h.map(g=>g.dataKey),x=Tw(t,r,(d=h[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:p,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(h=>h!=null),f=Tw(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function Cw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cw(Object(r),!0).forEach(function(n){pB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pB(e,t,r){return(t=mB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mB(e){var t=xB(e,"string");return typeof t=="symbol"?t:t+""}function xB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gB(e,t,r,n,a){var i,s=n.length;if(!(s<1)){var l=Ar(e,r,0,!0),c,u=[];if(et((i=n[0])===null||i===void 0?void 0:i.barSize)){var d=!1,f=r/s,h=n.reduce((w,y)=>w+(y.barSize||0),0);h+=(s-1)*l,h>=r&&(h-=(s-1)*l,l=0),h>=r&&f>0&&(d=!0,f*=.9,h=s*f);var p=(r-h)/2>>0,x={offset:p-l,size:0};c=n.reduce((w,y)=>{var N,S={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:x.offset+x.size+l,size:d?f:(N=y.barSize)!==null&&N!==void 0?N:0}},E=[...w,S];return x=S.position,E},u)}else{var g=Ar(t,r,0,!0);r-2*g-(s-1)*l<=0&&(l=0);var v=(r-2*g-(s-1)*l)/s;v>1&&(v>>=0);var b=et(a)?Math.min(v,a):v;c=n.reduce((w,y,N)=>[...w,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:g+(v+l)*N+(v-b)/2,size:b}}],u)}return c}}var vB=(e,t,r,n,a,i,s)=>{var l=Ft(s)?t:s,c=gB(r,n,a!==i?a:i,e,l);return a!==i&&c!=null&&(c=c.map(u=>pc(pc({},u),{},{position:pc(pc({},u.position),{},{offset:u.position.offset-a/2})}))),c},bB=(e,t)=>{var r=xx(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},yB=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function wB(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&et(e.zIndex)?e.zIndex:t}var a5=e=>{var{chartData:t}=e,r=Ot(),n=Ir();return m.useEffect(()=>n?()=>{}:(r(Iy(t)),()=>{r(Iy(void 0))}),[t,r,n]),null},kw={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},i5=nn({name:"brush",initialState:kw,reducers:{setBrushSettings(e,t){return t.payload==null?kw:t.payload}}}),{setBrushSettings:Are}=i5.actions,NB=i5.reducer;function _B(e){return(e%180+180)%180}var SB=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=_B(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},EB={dots:[],areas:[],lines:[]},s5=nn({name:"referenceElements",initialState:EB,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=zn(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=zn(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=zn(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Pre,removeDot:Ore,addArea:Dre,removeArea:Ire,addLine:Rre,removeLine:Mre}=s5.actions,jB=s5.reducer,TB=m.createContext(void 0),CB=e=>{var{children:t}=e,[r]=m.useState("".concat(qo("recharts"),"-clip")),n=og();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return m.createElement(TB.Provider,{value:r},m.createElement("defs",null,m.createElement("clipPath",{id:r},m.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function o5(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function kB(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return SB(n,r)}function AB(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function ul(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function PB(e,t){return o5(e,t+1)}function OB(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,c=0,u=1,d=s,f=function(){var x=n?.[c];if(x===void 0)return{v:o5(n,u)};var g=c,v,b=()=>(v===void 0&&(v=r(x,g)),v),w=x.coordinate,y=c===0||ul(e,w,b,d,l);y||(c=0,d=s,u+=1),y&&(d=w+e*(b()/2+a),c+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function DB(e,t,r,n,a){var i=(n||[]).slice(),s=i.length;if(s===0)return[];for(var{start:l,end:c}=t,u=1;u<=s;u++){for(var d=(s-1)%u,f=l,h=!0,p=function(){var N=n[g];if(N==null)return 0;var S=g,E,_=()=>(E===void 0&&(E=r(N,S)),E),j=N.coordinate,A=g===d||ul(e,j,_,f,c);if(!A)return h=!1,1;A&&(f=j+e*(_()/2+a))},x,g=d;g<s&&(x=p(),!(x!==0&&x===1));g+=u);if(h){for(var v=[],b=d;b<s;b+=u){var w=n[b];w!=null&&v.push(w)}return v}}return[]}function Aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aw(Object(r),!0).forEach(function(n){IB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IB(e,t,r){return(t=RB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RB(e){var t=MB(e,"string");return typeof t=="symbol"?t:t+""}function MB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FB(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:c}=t,u=function(h){var p=i[h];if(p==null)return 1;var x=p,g,v=()=>(g===void 0&&(g=r(p,h)),g);if(h===s-1){var b=e*(x.coordinate+e*v()/2-c);i[h]=x=_r(_r({},x),{},{tickCoord:b>0?x.coordinate-b*e:x.coordinate})}else i[h]=x=_r(_r({},x),{},{tickCoord:x.coordinate});if(x.tickCoord!=null){var w=ul(e,x.tickCoord,v,l,c);w&&(c=x.tickCoord-e*(v()/2+a),i[h]=_r(_r({},x),{},{isShow:!0}))}},d=s-1;d>=0;d--)u(d);return i}function LB(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:c,end:u}=t;if(i){var d=n[l-1];if(d!=null){var f=r(d,l-1),h=e*(d.coordinate+e*f/2-u);if(s[l-1]=d=_r(_r({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),d.tickCoord!=null){var p=ul(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+a),s[l-1]=_r(_r({},d),{},{isShow:!0}))}}}for(var x=i?l-1:l,g=function(w){var y=s[w];if(y==null)return 1;var N=y,S,E=()=>(S===void 0&&(S=r(y,w)),S);if(w===0){var _=e*(N.coordinate-e*E()/2-c);s[w]=N=_r(_r({},N),{},{tickCoord:_<0?N.coordinate-_*e:N.coordinate})}else s[w]=N=_r(_r({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var j=ul(e,N.tickCoord,E,c,u);j&&(c=N.tickCoord+e*(E()/2+a),s[w]=_r(_r({},N),{},{isShow:!0}))}},v=0;v<x;v++)g(v);return s}function lg(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(Ie(c)||Md.isSsr){var h;return(h=PB(a,Ie(c)?c:0))!==null&&h!==void 0?h:[]}var p=[],x=l==="top"||l==="bottom"?"width":"height",g=d&&x==="width"?Ho(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(S,E)=>{var _=typeof u=="function"?u(S.value,E):S.value;return x==="width"?kB(Ho(_,{fontSize:t,letterSpacing:r}),g,f):Ho(_,{fontSize:t,letterSpacing:r})[x]},b=a[0],w=a[1],y=a.length>=2&&b!=null&&w!=null?lr(w.coordinate-b.coordinate):1,N=AB(i,y,x);return c==="equidistantPreserveStart"?OB(y,N,v,a,s):c==="equidistantPreserveEnd"?DB(y,N,v,a,s):(c==="preserveStart"||c==="preserveStartEnd"?p=LB(y,N,v,a,s,c==="preserveStartEnd"):p=FB(y,N,v,a,s),p.filter(S=>S.isShow))}var BB=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>s&&(s=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+i,u=s+c+l+(r?n:0);return Math.round(u)}return 0},$B=["axisLine","width","height","className","hide","ticks","axisType"];function UB(e,t){if(e==null)return{};var r,n,a=HB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function HB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qi(){return qi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qi.apply(null,arguments)}function Pw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pw(Object(r),!0).forEach(function(n){zB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zB(e,t,r){return(t=WB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WB(e){var t=VB(e,"string");return typeof t=="symbol"?t:t+""}function VB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pa={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Xt.axis};function KB(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Bt(Bt(Bt({},c),xn(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!s||i==="bottom"&&s);u=Bt(Bt({},u),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var f=+(i==="left"&&!s||i==="right"&&s);u=Bt(Bt({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return m.createElement("line",qi({},u,{className:lt("recharts-cartesian-axis-line",Wi(l,"className"))}))}function GB(e,t,r,n,a,i,s,l,c){var u,d,f,h,p,x,g=l?-1:1,v=e.tickSize||s,b=Ie(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,h=r+ +!l*a,f=h-g*v,x=f-g*c,p=b;break;case"left":f=h=e.coordinate,d=t+ +!l*n,u=d-g*v,p=u-g*c,x=b;break;case"right":f=h=e.coordinate,d=t+ +l*n,u=d+g*v,p=u+g*c,x=b;break;default:u=d=e.coordinate,h=r+ +l*a,f=h+g*v,x=f+g*c,p=b;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:p,y:x}}}function XB(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function YB(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function qB(e){var{option:t,tickProps:r,value:n}=e,a,i=lt(r.className,"recharts-cartesian-axis-tick-value");if(m.isValidElement(t))a=m.cloneElement(t,Bt(Bt({},r),{},{className:i}));else if(typeof t=="function")a=t(Bt(Bt({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=lt(s,Xj(t))),a=m.createElement(r0,qi({},r,{className:s}),n)}return a}var ZB=m.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:i,tickFormatter:s,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:h,y:p,width:x,height:g,tickSize:v,tickMargin:b,fontSize:w,letterSpacing:y,getTicksConfig:N,events:S,axisType:E}=e,_=lg(Bt(Bt({},N),{},{ticks:r}),w,y),j=XB(d,f),A=YB(d,f),T=xn(N),k=Hi(n),C={};typeof a=="object"&&(C=a);var L=Bt(Bt({},T),{},{fill:"none"},C),G=_.map(K=>Bt({entry:K},GB(K,h,p,x,g,d,v,f,b))),V=G.map(K=>{var{entry:Y,line:q}=K;return m.createElement(cr,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},a&&m.createElement("line",qi({},L,q,{className:lt("recharts-cartesian-axis-tick-line",Wi(a,"className"))})))}),X=G.map((K,Y)=>{var q,Z,{entry:le,tick:ce}=K,me=Bt(Bt(Bt(Bt({verticalAnchor:A},T),{},{textAnchor:j,stroke:"none",fill:i},ce),{},{index:Y,payload:le,visibleTicksCount:_.length,tickFormatter:s,padding:c},u),{},{angle:(q=(Z=u?.angle)!==null&&Z!==void 0?Z:T.angle)!==null&&q!==void 0?q:0}),Ne=Bt(Bt({},me),k);return m.createElement(cr,qi({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(le.value,"-").concat(le.coordinate,"-").concat(le.tickCoord)},gd(S,le,Y)),n&&m.createElement(qB,{option:n,tickProps:Ne,value:"".concat(typeof s=="function"?s(le.value,Y):le.value).concat(l||"")}))});return m.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(E,"-ticks")},X.length>0&&m.createElement(an,{zIndex:Xt.label},m.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(E,"-tick-labels"),ref:t},X)),V.length>0&&m.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(E,"-tick-lines")},V))}),JB=m.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:l,axisType:c}=e,u=UB(e,$B),[d,f]=m.useState(""),[h,p]=m.useState(""),x=m.useRef(null);m.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return BB({ticks:x.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=m.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=b;var w=b[0];if(w){var y=window.getComputedStyle(w),N=y.fontSize,S=y.letterSpacing;(N!==d||S!==h)&&(f(N),p(S))}}},[d,h]);return s||n!=null&&n<=0||a!=null&&a<=0?null:m.createElement(an,{zIndex:e.zIndex},m.createElement(cr,{className:lt("recharts-cartesian-axis",i)},m.createElement(KB,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:xn(e)}),m.createElement(ZB,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:h,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),m.createElement(GL,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},m.createElement(n7,{label:e.label,labelRef:e.labelRef}),e.children)))}),cg=m.forwardRef((e,t)=>{var r=ur(e,Pa);return m.createElement(JB,qi({},r,{ref:t}))});cg.displayName="CartesianAxis";var QB=["x1","y1","x2","y2","key"],e$=["offset"],t$=["xAxisId","yAxisId"],r$=["xAxisId","yAxisId"];function Ow(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ow(Object(r),!0).forEach(function(n){n$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ow(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n$(e,t,r){return(t=a$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a$(e){var t=i$(e,"string");return typeof t=="symbol"?t:t+""}function i$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mi(){return Mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mi.apply(null,arguments)}function Ru(e,t){if(e==null)return{};var r,n,a=s$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function s$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var o$=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return m.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function l5(e){var{option:t,lineItemProps:r}=e,n;if(m.isValidElement(t))n=m.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:i,y1:s,x2:l,y2:c,key:u}=r,d=Ru(r,QB),f=(a=xn(d))!==null&&a!==void 0?a:{},{offset:h}=f,p=Ru(f,e$);n=m.createElement("line",Mi({},p,{x1:i,y1:s,x2:l,y2:c,fill:"none",key:u}))}return n}function l$(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Ru(e,t$),c=a.map((u,d)=>{var f=Cr(Cr({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return m.createElement(l5,{key:"line-".concat(d),option:n,lineItemProps:f})});return m.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function c$(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Ru(e,r$),c=a.map((u,d)=>{var f=Cr(Cr({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return m.createElement(l5,{option:n,lineItemProps:f,key:"line-".concat(d)})});return m.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function u$(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],x=p==null,g=x?a+s-f:p-f;if(g<=0)return null;var v=h%t.length;return m.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:g,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return m.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function d$(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],x=p==null,g=x?a+s-f:p-f;if(g<=0)return null;var v=h%r.length;return m.createElement("rect",{key:"react-".concat(h),x:f,y:i,width:g,height:l,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return m.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var f$=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return Z_(lg(Cr(Cr(Cr({},Pa),r),{},{ticks:J_(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},h$=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return Z_(lg(Cr(Cr(Cr({},Pa),r),{},{ticks:J_(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},p$={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Xt.grid};function ug(e){var t=sS(),r=oS(),n=iS(),a=Cr(Cr({},ur(e,p$)),{},{x:Ie(e.x)?e.x:n.left,y:Ie(e.y)?e.y:n.top,width:Ie(e.width)?e.width:n.width,height:Ie(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:p}=a,x=Ir(),g=Fe(A=>Ny(A,"xAxis",i,x)),v=Fe(A=>Ny(A,"yAxis",s,x));if(!fa(u)||!fa(d)||!Ie(l)||!Ie(c))return null;var b=a.verticalCoordinatesGenerator||f$,w=a.horizontalCoordinatesGenerator||h$,{horizontalPoints:y,verticalPoints:N}=a;if((!y||!y.length)&&typeof w=="function"){var S=h&&h.length,E=w({yAxis:v?Cr(Cr({},v),{},{ticks:S?h:v.ticks}):void 0,width:t??u,height:r??d,offset:n},S?!0:f);ou(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(y=E)}if((!N||!N.length)&&typeof b=="function"){var _=p&&p.length,j=b({xAxis:g?Cr(Cr({},g),{},{ticks:_?p:g.ticks}):void 0,width:t??u,height:r??d,offset:n},_?!0:f);ou(Array.isArray(j),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(N=j)}return m.createElement(an,{zIndex:a.zIndex},m.createElement("g",{className:"recharts-cartesian-grid"},m.createElement(o$,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),m.createElement(u$,Mi({},a,{horizontalPoints:y})),m.createElement(d$,Mi({},a,{verticalPoints:N})),m.createElement(l$,Mi({},a,{offset:n,horizontalPoints:y,xAxis:g,yAxis:v})),m.createElement(c$,Mi({},a,{offset:n,verticalPoints:N,xAxis:g,yAxis:v}))))}ug.displayName="CartesianGrid";var m$={},c5=nn({name:"errorBars",initialState:m$,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Fre,replaceErrorBar:Lre,removeErrorBar:Bre}=c5.actions,x$=c5.reducer,g$=["children"];function v$(e,t){if(e==null)return{};var r,n,a=b$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var y$={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},w$=m.createContext(y$);function u5(e){var{children:t}=e,r=v$(e,g$);return m.createElement(w$.Provider,{value:r},t)}function dg(e,t){var r,n,a=Fe(u=>qa(u,e)),i=Fe(u=>Za(u,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:ar.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ir.allowDataOverflow,c=s||l;return{needClip:c,needClipX:s,needClipY:l}}function d5(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=og(),{needClipX:i,needClipY:s,needClip:l}=dg(t,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return m.createElement("clipPath",{id:"clipPath-".concat(n)},m.createElement("rect",{x:i?c:c-d/2,y:s?u:u-f/2,width:i?d:d*2,height:s?f:f*2}))}var f5=(e,t,r,n)=>hi(e,"xAxis",t,n),h5=(e,t,r,n)=>fi(e,"xAxis",t,n),p5=(e,t,r,n)=>hi(e,"yAxis",r,n),m5=(e,t,r,n)=>fi(e,"yAxis",r,n),N$=Q([at,f5,p5,h5,m5],(e,t,r,n,a)=>Va(e,"xAxis")?Zs(t,n,!1):Zs(r,a,!1)),_$=(e,t,r,n,a)=>a;function S$(e){return e.type==="line"}var E$=Q([qd,_$],(e,t)=>e.filter(S$).find(r=>r.id===t)),j$=Q([at,f5,p5,h5,m5,E$,N$,ox],(e,t,r,n,a,i,s,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:h}=i,p;if(h!=null&&h.length>0?p=h:p=c?.slice(u,d+1),p!=null)return hU({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:s,displayedData:p})}});function T$(e){var t=Hi(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),l=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(l)||l<0)&&(l=n),{r:s,strokeWidth:l}}return{r,strokeWidth:n}}var th={exports:{}},rh={};var Dw;function C$(){if(Dw)return rh;Dw=1;var e=ud();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return rh.useSyncExternalStoreWithSelector=function(c,u,d,f,h){var p=a(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=s(function(){function v(S){if(!b){if(b=!0,w=S,S=f(S),h!==void 0&&x.hasValue){var E=x.value;if(h(E,S))return y=E}return y=S}if(E=y,r(w,S))return E;var _=f(S);return h!==void 0&&h(E,_)?(w=S,E):(w=S,y=_)}var b=!1,w,y,N=d===void 0?null:d;return[function(){return v(u())},N===null?void 0:function(){return v(N())}]},[u,d,f,h]);var g=n(c,p[0],p[1]);return i(function(){x.hasValue=!0,x.value=g},[g]),l(g),g},rh}var Iw;function k$(){return Iw||(Iw=1,th.exports=C$()),th.exports}k$();function A$(e){e()}function P$(){let e=null,t=null;return{clear(){e=null,t=null},notify(){A$(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Rw={notify(){},get:()=>[]};function O$(e,t){let r,n=Rw,a=0,i=!1;function s(g){d();const v=n.subscribe(g);let b=!1;return()=>{b||(b=!0,v(),f())}}function l(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){a++,r||(r=e.subscribe(c),n=P$())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Rw)}function h(){i||(i=!0,d())}function p(){i&&(i=!1,f())}const x={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>n};return x}var D$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",I$=D$(),R$=()=>typeof navigator<"u"&&navigator.product==="ReactNative",M$=R$(),F$=()=>I$||M$?m.useLayoutEffect:m.useEffect,L$=F$();function Mw(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function B$(e,t){if(Mw(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!Mw(e[r[a]],t[r[a]]))return!1;return!0}var $$=Symbol.for("react-redux-context"),U$=typeof globalThis<"u"?globalThis:{};function H$(){if(!m.createContext)return{};const e=U$[$$]??=new Map;let t=e.get(m.createContext);return t||(t=m.createContext(null),e.set(m.createContext,t)),t}var z$=H$();function W$(e){const{children:t,context:r,serverState:n,store:a}=e,i=m.useMemo(()=>{const c=O$(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=m.useMemo(()=>a.getState(),[a]);L$(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const l=r||z$;return m.createElement(l.Provider,{value:i},t)}var V$=W$,K$=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function G$(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function s0(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(K$.has(n)){if(e[n]==null&&t[n]==null)continue;if(!B$(e[n],t[n]))return!1}else if(!G$(e[n],t[n]))return!1;return!0}var X$=["id"],Y$=["type","layout","connectNulls","needClip","shape"],q$=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function dl(){return dl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dl.apply(null,arguments)}function Fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ea(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fw(Object(r),!0).forEach(function(n){Z$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z$(e,t,r){return(t=J$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J$(e){var t=Q$(e,"string");return typeof t=="symbol"?t:t+""}function Q$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fg(e,t){if(e==null)return{};var r,n,a=eU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tU=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:ao(r,t),payload:e}]},rU=m.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:ss,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:ao(s,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return m.createElement(ig,{tooltipEntrySettings:f})}),x5=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function nU(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var aU=(e,t,r)=>{var n=r.reduce((p,x)=>p+x);if(!n)return x5(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>i){l=[...r.slice(0,c),i-u];break}}var h=l.length%2===0?[0,s]:[s];return[...nU(r,a),...l,...h].map(p=>"".concat(p,"px")).join(", ")};function iU(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n,{id:l}=n,c=fg(n,X$),u=xn(c);return m.createElement(K9,{points:r,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:u,needClip:s,clipPathId:t})}function sU(e){var{showLabels:t,children:r,points:n}=e,a=m.useMemo(()=>n?.map(i=>{var s,l,c={x:(s=i.x)!==null&&s!==void 0?s:0,y:(l=i.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ea(ea({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return m.createElement(Hj,{value:t?a:void 0},r)}function Lw(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:l,connectNulls:c,needClip:u,shape:d}=i,f=fg(i,Y$),h=ea(ea({},Gr(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:l,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return m.createElement(m.Fragment,null,n?.length>1&&m.createElement(tg,dl({shapeType:"curve",option:d},h,{pathRef:r})),m.createElement(iU,{points:n,clipPathId:t,props:i}))}function oU(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function lU(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:p,height:x,onAnimationEnd:g,onAnimationStart:v}=r,b=a.current,w=Ol(s,"recharts-line-"),y=m.useRef(w),[N,S]=m.useState(!1),E=!N,_=m.useCallback(()=>{typeof g=="function"&&g(),S(!1)},[g]),j=m.useCallback(()=>{typeof v=="function"&&v(),S(!0)},[v]),A=oU(n.current),T=m.useRef(0);y.current!==w&&(T.current=i.current,y.current=w);var k=T.current;return m.createElement(sU,{points:s,showLabels:E},r.children,m.createElement(Pl,{animationId:w,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:_,onAnimationStart:j,key:w},C=>{var L=Tt(k,A+k,C),G=Math.min(L,A),V;if(c)if(l){var X="".concat(l).split(/[,\s]+/gim).map(q=>parseFloat(q));V=aU(G,A,X)}else V=x5(A,G);else V=l==null?void 0:String(l);if(C>0&&A>0&&(a.current=s,i.current=Math.max(i.current,G)),b){var K=b.length/s.length,Y=C===1?s:s.map((q,Z)=>{var le=Math.floor(Z*K);if(b[le]){var ce=b[le];return ea(ea({},q),{},{x:Tt(ce.x,q.x,C),y:Tt(ce.y,q.y,C)})}return h?ea(ea({},q),{},{x:Tt(p*2,q.x,C),y:Tt(x/2,q.y,C)}):ea(ea({},q),{},{x:q.x,y:q.y})});return a.current=Y,m.createElement(Lw,{props:r,points:Y,clipPathId:t,pathRef:n,strokeDasharray:V})}return m.createElement(Lw,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:V})}),m.createElement(Zx,{label:r.label}))}function cU(e){var{clipPathId:t,props:r}=e,n=m.useRef(null),a=m.useRef(0),i=m.useRef(null);return m.createElement(lU,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var uU=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:xt(e.payload,t)}};class dU extends m.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:l,left:c,width:u,height:d,id:f,needClip:h,zIndex:p}=this.props;if(t)return null;var x=lt("recharts-line",a),g=f,{r:v,strokeWidth:b}=T$(r),w=Zj(r),y=v*2+b,N=h?"url(#clipPath-".concat(w?"":"dots-").concat(g,")"):void 0;return m.createElement(an,{zIndex:p},m.createElement(cr,{className:x},h&&m.createElement("defs",null,m.createElement(d5,{clipPathId:g,xAxisId:i,yAxisId:s}),!w&&m.createElement("clipPath",{id:"clipPath-dots-".concat(g)},m.createElement("rect",{x:c-y/2,y:l-y/2,width:u+y,height:d+y}))),m.createElement(u5,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:uU,errorBarOffset:0},m.createElement(cU,{props:this.props,clipPathId:g}))),m.createElement(fB,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:N}))}}var g5={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Xt.line,type:"linear"};function fU(e){var t=ur(e,g5),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:p,yAxisId:x,id:g}=t,v=fg(t,q$),{needClip:b}=dg(p,x),w=og(),y=os(),N=Ir(),S=Fe(T=>j$(T,p,x,N,g));if(y!=="horizontal"&&y!=="vertical"||S==null||w==null)return null;var{height:E,width:_,x:j,y:A}=w;return m.createElement(dU,dl({},v,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:p,yAxisId:x,points:S,layout:y,height:E,width:_,left:j,top:A,needClip:b}))}function hU(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=xt(u,s);if(t==="horizontal"){var h=w1({axis:r,ticks:a,bandSize:l,entry:u,index:d}),p=Ft(f)?null:n.scale.map(f);return{x:h,y:p??null,value:f,payload:u}}var x=Ft(f)?null:r.scale.map(f),g=w1({axis:n,ticks:i,bandSize:l,entry:u,index:d});return x==null||g==null?null:{x,y:g,value:f,payload:u}}).filter(Boolean)}function pU(e){var t=ur(e,g5),r=Ir();return m.createElement(sg,{id:t.id,type:"line"},n=>m.createElement(m.Fragment,null,m.createElement(Jj,{legendPayload:tU(t)}),m.createElement(rU,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),m.createElement(e5,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),m.createElement(fU,dl({},t,{id:n}))))}var v5=m.memo(pU,s0);v5.displayName="Line";function us(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:r5}function ds(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:r5}var mU="Invariant failed";function xU(e,t){throw new Error(mU)}function Ap(){return Ap=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ap.apply(null,arguments)}function Mu(e){return m.createElement(tg,Ap({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var gU=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Ie(t))return t;var i=Ie(n)||Ft(n);return i?t(n,a):(i||xU(),r)}},vU=(e,t,r)=>r,bU=(e,t)=>t,Vl=Q([qd,bU],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),yU=Q([Vl],e=>e?.maxBarSize),wU=(e,t,r,n)=>n,NU=Q([at,qd,us,ds,vU],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),_U=(e,t,r)=>{var n=at(e),a=us(e,t),i=ds(e,t);if(!(a==null||i==null))return n==="horizontal"?_p(e,"yAxis",i,r):_p(e,"xAxis",a,r)},SU=(e,t)=>{var r=at(e),n=us(e,t),a=ds(e,t);if(!(n==null||a==null))return r==="horizontal"?wy(e,"xAxis",n):wy(e,"yAxis",a)},EU=Q([NU,U6,SU],hB),jU=(e,t,r)=>{var n,a,i=Vl(e,t);if(i==null)return 0;var s=us(e,t),l=ds(e,t);if(s==null||l==null)return 0;var c=at(e),u=wE(e),{maxBarSize:d}=i,f=Ft(d)?u:d,h,p;return c==="horizontal"?(h=hi(e,"xAxis",s,r),p=fi(e,"xAxis",s,r)):(h=hi(e,"yAxis",l,r),p=fi(e,"yAxis",l,r)),(n=(a=Zs(h,p,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0},b5=(e,t,r)=>{var n=at(e),a=us(e,t),i=ds(e,t);if(!(a==null||i==null)){var s,l;return n==="horizontal"?(s=hi(e,"xAxis",a,r),l=fi(e,"xAxis",a,r)):(s=hi(e,"yAxis",i,r),l=fi(e,"yAxis",i,r)),Zs(s,l)}},TU=Q([EU,wE,$6,NE,jU,b5,yU],vB),CU=(e,t,r)=>{var n=us(e,t);if(n!=null)return hi(e,"xAxis",n,r)},kU=(e,t,r)=>{var n=ds(e,t);if(n!=null)return hi(e,"yAxis",n,r)},AU=(e,t,r)=>{var n=us(e,t);if(n!=null)return fi(e,"xAxis",n,r)},PU=(e,t,r)=>{var n=ds(e,t);if(n!=null)return fi(e,"yAxis",n,r)},OU=Q([TU,Vl],yB),DU=Q([_U,Vl],bB),IU=Q([tr,Pm,CU,kU,AU,PU,OU,at,O6,b5,DU,Vl,wU],(e,t,r,n,a,i,s,l,c,u,d,f,h)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:g}=c;if(!(f==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||u==null)){var{data:v}=f,b;if(v!=null&&v.length>0?b=v:b=p?.slice(x,g+1),b!=null)return lH({layout:l,barSettings:f,pos:s,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:b,offset:e,cells:h,dataStartIndex:x})}}),RU=["index"];function Pp(){return Pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pp.apply(null,arguments)}function MU(e,t){if(e==null)return{};var r,n,a=FU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function FU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var y5=m.createContext(void 0),LU=e=>{var t=m.useContext(y5);if(t!=null)return t.stackId;if(e!=null)return UO(e)},BU=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),$U=e=>{var t=m.useContext(y5);if(t!=null){var{stackId:r}=t;return"url(#".concat(BU(r,e),")")}},w5=e=>{var{index:t}=e,r=MU(e,RU),n=$U(t);return m.createElement(cr,Pp({className:"recharts-bar-stack-layer",clipPath:n},r))},UU=["onMouseEnter","onMouseLeave","onClick"],HU=["value","background","tooltipPosition"],zU=["id"],WU=["onMouseEnter","onClick","onMouseLeave"];function Ua(){return Ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ua.apply(null,arguments)}function Bw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bw(Object(r),!0).forEach(function(n){VU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VU(e,t,r){return(t=KU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KU(e){var t=GU(e,"string");return typeof t=="symbol"?t:t+""}function GU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fu(e,t){if(e==null)return{};var r,n,a=XU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function XU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var YU=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:ao(r,t),payload:e}]},qU=m.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:ss,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:ao(i,t),hide:s,type:c,color:a,unit:l,graphicalItemId:u}};return m.createElement(ig,{tooltipEntrySettings:d})});function ZU(e){var t=Fe(pi),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:c}=i,u=Fu(i,UU),d=rg(s,n,i.id),f=ng(l),h=ag(c,n,i.id);if(!a||r==null)return null;var p=Hi(a);return m.createElement(an,{zIndex:wB(a,Xt.barBackground)},r.map((x,g)=>{var{value:v,background:b,tooltipPosition:w}=x,y=Fu(x,HU);if(!b)return null;var N=d(x,g),S=f(x,g),E=h(x,g),_=Ur(Ur(Ur(Ur(Ur({option:a,isActive:String(g)===t},y),{},{fill:"#eee"},b),p),gd(u,x,g)),{},{onMouseEnter:N,onMouseLeave:S,onClick:E,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return m.createElement(Mu,Ua({key:"background-bar-".concat(g)},_))}))}function JU(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return Ur(Ur({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return m.createElement(Hj,{value:t?a:void 0},r)}function QU(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,l=Fe(pi),c=Fe(zx),u=r&&String(i)===l&&(c==null||s===c),d=u?r:t;return u?m.createElement(an,{zIndex:Xt.activeBar},m.createElement(w5,{index:i},m.createElement(Mu,Ua({},n,{name:String(n.name)},a,{isActive:u,option:d,index:i,dataKey:s})))):m.createElement(Mu,Ua({},n,{name:String(n.name)},a,{isActive:u,option:d,index:i,dataKey:s}))}function eH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return m.createElement(Mu,Ua({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function tH(e){var t,{data:r,props:n}=e,a=(t=xn(n))!==null&&t!==void 0?t:{},{id:i}=a,s=Fu(a,zU),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:h}=n,p=Fu(n,WU),x=rg(d,c,i),g=ng(h),v=ag(f,c,i);return r?m.createElement(m.Fragment,null,r.map((b,w)=>m.createElement(w5,Ua({index:w,key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(w),className:"recharts-bar-rectangle"},gd(p,b,w),{onMouseEnter:x(b,w),onMouseLeave:g(b,w),onClick:v(b,w)}),u?m.createElement(QU,{shape:l,activeBar:u,baseProps:s,entry:b,index:w,dataKey:c}):m.createElement(eH,{shape:l,baseProps:s,entry:b,index:w,dataKey:c})))):null}function rH(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,h=Ol(t,"recharts-bar-"),[p,x]=m.useState(!1),g=!p,v=m.useCallback(()=>{typeof u=="function"&&u(),x(!1)},[u]),b=m.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return m.createElement(JU,{showLabels:g,rects:n},m.createElement(Pl,{animationId:h,begin:s,duration:l,isActive:i,easing:c,onAnimationEnd:v,onAnimationStart:b,key:h},w=>{var y=w===1?n:n?.map((N,S)=>{var E=f&&f[S];if(E)return Ur(Ur({},N),{},{x:Tt(E.x,N.x,w),y:Tt(E.y,N.y,w),width:Tt(E.width,N.width,w),height:Tt(E.height,N.height,w)});if(a==="horizontal"){var _=Tt(0,N.height,w),j=Tt(N.stackedBarStart,N.y,w);return Ur(Ur({},N),{},{y:j,height:_})}var A=Tt(0,N.width,w),T=Tt(N.stackedBarStart,N.x,w);return Ur(Ur({},N),{},{width:A,x:T})});return w>0&&(r.current=y??null),y==null?null:m.createElement(cr,null,m.createElement(tH,{props:t,data:y}))}),m.createElement(Zx,{label:t.label}),t.children)}function nH(e){var t=m.useRef(null);return m.createElement(rH,{previousRectanglesRef:t,props:e})}var N5=0,aH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:xt(e,t)}};class iH extends m.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=lt("recharts-bar",a),f=u;return m.createElement(cr,{className:d,id:u},l&&m.createElement("defs",null,m.createElement(d5,{clipPathId:f,xAxisId:i,yAxisId:s})),m.createElement(cr,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},m.createElement(ZU,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),m.createElement(nH,this.props)))}}var sH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:N5,xAxisId:0,yAxisId:0,zIndex:Xt.bar};function oH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=dg(t,r),h=os(),p=Ir(),x=eg(e.children,Wl),g=Fe(w=>IU(w,e.id,p,x));if(h!=="vertical"&&h!=="horizontal")return null;var v,b=g?.[0];return b==null||b.height==null||b.width==null?v=0:v=h==="vertical"?b.height/2:b.width/2,m.createElement(u5,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:aH,errorBarOffset:v},m.createElement(iH,Ua({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function lH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:h,cells:p,parentViewBox:x,dataStartIndex:g}=e,v=t==="horizontal"?l:s,b=d?v.scale.domain():null,w=HO({numericAxis:v}),y=v.scale.map(w);return f.map((N,S)=>{var E,_,j,A,T,k;if(d){var C=d[S+g];if(C==null)return null;E=MO(C,b)}else E=xt(N,r),Array.isArray(E)||(E=[w,E]);var L=gU(n,N5)(E[1],S);if(t==="horizontal"){var G,V=l.scale.map(E[0]),X=l.scale.map(E[1]);if(V==null||X==null)return null;_=N1({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:N,index:S}),j=(G=X??V)!==null&&G!==void 0?G:void 0,A=a.size;var K=V-X;if(T=ua(K)?0:K,k={x:_,y:h.top,width:A,height:h.height},Math.abs(L)>0&&Math.abs(T)<Math.abs(L)){var Y=lr(T||L)*(Math.abs(L)-Math.abs(T));j-=Y,T+=Y}}else{var q=s.scale.map(E[0]),Z=s.scale.map(E[1]);if(q==null||Z==null)return null;if(_=q,j=N1({axis:l,ticks:u,bandSize:i,offset:a.offset,entry:N,index:S}),A=Z-q,T=a.size,k={x:h.left,y:j,width:h.width,height:T},Math.abs(L)>0&&Math.abs(A)<Math.abs(L)){var le=lr(A||L)*(Math.abs(L)-Math.abs(A));A+=le}}if(_==null||j==null||A==null||T==null)return null;var ce=Ur(Ur({},N),{},{stackedBarStart:y,x:_,y:j,width:A,height:T,value:d?E:E[1],payload:N,background:k,tooltipPosition:{x:_+A/2,y:j+T/2},parentViewBox:x},p&&p[S]&&p[S].props);return ce}).filter(Boolean)}function cH(e){var t=ur(e,sH),r=LU(t.stackId),n=Ir();return m.createElement(sg,{id:t.id,type:"bar"},a=>m.createElement(m.Fragment,null,m.createElement(Jj,{legendPayload:YU(t)}),m.createElement(qU,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),m.createElement(e5,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),m.createElement(an,{zIndex:t.zIndex},m.createElement(oH,Ua({},t,{id:a})))))}var Op=m.memo(cH,s0);Op.displayName="Bar";var uH=["domain","range"],dH=["domain","range"];function $w(e,t){if(e==null)return{};var r,n,a=fH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Uw(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function _5(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=$w(e,uH),{domain:i,range:s}=t,l=$w(t,dH);return!Uw(r,i)||!Uw(n,s)?!1:s0(a,l)}var hH=["type"],pH=["dangerouslySetInnerHTML","ticks","scale"],mH=["id","scale"];function Dp(){return Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dp.apply(null,arguments)}function Hw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hw(Object(r),!0).forEach(function(n){xH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xH(e,t,r){return(t=gH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gH(e){var t=vH(e,"string");return typeof t=="symbol"?t:t+""}function vH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ip(e,t){if(e==null)return{};var r,n,a=bH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yH(e){var t=Ot(),r=m.useRef(null),n=lS(),{type:a}=e,i=Ip(e,hH),s=Vd(n,"xAxis",a),l=m.useMemo(()=>{if(s!=null)return zw(zw({},i),{},{type:s})},[i,s]);return m.useLayoutEffect(()=>{l!=null&&(r.current===null?t(Z9(l)):r.current!==l&&t(J9({prev:r.current,next:l})),r.current=l)},[l,t]),m.useLayoutEffect(()=>()=>{r.current&&(t(Q9(r.current)),r.current=null)},[t]),null}var wH=e=>{var{xAxisId:t,className:r}=e,n=Fe(Pm),a=Ir(),i="xAxis",s=Fe(b=>tj(b,i,t,a)),l=Fe(b=>ZE(b,t)),c=Fe(b=>UM(b,t)),u=Fe(b=>OE(b,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:h}=e,p=Ip(e,pH),{id:x,scale:g}=u,v=Ip(u,mH);return m.createElement(cg,Dp({},p,v,{x:c.x,y:c.y,width:l.width,height:l.height,className:lt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:s,axisType:i}))},NH={allowDataOverflow:ar.allowDataOverflow,allowDecimals:ar.allowDecimals,allowDuplicatedCategory:ar.allowDuplicatedCategory,angle:ar.angle,axisLine:Pa.axisLine,height:ar.height,hide:!1,includeHidden:ar.includeHidden,interval:ar.interval,label:!1,minTickGap:ar.minTickGap,mirror:ar.mirror,orientation:ar.orientation,padding:ar.padding,reversed:ar.reversed,scale:ar.scale,tick:ar.tick,tickCount:ar.tickCount,tickLine:Pa.tickLine,tickSize:Pa.tickSize,type:ar.type,xAxisId:0},_H=e=>{var t=ur(e,NH);return m.createElement(m.Fragment,null,m.createElement(yH,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),m.createElement(wH,t))},hg=m.memo(_H,_5);hg.displayName="XAxis";var SH=["type"],EH=["dangerouslySetInnerHTML","ticks","scale"],jH=["id","scale"];function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rp.apply(null,arguments)}function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(n){TH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TH(e,t,r){return(t=CH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CH(e){var t=kH(e,"string");return typeof t=="symbol"?t:t+""}function kH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mp(e,t){if(e==null)return{};var r,n,a=AH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PH(e){var t=Ot(),r=m.useRef(null),n=lS(),{type:a}=e,i=Mp(e,SH),s=Vd(n,"yAxis",a),l=m.useMemo(()=>{if(s!=null)return Vw(Vw({},i),{},{type:s})},[s,i]);return m.useLayoutEffect(()=>{l!=null&&(r.current===null?t(eB(l)):r.current!==l&&t(tB({prev:r.current,next:l})),r.current=l)},[l,t]),m.useLayoutEffect(()=>()=>{r.current&&(t(rB(r.current)),r.current=null)},[t]),null}function OH(e){var{yAxisId:t,className:r,width:n,label:a}=e,i=m.useRef(null),s=m.useRef(null),l=Fe(Pm),c=Ir(),u=Ot(),d="yAxis",f=Fe(E=>JE(E,t)),h=Fe(E=>zM(E,t)),p=Fe(E=>tj(E,d,t,c)),x=Fe(E=>DE(E,t));if(m.useLayoutEffect(()=>{if(!(n!=="auto"||!f||qx(a)||m.isValidElement(a)||x==null)){var E=i.current;if(E){var _=E.getCalculatedWidth();Math.round(f.width)!==Math.round(_)&&u(nB({id:t,width:_}))}}},[p,f,u,a,t,n,x]),f==null||h==null||x==null)return null;var{dangerouslySetInnerHTML:g,ticks:v,scale:b}=e,w=Mp(e,EH),{id:y,scale:N}=x,S=Mp(x,jH);return m.createElement(cg,Rp({},w,S,{ref:i,labelRef:s,x:h.x,y:h.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:lt("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:p,axisType:d}))}var DH={allowDataOverflow:ir.allowDataOverflow,allowDecimals:ir.allowDecimals,allowDuplicatedCategory:ir.allowDuplicatedCategory,angle:ir.angle,axisLine:Pa.axisLine,hide:!1,includeHidden:ir.includeHidden,interval:ir.interval,label:!1,minTickGap:ir.minTickGap,mirror:ir.mirror,orientation:ir.orientation,padding:ir.padding,reversed:ir.reversed,scale:ir.scale,tick:ir.tick,tickCount:ir.tickCount,tickLine:Pa.tickLine,tickSize:Pa.tickSize,type:ir.type,width:ir.width,yAxisId:0},IH=e=>{var t=ur(e,DH);return m.createElement(m.Fragment,null,m.createElement(PH,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),m.createElement(OH,t))},pg=m.memo(IH,_5);pg.displayName="YAxis";var RH=(e,t)=>t,mg=Q([RH,at,kE,fr,vj,Ja,i8,tr],f8),xg=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},S5=Pn("mouseClick"),E5=Tl();E5.startListening({actionCreator:S5,effect:(e,t)=>{var r=e.payload,n=mg(t.getState(),xg(r));n?.activeIndex!=null&&t.dispatch(nF({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Fp=Pn("mouseMove"),j5=Tl(),mc=null;j5.startListening({actionCreator:Fp,effect:(e,t)=>{var r=e.payload;mc!==null&&cancelAnimationFrame(mc);var n=xg(r);mc=requestAnimationFrame(()=>{var a=t.getState(),i=Fx(a,a.tooltip.settings.shared);if(i==="axis"){var s=mg(a,n);s?.activeIndex!=null?t.dispatch(cj({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(lj())}mc=null})}});function MH(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var Kw={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},T5=nn({name:"rootProps",initialState:Kw,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Kw.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),FH=T5.reducer,{updateOptions:LH}=T5.actions,BH=null,$H={updatePolarOptions:(e,t)=>t.payload},C5=nn({name:"polarOptions",initialState:BH,reducers:$H}),{updatePolarOptions:UH}=C5.actions,HH=C5.reducer,k5=Pn("keyDown"),A5=Pn("focus"),gg=Tl();gg.startListening({actionCreator:k5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Lx(a,po(r),$l(r),Hl(r)),l=s==null?-1:Number(s);if(!(!Number.isFinite(l)||l<0)){var c=Ja(r);if(i==="Enter"){var u=Au(r,"axis","hover",String(a.index));t.dispatch(Ep({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=GM(r),f=d==="left-to-right"?1:-1,h=i==="ArrowRight"?1:-1,p=l+h*f;if(!(c==null||p>=c.length||p<0)){var x=Au(r,"axis","hover",String(p));t.dispatch(Ep({active:!0,activeIndex:p.toString(),activeCoordinate:x}))}}}}}});gg.startListening({actionCreator:A5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=Au(r,"axis","hover",String(i));t.dispatch(Ep({active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Nn=Pn("externalEvent"),P5=Tl(),nh=new Map;P5.startListening({actionCreator:Nn,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,i=nh.get(a);i!==void 0&&cancelAnimationFrame(i);var s=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:zF(l),activeDataKey:zx(l),activeIndex:pi(l),activeLabel:wj(l),activeTooltipIndex:pi(l),isTooltipActive:WF(l)};r(c,n)}finally{nh.delete(a)}});nh.set(a,s)}}});var zH=Q([fo],e=>e.tooltipItemPayloads),WH=Q([zH,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(i=>i.settings.graphicalItemId===r);if(n!=null){var{getPosition:a}=n;if(a!=null)return a(t)}}}),O5=Pn("touchMove"),D5=Tl();D5.startListening({actionCreator:O5,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=Fx(n,n.tooltip.settings.shared);if(a==="axis"){var i=r.touches[0];if(i==null)return;var s=mg(n,xg({clientX:i.clientX,clientY:i.clientY,currentTarget:r.currentTarget}));s?.activeIndex!=null&&t.dispatch(cj({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(eS),f=(l=u.getAttribute(tS))!==null&&l!==void 0?l:void 0,h=ho(n).find(g=>g.id===f);if(d==null||h==null||f==null)return;var{dataKey:p}=h,x=WH(n,d,f);t.dispatch(oj({activeDataKey:p,activeIndex:d,activeCoordinate:x,activeGraphicalItemId:f}))}}}});var VH=N_({brush:NB,cartesianAxis:aB,chartData:z8,errorBars:x$,graphicalItems:d9,layout:PO,legend:M3,options:L8,polarAxis:E7,polarOptions:HH,referenceElements:jB,rootProps:FH,tooltip:aF,zIndex:j8}),KH=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return rO({reducer:VH,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([E5.middleware,j5.middleware,gg.middleware,P5.middleware,D5.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(F_({type:"raf"}))},devTools:{serialize:{replacer:MH},name:"recharts-".concat(r)}})};function I5(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Ir(),i=m.useRef(null);if(a)return r;i.current==null&&(i.current=KH(t,n));var s=Sm;return m.createElement(V$,{context:s,store:i.current},r)}function GH(e){var{layout:t,margin:r}=e,n=Ot(),a=Ir();return m.useEffect(()=>{a||(n(CO(t)),n(TO(r)))},[n,a,t,r]),null}var R5=m.memo(GH,s0);function M5(e){var t=Ot();return m.useEffect(()=>{t(LH(e))},[t,e]),null}function Gw(e){var{zIndex:t,isPanorama:r}=e,n=m.useRef(null),a=Ot();return m.useLayoutEffect(()=>(n.current&&a(S8({zIndex:t,element:n.current,isPanorama:r})),()=>{a(E8({zIndex:t,isPanorama:r}))}),[a,t,r]),m.createElement("g",{tabIndex:-1,ref:n})}function Xw(e){var{children:t,isPanorama:r}=e,n=Fe(p8);if(!n||n.length===0)return t;var a=n.filter(s=>s<0),i=n.filter(s=>s>0);return m.createElement(m.Fragment,null,a.map(s=>m.createElement(Gw,{key:s,zIndex:s,isPanorama:r})),t,i.map(s=>m.createElement(Gw,{key:s,zIndex:s,isPanorama:r})))}var XH=["children"];function YH(e,t){if(e==null)return{};var r,n,a=qH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Lu(){return Lu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lu.apply(null,arguments)}var ZH={width:"100%",height:"100%",display:"block"},JH=m.forwardRef((e,t)=>{var r=sS(),n=oS(),a=yS();if(!fa(r)||!fa(n))return null;var{children:i,otherAttributes:s,title:l,desc:c}=e,u,d;return s!=null&&(typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?d=s.role:d=a?"application":void 0),m.createElement($N,Lu({},s,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:ZH,ref:t}),i)}),QH=e=>{var{children:t}=e,r=Fe(Pd);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return m.createElement($N,{width:n,height:a,x:s,y:i},t)},Yw=m.forwardRef((e,t)=>{var{children:r}=e,n=YH(e,XH),a=Ir();return a?m.createElement(QH,null,m.createElement(Xw,{isPanorama:!0},r)):m.createElement(JH,Lu({ref:t},n),m.createElement(Xw,{isPanorama:!1},r))});function ez(){var e=Ot(),[t,r]=m.useState(null),n=Fe(XO);return m.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;et(i)&&i!==n&&e(AO(i))}},[t,e,n]),r}function qw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qw(Object(r),!0).forEach(function(n){rz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rz(e,t,r){return(t=nz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nz(e){var t=az(e,"string");return typeof t=="symbol"?t:t+""}function az(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ci(){return ci=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ci.apply(null,arguments)}var iz=()=>(J8(),null);function Bu(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var sz=m.forwardRef((e,t)=>{var r,n,a=m.useRef(null),[i,s]=m.useState({containerWidth:Bu((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Bu((n=e.style)===null||n===void 0?void 0:n.height)}),l=m.useCallback((u,d)=>{s(f=>{var h=Math.round(u),p=Math.round(d);return f.containerWidth===h&&f.containerHeight===p?f:{containerWidth:h,containerHeight:p}})},[]),c=m.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var h=x=>{var g=x[0];if(g!=null){var{width:v,height:b}=g.contentRect;l(v,b)}},p=new ResizeObserver(h);p.observe(u),a.current=p}},[t,l]);return m.useEffect(()=>()=>{var u=a.current;u?.disconnect()},[l]),m.createElement(m.Fragment,null,m.createElement(kl,{width:i.containerWidth,height:i.containerHeight}),m.createElement("div",ci({ref:c},e)))}),oz=m.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=m.useState({containerWidth:Bu(r),containerHeight:Bu(n)}),s=m.useCallback((c,u)=>{i(d=>{var f=Math.round(c),h=Math.round(u);return d.containerWidth===f&&d.containerHeight===h?d:{containerWidth:f,containerHeight:h}})},[]),l=m.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();s(u,d)}},[t,s]);return m.createElement(m.Fragment,null,m.createElement(kl,{width:a.containerWidth,height:a.containerHeight}),m.createElement("div",ci({ref:l},e)))}),lz=m.forwardRef((e,t)=>{var{width:r,height:n}=e;return m.createElement(m.Fragment,null,m.createElement(kl,{width:r,height:n}),m.createElement("div",ci({ref:t},e)))}),cz=m.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?m.createElement(oz,ci({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?m.createElement(lz,ci({},e,{width:r,height:n,ref:t})):m.createElement(m.Fragment,null,m.createElement(kl,{width:r,height:n}),m.createElement("div",ci({ref:t},e)))});function uz(e){return e?sz:cz}var dz=m.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:p,onTouchMove:x,onTouchStart:g,style:v,width:b,responsive:w,dispatchTouchEvents:y=!0}=e,N=m.useRef(null),S=Ot(),[E,_]=m.useState(null),[j,A]=m.useState(null),T=ez(),k=Om(),C=k?.width>0?k.width:b,L=k?.height>0?k.height:a,G=m.useCallback(I=>{T(I),typeof t=="function"&&t(I),_(I),A(I),I!=null&&(N.current=I)},[T,t,_,A]),V=m.useCallback(I=>{S(S5(I)),S(Nn({handler:i,reactEvent:I}))},[S,i]),X=m.useCallback(I=>{S(Fp(I)),S(Nn({handler:u,reactEvent:I}))},[S,u]),K=m.useCallback(I=>{S(lj()),S(Nn({handler:d,reactEvent:I}))},[S,d]),Y=m.useCallback(I=>{S(Fp(I)),S(Nn({handler:f,reactEvent:I}))},[S,f]),q=m.useCallback(()=>{S(A5())},[S]),Z=m.useCallback(I=>{S(k5(I.key))},[S]),le=m.useCallback(I=>{S(Nn({handler:s,reactEvent:I}))},[S,s]),ce=m.useCallback(I=>{S(Nn({handler:l,reactEvent:I}))},[S,l]),me=m.useCallback(I=>{S(Nn({handler:c,reactEvent:I}))},[S,c]),Ne=m.useCallback(I=>{S(Nn({handler:h,reactEvent:I}))},[S,h]),ee=m.useCallback(I=>{S(Nn({handler:g,reactEvent:I}))},[S,g]),oe=m.useCallback(I=>{y&&S(O5(I)),S(Nn({handler:x,reactEvent:I}))},[S,y,x]),fe=m.useCallback(I=>{S(Nn({handler:p,reactEvent:I}))},[S,p]),O=uz(w);return m.createElement(Cj.Provider,{value:E},m.createElement(Mk.Provider,{value:j},m.createElement(O,{width:C??v?.width,height:L??v?.height,className:lt("recharts-wrapper",n),style:tz({position:"relative",cursor:"default",width:C,height:L},v),onClick:V,onContextMenu:le,onDoubleClick:ce,onFocus:q,onKeyDown:Z,onMouseDown:me,onMouseEnter:X,onMouseLeave:K,onMouseMove:Y,onMouseUp:Ne,onTouchEnd:fe,onTouchMove:oe,onTouchStart:ee,ref:G},m.createElement(iz,null),r)))}),fz=["width","height","responsive","children","className","style","compact","title","desc"];function hz(e,t){if(e==null)return{};var r,n,a=pz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var F5=m.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:l,compact:c,title:u,desc:d}=e,f=hz(e,fz),h=xn(f);return c?m.createElement(m.Fragment,null,m.createElement(kl,{width:r,height:n}),m.createElement(Yw,{otherAttributes:h,title:u,desc:d},i)):m.createElement(dz,{className:s,style:l,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},m.createElement(Yw,{otherAttributes:h,title:u,desc:d,ref:t},m.createElement(CB,null,i)))});function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lp.apply(null,arguments)}var mz={top:5,right:5,bottom:5,left:5},xz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:mz,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},L5=m.forwardRef(function(t,r){var n,a=ur(t.categoricalChartProps,xz),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return m.createElement(I5,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:i},m.createElement(a5,{chartData:u.data}),m.createElement(R5,{layout:a.layout,margin:a.margin}),m.createElement(M5,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),m.createElement(F5,Lp({},a,{ref:r})))}),gz=["axis"],vz=m.forwardRef((e,t)=>m.createElement(L5,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:gz,tooltipPayloadSearcher:Xx,categoricalChartProps:e,ref:t})),bz=["axis","item"],yz=m.forwardRef((e,t)=>m.createElement(L5,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bz,tooltipPayloadSearcher:Xx,categoricalChartProps:e,ref:t}));function wz(e){var t=Ot();return m.useEffect(()=>{t(UH(e))},[t,e]),null}var Nz=["layout"];function Bp(){return Bp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bp.apply(null,arguments)}function _z(e,t){if(e==null)return{};var r,n,a=Sz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Sz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Ez={top:5,right:5,bottom:5,left:5},B5={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Ez,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},jz=m.forwardRef(function(t,r){var n,a=ur(t.categoricalChartProps,B5),{layout:i}=a,s=_z(a,Nz),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return m.createElement(I5,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},m.createElement(a5,{chartData:a.data}),m.createElement(R5,{layout:i,margin:a.margin}),m.createElement(M5,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),m.createElement(wz,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),m.createElement(F5,Bp({},s,{ref:r})))});function Zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zw(Object(r),!0).forEach(function(n){Tz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tz(e,t,r){return(t=Cz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cz(e){var t=kz(e,"string");return typeof t=="symbol"?t:t+""}function kz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Az=["item"],Pz=Jw(Jw({},B5),{},{layout:"centric",startAngle:0,endAngle:360}),Oz=m.forwardRef((e,t)=>{var r=ur(e,Pz);return m.createElement(jz,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Az,tooltipPayloadSearcher:Xx,categoricalChartProps:r,ref:t})});const Qr={UNPAID:"Chưa Thanh Toán",PROCESSING:"Đang Xử Lý",PAID:"Đã Thanh Toán",REFUNDED:"Đã Hoàn",PENDING_REFUND:"Chờ Hoàn",EXPIRED:"Hết Hạn",RENEWAL:"Cần Gia Hạn"},It={idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status"},_s={orderCode:"id_order",paidDate:"payment_date",amount:"amount",receiver:"receiver",note:"note",sender:"sender"},ah={id:"id",sourceName:"supplier_name"},ih={sourceId:"supplier_id",price:"price"},zt={code:"id_product",packageName:"package",variantName:"package_product",pctCtv:"pct_ctv",pctKhach:"pct_khach",pctPromo:"pct_promo",isActive:"is_active",updatedAt:"update"},Dz=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},Ha=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),a=String(r.getUTCMonth()+1).padStart(2,"0"),i=r.getUTCFullYear();return`${n}/${a}/${i}`},$5=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,a,i]=e.split("/").map(Number),s=new Date(i,a-1,n);return s.setMonth(s.getMonth()+t),s.setDate(s.getDate()-1),`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()}`},Iz=(e,t)=>{const[r,n,a]=e.split("/").map(Number),[i,s,l]=t.split("/").map(Number),c=new Date(a,n-1,r),u=new Date(l,s-1,i),d=1440*60*1e3;return Math.floor((u.getTime()-c.getTime())/d)+1},Qw=e=>String(e).padStart(2,"0"),vg=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[a,i,s]=t.split("/").map(Number);return!a||!i||!s?null:new Date(s,i-1,a)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r.map(Number);return!s||!i||!a?null:new Date(a,i-1,s)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},yt=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r;return`${s}/${i}/${a}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,a,i,s]=n;return`${s}/${i}/${a}`}}const t=vg(e);return t?`${Qw(t.getDate())}/${Qw(t.getMonth()+1)}/${t.getFullYear()}`:""},Rz=e=>{const t=vg(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},U5=e=>{const t=vg(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},$u=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},Mz=e=>{if(!Number.isFinite(e)||e<=0)return 0;const t=Math.floor(e/12),r=e%12;return t*365+r*30},H5=e=>{const t=Number(e);return Number.isFinite(t)?t:0},kn=e=>{const t=H5(e),r=1e3;return Number.isFinite(t)?Math.round(t/r)*r:0},Tn=e=>`${kn(e).toLocaleString("vi-VN")} ₫`,e2=e=>{const t=H5(e);return t>0?t.toLocaleString("vi-VN"):""},z5=e=>{const t=e.replace(/[^\d]/g,"");if(!t)return"";const r=parseInt(t,10);return isNaN(r)?"":r.toLocaleString("vi-VN").replace(/,/g,".")},Fz=e=>{let t=e.replace(/,/g,".");t=t.replace(/[^\d.]/g,"");const r=t.split(".");return r.length>2&&(t=r[0]+"."+r.slice(1).join("")),t},Lz=e=>!Number.isFinite(e)||e<=0?"₫0":e>=1e9?`₫${(e/1e9).toFixed(1)}B`:e>=1e6?`₫${(e/1e6).toFixed(1)}M`:e>=1e3?`₫${(e/1e3).toFixed(1)}K`:`₫${Math.round(e).toLocaleString("vi-VN")}`,Bz=(e,t,r=[])=>{const n=e||"";if(!n)return;const a=r.find(l=>(l[ah.sourceName]||l.name||"")===n)?.[ah.id]??null;if(a!==null){const c=t.find(u=>u[ih.sourceId]===a)?.[ih.price];if(Number.isFinite(c))return Number(c)}const s=t.find(l=>(l[ah.sourceName]||"")===n)?.[ih.price];return Number.isFinite(s)?Number(s):void 0},t2=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),W5=e=>V5(e).color,r2=e=>V5(e).priority,$z={[Qr.EXPIRED]:{color:"bg-red-600 text-white",priority:1},[Qr.RENEWAL]:{color:"bg-orange-500 text-white",priority:2},[Qr.UNPAID]:{color:"bg-yellow-500 text-slate-900",priority:3},[Qr.PROCESSING]:{color:"bg-sky-500 text-white",priority:4},[Qr.PAID]:{color:"bg-green-600 text-white",priority:5},[Qr.PENDING_REFUND]:{color:"bg-rose-500 text-white",priority:6},[Qr.REFUNDED]:{color:"bg-slate-600 text-white",priority:7}},V5=e=>$z[e?.trim()]||{color:"bg-slate-600 text-white",priority:5},o0=({accountNumber:e,bankCode:t,amount:r,description:n,accountName:a})=>{const i=(e||"").trim(),s=(t||"").trim();if(!i||!s)return"";const l=new URLSearchParams,c=Number(r);Number.isFinite(c)&&c>0&&l.set("amount",Math.round(c).toString());const u=(n||"").trim();u&&l.set("addInfo",u);const d=(a||"").trim();d&&l.set("accountName",d);const f=l.toString();return`https://img.vietqr.io/image/${s}-${i}-compact.png${f?`?${f}`:""}`},K5=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},Uz=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,a]=m.useState(""),[i,s]=m.useState(""),[l,c]=m.useState(!1),[u,d]=m.useState(null),f=async g=>{if(g.preventDefault(),d(null),!n.trim()){d("Vui lòng nhập tên mục tiêu");return}const v=Number(i.replace(/\./g,""));if(!v||v<=0){d("Số tiền mục tiêu phải lớn hơn 0");return}c(!0);try{const b=await fetch("/api/saving-goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goal_name:n.trim(),target_amount:v})});if(!b.ok){const w=await b.json();throw new Error(w.error||"Không thể tạo mục tiêu")}a(""),s(""),r(),t()}catch(b){d(b instanceof Error?b.message:"Lỗi không xác định")}finally{c(!1)}},h=g=>{s(z5(g))},p=i;if(!e)return null;const x=o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:o.jsxs("div",{className:"relative w-full max-w-md mx-4 rounded-3xl bg-gradient-to-br from-slate-900 to-slate-950 border border-white/10 p-6 shadow-2xl",children:[o.jsx("button",{onClick:t,className:"absolute right-4 top-4 rounded-full p-2 text-white/60 hover:bg-white/10 hover:text-white transition-colors",children:o.jsx(Pt,{className:"h-5 w-5"})}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Thêm Mục Tiêu Mới"}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"goalName",className:"block text-sm font-medium text-white/80 mb-2",children:"Tên mục tiêu"}),o.jsx("input",{id:"goalName",type:"text",value:n,onChange:g=>a(g.target.value),placeholder:"Ví dụ: Laptop mới, Du lịch...",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:l})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"targetAmount",className:"block text-sm font-medium text-white/80 mb-2",children:"Số tiền mục tiêu"}),o.jsx("input",{id:"targetAmount",type:"text",value:p,onChange:g=>h(g.target.value),placeholder:"0",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:l})]}),u&&o.jsx("div",{className:"rounded-lg bg-red-500/10 border border-red-500/20 px-4 py-3 text-sm text-red-400",children:u}),o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:t,className:"flex-1 rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-sm font-semibold text-white hover:bg-white/10 transition-colors",disabled:l,children:"Hủy"}),o.jsx("button",{type:"submit",className:"flex-1 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3 text-sm font-semibold text-white hover:from-indigo-500 hover:to-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?"Đang lưu...":"Thêm mục tiêu"})]})]})]})});return V4.createPortal(x,document.body)},$p="app-notification",Tr=e=>{typeof window>"u"||window.dispatchEvent(new CustomEvent($p,{detail:e}))},xc=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],Hz=({budgets:e,walletColumns:t,walletRows:r,currencyFormatter:n,goldValue:a})=>{const i=r?.[0],s=m.useMemo(()=>{const u=a&&a>0?[{name:"Vàng (quy VND)",value:a,color:"#FBBF24"}]:[];if(i){const d=t.filter(f=>{const h=String(f.assetCode||"").trim().toUpperCase();return!(String(f.name||"").toLowerCase().includes("hana")||h&&h!=="VND")}).map((f,h)=>({name:f.name||f.field,value:Math.max(0,Number(i.values[f.field]||0)),color:xc[h%xc.length]})).filter(f=>f.value>0);if(d.length)return[...d,...u]}return[...e.map((d,f)=>({name:d.name,value:Math.max(0,d.used),color:xc[f%xc.length]})).filter(d=>d.value>0),...u]},[e,t,i,a]),l=m.useMemo(()=>s.reduce((u,d)=>u+d.value,0),[s]),c=({payload:u})=>{if(!u||u.length===0)return null;const d=u[0],f=Number(d?.value||0),h=l>0?Math.round(f/l*100):0;return o.jsxs("div",{className:"rounded-lg border border-white/10 bg-slate-900/90 px-3 py-2 text-xs text-white shadow-lg",children:[o.jsx("div",{className:"font-semibold",children:d?.name}),o.jsx("div",{children:n.format(f)}),o.jsxs("div",{className:"text-white/70",children:[h,"%"]})]})};return o.jsxs("div",{className:"relative h-72 w-full",children:[o.jsx("div",{className:"absolute inset-0 rounded-2xl border border-white/20 bg-gradient-to-br from-indigo-900 via-slate-900 to-slate-950 shadow-inner shadow-slate-900/50"}),o.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center text-white/70",children:s.length===0?o.jsx("div",{className:"text-sm",children:"Chưa có dữ liệu chi tiêu"}):o.jsxs(o.Fragment,{children:[o.jsx(Dm,{width:"100%",height:"100%",children:o.jsxs(Oz,{children:[o.jsx(t5,{data:s,dataKey:"value",nameKey:"name",innerRadius:75,outerRadius:100,children:s.map((u,d)=>o.jsx(Wl,{fill:u.color,stroke:"transparent"},`${u.name}-${d}`))}),o.jsx(Yx,{content:c})]})}),l>0&&o.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-white",children:[o.jsx("div",{className:"text-xs uppercase tracking-wide text-white/80",children:"Tài sản"}),o.jsx("div",{className:"text-lg font-bold",children:n.format(l)})]})})]})})]})},gc=({title:e,value:t,change:r,icon:n})=>{const a=r>=0,i=a?um:cm;return o.jsxs("div",{className:"bg-gradient-to-br from-indigo-950/80 to-purple-950/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:border-white/20 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("div",{className:"p-2 bg-white/5 rounded-lg border border-white/10",children:o.jsx(n,{className:"h-5 w-5 text-indigo-400"})}),o.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold ${a?"bg-emerald-500/20 text-emerald-400":"bg-rose-500/20 text-rose-400"}`,children:[o.jsx(i,{className:"h-3 w-3"}),Math.abs(r),"%"]})]}),o.jsxs("div",{className:"space-y-0.5",children:[o.jsx("p",{className:"text-2xl font-bold text-white",children:t}),o.jsx("p",{className:"text-xs text-white/60",children:e})]})]})},zz=({budgets:e,savingGoals:t,currencyFormatter:r,walletColumns:n,walletRows:a,goldValue:i,goldCost:s,onRefetchGoals:l})=>{const[c,u]=m.useState(!1),d=async(g,v)=>{const b=t.find(N=>N.id===g);if(!b)return;const w=v==="down"?(b.priority||0)+1:(b.priority||0)-1,y=t.find(N=>N.id!==g&&N.priority===w);try{const N=[];if(N.push(fetch(`/api/saving-goals/${b.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:w})})),y){const S=v==="down"?y.priority-1:y.priority+1;N.push(fetch(`/api/saving-goals/${y.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:S})}))}await Promise.all(N),l&&l()}catch(N){console.error("Error reordering goal:",N);const{handleNetworkError:S}=await Vc(async()=>{const{handleNetworkError:E}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:E}},[]);Tr({type:"error",title:"Lỗi sắp xếp mục tiêu",message:S(N)})}},f=async g=>{if(confirm("Bạn có chắc muốn xóa mục tiêu này?"))try{if(!(await fetch(`/api/saving-goals/${g}`,{method:"DELETE"})).ok)throw new Error("Failed to delete goal");l&&l()}catch(v){console.error("Error deleting goal:",v);const{handleNetworkError:b}=await Vc(async()=>{const{handleNetworkError:w}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:w}},[]);Tr({type:"error",title:"Lỗi xóa mục tiêu",message:b(v)})}},h=m.useMemo(()=>{const g=a?.[0];let v=0;if(g){const S=n.find(E=>{const _=String(E.name||"").toLowerCase();return _.includes("quỹ")||_.includes("quy")});S&&(v=Number(g.values[S.field]||0)||0)}const b=t.reduce((S,E)=>S+(Number(E.target_amount)||0),0),w=v,y=Math.max(0,b-w),N=b>0?w/b*100:0;return{totalSaved:w,totalTarget:b,totalRemaining:y,progress:Math.min(100,Math.max(0,N))}},[t,a,n]),p=m.useMemo(()=>{if(h.totalTarget<=0)return[];let g=0;return t.map((v,b)=>{g+=Number(v.target_amount)||0;const w=g/h.totalTarget*100,y=Math.min(100,Math.max(0,w));return{index:b+1,position:y}})},[t,h.totalTarget]),x=m.useMemo(()=>{const g=a?.[0],v=a?.[1],b=S=>{if(!S)return{cash:0,gold:0,investment:0,total:0};const E=n.find(C=>{const L=String(C.name||"").toLowerCase();return L.includes("quỹ")||L.includes("quy")}),_=n.find(C=>{const L=String(C.name||"").toLowerCase();return L.includes("vàng")||L.includes("gold")||L.includes("vang")}),A=n.filter(C=>{const L=String(C.assetCode||"").trim().toUpperCase(),G=String(C.name||"").toLowerCase();return G.includes("hana")||G.includes("gold")||G.includes("vàng")||G.includes("vang")||E&&C.field===E.field?!1:!L||L==="VND"}).reduce((C,L)=>C+(Number(S.values[L.field]||0)||0),0),T=E&&Number(S.values[E.field]||0)||0,k=_&&Number(S.values[_.field]||0)||0;return{cash:A,gold:k,investment:T,total:A+k+T}},w=b(g),y=b(v);i!=null&&(w.gold=i,w.total=w.cash+w.gold+w.investment);const N=(S,E)=>E===0?S>0?100:0:Number(((S-E)/E*100).toFixed(1));if(s&&w.gold>0){w.total=w.cash+w.gold+w.investment;const S=Number(((w.gold-s)/s*100).toFixed(1));return{current:w,changes:{cash:N(w.cash,y.cash),gold:S,investment:N(w.investment,y.investment),total:N(w.total,y.total)}}}return{current:w,changes:{cash:N(w.cash,y.cash),gold:N(w.gold,y.gold),investment:N(w.investment,y.investment),total:N(w.total,y.total)}}},[a,n,i,s]);return o.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[o.jsxs("div",{className:"rounded-3xl bg-white/70 p-6 space-y-6 shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiêu hàng tháng"}),o.jsx("p",{className:"text-xs text-white/70",children:"Tổng quan tháng hiện tại"})]}),o.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-indigo-500/30 px-3 py-1 text-xs font-semibold text-white shadow-inner shadow-indigo-900/30",children:[o.jsx(Zg,{className:"h-4 w-4"}),o.jsx("span",{children:"Đang theo dõi"})]})]}),o.jsx(Hz,{budgets:e,walletColumns:n,walletRows:a,currencyFormatter:r,goldValue:i}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsx(gc,{title:"Tiền Mặt",value:r.format(x.current.cash),change:x.changes.cash,icon:mC}),o.jsx(gc,{title:"Vàng",value:r.format(x.current.gold),change:x.changes.gold,icon:mk}),o.jsx(gc,{title:"Đầu Tư",value:r.format(x.current.investment),change:x.changes.investment,icon:Yo}),o.jsx(gc,{title:"Tổng Tài Sản",value:r.format(x.current.total),change:x.changes.total,icon:ik})]})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"space-y-4 rounded-3xl bg-white/70 p-5 shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Mục tiêu tiết kiệm"}),o.jsx("p",{className:"text-xs text-white/70",children:"Theo dõi tiến độ theo từng hàng mục"})]}),o.jsx(Zg,{className:"h-5 w-5 text-white/70"})]}),o.jsxs("div",{className:"rounded-2xl border border-white/30 bg-white/60 p-4 shadow-[0_16px_32px_-28px_rgba(0,0,0,0.4)]",children:[o.jsxs("div",{className:"flex items-start justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wide text-white/80",children:"Tổng quan"}),o.jsx("p",{className:"text-2xl font-semibold text-white",children:r.format(h.totalSaved)}),o.jsxs("p",{className:"text-xs text-white/70",children:[r.format(h.totalTarget)," mục tiêu : ",t.length," hạng mục"]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-xs text-white/60",children:"Còn lại"}),o.jsx("p",{className:"text-sm font-semibold text-white",children:r.format(h.totalRemaining)})]})]}),o.jsxs("div",{className:"mt-3 relative h-6",children:[o.jsx("div",{className:"absolute inset-x-0 top-1/2 h-2 -translate-y-1/2 overflow-hidden rounded-full bg-white/20",children:o.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-amber-300 via-rose-300 to-emerald-200 shadow-[0_0_14px_rgba(251,191,36,0.55)]",style:{width:`${h.progress}%`}})}),p.map(g=>o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${g.position}%`},children:o.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border border-white/70 bg-slate-900/90 text-[11px] font-semibold text-white shadow-[0_8px_16px_-12px_rgba(0,0,0,0.55)]",children:g.index})},`milestone-${g.index}`))]}),o.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[o.jsxs("span",{children:[h.progress.toFixed(2),"%"]}),o.jsxs("span",{children:["Đã đạt ",r.format(h.totalSaved)]})]})]}),o.jsx("div",{className:"space-y-3",children:t.length===0?o.jsx("div",{className:"rounded-2xl border border-dashed border-white/40 bg-white/40 px-4 py-3 text-xs text-white/70",children:"Chưa có mục tiêu tiết kiệm nào."}):t.map((g,v)=>{const b=Number(g.target_amount)||0,w=h.totalSaved,y=b>0?Math.min(100,w/b*100):0,N=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],S=N[v%N.length];return o.jsxs("div",{className:"rounded-2xl border border-white/35 bg-white/60 p-3 shadow-[0_12px_28px_-26px_rgba(0,0,0,0.35)]",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-white/20 text-[11px] font-semibold text-white/80",children:v+1}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:g.goal_name}),o.jsxs("p",{className:"text-xs text-white/75",children:[r.format(w)," / ",r.format(b)]})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>d(g.id,"up"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Tăng ưu tiên",children:o.jsx(Yo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>d(g.id,"down"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Giảm ưu tiên",children:o.jsx(cm,{className:"h-4 w-4"})}),o.jsx("div",{className:"h-4 w-px bg-white/20 mx-0.5"}),o.jsx("button",{onClick:()=>f(g.id),className:"rounded-lg p-1.5 text-white/60 hover:bg-red-400/80 hover:text-white transition-colors",title:"Xóa mục tiêu",children:o.jsx(Kr,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"mt-3 h-2 overflow-hidden rounded-full bg-white/20",children:o.jsx("div",{className:"h-full rounded-full",style:{width:`${y}%`,background:`linear-gradient(90deg, ${S}, rgba(255,255,255,0.85))`}})}),o.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[o.jsxs("span",{children:[y.toFixed(2),"%"]}),o.jsxs("span",{children:["Đã đạt ",r.format(w)]})]})]},g.id)})}),o.jsx("button",{type:"button",onClick:()=>u(!0),className:"w-full rounded-xl border border-white/30 bg-slate-900/80 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-24px_rgba(0,0,0,0.45)] transition-colors hover:bg-slate-900",children:"Thêm mục tiêu mới"})]})}),o.jsx(Uz,{isOpen:c,onClose:()=>u(!1),onSuccess:()=>{l&&l()}})]})},Wz=({labels:e,totalWallet5:t,currencyFormatter:r,adding:n,onToggleAdd:a})=>o.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),t!==null&&o.jsxs("p",{className:"text-xs text-white/70",children:[e.totalWallet5Label," ",r.format(t)]})]}),o.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20",children:[n?o.jsx(Pt,{className:"h-4 w-4"}):o.jsx(di,{className:"h-4 w-4"}),n?e.closeLabel:e.addLabel]})]}),Vz=({displayColumns:e,rows:t,adding:r,newDate:n,newValues:a,loading:i,onDateChange:s,onValueChange:l,onSave:c,onCancel:u,formatDate:d,formatValue:f,resolveValue:h,labels:p})=>o.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:o.jsxs("table",{className:"min-w-full text-sm text-white",children:[o.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-center",children:p.dateHeader}),e.map(x=>o.jsx("th",{className:"px-3 py-2 text-center",children:x.name||x.field},x.field))]})}),o.jsxs("tbody",{className:"divide-y divide-white/10",children:[r&&o.jsxs(o.Fragment,{children:[o.jsxs("tr",{className:"bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("input",{type:"date",className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:n,onChange:x=>s(x.target.value)})}),e.map(x=>x.sourceFields&&x.sourceFields.length?o.jsx("td",{className:"px-3 py-2 text-center whitespace-pre-line",children:o.jsx("div",{className:"flex flex-col gap-1",children:x.sourceFields.map(g=>o.jsx("input",{className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white text-center focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all placeholder:text-white/20",placeholder:g,value:a[g]||"",onChange:v=>l(g,v.target.value)},g))})},x.field):o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("input",{className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white text-center focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all placeholder:text-white/20",placeholder:"0",value:a[x.field]||"",onChange:g=>l(x.field,g.target.value)})},x.field))]}),o.jsx("tr",{className:"bg-white/5",children:o.jsx("td",{className:"px-3 py-2 text-center",colSpan:e.length+1,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"rounded-md bg-emerald-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-emerald-600",onClick:c,children:p.saveLabel}),o.jsx("button",{type:"button",className:"rounded-md bg-rose-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-rose-600",onClick:u,children:p.cancelLabel})]})})})]}),i&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:p.loadingText})}),!i&&t.length===0&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:p.emptyText})}),!i&&t.map((x,g)=>o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 text-center font-semibold",children:d(x.recordDate)}),e.map(v=>{const b=h(x,v);if(Array.isArray(b)){const w=b.map(N=>N.value?f(N.value,N.assetCode||v.assetCode):null).filter(Boolean),y=w.length?w.join(`
`):"-";return o.jsx("td",{className:"px-3 py-2 text-center text-white/90 whitespace-pre-line",children:y},v.field)}return o.jsx("td",{className:"px-3 py-2 text-center text-white/90",children:f(b,v.assetCode)},v.field)})]},`${x.recordDate}-${g}`))]})]})}),Kz=e=>yt(new Date(e))||e,Gz=e=>{const t=i=>(i||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),r=e.filter(i=>{const s=t(i.name||i.field||"");return s.includes("hana")||s.includes("gold")||s.includes("vang")}),n=e.filter(i=>!r.includes(i));if(!r.length)return e;const a=Array.from(new Set(r.map(i=>(i.assetCode||"").toUpperCase()).filter(Boolean)));return[...n,{id:0,field:"wallet_gold_combined",name:"HanaGold / Vang",assetCode:a.length===1?a[0]:void 0,sourceFields:r.map(i=>i.field)}]},Xz=e=>{const t={};return e.forEach(r=>{t[r.field]=r.assetCode}),t},Yz=e=>{const[t,r]=String(e).split("."),n=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r?`${n}.${r}`:n},qz=(e,t,r)=>e?(t||"").toUpperCase()==="VND"?r.format(e):Yz(e):"-",Zz=(e,t,r)=>t.sourceFields&&t.sourceFields.length?t.sourceFields.map(n=>({field:n,value:Number(e.values[n]||0)||0,assetCode:r[n]})):Number(e.values[t.field]||0),Jz={title:"Dòng tiền theo ngày",totalWallet5Label:"Tổng ID 5:",addLabel:"Thêm",closeLabel:"Đóng"},Qz={dateHeader:"Ngày",saveLabel:"Lưu",cancelLabel:"Hủy",loadingText:"Đang tải dữ liệu...",emptyText:"Chưa có dữ liệu dòng tiền."},eW=({columns:e,rows:t,loading:r,error:n,onRefresh:a,currencyFormatter:i})=>{const s=m.useMemo(()=>Gz(e),[e]),l=m.useMemo(()=>Xz(e),[e]),[c,u]=m.useState(!1),[d,f]=m.useState(""),[h,p]=m.useState({}),x=m.useMemo(()=>e.find(E=>E.id===5)?.field||null,[e]),g=m.useMemo(()=>x?t.reduce((E,_)=>E+(Number(_.values[x]||0)||0),0):null,[t,x]),v=m.useCallback((E,_)=>qz(E,_,i),[i]),b=m.useCallback((E,_)=>Zz(E,_,l),[l]),w=m.useCallback((E,_)=>{const j=e.find(T=>T.field===E),A=!j?.assetCode||j.assetCode.toUpperCase()==="VND";p(T=>({...T,[E]:A?z5(_):Fz(_)}))},[e]),y=m.useCallback(()=>{u(!1),f(""),p({})},[]),N=async()=>{const E=d||yt(new Date)||"";if(!E)return;const _={};e.forEach(j=>{const A=h[j.field]||"",k=!j.assetCode||j.assetCode.toUpperCase()==="VND"?A.replace(/\./g,""):A,C=Number(k||0);k&&(_[j.field]=Number.isFinite(C)?C:0)});try{await Ue("/api/wallets/daily-balances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordDate:E,values:_})}),y(),a()}catch(j){console.error("Failed to save wallet balances:",j)}},S=m.useCallback(()=>{const E=new Date,_=E.getFullYear(),j=String(E.getMonth()+1).padStart(2,"0"),A=String(E.getDate()).padStart(2,"0");f(`${_}-${j}-${A}`),u(T=>!T)},[]);return o.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/60 to-slate-900/65 p-5 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.7)]",children:[o.jsx(Wz,{labels:Jz,totalWallet5:g,currencyFormatter:i,adding:c,onToggleAdd:S}),n&&o.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/50 bg-amber-50/10 px-3 py-2 text-xs text-amber-200",children:n}),o.jsx(Vz,{displayColumns:s,rows:t,adding:c,newDate:d,newValues:h,loading:r,onDateChange:f,onValueChange:w,onSave:N,onCancel:y,formatDate:Kz,formatValue:v,resolveValue:b,labels:Qz})]})},tW=({financeSummary:e,budgets:t,savingGoals:r,currencyFormatter:n,goldRows:a,goldLoading:i,goldError:s,onRefreshGold:l,latestGoldBid:c,walletColumns:u,walletRows:d,walletLoading:f,walletError:h,onRefreshWallets:p,onRefetchGoals:x})=>{const g=u.find(j=>(j.assetCode||"").toUpperCase()!=="VND"&&/vàng|gold|hana/i.test(j.name))?.field||u.find(j=>(j.assetCode||"").toUpperCase()!=="VND")?.field||u.find(j=>j.id===7)?.field||null,v=u.find(j=>(j.assetCode||"").toUpperCase()==="VND"&&/hana|vàng|gold/i.test(j.name))?.field||u.find(j=>j.id===5)?.field||null,b=g&&d.length>0?d.reduce((j,A)=>j+(Number(A.values[g]||0)||0),0):0,w=v&&d.length>0?d.reduce((j,A)=>j+(Number(A.values[v]||0)||0),0):null,y=c?c/10:null;a.length&&Number(a[0]?.ask||0);const N=y?b*y:null,S=w!==null?w:y?b*y:null,E=N!==null&&S!==null?N-S:N??null,_=a.map((j,A)=>A===0?{...j,totalGoldAmount:b,totalGoldValue:S??void 0,profit:E??void 0}:j);return o.jsxs("div",{className:"space-y-6 rounded-[32px] bg-white/5 border border-white/10 p-6 shadow-[0_24px_60px_-34px_rgba(0,0,0,0.7)] backdrop-blur",children:[o.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:e.map(j=>o.jsx(Nk,{...j},j.title))}),o.jsx(_k,{loading:i,error:s,rows:_,onRefresh:l}),o.jsx(zz,{budgets:t,savingGoals:r,currencyFormatter:n,walletColumns:u,walletRows:d,goldValue:N,goldCost:S,onRefetchGoals:x}),o.jsx(eW,{columns:u,rows:d,loading:f,error:h,onRefresh:p,currencyFormatter:n,goldPrice:c})]})},vr={sky:{border:"border-sky-500/30",glow:"bg-sky-500/20",iconBg:"bg-sky-500 text-white shadow-[0_0_15px_rgba(14,165,233,0.5)]"},emerald:{border:"border-emerald-500/30",glow:"bg-emerald-500/20",iconBg:"bg-emerald-500 text-white shadow-[0_0_15px_rgba(16,185,129,0.5)]"},violet:{border:"border-violet-500/30",glow:"bg-violet-500/20",iconBg:"bg-violet-500 text-white shadow-[0_0_15px_rgba(139,92,246,0.5)]"},amber:{border:"border-amber-500/30",glow:"bg-amber-500/20",iconBg:"bg-amber-500 text-white shadow-[0_0_15px_rgba(245,158,11,0.5)]"},rose:{border:"border-rose-500/30",glow:"bg-rose-500/20",iconBg:"bg-rose-500 text-white shadow-[0_0_15px_rgba(244,63,94,0.5)]"},indigo:{border:"border-indigo-500/30",glow:"bg-indigo-500/20",iconBg:"bg-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.5)]"},slate:{border:"border-slate-500/30",glow:"bg-slate-500/20",iconBg:"bg-slate-500 text-white shadow-[0_0_15px_rgba(100,116,139,0.5)]"},teal:{border:"border-teal-500/30",glow:"bg-teal-500/20",iconBg:"bg-teal-500 text-white shadow-[0_0_15px_rgba(20,184,166,0.5)]"}},Ta=({title:e,value:t,icon:r,accent:n,subtitle:a,children:i})=>o.jsxs("div",{className:`stat-card group relative isolate overflow-hidden rounded-[24px] glass-panel p-4 sm:p-5 transition-all duration-500 holographic-hover z-10 ${n.border}`,children:[o.jsx("div",{className:`stat-card__glow absolute -right-12 -top-12 h-32 w-32 rounded-full blur-[60px] opacity-10 transition-opacity group-hover:opacity-25 ${n.glow}`}),o.jsxs("div",{className:"stat-card__content flex items-start justify-between gap-4",children:[o.jsxs("div",{className:"stat-card__text relative z-10",children:[o.jsx("p",{className:"stat-card__title text-[10px] sm:text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80 leading-none mb-1.5",children:e}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("h3",{className:"stat-card__value text-xl sm:text-2xl font-bold text-white tracking-tight leading-none",children:t}),a&&o.jsx("p",{className:"text-[10px] sm:text-xs font-medium text-emerald-400/80 tracking-wide",children:a})]})]}),o.jsxs("div",{className:`stat-card__icon relative flex h-11 w-11 shrink-0 items-center justify-center rounded-xl border border-white/10 overflow-hidden transform transition-all duration-500 group-hover:rotate-[10deg] group-hover:scale-110 ${n.iconBg}`,children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent pointer-events-none"}),o.jsx(r,{className:"h-5 w-5 relative z-10"})]})]}),i&&o.jsx("div",{className:"mt-6 relative z-10 animate-in fade-in slide-in-from-bottom-2 duration-700",children:i})]}),rW=({stats:e})=>o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 sm:p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsx("div",{className:"grid grid-cols-1 gap-3 sm:gap-4 sm:grid-cols-2 lg:grid-cols-4",children:e.map((t,r)=>o.jsx(Ta,{title:t.name,value:t.value,icon:t.icon,accent:vr[t.accent],children:o.jsx("div",{className:`flex items-center text-sm font-semibold ${t.changeType==="increase"?"text-emerald-200":t.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:t.changeType==="alert"?o.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):t.changeType==="increase"?o.jsxs(o.Fragment,{children:[o.jsx(Yo,{className:"mr-1 h-4 w-4"}),t.change]}):o.jsxs(o.Fragment,{children:[o.jsx(lm,{className:"mr-1 h-4 w-4"}),t.change]})})},`${t.name}-${r}`))})}),nW=({data:e,availableYears:t,selectedYear:r,onYearChange:n})=>{const a=Tn;return o.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[o.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Doanh thu theo tháng"}),o.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-white/80 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:r,onChange:i=>n(Number(i.target.value)),children:t.length===0?o.jsx("option",{value:r,children:r}):t.map(i=>o.jsx("option",{value:i,children:i},i))})]}),o.jsx("div",{className:"w-full",children:o.jsx(Dm,{width:"100%",height:320,children:o.jsxs(vz,{data:e,children:[o.jsx(ug,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),o.jsx(hg,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(pg,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:i=>`${Math.round(i/1e6)}M`}),o.jsx(Yx,{formatter:i=>[a(i),"Doanh thu"],labelStyle:{color:"#111827"}}),o.jsx(v5,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]})},aW=({data:e})=>o.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[o.jsx("h3",{className:"mb-6 text-lg font-semibold text-white",children:"Tổng đơn và đơn hủy theo tháng"}),o.jsx("div",{className:"w-full",children:o.jsx(Dm,{width:"100%",height:320,children:o.jsxs(yz,{data:e,children:[o.jsx(ug,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),o.jsx(hg,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(pg,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(Yx,{formatter:(t,r,n)=>[t,n?.dataKey==="total_orders"?"Tổng đơn":"Đơn hủy"],labelStyle:{color:"#111827"}}),o.jsx(Op,{dataKey:"total_orders",name:"Tổng đơn",fill:"#3b82f6",radius:[4,4,0,0]}),o.jsx(Op,{dataKey:"total_canceled",name:"Đơn hủy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]}),iW=({stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i})=>o.jsxs("div",{className:"overview-section",children:[o.jsx(rW,{stats:e}),o.jsxs("div",{className:"overview-section__charts grid grid-cols-1 gap-4 sm:gap-6 md:grid-cols-1 xl:grid-cols-2",children:[o.jsx(nW,{data:t,availableYears:n,selectedYear:a,onYearChange:i}),o.jsx(aW,{data:r})]})]}),sW=[{key:"overview",label:"Tổng quan"},{key:"finance",label:"Chi tiêu & Ngân sách"}],oW=({activeSection:e,onChange:t})=>o.jsx("div",{className:"w-full flex p-1.5 rounded-[28px] glass-panel-light border border-white/5 shadow-2xl relative z-10 transition-all duration-300",children:o.jsx("div",{className:"flex-1 grid grid-cols-2 gap-2",children:sW.map(r=>{const n=e===r.key;return o.jsx("button",{onClick:()=>t(r.key),className:`w-full rounded-[22px] px-6 py-4 text-sm font-black uppercase tracking-[0.15em] transition-all duration-500 relative overflow-hidden ${n?"text-white shadow-[0_0_30px_rgba(99,102,241,0.3)] bg-indigo-600/40 border border-indigo-400/30":"text-indigo-100/50 hover:text-white/80 hover:bg-white/5 border border-transparent"}`,children:r.label},r.key)})})}),lW=()=>o.jsxs("div",{className:"dashboard-hero relative group overflow-hidden rounded-[32px] glass-panel-light p-8 lg:p-10 transition-all duration-700 holographic-hover",children:[o.jsx("div",{className:"dashboard-hero__glow dashboard-hero__glow--right absolute -right-20 -top-20 w-96 h-96 bg-indigo-500/10 rounded-full blur-[100px] animate-pulse"}),o.jsx("div",{className:"dashboard-hero__glow dashboard-hero__glow--left absolute -left-20 -bottom-20 w-96 h-96 bg-purple-500/10 rounded-full blur-[100px] animate-pulse [animation-delay:2s]"}),o.jsx("div",{className:"dashboard-hero__content relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:o.jsxs("div",{className:"dashboard-hero__text space-y-2",children:[o.jsxs("h1",{className:"dashboard-hero__title text-4xl lg:text-5xl font-bold text-white tracking-tighter",children:["Bảng Điều ",o.jsx("span",{className:"text-indigo-400",children:"Khiển"})]}),o.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Digital Control Hub & Analysis"})]})})]}),cW=[],uW=[{name:"Nha cua & Tien ich",used:315e4,total:45e5},{name:"Thuc pham & Thiet yeu",used:226e4,total:45e5},{name:"Cham soc ca nhan",used:189e4,total:45e5},{name:"Phu kien",used:152e4,total:45e5}],dW=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),fW=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",Wr=(e,t={})=>{const{fallback:r="Đã xảy ra lỗi. Vui lòng thử lại sau.",blockPatterns:n}=t,a=fW(e);return!a||Array.isArray(n)&&n.some(i=>i.test(a))?r:a},hW=Tn,G5=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",X5=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,sh=(e,t,r,n)=>{const a=Number.isFinite(Number(t))?Number(t):0,i=Number.isFinite(Number(r))?Number(r):0,s=n?hW(a):a.toLocaleString("vi-VN"),l=X5(a,i);return{name:e,value:s,change:G5(l),changeType:l>=0?"increase":"decrease",accent:"sky"}},pW=e=>[{...sh("Tổng đơn hàng",e.totalOrders.current,e.totalOrders.previous,!1),icon:hd,accent:"sky"},{name:"Đơn sắp hết hạn",value:e.overdueOrders.count.toLocaleString("vi-VN"),change:"Cần xử lý",changeType:"alert",icon:ON,accent:"rose"},{...sh("Tổng nhập hàng",e.totalImports.current,e.totalImports.previous,!0),icon:PN,accent:"amber"},{...sh("Tổng lợi nhuận",e.totalProfit.current,e.totalProfit.previous,!0),icon:DN,accent:"emerald"}],mW=()=>{const e=m.useMemo(()=>new Date().getFullYear(),[]),t=m.useMemo(()=>new Date().getMonth()+1,[]),[r,n]=m.useState([]),[a,i]=m.useState([]),[s,l]=m.useState([]),[c,u]=m.useState([]),[d,f]=m.useState(e),[h,p]=m.useState(!0),[x,g]=m.useState(null),v=m.useCallback(async b=>{p(!0),g(null);try{const w=await Ue("/api/dashboard/stats");if(!w.ok){const _=await w.text();throw new Error(Wr(_,{fallback:"Không thể tải thống kê tổng quan."}))}const y=await w.json();n(pW(y));const N=await rC(b);i(N.revenueData),l(N.orderStatusData);const S=b===e?t:12,E=N.orderStatusData.filter((_,j)=>j<S&&Number.isFinite(Number(_.total_orders)));if(E.length>=2){const _=Number(E[E.length-1].total_orders)||0,j=Number(E[E.length-2].total_orders)||0,A=X5(_,j);n(T=>T.map((k,C)=>C===0?{...k,change:G5(A),changeType:A>=0?"increase":"decrease"}:k))}}catch(w){console.error("Lỗi khi lấy dữ liệu dashboard:",w),g(w instanceof Error?Wr(w.message,{fallback:"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau."}):"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau.")}finally{p(!1)}},[]);return m.useEffect(()=>{let b=!1;return(async()=>{try{const y=await nC(),N=y.length?y:[e];b||(u(N),f(S=>N.includes(S)?S:N[0]??e))}catch(y){console.error("Failed to load available years:",y),b||(g(y instanceof Error?Wr(y.message,{fallback:"Không thể tải năm dữ liệu dashboard."}):"Không thể tải năm dữ liệu dashboard."),p(!1))}})(),()=>{b=!0}},[e]),m.useEffect(()=>{v(d)},[d,v]),{statsData:r,revenueChartData:a,orderChartData:s,availableYears:c,selectedYear:d,setSelectedYear:f,loading:h,errorMessage:x}},xW=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(!1),[a,i]=m.useState(null),s=m.useCallback(async()=>{n(!0),i(null);try{const u=await fetch("https://api.hanagold.vn/app/setting/get-chart-gold");if(!u.ok)throw new Error(`HTTP ${u.status}`);const d=await u.json();if(!d||d.signal!==1||!Array.isArray(d.data))throw new Error("Dữ liệu không hợp lệ");const f=[];d.data.forEach(h=>{const p=h?.time??"";(Array.isArray(h?.data)?h.data:[]).forEach(g=>{(Array.isArray(g?.main_gold_price)?g.main_gold_price:[]).forEach(b=>{const w=Number(b?.ask??NaN),y=Number(b?.bid??NaN);if(!Number.isFinite(w)||!Number.isFinite(y))return;const N=w*1e6,S=y*1e6;f.push({time:p,group:g?.name??"",displayName:b?.display_name??b?.name??"",ask:N,bid:S,trendAsk:b?.trend?.ask,trendBid:b?.trend?.bid})})})}),t(f)}catch(c){console.error("Lỗi khi lấy giá vàng HanaGold:",c),i(c instanceof Error?c.message:"Không thể lấy dữ liệu giá vàng.")}finally{n(!1)}},[]),l=m.useMemo(()=>{if(!e.length)return[];const c=e.filter(d=>{const f=`${d.displayName||""}`.toLowerCase(),h=`${d.group||""}`.toLowerCase();return f.includes("kim kh")||f.includes("kht")||h.includes("kim kh")});if(!c.length)return[];const u=c[c.length-1]?.time||"";return c.filter(d=>d.time===u)},[e]);return{goldPrices:e,goldLoading:r,goldError:a,fetchGoldPrices:s,selectedGoldRows:l}},gW=()=>{const[e,t]=m.useState([]),[r,n]=m.useState([]),[a,i]=m.useState(!1),[s,l]=m.useState(null),c=m.useCallback(async()=>{i(!0),l(null);try{const d=await Ue("/api/wallets/daily-balances");if(!d.ok)throw new Error(`HTTP ${d.status}`);const f=await d.json();t(Array.isArray(f?.wallets)?f.wallets:[]),n(Array.isArray(f?.rows)?f.rows:[])}catch(d){console.error("Failed to fetch wallet balances:",d),l("Không thể tải dữ liệu dòng tiền từ cơ sở dữ liệu.")}finally{i(!1)}},[]);return m.useEffect(()=>{c()},[c]),{walletColumns:m.useMemo(()=>[...e].sort((d,f)=>d.id-f.id),[e]),walletRows:r,walletLoading:a,walletError:s,fetchWalletBalances:c}},vW=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(0),[a,i]=m.useState(!0),[s,l]=m.useState(null),c=m.useCallback(async()=>{try{i(!0),l(null);const u=await Ue("/api/saving-goals");if(!u.ok)throw new Error("Không thể tải danh sách mục tiêu");const d=await u.json();t(d.goals||[]),n(d.totalTarget||0)}catch(u){console.error("Error fetching saving goals:",u),l(u instanceof Error?u.message:"Lỗi không xác định"),t([]),n(0)}finally{i(!1)}},[]);return m.useEffect(()=>{c()},[c]),{goals:e,totalTarget:r,loading:a,error:s,refetch:c}},bW=()=>{const{statsData:e,revenueChartData:t,orderChartData:r,availableYears:n,selectedYear:a,setSelectedYear:i,loading:s,errorMessage:l}=mW(),{goldLoading:c,goldError:u,selectedGoldRows:d,fetchGoldPrices:f}=xW(),{walletColumns:h,walletRows:p,walletLoading:x,walletError:g,fetchWalletBalances:v}=gW(),{goals:b,refetch:w}=vW(),[y,N]=m.useState("overview"),S=d.length&&Number(d[0]?.bid||0)||null;return m.useEffect(()=>{f()},[f]),s?o.jsx("div",{className:"py-10 text-center",children:o.jsx("p",{className:"text-lg font-medium text-white/80",children:"Đang tải dữ liệu dashboard..."})}):o.jsxs("div",{className:"dashboard space-y-6",children:[o.jsx(lW,{}),o.jsx(oW,{activeSection:y,onChange:N}),l&&o.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:l}),y==="overview"&&o.jsx(iW,{stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i}),y==="finance"&&o.jsx(tW,{financeSummary:cW,budgets:uW,savingGoals:b,currencyFormatter:dW,goldRows:d,goldLoading:c,goldError:u,onRefreshGold:f,latestGoldBid:S,walletColumns:h,walletRows:p,walletLoading:x,walletError:g,onRefreshWallets:v,onRefetchGoals:w})]})},yW={ID_ORDER:It.idOrder,ID_PRODUCT:It.idProduct,INFORMATION_ORDER:It.informationOrder,CUSTOMER:It.customer,CONTACT:It.contact,SLOT:It.slot,ORDER_DATE:It.orderDate,DAYS:It.days,ORDER_EXPIRED:It.orderExpired,SUPPLY:It.supply,COST:It.cost,PRICE:It.price,NOTE:It.note,STATUS:It.status,REFUND:It.refund},Je={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},H=yW,st={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},wt={COLLABORATOR:"MAVC",RETAIL:"MAVL",PROMO:"MAVK",GIFT:"MAVT",IMPORT:"MAVN",STUDENT:"MAVS"},Y5=wt.COLLABORATOR,wW=[{value:wt.COLLABORATOR,label:"Cộng Tác Viên"},{value:wt.STUDENT,label:"Sinh Viên"},{value:wt.RETAIL,label:"Khách Lẻ"},{value:wt.PROMO,label:"Khuyến Mãi"},{value:wt.GIFT,label:"Quà Tặng"},{value:wt.IMPORT,label:"Nhập Hàng"}],rt={ORDER_EXPIRED:Qr.EXPIRED,CAN_GIA_HAN:Qr.RENEWAL,CHUA_THANH_TOAN:Qr.UNPAID,DANG_XU_LY:Qr.PROCESSING,DA_THANH_TOAN:Qr.PAID,CHO_HOAN:Qr.PENDING_REFUND,DA_HOAN:Qr.REFUNDED},q5={active:{label:"Đơn Hàng",description:"Danh sách đơn đang hoạt động",endpoint:Je.ORDERS},expired:{label:"Hết Hạn",description:"Danh sách các đơn hàng đã hết hạn",endpoint:Je.ORDERS_EXPIRED},canceled:{label:"Hoàn Tiền",description:"Đơn đã hủy/hoàn tiền",endpoint:Je.ORDERS_CANCELED}},NW=["active","expired","canceled"],vc=[{name:"Tổng Đơn Hàng",value:"0",icon:Ui,accent:vr.sky},{name:"Cần Gia Hạn",value:"0",icon:fm,accent:vr.amber},{name:"Hết Hạn",value:"0",icon:lm,accent:vr.rose},{name:"Đăng Ký Hôm Nay",value:"0",icon:Yo,accent:vr.emerald}],_W=[{value:"all",label:"Tất cả cột"},{value:H.ID_ORDER,label:"Mã Đơn Hàng"},{value:H.ID_PRODUCT,label:"Sản Phẩm"},{value:H.INFORMATION_ORDER,label:"Thông tin"},{value:H.CUSTOMER,label:"Khách Hàng"},{value:H.SLOT,label:"Slot"},{value:H.SUPPLY,label:"Nguồn"}],SW="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",EW="opacity-60 cursor-not-allowed shadow-none pointer-events-none",An=la.forwardRef(({icon:e,className:t="",disabled:r,children:n,...a},i)=>o.jsxs("button",{ref:i,className:`${SW} ${r?EW:"hover:-translate-y-0.5"} ${t}`,disabled:r,...a,children:[e&&o.jsx(e,{className:"h-4 w-4"}),o.jsx("span",{className:"font-semibold",children:n})]}));An.displayName="GradientButton";const Z5=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,secondaryMessage:i,confirmLabel:s="OK",cancelLabel:l="Hủy",isSubmitting:c=!1})=>e?o.jsx("div",{className:"confirm-modal fixed inset-0 z-70 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:o.jsxs("div",{className:"confirm-modal__container w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[o.jsx("h3",{className:"confirm-modal__title text-lg font-semibold leading-6 text-white mb-2",children:n}),o.jsxs("div",{className:"confirm-modal__body mb-4",children:[o.jsx("p",{className:"confirm-modal__message text-sm text-white/90",children:a}),i?o.jsx("p",{className:"mt-2 text-sm font-semibold text-rose-300",children:i}):null]}),o.jsxs("div",{className:"confirm-modal__actions flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:t,disabled:c,className:"confirm-modal__btn confirm-modal__btn--cancel px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:l}),o.jsx("button",{type:"button",onClick:r,disabled:c,className:"confirm-modal__btn confirm-modal__btn--confirm px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang Xử Lý...":s})]})]})}):null,jW="VPB",n2="9183400998",a2="NGO LE NGOC HUNG",TW=({isOpen:e,orderId:t,productName:r,customerType:n,basePrice:a,normalizedOrderDate:i,skipRecalc:s=!1})=>{const[l,c]=m.useState(null),[u,d]=m.useState(!1),[f,h]=m.useState(null);return m.useEffect(()=>{if(!e||!t||!r){c(null),d(!1),h(null);return}let p=!1;if(c(a),s){d(!1),h(null);return}const x={san_pham_name:r,id_product:r,id_order:t};return i&&(x.order_date=i),n&&(x.customer_type=n),(async()=>{try{d(!0),h(null);const v=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),{data:b,rawText:w}=await K5(v);if(!v.ok){const N=b?.error||w||`Server responded with ${v.status}`;throw new Error(N)}const y=b??{};if(!p){const N=Number(y.price??y.gia_ban);c(Number.isFinite(N)&&N>=0?N:a)}}catch(v){console.error("Lỗi khi tính lại giá đơn hàng:",v),p||(h("Không thể tính lại giá đơn hàng. Đang hiển thị giá hiện có."),c(a))}finally{p||d(!1)}})(),()=>{p=!0}},[a,n,e,i,t,r,s]),{calculatedPrice:l,priceLoading:u,priceError:f}},i2=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,s2=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},CW=({isOpen:e,onClose:t,order:r,formatCurrency:n,keepOrderPrice:a=!1})=>{const i=r?.[H.ID_ORDER],s=r?.[H.ID_PRODUCT],l=Number(r?.[H.PRICE])||0,c=r?.[H.SUPPLY]||"",u=r?.customer_type||c||"",d=r?.registration_date||r?.[H.ORDER_DATE]||"",f=Dz(yt(d)||d)||null,{calculatedPrice:h,priceLoading:p,priceError:x}=TW({isOpen:e,orderId:i,productName:s,customerType:u,basePrice:l,normalizedOrderDate:f,skipRecalc:a}),g=m.useMemo(()=>Math.max(0,Number(r?.[H.PRICE])||0),[r]),b=kn(a?g:h??g);if(!e||!r)return null;const w=String(r[st.TRANG_THAI_TEXT]||r.trangThaiText||r[H.STATUS]||"").trim()||"Chưa Thanh Toán",y=r[st.SO_NGAY_CON_LAI]!==void 0&&r[st.SO_NGAY_CON_LAI]!==null?Number(r[st.SO_NGAY_CON_LAI]):null,N=s2(r.so_ngay_con_lai),S=i2(r.expiry_date||r.expiry_date_display||r[st.EXPIRY_DATE_DISPLAY]||r[H.ORDER_EXPIRED]),E=U5(S)??s2(r[H.DAYS]),_=y!==null&&Number.isFinite(y)?y:N??E??0,j=i2(r.registration_date_display||r[st.ORDER_DATE_DISPLAY]||r.registration_date||r[H.ORDER_DATE]),A=(r.registration_date_display||r[st.ORDER_DATE_DISPLAY]||yt(j)||String(r[H.ORDER_DATE]||""))??"",T=r.expiry_date_display||r[st.EXPIRY_DATE_DISPLAY]||yt(S)||String(r[H.ORDER_EXPIRED]||""),k=String(r[H.ID_ORDER]||""),C=kn(g),L=o0({accountNumber:n2,bankCode:jW,amount:C,description:k,accountName:a2});return o.jsx("div",{className:"view-order-modal fixed inset-0 z-70 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 p-2 sm:p-4 md:p-6",onClick:t,children:o.jsxs("div",{className:"view-order-modal__container bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[98vh] sm:max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:G=>G.stopPropagation(),children:[o.jsxs("div",{className:"view-order-modal__header flex justify-center items-center p-3 sm:p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[o.jsxs("h3",{className:"view-order-modal__title text-lg sm:text-xl font-semibold text-white",children:["Chi tiết đơn hàng:"," ",o.jsx("span",{className:"text-blue-600",children:r[H.ID_ORDER]})]}),o.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Pt,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"view-order-modal__body p-3 sm:p-6 overflow-y-auto flex-grow space-y-4 sm:space-y-5 text-gray-700",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-xs sm:text-sm",children:[o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID Đơn:"}),o.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[H.ID_ORDER]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sản Phẩm:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.ID_PRODUCT]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 mb-1 sm:mb-0",children:"Thông Tin Sản Phẩm:"}),o.jsx("dd",{className:"text-slate-100 w-full sm:w-2/3 text-left sm:text-right break-words",children:r[H.INFORMATION_ORDER]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.SLOT]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 mb-1 sm:mb-0",children:"Ghi Chú:"}),o.jsx("dd",{className:"text-slate-100 w-full sm:w-2/3 text-left sm:text-right break-words",children:r[H.NOTE]||"-"})]}),o.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trạng Thái:"}),o.jsx("dd",{className:"w-2/3 text-right",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${W5(w)}`,children:w})})]})]}),o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khách Hàng:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.CUSTOMER]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1 items-start",children:[o.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 shrink-0 mb-1 sm:mb-0",children:"Liên Hệ:"}),o.jsx("dd",{className:"w-full sm:w-2/3 text-left sm:text-right break-all",children:o.jsx("a",{href:r[H.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[H.CONTACT]||"-"})})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Order:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:A})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.DAYS]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Hết Hạn:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:T})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày Còn Lại:"}),o.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:_})]})]})]}),o.jsx("hr",{className:"my-4 border-white/10"}),o.jsxs("div",{className:"view-order-modal__qr text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[o.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Quét mã QR để thanh toán (VietQR)"}),L?o.jsx("div",{className:"flex justify-center mb-3",children:o.jsx("img",{src:L,alt:`QR Code thanh toán ${r[H.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40 w-full max-w-[240px] sm:max-w-[280px] h-auto",width:280,height:280})}):o.jsx("p",{className:"text-red-600 font-medium",children:"Không thể tạo mã QR. Vui lòng kiểm tra lại cấu hình"}),o.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[o.jsxs("p",{children:["Ngân hàng: ",o.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),o.jsxs("p",{children:["Số tài khoản: ",o.jsx("strong",{className:"text-indigo-100",children:n2})]}),o.jsxs("p",{children:["Chủ tài khoản: ",o.jsx("strong",{className:"text-indigo-100",children:a2})]}),o.jsxs("p",{children:["Số tiền:"," ",o.jsx("strong",{className:"text-xl text-red-600",children:n(a?C:b)})]}),!a&&p&&o.jsx("p",{className:"text-xs text-slate-400",children:"Đang tính lại giá..."}),x&&o.jsx("p",{className:"text-xs text-red-500",children:x}),o.jsxs("p",{children:["Nội dung: ",o.jsx("strong",{className:"text-indigo-200",children:k})," ","(Vui lòng điền đúng)"]})]})]})]})]})})},o2=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",l2=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,zo=e=>(e?.supplier_name??e?.source_name??e?.name??"").trim(),c2=Sl,kW=(e,t)=>{const[r,n]=m.useState(null),[a,i]=m.useState([]),[s,l]=m.useState([]),c=m.useRef(e),[u,d]=m.useState(!1),f=m.useCallback(()=>{const N=c.current?.[H.SUPPLY]||"";return N.trim()?{id:-1,supplier_name:N,source_name:N}:null},[]),h=m.useCallback(N=>{const S=f();return S&&!N.some(_=>zo(_)===zo(S))?[S,...N]:N},[f]),p=m.useCallback(async N=>{if(!N){const S=h([]);return i(S),S}try{const S=await fetch(`${c2}${Je.SUPPLIES_BY_PRODUCT(N)}`,{credentials:"include"});if(!S.ok)throw new Error("Lỗi tải danh sách nguồn.");const E=await S.json(),_=h(E);return i(_),_}catch(S){console.error("Lỗi khi fetch supplies cho sản phẩm:",S);const E=h([]);return i(E),E}},[h]),x=m.useCallback(async N=>{if(!N)return l([]),[];try{const S=await fetch(`${c2}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(N)}`,{credentials:"include"});if(!S.ok)throw new Error("Lỗi tải danh sách giá nguồn.");const E=await S.json();return l(E),E}catch(S){return console.error("Lỗi khi fetch giá nguồn cho sản phẩm:",S),l([]),[]}},[]);m.useEffect(()=>{if(t&&e){const N={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(N),c.current=N,i(E=>h(E));const S=e.id_product;S&&(p(S),x(S)),d(!1)}else t||(n(null),i([]),l([]),d(!1))},[t,e,p,x,h]),m.useEffect(()=>{if(!t||!r?.id_product)return;const N=r.id_product;p(N),x(N)},[t,r?.id_product,p,x]);const g=m.useCallback((N,S)=>{n(E=>E&&{...E,[N]:S})},[]),v=m.useCallback(N=>{const S=a.find(A=>A.id===N),E=zo(S)||r?.[H.SUPPLY]||"";d(!1),g(H.SUPPLY,E||"");const _=Bz(E,s,a)??s.find(A=>A.source_id===N)?.price??null,j=Number(_);if(Number.isFinite(j))g(H.COST,j);else if(c.current){const A=Number(c.current[H.COST]||0);g(H.COST,A)}},[r,g,a,s]),b=m.useCallback(N=>{d(!0),g(H.SUPPLY,N)},[g]),w=m.useCallback(()=>{d(N=>{const S=!N;return S||g(H.SUPPLY,""),S})},[g]),y=m.useCallback(()=>{n(c.current);const N=c.current?.id_product;N&&(p(N),x(N))},[p,x]);return{formData:r,supplies:a,isCustomSupply:u,supplyPrices:s,handleSupplySelect:v,resetForm:y,setFieldValue:g,handleCustomSupplyChange:b,toggleCustomSupply:w}},Mr="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",qr="block text-sm font-medium text-slate-100 mb-1",Zn="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",AW=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:a,supplies:i,isCustomSupply:s,handleSupplySelect:l,resetForm:c,setFieldValue:u,handleCustomSupplyChange:d,toggleCustomSupply:f}=kW(r,e),[h,p]=m.useState(!1),x=S=>a?String(a[S]??""):"",g=S=>a&&Number(a[S]??0)||0,v=m.useCallback(S=>{const E=S.target,{name:_,value:j}=E,A=E instanceof HTMLInputElement&&E.type==="checkbox"?E.checked:j;u(_,A)},[u]),b=m.useMemo(()=>{if(!a)return"";const S=i.find(E=>zo(E)===a[H.SUPPLY]);return S?String(S.id):""},[a,i]),w=m.useMemo(()=>{if(!a)return"";const S=l2(a.registration_date_display||a.registration_date||a[H.ORDER_DATE]);return yt(S)||String(S||"")},[a]),y=m.useMemo(()=>{if(!a)return"";const S=l2(a.expiry_date_display||a.expiry_date||a[H.ORDER_EXPIRED]);return yt(S)||String(S||"")},[a]),N=async S=>{if(S.preventDefault(),!!a){p(!0);try{await n(a)}finally{p(!1)}}};return!e||!a?null:o.jsx("div",{className:"edit-order-shell fixed inset-0 z-70 flex items-center justify-center bg-black/55 backdrop-blur-lg p-2 sm:p-4 md:p-6",children:o.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[o.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-4 sm:px-6 py-3 sm:py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[o.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-100",children:"Chỉnh sửa đơn hàng"}),o.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"Đóng",children:o.jsx(Pt,{className:"h-6 w-6"})})]}),o.jsxs("form",{onSubmit:N,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Mã đơn hàng"}),o.jsx("input",{type:"text",name:H.ID_ORDER,value:x(H.ID_ORDER),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Khách hàng"}),o.jsx("input",{type:"text",name:H.CUSTOMER,value:x(H.CUSTOMER),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Liên hệ"}),o.jsx("input",{type:"text",name:H.CONTACT,value:x(H.CONTACT),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Slot"}),o.jsx("input",{type:"text",name:H.SLOT,value:x(H.SLOT),onChange:v,className:Mr})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Sản phẩm"}),o.jsx("input",{type:"text",name:H.ID_PRODUCT,value:x(H.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Nguồn"}),o.jsxs("div",{className:"flex items-center gap-2",children:[s?o.jsx("input",{type:"text",name:H.SUPPLY,value:x(H.SUPPLY),onChange:S=>d(S.target.value),className:Mr,placeholder:"Nhập nguồn mới"}):o.jsxs("select",{name:H.SUPPLY,value:b,onChange:S=>l(Number(S.target.value)),className:Mr,children:[o.jsx("option",{value:"",children:"-- Giữ nguyên hoặc chọn --"}),i.map(S=>o.jsx("option",{value:S.id,children:zo(S)},S.id))]}),o.jsx("button",{type:"button",onClick:f,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${s?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":s?"Tắt nhập nguồn mới":"Nhập nguồn mới",children:s?o.jsx(IN,{className:"h-6 w-6","aria-hidden":"true"}):o.jsx(hm,{className:"h-6 w-6","aria-hidden":"true"})})]}),!i.length&&!s&&o.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Không có danh sách nguồn cho sản phẩm hiện tại."})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Thông tin đơn hàng"}),o.jsx("input",{type:"text",name:H.INFORMATION_ORDER,value:x(H.INFORMATION_ORDER),onChange:v,className:Mr})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ngày đăng ký"}),o.jsx("input",{type:"text",name:H.ORDER_DATE,value:w,readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Số ngày"}),o.jsx("input",{type:"text",name:H.DAYS,value:x(H.DAYS),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ngày hết hạn"}),o.jsx("input",{type:"text",name:H.ORDER_EXPIRED,value:y,readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Giá nhập"}),o.jsx("input",{type:"text",name:H.COST,value:o2(g(H.COST)),readOnly:!0,disabled:!0,className:`${Mr} ${Zn} font-semibold`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Giá bán"}),o.jsx("input",{type:"text",name:H.PRICE,value:o2(g(H.PRICE)),readOnly:!0,disabled:!0,className:`${Mr} ${Zn} font-semibold text-emerald-300`})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Trạng thái"}),o.jsx("input",{type:"text",name:H.STATUS,value:x(H.STATUS),readOnly:!0,disabled:!0,className:`${Mr} ${Zn}`})]})}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ghi chú"}),o.jsx("textarea",{name:H.NOTE,value:x(H.NOTE),rows:4,onChange:v,className:Mr})]}),o.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[o.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hoàn tác"}),o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Đóng"}),o.jsx("button",{type:"submit",disabled:h,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${h?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:h?"Đang lưu...":"Lưu thay đổi"})]})]})]})})},Up=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},fl=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),a=parseInt(r[1],10),i=parseInt(r[2],10),s=new Date(i,a-1,n);s.setDate(s.getDate()+t-1);const l=String(s.getDate()).padStart(2,"0"),c=String(s.getMonth()+1).padStart(2,"0"),u=s.getFullYear();return`${l}/${c}/${u}`},J5={[H.ID_ORDER]:"",[H.ID_PRODUCT]:"",[H.INFORMATION_ORDER]:"",[H.CUSTOMER]:"",[H.CONTACT]:"",[H.SLOT]:"",[H.ORDER_DATE]:"",[H.DAYS]:"0",[H.ORDER_EXPIRED]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.NOTE]:"",[H.STATUS]:rt.CHUA_THANH_TOAN},hr="w-full transition-all",Nr="block text-[11px] font-black uppercase tracking-[0.15em] text-indigo-300/80 mb-2 px-1",Io="opacity-60 cursor-not-allowed bg-indigo-500/5",u2=({name:e,value:t,options:r,placeholder:n,disabled:a,onChange:i,onClear:s})=>{const l=m.useRef(null),[c,u]=m.useState(!1),[d,f]=m.useState(""),h=m.useMemo(()=>{const x=r.find(g=>g.value===t);return x?x.label:""},[r,t]);m.useEffect(()=>{f(h)},[h]);const p=m.useMemo(()=>{const x=(d||"").toLowerCase().trim();return x?r.filter(g=>g.label.toLowerCase().includes(x)):r},[r,d]);return m.useEffect(()=>{const x=g=>{l.current&&(l.current.contains(g.target)||u(!1))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),o.jsxs("div",{ref:l,className:"relative",children:[o.jsx("input",{name:e,type:"text",value:d,onChange:x=>{const g=x.target.value;f(g),g===""&&s?.(),c||u(!0)},onFocus:()=>u(!0),disabled:a,placeholder:n,className:`${hr} pr-8`,autoComplete:"off"}),!!d&&s&&!a&&o.jsx("button",{type:"button",onMouseDown:x=>{x.preventDefault(),f(""),s(),u(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:"×"}),c&&!a&&o.jsx("div",{className:"absolute z-20 mt-2 w-full glass-panel-dark border-white/10 shadow-2xl max-h-60 overflow-auto animate-in fade-in slide-in-from-top-2 duration-200",children:p.length===0?o.jsx("div",{className:"px-4 py-3 text-sm text-indigo-300/60 italic",children:"Không có kết quả"}):p.map(x=>o.jsx("div",{className:`px-4 py-2.5 text-sm cursor-pointer transition-colors hover:bg-indigo-500/20 active:bg-indigo-500/30 ${x.value===t?"bg-indigo-500/10 text-indigo-300":"text-slate-200"}`,onMouseDown:g=>{g.preventDefault(),f(x.label),u(!1),i(x.value,x)},children:x.label},`${String(x.value)}-${x.label}`))})]})},PW=e=>{const[t,r]=m.useState(J5),[n,a]=m.useState(e),[i,s]=m.useState(null),[l,c]=m.useState(!1),u=m.useCallback(d=>{r(f=>({...f,...d}))},[]);return{formData:t,setFormData:r,customerType:n,setCustomerType:a,selectedSupplyId:i,setSelectedSupplyId:s,customProductTouched:l,setCustomProductTouched:c,updateForm:u}},OW=({isOpen:e,customerType:t,setCustomerType:r,setFormData:n,setIsDataLoaded:a,setSelectedSupplyId:i,setSupplies:s,setSupplyPrices:l,setCustomProductTouched:c,fetchProducts:u,fetchAllSupplies:d})=>{const f=m.useMemo(()=>t+t2(5),[t]);m.useEffect(()=>{if(!e)return;const h=Y5,p=h+t2(5),x=Ha();r(h),n({...J5,[H.ID_ORDER]:p,[H.ORDER_DATE]:x,[H.ORDER_EXPIRED]:x}),a(!1),i(null),s([]),l([]),c(!1),u(),d()},[d,u,e,r,n,a,i,s,l,c]),m.useEffect(()=>{e&&n(h=>({...h,[H.ID_ORDER]:f}))},[f,e,n])},DW=({infoValue:e,infoRef:t,productName:r,orderId:n,registerDate:a,selectedSupplyId:i,customMode:s,customerType:l,recalcPrice:c})=>{m.useEffect(()=>{t.current=e||""},[e,t]),m.useEffect(()=>{if(!r||!n||!a||s)return;const u=i??0;c(u,r,n,a,void 0,{updateCost:!!u})},[l,c,r,n,a,i,s])},IW=({formData:e,isLoading:t,updateForm:r,onSave:n})=>({handleSubmit:m.useCallback(i=>{if(i.preventDefault(),e&&e[H.ID_PRODUCT]&&e[H.SUPPLY]&&e[H.CUSTOMER]&&e[H.INFORMATION_ORDER]&&!t){const l=yt(e[H.ORDER_DATE])||e[H.ORDER_DATE]||Ha(),c=yt(e[H.ORDER_EXPIRED])||e[H.ORDER_EXPIRED]||"",u=Number(e[H.DAYS]||0)||0;let d=c;if(!d&&l&&u>0){const x=fl(l,u);x&&x!=="N/A"&&(d=x,r({[H.ORDER_EXPIRED]:d}))}const f=Up(l),h=d?Up(d):f,p={...e,[H.COST]:Number(e[H.COST]),[H.PRICE]:Number(e[H.PRICE]),[H.ORDER_DATE]:f,[H.ORDER_EXPIRED]:h,[H.CONTACT]:e[H.CONTACT]||null,[H.SLOT]:e[H.SLOT]||null,[H.NOTE]:e[H.NOTE]||null};return n(p),!0}return Tr({type:"error",title:"Thiếu thông tin",message:"Vui lòng điền đầy đủ các thông tin."}),!1},[e,t,n,r])}),RW=({customerType:e,setFormData:t,productName:r})=>{const[n,a]=m.useState(!1),[i,s]=m.useState(!1),l=m.useRef(""),c=m.useRef(0),u=m.useRef(null);m.useEffect(()=>()=>{u.current?.abort()},[]);const d=m.useCallback(async(p,x,g,v)=>{const b=c.current+1;c.current=b,u.current&&u.current.abort();const w=new AbortController;u.current=w,a(!0),s(!1);try{const y=Up(v)||v||null,N=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supply_id:p,san_pham_name:x,id_product:x,id_order:g,order_date:y,customer_type:e}),signal:w.signal}),{data:S,rawText:E}=await K5(N);if(b!==c.current)return;if(!N.ok){const C=S?.error||E||"Lỗi tính giá từ Server.";throw new Error(C)}if(!S)throw new Error("Phản hồi không hợp lệ từ server.");const _=S||{},j=yt(v)||v||Ha(),A={cost:Math.max(0,Number(_.gia_nhap??_.cost??0)||0),price:Math.max(0,Number(_.gia_ban??_.price??0)||0),days:Number(_.so_ngay_da_dang_ki??_.days??0)||0,order_expired:""},T=(_.order_expired??_.het_han??"").trim(),k=yt(T)||T||(A.days>0?fl(j,A.days):"");return A.order_expired=k,A}catch(y){if(y?.name==="AbortError")return;console.error("Lỗi khi tính giá:",y),s(!1),Tr({type:"error",title:"Lỗi tính giá",message:`Tính giá thất bại: ${y instanceof Error?y.message:"Lỗi không xác định"}`});return}finally{b===c.current&&a(!1)}},[e]),f=m.useCallback((p,x,g,v)=>{if(!p)return;const b=yt(x)||x||Ha();let w=Number(p.days||0)||0,y=p.order_expired||(w>0?fl(b,w):"");const N=$u(v?.infoOverride||"")||$u((v?.productNameOverride||r||"").toString());if(N>0){const S=Mz(N),E=$5(b,N);S>0&&(w=S,y=E)}t(S=>{const E=Number(S[H.COST]||0),_=Number.isFinite(p.cost)&&p.cost>0?p.cost:void 0,A=v?.updateCost??!0?_??Number(g??E??0):E,T=Number(S[H.PRICE]||0),k=Number.isFinite(p.price)&&p.price>0?p.price:void 0;let C=k??T??0;return e===wt.PROMO&&(C=k??A??T??0),{...S,[H.COST]:A,[H.PRICE]:C,[H.DAYS]:w>0?String(w):String(S[H.DAYS]||"0"),[H.ORDER_EXPIRED]:y||S[H.ORDER_EXPIRED]||""}}),s(!0)},[e,r,t]),h=m.useCallback((p,x,g,v,b,w)=>{!x||!g||!v||d(p,x,g,v).then(y=>f(y,v,b,{...w,productNameOverride:x,infoOverride:l.current}))},[f,d]);return{isLoading:n,setIsLoading:a,isDataLoaded:i,setIsDataLoaded:s,calculatePrice:d,applyCalculationResult:f,recalcPrice:h,infoRef:l}},MW=({productName:e,orderId:t,registerDate:r,allSupplies:n,selectedSupplyId:a,customMode:i,todayDate:s,setSelectedSupplyId:l,setCustomProductTouched:c,setFormData:u,setSupplies:d,setSupplyPrices:f,setIsDataLoaded:h,fetchSuppliesByProduct:p,fetchAllSupplyPrices:x,recalcPrice:g})=>(m.useEffect(()=>{e||(l(null),u(b=>{if(!b[H.ID_PRODUCT]&&Number(b[H.PRICE]||0)===0&&String(b[H.DAYS]||"0")==="0")return b;const y=b[H.ORDER_DATE]||Ha();return{...b,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y}}))},[e,u,l]),{handleProductSelect:m.useCallback(b=>{const w=(b||"").trim();if(l(null),c(!1),!w){u(y=>({...y,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y[H.ORDER_DATE]||s})),d(n),f([]),h(!1);return}if(u(y=>({...y,[H.ID_PRODUCT]:w,[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y[H.ORDER_DATE]||s})),d([]),f([]),p(w),x(w),t&&r&&!i){const y=a??0;g(y,w,t,r,void 0,{updateCost:!!y})}},[n,i,x,p,t,g,r,a,c,u,h,l,d,f,s])}),FW=300*1e3,d2=new Map,LW=e=>{const t=d2.get(e);if(t)return t;const r={ts:0};return d2.set(e,r),r},BW=e=>!!(e.data&&Date.now()-e.ts<FW),bc=async(e,t,r=!1)=>{const n=LW(e);if(!r&&BW(n))return n.data;if(n.promise)return n.promise;const a=t().then(i=>(n.data=i,n.ts=Date.now(),n.promise=void 0,i)).catch(i=>{throw n.promise=void 0,i});return n.promise=a,a},f2=e=>e.trim(),$W=e=>{const[t,r]=m.useState([]),[n,a]=m.useState([]),[i,s]=m.useState([]),[l,c]=m.useState([]),u=m.useCallback(async(p=!1)=>{try{const x=await bc(`products:${e}`,async()=>{const g=await fetch(`${e}${Je.PRODUCTS_ALL}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách sản phẩm.");return await g.json()},p);s(x)}catch(x){console.error("Lỗi khi fetch products:",x)}},[e]),d=m.useCallback(async(p=!1)=>{try{const x=await bc(`supplies:${e}`,async()=>{const g=await fetch(`${e}${Je.SUPPLIES}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách nguồn.");return await g.json()},p);r(x),a(g=>g.length?g:x)}catch(x){console.error("Lỗi khi fetch all supplies:",x),r([])}},[e]),f=m.useCallback(async(p,x=!1)=>{const g=f2(p);if(!g){a(v=>v.length?v:t);return}try{const v=await bc(`suppliesByProduct:${e}:${g}`,async()=>{const b=await fetch(`${e}${Je.SUPPLIES_BY_PRODUCT(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Lỗi tải danh sách nguồn.");return await b.json()},x);a(v)}catch(v){console.error("Lỗi khi fetch supplies:",v),a(t)}},[e,t]),h=m.useCallback(async(p,x=!1)=>{const g=f2(p);if(!g){c([]);return}try{const v=await bc(`supplyPricesByProduct:${e}:${g}`,async()=>{const b=await fetch(`${e}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Lỗi tính giá nhập của nguồn.");return await b.json()},x);c(v)}catch(v){console.error("Lỗi khi fetch all supply prices:",v),c([])}},[e]);return{allSupplies:t,supplies:n,products:i,supplyPrices:l,setSupplies:a,setSupplyPrices:c,fetchProducts:u,fetchAllSupplies:d,fetchSuppliesByProduct:f,fetchAllSupplyPrices:h}},UW=({supplies:e,supplyPrices:t,formData:r,customerType:n,productName:a,orderId:i,registerDate:s,setSelectedSupplyId:l,setFormData:c,setIsDataLoaded:u,recalcPrice:d})=>{const f=m.useMemo(()=>{const g=new Map,v=new Map;for(const b of e){g.set(b.id,b);const w=b.supplier_name??b.source_name??"";w&&!v.has(w)&&v.set(w,b.id)}return{byId:g,idByName:v}},[e]),h=m.useMemo(()=>{const g=new Map,v=new Map;for(const b of t){const w=Number(b.price);if(!Number.isFinite(w))continue;g.has(b.source_id)||g.set(b.source_id,w);const y=b.supplier_name??b.source_name;y&&!v.has(y)&&v.set(y,w)}return{byId:g,byName:v}},[t]),p=m.useCallback((g,v,b)=>{if(v){const w=h.byName.get(v);if(w!==void 0&&Number.isFinite(w))return w;const y=f.idByName.get(v);if(y!==void 0){const N=h.byId.get(y);if(N!==void 0&&Number.isFinite(N))return N}}if(g!==0){const w=h.byId.get(g);if(w!==void 0&&Number.isFinite(w))return w}return b},[f.idByName,h.byId,h.byName]);return{handleSourceSelect:m.useCallback(g=>{const v=f.byId.get(g),b=Number(r[H.COST]||0),w=v?.supplier_name??v?.source_name??"",y=p(g,w,b);if(l(g===0?null:g),c(N=>{const S={...N,[H.SUPPLY]:v?w:"",[H.COST]:y};return n===wt.PROMO&&(S[H.PRICE]=y),S}),!a||!i||!s){u(!1);return}d(g,a,i,s,y,{updateCost:!0})},[n,r,p,i,a,d,s,c,u,l,f.byId])}},HW=Sl,zW=(e,t,r)=>{const{formData:n,setFormData:a,customerType:i,setCustomerType:s,selectedSupplyId:l,setSelectedSupplyId:c,customProductTouched:u,setCustomProductTouched:d,updateForm:f}=PW(Y5),{allSupplies:h,supplies:p,products:x,supplyPrices:g,setSupplies:v,setSupplyPrices:b,fetchProducts:w,fetchAllSupplies:y,fetchSuppliesByProduct:N,fetchAllSupplyPrices:S}=$W(HW),E=n[H.ID_PRODUCT],_=n[H.ID_ORDER],j=n[H.ORDER_DATE],A=n[H.INFORMATION_ORDER]||"",{isLoading:T,isDataLoaded:k,setIsDataLoaded:C,recalcPrice:L,infoRef:G}=RW({customerType:i,setFormData:a,productName:E}),V=m.useMemo(()=>Ha(),[]);OW({isOpen:e,customerType:i,setCustomerType:s,setFormData:a,setIsDataLoaded:C,setSelectedSupplyId:c,setSupplies:v,setSupplyPrices:b,setCustomProductTouched:d,fetchProducts:w,fetchAllSupplies:y}),DW({infoValue:A,infoRef:G,productName:E,orderId:_,registerDate:j,selectedSupplyId:l,customMode:r,customerType:i,recalcPrice:L});const{handleProductSelect:X}=MW({productName:E,orderId:_,registerDate:j,allSupplies:h,selectedSupplyId:l,customMode:r,todayDate:V,setSelectedSupplyId:c,setCustomProductTouched:d,setFormData:a,setSupplies:v,setSupplyPrices:b,setIsDataLoaded:C,fetchSuppliesByProduct:N,fetchAllSupplyPrices:S,recalcPrice:L}),{handleSourceSelect:K}=UW({supplies:p,supplyPrices:g,formData:n,customerType:i,productName:E,orderId:_,registerDate:j,setSelectedSupplyId:c,setFormData:a,setIsDataLoaded:C,recalcPrice:L}),Y=le=>{const{name:ce,value:me}=le.target;f({[ce]:me})},q=le=>{const ce=le.target.value;s(ce),c(null),v([]),b([]),C(!1),a(me=>({...me,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:me[H.ORDER_DATE]||Ha()}))},{handleSubmit:Z}=IW({formData:n,isLoading:T,updateForm:f,onSave:t});return{formData:n,supplies:p,allSupplies:h,products:x,isLoading:T,isDataLoaded:k,selectedSupplyId:l,customerType:i,updateForm:f,setIsDataLoaded:C,customProductTouched:u,setCustomProductTouched:d,handleChange:Y,handleProductSelect:X,handleSourceSelect:K,handleCustomerTypeChange:q,handleSubmit:Z}},WW=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=m.useState(!1),{formData:i,updateForm:s,supplies:l,products:c,isLoading:u,selectedSupplyId:d,customerType:f,setIsDataLoaded:h,customProductTouched:p,setCustomProductTouched:x,handleChange:g,handleProductSelect:v,handleSourceSelect:b,handleCustomerTypeChange:w,handleSubmit:y}=zW(e,r,n),N=i[H.INFORMATION_ORDER]||"",S=i[H.ID_PRODUCT]||"",E=i[H.ORDER_DATE]||Ha(),_=i[H.COST],j=i[H.PRICE],A=m.useMemo(()=>i[H.ORDER_EXPIRED]||"",[i]),T=m.useMemo(()=>i[H.ORDER_DATE]||Ha(),[i]),k=m.useMemo(()=>Number(i[H.DAYS]||0)||0,[i]),C=m.useMemo(()=>c.map(Y=>({value:Y.san_pham,label:Y.san_pham})),[c]),L=m.useMemo(()=>l.map(Y=>({value:Y.id,label:Y.supplier_name??Y.source_name})),[l]),G=m.useCallback(Y=>q=>{const le=(q.target.value||"").replace(/\D/g,""),ce=le?parseInt(le,10):0;s({[Y]:ce})},[s]),V=m.useCallback(Y=>{const q=yt(Y.target.value)||Y.target.value||"",Z=k>0?fl(q,k):q,le={[H.ORDER_DATE]:q};Z&&Z!=="N/A"?le[H.ORDER_EXPIRED]=Z:k<=0&&q&&(le[H.ORDER_EXPIRED]=q),s(le)},[k,s]);m.useEffect(()=>{if(!n||!p)return;const Y=$u(N)||$u(S),q=E;if(Y>0){const Z=$5(q,Y),le=Iz(q,Z);s({[H.DAYS]:String(le),[H.ORDER_EXPIRED]:Z})}},[n,p,N,S,E,s]),m.useEffect(()=>{if(!A)return;const Y=yt(A);if(!Y&&T&&k>0){const q=fl(T,k);q&&q!=="N/A"&&q!==A&&s({[H.ORDER_EXPIRED]:q})}else Y&&Y!==A&&s({[H.ORDER_EXPIRED]:Y})},[A,T,k,s]);const X=m.useMemo(()=>{const Y=i[H.ID_PRODUCT]||"",q=i[H.SUPPLY]||"",Z=i[H.INFORMATION_ORDER]||"",le=i[H.CUSTOMER]||"";return!!Y&&!!q&&!!Z&&!!le},[i]);if(m.useEffect(()=>{h(X)},[X,h]),!e)return null;const K=!!(i[H.CUSTOMER]&&i[H.ID_PRODUCT]&&i[H.SUPPLY]&&i[H.INFORMATION_ORDER]);return o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 p-2 sm:p-4",children:o.jsxs("div",{className:"glass-panel border-white/10 rounded-[32px] shadow-[0_32px_64px_-16px_rgba(0,0,0,0.6)] w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col text-slate-100 overflow-hidden",children:[o.jsxs("div",{className:"p-6 sm:p-8 border-b border-white/5 sticky top-0 bg-[#0c1222]/80 backdrop-blur-xl z-20 flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white tracking-tight",children:"Tạo Đơn Hàng Mới"}),o.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:o.jsx(Pt,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:o.jsx("form",{onSubmit:y,children:o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-6 rounded-2xl bg-white/5 border border-white/5",children:[o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Loại Khách Hàng"}),o.jsx("select",{name:"customer_type",value:f,onChange:w,className:hr,children:wW.map(Y=>o.jsx("option",{value:Y.value,children:Y.label},Y.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Mã Đơn Hàng"}),o.jsx("input",{type:"text",name:H.ID_ORDER,value:i[H.ID_ORDER]||"",readOnly:!0,className:`${hr} font-semibold ${Io}`})]}),o.jsxs("div",{children:[o.jsxs("label",{className:Nr,children:["Tên Khách Hàng ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:H.CUSTOMER,value:i[H.CUSTOMER]||"",onChange:g,className:hr,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Link Liên Hệ"}),o.jsx("input",{type:"url",name:H.CONTACT,value:i[H.CONTACT]||"",onChange:g,className:hr})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[o.jsxs("div",{className:"md:col-span-5",children:[o.jsxs("label",{className:Nr,children:["Sản Phẩm ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(u2,{name:H.ID_PRODUCT,value:i[H.ID_PRODUCT]||"",options:C,placeholder:"-- Chọn --",onChange:Y=>v(String(Y)),onClear:()=>v(""),disabled:n})]}),o.jsxs("div",{className:"md:col-span-5",children:[o.jsxs("label",{className:Nr,children:["Nguồn ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(u2,{name:H.SUPPLY,value:d??"",options:L,placeholder:"-- Chọn --",disabled:n||!i[H.ID_PRODUCT],onChange:Y=>b(Number(Y)),onClear:()=>b(0)})]}),o.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:o.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{x(!1),a(Y=>!Y)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?o.jsx(IN,{className:"h-6 w-6","aria-hidden":"true"}):o.jsx(hm,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&o.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Sản Phẩm Mới"}),o.jsx("input",{type:"text",name:H.ID_PRODUCT,value:i[H.ID_PRODUCT]||"",onChange:g,onBlur:()=>x(!0),className:hr,placeholder:"Nhập Tên Sản Phẩm Mới"})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Nguồn Mới"}),o.jsx("input",{type:"text",name:H.SUPPLY,value:i[H.SUPPLY]||"",onChange:g,className:hr,placeholder:"Nhập Tên Nguồn Mới"})]})]}),o.jsxs("div",{className:"md:col-span-12",children:[o.jsxs("label",{className:Nr,children:["Thông Tin Sản Phẩm ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:H.INFORMATION_ORDER,value:i[H.INFORMATION_ORDER]||"",onChange:g,className:hr,required:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Ngày Đăng Ký (dd/mm/yyyy)"}),o.jsx("input",{type:"text",name:H.ORDER_DATE,value:T,placeholder:"dd/mm/yyyy",onChange:V,className:hr})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Số Ngày Đăng Ký"}),o.jsx("input",{type:"text",name:H.DAYS,value:i[H.DAYS]||"",readOnly:!0,className:`${hr} ${Io}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Ngày Hết Hạn"}),o.jsx("input",{type:"text",name:H.ORDER_EXPIRED,value:i[H.ORDER_EXPIRED]||"",readOnly:!0,className:`${hr} font-bold text-rose-400 ${Io}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Slot"}),o.jsx("input",{type:"text",name:H.SLOT,value:i[H.SLOT]||"",onChange:g,className:hr})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Giá Nhập"}),n?o.jsx("input",{type:"text",inputMode:"numeric",name:H.COST,value:e2(Number(_??0)),onChange:G(H.COST),className:`${hr} font-semibold`}):o.jsx("input",{type:"text",name:H.COST,value:Tn(_??0),readOnly:!0,className:`${hr} font-semibold ${Io}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Giá Bán"}),n?o.jsx("input",{type:"text",inputMode:"numeric",name:H.PRICE,value:e2(Number(j??0)),onChange:G(H.PRICE),className:`${hr} font-bold text-emerald-400`}):o.jsx("input",{type:"text",name:H.PRICE,value:Tn(j??0),readOnly:!0,className:`${hr} font-bold text-emerald-400 ${Io}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:Nr,children:"Ghi Chú"}),o.jsx("textarea",{name:H.NOTE,value:i[H.NOTE]||"",onChange:g,rows:8,className:hr})]})]})]})]})})}),o.jsxs("div",{className:"p-6 sm:p-8 border-t border-white/5 bg-[#0c1222]/50 backdrop-blur-xl flex justify-end sticky bottom-0 z-20",children:[o.jsx("button",{type:"button",onClick:t,className:"px-8 py-2.5 text-sm font-bold text-slate-300 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-all shadow-lg mr-4",children:"Hủy"}),o.jsx("button",{type:"submit",onClick:y,className:`px-8 py-2.5 text-sm font-bold text-white rounded-xl transition-all shadow-[0_0_20px_rgba(16,185,129,0.3)] ${K&&!u?"bg-emerald-500 hover:bg-emerald-600 hover:scale-[1.02] active:scale-[0.98]":"bg-slate-700 opacity-50 cursor-not-allowed"}`,disabled:!K||u,children:u?"Đang Tính Giá...":"Tạo Đơn Hàng"})]})]})})},VW=Sl;function KW(e){const[t,r]=m.useState([]),[n,a]=m.useState(null),i=m.useCallback(async()=>{try{a(null);const s=q5[e].endpoint,l=await fetch(`${VW}${s}`,{credentials:"include"});if(l.status===401){window.location.href="/login";return}if(!l.ok)throw new Error(`Lỗi máy chủ: ${l.status}`);const c=await l.json();Array.isArray(c)?r(c):console.error("Dữ liệu nhận được không phải là mảng:",c)}catch(s){console.error("Lỗi khi tải đơn hàng:",s);const{handleNetworkError:l}=await Vc(async()=>{const{handleNetworkError:u}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:u}},[]),c=l(s);a(c)}},[e]);return m.useEffect(()=>{i()},[i]),{orders:t,setOrders:r,fetchError:n,fetchOrders:i}}function GW(e,t=300){const[r,n]=m.useState(e);return m.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}const Fs=e=>kn(e).toLocaleString("vi-VN")+" VND",Ro=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},Uc=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),oh=e=>Uc(e).replace(/[^a-z0-9]/g,""),h2=(e,t)=>{const r=e??t;return r==null?"":yt(r)||String(r)},Ca=e=>{if(e==null)return e;if(typeof e!="boolean"&&(typeof e=="string"||typeof e=="number"||e instanceof Date))return e},XW=e=>e==null?e:typeof e=="boolean"?null:typeof e=="number"||typeof e=="string"?e:null,lh=e=>{if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},p2=e=>{const t=Ca(e.expiry_date)??Ca(e[H.ORDER_EXPIRED])??Ca(e.expiry_date_display)??Ca(e[st.EXPIRY_DATE_DISPLAY]),n=(yt(t)||String(t||"")).split("/");if(n.length===3){const[i,s,l]=n.map(Number);if(Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(l))return new Date(l,s-1,i).getTime()}const a=new Date(String(t||""));return Number.isFinite(a.getTime())?a.getTime():0};function YW(e,t){return e.map(r=>{const n=Ca(r.registration_date??r[H.ORDER_DATE]),a=Ca(r.expiry_date??r[H.ORDER_EXPIRED]),i=h2(Ca(r.registration_date_display),n),s=h2(Ca(r.expiry_date_display),a),l=lh(XW(r.so_ngay_con_lai)),c=U5(a||s),u=l??c??0,d=r[H.STATUS]||rt.CHUA_THANH_TOAN,f=String(d).trim(),h=kn(Number.parseFloat(String(r[H.PRICE]??0))||0),p=Number(r[H.DAYS])||0,x=Math.max(0,u);let g=p>0?h*x/p:0;const v=r.can_hoan??r[H.REFUND]??r.refund;let b=lh(v)??(Number.isFinite(g)?g:null);if(t==="canceled"){const w=lh(r.refund);w!==null&&(g=w,b=w)}return{...r,[st.SO_NGAY_CON_LAI]:u,[st.GIA_TRI_CON_LAI]:g,[st.TRANG_THAI_TEXT]:f,[st.ORDER_DATE_DISPLAY]:i,[st.EXPIRY_DATE_DISPLAY]:s,can_hoan:b}})}const m2=e=>e===rt.CHUA_THANH_TOAN||e===rt.CHO_HOAN;function qW(e,t){const{searchTerm:r,searchField:n,statusFilter:a,dataset:i}=t,s=Uc(r),l=oh(r),c=n==="all"?[H.CUSTOMER,H.ID_ORDER,H.ID_PRODUCT,H.INFORMATION_ORDER,H.SUPPLY,H.CONTACT]:[n],u=a==="all"?"":String(a||"").trim();return[...e.filter(h=>{const p=!s||c.some(w=>{const y=h[w],N=Uc(y);if(!N)return!1;if(w===H.ID_ORDER){const S=oh(y);return!!l&&S.includes(l)||N.includes(s)}return N.includes(s)}),x=!!l&&oh(h[H.ID_ORDER]).includes(l),g=!!s&&Uc(h[H.ID_PRODUCT]).includes(s),v=String(h[st.TRANG_THAI_TEXT]||"").trim();return(p||x||g)&&(a==="all"||u&&v===u)})].sort((h,p)=>{const x=String(h[st.TRANG_THAI_TEXT]||"").trim(),g=String(p[st.TRANG_THAI_TEXT]||"").trim(),v=m2(x),b=m2(g);if(v!==b)return v?-1:1;if(i==="expired"){const j=p2(h),A=p2(p);if(j!==A)return A-j}const w=r2(x),y=r2(g);if(w!==y)return w-y;const N=Number(h[st.SO_NGAY_CON_LAI]??0),S=Number(p[st.SO_NGAY_CON_LAI]??0);if(N!==S)return N-S;const E=h[H.ID_ORDER]||"",_=p[H.ID_ORDER]||"";return E<_?-1:E>_?1:0})}function ZW(e){const t=e.length,r=e.filter(s=>{const l=Number(s[st.SO_NGAY_CON_LAI]??0);return Number.isFinite(l)&&l>0&&l<=4}).length,n=e.filter(s=>{const l=Number(s[st.SO_NGAY_CON_LAI]??0);return Number.isFinite(l)&&l<=0}).length,a=e.filter(s=>{const l=Ca(s.registration_date||s.registration_date_display||s[st.ORDER_DATE_DISPLAY]||s[H.ORDER_DATE]);return Rz(l)}).length;return{updatedStats:[{...vc[0],value:String(t)},{...vc[1],value:String(r)},{...vc[2],value:String(n)},{...vc[3],value:String(a)}],totalRecords:t}}function JW(e,t,r){const n=Math.max(1,Math.ceil(e.length/r)),a=t*r,i=a-r;return{currentOrders:e.slice(i,a),totalPages:n}}function QW(e,t){const r=[];if(t<=7){for(let s=1;s<=t;s++)r.push(s);return r}const n=(s,l,c)=>Math.min(Math.max(s,l),c),a=n(e-1,2,t-3),i=n(e+1,4,t-1);r.push(1),a>2&&r.push("...");for(let s=a;s<=i;s++)r.push(s);return i<t-1&&r.push("..."),r.push(t),r}function eV({orders:e,searchTerm:t,searchField:r,statusFilter:n,rowsPerPage:a,currentPage:i,setCurrentPage:s,dataset:l}){const c=GW(t,300),u=m.useMemo(()=>{const f=YW(e,l),h=qW(f,{searchTerm:c,searchField:r,statusFilter:n,dataset:l}),{updatedStats:p,totalRecords:x}=ZW(f),{currentOrders:g,totalPages:v}=JW(h,i,a);return{filteredOrders:h,currentOrders:g,totalPages:v,updatedStats:p,totalRecords:x}},[e,l,c,r,n,a,i]);m.useEffect(()=>{s(1)},[c,r,n,a,s]);const d=m.useMemo(()=>QW(i,u.totalPages),[i,u.totalPages]);return{...u,paginationPages:d}}function tV(){const[e,t]=m.useState(!1),[r,n]=m.useState(!1),[a,i]=m.useState(!1),[s,l]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState("view"),[h,p]=m.useState(null),[x,g]=m.useState(null),v=m.useCallback(()=>l(!0),[]),b=m.useCallback(()=>l(!1),[]),w=m.useCallback(()=>{n(!1),u(null),f("view")},[]),y=m.useCallback(()=>{i(!1),g(null)},[]),N=m.useCallback(()=>{t(!1),p(null)},[]),S=m.useCallback((A,T="view")=>{u(A),f(T),n(!0)},[]),E=m.useCallback(A=>{const T={...A,cost:Number(A[H.COST]??0)||0,price:Number(A[H.PRICE]??0)||0};g(T),i(!0)},[]),_=m.useCallback(A=>{p(A),t(!0)},[]),j=m.useCallback(()=>{t(!1),n(!1),i(!1),l(!1),u(null),f("view"),p(null),g(null)},[]);return{isModalOpen:e,isViewModalOpen:r,viewModalSource:d,isEditModalOpen:a,isCreateModalOpen:s,orderToView:c,orderToDelete:h,orderToEdit:x,openCreateModal:v,closeCreateModal:b,closeViewModal:w,closeEditModal:y,closeModal:N,handleViewOrder:S,handleEditOrder:E,handleDeleteOrder:_,resetModals:j,setOrderToDelete:p}}const Hp="app:data-refresh",Q5=e=>!e||e.length===0?["all"]:e,rV=(e,t)=>e.includes("all")||t.some(r=>e.includes(r)),Ss=(e=["all"])=>{if(typeof window>"u")return;const t={scopes:Q5(e)};window.dispatchEvent(new CustomEvent(Hp,{detail:t}))},nV=(e,t)=>{if(typeof window>"u")return()=>{};const r=n=>{const a=n.detail,i=Q5(a?.scopes);rV(i,e)&&t()};return window.addEventListener(Hp,r),()=>{window.removeEventListener(Hp,r)}},Es=Sl;function aV(e){const{fetchOrders:t,closeCreateModal:r,closeEditModal:n,closeModal:a,handleViewOrder:i,orderToDelete:s,setOrderToDelete:l,setOrders:c}=e,[u,d]=m.useState(null),f=m.useCallback(async b=>{r();try{const w=await fetch(`${Es}${Je.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(b)});if(!w.ok){const N=await w.json();throw new Error(N.error||"Lỗi khi tạo đơn hàng mới từ Máy chủ")}await t();const y=await w.json();i(y,"create"),Ss(["orders","dashboard"])}catch(w){console.error("Lỗi khi tạo đơn hàng:",w),Tr({type:"error",title:"Lỗi tạo đơn hàng",message:`Lỗi khi tạo đơn hàng: ${w instanceof Error?w.message:String(w)}`})}},[r,t,i]),h=m.useCallback(async b=>{if(!b||!b.id)return;const w=String(b[H.STATUS]||"").trim();let y=null;if(w===rt.CHUA_THANH_TOAN?y={[H.STATUS]:rt.DANG_XU_LY}:w===rt.DANG_XU_LY&&(y={[H.STATUS]:rt.DA_THANH_TOAN}),!!y)try{const N=await fetch(`${Es}${Je.ORDER_BY_ID(b.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(y)});if(!N.ok){const S=await Ro(N);throw new Error(S||"Lỗi khi cập nhật trạng thái từ máy chủ")}await t(),Ss(["orders","dashboard"])}catch(N){console.error("Lỗi khi đánh dấu đã thanh toán:",N),Tr({type:"error",title:"Lỗi cập nhật thanh toán",message:`Không thể đánh dấu đã thanh toán: ${N instanceof Error?N.message:String(N)}`})}},[t]),p=m.useCallback(async b=>{if(!b)return;const w=String(b[H.ID_ORDER]||"").trim();if(w){d(w);try{const y=await fetch(`${Es}${Je.ORDER_RENEW(w)}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({forceRenewal:!0})});if(!y.ok){const N=await Ro(y);throw new Error(N||"Không thể gia hạn thủ công cho đơn hàng.")}await t(),Ss(["orders","dashboard"]),Tr({type:"success",title:"Gia hạn thành công",message:`Gia hạn đơn hàng thành công.
Đơn đã được xử lý renewal thủ công.`})}catch(y){console.error("Lỗi khi chạy gia hạn thủ công:",y),Tr({type:"error",title:"Lỗi gia hạn",message:`Không thể gia hạn đơn hàng: ${y instanceof Error?y.message:String(y)}`})}finally{d(null)}}},[t]),x=m.useCallback(async b=>{if(!(!b||!b.id))try{const w=await fetch(`${Es}${Je.ORDER_CANCELED_REFUND(b.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!w.ok){const y=await Ro(w);throw new Error(y||"Lỗi khi xác nhận hoàn tiền từ máy chủ")}await t(),Ss(["orders","dashboard"])}catch(w){console.error("Lỗi khi xác nhận hoàn tiền:",w),Tr({type:"error",title:"Lỗi xác nhận hoàn tiền",message:`Lỗi khi xác nhận hoàn tiền: ${w instanceof Error?w.message:String(w)}`})}},[t]),g=m.useCallback(async b=>{n();const w={[H.ID_ORDER]:b.id_order,[H.ID_PRODUCT]:b.id_product,[H.INFORMATION_ORDER]:b.information_order,[H.CUSTOMER]:b.customer,[H.CONTACT]:b.contact,[H.SLOT]:b.slot,[H.SUPPLY]:b.supply,[H.COST]:Number(b.cost??0)||0,[H.PRICE]:Number(b.price??0)||0,[H.NOTE]:b.note,[H.STATUS]:b.status};try{const y=await fetch(`${Es}${Je.ORDER_BY_ID(Number(b.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(w)});if(!y.ok){const N=await Ro(y);throw new Error(N||"Lỗi khi cập nhật đơn hàng từ Máy chủ")}await t(),Ss(["orders","dashboard"])}catch(y){console.error("Lỗi khi cập nhật đơn hàng:",y),Tr({type:"error",title:"Lỗi cập nhật đơn hàng",message:`Lỗi khi cập nhật đơn hàng: ${y instanceof Error?y.message:String(y)}`})}},[n,t]),v=m.useCallback(async()=>{if(s){a();try{const b=await fetch(`${Es}${Je.ORDER_BY_ID(s.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:s[st.GIA_TRI_CON_LAI],gia_tri_con_lai:s[st.GIA_TRI_CON_LAI]})});if(!b.ok){const w=await Ro(b);throw new Error(w||"Lỗi khi xóa đơn hàng từ Máy chủ")}c(w=>w.filter(y=>y.id!==s.id)),Ss(["orders","dashboard"])}catch(b){console.error("Lỗi khi xóa đơn hàng:",b),Tr({type:"error",title:"Lỗi xóa đơn hàng",message:`Lỗi khi xóa đơn hàng: ${b instanceof Error?b.message:String(b)}`})}finally{l(null)}}},[a,s,l,c]);return{handleSaveNewOrder:f,handleMarkPaid:h,handleRenewOrder:p,handleConfirmRefund:x,handleSaveEdit:g,confirmDelete:v,renewingOrderCode:u}}function iV(e){const{orders:t,setOrders:r,fetchError:n,fetchOrders:a}=KW(e),[i,s]=m.useState(""),[l,c]=m.useState("all"),[u,d]=m.useState("all"),[f,h]=m.useState(1),[p,x]=m.useState(10),g=tV(),v=eV({orders:t,searchTerm:i,searchField:l,statusFilter:u,rowsPerPage:p,currentPage:f,setCurrentPage:h,dataset:e}),b=aV({fetchOrders:a,closeCreateModal:g.closeCreateModal,closeEditModal:g.closeEditModal,closeModal:g.closeModal,handleViewOrder:g.handleViewOrder,orderToDelete:g.orderToDelete,setOrderToDelete:g.setOrderToDelete,setOrders:r});return m.useEffect(()=>{r([]),s(""),d("all"),h(1),g.resetModals()},[e,r,g.resetModals]),{...v,searchTerm:i,setSearchTerm:s,searchField:l,setSearchField:c,statusFilter:u,setStatusFilter:d,currentPage:f,setCurrentPage:h,rowsPerPage:p,setRowsPerPage:x,isModalOpen:g.isModalOpen,isViewModalOpen:g.isViewModalOpen,viewModalSource:g.viewModalSource,isEditModalOpen:g.isEditModalOpen,isCreateModalOpen:g.isCreateModalOpen,orderToView:g.orderToView,orderToDelete:g.orderToDelete,orderToEdit:g.orderToEdit,openCreateModal:g.openCreateModal,closeCreateModal:g.closeCreateModal,closeViewModal:g.closeViewModal,closeEditModal:g.closeEditModal,closeModal:g.closeModal,handleViewOrder:g.handleViewOrder,handleEditOrder:g.handleEditOrder,handleDeleteOrder:g.handleDeleteOrder,handleSaveNewOrder:b.handleSaveNewOrder,handleSaveEdit:b.handleSaveEdit,handleConfirmRefund:b.handleConfirmRefund,handleMarkPaid:b.handleMarkPaid,handleRenewOrder:b.handleRenewOrder,confirmDelete:b.confirmDelete,renewingOrderCode:b.renewingOrderCode,fetchError:n,reloadOrders:a}}const eT=la.memo(function({order:t,isExpanded:r,showRemainingColumn:n,showActionButtons:a,isCanceled:i,totalColumns:s,renewingOrderCode:l,onToggleDetails:c,onView:u,onEdit:d,onDelete:f,onConfirmRefund:h,onMarkPaid:p,onRenew:x}){const{[st.SO_NGAY_CON_LAI]:g,[st.GIA_TRI_CON_LAI]:v,[st.TRANG_THAI_TEXT]:b}=t,w=Number.isFinite(Number(t[H.COST]))?Number(t[H.COST]):0,y=Number.isFinite(Number(t[H.PRICE]))?Number(t[H.PRICE]):0,N=Number.isFinite(Number(v))?Number(v):0,S=Number.isFinite(Number(t.can_hoan))?Number(t.can_hoan):null,E=i?Math.max(0,S!==null&&Number.isFinite(N)?Math.min(S,N):S??N):N,_=rt.CHO_HOAN,j=String(b||"").trim(),A=i&&j===_,T=j===rt.CAN_GIA_HAN||j===rt.ORDER_EXPIRED,k=j===rt.CHUA_THANH_TOAN,C=j===rt.DANG_XU_LY,L=t[st.ORDER_DATE_DISPLAY]||"",G=t[st.EXPIRY_DATE_DISPLAY]||"",V=String(t[H.ID_ORDER]||"").trim(),X=l===V,K=Number.isFinite(Number(g))?Number(g):0,Y=i?"text-indigo-600":K<=0?"text-red-600":K<=4?"text-orange-500":"text-green-500",q=i?Fs(E):K,Z=m.useCallback(()=>{t.id!==void 0&&t.id!==null&&c(t.id)},[c,t.id]),le=ce=>me=>{me.stopPropagation(),ce(t)};return o.jsxs(la.Fragment,{children:[o.jsxs("tr",{onClick:Z,className:`order-row ${r?"order-row--expanded":""} group/row cursor-pointer transition-all duration-500 ${r?"z-20":"z-10"}`,children:[o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 first:rounded-l-[16px] sm:first:rounded-l-[24px] last:rounded-r-[16px] sm:last:rounded-r-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:o.jsxs("div",{className:"flex flex-col items-center w-full",children:[o.jsx("span",{className:"text-xs sm:text-sm font-bold text-white tracking-normal sm:tracking-wider uppercase truncate w-full block text-center",children:t[H.ID_ORDER]||""}),o.jsx("span",{className:"text-indigo-400/80 text-[10px] sm:text-[11px] font-bold mt-1 uppercase tracking-normal sm:tracking-wider truncate w-full block text-center",children:t[H.ID_PRODUCT]||""})]})}),o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:o.jsxs("div",{className:"flex flex-col items-center w-full",children:[o.jsx("span",{className:"text-indigo-100/90 text-xs font-medium tracking-wide text-center truncate w-full block",children:t[H.INFORMATION_ORDER]||"—"}),t[H.SLOT]?o.jsx("div",{className:"mt-1 px-2 py-0.5 rounded-md bg-white/5 border border-white/10 text-[11px] font-bold text-indigo-300/80 uppercase w-full truncate text-center block",children:t[H.SLOT]}):null]})}),o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:o.jsxs("div",{className:"flex flex-col items-center w-full",children:[o.jsx("span",{className:"text-sm font-bold text-white tracking-tight truncate w-full block text-center",children:t[H.CUSTOMER]||"Khách ẩn"}),o.jsx("span",{className:"text-white/60 text-[11px] font-medium mt-0.5 truncate w-full block text-center",children:t[H.CONTACT]||""})]})}),o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:o.jsxs("div",{className:"inline-flex items-center justify-center gap-1.5 px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] sm:text-[11px] font-bold text-indigo-200 w-full truncate",children:[o.jsx("span",{className:"truncate",children:L||"—"}),o.jsx("span",{className:"text-white/20 shrink-0",children:"/"}),o.jsx("span",{className:"truncate",children:G||"—"})]})}),n&&o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:o.jsx("span",{className:`text-sm font-black transition-all group-hover/row:scale-110 inline-block w-full truncate ${Y}`,children:q})}),o.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:o.jsx("span",{className:`inline-block px-2 py-1 text-[9px] sm:text-[10px] font-bold uppercase tracking-wider rounded-full border shadow-[inset_0_1px_2px_rgba(255,255,255,0.1)] whitespace-nowrap w-full truncate overflow-hidden text-ellipsis ${W5(String(b||""))}`,children:String(b||"")})}),o.jsx("td",{className:"order-row__actions px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 last:rounded-r-[16px] sm:last:rounded-r-[24px]",children:o.jsxs("div",{className:"flex space-x-2 justify-end flex-shrink-0",children:[o.jsx("button",{onClick:le(u),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-indigo-300/60 hover:text-white hover:bg-indigo-500/20 hover:border-indigo-500/40 transition-all flex-shrink-0",children:o.jsx(ma,{className:"h-4 w-4"})}),A&&o.jsx("button",{onClick:le(h),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 transition-all flex-shrink-0",title:"Xác nhận đã giải/hoàn tiền",children:o.jsx(Ui,{className:"h-4 w-4"})}),!i&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:le(d),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-400 hover:bg-amber-500/30 transition-all flex-shrink-0",children:o.jsx(ca,{className:"h-4 w-4"})}),o.jsx("button",{onClick:le(f),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500/30 transition-all flex-shrink-0",title:"Xoá đơn hàng",children:o.jsx(Kr,{className:"h-4 w-4"})})]})]})})]}),r&&o.jsx("tr",{className:"order-row__expandable animate-in fade-in slide-in-from-top-2 duration-300",children:o.jsx("td",{colSpan:s,className:"order-row__expandable-cell px-6 pb-8 pt-2",children:o.jsxs("div",{className:"order-row__expandable-content rounded-[32px] glass-panel-light p-6 shadow-2xl border border-indigo-500/20",children:[o.jsxs("div",{className:"order-row__expandable-header mb-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 text-center",children:[o.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tiết đơn hàng"}),o.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",t[H.ID_ORDER]||""]})]}),a&&o.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[k&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:le(p),children:"Thanh Toán"}),C&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:le(p),children:"Thanh Toán"}),T&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:X,onClick:ce=>{ce.stopPropagation(),X||x(t)},children:X?"Đang Gia Hạn...":"Gia Hạn"})]})]}),o.jsxs("div",{className:"order-row__detail-grid grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[o.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Nguồn"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[H.SUPPLY]||"N/A"})]}),o.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá nhập"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Fs(w)})]}),o.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá bán"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Fs(y)})]}),o.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá trị còn lại"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:Fs(E)})]}),o.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Số ngày"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[H.DAYS]||0})]}),o.jsxs("div",{className:"order-row__detail-item order-row__detail-item--note rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi chú"}),o.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:t[H.NOTE]||"Không có ghi chú."})]})]})]})})})]})});eT.displayName="OrderRow";const sV=({order:e,showRemainingColumn:t,showActionButtons:r,isCanceled:n,renewingOrderCode:a,onView:i,onEdit:s,onDelete:l,onConfirmRefund:c,onMarkPaid:u,onRenew:d})=>{const f=e[H.ID_ORDER]||"--",h=e[H.CUSTOMER]||"--",p=e[H.ID_PRODUCT]||"--",x=e[H.SUPPLY]||"",g=e[H.ORDER_EXPIRED]||"",v=e[st.TRANG_THAI_TEXT]||"",b=Number(e[H.PRICE]||0),w=Number(e[st.SO_NGAY_CON_LAI]||0),y={[rt.DA_THANH_TOAN]:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",[rt.CHUA_THANH_TOAN]:"bg-amber-500/20 text-amber-300 border-amber-500/30",[rt.ORDER_EXPIRED]:"bg-rose-500/20 text-rose-300 border-rose-500/30",[rt.CAN_GIA_HAN]:"bg-sky-500/20 text-sky-300 border-sky-500/30",[rt.CHO_HOAN]:"bg-rose-500/20 text-rose-300 border-rose-500/30",[rt.DA_HOAN]:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",[rt.DANG_XU_LY]:"bg-indigo-500/20 text-indigo-300 border-indigo-500/30"},N=String(v||"").trim(),S=y[N]||"bg-slate-500/20 text-slate-300 border-slate-500/30",E=N,_=String(e[H.ID_ORDER]||"").trim(),j=N===rt.CAN_GIA_HAN||N===rt.ORDER_EXPIRED,A=N===rt.CHUA_THANH_TOAN,T=N===rt.DANG_XU_LY,k=a===_;return o.jsxs("div",{className:"order-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[o.jsx("div",{className:`order-card__glow absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${E===rt.DA_THANH_TOAN?"bg-emerald-500":E===rt.CHUA_THANH_TOAN?"bg-amber-500":E===rt.ORDER_EXPIRED||E===rt.CHO_HOAN?"bg-rose-500":"bg-indigo-500"}`}),o.jsxs("div",{className:"order-card__inner relative z-10 flex flex-col gap-4",children:[o.jsxs("div",{className:"order-card__header flex flex-col gap-2.5",children:[o.jsxs("div",{className:"order-card__title-row flex items-center gap-2",children:[o.jsx("span",{className:"order-card__dot w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),o.jsx("h3",{className:"order-card__title text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:f})]}),o.jsxs("div",{className:"order-card__tags flex items-center flex-wrap gap-2",children:[o.jsx("div",{className:"order-card__product-tag inline-flex self-start px-2.5 py-1 rounded-lg bg-indigo-500/10 border border-indigo-500/20 backdrop-blur-md min-w-0",children:o.jsx("p",{className:"text-[10px] sm:text-[11px] font-bold text-indigo-300 uppercase tracking-wide truncate max-w-[140px] sm:max-w-[200px]",children:p})}),x&&o.jsx("div",{className:"order-card__supply-tag inline-flex self-start px-2.5 py-1 rounded-lg bg-purple-500/10 border border-purple-500/20 backdrop-blur-md min-w-0",children:o.jsxs("p",{className:"text-[10px] sm:text-[11px] font-bold text-purple-300 uppercase tracking-wide truncate max-w-[120px] sm:max-w-[160px]",children:["NCC: ",x]})})]}),o.jsxs("div",{className:"order-card__status-row flex items-center justify-between gap-2",children:[o.jsx("span",{className:`order-card__status px-2.5 py-1 shrink-0 rounded-xl text-[10px] font-bold uppercase tracking-wide border shadow-lg ${S}`,children:v}),r&&(A||T||j)&&o.jsxs("div",{className:"flex items-center gap-2",children:[(A||T)&&u&&o.jsx("button",{className:"inline-flex whitespace-nowrap px-2.5 py-0.5 rounded-xl bg-emerald-500/20 border border-emerald-500/30 text-[10px] font-bold text-emerald-300 uppercase tracking-wide transition-all hover:bg-emerald-500/30 active:scale-95 shadow-lg",onClick:C=>{C.stopPropagation(),u(e)},children:"Thanh Toán"}),j&&d&&o.jsx("button",{className:"inline-flex whitespace-nowrap px-2.5 py-0.5 rounded-xl bg-blue-500/20 border border-blue-500/30 text-[10px] font-bold text-blue-300 uppercase tracking-wide transition-all hover:bg-blue-500/30 active:scale-95 shadow-lg disabled:opacity-70 disabled:cursor-not-allowed",disabled:k,onClick:C=>{C.stopPropagation(),k||d(e)},children:k?"Đang Gia Hạn...":"Gia Hạn"})]})]})]}),o.jsxs("div",{className:"order-card__info flex items-center justify-between gap-4 p-3.5 rounded-2xl bg-white/5 border border-white/5 backdrop-blur-sm group-hover:bg-white/[0.08] transition-colors",children:[o.jsxs("div",{className:"order-card__customer flex flex-col min-w-0",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Khách hàng"}),o.jsx("p",{className:"text-[13px] font-bold text-white truncate",children:h})]}),o.jsxs("div",{className:"order-card__price flex flex-col items-end shrink-0 pl-4 border-l border-white/10",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Tổng tiền"}),o.jsx("p",{className:"text-sm sm:text-base font-black text-indigo-200 tabular-nums",children:Fs(b)})]})]}),o.jsxs("div",{className:"order-card__footer flex items-center justify-between pt-1",children:[o.jsxs("div",{className:"order-card__timeline flex items-center gap-4",children:[o.jsxs("div",{className:"order-card__timeline-item flex flex-col",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Hạn đơn"}),o.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:g?yt(g):"—"})]}),t&&o.jsxs("div",{className:"order-card__timeline-item flex flex-col border-l border-white/10 pl-4",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Còn"}),o.jsxs("p",{className:`text-[11px] font-black tabular-nums transition-all ${w<=3?"text-rose-400 drop-shadow-[0_0_8px_rgba(251,113,133,0.3)]":"text-emerald-400"}`,children:[w," ngày"]})]})]}),r&&o.jsxs("div",{className:"order-card__actions flex items-center gap-2",children:[o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 hover:bg-indigo-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:()=>i(e),title:"Xem",children:o.jsx(ma,{className:"h-5 w-5"})}),c&&n&&E==="cho_hoan"&&o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 hover:bg-emerald-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(16,185,129,0.3)] active:scale-90",onClick:()=>c(e),children:o.jsx(Ui,{className:"h-5 w-5"})}),!n&&o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-500 hover:bg-amber-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(245,158,11,0.3)] active:scale-90",onClick:()=>s(e),title:"Sửa",children:o.jsx(ca,{className:"h-5 w-5"})}),o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90",onClick:()=>l(e),title:"Xóa",children:o.jsx(Kr,{className:"h-5 w-5"})})]})]})]})]})},bg=({children:e,className:t="",cardView:r,showCardOnMobile:n=!1})=>n&&r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"block md:hidden",children:r}),o.jsx("div",{className:`hidden md:block ${t}`,children:o.jsx("div",{className:"overflow-x-visible",children:o.jsx("div",{className:"inline-block min-w-full align-middle",children:e})})})]}):o.jsx("div",{className:`overflow-x-auto ${t}`,children:e}),yg=({data:e,renderCard:t,className:r=""})=>o.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 gap-4 ${r}`,children:e.map((n,a)=>o.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-3 duration-500",style:{animationDelay:`${a*50}ms`},children:t(n,a)},a))});function oV(){const[e,t]=m.useState("active"),[r,n]=m.useState({active:0,expired:0,canceled:0}),{currentOrders:a,totalPages:i,updatedStats:s,filteredOrders:l,paginationPages:c,searchTerm:u,setSearchTerm:d,searchField:f,setSearchField:h,statusFilter:p,setStatusFilter:x,currentPage:g,setCurrentPage:v,rowsPerPage:b,setRowsPerPage:w,isModalOpen:y,isViewModalOpen:N,viewModalSource:S,isEditModalOpen:E,isCreateModalOpen:_,orderToView:j,orderToDelete:A,orderToEdit:T,openCreateModal:k,closeCreateModal:C,closeViewModal:L,closeEditModal:G,closeModal:V,handleViewOrder:X,handleEditOrder:K,handleDeleteOrder:Y,handleSaveNewOrder:q,handleSaveEdit:Z,handleConfirmRefund:le,handleMarkPaid:ce,handleRenewOrder:me,confirmDelete:Ne,fetchError:ee,reloadOrders:oe,totalRecords:fe,renewingOrderCode:O}=iV(e);m.useEffect(()=>{n(ue=>ue[e]===fe?ue:{...ue,[e]:fe})},[e,fe]);const I=e==="active",[F,M]=m.useState(null),W=m.useCallback(ue=>{M(Be=>Be===ue?null:ue)},[]),J=e!=="expired",se=!0,ke=e==="canceled",ye=ke?"Giá Trị Còn Lại":"Còn Lại",Pe=J?7:6;return o.jsxs("div",{className:"space-y-4",children:[ee&&o.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-rose-500/20 bg-rose-500/10 p-4 text-sm text-rose-200 shadow-xl backdrop-blur-md sm:flex-row sm:items-center sm:justify-between animate-in fade-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-2 w-2 rounded-full bg-rose-500 animate-pulse"}),o.jsx("span",{className:"font-medium",children:ee})]}),o.jsx("button",{type:"button",onClick:oe,className:"rounded-xl border border-rose-500/30 bg-rose-500/20 px-4 py-2 text-xs font-bold uppercase tracking-wider text-rose-100 transition hover:bg-rose-500/30 active:scale-95",children:"Thử Lại"})]}),o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:o.jsxs("div",{className:"space-y-1",children:[o.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Quản Lý ",o.jsx("span",{className:"text-indigo-400",children:"Đơn Hàng"})]}),o.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Control and monitor all customer transactions"})]})}),o.jsx("div",{className:"rounded-[32px] glass-panel-dark p-4 shadow-2xl border border-white/5",children:o.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:NW.map(ue=>{const Be=ue,Ve=q5[Be],ve=e===Be,we=r[Be]??0;return o.jsxs("button",{type:"button",onClick:()=>t(Be),className:`flex items-center justify-between rounded-2xl px-6 py-4 text-left transition-all duration-300 border ${ve?"bg-gradient-to-br from-indigo-500/80 to-purple-600/80 text-white border-white/20 shadow-[0_12px_40px_-12px_rgba(99,102,241,0.5)] scale-[1.02]":"bg-white/5 text-slate-400 hover:bg-white/10 border-white/5 hover:text-slate-200"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:Ve.label}),o.jsx("p",{className:"text-xs text-indigo-100/80",children:Ve.description})]}),o.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:we.toLocaleString("vi-VN")})]},ue)})})}),o.jsx("div",{className:"rounded-[24px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map(ue=>o.jsx(Ta,{title:ue.name,value:ue.value,icon:ue.icon,accent:ue.accent},ue.name))})}),o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap gap-4 items-stretch lg:items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[280px]",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:"Tìm kiếm đơn hàng, khách hàng...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:u,onChange:ue=>d(ue.target.value)})]}),o.jsxs("div",{className:"flex flex-wrap gap-3 items-center w-full lg:w-auto lg:flex-shrink-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1","aria-hidden":!0}),o.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[140px] lg:w-[170px]",children:o.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:f,onChange:ue=>h(ue.target.value),children:_W.map(ue=>o.jsx("option",{value:ue.value,className:"bg-slate-900 text-white",children:ue.label},ue.value))})}),o.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[160px] lg:w-[220px]",children:o.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:p,onChange:ue=>x(ue.target.value),children:[o.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Tất cả trạng thái"}),o.jsx("option",{value:rt.DA_THANH_TOAN,className:"bg-slate-900 text-white",children:"Đã thanh toán"}),o.jsx("option",{value:rt.CHUA_THANH_TOAN,className:"bg-slate-900 text-white",children:"Chưa thanh toán"}),o.jsx("option",{value:rt.DANG_XU_LY,className:"bg-slate-900 text-white",children:"Đang xử lý"}),o.jsx("option",{value:rt.CAN_GIA_HAN,className:"bg-slate-900 text-white",children:"Cần gia hạn"}),o.jsx("option",{value:rt.ORDER_EXPIRED,className:"bg-slate-900 text-white",children:"Hết hạn"})]})}),I&&o.jsx(An,{icon:di,onClick:k,children:"Tạo Đơn"})]})]})}),o.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[o.jsx(bg,{showCardOnMobile:!0,cardView:a.length===0?o.jsxs("div",{className:"p-4 text-center",children:[o.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy đơn hàng"}),o.jsx("div",{className:"text-white/60",children:"Thử thay đổi bộ lọc tìm kiếm"})]}):o.jsx(yg,{data:a,renderCard:ue=>o.jsx(sV,{order:ue,showRemainingColumn:J,showActionButtons:se,isCanceled:ke,renewingOrderCode:O,onView:X,onEdit:K,onDelete:Y,onConfirmRefund:le,onMarkPaid:ce,onRenew:me}),className:"p-2"}),children:o.jsxs("table",{className:"min-w-full table-fixed border-separate border-spacing-y-4 text-white",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:pb-2 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:sm:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-center",children:[o.jsx("th",{className:"w-[14%]",children:"SẢN PHẨM"}),o.jsx("th",{className:"w-[18%]",children:"THÔNG TIN ĐƠN"}),o.jsx("th",{className:"w-[14%]",children:"KHÁCH HÀNG"}),o.jsx("th",{className:"w-[16%]",children:"THỜI HẠN"}),J&&o.jsx("th",{className:"w-[8%] whitespace-nowrap",children:ye}),o.jsx("th",{className:"w-[12%]",children:"TRẠNG THÁI"}),o.jsx("th",{className:"w-[18%] text-right pr-4",children:"THAO TÁC"})]})}),o.jsx("tbody",{className:"",children:a.length===0?o.jsx("tr",{children:o.jsxs("td",{colSpan:Pe,className:"text-center py-12",children:[o.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy đơn hàng"}),o.jsx("div",{className:"text-white/60",children:"Thử thay đổi bộ lọc tìm kiếm"})]})}):a.map((ue,Be)=>o.jsx(eT,{order:ue,index:Be,isExpanded:F===ue.id,showRemainingColumn:J,showActionButtons:se,isCanceled:ke,totalColumns:Pe,renewingOrderCode:O,onToggleDetails:W,onView:X,onEdit:K,onDelete:Y,onConfirmRefund:le,onMarkPaid:ce,onRenew:me},ue.id))})]})}),l.length>0&&o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[o.jsx("span",{children:"Hiển thị"}),o.jsxs("select",{id:"rowsPerPage",value:b,onChange:ue=>w(Number(ue.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"})]}),o.jsx("span",{children:"dòng"})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[o.jsx("button",{onClick:()=>v(1),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang đầu",children:"<<"}),o.jsx("button",{onClick:()=>v(ue=>Math.max(ue-1,1)),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trước",children:"<"}),o.jsx("div",{className:"flex items-center gap-1",children:c.map((ue,Be)=>ue==="..."?o.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${Be}`):o.jsx("button",{onClick:()=>v(ue),disabled:ue===g,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${ue===g?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:ue},ue))}),o.jsx("button",{onClick:()=>v(ue=>Math.min(ue+1,i)),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),o.jsx("button",{onClick:()=>v(i),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cuối",children:">>"})]})]})]}),o.jsx(Z5,{isOpen:y,onClose:V,onConfirm:Ne,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa đơn hàng: ${A?.id_order}?`}),o.jsx(CW,{isOpen:N,onClose:L,order:j,formatCurrency:Fs,keepOrderPrice:S==="create"}),o.jsx(AW,{isOpen:E,onClose:G,order:T,onSave:ue=>Z(ue)}),o.jsx(WW,{isOpen:_,onClose:C,onSave:ue=>{q(ue)}})]})}const lV={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},Uu=[{value:"information",label:"Thông tin gói"},{value:"note",label:"Ghi chú"},{value:"supplier",label:"Nhà cung cấp"},{value:"import",label:"Giá nhập (VND)"},{value:"expired",label:"Ngày hết hạn"},{value:"capacity",label:"Tổng dung lượng (GB)"}],zp=e=>e.filter(t=>t!=="capacity"),Zi=5,Ji=2e3,Wp=100,cV=.2,uV=2,dV=[{value:"information",label:"Liên kết theo thông tin đơn hàng",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên các trường thông tin như tên sản phẩm, thông tin sản phẩm."},{value:"slot",label:"Liên kết theo vị trí",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên mã định danh vị trí (slot) của đơn hàng."}],x2=[{value:"all",label:"Tất cả trạng thái"},{value:"full",label:"Còn nhiều"},{value:"low",label:"Sắp hết"},{value:"out",label:"Đã hết"}],fV=It.informationOrder,tT=It.slot,rT="package_slot_link_prefs",wg=(e,t)=>t<=0||e<=0?"out":e/t<=cV?"low":"ok",Ls=e=>e<=0?"out":e<uV?"low":"ok",Kl=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),g2=e=>{const t=Kl(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},ui=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),Ng=e=>{const t=yt(e??"");if(t)return t;const r=(e||"").trim();if(!r)return"";const n=r.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(n){const[,a,i,s]=n;return`${String(a).padStart(2,"0")}/${String(i).padStart(2,"0")}/${s}`}return r},v2=e=>{const t=ui(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},Vp=e=>{const t=ui(e);return t?t.toLowerCase().replace(/\s+/g,""):""},nT=e=>{const t=Vp(e.informationUser||"");return t?[t]:[]},hV=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",pV=(e,t,r)=>{const n=ui(r);if(t!=="slot")return n?[n]:[];const i=(e.slotDisplay??"").split("|").map(l=>ui(l)).filter(Boolean);if(i.length>=1)return i;const s=ui(e.customerDisplay);return s?[s,`${s} (2)`]:n?[n]:[]},b2=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},mV=(e,t)=>{let n=t.productKey;if(e){const s=n.indexOf(e);s>=0&&(n=n.slice(s+e.length))}const a=b2(n);if(a)return a;const i=Kl(t.base?.id_product??"");return b2(i)},xV=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):Wp} GB`,gV=e=>e===tT?"slot":"information",yc=e=>e==="slot"?tT:fV,aT=e=>Kl(e),ta=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},ch=e=>e==null?"":typeof e=="string"?e:String(e),y2=(e,t,r)=>[e&&`Tài khoản: ${e}`,t&&`Mật khẩu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",vV=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):ch(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):ch(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:ch(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}},bV=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(rT);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},yV=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(rT,JSON.stringify(e))}catch{}},w2=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,a=e.match??e.matchModeValue??null,i=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,s=a?gV(a):e.slotLinkMode??(i==="slot"?"slot":"information"),l=Array.isArray(e.productCodes)?e.productCodes.map(u=>typeof u=="string"?u.trim():"").filter(u=>!!u):[],c=Array.from(new Set(l.map(u=>aT(u)).filter(Boolean)));return{...e,slot:e.slot??Zi,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:s,matchModeValue:a,productCodes:l,normalizedProductCodes:c}},wV=({row:e,showCapacityColumn:t,tableColumnCount:r,isExpanded:n,onToggle:a,onEdit:i,onView:s,onDelete:l})=>{const c=e.slotLimit||Zi,u=e.slotUsed,d=e.remainingSlots,f=c>0?Math.min(d/c*100,100):0,h=Ls(d),p=h==="out"?"bg-red-500":h==="low"?"bg-yellow-500":"bg-green-500",x=e.capacityLimit||Ji,g=e.capacityUsed,v=e.remainingCapacity,b=x>0?Math.min(v/x*100,100):0,w=wg(v,x),y=w==="out"?"bg-red-500":w==="low"?"bg-yellow-500":"bg-green-500",N=Math.min(u,c),S=e.slotAssignments??[],E=Array.from({length:Math.max(c,0)},(j,A)=>{const T=A+1,k=T<=N,C=S[T-1]??null;return{slotNumber:T,isUsed:k,assignment:C}}),_=t&&!!e.hasCapacityField;return o.jsxs(o.Fragment,{children:[o.jsxs("tr",{onClick:()=>a(e.id),className:`package-row ${n?"package-row--expanded":""} hover:bg-indigo-500/20 ${n?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] font-medium text-white",children:o.jsx("div",{className:"whitespace-normal break-words line-clamp-2",title:e.package||"",children:e.package})}),o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:o.jsx("div",{className:"whitespace-normal break-all line-clamp-1",title:e.informationUser||"",children:e.informationUser||""})}),o.jsxs("td",{className:"package-row__cell px-1 py-4 lg:px-2",children:[o.jsxs("div",{className:"package-row__slot-summary text-sm font-bold text-white flex items-center gap-2",children:[o.jsx("span",{className:"text-indigo-400",children:u}),o.jsx("span",{className:"text-white/20",children:"/"}),o.jsxs("span",{children:[c," Vị trí"]})]}),o.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 mt-2 overflow-hidden border border-white/5",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${p} shadow-[0_0_8px_rgba(34,197,94,0.4)]`,style:{width:`${f}%`}})}),o.jsxs("div",{className:"text-[11px] font-bold uppercase tracking-wider text-white/50 mt-2",children:["Trống: ",d]})]}),t&&o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2",children:_?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm font-bold text-white flex items-center gap-2",children:[o.jsx("span",{className:"text-purple-400",children:g}),o.jsx("span",{className:"text-white/20",children:"/"}),o.jsxs("span",{children:[x," GB"]})]}),o.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 mt-2 overflow-hidden border border-white/5",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${y} shadow-[0_0_8px_rgba(168,85,247,0.4)]`,style:{width:`${b}%`}})}),o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wider text-white/30 mt-2",children:["Trống: ",v," GB"]})]}):o.jsx("div",{className:"text-xs text-white/30 font-bold uppercase tracking-widest italic",children:"N/A"})}),o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:o.jsx("div",{className:"truncate",title:e.supplier||"",children:e.supplier||""})}),o.jsxs("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white whitespace-nowrap",children:[Number(e.import||0).toLocaleString("vi-VN")," ",o.jsx("span",{className:"text-[10px] text-white/50",children:"VND"})]}),o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] whitespace-nowrap",children:o.jsx("span",{className:"font-mono font-semibold text-white/95 tracking-tight",children:Ng(e.expired)||"---"})}),o.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:o.jsx("div",{className:"whitespace-normal break-words line-clamp-1",title:e.note||"",children:e.note||""})}),o.jsx("td",{className:"package-row__actions px-1 py-4 lg:px-2 whitespace-nowrap text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-center gap-1 flex-wrap md:flex-nowrap",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",type:"button","aria-label":"Sửa",onClick:j=>{j.stopPropagation(),i(e)},children:o.jsx(ca,{className:"h-3.5 w-3.5"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-purple-400 border border-white/10 hover:bg-purple-500/10 hover:border-purple-500/30 transition-all active:scale-90",type:"button","aria-label":"Xem",onClick:j=>{j.stopPropagation(),s(e)},children:o.jsx(ma,{className:"h-3.5 w-3.5"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",type:"button","aria-label":"Xóa",onClick:j=>{j.stopPropagation(),l(e)},children:o.jsx(Kr,{className:"h-3.5 w-3.5"})})]})})]}),n&&o.jsx("tr",{className:"package-row__expandable-row",children:o.jsx("td",{colSpan:r,className:"package-row__expandable-cell bg-indigo-900/30 px-6 py-4 text-white",children:o.jsxs("div",{className:"package-row__expandable-content glass-panel-dark border border-white/5 bg-slate-900/40 rounded-3xl p-6 space-y-6",children:[o.jsxs("div",{className:"package-row__expandable-header flex items-center justify-between border-b border-white/5 pb-4",children:[o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/70",children:"Chi Tiết Các Vị Trí"}),o.jsx("p",{className:"text-xl font-bold text-white tracking-tight mt-1",children:"Slot Distribution Maps"})]}),o.jsxs("div",{className:"px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-[11px] font-bold uppercase tracking-widest text-white/70",children:[u," Dùng / ",d," Trống"]})]}),o.jsx("div",{className:"package-row__slot-grid grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3",children:E.map(j=>o.jsxs("div",{className:`package-row__slot-cell ${j.isUsed?"package-row__slot-cell--used":"package-row__slot-cell--available"} flex flex-col items-center justify-center rounded-2xl border p-4 transition-all duration-300 hover:scale-[1.05] ${j.isUsed?"border-amber-500/20 bg-amber-500/5 text-amber-200":"border-emerald-500/20 bg-emerald-500/5 text-emerald-200"}`,children:[o.jsxs("div",{className:"flex flex-col items-center gap-2",children:[o.jsx("div",{className:`p-2 rounded-xl backdrop-blur-md ${j.isUsed?"bg-amber-500/10":"bg-emerald-500/10"}`,children:o.jsx(wC,{className:"h-5 w-5"})}),o.jsx("span",{className:"text-xs font-bold tracking-tight text-white/90",children:j.assignment?.slotLabel||`Slot ${j.slotNumber}`})]}),o.jsx("p",{className:`text-[11px] font-bold uppercase tracking-widest mt-2 ${j.isUsed?"text-amber-500/80":"text-emerald-500/80"}`,children:j.assignment&&_?xV(j.assignment.capacityUnits):j.isUsed?"ASSIGNED":"AVAILABLE"})]},j.slotNumber))})]})})})]})},NV=({row:e,showCapacityColumn:t,onEdit:r,onView:n,onDelete:a})=>{const i=e.slotLimit||Zi,s=e.slotUsed,l=e.remainingSlots,c=i>0?Math.min(l/i*100,100):0,u=Ls(l),d=u==="out"?"bg-red-500":u==="low"?"bg-yellow-500":"bg-green-500",f=u==="out"?"bg-red-500":u==="low"?"bg-amber-500":"bg-emerald-500",h=t&&!!e.hasCapacityField,p=e.capacityLimit||Ji,x=e.capacityUsed,g=e.remainingCapacity,v=p>0?Math.min(g/p*100,100):0,b=wg(g,p),w=b==="out"?"bg-red-500":b==="low"?"bg-yellow-500":"bg-green-500";return o.jsxs("div",{className:"package-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[o.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${f}`}),o.jsxs("div",{className:"relative z-10 flex flex-col gap-3",children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),o.jsx("h3",{className:"text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:e.package||"--"})]}),o.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.informationUser&&o.jsx("div",{className:"inline-flex px-2.5 py-1 rounded-lg bg-indigo-500/10 border border-indigo-500/20 backdrop-blur-md min-w-0",children:o.jsx("p",{className:"text-[10px] sm:text-[11px] font-bold text-indigo-300 uppercase tracking-wide truncate max-w-[200px]",children:e.informationUser})}),e.supplier&&o.jsx("div",{className:"inline-flex px-2.5 py-1 rounded-lg bg-purple-500/10 border border-purple-500/20 backdrop-blur-md min-w-0",children:o.jsxs("p",{className:"text-[10px] sm:text-[11px] font-bold text-purple-300 uppercase tracking-wide truncate max-w-[120px]",children:["NCC: ",e.supplier]})})]})]}),o.jsxs("div",{className:"flex items-stretch gap-3",children:[o.jsxs("div",{className:"flex-1 p-3 rounded-2xl bg-white/5 border border-white/5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Vị trí"}),o.jsxs("span",{className:"text-xs font-bold text-white",children:[o.jsx("span",{className:"text-indigo-400",children:s}),o.jsx("span",{className:"text-white/20 mx-0.5",children:"/"}),i]})]}),o.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 overflow-hidden border border-white/5",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${d} shadow-[0_0_8px_rgba(34,197,94,0.4)]`,style:{width:`${c}%`}})}),o.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-wider text-white/40 mt-1.5",children:["Trống: ",l]})]}),h&&o.jsxs("div",{className:"flex-1 p-3 rounded-2xl bg-white/5 border border-white/5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Dung lượng"}),o.jsxs("span",{className:"text-xs font-bold text-white",children:[o.jsx("span",{className:"text-purple-400",children:x}),o.jsx("span",{className:"text-white/20 mx-0.5",children:"/"}),p," GB"]})]}),o.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 overflow-hidden border border-white/5",children:o.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${w} shadow-[0_0_8px_rgba(168,85,247,0.4)]`,style:{width:`${v}%`}})}),o.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-wider text-white/30 mt-1.5",children:["Trống: ",g," GB"]})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-2xl bg-white/5 border border-white/5 backdrop-blur-sm",children:[o.jsxs("div",{className:"flex flex-col min-w-0",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Giá nhập"}),o.jsxs("p",{className:"text-sm font-black text-indigo-200 tabular-nums",children:[Number(e.import||0).toLocaleString("vi-VN")," ",o.jsx("span",{className:"text-[10px] text-white/40",children:"VND"})]})]}),o.jsxs("div",{className:"flex flex-col items-end shrink-0 pl-4 border-l border-white/10",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Hết hạn"}),o.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums font-mono",children:Ng(e.expired)||"---"})]})]}),e.note&&o.jsx("div",{className:"px-3 py-2 rounded-xl bg-white/[0.03] border border-white/5",children:o.jsxs("p",{className:"text-[11px] text-white/50 truncate",title:e.note,children:["📝 ",e.note]})}),o.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:()=>r(e),title:"Sửa",children:o.jsx(ca,{className:"h-5 w-5"})}),o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-purple-500/10 border border-purple-500/20 text-purple-400 hover:bg-purple-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(168,85,247,0.3)] active:scale-90",onClick:()=>n(e),title:"Xem",children:o.jsx(ma,{className:"h-5 w-5"})}),o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90",onClick:()=>a(e),title:"Xóa",children:o.jsx(Kr,{className:"h-5 w-5"})})]})]})]})},_V=({rows:e,loading:t,showCapacityColumn:r,tableColumnCount:n,onEdit:a,onView:i,onDelete:s})=>{const[l,c]=m.useState(null),u=d=>{c(f=>f===d?null:d)};return o.jsxs("div",{className:"package-table glass-panel-dark rounded-[32px] shadow-2xl overflow-hidden text-white border border-white/5",children:[o.jsx("div",{className:"md:hidden",children:t?o.jsx("div",{className:"px-6 py-8 text-center text-white/80 text-sm",children:"Đang Tải Dữ Liệu..."}):e.length===0?o.jsx("div",{className:"px-6 py-8 text-center text-white/80 text-sm",children:"Không có gói nào để hiển thị."}):o.jsx("div",{className:"p-3 space-y-3",children:e.map((d,f)=>o.jsx(NV,{row:d,showCapacityColumn:r,onEdit:a,onView:i,onDelete:s},`card-${d.id}-${f}`))})}),o.jsx("div",{className:"package-table__inner overflow-x-auto hidden md:block",children:o.jsx("div",{className:"inline-block min-w-full align-middle",children:o.jsxs("table",{className:"package-table__table w-full table-fixed divide-y divide-white/5",children:[o.jsxs("colgroup",{children:[o.jsx("col",{className:r?"w-[12%]":"w-[14%]"}),o.jsx("col",{className:r?"w-[17%]":"w-[20%]"}),o.jsx("col",{className:"w-[10%]"}),r&&o.jsx("col",{className:"w-[8%]"}),o.jsx("col",{className:r?"w-[8%]":"w-[9%]"}),o.jsx("col",{className:r?"w-[10%]":"w-[11%]"}),o.jsx("col",{className:"w-[10%]"}),o.jsx("col",{className:r?"w-[15%]":"w-[17%]"}),o.jsx("col",{className:"w-[10%]"})]}),o.jsx("thead",{className:"package-table__head bg-white/5",children:o.jsxs("tr",{children:[o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Tên Gói"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Thông Tin Gói"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Số Lượng"}),r&&o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Dung Lượng"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"NCC"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Giá Nhập"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Ngày Hết Hạn"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Ghi Chú"}),o.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-center text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Thao Tác"})]})}),o.jsx("tbody",{className:"package-table__body divide-y divide-white/5",children:t?o.jsx("tr",{className:"package-table__loading-row",children:o.jsx("td",{colSpan:n,className:"package-table__loading-cell px-6 py-8 text-center text-white/80 text-sm",children:"Đang Tải Dữ Liệu..."})}):e.length===0?o.jsx("tr",{className:"package-table__empty-row",children:o.jsx("td",{colSpan:n,className:"package-table__empty-cell px-6 py-8 text-center text-white/80 text-sm",children:"Không có gói nào để hiển thị."})}):e.map((d,f)=>o.jsx(wV,{row:d,showCapacityColumn:r,tableColumnCount:n,isExpanded:l===d.id,onToggle:u,onEdit:a,onView:i,onDelete:s},`${d.id}-${f}`))})]})})})]})},_g=({open:e,title:t,onClose:r,children:n,footer:a})=>e?o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/40 px-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),o.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"Ž?A3ng",children:o.jsx(Pt,{className:"h-5 w-5"})})]}),o.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),o.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:a})]})}):null,SV=({open:e,initialProductId:t,initialName:r,initialFields:n,onClose:a,onSubmit:i,mode:s})=>{const[l,c]=m.useState(t),[u,d]=m.useState(r),[f,h]=m.useState(new Set(n)),[p,x]=m.useState(null),[g,v]=m.useState([]),[b,w]=m.useState(!1);m.useEffect(()=>{e&&(c(t),d(r),h(new Set(n)),x(null))},[e,n,r,t]),m.useEffect(()=>{if(!e)return;let _=!1;return w(!0),Ue("/api/products/packages").then(j=>j.json()).then(j=>{_||!Array.isArray(j)||v(j)}).catch(()=>{_||v([])}).finally(()=>{_||w(!1)}),()=>{_=!0}},[e]);const y=_=>{h(j=>{const A=new Set(j);return A.has(_)?A.delete(_):A.add(_),A})},N=()=>h(new Set(Uu.map(_=>_.value))),S=()=>h(new Set),E=_=>{_.preventDefault();const j=l!=null?Number(l):null,A=u?.trim()??"";if(j==null||!Number.isFinite(j)||j<1){x("Vui lòng chọn loại gói (sản phẩm).");return}if(f.size===0){x("Vui lòng chọn ít nhất một trường dữ liệu.");return}i(j,A||String(j),Array.from(f))};return o.jsx(_g,{open:e,title:s==="edit"&&(r||t!=null)?`Chỉnh sửa loại gói: ${r||t}`:"Tạo loại gói sản phẩm mới",onClose:a,footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy bỏ"}),o.jsx("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:s==="create"?"Tạo Loại":"Lưu Thay Đổi"})]}),children:o.jsxs("form",{onSubmit:E,className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tên Loại Gói (chọn từ Sản phẩm)"}),b?o.jsx("p",{className:"text-sm text-white/70 py-2",children:"Đang tải danh sách..."}):o.jsxs("select",{value:l??"",onChange:_=>{const j=_.target.value,A=j===""?null:Number(j),T=g.find(k=>k.id===A);c(A!=null&&Number.isFinite(A)?A:null),d(T?.package_name??"")},className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${s==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:s==="edit",children:[o.jsx("option",{value:"",children:s==="create"?"-- Chọn loại gói (sản phẩm) --":(r||t)??"--"}),s==="edit"&&t!=null&&!g.some(_=>_.id===t)&&o.jsx("option",{value:t,children:r||t}),g.map(_=>o.jsx("option",{value:_.id,children:_.package_name},_.id))]}),s==="edit"&&o.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bạn chỉ có thể chỉnh sửa các trường dữ liệu, tên loại gói giữ nguyên."})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Các trường dữ liệu của loại gói này"}),o.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[o.jsx("button",{type:"button",onClick:N,className:"text-blue-600 hover:text-blue-700",children:"Chọn tất cả"}),o.jsx("button",{type:"button",onClick:S,className:"text-rose-600 hover:text-rose-700",children:"Bỏ chọn tất cả"})]})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Uu.map(_=>o.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${f.has(_.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:f.has(_.value),onChange:()=>y(_.value)}),o.jsx("span",{className:"text-sm font-medium text-gray-800",children:_.label})]},_.value))})]}),p&&o.jsx("p",{className:"text-sm text-red-600",children:p})]})})},N2=({open:e,mode:t,template:r,initialValues:n,onClose:a,onSubmit:i})=>{const s=m.useMemo(()=>({...lV,...n??{}}),[n]),[l,c]=m.useState(s),u=m.useCallback(y=>{const N=y.replace(/[^0-9]/g,"");if(!N)return"";const S=Number(N);return Number.isFinite(S)?S.toLocaleString("vi-VN"):""},[]);m.useEffect(()=>{e&&c({...s,import:u(s.import)})},[e,s,u]);const d=(y,N)=>{const S=N.target.value;if(y==="import"){c(E=>({...E,import:u(S)}));return}c(E=>({...E,[y]:S}))},f=(l.slotLinkMode==="slot"||l.slotLinkMode==="information")&&!(l.informationUser??"").trim()?"Khi chọn Match theo Slot hoặc Information, Thông tin gói (Tài khoản) là bắt buộc.":null,h=y=>{y.preventDefault(),!f&&i(l)},p=y=>{c(N=>({...N,slotLinkMode:y}))},g=["information","note","supplier","import","expired"].some(y=>r.fields.includes(y)),v=r.fields.includes("capacity"),b=g||v,w=g&&v;return o.jsx(_g,{open:e,title:`${t==="add"?"Thêm Gói":"Sửa Gói"} - ${r.name}`,onClose:a,footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy"}),o.jsx("button",{type:"submit",onClick:h,disabled:!!f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:t==="add"?"Lưu gói":"Lưu thay đổi"})]}),children:o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[b&&o.jsxs("div",{className:`grid grid-cols-1 gap-4 ${w?"md:grid-cols-2":""}`,children:[g&&o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tiết gói"}),o.jsx("p",{className:"text-xs text-white/80",children:"Nhập các trường mô tả liên quan đến gói này."})]}),r.fields.includes("information")&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),o.jsx("input",{type:"text",value:l.informationUser,onChange:y=>d("informationUser",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),o.jsx("input",{type:"text",value:l.informationPass,onChange:y=>d("informationPass",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),o.jsx("input",{type:"email",value:l.informationMail,onChange:y=>d("informationMail",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),o.jsx("input",{type:"text",value:l.note,onChange:y=>d("note",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi chú cho gói này"})]}),r.fields.includes("supplier")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhà cung cấp"}),o.jsx("input",{type:"text",value:l.supplier,onChange:y=>d("supplier",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Giá nhập (VND)"}),o.jsx("input",{type:"text",inputMode:"numeric",value:l.import,onChange:y=>d("import",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngày hết hạn"}),o.jsx("input",{type:"date",value:l.expired,onChange:y=>d("expired",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),v&&o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),o.jsx("p",{className:"text-xs text-white/80",children:"Cung cấp thông tin tài khoản dung lượng."})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),o.jsx("input",{type:"text",value:l.accountUser,onChange:y=>d("accountUser",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),o.jsx("input",{type:"text",value:l.accountPass,onChange:y=>d("accountPass",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),o.jsx("input",{type:"email",value:l.accountMail,onChange:y=>d("accountMail",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),o.jsx("textarea",{value:l.accountNote,onChange:y=>d("accountNote",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi chú cho tài khoản dung lượng"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lượng (GB)"}),o.jsx("input",{type:"number",min:0,value:l.capacity,onChange:y=>d("capacity",y),placeholder:`Mặc định: ${Ji}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số vị trí (slot)"}),o.jsx("input",{type:"number",min:0,value:l.slot,onChange:y=>d("slot",y),placeholder:`Mặc định: ${Zi}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Chọn chế độ ghép lệnh"}),o.jsx("p",{className:"text-xs text-white/80",children:"Chọn phương thức kết nối giữa gói và đơn hàng."})]})}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:dV.map(y=>{const N=l.slotLinkMode===y.value;return o.jsxs("button",{type:"button",onClick:()=>p(y.value),className:`border rounded-lg p-3 text-left transition ${N?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[o.jsx("span",{className:"block text-sm font-semibold",children:y.label}),o.jsx("span",{className:"block text-xs text-white/70 mt-1",children:y.helper})]},y.value)})}),o.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[o.jsx("b",{children:"Link theo thông tin đơn hàng:"})," So khớp thông tin gói (tài khoản, mail, v.v.) với chi tiết trong đơn hàng.",o.jsx("br",{}),o.jsx("b",{children:"Link theo vị trí:"})," So khớp thông tin gói với mã vị trí (slot) khai báo trong đơn hàng.",o.jsx("br",{})]}),f&&o.jsx("p",{className:"text-sm text-amber-400 mt-2",role:"alert",children:f})]}),r.fields.length===0&&o.jsx("p",{className:"text-sm text-white/80",children:"Loại gói này không có trường dữ liệu nào được cấu hình."})]})})},EV=({open:e,row:t,onClose:r})=>{if(!e||!t)return null;const n=[{label:"Tài khoản",value:t.informationUser},{label:"Mật khẩu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi chú",value:t.note},{label:"Nguồn",value:t.supplier},{label:"Giá nhập",value:t.import},{label:"Ngày hết hạn",value:Ng(t.expired)}],a=[{label:"Tài khoản",value:t.accountUser},{label:"Mật khẩu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi chú",value:t.accountNote}],i=!!t.hasCapacityField,s=t.capacityLimit||Ji,l=t.capacityUsed||0,c=t.remainingCapacity||0,u=s>0?Math.min(c/s*100,100):0,d=wg(c,s),f=d==="out"?"bg-red-500":d==="low"?"bg-yellow-500":"bg-green-500";return o.jsx(_g,{open:e,title:`Chi Tiết Gói: ${t.package}`,onClose:r,footer:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"Đóng"}),children:o.jsxs("div",{className:`grid grid-cols-1 gap-4 ${i?"md:grid-cols-2":""}`,children:[o.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thông tin gói"}),o.jsx("p",{className:"text-xs text-white/80",children:"Các trường dữ liệu được lưu cho gói này."})]}),o.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(h=>o.jsxs("div",{children:[o.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:h.label}),o.jsx("dd",{className:"text-sm font-medium text-white break-words",children:h.value!==null&&h.value!==void 0&&h.value!==""?h.value:"-"})]},h.label))})]}),i&&o.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),o.jsx("p",{className:"text-xs text-white/80",children:"Tổng quan về tài khoản dung lượng."})]}),o.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:a.map(h=>o.jsxs("div",{children:[o.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:h.label}),o.jsx("dd",{className:"text-sm font-medium text-white break-words",children:h.value!==null&&h.value!==void 0&&h.value!==""?h.value:"-"})]},h.label))}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"text-sm text-white",children:[o.jsx("span",{className:"font-semibold",children:l})," /"," ",s," GB"]}),o.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full ${f}`,style:{width:`${u}%`}})}),o.jsxs("div",{className:"text-xs text-white/80",children:["Còn trống: ",c," GB"]})]})]})]})})},iT=(e,t)=>{const r=e.base;return r?.id!==void 0&&r?.id!==null?`id:${r.id}`:r?.id_order!==void 0&&r?.id_order!==null?`code:${r.id_order}`:`${e.productKey||e.infoKey}-${t}`};function jV(e,t){if(e.size===0)return[];const r=new Map;return e.forEach(n=>{const a=t.get(n);a?.length&&a.forEach(i=>{const s=iT(i,r.size);r.has(s)||r.set(s,i)})}),Array.from(r.values())}function sT(e){return e==="information"?"information":"slot"}function TV(e){return e==="information"?"slot":"information"}function CV(e,t){const r=Kl(t.package??""),n=t.normalizedProductCodes??[],a=n.length>0?new Set(n):null;return a?.size&&e.productCodeNormalized&&a.has(e.productCodeNormalized)?!0:!r||!e.productCodeNormalized?!1:e.productCodeNormalized===r}function kV(e,t){const r=nT(t);if(r.length===0)return!0;const n=t.slotLinkMode??"information",i=sT(n)==="slot"?e.slotMatchKey:e.informationMatchKey;return i?r.some(s=>s===i||s.includes(i)||i.includes(s)):!1}function AV(e){const{item:t,orderMatchers:r,ordersByProductCode:n,ordersReady:a}=e,i=!!t.hasCapacityField,s=ta(t.slot),l=s&&s>0?Math.floor(s):Zi,c=ta(t.slotUsed),u=Kl(t.package??""),d=t.slotLinkMode??"information",f=TV(d),h=sT(d);nT(t);const p=t.normalizedProductCodes??[],x=p.length>0?new Set(p):null,g=a&&r.length>0&&(x!=null&&x.size>0||u.length>0),v=L=>CV(L,{...t,normalizedProductCodes:p}),b=L=>kV(L,{...t,slotLinkMode:d}),w=g&&x?.size?jV(x,n):null,y=g?(()=>{const L=new Map,G=V=>{const X=iT(V,L.size);L.has(X)||L.set(X,V)};return w?.forEach(G),r.forEach(V=>{v(V)&&G(V)}),Array.from(L.values()).filter(b)})():[],N=new Set,S=[];g&&y.forEach(L=>{const G=hV(L,f),X=(h==="slot"?L.slotDisplay:L.informationDisplay)||L.customerDisplay||"",K=L.base?.id!==void 0&&L.base?.id!==null?`id:${L.base.id}`:L.base?.id_order!==void 0&&L.base?.id_order!==null?`code:${L.base.id_order}`:`${X}-${S.length}`;if(N.has(K))return;N.add(K);const Y=G||X,q=pV(L,f,Y);if(q.length===0)return;const Z=i?mV(u,L):null;q.forEach(le=>{const ce=le||Y||"";ce&&S.push({slotLabel:ce,matchValue:X||ce,sourceOrderId:L.base?.id??null,sourceOrderCode:L.base?.id_order??null,displayColumn:f,matchColumn:h,capacityUnits:Z})})});const E=S.length>0?S.length:c!==null?Math.max(Math.floor(c),0):0,_=Math.min(E,l),j=Math.max(l-_,0);let A=0,T=0,k=0;if(i){const L=ta(t.capacity);A=L&&L>0?Math.floor(L):Ji;const G=ta(t.capacityUsed),V=S.length>0?S.reduce((K,Y)=>K+(Y.capacityUnits??Wp),0):E*Wp,X=Math.min(V,A);T=Math.min(Math.max(G!==null?Math.floor(G):X,0),A),k=Math.max(A-T,0)}const C=g?y.map(L=>L.base):[];return{slotUsed:_,slotLimit:l,remainingSlots:j,capacityLimit:A,capacityUsed:T,remainingCapacity:k,slotAssignments:S,matchedOrders:C,packageCode:u,hasCapacityField:i,productCodes:t.productCodes??[],normalizedProductCodes:p,matchModeValue:t.matchModeValue??t.match??null}}const PV=()=>{const[e,t]=m.useState(""),[r,n]=m.useState("all"),[a,i]=m.useState("all"),[s,l]=m.useState([]),[c,u]=m.useState([]),[d,f]=m.useState([]),[h,p]=m.useState(!0),[x,g]=m.useState(!0),[v,b]=m.useState(!1),[w,y]=m.useState(()=>bV()),N=m.useRef(w),S=m.useRef(!0),E=m.useMemo(()=>Uu.map(ee=>ee.value),[]);m.useEffect(()=>{N.current=w},[w]),m.useEffect(()=>()=>{S.current=!1},[]);const _=m.useCallback((ee,oe)=>{const fe=String(ee);y(O=>{if(O[fe]===oe)return O;const I={...O,[fe]:oe};return yV(I),I})},[]);m.useEffect(()=>{let ee=!1;return(async()=>{try{p(!0);const oe=await Ue("/api/package-products");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const fe=await oe.json();if(!ee)if(Array.isArray(fe)){const O=fe.map(I=>w2(I,N.current));l(O)}else l([])}catch(oe){if(console.error("Tải sản phẩm gói thất bại:",oe),!ee){const{handleNetworkError:fe}=await Vc(async()=>{const{handleNetworkError:O}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:O}},[]);console.error(fe(oe)),l([])}}finally{ee||p(!1)}})(),()=>{ee=!0}},[]),m.useEffect(()=>{let ee=!1;return(async()=>{try{g(!0),b(!1);const oe=await Ue("/api/orders");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const fe=await oe.json();ee||(Array.isArray(fe)?u(fe):u([]),b(!0))}catch(oe){console.error("Tải danh sách đơn hàng thất bại:",oe),ee||(u([]),b(!1))}finally{ee||g(!1)}})(),()=>{ee=!0}},[]);const j=m.useCallback(async()=>{if(S.current){g(!0),b(!1);try{const ee=await Ue("/api/orders");if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const oe=await ee.json();if(!S.current)return;Array.isArray(oe)?u(oe):u([]),b(!0)}catch(ee){console.error("Failed to refresh orders for packages:",ee),S.current&&(u([]),b(!1))}finally{S.current&&g(!1)}}},[]);m.useEffect(()=>nV(["orders"],()=>{j()}),[j]);const A=m.useMemo(()=>Array.from(new Set(s.map(ee=>ee.package))).sort(),[s]);m.useEffect(()=>{f(ee=>{const oe=new Map(ee.map(O=>[O.name,O]));let fe=!1;return A.forEach(O=>{if(!O)return;const F=s.find(J=>J.package===O)?.productId??null,M=s.some(J=>J.package===O&&J.hasCapacityField),W=oe.get(O);if(!W){const J=M?E:zp(E);oe.set(O,{name:O,productId:F,fields:J,isCustom:!1}),fe=!0;return}if(W.isCustom!==!0&&!M&&W.fields.includes("capacity")){const J=zp(W.fields);oe.set(O,{...W,productId:W.productId??F,fields:J}),fe=!0}}),fe?Array.from(oe.values()).sort((O,I)=>O.name.localeCompare(I.name)):ee})},[A,s,E]);const T=m.useMemo(()=>c.map(ee=>{const oe=ee.id_product??ee.idProduct??"",fe=ee.information_order??ee.informationOrder??"",O=ee.slot,I=g2(oe),F=g2(fe);return{base:ee,productKey:I.normalized,productLettersKey:I.lettersOnly,infoKey:F.normalized,infoLettersKey:F.lettersOnly,slotDisplay:ui(O),slotKey:v2(O),slotMatchKey:Vp(O),informationDisplay:ui(fe),informationKey:v2(fe),informationMatchKey:Vp(fe),customerDisplay:ui(ee.customer),productCodeNormalized:aT(oe)}}),[c]),k=m.useMemo(()=>{const ee=new Map;return T.forEach(oe=>{if(!oe.productCodeNormalized)return;const fe=oe.productCodeNormalized;ee.has(fe)||ee.set(fe,[]),ee.get(fe).push(oe)}),ee},[T]),C=m.useMemo(()=>s.map(ee=>({...ee,...AV({item:ee,orderMatchers:T,ordersByProductCode:k,ordersReady:v})})),[s,T,v,k]),L=r!=="all"?r:null,G=m.useMemo(()=>L?d.find(ee=>ee.name===L)??null:null,[d,L]),V=m.useMemo(()=>L?C.filter(ee=>ee.package===L):C,[C,L]),X=m.useMemo(()=>V.filter(ee=>{const oe=e.trim().toLowerCase(),fe=[ee.information,ee.informationUser,ee.informationMail,ee.informationPass,ee.accountUser,ee.accountMail,ee.accountPass,ee.note],O=oe.length===0||fe.some(W=>(W==null?"":String(W)).toLowerCase().includes(oe)),I=r==="all"||ee.package===r,F=Ls(ee.remainingSlots);return O&&I&&(a==="all"||a==="full"&&F==="ok"||a===F)}),[V,e,r,a]),K=m.useMemo(()=>[...X].sort((ee,oe)=>{const fe=Number(ee.remainingSlots),O=Number(oe.remainingSlots),I=Number.isFinite(fe)?fe:Number.POSITIVE_INFINITY,F=Number.isFinite(O)?O:Number.POSITIVE_INFINITY,M=I<=0?Number.POSITIVE_INFINITY:I,W=F<=0?Number.POSITIVE_INFINITY:F;return M===W?0:M-W}),[X]),q=X.some(ee=>ee.hasCapacityField??!1)||X.length===0&&(G?.fields.includes("capacity")??!1),Z=q?9:8,le=m.useMemo(()=>{const ee=V.reduce((fe,O)=>Ls(O.remainingSlots)==="low"?fe+1:fe,0),oe=V.reduce((fe,O)=>Ls(O.remainingSlots)==="out"?fe+1:fe,0);return{total:V.length,low:ee,out:oe}},[V]),ce=m.useMemo(()=>{const ee=new Set;return C.forEach(oe=>{const fe=(oe.package||"").trim();fe&&ee.add(fe)}),d.forEach(oe=>{oe.name&&ee.add(oe.name)}),Array.from(ee).sort((oe,fe)=>oe.localeCompare(fe))},[C,d]),me=m.useMemo(()=>{const ee=new Map;return ce.forEach(oe=>ee.set(oe,{total:0,low:0,out:0})),C.forEach(oe=>{const fe=(oe.package||"").trim();if(!fe)return;const O=ee.get(fe);if(!O)return;O.total+=1;const I=Ls(oe.remainingSlots);I==="low"&&(O.low+=1),I==="out"&&(O.out+=1)}),ce.map(oe=>({name:oe,...ee.get(oe)??{total:0,low:0,out:0}}))},[ce,C]),Ne=m.useCallback(ee=>w2(ee,N.current),[]);return{data:{rows:s,templates:d,computedRows:C,filteredRows:X,sortedRows:K,scopedRows:V,selectedPackage:L,selectedTemplate:G,packageSummaries:me,slotStats:le,showCapacityColumn:q,tableColumnCount:Z,loading:h||x,packagesLoading:h,ordersLoading:x,ordersReady:v,defaultTemplateFields:E},filters:{searchTerm:e,categoryFilter:r,statusFilter:a},actions:{setSearchTerm:t,setCategoryFilter:n,setStatusFilter:i,setRows:l,setTemplates:f,persistSlotLinkPreference:_,applySlotLinkPrefs:Ne}}},_2=[{border:"border-sky-500/30",glow:"bg-sky-500/20",link:"text-sky-400 hover:text-sky-300"},{border:"border-emerald-500/30",glow:"bg-emerald-500/20",link:"text-emerald-400 hover:text-emerald-300"},{border:"border-violet-500/30",glow:"bg-violet-500/20",link:"text-violet-400 hover:text-violet-300"},{border:"border-amber-500/30",glow:"bg-amber-500/20",link:"text-amber-400 hover:text-amber-300"}],OV=()=>{const{data:{rows:e,templates:t,filteredRows:r,sortedRows:n,selectedPackage:a,selectedTemplate:i,packageSummaries:s,slotStats:l,showCapacityColumn:c,tableColumnCount:u,loading:d,defaultTemplateFields:f},filters:{searchTerm:h,categoryFilter:p,statusFilter:x},actions:{setSearchTerm:g,setCategoryFilter:v,setStatusFilter:b,setRows:w,setTemplates:y,persistSlotLinkPreference:N,applySlotLinkPrefs:S}}=PV(),[E,_]=m.useState(!1),[j,A]=m.useState(null),[T,k]=m.useState(""),[C,L]=m.useState(Uu.map(ge=>ge.value)),[G,V]=m.useState("create"),[X,K]=m.useState(!1),[Y,q]=m.useState(!1),[Z,le]=m.useState(null),[ce,me]=m.useState(!1),[Ne,ee]=m.useState(null),[oe,fe]=m.useState(!1),[O,I]=m.useState(!1),[F,M]=m.useState(new Set),[W,J]=m.useState(null),[se,ke]=m.useState(!1),[ye,Pe]=m.useState(null),ue=sm(),Be=kN();m.useEffect(()=>{const Ge=new URLSearchParams(ue.search).get("package")||"all";v(ze=>ze===Ge?ze:Ge)},[ue.search,v]);const Ve=m.useCallback(ge=>{const Ke=ge==="all"||p===ge?"all":ge;Ke!==p&&v(Ke);const Ge=new URLSearchParams(ue.search);Ke==="all"?Ge.delete("package"):Ge.set("package",Ke);const ze=Ge.toString(),Qe=ze?`?${ze}`:"";Qe!==ue.search&&Be({pathname:ue.pathname,search:Qe},{replace:!0})},[p,ue.pathname,ue.search,Be,v]),ve=()=>{if(a&&i){he({productId:i.productId??null,name:a,fields:i.fields,mode:"edit"});return}he()},we=()=>{if(a){if(!i){he({productId:null,name:a,fields:f,mode:"create"});return}K(!0)}},he=m.useCallback(ge=>{A(ge?.productId??null),k(ge?.name??""),L(ge?.fields&&ge.fields.length>0?ge.fields:f),V(ge?.mode??"create"),_(!0)},[f]),Te=m.useCallback(async(ge,Ke,Ge)=>{if(!(!Number.isFinite(ge)||ge<1))try{const ze=await Ue("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:ge,slotLimit:0,matchMode:null,informationUser:null,informationPass:null,informationMail:null,note:null,supplier:null,importPrice:null,expired:null})});if(!ze.ok)throw new Error(`HTTP ${ze.status}`);const Qe=await ze.json();w(Rr=>[...Rr,Qe]),_(!1),Ve(Qe.package??Ke)}catch(ze){console.error("Tạo loại gói thất bại:",ze),Tr({type:"error",title:"Lỗi tạo loại gói",message:ze instanceof Error?ze.message:"Không thể tạo loại gói."})}},[Ve,w]),pe=m.useCallback(ge=>{const Ke=t.find(Ge=>Ge.name===ge)??null;he({productId:Ke?.productId??null,name:ge,fields:Ke?.fields??f,mode:"edit"})},[t,he,f]),We=m.useCallback(()=>{fe(!1),M(new Set)},[]),Oe=m.useCallback(ge=>{const Ke=ge.trim();Ke&&M(Ge=>{const ze=new Set(Ge);return ze.has(Ke)?ze.delete(Ke):ze.add(Ke),ze})},[]),Ae=m.useCallback(async()=>{if(F.size===0){We();return}I(!0);const ge=Array.from(F),Ke=ge.map(Ge=>e.find(ze=>(ze.package||"").trim()===Ge)?.productId).filter(Ge=>Ge!=null&&Number.isFinite(Ge));if(Ke.length===0){I(!1),We();return}try{const Ge=await Ue("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageIds:Ke})});if(!Ge.ok){const ze=await Ge.text();throw new Error(ze||`HTTP ${Ge.status}`)}w(ze=>ze.filter(Qe=>!Ke.includes(Qe.productId??-1))),y(ze=>ze.filter(Qe=>!Ke.includes(Qe.productId??-1))),a&&ge.includes(a)&&Ve("all")}catch(Ge){console.error("Xóa nhóm thất bại:",Ge),Tr({type:"error",title:"Lỗi xóa loại gói",message:`Xóa nhóm thất bại: ${Ge instanceof Error?Ge.message:"Lỗi không xác định"}`})}finally{I(!1),We()}},[F,We,a,Ve,w,y,e]),Ye=m.useCallback(ge=>{const Ke=t.find(Ge=>Ge.name===ge.package)??{name:ge.package,fields:ge.hasCapacityField?f:zp(f),isCustom:!1};le({rowId:ge.id,template:Ke,initialValues:vV(ge),accountStorageId:ge.accountStorageId??null}),q(!0)},[t,f]),ct=m.useCallback(()=>{q(!1),le(null)},[]),He=m.useCallback(ge=>{ee(ge),me(!0)},[]),ut=m.useCallback(()=>{me(!1),ee(null)},[]),vn=m.useCallback(ge=>{Pe(null),J(ge)},[]),Qa=m.useCallback(()=>{ke(!1),Pe(null),J(null)},[]),Rn=m.useCallback(async()=>{if(!W||se)return;const ge=W.id,Ke=(W.package||"").trim();if(ge==null){Pe("Không tìm thấy ID gói để xóa.");return}ke(!0);const Ge=async ze=>{const Qe=await ze.text().catch(()=>""),Rr=Qe?Qe.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim():"",sn=ze.status?` (HTTP ${ze.status})`:"",bn=Rr||ze.statusText||"Không thể thực hiện xóa trên máy chủ";throw new Error(`Không thể xóa gói${sn}: ${bn}`)};try{const ze=await Ue(`/api/package-products/${ge}`,{method:"DELETE"});ze.ok||await Ge(ze);const Qe=await ze.json().catch(()=>({}));console.log("Delete package product response",{targetId:ge,targetName:Ke,data:Qe});const Rr=new Set((Qe.deletedIds&&Qe.deletedIds.length?Qe.deletedIds:[ge]).map(sn=>String(sn)));w(sn=>sn.filter(bn=>{const va=bn.id!==void 0&&bn.id!==null?String(bn.id):"__";return!Rr.has(va)})),Qa()}catch(ze){console.error("Xóa gói thất bại:",ze),Pe(ze instanceof Error?ze.message:"Lỗi không xác định"),ke(!1)}},[se,W,w,y,a,Ve,Qa,Pe]),ga=m.useCallback(async ge=>{if(!i)return;const Ke=i.fields.includes("capacity"),Ge=i.fields.includes("information"),ze=i.fields.includes("note"),Qe=i.fields.includes("supplier"),Rr=i.fields.includes("import"),sn=ta(ge.slot),bn=sn!==null&&sn>0?Math.floor(sn):Zi,va=ta(ge.capacity),ei=va!==null&&va>0?Math.floor(va):Ji,gs=Ge?y2(ge.informationUser||null,ge.informationPass||null,ge.informationMail||null):"",Si={packageId:i.productId??void 0,informationUser:Ge&&ge.informationUser||null,informationPass:Ge&&ge.informationPass||null,informationMail:Ge&&ge.informationMail||null,note:ze&&ge.note||null,supplier:Qe&&ge.supplier||null,importPrice:Rr?ta(ge.import)??0:null,accountUser:Ke&&ge.accountUser||null,accountPass:Ke&&ge.accountPass||null,accountMail:Ke&&ge.accountMail||null,accountNote:Ke&&ge.accountNote||null,capacity:Ke?ei:null,hasCapacityField:Ke,expired:ge.expired||null,slotLimit:bn,matchMode:yc(ge.slotLinkMode)};try{const Gn=await Ue("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Si)});if(!Gn.ok)throw new Error(`HTTP ${Gn.status}`);const on=await Gn.json(),yo=S({...on,slot:bn,slotUsed:0,capacity:Ke?ei:on.capacity,information:Ge?gs||null:on.information,match:on.match??yc(ge.slotLinkMode),hasCapacityField:Ke});w(ba=>[...ba,yo]),on.id!==void 0&&on.id!==null&&N(on.id,ge.slotLinkMode),K(!1)}catch(Gn){console.error("Lỗi khi tạo gói sản phẩm:",Gn)}},[i,S,w,N]),xs=m.useCallback(async ge=>{if(!Z)return;const{template:Ke,rowId:Ge,accountStorageId:ze}=Z,Qe=Ke.fields.includes("capacity"),Rr=Ke.fields.includes("information"),sn=Ke.fields.includes("note"),bn=Ke.fields.includes("supplier"),va=Ke.fields.includes("import"),ei=ta(ge.slot),gs=ei!==null&&ei>0?Math.floor(ei):Zi,Si=ta(ge.capacity),Gn=Si!==null&&Si>0?Math.floor(Si):Ji,on=Rr?y2(ge.informationUser||null,ge.informationPass||null,ge.informationMail||null):"",yo={informationUser:Rr&&ge.informationUser||null,informationPass:Rr&&ge.informationPass||null,informationMail:Rr&&ge.informationMail||null,note:sn&&ge.note||null,supplier:bn&&ge.supplier||null,importPrice:va?ta(ge.import)??0:null,expired:ge.expired||null,slotLimit:gs,accountStorageId:ze??null,accountUser:Qe&&ge.accountUser||null,accountPass:Qe&&ge.accountPass||null,accountMail:Qe&&ge.accountMail||null,accountNote:Qe&&ge.accountNote||null,capacity:Qe?Gn:null,hasCapacityField:Qe,matchMode:yc(ge.slotLinkMode)};try{const ba=await Ue(`/api/package-products/${Ge}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(yo)});if(!ba.ok)throw new Error(`HTTP ${ba.status}`);const vs=await ba.json(),P=S({...vs,slot:gs,capacity:Qe?Gn:vs.capacity,information:Rr?on||null:vs.information,match:vs.match??yc(ge.slotLinkMode),hasCapacityField:Qe});w(B=>B.map(D=>D.id===Ge?P:D)),N(Ge,ge.slotLinkMode),ct()}catch(ba){console.error(`Cập nhật Gói Sản Phẩm ${Ge} Lỗi:`,ba)}},[Z,ct,S,w,N]),Zl=m.useMemo(()=>[{name:"Tổng",value:String(l.total),icon:Ui,accent:vr.sky},{name:"Gói sắp hết",value:String(l.low),icon:fm,accent:vr.amber},{name:"Gói đã hết",value:String(l.out),icon:lm,accent:vr.rose},{name:"Thêm hôm nay",value:"0",icon:Yo,accent:vr.emerald}],[l]);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản lý Gói Sản phẩm"}),o.jsx("p",{className:"text-sm text-white/50",children:"Quản lý các loại gói sản phẩm và các gói con."})]}),o.jsx("div",{className:"rounded-[32px] glass-panel p-6 shadow-2xl border border-white/5",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Zl.map(ge=>o.jsx(Ta,{title:ge.name,value:ge.value,icon:ge.icon,accent:ge.accent},ge.name))})}),o.jsxs("div",{className:"glass-panel-dark rounded-3xl shadow-2xl p-6 text-white border border-white/5",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-white tracking-tight",children:"Tổng quan các loại gói"}),o.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Manage and organize your product categories"})]}),o.jsx(An,{icon:di,onClick:ve,className:"!py-2 !px-4 text-xs shrink-0",children:"Tạo Loại Gói"})]}),s.length===0?o.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Không có loại gói nào được tìm thấy."}):o.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:s.map((ge,Ke)=>{const Ge=ge.name===a,ze=_2[Ke%_2.length],Qe=F.has(ge.name.trim());return o.jsxs("div",{className:`relative isolate rounded-[28px] border ${ze.border} bg-white/5 p-6 text-white shadow-xl backdrop-blur-xl transition-all duration-300 hover:scale-[1.02] ${Ge?"ring-2 ring-indigo-500/50 shadow-indigo-500/20":"hover:bg-white/10 border-white/10"}`,children:[o.jsx("div",{className:`absolute -right-8 -top-8 h-24 w-24 rounded-full blur-[40px] opacity-10 ${ze.glow}`}),o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-indigo-300/50",children:"Loại Gói"}),o.jsx("h3",{className:"text-xl font-bold tracking-tight mt-1",children:ge.name}),o.jsxs("p",{className:"mt-1 text-sm font-medium text-white/40",children:["Số lượng: ",ge.total]})]}),oe?o.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:Qe,disabled:O,onChange:()=>Oe(ge.name)}),"Chọn để xóa"]}):o.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:()=>Ve(ge.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${Ge?"text-blue-300":"text-white/80"}`,title:"Xem chi tiết",children:o.jsx(ma,{className:"h-5 w-5"})}),o.jsx("button",{type:"button",onClick:()=>pe(ge.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chỉnh sửa Loại Gói",children:o.jsx(ca,{className:"h-5 w-5"})})]})})]}),o.jsxs("dl",{className:"mt-6 grid grid-cols-3 gap-3 text-sm",children:[o.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-3 text-center transition-colors hover:bg-white/10",children:[o.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-indigo-300/40",children:"Tổng"}),o.jsx("dd",{className:"mt-1 text-xl font-bold text-white",children:ge.total})]}),o.jsxs("div",{className:"rounded-2xl border border-amber-500/10 bg-amber-500/5 p-3 text-center transition-colors hover:bg-amber-500/10",children:[o.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-amber-500/60",children:"Sắp hết"}),o.jsx("dd",{className:"mt-1 text-xl font-bold text-amber-400",children:ge.low})]}),o.jsxs("div",{className:"rounded-2xl border border-rose-500/10 bg-rose-500/5 p-3 text-center transition-colors hover:bg-rose-500/10",children:[o.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-rose-500/60",children:"Hết"}),o.jsx("dd",{className:"mt-1 text-xl font-bold text-rose-400",children:ge.out})]})]})]},ge.name)})})]}),a&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:`Tìm kiếm trong các gói của ${a}...`,className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:h,onChange:ge=>g(ge.target.value)})]}),o.jsxs("div",{className:"flex w-full lg:w-auto gap-3 items-center",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx("div",{className:"relative w-full lg:w-[180px]",children:o.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:x,onChange:ge=>b(ge.target.value),children:x2.map(ge=>o.jsx("option",{value:ge.value,className:"bg-slate-900 text-white",children:ge.label},ge.value))})})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),oe?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:Ae,className:"flex items-center justify-center gap-1 rounded-xl bg-emerald-500/80 px-3 py-2 text-sm font-semibold text-white shadow-lg hover:bg-emerald-600 transition disabled:opacity-60",disabled:O,title:"Xác nhận xóa",children:o.jsx(Hn,{className:"h-5 w-5"})}),o.jsx("button",{type:"button",onClick:We,className:"flex items-center justify-center gap-1 rounded-xl bg-white/10 px-3 py-2 text-sm font-semibold text-white shadow-lg hover:bg-white/20 transition disabled:opacity-60",disabled:O,title:"Hủy xóa",children:o.jsx(Pt,{className:"h-5 w-5"})})]}):o.jsx(An,{icon:Kr,onClick:()=>{fe(!0),M(new Set)},disabled:O,className:"!py-2 !px-4 text-xs",children:"Xóa Loại gói"}),o.jsx(An,{icon:di,onClick:we,disabled:!a,className:"!py-2 !px-4 text-xs",children:"Thêm Gói"}),o.jsx("button",{className:`px-4 py-2 rounded-xl text-xs font-semibold transition-all border ${r.length?"bg-white/5 text-white border-white/10 hover:bg-white/10":"bg-white/5 text-white/30 border-white/5 cursor-not-allowed"}`,disabled:!r.length,children:"Xuất Excel"})]})]})}),o.jsxs("div",{className:"text-xs font-medium text-indigo-300/60 flex items-center gap-2 px-4 py-1",children:[o.jsx("span",{className:"opacity-70",children:"Đang xem:"}),o.jsx("span",{className:"text-indigo-300",children:a}),x!=="all"&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-white/20",children:"/"}),o.jsx("span",{className:"text-indigo-300",children:x2.find(ge=>ge.value===x)?.label})]})]}),o.jsx(_V,{rows:n,loading:d,showCapacityColumn:c,tableColumnCount:u,onEdit:Ye,onView:He,onDelete:vn})]}),o.jsx(SV,{open:E,initialProductId:j,initialName:T,initialFields:C,mode:G,onClose:()=>_(!1),onSubmit:Te}),i&&o.jsx(N2,{mode:"add",open:X,template:i,onClose:()=>K(!1),onSubmit:ga}),Y&&Z&&o.jsx(N2,{mode:"edit",open:Y,template:Z.template,initialValues:Z.initialValues,onClose:ct,onSubmit:xs}),o.jsx(EV,{open:ce,row:Ne,onClose:ut}),o.jsx(Z5,{isOpen:!!W,onClose:Qa,onConfirm:Rn,title:"Xác nhận xóa gói",message:`Bạn có chắc muốn xóa gói "${W?.package}"?`,secondaryMessage:ye||void 0,confirmLabel:"OK",cancelLabel:"Hủy",isSubmitting:se})]})},DV=({searchTerm:e,onSearchChange:t,onAddCategoryClick:r})=>o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên hoặc mã sản phẩm...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:n=>t(n.target.value)})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),r&&o.jsx("button",{className:"px-5 py-2.5 bg-white/5 border border-white/10 hover:bg-white/10 text-white text-sm font-semibold rounded-2xl transition-all flex items-center gap-2",onClick:r,type:"button",children:"Thêm Danh Mục"})]})]})}),IV=({viewMode:e,onViewModeChange:t})=>o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("button",{type:"button",onClick:()=>t("products"),"aria-pressed":e==="products",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="products"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[o.jsx("p",{className:"text-lg font-semibold text-white",children:"Sản phẩm"}),o.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Hiển thị thông tin sản phẩm"})]}),o.jsxs("button",{type:"button",onClick:()=>t("categories"),"aria-pressed":e==="categories",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="categories"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[o.jsx("p",{className:"text-lg font-semibold text-white",children:"Danh mục"}),o.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Danh sách sản phẩm theo danh mục"})]})]}),Kp=(e,t,r)=>Math.min(Math.max(e,t),r),RV=(e,t)=>{const r=[];if(e<=5){for(let i=1;i<=e;i++)r.push(i);return r}const n=Kp(t-1,2,e-3),a=Kp(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let i=n;i<=a;i++)r.push(i);return a<e-1&&r.push("..."),r.push(e),r};function oT({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:a=""}){const i=r>0?r:10,s=Math.max(1,Math.ceil(t/i)),l=Kp(e,1,s),c=l>1,u=l<s,d="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition disabled:opacity-40 disabled:cursor-not-allowed",f="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition",h="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]",p=t===0?0:(l-1)*i+1,x=Math.min(l*i,t),g=RV(s,l);return o.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${a}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("button",{className:d,onClick:()=>n(1),disabled:!c,children:"<<"}),o.jsx("button",{className:d,onClick:()=>n(l-1),disabled:!c,children:"<"}),o.jsx("div",{className:"flex items-center gap-1.5",children:g.map((v,b)=>v==="..."?o.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${b}`):o.jsx("button",{className:`${f} ${v===l?h:""}`,onClick:()=>n(v),disabled:v===l,children:v},v))}),o.jsx("button",{className:d,onClick:()=>n(l+1),disabled:!u,children:">"}),o.jsx("button",{className:d,onClick:()=>n(s),disabled:!u,children:">>"})]}),o.jsx("div",{className:"text-white/70",children:t===0?"0 mục":`${p}-${x} trong ${t}`})]})}const Hc=10,MV=e=>{const t=e.trim();return t?t.slice(0,2).toUpperCase():"--"},Rt=e=>e?e.replace(/--\d+m$/i,"").trim():"",Jr=e=>(e||"").replace(/\n/g,"<br/>"),js=e=>Rt(e).toLowerCase(),uh=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Bs=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),a=s=>{if(s.nodeType===Node.TEXT_NODE)return uh(s.textContent||"");if(s.nodeType===Node.ELEMENT_NODE){const l=s;if(l.tagName==="BR")return"<br/>";if(l.tagName==="A"){const u=l.getAttribute("href")||"#",d=uh(u),f=Array.from(l.childNodes).map(a).join("");return`<a href="${d}" title="${d}" target="_blank" rel="noopener noreferrer">${f}</a>`}const c=Array.from(l.childNodes).map(a).join("");return n.has(l.tagName)?`${c}<br/>`:c}return""};return Array.from(r.body.childNodes).map(a).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return uh(e)}},dh=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=/(Thông tin\s*&\s*tên sản phẩm|thông tin sản phẩm|mô tả|nội dung|tên sản phẩm)/i,i=n.match(a),s=l=>l.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(i&&(i.index??0)>=3){const l=i.index??0,c=r.slice(0,l).trim(),u=r.slice(l).trim();return{rulesHtml:s(c),descriptionHtml:s(u)}}return{rulesHtml:e||"",descriptionHtml:t||""}},FV=(e,t,r)=>{const n=(r||"").toLowerCase().trim(),a=new Map;t.forEach(l=>{const c=js(l.san_pham||""),u=js(l.package_product||"");[c,u].filter(Boolean).forEach(f=>{a.has(f)||a.set(f,l)})});const i=new Map;for(const l of e){const c=js(l.productId||""),u=c?a.get(c):null,d={...l,priceId:u?.id??null,productId:Rt(l.productId||""),productName:l.productName||(u?Rt(u.package_product||u.san_pham||""):null)||l.productId,packageProduct:u?Rt(u.package_product||u.san_pham||""):null,packageName:u?Rt(u.package||u.san_pham||""):null,category:u?.category??null,categories:Array.isArray(u?.categories)?u?.categories??[]:[],imageUrl:l.imageUrl??u?.image_url??null,packageImageUrl:u?.image_url??null,rulesHtml:l.rulesHtml||Jr(l.rules||""),descriptionHtml:l.descriptionHtml||Jr(l.description||"")},f=c||js(d.productName||"");f&&(i.has(f)||i.set(f,d))}for(const l of t){const c=js(l.san_pham||""),u=js(l.package_product||""),d=c||u,f=c&&i.has(c)||u&&i.has(u);!d||f||i.set(d,{id:l.id,priceId:l.id,productId:Rt(l.san_pham||""),productName:Rt(l.package_product||l.san_pham||""),packageProduct:Rt(l.package_product||l.san_pham||""),packageName:Rt(l.package||""),category:l.category??null,categories:Array.isArray(l.categories)?l.categories??[]:[],rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:l.image_url??null,packageImageUrl:l.image_url??null})}let s=Array.from(i.values());return n&&(s=s.filter(l=>`${l.productId||""} ${l.productName||""} ${l.description||""} ${l.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),s},LV=({item:e,size:t="small"})=>{const r=e.productName||e.productId||"--",n=MV(r),a=t==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs",i="rounded-md bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold";return e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:r,className:`${a} rounded-md object-cover`,onError:s=>{s.currentTarget.style.display="none"}}):o.jsx("div",{className:`${a} ${i}`,children:o.jsx("span",{children:n})})},BV=({item:e,isExpanded:t,onToggle:r,onEdit:n})=>{const a=e.packageProduct||e.productName||e.productId||"--",i=(e.packageName||"").trim(),s=e.rulesHtml||Jr(e.rules||""),l=e.descriptionHtml||Jr(e.description||""),{rulesHtml:c,descriptionHtml:u}=dh(s,l),d=Bs(c)||"Không có thông tin bán hàng",f=Bs(u||Jr(e.description||""))||"Không có thông tin sản phẩm";return o.jsxs(la.Fragment,{children:[o.jsxs("tr",{className:`product-row ${t?"product-row--expanded":""} hover:bg-white/5 cursor-pointer ${t?"bg-white/5":""}`,onClick:()=>r(t?null:Number(e.id)),children:[o.jsx("td",{className:"product-row__cell px-4 py-3",children:e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:a,className:"h-12 w-12 rounded-lg object-cover",onError:h=>{h.currentTarget.src="https://via.placeholder.com/48?text=No+Image"}}):o.jsx("div",{className:"h-12 w-12 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-white/50 text-[11px] font-bold uppercase tracking-tighter text-center px-1",children:"No Image"})}),o.jsx("td",{className:"px-4 py-3 text-white",children:o.jsx("div",{className:"flex flex-col",children:o.jsx("span",{className:"font-semibold text-white",children:Rt(e.productId||"")||"--"})})}),o.jsx("td",{className:"px-4 py-3 text-white",children:Rt(a)||"--"}),o.jsx("td",{className:"px-4 py-3 text-white/80 border-r border-white/10 min-w-[160px]",children:o.jsx("span",{className:"block truncate",title:i||void 0,children:i||"--"})}),o.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:o.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.rulesHtml?void 0:e.rules||"",dangerouslySetInnerHTML:{__html:d}})}),o.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:o.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.descriptionHtml?void 0:e.description||"",dangerouslySetInnerHTML:{__html:f}})}),o.jsxs("td",{className:"product-row__actions px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",title:"Xem",type:"button",children:o.jsx(ma,{className:"h-3.5 w-3.5"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-90",title:"Sửa",type:"button",onClick:h=>{h.stopPropagation(),n(e)},children:o.jsx(is,{className:"h-3.5 w-3.5"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",title:"Xóa",type:"button",children:o.jsx(Kr,{className:"h-3.5 w-3.5"})})]})]}),t&&o.jsx("tr",{className:"bg-white/5",children:o.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin chi tiết"}),o.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:Rt(e.packageProduct||e.productName||e.productId||"")||"Không có thông tin chi tiết."})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:o.jsx(LV,{item:e,size:"large"})}),o.jsxs("div",{className:"flex-1 space-y-3",children:[o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy tắc bán hàng"}),o.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Bs(dh(e.rulesHtml||Jr(e.rules||""),e.descriptionHtml||Jr(e.description||"")).rulesHtml)||"Không có quy tắc bán hàng."}})]}),o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Bs(dh(e.rulesHtml||Jr(e.rules||""),e.descriptionHtml||Jr(e.description||"")).descriptionHtml||Jr(e.description||""))||"Không có thông tin sản phẩm."}})]})]})]})]})})]},`${e.id}-${e.productId}`)},$V=({item:e,onEdit:t,onView:r})=>{const n=Rt(e.packageProduct||e.productName||e.productId||"--"),a=(e.packageName||"").trim(),i=Bs(e.rulesHtml||Jr(e.rules||""))||"Không có thông tin bán hàng",s=Bs(e.descriptionHtml||Jr(e.description||""))||"Không có thông tin sản phẩm";return o.jsxs("div",{className:"product-card glass-panel-dark rounded-2xl p-4 border border-white/5 space-y-4 shadow-xl",children:[o.jsxs("div",{className:"product-card__header flex items-start gap-3",children:[e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:n,className:"h-16 w-16 rounded-lg object-cover flex-shrink-0",onError:l=>{l.currentTarget.src="https://via.placeholder.com/64?text=No+Image"}}):o.jsx("div",{className:"h-16 w-16 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:n.substring(0,2).toUpperCase()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-white text-base truncate",children:n}),o.jsxs("p",{className:"text-sm text-white/70 mt-1",children:["Mã: ",Rt(e.productId||"")||"--"]}),a&&o.jsxs("p",{className:"text-xs text-white/60 mt-1",children:["Danh mục: ",a]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-xs font-semibold text-white/80 uppercase tracking-wide",children:"Quy tắc bán hàng"}),o.jsx("div",{className:"text-sm text-white/70 line-clamp-2 rich-display",dangerouslySetInnerHTML:{__html:i}})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-xs font-semibold text-white/80 uppercase tracking-wide",children:"Mô tả"}),o.jsx("div",{className:"text-sm text-white/70 line-clamp-2 rich-display",dangerouslySetInnerHTML:{__html:s}})]}),o.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-white/5",children:[r&&o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-95",title:"Xem",type:"button",onClick:()=>r(e),children:o.jsx(ma,{className:"h-4 w-4"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-95",title:"Sửa",type:"button",onClick:()=>t(e),children:o.jsx(is,{className:"h-4 w-4"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-95",title:"Xóa",type:"button",children:o.jsx(Kr,{className:"h-4 w-4"})})]})]})},UV=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,expandedId:s,onToggleExpand:l,onEdit:c})=>o.jsxs("div",{className:"product-table rounded-[32px] border border-white/5 bg-slate-900/40 shadow-2xl backdrop-blur-xl overflow-hidden",children:[o.jsxs("div",{className:"product-table__header border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[o.jsx("h2",{className:"product-table__title text-lg font-semibold text-white",children:"Sản phẩm"}),r&&o.jsx("span",{className:"product-table__loading text-xs text-white/60",children:"Đang tải..."})]}),o.jsx(bg,{showCardOnMobile:!0,cardView:o.jsx(yg,{data:e,renderCard:u=>o.jsx($V,{item:u,onEdit:c}),className:"p-2"}),children:o.jsxs("table",{className:"product-table__table min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"13%"}}),o.jsx("col",{style:{width:"15%"}}),o.jsx("col",{style:{width:"12%",minWidth:"160px"}}),o.jsx("col",{style:{width:"22%",minWidth:"240px"}}),o.jsx("col",{style:{width:"21%",minWidth:"240px"}}),o.jsx("col",{style:{width:"7%",minWidth:"120px"}})]}),o.jsx("thead",{className:"product-table__head bg-white/5 text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/40",children:o.jsxs("tr",{children:[o.jsx("th",{className:"product-table__th px-4 py-3 text-left font-semibold",children:"Hình ảnh"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Mã sản phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Tên sản phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold border-r border-white/10 min-w-[160px]",children:"Danh mục"}),o.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy tắc"}),o.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"Mô tả"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[e.map(u=>o.jsx(BV,{item:u,isExpanded:s===u.id,onToggle:l,onEdit:c},`${u.id}-${u.productId}`)),!r&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có sản phẩm nào được hiển thị."})}),r&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách sản phẩm..."})})]})]})}),o.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:o.jsx(oT,{currentPage:n,totalItems:t,pageSize:a,onPageChange:i})})]}),HV=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,expandedId:i,onPageChange:s,onToggleExpand:l,onEdit:c})=>o.jsx(UV,{products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:s,expandedId:i,onToggleExpand:l,onEdit:c}),zV=({categoryRows:e,allCategoryRows:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,onEditCategory:s,getCategoryColor:l})=>{const[c,u]=m.useState(null);return o.jsxs("div",{className:"category-table rounded-[32px] border border-white/5 bg-slate-900/40 shadow-2xl backdrop-blur-xl overflow-hidden",children:[o.jsxs("div",{className:"category-table__header border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[o.jsx("h2",{className:"category-table__title text-lg font-semibold text-white",children:"Danh Mục"}),r?o.jsx("span",{className:"text-xs text-white/60",children:"Đang tải..."}):o.jsxs("span",{className:"text-xs text-white/60",children:[t.length," danh mục"]})]}),o.jsx("div",{className:"category-table__inner overflow-x-auto",children:o.jsxs("table",{className:"category-table__table min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"30%"}}),o.jsx("col",{style:{width:"40%"}}),o.jsx("col",{style:{width:"20%",minWidth:"140px"}})]}),o.jsx("thead",{className:"category-table__head bg-white/5 text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/70",children:o.jsxs("tr",{children:[o.jsx("th",{className:"category-table__th px-4 py-3 text-left font-semibold",children:"Hình Ảnh"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Gói Sản Phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Danh Mục"}),o.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Thao Tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[!r&&t.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có danh mục nào để hiển thị."})}),r&&t.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách danh mục..."})}),e.map(d=>o.jsxs(la.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-4 py-3",children:d.imageUrl?o.jsx("img",{src:d.imageUrl,alt:d.packageName,className:"h-12 w-12 rounded-lg object-cover",onError:f=>{f.currentTarget.src="https://via.placeholder.com/48?text=No+Image"}}):o.jsx("div",{className:"h-12 w-12 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-white/50 text-[11px] font-bold uppercase tracking-tighter text-center px-1",children:"No Image"})}),o.jsx("td",{className:"px-4 py-3 text-white font-semibold",children:d.packageName}),o.jsx("td",{className:"px-4 py-3 text-white/80",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:(d.categories||[]).map((f,h)=>o.jsx("span",{className:"category-pill",style:{backgroundColor:l(f,h)},children:f.name},`${d.key}-${f.id||f.name}`))})}),o.jsxs("td",{className:"px-4 py-3 text-center",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",onClick:()=>u(f=>f===d.key?null:d.key),children:o.jsx(ma,{className:"h-5 w-5 text-blue-400"})}),o.jsx("button",{className:"ml-2 inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",type:"button",onClick:()=>s(d),children:o.jsx(is,{className:"h-5 w-5 text-green-400"})})]})]}),c===d.key&&o.jsx("tr",{className:"bg-white/5",children:o.jsx("td",{colSpan:3,className:"px-6 py-4",children:o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-2",children:d.items.map(f=>{const h=Rt(f.productId||""),p=Rt(f.packageProduct||f.productName||f.productId||"");return o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:h}),o.jsx("p",{className:"text-xs text-white/60 truncate",children:p})]},`${d.key}-${f.id}-${f.productId}`)})})})})]},d.key))]})]})}),!r&&t.length>0&&o.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:o.jsx(oT,{currentPage:n,totalItems:t.length,pageSize:a,onPageChange:i})})]})},fh=8,WV=({categoryRows:e,loading:t,onEditCategory:r,getCategoryColor:n})=>{const[a,i]=m.useState(1);m.useEffect(()=>{i(1)},[e.length]);const s=m.useMemo(()=>{const l=(a-1)*fh,c=l+fh;return e.slice(l,c)},[e,a]);return o.jsx(zV,{categoryRows:s,allCategoryRows:e,loading:t,currentPage:a,pageSize:fh,onPageChange:i,onEditCategory:r,getCategoryColor:n})},VV=({open:e,name:t,color:r,saving:n,error:a,onNameChange:i,onColorChange:s,onClose:l,onSave:c})=>{if(!e)return null;const u=(t||"").trim(),d=n||!u;return o.jsx("div",{className:"fixed inset-0 z-70 flex items-start justify-center bg-black/50 px-4 py-8",children:o.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tạo danh mục mới"}),o.jsx("button",{type:"button",className:"rounded-full p-2 text-white/60 hover:text-white hover:bg-white/10 transition",onClick:l,"aria-label":"Đóng",children:o.jsx(Pt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"px-5 py-5 space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Tên danh mục"}),o.jsx("input",{type:"text",value:t,onChange:f=>i(f.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"Nhập tên danh mục"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Màu sắc"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"color",value:r,onChange:f=>s(f.target.value),className:"h-10 w-14 rounded border border-white/10 bg-white/10"}),o.jsx("input",{type:"text",value:r,onChange:f=>s(f.target.value),className:"flex-1 rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"#facc15"}),o.jsx("div",{className:"h-10 w-10 rounded-lg border border-white/10",style:{backgroundColor:r||"#facc15"}})]})]}),a&&o.jsx("div",{className:"rounded-lg border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:a})]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-4",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/10 px-4 py-2 text-sm font-semibold text-white/70 hover:text-white hover:bg-white/10 transition",onClick:l,disabled:n,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-500 transition disabled:opacity-60",onClick:c,disabled:d,children:n?"Đang tạo...":"Tạo danh mục"})]})]})})},lT=async e=>{const t=new FormData;t.append("image",e);const r=await Ue("/api/product-images/upload",{method:"POST",body:t});if(!r.ok){const a=await r.text().catch(()=>"");throw new Error(Wr(a,{fallback:"Upload failed."}))}const n=await r.json().catch(()=>null);if(!n||typeof n.url!="string")throw new Error("Invalid upload response.");return n},cT=async()=>{const e=await Ue("/api/product-images");if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(Wr(r,{fallback:"Failed to load images."}))}const t=await e.json().catch(()=>null);return!t||!Array.isArray(t.items)?{items:[],count:0}:{items:t.items,count:typeof t.count=="number"&&Number.isFinite(t.count)?t.count:t.items.length}},uT=async e=>{const t=encodeURIComponent(e||""),r=await Ue(`/api/product-images/${t}`,{method:"DELETE"});if(!r.ok){const n=await r.text().catch(()=>"");throw new Error(Wr(n,{fallback:"Delete failed."}))}},KV=({open:e,images:t,selectedImage:r,loading:n,uploading:a,deleting:i,error:s,uploadError:l,onClose:c,onSelect:u,onUseSelected:d,onUploadClick:f,onDeleteSelected:h})=>e?o.jsx("div",{className:"fixed inset-0 z-[80] flex items-center justify-center bg-black/70 px-4 py-6",children:o.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-white/10 bg-[#0b1220] shadow-2xl",children:[o.jsx("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chọn hình ảnh sản phẩm"})}),o.jsxs("div",{className:"p-4 space-y-4",children:[n?o.jsx("p",{className:"text-sm text-white/70",children:"Đang tải hình ảnh..."}):t.length===0?o.jsx("p",{className:"text-sm text-white/70",children:"Chưa có hình ảnh nào."}):o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 max-h-[400px] overflow-y-auto",children:t.map(p=>{const x=r?.fileName===p.fileName;return o.jsxs("button",{type:"button",className:`rounded-xl border p-2 text-left transition ${x?"border-blue-400 ring-2 ring-blue-400/40":"border-white/10 hover:border-white/30"}`,onClick:()=>u(p),children:[o.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-lg bg-black/30",children:o.jsx("img",{src:p.url,alt:p.fileName,className:"h-full w-full object-contain"})}),o.jsx("p",{className:"mt-2 truncate text-xs text-white/70",children:p.fileName})]},p.fileName)})}),(s||l)&&o.jsxs("div",{className:"space-y-1",children:[s&&o.jsx("p",{className:"text-xs text-rose-300",children:s}),l&&o.jsx("p",{className:"text-xs text-rose-300",children:l})]}),o.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/40 bg-transparent px-4 py-2 text-sm font-semibold text-white/90 hover:border-white hover:text-white disabled:opacity-60",onClick:f,disabled:a,children:a?"Đang tải...":"Tải hình mới"}),o.jsx("button",{type:"button",className:"rounded-lg border border-rose-400/60 bg-transparent px-4 py-2 text-sm font-semibold text-rose-200 hover:border-rose-300 hover:text-rose-100 disabled:opacity-60",onClick:h,disabled:!r||i,children:i?"Đang xóa...":"Xoá hình đã chọn"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white/70 hover:text-white",onClick:c,children:"Hủy"}),o.jsx("button",{type:"button",className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:d,disabled:!r,children:"Sử dụng hình đã chọn"})]})]})]})]})}):null,GV=({imageUrl:e,onImageUrlChange:t})=>{const r=m.useRef(null),[n,a]=m.useState(!1),[i,s]=m.useState([]),[l,c]=m.useState(!1),[u,d]=m.useState(null),[f,h]=m.useState(null),[p,x]=m.useState(!1),[g,v]=m.useState(null),[b,w]=m.useState(!1),y=async T=>{c(!0),d(null);try{const k=await cT(),C=Array.isArray(k.items)?k.items:[];s(C);let L=T||f;L&&(L=C.find(G=>G.fileName===L?.fileName||G.url===L?.url)||null),!L&&e&&(L=C.find(G=>G.url===e)||null),!L&&C.length&&(L=C[0]),h(L)}catch(k){d(k instanceof Error?k.message:"Failed to load images."),s([])}finally{c(!1)}},N=()=>{a(!0),d(null),v(null),y()},S=()=>{a(!1)},E=()=>{r.current?.click()},_=async T=>{const k=T.target.files?.[0];if(k){x(!0),v(null);try{const C=await lT(k);t(C.url);const L=C.fileName?{fileName:C.fileName,url:C.url}:null;h(L),await y(L)}catch(C){v(C instanceof Error?C.message:"Upload failed.")}finally{x(!1),T.target.value=""}}},j=()=>{f&&(t(f.url),a(!1))},A=async()=>{if(!(!f||b)){w(!0),d(null);try{await uT(f.fileName),e===f.url&&t(""),await y(null)}catch(T){d(T instanceof Error?T.message:"Delete failed.")}finally{w(!1)}}};return o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold text-slate-300 uppercase tracking-wide mb-3",children:"Hình ảnh sản phẩm"}),o.jsxs("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 shadow-sm backdrop-blur-sm",children:[e?o.jsx("img",{src:e,alt:"Product",className:"h-full w-full object-contain p-3",onError:T=>{T.currentTarget.style.display="none"}}):o.jsx("div",{className:"flex h-full w-full items-center justify-center",children:o.jsx(RN,{className:"h-16 w-16 text-white/20"})}),o.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 hover:opacity-100 transition-opacity backdrop-blur-sm",onClick:N,children:o.jsx("span",{className:"rounded-xl border border-white/70 bg-black/60 px-4 py-2.5 text-sm font-semibold text-white shadow-lg backdrop-blur-sm",children:e?"Thay đổi":"Chọn ảnh"})}),o.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:_})]}),o.jsx(KV,{open:n,images:i,selectedImage:f,loading:l,uploading:p,deleting:b,error:u,uploadError:g,onClose:S,onSelect:h,onUseSelected:j,onUploadClick:E,onDeleteSelected:A})]})},XV=["#facc15","#f97316","#ef4444","#f43f5e","#a855f7","#8b5cf6","#3b82f6","#38bdf8","#14b8a6","#22c55e","#84cc16","#eab308"],S2=({value:e,onChange:t,label:r})=>o.jsxs("div",{className:"space-y-2",children:[r&&o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:r}),o.jsx("div",{className:"grid grid-cols-6 gap-2",children:XV.map(n=>o.jsx("button",{type:"button",onClick:()=>t(n),className:`h-10 w-full rounded-lg border-2 transition-all ${e===n?"border-white ring-2 ring-white/50 scale-110":"border-white/20 hover:border-white/40 hover:scale-105"}`,style:{backgroundColor:n},title:n},n))}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"color",value:e||"#facc15",onChange:n=>t(n.target.value),className:"h-10 w-16 rounded-lg border border-white/20 bg-slate-950/40 cursor-pointer"}),o.jsx("input",{type:"text",value:e||"",onChange:n=>t(n.target.value),placeholder:"#000000",className:"flex-1 rounded-lg border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-white placeholder:text-slate-400 focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all"})]})]}),YV=async()=>{const e=await Ue("/api/categories");if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(r||`Failed to load categories (${e.status}).`)}const t=await e.json();return Array.isArray(t)?t:[]},qV=async e=>{const t=await Ue("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.text().catch(()=>"");throw new Error(r||`Failed to create category (${t.status}).`)}return await t.json()},ZV=async(e,t)=>{const r=await Ue(`/api/categories/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.text().catch(()=>"");throw new Error(n||`Failed to update category (${r.status}).`)}return await r.json()},JV=async e=>{const t=await Ue(`/api/categories/${e}`,{method:"DELETE"});if(!t.ok){const r=await t.text().catch(()=>"");throw new Error(r||`Failed to delete category (${t.status}).`)}},QV=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(!1),[a,i]=m.useState(null),[s,l]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(!1),h=m.useCallback(async()=>{n(!0),i(null);try{const v=await YV();t(v)}catch(v){i(v instanceof Error?v.message:"Failed to load categories"),t([])}finally{n(!1)}},[]),p=m.useCallback(async v=>{l(!0),i(null);try{const b=await qV(v);return await h(),b}catch(b){const w=b instanceof Error?b.message:"Failed to create category";throw i(w),b}finally{l(!1)}},[h]),x=m.useCallback(async(v,b)=>{u(!0),i(null);try{const w=await ZV(v,b);return await h(),w}catch(w){const y=w instanceof Error?w.message:"Failed to update category";throw i(y),w}finally{u(!1)}},[h]),g=m.useCallback(async v=>{f(!0),i(null);try{await JV(v),await h()}catch(b){const w=b instanceof Error?b.message:"Failed to delete category";throw i(w),b}finally{f(!1)}},[h]);return{categories:e,loading:r,error:a,creating:s,updating:c,deleting:d,reload:h,create:p,update:x,remove:g}},eK=({onCategoriesChange:e})=>{const{categories:t,loading:r,error:n,creating:a,updating:i,deleting:s,reload:l,create:c,update:u,remove:d}=QV(),[f,h]=m.useState(null),[p,x]=m.useState(""),[g,v]=m.useState("#facc15"),[b,w]=m.useState(!1),[y,N]=m.useState(""),[S,E]=m.useState("#facc15"),[_,j]=m.useState(null);m.useEffect(()=>{l()},[l]);const A=X=>{h(X.id),x(X.name),v(X.color||"#facc15")},T=()=>{h(null),x(""),v("#facc15")},k=async()=>{if(!(!f||!p.trim()))try{await u(f,{name:p.trim(),color:g}),h(null),x(""),v("#facc15"),e?.()}catch{}},C=()=>{w(!0),N(""),E("#facc15")},L=()=>{w(!1),N(""),E("#facc15")},G=async()=>{if(y.trim())try{await c({name:y.trim(),color:S}),w(!1),N(""),E("#facc15"),e?.()}catch{}},V=async X=>{try{await d(X),j(null),e?.()}catch{}};return r&&t.length===0?o.jsx("div",{className:"flex items-center justify-center py-16",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("p",{className:"text-sm text-slate-400",children:"Đang tải danh mục..."})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-xl font-bold text-white",children:"Quản Lý Danh Mục"}),o.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Thêm, sửa, hoặc xóa các danh mục sản phẩm"})]}),o.jsxs("button",{type:"button",onClick:C,disabled:b||a,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-5 py-3 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 hover:shadow-xl disabled:opacity-50",children:[o.jsx(di,{className:"h-4 w-4"}),"Thêm Danh Mục"]})]}),n&&o.jsxs("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-5 py-4 text-sm text-rose-200 flex items-start gap-3",children:[o.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o.jsx("span",{children:n})]}),b&&o.jsxs("div",{className:"rounded-2xl border border-indigo-400/50 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10 p-6 space-y-4 shadow-lg",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Tên Danh Mục"}),o.jsx("input",{type:"text",value:y,onChange:X=>N(X.target.value),placeholder:"Nhập tên danh mục...",className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",autoFocus:!0})]}),o.jsx(S2,{label:"Màu Sắc",value:S,onChange:E}),o.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:L,disabled:a,className:"px-5 py-2.5 text-sm font-semibold text-slate-300 hover:text-white transition-colors disabled:opacity-50",children:"Hủy"}),o.jsxs("button",{type:"button",onClick:G,disabled:!y.trim()||a,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:[o.jsx(Hn,{className:"h-4 w-4"}),a?"Đang tạo...":"Tạo"]})]})]}),o.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.map(X=>{const K=f===X.id,Y=_===X.id;return K?o.jsxs("div",{className:"sm:col-span-2 rounded-2xl border border-indigo-400/50 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10 p-6 space-y-4 shadow-lg",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Tên Danh Mục"}),o.jsx("input",{type:"text",value:p,onChange:q=>x(q.target.value),className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all"})]}),o.jsx(S2,{label:"Màu Sắc",value:g,onChange:v}),o.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:T,disabled:i,className:"px-5 py-2.5 text-sm font-semibold text-slate-300 hover:text-white transition-colors disabled:opacity-50",children:"Hủy"}),o.jsxs("button",{type:"button",onClick:k,disabled:!p.trim()||i,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:[o.jsx(Hn,{className:"h-4 w-4"}),i?"Đang lưu...":"Lưu"]})]})]},X.id):o.jsx("div",{className:"group rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm hover:border-white/25 transition-all",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"h-14 w-14 rounded-xl border-2 border-white/20 flex-shrink-0 shadow-md",style:{backgroundColor:X.color||"#facc15"}}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-base font-semibold text-white truncate",children:X.name}),o.jsx("p",{className:"text-xs text-slate-400 mt-1 font-mono",children:X.color||"#facc15"})]}),Y?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:()=>j(null),disabled:s,className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/10 transition-colors disabled:opacity-50",title:"Hủy",children:o.jsx(Pt,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>V(X.id),disabled:s,className:"p-2 rounded-lg text-red-400 hover:text-red-300 hover:bg-red-500/20 transition-colors disabled:opacity-50",title:"Xác nhận xóa",children:o.jsx(Hn,{className:"h-4 w-4"})})]}):o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{type:"button",onClick:()=>A(X),disabled:f!==null||i,className:"p-2 rounded-lg text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/20 transition-colors disabled:opacity-50",title:"Sửa",children:o.jsx(ca,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>j(X.id),disabled:f!==null||s,className:"p-2 rounded-lg text-slate-400 hover:text-red-400 hover:bg-red-500/20 transition-colors disabled:opacity-50",title:"Xóa",children:o.jsx(Kr,{className:"h-4 w-4"})})]})]})},X.id)}),t.length===0&&!r&&o.jsxs("div",{className:"sm:col-span-2 text-center py-12",children:[o.jsx("svg",{className:"w-16 h-16 text-slate-600 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),o.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"Chưa có danh mục nào"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Nhấn "Thêm Danh Mục" để tạo danh mục mới'})]})]})]})},E2=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],tK=(e,t)=>e.color||E2[t%E2.length],rK=({open:e,packageName:t,imageUrl:r,categoryOptions:n,selectedCategoryIds:a,saving:i,error:s,onPackageNameChange:l,onImageUrlChange:c,onToggleCategory:u,onClose:d,onSave:f,onCategoriesReload:h})=>{const[p,x]=m.useState("edit");if(!e)return null;const g=()=>{h?.()};return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:o.jsxs("div",{className:"relative flex w-full max-w-6xl flex-col rounded-[32px] border border-white/20 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl max-h-[95vh] overflow-hidden",children:[o.jsx("button",{type:"button",onClick:d,className:"absolute right-6 top-6 z-10 rounded-full bg-slate-800/80 p-2 text-slate-400 backdrop-blur-sm transition-all hover:bg-slate-700 hover:text-white","aria-label":"Đóng",children:o.jsx(Pt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"border-b border-white/10 px-8 py-6",children:[o.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Chỉnh sửa gói sản phẩm và danh mục"}),o.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Quản lý thông tin gói sản phẩm và danh mục"})]}),o.jsxs("div",{className:"flex border-b border-white/10 px-8 bg-slate-900/50",children:[o.jsxs("button",{type:"button",onClick:()=>x("edit"),className:`px-6 py-4 text-sm font-semibold transition-all relative ${p==="edit"?"text-indigo-400":"text-slate-400 hover:text-slate-300"}`,children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Chỉnh Sửa Gói"]}),p==="edit"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]}),o.jsxs("button",{type:"button",onClick:()=>x("manage"),className:`px-6 py-4 text-sm font-semibold transition-all relative ${p==="manage"?"text-indigo-400":"text-slate-400 hover:text-slate-300"}`,children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Quản Lý Danh Mục"]}),p==="manage"&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-8 py-6",children:p==="edit"?o.jsxs("div",{className:"grid gap-8 lg:grid-cols-3",children:[o.jsx("div",{className:"lg:col-span-1",children:o.jsx("div",{className:"sticky top-0",children:o.jsx(GV,{imageUrl:r,onImageUrlChange:c})})}),o.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[o.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-6 shadow-sm backdrop-blur-sm",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Gói Sản Phẩm"}),o.jsx("input",{type:"text",value:t,onChange:w=>l(w.target.value),className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",placeholder:"Nhập tên gói sản phẩm..."})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:"Danh Mục"}),o.jsxs("span",{className:"text-xs font-medium text-indigo-400 bg-indigo-500/20 px-3 py-1.5 rounded-full",children:["Đã chọn: ",a.length]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[n.map((w,y)=>{const N=a.includes(w.id),S=tK(w,y);return o.jsxs("button",{type:"button",onClick:()=>u(w.id),className:`group relative inline-flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-xs transition-all duration-200 ${N?"shadow-lg scale-105":"opacity-70 hover:opacity-90 shadow-sm hover:shadow-md hover:scale-102"}`,style:{background:`linear-gradient(135deg, ${S} 0%, ${S}dd 100%)`,color:"#ffffff",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",border:N?"2px solid rgba(255, 255, 255, 0.8)":"1px solid rgba(255, 255, 255, 0.15)",boxShadow:N?`0 0 0 3px ${S}40, 0 4px 12px rgba(0, 0, 0, 0.3)`:void 0},children:[N&&o.jsx("div",{className:"absolute inset-0 rounded-lg",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 100%)"}}),!N&&o.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 100%)"}}),o.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[N&&o.jsx(Hn,{className:"h-3.5 w-3.5"}),w.name]})]},w.id)}),n.length===0&&o.jsxs("div",{className:"w-full text-center py-12 rounded-2xl border border-white/10 bg-slate-800/30",children:[o.jsx("svg",{className:"w-12 h-12 text-slate-600 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),o.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"Không có danh mục để chọn"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Hãy tạo danh mục mới trong tab "Quản Lý Danh Mục"'})]})]})]}),s&&o.jsxs("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-5 py-4 text-sm text-rose-200 flex items-start gap-3",children:[o.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o.jsx("span",{children:s})]})]})]}):o.jsx(eK,{onCategoriesChange:g})}),p==="edit"&&o.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-8 py-5 bg-slate-900/50",children:[o.jsx("button",{type:"button",className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",onClick:d,disabled:i,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-8 py-3 font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",onClick:f,disabled:i,children:i?o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang lưu..."]}):"Lưu thay đổi"})]})]})})},nK=({open:e,images:t,selectedImage:r,loading:n,uploading:a,deleting:i,error:s,uploadError:l,onClose:c,onSelect:u,onUseSelected:d,onUploadClick:f,onDeleteSelected:h})=>e?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 px-4 py-6",children:o.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-white/10 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl",children:[o.jsx("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chọn hình ảnh sản phẩm"})}),o.jsxs("div",{className:"p-4 space-y-4",children:[n?o.jsx("p",{className:"text-sm text-white/70",children:"Đang tải hình ảnh..."}):t.length===0?o.jsx("p",{className:"text-sm text-white/70",children:"Chưa có hình ảnh nào."}):o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 max-h-[400px] overflow-y-auto",children:t.map(p=>{const x=r?.fileName===p.fileName;return o.jsxs("button",{type:"button",className:`rounded-xl border p-2 text-left transition ${x?"border-indigo-400 ring-2 ring-indigo-400/40":"border-white/10 hover:border-white/30"}`,onClick:()=>u(p),children:[o.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-lg bg-black/30",children:o.jsx("img",{src:p.url,alt:p.fileName,className:"h-full w-full object-contain"})}),o.jsx("p",{className:"mt-2 truncate text-xs text-white/70",children:p.fileName})]},p.fileName)})}),(s||l)&&o.jsxs("div",{className:"space-y-1",children:[s&&o.jsx("p",{className:"text-xs text-rose-300",children:s}),l&&o.jsx("p",{className:"text-xs text-rose-300",children:l})]}),o.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/40 bg-transparent px-4 py-2 text-sm font-semibold text-white/90 hover:border-white hover:text-white disabled:opacity-60",onClick:f,disabled:a,children:a?"Đang tải...":"Tải hình mới"}),o.jsx("button",{type:"button",className:"rounded-lg border border-rose-400/60 bg-transparent px-4 py-2 text-sm font-semibold text-rose-200 hover:border-rose-300 hover:text-rose-100 disabled:opacity-60",onClick:h,disabled:!r||i,children:i?"Đang xóa...":"Xoá hình đã chọn"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white/70 hover:text-white",onClick:c,children:"Hủy"}),o.jsx("button",{type:"button",className:"rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700 disabled:opacity-60",onClick:d,disabled:!r,children:"Sử dụng hình đã chọn"})]})]})]})]})}):null,aK=({imageUrl:e,onImageChange:t,onImageRemove:r})=>{const n=m.useRef(null),[a,i]=m.useState(!1),[s,l]=m.useState(!1),[c,u]=m.useState([]),[d,f]=m.useState(!1),[h,p]=m.useState(null),[x,g]=m.useState(null),[v,b]=m.useState(!1),[w,y]=m.useState(null),[N,S]=m.useState(!1),E=async V=>{f(!0),p(null);try{const X=await cT(),K=Array.isArray(X.items)?X.items:[];u(K);let Y=V||x;Y&&(Y=K.find(q=>q.fileName===Y?.fileName||q.url===Y?.url)||null),!Y&&e&&(Y=K.find(q=>q.url===e)||null),!Y&&K.length&&(Y=K[0]),g(Y)}catch(X){p(X instanceof Error?X.message:"Failed to load images."),u([])}finally{f(!1)}},_=()=>{l(!0),p(null),y(null),E()},j=V=>{if(V&&V.type.startsWith("image/")){const X=new FileReader;X.onload=K=>{K.target?.result&&t(K.target.result)},X.readAsDataURL(V)}},A=V=>{V.preventDefault(),i(!1);const X=V.dataTransfer.files[0];X&&j(X)},T=V=>{V.preventDefault(),i(!0)},k=()=>{i(!1)},C=async V=>{const X=V.target.files?.[0];if(X){b(!0),y(null);try{const K=await lT(X);t(K.url);const Y=K.fileName?{fileName:K.fileName,url:K.url}:null;g(Y),await E(Y)}catch(K){y(K instanceof Error?K.message:"Upload failed.")}finally{b(!1),V.target.value=""}}},L=()=>{x&&(t(x.url),l(!1))},G=async()=>{if(!(!x||N)){S(!0),p(null);try{await uT(x.fileName),e===x.url&&r(),await E(null)}catch(V){p(V instanceof Error?V.message:"Delete failed.")}finally{S(!1)}}};return o.jsxs("div",{className:"relative h-full",children:[o.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:C,className:"hidden"}),e?o.jsxs("div",{className:"relative h-full rounded-2xl overflow-hidden border border-white/15 bg-slate-950/40 group",children:[o.jsx("img",{src:e,alt:"Product preview",className:"w-full h-full object-cover"}),o.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[o.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 rounded-lg bg-indigo-500 text-white font-semibold hover:bg-indigo-600 transition-colors",children:"Chọn từ Server"}),o.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-red-500 text-white font-semibold hover:bg-red-600 transition-colors",children:"Xóa"})]})]}):o.jsxs("div",{onClick:_,onDrop:A,onDragOver:T,onDragLeave:k,className:`h-full rounded-2xl border-2 border-dashed cursor-pointer transition-all flex flex-col items-center justify-center gap-4 p-6 ${a?"border-indigo-400 bg-indigo-500/20":"border-white/20 bg-slate-950/40 hover:border-indigo-400/60 hover:bg-slate-900/60"}`,children:[o.jsx(RN,{className:"h-16 w-16 text-slate-400"}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-semibold text-white mb-1",children:"Chọn hình ảnh sản phẩm"}),o.jsx("p",{className:"text-xs text-slate-400",children:"Nhấp để chọn từ server hoặc kéo thả file"})]})]}),o.jsx(nK,{open:s,images:c,selectedImage:x,loading:d,uploading:v,deleting:N,error:h,uploadError:w,onClose:()=>l(!1),onSelect:g,onUseSelected:L,onUploadClick:()=>n.current?.click(),onDeleteSelected:G})]})},j2=({label:e,value:t,onChange:r,placeholder:n="Nhập nội dung...",minHeight:a="200px"})=>{const i=m.useRef(null),s=m.useRef(!1);m.useEffect(()=>{i.current&&!s.current&&i.current.innerHTML!==t&&(i.current.innerHTML=t||"")},[t]);const l=()=>{i.current&&(s.current=!0,r(i.current.innerHTML),setTimeout(()=>{s.current=!1},0))},c=(p,x)=>{document.execCommand(p,!1,x),i.current?.focus(),l()},u=p=>{c("formatBlock",p)},d=()=>{const p=prompt("Nhập URL:");p&&c("createLink",p)},f="p-2.5 rounded-lg border border-white/10 bg-slate-800/60 text-slate-300 hover:bg-slate-700/80 hover:text-white hover:border-white/20 transition-all flex items-center justify-center min-w-[40px]";return o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:e}),o.jsxs("div",{className:"flex flex-wrap gap-2 p-3 rounded-xl border border-white/10 bg-slate-950/40",children:[o.jsxs("select",{onChange:p=>{p.target.value&&(u(p.target.value),p.target.value="")},className:"px-3 py-2 rounded-lg border border-white/10 bg-slate-800/60 text-slate-300 text-sm hover:bg-slate-700/80 hover:border-white/20 transition-all cursor-pointer min-w-[140px]",defaultValue:"",children:[o.jsx("option",{value:"",disabled:!0,children:"Định dạng tiêu đề"}),o.jsx("option",{value:"h1",children:"H1 - Tiêu đề chính"}),o.jsx("option",{value:"h2",children:"H2 - Tiêu đề phụ"}),o.jsx("option",{value:"h3",children:"H3 - Tiêu đề cấp 3"}),o.jsx("option",{value:"h4",children:"H4 - Tiêu đề cấp 4"}),o.jsx("option",{value:"h5",children:"H5 - Tiêu đề cấp 5"}),o.jsx("option",{value:"h6",children:"H6 - Tiêu đề cấp 6"}),o.jsx("option",{value:"p",children:"Đoạn văn bản"})]}),o.jsx("div",{className:"w-px h-10 bg-white/10"}),o.jsx("button",{type:"button",onClick:()=>c("bold"),className:f,title:"Bold (Ctrl+B)",children:o.jsx(bC,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>c("italic"),className:f,title:"Italic (Ctrl+I)",children:o.jsx(HC,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>c("underline"),className:f,title:"Underline (Ctrl+U)",children:o.jsx(ck,{className:"h-4 w-4"})}),o.jsx("div",{className:"w-px h-10 bg-white/10"}),o.jsx("button",{type:"button",onClick:()=>c("insertUnorderedList"),className:f,title:"Danh sách không thứ tự",children:o.jsx(KC,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>c("insertOrderedList"),className:f,title:"Danh sách có thứ tự",children:o.jsx(gC,{className:"h-4 w-4"})}),o.jsx("div",{className:"w-px h-10 bg-white/10"}),o.jsx("button",{type:"button",onClick:d,className:f,title:"Chèn liên kết",children:o.jsx(WC,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",onClick:()=>u("blockquote"),className:f,title:"Trích dẫn",children:o.jsx(EC,{className:"h-4 w-4"})}),o.jsx("div",{className:"w-px h-10 bg-white/10"}),o.jsx("button",{type:"button",onClick:()=>c("removeFormat"),className:`${f} text-red-400 hover:text-red-300`,title:"Xóa định dạng",children:o.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("div",{ref:i,contentEditable:!0,onInput:l,className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all overflow-y-auto prose prose-invert prose-headings:text-white prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg prose-h4:text-base prose-h5:text-sm prose-h6:text-xs prose-p:text-sm prose-a:text-indigo-400 prose-blockquote:border-l-4 prose-blockquote:border-indigo-500 prose-blockquote:pl-4 prose-blockquote:italic max-w-none",style:{minHeight:a},"data-placeholder":n}),o.jsx("style",{children:`
        [contentEditable][data-placeholder]:empty:before {
          content: attr(data-placeholder);
          color: rgb(148 163 184);
          pointer-events: none;
        }
        
        /* SEO-friendly heading styles */
        [contentEditable] h1 {
          font-size: 1.5rem;
          font-weight: 700;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.2;
        }
        
        [contentEditable] h2 {
          font-size: 1.25rem;
          font-weight: 700;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.3;
        }
        
        [contentEditable] h3 {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.4;
        }
        
        [contentEditable] h4 {
          font-size: 1rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] h5 {
          font-size: 0.875rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] h6 {
          font-size: 0.75rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] p {
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] blockquote {
          border-left: 4px solid rgb(99 102 241);
          padding-left: 1rem;
          font-style: italic;
          color: rgb(203 213 225);
          margin: 0.5rem 0;
        }
        
        [contentEditable] ul, [contentEditable] ol {
          margin: 0.5rem 0;
          padding-left: 1.5rem;
        }
        
        [contentEditable] li {
          margin: 0.25rem 0;
        }
        
        [contentEditable] a {
          color: rgb(129 140 248);
          text-decoration: underline;
        }
        
        [contentEditable] a:hover {
          color: rgb(165 180 252);
        }
      `})]})},iK=({product:e,saving:t,onClose:r,onSave:n})=>{const a=m.useMemo(()=>({productId:Rt(e?.productId||""),productName:Rt(e?.packageProduct||e?.productName||"")||"",packageName:e?.packageName||"",shortDescription:e?.shortDescription||"",rules:e?.rules||"",rulesHtml:e?.rulesHtml||Jr(e?.rules||""),description:e?.description||"",descriptionHtml:e?.descriptionHtml||Jr(e?.description||""),imageUrl:e?.imageUrl||"",priceId:e?.priceId??null}),[e]),[i,s]=m.useState(a);m.useEffect(()=>{e&&s(a)},[a,e]);const l=()=>{n(i)};if(!e)return null;const c="w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",u="text-xs font-semibold text-slate-300 uppercase tracking-wide";return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:o.jsxs("div",{className:"relative flex w-full max-w-7xl flex-col rounded-[32px] border border-white/20 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl max-h-[95vh] overflow-hidden",children:[o.jsx("button",{onClick:r,className:"absolute right-6 top-6 z-10 rounded-full bg-slate-800/80 p-2 text-slate-400 backdrop-blur-sm transition-all hover:bg-slate-700 hover:text-white","aria-label":"Close",children:o.jsx(Pt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto px-4 py-6 sm:px-6 sm:py-8",children:[o.jsx("div",{className:"text-center",children:o.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Chỉnh sửa thông tin sản phẩm"})}),o.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[o.jsxs("div",{className:"lg:col-span-1 space-y-5",children:[o.jsx("div",{style:{height:"400px"},children:o.jsx(aK,{imageUrl:i.imageUrl,onImageChange:d=>s(f=>({...f,imageUrl:d})),onImageRemove:()=>s(d=>({...d,imageUrl:""}))})}),o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-sm backdrop-blur-sm",children:[o.jsx("h3",{className:"mb-4 text-lg font-semibold text-white",children:"Thông Tin Cơ Bản"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:u,children:"Mã Sản Phẩm"}),o.jsx("input",{type:"text",value:i.productId,onChange:d=>s(f=>({...f,productId:d.target.value})),placeholder:"Nhập mã sản phẩm...",className:c})]}),o.jsxs("div",{children:[o.jsx("label",{className:u,children:"Tên Sản Phẩm"}),o.jsx("input",{type:"text",value:i.productName,onChange:d=>s(f=>({...f,productName:d.target.value})),placeholder:"Nhập tên sản phẩm...",className:c})]}),o.jsxs("div",{children:[o.jsx("label",{className:u,children:"Gói Sản Phẩm"}),o.jsx("input",{type:"text",value:i.packageName,onChange:d=>s(f=>({...f,packageName:d.target.value})),placeholder:"Nhập gói sản phẩm...",className:c})]}),o.jsxs("div",{children:[o.jsx("label",{className:u,children:"Mô Tả Ngắn"}),o.jsx("textarea",{value:i.shortDescription,onChange:d=>s(f=>({...f,shortDescription:d.target.value})),rows:3,placeholder:"Nhập mô tả ngắn về sản phẩm...",className:c})]})]})]})]}),o.jsx("div",{className:"lg:col-span-2 space-y-5",children:o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-sm backdrop-blur-sm space-y-4",children:[o.jsx(j2,{label:"Quy Tắc Sản Phẩm",value:i.rulesHtml||"",onChange:d=>{s(f=>({...f,rulesHtml:d,rules:d.replace(/<[^>]*>/g,"")}))},placeholder:"Nhập quy tắc sản phẩm...",minHeight:"150px"}),o.jsx(j2,{label:"Mô Tả Sản Phẩm",value:i.descriptionHtml||"",onChange:d=>{s(f=>({...f,descriptionHtml:d,description:d.replace(/<[^>]*>/g,"")}))},placeholder:"Nhập mô tả chi tiết sản phẩm...",minHeight:"200px"})]})})]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur-sm",children:[o.jsx("button",{type:"button",onClick:r,disabled:t,className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",children:"Hủy bỏ"}),o.jsx("button",{type:"button",onClick:l,disabled:t,className:"rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-3 font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:t?"Đang Lưu...":"Lưu thay đổi"})]})]})]})})},ka=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],sK=(e,t)=>{if(e.color)return e.color;const r=Number(e.id);return Number.isFinite(r)?ka[Math.abs(r)%ka.length]:ka[t%ka.length]},oK=(e,t)=>t||(Number.isFinite(e)?ka[Math.abs(e)%ka.length]:ka[0]),lK=({reloadCategories:e})=>{const[t,r]=m.useState(!1),[n,a]=m.useState(""),[i,s]=m.useState(ka[0]),[l,c]=m.useState(!1),[u,d]=m.useState(null),f=m.useCallback(()=>{r(!0),d(null),a(""),s(ka[0])},[]),h=m.useCallback(()=>{r(!1),c(!1),d(null),a("")},[]),p=m.useCallback(async()=>{const x=n.trim();if(!x){d("Category name is required.");return}c(!0),d(null);try{const g=await Ue("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x,color:(i||"").trim()||null})});if(!g.ok){const v=await g.text().catch(()=>"");throw new Error(v||`Failed to create category (${g.status}).`)}await g.json().catch(()=>null),await e(),r(!1),a("")}catch(g){d(Wr(g instanceof Error?g.message:String(g??""),{fallback:"Cannot create category."}))}finally{c(!1)}},[n,i,e]);return{createCategoryOpen:t,newCategoryName:n,setNewCategoryName:a,newCategoryColor:i,setNewCategoryColor:s,creatingCategory:l,createCategoryError:u,openCreateCategory:f,closeCreateCategory:h,handleCreateCategory:p}},dT=async(e,t)=>{const r=await Ue(`/api/product-prices/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!r.ok){const n=await r.text();throw new Error(Wr(n,{fallback:"Cannot update product categories."}))}return r.json().catch(()=>({}))},cK=async e=>{const t=await Ue(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(Wr(n,{fallback:"Không thể xóa sản phẩm khỏi bảng giá.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},uK=({categoryOptions:e,reloadProducts:t,onOpenEdit:r})=>{const[n,a]=m.useState(null),[i,s]=m.useState(""),[l,c]=m.useState(""),[u,d]=m.useState([]),[f,h]=m.useState(!1),[p,x]=m.useState(null),g=m.useCallback(y=>{a(y),s(y.packageName||""),c(y.imageUrl||"");const N=(y.categories||[]).map(S=>Number(S.id)).filter(S=>Number.isFinite(S));d(Array.from(new Set(N))),x(null),r&&r()},[r]),v=m.useCallback(()=>{a(null),h(!1),x(null)},[]),b=m.useCallback(y=>{d(N=>N.includes(y)?N.filter(S=>S!==y):[...N,y])},[]),w=m.useCallback(async()=>{if(!n)return;const y=n.items.find(_=>Number.isFinite(Number(_.priceId)))||n.items.find(_=>Number.isFinite(Number(_.id))),N=y?Number(y.priceId??y.id):null;if(!N){x("Missing product id for update.");return}h(!0),x(null);const S=i.trim(),E=u.reduce((_,j)=>{const A=e.find(T=>T.id===j);return _[j]=oK(j,A?.color??null),_},{});try{await dT(N,{packageName:S,categoryIds:u,categoryColors:E,imageUrl:l.trim()||null}),await t(),a(null)}catch(_){x(Wr(_ instanceof Error?_.message:String(_??""),{fallback:"Cannot update category."}))}finally{h(!1)}},[n,i,l,u,e,t]);return{editingCategoryGroup:n,categoryPackageName:i,setCategoryPackageName:s,categoryImageUrl:l,setCategoryImageUrl:c,selectedCategoryIds:u,categorySaving:f,categorySaveError:p,openCategoryEdit:g,closeCategoryEdit:v,handleToggleCategory:b,handleSaveCategory:w}},dK=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(!1),[a,i]=m.useState(null),s=m.useRef(!0);m.useEffect(()=>()=>{s.current=!1},[]);const l=m.useCallback(async()=>{if(s.current){n(!0),i(null);try{const c=await Ue("/api/categories");if(!c.ok){const f=await c.text().catch(()=>"");throw new Error(f||`Failed to load categories (${c.status}).`)}const u=await c.json().catch(()=>[]);if(!s.current)return;const d=Array.isArray(u)?u:[];d.sort((f,h)=>String(f?.name||"").localeCompare(String(h?.name||""),"vi",{sensitivity:"base"})),t(d)}catch(c){if(!s.current)return;t([]),i(Wr(c instanceof Error?c.message:String(c??""),{fallback:"Cannot load categories."}))}finally{s.current&&n(!1)}}},[]);return m.useEffect(()=>{l()},[l]),{categoryOptions:e,loading:r,error:a,reload:l}},fK=async e=>{const t=await Ue("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(Wr(n,{fallback:"Không thể lưu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phản hồi không hợp lệ từ server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},hK=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Ue(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(Wr(l,{fallback:"Không thể tải thông tin sản phẩm."}))}const a=await n.json().catch(()=>null);if(!a||!Array.isArray(a.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const i=typeof a.count=="number"&&Number.isFinite(a.count)?a.count:a.items.length,s=typeof a.total=="number"&&Number.isFinite(a.total)?a.total:i;return{...a,count:i,total:s,offset:typeof a.offset=="number"&&Number.isFinite(a.offset)?a.offset:e.offset??0,limit:typeof a.limit=="number"&&Number.isFinite(a.limit)?a.limit:e.limit??a.items.length}},pK=({setProductDescs:e,setError:t,reloadProducts:r})=>{const[n,a]=m.useState(null),[i,s]=m.useState(!1),l=m.useCallback(f=>{a(f)},[]),c=m.useCallback(()=>{a(null),s(!1)},[]),u=m.useCallback(()=>{a(null)},[]),d=m.useCallback(async f=>{if(!n)return;s(!0);const h={productId:f.productId.trim()||n.productId||"",rules:f.rulesHtml||f.rules,description:f.descriptionHtml||f.description,imageUrl:f.imageUrl||null};try{const p=await fK(h),x=f.priceId??n.priceId;x&&Number.isFinite(x)&&await dT(x,{packageName:f.packageName.trim()||null,packageProduct:f.productName.trim()||null});const g=p.rulesHtml||p.rules||f.rulesHtml||f.rules||"",v=p.descriptionHtml||p.description||f.descriptionHtml||f.description||"",b={...n,id:p.id||n.id,productId:p.productId,productName:Rt(f.productName||n.productName||"")||n.productName,packageName:f.packageName||n.packageName,rules:p.rules||"",rulesHtml:g,description:p.description||"",descriptionHtml:v,imageUrl:p.imageUrl||f.imageUrl||null};e(w=>{const y=Rt(p.productId||n.productId||"").toLowerCase(),N=w.findIndex(E=>Rt(E.productId||"").toLowerCase()===y);if(N===-1)return[...w,{id:p.id||n.id,productId:p.productId,productName:b.productName||null,rules:p.rules||"",rulesHtml:g,description:p.description||"",descriptionHtml:v,imageUrl:p.imageUrl||null}];const S=[...w];return S[N]={...S[N],id:p.id||S[N].id,productId:p.productId,productName:b.productName||S[N].productName||null,rules:p.rules||"",rulesHtml:g,description:p.description||"",descriptionHtml:v,imageUrl:p.imageUrl||null},S}),a(null),await r()}catch(p){t(Wr(p instanceof Error?p.message:String(p??""),{fallback:"Không thể lưu thông tin sản phẩm."}))}finally{s(!1)}},[n,e,t,r]);return{editingProduct:n,editSaving:i,openEditForm:l,closeEditForm:c,handleSaveEdit:d,clearEditingProduct:u}},mK=()=>{const[e,t]=m.useState(null),[r,n]=m.useState(1),[a,i]=m.useState([]),[s,l]=m.useState([]),[c,u]=m.useState(""),[d,f]=m.useState(!1),[h,p]=m.useState(null),x=m.useMemo(()=>FV(a,s,c),[a,s,c]),g=m.useMemo(()=>Math.max(1,Math.ceil(x.length/Hc)),[x.length]),v=m.useMemo(()=>{const y=(r-1)*Hc,N=y+Hc;return x.slice(y,N)},[x,r]),b=m.useCallback(async()=>{f(!0),p(null);try{const[y,N]=await Promise.all([hK({}),Ue("/api/products")]),S=await N.json().catch(()=>[]);i(Array.isArray(y.items)?y.items:[]),l(Array.isArray(S)?S:[])}catch(y){i([]),l([]),p(Wr(y instanceof Error?y.message:String(y??""),{fallback:"Không thể tải danh sách sản phẩm."}))}finally{f(!1)}},[]);return m.useEffect(()=>{b()},[b]),m.useEffect(()=>{r>g&&n(g)},[r,g]),{data:{mergedProducts:x,pagedProducts:v,loading:d,error:h,currentPage:r,totalPages:g,expandedId:e,searchTerm:c},actions:{handleSearchChange:y=>{u(y),n(1)},setCurrentPage:n,setExpandedId:t,reload:b,setProductDescs:i,setError:p}}},xK=e=>{const t=new Map;return e.forEach(r=>{const n=(r.packageName||"").trim();if(!n)return;const a=n;t.has(a)||t.set(a,{key:a,packageName:n,imageUrl:r.packageImageUrl??null,categories:[],items:[]}),t.get(a)?.items.push(r)}),Array.from(t.entries()).map(([,r])=>{const n=new Map;return r.items.forEach(a=>{(a.categories||[]).forEach(i=>{if(!i||!i.name)return;const s=i.id?String(i.id):i.name;n.has(s)||n.set(s,i)})}),{...r,categories:Array.from(n.values()).sort((a,i)=>String(a?.name||"").localeCompare(String(i?.name||""),"vi",{sensitivity:"base"})),items:[...r.items].sort((a,i)=>{const s=Rt(a.productId||a.packageProduct||a.productName||""),l=Rt(i.productId||i.packageProduct||i.productName||"");return s.localeCompare(l,"vi",{sensitivity:"base"})})}}).sort((r,n)=>r.packageName.localeCompare(n.packageName,"vi",{sensitivity:"base"}))},gK=()=>{const{data:{mergedProducts:e,pagedProducts:t,loading:r,error:n,currentPage:a,expandedId:i,searchTerm:s},actions:{handleSearchChange:l,setCurrentPage:c,setExpandedId:u,reload:d,setProductDescs:f,setError:h}}=mK(),[p,x]=m.useState("products"),{categoryOptions:g,loading:v,error:b,reload:w}=dK(),{editingProduct:y,editSaving:N,openEditForm:S,closeEditForm:E,handleSaveEdit:_,clearEditingProduct:j}=pK({setProductDescs:f,setError:h,reloadProducts:d}),{editingCategoryGroup:A,categoryPackageName:T,setCategoryPackageName:k,categoryImageUrl:C,setCategoryImageUrl:L,selectedCategoryIds:G,categorySaving:V,categorySaveError:X,openCategoryEdit:K,closeCategoryEdit:Y,handleToggleCategory:q,handleSaveCategory:Z}=uK({categoryOptions:g,reloadProducts:d,onOpenEdit:j}),{createCategoryOpen:le,newCategoryName:ce,setNewCategoryName:me,newCategoryColor:Ne,setNewCategoryColor:ee,creatingCategory:oe,createCategoryError:fe,openCreateCategory:O,closeCreateCategory:I,handleCreateCategory:F}=lK({reloadCategories:w}),M=m.useMemo(()=>xK(e),[e]);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thông Tin Sản Phẩm"}),o.jsx("p",{className:"text-sm text-white/70",children:"Đồng bộ với bảng product_desc trong database."})]}),o.jsx(DV,{searchTerm:s,onSearchChange:l,onAddCategoryClick:O}),n&&o.jsx("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),o.jsx(IV,{viewMode:p,onViewModeChange:x}),p==="products"?o.jsx(HV,{products:t,mergedTotal:e.length,loading:r,currentPage:a,pageSize:Hc,onPageChange:c,expandedId:i,onToggleExpand:u,onEdit:S}):o.jsx(WV,{categoryRows:M,loading:r,onEditCategory:K,getCategoryColor:sK}),le&&o.jsx(VV,{open:le,name:ce,color:Ne,saving:oe,error:fe,onNameChange:me,onColorChange:ee,onClose:I,onSave:F}),A&&o.jsx(rK,{open:!!A,packageName:T,imageUrl:C,categoryOptions:g,selectedCategoryIds:G,saving:V||v,error:X||b,onPackageNameChange:k,onImageUrlChange:L,onToggleCategory:q,onClose:Y,onSave:Z,onCategoriesReload:w}),y&&o.jsx(iK,{product:y,saving:N,onClose:E,onSave:_})]})},vK=({searchTerm:e,statusFilter:t,isLoading:r,isRefreshing:n,error:a,onSearchChange:i,onStatusChange:s,onRefresh:l,onAddProduct:c})=>o.jsxs("div",{className:"pricing-filters space-y-4",children:[o.jsx("div",{className:"pricing-filters__panel rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsxs("div",{className:"pricing-filters__row flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"pricing-filters__search relative w-full lg:flex-1",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:"Tìm Kiếm Sản Phẩm...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:u=>i(u.target.value)})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx("div",{className:"relative w-full lg:w-[170px]",children:o.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:t,onChange:u=>s(u.target.value),children:[o.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Trạng Thái"}),o.jsx("option",{value:"active",className:"bg-slate-900 text-white",children:"Đang Hoạt Động"}),o.jsx("option",{value:"inactive",className:"bg-slate-900 text-white",children:"Tạm Dừng"})]})}),o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx(An,{onClick:c,className:"!py-2.5 !px-5 text-sm",children:"Thêm Sản Phẩm"}),o.jsx("button",{type:"button",onClick:l,disabled:r||n,className:`px-5 py-2.5 rounded-2xl text-sm font-semibold transition-all border ${r||n?"bg-white/5 text-white/30 border-white/5 cursor-not-allowed":"bg-white/5 text-white border-white/10 hover:bg-white/10"}`,children:r||n?"Đang Đồng Bộ...":"Đồng Bộ Lại"})]})]})}),a&&o.jsx("div",{className:"mt-6 rounded-2xl border border-rose-500/20 bg-rose-500/10 px-5 py-3 text-sm text-rose-200 backdrop-blur-md shadow-xl animate-in fade-in slide-in-from-top-2",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-rose-500 animate-pulse"}),o.jsx("span",{children:a})]})})]}),bK=({stats:e})=>o.jsx("div",{className:"pricing-stats space-y-4",children:o.jsx("div",{className:"pricing-stats__panel rounded-[32px] border border-white/5 bg-gradient-to-br from-indigo-500/10 via-purple-500/5 to-slate-900/40 p-6 shadow-2xl backdrop-blur-xl",children:o.jsx("div",{className:"pricing-stats__grid grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(t=>o.jsx(Ta,{title:t.name,value:t.value,icon:t.icon,subtitle:t.subtitle,accent:vr[t.accent]},t.name))})})}),Gp=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),Xp=0,hh=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},Hu=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},T2=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),yK=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",wK=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Tháng`},NK=(e,t)=>{const r=wK(t);return e&&r?`${e} ${r}`:e||r||yK(t)||"Không Xác Định"},ti=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},_K=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},SK=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t))return null;const r=t>1?t/100:t;return r<0||r>=1?null:1-r},hl=(e,t,r)=>typeof e!="number"||!Number.isFinite(e)||e<Xp||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?!1:SK(t,e)!==null,EK=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",jK=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${EK(r.sourceName)}`,a=t.get(n);if(!a){t.set(n,r);continue}const i=a.price??Number.POSITIVE_INFINITY,s=r.price??Number.POSITIVE_INFINITY,l=Date.parse(a.lastOrderDate??"")||0,c=Date.parse(r.lastOrderDate??"")||0;(s<i||s===i&&c>l)&&t.set(n,r)}return Array.from(t.values())},wc=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(n!==a)return n-a;const i=Date.parse(t.lastOrderDate??"")||0,s=Date.parse(r.lastOrderDate??"")||0;return i!==s?s-i:t.sourceName.localeCompare(r.sourceName)}),Os=(e,t)=>`${e}-${t}`,pl=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,fT=(e,t)=>pl(t,e),hT=(e,t,r,n,a)=>{const i=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof a=="number"&&Number.isFinite(a)&&a>0&&a||null;if(i===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!hl(t,e,r))return null;const s=t>1?t/100:t,l=e&&e>1?e:e||1,c=i*l,u=c-c*s;return Math.min(c,Math.max(i,u))},$o=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=fT(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,a=pl(n??t,e.pctKhach),i=hT(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.retailPrice,promoPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.promoPrice}},Yp=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},qp=e=>{if(e==null)return"";const t=typeof e=="number"&&Number.isFinite(e)?Math.round(e):e,r=String(t).replace(/\D+/g,"");if(!r)return"";const n=Number(r);return Number.isFinite(n)?new Intl.NumberFormat("vi-VN").format(n):""},jn=e=>{if(e==null)return null;const t=e.toString().replace(",",".").trim();return t?ti(t):null},zu=({multiplier:e,price:t,basePrice:r})=>"",Fr=e=>{const t=Hu(e);return t===null||t<=0?"-":Gp.format(t)},zc=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},pT=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},Hs=e=>(e||"").trim(),C2=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=Hu(e)??0;return t===0?Gp.format(0):Gp.format(t)},TK=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,a=typeof r=="number"&&Number.isFinite(r)?r-e:null,i=C2(n),s=C2(a);return`${i} - ${s}`},Wu=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},CK=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(a<n)return r;if(a>n)return t;const i=Wu(t.lastOrderDate);return Wu(r.lastOrderDate)>i?r:t},null):null,ri=(e,t)=>{const r=e.reduce((n,a)=>{const i=typeof a.price=="number"&&Number.isFinite(a.price)?a.price:Number.NEGATIVE_INFINITY;return i>n?i:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},mT=(e,t)=>{const r=T2(e?.[zt.packageName]??e?.package_label),n=T2(e?.[zt.variantName]??e?.package_product_label),a=(e?.[zt.code]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Không xác định",packageProduct:n,sanPhamRaw:a,variantLabel:NK(n,a),pctCtv:ti(e?.[zt.pctCtv]),pctKhach:ti(e?.[zt.pctKhach]),pctPromo:ti(e?.[zt.pctPromo]),isActive:_K(e?.[zt.isActive]),baseSupplyPrice:ti(e?.max_supply_price),wholesalePrice:ti(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:ti(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:ti(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[zt.updatedAt]=="string"?e[zt.updatedAt]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:typeof e?.update=="string"?e.update:null}},kK=({item:e,productKey:t,isExpanded:r,statusOverride:n,updatedTimestamp:a,supplyState:i,pendingNewSupply:s,supplierOptions:l,isLoadingSuppliers:c,editingProductId:u,productEditForm:d,productEditError:f,isSavingProductEdit:h,isDeletingProduct:p,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:w,onStartProductEdit:y,onProductEditChange:N,onCancelProductEdit:S,onSubmitProductEdit:E,onRequestDeleteProduct:_,onStartEditingSupply:j,onSupplyInputChange:A,onCancelSupplyEditing:T,onConfirmSupplyEditing:k,onStartAddSupplierRow:C,onNewSupplierInputChange:L,onCancelAddSupplierRow:G,onConfirmAddSupplierRow:V,onDeleteSupplyRow:X,onToggleStatus:K,fetchSupplyPricesForProduct:Y})=>{const q=i?.items??[],Z=s??null,le=CK(q),ce=le?.price??e.baseSupplyPrice,me=le?.sourceName??"-",Ne=ri(q,e.baseSupplyPrice),ee=[...q.map(ve=>({kind:"existing",supplier:ve})),...Z?[{kind:"new"}]:[]],oe=n??e.isActive??!1,fe=a??e.lastUpdated??"",O=fe?pT(fe):"-",I=hl(e.pctPromo,e.pctKhach,e.pctCtv),F=u===e.id,M=F?d:null,W=M?{pctCtv:jn(M.pctCtv),pctKhach:jn(M.pctKhach),pctPromo:jn(M.pctPromo)}:null,J=W?fT(W.pctCtv,Ne):null,se=typeof J=="number"&&Number.isFinite(J)&&J>0?J:Ne,ke=W?pl(se,W.pctKhach):null,ye=W?hT(W.pctKhach,W.pctPromo,W.pctCtv,J,Ne):null,Pe=zc(W?.pctPromo??null),ue=hl(W?.pctPromo??null,W?.pctKhach??null,W?.pctCtv??null)&&Number.isFinite(ye??NaN),Be=typeof Ne=="number"&&Number.isFinite(Ne)&&Ne>0?Fr(Ne):"Chưa có dữ liệu",Ve=()=>{Y(e.sanPhamRaw)};return o.jsxs(la.Fragment,{children:[o.jsxs("tr",{className:"hidden md:table-row cursor-pointer bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 transition hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70",onClick:()=>w(e),children:[o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(dm,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${r?"rotate-180":""}`}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold text-white",children:e.packageName}),o.jsx("div",{className:"text-xs text-white/70",children:e.variantLabel})]})]})}),o.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[o.jsx("div",{className:"text-sm font-semibold text-white",children:Fr(e.wholesalePrice)}),o.jsx("div",{className:"text-xs text-white/70",children:zu({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),o.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[o.jsx("div",{className:"text-sm font-semibold text-amber-300",children:Fr(e.retailPrice)}),o.jsx("div",{className:"text-xs text-white/70",children:zu({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:I?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-pink-200",children:Fr(e.promoPrice)}),o.jsx("div",{className:"text-xs text-white/70",children:zc(e.pctPromo)??"-"})]}):o.jsx("div",{className:"text-sm text-white/60",children:"-"})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsx("div",{className:"flex flex-col items-center",children:o.jsx("button",{type:"button",onClick:ve=>{ve.stopPropagation(),K(e)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${oe?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":oe,children:o.jsx(fd,{className:"h-4 w-4"})})})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsx("div",{className:"text-sm text-white",children:O})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:ve=>y(ve,e),children:o.jsx(ca,{className:"h-4 w-4"})}),o.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${p?"cursor-not-allowed opacity-60":""}`,onClick:ve=>_(ve,e),disabled:p,children:o.jsx(Kr,{className:"h-4 w-4"})})]})})]}),F&&M&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-2 md:px-6 pb-4 md:pb-6",children:o.jsxs("div",{className:"space-y-4 md:space-y-6 rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-3 py-4 md:px-6 md:py-5 text-white shadow-lg",children:[o.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3 md:p-5 shadow-lg",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thông Tin Sản Phẩm"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tên sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:M.packageName,onChange:ve=>N("packageName",ve.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Gói sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:M.packageProduct,onChange:ve=>N("packageProduct",ve.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Mã sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:M.sanPham,onChange:ve=>N("sanPham",ve.target.value)})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3 md:p-5 shadow-lg",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"Tỷ giá"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá CTV"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:M.pctCtv,onChange:ve=>N("pctCtv",ve.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khách"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:M.pctKhach,onChange:ve=>N("pctKhach",ve.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khuyến mãi"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:M.pctPromo,onChange:ve=>N("pctPromo",ve.target.value)})]})]})]})]}),M&&o.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-3 md:p-4 shadow-lg backdrop-blur",children:[o.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[o.jsx("span",{children:"Giá dự kiến theo tỉ giá"}),o.jsxs("span",{className:"font-medium normal-case text-amber-200",children:["Giá nguồn cao nhất:"," ",o.jsx("span",{className:"font-semibold",children:Be})]})]}),o.jsxs("div",{className:`mt-3 md:mt-4 grid gap-2 md:gap-3 text-center text-sm grid-cols-2 ${ue?"md:grid-cols-3":"md:grid-cols-2"}`,children:[o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Sỉ dự kiến"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(J)}),o.jsx("p",{className:"text-[11px] text-white/70",children:M.pctCtv?`Tỷ Giá: ${M.pctCtv}`:"Nhập tỉ giá CTV"})]}),o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Khách dự kiến"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(ke)}),o.jsx("p",{className:"text-[11px] text-white/70",children:M.pctKhach?`Tỷ Giá: ${M.pctKhach}`:"Nhập tỉ giá khách"})]}),ue&&o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Khuyến mãi dự kiến"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(ye)}),o.jsx("p",{className:"text-[11px] text-white/70",children:Pe??"Nhập tỉ giá khuyến mãi"})]})]})]}),f&&o.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:f}),o.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[o.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-4 md:px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:S,disabled:h,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-4 md:px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:E,disabled:h,children:h?"Đang Lưu...":"Lưu thay đổi"})]})]})})}),r&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-2 md:px-6 pb-4 md:pb-6",children:o.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 p-2 md:p-4 text-white",children:o.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-3 py-4 md:px-6 md:py-5 text-white shadow-lg",children:[o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiết giá sản phẩm"})}),o.jsxs("div",{className:`grid gap-2 md:gap-4 text-center grid-cols-2 ${I?"md:grid-cols-4":"md:grid-cols-3"}`,children:[o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá nguồn thấp nhất"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(ce)}),o.jsx("p",{className:"text-[10px] md:text-xs text-white/70 truncate max-w-full",children:me})]}),o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá sỉ hiện tại"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(e.wholesalePrice)})]}),o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá khách hiện tại"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(e.retailPrice)})]}),I&&o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[o.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá KM hiện tại"}),o.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Fr(e.promoPrice)}),o.jsx("p",{className:"text-[10px] md:text-xs text-white/70",children:zc(e.pctPromo)??"-"})]})]}),o.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/15",children:[o.jsx("div",{className:"flex justify-end border-b border-white/10 bg-white/5 px-4 py-2",children:o.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>C(e.id),disabled:!!Z,children:[o.jsx(hm,{className:"h-4 w-4"}),"Thêm nguồn"]})}),o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-white/5 text-[11px] uppercase tracking-wide text-white/70",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-2 md:px-4 py-2 text-left",children:"NCC"}),o.jsx("th",{className:"px-2 md:px-4 py-2 text-center",children:"Giá nhập"}),o.jsx("th",{className:"hidden md:table-cell px-4 py-2 text-center",children:"Lợi nhuận"}),o.jsx("th",{className:"px-2 md:px-4 py-2 text-center",children:"Thao tác"})]})}),o.jsx("tbody",{children:i?.loading?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Đang Tải Dữ Liệu"})}):i?.error?o.jsx("tr",{children:o.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white",children:[o.jsx("span",{children:i.error})," ",o.jsx("button",{type:"button",className:"text-xs text-red-400 hover:text-red-200 hover:underline",onClick:Ve,children:"Thử Lại"})]})}):q.length===0&&ee.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Chưa có dữ liệu từ NCC"})}):ee.map(ve=>{if(ve.kind==="existing"&&ve.supplier){const we=ve.supplier,he=Os(e.id,we.sourceId),Te=x[he]??!1,pe=v[he]??!1,We=g[he]??(we.price??"").toString();b[he];const Oe=!Te||pe,Ae=Fr(we.price);return o.jsxs("tr",{className:"border-t border-dashed border-white/10",children:[o.jsx("td",{className:"px-2 md:px-4 py-3",children:o.jsx("div",{className:"text-xs md:text-sm font-semibold text-white truncate max-w-[80px] md:max-w-none",children:we.sourceName})}),o.jsx("td",{className:"px-2 md:px-4 py-3",children:Te?o.jsxs("div",{className:"flex flex-col items-center gap-1",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"text",className:"w-20 md:w-28 rounded-lg border border-white/25 bg-white/5 px-2 py-1 text-center text-xs md:text-sm text-white placeholder:text-white/50 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/30 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:We,onChange:Ye=>A(e.id,we.sourceId,Ye.target.value),disabled:Oe}),o.jsx("span",{className:"text-xs text-white/70",children:"đ"})]}),o.jsx("span",{className:"hidden md:inline text-[11px] text-white/60",children:"Nhập giá mới"})]}):o.jsx("div",{className:"flex justify-center",children:o.jsx("span",{className:"inline-flex min-w-0 md:min-w-[112px] justify-center rounded-lg bg-white/10 px-2 md:px-3 py-1.5 md:py-2 text-xs md:text-sm font-semibold text-white",children:Ae})})}),o.jsx("td",{className:"hidden md:table-cell px-4 py-3 text-center text-xs text-white/70",children:TK(we.price,e.wholesalePrice,e.retailPrice)}),o.jsx("td",{className:"px-2 md:px-4 py-3",children:Te?o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:pe,onClick:()=>k(e.id,we.sourceId,t,e.sanPhamRaw),children:o.jsx(Hn,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:pe,onClick:()=>T(e.id,we.sourceId),children:o.jsx(Pt,{className:"h-4 w-4"})})]}):o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:pe,onClick:()=>j(e.id,we.sourceId,we.price),children:o.jsx(ca,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:pe,onClick:()=>X(e.id,we.sourceId,t,e.sanPhamRaw),children:o.jsx(MN,{className:"h-4 w-4"})})]})})]},he)}if(ve.kind==="new"&&Z){const we=Z,he=we.useCustomName?"__custom__":we.sourceId!==null?`id:${we.sourceId}`:we.sourceName?`name:${we.sourceName}`:"",Te=l.length>0,pe=We=>{const Oe=We.target.value;if(Oe==="__custom__"){L(e.id,"useCustomName",!0),L(e.id,"sourceName",""),L(e.id,"sourceId",null);return}if(L(e.id,"useCustomName",!1),!Oe){L(e.id,"sourceId",null),L(e.id,"sourceName","");return}const Ae=l.find(Ye=>(Ye.id!==null?`id:${Ye.id}`:`name:${Ye.name}`)===Oe);L(e.id,"sourceId",Ae?.id??null),L(e.id,"sourceName",Ae?.name??Oe.replace(/^name:/,"").trim())};return o.jsxs(la.Fragment,{children:[o.jsxs("tr",{className:"border-t border-dashed border-white/15 bg-slate-900/50",children:[o.jsx("td",{className:"px-2 md:px-4 py-3",children:o.jsx("div",{className:"flex flex-col gap-2",children:Te&&!we.useCustomName?o.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-2",children:[o.jsxs("select",{className:"w-full md:w-60 md:max-w-xs rounded-lg border border-white/20 bg-slate-900/80 px-2 md:px-3 py-2 text-xs md:text-sm text-white shadow-sm focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/30 disabled:opacity-60",value:he,onChange:pe,disabled:we.isSaving,children:[o.jsx("option",{value:"",children:c?"Đang tải Nhà Cung Cấp...":"Chọn Nhà Cung Cấp..."}),l.map(We=>{const Oe=We.id!==null?`id:${We.id}`:`name:${We.name}`;return o.jsx("option",{value:Oe,children:We.name},Oe)}),o.jsx("option",{value:"__custom__",children:"Nhập tên Nhà Cung Cấp khác"})]}),o.jsx("button",{type:"button",className:"rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>L(e.id,"useCustomName",!0),disabled:we.isSaving,children:"Nhập"})]}):o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Te&&o.jsxs("button",{type:"button",className:"flex items-center gap-1 rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>L(e.id,"useCustomName",!1),disabled:we.isSaving,children:[o.jsx("span",{className:"text-sm",children:"←"}),o.jsx("span",{className:"sr-only",children:"Chọn từ danh sách"})]}),o.jsx("input",{type:"text",className:"w-60 max-w-xs rounded-lg border border-indigo-300/60 bg-white/95 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200",placeholder:"Tên NCC",value:we.sourceName,onChange:We=>L(e.id,"sourceName",We.target.value),disabled:we.isSaving})]})})}),o.jsx("td",{className:"px-2 md:px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("input",{type:"text",className:"w-20 md:w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-xs md:text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Giá nhập",value:we.price,onChange:We=>L(e.id,"price",We.target.value),disabled:we.isSaving}),o.jsx("span",{className:"text-xs text-white/70",children:"đ"})]})}),o.jsx("td",{className:"hidden md:table-cell px-4 py-3 text-center text-xs text-white/70",children:"-"}),o.jsx("td",{className:"px-2 md:px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>V(e),children:o.jsx(Hn,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>G(e.id),children:o.jsx(Pt,{className:"h-4 w-4"})})]})})]}),we.error&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:we.error})})]},`new-${e.id}`)}return null})})]})]})]})})})})]})},k2=la.memo(kK),AK=({item:e,isExpanded:t,statusOverride:r,updatedTimestamp:n,isDeletingProduct:a,onToggleProductDetails:i,onStartProductEdit:s,onRequestDeleteProduct:l,onToggleStatus:c})=>{const u=r??e.isActive??!1,d=n??e.lastUpdated??"",f=d?pT(d):"-",h=hl(e.pctPromo,e.pctKhach,e.pctCtv);return o.jsxs("div",{className:"price-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50 cursor-pointer",onClick:()=>i(e),children:[o.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${u?"bg-emerald-500":"bg-slate-500"}`}),o.jsxs("div",{className:"relative z-10 flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex items-start gap-2 min-w-0 flex-1",children:[o.jsx(dm,{className:`mt-0.5 h-4 w-4 shrink-0 text-white/60 transition-transform ${t?"rotate-180":""}`}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("h3",{className:"text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:e.packageName}),e.variantLabel&&o.jsx("p",{className:"text-[10px] text-white/60 mt-1 truncate",children:e.variantLabel})]})]}),o.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),c(e)},className:`relative shrink-0 flex h-8 w-8 items-center justify-center rounded-full border-2 shadow-inner transition ${u?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":u,children:o.jsx(fd,{className:"h-3.5 w-3.5"})})]}),o.jsxs("div",{className:`grid gap-2 ${h?"grid-cols-3":"grid-cols-2"}`,children:[o.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"Giá Sỉ"}),o.jsx("p",{className:"text-[13px] font-bold text-white tabular-nums",children:Fr(e.wholesalePrice)}),o.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:zu({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),o.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"Giá Lẻ"}),o.jsx("p",{className:"text-[13px] font-bold text-amber-300 tabular-nums",children:Fr(e.retailPrice)}),o.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:zu({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),h&&o.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[o.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"KM"}),o.jsx("p",{className:"text-[13px] font-bold text-pink-200 tabular-nums",children:Fr(e.promoPrice)}),o.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:zc(e.pctPromo)??"-"})]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-1",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-0.5",children:"Cập nhật"}),o.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:f})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:p=>{p.stopPropagation(),s(p,e)},title:"Sửa",children:o.jsx(ca,{className:"h-5 w-5"})}),o.jsx("button",{className:`w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90 ${a?"cursor-not-allowed opacity-60":""}`,onClick:p=>{p.stopPropagation(),l(p,e)},disabled:a,title:"Xóa",children:o.jsx(Kr,{className:"h-5 w-5"})})]})]})]})]})},PK=({items:e,totalRows:t,currentPage:r,rowsPerPage:n,onPageChange:a,onRowsPerPageChange:i,isLoading:s,error:l,expandedProductId:c,supplyPriceMap:u,statusOverrides:d,updatedTimestampMap:f,supplierOptions:h,isLoadingSuppliers:p,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,newSupplyRows:w,editingProductId:y,productEditForm:N,productEditError:S,isSavingProductEdit:E,deleteProductState:_,onToggleProductDetails:j,onStartProductEdit:A,onProductEditChange:T,onCancelProductEdit:k,onSubmitProductEdit:C,onRequestDeleteProduct:L,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:me,fetchSupplyPricesForProduct:Ne})=>{const ee=Math.max(1,Math.ceil(t/n)),oe=Math.min(Math.max(r,1),ee),fe=[10,20,50],O=la.useMemo(()=>{const J=(Pe,ue)=>{Pe>=1&&Pe<=ee&&ue.add(Pe)},se=new Set([1,ee]);J(oe-1,se),J(oe,se),J(oe+1,se),oe<=2&&(J(2,se),J(3,se),J(4,se)),oe>=ee-1&&(J(ee-1,se),J(ee-2,se),J(ee-3,se));const ke=Array.from(se).sort((Pe,ue)=>Pe-ue),ye=[];return ke.forEach((Pe,ue)=>{ue>0&&Pe-ke[ue-1]>1&&ye.push("ellipsis"),ye.push(Pe)}),ye},[oe,ee]),I=J=>{const se=Math.min(Math.max(J,1),ee);a(se)},F="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 transition-all hover:bg-white/10 hover:border-white/20 disabled:opacity-40 disabled:cursor-not-allowed active:scale-95",M="w-10 h-10 flex items-center justify-center rounded-xl font-bold border border-white/10 bg-white/5 text-white/80 transition-all hover:bg-white/10 hover:border-white/20 active:scale-95",W="bg-gradient-to-br from-indigo-500 to-purple-600 text-white border-white/20 shadow-[0_8px_20px_-6px_rgba(99,102,241,0.6)]";return o.jsxs("div",{className:"overflow-hidden rounded-[32px] border border-white/5 bg-white/5 text-white shadow-2xl backdrop-blur-xl",children:[o.jsx("div",{className:"md:hidden",children:s?o.jsx("div",{className:"px-6 py-8 text-center text-sm text-white/80",children:"Đang Tải Dữ Liệu..."}):e.length===0?o.jsx("div",{className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Không thể tải dữ liệu. Vui lòng thử lại.":"Không có sản phẩm."}):o.jsx("div",{className:"p-3 space-y-3",children:e.map(J=>{const se=c===J.id,ke=_.product?.id===J.id&&_.loading,ye=Hs(J.sanPhamRaw),Pe=u[ye],ue=w[J.id]||null;return o.jsxs("div",{children:[o.jsx(AK,{item:J,isExpanded:se,statusOverride:d[J.id],updatedTimestamp:f[J.id],isDeletingProduct:ke,onToggleProductDetails:j,onStartProductEdit:(Be,Ve)=>{se||j(Ve),A(Be,Ve)},onRequestDeleteProduct:L,onToggleStatus:me}),se&&o.jsx("div",{className:"mt-1 overflow-x-auto rounded-2xl border border-white/10 bg-slate-900/60",children:o.jsx("table",{className:"w-full text-white",children:o.jsx("tbody",{children:o.jsx(k2,{item:J,productKey:ye,isExpanded:!0,statusOverride:d[J.id],updatedTimestamp:f[J.id],supplyState:Pe,pendingNewSupply:ue,supplierOptions:h,isLoadingSuppliers:p,editingProductId:y,productEditForm:N,productEditError:S,isSavingProductEdit:E,isDeletingProduct:ke,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:j,onStartProductEdit:A,onProductEditChange:T,onCancelProductEdit:k,onSubmitProductEdit:C,onRequestDeleteProduct:L,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:me,fetchSupplyPricesForProduct:Ne})})})})]},`card-${J.id}`)})})}),o.jsx("div",{className:"overflow-x-auto hidden md:block",children:o.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[o.jsx("thead",{className:"bg-white/5",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Sản Phẩm"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Sỉ"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Lẻ"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Khuyến Mãi"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Tình Trạng Sản Phẩm"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Cập Nhật"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Thao Tác"})]})}),o.jsx("tbody",{className:"divide-y divide-white/10 bg-white/5",children:s?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"Đang Tải Dữ Liệu..."})}):e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Không thể tải dữ liệu. Vui lòng thử lại.":"Không có sản phẩm."})}):e.map(J=>{const se=c===J.id,ke=Hs(J.sanPhamRaw),ye=u[ke],Pe=w[J.id]||null,ue=_.product?.id===J.id&&_.loading;return o.jsx(k2,{item:J,productKey:ke,isExpanded:se,statusOverride:d[J.id],updatedTimestamp:f[J.id],supplyState:ye,pendingNewSupply:Pe,supplierOptions:h,isLoadingSuppliers:p,editingProductId:y,productEditForm:N,productEditError:S,isSavingProductEdit:E,isDeletingProduct:ue,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:j,onStartProductEdit:A,onProductEditChange:T,onCancelProductEdit:k,onSubmitProductEdit:C,onRequestDeleteProduct:L,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:me,fetchSupplyPricesForProduct:Ne},J.id)})})]})}),o.jsxs("div",{className:"flex flex-col gap-3 border-t border-white/10 bg-slate-950/70 px-4 py-3 text-sm text-white/80 md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Hiển thị"}),o.jsx("select",{className:"rounded-lg border border-white/20 bg-slate-900 px-3 py-1 text-white shadow-sm focus:border-indigo-400 focus:outline-none",value:n,onChange:J=>i(Number(J.target.value)),children:fe.map(J=>o.jsx("option",{value:J,children:J},J))}),o.jsx("span",{children:"dòng"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[o.jsx("button",{className:F,onClick:()=>I(1),disabled:oe===1,"aria-label":"Trang đầu",children:"<<"}),o.jsx("button",{className:F,onClick:()=>I(oe-1),disabled:oe===1,"aria-label":"Trang trước",children:"<"}),O.map((J,se)=>J==="ellipsis"?o.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${se}`):o.jsx("button",{className:`${M} ${oe===J?W:""}`,onClick:()=>I(J),children:J},J)),o.jsx("button",{className:F,onClick:()=>I(oe+1),disabled:oe===ee,"aria-label":"Trang sau",children:">"}),o.jsx("button",{className:F,onClick:()=>I(ee),disabled:oe===ee,"aria-label":"Trang cuối",children:">>"})]})]})]})},OK=({isOpen:e,createForm:t,createSuppliers:r,supplierOptions:n,bankOptions:a,isLoadingSuppliers:i,isLoadingBanks:s,isSubmitting:l,createError:c,onClose:u,onFormChange:d,onSupplierChange:f,onSupplierSelectChange:h,onSupplierPriceInput:p,onEnableCustomSupplier:x,onAddSupplier:g,onRemoveSupplier:v,onSubmit:b})=>{if(!e)return null;const w="mt-1 w-full rounded-xl border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",y="text-xs font-semibold text-slate-300 uppercase tracking-wide";return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center overflow-y-auto bg-black/50 px-2 py-4 sm:px-4 sm:py-6",style:{zIndex:9999},children:o.jsxs("div",{className:"relative flex w-full max-w-4xl flex-col rounded-[32px] border border-white/15 bg-gradient-to-br from-slate-800/95 via-slate-700/90 to-slate-900/95 shadow-2xl backdrop-blur-sm",style:{zIndex:1e4},children:[o.jsx("button",{className:"absolute right-4 top-4 text-slate-400 hover:text-white transition-colors z-10",onClick:u,children:o.jsx(Pt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"space-y-6 px-4 py-6 sm:px-6 sm:py-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:"Thêm Sản Phẩm mới"}),o.jsx("p",{className:"text-base text-slate-300",children:"Nhập Thông tin Sản Phẩm, Tỷ Giá và Nhà Cung Cấp"})]}),o.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300 mb-4",children:"Thông Tin Cơ Bản"}),o.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Tên Sản Phẩm"}),o.jsx("input",{type:"text",className:w,placeholder:"Nhập tên sản phẩm",value:t.packageName,onChange:N=>d("packageName",N.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Gói Sản Phẩm"}),o.jsx("input",{type:"text",className:w,placeholder:"Nhập gói sản phẩm",value:t.packageProduct,onChange:N=>d("packageProduct",N.target.value)})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:y,children:"Mã Sản Phẩm"}),o.jsx("input",{type:"text",className:w,placeholder:"Nhập mã sản phẩm",value:t.sanPham,onChange:N=>d("sanPham",N.target.value)})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300 mb-4",children:"Tỷ Giá"}),o.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Tỷ Giá CTV"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctCtv,onChange:N=>d("pctCtv",N.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Tỷ Giá Khách"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctKhach,onChange:N=>d("pctKhach",N.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Tỷ Giá Khuyến Mãi"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctPromo,onChange:N=>d("pctPromo",N.target.value)})]})]})]}),o.jsx("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300",children:"Thông Tin Nhà Cung Cấp"}),o.jsxs("div",{className:"space-y-4",children:[r.map(N=>o.jsxs("div",{className:"rounded-xl border border-white/10 bg-slate-900/40 p-4",children:[o.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Nhà Cung Cấp"}),r.length>1&&o.jsx("button",{type:"button",onClick:()=>v(N.id),className:"text-red-400 hover:text-red-300 transition-colors",children:o.jsx(qC,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Tên Nhà Cung Cấp"}),N.useCustomName?o.jsx("input",{type:"text",className:w,placeholder:"Nhập tên nhà cung cấp",value:N.sourceName,onChange:S=>f(N.id,"sourceName",S.target.value)}):o.jsxs("div",{className:"relative",children:[o.jsxs("select",{className:w,value:N.sourceId??"",onChange:S=>h(N.id,S.target.value),disabled:i,children:[o.jsx("option",{value:"",children:"Chọn Nhà Cung Cấp"}),n.map(S=>o.jsx("option",{value:S.id??"",children:S.name},S.id))]}),i&&o.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:o.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"})})]}),o.jsx("button",{type:"button",onClick:()=>x(N.id),className:"mt-2 text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:N.useCustomName?"← Chọn từ danh sách":"+ Thêm nhà cung cấp mới"})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Giá Nhập"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",className:w,placeholder:"0",value:N.price,onChange:S=>p(N.id,S.target.value)}),o.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400",children:"VNĐ"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Số Tài Khoản"}),o.jsx("input",{type:"text",className:w,placeholder:"Nhập số tài khoản",value:N.numberBank,onChange:S=>f(N.id,"numberBank",S.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:y,children:"Ngân Hàng"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{className:w,value:N.bankBin,onChange:S=>f(N.id,"bankBin",S.target.value),disabled:s,children:[o.jsx("option",{value:"",children:"Chọn Ngân Hàng"}),a.map(S=>o.jsx("option",{value:S.bin,children:S.name},S.bin))]}),s&&o.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:o.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"})})]})]})]}),(()=>{const S=N.price?Number(String(N.price).replace(/\D/g,"")):null,E=S!=null&&Number.isFinite(S)&&S>0,_=E?pl(S,jn(t.pctCtv)):null,j=_!=null?pl(_,jn(t.pctKhach)):null,A=Hu(_),T=Hu(j);return E?o.jsxs("div",{className:"mt-4 grid gap-2 rounded-lg border border-white/5 bg-slate-950/30 p-3 text-xs",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-slate-400",children:"Xem Trước Giá (theo Tỷ Giá CTV):"}),o.jsx("span",{className:"font-semibold text-white",children:qp(A)})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-slate-400",children:"Giá Lẻ (từ giá CTV × Tỷ Giá Khách):"}),o.jsx("span",{className:"font-semibold text-white",children:qp(T)})]})]}):null})()]},N.id)),o.jsxs("button",{type:"button",onClick:g,className:"flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed border-white/20 bg-slate-900/20 px-4 py-3 text-sm font-semibold text-indigo-300 transition-all hover:border-indigo-400/50 hover:bg-slate-800/40 hover:text-indigo-200",children:[o.jsx(hk,{className:"h-5 w-5"}),"Thêm Nhà Cung Cấp"]})]})]})}),c&&o.jsx("div",{className:"rounded-xl border border-red-500/20 bg-red-500/10 p-4",children:o.jsx("p",{className:"text-sm text-red-300",children:c})}),o.jsxs("div",{className:"flex items-center justify-end gap-3 rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur-sm",children:[o.jsx("button",{type:"button",onClick:u,disabled:l,className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",children:"Hủy bỏ"}),o.jsx(An,{onClick:b,disabled:l,className:"px-6 py-3",children:l?"Đang Lưu...":"Thêm Sản Phẩm"})]})]})]})})},DK=({product:e,loading:t,error:r,onClose:n,onConfirm:a})=>e?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 px-4 py-6",style:{zIndex:9999},onClick:()=>{t||n()},children:o.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:i=>i.stopPropagation(),children:[o.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xác Định Xóa"}),o.jsx("p",{className:"text-sm text-sky-200/90",children:"Hành động này sẽ Xóa Sản Phẩm khỏi bảng Giá."})]}),o.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:n,disabled:t,children:o.jsx(Pt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-sky-100",children:e.packageName||e.packageProduct||e.sanPhamRaw||`Sản Phẩm #${e.id}`}),o.jsxs("p",{className:"text-sm text-sky-200/90",children:["Mã: ",e.sanPhamRaw||"Không xác định"]})]}),o.jsx("p",{children:"Bạn có chắc chắn muốn xóa sản phẩm này? Hành động không thể hoàn tác và dữ liệu liên quan sẽ được cập nhật."})]}),r&&o.jsx("p",{className:"mt-4 text-xs text-red-500",children:r}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-white/70 hover:bg-indigo-500/10 disabled:opacity-50",onClick:n,disabled:t,children:"Hủy"}),o.jsx("button",{type:"button",className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60",onClick:a,disabled:t,children:t?"Đang Xóa...":"Xóa Sản Phẩm"})]})]})}):null,IK=e=>{const[t,r]=m.useState(""),[n,a]=m.useState("all"),[i,s]=m.useState(1),[l,c]=m.useState(10),[u,d]=m.useState([]),[f,h]=m.useState(!1),[p,x]=m.useState(null),[g,v]=m.useState(null),[b,w]=m.useState({}),[y,N]=m.useState({}),[S,E]=m.useState(!1),_=m.useCallback(async()=>{h(!0),x(null);try{const k=await fetch(`${e}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(k.status===401){window.location.href="/login";return}if(!k.ok)throw new Error("Không thể tải dữ liệu sản phẩm.");const C=await k.json(),V=(Array.isArray(C)?C:Array.isArray(C?.items)?C.items:[]).map((K,Y)=>mT(K,Y)).map(K=>$o(K,K.baseSupplyPrice)),X=V.reduce((K,Y)=>(Y.lastUpdated&&(K[Y.id]=Y.lastUpdated),K),{});d(V),w({}),N(X)}catch(k){console.error("Lỗi khi tải dữ liệu:",k),d([]),x(k instanceof Error?k.message:"Không thể tải dữ liệu pricing.")}finally{h(!1)}},[e]),j=m.useMemo(()=>{const k=t.trim().toLowerCase();return u.filter(C=>n==="active"&&!C.isActive||n==="inactive"&&C.isActive?!1:k?[C.packageName,C.packageProduct,C.sanPhamRaw,C.variantLabel].join(" ").toLowerCase().includes(k):!0).sort((C,L)=>{const G=!(b[C.id]??C.isActive),V=!(b[L.id]??L.isActive);if(G!==V)return G?1:-1;const X=Wu(y[C.id]??C.lastUpdated),K=Wu(y[L.id]??L.lastUpdated);return X!==K?K-X:C.id-L.id})},[u,t,n,b,y]),A=m.useMemo(()=>{const k=(i-1)*l,C=k+l;return j.slice(k,C)},[j,i,l]),T=j.length;return{currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:c,totalRows:T,searchTerm:t,setSearchTerm:r,statusFilter:n,setStatusFilter:a,productPrices:u,setProductPrices:d,isLoading:f,setIsLoading:h,error:p,setError:x,statusOverrides:b,setStatusOverrides:w,updatedTimestampMap:y,setUpdatedTimestampMap:N,expandedProductId:g,setExpandedProductId:v,isRefreshing:S,setIsRefreshing:E,fetchProductPrices:_,filteredPricing:A}},RK=e=>({packageName:e.packageName||"",packageProduct:e.packageProduct||"",sanPham:e.sanPhamRaw||"",pctCtv:e.pctCtv!==null&&e.pctCtv!==void 0?String(e.pctCtv):"",pctKhach:e.pctKhach!==null&&e.pctKhach!==void 0?String(e.pctKhach):"",pctPromo:e.pctPromo!==null&&e.pctPromo!==void 0?String(e.pctPromo):""}),MK=({apiBase:e,productPrices:t,setProductPrices:r,fetchProductPrices:n,statusOverrides:a,setStatusOverrides:i,updatedTimestampMap:s,setUpdatedTimestampMap:l})=>{const[c,u]=m.useState(null),[d,f]=m.useState(null),[h,p]=m.useState(null),[x,g]=m.useState(!1),[v,b]=m.useState(!1),[w,y]=m.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[N,S]=m.useState([hh()]),[E,_]=m.useState(null),[j,A]=m.useState(!1),[T,k]=m.useState([]),[C,L]=m.useState(!1),[G,V]=m.useState([]),[X,K]=m.useState(!1),[Y,q]=m.useState({product:null,loading:!1,error:null}),Z=m.useCallback(async()=>{if(!(X||G.length>0)){K(!0);try{const ve=await fetch(`${e}${Je.BANK_LIST}`,{credentials:"include"});if(!ve.ok)throw new Error("Không thể tải danh sách ngân hàng.");const we=await ve.json(),he=Array.isArray(we)?we.map(Te=>({bin:Te?.bin?.toString().trim()??"",name:Te?.bank_name?.toString().trim()??Te?.name??""})).filter(Te=>Te.bin&&Te.name):[];V(he)}catch(ve){console.error("Lỗi khi tải danh sách ngân hàng:",ve)}finally{K(!1)}}},[e,G.length,X]),le=m.useCallback(async()=>{if(!(C||T.length>0)){L(!0);try{const ve=await fetch(`${e}${Je.SUPPLIES}`,{credentials:"include"});if(!ve.ok)throw new Error("Không thể tải danh sách NCC.");const we=await ve.json().catch(()=>null),Te=(Array.isArray(we?.items)?we.items:Array.isArray(we)?we:[]).map(Oe=>{const Ae=Oe?.id??Oe?.sourceId??Oe?.source_id,Ye=typeof Ae=="number"&&Number.isFinite(Ae)?Ae:Number.isFinite(Number(Ae))?Number(Ae):null,ct=Oe?.supplier_name??Oe?.source_name??Oe?.name??Oe?.sourceName??Oe?.source??"";return{id:Ye??null,name:(ct||"").trim(),numberBank:Oe?.number_bank??Oe?.numberBank??Oe?.bankNumber??"",binBank:Oe?.bin_bank??Oe?.binBank??Oe?.bankBin??""}}).filter(Oe=>Oe.name.length>0),pe=[],We=new Set;for(const Oe of Te){const Ae=Oe.id!==null?`id:${Oe.id}`:`name:${Oe.name.toLowerCase().trim()}`;We.has(Ae)||(We.add(Ae),pe.push(Oe))}k(pe)}catch(ve){console.error("Lỗi khi tải danh sách NCC:",ve)}finally{L(!1)}}},[e,C,T.length]);m.useEffect(()=>{!C&&T.length===0&&le()},[C,T.length,le]),m.useEffect(()=>{v&&G.length===0&&!X&&Z(),v&&T.length===0&&!C&&le()},[v,G.length,X,Z,T.length,C,le]);const ce=(ve,we)=>{if(ve.stopPropagation(),g(!1),c===we.id){u(null),f(null),p(null);return}p(null),u(we.id),f(RK(we))},me=(ve,we)=>{f(he=>he&&{...he,[ve]:we})},Ne=()=>{u(null),f(null),p(null),g(!1)},ee=async()=>{if(!d||c===null)return;const ve=d.packageName?.trim()??"",we=d.packageProduct?.trim()??"",he=d.sanPham?.trim()??"";if(!he){p("Vui lòng nhập mã sản phẩm hợp lệ");return}const Te=jn(d.pctCtv),pe=jn(d.pctKhach),We=jn(d.pctPromo);if(!Te||Te<=0){p("Tỷ giá CTV phải lớn hơn 0");return}if(!pe||pe<=0){p("Tỷ giá Khách phải lớn hơn 0");return}if(We!==null){if(We<Xp){p("Tỷ lệ khuyến mãi không được âm.");return}const Oe=Math.max(0,pe-1);if(Oe===0&&We>0){p("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(We>Oe){p(`Tỷ lệ khuyến mãi không được vượt ${Oe.toFixed(2)}`);return}}g(!0),p(null);try{const Oe=await fetch(`${e}${Je.PRODUCT_PRICE_DETAIL(c)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:ve,packageProduct:we,sanPham:he,pctCtv:Te,pctKhach:pe,pctPromo:We}),credentials:"include"}),Ae=await Oe.text();let Ye=null;if(Ae)try{Ye=JSON.parse(Ae)}catch{Ye=null}if(!Oe.ok){const He=Ye?.error||Ae?.trim()||"Không thể cập nhật giá sản phẩm";throw new Error(He)}const ct=mT(Ye,c);r(He=>He.map(ut=>ut.id===c?ct:ut)),ct?.id!==void 0&&l(He=>({...He,[ct.id]:ct.lastUpdated||new Date().toISOString()})),await n(),u(null),f(null)}catch(Oe){console.error("Lỗi khi cập nhật giá sản phẩm:",Oe),p(Oe instanceof Error?Oe.message:"Không thể cập nhật giá sản phẩm")}finally{g(!1)}},oe=m.useCallback((ve,we)=>{ve.stopPropagation(),q({product:we,loading:!1,error:null})},[]),fe=m.useCallback(()=>{q({product:null,loading:!1,error:null})},[]),O=m.useCallback(async()=>{const ve=Y.product;if(ve){q(we=>({...we,loading:!0,error:null}));try{const we=await cK(ve.id);if(!we.success)throw new Error(we.message||"Không thể xóa sản phẩm.");r(he=>he.filter(Te=>Te.id!==ve.id)),i(he=>{const Te={...he};return delete Te[ve.id],Te}),l(he=>{const Te={...he};return delete Te[ve.id],Te}),fe()}catch(we){console.error("Failed to delete product price:",we),q(he=>({...he,loading:!1,error:we instanceof Error?we.message:"Không thể xóa sản phẩm. Vui lòng thử lại."}))}}},[fe,Y.product,r,i,l]),I=()=>{y({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),S([hh()]),_(null),A(!1)},F=()=>{I(),b(!0),G.length===0&&!X&&Z(),T.length===0&&!C&&le()},M=()=>{b(!1),I()};return{editingProductId:c,productEditForm:d,productEditError:h,isSavingProductEdit:x,isCreateModalOpen:v,createForm:w,createSuppliers:N,createError:E,isSubmittingCreate:j,supplierOptions:T,isLoadingSuppliers:C,bankOptions:G,isLoadingBanks:X,deleteProductState:Y,handleStartProductEdit:ce,handleProductEditChange:me,handleCancelProductEdit:Ne,handleSubmitProductEdit:ee,handleRequestDeleteProduct:oe,confirmDeleteProduct:O,closeDeleteProductModal:fe,handleOpenCreateModal:F,handleCloseCreateModal:M,handleCreateFormChange:(ve,we)=>{y(he=>({...he,[ve]:we}))},handleSupplierChange:(ve,we,he)=>{S(Te=>Te.map(pe=>pe.id===ve?{...pe,[we]:we==="sourceId"?he&&Number(he)||null:we==="useCustomName"?he==="true":he}:pe))},handleSupplierSelectChange:(ve,we)=>{const he=T.find(Te=>Te.id!==null&&we===String(Te.id)||Te.id===null&&we===Te.name)||null;S(Te=>Te.map(pe=>pe.id===ve?{...pe,sourceId:he?.id??null,sourceName:he?.name??"",numberBank:he?.numberBank??"",bankBin:he?.binBank??"",useCustomName:!1}:pe))},handleSupplierPriceInput:(ve,we)=>{const he=Yp(we);S(Te=>Te.map(pe=>pe.id===ve?{...pe,price:he}:pe))},handleEnableCustomSupplier:ve=>{S(we=>we.map(he=>he.id===ve?{...he,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:he))},handleAddSupplierRow:()=>{S(ve=>[...ve,hh()])},handleRemoveSupplierRow:ve=>{S(we=>we.length===1?we:we.filter(he=>he.id!==ve))},handleSubmitCreateProduct:async()=>{const ve=w.packageName.trim(),we=w.packageProduct.trim(),he=w.sanPham.trim(),Te=jn(w.pctCtv),pe=jn(w.pctKhach),We=jn(w.pctPromo);if(!he){_("Vui lòng nhập mã sản phẩm");return}if(Te!==null&&Te<=0){_("Tỷ giá CTV phải lớn hơn 0.");return}if(pe!==null&&pe<=0){_("Tỷ giá khách phải lớn hơn 0.");return}if(We!==null){if(We<Xp){_("Tỷ lệ khuyến mãi không được âm.");return}if(pe!==null&&pe>0){const Ae=Math.max(0,pe-1);if(Ae===0&&We>0){_("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(We>Ae){_(`Tỷ lệ khuyến mãi không được vượt ${Ae.toFixed(2)}`);return}}}const Oe=N.map(Ae=>{const Ye=(Ae.sourceName||"").trim(),ct=Number((Ae.price||"").replace(/\D+/g,"")),He=Number.isFinite(ct)&&ct>0?ct:null,ut=Ae.sourceId,vn=ut!=null&&Number.isFinite(Number(ut))?Number(ut):void 0;return!vn&&!Ye?null:{sourceId:vn,sourceName:Ye||void 0,price:He,numberBank:(Ae.numberBank||"").trim()||void 0,binBank:(Ae.bankBin||"").trim()||void 0}}).filter(Ae=>!!(Ae&&(Ae.sourceId!==void 0||Ae.sourceName&&Ae.sourceName.length>0)));if(Oe.length===0){_("Vui lòng chọn hoặc nhập ít nhất một Nhà Cung Cấp và giá nhập.");return}A(!0),_(null);try{const Ae=await fetch(`${e}${Je.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:ve||void 0,packageProduct:we||void 0,sanPham:he,pctCtv:Te??void 0,pctKhach:pe??void 0,pctPromo:We??void 0,suppliers:Oe}),credentials:"include"}),Ye=await Ae.text();let ct=null;if(Ye)try{ct=JSON.parse(Ye)}catch{ct=null}if(!Ae.ok){const He=ct?.error||Ye?.trim()||"Không thể tạo sản phẩm";throw new Error(He)}await n(),M()}catch(Ae){console.error("Lỗi khi tạo sản phẩm:",Ae),_(Ae instanceof Error?Ae.message:"Không thể tạo sản phẩm")}finally{A(!1)}},handleToggleStatus:async ve=>{const he=!(a[ve.id]??ve.isActive??!1),Te=a[ve.id],pe=s[ve.id],We=new Date().toISOString();i(Oe=>({...Oe,[ve.id]:he})),r(Oe=>Oe.map(Ae=>Ae.id===ve.id?{...Ae,isActive:he}:Ae)),l(Oe=>({...Oe,[ve.id]:We}));try{const Oe=await fetch(`${e}${Je.PRODUCT_PRICES}/${ve.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:he}),credentials:"include"});if(!Oe.ok)throw new Error("Lỗi khi cập nhật trạng thái");const Ae=await Oe.json(),Ye=Ae?.is_active??he,ct=typeof Ae?.update=="string"?Ae.update:We;i(He=>({...He,[ve.id]:Ye})),r(He=>He.map(ut=>ut.id===ve.id?{...ut,isActive:Ye,lastUpdated:ct}:ut)),l(He=>({...He,[ve.id]:ct}))}catch(Oe){console.error("Failed to toggle product status:",Oe),i(Ae=>{const Ye={...Ae};return Te===void 0?delete Ye[ve.id]:Ye[ve.id]=Te,Ye}),r(Ae=>Ae.map(Ye=>Ye.id===ve.id?{...Ye,isActive:Te??ve.isActive??!1}:Ye)),l(Ae=>{const Ye={...Ae};return pe?Ye[ve.id]=pe:delete Ye[ve.id],Ye}),Tr({type:"error",title:"Lỗi cập nhật trạng thái giá",message:"Cập nhật thất bại. Vui lòng thử lại."})}}}},FK=({apiBase:e,setProductPrices:t,fetchProductPrices:r})=>{const[n,a]=m.useState({}),[i,s]=m.useState({}),[l,c]=m.useState({}),[u,d]=m.useState({}),[f,h]=m.useState({}),[p,x]=m.useState({}),g=m.useCallback(async T=>{const k=Hs(T);if(k){a(C=>({...C,[k]:{items:C[k]?.items??[],loading:!0,error:null,productName:C[k]?.productName??T}}));try{const C=await fetch(`${e}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(T)}`,{credentials:"include"});if(!C.ok)throw new Error("Không thể tải giá nguồn. Vui lòng thử lại.");const L=await C.json(),G=Array.isArray(L)?L.map((K,Y)=>({sourceId:Number.isFinite(Number(K?.sourceId??K?.source_id))?Number(K?.sourceId??K?.source_id):Y,sourceName:K?.supplier_name?.toString().trim()||K?.sourceName?.toString().trim()||K?.source_name?.toString().trim()||`Nhà Cung Cấp #${Number(K?.sourceId)||Y+1}`,price:typeof K?.price=="number"&&Number.isFinite(K.price)?K.price:null,lastOrderDate:typeof K?.last_order_date=="string"?K.last_order_date:null})):[],V=wc(jK(G)),X=ri(V,null);typeof X=="number"&&Number.isFinite(X)&&X>0&&t(K=>{let Y=!1;const q=K.map(Z=>{if(Hs(Z.sanPhamRaw)!==k)return Z;const le=typeof Z.baseSupplyPrice=="number"&&Number.isFinite(Z.baseSupplyPrice)&&Math.abs(Z.baseSupplyPrice-X)<1e-5,ce=typeof Z.wholesalePrice=="number"&&Number.isFinite(Z.wholesalePrice)&&Z.wholesalePrice>0,me=typeof Z.retailPrice=="number"&&Number.isFinite(Z.retailPrice)&&Z.retailPrice>0,Ne=hl(Z.pctPromo,Z.pctKhach,Z.pctCtv),ee=typeof Z.promoPrice=="number"&&Number.isFinite(Z.promoPrice)&&Z.promoPrice>0;return le&&ce&&me&&(!Ne||ee)?Z:(Y=!0,$o({...Z,baseSupplyPrice:X},X))});return Y?q:K}),a(K=>({...K,[k]:{loading:!1,error:null,items:V,productName:T}}))}catch(C){a(L=>({...L,[k]:{loading:!1,items:L[k]?.items??[],error:C instanceof Error?C.message:"Không thể tải giá nguồn. Vui lòng thử lại.",productName:L[k]?.productName??T}}))}}},[e,t]),v=T=>{s(k=>{const C={...k};return delete C[T],C}),c(k=>{const C={...k};return delete C[T],C}),h(k=>{const C={...k};return delete C[T],C})},b=(T,k,C)=>{const L=Os(T,k);s(G=>({...G,[L]:!0})),c(G=>({...G,[L]:C==null?"":qp(C)})),h(G=>({...G,[L]:null}))},w=(T,k,C)=>{const L=Os(T,k),G=Yp(C);c(V=>({...V,[L]:G})),h(V=>({...V,[L]:null}))},y=(T,k)=>{const C=Os(T,k);v(C),d(L=>{const G={...L};return delete G[C],G})},N=async(T,k,C,L)=>{const G=Os(T,k),X=l[G]?.toString().trim()??"";if(!X){h(Y=>({...Y,[G]:"Vui lòng nhập giá hợp lệ."}));return}const K=Number(X.replace(/\D+/g,""));if(!Number.isFinite(K)||K<0){h(Y=>({...Y,[G]:"Giá nhập không được thấp hơn 0."}));return}d(Y=>({...Y,[G]:!0}));try{const Y=await fetch(`${e}${Je.UPDATE_SUPPLY_PRICE(T,k)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:K}),credentials:"include"}),q=await Y.json().catch(()=>null);if(!Y.ok)throw new Error(q?.error||"Không thể cập nhật giá nguồn.");const Z=Number.isFinite(Number(q?.price))?Number(q?.price):K;let le=null,ce=!1;if(a(me=>{const Ne=me[C];if(!Ne)return me;const ee=ri(Ne.items,null),oe=Ne.items.find(J=>J.sourceId===k),fe=typeof oe?.price=="number"?oe.price:null,O=typeof fe=="number"&&typeof ee=="number"&&Math.abs(fe-ee)<1e-5,I=wc(Ne.items.map(J=>J.sourceId===k?{...J,price:Z}:J)),F=ri(I,null),M=fe===null||fe!==Z;return typeof F=="number"&&Number.isFinite(F)&&F>0?(le=F,(F!==ee||O&&M)&&(ce=!0)):O&&M&&(le=F??null,ce=!0),{...me,[C]:{...Ne,items:I}}}),ce&&t(me=>me.map(Ne=>Ne.id===T?$o(Ne,le):Ne)),v(G),await g(L),ce)try{await r()}catch(me){console.error("Failed to refresh product pricing:",me)}}catch(Y){h(q=>({...q,[G]:Y instanceof Error?Y.message:"Không thể cập nhật giá nguồn."}))}finally{d(Y=>{const q={...Y};return delete q[G],q})}},S=T=>{x(k=>k[T]?k:{...k,[T]:{sourceName:"",sourceId:null,useCustomName:!1,price:"",error:null,isSaving:!1}})},E=(T,k,C)=>{let L=C;if(k==="price")L=Yp(String(C??""));else if(k==="sourceId"){const G=Number(C);L=C===null||Number.isNaN(G)||!Number.isFinite(G)?null:G}else k==="useCustomName"?L=!!C:L=String(C??"");x(G=>{const V=G[T];if(!V)return G;const X={...V,[k]:L,error:null};return k==="useCustomName"&&(L?(X.sourceId=null,X.sourceName=""):!X.sourceName&&V.sourceName&&(X.sourceName=V.sourceName)),{...G,[T]:X}})},_=T=>{x(k=>{const C={...k};return delete C[T],C})};return{supplyPriceMap:n,editingSupplyRows:i,supplyPriceDrafts:l,savingSupplyRows:u,supplyRowErrors:f,newSupplyRows:p,fetchSupplyPricesForProduct:g,handleStartEditingSupply:b,handleSupplyInputChange:w,handleCancelSupplyEditing:y,handleConfirmSupplyEditing:N,handleStartAddSupplierRow:S,handleNewSupplierInputChange:E,handleCancelAddSupplierRow:_,handleConfirmAddSupplierRow:async T=>{const k=p[T.id];if(!k)return;const C=k.sourceName.trim(),L=k.useCustomName||k.sourceId===null?null:k.sourceId,G=Number((k.price||"").replace(/\D+/g,""));if(!C){x(V=>({...V,[T.id]:{...k,error:"Vui lòng chọn hoặc nhập tên nguồn hợp lệ."}}));return}if(!Number.isFinite(G)||G<=0){x(V=>({...V,[T.id]:{...k,error:"Giá nhập phải lớn hơn 0."}}));return}x(V=>({...V,[T.id]:{...k,isSaving:!0,error:null}}));try{const V=await fetch(`${e}${Je.CREATE_SUPPLY_PRICE(T.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:C,sourceId:L,price:G}),credentials:"include"}),X=await V.json().catch(()=>null);if(!V.ok)throw new Error(X?.error||"Không thể thêm nguồn mới.");const K=Hs(T.sanPhamRaw),Y=Number(X?.sourceId),Z=(typeof L=="number"&&Number.isFinite(L)&&L>0?L:null)??Date.now(),le=Number.isFinite(Y)&&Y>0?Y:Z,ce=Number.isFinite(Number(X?.price))?Number(X?.price):G;let me=null,Ne=!1;if(a(ee=>{const oe=ee[K],fe=oe?.items??[],O=fe.some(J=>J.sourceId===le),I=wc(O?fe.map(J=>J.sourceId===le?{...J,price:ce}:J):[...fe,{sourceId:le,sourceName:C,price:ce,lastOrderDate:null}]),F=ri(fe,null),M=ri(I,null);return(typeof F=="number"&&typeof M=="number"?Math.abs(M-F)>1e-5:F!==M)&&(Ne=!0),me=M,{...ee,[K]:{loading:oe?.loading??!1,error:null,items:I}}}),Ne&&t(ee=>ee.map(oe=>oe.id===T.id?$o(oe,me):oe)),await g(T.sanPhamRaw),_(T.id),Ne)try{await r()}catch(ee){console.error("Failed to refresh product pricing:",ee)}}catch(V){x(X=>({...X,[T.id]:{...k,isSaving:!1,error:V instanceof Error?V.message:"Không thể thêm nguồn mới."}}))}},handleDeleteSupplyRow:async(T,k,C,L)=>{const G=Os(T,k);h(K=>({...K,[G]:null})),d(K=>({...K,[G]:!0}));let V=null,X=!1;try{const K=await fetch(`${e}${Je.DELETE_SUPPLY_PRICE(T,k)}`,{method:"DELETE",credentials:"include"}),Y=await K.json().catch(()=>null);if(!K.ok)throw new Error(Y?.error||"Không thể xóa nguồn này.");if(a(q=>{const Z=q[C];if(!Z)return q;const le=wc(Z.items.filter(ee=>ee.sourceId!==k)),ce=ri(Z.items,null),me=ri(le,null);return(typeof ce=="number"&&typeof me=="number"?Math.abs(me-ce)>1e-5:ce!==me)&&(X=!0),V=me,{...q,[C]:{...Z,items:le}}}),v(G),X&&t(q=>q.map(Z=>Z.id===T?$o(Z,V):Z)),await g(L),X)try{await r()}catch(q){console.error("Failed to refresh product pricing:",q)}}catch(K){h(Y=>({...Y,[G]:K instanceof Error?K.message:"Không thể xóa nguồn này."}))}finally{d(K=>{const Y={...K};return delete Y[G],Y})}}}},LK={};var BK={};const ph=typeof import.meta<"u"&&LK?.VITE_API_BASE_URL||typeof process<"u"&&BK?.VITE_API_BASE_URL||""||"http://localhost:3001",$K=()=>{const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:c,productPrices:u,setProductPrices:d,isLoading:f,error:h,statusOverrides:p,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v,expandedProductId:b,setExpandedProductId:w,isRefreshing:y,setIsRefreshing:N,fetchProductPrices:S,filteredPricing:E}=IK(ph),_=FK({apiBase:ph,setProductPrices:d,fetchProductPrices:S}),{supplyPriceMap:j,fetchSupplyPricesForProduct:A}=_,T=MK({apiBase:ph,productPrices:u,setProductPrices:d,fetchProductPrices:S,statusOverrides:p,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v});m.useEffect(()=>{S()},[S]);const k=m.useCallback(async()=>{if(!y){N(!0);try{await S();const G=new Set;Object.values(j).forEach(V=>{V?.productName&&G.add(V.productName)}),await Promise.all(Array.from(G).map(V=>A(V)))}catch(G){console.error("Failed to refresh pricing data:",G)}finally{N(!1)}}},[y,S,N,j,A]),C=G=>{const V=b===G.id?null:G.id;if(w(V),V===G.id){const X=Hs(G.sanPhamRaw),K=_.supplyPriceMap[X];(!K||!K.loading&&K.items.length===0)&&_.fetchSupplyPricesForProduct(G.sanPhamRaw)}},L=m.useMemo(()=>{const G=u.length,V=u.filter(K=>K.isActive).length,X=G-V;return[{name:"Tổng Sản Phẩm",value:G.toString(),icon:dd,accent:"emerald",subtitle:"Tất cả sản phẩm"},{name:"Đang Hoạt Động",value:V.toString(),icon:um,accent:"sky",subtitle:"Sẵn sàng bán"},{name:"Tạm Dừng",value:X.toString(),icon:ca,accent:"violet",subtitle:"Đang ẩn trên bảng giá"}]},[u]);return{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:c,filteredPricing:E,pricingStats:L,isLoading:f,error:h,isRefreshing:y,expandedProductId:b,supplyPriceMap:j,editingSupplyRows:_.editingSupplyRows,supplyPriceDrafts:_.supplyPriceDrafts,savingSupplyRows:_.savingSupplyRows,supplyRowErrors:_.supplyRowErrors,newSupplyRows:_.newSupplyRows,editingProductId:T.editingProductId,productEditForm:T.productEditForm,productEditError:T.productEditError,isSavingProductEdit:T.isSavingProductEdit,isCreateModalOpen:T.isCreateModalOpen,createForm:T.createForm,createSuppliers:T.createSuppliers,createError:T.createError,isSubmittingCreate:T.isSubmittingCreate,supplierOptions:T.supplierOptions,isLoadingSuppliers:T.isLoadingSuppliers,bankOptions:T.bankOptions,isLoadingBanks:T.isLoadingBanks,statusOverrides:p,updatedTimestampMap:g,deleteProductState:T.deleteProductState,handleRefreshAll:k,handleToggleProductDetails:C,handleStartEditingSupply:_.handleStartEditingSupply,handleSupplyInputChange:_.handleSupplyInputChange,handleCancelSupplyEditing:_.handleCancelSupplyEditing,handleConfirmSupplyEditing:_.handleConfirmSupplyEditing,handleStartAddSupplierRow:_.handleStartAddSupplierRow,handleNewSupplierInputChange:_.handleNewSupplierInputChange,handleCancelAddSupplierRow:_.handleCancelAddSupplierRow,handleConfirmAddSupplierRow:_.handleConfirmAddSupplierRow,handleDeleteSupplyRow:_.handleDeleteSupplyRow,handleStartProductEdit:T.handleStartProductEdit,handleProductEditChange:T.handleProductEditChange,handleCancelProductEdit:T.handleCancelProductEdit,handleSubmitProductEdit:T.handleSubmitProductEdit,handleRequestDeleteProduct:T.handleRequestDeleteProduct,confirmDeleteProduct:T.confirmDeleteProduct,closeDeleteProductModal:T.closeDeleteProductModal,handleOpenCreateModal:T.handleOpenCreateModal,handleCloseCreateModal:T.handleCloseCreateModal,handleCreateFormChange:T.handleCreateFormChange,handleSupplierChange:T.handleSupplierChange,handleSupplierSelectChange:T.handleSupplierSelectChange,handleSupplierPriceInput:T.handleSupplierPriceInput,handleEnableCustomSupplier:T.handleEnableCustomSupplier,handleAddSupplierRow:T.handleAddSupplierRow,handleRemoveSupplierRow:T.handleRemoveSupplierRow,handleSubmitCreateProduct:T.handleSubmitCreateProduct,handleToggleStatus:T.handleToggleStatus,fetchSupplyPricesForProduct:_.fetchSupplyPricesForProduct}};function UK(){const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,totalRows:a,currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:c,pricingStats:u,filteredPricing:d,isLoading:f,error:h,isRefreshing:p,expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:b,editingSupplyRows:w,supplyPriceDrafts:y,savingSupplyRows:N,supplyRowErrors:S,newSupplyRows:E,editingProductId:_,productEditForm:j,productEditError:A,isSavingProductEdit:T,deleteProductState:k,isCreateModalOpen:C,createForm:L,createSuppliers:G,createError:V,isSubmittingCreate:X,supplierOptions:K,isLoadingSuppliers:Y,bankOptions:q,isLoadingBanks:Z,handleRefreshAll:le,handleToggleProductDetails:ce,handleStartProductEdit:me,handleProductEditChange:Ne,handleCancelProductEdit:ee,handleSubmitProductEdit:oe,handleRequestDeleteProduct:fe,confirmDeleteProduct:O,closeDeleteProductModal:I,handleStartEditingSupply:F,handleSupplyInputChange:M,handleCancelSupplyEditing:W,handleConfirmSupplyEditing:J,handleStartAddSupplierRow:se,handleNewSupplierInputChange:ke,handleCancelAddSupplierRow:ye,handleConfirmAddSupplierRow:Pe,handleDeleteSupplyRow:ue,handleToggleStatus:Be,handleOpenCreateModal:Ve,handleCloseCreateModal:ve,handleCreateFormChange:we,handleSupplierChange:he,handleSupplierSelectChange:Te,handleSupplierPriceInput:pe,handleEnableCustomSupplier:We,handleAddSupplierRow:Oe,handleRemoveSupplierRow:Ae,handleSubmitCreateProduct:Ye,fetchSupplyPricesForProduct:ct}=$K();return o.jsxs(o.Fragment,{children:[o.jsx(DK,{product:k.product,loading:k.loading,error:k.error,onClose:I,onConfirm:O}),o.jsx(OK,{isOpen:C,createForm:L,createSuppliers:G,supplierOptions:K,bankOptions:q,isLoadingSuppliers:Y,isLoadingBanks:Z,createError:V,isSubmitting:X,onClose:ve,onFormChange:we,onSupplierChange:he,onSupplierSelectChange:Te,onSupplierPriceInput:pe,onEnableCustomSupplier:We,onAddSupplier:Oe,onRemoveSupplier:Ae,onSubmit:Ye,parseRatioInput:jn}),o.jsxs("div",{className:"space-y-6",children:[o.jsx(bK,{stats:u,onAddProduct:Ve}),o.jsx(vK,{searchTerm:e,statusFilter:r,isLoading:f,isRefreshing:p,error:h,onSearchChange:t,onStatusChange:n,onRefresh:le,onAddProduct:Ve}),o.jsx(PK,{items:d,isLoading:f,error:h,totalRows:a,currentPage:i,rowsPerPage:l,onPageChange:s,onRowsPerPageChange:He=>{c(He),s(1)},expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:b,supplierOptions:K,isLoadingSuppliers:Y,editingSupplyRows:w,supplyPriceDrafts:y,savingSupplyRows:N,supplyRowErrors:S,newSupplyRows:E,editingProductId:_,productEditForm:j,productEditError:A,isSavingProductEdit:T,deleteProductState:k,onToggleProductDetails:ce,onStartProductEdit:me,onProductEditChange:Ne,onCancelProductEdit:ee,onSubmitProductEdit:oe,onRequestDeleteProduct:fe,onStartEditingSupply:F,onSupplyInputChange:M,onCancelSupplyEditing:W,onConfirmSupplyEditing:J,onStartAddSupplierRow:se,onNewSupplierInputChange:ke,onCancelAddSupplierRow:ye,onConfirmAddSupplierRow:Pe,onDeleteSupplyRow:ue,onToggleStatus:Be,fetchSupplyPricesForProduct:ct})]})]})}const HK=()=>{const e=m.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]);return o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:o.jsxs("linearGradient",{id:e,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[o.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),o.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),o.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),o.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[o.jsx("div",{className:"retro-grid"}),o.jsx("div",{className:"retro-sun"}),o.jsx("div",{className:"retro-planet"}),o.jsx("div",{className:"retro-glow"})]})]})},zK=({children:e})=>o.jsxs("div",{className:"login-card retro-card",children:[o.jsx("div",{className:"login-card__header card-top",children:o.jsxs("div",{className:"login-card__title-wrap title",children:[o.jsx("p",{className:"login-card__eyebrow eyebrow",children:"Chào mừng trở lại"}),o.jsx("h1",{className:"login-card__title gradient-title",children:"Mavryk Premium"}),o.jsx("p",{className:"login-card__subtitle subtitle",children:"Nhập thông tin của bạn để vào trang quản trị."})]})}),e]}),WK=({email:e,password:t,loading:r,error:n,onEmailChange:a,onPasswordChange:i,onSubmit:s})=>o.jsxs("form",{className:"form",onSubmit:s,children:[o.jsxs("label",{className:"field",children:[o.jsx("span",{children:"Tài khoản"}),o.jsx("input",{type:"text",required:!0,value:e,onChange:l=>a(l.target.value),placeholder:"Nhập tên đăng nhập"})]}),o.jsxs("label",{className:"field",children:[o.jsx("span",{children:"Mật khẩu"}),o.jsx("input",{type:"password",required:!0,value:t,onChange:l=>i(l.target.value),placeholder:"Nhập mật khẩu"})]}),o.jsxs("div",{className:"controls",children:[o.jsxs("label",{className:"remember",children:[o.jsx("input",{type:"checkbox",defaultChecked:!0}),o.jsx("span",{children:"Ghi nhớ đăng nhập"})]}),o.jsx("button",{type:"button",className:"ghost",children:"Quên mật khẩu?"})]}),o.jsx("button",{type:"submit",className:"cta",disabled:r,children:r?"Đang đăng nhập...":"Đăng nhập"}),n&&o.jsx("p",{className:"error-msg",children:n})]}),VK=()=>{const[e,t]=m.useState(""),[r,n]=m.useState(""),[a,i]=m.useState(null),[s,l]=m.useState(!1),{setUser:c}=om(),u=kN();return{email:e,password:r,error:a,loading:s,setEmail:t,setPassword:n,handleSubmit:f=>{f.preventDefault(),i(null),l(!0),Ue("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async h=>{if(!h.ok){const x=await h.json().catch(()=>({}));throw new Error(x.error||"Login failed")}const p=await h.json();c(p.user||null),u("/dashboard",{replace:!0})}).catch(h=>{i(h instanceof Error?h.message:"Login failed")}).finally(()=>l(!1))}}},KK=()=>{const{email:e,password:t,error:r,loading:n,setEmail:a,setPassword:i,handleSubmit:s}=VK();return o.jsx("div",{className:"login-page retro-login",children:o.jsxs("div",{className:"login-page__shell retro-shell",children:[o.jsx(HK,{}),o.jsx(zK,{children:o.jsx(WK,{email:e,password:t,loading:n,error:r,onEmailChange:a,onPasswordChange:i,onSubmit:s})})]})})},GK=async e=>{const t=await Ue(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Nguồn đã được xóa trước đó."};if(!t.ok){const n=await t.text();throw new Error(n||"Không thể xóa nguồn.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},XK=({stats:e})=>o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx(Ta,{title:"Tổng NCC",value:e.totalSuppliers,icon:dk,accent:vr.sky}),o.jsx(Ta,{title:"Đang hoạt động",value:e.activeSuppliers,icon:Ui,accent:vr.emerald}),o.jsx(Ta,{title:"Tổng đơn",value:e.monthlyOrders,icon:hd,accent:vr.violet}),o.jsx(Ta,{title:"Tổng nhập",value:Lz(e.totalImportValue),icon:dd,accent:vr.amber})]}),A2=e=>e.trim().toLowerCase(),mh=e=>{const r=String(e||"").replace(/[^\d-]/g,""),n=r.startsWith("-")?"-"+r.slice(1).replace(/-/g,""):r.replace(/-/g,""),a=Number(n);return Number.isFinite(a)?a:0},YK=o0,xh=Tn,qK=({supplyId:e,onRefreshSupplies:t})=>{const[r,n]=m.useState([]),[a,i]=m.useState(!1),[s,l]=m.useState({round:"",import:"",paid:"",isEditing:!1}),[c,u]=m.useState(null),[d,f]=m.useState(""),h=b=>{const w=String(b||"").replace(/[^\d-]/g,""),y=w.startsWith("-")?"-"+w.slice(1).replace(/-/g,""):w.replace(/-/g,"");if(y==="-")return"-";const N=Number(y);return Number.isFinite(N)?N.toLocaleString("vi-VN"):""},p=m.useCallback(async()=>{i(!0);try{const b=await Ue(`/api/supplies/${e}/payments?offset=0&limit=20`);if(b.ok){const w=await b.json();n(w.payments||[])}}finally{i(!1)}},[e]);m.useEffect(()=>{p()},[p]);const x=async()=>{if(s.round)try{const b={round:s.round,totalImport:mh(s.import),paid:mh(s.paid),status:"Chưa Thanh Toán"};(await Ue(`/api/supplies/${e}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok&&(l({round:"",import:"",paid:"",isEditing:!1}),p(),t?.())}catch(b){console.error(b)}},g=async b=>{try{await Ue(`/api/supplies/${e}/payments/${b}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:mh(d)})}),u(null),p(),t?.()}catch(w){console.error(w)}},v=b=>(b||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();return o.jsxs("div",{className:"bg-slate-900/80 rounded-xl border border-white/10 overflow-hidden",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center",children:[o.jsx("h4",{className:"text-sm font-semibold text-white",children:"Lịch Sử Thanh Toán"}),o.jsxs("button",{onClick:()=>l({...s,isEditing:!0}),className:"text-xs flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-white transition",children:[o.jsx(di,{className:"h-3 w-3"})," Thêm Chu Kỳ"]})]}),o.jsxs("table",{className:"w-full text-sm text-left text-white/80",children:[o.jsx("thead",{className:"bg-white/5 text-xs uppercase text-white/60",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Chu Kỳ"}),o.jsx("th",{className:"px-4 py-2",children:"Tổng Nhập"}),o.jsx("th",{className:"px-4 py-2",children:"Còn Nợ"}),o.jsx("th",{className:"px-4 py-2",children:"Đã Thanh Toán"}),o.jsx("th",{className:"px-4 py-2",children:"Trạng Thái"}),o.jsx("th",{className:"px-4 py-2 text-right",children:"Thao Tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[s.isEditing&&o.jsxs("tr",{className:"bg-indigo-500/10",children:[o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"Tên chu kỳ...",value:s.round,onChange:b=>l({...s,round:b.target.value})})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:s.import,onChange:b=>l({...s,import:h(b.target.value)})})}),o.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"—"}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:s.paid,onChange:b=>l({...s,paid:h(b.target.value)})})}),o.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"Mới"}),o.jsxs("td",{className:"px-4 py-2 text-right",children:[o.jsx("button",{onClick:x,className:"text-emerald-400 hover:text-emerald-300 mr-2",children:o.jsx(Hn,{className:"h-5 w-5 inline"})}),o.jsx("button",{onClick:()=>l({...s,isEditing:!1}),className:"text-rose-400 hover:text-rose-300",children:o.jsx(Pt,{className:"h-5 w-5 inline"})})]})]}),a?o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"text-center py-4",children:"Đang tải..."})}):r.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"text-center py-4 opacity-50",children:"Chưa có dữ liệu thanh toán"})}):r.map(b=>{const w=v(b.status)==="chua thanh toan";return o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-4 py-2",children:b.round}),o.jsx("td",{className:"px-4 py-2",children:c===b.id?o.jsx("input",{className:"bg-black/20 border border-white/20 rounded px-1 w-24 text-right",value:d,onChange:y=>f(h(y.target.value))}):b.totalImport>=0?xh(b.totalImport):"—"}),o.jsx("td",{className:`px-4 py-2 ${b.totalImport<0?"text-rose-400 font-semibold":""}`,children:b.totalImport<0?xh(Math.abs(b.totalImport)):"—"}),o.jsx("td",{className:"px-4 py-2",children:xh(b.paid)}),o.jsx("td",{className:"px-4 py-2",children:b.status}),o.jsx("td",{className:"px-4 py-2 text-right",children:c===b.id?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>g(b.id),className:"text-emerald-400 mr-2",children:o.jsx(Hn,{className:"h-4 w-4 inline"})}),o.jsx("button",{onClick:()=>u(null),className:"text-rose-400",children:o.jsx(Pt,{className:"h-4 w-4 inline"})})]}):w&&o.jsx("button",{onClick:()=>{u(b.id),f(b.totalImport.toLocaleString("vi-VN"))},className:"text-white/40 hover:text-blue-300",children:o.jsx(is,{className:"h-4 w-4 inline"})})})]},b.id)})]})]})]})},gh=Tn,ZK=e=>e?yt(e):"--",JK=({supply:e,onToggleStatus:t,onView:r,onEdit:n,onDelete:a})=>{const i=e.isActive?"bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"bg-slate-500/20 text-slate-300 border-slate-500/30";return o.jsxs("div",{className:"relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[o.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${e.isActive?"bg-emerald-500":"bg-slate-500"}`}),o.jsxs("div",{className:"relative z-10 flex flex-col gap-4",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),o.jsx("h3",{className:"text-sm font-bold text-white truncate",children:e.sourceName||"Không Tên"})]}),o.jsx("span",{className:`px-2.5 py-1 shrink-0 rounded-xl text-[10px] font-bold uppercase tracking-wide border shadow-lg ${i}`,children:e.isActive?"Hoạt động":"Tạm dừng"})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-2xl bg-white/5 border border-white/5",children:[o.jsx(AC,{className:"w-5 h-5 text-indigo-300 shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex flex-col min-w-0",children:[o.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-widest mb-0.5",children:"Tài khoản"}),o.jsx("p",{className:"text-sm font-bold text-white truncate",children:e.numberBank||"--"}),o.jsx("p",{className:"text-xs text-indigo-200/70 truncate",children:e.bankName})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"flex flex-col p-2.5 rounded-xl bg-white/5 border border-white/5",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Tháng này"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(hd,{className:"w-3.5 h-3.5 text-emerald-400"}),o.jsxs("span",{className:"text-xs font-bold text-white",children:[e.monthlyOrders," đơn"]})]}),o.jsx("span",{className:"text-[10px] font-medium text-emerald-400/80 mt-0.5 ml-5",children:gh(e.monthlyImportValue)})]}),o.jsxs("div",{className:"flex flex-col p-2.5 rounded-xl bg-white/5 border border-white/5",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Công nợ"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(dd,{className:"w-3.5 h-3.5 text-orange-400"}),o.jsx("span",{className:"text-xs font-bold text-orange-400",children:gh(Math.min(0,e.totalUnpaidImport||0))})]}),o.jsxs("span",{className:"text-[10px] font-medium text-white/40 mt-0.5 ml-5",children:["Đã trả: ",gh(e.totalPaidImport)]})]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-1 border-t border-white/5 mt-1",children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Lần cuối"}),o.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:ZK(e.lastOrderDate)})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>t(e),className:`w-9 h-9 flex items-center justify-center rounded-xl border transition-all active:scale-90 ${e.isActive?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400 hover:bg-emerald-500 hover:text-white":"bg-white/5 border-white/10 text-white/30 hover:bg-white/10 hover:text-white"}`,children:o.jsx(fd,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>r(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-blue-500/10 border border-blue-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all active:scale-90",children:o.jsx(ma,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>n(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-400 hover:bg-amber-500 hover:text-white transition-all active:scale-90",children:o.jsx(is,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>a(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500 hover:text-white transition-all active:scale-90",children:o.jsx(Kr,{className:"h-4 w-4"})})]})]})]})]})},Nc=Tn,QK=e=>e?yt(e):"--",eG=({supplies:e,loading:t,expandedId:r,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l,onRefreshSupplies:c})=>o.jsx("div",{className:"supply-list glass-panel-dark border border-white/5 rounded-[32px] overflow-hidden shadow-2xl backdrop-blur-xl",children:o.jsx(bg,{className:"supply-list__inner",showCardOnMobile:!0,cardView:t?o.jsx("div",{className:"p-8 text-center text-white/50",children:"Đang tải..."}):e.length===0?o.jsx("div",{className:"p-8 text-center text-white/50",children:"Chưa có nhà cung cấp nào"}):o.jsx(yg,{data:e,renderCard:u=>o.jsx(JK,{supply:u,onToggleStatus:l,onView:s,onEdit:a,onDelete:i}),className:"p-4"}),children:o.jsxs("table",{className:"supply-list__table w-full text-left",children:[o.jsx("thead",{className:"supply-list__head bg-white/5 text-[10px] uppercase text-indigo-300/40 font-bold tracking-[0.2em]",children:o.jsxs("tr",{children:[o.jsx("th",{className:"supply-list__th px-4 py-3",children:"Nhà cung cấp"}),o.jsx("th",{className:"px-4 py-3",children:"Tài khoản"}),o.jsx("th",{className:"px-4 py-3",children:"Tháng này"}),o.jsx("th",{className:"px-4 py-3",children:"Lần cuối"}),o.jsx("th",{className:"px-4 py-3",children:"Đã trả"}),o.jsx("th",{className:"px-4 py-3",children:"Còn nợ"}),o.jsx("th",{className:"px-4 py-3",children:"Thanh toán"}),o.jsx("th",{className:"px-4 py-3 text-center",children:"TT"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Thao tác"})]})}),o.jsx("tbody",{className:"divide-y divide-white/5",children:t?o.jsx("tr",{children:o.jsx("td",{colSpan:9,className:"text-center py-8 text-white/50",children:"Đang tải..."})}):e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:9,className:"text-center py-8 text-white/50",children:"Chưa có nhà cung cấp nào"})}):e.map(u=>o.jsx(tG,{supply:u,isExpanded:r===u.id,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l,onRefreshSupplies:c},u.id))})]})})}),tG=({supply:e,isExpanded:t,onToggle:r,onEdit:n,onDelete:a,onView:i,onToggleStatus:s,onRefreshSupplies:l})=>o.jsxs(o.Fragment,{children:[o.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:bg-white/5 cursor-pointer transition border-b border-white/5",onClick:()=>r(e.id),children:[o.jsxs("td",{className:"px-4 py-4",children:[o.jsx("div",{className:"font-medium text-white",children:e.sourceName||"Không Tên"}),o.jsxs("div",{className:"text-xs text-white/60",children:["Tổng đơn: ",e.totalOrders]})]}),o.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[o.jsx("div",{children:e.numberBank||"--"}),o.jsx("div",{className:"text-xs text-white/50",children:e.bankName})]}),o.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[o.jsxs("div",{children:[e.monthlyOrders," Đơn"]}),o.jsx("div",{className:"text-xs text-emerald-400",children:Nc(e.monthlyImportValue)})]}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:QK(e.lastOrderDate)}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Nc(e.totalPaidImport)}),o.jsx("td",{className:"px-4 py-4 font-bold text-orange-400 text-sm",children:Nc(Math.min(0,e.totalUnpaidImport||0))}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Nc(Math.max(0,e.totalUnpaidImport||0))}),o.jsx("td",{className:"px-4 py-4 text-center",children:o.jsx("button",{onClick:c=>{c.stopPropagation(),s(e)},className:`w-8 h-8 rounded-xl flex items-center justify-center transition-all active:scale-90 ${e.isActive?"bg-emerald-500 text-white shadow-[0_0_12px_rgba(16,185,129,0.3)]":"bg-white/5 text-white/30 border border-white/10"}`,children:o.jsx(fd,{className:"h-4 w-4"})})}),o.jsx("td",{className:"px-4 py-4 text-right",children:o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:c=>{c.stopPropagation(),i(e)},className:"p-1.5 rounded-lg bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",children:o.jsx(ma,{className:"h-4 w-4"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),n(e)},className:"p-1.5 rounded-lg bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-90",children:o.jsx(is,{className:"h-4 w-4"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),a(e)},className:"p-1.5 rounded-lg bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",children:o.jsx(Kr,{className:"h-4 w-4"})})]})})]}),t&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-0 pb-4 pt-0 bg-indigo-950/30",children:o.jsx("div",{className:"p-4 border-b border-white/10 shadow-inner",children:o.jsx(qK,{supplyId:e.id,onRefreshSupplies:l})})})})]}),rG=(e,t)=>{const[r,n]=m.useState(!1),[a,i]=m.useState(null),[s,l]=m.useState(null),c=m.useCallback(async()=>{if(e){n(!0),i(null);try{const u=await Ue(`/api/supplies/${e}/overview`),d=await u.json();if(!u.ok)throw new Error(d?.error||"Không tải được chi tiết");l(d)}catch(u){i(u?.message||"Đã có lỗi xảy ra")}finally{n(!1)}}},[e]);return m.useEffect(()=>{t&&e?c():t||(l(null),i(null))},[t,e,c]),{overview:s,loading:r,error:a,fetchOverview:c,setError:i}},nG=({supply:e,fetchOverview:t,onRefreshList:r})=>{const[n,a]=m.useState(null),[i,s]=m.useState(null);return{confirmingId:n,qrPayment:i,confirmPayment:async u=>{a(u);try{const d=await Ue(`/api/payment-supply/${u}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f?.error||"Không thể thanh toán chu kỳ")}return await t(),s(null),r?.(),{success:!0}}catch(d){return{success:!1,error:d?.message||"Không thể thanh toán chu kỳ"}}finally{a(null)}},showQrForPayment:u=>{const d=(u.totalImport||0)-(u.paid||0),f=Math.abs(d),h=d>0,p=(()=>{const w=new Date,y=String(w.getDate()).padStart(2,"0"),N=String(w.getMonth()+1).padStart(2,"0"),S=w.getFullYear();return`${y}/${N}/${S}`})(),x=h?e?.numberBank||"":"9183400998",g=h?e?.binBank||"":"VPB",v=h?e?.nameBank||"":"NGO LE NGOC HUNG",b=YK({accountNumber:x,bankCode:g,amount:f,description:u.round||p,accountName:v});s({id:u.id,amount:f,url:b,round:u.round||""})},setQrPayment:s}},aG=({isOpen:e,onClose:t,supplyId:r,banks:n=[],onRefreshList:a})=>{const{overview:i,loading:s,error:l,fetchOverview:c,setError:u}=rG(r,e),{confirmingId:d,confirmPayment:f}=nG({supply:i?.supply,fetchOverview:c,onRefreshList:a}),[h,p]=m.useState(null),x=i?.supply,g=i?.stats,v=i?.unpaidPayments||[],b=v.find(T=>T.id===h)||v[0]||null,w=m.useMemo(()=>{if(!x||!b)return null;const T=Number(b.totalImport||b.import_value||0),k=b.round||`PAY ${x.id}`;return!x.numberBank||!x.binBank?null:o0({accountNumber:x.numberBank,bankCode:x.binBank,amount:Math.max(0,T),description:k,accountName:x.nameBank||x.sourceName||""})},[x,b]),y=async T=>{const k=await f(T);k.success||u(k.error||"Không thể thanh toán chu kỳ")},N=()=>{p(null),t()};if(!e||!r)return null;const S=v.reduce((T,k)=>T+Math.max(0,(k.totalImport||0)-(k.paid||0)),0),E=g?.monthlyOrders||[],_=x?.isActive?"Đang hoạt động":"Tạm dừng";x?.isActive;const j=x?.bankName||n.find(T=>(T.bin||"").trim()===(x?.binBank||"").trim())?.name||x?.binBank||"--",A=[{label:"Tổng đơn",value:g?.totalOrders??0},{label:"Đã thanh toán",value:g?.paidOrders??0},{label:"Chưa thanh toán",value:g?.unpaidOrders??0},{label:"Đã hủy",value:g?.canceledOrders??0}];return o.jsx(o.Fragment,{children:o.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60 p-2",onClick:N,children:o.jsxs("div",{className:"glass-panel-dark border border-white/5 p-5 md:p-6 rounded-[32px] text-white w-full max-w-4xl max-h-[95vh] shadow-2xl overflow-y-auto custom-scroll",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"flex-1"}),o.jsx("h2",{className:"text-xl font-bold text-center",children:"Chi tiết Nhà Cung Cấp"}),o.jsx("div",{className:"flex-1 flex justify-end",children:o.jsx("button",{onClick:N,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70","aria-label":"Đóng",children:o.jsx(Pt,{className:"h-6 w-6"})})})]}),s?o.jsx("div",{className:"mt-6 text-center text-white/70",children:"Đang tải chi tiết..."}):l?o.jsxs("div",{className:"mt-6 bg-rose-500/10 text-rose-200 border border-rose-500/40 rounded-xl p-4 flex items-center justify-between gap-3",children:[o.jsx("span",{children:l}),o.jsx("button",{onClick:c,className:"px-3 py-1 rounded-lg bg-rose-500 text-white text-sm hover:bg-rose-600",children:"Thử lại"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-5",children:[o.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/5 p-5 space-y-4",children:[o.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80",children:"Thông tin chung"}),o.jsxs("div",{className:"text-sm text-white/80 space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[o.jsx("span",{className:"text-white/40",children:"Tên NCC"}),o.jsx("span",{className:"font-bold text-white",children:x?.sourceName||"--"})]}),o.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[o.jsx("span",{className:"text-white/40",children:"Ngân hàng"}),o.jsx("span",{className:"font-semibold text-white",children:j})]}),o.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[o.jsx("span",{className:"text-white/40",children:"Số tài khoản"}),o.jsx("span",{className:"font-mono font-semibold text-white",children:x?.numberBank||"--"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-white/40",children:"Trạng thái"}),o.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-bold uppercase ${x?.isActive?"text-emerald-400 bg-emerald-500/10":"text-white/50 bg-white/5"}`,children:_})]})]})]}),o.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/5 p-5 space-y-4",children:[o.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80",children:"Tổng quan thanh toán"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-white/80",children:[o.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[o.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Đã trả"}),o.jsx("p",{className:"text-lg font-bold text-white mt-1",children:Tn(g?.totalPaidAmount||0)})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[o.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Còn nợ"}),o.jsx("p",{className:"text-lg font-bold text-orange-400 mt-1",children:Tn(S)})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[o.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Nợ đơn"}),o.jsx("p",{className:"text-lg font-bold text-white mt-1",children:g?.unpaidOrders??0})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[o.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Đã xong"}),o.jsx("p",{className:"text-lg font-bold text-white mt-1",children:g?.paidOrders??0})]})]})]})]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-3",children:A.map(T=>o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:T.label}),o.jsx("p",{className:"text-xl font-semibold",children:T.value})]},T.label))}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-3 items-start",children:[o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Chu kỳ chưa thanh toán"}),o.jsxs("span",{className:"text-xs text-white/60",children:["Còn nợ ",Tn(S)]})]}),v.length===0?o.jsx("p",{className:"text-white/50 text-sm",children:"Không có chu kỳ nợ."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-1.5 max-h-28 overflow-y-auto custom-scroll scroll-overlay mb-3",children:v.map(T=>o.jsxs("div",{onClick:()=>p(T.id),className:`w-full flex items-center justify-between rounded-lg px-3 py-2 border transition cursor-pointer ${b?.id===T.id?"border-indigo-500 bg-indigo-500/20":"border-white/5 bg-white/5 hover:bg-white/10"}`,children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:T.round||"Chu kỳ"}),o.jsx("p",{className:"text-xs text-white/60",children:T.status})]}),o.jsxs("div",{className:"text-right text-sm mr-2",children:[o.jsx("p",{className:"text-rose-400 font-semibold",children:Tn(T.totalImport||0)}),o.jsxs("p",{className:"text-white/40 text-xs",children:["Đã trả: ",Tn(T.paid||0)]})]}),o.jsx("button",{disabled:d===T.id,onClick:k=>{k.stopPropagation(),y(T.id)},className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-60 font-semibold transition flex-shrink-0",children:d===T.id?"...":"Thanh toán"})]},T.id))}),b&&o.jsx("div",{className:"flex justify-center mt-2",children:w?o.jsx("img",{src:w,alt:"QR",className:"w-64 rounded-lg shadow-lg"}):o.jsx("div",{className:"w-64 h-64 bg-white/10 rounded-lg flex items-center justify-center text-xs text-center p-2",children:"Thiếu thông tin NH"})})]})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Đơn theo tháng"}),o.jsxs("span",{className:"text-xs text-white/60",children:[E.length," tháng"]})]}),E.length===0?o.jsx("p",{className:"text-white/50 text-sm",children:"Chưa có dữ liệu."}):o.jsx("div",{className:"space-y-1.5 max-h-80 overflow-y-auto custom-scroll scroll-overlay",children:E.map(T=>o.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5",children:[o.jsxs("span",{className:"text-sm font-semibold",children:["Tháng ",T.month]}),o.jsxs("span",{className:"text-sm",children:[T.orders," đơn"]})]},T.month))})]})]}),o.jsx("div",{className:"mt-4 text-right",children:o.jsx("button",{onClick:N,className:"px-10 py-2.5 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 text-white font-bold transition-all active:scale-95",children:"Đóng"})})]})]})})})},iG=()=>{const[e,t]=m.useState([]),[r,n]=m.useState({totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0}),[a,i]=m.useState(!1),[s,l]=m.useState(null),c=m.useCallback(async()=>{i(!0);try{const d=await Ue("/api/supply-insights");if(!d.ok)throw new Error("Lỗi tải dữ liệu");const f=await d.json(),h=(f.supplies||[]).map(p=>{const x=p.isActive??(p.status!=="inactive"&&p.status!=="tạm dừng");return{...p,isActive:x,status:x?"active":"inactive",products:Array.isArray(p.products)?p.products.filter(Boolean):[]}});t(h),n({totalSuppliers:Number(f.stats?.totalSuppliers)||0,activeSuppliers:Number(f.stats?.activeSuppliers)||h.filter(p=>p.isActive).length,monthlyOrders:Number(f.stats?.monthlyOrders)||0,totalImportValue:Number(f.stats?.totalImportValue)||0})}catch(d){l(d instanceof Error?d.message:"Lỗi không xác định")}finally{i(!1)}},[]);return{supplies:e,stats:r,loading:a,error:s,fetchSupplies:c,setSupplies:t,toggleStatus:async(d,f)=>{t(h=>h.map(p=>p.id===d?{...p,isActive:!f,status:f?"inactive":"active"}:p));try{await Ue(`/api/supplies/${d}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!f})}),await c()}catch{t(h=>h.map(p=>p.id===d?{...p,isActive:f,status:f?"active":"inactive"}:p)),Tr({type:"error",title:"Lỗi cập nhật trạng thái",message:"Không thể cập nhật trạng thái"})}}}},sG=({isOpen:e,onClose:t,onSuccess:r,banks:n})=>{const[a,i]=m.useState({sourceName:"",numberBank:"",bankBin:"",status:"active"}),[s,l]=m.useState(!1),[c,u]=m.useState(null);if(m.useEffect(()=>{e&&n.length>0&&!a.bankBin&&i(f=>({...f,bankBin:n[0].bin}))},[e,n,a.bankBin]),!e)return null;const d=async f=>{if(f.preventDefault(),!a.sourceName.trim())return u("Tên không được để trống");l(!0),u(null);try{const h=await Ue("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:a.sourceName,number_bank:a.numberBank,bin_bank:a.bankBin,status:a.status})});if(!h.ok)throw new Error((await h.json()).error||"Lỗi khi tạo");r(),t(),i({sourceName:"",numberBank:"",bankBin:n[0]?.bin||"",status:"active"})}catch(h){u(h instanceof Error?h.message:"Lỗi tạo nhà cung cấp")}finally{l(!1)}};return o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4 animate-in fade-in",onClick:t,children:o.jsxs("div",{className:"glass-panel-dark rounded-[32px] shadow-2xl w-full max-w-md p-8 border border-white/10 animate-in zoom-in-95 duration-300",onClick:f=>f.stopPropagation(),children:[o.jsx("h3",{className:"text-2xl font-bold text-white mb-6 tracking-tight",children:"Thêm Nhà Cung Cấp Mới"}),c&&o.jsx("p",{className:"text-sm text-red-600 mb-3",children:c}),o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-indigo-300/50 mb-2 ml-1",children:"Tên Nhà Cung Cấp"}),o.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl p-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-white/20",value:a.sourceName,onChange:f=>i({...a,sourceName:f.target.value}),placeholder:"Nhập tên..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.numberBank,onChange:f=>i({...a,numberBank:f.target.value}),placeholder:"STK..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),o.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:a.bankBin,onChange:f=>i({...a,bankBin:f.target.value}),children:n.map(f=>o.jsx("option",{value:f.bin,children:f.name||f.bin},f.bin))})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),o.jsx(An,{type:"submit",disabled:s,className:"!py-2.5 !px-8 text-sm",children:s?"Đang xử lý...":"Thêm Mới"})]})]})]})})},oG=({isOpen:e,onClose:t,onSuccess:r,supply:n,banks:a})=>{const[i,s]=m.useState({sourceName:"",numberBank:"",bankBin:""}),[l,c]=m.useState(!1),[u,d]=m.useState(null);if(m.useEffect(()=>{n&&s({sourceName:n.sourceName||"",numberBank:n.numberBank||"",bankBin:n.binBank||a[0]?.bin||""})},[n,a]),!e||!n)return null;const f=async h=>{h.preventDefault(),c(!0);try{if(!(await Ue(`/api/supplies/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:i.sourceName,number_bank:i.numberBank,bin_bank:i.bankBin})})).ok)throw new Error("Lỗi cập nhật");r(),t()}catch(p){d(p instanceof Error?p.message:"Lỗi cập nhật")}finally{c(!1)}};return o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4 animate-in fade-in",onClick:t,children:o.jsxs("div",{className:"glass-panel-dark rounded-[32px] shadow-2xl w-full max-w-lg p-8 border border-white/10 animate-in zoom-in-95 duration-300",onClick:h=>h.stopPropagation(),children:[o.jsx("h3",{className:"text-2xl font-bold text-white mb-6 tracking-tight",children:"Chỉnh Sửa Thông Tin"}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tên Nhà Cung Cấp"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.sourceName,onChange:h=>s({...i,sourceName:h.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.numberBank,onChange:h=>s({...i,numberBank:h.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),o.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:i.bankBin,onChange:h=>s({...i,bankBin:h.target.value}),children:a.map(h=>o.jsx("option",{value:h.bin,children:h.name||h.bin},h.bin))})]}),u&&o.jsx("p",{className:"text-sm text-red-500",children:u}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),o.jsx(An,{type:"submit",disabled:l,className:"!py-2.5 !px-8 text-sm",children:"Lưu Thay Đổi"})]})]})]})})},lG=({isOpen:e,onClose:t,onConfirm:r,supplyName:n})=>e?o.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/90 backdrop-blur-md p-4 animate-in fade-in",children:o.jsxs("div",{className:"glass-panel-dark rounded-[32px] p-8 max-w-sm w-full shadow-2xl border border-rose-500/20 animate-in zoom-in-95 duration-300",children:[o.jsx("h3",{className:"text-2xl font-bold text-rose-500 mb-2 tracking-tight",children:"Xóa Nhà Cung Cấp?"}),o.jsxs("p",{className:"text-white/60 mb-8 leading-relaxed",children:["Bạn có chắc muốn xóa ",o.jsx("b",{children:n}),"? Hành động này không thể hoàn tác."]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),o.jsx("button",{onClick:r,className:"px-6 py-2.5 bg-rose-500 text-white font-bold rounded-2xl hover:bg-rose-600 transition-all active:scale-95 shadow-lg shadow-rose-500/20",children:"Xóa Vĩnh Viễn"})]})]})}):null;function cG(){const{supplies:e,stats:t,loading:r,fetchSupplies:n,toggleStatus:a}=iG(),[i,s]=m.useState(""),[l,c]=m.useState("all"),[u,d]=m.useState([]),[f,h]=m.useState(null),[p,x]=m.useState(!1),[g,v]=m.useState(null),[b,w]=m.useState(null),[y,N]=m.useState(null);m.useEffect(()=>{n(),Ue("/api/banks").then(_=>_.json()).then(_=>{Array.isArray(_)&&d(_.map(j=>({bin:j.bin,name:j.bank_name||j.bankName||j.name||j.bank||j.bin})))}).catch(console.error)},[n]);const S=m.useMemo(()=>{const _=A2(i),j=e.filter(T=>{const k=!_||A2(T.sourceName).includes(_),C=l==="all"||(l==="active"?T.isActive:!T.isActive);return k&&C}),A=T=>{if(!T)return 0;const k=new Date(T).getTime();return Number.isFinite(k)?k:0};return j.sort((T,k)=>{const C=Number(T.totalUnpaidImport)||0,L=Number(k.totalUnpaidImport)||0,G=C>0,V=L>0;if(G!==V)return G?-1:1;const X=C<0,K=L<0;if(X!==K)return X?-1:1;if((G||X)&&C!==L)return L-C;const Y=A(T.lastOrderDate),q=A(k.lastOrderDate),Z=Y>0,le=q>0;if(Z!==le)return Z?-1:1;if(Y!==q)return q-Y;const ce=(k.totalOrders||0)-(T.totalOrders||0);return ce!==0?ce:T.sourceName.localeCompare(k.sourceName)})},[e,i,l]),E=async()=>{if(y){const _=await GK(y.id);_.success?(await n(),N(null)):Tr({type:"error",title:"Lỗi xóa nhà cung cấp",message:_.message||"Không thể xóa nhà cung cấp."})}};return o.jsxs("div",{className:"space-y-6 pb-20",children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản Lý Nguồn Hàng"}),o.jsx("p",{className:"text-white/60 text-sm",children:"Theo dõi công nợ và chu kỳ thanh toán từ các đối tác cung cấp."})]}),o.jsx(XK,{stats:t}),o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:"Tìm kiếm nhà cung cấp...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:i,onChange:_=>s(_.target.value)})]}),o.jsxs("div",{className:"flex w-full lg:w-auto gap-3 items-center",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx("div",{className:"relative w-full lg:w-[180px]",children:o.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:l,onChange:_=>c(_.target.value),children:[o.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Tất cả trạng thái"}),o.jsx("option",{value:"active",className:"bg-slate-900 text-white",children:"Đang hoạt động"}),o.jsx("option",{value:"inactive",className:"bg-slate-900 text-white",children:"Tạm dừng"})]})})]}),o.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx(An,{icon:di,onClick:()=>x(!0),className:"!py-2.5 !px-5 text-sm",children:"Thêm NCC"})]})]})}),o.jsx(eG,{supplies:S,loading:r,expandedId:f,onToggle:_=>h(j=>j===_?null:_),onEdit:v,onDelete:N,onView:_=>w(_.id),onToggleStatus:_=>a(_.id,_.isActive),onRefreshSupplies:n}),o.jsx(sG,{isOpen:p,onClose:()=>x(!1),onSuccess:n,banks:u}),o.jsx(oG,{isOpen:!!g,onClose:()=>v(null),onSuccess:n,supply:g,banks:u}),o.jsx(lG,{isOpen:!!y,onClose:()=>N(null),onConfirm:E,supplyName:y?.sourceName}),o.jsx(aG,{isOpen:!!b,onClose:()=>w(null),supplyId:b,banks:u,onRefreshList:n})]})}const vh=e=>e.toLocaleString("vi-VN"),Pi=e=>{const t=Number(e);return Number.isFinite(t)?t:0},_c=e=>(e||"").trim().toLowerCase(),Sc=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},Ds=e=>(e||"").trim().toLowerCase(),bh=e=>{const t=Number(e);return Number.isFinite(t)?t:0},uG=e=>{const t=bh(e?.price),r=bh(e?.resellPrice),n=bh(e?.promoPrice);return{price:t||r||n||0,promoPrice:n||0,resellPrice:r||void 0}},dG=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},fG=(e,t)=>{if(e){const u=kn(e.price||0),d=e.promoPrice>0?kn(e.promoPrice):0;return{unitPrice:u,discount:d}}const r=t?.basePrice??t?.unitPrice??0,n=t?.pctPromo!==void 0?Pi(t.pctPromo):0,a=n>1?n/100:Math.max(0,n),i=t?.pctKhach!==void 0&&t?.pctKhach>0?t.pctKhach:1,s=t?.pctCtv!==void 0&&t?.pctCtv>0?t.pctCtv:1,l=kn(r*i*s),c=a>0?kn(l*a):0;return{unitPrice:l,discount:c}},P2=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),a=[],i=(l,c)=>{if(l.nodeType===Node.TEXT_NODE){c.push((l.textContent||"").replace(/\u00a0/g," "));return}if(l.nodeType===Node.ELEMENT_NODE){const u=l;if(u.tagName==="BR"){c.push(`
`);return}const d=[];u.childNodes.forEach(h=>i(h,d));const f=d.join("");c.push(f),n.has(u.tagName)&&c.push(`
`)}},s=[];return r.body.childNodes.forEach(l=>i(l,s)),s.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e||""}},hG=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},pG=(e,t)=>{const r=new Set,n=[];return e.forEach(a=>{const s=(a?.[zt.code]||a?.san_pham||"").trim();if(!s)return;const l=s.toLowerCase();if(r.has(l))return;r.add(l);const c=dG(s),u=Pi(a?.pct_khach??a?.[zt.pctKhach]),d=Pi(a?.pct_ctv??a?.[zt.pctCtv]),f=u>10?u/100:u>0?u:1,h=d>10?d/100:d>0?d:1,p=Pi(a?.pct_promo??a?.[zt.pctPromo]),x=p>1?p/100:Math.max(0,p),g=Pi(a?.max_supply_price),v=Pi(a?.computed_retail_price??a?.retail_price??a?.gia_le??a?.gia_ban)||0,b=Pi(a?.computed_promo_price??a?.promo_price??a?.gia_khuyen_mai??a?.gia_km)||0,w=g>0?kn(g):0,N=(v||b||w)*(h>0?h:1)*(f>0?f:1),S=kn(N),E=S*(1-x),_=kn(E),j=Math.min(S,w>0?Math.max(w,_):_),A=j>0?S-j:0,T=a?.[zt.variantName]||a?.package_product||a?.package_product_label||"",k=T?`${T} (${s})`:a?.package?`${a?.package} (${s})`:s,C=Ds(s),L=t[C];n.push({productId:s,value:s,productDisplay:a?.package||s,packageDisplay:T||a?.package||s,label:k,durationMonths:c.months,durationDays:c.days,term:c.days?`${c.days} ngày`:"",unitPrice:S,discountValue:A,basePrice:L?.price??L?.resellPrice??v??S,promoPrice:L?.promoPrice??0,pctPromo:x,pctKhach:f,pctCtv:h,wholesalePrice:w})}),n.sort((a,i)=>a.label.localeCompare(i.label,"vi"))},Ts="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",mG=({recipient:e,onRecipientChange:t,quoteDate:r,onQuoteDateChange:n,quoteCode:a,contact:i,onContactChange:s,productSearch:l,onProductSearchChange:c,filteredOptions:u,selectedProductKeys:d,onToggleProduct:f,onAddSelectedProduct:h,onResetSearch:p,lines:x,onRemoveLine:g,onDownload:v})=>o.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[o.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thông tin báo giá"})}),o.jsxs("div",{className:"px-6 py-5 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Kính gửi"}),o.jsx("input",{type:"text",value:e,onChange:b=>t(b.target.value),className:Ts})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Ngày"}),o.jsx("input",{type:"date",value:r,onChange:b=>n(b.target.value),className:Ts})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Mã báo giá"}),o.jsx("input",{value:a,readOnly:!0,className:`${Ts} opacity-80`})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Liên hệ"}),o.jsx("input",{type:"text",value:i,onChange:b=>s(b.target.value),className:Ts,placeholder:"Email / SDT"})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi chú (tùy chọn)"}),o.jsx("input",{type:"text",className:Ts,placeholder:"Thông tin thêm cho báo giá"})]})]}),o.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[o.jsx("label",{className:"text-sm font-semibold text-white block",children:"Mã sản phẩm"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[o.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),className:`${Ts} text-sm`,placeholder:"Tìm sản phẩm..."}),o.jsx("button",{type:"button",onClick:p,className:"px-3 py-2 text-sm rounded-lg border border-white/20 bg-white/5 text-white hover:border-white/40 transition-colors",children:"Xóa Tìm Kiếm"})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:u.map(b=>{const w=d.includes(b.value);return o.jsx("button",{type:"button",onClick:()=>f(b.value),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${w?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:b.label,children:b.label},b.value)})}),o.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[o.jsx("button",{type:"button",onClick:h,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!d.length,children:"Thêm"}),o.jsx("button",{type:"button",onClick:v,className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),x.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[b.product,o.jsx("button",{type:"button",onClick:()=>g(b.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xoa",children:"x"})]},b.id))})]})]})]}),xG=({rows:e})=>o.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[o.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),o.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TÊN SẢN PHẨM"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GÓI"}),o.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THỜI GIAN"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"ĐƠN GIÁ"}),o.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIẢM GIÁ"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THANH TIỀN"}),o.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CHÚ"})]})}),o.jsx("tbody",{children:e.map((t,r)=>o.jsxs("tr",{className:"align-top",children:[o.jsx("td",{className:"border border-slate-600 text-center py-2",children:r+1}),o.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:t.product,children:t.product}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.packageName||t.term}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.durationMonths?`${t.durationMonths} tháng`:t.durationDays?`${t.durationDays} ngày`:t.term||"--"}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:vh(t.unitPrice)}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:vh(t.discount||0)}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:vh(t.total)}),o.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:t.note||""})]},t.id))})]}),gG=({sections:e})=>{const t=o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Quy Tắc"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."}),o.jsx("p",{className:"font-semibold mt-3",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."})]});return o.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[e.length===0?t:e.map(r=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-semibold",children:r.name}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Quy tắc"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.rules||"Chưa cập nhật."})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.description||"Chưa cập nhật."})]})]},r.name)),o.jsxs("div",{className:"pt-2 text-sm",children:[o.jsx("p",{className:"font-semibold",children:"Mọi thông tin chi tiết có thể liên hệ:"}),o.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Tài Khoản Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]})},xT="/assets/sign-DzA7EGyE.png",vG=()=>o.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:o.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[o.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),o.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(Ký, ghi rõ họ tên)"}),o.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:o.jsx("img",{src:xT,alt:"Chữ ký",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}})})]})}),bG={};var yG={};const wG="/mavryk-logo.png",O2=typeof import.meta<"u"&&bG?.VITE_API_BASE_URL||typeof process<"u"&&yG?.VITE_API_BASE_URL||""||"http://localhost:3001";function NG(){m.useEffect(()=>{const V=document.title;return document.title="Mavryk Premium Store",()=>{document.title=V}},[]);const[e,t]=m.useState(new Date().toISOString().slice(0,10)),[r,n]=m.useState(""),[a,i]=m.useState(""),[s,l]=m.useState([]),[c,u]=m.useState([]),[d,f]=m.useState(""),[h,p]=m.useState({}),x=m.useRef({}),[g,v]=m.useState([]),[b,w]=m.useState([]),y=m.useMemo(()=>{const V=b.map(K=>({...K,total:(K.unitPrice-(K.discount||0))*K.quantity})),X=V.reduce((K,Y)=>K+Y.total,0);return{rows:V,grandTotal:X}},[b]);m.useEffect(()=>{let V=!0;return(async()=>{try{const Y=await fetch(`${O2}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(!Y.ok)throw new Error("Failed to load variant pricing");const q=await Y.json();if(!V)return;Array.isArray(q)?l(q):q?.items&&Array.isArray(q.items)?l(q.items):l([])}catch(Y){console.error("Khong the tai pricing:",Y)}})(),(async()=>{try{const Y=await fetch(`${O2}${Je.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!Y.ok)throw new Error("Failed to load product_desc");const q=await Y.json();V&&q?.items&&Array.isArray(q.items)&&u(q.items.map(Z=>({productId:Z.productId||Z.product_id||"",rules:Z.rules??"",description:Z.description??""})))}catch(Y){console.error("Khong the tai product_desc:",Y)}})(),()=>{V=!1}},[]);const N=m.useCallback(async V=>{const X=V.map(Z=>({original:Z,key:Ds(Z)})).filter(Z=>Z.key);if(!X.length)return h;const K=X.filter(Z=>!h[Z.key]);if(!K.length)return h;const Y={},q=[];return K.forEach(({original:Z,key:le})=>{if(x.current[le]){q.push(x.current[le].then(me=>{me&&(Y[le]=me)}));return}const ce=(async()=>{try{const me=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({san_pham_name:Z,id_product:Z,customer_type:"LE",for_quote:!0})}),Ne=await me.json().catch(()=>null);if(!me.ok)throw new Error(Ne?.error||"Fail calculate-price");return uG(Ne)}catch(me){return console.error("calculate-price failed",Z,me),null}})();x.current[le]=ce,q.push(ce.then(me=>{me&&(Y[le]=me)}).finally(()=>{delete x.current[le]}))}),q.length&&await Promise.all(q),Object.keys(Y).length?(p(Z=>({...Z,...Y})),{...h,...Y}):h},[h]),S=m.useMemo(()=>pG(s,h),[s,h]),E=m.useMemo(()=>{const V=new Map;return S.forEach(X=>{V.set(Ds(X.value),X)}),V},[S]),_=m.useMemo(()=>{const V=new Map;return s.forEach(X=>{const K=X?.[zt.code]||X?.san_pham||"",Y=X?.[zt.variantName]||X?.package_product||X?.package_product_label||"",q=_c(Sc(K));q&&Y&&V.set(q,Y)}),V},[s]),j=m.useMemo(()=>{const V=new Map;return c.forEach(X=>{const K=_c(Sc(X.productId));K&&V.set(K,X)}),V},[c]),A=m.useMemo(()=>{const V=d.trim().toLowerCase();return V?S.filter(X=>{const K=X.label.toLowerCase(),Y=X.value.toLowerCase(),q=X.productDisplay.toLowerCase();return K.includes(V)||Y.includes(V)||q.includes(V)}):S},[S,d]),T=m.useMemo(()=>{const V=new Set,X=[];return b.forEach(K=>{const Y=K.productCode||K.product||"",q=_c(Sc(Y));if(!q||V.has(q))return;V.add(q);const Z=j.get(q),le=_.get(q)||K.packageName||K.product;X.push({name:le,rules:P2(Z?.rules),description:P2(Z?.description)})}),X},[b,j,_]),k=async()=>{if(!g.length)return;const V=g.map(K=>K.trim()).filter(Boolean);if(!V.length)return;const X=await N(V);w(K=>{const Y=[...K];return V.forEach(q=>{const Z=E.get(Ds(q))??E.get(Ds(q.normalize("NFD").replace(/[\u0300-\u036f]/g,""))),le=(Y.length+1).toString(),ce=Z?.durationDays?`${Z.durationDays} ngày`:Z?.term||"",me=Ds(q),Ne=X[me],{unitPrice:ee,discount:oe}=fG(Ne,Z||{});Y.push({id:le,productCode:q,product:Z?.productDisplay||q,packageName:Z?.packageDisplay||_.get(_c(Sc(q)))||"",term:ce,durationMonths:Z?.durationMonths??null,durationDays:Z?.durationDays??null,unitPrice:ee,quantity:1,discount:oe})}),Y}),v([])},C=V=>w(X=>X.filter(K=>K.id!==V)),L=`BG-${(e||"").replaceAll("-","")||"----"}`;return o.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[o.jsx("style",{children:`
    /* Hide scrollbars while keeping scroll functionality */
    body {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    body::-webkit-scrollbar {
      display: none;
    }

    @media print {
      /* Hide everything except the printable quote */
      body { background: white !important; margin: 0 !important; padding: 0 !important; }
      body * { visibility: hidden !important; }
      #quote-print-area,
      #quote-print-area * { visibility: visible !important; }
      #quote-print-area {
        position: absolute;
        left: 0;
        top: 0;
        box-shadow: none !important;
        border: none !important;
      }
      .no-print { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
    }
  `}),o.jsx(mG,{recipient:r,onRecipientChange:n,quoteDate:e,onQuoteDateChange:t,quoteCode:L,contact:a,onContactChange:i,productSearch:d,onProductSearchChange:f,filteredOptions:A,selectedProductKeys:g,onToggleProduct:V=>v(X=>X.includes(V)?X.filter(K=>K!==V):[...X,V]),onAddSelectedProduct:k,onResetSearch:()=>f(""),lines:b,onRemoveLine:C,onDownload:()=>window.print()}),o.jsx("div",{className:"print-wrapper flex justify-center",children:o.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[o.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:o.jsx("img",{src:wG,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:V=>{V.currentTarget.style.display="none"}})}),o.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),o.jsx("p",{children:"SDT: 0378.304.963"}),o.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),o.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BẢNG BÁO GIÁ"}),o.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800 space-y-1",children:[o.jsxs("p",{children:["Ngày: ",o.jsx("strong",{children:hG(e)||"..."})]}),o.jsxs("p",{children:["Kính gửi: ",o.jsx("strong",{children:r})]}),a?o.jsxs("p",{children:["Thông tin liên hệ: ",o.jsx("strong",{children:a})]}):null,o.jsx("p",{className:"mt-3 italic",children:"Mavryk Premium Store trân trọng gửi lời cảm ơn và bản báo giá chi tiết sản phẩm theo yêu cầu của Quý khách. Chúng tôi cam kết mọi sản phẩm đều đạt tiêu chuẩn chất lượng cao cấp nhất, đảm bảo mang lại trải nghiệm tuyệt vời và xứng đáng với sự đầu tư của Quý khách."})]}),o.jsx(xG,{rows:y.rows}),o.jsx(gG,{sections:T}),o.jsx(vG,{})]})})})]})}const _G=({form:e,invoiceCodes:t,onChange:r,onAddInvoiceCode:n,onRemoveInvoiceCode:a,onSubmit:i})=>{const s=m.useId(),[l,c]=m.useState(null),u="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",d="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",f="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",h=p=>{p.key==="Enter"&&(p.preventDefault(),n())};return o.jsxs("div",{className:"bill-order-form rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[o.jsx("div",{className:"bill-order-form__header border-b border-slate-200 px-6 py-4",children:o.jsx("h2",{className:"bill-order-form__title text-lg font-semibold text-white",children:"Thông tin hóa đơn"})}),o.jsxs("form",{className:"bill-order-form__form px-6 py-5 space-y-4",onSubmit:i,children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:s,className:"text-sm font-medium text-slate-100",children:"Hóa đơn"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:d,onMouseLeave:()=>c(null),children:t.map(p=>o.jsxs("button",{type:"button",onClick:()=>a(p.id),onMouseEnter:()=>c(p.id),onMouseLeave:()=>c(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xóa hóa đơn ${p.code}`,children:[o.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:p.code}),o.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${l===p.id?"bg-white/20 text-red-500":""}`,children:o.jsx(Pt,{className:"h-4 w-4"})})]},p.id))}),o.jsx("div",{className:f,children:o.jsx("input",{id:s,type:"text",onMouseEnter:()=>c(null),onFocus:()=>c(null),onBlur:()=>c(null),value:e.invoiceCode,onChange:p=>r("invoiceCode",p.target.value),onKeyDown:h,className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhập mã hóa đơn và nhấn Enter"})})]})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngày"}),o.jsx("input",{type:"date",value:e.invoiceDate,onChange:p=>r("invoiceDate",p.target.value),className:u})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Mã số thuế"}),o.jsx("input",{type:"text",value:e.taxCode,onChange:p=>r("taxCode",p.target.value),className:u})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khách hàng / Công ty"}),o.jsx("input",{type:"text",value:e.customerName,onChange:p=>r("customerName",p.target.value),className:u})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),o.jsx("input",{type:"text",value:e.fax,onChange:p=>r("fax",p.target.value),className:u})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Địa chỉ"}),o.jsx("textarea",{value:e.address,onChange:p=>r("address",p.target.value),rows:2,className:`${u} resize-none`})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"SĐT"}),o.jsx("input",{type:"text",value:e.phone,onChange:p=>r("phone",p.target.value),className:u})]})]}),o.jsx("div",{className:"pt-2",children:o.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cập nhật thông tin"})})]})]})};let D2=0;const SG=e=>(D2+=1,{id:`inv-${Date.now().toString(36)}-${D2.toString(36)}`,code:e}),Ec=e=>(e||"").trim().toLowerCase(),I2=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},EG=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith(wt.COLLABORATOR)?wt.COLLABORATOR:t.startsWith(wt.STUDENT)?wt.STUDENT:t.startsWith(wt.RETAIL)?wt.RETAIL:t.startsWith(wt.PROMO)?wt.PROMO:t.startsWith(wt.GIFT)?wt.GIFT:null},yh=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},jG=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},Cs={name:"MAVRYK PREMIUM",address:"Phan Văn Trị, Phường 11, Quận Bình Thạnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ngô Lê Ngọc Hương"},TG={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},wh="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",Nh=e=>`${e.toLocaleString("vi-VN")} đ`,CG=({form:e,invoiceLines:t,totals:r,dateDisplay:n,onDownload:a})=>{const i=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${wh};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${wh} !important;
      }
      #invoice-preview .invoice-signature img {
        max-width: 200px !important;
        height: auto !important;
        object-fit: contain !important;
        filter: none !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }
    }
  `;return o.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[o.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trước & tải về"})}),o.jsxs("div",{className:"p-6",children:[o.jsx("style",{children:i}),o.jsx("div",{id:"invoice-print-area",children:o.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:wh},children:[o.jsxs("div",{className:"text-center leading-7",children:[o.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:Cs.name}),o.jsxs("p",{children:["Địa chỉ: ",Cs.address]}),o.jsxs("p",{children:["Điện thoại: ",Cs.phone]}),o.jsxs("p",{children:["Ngân hàng: ",Cs.bank]}),o.jsxs("p",{children:["STK: ",Cs.accountNumber]}),o.jsxs("p",{children:["Tên người nhận: ",Cs.receiver]})]}),o.jsx("div",{className:"my-4 h-px bg-slate-300"}),o.jsxs("div",{className:"text-center space-y-2 leading-7",children:[o.jsx("h2",{className:"text-xl font-bold uppercase",children:"HÓA ĐƠN BÁN HÀNG"}),o.jsx("div",{className:"text-sm",children:o.jsxs("p",{children:["Ngày: ",n]})})]}),o.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Khách hàng: "}),e.customerName||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Địa chỉ: "}),e.address||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",o.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Mã số Thuế: "}),e.taxCode||"---"]})]}),o.jsx("div",{className:"mt-8 px-2",children:o.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:o.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tên hàng hóa / Dịch vụ"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Đơn giá"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chiết khấu"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thành tiền"})]})}),o.jsx("tbody",{children:t.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Chưa có mã hóa đơn nào được chọn."})}):t.map(s=>o.jsxs("tr",{children:[o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:o.jsx("div",{className:"font-semibold",children:s.description})}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Nh(s.unitPrice)}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:s.quantity}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${s.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Nh(s.total)})]},s.id))})]})})}),o.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tổng tiền hàng: ",Nh(r.subtotal)]}),o.jsxs("div",{className:"mt-8 space-y-4",children:[o.jsx("div",{className:"text-center text-sm italic",children:"Cảm ơn và hẹn gặp lại!"}),o.jsx("div",{className:"flex justify-end items-end mt-6 invoice-signature",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mb-2 text-sm font-semibold",children:"Người lập hóa đơn"}),o.jsx("img",{src:xT,alt:"Chữ ký",className:"h-20 w-auto object-contain max-w-[200px]",style:{filter:"none"}})]})})]})]})}),o.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:o.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[o.jsx(oC,{className:"h-5 w-5"}),"Download PDF"]})})]})]})},kG={};var AG={};const R2=typeof import.meta<"u"&&kG?.VITE_API_BASE_URL||typeof process<"u"&&AG?.VITE_API_BASE_URL||""||"http://localhost:3001";function PG(){m.useEffect(()=>{const w=document.title;return document.title="Mavryk Premium Store",()=>{document.title=w}},[]);const[e,t]=m.useState(TG),[r,n]=m.useState([]),[a,i]=m.useState([]),[s,l]=m.useState([]);m.useEffect(()=>{let w=!0;const y=async()=>{try{const S=await fetch(`${R2}${Je.ORDERS}`,{credentials:"include"});if(!S.ok)throw new Error("Failed to load orders");const E=await S.json();w&&Array.isArray(E)&&i(E)}catch(S){console.error("Không thể tải dữ liệu order_list:",S)}},N=async()=>{try{const S=await fetch(`${R2}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(!S.ok)throw new Error("Failed to load product pricing");const E=await S.json();w&&E?.items&&Array.isArray(E.items)&&l(E.items)}catch(S){console.error("Không thể tải dữ liệu pricing:",S)}};return y(),N(),()=>{w=!1}},[]);const c=m.useMemo(()=>{const w=new Map;return a.forEach(y=>{const N=Ec(y?.[It.idOrder]);N&&w.set(N,y)}),w},[a]),u=m.useMemo(()=>{const w=new Map;return s.forEach(y=>{const N=Ec(y?.[zt.code]);N&&w.set(N,y)}),w},[s]),d=m.useMemo(()=>r.map(w=>{const y=c.get(Ec(w.code)),N=Ec(y?.[It.idProduct]),S=u.get(N),E=EG(y?.[It.idOrder]||w.code),_=I2(y?.[It.idProduct])||I2(S?.[zt.code]),j=_?`${_} tháng`:"",A=S?.[zt.variantName]||S?.[zt.packageName]||y?.[It.idProduct]||w.code,T=j?`${A} ${j}`:A,k=yh(S?.computed_wholesale_price)||yh(y?.[It.price]),C=yh(S?.computed_retail_price)||k;let L=C;E===wt.COLLABORATOR||E===wt.STUDENT?L=k:E===wt.GIFT?L=0:E===wt.RETAIL||E===wt.PROMO?L=C:L=C||k;const G=E===wt.PROMO?jG(S?.[zt.pctPromo]):0,V=Number((G*100).toFixed(2)),X=1,K=Math.max(0,L*X*(1-G));return{id:w.id,code:w.code,description:T,unitPrice:L,quantity:X,discountPct:V,total:K}}),[r,c,u]),f=m.useMemo(()=>({subtotal:d.reduce((y,N)=>y+N.total,0)}),[d]),h=m.useMemo(()=>{if(!e.invoiceDate)return"..... tháng ..... năm 20..";const w=new Date(e.invoiceDate);return Number.isNaN(w.getTime())?"..... tháng ..... năm 20..":new Intl.DateTimeFormat("vi-VN").format(w)},[e.invoiceDate]),p=(w,y)=>{t(N=>({...N,[w]:y}))},x=()=>{const w=e.invoiceCode.trim();w&&(n(y=>y.some(N=>N.code===w)?y:[...y,SG(w)]),t(y=>({...y,invoiceCode:""})))},g=w=>{n(y=>y.filter(N=>N.id!==w))},v=w=>{w.preventDefault()},b=()=>{window.print()};return o.jsxs("div",{className:"space-y-6 print-wrapper",children:[o.jsx(_G,{form:e,invoiceCodes:r,onChange:p,onAddInvoiceCode:x,onRemoveInvoiceCode:g,onSubmit:v}),o.jsx(CG,{form:e,invoiceLines:d,totals:f,dateDisplay:h,onDownload:b})]})}var Vu={};Vu.version="0.20.3";var Sa=1200,ml=function(e){Sa=e};function OG(){ml(1200)}var jc=function(t){return String.fromCharCode(t)},M2=function(t){return String.fromCharCode(t)},kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ku(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=kr.charAt(i)+kr.charAt(s)+kr.charAt(l)+kr.charAt(c);return t}function DG(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(u++),n>255&&(n=95),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),a>255&&(a=95),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=kr.charAt(i)+kr.charAt(s)+kr.charAt(l)+kr.charAt(c);return t}function IG(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,u=0;u<e.length;)r=e[u++],i=r>>2,n=e[u++],s=(r&3)<<4|n>>4,a=e[u++],l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=kr.charAt(i)+kr.charAt(s)+kr.charAt(l)+kr.charAt(c);return t}function xi(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0;if(e.slice(0,5)=="data:"){var u=e.slice(0,1024).indexOf(";base64,");u>-1&&(e=e.slice(u+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=kr.indexOf(e.charAt(u++)),s=kr.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=kr.indexOf(e.charAt(u++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=kr.indexOf(e.charAt(u++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var ot=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),xa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),Gu=(function(){if(typeof Buffer>"u")return!1;var e=xa([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function Qi(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function F2(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var cn=function(t){return ot?xa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function l0(e){if(typeof ArrayBuffer>"u")return cn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function es(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function RG(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Kt=ot?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(cn(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function MG(e){for(var t=[],r=0,n=e.length+250,a=Qi(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Qi(65535),n=65530)}return t.push(a.slice(0,r)),Kt(t)}var Wo=/\u0000/g,Tc=/[\u0001-\u0006]/g;function zs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Un(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}function Sg(e,t){var r=""+e;return r.length>=t?r:Ct(" ",t-r.length)+r}function Xu(e,t){var r=""+e;return r.length>=t?r:r+Ct(" ",t-r.length)}function FG(e,t){var r=""+Math.round(e);return r.length>=t?r:Ct("0",t-r.length)+r}function LG(e,t){var r=""+e;return r.length>=t?r:Ct("0",t-r.length)+r}var L2=Math.pow(2,32);function ks(e,t){if(e>L2||e<-L2)return FG(e,t);var r=Math.round(e);return LG(r,t)}function Yu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var B2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function BG(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var _t={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$G={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qu(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),l=f*s+i,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),i=s,s=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=i):(d=u,l=s)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function UG(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+Ct("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Ct("0",t.length-15);return Number(n)}function As(e,t,r){if(e>2958465||e<0)return null;e=UG(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=KG(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}function Eg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function HG(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function zG(e){var t=e<0?12:11,r=Eg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function WG(e){var t=Eg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function VG(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=zG(e):t===10?r=e.toFixed(10).substr(0,12):r=WG(e),Eg(HG(r.toUpperCase()))}function Zp(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):VG(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return za(14,yr(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function KG(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function GG(e,t,r,n){var a="",i=0,s=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return _h[r.m-1][1];case 5:return _h[r.m-1][0];default:return _h[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return B2[r.q][0];default:return B2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Un(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Un(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Un(c,u):"";return d}function oi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var gT=/%/g;function XG(e,t,r){var n=t.replace(gT,""),a=t.length-n.length;return Oa(e,n,r*Math.pow(10,2*a))+Ct("%",a)}function YG(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function vT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+vT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var bT=/# (\?+)( ?)\/( ?)(\d+)/;function qG(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?Ct(" ",e[1].length+1+e[4].length):Sg(s,e[1].length)+e[2]+"/"+e[3]+Un(l,e[4].length))}function ZG(e,t,r){return r+(t===0?"":""+t)+Ct(" ",e[1].length+2+e[4].length)}var yT=/^#*0*\.([0#]+)/,wT=/\)[^)]*[0#]/,NT=/\(###\) ###\\?-####/;function Br(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function U2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function H2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function JG(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function QG(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _n(e,t,r){if(e.charCodeAt(0)===40&&!t.match(wT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_n("n",n,r):"("+_n("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YG(e,t,r);if(t.indexOf("%")!==-1)return XG(e,t,r);if(t.indexOf("E")!==-1)return vT(t,r);if(t.charCodeAt(0)===36)return"$"+_n(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ks(c,t.length);if(t.match(/^[#?]+$/))return a=ks(r,0),a==="0"&&(a=""),a.length>t.length?a:Br(t.substr(0,t.length-a.length))+a;if(i=t.match(bT))return qG(i,c,u);if(t.match(/^#+0+$/))return u+ks(c,t.length-t.indexOf("0"));if(i=t.match(yT))return a=U2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Br(i[1])).replace(/\.$/,"."+Br(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Ct("0",Br(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+U2(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+oi(ks(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_n(e,t,-r):oi(""+(Math.floor(r)+JG(r,i[1].length)))+"."+Un(H2(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return _n(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zs(_n(e,t.replace(/[\\-]/g,""),r)),s=0,zs(zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(NT))return a=_n(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=qu(c,Math.pow(10,s)-1,!1),a=""+u,d=Oa("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Xu(l[2],s),d.length<i[4].length&&(d=Br(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=qu(c,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sg(l[1],s)+i[2]+"/"+i[3]+Xu(l[2],s):Ct(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=ks(r,0),t.length<=a.length?a:Br(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return Br(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=H2(r,i[1].length),r<0?"-"+_n(e,t,-r):oi(QG(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Un(0,3-x.length):"")+x})+"."+Un(s,i[1].length);switch(t){case"###,##0.00":return _n(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=oi(ks(c,0));return p!=="0"?u+p:"";case"###,###.00":return _n(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _n(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function eX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tX(e,t,r){var n=t.replace(gT,""),a=t.length-n.length;return Oa(e,n,r*Math.pow(10,2*a))+Ct("%",a)}function _T(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_T(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(wT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jn("n",n,r):"("+Jn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return eX(e,t,r);if(t.indexOf("%")!==-1)return tX(e,t,r);if(t.indexOf("E")!==-1)return _T(t,r);if(t.charCodeAt(0)===36)return"$"+Jn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Un(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Br(t.substr(0,t.length-a.length))+a;if(i=t.match(bT))return ZG(i,c,u);if(t.match(/^#+0+$/))return u+Un(c,t.length-t.indexOf("0"));if(i=t.match(yT))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Br(i[1])).replace(/\.$/,"."+Br(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+Ct("0",Br(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+oi(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jn(e,t,-r):oi(""+r)+"."+Ct("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Jn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=zs(Jn(e,t.replace(/[\\-]/g,""),r)),s=0,zs(zs(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(NT))return a=Jn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=qu(c,Math.pow(10,s)-1,!1),a=""+u,d=Oa("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Xu(l[2],s),d.length<i[4].length&&(d=Br(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=qu(c,Math.pow(10,s)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Sg(l[1],s)+i[2]+"/"+i[3]+Xu(l[2],s):Ct(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Br(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return Br(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jn(e,t,-r):oi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Un(0,3-x.length):"")+x})+"."+Un(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=oi(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Jn(e,t.slice(0,t.lastIndexOf(".")),r)+Br(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Oa(e,t,r){return(r|0)===r?Jn(e,t,r):_n(e,t,r)}function rX(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ST=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ts(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Yu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ST))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function nX(e,t,r,n){for(var a=[],i="",s=0,l="",c="t",u,d,f,h="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!Yu(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=As(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=As(t,r),u==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var g={t:l,v:l};if(u==null&&(u=As(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?e.charAt(s+2):l),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",s+=5,h="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(ST)){if(u==null&&(u=As(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",ts(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var v=0,b=0,w;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",v<1&&(v=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(b=Math.max(b,w[0].length-1),v=4),v<3&&(v=3);case"d":case"y":case"e":c=a[s].t;break;case"M":c=a[s].t,v<2&&(v=2);break;case"m":c==="s"&&(a[s].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[s].v.match(/[Hh]/)&&(v=1),v<2&&a[s].v.match(/[Mm]/)&&(v=2),v<3&&a[s].v.match(/[Ss]/)&&(v=3)}var y;switch(v){case 0:break;case 1:case 2:case 3:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,y=As(u.D),y.u=u.u,y.S=u.S,y.M=u.M,y.H=u.H,u=y);break;case 4:switch(b){case 1:u.u=Math.round(u.u*10)/10;break;case 2:u.u=Math.round(u.u*100)/100;break;case 3:u.u=Math.round(u.u*1e3)/1e3;break}u.u>=1&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,y=As(u.D),y.u=u.u,y.S=u.S,y.M=u.M,y.H=u.H,u=y);break}var N="",S;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=GG(a[s].t.charCodeAt(0),a[s].v,u,b),a[s].t="t";break;case"n":case"?":for(S=s+1;a[S]!=null&&((l=a[S].t)==="?"||l==="D"||(l===" "||l==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[s].v+=a[S].v,a[S]={v:"",t:";"},++S;N+=a[s].v,s=S-1;break;case"G":a[s].t="t",a[s].v=Zp(t,r);break}var E="",_,j;if(N.length>0){N.charCodeAt(0)==40?(_=t<0&&N.charCodeAt(0)===45?-t:t,j=Oa("n",N,_)):(_=t<0&&n>1?-t:t,j=Oa("n",N,_),_<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),S=j.length-1;var A=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){A=s;break}var T=a.length;if(A===a.length&&j.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(S>=a[s].v.length-1?(S-=a[s].v.length,a[s].v=j.substr(S+1,a[s].v.length)):S<0?a[s].v="":(a[s].v=j.substr(0,S+1),S=-1),a[s].t="t",T=s);S>=0&&T<a.length&&(a[T].v=j.substr(0,S+1)+a[T].v)}else if(A!==a.length&&j.indexOf("E")===-1){for(S=j.indexOf(".")-1,s=A;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===A?a[s].v.indexOf(".")-1:a[s].v.length-1,E=a[s].v.substr(d+1);d>=0;--d)S>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(E=j.charAt(S--)+E);a[s].v=E,a[s].t="t",T=s}for(S>=0&&T<a.length&&(a[T].v=j.substr(0,S+1)+a[T].v),S=j.indexOf(".")+1,s=A;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==A)){for(d=a[s].v.indexOf(".")>-1&&s===A?a[s].v.indexOf(".")+1:0,E=a[s].v.substr(0,d);d<a[s].v.length;++d)S<j.length&&(E+=j.charAt(S++));a[s].v=E,a[s].t="t",T=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(_=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Oa(a[s].t,a[s].v,_),a[s].t="t");var k="";for(s=0;s!==a.length;++s)a[s]!=null&&(k+=a[s].v);return k}var z2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function W2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function aX(e,t){var r=rX(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(z2),l=r[1].match(z2);return W2(t,s)?[n,r[0]]:W2(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function za(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:_t)[e],n==null&&(n=r.table&&r.table[$2[e]]||_t[$2[e]]),n==null&&(n=$G[e]||"General");break}if(Yu(n,0))return Zp(t,r);t instanceof Date&&(t=yr(t,r.date1904));var a=aX(n,t);if(Yu(a[1]))return Zp(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return nX(a[1],t,r,a[0])}function ET(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(_t[r]==null){t<0&&(t=r);continue}if(_t[r]==e){t=r;break}}t<0&&(t=391)}return _t[t]=e,t}function c0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ET(e[t],t)}function u0(){_t=BG()}var Zu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iX(e){var t=typeof e=="number"?_t[e]:e;return t=t.replace(Zu,"(\\d+)"),Zu.lastIndex=0,new RegExp("^"+t+"$")}function sX(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,c=-1;(t.match(Zu)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?l=p:a=p;break}}),Zu.lastIndex=0,c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var oX={"d.m":"d\\.m"};function lX(e,t){return ET(oX[e]||e,t)}var V2=(function(){var e={};e.version="1.2.0";function t(){for(var _=0,j=new Array(256),A=0;A!=256;++A)_=A,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,j[A]=_;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(_){var j=0,A=0,T=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)k[T]=_[T];for(T=0;T!=256;++T)for(A=_[T],j=256+T;j<4096;j+=256)A=k[j]=A>>>8^_[A&255];var C=[];for(T=1;T!=16;++T)C[T-1]=typeof Int32Array<"u"&&typeof k.subarray=="function"?k.subarray(T*256,T*256+256):k.slice(T*256,T*256+256);return C}var a=n(r),i=a[0],s=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],p=a[8],x=a[9],g=a[10],v=a[11],b=a[12],w=a[13],y=a[14];function N(_,j){for(var A=j^-1,T=0,k=_.length;T<k;)A=A>>>8^r[(A^_.charCodeAt(T++))&255];return~A}function S(_,j){for(var A=j^-1,T=_.length-15,k=0;k<T;)A=y[_[k++]^A&255]^w[_[k++]^A>>8&255]^b[_[k++]^A>>16&255]^v[_[k++]^A>>>24]^g[_[k++]]^x[_[k++]]^p[_[k++]]^h[_[k++]]^f[_[k++]]^d[_[k++]]^u[_[k++]]^c[_[k++]]^l[_[k++]]^s[_[k++]]^i[_[k++]]^r[_[k++]];for(T+=15;k<T;)A=A>>>8^r[(A^_[k++])&255];return~A}function E(_,j){for(var A=j^-1,T=0,k=_.length,C=0,L=0;T<k;)C=_.charCodeAt(T++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,L=_.charCodeAt(T++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|L>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|L&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return e.table=r,e.bstr=N,e.buf=S,e.str=E,e})(),gt=(function(){var t={};t.version="1.2.2";function r(P,B){for(var D=P.split("/"),R=B.split("/"),U=0,z=0,ne=Math.min(D.length,R.length);U<ne;++U){if(z=D[U].length-R[U].length)return z;if(D[U]!=R[U])return D[U]<R[U]?-1:1}return D.length-R.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(0,B+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(B+1)}function i(P,B){typeof B=="string"&&(B=new Date(B));var D=B.getHours();D=D<<6|B.getMinutes(),D=D<<5|B.getSeconds()>>>1,P.write_shift(2,D);var R=B.getFullYear()-1980;R=R<<4|B.getMonth()+1,R=R<<5|B.getDate(),P.write_shift(2,R)}function s(P){var B=P.read_shift(2)&65535,D=P.read_shift(2)&65535,R=new Date,U=D&31;D>>>=5;var z=D&15;D>>>=4,R.setMilliseconds(0),R.setFullYear(D+1980),R.setMonth(z-1),R.setDate(U);var ne=B&31;B>>>=5;var de=B&63;return B>>>=6,R.setHours(B),R.setMinutes(de),R.setSeconds(ne<<1),R}function l(P){$r(P,0);for(var B={},D=0;P.l<=P.length-4;){var R=P.read_shift(2),U=P.read_shift(2),z=P.l+U,ne={};switch(R){case 21589:D=P.read_shift(1),D&1&&(ne.mtime=P.read_shift(4)),U>5&&(D&2&&(ne.atime=P.read_shift(4)),D&4&&(ne.ctime=P.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break;case 1:{var de=P.read_shift(4),te=P.read_shift(4);ne.usz=te*Math.pow(2,32)+de,de=P.read_shift(4),te=P.read_shift(4),ne.csz=te*Math.pow(2,32)+de}break}P.l=z,B[R]=ne}return B}var c;function u(){return c||(c=cX)}function d(P,B){if(P[0]==80&&P[1]==75)return Ke(P,B);if((P[0]|32)==109&&(P[1]|32)==105)return gs(P,B);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var D=3,R=512,U=0,z=0,ne=0,de=0,te=0,ae=[],ie=P.slice(0,512);$r(ie,0);var _e=f(ie);switch(D=_e[0],D){case 3:R=512;break;case 4:R=4096;break;case 0:if(_e[1]==0)return Ke(P,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}R!==512&&(ie=P.slice(0,R),$r(ie,28));var je=P.slice(0,R);h(ie,D);var De=ie.read_shift(4,"i");if(D===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);ie.l+=4,ne=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),de=ie.read_shift(4,"i"),U=ie.read_shift(4,"i"),te=ie.read_shift(4,"i"),z=ie.read_shift(4,"i");for(var Se=-1,Ce=0;Ce<109&&(Se=ie.read_shift(4,"i"),!(Se<0));++Ce)ae[Ce]=Se;var Xe=p(P,R);v(te,z,Xe,R,ae);var Et=w(Xe,ne,ae,R);ne<Et.length&&(Et[ne].name="!Directory"),U>0&&de!==L&&(Et[de].name="!MiniFAT"),Et[ae[0]].name="!FAT",Et.fat_addrs=ae,Et.ssz=R;var Dt={},wr=[],wo=[],No=[];y(ne,Et,Xe,wr,U,Dt,wo,de),x(wo,No,wr),wr.shift();var _o={FileIndex:wo,FullPaths:No};return B&&B.raw&&(_o.raw={header:je,sectors:Xe}),_o}function f(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(G,"Header Signature: "),P.l+=16;var B=P.read_shift(2,"u");return[P.read_shift(2,"u"),B]}function h(P,B){var D=9;switch(P.l+=2,D=P.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function p(P,B){for(var D=Math.ceil(P.length/B)-1,R=[],U=1;U<D;++U)R[U-1]=P.slice(U*B,(U+1)*B);return R[D-1]=P.slice(D*B),R}function x(P,B,D){for(var R=0,U=0,z=0,ne=0,de=0,te=D.length,ae=[],ie=[];R<te;++R)ae[R]=ie[R]=R,B[R]=D[R];for(;de<ie.length;++de)R=ie[de],U=P[R].L,z=P[R].R,ne=P[R].C,ae[R]===R&&(U!==-1&&ae[U]!==U&&(ae[R]=ae[U]),z!==-1&&ae[z]!==z&&(ae[R]=ae[z])),ne!==-1&&(ae[ne]=R),U!==-1&&R!=ae[R]&&(ae[U]=ae[R],ie.lastIndexOf(U)<de&&ie.push(U)),z!==-1&&R!=ae[R]&&(ae[z]=ae[R],ie.lastIndexOf(z)<de&&ie.push(z));for(R=1;R<te;++R)ae[R]===R&&(z!==-1&&ae[z]!==z?ae[R]=ae[z]:U!==-1&&ae[U]!==U&&(ae[R]=ae[U]));for(R=1;R<te;++R)if(P[R].type!==0){if(de=R,de!=ae[de])do de=ae[de],B[R]=B[de]+"/"+B[R];while(de!==0&&ae[de]!==-1&&de!=ae[de]);ae[R]=-1}for(B[0]+="/",R=1;R<te;++R)P[R].type!==2&&(B[R]+="/")}function g(P,B,D){for(var R=P.start,U=P.size,z=[],ne=R;D&&U>0&&ne>=0;)z.push(B.slice(ne*C,ne*C+C)),U-=C,ne=Oi(D,ne*4);return z.length===0?re(0):Kt(z).slice(0,P.size)}function v(P,B,D,R,U){var z=L;if(P===L){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ne=D[P],de=(R>>>2)-1;if(!ne)return;for(var te=0;te<de&&(z=Oi(ne,te*4))!==L;++te)U.push(z);B>=1&&v(Oi(ne,R-4),B-1,D,R,U)}}function b(P,B,D,R,U){var z=[],ne=[];U||(U=[]);var de=R-1,te=0,ae=0;for(te=B;te>=0;){U[te]=!0,z[z.length]=te,ne.push(P[te]);var ie=D[Math.floor(te*4/R)];if(ae=te*4&de,R<4+ae)throw new Error("FAT boundary crossed: "+te+" 4 "+R);if(!P[ie])break;te=Oi(P[ie],ae)}return{nodes:z,data:J2([ne])}}function w(P,B,D,R){var U=P.length,z=[],ne=[],de=[],te=[],ae=R-1,ie=0,_e=0,je=0,De=0;for(ie=0;ie<U;++ie)if(de=[],je=ie+B,je>=U&&(je-=U),!ne[je]){te=[];var Se=[];for(_e=je;_e>=0;){Se[_e]=!0,ne[_e]=!0,de[de.length]=_e,te.push(P[_e]);var Ce=D[Math.floor(_e*4/R)];if(De=_e*4&ae,R<4+De)throw new Error("FAT boundary crossed: "+_e+" 4 "+R);if(!P[Ce]||(_e=Oi(P[Ce],De),Se[_e]))break}z[je]={nodes:de,data:J2([te])}}return z}function y(P,B,D,R,U,z,ne,de){for(var te=0,ae=R.length?2:0,ie=B[P].data,_e=0,je=0,De;_e<ie.length;_e+=128){var Se=ie.slice(_e,_e+128);$r(Se,64),je=Se.read_shift(2),De=Pg(Se,0,je-ae),R.push(De);var Ce={name:De,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},Xe=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Xe!==0&&(Ce.ct=N(Se,Se.l-8));var Et=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Et!==0&&(Ce.mt=N(Se,Se.l-8)),Ce.start=Se.read_shift(4,"i"),Ce.size=Se.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=L,Ce.name=""),Ce.type===5?(te=Ce.start,U>0&&te!==L&&(B[te].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",B[Ce.start]===void 0&&(B[Ce.start]=b(D,Ce.start,B.fat_addrs,B.ssz)),B[Ce.start].name=Ce.name,Ce.content=B[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:te!==L&&Ce.start!==L&&B[te]&&(Ce.content=g(Ce,B[te].data,(B[de]||{}).data))),Ce.content&&$r(Ce.content,0),z[De]=Ce,ne.push(Ce)}}function N(P,B){return new Date((dn(P,B+4)/1e7*Math.pow(2,32)+dn(P,B)/1e7-11644473600)*1e3)}function S(P,B){return u(),d(c.readFileSync(P),B)}function E(P,B){var D=B&&B.type;switch(D||ot&&Buffer.isBuffer(P)&&(D="buffer"),D||"base64"){case"file":return S(P,B);case"base64":return d(cn(xi(P)),B);case"binary":return d(cn(P),B)}return d(P,B)}function _(P,B){var D=B||{},R=D.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=R+"/",P.FileIndex[0]={name:R,type:5}),D.CLSID&&(P.FileIndex[0].clsid=D.CLSID),j(P)}function j(P){var B="Sh33tJ5";if(!gt.find(P,"/"+B)){var D=re(4);D[0]=55,D[1]=D[3]=50,D[2]=54,P.FileIndex.push({name:B,type:2,content:D,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+B),A(P)}}function A(P,B){_(P);for(var D=!1,R=!1,U=P.FullPaths.length-1;U>=0;--U){var z=P.FileIndex[U];switch(z.type){case 0:R?D=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(z.R*z.L*z.C)&&(D=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!B)){var ne=new Date(1987,1,19),de=0,te=Object.create?Object.create(null):{},ae=[];for(U=0;U<P.FullPaths.length;++U)te[P.FullPaths[U]]=!0,P.FileIndex[U].type!==0&&ae.push([P.FullPaths[U],P.FileIndex[U]]);for(U=0;U<ae.length;++U){var ie=n(ae[U][0]);for(R=te[ie];!R;){for(;n(ie)&&!te[n(ie)];)ie=n(ie);ae.push([ie,{name:a(ie).replace("/",""),type:1,clsid:X,ct:ne,mt:ne,content:null}]),te[ie]=!0,ie=n(ae[U][0]),R=te[ie]}}for(ae.sort(function(De,Se){return r(De[0],Se[0])}),P.FullPaths=[],P.FileIndex=[],U=0;U<ae.length;++U)P.FullPaths[U]=ae[U][0],P.FileIndex[U]=ae[U][1];for(U=0;U<ae.length;++U){var _e=P.FileIndex[U],je=P.FullPaths[U];if(_e.name=a(je).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||X,U===0)_e.C=ae.length>1?1:-1,_e.size=0,_e.type=5;else if(je.slice(-1)=="/"){for(de=U+1;de<ae.length&&n(P.FullPaths[de])!=je;++de);for(_e.C=de>=ae.length?-1:de,de=U+1;de<ae.length&&n(P.FullPaths[de])!=n(je);++de);_e.R=de>=ae.length?-1:de,_e.type=1}else n(P.FullPaths[U+1]||"")==n(je)&&(_e.R=U+1),_e.type=2}}}function T(P,B){var D=B||{};if(D.fileType=="mad")return Si(P,D);if(A(P),D.fileType==="zip")return ze(P,D);var R=(function(De){for(var Se=0,Ce=0,Xe=0;Xe<De.FileIndex.length;++Xe){var Et=De.FileIndex[Xe];if(Et.content){var Dt=Et.content.length;Dt>0&&(Dt<4096?Se+=Dt+63>>6:Ce+=Dt+511>>9)}}for(var wr=De.FullPaths.length+3>>2,wo=Se+7>>3,No=Se+127>>7,_o=wo+Ce+wr+No,Ei=_o+127>>7,b0=Ei<=109?0:Math.ceil((Ei-109)/127);_o+Ei+b0+127>>7>Ei;)b0=++Ei<=109?0:Math.ceil((Ei-109)/127);var ya=[1,b0,Ei,No,wr,Ce,Se,0];return De.FileIndex[0].size=Se<<6,ya[7]=(De.FileIndex[0].start=ya[0]+ya[1]+ya[2]+ya[3]+ya[4]+ya[5])+(ya[6]+7>>3),ya})(P),U=re(R[7]<<9),z=0,ne=0;{for(z=0;z<8;++z)U.write_shift(1,V[z]);for(z=0;z<8;++z)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),z=0;z<3;++z)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,R[2]),U.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:L),U.write_shift(4,R[3]),U.write_shift(-4,R[1]?R[0]-1:L),U.write_shift(4,R[1]),z=0;z<109;++z)U.write_shift(-4,z<R[2]?R[1]+z:-1)}if(R[1])for(ne=0;ne<R[1];++ne){for(;z<236+ne*127;++z)U.write_shift(-4,z<R[2]?R[1]+z:-1);U.write_shift(-4,ne===R[1]-1?L:ne+1)}var de=function(De){for(ne+=De;z<ne-1;++z)U.write_shift(-4,z+1);De&&(++z,U.write_shift(-4,L))};for(ne=z=0,ne+=R[1];z<ne;++z)U.write_shift(-4,K.DIFSECT);for(ne+=R[2];z<ne;++z)U.write_shift(-4,K.FATSECT);de(R[3]),de(R[4]);for(var te=0,ae=0,ie=P.FileIndex[0];te<P.FileIndex.length;++te)ie=P.FileIndex[te],ie.content&&(ae=ie.content.length,!(ae<4096)&&(ie.start=ne,de(ae+511>>9)));for(de(R[6]+7>>3);U.l&511;)U.write_shift(-4,K.ENDOFCHAIN);for(ne=z=0,te=0;te<P.FileIndex.length;++te)ie=P.FileIndex[te],ie.content&&(ae=ie.content.length,!(!ae||ae>=4096)&&(ie.start=ne,de(ae+63>>6)));for(;U.l&511;)U.write_shift(-4,K.ENDOFCHAIN);for(z=0;z<R[4]<<2;++z){var _e=P.FullPaths[z];if(!_e||_e.length===0){for(te=0;te<17;++te)U.write_shift(4,0);for(te=0;te<3;++te)U.write_shift(4,-1);for(te=0;te<12;++te)U.write_shift(4,0);continue}ie=P.FileIndex[z],z===0&&(ie.start=ie.size?ie.start-1:L);var je=z===0&&D.root||ie.name;if(je.length>31&&(console.error("Name "+je+" will be truncated to "+je.slice(0,31)),je=je.slice(0,31)),ae=2*(je.length+1),U.write_shift(64,je,"utf16le"),U.write_shift(2,ae),U.write_shift(1,ie.type),U.write_shift(1,ie.color),U.write_shift(-4,ie.L),U.write_shift(-4,ie.R),U.write_shift(-4,ie.C),ie.clsid)U.write_shift(16,ie.clsid,"hex");else for(te=0;te<4;++te)U.write_shift(4,0);U.write_shift(4,ie.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ie.start),U.write_shift(4,ie.size),U.write_shift(4,0)}for(z=1;z<P.FileIndex.length;++z)if(ie=P.FileIndex[z],ie.size>=4096)if(U.l=ie.start+1<<9,ot&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+511&-512;else{for(te=0;te<ie.size;++te)U.write_shift(1,ie.content[te]);for(;te&511;++te)U.write_shift(1,0)}for(z=1;z<P.FileIndex.length;++z)if(ie=P.FileIndex[z],ie.size>0&&ie.size<4096)if(ot&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+63&-64;else{for(te=0;te<ie.size;++te)U.write_shift(1,ie.content[te]);for(;te&63;++te)U.write_shift(1,0)}if(ot)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function k(P,B){var D=P.FullPaths.map(function(te){return te.toUpperCase()}),R=D.map(function(te){var ae=te.split("/");return ae[ae.length-(te.slice(-1)=="/"?2:1)]}),U=!1;B.charCodeAt(0)===47?(U=!0,B=D[0].slice(0,-1)+B):U=B.indexOf("/")!==-1;var z=B.toUpperCase(),ne=U===!0?D.indexOf(z):R.indexOf(z);if(ne!==-1)return P.FileIndex[ne];var de=!z.match(Tc);for(z=z.replace(Wo,""),de&&(z=z.replace(Tc,"!")),ne=0;ne<D.length;++ne)if((de?D[ne].replace(Tc,"!"):D[ne]).replace(Wo,"")==z||(de?R[ne].replace(Tc,"!"):R[ne]).replace(Wo,"")==z)return P.FileIndex[ne];return null}var C=64,L=-2,G="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(P,B,D){u();var R=T(P,D);c.writeFileSync(B,R)}function q(P){for(var B=new Array(P.length),D=0;D<P.length;++D)B[D]=String.fromCharCode(P[D]);return B.join("")}function Z(P,B){var D=T(P,B);switch(B&&B.type||"buffer"){case"file":return u(),c.writeFileSync(B.filename,D),D;case"binary":return typeof D=="string"?D:q(D);case"base64":return Ku(typeof D=="string"?D:q(D));case"buffer":if(ot)return Buffer.isBuffer(D)?D:xa(D);case"array":return typeof D=="string"?cn(D):D}return D}var le;function ce(P){try{var B=P.InflateRaw,D=new B;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)le=P;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function me(P,B){if(!le)return Zl(P,B);var D=le.InflateRaw,R=new D,U=R._processChunk(P.slice(P.l),R._finishFlushFlag);return P.l+=R.bytesRead,U}function Ne(P){return le?le.deflateRawSync(P):ct(P)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(P){var B=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(B>>16|B>>8|B)&255}for(var I=typeof Uint8Array<"u",F=I?new Uint8Array(256):[],M=0;M<256;++M)F[M]=O(M);function W(P,B){var D=F[P&255];return B<=8?D>>>8-B:(D=D<<8|F[P>>8&255],B<=16?D>>>16-B:(D=D<<8|F[P>>16&255],D>>>24-B))}function J(P,B){var D=B&7,R=B>>>3;return(P[R]|(D<=6?0:P[R+1]<<8))>>>D&3}function se(P,B){var D=B&7,R=B>>>3;return(P[R]|(D<=5?0:P[R+1]<<8))>>>D&7}function ke(P,B){var D=B&7,R=B>>>3;return(P[R]|(D<=4?0:P[R+1]<<8))>>>D&15}function ye(P,B){var D=B&7,R=B>>>3;return(P[R]|(D<=3?0:P[R+1]<<8))>>>D&31}function Pe(P,B){var D=B&7,R=B>>>3;return(P[R]|(D<=1?0:P[R+1]<<8))>>>D&127}function ue(P,B,D){var R=B&7,U=B>>>3,z=(1<<D)-1,ne=P[U]>>>R;return D<8-R||(ne|=P[U+1]<<8-R,D<16-R)||(ne|=P[U+2]<<16-R,D<24-R)||(ne|=P[U+3]<<24-R),ne&z}function Be(P,B,D){var R=B&7,U=B>>>3;return R<=5?P[U]|=(D&7)<<R:(P[U]|=D<<R&255,P[U+1]=(D&7)>>8-R),B+3}function Ve(P,B,D){var R=B&7,U=B>>>3;return D=(D&1)<<R,P[U]|=D,B+1}function ve(P,B,D){var R=B&7,U=B>>>3;return D<<=R,P[U]|=D&255,D>>>=8,P[U+1]=D,B+8}function we(P,B,D){var R=B&7,U=B>>>3;return D<<=R,P[U]|=D&255,D>>>=8,P[U+1]=D&255,P[U+2]=D>>>8,B+16}function he(P,B){var D=P.length,R=2*D>B?2*D:B+5,U=0;if(D>=B)return P;if(ot){var z=F2(R);if(P.copy)P.copy(z);else for(;U<P.length;++U)z[U]=P[U];return z}else if(I){var ne=new Uint8Array(R);if(ne.set)ne.set(P);else for(;U<D;++U)ne[U]=P[U];return ne}return P.length=R,P}function Te(P){for(var B=new Array(P),D=0;D<P;++D)B[D]=0;return B}function pe(P,B,D){var R=1,U=0,z=0,ne=0,de=0,te=P.length,ae=I?new Uint16Array(32):Te(32);for(z=0;z<32;++z)ae[z]=0;for(z=te;z<D;++z)P[z]=0;te=P.length;var ie=I?new Uint16Array(te):Te(te);for(z=0;z<te;++z)ae[U=P[z]]++,R<U&&(R=U),ie[z]=0;for(ae[0]=0,z=1;z<=R;++z)ae[z+16]=de=de+ae[z-1]<<1;for(z=0;z<te;++z)de=P[z],de!=0&&(ie[z]=ae[de+16]++);var _e=0;for(z=0;z<te;++z)if(_e=P[z],_e!=0)for(de=W(ie[z],R)>>R-_e,ne=(1<<R+4-_e)-1;ne>=0;--ne)B[de|ne<<_e]=_e&15|z<<4;return R}var We=I?new Uint16Array(512):Te(512),Oe=I?new Uint16Array(32):Te(32);if(!I){for(var Ae=0;Ae<512;++Ae)We[Ae]=0;for(Ae=0;Ae<32;++Ae)Oe[Ae]=0}(function(){for(var P=[],B=0;B<32;B++)P.push(5);pe(P,Oe,32);var D=[];for(B=0;B<=143;B++)D.push(8);for(;B<=255;B++)D.push(9);for(;B<=279;B++)D.push(7);for(;B<=287;B++)D.push(8);pe(D,We,288)})();var Ye=(function(){for(var B=I?new Uint8Array(32768):[],D=0,R=0;D<fe.length-1;++D)for(;R<fe[D+1];++R)B[R]=D;for(;R<32768;++R)B[R]=29;var U=I?new Uint8Array(259):[];for(D=0,R=0;D<oe.length-1;++D)for(;R<oe[D+1];++R)U[R]=D;function z(de,te){for(var ae=0;ae<de.length;){var ie=Math.min(65535,de.length-ae),_e=ae+ie==de.length;for(te.write_shift(1,+_e),te.write_shift(2,ie),te.write_shift(2,~ie&65535);ie-- >0;)te[te.l++]=de[ae++]}return te.l}function ne(de,te){for(var ae=0,ie=0,_e=I?new Uint16Array(32768):[];ie<de.length;){var je=Math.min(65535,de.length-ie);if(je<10){for(ae=Be(te,ae,+(ie+je==de.length)),ae&7&&(ae+=8-(ae&7)),te.l=ae/8|0,te.write_shift(2,je),te.write_shift(2,~je&65535);je-- >0;)te[te.l++]=de[ie++];ae=te.l*8;continue}ae=Be(te,ae,+(ie+je==de.length)+2);for(var De=0;je-- >0;){var Se=de[ie];De=(De<<5^Se)&32767;var Ce=-1,Xe=0;if((Ce=_e[De])&&(Ce|=ie&-32768,Ce>ie&&(Ce-=32768),Ce<ie))for(;de[Ce+Xe]==de[ie+Xe]&&Xe<250;)++Xe;if(Xe>2){Se=U[Xe],Se<=22?ae=ve(te,ae,F[Se+1]>>1)-1:(ve(te,ae,3),ae+=5,ve(te,ae,F[Se-23]>>5),ae+=3);var Et=Se<8?0:Se-4>>2;Et>0&&(we(te,ae,Xe-oe[Se]),ae+=Et),Se=B[ie-Ce],ae=ve(te,ae,F[Se]>>3),ae-=3;var Dt=Se<4?0:Se-2>>1;Dt>0&&(we(te,ae,ie-Ce-fe[Se]),ae+=Dt);for(var wr=0;wr<Xe;++wr)_e[De]=ie&32767,De=(De<<5^de[ie])&32767,++ie;je-=Xe-1}else Se<=143?Se=Se+48:ae=Ve(te,ae,1),ae=ve(te,ae,F[Se]),_e[De]=ie&32767,++ie}ae=ve(te,ae,0)-1}return te.l=(ae+7)/8|0,te.l}return function(te,ae){return te.length<8?z(te,ae):ne(te,ae)}})();function ct(P){var B=re(50+Math.floor(P.length*1.1)),D=Ye(P,B);return B.slice(0,D)}var He=I?new Uint16Array(32768):Te(32768),ut=I?new Uint16Array(32768):Te(32768),vn=I?new Uint16Array(128):Te(128),Qa=1,Rn=1;function ga(P,B){var D=ye(P,B)+257;B+=5;var R=ye(P,B)+1;B+=5;var U=ke(P,B)+4;B+=4;for(var z=0,ne=I?new Uint8Array(19):Te(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ae=I?new Uint8Array(8):Te(8),ie=I?new Uint8Array(8):Te(8),_e=ne.length,je=0;je<U;++je)ne[ee[je]]=z=se(P,B),te<z&&(te=z),ae[z]++,B+=3;var De=0;for(ae[0]=0,je=1;je<=te;++je)ie[je]=De=De+ae[je-1]<<1;for(je=0;je<_e;++je)(De=ne[je])!=0&&(de[je]=ie[De]++);var Se=0;for(je=0;je<_e;++je)if(Se=ne[je],Se!=0){De=F[de[je]]>>8-Se;for(var Ce=(1<<7-Se)-1;Ce>=0;--Ce)vn[De|Ce<<Se]=Se&7|je<<3}var Xe=[];for(te=1;Xe.length<D+R;)switch(De=vn[Pe(P,B)],B+=De&7,De>>>=3){case 16:for(z=3+J(P,B),B+=2,De=Xe[Xe.length-1];z-- >0;)Xe.push(De);break;case 17:for(z=3+se(P,B),B+=3;z-- >0;)Xe.push(0);break;case 18:for(z=11+Pe(P,B),B+=7;z-- >0;)Xe.push(0);break;default:Xe.push(De),te<De&&(te=De);break}var Et=Xe.slice(0,D),Dt=Xe.slice(D);for(je=D;je<286;++je)Et[je]=0;for(je=R;je<30;++je)Dt[je]=0;return Qa=pe(Et,He,286),Rn=pe(Dt,ut,30),B}function xs(P,B){if(P[0]==3&&!(P[1]&3))return[Qi(B),2];for(var D=0,R=0,U=F2(B||1<<18),z=0,ne=U.length>>>0,de=0,te=0;(R&1)==0;){if(R=se(P,D),D+=3,R>>>1)R>>1==1?(de=9,te=5):(D=ga(P,D),de=Qa,te=Rn);else{D&7&&(D+=8-(D&7));var ae=P[D>>>3]|P[(D>>>3)+1]<<8;if(D+=32,ae>0)for(!B&&ne<z+ae&&(U=he(U,z+ae),ne=U.length);ae-- >0;)U[z++]=P[D>>>3],D+=8;continue}for(;;){!B&&ne<z+32767&&(U=he(U,z+32767),ne=U.length);var ie=ue(P,D,de),_e=R>>>1==1?We[ie]:He[ie];if(D+=_e&15,_e>>>=4,(_e>>>8&255)===0)U[z++]=_e;else{if(_e==256)break;_e-=257;var je=_e<8?0:_e-4>>2;je>5&&(je=0);var De=z+oe[_e];je>0&&(De+=ue(P,D,je),D+=je),ie=ue(P,D,te),_e=R>>>1==1?Oe[ie]:ut[ie],D+=_e&15,_e>>>=4;var Se=_e<4?0:_e-2>>1,Ce=fe[_e];for(Se>0&&(Ce+=ue(P,D,Se),D+=Se),!B&&ne<De&&(U=he(U,De+100),ne=U.length);z<De;)U[z]=U[z-Ce],++z}}}return B?[U,D+7>>>3]:[U.slice(0,z),D+7>>>3]}function Zl(P,B){var D=P.slice(P.l||0),R=xs(D,B);return P.l+=R[1],R[0]}function ge(P,B){if(P)typeof console<"u"&&console.error(B);else throw new Error(B)}function Ke(P,B){var D=P;$r(D,0);var R=[],U=[],z={FileIndex:R,FullPaths:U};_(z,{root:B.root});for(var ne=D.length-4;(D[ne]!=80||D[ne+1]!=75||D[ne+2]!=5||D[ne+3]!=6)&&ne>=0;)--ne;D.l=ne+4,D.l+=4;var de=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,ne=0;ne<de;++ne){D.l+=20;var ae=D.read_shift(4),ie=D.read_shift(4),_e=D.read_shift(2),je=D.read_shift(2),De=D.read_shift(2);D.l+=8;var Se=D.read_shift(4),Ce=l(D.slice(D.l+_e,D.l+_e+je));D.l+=_e+je+De;var Xe=D.l;D.l=Se+4,Ce&&Ce[1]&&((Ce[1]||{}).usz&&(ie=Ce[1].usz),(Ce[1]||{}).csz&&(ae=Ce[1].csz)),Ge(D,ae,ie,z,Ce),D.l=Xe}return z}function Ge(P,B,D,R,U){P.l+=2;var z=P.read_shift(2),ne=P.read_shift(2),de=s(P);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var te=P.read_shift(4),ae=P.read_shift(4),ie=P.read_shift(4),_e=P.read_shift(2),je=P.read_shift(2),De="",Se=0;Se<_e;++Se)De+=String.fromCharCode(P[P.l++]);if(je){var Ce=l(P.slice(P.l,P.l+je));(Ce[21589]||{}).mt&&(de=Ce[21589].mt),(Ce[1]||{}).usz&&(ie=Ce[1].usz),(Ce[1]||{}).csz&&(ae=Ce[1].csz),U&&((U[21589]||{}).mt&&(de=U[21589].mt),(U[1]||{}).usz&&(ie=U[1].usz),(U[1]||{}).csz&&(ae=U[1].csz))}P.l+=je;var Xe=P.slice(P.l,P.l+ae);switch(ne){case 8:Xe=me(P,ie);break;case 0:P.l+=ae;break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var Et=!1;z&8&&(te=P.read_shift(4),te==134695760&&(te=P.read_shift(4),Et=!0),ae=P.read_shift(4),ie=P.read_shift(4)),ae!=B&&ge(Et,"Bad compressed size: "+B+" != "+ae),ie!=D&&ge(Et,"Bad uncompressed size: "+D+" != "+ie),on(R,De,Xe,{unsafe:!0,mt:de})}function ze(P,B){var D=B||{},R=[],U=[],z=re(1),ne=D.compression?8:0,de=0,te=0,ae=0,ie=0,_e=0,je=P.FullPaths[0],De=je,Se=P.FileIndex[0],Ce=[],Xe=0;for(te=1;te<P.FullPaths.length;++te)if(De=P.FullPaths[te].slice(je.length),Se=P.FileIndex[te],!(!Se.size||!Se.content||Array.isArray(Se.content)&&Se.content.length==0||De=="Sh33tJ5")){var Et=ie,Dt=re(De.length);for(ae=0;ae<De.length;++ae)Dt.write_shift(1,De.charCodeAt(ae)&127);Dt=Dt.slice(0,Dt.l),Ce[_e]=typeof Se.content=="string"?V2.bstr(Se.content,0):V2.buf(Se.content,0);var wr=typeof Se.content=="string"?cn(Se.content):Se.content;ne==8&&(wr=Ne(wr)),z=re(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,de),z.write_shift(2,ne),Se.mt?i(z,Se.mt):z.write_shift(4,0),z.write_shift(-4,Ce[_e]),z.write_shift(4,wr.length),z.write_shift(4,Se.content.length),z.write_shift(2,Dt.length),z.write_shift(2,0),ie+=z.length,R.push(z),ie+=Dt.length,R.push(Dt),ie+=wr.length,R.push(wr),z=re(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,de),z.write_shift(2,ne),z.write_shift(4,0),z.write_shift(-4,Ce[_e]),z.write_shift(4,wr.length),z.write_shift(4,Se.content.length),z.write_shift(2,Dt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Et),Xe+=z.l,U.push(z),Xe+=Dt.length,U.push(Dt),++_e}return z=re(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,_e),z.write_shift(2,_e),z.write_shift(4,Xe),z.write_shift(4,ie),z.write_shift(2,0),Kt([Kt(R),Kt(U),z])}var Qe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rr(P,B){if(P.ctype)return P.ctype;var D=P.name||"",R=D.match(/\.([^\.]+)$/);return R&&Qe[R[1]]||B&&(R=(D=B).match(/[\.\\]([^\.\\])+$/),R&&Qe[R[1]])?Qe[R[1]]:"application/octet-stream"}function sn(P){for(var B=Ku(P),D=[],R=0;R<B.length;R+=76)D.push(B.slice(R,R+76));return D.join(`\r
`)+`\r
`}function bn(P){var B=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var ie=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],R=B.split(`\r
`),U=0;U<R.length;++U){var z=R[U];if(z.length==0){D.push("");continue}for(var ne=0;ne<z.length;){var de=76,te=z.slice(ne,ne+de);te.charAt(de-1)=="="?de--:te.charAt(de-2)=="="?de-=2:te.charAt(de-3)=="="&&(de-=3),te=z.slice(ne,ne+de),ne+=de,ne<z.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function va(P){for(var B=[],D=0;D<P.length;++D){for(var R=P[D];D<=P.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+P[++D];B.push(R)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return cn(B.join(`\r
`))}function ei(P,B,D){for(var R="",U="",z="",ne,de=0;de<10;++de){var te=B[de];if(!te||te.match(/^\s*$/))break;var ae=te.match(/^([^:]*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":R=ae[2].trim();break;case"content-type":z=ae[2].trim();break;case"content-transfer-encoding":U=ae[2].trim();break}}switch(++de,U.toLowerCase()){case"base64":ne=cn(xi(B.slice(de).join("")));break;case"quoted-printable":ne=va(B.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ie=on(P,R.slice(D.length),ne,{unsafe:!0});z&&(ie.ctype=z)}function gs(P,B){if(q(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=B&&B.root||"",R=(ot&&Buffer.isBuffer(P)?P.toString("binary"):q(P)).split(`\r
`),U=0,z="";for(U=0;U<R.length;++U)if(z=R[U],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),D||(D=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),z.slice(0,D.length)!=D););var ne=(R[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var de="--"+(ne[1]||""),te=[],ae=[],ie={FileIndex:te,FullPaths:ae};_(ie);var _e,je=0;for(U=0;U<R.length;++U){var De=R[U];De!==de&&De!==de+"--"||(je++&&ei(ie,R.slice(_e,U),D),_e=U)}return ie}function Si(P,B){var D=B||{},R=D.boundary||"SheetJS";R="------="+R;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],z=P.FullPaths[0],ne=z,de=P.FileIndex[0],te=1;te<P.FullPaths.length;++te)if(ne=P.FullPaths[te].slice(z.length),de=P.FileIndex[te],!(!de.size||!de.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var ae=de.content,ie=ot&&Buffer.isBuffer(ae)?ae.toString("binary"):q(ae),_e=0,je=Math.min(1024,ie.length),De=0,Se=0;Se<=je;++Se)(De=ie.charCodeAt(Se))>=32&&De<128&&++_e;var Ce=_e>=je*4/5;U.push(R),U.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ne),U.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),U.push("Content-Type: "+Rr(de,ne)),U.push(""),U.push(Ce?bn(ie):sn(ie))}return U.push(R+`--\r
`),U.join(`\r
`)}function Gn(P){var B={};return _(B,P),B}function on(P,B,D,R){var U=R&&R.unsafe;U||_(P);var z=!U&&gt.find(P,B);if(!z){var ne=P.FullPaths[0];B.slice(0,ne.length)==ne?ne=B:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+B).replace("//","/")),z={name:a(B),type:2},P.FileIndex.push(z),P.FullPaths.push(ne),U||gt.utils.cfb_gc(P)}return z.content=D,z.size=D?D.length:0,R&&(R.CLSID&&(z.clsid=R.CLSID),R.mt&&(z.mt=R.mt),R.ct&&(z.ct=R.ct)),z}function yo(P,B){_(P);var D=gt.find(P,B);if(D){for(var R=0;R<P.FileIndex.length;++R)if(P.FileIndex[R]==D)return P.FileIndex.splice(R,1),P.FullPaths.splice(R,1),!0}return!1}function ba(P,B,D){_(P);var R=gt.find(P,B);if(R){for(var U=0;U<P.FileIndex.length;++U)if(P.FileIndex[U]==R)return P.FileIndex[U].name=a(D),P.FullPaths[U]=D,!0}return!1}function vs(P){A(P,!0)}return t.find=k,t.read=E,t.parse=d,t.write=Z,t.writeFile=Y,t.utils={cfb_new:Gn,cfb_add:on,cfb_del:yo,cfb_mov:ba,cfb_gc:vs,ReadShift:Vo,CheckField:HT,prep_blob:$r,bconcat:Kt,use_zlib:ce,_deflateRaw:ct,_inflateRaw:Zl,consts:K},t})(),cX;function K2(e){return typeof e=="string"?l0(e):Array.isArray(e)?RG(e):e}function Gl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=l0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([K2(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+IG(new Uint8Array(K2(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=es(t)),c.write(t),c.close(),t}catch(u){if(!u.message||u.message.indexOf("onstruct")==-1)throw u}throw new Error("cannot save file "+e)}function Yt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function G2(e,t){for(var r=[],n=Yt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function jg(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function d0(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function uX(e){for(var t=[],r=Yt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var jT=Date.UTC(1899,11,30,0,0,0),dX=Date.UTC(1899,11,31,0,0,0),fX=Date.UTC(1904,0,1,0,0,0);function yr(e,t){var r=e.getTime(),n=(r-jT)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Ws(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+jT),t}var hX=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,pX=/^(\d+)-(\d+)-(\d+)$/,TT=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function rn(e,t){if(e instanceof Date)return e;var r=e.match(hX);if(r)return new Date((t?fX:dX)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(pX),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(TT),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function Tg(e,t){if(ot&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function Dr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Dr(e[r]));return t}function Ct(e,t){for(var r="";r.length<t;)r+=e;return r}function Da(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var mX=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,xX=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,gX=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,vX=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function bX(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function yX(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var wX=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ju(e){if(gX.test(e))return e.indexOf("Z")==-1?f0(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(mX);if(n)return bX(n);if(n=r.match(xX),n)return yX(n);if(n=r.match(TT),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(vX&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear();a.getMonth();var l=a.getDate();if(isNaN(l))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&wX.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}function ro(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function f0(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function qe(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return ot?n=xa(r):n=MG(r),gt.utils.cfb_add(e,t,n)}gt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Cg(){return gt.utils.cfb_new()}var Jt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,NX={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kg=jg(NX),Ag=/[&<>'"]/g,_X=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Ze(e){var t=e+"";return t.replace(Ag,function(r){return kg[r]}).replace(_X,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function X2(e){return Ze(e).replace(/ /g,"_x0020_")}var CT=/[\u0000-\u001f]/g;function Sh(e){var t=e+"";return t.replace(Ag,function(r){return kg[r]}).replace(/\n/g,"<br/>").replace(CT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function SX(e){var t=e+"";return t.replace(Ag,function(r){return kg[r]}).replace(CT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function EX(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function jX(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Eh(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Y2(e){var t=Qi(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function q2(e){return xa(e,"binary").toString("utf8")}var Cc="foo bar bazâð£",Vs=ot&&(q2(Cc)==Eh(Cc)&&q2||Y2(Cc)==Eh(Cc)&&Y2)||Eh,xl=ot?function(e){return xa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},TX=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),kT=/(^\s|\s$|\n)/;function gr(e,t){return"<"+e+(t.match(kT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gl(e){return Yt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ee(e,t,r){return"<"+e+(r!=null?gl(r):"")+(t!=null?(t.match(kT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Jp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function CX(e,t){switch(typeof e){case"string":var r=Ee("vt:lpwstr",Ze(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ee((e|0)==e?"vt:i4":"vt:r8",Ze(String(e)));case"boolean":return Ee("vt:bool",e?"true":"false")}if(e instanceof Date)return Ee("vt:filetime",Jp(e));throw new Error("Unable to serialize "+e)}var or={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},mo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],un={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kX(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function AX(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var Z2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},J2=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xa(t)})):Z2(e)}:Z2,Q2=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Uo(e,a)));return n.join("").replace(Wo,"")},Pg=ot?function(e,t,r){return!Buffer.isBuffer(e)||!Gu?Q2(e,t,r):e.toString("utf16le",t,r).replace(Wo,"")}:Q2,eN=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},AT=ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):eN(e,t,r)}:eN,tN=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Is(e,a)));return n.join("")},Xl=ot?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):tN(t,r,n)}:tN,PT=function(e,t){var r=dn(e,t);return r>0?Xl(e,t+4,t+4+r-1):""},OT=PT,DT=function(e,t){var r=dn(e,t);return r>0?Xl(e,t+4,t+4+r-1):""},IT=DT,RT=function(e,t){var r=2*dn(e,t);return r>0?Xl(e,t+4,t+4+r-1):""},MT=RT,FT=function(t,r){var n=dn(t,r);return n>0?Pg(t,r+4,r+4+n):""},LT=FT,BT=function(e,t){var r=dn(e,t);return r>0?Xl(e,t+4,t+4+r):""},$T=BT,UT=function(e,t){return kX(e,t)},Qu=UT,Og=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ot&&(OT=function(t,r){if(!Buffer.isBuffer(t))return PT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},IT=function(t,r){if(!Buffer.isBuffer(t))return DT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},MT=function(t,r){if(!Buffer.isBuffer(t)||!Gu)return RT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},LT=function(t,r){if(!Buffer.isBuffer(t)||!Gu)return FT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},$T=function(t,r){if(!Buffer.isBuffer(t))return BT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Qu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):UT(t,r)},Og=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Is=function(e,t){return e[t]},Uo=function(e,t){return e[t+1]*256+e[t]},PX=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},dn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Oi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},OX=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Vo(e,t){var r="",n,a,i=[],s,l,c,u;switch(t){case"dbcs":if(u=this.l,ot&&Buffer.isBuffer(this)&&Gu)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Uo(this,u)),u+=2;e*=2;break;case"utf8":r=Xl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Pg(this,this.l,this.l+e);break;case"wstr":return Vo.call(this,e,"dbcs");case"lpstr-ansi":r=OT(this,this.l),e=4+dn(this,this.l);break;case"lpstr-cp":r=IT(this,this.l),e=4+dn(this,this.l);break;case"lpwstr":r=MT(this,this.l),e=4+2*dn(this,this.l);break;case"lpp4":e=4+dn(this,this.l),r=LT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+dn(this,this.l),r=$T(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Is(this,this.l+e++))!==0;)i.push(jc(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Uo(this,this.l+e))!==0;)i.push(jc(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Is(this,u),this.l=u+1,l=Vo.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(jc(Uo(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Is(this,u),this.l=u+1,l=Vo.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(jc(Is(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Is(this,this.l),this.l++,n;case 2:return n=(t==="i"?PX:Uo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Oi:OX)(this,this.l),this.l+=4,n):(a=dn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Qu(this,this.l):a=Qu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=AT(this,this.l,e);break}}return this.l+=e,r}var DX=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},IX=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},RX=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function MX(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)RX(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,DX(this,t,this.l);break;case 8:if(n=8,r==="f"){AX(this,t,this.l);break}case 16:break;case-4:n=4,IX(this,t,this.l);break}return this.l+=n,this}function HT(e,t){var r=AT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function $r(e,t){e.l=t,e.read_shift=Vo,e.chk=HT,e.write_shift=MX}function pa(e,t){e.l+=t}function re(e){var t=Qi(e);return $r(t,0),t}function Pr(){var e=[],t=ot?16384:2048;ot&&re(t).copy;var r=function(d){var f=re(d);return $r(f,0),f},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},s=function(){return a(),Kt(e)},l=function(){return a(),e},c=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e,end2:l}}function xe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=zee[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Og(r)&&e.push(r)}}function Ko(e,t,r){var n=Dr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function rN(e,t,r){var n=Dr(e);return n.s=Ko(n.s,t.s,r),n.e=Ko(n.e,t.s,r),n}function Go(e,t){if(e.cRel&&e.c<0)for(e=Dr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Mt(e);return!e.cRel&&e.cRel!=null&&(r=BX(r)),!e.rRel&&e.rRel!=null&&(r=FX(r)),r}function jh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ht(e.s.c)+":"+(e.e.cRel?"":"$")+ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+mt(e.s.r)+":"+(e.e.rRel?"":"$")+mt(e.e.r):Go(e.s,t.biff)+":"+Go(e.e,t.biff)}function Dg(e){return parseInt(LX(e),10)-1}function mt(e){return""+(e+1)}function FX(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LX(e){return e.replace(/\$(\d+)$/,"$1")}function Ig(e){for(var t=$X(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function BX(e){return e.replace(/^([A-Z])/,"$$$1")}function $X(e){return e.replace(/^\$([A-Z])/,"$1")}function UX(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function At(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function br(e){var t=e.indexOf(":");return t==-1?{s:At(e),e:At(e)}:{s:At(e.slice(0,t)),e:At(e.slice(t+1))}}function qt(e,t){return typeof t>"u"||typeof t=="number"?qt(e.s,e.e):(typeof e!="string"&&(e=Mt(e)),typeof t!="string"&&(t=Mt(t)),e==t?e:e+":"+t)}function vl(e){var t=br(e);return"$"+ht(t.s.c)+"$"+mt(t.s.r)+":$"+ht(t.e.c)+"$"+mt(t.e.r)}function bl(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function St(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function nN(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=za(e.z,r?yr(t):t)}catch{}try{return e.w=za((e.XF||{}).numFmtId||(r?14:0),r?yr(t):t)}catch{return""+t}}function Wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Vr[e.v]||e.v:t==null?nN(e,e.v):nN(e,t))}function xo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function HX(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function zT(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?At(n.origin):n.origin;s=c.r,l=c.c}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=St(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(u.e.r=s=i["!ref"]?d.e.r+1:0)}else u.s.c=u.e.c=u.s.r=u.e.r=0;for(var f=[],h=!1,p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");var x=s+p;a&&(i["!data"][x]||(i["!data"][x]=[]),f=i["!data"][x]);for(var g=t[p],v=0;v!=g.length;++v)if(!(typeof g[v]>"u")){var b={v:g[v],t:""},w=l+v;if(u.s.r>x&&(u.s.r=x),u.s.c>w&&(u.s.c=w),u.e.r<x&&(u.e.r=x),u.e.c<w&&(u.e.c=w),h=!0,g[v]&&typeof g[v]=="object"&&!Array.isArray(g[v])&&!(g[v]instanceof Date))b=g[v];else if(Array.isArray(b.v)&&(b.f=g[v][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(n.nullError)b.t="e",b.v=0;else if(n.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?isFinite(b.v)?b.t="n":isNaN(b.v)?(b.t="e",b.v=15):(b.t="e",b.v=7):typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=n.dateNF||_t[14],n.UTC||(b.v=f0(b.v)),n.cellDates?(b.t="d",b.w=za(b.z,yr(b.v,n.date1904))):(b.t="n",b.v=yr(b.v,n.date1904),b.w=za(b.z,b.v))):b.t="s";if(a)f[w]&&f[w].z&&(b.z=f[w].z),f[w]=b;else{var y=ht(w)+(x+1);i[y]&&i[y].z&&(b.z=i[y].z),i[y]=b}}}return h&&u.s.c<104e5&&(i["!ref"]=qt(u)),i}function go(e,t){return zT(null,e,t)}function zX(e){return e.read_shift(4,"i")}function Wn(e,t){return t||(t=re(4)),t.write_shift(4,e),t}function Or(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function er(e,t){var r=!1;return t==null&&(r=!0,t=re(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function WX(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function VX(e,t){return t||(t=re(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Rg(e,t){var r=e.l,n=e.read_shift(1),a=Or(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(WX(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function KX(e,t){var r=!1;return t==null&&(r=!0,t=re(15+4*e.t.length)),t.write_shift(1,0),er(e.t,t),r?t.slice(0,t.l):t}var GX=Rg;function XX(e,t){var r=!1;return t==null&&(r=!0,t=re(23+4*e.t.length)),t.write_shift(1,1),er(e.t,t),t.write_shift(4,1),VX({},t),r?t.slice(0,t.l):t}function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function fs(e,t){return t==null&&(t=re(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function hs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ps(e,t){return t==null&&(t=re(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var YX=Or,WT=er;function h0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yl(e,t){var r=!1;return t==null&&(r=!0,t=re(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var qX=Or,Qp=h0,Mg=yl;function Fg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Qu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Oi(t,0)>>2;return r?a/100:a}function VT(e,t){t==null&&(t=re(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function KT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function ZX(e,t){return t||(t=re(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ms=KT,vo=ZX;function bo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function rs(e,t){return(t||re(8)).write_shift(8,e,"f")}function JX(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=oY[a];u&&(t.rgb=mN(u));break;case 2:t.rgb=mN([s,l,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function ed(e,t){if(t||(t=re(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function QX(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function eY(e,t){t||(t=re(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var GT=2,ln=3,kc=11,td=19,Ac=64,tY=65,rY=71,nY=4108,aY=4126,xr=80,aN={1:{n:"CodePage",t:GT},2:{n:"Category",t:xr},3:{n:"PresentationFormat",t:xr},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:kc},12:{n:"HeadingPairs",t:nY},13:{n:"TitlesOfParts",t:aY},14:{n:"Manager",t:xr},15:{n:"Company",t:xr},16:{n:"LinksUpToDate",t:kc},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:kc},22:{n:"HyperlinksChanged",t:kc},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:tY},26:{n:"ContentType",t:xr},27:{n:"ContentStatus",t:xr},28:{n:"Language",t:xr},29:{n:"Version",t:xr},255:{},2147483648:{n:"Locale",t:td},2147483651:{n:"Behavior",t:td},1919054434:{}},iN={1:{n:"CodePage",t:GT},2:{n:"Title",t:xr},3:{n:"Subject",t:xr},4:{n:"Author",t:xr},5:{n:"Keywords",t:xr},6:{n:"Comments",t:xr},7:{n:"Template",t:xr},8:{n:"LastAuthor",t:xr},9:{n:"RevNumber",t:xr},10:{n:"EditTime",t:Ac},11:{n:"LastPrinted",t:Ac},12:{n:"CreatedDate",t:Ac},13:{n:"ModifiedDate",t:Ac},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:rY},18:{n:"Application",t:xr},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:td},2147483651:{n:"Behavior",t:td},1919054434:{}};function iY(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var sY=iY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),oY=Dr(sY),Vr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sa={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lY=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],cY={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Pc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function XT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YT(e,t,r){var n=uX(cY),a=[],i;a[a.length]=Jt,a[a.length]=Ee("Types",null,{xmlns:or.CT,"xmlns:xsd":or.xsd,"xmlns:xsi":or.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ee("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(i=e[u][0],a[a.length]=Ee("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Pc[u][t.bookType]||Pc[u].xlsx}))},l=function(u){(e[u]||[]).forEach(function(d){a[a.length]=Ee("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Pc[u][t.bookType]||Pc[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(d){a[a.length]=Ee("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[u][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qT(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ks(e){var t=[Jt,Ee("Relationships",null,{xmlns:or.RELS})];return Yt(e["!id"]).forEach(function(r){t[t.length]=Ee("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function it(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function uY(e){var t=[Jt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sN(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function dY(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function fY(e){var t=[Jt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sN(e[r][0],e[r][1])),t.push(dY("",e[r][0]));return t.push(sN("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ZT(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Vu.version+"</meta:generator></office:meta></office:document-meta>"}var $i=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Th(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ze(t),n[n.length]=r?Ee(e,t,r):gr(e,t))}function JT(e,t){var r=t||{},n=[Jt,Ee("cp:coreProperties",null,{"xmlns:cp":or.CORE_PROPS,"xmlns:dc":or.dc,"xmlns:dcterms":or.dcterms,"xmlns:dcmitype":or.dcmitype,"xmlns:xsi":or.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Th("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Jp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Th("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Jp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=$i.length;++i){var s=$i[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Th(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],QT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function e4(e){var t=[],r=Ee;return e||(e={}),e.Application="SheetJS",t[t.length]=Jt,t[t.length]=Ee("Properties",null,{xmlns:or.EXT_PROPS,"xmlns:vt":or.vt}),Gs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ze(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ze(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function t4(e){var t=[Jt,Ee("Properties",null,{xmlns:or.CUST_PROPS,"xmlns:vt":or.vt})];if(!e)return t.join("");var r=1;return Yt(e).forEach(function(a){++r,t[t.length]=Ee("property",CX(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ze(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var oN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hY(e,t){var r=[];return Yt(oN).map(function(n){for(var a=0;a<$i.length;++a)if($i[a][1]==n)return $i[a];for(a=0;a<Gs.length;++a)if(Gs[a][1]==n)return Gs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(gr(oN[n[1]]||n[1],a))}}),Ee("DocumentProperties",r.join(""),{xmlns:un.o})}function pY(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Yt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<$i.length;++s)if(i==$i[s][1])return;for(s=0;s<Gs.length;++s)if(i==Gs[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Ee(X2(i),l,{"dt:dt":c}))}}),t&&Yt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ee(X2(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+un.o+'">'+a.join("")+"</"+n+">"}function mY(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=re(8);return s.write_shift(4,n),s.write_shift(4,a),s}function lN(e,t){var r=re(4),n=re(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=re(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=mY(t);break;case 31:case 80:for(n=re(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Kt([r,n])}var r4=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xY(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function cN(e,t,r){var n=re(8),a=[],i=[],s=8,l=0,c=re(8),u=re(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=re(8),u.write_shift(4,0),a.unshift(u);var d=[re(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=re(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Kt(d),i.unshift(c),s+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(r4.indexOf(e[l][0])>-1||QT.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=lN(x.t,h)}else{var v=xY(h);v==-1&&(v=31,h=String(h)),c=lN(v,h)}i.push(c),u=re(8),u.write_shift(4,t?p:2+l),a.push(u),s+=8+c.length}var b=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,b),b+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),Kt([n].concat(a).concat(i))}function uN(e,t,r,n,a,i){var s=re(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=cN(e,r,n);if(l.push(c),a){var u=cN(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),l.push(u)}return Kt(l)}function gY(e,t){t||(t=re(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function vY(e,t){return e.read_shift(t)===1}function jr(e,t){return t||(t=re(2)),t.write_shift(2,+!!e),t}function Wc(e){return e.read_shift(2,"u")}function En(e,t){return t||(t=re(2)),t.write_shift(2,e),t}function n4(e,t,r){return r||(r=re(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function a4(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Sa;if(r&&r.biff>=8&&(Sa=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return Sa=i,l}function bY(e){var t=e.t||"",r=re(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=re(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Kt(a)}function yY(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function wY(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):yY(e,n,r)}function NY(e,t,r){if(r.biff>5)return wY(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function i4(e,t,r){return r||(r=re(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dN(e,t){t||(t=re(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _Y(e){var t=re(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),dN(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&dN(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ns(e,t,r,n){return n||(n=re(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function SY(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function EY(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function s4(e,t){return t||(t=re(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Lg(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=re(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function jY(e,t){var r=!t||t.biff==8,n=re(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function TY(e,t){var r=!t||t.biff>=8?2:1,n=re(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function CY(e,t){var r=re(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=bY(e[a]);var i=Kt([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function kY(){var e=re(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function AY(e){var t=re(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function PY(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=re(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function OY(e,t,r,n){var a=re(10);return ns(e,t,n,a),a.write_shift(4,r),a}function DY(e,t,r,n,a){var i=!a||a.biff==8,s=re(8+ +i+(1+i)*r.length);return ns(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function IY(e,t,r,n){var a=r&&r.biff==5;n||(n=re(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function RY(e){var t=re(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function MY(e){var t=re(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function FY(e,t){var r=t.biff==8||!t.biff?4:2,n=re(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function fN(e,t,r,n){var a=r&&r.biff==5;n||(n=re(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function LY(e){var t=re(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function o4(e){var t=re(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var BY=o4;function $Y(e){var t=re(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ch(e,t,r,n,a,i){var s=re(8);return ns(e,t,n,s),n4(r,i,s),s}function UY(e,t,r,n){var a=re(14);return ns(e,t,n,a),rs(r,a),a}function HY(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return hN(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(SY(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function hN(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=a4(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function kh(e,t,r,n){var a=re(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function zY(e){var t=re(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)s4(e[r],t);return t}function WY(e){var t=re(24),r=At(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Kt([t,_Y(e[1])])}function VY(e){var t=e[1].Tooltip,r=re(10+2*(t.length+1));r.write_shift(2,2048);var n=At(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function KY(e){return e||(e=re(4)),e.write_shift(2,1),e.write_shift(2,1),e}function GY(e,t,r){if(!r.cellStyles)return pa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function XY(e,t){var r=re(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function YY(e){for(var t=re(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Yl(e,t,r,n,a){return e||(e=re(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function qY(e,t,r,n,a){var i=re(15);return Yl(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function ZY(e,t,r,n,a){var i=re(9);return Yl(i,e,t,n||0,a||0),i.write_shift(2,r),i}var JY=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=Qi(1);switch(c.type){case"base64":d=cn(xi(l));break;case"binary":d=cn(l);break;case"buffer":case"array":d=l;break}$r(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,v=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(v=d.read_shift(2));var b=d.read_shift(2);c.codepage,f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&e[d[d.l]],d.l+=1,d.l+=2),x&&(d.l+=36);for(var w=[],y={},N=Math.min(d.length,f==2?521:v-10-(p?264:0)),S=x?32:11;d.l<N&&d[d.l]!=13;)switch(y={},y.name=es(d.slice(d.l,d.l+S)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=S,y.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(y.offset=d.read_shift(4)),y.len=d.read_shift(1),f==2&&(y.offset=d.read_shift(2)),y.dec=d.read_shift(1),y.name.length&&w.push(y),f!=2&&(d.l+=x?13:14),y.type){case"B":(!p||y.len!=8)&&c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var E=0,_=0;for(u[0]=[],_=0;_!=w.length;++_)u[0][_]=w[_].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++E]=[],_=0,_=0;_!=w.length;++_){var j=d.slice(d.l,d.l+w[_].len);d.l+=w[_].len,$r(j,0);var A=es(j);switch(w[_].type){case"C":A.trim().length&&(u[E][_]=A.replace(/([^\s])\s+$/,"$1"));break;case"D":A.length===8?(u[E][_]=new Date(Date.UTC(+A.slice(0,4),+A.slice(4,6)-1,+A.slice(6,8),0,0,0,0)),c&&c.UTC||(u[E][_]=ro(u[E][_]))):u[E][_]=A;break;case"F":u[E][_]=parseFloat(A.trim());break;case"+":case"I":u[E][_]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(A.trim().toUpperCase()){case"Y":case"T":u[E][_]=!0;break;case"N":case"F":u[E][_]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+A+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[E][_]="##MEMO##"+(x?parseInt(A.trim(),10):j.read_shift(4));break;case"N":A=A.replace(/\u0000/g,"").trim(),A&&A!="."&&(u[E][_]=+A||0);break;case"@":u[E][_]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":{var T=j.read_shift(4),k=j.read_shift(4);if(T==0&&k==0)break;u[E][_]=new Date((T-2440588)*864e5+k),c&&c.UTC||(u[E][_]=ro(u[E][_]))}break;case"Y":u[E][_]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][_]=-j.read_shift(-8,"f");break;case"B":if(p&&w[_].len==8){u[E][_]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[_].len;break;case"0":if(w[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[_].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=go(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{var u=xo(n(l,c),c);return u.bookType="dbf",u}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var u=c||{},d=Sa;if(+u.codepage>=0&&ml(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Pr(),h=nm(l,{header:1,raw:!0,cellDates:!0}),p=h[0],x=h.slice(1),g=l["!cols"]||[],v=0,b=0,w=0,y=1;for(v=0;v<p.length;++v){if(((g[v]||{}).DBF||{}).name){p[v]=g[v].DBF.name,++w;continue}if(p[v]!=null){if(++w,typeof p[v]=="number"&&(p[v]=p[v].toString(10)),typeof p[v]!="string")throw new Error("DBF Invalid column name "+p[v]+" |"+typeof p[v]+"|");if(p.indexOf(p[v])!==v){for(b=0;b<1024;++b)if(p.indexOf(p[v]+"_"+b)==-1){p[v]+="_"+b;break}}}}var N=St(l["!ref"]),S=[],E=[],_=[];for(v=0;v<=N.e.c-N.s.c;++v){var j="",A="",T=0,k=[];for(b=0;b<x.length;++b)x[b][v]!=null&&k.push(x[b][v]);if(k.length==0||p[v]==null){S[v]="?";continue}for(b=0;b<k.length;++b){switch(typeof k[b]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=k[b]instanceof Date?"D":"C";break;default:A="C"}T=Math.max(T,String(k[b]).length),j=j&&j!=A?"C":A}T>250&&(T=250),A=((g[v]||{}).DBF||{}).type,A=="C"&&g[v].DBF.len>T&&(T=g[v].DBF.len),j=="B"&&A=="N"&&(j="N",_[v]=g[v].DBF.dec,T=g[v].DBF.len),E[v]=j=="C"||A=="N"?T:i[j]||0,y+=E[v],S[v]=j}var C=f.next(32);for(C.write_shift(4,318902576),C.write_shift(4,x.length),C.write_shift(2,296+32*w),C.write_shift(2,y),v=0;v<4;++v)C.write_shift(4,0);var L=+t[Sa]||3;for(C.write_shift(4,0|L<<8),e[L]!=+u.codepage&&(u.codepage&&console.error("DBF Unsupported codepage "+Sa+", using 1252"),Sa=1252),v=0,b=0;v<p.length;++v)if(p[v]!=null){var G=f.next(32),V=(p[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,V,"sbcs"),G.write_shift(1,S[v]=="?"?"C":S[v],"sbcs"),G.write_shift(4,b),G.write_shift(1,E[v]||i[S[v]]||0),G.write_shift(1,_[v]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),b+=E[v]||i[S[v]]||0}var X=f.next(264);for(X.write_shift(4,13),v=0;v<65;++v)X.write_shift(4,0);for(v=0;v<x.length;++v){var K=f.next(y);for(K.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(S[b]){case"L":K.write_shift(1,x[v][b]==null?63:x[v][b]?84:70);break;case"B":K.write_shift(8,x[v][b]||0,"f");break;case"N":var Y="0";for(typeof x[v][b]=="number"&&(Y=x[v][b].toFixed(_[b]||0)),Y.length>E[b]&&(Y=Y.slice(0,E[b])),w=0;w<E[b]-Y.length;++w)K.write_shift(1,32);K.write_shift(1,Y,"sbcs");break;case"D":x[v][b]?(K.write_shift(4,("0000"+x[v][b].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(x[v][b].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+x[v][b].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var q=K.l,Z=String(x[v][b]!=null?x[v][b]:"").slice(0,E[b]);for(K.write_shift(1,Z,"cpstr"),q+=E[b]-K.l,w=0;w<q;++w)K.write_shift(1,32);break}}return Sa=d,f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),QY=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(p,x){var g=e[x];return typeof g=="number"?M2(g):g},n=function(p,x,g){var v=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?p:M2(v)};e["|"]=254;var a=function(p){return p.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(p,x){switch(x.type){case"base64":return s(xi(p),x);case"binary":return s(p,x);case"buffer":return s(ot&&Buffer.isBuffer(p)?p.toString("binary"):es(p),x);case"array":return s(Tg(p),x)}throw new Error("Unrecognized type "+x.type)}function s(p,x){var g=p.split(/[\n\r]+/),v=-1,b=-1,w=0,y=0,N=[],S=[],E=null,_={},j=[],A=[],T=[],k=0,C,L={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&ml(+x.codepage);w!==g.length;++w){k=0;var G=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=G.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),X=V[0],K;if(G.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"V":{var Y=parseInt(V[y].slice(1),10);Y>=1&&Y<=4&&(L.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":V[1].charAt(0)==="P"&&S.push(G.slice(3).replace(/;;/g,";"));break;case"NN":{var q={Sheet:0};for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"N":q.Name=V[y].slice(1);break;case"E":q.Ref=(x&&x.sheet||"Sheet1")+"!"+vN(V[y].slice(1));break}L.Workbook.Names.push(q)}break;case"C":var Z=!1,le=!1,ce=!1,me=!1,Ne=-1,ee=-1,oe="",fe="z",O="";for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":O=V[y].slice(1);break;case"X":b=parseInt(V[y].slice(1),10)-1,le=!0;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,le||(b=0),C=N.length;C<=v;++C)N[C]=[];break;case"K":K=V[y].slice(1),K.charAt(0)==='"'?(K=K.slice(1,K.length-1),fe="s"):K==="TRUE"||K==="FALSE"?(K=K==="TRUE",fe="b"):K.charAt(0)=="#"&&sa[K]!=null?(fe="e",K=sa[K]):isNaN(Da(K))||(K=Da(K),fe="n",E!==null&&ts(E)&&x.cellDates&&(K=Ws(L.Workbook.WBProps.date1904?K+1462:K),fe=typeof K=="number"?"n":"d")),Z=!0;break;case"E":me=!0,oe=vN(V[y].slice(1),{r:v,c:b});break;case"S":ce=!0;break;case"G":break;case"R":Ne=parseInt(V[y].slice(1),10)-1;break;case"C":ee=parseInt(V[y].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}if(Z&&(N[v][b]?(N[v][b].t=fe,N[v][b].v=K):N[v][b]={t:fe,v:K},E&&(N[v][b].z=E),x.cellText!==!1&&E&&(N[v][b].w=za(N[v][b].z,N[v][b].v,{date1904:L.Workbook.WBProps.date1904})),E=null),ce){if(me)throw new Error("SYLK shared formula cannot have own formula");var I=Ne>-1&&N[Ne][ee];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");oe=eZ(I[1],{r:v-Ne,c:b-ee})}oe&&(N[v][b]?N[v][b].f=oe:N[v][b]={t:"n",f:oe}),O&&(N[v][b]||(N[v][b]={t:"z"}),N[v][b].c=[{a:"SheetJSYLK",t:O}]);break;case"F":var F=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":b=parseInt(V[y].slice(1),10)-1,++F;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,C=N.length;C<=v;++C)N[C]=[];break;case"M":k=parseInt(V[y].slice(1),10)/20;break;case"F":break;case"G":break;case"P":E=S[parseInt(V[y].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(T=V[y].slice(1).split(" "),C=parseInt(T[0],10);C<=parseInt(T[1],10);++C)k=parseInt(T[2],10),A[C-1]=k===0?{hidden:!0}:{wch:k};break;case"C":b=parseInt(V[y].slice(1),10)-1,A[b]||(A[b]={});break;case"R":v=parseInt(V[y].slice(1),10)-1,j[v]||(j[v]={}),k>0?(j[v].hpt=k,j[v].hpx=d4(k)):k===0&&(j[v].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}F<1&&(E=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}}return j.length>0&&(_["!rows"]=j),A.length>0&&(_["!cols"]=A),A.forEach(function(M){Bg(M)}),x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),[N,_,L]}function l(p,x){var g=i(p,x),v=g[0],b=g[1],w=g[2],y=Dr(x);y.date1904=(((w||{}).Workbook||{}).WBProps||{}).date1904;var N=go(v,y);Yt(b).forEach(function(E){N[E]=b[E]});var S=xo(N,x);return Yt(w).forEach(function(E){S[E]=w[E]}),S.bookType="sylk",S}function c(p,x,g,v,b,w){var y="C;Y"+(g+1)+";X"+(v+1)+";K";switch(p.t){case"n":y+=isFinite(p.v)?p.v||0:Vr[isNaN(p.v)?36:7],p.f&&!p.F&&(y+=";E"+m0(p.f,{r:g,c:v}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||Vr[p.v]||p.v;break;case"d":y+=yr(rn(p.v,w),w);break;case"s":y+='"'+(p.v==null?"":String(p.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,x,g){var v="C;Y"+(x+1)+";X"+(g+1)+";A";return v+=a(p.map(function(b){return b.t}).join("")),v}function d(p,x){x.forEach(function(g,v){var b="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?b+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=rd(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=nd(g.wpx)),typeof g.wch=="number"&&(b+=Math.round(g.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function f(p,x){x.forEach(function(g,v){var b="F;";g.hidden?b+="M0;":g.hpt?b+="M"+20*g.hpt+";":g.hpx&&(b+="M"+20*ad(g.hpx)+";"),b.length>2&&p.push(b+"R"+(v+1))})}function h(p,x,g){x||(x={}),x._formats=["General"];var v=["ID;PSheetJS;N;E"],b=[],w=St(p["!ref"]||"A1"),y,N=p["!data"]!=null,S=`\r
`,E=(((g||{}).Workbook||{}).WBProps||{}).date1904,_="General";v.push("P;PGeneral");var j=w.s.r,A=w.s.c,T=[];if(p["!ref"]){for(j=w.s.r;j<=w.e.r;++j)if(!(N&&!p["!data"][j])){for(T=[],A=w.s.c;A<=w.e.c;++A)y=N?p["!data"][j][A]:p[ht(A)+mt(j)],!(!y||!y.c)&&T.push(u(y.c,j,A));T.length&&b.push(T.join(S))}}if(p["!ref"]){for(j=w.s.r;j<=w.e.r;++j)if(!(N&&!p["!data"][j])){for(T=[],A=w.s.c;A<=w.e.c;++A)if(y=N?p["!data"][j][A]:p[ht(A)+mt(j)],!(!y||y.v==null&&(!y.f||y.F))){if((y.z||(y.t=="d"?_t[14]:"General"))!=_){var k=x._formats.indexOf(y.z);k==-1&&(x._formats.push(y.z),k=x._formats.length-1,v.push("P;P"+y.z.replace(/;/g,";;"))),T.push("F;P"+k+";Y"+(j+1)+";X"+(A+1))}T.push(c(y,p,j,A,x,E))}b.push(T.join(S))}}return v.push("F;P0;DG0G8;M255"),p["!cols"]&&d(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),p["!ref"]&&v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" ")),v.push("O;L;D;B"+(E?";V4":"")+";K47;G100 0.001"),delete x._formats,v.join(S)+S+b.join(S)+S+"E"+S}return{to_workbook:l,from_sheet:h}})(),eq=(function(){function e(l,c){switch(c.type){case"base64":return t(xi(l),c);case"binary":return t(l,c);case"buffer":return t(ot&&Buffer.isBuffer(l)?l.toString("binary"):es(l),c);case"array":return t(Tg(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var u=l.split(`
`),d=-1,f=-1,h=0,p=[];h!==u.length;++h){if(u[h].trim()==="BOT"){p[++d]=[],f=0;continue}if(!(d<0)){var x=u[h].trim().split(","),g=x[0],v=x[1];++h;for(var b=u[h]||"";(b.match(/["]/g)||[]).length&1&&h<u.length-1;)b+=`
`+u[++h];switch(b=b.trim(),+g){case-1:if(b==="BOT"){p[++d]=[],f=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[d][f]=!0:b==="FALSE"?p[d][f]=!1:isNaN(Da(v))?isNaN(Ju(v).getDate())?p[d][f]=v:(p[d][f]=rn(v),c&&c.UTC||(p[d][f]=ro(p[d][f]))):p[d][f]=Da(v),++f;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[d][f++]=b!==""?b:null;break}if(b==="EOD")break}}return c&&c.sheetRows&&(p=p.slice(0,c.sheetRows)),p}function r(l,c){return go(e(l,c),c)}function n(l,c){var u=xo(r(l,c),c);return u.bookType="dif",u}function a(l,c){return"0,"+String(l)+`\r
`+c}function i(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function s(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var c=St(l["!ref"]),u=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],f=c.s.r;f<=c.e.r;++f){for(var h=u?l["!data"][f]:[],p=`-1,0\r
BOT\r
`,x=c.s.c;x<=c.e.c;++x){var g=u?h&&h[x]:l[Mt({r:f,c:x})];if(g==null){p+=`1,0\r
""\r
`;continue}switch(g.t){case"n":g.w!=null?p+="0,"+g.w+`\r
V`:g.v!=null?p+=a(g.v,"V"):g.f!=null&&!g.F?p+=i("="+g.f):p+=`1,0\r
""`;break;case"b":p+=g.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":p+=i(isNaN(+g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=za(g.z||_t[14],yr(rn(g.v)))),p+=a(g.w,"V");break;default:p+=`1,0\r
""`}p+=`\r
`}d.push(p)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),l4=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),x=-1,g=-1,v=0,b=[];v!==p.length;++v){var w=p[v].trim().split(":");if(w[0]==="cell"){var y=At(w[1]);if(b.length<=y.r)for(x=b.length;x<=y.r;++x)b[x]||(b[x]=[]);switch(x=y.r,g=y.c,w[2]){case"t":b[x][g]=e(w[3]);break;case"v":b[x][g]=+w[3];break;case"vtf":var N=w[w.length-1];case"vtc":w[3]==="nl"?b[x][g]=!!+w[4]:b[x][g]=w[w.length-1].charAt(0)=="#"?{t:"e",v:sa[w[w.length-1]]}:+w[4],w[2]=="vtf"&&(b[x][g]=[b[x][g],N])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return go(r(f,h),h)}function a(f,h){return xo(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,g="",v=br(f["!ref"]),b=f["!data"]!=null,w=v.s.r;w<=v.e.r;++w)for(var y=v.s.c;y<=v.e.c;++y)if(g=Mt({r:w,c:y}),x=b?(f["!data"][w]||[])[y]:f[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":p.push(t(x.v));break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=yr(rn(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||za(x.z||_t[14],N);break;case"n":isFinite(x.v)?x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v):(p[2]="vt"+(x.f?"f":"c"),p[3]="e"+Vr[isNaN(x.v)?36:7],p[4]="0",p[5]=x.f||p[3].slice(1),p[6]="e",p[7]=p[3].slice(1));break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,s,l,s,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}})(),tq=(function(){function e(d,f,h,p,x){x.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(Da(d))?isNaN(Ju(d).getDate())?d.charCodeAt(0)==35&&sa[d]!=null?f[h][p]={t:"e",v:sa[d],w:d}:f[h][p]=d:f[h][p]=rn(d):f[h][p]=Da(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var v=10,b=0,w=0;w<=g;++w)b=x[w].indexOf(" "),b==-1?b=x[w].length:b++,v=Math.max(v,b);for(w=0;w<=g;++w){p[w]=[];var y=0;for(e(x[w].slice(0,v).trim(),p,w,y,h),y=1;y<=(x[w].length-v)/10+1;++y)e(x[w].slice(v+(y-1)*10,v+y*10).trim(),p,w,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[x.pop()[1]]||44}function i(d,f){var h=f||{},p="",x={};h.dense&&(x["!data"]=[]);var g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=a(d.slice(0,1024)):h&&h.FS?p=h.FS:p=a(d.slice(0,1024));var v=0,b=0,w=0,y=0,N=0,S=p.charCodeAt(0),E=!1,_=0,j=d.charCodeAt(0),A=h.dateNF!=null?iX(h.dateNF):null;function T(){var k=d.slice(y,N);k.slice(-1)=="\r"&&(k=k.slice(0,-1));var C={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(C.w=k),k.length===0)C.t="z";else if(h.raw)C.t="s",C.v=k;else if(k.trim().length===0)C.t="s",C.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(C.t="s",C.v=k.slice(2,-1).replace(/""/g,'"')):tZ(k)?(C.t="s",C.f=k.slice(1),C.v=k):(C.t="s",C.v=k);else if(k=="TRUE")C.t="b",C.v=!0;else if(k=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=Da(k)))C.t="n",C.v=w;else if(!isNaN((w=Ju(k)).getDate())||A&&k.match(A)){if(C.z=h.dateNF||_t[14],A&&k.match(A)){var L=sX(k,h.dateNF,k.match(A)||[]);w=rn(L),h&&h.UTC===!1&&(w=ro(w))}else h&&h.UTC===!1?w=ro(w):h.cellText!==!1&&h.dateNF&&(C.w=za(C.z,w));h.cellDates?(C.t="d",C.v=w):(C.t="n",C.v=yr(w)),h.cellNF||delete C.z}else k.charCodeAt(0)==35&&sa[k]!=null?(C.t="e",C.w=k,C.v=sa[k]):(C.t="s",C.v=k);if(C.t=="z"||(h.dense?(x["!data"][v]||(x["!data"][v]=[]),x["!data"][v][b]=C):x[Mt({c:b,r:v})]=C),y=N+1,j=d.charCodeAt(y),g.e.c<b&&(g.e.c=b),g.e.r<v&&(g.e.r=v),_==S)++b;else if(b=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;N<d.length;++N)switch(_=d.charCodeAt(N)){case 34:j===34&&(E=!E);break;case 13:if(E)break;d.charCodeAt(N+1)==10&&++N;case S:case 10:if(!E&&T())break e;break}return N-y>0&&T(),x["!ref"]=qt(g),x}function s(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):go(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:Cte(d,f);switch(f.type){case"base64":h=xi(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):(f.codepage,h=ot&&Buffer.isBuffer(d)?d.toString("binary"):es(d));break;case"array":h=Tg(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Vs(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Vs(h):f.type=="binary",h.slice(0,19)=="socialcalc:version:"?l4.to_sheet(f.type=="string"?h:Vs(h),f):s(h,f)}function c(d,f){return xo(l(d,f),f)}function u(d){var f=[];if(!d["!ref"])return"";for(var h=St(d["!ref"]),p,x=d["!data"]!=null,g=h.s.r;g<=h.e.r;++g){for(var v=[],b=h.s.c;b<=h.e.c;++b){var w=Mt({r:g,c:b});if(p=x?(d["!data"][g]||[])[b]:d[w],!p||p.v==null){v.push("          ");continue}for(var y=(p.w||(Wa(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(b===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}})(),pN=(function(){function e(O,I,F){if(O){$r(O,O.l||0);for(var M=F.Enum||me;O.l<O.length;){var W=O.read_shift(2),J=M[W]||M[65535],se=O.read_shift(2),ke=O.l+se,ye=J.f&&J.f(O,se,F);if(O.l=ke,I(ye,J,W))return}}}function t(O,I){switch(I.type){case"base64":return n(cn(xi(O)),I);case"binary":return n(cn(O),I);case"buffer":case"array":return n(O,I)}throw"Unsupported type "+I.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(O,I){if(!O)return O;var F=I||{},M={},W="Sheet1",J="",se=0,ke={},ye=[],Pe=[],ue=[];F.dense&&(ue=M["!data"]=[]);var Be={s:{r:0,c:0},e:{r:0,c:0}},Ve=F.sheetRows||0,ve={};if(O[4]==81&&O[5]==80&&O[6]==87)return fe(O,I);if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)F.Enum=me,e(O,function(pe,We,Oe){switch(Oe){case 0:F.vers=pe,pe>=4096&&(F.qpro=!0);break;case 255:F.vers=pe,F.works=!0;break;case 6:Be=pe;break;case 204:pe&&(J=pe);break;case 222:J=pe;break;case 15:case 51:(!F.qpro&&!F.works||Oe==51)&&pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),(F.works||F.works2)&&(pe[1].v=pe[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=F.dateNF||r[(pe[2]&15)-1]||_t[14],F.cellDates&&(pe[1].v=Ws(pe[1].v),pe[1].t=typeof pe[1].v=="number"?"n":"d")),F.qpro&&pe[3]>se&&(M["!ref"]=qt(Be),ke[W]=M,ye.push(W),M={},F.dense&&(ue=M["!data"]=[]),Be={s:{r:0,c:0},e:{r:0,c:0}},se=pe[3],W=J||"Sheet"+(se+1),J="");var Ae=F.dense?(ue[pe[0].r]||[])[pe[0].c]:M[Mt(pe[0])];if(Ae){Ae.t=pe[1].t,Ae.v=pe[1].v,pe[1].z!=null&&(Ae.z=pe[1].z),pe[1].f!=null&&(Ae.f=pe[1].f),ve=Ae;break}F.dense?(ue[pe[0].r]||(ue[pe[0].r]=[]),ue[pe[0].r][pe[0].c]=pe[1]):M[Mt(pe[0])]=pe[1],ve=pe[1];break;case 21509:F.works2=!0;break;case 21506:pe==5281&&(ve.z="hh:mm:ss",F.cellDates&&ve.t=="n"&&(ve.v=Ws(ve.v),ve.t=typeof ve.v=="number"?"n":"d"));break}},F);else if(O[2]==26||O[2]==14)F.Enum=Ne,O[2]==14&&(F.qpro=!0,O.l=0),e(O,function(pe,We,Oe){switch(Oe){case 204:W=pe;break;case 22:pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),pe[1].v=pe[1].v.replace(/\x0F./g,function(Ae){return String.fromCharCode(Ae.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>se&&(M["!ref"]=qt(Be),ke[W]=M,ye.push(W),M={},F.dense&&(ue=M["!data"]=[]),Be={s:{r:0,c:0},e:{r:0,c:0}},se=pe[3],W="Sheet"+(se+1)),Ve>0&&pe[0].r>=Ve)break;F.dense?(ue[pe[0].r]||(ue[pe[0].r]=[]),ue[pe[0].r][pe[0].c]=pe[1]):M[Mt(pe[0])]=pe[1],Be.e.c<pe[0].c&&(Be.e.c=pe[0].c),Be.e.r<pe[0].r&&(Be.e.r=pe[0].r);break;case 27:pe[14e3]&&(Pe[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Pe[pe[0]]=pe[1],pe[0]==se&&(W=pe[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(M["!ref"]=qt(Be),ke[J||W]=M,ye.push(J||W),!Pe.length)return{SheetNames:ye,Sheets:ke};for(var we={},he=[],Te=0;Te<Pe.length;++Te)ke[ye[Te]]?(he.push(Pe[Te]||ye[Te]),we[Pe[Te]]=ke[Pe[Te]]||ke[ye[Te]]):(he.push(Pe[Te]),we[Pe[Te]]={"!ref":"A1"});return{SheetNames:he,Sheets:we}}function a(O,I){var F=I||{};if(+F.codepage>=0&&ml(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Pr();if(!O["!ref"])throw new Error("Cannot export empty sheet to WK1");var W=St(O["!ref"]),J=O["!data"]!=null,se=[];be(M,0,s(1030)),be(M,6,u(W));for(var ke=Math.min(W.e.r,8191),ye=W.s.c;ye<=W.e.c;++ye)se[ye]=ht(ye);for(var Pe=W.s.r;Pe<=ke;++Pe){var ue=mt(Pe);for(ye=W.s.c;ye<=W.e.c;++ye){var Be=J?(O["!data"][Pe]||[])[ye]:O[se[ye]+ue];if(!(!Be||Be.t=="z"))switch(Be.t){case"n":(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?be(M,13,v(Pe,ye,Be)):be(M,14,w(Pe,ye,Be));break;case"d":var Ve=yr(Be.v);(Ve|0)==Ve&&Ve>=-32768&&Ve<=32767?be(M,13,v(Pe,ye,{v:Ve,z:Be.z||_t[14]})):be(M,14,w(Pe,ye,{v:Ve,z:Be.z||_t[14]}));break;default:var ve=Wa(Be);be(M,15,p(Pe,ye,ve.slice(0,239)))}}}return be(M,1),M.end()}function i(O,I){var F=I||{};if(+F.codepage>=0&&ml(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Pr();be(M,0,l(O));for(var W=0,J=0;W<O.SheetNames.length;++W)(O.Sheets[O.SheetNames[W]]||{})["!ref"]&&be(M,27,ce(O.SheetNames[W],J++));var se=0;for(W=0;W<O.SheetNames.length;++W){var ke=O.Sheets[O.SheetNames[W]];if(!(!ke||!ke["!ref"])){for(var ye=St(ke["!ref"]),Pe=ke["!data"]!=null,ue=[],Be=Math.min(ye.e.r,8191),Ve=ye.s.r;Ve<=Be;++Ve)for(var ve=mt(Ve),we=ye.s.c;we<=ye.e.c;++we){Ve===ye.s.r&&(ue[we]=ht(we));var he=ue[we]+ve,Te=Pe?(ke["!data"][Ve]||[])[we]:ke[he];if(!(!Te||Te.t=="z"))if(Te.t=="n")be(M,23,L(Ve,we,se,Te.v));else{var pe=Wa(Te);be(M,22,T(Ve,we,se,pe.slice(0,239)))}}++se}}return be(M,1),M.end()}function s(O){var I=re(2);return I.write_shift(2,O),I}function l(O){var I=re(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var F=0,M=0,W=0,J=0;J<O.SheetNames.length;++J){var se=O.SheetNames[J],ke=O.Sheets[se];if(!(!ke||!ke["!ref"])){++W;var ye=br(ke["!ref"]);F<ye.e.r&&(F=ye.e.r),M<ye.e.c&&(M=ye.e.c)}}return F>8191&&(F=8191),I.write_shift(2,F),I.write_shift(1,W),I.write_shift(1,M),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(O,I,F){var M={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&F.qpro?(M.s.c=O.read_shift(1),O.l++,M.s.r=O.read_shift(2),M.e.c=O.read_shift(1),O.l++,M.e.r=O.read_shift(2),M):(M.s.c=O.read_shift(2),M.s.r=O.read_shift(2),I==12&&F.qpro&&(O.l+=2),M.e.c=O.read_shift(2),M.e.r=O.read_shift(2),I==12&&F.qpro&&(O.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function u(O){var I=re(8);return I.write_shift(2,O.s.c),I.write_shift(2,O.s.r),I.write_shift(2,O.e.c),I.write_shift(2,O.e.r),I}function d(O,I,F){var M=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(M[0].c=O.read_shift(1),M[3]=O.read_shift(1),M[0].r=O.read_shift(2),O.l+=2):F.works?(M[0].c=O.read_shift(2),M[0].r=O.read_shift(2),M[2]=O.read_shift(2)):(M[2]=O.read_shift(1),M[0].c=O.read_shift(2),M[0].r=O.read_shift(2)),M}function f(O){return O.z&&ts(O.z)?240|(r.indexOf(O.z)+1||2):255}function h(O,I,F){var M=O.l+I,W=d(O,I,F);if(W[1].t="s",(F.vers&65534)==20768){O.l++;var J=O.read_shift(1);return W[1].v=O.read_shift(J,"utf8"),W}return F.qpro&&O.l++,W[1].v=O.read_shift(M-O.l,"cstr"),W}function p(O,I,F){var M=re(7+F.length);M.write_shift(1,255),M.write_shift(2,I),M.write_shift(2,O),M.write_shift(1,39);for(var W=0;W<M.length;++W){var J=F.charCodeAt(W);M.write_shift(1,J>=128?95:J)}return M.write_shift(1,0),M}function x(O,I,F){var M=O.l+I,W=d(O,I,F);if(W[1].t="s",F.vers==20768){var J=O.read_shift(1);return W[1].v=O.read_shift(J,"utf8"),W}return W[1].v=O.read_shift(M-O.l,"cstr"),W}function g(O,I,F){var M=d(O,I,F);return M[1].v=O.read_shift(2,"i"),M}function v(O,I,F){var M=re(7);return M.write_shift(1,f(F)),M.write_shift(2,I),M.write_shift(2,O),M.write_shift(2,F.v,"i"),M}function b(O,I,F){var M=d(O,I,F);return M[1].v=O.read_shift(8,"f"),M}function w(O,I,F){var M=re(13);return M.write_shift(1,f(F)),M.write_shift(2,I),M.write_shift(2,O),M.write_shift(8,F.v,"f"),M}function y(O,I,F){var M=O.l+I,W=d(O,I,F);if(W[1].v=O.read_shift(8,"f"),F.qpro)O.l=M;else{var J=O.read_shift(2);_(O.slice(O.l,O.l+J),W),O.l+=J}return W}function N(O,I,F){var M=I&32768;return I&=-32769,I=(M?O:0)+(I>=8192?I-16384:I),(M?"":"$")+(F?ht(I):mt(I))}var S={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(O,I){$r(O,0);for(var F=[],M=0,W="",J="",se="",ke="";O.l<O.length;){var ye=O[O.l++];switch(ye){case 0:F.push(O.read_shift(8,"f"));break;case 1:J=N(I[0].c,O.read_shift(2),!0),W=N(I[0].r,O.read_shift(2),!1),F.push(J+W);break;case 2:{var Pe=N(I[0].c,O.read_shift(2),!0),ue=N(I[0].r,O.read_shift(2),!1);J=N(I[0].c,O.read_shift(2),!0),W=N(I[0].r,O.read_shift(2),!1),F.push(Pe+ue+":"+J+W)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(O.read_shift(2));break;case 6:{for(var Be="";ye=O[O.l++];)Be+=String.fromCharCode(ye);F.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:ke=F.pop(),se=F.pop(),F.push(["AND","OR"][ye-20]+"("+se+","+ke+")");break;default:if(ye<32&&E[ye])ke=F.pop(),se=F.pop(),F.push(se+E[ye]+ke);else if(S[ye]){if(M=S[ye][1],M==69&&(M=O[O.l++]),M>F.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+F.join("|")+"|");return}var Ve=F.slice(-M);F.length-=M,F.push(S[ye][0]+"("+Ve.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}F.length==1?I[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function j(O){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=O.read_shift(2),I[3]=O[O.l++],I[0].c=O[O.l++],I}function A(O,I){var F=j(O);return F[1].t="s",F[1].v=O.read_shift(I-4,"cstr"),F}function T(O,I,F,M){var W=re(6+M.length);W.write_shift(2,O),W.write_shift(1,F),W.write_shift(1,I),W.write_shift(1,39);for(var J=0;J<M.length;++J){var se=M.charCodeAt(J);W.write_shift(1,se>=128?95:se)}return W.write_shift(1,0),W}function k(O,I){var F=j(O);F[1].v=O.read_shift(2);var M=F[1].v>>1;if(F[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return F[1].v=M,F}function C(O,I){var F=j(O),M=O.read_shift(4),W=O.read_shift(4),J=O.read_shift(2);if(J==65535)return M===0&&W===3221225472?(F[1].t="e",F[1].v=15):M===0&&W===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var se=J&32768;return J=(J&32767)-16446,F[1].v=(1-se*2)*(W*Math.pow(2,J+32)+M*Math.pow(2,J)),F}function L(O,I,F,M){var W=re(14);if(W.write_shift(2,O),W.write_shift(1,F),W.write_shift(1,I),M==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var J=0,se=0,ke=0,ye=0;return M<0&&(J=1,M=-M),se=Math.log2(M)|0,M/=Math.pow(2,se-31),ye=M>>>0,(ye&2147483648)==0&&(M/=2,++se,ye=M>>>0),M-=ye,ye|=2147483648,ye>>>=0,M*=Math.pow(2,32),ke=M>>>0,W.write_shift(4,ke),W.write_shift(4,ye),se+=16383+(J?32768:0),W.write_shift(2,se),W}function G(O,I){var F=C(O);return O.l+=I-14,F}function V(O,I){var F=j(O),M=O.read_shift(4);return F[1].v=M>>6,F}function X(O,I){var F=j(O),M=O.read_shift(8,"f");return F[1].v=M,F}function K(O,I){var F=X(O);return O.l+=I-12,F}function Y(O,I){return O[O.l+I-1]==0?O.read_shift(I,"cstr"):""}function q(O,I){var F=O[O.l++];F>I-1&&(F=I-1);for(var M="";M.length<F;)M+=String.fromCharCode(O[O.l++]);return M}function Z(O,I,F){if(!(!F.qpro||I<21)){var M=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var W=O.read_shift(I-21,"cstr");return[M,W]}}function le(O,I){for(var F={},M=O.l+I;O.l<M;){var W=O.read_shift(2);if(W==14e3){for(F[W]=[0,""],F[W][0]=O.read_shift(2);O[O.l];)F[W][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return F}function ce(O,I){var F=re(5+O.length);F.write_shift(2,14e3),F.write_shift(2,I);for(var M=0;M<O.length;++M){var W=O.charCodeAt(M);F[F.l++]=W>127?95:W}return F[F.l++]=0,F}var me={0:{n:"BOF",f:Wc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:q},255:{n:"BOF",f:Wc},21506:{n:"WKSNF",f:Wc},65535:{n:""}},Ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:A},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},ee={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function oe(O){var I=O.read_shift(2),F=O.read_shift(1);if(F!=0)throw"unsupported QPW string type "+F.toString(16);return O.read_shift(I,"sbcs-cont")}function fe(O,I){$r(O,0);var F=I||{},M={};F.dense&&(M["!data"]=[]);var W=[],J="",se={s:{r:-1,c:-1},e:{r:-1,c:-1}},ke=0,ye=0,Pe=0,ue=0,Be={SheetNames:[],Sheets:{}},Ve=[];e:for(;O.l<O.length;){var ve=O.read_shift(2),we=O.read_shift(2),he=O.slice(O.l,O.l+we);switch($r(he,0),ve){case 1:if(he.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Te=he.read_shift(4),pe=(he.length-he.l)/Te|0,We=0;We<Te;++We){var Oe=he.l+pe,Ae={};he.l+=2,Ae.numFmtId=he.read_shift(2),ee[Ae.numFmtId]&&(Ae.z=ee[Ae.numFmtId]),he.l=Oe,Ve.push(Ae)}break;case 1025:break;case 1026:break;case 1031:for(he.l+=12;he.l<he.length;)ke=he.read_shift(2),ye=he.read_shift(1),W.push(he.read_shift(ke,"cstr"));break;case 1032:break;case 1537:{var Ye=he.read_shift(2);M={},F.dense&&(M["!data"]=[]),se.s.c=he.read_shift(2),se.e.c=he.read_shift(2),se.s.r=he.read_shift(4),se.e.r=he.read_shift(4),he.l+=4,he.l+2<he.length&&(ke=he.read_shift(2),ye=he.read_shift(1),J=ke==0?"":he.read_shift(ke,"cstr")),J||(J=ht(Ye))}break;case 1538:{if(se.s.c>255||se.s.r>999999)break;se.e.c<se.s.c&&(se.e.c=se.s.c),se.e.r<se.s.r&&(se.e.r=se.s.r),M["!ref"]=qt(se),Wg(Be,M,J)}break;case 2561:Pe=he.read_shift(2),se.e.c<Pe&&(se.e.c=Pe),se.s.c>Pe&&(se.s.c=Pe),ue=he.read_shift(4),se.s.r>ue&&(se.s.r=ue),ue=he.read_shift(4),se.e.r<ue&&(se.e.r=ue);break;case 3073:{ue=he.read_shift(4),ke=he.read_shift(4),se.s.r>ue&&(se.s.r=ue),se.e.r<ue+ke-1&&(se.e.r=ue+ke-1);for(var ct=ht(Pe);he.l<he.length;){var He={t:"z"},ut=he.read_shift(1),vn=-1;ut&128&&(vn=he.read_shift(2));var Qa=ut&64?he.read_shift(2)-1:0;switch(ut&31){case 0:break;case 1:break;case 2:He={t:"n",v:he.read_shift(2)};break;case 3:He={t:"n",v:he.read_shift(2,"i")};break;case 4:He={t:"n",v:Fg(he)};break;case 5:He={t:"n",v:he.read_shift(8,"f")};break;case 7:He={t:"s",v:W[ye=he.read_shift(4)-1]};break;case 8:He={t:"n",v:he.read_shift(8,"f")},he.l+=2,he.l+=4,isNaN(He.v)&&(He={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(ut&31)}vn!=-1&&(Ve[vn-1]||{}).z&&(He.z=Ve[vn-1].z);var Rn=0;if(ut&32)switch(ut&31){case 2:Rn=he.read_shift(2);break;case 3:Rn=he.read_shift(2,"i");break;case 7:Rn=he.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(ut&31)}if(!(!F.sheetStubs&&He.t=="z")){var ga=Dr(He);He.t=="n"&&He.z&&ts(He.z)&&F.cellDates&&(ga.v=Ws(He.v),ga.t=typeof ga.v=="number"?"n":"d"),M["!data"]!=null?(M["!data"][ue]||(M["!data"][ue]=[]),M["!data"][ue][Pe]=ga):M[ct+mt(ue)]=ga}for(++ue,--ke;Qa-- >0&&ke>=0;){if(ut&32)switch(ut&31){case 2:He={t:"n",v:He.v+Rn&65535};break;case 3:He={t:"n",v:He.v+Rn&65535},He.v>32767&&(He.v-=65536);break;case 7:He={t:"s",v:W[ye=ye+Rn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(ut&31)}else switch(ut&31){case 1:He={t:"z"};break;case 2:He={t:"n",v:he.read_shift(2)};break;case 7:He={t:"s",v:W[ye=he.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(ut&31)}!F.sheetStubs&&He.t=="z"||(M["!data"]!=null?(M["!data"][ue]||(M["!data"][ue]=[]),M["!data"][ue][Pe]=He):M[ct+mt(ue)]=He),++ue,--ke}}}break;case 3074:{Pe=he.read_shift(2),ue=he.read_shift(4);var xs=oe(he);M["!data"]!=null?(M["!data"][ue]||(M["!data"][ue]=[]),M["!data"][ue][Pe]={t:"s",v:xs}):M[ht(Pe)+mt(ue)]={t:"s",v:xs}}break}O.l+=we}return Be}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})(),rq=/^\s|\s$|[\t\n\r]/;function nq(e,t){if(!t.bookSST)return"";var r=[Jt];r[r.length]=Ee("sst",null,{xmlns:mo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(rq)&&(i+=' xml:space="preserve"'),i+=">"+Ze(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function aq(e){return[e.read_shift(4),e.read_shift(4)]}function iq(e,t){return t||(t=re(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var sq=KX;function oq(e){var t=Pr();xe(t,159,iq(e));for(var r=0;r<e.length;++r)xe(t,19,sq(e[r]));return xe(t,160),t.end()}function lq(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function c4(e){var t=0,r,n=lq(e),a=n.length+1,i,s,l,c,u;for(r=Qi(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,u=l|c,t=u^s;return t^52811}function cq(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=St(e["!ref"]),a,i=e["!data"]!=null,s=[],l=n.s.r;l<=n.e.r;++l){r.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),i&&(s=e["!data"][l]||[]),c=n.s.c;c<=n.e.c;++c){var u=Mt({r:l,c});if(a=i?s[c]:e[u],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(Wa(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function mN(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var uq=6,Ia=uq;function rd(e){return Math.floor((e+Math.round(128/Ia)/256)*Ia)}function nd(e){return Math.floor((e-5)/Ia*100+.5)/100}function em(e){return Math.round((e*Ia+5)/Ia*256)/256}function Bg(e){e.width?(e.wpx=rd(e.width),e.wch=nd(e.wpx),e.MDW=Ia):e.wpx?(e.wch=nd(e.wpx),e.width=em(e.wch),e.MDW=Ia):typeof e.wch=="number"&&(e.width=em(e.wch),e.wpx=rd(e.width),e.MDW=Ia),e.customWidth&&delete e.customWidth}var dq=96,u4=dq;function ad(e){return e*96/u4}function d4(e){return e*u4/96}function fq(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ee("numFmt",null,{numFmtId:n,formatCode:Ze(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ee("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function hq(e){var t=[];return t[t.length]=Ee("cellXfs",null),e.forEach(function(r){t[t.length]=Ee("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ee("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function pq(e,t){var r=[Jt,Ee("styleSheet",null,{xmlns:mo[0],"xmlns:vt":or.vt})],n;return e.SSF&&(n=fq(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=hq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function mq(e,t){var r=e.read_shift(2),n=Or(e);return[r,n]}function xq(e,t,r){r||(r=re(6+4*t.length)),r.write_shift(2,e),er(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function gq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=QX(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=JX(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Or(e),n}function vq(e,t){t||(t=re(153)),t.write_shift(2,e.sz*20),eY(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ed(e.color,t);var n=0;return n=2,t.write_shift(1,n),er(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ah,yq=pa;function xN(e,t){t||(t=re(84)),Ah||(Ah=jg(bq));var r=Ah[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ed({auto:1},t),ed({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function wq(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function f4(e,t,r){r||(r=re(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Mo(e,t){return t||(t=re(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Nq=pa;function _q(e,t){return t||(t=re(51)),t.write_shift(1,0),Mo(null,t),Mo(null,t),Mo(null,t),Mo(null,t),Mo(null,t),t.length>t.l?t.slice(0,t.l):t}function Sq(e,t){return t||(t=re(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),yl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Eq(e,t,r){var n=re(2052);return n.write_shift(4,e),yl(t,n),yl(r,n),n.length>n.l?n.slice(0,n.l):n}function jq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(xe(e,615,Wn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&xe(e,44,xq(a,t[a]))}),xe(e,616))}}function Tq(e){var t=1;xe(e,611,Wn(t)),xe(e,43,vq({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(e,612)}function Cq(e){var t=2;xe(e,603,Wn(t)),xe(e,45,xN({patternType:"none"})),xe(e,45,xN({patternType:"gray125"})),xe(e,604)}function kq(e){var t=1;xe(e,613,Wn(t)),xe(e,46,_q()),xe(e,614)}function Aq(e){var t=1;xe(e,626,Wn(t)),xe(e,47,f4({numFmtId:0},65535)),xe(e,627)}function Pq(e,t){xe(e,617,Wn(t.length)),t.forEach(function(r){xe(e,47,f4(r,0))}),xe(e,618)}function Oq(e){var t=1;xe(e,619,Wn(t)),xe(e,48,Sq({xfId:0,name:"Normal"})),xe(e,620)}function Dq(e){var t=0;xe(e,505,Wn(t)),xe(e,506)}function Iq(e){var t=0;xe(e,508,Eq(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function Rq(e,t){var r=Pr();return xe(r,278),jq(r,e.SSF),Tq(r),Cq(r),kq(r),Aq(r),Pq(r,t.cellXfs),Oq(r),Dq(r),Iq(r),xe(r,279),r.end()}function h4(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Jt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Mq(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Or(e)}}function Fq(e){var t=re(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),er(e.name,t),t.slice(0,t.l)}function Lq(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Bq(e){var t=re(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function $q(e,t){var r=re(8+2*t.length);return r.write_shift(4,e),er(t,r),r.slice(0,r.l)}function Uq(e){return e.l+=4,e.read_shift(4)!=0}function Hq(e,t){var r=re(8);return r.write_shift(4,e),r.write_shift(4,1),r}function zq(){var e=Pr();return xe(e,332),xe(e,334,Wn(1)),xe(e,335,Fq({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,$q(1,"XLDAPR")),xe(e,52),xe(e,35,Wn(514)),xe(e,4096,Wn(0)),xe(e,4097,En(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,Hq(1)),xe(e,51,Bq([[1,0]])),xe(e,338),xe(e,333),e.end()}function Wq(){var e=[Jt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Vq(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Mt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function p4(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Ee("xml",null,{"xmlns:v":un.v,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:mv":un.mv}).replace(/\/>/,">"),Ee("o:shapelayout",Ee("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,l=t||[];return l.length>0&&i.push(Ee("v:shapetype",[Ee("v:stroke",null,{joinstyle:"miter"}),Ee("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),l.forEach(function(c){++s,i.push(Kq(c,s))}),i.push("</xml>"),i.join("")}function Kq(e,t,r){var n=At(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Ee("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Ee("v:fill",i,a),l={on:"t",obscured:"t"};return["<v:shape"+gl({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Ee("v:shadow",null,l),Ee("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gr("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),gr("x:AutoFill","False"),gr("x:Row",String(n.r)),gr("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function Gq(e){var t=[Jt,Ee("comments",null,{xmlns:mo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Ze(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(u){u.a&&(a=r.indexOf(Ze(u.a))),u.T&&++s,i.push(u.t==null?"":Ze(u.t))}),s===0)n[1].forEach(function(u){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Ze(u.a))+'"><text>'),t.push(gr("t",u.t==null?"":Ze(u.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(gr("t",Ze(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function m4(e,t,r){var n=[Jt,Ee("ThreadedComments",null,{xmlns:or.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ee("threadedComment",gr("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function x4(e){var t=[Jt,Ee("personList",null,{xmlns:or.TCMNT,"xmlns:x":mo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ee("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Xq(e){var t={};t.iauthor=e.read_shift(4);var r=ms(e);return t.rfx=r.s,t.ref=Mt(r.s),e.l+=16,t}function Yq(e,t){return t==null&&(t=re(36)),t.write_shift(4,e[1].iauthor),vo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var qq=Or;function gN(e){return er(e.slice(0,54))}function Zq(e){var t=Pr(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),xe(t,632,gN(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),xe(t,632,gN("tc="+a.ID))))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var s={s:At(n[0]),e:At(n[0])};xe(t,635,Yq([s,a])),a.t&&a.t.length>0&&xe(t,637,XX(a)),xe(t,636),delete a.iauthor})}),xe(t,634),xe(t,629),t.end()}function Jq(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Qq=["xlsb","xlsm","xlam","biff8","xla"],vN=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,a+(l?"":"$")+ht(d)+(c?"":"$")+mt(u)}return function(a,i){return t=i,a.replace(e,r)}})(),p0=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{p0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var m0=(function(){return function(t,r){return t.replace(p0,function(n,a,i,s,l,c){var u=Ig(s)-(i?0:r.c),d=Dg(c)-(l?0:r.r),f=l=="$"?d+1:d==0?"":"["+d+"]",h=i=="$"?u+1:u==0?"":"["+u+"]";return a+"R"+f+"C"+h})}})();function eZ(e,t){return e.replace(p0,function(r,n,a,i,s,l){return n+(a=="$"?a+i:ht(Ig(i)+t.c))+(s=="$"?s+l:mt(Dg(l)+t.r))})}function tZ(e){return e.length!=1}function Wt(e){e.l+=1}function gi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function g4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return v4(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=gi(e),l=gi(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function v4(e){var t=gi(e),r=gi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function rZ(e,t,r){if(r.biff<8)return v4(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=gi(e),s=gi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function b4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return nZ(e);var n=e.read_shift(r&&r.biff==12?4:2),a=gi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function nZ(e){var t=gi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function aZ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iZ(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return sZ(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function sZ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function oZ(e,t,r){var n=(e[e.l++]&96)>>5,a=g4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function lZ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=g4(e,i,r);return[n,a,s]}function cZ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function uZ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function dZ(e,t,r){var n=(e[e.l++]&96)>>5,a=rZ(e,t-1,r);return[n,a]}function fZ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function bN(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function hZ(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function pZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function mZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xZ(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function gZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function y4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function vZ(e){return e.read_shift(2),y4(e)}function bZ(e){return e.read_shift(2),y4(e)}function yZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=b4(e,0,r);return[n,a]}function wZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=iZ(e,0,r);return[n,a]}function NZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=b4(e,0,r);return[n,a,i]}function _Z(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[IJ[a],_4[a],n]}function SZ(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:EZ(e);return[a,(i[0]===0?_4:DJ)[i[1]]]}function EZ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function jZ(e,t,r){e.l+=r&&r.biff==2?3:4}function TZ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function CZ(e){return e.l++,Vr[e.read_shift(1)]}function kZ(e){return e.l++,e.read_shift(2)}function AZ(e){return e.l++,e.read_shift(1)!==0}function PZ(e){return e.l++,bo(e)}function OZ(e,t,r){return e.l++,a4(e,t-1,r)}function DZ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vY(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Vr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=bo(e);break;case 2:r[1]=NY(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function IZ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ms:EY)(e));return a}function RZ(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=DZ(e,r.biff);return s}function MZ(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function FZ(e,t,r){if(r.biff==5)return LZ(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function LZ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function BZ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $Z(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function UZ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function HZ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var zZ=pa,WZ=pa,VZ=pa;function ql(e,t,r){return e.l+=2,[aZ(e)]}function $g(e){return e.l+=6,[]}var KZ=ql,GZ=$g,XZ=$g,YZ=ql;function w4(e){return e.l+=2,[Wc(e),e.read_shift(2)&1]}var qZ=ql,ZZ=w4,JZ=$g,QZ=ql,eJ=ql,tJ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function rJ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=tJ[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function nJ(e){return e.l+=2,[e.read_shift(4)]}function aJ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function iJ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function sJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function oJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lJ(e){return e.l+=4,[0,0]}var yN={1:{n:"PtgExp",f:TZ},2:{n:"PtgTbl",f:VZ},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:OZ},26:{n:"PtgSheet",f:aJ},27:{n:"PtgEndSheet",f:iJ},28:{n:"PtgErr",f:CZ},29:{n:"PtgBool",f:AZ},30:{n:"PtgInt",f:kZ},31:{n:"PtgNum",f:PZ},32:{n:"PtgArray",f:fZ},33:{n:"PtgFunc",f:_Z},34:{n:"PtgFuncVar",f:SZ},35:{n:"PtgName",f:MZ},36:{n:"PtgRef",f:yZ},37:{n:"PtgArea",f:oZ},38:{n:"PtgMemArea",f:BZ},39:{n:"PtgMemErr",f:zZ},40:{n:"PtgMemNoMem",f:WZ},41:{n:"PtgMemFunc",f:$Z},42:{n:"PtgRefErr",f:UZ},43:{n:"PtgAreaErr",f:cZ},44:{n:"PtgRefN",f:wZ},45:{n:"PtgAreaN",f:dZ},46:{n:"PtgMemAreaN",f:sJ},47:{n:"PtgMemNoMemN",f:oJ},57:{n:"PtgNameX",f:FZ},58:{n:"PtgRef3d",f:NZ},59:{n:"PtgArea3d",f:lZ},60:{n:"PtgRefErr3d",f:HZ},61:{n:"PtgAreaErr3d",f:uZ},255:{}},cJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},uJ={1:{n:"PtgElfLel",f:w4},2:{n:"PtgElfRw",f:QZ},3:{n:"PtgElfCol",f:KZ},6:{n:"PtgElfRwV",f:eJ},7:{n:"PtgElfColV",f:YZ},10:{n:"PtgElfRadical",f:qZ},11:{n:"PtgElfRadicalS",f:JZ},13:{n:"PtgElfColS",f:GZ},15:{n:"PtgElfColSV",f:XZ},16:{n:"PtgElfRadicalLel",f:ZZ},25:{n:"PtgList",f:rJ},29:{n:"PtgSxName",f:nJ},255:{}},dJ={0:{n:"PtgAttrNoop",f:lJ},1:{n:"PtgAttrSemi",f:gZ},2:{n:"PtgAttrIf",f:mZ},4:{n:"PtgAttrChoose",f:hZ},8:{n:"PtgAttrGoto",f:pZ},16:{n:"PtgAttrSum",f:jZ},32:{n:"PtgAttrBaxcel",f:bN},33:{n:"PtgAttrBaxcel",f:bN},64:{n:"PtgAttrSpace",f:vZ},65:{n:"PtgAttrSpaceSemi",f:bZ},128:{n:"PtgAttrIfError",f:xZ},255:{}};function fJ(e,t,r,n){if(n.biff<8)return pa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=RZ(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=IZ(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(pa(e,t)),i}function hJ(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=yN[i]||yN[cJ[i]],(i===24||i===25)&&(a=(i===24?uJ:dJ)[e[e.l+1]]),!a||!a.f?pa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function pJ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];s?s[0]===2?a.push('"'+s[1].replace(/"/g,'""')+'"'):a.push(s[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var mJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xJ(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function N4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wN(e,t,r){var n=N4(e,t,r);return n=="#REF"?n:bl(n,r)}function no(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,v="",b=0,w=e[0].length;b<w;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:v=Ct(" ",e[0][g][1][1]);break;case 1:v=Ct("\r",e[0][g][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+v,g=-1}l.push(u+mJ[y[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(xJ(u,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ko(y[1][1],s,a),l.push(Go(d,i));break;case"PtgRefN":d=r?Ko(y[1][1],r,a):y[1][1],l.push(Go(d,i));break;case"PtgRef3d":f=y[1][1],d=Ko(y[1][2],s,a),x=wN(n,f,a),l.push(x+"!"+Go(d,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],S=y[1][1];N||(N=0),N&=127;var E=N==0?[]:l.slice(-N);l.length-=N,S==="User"&&(S=E.shift()),l.push(S+"("+E.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":p=rN(y[1][1],r?{s:r}:s,a),l.push(jh(p,a));break;case"PtgArea":p=rN(y[1][1],s,a),l.push(jh(p,a));break;case"PtgArea3d":f=y[1][1],p=y[1][2],x=wN(n,f,a),l.push(x+"!"+jh(p,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var _=(n.names||[])[h-1]||(n[0]||[])[h],j=_?_.Name:"SH33TJSNAME"+String(h);j&&j.slice(0,6)=="_xlfn."&&!a.xlfn&&(j=j.slice(6)),l.push(j);break;case"PtgNameX":var A=y[1][1];h=y[1][2];var T;if(a.biff<=5)A<0&&(A=-A),n[A]&&(T=n[A][h]);else{var k="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(k=n.SheetNames[n[A][h].itab-1]+"!"):k=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])k+=n[A][h].Name;else if(n[0]&&n[0][h])k+=n[0][h].Name;else{var C=(N4(n,A,a)||"").split(";;");C[h-1]?k=C[h-1]:k+="SH33TJSERRX"}l.push(k);break}T||(T={Name:"SH33TJSERRY"}),l.push(T.Name);break;case"PtgParen":var L="(",G=")";if(g>=0){switch(v="",e[0][g][1][0]){case 2:L=Ct(" ",e[0][g][1][1])+L;break;case 3:L=Ct("\r",e[0][g][1][1])+L;break;case 4:G=Ct(" ",e[0][g][1][1])+G;break;case 5:G=Ct("\r",e[0][g][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(L+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[Mt(d)]){var X=n.sharedf[Mt(d)];l.push(no(X,s,V,n,a))}else{var K=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(no(u[1],s,V,n,a)),K=!0;break}K||l.push(y[1])}break;case"PtgArray":l.push("{"+pJ(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Y.indexOf(e[0][b][0])==-1){y=e[0][g];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:v=Ct(" ",y[1][1]);break;case 5:q=!1;case 1:v=Ct("\r",y[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((q?v:"")+l.pop()+(q?"":v)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function gJ(e){if(e==null){var t=re(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return rs(e);return rs(0)}function vJ(e,t,r,n,a){var i=ns(t,r,a),s=gJ(e.v),l=re(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=re(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Kt([i,s,l,u]);return f}function x0(e,t,r){var n=e.read_shift(4),a=hJ(e,n,r),i=e.read_shift(4),s=i>0?fJ(e,i,a,r):null;return[a,s]}var bJ=x0,g0=x0,yJ=x0,wJ=x0;function NN(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=re(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=re(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function NJ(e){var t=re(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function _J(e){var t=re(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function SJ(e){var t=re(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=re(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=re(4);return n.write_shift(4,0),Kt([t,r,n])}function EJ(e){var t=At(e),r=re(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function jJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=At(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=re(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function TJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=re(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function CJ(e){var t=e.split(":"),r=t[0],n=re(23);n.write_shift(4,15),r=t[0];var a=At(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=At(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function kJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=re(27);i.write_shift(4,19);var s=a[0],l=At(s);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=a[1],l=At(s),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function AJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=br(e),i=re(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function PJ(e,t){if(typeof e=="number")return NN(e);if(typeof e=="boolean")return _J(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return NJ(+sa[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return EJ(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return CJ(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return AJ(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return jJ(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kJ(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return TJ(e,t);if(/^".*"$/.test(e))return SJ(e);if(/^[+-]\d+$/.test(e))return NN(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var OJ=PJ,DJ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},IJ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function RJ(e){var t="of:="+e.replace(p0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function S4(e){return e.replace(/!/,".").replace(/:/,":.")}var Xo=typeof Map<"u";function Ug(e,t,r){var n=0,a=e.length;if(r){if(Xo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Xo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Xo?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function v0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ia=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=nd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=em(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function E4(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _i(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){lX(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function MJ(e,t,r){if(e&&e["!ref"]){var n=St(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function FJ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+qt(e[r])+'"/>';return t+"</mergeCells>"}function LJ(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=xl(Ze(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Ee("outlinePr",null,u)}!i&&!l||(a[a.length]=Ee("sheetPr",l,s))}var BJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$J=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UJ(e){var t={sheet:1};return BJ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$J.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=c4(e.password).toString(16).toUpperCase()),Ee("sheetProtection",null,t)}function HJ(e){return E4(e),Ee("pageMargins",null,e)}function zJ(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ee("col",null,v0(a,n)));return r[r.length]="</cols>",r.join("")}function WJ(e,t,r,n){var a=typeof e.ref=="string"?e.ref:qt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=br(a);s.s.r==s.e.r&&(s.e.r=br(t["!ref"]).e.r,a=qt(s));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=bl(r.SheetNames[n])+"!"+vl(a);break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ee("autoFilter",null,{ref:a})}function VJ(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ee("sheetViews",Ee("sheetView",null,a),{})}function KJ(e,t,r,n,a,i,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var l="",c=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=Vr[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=Vr[e.v=7]);break;case"e":l=Vr[e.v];break;case"d":if(n&&n.cellDates){var d=rn(e.v,s);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else e=Dr(e),e.t="n",l=""+(e.v=yr(rn(e.v,s),s));typeof e.z>"u"&&(e.z=_t[14]);break;default:l=e.v;break}var f=e.t=="z"||e.v==null?"":gr("v",Ze(l)),h={r:t},p=_i(n.cellXfs,e,n);switch(p!==0&&(h.s=p),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){f=gr("v",""+Ug(n.Strings,e.v,n.revStrings)),h.t="s";break}else h.t="str";break}if(e.t!=c&&(e.t=c,e.v=u),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Ee("f",Ze(e.f),x)+(e.v!=null?f:"")}return e.l&&(e.l.display=Ze(l),r["!links"].push([t,e.l])),e.D&&(h.cm=1),Ee("c",f,h)}function GJ(e,t,r,n){var a=[],i=[],s=St(e["!ref"]),l="",c,u="",d=[],f=0,h=0,p=e["!rows"],x=e["!data"]!=null,g=x?e["!data"]:[],v={r:u},b,w=-1,y=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(h=s.s.c;h<=s.e.c;++h)d[h]=ht(h);for(f=s.s.r;f<=s.e.r;++f){i=[],u=mt(f);var N=x?g[f]:[];for(h=s.s.c;h<=s.e.c;++h){c=d[h]+u;var S=x?N[h]:e[c];S!==void 0&&(l=KJ(S,c,e,t,r,n,y))!=null&&i.push(l)}(i.length>0||p&&p[f])&&(v={r:u},p&&p[f]&&(b=p[f],b.hidden&&(v.hidden=1),w=-1,b.hpx?w=ad(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(v.ht=w,v.customHeight=1),b.level&&(v.outlineLevel=b.level)),a[a.length]=Ee("row",i.join(""),v))}if(p)for(;f<p.length;++f)p&&p[f]&&(v={r:f+1},b=p[f],b.hidden&&(v.hidden=1),w=-1,b.hpx?w=ad(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(v.ht=w,v.customHeight=1),b.level&&(v.outlineLevel=b.level),a[a.length]=Ee("row","",v));return a.join("")}function XJ(e,t,r,n){var a=[Jt,Ee("worksheet",null,{xmlns:mo[0],"xmlns:r":or.r})],i=r.SheetNames[e],s=0,l="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=St(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=qt(d)}n||(n={}),c["!comments"]=[];var f=[];LJ(c,r,e,t,a),a[a.length]=Ee("dimension",null,{ref:u}),a[a.length]=VJ(c,t,e,r),t.sheetFormat&&(a[a.length]=Ee("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=zJ(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=GJ(c,t,e,r),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=UJ(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=WJ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=FJ(c["!merges"]));var h=-1,p,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=it(n,-1,Ze(g[1].Target).replace(/#[\s\S]*$/,""),tt.HLINK),p["r:id"]="rId"+x),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Ze(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Ze(g[1].Tooltip)),p.display=g[1].display,a[a.length]=Ee("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=HJ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=gr("ignoredErrors",Ee("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=it(n,-1,"../drawings/drawing"+(e+1)+".xml",tt.DRAW),a[a.length]=Ee("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=it(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",tt.VML),a[a.length]=Ee("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function YJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function qJ(e,t,r){var n=re(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=ad(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=r["!data"]!=null,f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,p=-1,x=f<<10;x<f+1<<10;++x){u.c=x;var g=d?(r["!data"][u.r]||[])[u.c]:r[Mt(u)];g&&(h<0&&(h=x),p=x)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,p))}var v=n.l;return n.l=c,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function ZJ(e,t,r,n){var a=qJ(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&xe(e,0,a)}var JJ=ms,QJ=vo;function eQ(){}function tQ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=YX(e),r}function rQ(e,t,r){r==null&&(r=re(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return ed({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),WT(e,r),r.slice(0,r.l)}function nQ(e){var t=In(e);return[t]}function aQ(e,t,r){return r==null&&(r=re(8)),fs(t,r)}function iQ(e){var t=hs(e);return[t]}function sQ(e,t,r){return r==null&&(r=re(4)),ps(t,r)}function oQ(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function lQ(e,t,r){return r==null&&(r=re(9)),fs(t,r),r.write_shift(1,e.v?1:0),r}function cQ(e){var t=hs(e),r=e.read_shift(1);return[t,r,"b"]}function uQ(e,t,r){return r==null&&(r=re(5)),ps(t,r),r.write_shift(1,e.v?1:0),r}function dQ(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function Ph(e,t,r){return r==null&&(r=re(9)),fs(t,r),r.write_shift(1,e.v),r}function fQ(e){var t=hs(e),r=e.read_shift(1);return[t,r,"e"]}function Oh(e,t,r){return r==null&&(r=re(8)),ps(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function hQ(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function pQ(e,t,r){return r==null&&(r=re(12)),fs(t,r),r.write_shift(4,t.v),r}function mQ(e){var t=hs(e),r=e.read_shift(4);return[t,r,"s"]}function xQ(e,t,r){return r==null&&(r=re(8)),ps(t,r),r.write_shift(4,t.v),r}function gQ(e){var t=In(e),r=bo(e);return[t,r,"n"]}function vQ(e,t,r){return r==null&&(r=re(16)),fs(t,r),rs(e.v,r),r}function bQ(e){var t=hs(e),r=bo(e);return[t,r,"n"]}function yQ(e,t,r){return r==null&&(r=re(12)),ps(t,r),rs(e.v,r),r}function wQ(e){var t=In(e),r=Fg(e);return[t,r,"n"]}function NQ(e,t,r){return r==null&&(r=re(12)),fs(t,r),VT(e.v,r),r}function _Q(e){var t=hs(e),r=Fg(e);return[t,r,"n"]}function SQ(e,t,r){return r==null&&(r=re(8)),ps(t,r),VT(e.v,r),r}function EQ(e){var t=In(e),r=Rg(e);return[t,r,"is"]}function jQ(e){var t=In(e),r=Or(e);return[t,r,"str"]}function TQ(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=re(12+4*e.v.length)),fs(t,r),er(n,r),r.length>r.l?r.slice(0,r.l):r}function CQ(e){var t=hs(e),r=Or(e);return[t,r,"str"]}function kQ(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=re(8+4*n.length)),ps(t,r),er(n,r),r.length>r.l?r.slice(0,r.l):r}function AQ(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=g0(e,n-e.l,r);s[3]=no(l,null,a,r.supbooks,r)}else e.l=n;return s}function PQ(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=g0(e,n-e.l,r);s[3]=no(l,null,a,r.supbooks,r)}else e.l=n;return s}function OQ(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=bo(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=g0(e,n-e.l,r);s[3]=no(l,null,a,r.supbooks,r)}else e.l=n;return s}function DQ(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var i=Or(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=g0(e,n-e.l,r);s[3]=no(l,null,a,r.supbooks,r)}else e.l=n;return s}var IQ=ms,RQ=vo;function MQ(e,t){return t==null&&(t=re(4)),t.write_shift(4,e),t}function FQ(e,t){var r=e.l+t,n=ms(e),a=h0(e),i=Or(e),s=Or(e),l=Or(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:l};return s&&(c.Tooltip=s),c}function LQ(e,t){var r=re(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vo({s:At(e[0]),e:At(e[0])},r),Mg("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return er(a||"",r),er(e[1].Tooltip||"",r),er("",r),r.slice(0,r.l)}function BQ(){}function $Q(e,t,r){var n=e.l+t,a=KT(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=bJ(e,n-e.l,r);s[1]=l}else e.l=n;return s}function UQ(e,t,r){var n=e.l+t,a=ms(e),i=[a];if(r.cellFormula){var s=wJ(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function HQ(e,t,r){r==null&&(r=re(18));var n=v0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var j4=["left","right","top","bottom","header","footer"];function zQ(e){var t={};return j4.forEach(function(r){t[r]=bo(e)}),t}function WQ(e,t){return t==null&&(t=re(48)),E4(e),j4.forEach(function(r){rs(e[r],t)}),t}function VQ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function KQ(e,t,r){r==null&&(r=re(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function GQ(e){var t=re(24);return t.write_shift(4,4),t.write_shift(4,1),vo(e,t),t}function XQ(e,t){return t==null&&(t=re(66)),t.write_shift(2,e.password?c4(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function YQ(){}function qQ(){}function ZQ(e,t,r,n,a,i,s,l){var c={r,c:n};if(t.c&&i["!comments"].push([Mt(c),t.c]),t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Dr(t),t.z=t.z||_t[14],t.v=yr(rn(t.v,l),l),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}switch(c.s=_i(a.cellXfs,t,a),t.l&&i["!links"].push([Mt(c),t.l]),t.t){case"s":case"str":return a.bookSST?(u=Ug(a.Strings,t.v==null?"":String(t.v),a.revStrings),c.t="s",c.v=u,s?xe(e,18,xQ(t,c)):xe(e,7,pQ(t,c))):(c.t="str",s?xe(e,17,kQ(t,c)):xe(e,6,TQ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?xe(e,13,SQ(t,c)):xe(e,2,NQ(t,c)):isFinite(t.v)?s?xe(e,16,yQ(t,c)):xe(e,5,vQ(t,c)):(c.t="e",isNaN(t.v)?s?xe(e,14,Oh({v:36},c)):xe(e,3,Ph({v:36},c)):s?xe(e,14,Oh({v:7},c)):xe(e,3,Ph({v:7},c))),!0;case"b":return c.t="b",s?xe(e,15,uQ(t,c)):xe(e,4,lQ(t,c)),!0;case"e":return c.t="e",s?xe(e,14,Oh(t,c)):xe(e,3,Ph(t,c)),!0}return s?xe(e,12,sQ(t,c)):xe(e,1,aQ(t,c)),!0}function JQ(e,t,r,n,a){var i=St(t["!ref"]||"A1"),s="",l=[],c=(((a||{}).Workbook||{}).WBProps||{}).date1904;xe(e,145);var u=t["!data"]!=null,d=u?t["!data"][i.s.r]:[],f=i.e.r;t["!rows"]&&(f=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=f;++h)if(s=mt(h),u&&(d=t["!data"][h]),ZJ(e,t,i,h),!(u&&!d)){var p=!1;if(h<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){h===i.s.r&&(l[x]=ht(x));var g=u?d[x]:t[l[x]+s];if(!g){p=!1;continue}p=ZQ(e,g,h,x,n,t,p,c)}}xe(e,146)}function QQ(e,t){!t||!t["!merges"]||(xe(e,177,MQ(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,RQ(r))}),xe(e,178))}function eee(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,HQ(n,r))}),xe(e,391))}function tee(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,GQ(St(t["!ref"]))),xe(e,650))}function ree(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=it(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),tt.HLINK);xe(e,494,LQ(n,a))}}),delete t["!links"]}function nee(e,t,r,n){if(t["!comments"].length>0){var a=it(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",tt.VML);xe(e,551,Mg("rId"+a)),t["!legacy"]=a}}function aee(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:qt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=br(i);l.s.r==l.e.r&&(l.e.r=br(t["!ref"]).e.r,i=qt(l));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref=bl(r.SheetNames[n])+"!"+vl(i);break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:bl(r.SheetNames[n])+"!"+vl(i)}),xe(e,161,vo(St(i))),xe(e,162)}}function iee(e,t,r){xe(e,133),xe(e,137,KQ(t,r)),xe(e,138),xe(e,134)}function see(e,t){t["!protect"]&&xe(e,535,XQ(t["!protect"]))}function oee(e,t,r,n){var a=Pr(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=St(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],xe(a,129),(r.vbaraw||s["!outline"])&&xe(a,147,rQ(l,s["!outline"])),xe(a,148,QJ(c)),iee(a,s,r.Workbook),eee(a,s),JQ(a,s,e,t,r),see(a,s),aee(a,s,r,e),QQ(a,s),ree(a,s,n),s["!margins"]&&xe(a,476,WQ(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&tee(a,s),nee(a,s,e,n),xe(a,130),a.end()}function lee(e,t){e.l+=10;var r=Or(e);return{name:r}}var cee=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function uee(e){return!e.Workbook||!e.Workbook.WBProps?"false":jX(e.Workbook.WBProps.date1904)?"true":"false"}var dee=":][*?/\\".split("");function T4(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");dee.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function fee(e,t,r){e.forEach(function(n,a){T4(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function hee(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];fee(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)MJ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a&&(s=c)});var l=bl(n)+"!"+vl(i["!autofilter"].ref);s?s.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:l})}})}function pee(e){var t=[Jt];t[t.length]=Ee("workbook",null,{xmlns:mo[0],"xmlns:r":or.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(cee.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ee("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ze(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ee("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Ee("definedName",Ze(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function mee(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Qp(e),r.name=Or(e),r}function xee(e,t){return t||(t=re(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Mg(e.strRelID,t),er(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function gee(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Or(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vee(e,t){t||(t=re(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),WT(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function bee(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=qX(e),l,c="";try{l=yJ(e,0,r);try{c=h0(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var u={Name:s,Ptg:l,Flags:a};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function yee(e,t){var r=re(9),n=0,a=e.Name;lY.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,er(a),OJ(e.Ref,t)];if(e.Comment)i.push(yl(e.Comment));else{var s=re(4);s.write_shift(4,4294967295),i.push(s)}return Kt(i)}function wee(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,xee(a))}xe(e,144)}function Nee(e,t){t||(t=re(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return er("SheetJS",t),er(Vu.version,t),er(Vu.version,t),er("7262",t),t.length>t.l?t.slice(0,t.l):t}function _ee(e,t){t||(t=re(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function See(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(xe(e,135),xe(e,158,_ee(a)),xe(e,136))}}function Eee(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;xe(e,39,yee(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function jee(e){var t=e.SheetNames.length,r=re(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function Tee(e,t){xe(e,353),xe(e,357),xe(e,362,jee(t)),xe(e,354)}function Cee(e,t){var r=Pr();return xe(r,131),xe(r,128,Nee()),xe(r,153,vee(e.Workbook&&e.Workbook.WBProps||null)),See(r,e),wee(r,e),Tee(r,e),(e.Workbook||{}).Names&&Eee(r,e),xe(r,132),r.end()}function kee(e,t){var r=[];return e.Props&&r.push(hY(e.Props,t)),e.Custprops&&r.push(pY(e.Props,e.Custprops)),r.join("")}function Aee(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function Pee(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ee("NumberFormat",null,{"ss:Format":Ze(_t[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ee("Style",i.join(""),s))}),Ee("Styles",r.join(""))}function C4(e){return Ee("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+m0(e.Ref,{r:0,c:0})})}function Oee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(C4(a)))}return Ee("Names",r.join(""))}function Dee(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(C4(l)))}return i.join("")}function Iee(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ee("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ee("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ee("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ee("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(gr("ProtectContents","True")),e["!protect"].objects&&a.push(gr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(gr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(gr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(gr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ee("WorksheetOptions",a.join(""),{xmlns:un.x})}function Ree(e){return e.map(function(t){var r=EX(t.t||""),n=Ee("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Ee("Comment",n,a)}).join("")}function Mee(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Ze(m0(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=At(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Ze(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Ze(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(f="Number",h=String(e.v)):(f="Error",h=Vr[isNaN(e.v)?36:7]);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Vr[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||_t[14]);break;case"s":f="String",h=SX(e.v||"");break}var p=_i(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=s.c+1;var x=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=Ree(e.c)),Ee("Cell",g,l)}function Fee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=d4(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Lee(e,t,r,n){if(!e["!ref"])return"";var a=St(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,b){Bg(v);var w=!!v.width,y=v0(b,v),N={"ss:Index":b+1};w&&(N["ss:Width"]=rd(y.width)),v.hidden&&(N["ss:Hidden"]="1"),l.push(Ee("Column",null,N))});for(var c=e["!data"]!=null,u={r:0,c:0},d=a.s.r;d<=a.e.r;++d){var f=[Fee(d,(e["!rows"]||[])[d])];u.r=d;for(var h=a.s.c;h<=a.e.c;++h){u.c=h;var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>d)&&!(i[s].e.c<h)&&!(i[s].e.r<d)){(i[s].s.c!=h||i[s].s.r!=d)&&(p=!0);break}if(!p){var x=ht(h)+mt(d),g=c?(e["!data"][d]||[])[h]:e[x];f.push(Mee(g,x,e,t,r,n,u))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function Bee(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Dee(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Lee(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Iee(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+m0(vl(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function $ee(e,t){t||(t={}),e.SSF||(e.SSF=Dr(_t)),e.SSF&&(u0(),c0(e.SSF),t.revssf=d0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_i(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kee(e,t)),r.push(Aee(e)),r.push(""),r.push(Oee(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Ee("Worksheet",Bee(n,t,e),{"ss:Name":Ze(e.SheetNames[n])}));return r[2]=Pee(e,t),Jt+Ee("Workbook",r.join(""),{xmlns:un.ss,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:ss":un.ss,"xmlns:dt":un.dt,"xmlns:html":un.html})}var Dh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Uee(e,t){var r=[],n=[],a=[],i=0,s,l=G2(aN,"n"),c=G2(iN,"n");if(e.Props)for(s=Yt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Yt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)r4.indexOf(a[i][0])>-1||QT.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&gt.utils.cfb_add(t,"/SummaryInformation",uN(n,Dh.SI,c,iN)),(r.length||u.length)&&gt.utils.cfb_add(t,"/DocumentSummaryInformation",uN(r,Dh.DSI,l,aN,u.length?u:null,Dh.UDI))}function Hee(e,t){var r=t||{},n=gt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gt.utils.cfb_add(n,a,A4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Uee(e,n),r.biff==8&&e.vbaraw&&Jq(n,gt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var zee={0:{f:YJ},1:{f:nQ},2:{f:wQ},3:{f:dQ},4:{f:oQ},5:{f:gQ},6:{f:jQ},7:{f:hQ},8:{f:DQ},9:{f:OQ},10:{f:AQ},11:{f:PQ},12:{f:iQ},13:{f:_Q},14:{f:fQ},15:{f:cQ},16:{f:bQ},17:{f:CQ},18:{f:mQ},19:{f:Rg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bee},40:{},42:{},43:{f:gq},44:{f:mq},45:{f:yq},46:{f:Nq},47:{f:wq},48:{},49:{f:zX},50:{},51:{f:Lq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:GY},62:{f:EQ},63:{f:Vq},64:{f:YQ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:VQ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tQ},148:{f:JJ,p:16},151:{f:BQ},152:{},153:{f:gee},154:{},155:{},156:{f:mee},157:{},158:{},159:{T:1,f:aq},160:{T:-1},161:{T:1,f:ms},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:IQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Mq},336:{T:-1},337:{f:Uq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:HY},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$Q},427:{f:UQ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zQ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eQ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:FQ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qp},551:{f:h0},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qq},633:{T:1},634:{T:-1},635:{T:1,f:Xq},636:{T:-1},637:{f:GX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lee},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:qQ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function be(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Og(r)&&e.push(r)}}function Wee(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return be(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,c=0,u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(s[l]||8224)<=8224;)u+=s[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Ih(e,t,r,n){var a=re(9);return Yl(a,e,t),n4(r,n||"b",a),a}function Vee(e,t,r){var n=re(8+2*r.length);return Yl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function k4(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return be(e,28,kh(n,r[1],r[2]));be(e,28,kh(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)be(e,28,kh(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function Kee(e,t,r,n,a,i){var s=0;t.z!=null&&(s=a._BIFF2FmtTable.indexOf(t.z),s==-1&&(a._BIFF2FmtTable.push(t.z),s=a._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<a.cellXfs.length&&a.cellXfs[l].numFmtId!=s;++l);l==a.cellXfs.length&&a.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var c=t.t=="d"?yr(rn(t.v,i),i):t.v;a.biff==2&&c==(c|0)&&c>=0&&c<65536?be(e,2,ZY(r,n,c,l,s)):isNaN(c)?be(e,5,Ih(r,n,36,"e")):isFinite(c)?be(e,3,qY(r,n,c,l,s)):be(e,5,Ih(r,n,7,"e"));return;case"b":case"e":be(e,5,Ih(r,n,t.v,t.t));return;case"s":case"str":be(e,4,Vee(r,n,t.v==null?"":String(t.v).slice(0,255)));return}be(e,1,Yl(null,r,n))}function Gee(e,t,r,n,a){var i=t["!data"]!=null,s=St(t["!ref"]||"A1"),l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var u=(((a||{}).Workbook||{}).WBProps||{}).date1904,d=[],f=[],h=s.s.c;h<=s.e.c;++h)c[h]=ht(h);for(var p=s.s.r;p<=s.e.r;++p)for(i&&(d=t["!data"][p]||[]),l=mt(p),h=s.s.c;h<=s.e.c;++h){var x=i?d[h]:t[c[h]+l];x&&(Kee(e,x,p,h,n,u),x.c&&f.push([x.c,p,h]))}k4(e,f)}function Xee(e,t){for(var r=t||{},n=Pr(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);be(n,r.biff==4?1033:r.biff==3?521:9,Lg(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&be(n,34,jr(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=Pr();return Gee(s,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(l){r.biff<=3?be(n,30,RY(l)):be(n,1054,MY(l))}),r.cellXfs.forEach(function(l){switch(r.biff){case 2:be(n,67,LY(l));break;case 3:be(n,579,o4(l));break;case 4:be(n,1091,BY(l));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),be(n,10),n.end()}var Mn=1,Sn=[];function Yee(){var e=re(82+8*Sn.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*Sn.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*Sn.length);{e.write_shift(4,Mn),e.write_shift(4,Sn.length+1);for(var t=0,r=0;r<Sn.length;++r)t+=Sn[r]&&Sn[r][1]||0;e.write_shift(4,t),e.write_shift(4,Sn.length)}Sn.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function qee(e,t){var r=[],n=0,a=Pr(),i=Mn,s;t.forEach(function(c,u){var d="",f=c[0].map(function(y){return y.a&&!d&&(d=y.a),y.t}).join("");++Mn;{var h=re(150);h.write_shift(2,15),h.write_shift(2,61444),h.write_shift(4,150),h.write_shift(2,3234),h.write_shift(2,61450),h.write_shift(4,8),h.write_shift(4,Mn),h.write_shift(4,2560),h.write_shift(2,227),h.write_shift(2,61451),h.write_shift(4,84),h.write_shift(2,128),h.write_shift(4,0),h.write_shift(2,139),h.write_shift(4,2),h.write_shift(2,191),h.write_shift(4,524296),h.write_shift(2,344),h.l+=4,h.write_shift(2,385),h.write_shift(4,134217808),h.write_shift(2,387),h.write_shift(4,134217808),h.write_shift(2,389),h.write_shift(4,268435700),h.write_shift(2,447),h.write_shift(4,1048592),h.write_shift(2,448),h.write_shift(4,134217809),h.write_shift(2,451),h.write_shift(4,268435700),h.write_shift(2,513),h.write_shift(4,134217809),h.write_shift(2,515),h.write_shift(4,268435700),h.write_shift(2,575),h.write_shift(4,196609),h.write_shift(2,959),h.write_shift(4,131072|(c[0].hidden?2:0)),h.l+=2,h.write_shift(2,61456),h.write_shift(4,18),h.write_shift(2,3),h.write_shift(2,c[2]+2),h.l+=2,h.write_shift(2,c[1]+1),h.l+=2,h.write_shift(2,c[2]+4),h.l+=2,h.write_shift(2,c[1]+5),h.l+=2,h.l+=2,h.write_shift(2,61457),h.l+=4,h.l=150,u==0?s=h:be(a,236,h)}n+=150;{var p=re(52);p.write_shift(2,21),p.write_shift(2,18),p.write_shift(2,25),p.write_shift(2,Mn),p.write_shift(2,0),p.l=22,p.write_shift(2,13),p.write_shift(2,22),p.write_shift(4,1651663474),p.write_shift(4,2503426821),p.write_shift(4,2150634280),p.write_shift(4,1768515844+Mn*256),p.write_shift(2,0),p.write_shift(4,0),p.l+=4,be(a,93,p)}{var x=re(8);x.l+=2,x.write_shift(2,61453),x.l+=4,be(a,236,x)}n+=8;{var g=re(18);g.write_shift(2,18),g.l+=8,g.write_shift(2,f.length),g.write_shift(2,16),g.l+=4,be(a,438,g);{var v=re(1+f.length);v.write_shift(1,0),v.write_shift(f.length,f,"sbcs"),be(a,60,v)}{var b=re(16);b.l+=8,b.write_shift(2,f.length),b.l+=6,be(a,60,b)}}{var w=re(12+d.length);w.write_shift(2,c[1]),w.write_shift(2,c[2]),w.write_shift(2,0|(c[0].hidden?0:2)),w.write_shift(2,Mn),w.write_shift(2,d.length),w.write_shift(1,0),w.write_shift(d.length,d,"sbcs"),w.l++,r.push(w)}});{var l=re(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Mn),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,i),l.write_shift(4,5),be(e,236,s?Kt([l,s]):l)}e.push(a.end()),r.forEach(function(c){be(e,28,c)}),Sn.push([i,t.length+1,Mn]),++Mn}function Zee(e,t,r){be(e,49,PY({sz:12,name:"Arial"},r))}function Jee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&be(e,1054,IY(a,t[a],r))})}function Qee(e,t){var r=re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(e,2151,r),r=re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),s4(St(t["!ref"]||"A1"),r),r.write_shift(4,4),be(e,2152,r)}function ete(e,t){for(var r=0;r<16;++r)be(e,224,fN({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){be(e,224,fN(n,0,t))})}function tte(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];be(e,440,WY(n)),n[1].Tooltip&&be(e,2048,VY(n))}delete t["!links"]}function rte(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&be(e,125,XY(v0(a,n),a))})}}function nte(e,t,r,n,a,i){var s=16+_i(a.cellXfs,t,a);if(t.v==null&&!t.bf){be(e,513,ns(r,n,s));return}if(t.bf)be(e,6,vJ(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?yr(rn(t.v,i),i):t.v;isNaN(l)?be(e,517,Ch(r,n,36,s,a,"e")):isFinite(l)?be(e,515,UY(r,n,l,s)):be(e,517,Ch(r,n,7,s,a,"e"));break;case"b":case"e":be(e,517,Ch(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var c=Ug(a.Strings,t.v==null?"":String(t.v),a.revStrings);be(e,253,OY(r,n,c,s))}else be(e,516,DY(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,a));break;default:be(e,513,ns(r,n,s))}}function ate(e,t,r){var n=Pr(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=i["!data"]!=null,u=t.biff==8,d="",f=[],h=St(i["!ref"]||"A1"),p=u?65536:16384;if(h.e.c>255||h.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+p);h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.r,p-1)}be(n,2057,Lg(r,16,t)),be(n,13,En(1)),be(n,12,En(100)),be(n,15,jr(!0)),be(n,17,jr(!1)),be(n,16,rs(.001)),be(n,95,jr(!0)),be(n,42,jr(!1)),be(n,43,jr(!1)),be(n,130,En(1)),be(n,128,$Y()),be(n,131,jr(!1)),be(n,132,jr(!1)),u&&rte(n,i["!cols"]),be(n,512,FY(h,t));var x=(((r||{}).Workbook||{}).WBProps||{}).date1904;u&&(i["!links"]=[]);for(var g=h.s.c;g<=h.e.c;++g)f[g]=ht(g);for(var v=[],b=[],w=h.s.r;w<=h.e.r;++w)for(c&&(b=i["!data"][w]||[]),d=mt(w),g=h.s.c;g<=h.e.c;++g){var y=c?b[g]:i[f[g]+d];y&&(nte(n,y,w,g,t,x),u&&y.l&&i["!links"].push([f[g]+d,y.l]),y.c&&v.push([y.c,w,g]))}var N=l.CodeName||l.name||a;return u?qee(n,v):k4(n,v),u&&be(n,574,AY((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&be(n,229,zY(i["!merges"])),u&&tte(n,i),be(n,442,i4(N)),u&&Qee(n,i),be(n,10),n.end()}function ite(e,t,r){var n=Pr(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(be(n,2057,Lg(e,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,l?En(1200):null),be(n,193,gY(2)),c&&be(n,191),c&&be(n,192),be(n,226),be(n,92,jY("SheetJS",r)),be(n,66,En(l?1200:1252)),l&&be(n,353,En(0)),l&&be(n,448),be(n,317,YY(e.SheetNames.length)),l&&e.vbaraw&&be(n,211),l&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";be(n,442,i4(u))}be(n,156,En(17)),be(n,25,jr(!1)),be(n,18,jr(!1)),be(n,19,En(0)),l&&be(n,431,jr(!1)),l&&be(n,444,En(0)),be(n,61,kY()),be(n,64,jr(!1)),be(n,141,En(0)),be(n,34,jr(uee(e)=="true")),be(n,14,jr(!0)),l&&be(n,439,jr(!1)),be(n,218,En(0)),Zee(n,e,r),Jee(n,e.SSF,r),ete(n,r),l&&be(n,352,jr(!1));var d=n.end(),f=Pr();l&&be(f,140,KY()),l&&Sn.length&&be(f,235,Yee()),l&&r.Strings&&Wee(f,252,CY(r.Strings)),be(f,10);var h=f.end(),p=Pr(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var v=d.length+x+h.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};be(p,133,TY({pos:v,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),v+=t[g].length}var w=p.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var y=[];return d.length&&y.push(d),w.length&&y.push(w),h.length&&y.push(h),Kt(y)}function ste(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Dr(_t)),e&&e.SSF&&(u0(),c0(e.SSF),r.revssf=d0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),Mn=1,Sn=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Hg(r),r.cellXfs=[],_i(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=ate(a,r,e);return n.unshift(ite(e,n,r)),Kt(n)}function A4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=br(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return ste(e,t);case 4:case 3:case 2:return Xee(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function ote(e,t,r,n){for(var a=e["!merges"]||[],i=[],s={},l=e["!data"]!=null,c=t.s.c;c<=t.e.c;++c){for(var u=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>c)&&!(a[f].e.r<r||a[f].e.c<c)){if(a[f].s.r<r||a[f].s.c<c){u=-1;break}u=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(u<0)){var h=ht(c)+mt(r),p=l?(e["!data"][r]||[])[c]:e[h];p&&p.t=="n"&&p.v!=null&&!isFinite(p.v)&&(isNaN(p.v)?p={t:"e",v:36,w:Vr[36]}:p={t:"e",v:7,w:Vr[7]});var x=p&&p.v!=null&&(p.h||Sh(p.w||(Wa(p),p.w)||""))||"";s={},u>1&&(s.rowspan=u),d>1&&(s.colspan=d),n.editable?x='<span contenteditable="true">'+x+"</span>":p&&(s["data-t"]=p&&p.t||"z",p.v!=null&&(s["data-v"]=Sh(p.v instanceof Date?p.v.toISOString():p.v)),p.z!=null&&(s["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+Sh(p.l.Target)+'">'+x+"</a>")),s.id=(n.id||"sjs")+"-"+h,i.push(Ee("td",x,s))}}var g="<tr>";return g+i.join("")+"</tr>"}var lte='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cte="</body></html>";function ute(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function P4(e,t){var r=t||{},n=r.header!=null?r.header:lte,a=r.footer!=null?r.footer:cte,i=[n],s=br(e["!ref"]||"A1");if(i.push(ute(e,s,r)),e["!ref"])for(var l=s.s.r;l<=s.e.r;++l)i.push(ote(e,s,l,r));return i.push("</table>"+a),i.join("")}function O4(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?At(a.origin):a.origin;s=c.r,l=c.c}var u=Math.min(a.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var f=br(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var h=[],p=0,x=e["!rows"]||(e["!rows"]=[]),g=0,v=0,b=0,w=0,y=0,N=0;for(e["!cols"]||(e["!cols"]=[]);g<n.length&&v<u;++g){var S=n[g];if(_N(S)){if(a.display)continue;x[v]={hidden:!0}}var E=S.cells;for(b=w=0;b<E.length;++b){var _=E[b];if(!(a.display&&_N(_))){var j=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):TX(_.innerHTML),A=_.getAttribute("data-z")||_.getAttribute("z");for(p=0;p<h.length;++p){var T=h[p];T.s.c==w+l&&T.s.r<v+s&&v+s<=T.e.r&&(w=T.e.c+1-l,p=-1)}N=+_.getAttribute("colspan")||1,((y=+_.getAttribute("rowspan")||1)>1||N>1)&&h.push({s:{r:v+s,c:w+l},e:{r:v+s+(y||1)-1,c:w+l+(N||1)-1}});var k={t:"s",v:j},C=_.getAttribute("data-t")||_.getAttribute("t")||"";j!=null&&(j.length==0?k.t=C||"z":a.raw||j.trim().length==0||C=="s"||(C=="e"&&Vr[+j]?k={t:"e",v:+j,w:Vr[+j]}:j==="TRUE"?k={t:"b",v:!0}:j==="FALSE"?k={t:"b",v:!1}:isNaN(Da(j))?isNaN(Ju(j).getDate())?j.charCodeAt(0)==35&&sa[j]!=null&&(k={t:"e",v:sa[j],w:j}):(k={t:"d",v:rn(j)},a.UTC&&(k.v=f0(k.v)),a.cellDates||(k={t:"n",v:yr(k.v)}),k.z=a.dateNF||_t[14]):k={t:"n",v:Da(j)})),k.z===void 0&&A!=null&&(k.z=A);var L="",G=_.getElementsByTagName("A");if(G&&G.length)for(var V=0;V<G.length&&!(G[V].hasAttribute("href")&&(L=G[V].getAttribute("href"),L.charAt(0)!="#"));++V);L&&L.charAt(0)!="#"&&L.slice(0,11).toLowerCase()!="javascript:"&&(k.l={Target:L}),i?(e["!data"][v+s]||(e["!data"][v+s]=[]),e["!data"][v+s][w+l]=k):e[Mt({c:w+l,r:v+s})]=k,d.e.c<w+l&&(d.e.c=w+l),w+=N}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,v-1+s),e["!ref"]=qt(d),v>=u&&(e["!fullref"]=qt((d.e.r=n.length-g+v-1+s,d))),e}function D4(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),O4(n,e,t)}function dte(e,t){var r=xo(D4(e,t),t);return r}function _N(e){var t="",r=fte(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function fte(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hte=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Jt+t}})();function pte(e,t){var r="number",n="",a={"style:name":t},i="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Ze(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var l=e.match(/# (\?+)\/(\?+)/);if(l){n+=Ee("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=e.match(/# (\?+)\/(\d+)/)){n+=Ee("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Ee("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"s":c=!0,--s;break t;case"m":r:for(var u=s+1;u<e.length;++u)switch(e[u]){case"y":case"d":break r;case"h":case"s":c=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Ze(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++s],n+="<number:text>"+Ze(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!c)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do i+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Ze(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(i)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Ze(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+e);else{var f=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(f.indexOf("0")==-1?"0":f.length-f.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",s=d.index+d[0].length}if(e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>"}}return n?Ee("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function SN(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var l=(r==-1?"$":"")+S4(s.Ref);return"        "+Ee("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var EN=(function(){var e=function(a,i){return Ze(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,s,l,c,u){var d=[];d.push('      <table:table table:name="'+Ze(i.SheetNames[s])+`" table:style-name="ta1">
`);var f=0,h=0,p=br(a["!ref"]||"A1"),x=a["!merges"]||[],g=0,v=a["!data"]!=null;if(a["!cols"])for(h=0;h<=p.e.c;++h)d.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var b="",w=a["!rows"]||[];for(f=0;f<p.s.r;++f)b=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+b+`></table:table-row>
`);for(;f<=p.e.r;++f){for(b=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+b+`>
`),h=0;h<p.s.c;++h)d.push(t);for(;h<=p.e.c;++h){var y=!1,N={},S="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>f)&&!(x[g].e.c<h)&&!(x[g].e.r<f)){(x[g].s.c!=h||x[g].s.r!=f)&&(y=!0),N["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,N["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(y){d.push(`          <table:covered-table-cell/>
`);continue}var E=Mt({r:f,c:h}),_=v?(a["!data"][f]||[])[h]:a[E];if(_&&_.f&&(N["table:formula"]=Ze(RJ(_.f)),_.F&&_.F.slice(0,E.length)==E)){var j=br(_.F);N["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,N["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!_){d.push(t);continue}switch(_.t){case"b":S=_.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=_.v?"true":"false";break;case"n":isFinite(_.v)?(S=_.w||String(_.v||0),N["office:value-type"]="float",N["office:value"]=_.v||0):(isNaN(_.v)?(S="#NUM!",N["table:formula"]="of:=#NUM!"):(S="#DIV/0!",N["table:formula"]="of:="+(_.v<0?"-":"")+"1/0"),N["office:string-value"]="",N["office:value-type"]="string",N["calcext:value-type"]="error");break;case"s":case"str":S=_.v==null?"":_.v,N["office:value-type"]="string";break;case"d":S=_.w||rn(_.v,u).toISOString(),N["office:value-type"]="date",N["office:date-value"]=rn(_.v,u).toISOString(),N["table:style-name"]="ce1";break;default:d.push(t);continue}var A=e(S);if(_.l&&_.l.Target){var T=_.l.Target;T=T.charAt(0)=="#"?"#"+S4(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),A=Ee("text:a",A,{"xlink:href":T.replace(/&/g,"&amp;")})}c[_.z]&&(N["table:style-name"]="ce"+c[_.z].slice(1));var k=Ee("text:p",A,{});if(_.c){for(var C="",L="",G={},V=0;V<_.c.length;++V)!C&&_.c[V].a&&(C=_.c[V].a),L+="<text:p>"+e(_.c[V].t)+"</text:p>";_.c.hidden||(G["office:display"]=!0),k=Ee("office:annotation",L,G)+k}d.push("          "+Ee("table:table-cell",k,N)+`
`)}d.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&d.push(SN(i.Workbook.Names,i.SheetNames,s)),d.push(`      </table:table>
`),d.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var s=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var f=0;f<d["!cols"].length;++f)if(d["!cols"][f]){var h=d["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Bg(h),h.ods=s;var p=d["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++s}}});var l=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var f=0;f<d["!rows"].length;++f)if(d["!rows"][f]){d["!rows"][f].ods=l;var h=d["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c={},u=69;return i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d){var f=d["!data"]!=null;if(d["!ref"])for(var h=br(d["!ref"]),p=0;p<=h.e.r;++p)for(var x=0;x<=h.e.c;++x){var g=f?(d["!data"][p]||[])[x]:d[Mt({r:p,c:x})];if(!(!g||!g.z||g.z.toLowerCase()=="general")&&!c[g.z]){var v=pte(g.z,"N"+u);v&&(c[g.z]="N"+u,++u,a.push(v+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Yt(c).forEach(function(d){a.push('<style:style style:name="ce'+c[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+c[d]+`"/>
`)}),a.push(` </office:automatic-styles>
`),c};return function(i,s){var l=[Jt],c=gl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=gl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(ZT().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+c+`>
`);var d=n(l,i);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var f=0;f!=i.SheetNames.length;++f)l.push(r(i.Sheets[i.SheetNames[f]],i,f,s,d,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&l.push(SN(i.Workbook.Names,i.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),s.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function I4(e,t){if(t.bookType=="fods")return EN(e,t);var r=Cg(),n="",a=[],i=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,EN(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",qe(r,n,hte(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",qe(r,n,Jt+ZT()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,fY(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,uY(a)),r}var zr=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function id(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function wl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Vs(es(e))}function Lr(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):cn(xl(e))}function vi(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],s=i.length;if(s<250)for(var l=0;l<s;++l)n[a++]=i[l];else n.set(i,a),a+=s}return n}function mte(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Nl(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function Me(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[zr](0,r)}function R4(e){for(var t={l:0},r=[];t.l<e.length;)r.push(Nl(e,t));return r}function M4(e){return vi(e.map(function(t){return Me(t)}))}function pn(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function $e(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=Nl(e,r),i=a&7;a=a/8|0;var s,l=r.l;switch(i){case 0:{for(;e[l++]>=128;);s=e[zr](r.l,l),r.l=l}break;case 1:s=e[zr](l,l+8),r.l=l+8;break;case 2:{var c=Nl(e,r);s=e[zr](r.l,r.l+c),r.l+=c}break;case 5:s=e[zr](l,l+4),r.l=l+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:s,type:i};t[a]==null&&(t[a]=[]),t[a].push(u)}return t}function Le(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push(Me(n*8+a.type)),a.type==2&&t.push(Me(a.data.length)),t.push(a.data))})}),vi(t)}function sd(e,t){return e?.map(function(r){return t(r.data)})||[]}function od(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Nl(e,n),i=$e(e[zr](n.l,n.l+a));n.l+=a;var s={id:pn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=$e(l.data),u=pn(c[3][0].data);s.messages.push({meta:c,data:e[zr](n.l,n.l+u)}),n.l+=u}),(t=i[3])!=null&&t[0]&&(s.merge=pn(i[3][0].data)>>>0>0),r.push(s)}return r}function Xs(e){var t=[];return e.forEach(function(r){var n=[[],[{data:Me(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:Me(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Me(s.data.length)}],n[2].push({data:Le(s.meta),type:2})});var i=Le(n);t.push(Me(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),vi(t)}function xte(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Nl(t,r),a=[],i=r.l;i<t.length;){var s=t[i]&3;if(s==0){var l=t[i++]>>2;if(l<60)++l;else{var c=l-59;l=t[i],c>1&&(l|=t[i+1]<<8),c>2&&(l|=t[i+2]<<16),c>3&&(l|=t[i+3]<<24),l>>>=0,l++,i+=c}a.push(t[zr](i,i+l)),i+=l;continue}else{var u=0,d=0;if(s==1?(d=(t[i]>>2&7)+4,u=(t[i++]&224)<<3,u|=t[i++]):(d=(t[i++]>>2)+1,s==2?(u=t[i]|t[i+1]<<8,i+=2):(u=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),u==0)throw new Error("Invalid offset 0");for(var f=a.length-1,h=u;f>=0&&h>=a[f].length;)h-=a[f].length,--f;if(f<0)if(h==0)h=a[f=0].length;else throw new Error("Invalid offset beyond length");if(d<h)a.push(a[f][zr](a[f].length-h,a[f].length-h+d));else{for(h>0&&(a.push(a[f][zr](a[f].length-h)),d-=h),++f;d>=a[f].length;)a.push(a[f]),d-=a[f].length,++f;d&&a.push(a[f][zr](0,d))}a.length>25&&(a=[vi(a)])}}for(var p=0,x=0;x<a.length;++x)p+=a[x].length;if(p!=n)throw new Error("Unexpected length: ".concat(p," != ").concat(n));return a}function ld(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,xte(n,e[zr](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:vi(t)}function Ys(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Me(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[zr](r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return vi(t)}function Rh(e,t){var r=new Uint8Array(32),n=id(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&ts(e.z)){r[1]=5,n.setFloat64(a,(Ws(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,mte(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var l=t.rsst.findIndex(function(u){var d;return u.v==s&&u.l==((d=e.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=16,a+=4}else{var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(gte(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[zr](0,a)}function Mh(e,t){var r=new Uint8Array(32),n=id(r),a=12,i=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var l=t.rsst.findIndex(function(u){var d;return u.v==s&&u.l==((d=e.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[zr](0,a)}function Vt(e){var t=$e(e);return pn(t[1][0].data)}function Er(e){return Le([[],[{type:0,data:Me(e)}]])}function Sr(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?R4(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:M4(n)}])}function wa(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?R4(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:M4(n.filter(function(a){return a!=t}))}]}function gte(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function vte(e,t,r){var n,a,i,s=[[],[{type:0,data:Me(0)}],[{type:0,data:Me(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Me(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Me(1)}]];if(!((n=s[6])!=null&&n[0])||!((a=s[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(s[7][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(s[7][0].data),s[7][0].data=c}if(s[4][0].data.length<2*e.length){var u=new Uint8Array(2*e.length);u.set(s[4][0].data),s[4][0].data=u}for(var d=id(s[7][0].data),f=0,h=[],p=id(s[4][0].data),x=0,g=[],v=4,b=0;b<e.length;++b){if(e[b]==null||e[b].t=="z"&&!((i=e[b].c)!=null&&i.length)||e[b].t=="e"){d.setUint16(b*2,65535,!0),p.setUint16(b*2,65535);continue}d.setUint16(b*2,f/v,!0),p.setUint16(b*2,x/v,!0);var w,y;switch(e[b].t){case"d":if(e[b].v instanceof Date){w=Rh(e[b],t),y=Mh(e[b],t);break}w=Rh(e[b],t),y=Mh(e[b],t);break;case"s":case"n":case"b":case"z":w=Rh(e[b],t),y=Mh(e[b],t);break;default:throw new Error("Unsupported value "+e[b])}h.push(w),f+=w.length,g.push(y),x+=y.length,++l}for(s[2][0].data=Me(l),s[5][0].data=Me(5);b<s[7][0].data.length/2;++b)d.setUint16(b*2,65535,!0),p.setUint16(b*2,65535,!0);return s[6][0].data=vi(h),s[3][0].data=vi(g),s[8]=[{type:0,data:Me(1)}],s}function tm(e,t){return{meta:[[],[{type:0,data:Me(e)}]],data:t}}function ra(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function bte(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&od(ld(a.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:i,type:pn(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&od(ld(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(s){i.meta[s]&&i.meta[s].forEach(function(l){t[a.id].deps.push(pn(l.data))})})})})}),t}function Oc(e,t,r){return Le([[],[{type:0,data:Me(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:Me(1)}]])}function jN(e){switch(e){case 0:return Oc(99,222,171);case 1:return Oc(162,197,240);case 2:return Oc(255,189,189)}return Oc(Math.random()*255,Math.random()*255,Math.random()*255)}function yte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=gt.read(t.numbers,{type:"base64"}),n=bte(r),a=na(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=sd($e(a.messages[0].data)[1],Vt);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,l){l>=1&&(Nte(r,n,l+1),a=na(r,n,1),i=sd($e(a.messages[0].data)[1],Vt)),_te(r,n,e.Sheets[s],s,l,i[l])}),r}function dt(e,t,r,n){var a=gt.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=od(ld(a.content)),s=i.find(function(l){return l.id==r});n(s,i),a.content=Ys(Xs(i)),a.size=a.content.length}function na(e,t,r){var n=gt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=od(ld(n.content)),i=a.find(function(s){return s.id==r});return i}function rm(e,t,r){e[3].push({type:2,data:Le([[],[{type:0,data:Me(t)}],[{type:2,data:Lr(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:Lr(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(0)}]])}),e[1]=[{type:0,data:Me(Math.max(t+1,pn(e[1][0].data)))}]}function Ti(e,t,r,n,a,i){i||(i=ra({deps:[],location:"",type:t},a));var s="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+s,gt.utils.cfb_add(e,s,Ys(Xs([{id:i,messages:[tm(t,Le(r))]}])));var l=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return dt(e,a,2,function(c){var u=$e(c.messages[0].data);rm(u,i||0,l),c.messages[0].data=Le(u)}),i}function Zr(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,u,d=$e(l.data);return(c=d[3])!=null&&c[0]?wl(d[3][0].data)==a:!!((u=d[2])!=null&&u[0]&&wl(d[2][0].data)==a)}),s=$e(e[3][i].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){s[6].push({type:2,data:Le([[],[{type:0,data:Me(l)}]])})}),e[3][i].data=Le(s)}function wte(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,u,d=$e(l.data);return(c=d[3])!=null&&c[0]?wl(d[3][0].data)==a:!!((u=d[2])!=null&&u[0]&&wl(d[2][0].data)==a)}),s=$e(e[3][i].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(l){return pn($e(l.data)[1][0].data)!=n}),e[3][i].data=Le(s)}function Nte(e,t,r){var n=-1,a=-1,i={};dt(e,t,1,function(c,u){var d=$e(c.messages[0].data);n=Vt($e(c.messages[0].data)[1][0].data),a=ra({deps:[1],location:t[n].location,type:2},t),i[n]=a,Sr(c,a),d[1].push({type:2,data:Er(a)});var f=na(e,t,n);f.id=a,t[1].location==t[a].location?u.push(f):dt(e,t,a,function(h,p){return p.push(f)}),c.messages[0].data=Le(d)});var s=-1;dt(e,t,a,function(c,u){for(var d=$e(c.messages[0].data),f=3;f<=69;++f)delete d[f];var h=sd(d[2],Vt);h.forEach(function(x){return wa(c,x)}),s=ra({deps:[a],location:t[h[0]].location,type:t[h[0]].type},t),Sr(c,s),i[h[0]]=s,d[2]=[{type:2,data:Er(s)}];var p=na(e,t,h[0]);p.id=s,t[h[0]].location==t[a].location?u.push(p):(dt(e,t,2,function(x){var g=$e(x.messages[0].data);Zr(g,t,a,s),x.messages[0].data=Le(g)}),dt(e,t,s,function(x,g){return g.push(p)})),c.messages[0].data=Le(d)});var l=-1;dt(e,t,s,function(c,u){for(var d=$e(c.messages[0].data),f=$e(d[1][0].data),h=3;h<=69;++h)delete f[h];var p=Vt(f[2][0].data);f[2][0].data=Er(i[p]),d[1][0].data=Le(f);var x=Vt(d[2][0].data);wa(c,x),l=ra({deps:[s],location:t[x].location,type:t[x].type},t),Sr(c,l),i[x]=l,d[2][0].data=Er(l);var g=na(e,t,x);g.id=l,t[s].location==t[l].location?u.push(g):dt(e,t,l,function(v,b){return b.push(g)}),c.messages[0].data=Le(d)}),dt(e,t,l,function(c,u){var d,f,h=$e(c.messages[0].data),p=wl(h[1][0].data),x=p.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(h[1][0].data=Lr(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(S){return delete h[S]}),h[45]){var g=$e(h[45][0].data),v=Vt(g[1][0].data);wa(c,v),delete h[45]}if(h[70]){var b=$e(h[70][0].data);(d=b[2])==null||d.forEach(function(S){var E=$e(S.data);[2,3].map(function(_){return E[_][0]}).forEach(function(_){var j=$e(_.data);if(j[8]){var A=Vt(j[8][0].data);wa(c,A)}})}),delete h[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(S){if(h[S]){var E=Vt(h[S][0].data);delete h[S],wa(c,E)}});var w=$e(h[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(S){var E;if((E=w[S])!=null&&E[0]){var _=Vt(w[S][0].data),j=ra({deps:[l],location:t[_].location,type:t[_].type},t);wa(c,_),Sr(c,j),i[_]=j;var A=na(e,t,_);if(A.id=j,t[_].location==t[l].location)u.push(A);else{t[j].location=t[_].location.replace(_.toString(),j.toString()),t[j].location==t[_].location&&(t[j].location=t[j].location.replace(/\.iwa/,"-".concat(j,".iwa"))),gt.utils.cfb_add(e,t[j].location,Ys(Xs([A])));var T=t[j].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");dt(e,t,2,function(k){var C=$e(k.messages[0].data);rm(C,j,T),Zr(C,t,l,j),k.messages[0].data=Le(C)})}w[S][0].data=Er(j)}});var y=$e(w[1][0].data);(f=y[2])==null||f.forEach(function(S){var E=Vt(S.data),_=ra({deps:[l],location:t[E].location,type:t[E].type},t);wa(c,E),Sr(c,_),i[E]=_;var j=na(e,t,E);if(j.id=_,t[E].location==t[l].location)u.push(j);else{t[_].location=t[E].location.replace(E.toString(),_.toString()),t[_].location==t[E].location&&(t[_].location=t[_].location.replace(/\.iwa/,"-".concat(_,".iwa"))),gt.utils.cfb_add(e,t[_].location,Ys(Xs([j])));var A=t[_].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");dt(e,t,2,function(T){var k=$e(T.messages[0].data);rm(k,_,A),Zr(k,t,l,_),T.messages[0].data=Le(k)})}S.data=Er(_)}),w[1][0].data=Le(y);var N=$e(w[3][0].data);N[1].forEach(function(S){var E=$e(S.data),_=Vt(E[2][0].data),j=i[_];if(!i[_]){j=ra({deps:[l],location:"",type:t[_].type},t),t[j].location="Root Entry/Index/Tables/Tile-".concat(j,".iwa"),i[_]=j;var A=na(e,t,_);A.id=j,wa(c,_),Sr(c,j),gt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(j,".iwa"),Ys(Xs([A]))),dt(e,t,2,function(T){var k=$e(T.messages[0].data);k[3].push({type:2,data:Le([[],[{type:0,data:Me(j)}],[{type:2,data:Lr("Tables/Tile")}],[{type:2,data:Lr("Tables/Tile-".concat(j))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(0)}]])}),k[1]=[{type:0,data:Me(Math.max(j+1,pn(k[1][0].data)))}],Zr(k,t,l,j),T.messages[0].data=Le(k)})}E[2][0].data=Er(j),S.data=Le(E)}),w[3][0].data=Le(N)}h[4][0].data=Le(w),c.messages[0].data=Le(h)})}function _te(e,t,r,n,a,i){var s=[];dt(e,t,i,function(u){var d=$e(u.messages[0].data);d[1]=[{type:2,data:Lr(n)}],s=sd(d[2],Vt),u.messages[0].data=Le(d)});var l=na(e,t,s[0]),c=Vt($e(l.messages[0].data)[2][0].data);dt(e,t,c,function(u,d){return Ste(e,t,r,u,d,c)})}function Ste(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=br(r["!ref"]);s.s.r=s.s.c=0;var l=!1;s.e.c>999&&(l=!0,s.e.c=999),s.e.r>999999&&(l=!0,s.e.r=999999),l&&console.error("Truncating to ".concat(qt(s)));var c=[];if(r["!data"])c=r["!data"];else{for(var u=[],d=0;d<=s.e.c;++d)u[d]=ht(d);for(var f=0;f<=s.e.r;++f){c[f]=[];var h=""+(f+1);for(d=0;d<=s.e.c;++d){var p=r[u[d]+h];p&&(c[f][d]=p)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},g=$e(n.messages[0].data);{g[6][0].data=Me(s.e.r+1),g[7][0].data=Me(s.e.c+1),delete g[46];var v=$e(g[4][0].data);{var b=Vt($e(v[1][0].data)[2][0].data);dt(e,t,b,function(ce,me){var Ne,ee=$e(ce.messages[0].data);if((Ne=ee?.[2])!=null&&Ne[0])for(var oe=0;oe<c.length;++oe){var fe=$e(ee[2][0].data);fe[1][0].data=Me(oe),fe[4][0].data=Me(c[oe].length),ee[2][oe]={type:ee[2][0].type,data:Le(fe)}}ce.messages[0].data=Le(ee)});var w=Vt(v[2][0].data);dt(e,t,w,function(ce,me){for(var Ne=$e(ce.messages[0].data),ee=0;ee<=s.e.c;++ee){var oe=$e(Ne[2][0].data);oe[1][0].data=Me(ee),oe[4][0].data=Me(s.e.r+1),Ne[2][ee]={type:Ne[2][0].type,data:Le(oe)}}ce.messages[0].data=Le(Ne)});var y=$e(v[9][0].data);y[1]=[];var N=$e(v[3][0].data);{var S=256;N[2]=[{type:0,data:Me(S)}];var E=Vt($e(N[1][0].data)[2][0].data),_=(function(){var ce=na(e,t,2),me=$e(ce.messages[0].data),Ne=me[3].filter(function(ee){return pn($e(ee.data)[1][0].data)==E});return Ne?.length?pn($e(Ne[0].data)[12][0].data):0})();gt.utils.cfb_del(e,t[E].location),dt(e,t,2,function(ce){var me=$e(ce.messages[0].data);me[3]=me[3].filter(function(Ne){return pn($e(Ne.data)[1][0].data)!=E}),wte(me,t,i,E),ce.messages[0].data=Le(me)}),wa(n,E),N[1]=[];for(var j=Math.ceil((s.e.r+1)/S),A=0;A<j;++A){var T=ra({deps:[],location:"",type:6002},t);t[T].location="Root Entry/Index/Tables/Tile-".concat(T,".iwa");for(var k=[[],[{type:0,data:Me(0)}],[{type:0,data:Me(Math.min(s.e.r+1,(A+1)*S))}],[{type:0,data:Me(0)}],[{type:0,data:Me(Math.min((A+1)*S,s.e.r+1)-A*S)}],[],[{type:0,data:Me(5)}],[{type:0,data:Me(1)}],[{type:0,data:Me(1)}]],C=A*S;C<=Math.min(s.e.r,(A+1)*S-1);++C){var L=vte(c[C],x);L[1][0].data=Me(C-A*S),k[5].push({data:Le(L),type:2})}N[1].push({type:2,data:Le([[],[{type:0,data:Me(A)}],[{type:2,data:Er(T)}]])});var G={id:T,messages:[tm(6002,Le(k))]},V=Ys(Xs([G]));gt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(T,".iwa"),V),dt(e,t,2,function(ce){var me=$e(ce.messages[0].data);me[3].push({type:2,data:Le([[],[{type:0,data:Me(T)}],[{type:2,data:Lr("Tables/Tile")}],[{type:2,data:Lr("Tables/Tile-".concat(T))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(_)}]])}),me[1]=[{type:0,data:Me(Math.max(T+1,pn(me[1][0].data)))}],Zr(me,t,i,T),ce.messages[0].data=Le(me)}),Sr(n,T),y[1].push({type:2,data:Le([[],[{type:0,data:Me(A*S)}],[{type:0,data:Me(A)}]])})}}if(v[3][0].data=Le(N),v[9][0].data=Le(y),v[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var X=ra({type:6144,deps:[i],location:t[i].location},t);a.push({id:X,messages:[tm(6144,Le([[],r["!merges"].map(function(ce){return{type:2,data:Le([[],[{type:2,data:Le([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.s.r,ce.s.c]).buffer)}]])}],[{type:2,data:Le([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.e.r-ce.s.r+1,ce.e.c-ce.s.c+1]).buffer)}]])}]])}})]))]}),v[13]=[{type:2,data:Er(X)}],dt(e,t,2,function(ce){var me=$e(ce.messages[0].data);Zr(me,t,i,X),ce.messages[0].data=Le(me)}),Sr(n,X)}else delete v[13];var K=Vt(v[4][0].data);dt(e,t,K,function(ce){var me=$e(ce.messages[0].data);me[3]=[],x.sst.forEach(function(Ne,ee){ee!=0&&me[3].push({type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(1)}],[{type:2,data:Lr(Ne)}]])})}),ce.messages[0].data=Le(me)});var Y=Vt(v[17][0].data);if(dt(e,t,Y,function(ce){var me=$e(ce.messages[0].data);me[3]=[];var Ne=[904980,903835,903815,903845];x.rsst.forEach(function(ee,oe){if(oe!=0){var fe=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Lr(ee.v)}]];fe[10]=[{type:0,data:new Uint8Array([1])}],fe[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],fe[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],fe[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],fe[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],fe[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],fe[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],fe[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],fe[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var O=ra({deps:[],location:"",type:2001},t),I=[];if(ee.l){var F=Ti(e,2032,[[],[],[{type:2,data:Lr(ee.l)}]],"/Index/Tables/DataList",t);fe[11]=[];var M=[[],[]];M[1]||(M[1]=[]),M[1].push({type:2,data:Le([[],[{type:0,data:Me(0)}],[{type:2,data:Er(F)}]])}),fe[11][0]={type:2,data:Le(M)},I.push(F)}Ti(e,2001,fe,"/Index/Tables/DataList",t,O),dt(e,t,O,function(J){Ne.forEach(function(se){return Sr(J,se)}),I.forEach(function(se){return Sr(J,se)})});var W=Ti(e,6218,[[],[{type:2,data:Er(O)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);dt(e,t,W,function(J){return Sr(J,O)}),me[3].push({type:2,data:Le([[],[{type:0,data:Me(oe)}],[{type:0,data:Me(1)}],[],[],[],[],[],[],[{type:2,data:Er(W)}]])}),Sr(ce,W),dt(e,t,2,function(J){var se=$e(J.messages[0].data);Zr(se,t,Y,W),Zr(se,t,W,O),Zr(se,t,O,I),Zr(se,t,O,Ne),J.messages[0].data=Le(se)})}}),ce.messages[0].data=Le(me)}),x.cmnt.length>1){var q=Vt(v[19][0].data),Z={},le=0;dt(e,t,q,function(ce){var me=$e(ce.messages[0].data);me[3]=[],x.cmnt.forEach(function(Ne,ee){if(ee!=0){var oe=[];Ne.replies&&Ne.replies.forEach(function(I){Z[I.a||""]||(Z[I.a||""]=Ti(e,212,[[],[{type:2,data:Lr(I.a||"")}],[{type:2,data:jN(++le)}],[],[{type:0,data:Me(0)}]],"/Index/Tables/DataList",t));var F=Z[I.a||""],M=Ti(e,3056,[[],[{type:2,data:Lr(I.t||"")}],[{type:2,data:Le([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Er(F)}]],"/Index/Tables/DataList",t);dt(e,t,M,function(W){return Sr(W,F)}),oe.push(M),dt(e,t,2,function(W){var J=$e(W.messages[0].data);Zr(J,t,M,F),W.messages[0].data=Le(J)})}),Z[Ne.a||""]||(Z[Ne.a||""]=Ti(e,212,[[],[{type:2,data:Lr(Ne.a||"")}],[{type:2,data:jN(++le)}],[],[{type:0,data:Me(0)}]],"/Index/Tables/DataList",t));var fe=Z[Ne.a||""],O=Ti(e,3056,[[],[{type:2,data:Lr(Ne.t||"")}],[{type:2,data:Le([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Er(fe)}],oe.map(function(I){return{type:2,data:Er(I)}}),[{type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(0)}]])}]],"/Index/Tables/DataList",t);dt(e,t,O,function(I){Sr(I,fe),oe.forEach(function(F){return Sr(I,F)})}),me[3].push({type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(1)}],[],[],[],[],[],[],[],[{type:2,data:Er(O)}]])}),Sr(ce,O),dt(e,t,2,function(I){var F=$e(I.messages[0].data);Zr(F,t,q,O),Zr(F,t,O,fe),oe.length&&Zr(F,t,O,oe),I.messages[0].data=Le(F)})}}),me[2][0].data=Me(x.cmnt.length+1),ce.messages[0].data=Le(me)})}}g[4][0].data=Le(v)}n.messages[0].data=Le(g)}function Ete(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Hg(e){Ete([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function jte(e,t){e&&!e.SSF&&(e.SSF=Dr(_t)),e&&e.SSF&&(u0(),c0(e.SSF),t.revssf=d0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=XT();Hg(t=t||{});var i=Cg(),s="",l=0;if(t.cellXfs=[],_i(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qe(i,s,JT(e.Props,t)),a.coreprops.push(s),it(t.rels,2,s,tt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,s,e4(e.Props)),a.extprops.push(s),it(t.rels,3,s,tt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qe(i,s,t4(e.Custprops)),a.custprops.push(s),it(t.rels,4,s,tt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+l+"."+r,qe(i,s,oee(l-1,t,e,f)),a.sheets.push(s),it(t.wbrels,-1,"worksheets/sheet"+l+"."+r,tt.WS[0]),h){var x=h["!comments"],g=!1,v="";if(x&&x.length>0){var b=!1;x.forEach(function(y){y[1].forEach(function(N){N.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+".xml",qe(i,v,m4(x,d,t)),a.threadedcomments.push(v),it(f,-1,"../threadedComments/threadedComment"+l+".xml",tt.TCMNT)),v="xl/comments"+l+"."+r,qe(i,v,Zq(x)),a.comments.push(v),it(f,-1,"../comments"+l+"."+r,tt.CMNT),g=!0}h["!legacy"]&&g&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",p4(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&qe(i,qT(s),Ks(f))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qe(i,s,oq(t.Strings)),a.strs.push(s),it(t.wbrels,-1,"sharedStrings."+r,tt.SST)),s="xl/workbook."+r,qe(i,s,Cee(e)),a.workbooks.push(s),it(t.rels,1,s,tt.WB),s="xl/theme/theme1.xml";var w=h4(e.Themes,t);return qe(i,s,w),a.themes.push(s),it(t.wbrels,-1,"theme/theme1.xml",tt.THEME),s="xl/styles."+r,qe(i,s,Rq(e,t)),a.styles.push(s),it(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qe(i,s,e.vbaraw),a.vba.push(s),it(t.wbrels,-1,"vbaProject.bin",tt.VBA)),s="xl/metadata."+r,qe(i,s,zq()),a.metadata.push(s),it(t.wbrels,-1,"metadata."+r,tt.XLMETA),d.length>1&&(s="xl/persons/person.xml",qe(i,s,x4(d)),a.people.push(s),it(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),qe(i,"[Content_Types].xml",YT(a,t)),qe(i,"_rels/.rels",Ks(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",Ks(t.wbrels)),delete t.revssf,delete t.ssf,i}function Tte(e,t){e&&!e.SSF&&(e.SSF=Dr(_t)),e&&e.SSF&&(u0(),c0(e.SSF),t.revssf=d0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Qq.indexOf(t.bookType)>-1,a=XT();Hg(t=t||{});var i=Cg(),s="",l=0;if(t.cellXfs=[],_i(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",qe(i,s,JT(e.Props,t)),a.coreprops.push(s),it(t.rels,2,s,tt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,s,e4(e.Props)),a.extprops.push(s),it(t.rels,3,s,tt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",qe(i,s,t4(e.Custprops)),a.custprops.push(s),it(t.rels,4,s,tt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+l+"."+r,qe(i,s,XJ(l-1,t,e,f)),a.sheets.push(s),it(t.wbrels,-1,"worksheets/sheet"+l+"."+r,tt.WS[0]),h){var x=h["!comments"],g=!1,v="";if(x&&x.length>0){var b=!1;x.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+".xml",qe(i,v,m4(x,d,t)),a.threadedcomments.push(v),it(f,-1,"../threadedComments/threadedComment"+l+".xml",tt.TCMNT)),v="xl/comments"+l+"."+r,qe(i,v,Gq(x)),a.comments.push(v),it(f,-1,"../comments"+l+"."+r,tt.CMNT),g=!0}h["!legacy"]&&g&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",p4(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&qe(i,qT(s),Ks(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,qe(i,s,nq(t.Strings,t)),a.strs.push(s),it(t.wbrels,-1,"sharedStrings."+r,tt.SST)),s="xl/workbook."+r,qe(i,s,pee(e)),a.workbooks.push(s),it(t.rels,1,s,tt.WB),s="xl/theme/theme1.xml",qe(i,s,h4(e.Themes,t)),a.themes.push(s),it(t.wbrels,-1,"theme/theme1.xml",tt.THEME),s="xl/styles."+r,qe(i,s,pq(e,t)),a.styles.push(s),it(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",qe(i,s,e.vbaraw),a.vba.push(s),it(t.wbrels,-1,"vbaProject.bin",tt.VBA)),s="xl/metadata."+r,qe(i,s,Wq()),a.metadata.push(s),it(t.wbrels,-1,"metadata."+r,tt.XLMETA),d.length>1&&(s="xl/persons/person.xml",qe(i,s,x4(d)),a.people.push(s),it(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),qe(i,"[Content_Types].xml",YT(a,t)),qe(i,"_rels/.rels",Ks(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",Ks(t.wbrels)),delete t.revssf,delete t.ssf,i}function Cte(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function F4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gl(t.file,gt.write(e,{type:ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gt.write(e,t)}function kte(e,t){switch(t.bookType){case"ods":return I4(e,t);case"numbers":return yte(e,t);case"xlsb":return jte(e,t);default:return Tte(e,t)}}function Ate(e,t){var r=Dr(t||{}),n=kte(e,r);return Pte(n,r)}function Pte(e,t){var r={},n=ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(l0(a))}return t.password&&typeof encrypt_agile<"u"?F4(encrypt_agile(a,t.password),t):t.type==="file"?Gl(t.file,a):t.type=="string"?Vs(a):a}function Ote(e,t){var r=t||{},n=Hee(e,r);return F4(n,r)}function Qn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ku(xl(n));case"binary":return xl(n);case"string":return e;case"file":return Gl(t.file,n,"utf8");case"buffer":return ot?xa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Qn(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dte(e,t){switch(t.type){case"base64":return DG(e);case"binary":return e;case"string":return e;case"file":return Gl(t.file,e,"binary");case"buffer":return ot?xa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ku(r):t.type=="string"?Vs(r):r;case"file":return Gl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function L4(e,t){OG(),hee(e);var r=Dr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=L4(e,r);return r.type="array",l0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qn($ee(e,r),r);case"slk":case"sylk":return Qn(QY.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return Qn(P4(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Dte(B4(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Qn(zg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Qn(eq.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Dc(JY.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Qn(tq.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Qn(cq(e.Sheets[e.SheetNames[a]]),r);case"eth":return Qn(l4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Qn(I4(e,r),r);case"wk1":return Dc(pN.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Dc(pN.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dc(A4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Ote(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ate(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Ite(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Rte(e,t,r){var n=r||{};return n.type="file",n.file=t,Ite(n),L4(e,n)}function Mte(e,t,r,n,a,i,s){var l=mt(r),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),d=!0,f=e["!data"]!=null,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!f||e["!data"][r])for(var p=t.s.c;p<=t.e.c;++p){var x=f?(e["!data"][r]||[])[p]:e[n[p]+l];if(x==null||x.t===void 0){if(c===void 0)continue;i[p]!=null&&(h[i[p]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!ts(x.z)||(g=Ws(g),typeof g=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(g=ro(new Date(g)));break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(g==null)if(x.t=="e"&&g===null)h[i[p]]=null;else if(c!==void 0)h[i[p]]=c;else if(u&&g===null)h[i[p]]=null;else continue;else h[i[p]]=(x.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:u)?g:Wa(x,g,s);g!=null&&(d=!1)}}return{row:h,isempty:d}}function nm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=St(d);break;case"number":c=St(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=mt(c.s.r),h=[],p=[],x=0,g=0,v=e["!data"]!=null,b=c.s.r,w=0,y={};v&&!e["!data"][b]&&(e["!data"][b]=[]);var N=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(N[w]||{}).hidden)switch(h[w]=ht(w),r=v?e["!data"][b][w]:e[h[w]+f],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=h[w];break;case 3:i[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=Wa(r,null,u),g=y[s]||0,!g)y[s]=1;else{do l=s+"_"+g++;while(y[l]);y[s]=g,y[l]=1}i[w]=l}for(b=c.s.r+a;b<=c.e.r;++b)if(!(S[b]||{}).hidden){var E=Mte(e,c,b,h,n,i,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=E.row)}return p.length=x,p}var TN=/"/g;function Fte(e,t,r,n,a,i,s,l,c){for(var u=!0,d=[],f="",h=mt(r),p=e["!data"]!=null,x=p&&e["!data"][r]||[],g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=p?x[g]:e[n[g]+h];if(v==null)f="";else if(v.v!=null){u=!1,f=""+(c.rawNumbers&&v.t=="n"?v.v:Wa(v,null,c));for(var b=0,w=0;b!==f.length;++b)if((w=f.charCodeAt(b))===a||w===i||w===34||c.forceQuotes){f='"'+f.replace(TN,'""')+'"';break}f=="ID"&&l==0&&d.length==0&&(f='"ID"')}else v.f!=null&&!v.F?(u=!1,f="="+v.f,f.indexOf(",")>=0&&(f='"'+f.replace(TN,'""')+'"')):f="";d.push(f)}if(c.strip)for(;d[d.length-1]==="";)--d.length;return c.blankrows===!1&&u?null:d.join(s)}function zg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=St(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u="",d=[],f=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(d[p]=ht(p));for(var x=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(u=Fte(e,a,g,d,s,c,i,x,n),u!=null&&(u||n.blankrows!==!1)&&r.push((x++?l:"")+u));return r.join("")}function B4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=zg(e,t);return r}function Lte(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=St(e["!ref"]),s="",l=[],c,u=[],d=e["!data"]!=null;for(c=i.s.c;c<=i.e.c;++c)l[c]=ht(c);for(var f=i.s.r;f<=i.e.r;++f)for(s=mt(f),c=i.s.c;c<=i.e.c;++c)if(r=l[c]+s,n=d?(e["!data"][f]||[])[c]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}u[u.length]=r+"="+a}return u}function $4(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var l=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var u=typeof n.origin=="string"?At(n.origin):n.origin;l=u.r,c=u.c}var d={s:{c:0,r:0},e:{c,r:l+t.length-1+i}};if(s["!ref"]){var f=St(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+i)}else l==-1&&(l=0,d.e.r=t.length-1+i);var h=n.header||[],p=0,x=[];t.forEach(function(v,b){a&&!s["!data"][l+b+i]&&(s["!data"][l+b+i]=[]),a&&(x=s["!data"][l+b+i]),Yt(v).forEach(function(w){(p=h.indexOf(w))==-1&&(h[p=h.length]=w);var y=v[w],N="z",S="",E=a?"":ht(c+p)+mt(l+b+i),_=a?x[c+p]:s[E];y&&typeof y=="object"&&!(y instanceof Date)?a?x[c+p]=y:s[E]=y:(typeof y=="number"?N="n":typeof y=="boolean"?N="b":typeof y=="string"?N="s":y instanceof Date?(N="d",n.UTC||(y=f0(y)),n.cellDates||(N="n",y=yr(y)),S=_!=null&&_.z&&ts(_.z)?_.z:n.dateNF||_t[14]):y===null&&n.nullError&&(N="e",y=0),_?(_.t=N,_.v=y,delete _.w,delete _.R,S&&(_.z=S)):a?x[c+p]=_={t:N,v:y}:s[E]=_={t:N,v:y},S&&(_.z=S))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var g=mt(l);if(a&&!s["!data"][l]&&(s["!data"][l]=[]),i)for(p=0;p<h.length;++p)a?s["!data"][l][p+c]={t:"s",v:h[p]}:s[ht(p+c)+g]={t:"s",v:h[p]};return s["!ref"]=qt(d),s}function Bte(e,t){return $4(null,e,t)}function cd(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=At(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?cd(e,Mt(t)):cd(e,ht(r||0)+mt(t))}function $te(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ute(e,t){var r={SheetNames:[],Sheets:{}};return e&&Wg(r,e,t||"Sheet1"),r}function Wg(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var s=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(T4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Hte(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=$te(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function zte(e,t){return e.z=t,e}function U4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Wte(e,t,r){return U4(e,"#"+t,r)}function Vte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Kte(e,t,r,n){for(var a=typeof t!="string"?t:St(t),i=typeof t=="string"?t:qt(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=cd(e,s,l);c.t="n",c.F=i,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}var u=br(e["!ref"]);return u.s.r>a.s.r&&(u.s.r=a.s.r),u.s.c>a.s.c&&(u.s.c=a.s.c),u.e.r<a.e.r&&(u.e.r=a.e.r),u.e.c<a.e.c&&(u.e.c=a.e.c),e["!ref"]=qt(u),e}var am={encode_col:ht,encode_row:mt,encode_cell:Mt,encode_range:qt,decode_col:Ig,decode_row:Dg,split_cell:UX,decode_cell:At,decode_range:br,format_cell:Wa,sheet_new:HX,sheet_add_aoa:zT,sheet_add_json:$4,sheet_add_dom:O4,aoa_to_sheet:go,json_to_sheet:Bte,table_to_sheet:D4,table_to_book:dte,sheet_to_csv:zg,sheet_to_txt:B4,sheet_to_json:nm,sheet_to_html:P4,sheet_to_formulae:Lte,sheet_to_row_object_array:nm,sheet_get_cell:cd,book_new:Ute,book_append_sheet:Wg,book_set_sheet_visibility:Hte,cell_set_number_format:zte,cell_set_hyperlink:U4,cell_set_internal_link:Wte,cell_add_comment:Vte,sheet_set_array_formula:Kte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Vg=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",Gte=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")} VND`:"0 VND",Xte=e=>{if(!e)return null;const t=e.match(/nhan tu\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},_l=e=>Xte(e.note)||e.sender||"",im=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},Yte=[{value:"receipt",label:"Biên Nhận",description:"Mã đơn bắt đầu bằng MAV"},{value:"refund",label:"Hoàn tiền",description:"Các biên nhận khác"}],Fn={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankCode:"VPB"},Fh=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return null;const[,r,n,a]=t.map(Number);return new Date(a,n-1,r).getTime()},qte=e=>{const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return e;const[,r,n,a]=t;return`${a}/${n}/${r}`},Zte=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return"";const[,r,n,a]=t;return`${a}-${n}-${r}`},Jte=e=>{const t=r=>typeof r=="string"?r:"";return{id:Number(e?.id)||0,orderCode:t(e?.orderCode??e?.[_s.orderCode]),paidAt:t(e?.paidAt??e?.[_s.paidDate]),amount:Number(e?.amount??e?.[_s.amount])||0,sender:t(e?.sender??e?.[_s.sender]),receiver:t(e?.receiver??e?.[_s.receiver]),note:t(e?.note??e?.[_s.note])}},Qte=e=>{const t=["#","Mã đơn","Người gửi","Người nhận","Số tiền gốc","Số tiền định dạng","Nội dung chuyển khoản","Ngày thanh toán","Nhóm"],r=e.map((a,i)=>[i+1,a.orderCode||"",_l(a),a.receiver||"",a.amount,Vg(a.amount),a.note||"",a.paidAt?yt(a.paidAt):"",im(a.orderCode)==="receipt"?"Biên nhận":"Hoàn tiền"]),n=am.aoa_to_sheet([t,...r]);return n["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}],n},ere=({stats:e})=>o.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)] relative z-0",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e.map(t=>o.jsx(Ta,{title:t.name,value:t.value,icon:t.icon,accent:t.accent},t.name))})}),tre=({searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:n,dateRangeDisplay:a,rangePickerOpen:i,setRangePickerOpen:s,dateRangeRef:l,toDisplayDate:c,toISODate:u,onDateStartChange:d,onDateEndChange:f,onExport:h,exportDisabled:p,onAddReceipt:x})=>o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.25)] backdrop-blur-sm relative z-10",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1",children:[o.jsx(as,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),o.jsx("input",{type:"text",placeholder:"Tìm mã đơn, người gửi hoặc ghi chú...",className:"w-full pr-4 py-3 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:g=>t(g.target.value)})]}),o.jsxs("div",{className:"flex flex-wrap lg:flex-nowrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsxs("div",{className:"relative",ref:l,children:[o.jsxs("button",{type:"button",onClick:()=>s(!i),className:`flex items-center justify-between gap-3 px-4 py-2.5 rounded-2xl border transition-all text-sm min-w-[200px] ${i?"border-indigo-400/50 bg-indigo-500/20 text-indigo-200":"border-white/10 bg-slate-950/40 text-white hover:bg-white/5"}`,children:[o.jsx("span",{className:"font-medium truncate",children:a}),o.jsx(ON,{className:"w-5 h-5 opacity-70"})]}),i&&o.jsxs("div",{className:"absolute right-0 top-[calc(100%+12px)] w-80 bg-slate-900 border border-white/15 rounded-2xl shadow-2xl z-50 p-5 space-y-4 backdrop-blur-xl",children:[o.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[11px] font-bold text-indigo-300/80 uppercase tracking-widest px-1",children:"Từ Ngày"}),o.jsx("input",{type:"date",className:"w-full bg-slate-950/50 border border-white/10 text-white rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:u(r),onChange:g=>d(g.target.value?c(g.target.value):"")})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-[11px] font-bold text-indigo-300/80 uppercase tracking-widest px-1",children:"Đến Ngày"}),o.jsx("input",{type:"date",className:"w-full bg-slate-950/50 border border-white/10 text-white rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:u(n),onChange:g=>f(g.target.value?c(g.target.value):"")})]})]}),o.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-white/10",children:[o.jsx("button",{className:"text-sm font-medium text-indigo-400 hover:text-indigo-300 transition-colors",onClick:()=>{d(""),f("")},children:"Xóa"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{className:"px-4 py-2 text-xs font-semibold text-white/70 hover:text-white transition-colors",onClick:()=>s(!1),children:"Đóng"}),o.jsx("button",{className:"px-4 py-2 text-xs font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-500 transition-all shadow-lg",onClick:()=>s(!1),children:"Áp Dụng"})]})]})]})]}),o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx(An,{icon:di,onClick:x,className:"!py-2.5 !px-5 text-sm",children:"Thêm biên nhận"}),o.jsx("button",{type:"button",onClick:h,disabled:p,className:`px-5 py-2.5 rounded-2xl text-sm font-semibold transition-all border ${p?"bg-white/5 text-white/30 border-white/5 cursor-not-allowed":"bg-white/5 text-white border-white/10 hover:bg-white/10"}`,children:"Tải Về"})]})]})}),rre=({activeCategory:e,counts:t,onChange:r})=>o.jsx("div",{className:"rounded-[32px] glass-panel-light p-2 border border-white/5 shadow-2xl flex flex-col sm:flex-row gap-2 relative z-10 transition-all duration-500",children:Yte.map(n=>{const a=e===n.value,i=t[n.value];return o.jsxs("button",{type:"button",onClick:()=>r(n.value),className:`group relative flex-1 min-w-[200px] text-left rounded-[26px] px-6 py-5 transition-all duration-500 overflow-hidden ${a?"bg-indigo-600/40 text-white shadow-[0_0_40px_rgba(99,102,241,0.25)] border border-indigo-400/30":"text-indigo-100/60 hover:text-white border border-transparent"}`,children:[a&&o.jsx("div",{className:"absolute -right-8 -top-8 w-24 h-24 bg-indigo-500/20 rounded-full blur-3xl animate-pulse"}),o.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[11px] font-black uppercase tracking-[0.2em] leading-none opacity-80",children:n.label}),o.jsx("p",{className:`text-sm font-bold tracking-tight transition-colors ${a?"text-white":"text-indigo-100/70 group-hover:text-white"}`,children:n.description})]}),o.jsx("div",{className:`text-2xl font-black tracking-tighter ${a?"text-indigo-300":"text-indigo-200/20 group-hover:text-indigo-200/40"}`,children:i.toLocaleString()})]})]},n.value)})}),nre=({receipts:e,expandedReceiptId:t,onToggle:r,onSelectReceipt:n})=>o.jsx("div",{className:"bg-transparent overflow-visible",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full border-separate border-spacing-y-4 text-white",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"[&>th]:px-5 [&>th]:pb-2 [&>th]:text-[11px] [&>th]:font-black [&>th]:uppercase [&>th]:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-left",children:[o.jsx("th",{className:"w-[120px]",children:"MÃ ĐƠN"}),o.jsx("th",{className:"w-[180px]",children:"NGƯỜI GỬI"}),o.jsx("th",{className:"w-[180px]",children:"NGƯỜI NHẬN"}),o.jsx("th",{className:"w-[140px]",children:"SỐ TIỀN"}),o.jsx("th",{children:"NỘI DUNG CHUYỂN KHOẢN"}),o.jsx("th",{className:"w-[150px] text-right pr-6",children:"NGÀY THANH TOÁN"})]})}),o.jsx("tbody",{className:"",children:e.map(a=>{const i=t===a.id;return o.jsxs(la.Fragment,{children:[o.jsxs("tr",{className:"group/row cursor-pointer transition-all duration-500 relative z-10",onClick:()=>r(a.id),onDoubleClick:()=>n?n(a):void 0,children:[o.jsx("td",{className:"px-5 py-5 first:rounded-l-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:o.jsx("span",{className:"text-sm font-bold text-white tracking-wider uppercase",children:a.orderCode||"—"})}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:o.jsx("div",{className:"text-sm font-bold text-white tracking-tight",children:_l(a)||"—"})}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:o.jsx("div",{className:"text-xs font-medium text-white/80",children:a.receiver||Fn.accountNumber})}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:o.jsx("span",{className:"text-sm font-bold text-emerald-400 tracking-tight",children:Vg(a.amount)})}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 max-w-xs",children:o.jsx("span",{className:"block truncate text-[13px] text-white/60 font-medium",children:a.note||"—"})}),o.jsx("td",{className:"px-5 py-5 last:rounded-r-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-right pr-6",children:o.jsx("span",{className:"text-xs font-bold text-indigo-300/80 tracking-tighter",children:a.paidAt?yt(a.paidAt):"—"})})]}),i&&o.jsx("tr",{className:"animate-in fade-in slide-in-from-top-2 duration-300 relative z-0",children:o.jsx("td",{colSpan:6,className:"px-6 pb-8 pt-2",children:o.jsxs("div",{className:"rounded-[32px] glass-panel-light p-6 shadow-2xl border border-indigo-500/20",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Mã đơn hàng"}),o.jsx("p",{className:"text-sm font-black text-white",children:a.orderCode||"—"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Người gửi"}),o.jsx("p",{className:"text-sm font-bold text-white",children:_l(a)||"—"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Người nhận"}),o.jsx("p",{className:"text-sm font-medium text-indigo-200/80",children:Fn.accountNumber})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Ngày thanh toán"}),o.jsx("p",{className:"text-sm font-bold text-indigo-100/90",children:a.paidAt?yt(a.paidAt):"—"})]})]}),o.jsx("div",{className:"mt-6 pt-6 border-t border-white/5",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Nội dung chuyển khoản"}),o.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-slate-950/40 p-4 border border-white/5",children:o.jsxs("p",{className:"text-[13px] font-medium text-indigo-50 leading-relaxed italic",children:['"',a.note||"Không có nội dung ghi chú đi kèm.",'"']})})]})})]})})})]},a.id)})})]})})}),are=({open:e,amount:t,note:r,onClose:n,onAmountChange:a,onNoteChange:i})=>{const[s,l]=m.useState(t),[c,u]=m.useState(r);m.useEffect(()=>{e&&(l(t),u(r))},[e,t,r]);const d=m.useMemo(()=>{const v=s.replace(/[^\d]/g,"");if(!v)return 0;const b=Number(v);return Number.isFinite(b)?b:0},[s]),f=d>0?`${d.toLocaleString("vi-VN")} VND`:"Chưa Cập Nhật",h=m.useMemo(()=>o0({accountNumber:Fn.accountNumber,bankCode:Fn.bankCode,amount:d,description:c.trim(),accountName:Fn.accountHolder}),[d,c]),p=c.trim()||"Chưa có nội dung",x=()=>{const v=s.replace(/[^\d]/g,"");l(v),a(v)},g=()=>{const v=c.trim();u(v),i(v)};return e?o.jsx("div",{className:"fixed inset-0 z-[100] flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:o.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative z-[100]",children:[o.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:n,children:o.jsx(Pt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"px-6 py-10 space-y-6",children:[o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("h2",{className:"text-2xl font-semibold",children:"Tạo thông tin thanh toán qua QR Code"}),o.jsx("p",{className:"text-sm text-slate-300",children:"Quét mã QR để chuyển khoản nhanh. Nhập số tiền và nội dung để cập nhật chi tiết."})]}),o.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[o.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[o.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Quét mã QR để thanh toán"}),o.jsx("div",{className:"rounded-2xl bg-white p-4 relative z-0",children:o.jsx("img",{src:h,alt:"QR thanh toan",className:"h-64 w-64 object-contain relative z-0"})}),o.jsx("a",{href:h,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400 relative z-10",children:"Tải ảnh QR"}),o.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[o.jsxs("p",{children:["Ngân hàng: ",o.jsx("span",{className:"font-semibold",children:Fn.bankName})]}),o.jsxs("p",{children:["Số tài khoản:"," ",o.jsx("span",{className:"font-semibold",children:Fn.accountNumber})]}),o.jsxs("p",{children:["Chủ tài khoản:"," ",o.jsx("span",{className:"font-semibold uppercase",children:Fn.accountHolder})]}),o.jsxs("p",{children:["Số tiền:"," ",o.jsx("span",{className:"font-semibold text-rose-200",children:f})]}),o.jsxs("p",{children:["Nội dung:"," ",o.jsx("span",{className:"font-semibold text-violet-200",children:p})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[o.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[o.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngân hàng"}),o.jsx("p",{className:"text-lg font-semibold text-white",children:Fn.bankName})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[o.jsx("span",{children:"Thụ hưởng"}),o.jsx("span",{className:"font-semibold text-white",children:Fn.accountHolder})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm text-slate-300",children:"Số Tài Khoản"}),o.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:Fn.accountNumber})]})]}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:x,children:"+ Thêm số tiền"}),o.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[o.jsx("input",{type:"text",placeholder:"Ví dụ: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:s,onChange:v=>l(v.target.value),onBlur:x}),o.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:x,children:"OK"})]})]}),o.jsxs("div",{children:[o.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:g,children:"+ Thêm nội dung"}),o.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[o.jsx("input",{type:"text",placeholder:"Nhập nội dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:c,onChange:v=>u(v.target.value),onBlur:g}),o.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:g,children:"Lưu"})]})]})]})]})]})]})]})}):null},ire=({open:e,receipt:t,onClose:r})=>!e||!t?null:o.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 px-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl relative z-[100]",children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tiet bien nhan"}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Đóng",children:o.jsx(Pt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"px-5 py-4 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Mã đơn"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.orderCode||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Ngày Thanh Toán"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.paidAt?yt(t.paidAt):"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Người Gửi"}),o.jsx("p",{className:"font-semibold text-gray-900",children:_l(t)||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Người Nhận"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.receiver||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Số Tiền"}),o.jsx("p",{className:"font-semibold text-gray-900",children:Vg(t.amount)})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Nội Dung Chuyển Khoản"}),o.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:t.note||"Không có ghi chú"})]})]}),o.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"Đóng"})})]})});function sre(){const[e,t]=m.useState(""),[r,n]=m.useState(""),[a,i]=m.useState(""),[s,l]=m.useState("receipt"),[c,u]=m.useState([]),[d,f]=m.useState(!1),[h,p]=m.useState(null),[x,g]=m.useState(!1),[v,b]=m.useState(null),[w,y]=m.useState(!1),[N,S]=m.useState(""),[E,_]=m.useState(""),[j,A]=m.useState(null),T=m.useRef(null);m.useEffect(()=>{(async()=>{try{f(!0),p(null);const le=await Ue("/api/payment-receipts");if(!le.ok)throw new Error("Không thể tải biên nhận.");const ce=await le.json(),me=Array.isArray(ce?.receipts)?ce.receipts:Array.isArray(ce)?ce:[];u(me.map(Jte))}catch(le){console.error(le),p(le instanceof Error?le.message:"Không thể tải biên nhận.")}finally{f(!1)}})()},[]);const k=m.useMemo(()=>{const Z=e.trim().toLowerCase(),le=Fh(r),ce=Fh(a);return c.filter(me=>{const Ne=im(me.orderCode),ee=!Z||[me.orderCode,me.note,_l(me)].map(F=>F?.toLowerCase()??"").some(F=>F.includes(Z)),oe=Fh(yt(me.paidAt)||""),fe=le===null||oe===null||oe>=le,O=ce===null||oe===null||oe<=ce;return ee&&fe&&O&&Ne===s})},[c,e,r,a,s]),C=m.useMemo(()=>{const Z=c.reduce((ce,me)=>(me.orderCode||"").toUpperCase().startsWith("MAV")?ce+me.amount:ce,0),le=c.length>0?c[0].paidAt??"":"";return[{name:"Tổng Biên Nhận",value:c.length.toString(),icon:Ui,accent:vr.sky},{name:"Tổng Số Tiền",value:Gte(Z),icon:Ui,accent:vr.emerald},{name:"Biên Nhận Gần Nhất",value:le?yt(le)??"--":"--",icon:MN,accent:vr.violet}]},[c]),L=m.useMemo(()=>c.reduce((Z,le)=>{const ce=im(le.orderCode);return Z[ce]+=1,Z},{receipt:0,refund:0}),[c]),G=()=>{if(!k.length)return;const Z=Qte(k),le=am.book_new();am.book_append_sheet(le,Z,"Biên nhận thanh toán");const ce=new Date().toISOString().slice(0,10).replace(/-/g,"");Rte(le,`payment_receipts_${ce}.xlsx`)},V=d||k.length===0;m.useEffect(()=>{const Z=le=>{T.current&&!T.current.contains(le.target)&&g(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]);const X=r&&a?`${r} - ${a}`:"dd/mm/yyyy - dd/mm/yyyy",K=Z=>{b(le=>le===Z?null:Z)},Y=Z=>{A(Z)},q=()=>{A(null)};return o.jsxs(o.Fragment,{children:[o.jsx(are,{open:w,amount:N,note:E,onClose:()=>y(!1),onAmountChange:S,onNoteChange:_}),o.jsx(ire,{open:!!j,receipt:j,onClose:q}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("h1",{className:"text-4xl lg:text-5xl font-black text-white tracking-tighter",children:["Biên Nhận ",o.jsx("span",{className:"text-indigo-400",children:"Thanh Toán"})]}),o.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Digital Transaction Records & Ledger"})]}),o.jsx(ere,{stats:C}),o.jsx(tre,{searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:a,dateRangeDisplay:X,rangePickerOpen:x,setRangePickerOpen:g,dateRangeRef:T,toDisplayDate:qte,toISODate:Zte,onDateStartChange:n,onDateEndChange:i,onExport:G,exportDisabled:V,onAddReceipt:()=>y(!0)}),h&&o.jsx("div",{className:"text-sm text-red-600 px-1",children:h}),o.jsx(rre,{activeCategory:s,counts:L,onChange:l}),o.jsx(nre,{receipts:k,expandedReceiptId:v,onToggle:K,onSelectReceipt:Y}),!d&&k.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không có Biên Nhận"}),o.jsx("div",{className:"text-white/60",children:"Thử từ khóa khác"})]}),d&&o.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"Đang tải dữ liệu..."})]})]})}const ore=()=>o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("h1",{className:"text-4xl lg:text-5xl font-black text-white tracking-tighter",children:["Kho ",o.jsx("span",{className:"text-indigo-400",children:"Dữ Liệu"})]}),o.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Central Storage & Inventory Ledger"})]}),lre=({search:e,onSearchChange:t,onCreate:r,loading:n,error:a})=>o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.25)] backdrop-blur-sm relative z-10",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[o.jsxs("div",{className:"relative w-full lg:flex-1 group",children:[o.jsx(as,{className:`absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 transition-opacity duration-300 ${n?"opacity-30":"opacity-70 group-focus-within:opacity-100"}`}),o.jsx("input",{type:"text",placeholder:"Tìm kiếm tài khoản, danh mục, mật khẩu...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:i=>t(i.target.value)}),n&&o.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex gap-1",children:[o.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce"}),o.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce [animation-delay:0.2s]"}),o.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce [animation-delay:0.4s]"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[o.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),o.jsx(An,{onClick:r,disabled:n,className:"!py-2.5 !px-6 text-sm whitespace-nowrap",children:"Tạo mới"})]})]})}),a&&o.jsxs("div",{className:"mx-2 text-sm text-rose-300 flex items-center gap-2 bg-rose-500/10 border border-rose-500/20 px-4 py-2 rounded-xl",children:[o.jsx(fm,{className:"h-5 w-5"}),o.jsx("span",{children:a})]})]}),cre="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",Ic=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),ure=({items:e,draft:t,editingId:r,loading:n,onDraftChange:a,onSave:i,onDelete:s,onCancel:l,onStartEdit:c})=>{const u=(d,f)=>o.jsx("input",{className:`${cre} bg-white/5 border-white/5 focus:bg-white/10 text-white placeholder:text-white/20`,value:f||"",onChange:h=>a(d,h.target.value)});return o.jsx("div",{className:"storage-table bg-transparent overflow-visible",children:o.jsxs("table",{className:"storage-table__table min-w-full border-separate border-spacing-y-4 text-white",children:[o.jsx("thead",{className:"storage-table__head",children:o.jsxs("tr",{className:"storage-table__head-row [&>th]:px-5 [&>th]:pb-2 [&>th]:text-[11px] [&>th]:font-black [&>th]:uppercase [&>th]:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-left",children:[o.jsx("th",{className:"storage-table__th w-[120px]",children:"LOẠI"}),o.jsx("th",{className:"w-[180px]",children:"TÀI KHOẢN"}),o.jsx("th",{className:"w-[140px]",children:"MẬT KHẨU"}),o.jsx("th",{className:"w-[180px]",children:"MAIL DỰ PHÒNG"}),o.jsx("th",{className:"w-[120px]",children:"2FA"}),o.jsx("th",{className:"w-[120px]",children:"TRẠNG THÁI"}),o.jsx("th",{children:"GHI CHÚ"}),o.jsx("th",{className:"w-[140px] text-right pr-6",children:"THAO TÁC"})]})}),o.jsxs("tbody",{className:"",children:[r==="new"&&t&&o.jsxs("tr",{className:"group/row animate-in fade-in slide-in-from-top-2 duration-300 relative z-20",children:[o.jsx("td",{className:"px-5 py-5 first:rounded-l-[24px] glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("category",t.category)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("account",t.account)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("password",t.password)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("backup_email",t.backup_email)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("two_fa",t.two_fa)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("status",t.status)}),o.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:u("note",t.note)}),o.jsx("td",{className:"px-5 py-5 last:rounded-r-[24px] glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500 text-right pr-6",children:o.jsxs("div",{className:"inline-flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"w-9 h-9 flex items-center justify-center rounded-xl bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 hover:bg-emerald-500/40 transition-all",onClick:()=>i(void 0),disabled:n,title:"Lưu",children:o.jsx(Hn,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"w-9 h-9 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all",onClick:l,disabled:n,title:"Hủy",children:o.jsx(Pt,{className:"h-4 w-4"})})]})})]}),e.length===0&&r!=="new"?o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-5 py-12 text-center",children:o.jsx("div",{className:"text-white/40 text-sm font-medium tracking-wide",children:"HỆ THỐNG TRỐNG: KHÔNG CÓ HÀNG TỒN KHO"})})}):e.map(d=>{const f=r===d.id,h=f&&t||d;return o.jsxs("tr",{className:`group/row cursor-pointer transition-all duration-500 relative ${f?"z-20":"z-10"}`,children:[o.jsx("td",{className:`px-5 py-5 first:rounded-l-[24px] glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:f?u("category",h.category):o.jsx("span",{className:"text-sm font-bold text-white tracking-wider uppercase whitespace-nowrap",children:d.category||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:o.jsx("div",{className:"text-sm font-bold text-white tracking-tight",children:f?u("account",h.account):d.account||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:o.jsx("div",{className:"text-[13px] font-medium text-white/80",children:f?u("password",h.password):d.password||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:o.jsx("div",{className:"text-[13px] font-medium text-white/60 italic",children:f?u("backup_email",h.backup_email):d.backup_email||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:f?u("two_fa",h.two_fa):o.jsx("span",{className:"text-xs font-black text-indigo-400/80",children:d.two_fa||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:f?u("status",h.status):o.jsx("span",{className:"inline-flex px-2.5 py-1 rounded-full border border-white/10 bg-white/5 text-[10px] font-bold uppercase tracking-wider text-indigo-200 whitespace-nowrap",children:d.status||"—"})}),o.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:o.jsx("div",{className:"text-[12px] font-medium text-white/60 max-w-xs truncate",children:f?u("note",h.note):d.note||"—"})}),o.jsx("td",{className:`px-5 py-5 last:rounded-r-[24px] glass-panel border-y transition-all duration-500 text-right pr-6 ${f?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:o.jsx("div",{className:"inline-flex items-center gap-2",children:f?o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 hover:bg-emerald-500/40 transition-all",onClick:()=>i(d.id),disabled:n,title:"Lưu",children:o.jsx(Hn,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/20 border border-rose-500/40 text-rose-400 hover:bg-rose-500/40 transition-all",onClick:()=>s(d.id),disabled:n,title:"Xoá",children:o.jsx(Kr,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all",onClick:l,disabled:n,title:"Hủy",children:o.jsx(Pt,{className:"h-4 w-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-indigo-300/60 hover:text-white hover:bg-indigo-500/20 transition-all",onClick:()=>c(d),disabled:n,title:"Sửa",children:o.jsx(is,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500/30 transition-all",onClick:()=>s(d.id),disabled:n,title:"Xoá",children:o.jsx(Kr,{className:"h-4 w-4"})})]})})})]},d.id??`${d.category??""}-${d.account??""}`)})]})]})})};function dre(){const[e,t]=m.useState([]),[r,n]=m.useState(!1),[a,i]=m.useState(null),[s,l]=m.useState(""),[c,u]=m.useState(null),[d,f]=m.useState(null);m.useEffect(()=>{let y=!0;const N=E=>E?Array.isArray(E)?E:Array.isArray(E.items)?E.items:[]:[];return(async()=>{n(!0),i(null);try{let E=await Ue(Je.WAREHOUSE);if(E.status===404&&(E=await Ue("/api/warehouses")),!E.ok)throw new Error(`Không thể tải dữ liệu (${E.status})`);const _=await E.json(),j=N(_);y&&t(j)}catch(E){y&&i(E?.message||"Lỗi không xác định")}finally{y&&n(!1)}})(),()=>{y=!1}},[]);const h=y=>{u(y.id??null),f({...y})},p=()=>{u(null),f(null)},x=(y,N)=>{f(S=>({...S||{},[y]:N}))},g=async y=>{if(!(!y&&c!=="new"||!d)){n(!0),i(null);try{if(c==="new"){const N=await Ue(Je.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!N.ok)throw new Error(`Tạo mới thất bại (${N.status})`);const S=await N.json();t(E=>[...E,S]),p()}else{const N=await Ue(`${Je.WAREHOUSE}/${y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!N.ok)throw new Error(`Cập nhật thất bại (${N.status})`);const S=await N.json();t(E=>E.map(_=>_.id===y?{..._,...S}:_)),p()}}catch(N){i(N?.message||"Lỗi khi cập nhật")}finally{n(!1)}}},v=async y=>{if(y&&confirm("Bạn có chắc muốn xóa bản ghi này?")){n(!0),i(null);try{const N=await Ue(`${Je.WAREHOUSE}/${y}`,{method:"DELETE"});if(!N.ok)throw new Error(`Xoá thất bại (${N.status})`);t(S=>S.filter(E=>E.id!==y)),c===y&&p()}catch(N){i(N?.message||"Lỗi khi xóa")}finally{n(!1)}}},b=()=>{u("new"),f({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Tồn"})},w=m.useMemo(()=>({filtered:e.filter(N=>{if(!s.trim())return!0;const S=Ic(s);return[N.category,N.account,N.password,N.backup_email,N.two_fa,N.note,N.status].some(E=>Ic(E).includes(S))}).sort((N,S)=>{const E=Ic(N.category),_=Ic(S.category);return E.localeCompare(_,"vi")})}),[e,s]);return o.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[o.jsx(ore,{}),o.jsx(lre,{search:s,onSearchChange:l,onCreate:b,loading:r,error:a}),o.jsx(ure,{items:w.filtered,draft:d,editingId:c,loading:r,onDraftChange:x,onSave:g,onDelete:v,onCancel:p,onStartEdit:h,onStartCreate:b})]})}const fre={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};class hre extends m.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r});try{const n=fre?.VITE_API_BASE_URL||"http://localhost:3001";fetch(`${n}/api/error-report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t?.message||String(t),stack:t?.stack,url:window.location.href,extra:r?.componentStack?.slice(0,200)})}).catch(()=>{})}catch{}}handleReload=()=>{window.location.reload()};render(){return this.state.hasError?o.jsx("div",{className:"error-boundary min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-red-100 p-4",children:o.jsxs("div",{className:"error-boundary__container max-w-2xl w-full bg-white rounded-lg shadow-xl p-8",children:[o.jsx("div",{className:"error-boundary__icon-wrap flex items-center justify-center w-16 h-16 mx-auto bg-red-100 rounded-full mb-4",children:o.jsx("svg",{className:"error-boundary__icon w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h1",{className:"error-boundary__title text-2xl font-bold text-gray-900 text-center mb-2",children:"Đã xảy ra lỗi"}),o.jsx("p",{className:"error-boundary__message text-gray-600 text-center mb-6",children:"Ứng dụng gặp sự cố không mong muốn. Vui lòng thử tải lại trang."}),!1,o.jsxs("div",{className:"error-boundary__actions flex gap-4 justify-center",children:[o.jsx("button",{onClick:this.handleReload,className:"error-boundary__btn error-boundary__btn--reload px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Tải lại trang"}),o.jsx("button",{onClick:()=>window.history.back(),className:"error-boundary__btn error-boundary__btn--back px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Quay lại"})]})]})}):this.props.children}}const pre=()=>{const[e,t]=m.useState(!1),[r,n]=m.useState(null);if(m.useEffect(()=>{const c=u=>{n(u.detail),t(!0)};return window.addEventListener($p,c),()=>{window.removeEventListener($p,c)}},[]),!e||!r)return null;const{title:a="Thông báo",message:i,type:s="info"}=r,l=s==="success"?"from-emerald-600/90 via-emerald-700/90 to-emerald-900/95 border-emerald-300/40":s==="error"?"from-rose-600/90 via-rose-700/90 to-rose-900/95 border-rose-300/40":"from-slate-800/95 via-indigo-900/95 to-slate-950/95 border-white/20";return o.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:o.jsxs("div",{className:`w-full max-w-md mx-4 transform transition-all duration-300 rounded-2xl border ${l} p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur-xl`,children:[o.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-3",children:a}),o.jsx("p",{className:"text-sm text-white/90 mb-6 whitespace-pre-line",children:i}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 rounded-md bg-white/10 hover:bg-white/15 text-sm font-semibold text-white border border-white/30 transition-colors",children:"Đóng"})})]})})};function mre({children:e}){const{user:t,loading:r}=om(),n=sm();return r?null:t?o.jsx(o.Fragment,{children:e}):o.jsx(Lh,{to:"/login",replace:!0,state:{from:n.pathname}})}function xre(){const[e,t]=m.useState(!1);return o.jsx(hre,{children:o.jsx(K4,{children:o.jsx(aC,{children:o.jsxs(o.Fragment,{children:[o.jsx(pre,{}),o.jsxs(Gg,{children:[o.jsx(Yr,{path:"/login",element:o.jsx(KK,{})}),o.jsx(Yr,{path:"/*",element:o.jsx(mre,{children:o.jsxs("div",{className:"min-h-screen app-aurora",children:[o.jsx(wk,{isOpen:e,setIsOpen:t}),o.jsxs("div",{className:"transition-all duration-500 ease-in-out lg:ml-72 min-h-screen flex flex-col",children:[!e&&o.jsx("div",{className:"lg:hidden fixed top-6 left-6 z-40 animate-in fade-in duration-500",children:o.jsxs("button",{onClick:()=>t(!0),className:"p-3 rounded-2xl glass-panel-light border border-white/10 text-white shadow-2xl backdrop-blur-xl",children:[o.jsx("span",{className:"sr-only",children:"Open sidebar"}),o.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})]})}),o.jsx("main",{className:"flex-1 px-6 pt-4 pb-12 overflow-x-hidden",children:o.jsx("div",{className:"max-w-[1600px] mx-auto animate-in fade-in slide-in-from-bottom-4 duration-700",children:o.jsxs(Gg,{children:[o.jsx(Yr,{path:"/",element:o.jsx(Lh,{to:"/dashboard",replace:!0})}),o.jsx(Yr,{path:"/dashboard",element:o.jsx(bW,{})}),o.jsx(Yr,{path:"/orders",element:o.jsx(oV,{})}),o.jsx(Yr,{path:"/package-products",element:o.jsx(OV,{})}),o.jsx(Yr,{path:"/product-info",element:o.jsx(gK,{})}),o.jsx(Yr,{path:"/sources",element:o.jsx(cG,{})}),o.jsx(Yr,{path:"/pricing",element:o.jsx(UK,{})}),o.jsx(Yr,{path:"/bill-order",element:o.jsx(PG,{})}),o.jsx(Yr,{path:"/show-price",element:o.jsx(NG,{})}),o.jsx(Yr,{path:"/invoices",element:o.jsx(sre,{})}),o.jsx(Yr,{path:"/warehouse",element:o.jsx(dre,{})}),o.jsx(Yr,{path:"*",element:o.jsx(Lh,{to:"/dashboard",replace:!0})})]})})})]})]})})})]})]})})})})}const gre={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},H4=(e,t)=>{try{const r=gre?.VITE_API_BASE_URL||"http://localhost:3001";fetch(`${r}/api/error-report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,stack:t,url:window.location.href})}).catch(()=>{})}catch{}};window.onerror=(e,t,r,n,a)=>{a&&H4(a.message,a.stack)};window.onunhandledrejection=e=>{const t=e.reason;H4(t?.message||String(t),t?.stack)};q4.createRoot(document.getElementById("root")).render(o.jsx(xre,{}));
