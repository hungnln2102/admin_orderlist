import{r as mu,a as YT,b as p,L as yx,u as Bh,g as ri,c as XT,R as qT,d as ZT,e as ea,f as Qb,B as JT,h as bx,i as Xr,N as Cf}from"./vendor-U6qJKQZV.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var xd={exports:{}},Gs={};var wx;function QT(){if(wx)return Gs;wx=1;var e=mu(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,c,d){var u,f={},h=null,m=null;d!==void 0&&(h=""+d),c.key!==void 0&&(h=""+c.key),c.ref!==void 0&&(m=c.ref);for(u in c)n.call(c,u)&&!i.hasOwnProperty(u)&&(f[u]=c[u]);if(l&&l.defaultProps)for(u in c=l.defaultProps,c)f[u]===void 0&&(f[u]=c[u]);return{$$typeof:t,type:l,key:h,ref:m,props:f,_owner:a.current}}return Gs.Fragment=r,Gs.jsx=s,Gs.jsxs=s,Gs}var Nx;function eC(){return Nx||(Nx=1,xd.exports=QT()),xd.exports}var o=eC(),xl={},_x;function tC(){if(_x)return xl;_x=1;var e=YT();return xl.createRoot=e.createRoot,xl.hydrateRoot=e.hydrateRoot,xl}var rC=tC();function nC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const $h=p.forwardRef(nC);function aC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const iC=p.forwardRef(aC);function sC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const Uh=p.forwardRef(sC);function oC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const lC=p.forwardRef(oC);function cC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const Hh=p.forwardRef(cC);function uC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const Wh=p.forwardRef(uC);function dC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const wo=p.forwardRef(dC);function fC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"}))}const hC=p.forwardRef(fC);function mC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const pC=p.forwardRef(mC);function xC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const gC=p.forwardRef(xC);function vC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const ew=p.forwardRef(vC);function yC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const tw=p.forwardRef(yC);function bC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ms=p.forwardRef(bC);function wC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Ga=p.forwardRef(wC);function NC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const rw=p.forwardRef(NC);function _C({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const SC=p.forwardRef(_C);function EC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Kh=p.forwardRef(EC);function TC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const CC=p.forwardRef(TC);function jC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const gd=p.forwardRef(jC);function AC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const zh=p.forwardRef(AC);function kC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Ts=p.forwardRef(kC);function PC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const OC=p.forwardRef(PC);function DC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const RC=p.forwardRef(DC);function IC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const Bi=p.forwardRef(IC);function FC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const nw=p.forwardRef(FC);function MC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const LC=p.forwardRef(MC);function BC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const zo=p.forwardRef(BC);function $C({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const ps=p.forwardRef($C);function UC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Vh=p.forwardRef(UC);function HC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const ta=p.forwardRef(HC);function WC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const aw=p.forwardRef(WC);function KC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const Sx=p.forwardRef(KC);function zC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0 0 12 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 0 1-2.031.352 5.988 5.988 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971Zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 0 1-2.031.352 5.989 5.989 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971Z"}))}const VC=p.forwardRef(zC);function GC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const Gh=p.forwardRef(GC);function YC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Na=p.forwardRef(YC);function XC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const qC=p.forwardRef(XC);function ZC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const JC=p.forwardRef(ZC);function QC({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 0 0-2.25-2.25H15a3 3 0 1 1-6 0H5.25A2.25 2.25 0 0 0 3 12m18 0v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 9m18 0V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v3"}))}const ej=p.forwardRef(QC);function tj({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const iw=p.forwardRef(tj);function rj({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Dt=p.forwardRef(rj);var nj={};const aj=(()=>{const e=typeof import.meta<"u"?"https://admin.mavrykpremium.store":"";if(e)return e;const t=typeof process<"u"&&nj?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function ij(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const pu=ij(aj),sj=e=>{if(e.startsWith("http"))return e;const t=pu.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Ze(e,t){const r=sj(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(a){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw a}}async function oj(e=new Date().getFullYear()){const t=await Ze(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Không thể tải dữ liệu biểu đồ dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],a=l=>{const c=l.month||l.month_label||(Number.isFinite(l.month_num)?`T${l.month_num}`:"");return String(c||"").trim()},i=n.map(l=>({month:a(l),total_sales:Number(l.total_revenue??l.total_sales)||0})),s=n.map(l=>({month:a(l),total_orders:Number(l.total_orders)||0,total_canceled:Number(l.total_canceled)||0}));return{revenueData:i,orderStatusData:s,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function lj(){const e=await Ze("/api/dashboard/years");if(!e.ok)throw new Error("Lỗi khi tải danh sách năm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const sw=p.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),Yh=()=>p.useContext(sw),cj=({children:e})=>{const[t,r]=p.useState(null),[n,a]=p.useState(!0),i=async()=>{try{const s=await Ze("/api/auth/me");if(!s.ok){r(null);return}const l=await s.json();r(l.user||null)}catch{r(null)}finally{a(!1)}};return p.useEffect(()=>{i()},[]),o.jsx(sw.Provider,{value:{user:t,setUser:r,loading:n,refresh:i},children:e})},Ex=[{title:"Tổng Quan",items:[{name:"Tổng Quan",href:"/dashboard",icon:tw}]},{title:"Sản Phẩm",items:[{name:"Đơn Hàng",href:"/orders",icon:Gh},{name:"Gói Sản Phẩm",href:"/package-products",icon:SC},{name:"Bảng Giá",href:"/pricing",icon:Kh},{name:"Thông Tin Sản Phẩm",href:"/product-info",icon:RC}]},{title:"Cung Cấp",items:[{name:"Nhà Cung Cấp",href:"/sources",icon:CC},{name:"Báo Giá",href:"/show-price",icon:gd},{name:"Hóa Đơn",href:"/bill-order",icon:gd},{name:"Biên Lai",href:"/invoices",icon:gd},{name:"Lô Hàng",href:"/warehouse",icon:$h}]}],Tx=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,a])=>`${n}=${a}`).sort().join("&")},vd=(e,t,r)=>{const[n,a]=r.split("?"),i=a?`?${a}`:"";return e!==n?!1:Tx(t)===Tx(i)},uj=({section:e,isStaticSection:t,isOpenSection:r,currentPath:n,currentSearch:a,onToggle:i,onNavigate:s})=>{const l=e.items.some(c=>n===c.href||vd(n,a,c.href));return o.jsx("div",{className:`w-full rounded-2xl border border-white/10 bg-white/5 shadow-[0_10px_30px_-12px_rgba(0,0,0,0.45)] backdrop-blur-sm mb-3 ${l?"ring-2 ring-indigo-500/40":""}`,children:t?o.jsx("div",{className:"space-y-1 px-2 py-1",children:e.items.map(c=>{const d=n===c.href||vd(n,a,c.href);return o.jsx("div",{className:"space-y-2",children:o.jsxs(yx,{to:c.href,onClick:s,className:`
                    group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                    ${d?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                  `,children:[o.jsx(c.icon,{className:`h-5 w-5 transition-colors ${d?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{type:"button",onClick:()=>i(e.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[o.jsx("span",{children:e.title}),o.jsx(rw,{className:`h-4 w-4 transition-transform ${r?"rotate-180":""}`})]}),r&&o.jsx("div",{className:"space-y-1 px-2.5 py-2",children:e.items.map(c=>{const d=n===c.href||vd(n,a,c.href);return o.jsx("div",{className:"space-y-2",children:o.jsxs(yx,{to:c.href,onClick:s,className:`
                        group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                        ${d?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                      `,children:[o.jsx(c.icon,{className:`h-5 w-5 transition-colors ${d?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})})]})})},dj=({user:e,onLogout:t,onChangePassword:r})=>{const[n,a]=p.useState(!1);return o.jsxs("div",{className:"relative p-4 border-t border-white/10 bg-white/5 backdrop-blur-sm",children:[o.jsxs("div",{className:"w-full flex items-center justify-between",children:[o.jsxs("button",{type:"button",onClick:()=>a(i=>!i),className:"flex items-center flex-1",children:[o.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center shadow-md shadow-indigo-900/40",children:o.jsx("span",{className:"text-white text-sm font-bold tracking-wide",children:(e?.username||"A").slice(0,1).toUpperCase()})}),o.jsxs("div",{className:"ml-3 flex-1 text-left",children:[o.jsx("p",{className:"text-sm font-semibold text-white truncate",children:e?.username||"Tài Khoản"}),o.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:e?.role?`Role: ${e.role}`:"Chưa đăng nhập"})]})]}),o.jsx("button",{type:"button",onClick:t,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"Đăng Xuất",children:o.jsx(lC,{className:"h-5 w-5"})})]}),n&&o.jsx("div",{className:"absolute bottom-16 left-4 right-4 rounded-lg border border-white/15 bg-[#0f1432] shadow-2xl shadow-black/40 z-10",children:o.jsx("ul",{className:"py-2 text-sm text-indigo-50 space-y-1",children:["Thông Tin","Thông Tin Admin","Thông Tin Quản Lý","Thay Đổi Mật Khẩu"].map((i,s)=>o.jsx("li",{children:o.jsx("button",{type:"button",className:"w-full text-left px-4 py-2 hover:bg-white/10",onClick:()=>{a(!1),s===3&&r()},children:i})},i))})})]})},fj=({isOpen:e,onClose:t})=>{const[r,n]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,i]=p.useState(null),[s,l]=p.useState(null),[c,d]=p.useState(!1),u=()=>{n({currentPassword:"",newPassword:"",confirmPassword:""}),i(null),l(null)};p.useEffect(()=>{e&&u()},[e]);const f=()=>{t(),u()},h=async m=>{if(m.preventDefault(),i(null),l(null),!r.currentPassword||!r.newPassword||!r.confirmPassword){i("Vui lòng nhập đủ thông tin.");return}if(r.newPassword!==r.confirmPassword){i("Mật khẩu mới không khớp.");return}d(!0);try{const x=await Ze("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:r.currentPassword,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!x.ok){const g=await x.json().catch(()=>null);i(g?.error||"Không thay đổi được mật khẩu.");return}l("Thay đổi mật khẩu thành công."),n({currentPassword:"",newPassword:"",confirmPassword:""})}catch{i("Không thay đổi được mật khẩu.")}finally{d(!1)}};return e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 px-4",onClick:f,children:o.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Thay đổi mật khẩu"}),o.jsx("button",{type:"button",onClick:f,className:"text-white/70 hover:text-white transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-indigo-400/60","aria-label":"Đóng",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Mật khẩu cũ"}),o.jsx("input",{type:"password",autoComplete:"current-password",value:r.currentPassword,onChange:m=>n(x=>({...x,currentPassword:m.target.value})),placeholder:"Nhập mật khẩu cũ",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Mật khẩu mới"}),o.jsx("input",{type:"password",autoComplete:"new-password",value:r.newPassword,onChange:m=>n(x=>({...x,newPassword:m.target.value})),placeholder:"Nhập mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),o.jsxs("label",{className:"block text-sm text-indigo-100",children:[o.jsx("span",{children:"Nhập lại mật khẩu mới"}),o.jsx("input",{type:"password",autoComplete:"new-password",value:r.confirmPassword,onChange:m=>n(x=>({...x,confirmPassword:m.target.value})),placeholder:"Nhập lại mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),a&&o.jsx("p",{className:"text-sm text-rose-300",children:a}),s&&o.jsx("p",{className:"text-sm text-emerald-200",children:s}),o.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:f,disabled:c,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:"Hủy bỏ"}),o.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 rounded-md bg-indigo-500 text-white hover:bg-indigo-600 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang xử lý...":"Xác nhận"})]})]})]})}):null};function hj({isOpen:e,setIsOpen:t}){const r=Bh(),{user:n,setUser:a}=Yh(),[i,s]=p.useState(()=>Object.fromEntries(Ex.map(m=>[m.title,!0]))),[l,c]=p.useState(!1),d=m=>{s(x=>({...x,[m]:!x[m]}))},u=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{a(null),window.location.href="/login"}},f=()=>{c(!0)},h=()=>{c(!1)};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:o.jsx("button",{onClick:()=>t(!e),className:"bg-white p-2 rounded-lg shadow-lg border border-gray-200",children:e?o.jsx(Dt,{className:"h-6 w-6 text-gray-600"}):o.jsx(pC,{className:"h-6 w-6 text-gray-600"})})}),e&&o.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>t(!1)}),o.jsx("div",{className:`
          fixed top-0 left-0 z-40 w-64 h-full bg-gradient-to-b from-[#0c1230] via-[#141a3c] to-[#0a0e24] shadow-2xl border-r border-white/10
          transform transition-transform duration-300 ease-in-out
          ${e?"translate-x-0":"-translate-x-full"}
          lg:translate-x-0
        `,children:o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsx("div",{className:"px-4 pt-6 pb-4",children:o.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 px-4 py-3 shadow-lg shadow-indigo-900/50 text-center border border-white/10",children:[o.jsx("h1",{className:"text-lg font-bold text-white tracking-wide",children:"Admin Orderlist"}),o.jsx("p",{className:"text-[11px] text-indigo-100/90 mt-1 font-medium uppercase tracking-[0.08em]",children:"Control Panel"})]})}),o.jsx("nav",{className:"flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:Ex.map((m,x)=>o.jsx(uj,{section:m,isStaticSection:x===0,isOpenSection:i[m.title]??!0,currentPath:r.pathname,currentSearch:r.search,onToggle:d,onNavigate:()=>t(!1)},m.title))}),o.jsx(dj,{user:n,onLogout:u,onChangePassword:f})]})}),o.jsx(fj,{isOpen:l,onClose:h})]})}const mj=({title:e,value:t,delta:r,trend:n,accent:a,icon:i})=>{const s=a==="amber"?{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"}:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"},l=n==="up"?Wh:Hh;return o.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4 bg-white/70 border border-white/40 shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`h-10 w-10 rounded-xl ${s.iconBg} flex items-center justify-center`,children:o.jsx(i,{className:"h-5 w-5"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:e}),o.jsx("p",{className:"text-xl font-bold text-white",children:t})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-semibold ${s.chip}`,children:[o.jsx(l,{className:"h-3.5 w-3.5"}),r]})})]})},pj=({loading:e,error:t,rows:r,onRefresh:n})=>o.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/60 via-slate-700/50 to-slate-900/60 p-6 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.75),0_14px_36px_-24px_rgba(255,255,255,0.2)]",children:[o.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Bảng giá HanaGold"}),o.jsx("p",{className:"text-xs text-white/70",children:"Mua/Bán theo ngày"})]}),o.jsx("button",{type:"button",onClick:n,className:"rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20 border border-white/20",children:"Làm mới"})]}),t&&o.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/60 bg-amber-50/10 px-3 py-2 text-sm text-amber-200",children:t}),o.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:o.jsxs("table",{className:"min-w-full text-sm text-white",children:[o.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-left",children:"Mục"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Mua"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng tiền mua vàng"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng vàng (chỉ)"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Lợi nhuận"}),o.jsx("th",{className:"px-3 py-2 text-right",children:"Bán"}),o.jsx("th",{className:"px-3 py-2 text-center",children:"Xu hướng"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/10",children:[e&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Đang tải giá vàng..."})}),!e&&r.length===0&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Chưa có dữ liệu."})}),!e&&r.map((a,i)=>o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 font-semibold",children:a.displayName||"Không tên"}),o.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.bid/10).toLocaleString("vi-VN")," đ"]}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldValue!==void 0?a.totalGoldValue.toLocaleString("vi-VN"):"—"}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldAmount!==void 0?a.totalGoldAmount.toFixed(4):"—"}),o.jsx("td",{className:"px-3 py-2 text-right",children:a.profit!==void 0?a.profit.toLocaleString("vi-VN"):"—"}),o.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.ask/10).toLocaleString("vi-VN")," đ"]}),o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-[11px] font-semibold ${a.trendBid==="up"?"bg-emerald-500/20 text-emerald-200":a.trendBid==="down"?"bg-rose-500/20 text-rose-200":"bg-white/10 text-white/80"}`,children:a.trendBid==="up"?"Tăng":a.trendBid==="down"?"Giảm":"Ổn định"})})]},`${a.displayName}-${a.time}-${i}`))]})]})})]});function ow(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=ow(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ct(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=ow(e))&&(n&&(n+=" "),n+=t);return n}var xj=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Xh(e){if(typeof e!="string")return!1;var t=xj;return t.includes(e)}var gj=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function lw(e){if(typeof e!="string")return!1;var t=gj;return t.includes(e)}function cw(e){return typeof e=="string"&&e.startsWith("data-")}function xn(e){var t=Object.entries(e).filter(r=>{var[n]=r;return lw(n)||cw(n)});return Object.fromEntries(t)}function Ei(e){if(e==null)return null;if(p.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return xn(t)}return typeof e=="object"&&!Array.isArray(e)?xn(e):null}function zr(e){var t=Object.entries(e).filter(r=>{var[n]=r;return lw(n)||cw(n)||Xh(n)});return Object.fromEntries(t)}function vj(e){return e==null?null:p.isValidElement(e)?zr(e.props):typeof e=="object"&&!Array.isArray(e)?zr(e):null}var yj=["children","width","height","viewBox","className","style","title","desc"];function jf(){return jf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jf.apply(null,arguments)}function bj(e,t){if(e==null)return{};var r,n,a=wj(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uw=p.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:c,desc:d}=e,u=bj(e,yj),f=i||{width:n,height:a,x:0,y:0},h=ct("recharts-surface",s);return p.createElement("svg",jf({},zr(u),{className:h,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),p.createElement("title",null,c),p.createElement("desc",null,d),r)}),Nj=["children","className"];function Af(){return Af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Af.apply(null,arguments)}function _j(e,t){if(e==null)return{};var r,n,a=Sj(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Sj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vr=p.forwardRef((e,t)=>{var{children:r,className:n}=e,a=_j(e,Nj),i=ct("recharts-layer",n);return p.createElement("g",Af({className:i},zr(a),{ref:t}),r)}),Ej=p.createContext(null);function bt(e){return function(){return e}}const dw=Math.cos,ac=Math.sin,Un=Math.sqrt,ic=Math.PI,xu=2*ic,kf=Math.PI,Pf=2*kf,fi=1e-6,Tj=Pf-fi;function fw(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Cj(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return fw;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class jj{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?fw:Cj(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,d=a-r,u=s-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>fi)if(!(Math.abs(f*c-d*u)>fi)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-s,x=a-l,g=c*c+d*d,v=m*m+x*x,y=Math.sqrt(g),b=Math.sqrt(h),w=i*Math.tan((kf-Math.acos((g+h-v)/(2*y*b)))/2),N=w/b,_=w/y;Math.abs(N-1)>fi&&this._append`L${t+N*u},${r+N*f}`,this._append`A${i},${i},0,0,${+(f*m>u*x)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>fi||Math.abs(this._y1-u)>fi)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%Pf+Pf),h>Tj?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>fi&&this._append`A${n},${n},0,${+(h>=kf)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function qh(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new jj(t)}function Zh(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function hw(e){this._context=e}hw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function gu(e){return new hw(e)}function mw(e){return e[0]}function pw(e){return e[1]}function xw(e,t){var r=bt(!0),n=null,a=gu,i=null,s=qh(l);e=typeof e=="function"?e:e===void 0?mw:bt(e),t=typeof t=="function"?t:t===void 0?pw:bt(t);function l(c){var d,u=(c=Zh(c)).length,f,h=!1,m;for(n==null&&(i=a(m=s())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,d,c),+t(f,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:bt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:bt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:bt(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function gl(e,t,r){var n=null,a=bt(!0),i=null,s=gu,l=null,c=qh(d);e=typeof e=="function"?e:e===void 0?mw:bt(+e),t=typeof t=="function"?t:bt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?pw:bt(+r);function d(f){var h,m,x,g=(f=Zh(f)).length,v,y=!1,b,w=new Array(g),N=new Array(g);for(i==null&&(l=s(b=c())),h=0;h<=g;++h){if(!(h<g&&a(v=f[h],h,f))===y)if(y=!y)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=h-1;x>=m;--x)l.point(w[x],N[x]);l.lineEnd(),l.areaEnd()}y&&(w[h]=+e(v,h,f),N[h]=+t(v,h,f),l.point(n?+n(v,h,f):w[h],r?+r(v,h,f):N[h]))}if(b)return l=null,b+""||null}function u(){return xw().defined(a).curve(s).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:bt(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:bt(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:bt(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:bt(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:bt(!!f),d):a},d.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),d):s},d.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),d):i},d}class gw{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Aj(e){return new gw(e,!0)}function kj(e){return new gw(e,!1)}const Jh={draw(e,t){const r=Un(t/ic);e.moveTo(r,0),e.arc(0,0,r,0,xu)}},Pj={draw(e,t){const r=Un(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},vw=Un(1/3),Oj=vw*2,Dj={draw(e,t){const r=Un(t/Oj),n=r*vw;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Rj={draw(e,t){const r=Un(t),n=-r/2;e.rect(n,n,r,r)}},Ij=.8908130915292852,yw=ac(ic/10)/ac(7*ic/10),Fj=ac(xu/10)*yw,Mj=-dw(xu/10)*yw,Lj={draw(e,t){const r=Un(t*Ij),n=Fj*r,a=Mj*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=xu*i/5,l=dw(s),c=ac(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},yd=Un(3),Bj={draw(e,t){const r=-Un(t/(yd*3));e.moveTo(0,r*2),e.lineTo(-yd*r,-r),e.lineTo(yd*r,-r),e.closePath()}},yn=-.5,bn=Un(3)/2,Of=1/Un(12),$j=(Of/2+1)*3,Uj={draw(e,t){const r=Un(t/$j),n=r/2,a=r*Of,i=n,s=r*Of+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(yn*n-bn*a,bn*n+yn*a),e.lineTo(yn*i-bn*s,bn*i+yn*s),e.lineTo(yn*l-bn*c,bn*l+yn*c),e.lineTo(yn*n+bn*a,yn*a-bn*n),e.lineTo(yn*i+bn*s,yn*s-bn*i),e.lineTo(yn*l+bn*c,yn*c-bn*l),e.closePath()}};function Hj(e,t){let r=null,n=qh(a);e=typeof e=="function"?e:bt(e||Jh),t=typeof t=="function"?t:bt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:bt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:bt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function sc(){}function oc(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function bw(e){this._context=e}bw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:oc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Wj(e){return new bw(e)}function ww(e){this._context=e}ww.prototype={areaStart:sc,areaEnd:sc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Kj(e){return new ww(e)}function Nw(e){this._context=e}Nw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zj(e){return new Nw(e)}function _w(e){this._context=e}_w.prototype={areaStart:sc,areaEnd:sc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Vj(e){return new _w(e)}function Cx(e){return e<0?-1:1}function jx(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(Cx(i)+Cx(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function Ax(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function bd(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function lc(e){this._context=e}lc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bd(this,this._t0,Ax(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,bd(this,Ax(this,r=jx(this,e,t)),r);break;default:bd(this,this._t0,r=jx(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Sw(e){this._context=new Ew(e)}(Sw.prototype=Object.create(lc.prototype)).point=function(e,t){lc.prototype.point.call(this,t,e)};function Ew(e){this._context=e}Ew.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function Gj(e){return new lc(e)}function Yj(e){return new Sw(e)}function Tw(e){this._context=e}Tw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=kx(e),a=kx(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function kx(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Xj(e){return new Tw(e)}function vu(e,t){this._context=e,this._t=t}vu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function qj(e){return new vu(e,.5)}function Zj(e){return new vu(e,0)}function Jj(e){return new vu(e,1)}function xs(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Df(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Qj(e,t){return e[t]}function eA(e){const t=[];return t.key=e,t}function tA(){var e=bt([]),t=Df,r=xs,n=Qj;function a(i){var s=Array.from(e.apply(this,arguments),eA),l,c=s.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(s[l][d]=[0,+n(f,s[l].key,d,i)]).data=f;for(l=0,u=Zh(t(s));l<c;++l)s[u[l]].index=l;return r(s,u),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:bt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:bt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Df:typeof i=="function"?i:bt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??xs,a):r},a}function rA(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}xs(e,t)}}function nA(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}xs(e,t)}}function aA(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,d=0;l<s;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,m=(f-h)/2,x=0;x<l;++x){var g=e[t[x]],v=g[n][1]||0,y=g[n-1][1]||0;m+=v-y}c+=f,d+=m*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,xs(e,t)}}var wd={},Nd={},Px;function iA(){return Px||(Px=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Nd)),Nd}var _d={},Ox;function Cw(){return Ox||(Ox=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(_d)),_d}var Sd={},Dx;function Qh(){return Dx||(Dx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Sd)),Sd}var Ed={},Td={},Rx;function sA(){return Rx||(Rx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Td)),Td}var Ix;function em(){return Ix||(Ix=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sA(),r=Qh();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(i.push(""),l++);l<s;){const f=a[l];d?f==="\\"&&l+1<s?(l++,c+=a[l]):f===d?d="":c+=f:u?f==='"'||f==="'"?d=f:f==="]"?(u=!1,i.push(c),c=""):c+=f:f==="["?(u=!0,c&&(i.push(c),c="")):f==="."?c&&(i.push(c),c=""):c+=f,l++}return c&&i.push(c),i}e.toPath=n})(Ed)),Ed}var Fx;function tm(){return Fx||(Fx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iA(),r=Cw(),n=Qh(),a=em();function i(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?i(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return s(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function s(l,c,d){if(c.length===0)return d;let u=l;for(let f=0;f<c.length;f++){if(u==null||t.isUnsafeProperty(c[f]))return d;u=u[c[f]]}return u===void 0?d:u}e.get=i})(wd)),wd}var Cd,Mx;function oA(){return Mx||(Mx=1,Cd=tm().get),Cd}var lA=oA();const Ti=ri(lA);var cr=e=>e===0?0:e>0?1:-1,jn=e=>typeof e=="number"&&e!=+e,_a=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ke=e=>(typeof e=="number"||e instanceof Number)&&!jn(e),ra=e=>Ke(e)||typeof e=="string",cA=0,No=e=>{var t=++cA;return"".concat(e||"").concat(t)},kr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ke(t)&&typeof t!="string")return n;var i;if(_a(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return jn(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},jw=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function $t(e,t,r){return Ke(e)&&Ke(t)?e+r*(t-e):t}function Aw(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Ti(n,t))===r)}var Pt=e=>e===null||typeof e>"u",Vo=e=>Pt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),uA=["type","size","sizeType"];function Rf(){return Rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rf.apply(null,arguments)}function Lx(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lx(Object(r),!0).forEach(function(n){dA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lx(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dA(e,t,r){return(t=fA(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fA(e){var t=hA(e,"string");return typeof t=="symbol"?t:t+""}function hA(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mA(e,t){if(e==null)return{};var r,n,a=pA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pA(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kw={symbolCircle:Jh,symbolCross:Pj,symbolDiamond:Dj,symbolSquare:Rj,symbolStar:Lj,symbolTriangle:Bj,symbolWye:Uj},xA=Math.PI/180,gA=e=>{var t="symbol".concat(Vo(e));return kw[t]||Jh},vA=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*xA;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},yA=(e,t)=>{kw["symbol".concat(Vo(e))]=t},Pw=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=mA(e,uA),i=Bx(Bx({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var h=gA(s),m=Hj().type(h).size(vA(r,n,s)),x=m();if(x!==null)return x},{className:c,cx:d,cy:u}=i,f=zr(i);return d===+d&&u===+u&&r===+r?p.createElement("path",Rf({},f,{className:ct("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};Pw.registerSymbol=yA;var rm=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(p.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Xh(a)&&(n[a]=(i=>r[a](r,i)))}),n},bA=(e,t,r)=>n=>(e(t,r,n),null),yu=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];Xh(a)&&typeof i=="function"&&(n||(n={}),n[a]=bA(i,t,r))}),n},jd={},Ad={},$x;function wA(){return $x||($x=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(Ad)),Ad}var kd={},Ux;function Ow(){return Ux||(Ux=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(kd)),kd}var Pd={},Od={},Dd={},Hx;function NA(){return Hx||(Hx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Dd)),Dd}var Wx;function nm(){return Wx||(Wx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NA();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Od)),Od}var Rd={},Kx;function _A(){return Kx||(Kx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Rd)),Rd}var zx;function SA(){return zx||(zx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nm(),r=_A();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Pd)),Pd}var Id={},Fd={},Vx;function EA(){return Vx||(Vx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tm();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Fd)),Fd}var Md={},Ld={},Bd={},$d={},Gx;function Dw(){return Gx||(Gx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})($d)),$d}var Ud={},Yx;function Rw(){return Yx||(Yx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Ud)),Ud}var Hd={},Xx;function Iw(){return Xx||(Xx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Hd)),Hd}var qx;function TA(){return qx||(qx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dw(),r=Rw(),n=Iw();function a(u,f,h){return typeof h!="function"?a(u,f,()=>{}):i(u,f,function m(x,g,v,y,b,w){const N=h(x,g,v,y,b,w);return N!==void 0?!!N:i(x,g,m,w)},new Map)}function i(u,f,h,m){if(f===u)return!0;switch(typeof f){case"object":return s(u,f,h,m);case"function":return Object.keys(f).length>0?i(u,{...f},h,m):n.eq(u,f);default:return t.isObject(u)?typeof f=="string"?f==="":!0:n.eq(u,f)}}function s(u,f,h,m){if(f==null)return!0;if(Array.isArray(f))return c(u,f,h,m);if(f instanceof Map)return l(u,f,h,m);if(f instanceof Set)return d(u,f,h,m);const x=Object.keys(f);if(u==null)return x.length===0;if(x.length===0)return!0;if(m?.has(f))return m.get(f)===u;m?.set(f,u);try{for(let g=0;g<x.length;g++){const v=x[g];if(!r.isPrimitive(u)&&!(v in u)||f[v]===void 0&&u[v]!==void 0||f[v]===null&&u[v]!==null||!h(u[v],f[v],v,u,f,m))return!1}return!0}finally{m?.delete(f)}}function l(u,f,h,m){if(f.size===0)return!0;if(!(u instanceof Map))return!1;for(const[x,g]of f.entries()){const v=u.get(x);if(h(v,g,x,u,f,m)===!1)return!1}return!0}function c(u,f,h,m){if(f.length===0)return!0;if(!Array.isArray(u))return!1;const x=new Set;for(let g=0;g<f.length;g++){const v=f[g];let y=!1;for(let b=0;b<u.length;b++){if(x.has(b))continue;const w=u[b];let N=!1;if(h(w,v,g,u,f,m)&&(N=!0),N){x.add(b),y=!0;break}}if(!y)return!1}return!0}function d(u,f,h,m){return f.size===0?!0:u instanceof Set?c([...u],[...f],h,m):!1}e.isMatchWith=a,e.isSetMatch=d})(Bd)),Bd}var Zx;function Fw(){return Zx||(Zx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TA();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Ld)),Ld}var Wd={},Kd={},zd={},Jx;function CA(){return Jx||(Jx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(zd)),zd}var Vd={},Qx;function Mw(){return Qx||(Qx=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Vd)),Vd}var Gd={},eg;function Lw(){return eg||(eg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",f="[object Function]",h="[object ArrayBuffer]",m="[object Object]",x="[object Error]",g="[object DataView]",v="[object Uint8Array]",y="[object Uint8ClampedArray]",b="[object Uint16Array]",w="[object Uint32Array]",N="[object BigUint64Array]",_="[object Int8Array]",E="[object Int16Array]",S="[object Int32Array]",j="[object BigInt64Array]",P="[object Float32Array]",C="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=h,e.arrayTag=u,e.bigInt64ArrayTag=j,e.bigUint64ArrayTag=N,e.booleanTag=a,e.dataViewTag=g,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=P,e.float64ArrayTag=C,e.functionTag=f,e.int16ArrayTag=E,e.int32ArrayTag=S,e.int8ArrayTag=_,e.mapTag=c,e.numberTag=n,e.objectTag=m,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=b,e.uint32ArrayTag=w,e.uint8ArrayTag=v,e.uint8ClampedArrayTag=y})(Gd)),Gd}var Yd={},tg;function jA(){return tg||(tg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Yd)),Yd}var rg;function Bw(){return rg||(rg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CA(),r=Mw(),n=Lw(),a=Rw(),i=jA();function s(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,h,m=new Map,x=void 0){const g=x?.(u,f,h,m);if(g!==void 0)return g;if(a.isPrimitive(u))return u;if(m.has(u))return m.get(u);if(Array.isArray(u)){const v=new Array(u.length);m.set(u,v);for(let y=0;y<u.length;y++)v[y]=l(u[y],y,h,m,x);return Object.hasOwn(u,"index")&&(v.index=u.index),Object.hasOwn(u,"input")&&(v.input=u.input),v}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const v=new RegExp(u.source,u.flags);return v.lastIndex=u.lastIndex,v}if(u instanceof Map){const v=new Map;m.set(u,v);for(const[y,b]of u)v.set(y,l(b,y,h,m,x));return v}if(u instanceof Set){const v=new Set;m.set(u,v);for(const y of u)v.add(l(y,void 0,h,m,x));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const v=new(Object.getPrototypeOf(u)).constructor(u.length);m.set(u,v);for(let y=0;y<u.length;y++)v[y]=l(u[y],y,h,m,x);return v}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const v=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return m.set(u,v),c(v,u,h,m,x),v}if(typeof File<"u"&&u instanceof File){const v=new File([u],u.name,{type:u.type});return m.set(u,v),c(v,u,h,m,x),v}if(typeof Blob<"u"&&u instanceof Blob){const v=new Blob([u],{type:u.type});return m.set(u,v),c(v,u,h,m,x),v}if(u instanceof Error){const v=new u.constructor;return m.set(u,v),v.message=u.message,v.name=u.name,v.stack=u.stack,v.cause=u.cause,c(v,u,h,m,x),v}if(u instanceof Boolean){const v=new Boolean(u.valueOf());return m.set(u,v),c(v,u,h,m,x),v}if(u instanceof Number){const v=new Number(u.valueOf());return m.set(u,v),c(v,u,h,m,x),v}if(u instanceof String){const v=new String(u.valueOf());return m.set(u,v),c(v,u,h,m,x),v}if(typeof u=="object"&&d(u)){const v=Object.create(Object.getPrototypeOf(u));return m.set(u,v),c(v,u,h,m,x),v}return u}function c(u,f,h=u,m,x){const g=[...Object.keys(f),...t.getSymbols(f)];for(let v=0;v<g.length;v++){const y=g[v],b=Object.getOwnPropertyDescriptor(u,y);(b==null||b.writable)&&(u[y]=l(f[y],y,h,m,x))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=c})(Kd)),Kd}var ng;function AA(){return ng||(ng=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bw();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Wd)),Wd}var ag;function kA(){return ag||(ag=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fw(),r=AA();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Md)),Md}var Xd={},qd={},Zd={},ig;function PA(){return ig||(ig=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bw(),r=Lw();function n(a,i){return t.cloneDeepWith(a,(s,l,c,d)=>{const u=i?.(s,l,c,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a?.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(Zd)),Zd}var sg;function OA(){return sg||(sg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PA();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(qd)),qd}var Jd={},Qd={},og;function $w(){return og||(og=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Qd)),Qd}var e0={},lg;function DA(){return lg||(lg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Mw();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(e0)),e0}var cg;function RA(){return cg||(cg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Cw(),r=$w(),n=DA(),a=em();function i(s,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=s;for(let u=0;u<c.length;u++){const f=c[u];if((d==null||!Object.hasOwn(d,f))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(f)&&f<d.length))return!1;d=d[f]}return!0}e.has=i})(Jd)),Jd}var ug;function IA(){return ug||(ug=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fw(),r=Qh(),n=OA(),a=tm(),i=RA();function s(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?i.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=s})(Xd)),Xd}var dg;function FA(){return dg||(dg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ow(),r=EA(),n=kA(),a=IA();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(Id)),Id}var fg;function MA(){return fg||(fg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wA(),r=Ow(),n=SA(),a=FA();function i(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(l)):[]}e.uniqBy=i})(jd)),jd}var t0,hg;function LA(){return hg||(hg=1,t0=MA().uniqBy),t0}var BA=LA();const mg=ri(BA);function $A(e,t,r){return t===!0?mg(e,r):typeof t=="function"?mg(e,t):e}var r0={exports:{}},n0={},a0={exports:{}},i0={};var pg;function UA(){if(pg)return i0;pg=1;var e=mu();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(f,h){var m=h(),x=n({inst:{value:m,getSnapshot:h}}),g=x[0].inst,v=x[1];return i(function(){g.value=m,g.getSnapshot=h,c(g)&&v({inst:g})},[f,m,h]),a(function(){return c(g)&&v({inst:g}),f(function(){c(g)&&v({inst:g})})},[f]),s(m),m}function c(f){var h=f.getSnapshot;f=f.value;try{var m=h();return!r(f,m)}catch{return!0}}function d(f,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return i0.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,i0}var xg;function HA(){return xg||(xg=1,a0.exports=UA()),a0.exports}var gg;function WA(){if(gg)return n0;gg=1;var e=mu(),t=HA();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,c=e.useDebugValue;return n0.useSyncExternalStoreWithSelector=function(d,u,f,h,m){var x=i(null);if(x.current===null){var g={hasValue:!1,value:null};x.current=g}else g=x.current;x=l(function(){function y(E){if(!b){if(b=!0,w=E,E=h(E),m!==void 0&&g.hasValue){var S=g.value;if(m(S,E))return N=S}return N=E}if(S=N,n(w,E))return S;var j=h(E);return m!==void 0&&m(S,j)?(w=E,S):(w=E,N=j)}var b=!1,w,N,_=f===void 0?null:f;return[function(){return y(u())},_===null?void 0:function(){return y(_())}]},[u,f,h,m]);var v=a(d,x[0],x[1]);return s(function(){g.hasValue=!0,g.value=v},[v]),c(v),v},n0}var vg;function KA(){return vg||(vg=1,r0.exports=WA()),r0.exports}var zA=KA(),am=p.createContext(null),VA=e=>e,Ut=()=>{var e=p.useContext(am);return e?e.store.dispatch:VA},Jl=()=>{},GA=()=>Jl,YA=(e,t)=>e===t;function He(e){var t=p.useContext(am);return zA.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:GA,t?t.store.getState:Jl,t?t.store.getState:Jl,t?e:Jl,YA)}function XA(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function qA(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function ZA(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var yg=e=>Array.isArray(e)?e:[e];function JA(e){const t=Array.isArray(e[0])?e[0]:e;return ZA(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function QA(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var e4=class{constructor(e){this.value=e}deref(){return this.value}},t4=typeof WeakRef<"u"?WeakRef:e4,r4=0,bg=1;function vl(){return{s:r4,v:void 0,o:null,p:null}}function Uw(e,t={}){let r=vl();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let l=r;const{length:c}=arguments;for(let f=0,h=c;f<h;f++){const m=arguments[f];if(typeof m=="function"||typeof m=="object"&&m!==null){let x=l.o;x===null&&(l.o=x=new WeakMap);const g=x.get(m);g===void 0?(l=vl(),x.set(m,l)):l=g}else{let x=l.p;x===null&&(l.p=x=new Map);const g=x.get(m);g===void 0?(l=vl(),x.set(m,l)):l=g}}const d=l;let u;if(l.s===bg)u=l.v;else if(u=e.apply(null,arguments),i++,n){const f=a?.deref?.()??a;f!=null&&n(f,u)&&(u=f,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new t4(u):u}return d.s=bg,d.v=u,u}return s.clearCache=()=>{r=vl(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function n4(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),XA(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:m=Uw,argsMemoizeOptions:x=[]}=u,g=yg(h),v=yg(x),y=JA(a),b=f(function(){return i++,d.apply(null,arguments)},...g),w=m(function(){s++;const _=QA(y,arguments);return l=b.apply(null,_),l},...v);return Object.assign(w,{resultFunc:d,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var ie=n4(Uw),a4=Object.assign((e,t=ie)=>{qA(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,c)=>(s[r[c]]=l,s),{}))},{withTypes:()=>a4}),s0={},o0={},l0={},wg;function i4(){return wg||(wg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(l0)),l0}var c0={},u0={},Ng;function Hw(){return Ng||(Ng=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(u0)),u0}var _g;function s4(){return _g||(_g=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hw(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(c0)),c0}var Sg;function o4(){return Sg||(Sg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i4(),r=s4(),n=em();function a(i,s,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(m=>String(m));const d=(m,x)=>{let g=m;for(let v=0;v<x.length&&g!=null;++v)g=g[x[v]];return g},u=(m,x)=>x==null||m==null?x:typeof m=="object"&&"key"in m?Object.hasOwn(x,m.key)?x[m.key]:d(x,m.path):typeof m=="function"?m(x):Array.isArray(m)?d(x,m):typeof x=="object"?x[m]:x,f=s.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return i.map(m=>({original:m,criteria:f.map(x=>u(x,m))})).slice().sort((m,x)=>{for(let g=0;g<f.length;g++){const v=t.compareValues(m.criteria[g],x.criteria[g],l[g]);if(v!==0)return v}return 0}).map(m=>m.original)}e.orderBy=a})(o0)),o0}var d0={},Eg;function l4(){return Eg||(Eg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<i?s(u,c+1):a.push(u)}};return s(r,0),a}e.flatten=t})(d0)),d0}var f0={},Tg;function Ww(){return Tg||(Tg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$w(),r=nm(),n=Dw(),a=Iw();function i(s,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],s):!1}e.isIterateeCall=i})(f0)),f0}var Cg;function c4(){return Cg||(Cg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o4(),r=l4(),n=Ww();function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(s0)),s0}var h0,jg;function u4(){return jg||(jg=1,h0=c4().sortBy),h0}var d4=u4();const bu=ri(d4);var Kw=e=>e.legend.settings,f4=e=>e.legend.size,h4=e=>e.legend.payload;ie([h4,Kw],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?bu(n,r):n});var yl=1;function m4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=p.useState({height:0,left:0,top:0,width:0}),n=p.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>yl||Math.abs(s.left-t.left)>yl||Math.abs(s.top-t.top)>yl||Math.abs(s.width-t.width)>yl)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function fr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var p4=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ag=p4,m0=()=>Math.random().toString(36).substring(7).split("").join("."),x4={INIT:`@@redux/INIT${m0()}`,REPLACE:`@@redux/REPLACE${m0()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${m0()}`},cc=x4;function im(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function zw(e,t,r){if(typeof e!="function")throw new Error(fr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(fr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(fr(1));return r(zw)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,c=!1;function d(){s===i&&(s=new Map,i.forEach((v,y)=>{s.set(y,v)}))}function u(){if(c)throw new Error(fr(3));return a}function f(v){if(typeof v!="function")throw new Error(fr(4));if(c)throw new Error(fr(5));let y=!0;d();const b=l++;return s.set(b,v),function(){if(y){if(c)throw new Error(fr(6));y=!1,d(),s.delete(b),i=null}}}function h(v){if(!im(v))throw new Error(fr(7));if(typeof v.type>"u")throw new Error(fr(8));if(typeof v.type!="string")throw new Error(fr(17));if(c)throw new Error(fr(9));try{c=!0,a=n(a,v)}finally{c=!1}return(i=s).forEach(b=>{b()}),v}function m(v){if(typeof v!="function")throw new Error(fr(10));n=v,h({type:cc.REPLACE})}function x(){const v=f;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(fr(11));function b(){const N=y;N.next&&N.next(u())}return b(),{unsubscribe:v(b)}},[Ag](){return this}}}return h({type:cc.INIT}),{dispatch:h,subscribe:f,getState:u,replaceReducer:m,[Ag]:x}}function g4(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:cc.INIT})>"u")throw new Error(fr(12));if(typeof r(void 0,{type:cc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(fr(13))})}function Vw(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{g4(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<n.length;u++){const f=n[u],h=r[f],m=s[f],x=h(m,l);if(typeof x>"u")throw l&&l.type,new Error(fr(14));d[f]=x,c=c||x!==m}return c=c||n.length!==Object.keys(s).length,c?d:s}}function uc(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function v4(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(fr(15))};const s={getState:a.getState,dispatch:(c,...d)=>i(c,...d)},l=e.map(c=>c(s));return i=uc(...l)(a.dispatch),{...a,dispatch:i}}}function Gw(e){return im(e)&&"type"in e&&typeof e.type=="string"}var Yw=Symbol.for("immer-nothing"),kg=Symbol.for("immer-draftable"),gn=Symbol.for("immer-state");function In(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var _o=Object.getPrototypeOf;function Ci(e){return!!e&&!!e[gn]}function Sa(e){return e?Xw(e)||Array.isArray(e)||!!e[kg]||!!e.constructor?.[kg]||Go(e)||Nu(e):!1}var y4=Object.prototype.constructor.toString(),Pg=new WeakMap;function Xw(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=Pg.get(r);return n===void 0&&(n=Function.toString.call(r),Pg.set(r,n)),n===y4}function dc(e,t,r=!0){wu(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function wu(e){const t=e[gn];return t?t.type_:Array.isArray(e)?1:Go(e)?2:Nu(e)?3:0}function If(e,t){return wu(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function qw(e,t,r){const n=wu(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function b4(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Go(e){return e instanceof Map}function Nu(e){return e instanceof Set}function hi(e){return e.copy_||e.base_}function Ff(e,t){if(Go(e))return new Map(e);if(Nu(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Xw(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[gn];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(_o(e),n)}else{const n=_o(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function sm(e,t=!1){return _u(e)||Ci(e)||!Sa(e)||(wu(e)>1&&Object.defineProperties(e,{set:bl,add:bl,clear:bl,delete:bl}),Object.freeze(e),t&&Object.values(e).forEach(r=>sm(r,!0))),e}function w4(){In(2)}var bl={value:w4};function _u(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var N4={};function ji(e){const t=N4[e];return t||In(0,e),t}var So;function Zw(){return So}function _4(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Og(e,t){t&&(ji("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Mf(e){Lf(e),e.drafts_.forEach(S4),e.drafts_=null}function Lf(e){e===So&&(So=e.parent_)}function Dg(e){return So=_4(So,e)}function S4(e){const t=e[gn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Rg(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[gn].modified_&&(Mf(t),In(4)),Sa(e)&&(e=fc(t,e),t.parent_||hc(t,e)),t.patches_&&ji("Patches").generateReplacementPatches_(r[gn].base_,e,t.patches_,t.inversePatches_)):e=fc(t,r,[]),Mf(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Yw?e:void 0}function fc(e,t,r){if(_u(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[gn];if(!a)return dc(t,(i,s)=>Ig(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return hc(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,l=!1;a.type_===3&&(s=new Set(i),i.clear(),l=!0),dc(s,(c,d)=>Ig(e,a,i,c,d,r,l),n),hc(e,i,!1),r&&e.patches_&&ji("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function Ig(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const l=_u(a);if(!(l&&!s)){if(Ci(a)){const c=i&&t&&t.type_!==3&&!If(t.assigned_,n)?i.concat(n):void 0,d=fc(e,a,c);if(qw(r,n,d),Ci(d))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Sa(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&l)return;fc(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Go(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&hc(e,a)}}}function hc(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&sm(t,r)}function E4(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Zw(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=om;r&&(a=[n],i=Eo);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var om={get(e,t){if(t===gn)return e;const r=hi(e);if(!If(r,t))return T4(e,r,t);const n=r[t];return e.finalized_||!Sa(n)?n:n===p0(e.base_,t)?(x0(e),e.copy_[t]=$f(n,e)):n},has(e,t){return t in hi(e)},ownKeys(e){return Reflect.ownKeys(hi(e))},set(e,t,r){const n=Jw(hi(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=p0(hi(e),t),i=a?.[gn];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(b4(r,a)&&(r!==void 0||If(e.base_,t)))return!0;x0(e),Bf(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return p0(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,x0(e),Bf(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=hi(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){In(11)},getPrototypeOf(e){return _o(e.base_)},setPrototypeOf(){In(12)}},Eo={};dc(om,(e,t)=>{Eo[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Eo.deleteProperty=function(e,t){return Eo.set.call(this,e,t,void 0)};Eo.set=function(e,t,r){return om.set.call(this,e[0],t,r,e[0])};function p0(e,t){const r=e[gn];return(r?hi(r):e)[t]}function T4(e,t,r){const n=Jw(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function Jw(e,t){if(!(t in e))return;let r=_o(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=_o(r)}}function Bf(e){e.modified_||(e.modified_=!0,e.parent_&&Bf(e.parent_))}function x0(e){e.copy_||(e.copy_=Ff(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var C4=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...d){return s.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&In(6),n!==void 0&&typeof n!="function"&&In(7);let a;if(Sa(t)){const i=Dg(this),s=$f(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?Mf(i):Lf(i)}return Og(i,n),Rg(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Yw&&(a=void 0),this.autoFreeze_&&sm(a,!0),n){const i=[],s=[];ji("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else In(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,c=>t(c,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Sa(e)||In(8),Ci(e)&&(e=ga(e));const t=Dg(this),r=$f(e,void 0);return r[gn].isManual_=!0,Lf(t),r}finishDraft(e,t){const r=e&&e[gn];(!r||!r.isManual_)&&In(9);const{scope_:n}=r;return Og(n,t),Rg(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=ji("Patches").applyPatches_;return Ci(e)?n(e,t):this.produce(e,a=>n(a,t))}};function $f(e,t){const r=Go(e)?ji("MapSet").proxyMap_(e,t):Nu(e)?ji("MapSet").proxySet_(e,t):E4(e,t);return(t?t.scope_:Zw()).drafts_.push(r),r}function ga(e){return Ci(e)||In(10,e),Qw(e)}function Qw(e){if(!Sa(e)||_u(e))return e;const t=e[gn];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ff(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Ff(e,!0);return dc(r,(a,i)=>{qw(r,a,Qw(i))},n),t&&(t.finalized_=!1),r}var j4=new C4,e2=j4.produce;function t2(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var A4=t2(),k4=t2,P4=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?uc:uc.apply(null,arguments)};function An(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(pn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Gw(n)&&n.type===e,r}var r2=class io extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,io.prototype)}static get[Symbol.species](){return io}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new io(...t[0].concat(this)):new io(...t.concat(this))}};function Fg(e){return Sa(e)?e2(e,()=>{}):e}function wl(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function O4(e){return typeof e=="boolean"}var D4=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new r2;return r&&(O4(r)?s.push(A4):s.push(k4(r.extraArgument))),s},n2="RTK_autoBatch",Br=()=>e=>({payload:e,meta:{[n2]:!0}}),Mg=e=>t=>{setTimeout(t,e)},a2=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Mg(10):e.type==="callback"?e.queueNotification:Mg(e.timeout),d=()=>{s=!1,i&&(i=!1,l.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const f=()=>a&&u(),h=n.subscribe(f);return l.add(u),()=>{h(),l.delete(u)}},dispatch(u){try{return a=!u?.meta?.[n2],i=!a,i&&(s||(s=!0,c(d))),n.dispatch(u)}finally{a=!0}}})},R4=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new r2(e);return n&&a.push(a2(typeof n=="object"?n:void 0)),a};function I4(e){const t=D4(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(im(r))l=Vw(r);else throw new Error(pn(1));let c;typeof n=="function"?c=n(t):c=t();let d=uc;a&&(d=P4({trace:!1,...typeof a=="object"&&a}));const u=v4(...c),f=R4(u);let h=typeof s=="function"?s(f):f();const m=d(...h);return zw(l,i,m)}function i2(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(pn(28));if(l in t)throw new Error(pn(29));return t[l]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function F4(e){return typeof e=="function"}function M4(e,t){let[r,n,a]=i2(t),i;if(F4(e))i=()=>Fg(e());else{const l=Fg(e);i=()=>l}function s(l=i(),c){let d=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,f)=>{if(f)if(Ci(u)){const m=f(u,c);return m===void 0?u:m}else{if(Sa(u))return e2(u,h=>f(h,c));{const h=f(u,c);if(h===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return u},l)}return s.getInitialState=i,s}var L4="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",B4=(e=21)=>{let t="",r=e;for(;r--;)t+=L4[Math.random()*64|0];return t},$4=Symbol.for("rtk-slice-createasyncthunk");function U4(e,t){return`${e}/${t}`}function H4({creators:e}={}){const t=e?.asyncThunk?.[$4];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(pn(11));const s=(typeof n.reducers=="function"?n.reducers(K4()):n.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,N){const _=typeof w=="string"?w:w.type;if(!_)throw new Error(pn(12));if(_ in c.sliceCaseReducersByType)throw new Error(pn(13));return c.sliceCaseReducersByType[_]=N,d},addMatcher(w,N){return c.sliceMatchers.push({matcher:w,reducer:N}),d},exposeAction(w,N){return c.actionCreators[w]=N,d},exposeCaseReducer(w,N){return c.sliceCaseReducersByName[w]=N,d}};l.forEach(w=>{const N=s[w],_={reducerName:w,type:U4(a,w),createNotation:typeof n.reducers=="function"};V4(N)?Y4(_,N,d,t):z4(_,N,d)});function u(){const[w={},N=[],_=void 0]=typeof n.extraReducers=="function"?i2(n.extraReducers):[n.extraReducers],E={...w,...c.sliceCaseReducersByType};return M4(n.initialState,S=>{for(let j in E)S.addCase(j,E[j]);for(let j of c.sliceMatchers)S.addMatcher(j.matcher,j.reducer);for(let j of N)S.addMatcher(j.matcher,j.reducer);_&&S.addDefaultCase(_)})}const f=w=>w,h=new Map,m=new WeakMap;let x;function g(w,N){return x||(x=u()),x(w,N)}function v(){return x||(x=u()),x.getInitialState()}function y(w,N=!1){function _(S){let j=S[w];return typeof j>"u"&&N&&(j=wl(m,_,v)),j}function E(S=f){const j=wl(h,N,()=>new WeakMap);return wl(j,S,()=>{const P={};for(const[C,T]of Object.entries(n.selectors??{}))P[C]=W4(T,S,()=>wl(m,S,v),N);return P})}return{reducerPath:w,getSelectors:E,get selectors(){return E(_)},selectSlice:_}}const b={name:a,reducer:g,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...y(i),injectInto(w,{reducerPath:N,..._}={}){const E=N??i;return w.inject({reducerPath:E,reducer:g},_),{...b,...y(E,!0)}}};return b}}function W4(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var vn=H4();function K4(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function z4({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!G4(n))throw new Error(pn(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?An(e,s):An(e))}function V4(e){return e._reducerDefinitionType==="asyncThunk"}function G4(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Y4({type:e,reducerName:t},r,n,a){if(!a)throw new Error(pn(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:c,settled:d,options:u}=r,f=a(e,i,u);n.exposeAction(t,f),s&&n.addCase(f.fulfilled,s),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),d&&n.addMatcher(f.settled,d),n.exposeCaseReducer(t,{fulfilled:s||Nl,pending:l||Nl,rejected:c||Nl,settled:d||Nl})}function Nl(){}var X4="task",s2="listener",o2="completed",lm="cancelled",q4=`task-${lm}`,Z4=`task-${o2}`,Uf=`${s2}-${lm}`,J4=`${s2}-${o2}`,Su=class{constructor(e){this.code=e,this.message=`${X4} ${lm} (reason: ${e})`}name="TaskAbortError";message},cm=(e,t)=>{if(typeof e!="function")throw new TypeError(pn(32))},mc=()=>{},l2=(e,t=mc)=>(e.catch(t),e),c2=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),bi=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},wi=e=>{if(e.aborted){const{reason:t}=e;throw new Su(t)}};function u2(e,t){let r=mc;return new Promise((n,a)=>{const i=()=>a(new Su(e.reason));if(e.aborted){i();return}r=c2(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=mc})}var Q4=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Su?"cancelled":"rejected",error:r}}finally{t?.()}},pc=e=>t=>l2(u2(e,t).then(r=>(wi(e),r))),d2=e=>{const t=pc(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:is}=Object,Lg={},Eu="listenerMiddleware",ek=(e,t)=>{const r=n=>c2(e,()=>bi(n,e.reason));return(n,a)=>{cm(n);const i=new AbortController;r(i);const s=Q4(async()=>{wi(e),wi(i.signal);const l=await n({pause:pc(i.signal),delay:d2(i.signal),signal:i.signal});return wi(i.signal),l},()=>bi(i,Z4));return a?.autoJoin&&t.push(s.catch(mc)),{result:pc(e)(s),cancel(){bi(i,q4)}}}},tk=(e,t)=>{const r=async(n,a)=>{wi(t);let i=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});i=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await u2(t,Promise.race(l));return wi(t),c}finally{i()}};return(n,a)=>l2(r(n,a))},f2=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=An(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(pn(21));return cm(i),{predicate:a,type:t,effect:i}},h2=is(e=>{const{type:t,predicate:r,effect:n}=f2(e);return{id:B4(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(pn(22))}}},{withTypes:()=>h2}),Bg=(e,t)=>{const{type:r,effect:n,predicate:a}=f2(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},Hf=e=>{e.pending.forEach(t=>{bi(t,Uf)})},rk=(e,t)=>()=>{for(const r of t.keys())Hf(r);e.clear()},$g=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},m2=is(An(`${Eu}/add`),{withTypes:()=>m2}),nk=An(`${Eu}/removeAll`),p2=is(An(`${Eu}/remove`),{withTypes:()=>p2}),ak=(...e)=>{console.error(`${Eu}/error`,...e)},Yo=(e={})=>{const t=new Map,r=new Map,n=m=>{const x=r.get(m)??0;r.set(m,x+1)},a=m=>{const x=r.get(m)??1;x===1?r.delete(m):r.set(m,x-1)},{extra:i,onError:s=ak}=e;cm(s);const l=m=>(m.unsubscribe=()=>t.delete(m.id),t.set(m.id,m),x=>{m.unsubscribe(),x?.cancelActive&&Hf(m)}),c=m=>{const x=Bg(t,m)??h2(m);return l(x)};is(c,{withTypes:()=>c});const d=m=>{const x=Bg(t,m);return x&&(x.unsubscribe(),m.cancelActive&&Hf(x)),!!x};is(d,{withTypes:()=>d});const u=async(m,x,g,v)=>{const y=new AbortController,b=tk(c,y.signal),w=[];try{m.pending.add(y),n(m),await Promise.resolve(m.effect(x,is({},g,{getOriginalState:v,condition:(N,_)=>b(N,_).then(Boolean),take:b,delay:d2(y.signal),pause:pc(y.signal),extra:i,signal:y.signal,fork:ek(y.signal,w),unsubscribe:m.unsubscribe,subscribe:()=>{t.set(m.id,m)},cancelActiveListeners:()=>{m.pending.forEach((N,_,E)=>{N!==y&&(bi(N,Uf),E.delete(N))})},cancel:()=>{bi(y,Uf),m.pending.delete(y)},throwIfCancelled:()=>{wi(y.signal)}})))}catch(N){N instanceof Su||$g(s,N,{raisedBy:"effect"})}finally{await Promise.all(w),bi(y,J4),a(m),m.pending.delete(y)}},f=rk(t,r);return{middleware:m=>x=>g=>{if(!Gw(g))return x(g);if(m2.match(g))return c(g.payload);if(nk.match(g)){f();return}if(p2.match(g))return d(g.payload);let v=m.getState();const y=()=>{if(v===Lg)throw new Error(pn(23));return v};let b;try{if(b=x(g),t.size>0){const w=m.getState(),N=Array.from(t.values());for(const _ of N){let E=!1;try{E=_.predicate(g,w,v)}catch(S){E=!1,$g(s,S,{raisedBy:"predicate"})}E&&u(_,g,m,y)}}}finally{v=Lg}return b},startListening:c,stopListening:d,clearListeners:f}};function pn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ik={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},x2=vn({name:"chartLayout",initialState:ik,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:sk,setLayout:ok,setChartSize:lk,setScale:ck}=x2.actions,uk=x2.reducer;function Ug(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ug(Object(r),!0).forEach(function(n){dk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ug(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dk(e,t,r){return(t=fk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fk(e){var t=hk(e,"string");return typeof t=="symbol"?t:t+""}function hk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xc=Math.PI/180,mk=e=>e*180/Math.PI,Xt=(e,t,r,n)=>({x:e+Math.cos(-xc*n)*r,y:t+Math.sin(-xc*n)*r}),g2=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},pk=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},xk=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=pk({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,c=Math.acos(l);return n>i&&(c=2*Math.PI-c),{radius:s,angle:mk(c),angleInRadian:c}},gk=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},vk=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},yk=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=xk({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:c,endAngle:d}=gk(t),u=i,f;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;f=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=c}return f?Hg(Hg({},t),{},{radius:a,angle:vk(u,t)}):null};function v2(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Wg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function En(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wg(Object(r),!0).forEach(function(n){bk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bk(e,t,r){return(t=wk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wk(e){var t=Nk(e,"string");return typeof t=="symbol"?t:t+""}function Nk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wt(e,t,r){return Pt(e)||Pt(t)?r:ra(t)?Ti(e,t,r):typeof t=="function"?t(e):r}var _k=(e,t,r,n,a)=>{var i,s=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?r[c-1].coordinate:r[l-1].coordinate,u=r[c].coordinate,f=c>=l-1?r[0].coordinate:r[c+1].coordinate,h=void 0;if(cr(u-d)!==cr(f-u)){var m=[];if(cr(f-u)===cr(a[1]-a[0])){h=f;var x=u+a[1]-a[0];m[0]=Math.min(x,(x+d)/2),m[1]=Math.max(x,(x+d)/2)}else{h=d;var g=f+a[1]-a[0];m[0]=Math.min(u,(g+u)/2),m[1]=Math.max(u,(g+u)/2)}var v=[Math.min(u,(h+u)/2),Math.max(u,(h+u)/2)];if(e>v[0]&&e<=v[1]||e>=m[0]&&e<=m[1]){({index:s}=r[c]);break}}else{var y=Math.min(d,f),b=Math.max(d,f);if(e>(y+u)/2&&e<=(b+u)/2){({index:s}=r[c]);break}}}else if(t){for(var w=0;w<l;w++)if(w===0&&e<=(t[w].coordinate+t[w+1].coordinate)/2||w>0&&w<l-1&&e>(t[w].coordinate+t[w-1].coordinate)/2&&e<=(t[w].coordinate+t[w+1].coordinate)/2||w===l-1&&e>(t[w].coordinate+t[w-1].coordinate)/2){({index:s}=t[w]);break}}return s},Sk=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&Ke(e[i]))return En(En({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&Ke(e[s]))return En(En({},e),{},{[s]:e[s]+(a||0)})}return e},ni=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",y2=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},b2=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:f,niceTicks:h,axisType:m}=e;if(!s)return null;var x=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=a==="category"&&s.bandwidth?s.bandwidth()/x:0;if(g=m==="angleAxis"&&i&&i.length>=2?cr(i[0]-i[1])*2*g:g,f||h){var v=(f||h||[]).map((y,b)=>{var w=n?n.indexOf(y):y;return{coordinate:s(w)+g,value:y,offset:g,index:b}});return v.filter(y=>!jn(y.coordinate))}return c&&d?d.map((y,b)=>({coordinate:s(y)+g,value:y,index:b,offset:g})):s.ticks&&u!=null?s.ticks(u).map((y,b)=>({coordinate:s(y)+g,value:y,offset:g,index:b})):s.domain().map((y,b)=>({coordinate:s(y)+g,value:n?n[y]:y,index:b,offset:g}))},Kg=1e-4,Ek=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Kg,i=Math.max(n[0],n[1])+Kg,s=e(t[0]),l=e(t[r-1]);(s<a||s>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},Tk=(e,t)=>{if(!t||t.length!==2||!Ke(t[0])||!Ke(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Ke(e[0])||e[0]<r)&&(a[0]=r),(!Ke(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},Ck=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var l=jn(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1])}},jk=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=jn(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},Ak={sign:Ck,expand:rA,none:xs,silhouette:nA,wiggle:aA,positive:jk},kk=(e,t,r)=>{var n=Ak[r],a=tA().keys(t).value((i,s)=>+wt(i,s,0)).order(Df).offset(n);return a(e)};function Pk(e){return e==null?void 0:String(e)}function zg(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Pt(a[t.dataKey])){var l=Aw(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=wt(a,Pt(s)?t.dataKey:s);return Pt(c)?null:t.scale(c)}var Vg=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=wt(i,t.dataKey,t.scale.domain()[s]);return Pt(l)?null:t.scale(l)-a/2+n},Ok=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},Dk=e=>{var t=e.flat(2).filter(Ke);return[Math.min(...t),Math.max(...t)]},Rk=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Ik=(e,t,r)=>{if(e!=null)return Rk(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,l=s.reduce((c,d)=>{var u=v2(d,t,r),f=Dk(u);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},Gg=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Yg=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,To=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=bu(t,u=>u.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var c=a[s],d=a[s-1];i=Math.min((c.coordinate||0)-(d.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function Xg(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return En(En({},t),{},{dataKey:r,payload:n,value:a,name:i})}function Cs(e,t){if(e)return String(e);if(typeof t=="string")return t}function Fk(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?yk({x:e,y:t},n):null}var Mk=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return En(En(En({},n),Xt(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:c}=n;return En(En(En({},n),Xt(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},Lk=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Pa=e=>e.layout.width,Oa=e=>e.layout.height,Bk=e=>e.layout.scale,w2=e=>e.layout.margin,Tu=ie(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Cu=ie(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),N2="data-recharts-item-index",_2="data-recharts-item-data-key",Xo=60;function qg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qg(Object(r),!0).forEach(function(n){$k(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qg(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $k(e,t,r){return(t=Uk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uk(e){var t=Hk(e,"string");return typeof t=="symbol"?t:t+""}function Hk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wk=e=>e.brush.height;function Kk(e){var t=Cu(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Xo;return r+a}return r},0)}function zk(e){var t=Cu(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Xo;return r+a}return r},0)}function Vk(e){var t=Tu(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Gk(e){var t=Tu(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var nr=ie([Pa,Oa,w2,Wk,Kk,zk,Vk,Gk,Kw,f4],(e,t,r,n,a,i,s,l,c,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+i},f={top:(r.top||0)+s,bottom:(r.bottom||0)+l},h=_l(_l({},f),u),m=h.bottom;h.bottom+=n,h=Sk(h,c,d);var x=e-h.left-h.right,g=t-h.top-h.bottom;return _l(_l({brushBottom:m},h),{},{width:Math.max(x,0),height:Math.max(g,0)})}),Yk=ie(nr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),um=ie(Pa,Oa,(e,t)=>({x:0,y:0,width:e,height:t})),Xk=p.createContext(null),Vr=()=>p.useContext(Xk)!=null,ju=e=>e.brush,Au=ie([ju,nr,w2],(e,t,r)=>({height:e.height,x:Ke(e.x)?e.x:t.left,y:Ke(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ke(e.width)?e.width:t.width})),g0={},v0={},y0={},Zg;function qk(){return Zg||(Zg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,l=null;const c=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},f=()=>{d&&u(),g()};let h=null;const m=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},x=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{x(),s=void 0,l=null},v=()=>{u()},y=function(...b){if(a?.aborted)return;s=this,l=b;const w=h==null;m(),c&&w&&u()};return y.schedule=m,y.cancel=g,y.flush=v,a?.addEventListener("abort",g,{once:!0}),y}e.debounce=t})(y0)),y0}var Jg;function Zk(){return Jg||(Jg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qk();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:l=!0,maxWait:c}=i,d=Array(2);s&&(d[0]="leading"),l&&(d[1]="trailing");let u,f=null;const h=t.debounce(function(...g){u=n.apply(this,g),f=null},a,{edges:d}),m=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(u=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),u):(h.apply(this,g),u)},x=()=>(h.flush(),u);return m.cancel=h.cancel,m.flush=x,m}e.debounce=r})(v0)),v0}var Qg;function Jk(){return Qg||(Qg=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zk();function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(g0)),g0}var b0,ev;function Qk(){return ev||(ev=1,b0=Jk().throttle),b0}var eP=Qk();const tP=ri(eP);var gc=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},S2=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,l=_a(n)?e:Number(n),c=_a(a)?t:Number(a);return i&&i>0&&(l?c=l/i:c&&(l=c*i),s&&c>s&&(c=s)),{calculatedWidth:l,calculatedHeight:c}},rP={width:0,height:0,overflow:"visible"},nP={width:0,overflowX:"visible"},aP={height:0,overflowY:"visible"},iP={},sP=e=>{var{width:t,height:r}=e,n=_a(t),a=_a(r);return n&&a?rP:n?nP:a?aP:iP};function oP(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function Dr(e){return Number.isFinite(e)}function gs(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Wf(){return Wf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wf.apply(null,arguments)}function tv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tv(Object(r),!0).forEach(function(n){lP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lP(e,t,r){return(t=cP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cP(e){var t=uP(e,"string");return typeof t=="symbol"?t:t+""}function uP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E2=p.createContext({width:-1,height:-1});function T2(e){var{children:t,width:r,height:n}=e,a=p.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:p.createElement(E2.Provider,{value:a},t)}var dm=()=>p.useContext(E2),dP=p.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:f,className:h,onResize:m,style:x={}}=e,g=p.useRef(null),v=p.useRef();v.current=m,p.useImperativeHandle(t,()=>g.current);var[y,b]=p.useState({containerWidth:n.width,containerHeight:n.height}),w=p.useCallback((j,P)=>{b(C=>{var T=Math.round(j),k=Math.round(P);return C.containerWidth===T&&C.containerHeight===k?C:{containerWidth:T,containerHeight:k}})},[]);p.useEffect(()=>{var j=k=>{var W,{width:G,height:K}=k[0].contentRect;w(G,K),(W=v.current)===null||W===void 0||W.call(v,G,K)};u>0&&(j=tP(j,u,{trailing:!0,leading:!1}));var P=new ResizeObserver(j),{width:C,height:T}=g.current.getBoundingClientRect();return w(C,T),P.observe(g.current),()=>{P.disconnect()}},[w,u]);var{containerWidth:N,containerHeight:_}=y;gc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:E,calculatedHeight:S}=S2(N,_,{width:a,height:i,aspect:r,maxHeight:c});return gc(E>0||S>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,E,S,a,i,s,l,r),p.createElement("div",{id:f?"".concat(f):void 0,className:ct("recharts-responsive-container",h),style:rv(rv({},x),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:c}),ref:g},p.createElement("div",{style:sP({width:a,height:i})},p.createElement(T2,{width:E,height:S},d)))}),fm=p.forwardRef((e,t)=>{var r=dm();if(gs(r.width)&&gs(r.height))return e.children;var{width:n,height:a}=oP({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=S2(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Ke(i)&&Ke(s)?p.createElement(T2,{width:i,height:s},e.children):p.createElement(dP,Wf({},e,{width:n,height:a,ref:t}))}),ku=()=>{var e,t=Vr(),r=He(Yk),n=He(Au),a=(e=He(ju))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},fP={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},C2=()=>{var e;return(e=He(nr))!==null&&e!==void 0?e:fP},j2=()=>He(Pa),A2=()=>He(Oa),at=e=>e.layout.layoutType,Pu=()=>He(at),Ou=e=>{var t=Ut(),r=Vr(),{width:n,height:a}=e,i=dm(),s=n,l=a;return i&&(s=i.width>0?i.width:n,l=i.height>0?i.height:a),p.useEffect(()=>{!r&&gs(s)&&gs(l)&&t(lk({width:s,height:l}))},[t,r,s,l]),null},hP={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},k2=vn({name:"legend",initialState:hP,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Br()},removeLegendPayload:{reducer(e,t){var r=ga(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Br()}}}),{setLegendSize:yZ,setLegendSettings:bZ,addLegendPayload:P2,removeLegendPayload:O2}=k2.actions,mP=k2.reducer;function Kf(){return Kf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kf.apply(null,arguments)}function nv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nv(Object(r),!0).forEach(function(n){pP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pP(e,t,r){return(t=xP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xP(e){var t=gP(e,"string");return typeof t=="symbol"?t:t+""}function gP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vP(e){return Array.isArray(e)&&ra(e[0])&&ra(e[1])?e.join(" ~ "):e}var yP=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:f,accessibilityLayer:h=!1}=e,m=()=>{if(i&&i.length){var _={padding:0,margin:0},E=(l?bu(i,l):i).map((S,j)=>{if(S.type==="none")return null;var P=S.formatter||s||vP,{value:C,name:T}=S,k=C,W=T;if(P){var G=P(C,T,S,j,i);if(Array.isArray(G))[k,W]=G;else if(G!=null)k=G;else return null}var K=w0({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return p.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(j),style:K},ra(W)?p.createElement("span",{className:"recharts-tooltip-item-name"},W):null,ra(W)?p.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,p.createElement("span",{className:"recharts-tooltip-item-value"},k),p.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return p.createElement("ul",{className:"recharts-tooltip-item-list",style:_},E)}return null},x=w0({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=w0({margin:0},a),v=!Pt(u),y=v?u:"",b=ct("recharts-default-tooltip",c),w=ct("recharts-tooltip-label",d);v&&f&&i!==void 0&&i!==null&&(y=f(u,i));var N=h?{role:"status","aria-live":"assertive"}:{};return p.createElement("div",Kf({className:b,style:x},N),p.createElement("p",{className:w,style:g},p.isValidElement(y)?y:"".concat(y)),m())},Ys="recharts-tooltip-wrapper",bP={visibility:"hidden"};function wP(e){var{coordinate:t,translateX:r,translateY:n}=e;return ct(Ys,{["".concat(Ys,"-right")]:Ke(r)&&t&&Ke(t.x)&&r>=t.x,["".concat(Ys,"-left")]:Ke(r)&&t&&Ke(t.x)&&r<t.x,["".concat(Ys,"-bottom")]:Ke(n)&&t&&Ke(t.y)&&n>=t.y,["".concat(Ys,"-top")]:Ke(n)&&t&&Ke(t.y)&&n<t.y})}function av(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(i&&Ke(i[n]))return i[n];var u=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return s[n]?u:f;var h=c[n];if(h==null)return 0;if(s[n]){var m=u,x=h;return m<x?Math.max(f,h):Math.max(u,h)}if(d==null)return 0;var g=f+l,v=h+d;return g>v?Math.max(u,h):Math.max(f,h)}function NP(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function _P(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:l,viewBox:c}=e,d,u,f;return s.height>0&&s.width>0&&r?(u=av({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=av({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),d=NP({translateX:u,translateY:f,useTranslate3d:l})):d=bP,{cssProperties:d,cssClasses:wP({translateX:u,translateY:f,coordinate:r})}}function iv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iv(Object(r),!0).forEach(function(n){zf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zf(e,t,r){return(t=SP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SP(e){var t=EP(e,"string");return typeof t=="symbol"?t:t+""}function EP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class TP extends p.PureComponent{constructor(){super(...arguments),zf(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),zf(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:f,useTranslate3d:h,viewBox:m,wrapperStyle:x,lastBoundingBox:g,innerRef:v,hasPortalFromProps:y}=this.props,{cssClasses:b,cssProperties:w}=_P({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:d,position:u,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:m}),N=y?{}:Sl(Sl({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),_=Sl(Sl({},N),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return p.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:_,ref:v},i)}}var CP=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ai={devToolsEnabled:!1,isSsr:CP()},D2=()=>He(e=>e.rootProps.accessibilityLayer);function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vf.apply(null,arguments)}function sv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ov(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sv(Object(r),!0).forEach(function(n){jP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jP(e,t,r){return(t=AP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AP(e){var t=kP(e,"string");return typeof t=="symbol"?t:t+""}function kP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lv={curveBasisClosed:Kj,curveBasisOpen:zj,curveBasis:Wj,curveBumpX:Aj,curveBumpY:kj,curveLinearClosed:Vj,curveLinear:gu,curveMonotoneX:Gj,curveMonotoneY:Yj,curveNatural:Xj,curveStep:qj,curveStepAfter:Jj,curveStepBefore:Zj},El=e=>Dr(e.x)&&Dr(e.y),Xs=e=>e.x,qs=e=>e.y,PP=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Vo(e));return(r==="curveMonotone"||r==="curveBump")&&t?lv["".concat(r).concat(t==="vertical"?"Y":"X")]:lv[r]||gu},OP=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=PP(t,a),l=i?r.filter(El):r,c;if(Array.isArray(n)){var d=i?n.filter(f=>El(f)):n,u=l.map((f,h)=>ov(ov({},f),{},{base:d[h]}));return a==="vertical"?c=gl().y(qs).x1(Xs).x0(f=>f.base.x):c=gl().x(Xs).y1(qs).y0(f=>f.base.y),c.defined(El).curve(s),c(u)}return a==="vertical"&&Ke(n)?c=gl().y(qs).x1(Xs).x0(n):Ke(n)?c=gl().x(Xs).y1(qs).y0(n):c=xw().x(Xs).y(qs),c.defined(El).curve(s),c(l)},hm=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?OP(e):n;return p.createElement("path",Vf({},xn(e),rm(e),{className:ct("recharts-curve",t),d:i===null?void 0:i,ref:a}))},DP=["x","y","top","left","width","height","className"];function Gf(){return Gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gf.apply(null,arguments)}function cv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cv(Object(r),!0).forEach(function(n){IP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IP(e,t,r){return(t=FP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FP(e){var t=MP(e,"string");return typeof t=="symbol"?t:t+""}function MP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LP(e,t){if(e==null)return{};var r,n,a=BP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $P=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),UP=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,c=LP(e,DP),d=RP({x:t,y:r,top:n,left:a,width:i,height:s},c);return!Ke(t)||!Ke(r)||!Ke(i)||!Ke(s)||!Ke(n)||!Ke(a)?null:p.createElement("path",Gf({},zr(d),{className:ct("recharts-cross",l),d:$P(t,r,i,s,n,a)}))};function HP(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function uv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uv(Object(r),!0).forEach(function(n){KP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KP(e,t,r){return(t=zP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zP(e){var t=VP(e,"string");return typeof t=="symbol"?t:t+""}function VP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function br(e,t){var r=WP({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}function GP(){}function YP(e){return e!=null}function dv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dv(Object(r),!0).forEach(function(n){XP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XP(e,t,r){return(t=qP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qP(e){var t=ZP(e,"string");return typeof t=="symbol"?t:t+""}function ZP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JP=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),R2=(e,t,r)=>e.map(n=>"".concat(JP(n)," ").concat(t,"ms ").concat(r)).join(","),QP=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Co=(e,t)=>Object.keys(t).reduce((r,n)=>fv(fv({},r),{},{[n]:e(n,t[n])}),{});function hv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hv(Object(r),!0).forEach(function(n){eO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eO(e,t,r){return(t=tO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tO(e){var t=rO(e,"string");return typeof t=="symbol"?t:t+""}function rO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vc=(e,t,r)=>e+(t-e)*r,Yf=e=>{var{from:t,to:r}=e;return t!==r},I2=(e,t,r)=>{var n=Co((a,i)=>{if(Yf(i)){var[s,l]=e(i.from,i.to,i.velocity);return mr(mr({},i),{},{from:s,velocity:l})}return i},t);return r<1?Co((a,i)=>Yf(i)?mr(mr({},i),{},{velocity:vc(i.velocity,n[a].velocity,r),from:vc(i.from,n[a].from,r)}):i,t):I2(e,n,r-1)};function nO(e,t,r,n,a,i){var s,l=n.reduce((h,m)=>mr(mr({},h),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),c=()=>Co((h,m)=>m.from,l),d=()=>!Object.values(l).filter(Yf).length,u=null,f=h=>{s||(s=h);var m=h-s,x=m/r.dt;l=I2(r,l,x),a(mr(mr(mr({},e),t),c())),s=h,d()||(u=i.setTimeout(f))};return()=>(u=i.setTimeout(f),()=>{u()})}function aO(e,t,r,n,a,i,s){var l=null,c=a.reduce((f,h)=>mr(mr({},f),{},{[h]:[e[h],t[h]]}),{}),d,u=f=>{d||(d=f);var h=(f-d)/n,m=Co((g,v)=>vc(...v,r(h)),c);if(i(mr(mr(mr({},e),t),m)),h<1)l=s.setTimeout(u);else{var x=Co((g,v)=>vc(...v,r(1)),c);i(mr(mr(mr({},e),t),x))}};return()=>(l=s.setTimeout(u),()=>{l()})}const iO=(e,t,r,n,a,i)=>{var s=QP(e,t);return r.isStepper===!0?nO(e,t,r,s,a,i):aO(e,t,r,n,s,a,i)};var yc=1e-4,F2=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],M2=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),mv=(e,t)=>r=>{var n=F2(e,t);return M2(n,r)},sO=(e,t)=>r=>{var n=F2(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return M2(a,r)},pv=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else s.length===4&&([t,n,r,a]=s);var d=mv(t,r),u=mv(n,a),f=sO(t,r),h=x=>x>1?1:x<0?0:x,m=x=>{for(var g=x>1?1:x,v=g,y=0;y<8;++y){var b=d(v)-g,w=f(v);if(Math.abs(b-g)<yc||w<yc)return u(v);v=h(v-b/w)}return u(v)};return m.isStepper=!1,m},oO=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,c)=>{var d=-(s-l)*r,u=c*n,f=c+(d-u)*a/1e3,h=c*a/1e3+s;return Math.abs(h-l)<yc&&Math.abs(f)<yc?[l,0]:[h,f]};return i.isStepper=!0,i.dt=a,i},lO=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return pv(e);case"spring":return oO();default:if(e.split("(")[0]==="cubic-bezier")return pv(e)}return typeof e=="function"?e:null};function cO(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[c,...d]=l;if(typeof c=="number"){a=e.setTimeout(i.bind(null,d),c);return}i(c),a=e.setTimeout(i.bind(null,d));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class uO{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function dO(){return cO(new uO)}var fO=p.createContext(dO);function hO(e,t){var r=p.useContext(fO);return p.useMemo(()=>t??r(e),[e,t,r])}var mO={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},xv={t:0},N0={t:1};function qo(e){var t=br(e,mO),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=hO(t.animationId,t.animationManager),[f,h]=p.useState(r?xv:N0),m=p.useRef(null);return p.useEffect(()=>{r||h(N0)},[r]),p.useEffect(()=>{if(!r||!n)return GP;var x=iO(xv,N0,lO(i),a,h,u.getTimeoutController()),g=()=>{m.current=x()};return u.start([c,s,g,a,l]),()=>{u.stop(),m.current&&m.current(),l()}},[r,n,a,i,s,c,l,u]),d(f.t)}function Zo(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=p.useRef(No(t)),n=p.useRef(e);return n.current!==e&&(r.current=No(t),n.current=e),r.current}var pO=["radius"],xO=["radius"];function gv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gv(Object(r),!0).forEach(function(n){gO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gO(e,t,r){return(t=vO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vO(e){var t=yO(e,"string");return typeof t=="symbol"?t:t+""}function yO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bc.apply(null,arguments)}function yv(e,t){if(e==null)return{};var r,n,a=bO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bv=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,d;if(i>0&&a instanceof Array){for(var u=[0,0,0,0],f=0,h=4;f<h;f++)u[f]=a[f]>i?i:a[f];d="M".concat(e,",").concat(t+s*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+s*u[1])),d+="L ".concat(e+r,",").concat(t+n-s*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+r-l*u[2],",").concat(t+n)),d+="L ".concat(e+l*u[3],",").concat(t+n),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-s*u[3])),d+="Z"}else if(i>0&&a===+a&&a>0){var m=Math.min(i,a);d="M ".concat(e,",").concat(t+s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+l*m,",").concat(t,`
            L `).concat(e+r-l*m,",").concat(t,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+r,",").concat(t+s*m,`
            L `).concat(e+r,",").concat(t+n-s*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e+r-l*m,",").concat(t+n,`
            L `).concat(e+l*m,",").concat(t+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(e,",").concat(t+n-s*m," Z")}else d="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return d},wO={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},L2=e=>{var t=br(e,wO),r=p.useRef(null),[n,a]=p.useState(-1);p.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var V=r.current.getTotalLength();V&&a(V)}catch{}},[]);var{x:i,y:s,width:l,height:c,radius:d,className:u}=t,{animationEasing:f,animationDuration:h,animationBegin:m,isAnimationActive:x,isUpdateAnimationActive:g}=t,v=p.useRef(l),y=p.useRef(c),b=p.useRef(i),w=p.useRef(s),N=p.useMemo(()=>({x:i,y:s,width:l,height:c,radius:d}),[i,s,l,c,d]),_=Zo(N,"rectangle-");if(i!==+i||s!==+s||l!==+l||c!==+c||l===0||c===0)return null;var E=ct("recharts-rectangle",u);if(!g){var S=zr(t),{radius:j}=S,P=yv(S,pO);return p.createElement("path",bc({},P,{radius:typeof d=="number"?d:void 0,className:E,d:bv(i,s,l,c,d)}))}var C=v.current,T=y.current,k=b.current,W=w.current,G="0px ".concat(n===-1?1:n,"px"),K="".concat(n,"px 0px"),J=R2(["strokeDasharray"],h,typeof f=="string"?f:void 0);return p.createElement(qo,{animationId:_,key:_,canBegin:n>0,duration:h,easing:f,isActive:g,begin:m},V=>{var Z=$t(C,l,V),Q=$t(T,c,V),Y=$t(k,i,V),le=$t(W,s,V);r.current&&(v.current=Z,y.current=Q,b.current=Y,w.current=le);var de;x?V>0?de={transition:J,strokeDasharray:K}:de={strokeDasharray:G}:de={strokeDasharray:K};var pe=zr(t),{radius:_e}=pe,q=yv(pe,xO);return p.createElement("path",bc({},q,{radius:typeof d=="number"?d:void 0,className:E,d:bv(Y,le,Z,Q,d),ref:r,style:vv(vv({},de),t.style)}))})};function B2(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Xt(t,r,n,a),l=Xt(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Xf(){return Xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xf.apply(null,arguments)}var NO=(e,t)=>{var r=cr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Tl=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:c}=e,d=l*(s?1:-1)+n,u=Math.asin(l/d)/xc,f=c?a:a+i*u,h=Xt(t,r,d,f),m=Xt(t,r,n,f),x=c?a-i*u:a,g=Xt(t,r,d*Math.cos(u*xc),x);return{center:h,circleTangency:m,lineTangency:g,theta:u}},$2=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=NO(i,s),c=i+l,d=Xt(t,r,a,i),u=Xt(t,r,a,c),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var h=Xt(t,r,n,i),m=Xt(t,r,n,c);f+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=c),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},_O=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=cr(d-c),{circleTangency:f,lineTangency:h,theta:m}=Tl({cx:t,cy:r,radius:a,angle:c,sign:u,cornerRadius:i,cornerIsExternal:l}),{circleTangency:x,lineTangency:g,theta:v}=Tl({cx:t,cy:r,radius:a,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:l}),y=l?Math.abs(c-d):Math.abs(c-d)-m-v;if(y<0)return s?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):$2({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:d});var b="M ".concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(y>180),",").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:w,lineTangency:N,theta:_}=Tl({cx:t,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:E,lineTangency:S,theta:j}=Tl({cx:t,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),P=l?Math.abs(c-d):Math.abs(c-d)-_-j;if(P<0&&i===0)return"".concat(b,"L").concat(t,",").concat(r,"Z");b+="L".concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(E.x,",").concat(E.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(w.x,",").concat(w.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(u<0),",").concat(N.x,",").concat(N.y,"Z")}else b+="L".concat(t,",").concat(r,"Z");return b},SO={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},U2=e=>{var t=br(e,SO),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:f}=t;if(i<a||d===u)return null;var h=ct("recharts-sector",f),m=i-a,x=kr(s,m,0,!0),g;return x>0&&Math.abs(d-u)<360?g=_O({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):g=$2({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u}),p.createElement("path",Xf({},zr(t),{className:h,d:g}))};function EO(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:c,innerRadius:d,outerRadius:u,angle:f}=t,h=Xt(l,c,d,f),m=Xt(l,c,u,f);n=h.x,a=h.y,i=m.x,s=m.y}else return B2(t);return[{x:n,y:a},{x:i,y:s}]}var _0={},S0={},E0={},wv;function TO(){return wv||(wv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hw();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(E0)),E0}var Nv;function CO(){return Nv||(Nv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TO();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(S0)),S0}var _v;function jO(){return _v||(_v=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ww(),r=CO();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=s;return c}e.range=n})(_0)),_0}var T0,Sv;function AO(){return Sv||(Sv=1,T0=jO().range),T0}var kO=AO();const H2=ri(kO);function za(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function PO(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mm(e){let t,r,n;e.length!==2?(t=za,r=(l,c)=>za(e(l),c),n=(l,c)=>e(l)-c):(t=e===za||e===PO?e:OO,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function OO(){return 0}function W2(e){return e===null?NaN:+e}function*DO(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const RO=mm(za),Jo=RO.right;mm(W2).center;class Ev extends Map{constructor(t,r=MO){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(Tv(this,t))}has(t){return super.has(Tv(this,t))}set(t,r){return super.set(IO(this,t),r)}delete(t){return super.delete(FO(this,t))}}function Tv({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function IO({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function FO({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function MO(e){return e!==null&&typeof e=="object"?e.valueOf():e}function LO(e=za){if(e===za)return K2;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function K2(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const BO=Math.sqrt(50),$O=Math.sqrt(10),UO=Math.sqrt(2);function wc(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=BO?10:i>=$O?5:i>=UO?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/s,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*s,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?wc(e,t,r*2):[l,c,d]}function qf(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?wc(t,e,r):wc(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let d=0;d<l;++d)c[d]=(i-d)/-s;else for(let d=0;d<l;++d)c[d]=(i-d)*s;else if(s<0)for(let d=0;d<l;++d)c[d]=(a+d)/-s;else for(let d=0;d<l;++d)c[d]=(a+d)*s;return c}function Zf(e,t,r){return t=+t,e=+e,r=+r,wc(e,t,r)[2]}function Jf(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Zf(t,e,r):Zf(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Cv(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function jv(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function z2(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?K2:LO(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),x=Math.min(n,Math.floor(t+(c-d)*f/c+h));z2(e,t,m,x,a)}const i=e[t];let s=r,l=n;for(Zs(e,r,t),a(e[n],i)>0&&Zs(e,r,n);s<l;){for(Zs(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?Zs(e,r,l):(++l,Zs(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Zs(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function HO(e,t,r){if(e=Float64Array.from(DO(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return jv(e);if(t>=1)return Cv(e);var n,a=(n-1)*t,i=Math.floor(a),s=Cv(z2(e,i).subarray(0,i+1)),l=jv(e.subarray(i+1));return s+(l-s)*(a-i)}}function WO(e,t,r=W2){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function KO(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Pn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Da(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Qf=Symbol("implicit");function pm(){var e=new Ev,t=[],r=[],n=Qf;function a(i){let s=e.get(i);if(s===void 0){if(n!==Qf)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Ev;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return pm(t,r).unknown(n)},Pn.apply(a,arguments),a}function xm(){var e=pm().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=a<n,x=m?a:n,g=m?n:a;i=(g-x)/Math.max(1,h-c+d*2),l&&(i=Math.floor(i)),x+=(g-x-i*(h-c))*u,s=i*(1-c),l&&(x=Math.round(x),s=Math.round(s));var v=KO(h).map(function(y){return x+i*y});return r(m?v.reverse():v)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return xm(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},Pn.apply(f(),arguments)}function V2(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return V2(t())},e}function zO(){return V2(xm.apply(null,arguments).paddingInner(1))}function gm(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function G2(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Qo(){}var jo=.7,Nc=1/jo,ss="\\s*([+-]?\\d+)\\s*",Ao="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VO=/^#([0-9a-f]{3,8})$/,GO=new RegExp(`^rgb\\(${ss},${ss},${ss}\\)$`),YO=new RegExp(`^rgb\\(${Jn},${Jn},${Jn}\\)$`),XO=new RegExp(`^rgba\\(${ss},${ss},${ss},${Ao}\\)$`),qO=new RegExp(`^rgba\\(${Jn},${Jn},${Jn},${Ao}\\)$`),ZO=new RegExp(`^hsl\\(${Ao},${Jn},${Jn}\\)$`),JO=new RegExp(`^hsla\\(${Ao},${Jn},${Jn},${Ao}\\)$`),Av={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gm(Qo,ko,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:kv,formatHex:kv,formatHex8:QO,formatHsl:e5,formatRgb:Pv,toString:Pv});function kv(){return this.rgb().formatHex()}function QO(){return this.rgb().formatHex8()}function e5(){return Y2(this).formatHsl()}function Pv(){return this.rgb().formatRgb()}function ko(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=VO.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ov(t):r===3?new tn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Cl(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Cl(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=GO.exec(e))?new tn(t[1],t[2],t[3],1):(t=YO.exec(e))?new tn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=XO.exec(e))?Cl(t[1],t[2],t[3],t[4]):(t=qO.exec(e))?Cl(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ZO.exec(e))?Iv(t[1],t[2]/100,t[3]/100,1):(t=JO.exec(e))?Iv(t[1],t[2]/100,t[3]/100,t[4]):Av.hasOwnProperty(e)?Ov(Av[e]):e==="transparent"?new tn(NaN,NaN,NaN,0):null}function Ov(e){return new tn(e>>16&255,e>>8&255,e&255,1)}function Cl(e,t,r,n){return n<=0&&(e=t=r=NaN),new tn(e,t,r,n)}function t5(e){return e instanceof Qo||(e=ko(e)),e?(e=e.rgb(),new tn(e.r,e.g,e.b,e.opacity)):new tn}function eh(e,t,r,n){return arguments.length===1?t5(e):new tn(e,t,r,n??1)}function tn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}gm(tn,eh,G2(Qo,{brighter(e){return e=e==null?Nc:Math.pow(Nc,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?jo:Math.pow(jo,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tn(Ni(this.r),Ni(this.g),Ni(this.b),_c(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dv,formatHex:Dv,formatHex8:r5,formatRgb:Rv,toString:Rv}));function Dv(){return`#${gi(this.r)}${gi(this.g)}${gi(this.b)}`}function r5(){return`#${gi(this.r)}${gi(this.g)}${gi(this.b)}${gi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Rv(){const e=_c(this.opacity);return`${e===1?"rgb(":"rgba("}${Ni(this.r)}, ${Ni(this.g)}, ${Ni(this.b)}${e===1?")":`, ${e})`}`}function _c(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ni(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function gi(e){return e=Ni(e),(e<16?"0":"")+e.toString(16)}function Iv(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Fn(e,t,r,n)}function Y2(e){if(e instanceof Fn)return new Fn(e.h,e.s,e.l,e.opacity);if(e instanceof Qo||(e=ko(e)),!e)return new Fn;if(e instanceof Fn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new Fn(s,l,c,e.opacity)}function n5(e,t,r,n){return arguments.length===1?Y2(e):new Fn(e,t,r,n??1)}function Fn(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}gm(Fn,n5,G2(Qo,{brighter(e){return e=e==null?Nc:Math.pow(Nc,e),new Fn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?jo:Math.pow(jo,e),new Fn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new tn(C0(e>=240?e-240:e+120,a,n),C0(e,a,n),C0(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Fn(Fv(this.h),jl(this.s),jl(this.l),_c(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=_c(this.opacity);return`${e===1?"hsl(":"hsla("}${Fv(this.h)}, ${jl(this.s)*100}%, ${jl(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fv(e){return e=(e||0)%360,e<0?e+360:e}function jl(e){return Math.max(0,Math.min(1,e||0))}function C0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const vm=e=>()=>e;function a5(e,t){return function(r){return e+r*t}}function i5(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function s5(e){return(e=+e)==1?X2:function(t,r){return r-t?i5(t,r,e):vm(isNaN(t)?r:t)}}function X2(e,t){var r=t-e;return r?a5(e,r):vm(isNaN(e)?t:e)}const Mv=(function e(t){var r=s5(t);function n(a,i){var s=r((a=eh(a)).r,(i=eh(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=X2(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n})(1);function o5(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function l5(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function c5(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=js(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function u5(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Sc(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function d5(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=js(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var th=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,j0=new RegExp(th.source,"g");function f5(e){return function(){return e}}function h5(e){return function(t){return e(t)+""}}function m5(e,t){var r=th.lastIndex=j0.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=th.exec(e))&&(a=j0.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:Sc(n,a)})),r=j0.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?h5(c[0].x):f5(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function js(e,t){var r=typeof t,n;return t==null||r==="boolean"?vm(t):(r==="number"?Sc:r==="string"?(n=ko(t))?(t=n,Mv):m5:t instanceof ko?Mv:t instanceof Date?u5:l5(t)?o5:Array.isArray(t)?c5:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?d5:Sc)(e,t)}function ym(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function p5(e,t){t===void 0&&(t=e,e=js);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function x5(e){return function(){return e}}function Ec(e){return+e}var Lv=[0,1];function Ur(e){return e}function rh(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:x5(isNaN(t)?NaN:.5)}function g5(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function v5(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=rh(a,n),i=r(s,i)):(n=rh(n,a),i=r(i,s)),function(l){return i(n(l))}}function y5(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=rh(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=Jo(e,l,1,n)-1;return i[c](a[c](l))}}function el(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Du(){var e=Lv,t=Lv,r=js,n,a,i,s=Ur,l,c,d;function u(){var h=Math.min(e.length,t.length);return s!==Ur&&(s=g5(e[0],e[h-1])),l=h>2?y5:v5,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(n),t,r)))(n(s(h)))}return f.invert=function(h){return s(a((d||(d=l(t,e.map(n),Sc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Ec),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=ym,u()},f.clamp=function(h){return arguments.length?(s=h?!0:Ur,u()):s!==Ur},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return n=h,a=m,u()}}function bm(){return Du()(Ur,Ur)}function b5(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Tc(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function vs(e){return e=Tc(Math.abs(e)),e?e[1]:NaN}function w5(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function N5(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var _5=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Po(e){if(!(t=_5.exec(e)))throw new Error("invalid format: "+e);var t;return new wm({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Po.prototype=wm.prototype;function wm(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wm.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function S5(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var q2;function E5(e,t){var r=Tc(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(q2=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Tc(e,Math.max(0,t+i-1))[0]}function Bv(e,t){var r=Tc(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const $v={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:b5,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Bv(e*100,t),r:Bv,s:E5,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Uv(e){return e}var Hv=Array.prototype.map,Wv=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function T5(e){var t=e.grouping===void 0||e.thousands===void 0?Uv:w5(Hv.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Uv:N5(Hv.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=Po(f);var h=f.fill,m=f.align,x=f.sign,g=f.symbol,v=f.zero,y=f.width,b=f.comma,w=f.precision,N=f.trim,_=f.type;_==="n"?(b=!0,_="g"):$v[_]||(w===void 0&&(w=12),N=!0,_="g"),(v||h==="0"&&m==="=")&&(v=!0,h="0",m="=");var E=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",S=g==="$"?n:/[%p]/.test(_)?s:"",j=$v[_],P=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function C(T){var k=E,W=S,G,K,J;if(_==="c")W=j(T)+W,T="";else{T=+T;var V=T<0||1/T<0;if(T=isNaN(T)?c:j(Math.abs(T),w),N&&(T=S5(T)),V&&+T==0&&x!=="+"&&(V=!1),k=(V?x==="("?x:l:x==="-"||x==="("?"":x)+k,W=(_==="s"?Wv[8+q2/3]:"")+W+(V&&x==="("?")":""),P){for(G=-1,K=T.length;++G<K;)if(J=T.charCodeAt(G),48>J||J>57){W=(J===46?a+T.slice(G+1):T.slice(G))+W,T=T.slice(0,G);break}}}b&&!v&&(T=t(T,1/0));var Z=k.length+T.length+W.length,Q=Z<y?new Array(y-Z+1).join(h):"";switch(b&&v&&(T=t(Q+T,Q.length?y-W.length:1/0),Q=""),m){case"<":T=k+T+W+Q;break;case"=":T=k+Q+T+W;break;case"^":T=Q.slice(0,Z=Q.length>>1)+k+T+W+Q.slice(Z);break;default:T=Q+k+T+W;break}return i(T)}return C.toString=function(){return f+""},C}function u(f,h){var m=d((f=Po(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(vs(h)/3)))*3,g=Math.pow(10,-x),v=Wv[8+x/3];return function(y){return m(g*y)+v}}return{format:d,formatPrefix:u}}var Al,Nm,Z2;C5({thousands:",",grouping:[3],currency:["$",""]});function C5(e){return Al=T5(e),Nm=Al.format,Z2=Al.formatPrefix,Al}function j5(e){return Math.max(0,-vs(Math.abs(e)))}function A5(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(vs(t)/3)))*3-vs(Math.abs(e)))}function k5(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,vs(t)-vs(e))+1}function J2(e,t,r,n){var a=Jf(e,t,r),i;switch(n=Po(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=A5(a,s))&&(n.precision=i),Z2(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=k5(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=j5(a))&&(n.precision=i-(n.type==="%")*2);break}}return Nm(n)}function ii(e){var t=e.domain;return e.ticks=function(r){var n=t();return qf(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return J2(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,d,u=10;for(l<s&&(d=s,s=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=Zf(s,l,r),d===c)return n[a]=s,n[i]=l,t(n);if(d>0)s=Math.floor(s/d)*d,l=Math.ceil(l/d)*d;else if(d<0)s=Math.ceil(s*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function Q2(){var e=bm();return e.copy=function(){return el(e,Q2())},Pn.apply(e,arguments),ii(e)}function eN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Ec),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return eN(e).unknown(t)},e=arguments.length?Array.from(e,Ec):[0,1],ii(r)}function tN(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Kv(e){return Math.log(e)}function zv(e){return Math.exp(e)}function P5(e){return-Math.log(-e)}function O5(e){return-Math.exp(-e)}function D5(e){return isFinite(e)?+("1e"+e):e<0?0:e}function R5(e){return e===10?D5:e===Math.E?Math.exp:t=>Math.pow(e,t)}function I5(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Vv(e){return(t,r)=>-e(-t,r)}function _m(e){const t=e(Kv,zv),r=t.domain;let n=10,a,i;function s(){return a=I5(n),i=R5(n),r()[0]<0?(a=Vv(a),i=Vv(i),e(P5,O5)):e(Kv,zv),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=a(d),m=a(u),x,g;const v=l==null?10:+l;let y=[];if(!(n%1)&&m-h<v){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(x=1;x<n;++x)if(g=h<0?x/i(-h):x*i(h),!(g<d)){if(g>u)break;y.push(g)}}else for(;h<=m;++h)for(x=n-1;x>=1;--x)if(g=h>0?x/i(-h):x*i(h),!(g<d)){if(g>u)break;y.push(g)}y.length*2<v&&(y=qf(d,u,v))}else y=qf(h,m,Math.min(m-h,v)).map(i);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Po(c)).precision==null&&(c.trim=!0),c=Nm(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(tN(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function rN(){const e=_m(Du()).domain([1,10]);return e.copy=()=>el(e,rN()).base(e.base()),Pn.apply(e,arguments),e}function Gv(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Yv(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Sm(e){var t=1,r=e(Gv(t),Yv(t));return r.constant=function(n){return arguments.length?e(Gv(t=+n),Yv(t)):t},ii(r)}function nN(){var e=Sm(Du());return e.copy=function(){return el(e,nN()).constant(e.constant())},Pn.apply(e,arguments)}function Xv(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function F5(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function M5(e){return e<0?-e*e:e*e}function Em(e){var t=e(Ur,Ur),r=1;function n(){return r===1?e(Ur,Ur):r===.5?e(F5,M5):e(Xv(r),Xv(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ii(t)}function Tm(){var e=Em(Du());return e.copy=function(){return el(e,Tm()).exponent(e.exponent())},Pn.apply(e,arguments),e}function L5(){return Tm.apply(null,arguments).exponent(.5)}function qv(e){return Math.sign(e)*e*e}function B5(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function aN(){var e=bm(),t=[0,1],r=!1,n;function a(i){var s=B5(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(qv(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Ec)).map(qv)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return aN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Pn.apply(a,arguments),ii(a)}function iN(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=WO(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Jo(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(za),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return iN().domain(e).range(t).unknown(n)},Pn.apply(i,arguments)}function sN(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Jo(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return sN().domain([e,t]).range(a).unknown(i)},Pn.apply(ii(s),arguments)}function oN(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Jo(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return oN().domain(e).range(t).unknown(r)},Pn.apply(a,arguments)}const A0=new Date,k0=new Date;function ar(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<s);return c},a.filter=i=>ar(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(A0.setTime(+i),k0.setTime(+s),e(A0),e(k0),Math.floor(r(A0,k0))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Cc=ar(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Cc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ar(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Cc);Cc.range;const ha=1e3,Cn=ha*60,ma=Cn*60,Ea=ma*24,Cm=Ea*7,Zv=Ea*30,P0=Ea*365,vi=ar(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ha)},(e,t)=>(t-e)/ha,e=>e.getUTCSeconds());vi.range;const jm=ar(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ha)},(e,t)=>{e.setTime(+e+t*Cn)},(e,t)=>(t-e)/Cn,e=>e.getMinutes());jm.range;const Am=ar(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Cn)},(e,t)=>(t-e)/Cn,e=>e.getUTCMinutes());Am.range;const km=ar(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ha-e.getMinutes()*Cn)},(e,t)=>{e.setTime(+e+t*ma)},(e,t)=>(t-e)/ma,e=>e.getHours());km.range;const Pm=ar(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ma)},(e,t)=>(t-e)/ma,e=>e.getUTCHours());Pm.range;const tl=ar(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Cn)/Ea,e=>e.getDate()-1);tl.range;const Ru=ar(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ea,e=>e.getUTCDate()-1);Ru.range;const lN=ar(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ea,e=>Math.floor(e/Ea));lN.range;function $i(e){return ar(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Cn)/Cm)}const Iu=$i(0),jc=$i(1),$5=$i(2),U5=$i(3),ys=$i(4),H5=$i(5),W5=$i(6);Iu.range;jc.range;$5.range;U5.range;ys.range;H5.range;W5.range;function Ui(e){return ar(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Cm)}const Fu=Ui(0),Ac=Ui(1),K5=Ui(2),z5=Ui(3),bs=Ui(4),V5=Ui(5),G5=Ui(6);Fu.range;Ac.range;K5.range;z5.range;bs.range;V5.range;G5.range;const Om=ar(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Om.range;const Dm=ar(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Dm.range;const Ta=ar(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ta.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ar(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ta.range;const Ca=ar(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ca.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ar(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Ca.range;function cN(e,t,r,n,a,i){const s=[[vi,1,ha],[vi,5,5*ha],[vi,15,15*ha],[vi,30,30*ha],[i,1,Cn],[i,5,5*Cn],[i,15,15*Cn],[i,30,30*Cn],[a,1,ma],[a,3,3*ma],[a,6,6*ma],[a,12,12*ma],[n,1,Ea],[n,2,2*Ea],[r,1,Cm],[t,1,Zv],[t,3,3*Zv],[e,1,P0]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),x=m?m.range(d,+u+1):[];return h?x.reverse():x}function c(d,u,f){const h=Math.abs(u-d)/f,m=mm(([,,v])=>v).right(s,h);if(m===s.length)return e.every(Jf(d/P0,u/P0,f));if(m===0)return Cc.every(Math.max(Jf(d,u,f),1));const[x,g]=s[h/s[m-1][2]<s[m][2]/h?m-1:m];return x.every(g)}return[l,c]}const[Y5,X5]=cN(Ca,Dm,Fu,lN,Pm,Am),[q5,Z5]=cN(Ta,Om,Iu,tl,km,jm);function O0(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function D0(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Js(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function J5(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,d=Qs(a),u=eo(a),f=Qs(i),h=eo(i),m=Qs(s),x=eo(s),g=Qs(l),v=eo(l),y=Qs(c),b=eo(c),w={a:V,A:Z,b:Q,B:Y,c:null,d:n1,e:n1,f:w3,g:P3,G:D3,H:v3,I:y3,j:b3,L:uN,m:N3,M:_3,p:le,q:de,Q:s1,s:o1,S:S3,u:E3,U:T3,V:C3,w:j3,W:A3,x:null,X:null,y:k3,Y:O3,Z:R3,"%":i1},N={a:pe,A:_e,b:q,B:oe,c:null,d:a1,e:a1,f:L3,g:Y3,G:q3,H:I3,I:F3,j:M3,L:fN,m:B3,M:$3,p:ve,q:O,Q:s1,s:o1,S:U3,u:H3,U:W3,V:K3,w:z3,W:V3,x:null,X:null,y:G3,Y:X3,Z:Z3,"%":i1},_={a:C,A:T,b:k,B:W,c:G,d:t1,e:t1,f:m3,g:e1,G:Qv,H:r1,I:r1,j:u3,L:h3,m:c3,M:d3,p:P,q:l3,Q:x3,s:g3,S:f3,u:n3,U:a3,V:i3,w:r3,W:s3,x:K,X:J,y:e1,Y:Qv,Z:o3,"%":p3};w.x=E(r,w),w.X=E(n,w),w.c=E(t,w),N.x=E(r,N),N.X=E(n,N),N.c=E(t,N);function E(D,M){return function(I){var z=[],se=-1,ce=0,Ae=D.length,be,X,fe;for(I instanceof Date||(I=new Date(+I));++se<Ae;)D.charCodeAt(se)===37&&(z.push(D.slice(ce,se)),(X=Jv[be=D.charAt(++se)])!=null?be=D.charAt(++se):X=be==="e"?" ":"0",(fe=M[be])&&(be=fe(I,X)),z.push(be),ce=se+1);return z.push(D.slice(ce,se)),z.join("")}}function S(D,M){return function(I){var z=Js(1900,void 0,1),se=j(z,D,I+="",0),ce,Ae;if(se!=I.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(M&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(ce=D0(Js(z.y,0,1)),Ae=ce.getUTCDay(),ce=Ae>4||Ae===0?Ac.ceil(ce):Ac(ce),ce=Ru.offset(ce,(z.V-1)*7),z.y=ce.getUTCFullYear(),z.m=ce.getUTCMonth(),z.d=ce.getUTCDate()+(z.w+6)%7):(ce=O0(Js(z.y,0,1)),Ae=ce.getDay(),ce=Ae>4||Ae===0?jc.ceil(ce):jc(ce),ce=tl.offset(ce,(z.V-1)*7),z.y=ce.getFullYear(),z.m=ce.getMonth(),z.d=ce.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),Ae="Z"in z?D0(Js(z.y,0,1)).getUTCDay():O0(Js(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(Ae+5)%7:z.w+z.U*7-(Ae+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,D0(z)):O0(z)}}function j(D,M,I,z){for(var se=0,ce=M.length,Ae=I.length,be,X;se<ce;){if(z>=Ae)return-1;if(be=M.charCodeAt(se++),be===37){if(be=M.charAt(se++),X=_[be in Jv?M.charAt(se++):be],!X||(z=X(D,I,z))<0)return-1}else if(be!=I.charCodeAt(z++))return-1}return z}function P(D,M,I){var z=d.exec(M.slice(I));return z?(D.p=u.get(z[0].toLowerCase()),I+z[0].length):-1}function C(D,M,I){var z=m.exec(M.slice(I));return z?(D.w=x.get(z[0].toLowerCase()),I+z[0].length):-1}function T(D,M,I){var z=f.exec(M.slice(I));return z?(D.w=h.get(z[0].toLowerCase()),I+z[0].length):-1}function k(D,M,I){var z=y.exec(M.slice(I));return z?(D.m=b.get(z[0].toLowerCase()),I+z[0].length):-1}function W(D,M,I){var z=g.exec(M.slice(I));return z?(D.m=v.get(z[0].toLowerCase()),I+z[0].length):-1}function G(D,M,I){return j(D,t,M,I)}function K(D,M,I){return j(D,r,M,I)}function J(D,M,I){return j(D,n,M,I)}function V(D){return s[D.getDay()]}function Z(D){return i[D.getDay()]}function Q(D){return c[D.getMonth()]}function Y(D){return l[D.getMonth()]}function le(D){return a[+(D.getHours()>=12)]}function de(D){return 1+~~(D.getMonth()/3)}function pe(D){return s[D.getUTCDay()]}function _e(D){return i[D.getUTCDay()]}function q(D){return c[D.getUTCMonth()]}function oe(D){return l[D.getUTCMonth()]}function ve(D){return a[+(D.getUTCHours()>=12)]}function O(D){return 1+~~(D.getUTCMonth()/3)}return{format:function(D){var M=E(D+="",w);return M.toString=function(){return D},M},parse:function(D){var M=S(D+="",!1);return M.toString=function(){return D},M},utcFormat:function(D){var M=E(D+="",N);return M.toString=function(){return D},M},utcParse:function(D){var M=S(D+="",!0);return M.toString=function(){return D},M}}}var Jv={"-":"",_:" ",0:"0"},ur=/^\s*\d+/,Q5=/^%/,e3=/[\\^$*+?|[\]().{}]/g;function st(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function t3(e){return e.replace(e3,"\\$&")}function Qs(e){return new RegExp("^(?:"+e.map(t3).join("|")+")","i")}function eo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function r3(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function n3(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function a3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function i3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function s3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Qv(e,t,r){var n=ur.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function e1(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function o3(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function l3(e,t,r){var n=ur.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function c3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function t1(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function u3(e,t,r){var n=ur.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function r1(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function d3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function f3(e,t,r){var n=ur.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function h3(e,t,r){var n=ur.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function m3(e,t,r){var n=ur.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function p3(e,t,r){var n=Q5.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function x3(e,t,r){var n=ur.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function g3(e,t,r){var n=ur.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function n1(e,t){return st(e.getDate(),t,2)}function v3(e,t){return st(e.getHours(),t,2)}function y3(e,t){return st(e.getHours()%12||12,t,2)}function b3(e,t){return st(1+tl.count(Ta(e),e),t,3)}function uN(e,t){return st(e.getMilliseconds(),t,3)}function w3(e,t){return uN(e,t)+"000"}function N3(e,t){return st(e.getMonth()+1,t,2)}function _3(e,t){return st(e.getMinutes(),t,2)}function S3(e,t){return st(e.getSeconds(),t,2)}function E3(e){var t=e.getDay();return t===0?7:t}function T3(e,t){return st(Iu.count(Ta(e)-1,e),t,2)}function dN(e){var t=e.getDay();return t>=4||t===0?ys(e):ys.ceil(e)}function C3(e,t){return e=dN(e),st(ys.count(Ta(e),e)+(Ta(e).getDay()===4),t,2)}function j3(e){return e.getDay()}function A3(e,t){return st(jc.count(Ta(e)-1,e),t,2)}function k3(e,t){return st(e.getFullYear()%100,t,2)}function P3(e,t){return e=dN(e),st(e.getFullYear()%100,t,2)}function O3(e,t){return st(e.getFullYear()%1e4,t,4)}function D3(e,t){var r=e.getDay();return e=r>=4||r===0?ys(e):ys.ceil(e),st(e.getFullYear()%1e4,t,4)}function R3(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+st(t/60|0,"0",2)+st(t%60,"0",2)}function a1(e,t){return st(e.getUTCDate(),t,2)}function I3(e,t){return st(e.getUTCHours(),t,2)}function F3(e,t){return st(e.getUTCHours()%12||12,t,2)}function M3(e,t){return st(1+Ru.count(Ca(e),e),t,3)}function fN(e,t){return st(e.getUTCMilliseconds(),t,3)}function L3(e,t){return fN(e,t)+"000"}function B3(e,t){return st(e.getUTCMonth()+1,t,2)}function $3(e,t){return st(e.getUTCMinutes(),t,2)}function U3(e,t){return st(e.getUTCSeconds(),t,2)}function H3(e){var t=e.getUTCDay();return t===0?7:t}function W3(e,t){return st(Fu.count(Ca(e)-1,e),t,2)}function hN(e){var t=e.getUTCDay();return t>=4||t===0?bs(e):bs.ceil(e)}function K3(e,t){return e=hN(e),st(bs.count(Ca(e),e)+(Ca(e).getUTCDay()===4),t,2)}function z3(e){return e.getUTCDay()}function V3(e,t){return st(Ac.count(Ca(e)-1,e),t,2)}function G3(e,t){return st(e.getUTCFullYear()%100,t,2)}function Y3(e,t){return e=hN(e),st(e.getUTCFullYear()%100,t,2)}function X3(e,t){return st(e.getUTCFullYear()%1e4,t,4)}function q3(e,t){var r=e.getUTCDay();return e=r>=4||r===0?bs(e):bs.ceil(e),st(e.getUTCFullYear()%1e4,t,4)}function Z3(){return"+0000"}function i1(){return"%"}function s1(e){return+e}function o1(e){return Math.floor(+e/1e3)}var Vi,mN,pN;J3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function J3(e){return Vi=J5(e),mN=Vi.format,Vi.parse,pN=Vi.utcFormat,Vi.utcParse,Vi}function Q3(e){return new Date(e)}function eD(e){return e instanceof Date?+e:+new Date(+e)}function Rm(e,t,r,n,a,i,s,l,c,d){var u=bm(),f=u.invert,h=u.domain,m=d(".%L"),x=d(":%S"),g=d("%I:%M"),v=d("%I %p"),y=d("%a %d"),b=d("%b %d"),w=d("%B"),N=d("%Y");function _(E){return(c(E)<E?m:l(E)<E?x:s(E)<E?g:i(E)<E?v:n(E)<E?a(E)<E?y:b:r(E)<E?w:N)(E)}return u.invert=function(E){return new Date(f(E))},u.domain=function(E){return arguments.length?h(Array.from(E,eD)):h().map(Q3)},u.ticks=function(E){var S=h();return e(S[0],S[S.length-1],E??10)},u.tickFormat=function(E,S){return S==null?_:d(S)},u.nice=function(E){var S=h();return(!E||typeof E.range!="function")&&(E=t(S[0],S[S.length-1],E??10)),E?h(tN(S,E)):u},u.copy=function(){return el(u,Rm(e,t,r,n,a,i,s,l,c,d))},u}function tD(){return Pn.apply(Rm(q5,Z5,Ta,Om,Iu,tl,km,jm,vi,mN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function rD(){return Pn.apply(Rm(Y5,X5,Ca,Dm,Fu,Ru,Pm,Am,vi,pN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Mu(){var e=0,t=1,r,n,a,i,s=Ur,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(s=f,d):s};function u(f){return function(h){var m,x;return arguments.length?([m,x]=h,s=f(m,x),d):[s(0),s(1)]}}return d.range=u(js),d.rangeRound=u(ym),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function si(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function xN(){var e=ii(Mu()(Ur));return e.copy=function(){return si(e,xN())},Da.apply(e,arguments)}function gN(){var e=_m(Mu()).domain([1,10]);return e.copy=function(){return si(e,gN()).base(e.base())},Da.apply(e,arguments)}function vN(){var e=Sm(Mu());return e.copy=function(){return si(e,vN()).constant(e.constant())},Da.apply(e,arguments)}function Im(){var e=Em(Mu());return e.copy=function(){return si(e,Im()).exponent(e.exponent())},Da.apply(e,arguments)}function nD(){return Im.apply(null,arguments).exponent(.5)}function yN(){var e=[],t=Ur;function r(n){if(n!=null&&!isNaN(n=+n))return t((Jo(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(za),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>HO(e,i/n))},r.copy=function(){return yN(t).domain(e)},Da.apply(r,arguments)}function Lu(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,d=Ur,u,f=!1,h;function m(g){return isNaN(g=+g)?h:(g=.5+((g=+u(g))-i)*(n*g<n*i?l:c),d(f?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),s=u(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(f=!!g,m):f},m.interpolator=function(g){return arguments.length?(d=g,m):d};function x(g){return function(v){var y,b,w;return arguments.length?([y,b,w]=v,d=p5(g,[y,b,w]),m):[d(0),d(.5),d(1)]}}return m.range=x(js),m.rangeRound=x(ym),m.unknown=function(g){return arguments.length?(h=g,m):h},function(g){return u=g,a=g(e),i=g(t),s=g(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,m}}function bN(){var e=ii(Lu()(Ur));return e.copy=function(){return si(e,bN())},Da.apply(e,arguments)}function wN(){var e=_m(Lu()).domain([.1,1,10]);return e.copy=function(){return si(e,wN()).base(e.base())},Da.apply(e,arguments)}function NN(){var e=Sm(Lu());return e.copy=function(){return si(e,NN()).constant(e.constant())},Da.apply(e,arguments)}function Fm(){var e=Em(Lu());return e.copy=function(){return si(e,Fm()).exponent(e.exponent())},Da.apply(e,arguments)}function aD(){return Fm.apply(null,arguments).exponent(.5)}const so=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:xm,scaleDiverging:bN,scaleDivergingLog:wN,scaleDivergingPow:Fm,scaleDivergingSqrt:aD,scaleDivergingSymlog:NN,scaleIdentity:eN,scaleImplicit:Qf,scaleLinear:Q2,scaleLog:rN,scaleOrdinal:pm,scalePoint:zO,scalePow:Tm,scaleQuantile:iN,scaleQuantize:sN,scaleRadial:aN,scaleSequential:xN,scaleSequentialLog:gN,scaleSequentialPow:Im,scaleSequentialQuantile:yN,scaleSequentialSqrt:nD,scaleSequentialSymlog:vN,scaleSqrt:L5,scaleSymlog:nN,scaleThreshold:oN,scaleTime:tD,scaleUtc:rD,tickFormat:J2},Symbol.toStringTag,{value:"Module"}));var oi=e=>e.chartData,Mm=ie([oi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Bu=(e,t,r,n)=>n?Mm(e):oi(e);function Ai(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Dr(t)&&Dr(r))return!0}return!1}function l1(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function _N(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Dr(r))a=r;else if(typeof r=="function")return;if(Dr(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Ai(s))return s}}function iD(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Ai(n))return l1(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Ke(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&Gg.test(a)){var c=Gg.exec(a);if(c==null||t==null)s=void 0;else{var d=+c[1];s=t[0]-d}}else s=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ke(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&Yg.test(i)){var u=Yg.exec(i);if(u==null||t==null)l=void 0;else{var f=+u[1];l=t[1]+f}}else l=t?.[1];var h=[s,l];if(Ai(h))return t==null?h:l1(h,t,r)}}}var As=1e9,sD={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Bm,At=!0,kn="[DecimalError] ",_i=kn+"Invalid argument: ",Lm=kn+"Exponent out of range: ",ks=Math.floor,mi=Math.pow,oD=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hn,or=1e7,_t=7,SN=9007199254740991,kc=ks(SN/_t),Fe={};Fe.absoluteValue=Fe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Fe.comparedTo=Fe.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Fe.decimalPlaces=Fe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*_t;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Fe.dividedBy=Fe.div=function(e){return va(this,new this.constructor(e))};Fe.dividedToIntegerBy=Fe.idiv=function(e){var t=this,r=t.constructor;return yt(va(t,new r(e),0,1),r.precision)};Fe.equals=Fe.eq=function(e){return!this.cmp(e)};Fe.exponent=function(){return Jt(this)};Fe.greaterThan=Fe.gt=function(e){return this.cmp(e)>0};Fe.greaterThanOrEqualTo=Fe.gte=function(e){return this.cmp(e)>=0};Fe.isInteger=Fe.isint=function(){return this.e>this.d.length-2};Fe.isNegative=Fe.isneg=function(){return this.s<0};Fe.isPositive=Fe.ispos=function(){return this.s>0};Fe.isZero=function(){return this.s===0};Fe.lessThan=Fe.lt=function(e){return this.cmp(e)<0};Fe.lessThanOrEqualTo=Fe.lte=function(e){return this.cmp(e)<1};Fe.logarithm=Fe.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(hn))throw Error(kn+"NaN");if(r.s<1)throw Error(kn+(r.s?"NaN":"-Infinity"));return r.eq(hn)?new n(0):(At=!1,t=va(Oo(r,i),Oo(e,i),i),At=!0,yt(t,a))};Fe.minus=Fe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?CN(t,e):EN(t,(e.s=-e.s,e))};Fe.modulo=Fe.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(kn+"NaN");return r.s?(At=!1,t=va(r,e,0,1).times(e),At=!0,r.minus(t)):yt(new n(r),a)};Fe.naturalExponential=Fe.exp=function(){return TN(this)};Fe.naturalLogarithm=Fe.ln=function(){return Oo(this)};Fe.negated=Fe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Fe.plus=Fe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?EN(t,e):CN(t,(e.s=-e.s,e))};Fe.precision=Fe.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(_i+e);if(t=Jt(a)+1,n=a.d.length-1,r=n*_t+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Fe.squareRoot=Fe.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(kn+"NaN")}for(e=Jt(l),At=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=qn(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ks((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(va(l,i,s+2)).times(.5),qn(i.d).slice(0,s)===(t=qn(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(yt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return At=!0,yt(n,r)};Fe.times=Fe.mul=function(e){var t,r,n,a,i,s,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(i=h,h=m,m=i,s=c,c=d,d=s),i=[],s=c+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+m[n]*h[a-n-1]+t,i[a--]=l%or|0,t=l/or|0;i[a]=(i[a]+t)%or|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,At?yt(e,f.precision):e};Fe.toDecimalPlaces=Fe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(na(e,0,As),t===void 0?t=n.rounding:na(t,0,8),yt(r,e+Jt(r)+1,t))};Fe.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=ki(n,!0):(na(e,0,As),t===void 0?t=a.rounding:na(t,0,8),n=yt(new a(n),e+1,t),r=ki(n,!0,e+1)),r};Fe.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?ki(a):(na(e,0,As),t===void 0?t=i.rounding:na(t,0,8),n=yt(new i(a),e+Jt(a)+1,t),r=ki(n.abs(),!1,e+Jt(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Fe.toInteger=Fe.toint=function(){var e=this,t=e.constructor;return yt(new t(e),Jt(e)+1,t.rounding)};Fe.toNumber=function(){return+this};Fe.toPower=Fe.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(hn);if(l=new c(l),!l.s){if(e.s<1)throw Error(kn+"Infinity");return l}if(l.eq(hn))return l;if(n=c.precision,e.eq(hn))return yt(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=u<0?-u:u)<=SN){for(a=new c(hn),t=Math.ceil(n/_t+4),At=!1;r%2&&(a=a.times(l),u1(a.d,t)),r=ks(r/2),r!==0;)l=l.times(l),u1(l.d,t);return At=!0,e.s<0?new c(hn).div(a):yt(a,n)}}else if(i<0)throw Error(kn+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,At=!1,a=e.times(Oo(l,n+d)),At=!0,a=TN(a),a.s=i,a};Fe.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Jt(a),n=ki(a,r<=i.toExpNeg||r>=i.toExpPos)):(na(e,1,As),t===void 0?t=i.rounding:na(t,0,8),a=yt(new i(a),e,t),r=Jt(a),n=ki(a,e<=r||r<=i.toExpNeg,e)),n};Fe.toSignificantDigits=Fe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(na(e,1,As),t===void 0?t=n.rounding:na(t,0,8)),yt(new n(r),e,t)};Fe.toString=Fe.valueOf=Fe.val=Fe.toJSON=Fe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Jt(e),r=e.constructor;return ki(e,t<=r.toExpNeg||t>=r.toExpPos)};function EN(e,t){var r,n,a,i,s,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),At?yt(t,f):t;if(c=e.d,d=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=s,l=c.length),s=Math.ceil(f/_t),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/or|0,c[i]%=or;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,At?yt(t,f):t}function na(e,t,r){if(e!==~~e||e<t||e>r)throw Error(_i+e)}function qn(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=_t-n.length,r&&(i+=Ua(r)),i+=n;s=e[t],n=s+"",r=_t-n.length,r&&(i+=Ua(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var va=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%or|0,s=i/or|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*or+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,d,u,f,h,m,x,g,v,y,b,w,N,_,E,S,j,P=n.constructor,C=n.s==a.s?1:-1,T=n.d,k=a.d;if(!n.s)return new P(n);if(!a.s)throw Error(kn+"Division by zero");for(c=n.e-a.e,S=k.length,_=T.length,m=new P(C),x=m.d=[],d=0;k[d]==(T[d]||0);)++d;if(k[d]>(T[d]||0)&&--c,i==null?b=i=P.precision:s?b=i+(Jt(n)-Jt(a))+1:b=i,b<0)return new P(0);if(b=b/_t+2|0,d=0,S==1)for(u=0,k=k[0],b++;(d<_||u)&&b--;d++)w=u*or+(T[d]||0),x[d]=w/k|0,u=w%k|0;else{for(u=or/(k[0]+1)|0,u>1&&(k=e(k,u),T=e(T,u),S=k.length,_=T.length),N=S,g=T.slice(0,S),v=g.length;v<S;)g[v++]=0;j=k.slice(),j.unshift(0),E=k[0],k[1]>=or/2&&++E;do u=0,l=t(k,g,S,v),l<0?(y=g[0],S!=v&&(y=y*or+(g[1]||0)),u=y/E|0,u>1?(u>=or&&(u=or-1),f=e(k,u),h=f.length,v=g.length,l=t(f,g,h,v),l==1&&(u--,r(f,S<h?j:k,h))):(u==0&&(l=u=1),f=k.slice()),h=f.length,h<v&&f.unshift(0),r(g,f,v),l==-1&&(v=g.length,l=t(k,g,S,v),l<1&&(u++,r(g,S<v?j:k,v))),v=g.length):l===0&&(u++,g=[0]),x[d++]=u,l&&g[0]?g[v++]=T[N]||0:(g=[T[N]],v=1);while((N++<_||g[0]!==void 0)&&b--)}return x[0]||x.shift(),m.e=c,yt(m,s?i+Jt(m)+1:i)}})();function TN(e,t){var r,n,a,i,s,l,c=0,d=0,u=e.constructor,f=u.precision;if(Jt(e)>16)throw Error(Lm+Jt(e));if(!e.s)return new u(hn);for(At=!1,l=f,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(mi(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(hn),u.precision=l;;){if(a=yt(a.times(e),l),r=r.times(++c),s=i.plus(va(a,r,l)),qn(s.d).slice(0,l)===qn(i.d).slice(0,l)){for(;d--;)i=yt(i.times(i),l);return u.precision=f,t==null?(At=!0,yt(i,f)):i}i=s}}function Jt(e){for(var t=e.e*_t,r=e.d[0];r>=10;r/=10)t++;return t}function R0(e,t,r){if(t>e.LN10.sd())throw At=!0,r&&(e.precision=r),Error(kn+"LN10 precision limit exceeded");return yt(new e(e.LN10),t)}function Ua(e){for(var t="";e--;)t+="0";return t}function Oo(e,t){var r,n,a,i,s,l,c,d,u,f=1,h=10,m=e,x=m.d,g=m.constructor,v=g.precision;if(m.s<1)throw Error(kn+(m.s?"NaN":"-Infinity"));if(m.eq(hn))return new g(0);if(t==null?(At=!1,d=v):d=t,m.eq(10))return t==null&&(At=!0),R0(g,d);if(d+=h,g.precision=d,r=qn(x),n=r.charAt(0),i=Jt(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=qn(m.d),n=r.charAt(0),f++;i=Jt(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return c=R0(g,d+2,v).times(i+""),m=Oo(new g(n+"."+r.slice(1)),d-h).plus(c),g.precision=v,t==null?(At=!0,yt(m,v)):m;for(l=s=m=va(m.minus(hn),m.plus(hn),d),u=yt(m.times(m),d),a=3;;){if(s=yt(s.times(u),d),c=l.plus(va(s,new g(a),d)),qn(c.d).slice(0,d)===qn(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(R0(g,d+2,v).times(i+""))),l=va(l,new g(f),d),g.precision=v,t==null?(At=!0,yt(l,v)):l;l=c,a+=2}}function c1(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ks(r/_t),e.d=[],n=(r+1)%_t,r<0&&(n+=_t),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=_t;n<a;)e.d.push(+t.slice(n,n+=_t));t=t.slice(n),n=_t-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),At&&(e.e>kc||e.e<-kc))throw Error(Lm+r)}else e.s=0,e.e=0,e.d=[0];return e}function yt(e,t,r){var n,a,i,s,l,c,d,u,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=_t,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/_t),i=f.length,u>=i)return e;for(d=i=f[u],s=1;i>=10;i/=10)s++;n%=_t,a=n-_t+s}if(r!==void 0&&(i=mi(10,s-a-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/mi(10,s-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Jt(e),f.length=1,t=t-i-1,f[0]=mi(10,(_t-t%_t)%_t),e.e=ks(-t/_t)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=mi(10,_t-n),f[u]=a>0?(d/mi(10,s-a)%mi(10,a)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==or&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=or)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(At&&(e.e>kc||e.e<-kc))throw Error(Lm+Jt(e));return e}function CN(e,t){var r,n,a,i,s,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),At?yt(t,m):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),s=d-n,s){for(u=s<0,u?(r=c,s=-s,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(m/_t),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}s=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=or-1;--c[i],c[a]+=or}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,At?yt(t,m):t):new h(0)}function ki(e,t,r){var n,a=Jt(e),i=qn(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Ua(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ua(-a-1)+i,r&&(n=r-s)>0&&(i+=Ua(n))):a>=s?(i+=Ua(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Ua(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Ua(n))),e.s<0?"-"+i:i}function u1(e,t){if(e.length>t)return e.length=t,!0}function jN(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(_i+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return c1(s,i.toString())}else if(typeof i!="string")throw Error(_i+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,oD.test(i))c1(s,i);else throw Error(_i+i)}if(a.prototype=Fe,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=jN,a.config=a.set=lD,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function lD(e){if(!e||typeof e!="object")throw Error(kn+"Object expected");var t,r,n,a=["precision",1,As,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ks(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(_i+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(_i+r+": "+n);return this}var Bm=jN(sD);hn=new Bm(1);const mt=Bm;var cD=e=>e,AN={},kN=e=>e===AN,d1=e=>function t(){return arguments.length===0||arguments.length===1&&kN(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},PN=(e,t)=>e===1?t:d1(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==AN).length;return i>=e?t(...n):PN(e-i,d1(function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];var d=n.map(u=>kN(u)?l.shift():u);return t(...d,...l)}))}),$u=e=>PN(e.length,e),nh=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},uD=$u((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),dD=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return cD;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((l,c)=>c(l),i(...arguments))}},ah=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),ON=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,l)=>{var c;return s===((c=t)===null||c===void 0?void 0:c[l])})||(t=a,r=e(...a)),r}};function DN(e){var t;return e===0?t=1:t=Math.floor(new mt(e).abs().log(10).toNumber())+1,t}function RN(e,t,r){for(var n=new mt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}$u((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});$u((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});$u((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var IN=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},FN=(e,t,r)=>{if(e.lte(0))return new mt(0);var n=DN(e.toNumber()),a=new mt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new mt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?new mt(c.toNumber()):new mt(Math.ceil(c.toNumber()))},fD=(e,t,r)=>{var n=new mt(1),a=new mt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new mt(10).pow(DN(e)-1),a=new mt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new mt(Math.floor(e)))}else e===0?a=new mt(Math.floor((t-1)/2)):r||(a=new mt(Math.floor(e)));var s=Math.floor((t-1)/2),l=dD(uD(c=>a.add(new mt(c-s).mul(n)).toNumber()),nh);return l(0,t)},MN=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new mt(0),tickMin:new mt(0),tickMax:new mt(0)};var s=FN(new mt(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new mt(0):(l=new mt(t).add(r).div(2),l=l.sub(new mt(l).mod(s)));var c=Math.ceil(l.sub(t).div(s).toNumber()),d=Math.ceil(new mt(r).sub(l).div(s).toNumber()),u=c+d+1;return u>n?MN(t,r,n,a,i+1):(u<n&&(d=r>0?d+(n-u):d,c=r>0?c:c+(n-u)),{step:s,tickMin:l.sub(new mt(c).mul(s)),tickMax:l.add(new mt(d).mul(s))})};function hD(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,l]=IN([t,r]);if(s===-1/0||l===1/0){var c=l===1/0?[s,...nh(0,n-1).map(()=>1/0)]:[...nh(0,n-1).map(()=>-1/0),l];return t>r?ah(c):c}if(s===l)return fD(s,n,a);var{step:d,tickMin:u,tickMax:f}=MN(s,l,i,a,0),h=RN(u,f.add(new mt(.1).mul(d)),d);return t>r?ah(h):h}function mD(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=IN([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var l=Math.max(t,2),c=FN(new mt(s).sub(i).div(l-1),a,0),d=[...RN(new mt(i),new mt(s),c),s];return a===!1&&(d=d.map(u=>Math.round(u))),r>n?ah(d):d}var pD=ON(hD),xD=ON(mD),LN=e=>e.rootProps.maxBarSize,gD=e=>e.rootProps.barGap,BN=e=>e.rootProps.barCategoryGap,vD=e=>e.rootProps.barSize,rl=e=>e.rootProps.stackOffset,$m=e=>e.options.chartName,Um=e=>e.rootProps.syncId,$N=e=>e.rootProps.syncMethod,Hm=e=>e.options.eventEmitter,ca={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},on={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Uu=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},yD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ca.angleAxisId,includeHidden:!1,name:void 0,reversed:ca.reversed,scale:ca.scale,tick:ca.tick,tickCount:void 0,ticks:void 0,type:ca.type,unit:void 0},bD={allowDataOverflow:on.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:on.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:on.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:on.scale,tick:on.tick,tickCount:on.tickCount,ticks:void 0,type:on.type,unit:void 0},wD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:ca.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ca.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ca.scale,tick:ca.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},ND={allowDataOverflow:on.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:on.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:on.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:on.scale,tick:on.tick,tickCount:on.tickCount,ticks:void 0,type:"category",unit:void 0},Wm=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?wD:yD,Km=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?ND:bD,Hu=e=>e.polarOptions,zm=ie([Pa,Oa,nr],g2),UN=ie([Hu,zm],(e,t)=>{if(e!=null)return kr(e.innerRadius,t,0)}),HN=ie([Hu,zm],(e,t)=>{if(e!=null)return kr(e.outerRadius,t,t*.8)}),_D=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},WN=ie([Hu],_D);ie([Wm,WN],Uu);var KN=ie([zm,UN,HN],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ie([Km,KN],Uu);var zN=ie([at,Hu,UN,HN,Pa,Oa],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:c,endAngle:d}=t;return{cx:kr(s,a,a/2),cy:kr(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:d,clockWise:!1}}}),Rt=(e,t)=>t,nl=(e,t,r)=>r;function Vm(e){return e?.id}var ir=e=>{var t=at(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Ps=e=>e.tooltip.settings.axisId,sr=e=>{var t=ir(e),r=Ps(e);return al(e,t,r)},VN=ie([sr],e=>e?.dataKey);function GN(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:n;if(!(d==null||d.length===0)){var u=Vm(l);d.forEach((f,h)=>{var m=i==null||a?h:String(wt(f,i,null)),x=wt(f,l.dataKey,0),g;s.has(m)?g=s.get(m):g={},Object.assign(g,{[u]:x}),s.set(m,g)})}}),Array.from(s.values())}function Wu(e){return e.stackId!=null&&e.dataKey!=null}var Ku=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function zu(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function f1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f1(Object(r),!0).forEach(function(n){SD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SD(e,t,r){return(t=ED(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ED(e){var t=TD(e,"string");return typeof t=="symbol"?t:t+""}function TD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ih=[0,"auto"],nn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},YN=(e,t)=>e.cartesianAxis.xAxis[t],Ra=(e,t)=>{var r=YN(e,t);return r??nn},an={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ih,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Xo},XN=(e,t)=>e.cartesianAxis.yAxis[t],Ia=(e,t)=>{var r=XN(e,t);return r??an},CD={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Gm=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??CD},Lt=(e,t,r)=>{switch(t){case"xAxis":return Ra(e,r);case"yAxis":return Ia(e,r);case"zAxis":return Gm(e,r);case"angleAxis":return Wm(e,r);case"radiusAxis":return Km(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},jD=(e,t,r)=>{switch(t){case"xAxis":return Ra(e,r);case"yAxis":return Ia(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},al=(e,t,r)=>{switch(t){case"xAxis":return Ra(e,r);case"yAxis":return Ia(e,r);case"angleAxis":return Wm(e,r);case"radiusAxis":return Km(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qN=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ym(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Vu=e=>e.graphicalItems.cartesianItems,AD=ie([Rt,nl],Ym),Xm=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),il=ie([Vu,Lt,AD],Xm,{memoizeOptions:{resultEqualityCheck:zu}}),ZN=ie([il],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Wu)),JN=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),kD=ie([il],JN),qm=e=>e.map(t=>t.data).filter(Boolean).flat(1),PD=ie([il],qm,{memoizeOptions:{resultEqualityCheck:zu}}),Zm=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Jm=ie([PD,Bu],Zm),Qm=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:wt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:wt(a,n)}))):e.map(n=>({value:n})),Gu=ie([Jm,Lt,il],Qm);function QN(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Ql(e){if(ra(e)||e instanceof Date){var t=Number(e);if(Dr(t))return t}}function h1(e){if(Array.isArray(e)){var t=[Ql(e[0]),Ql(e[1])];return Ai(t)?t:void 0}var r=Ql(e);if(r!=null)return[r,r]}function Os(e){return e.map(Ql).filter(YP)}function OD(e,t,r){return!r||typeof t!="number"||jn(t)?[]:r.length?Os(r.flatMap(n=>{var a=wt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Dr(i)||!Dr(s)))return[t-i,t+s]})):[]}var DD=ie([ZN,Bu,sr],GN),e_=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,l]=i,c=l.map(Vm);return[s,{stackedData:kk(e,c,r),graphicalItems:l}]}))},sh=ie([DD,ZN,rl],e_),t_=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=Ik(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},RD=ie([Lt],e=>e.allowDataOverflow),ep=e=>{var t;if(e==null||!("domain"in e))return ih;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Os(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:ih},tp=ie([Lt],ep),rp=ie([tp,RD],_N),ID=ie([sh,oi,Rt,rp],t_,{memoizeOptions:{resultEqualityCheck:Ku}}),Yu=e=>e.errorBars,FD=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>QN(r,n)),Oc=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},np=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var d,u,f=(d=n[c.id])===null||d===void 0?void 0:d.filter(y=>QN(a,y)),h=wt(l,(u=t.dataKey)!==null&&u!==void 0?u:c.dataKey),m=OD(l,h,f);if(m.length>=2){var x=Math.min(...m),g=Math.max(...m);(i==null||x<i)&&(i=x),(s==null||g>s)&&(s=g)}var v=h1(h);v!=null&&(i=i==null?v[0]:Math.min(i,v[0]),s=s==null?v[1]:Math.max(s,v[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var c=h1(wt(l,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),s=s==null?c[1]:Math.max(s,c[1]))}),Dr(i)&&Dr(s))return[i,s]},MD=ie([Jm,Lt,kD,Yu,Rt],np,{memoizeOptions:{resultEqualityCheck:Ku}});function LD(e){var{value:t}=e;if(ra(t)||t instanceof Date)return t}var BD=(e,t,r)=>{var n=e.map(LD).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&jw(n))?H2(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},r_=e=>e.referenceElements.dots,Ds=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),$D=ie([r_,Rt,nl],Ds),n_=e=>e.referenceElements.areas,UD=ie([n_,Rt,nl],Ds),a_=e=>e.referenceElements.lines,HD=ie([a_,Rt,nl],Ds),i_=(e,t)=>{var r=Os(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},WD=ie($D,Rt,i_),s_=(e,t)=>{var r=Os(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},KD=ie([UD,Rt],s_),o_=(e,t)=>{var r=Os(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},zD=ie(HD,Rt,o_),VD=ie(WD,zD,KD,(e,t,r)=>Oc(e,r,t)),ap=(e,t,r,n,a,i,s,l)=>{if(r!=null)return r;var c=s==="vertical"&&l==="xAxis"||s==="horizontal"&&l==="yAxis",d=c?Oc(n,i,a):Oc(i,a);return iD(t,d,e.allowDataOverflow)},GD=ie([Lt,tp,rp,ID,MD,VD,at,Rt],ap,{memoizeOptions:{resultEqualityCheck:Ku}}),YD=[0,1],ip=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:c}=e,d=ni(t,i);return d&&l==null?H2(0,r.length):c==="category"?BD(n,e,d):a==="expand"?YD:s}},sp=ie([Lt,at,Jm,Gu,rl,Rt,GD],ip),l_=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(Vo(i));return l in so?l:"point"}}},Rs=ie([Lt,at,qN,$m,Rt],l_);function XD(e){if(e!=null){if(e in so)return so[e]();var t="scale".concat(Vo(e));if(t in so)return so[t]()}}function op(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=XD(t);if(a!=null){var i=a.domain(r).range(n);return Ek(i),i}}}var lp=(e,t,r)=>{var n=ep(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Ai(e))return pD(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Ai(e))return xD(e,t.tickCount,t.allowDecimals)}},cp=ie([sp,al,Rs],lp),up=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Ai(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(s,l)]}return t},qD=ie([Lt,sp,cp,Rt],up),ZD=ie(Gu,Lt,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Os(e.map(l=>l.value))).sort((l,c)=>l-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),c_=ie(ZD,at,BN,nr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Dr(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=kr(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),JD=(e,t)=>{var r=Ra(e,t);return r==null||typeof r.padding!="string"?0:c_(e,"xAxis",t,r.padding)},QD=(e,t)=>{var r=Ia(e,t);return r==null||typeof r.padding!="string"?0:c_(e,"yAxis",t,r.padding)},eR=ie(Ra,JD,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),tR=ie(Ia,QD,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),rR=ie([nr,eR,Au,ju,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),nR=ie([nr,at,tR,Au,ju,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),sl=(e,t,r,n)=>{var a;switch(t){case"xAxis":return rR(e,r,n);case"yAxis":return nR(e,r,n);case"zAxis":return(a=Gm(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return WN(e);case"radiusAxis":return KN(e,r);default:return}},u_=ie([Lt,sl],Uu),Is=ie([Lt,Rs,qD,u_],op);ie([il,Yu,Rt],FD);function d_(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Xu=(e,t)=>t,qu=(e,t,r)=>r,aR=ie(Tu,Xu,qu,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(d_)),iR=ie(Cu,Xu,qu,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(d_)),f_=(e,t)=>({width:e.width,height:t.height}),sR=(e,t)=>{var r=typeof t.width=="number"?t.width:Xo;return{width:r,height:e.height}},h_=ie(nr,Ra,f_),oR=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},lR=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},cR=ie(Oa,nr,aR,Xu,qu,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=f_(t,l);s==null&&(s=oR(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(d)*c.height,s+=(d?-1:1)*c.height}),i}),uR=ie(Pa,nr,iR,Xu,qu,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var c=sR(t,l);s==null&&(s=lR(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(d)*c.width,s+=(d?-1:1)*c.width}),i}),dR=(e,t)=>{var r=Ra(e,t);if(r!=null)return cR(e,r.orientation,r.mirror)},fR=ie([nr,Ra,dR,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),hR=(e,t)=>{var r=Ia(e,t);if(r!=null)return uR(e,r.orientation,r.mirror)},mR=ie([nr,Ia,hR,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),m_=ie(nr,Ia,(e,t)=>{var r=typeof t.width=="number"?t.width:Xo;return{width:r,height:e.height}}),m1=(e,t,r)=>{switch(t){case"xAxis":return h_(e,r).width;case"yAxis":return m_(e,r).height;default:return}},p_=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=ni(e,n),c=t.map(d=>d.value);if(s&&l&&i==="category"&&a&&jw(c))return c}},dp=ie([at,Gu,Lt,Rt],p_),x_=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=ni(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},fp=ie([at,Gu,al,Rt],x_),p1=ie([at,jD,Rs,Is,dp,fp,sl,cp,Rt],(e,t,r,n,a,i,s,l,c)=>{if(t==null)return null;var d=ni(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:l,range:s,realScaleType:r,scale:n}}),pR=(e,t,r,n,a,i,s,l,c)=>{if(!(t==null||n==null)){var d=ni(e,c),{type:u,ticks:f,tickCount:h}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=u==="category"&&n.bandwidth?n.bandwidth()/m:0;x=c==="angleAxis"&&i!=null&&i.length>=2?cr(i[0]-i[1])*2*x:x;var g=f||a;if(g){var v=g.map((y,b)=>{var w=s?s.indexOf(y):y;return{index:b,coordinate:n(w)+x,value:y,offset:x}});return v.filter(y=>!jn(y.coordinate))}return d&&l?l.map((y,b)=>({coordinate:n(y)+x,value:y,index:b,offset:x})):n.ticks?n.ticks(h).map(y=>({coordinate:n(y)+x,value:y,offset:x})):n.domain().map((y,b)=>({coordinate:n(y)+x,value:s?s[y]:y,index:b,offset:x}))}},g_=ie([at,al,Rs,Is,cp,sl,dp,fp,Rt],pR),xR=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=ni(e,s),{tickCount:c}=t,d=0;return d=s==="angleAxis"&&n?.length>=2?cr(n[0]-n[1])*2*d:d,l&&i?i.map((u,f)=>({coordinate:r(u)+d,value:u,index:f,offset:d})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+d,value:u,offset:d})):r.domain().map((u,f)=>({coordinate:r(u)+d,value:a?a[u]:u,index:f,offset:d}))}},Ya=ie([at,al,Is,sl,dp,fp,Rt],xR),Xa=ie(Lt,Is,(e,t)=>{if(!(e==null||t==null))return Pc(Pc({},e),{},{scale:t})}),gR=ie([Lt,Rs,sp,u_],op);ie((e,t,r)=>Gm(e,r),gR,(e,t)=>{if(!(e==null||t==null))return Pc(Pc({},e),{},{scale:t})});var vR=ie([at,Tu,Cu],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),v_=e=>e.options.defaultTooltipEventType,y_=e=>e.options.validateTooltipEventTypes;function b_(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function hp(e,t){var r=v_(e),n=y_(e);return b_(t,r,n)}function yR(e){return He(t=>hp(t,e))}var w_=(e,t)=>{var r,n=Number(t);if(!(jn(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},bR=e=>e.tooltip.settings,Wa={active:!1,index:null,dataKey:void 0,coordinate:void 0},wR={itemInteraction:{click:Wa,hover:Wa},axisInteraction:{click:Wa,hover:Wa},keyboardInteraction:Wa,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},N_=vn({name:"tooltip",initialState:wR,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Br()},removeTooltipEntrySettings:{reducer(e,t){var r=ga(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Br()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:NR,removeTooltipEntrySettings:_R,setTooltipSettingsState:SR,setActiveMouseOverItemIndex:__,mouseLeaveItem:ER,mouseLeaveChart:S_,setActiveClickItemIndex:TR,setMouseOverAxisIndex:E_,setMouseClickAxisIndex:CR,setSyncInteraction:oh,setKeyboardInteraction:lh}=N_.actions,jR=N_.reducer;function x1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x1(Object(r),!0).forEach(function(n){AR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AR(e,t,r){return(t=kR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kR(e){var t=PR(e,"string");return typeof t=="symbol"?t:t+""}function PR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OR(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function DR(e){return e.index!=null}var T_=(e,t,r,n)=>{if(t==null)return Wa;var a=OR(e,t,r);if(a==null)return Wa;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(DR(a)){if(i)return kl(kl({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return kl(kl({},Wa),{},{coordinate:a.coordinate})},mp=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Dr(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},C_=(e,t,r,n,a,i,s,l)=>{if(!(i==null||l==null)){var c=s[0],d=c==null?void 0:l(c.positions,i);if(d!=null)return d;var u=a?.[Number(i)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},j_=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},ol=e=>e.options.tooltipPayloadSearcher,Fs=e=>e.tooltip;function g1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g1(Object(r),!0).forEach(function(n){RR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RR(e,t,r){return(t=IR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IR(e){var t=FR(e,"string");return typeof t=="symbol"?t:t+""}function FR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MR(e,t){return e??t}var A_=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,f=[];return e.reduce((h,m)=>{var x,{dataDefinedOnItem:g,settings:v}=m,y=MR(g,l),b=Array.isArray(y)?v2(y,d,u):y,w=(x=v?.dataKey)!==null&&x!==void 0?x:n,N=v?.nameKey,_;if(n&&Array.isArray(b)&&!Array.isArray(b[0])&&s==="axis"?_=Aw(b,n,a):_=i(b,t,c,N),Array.isArray(_))_.forEach(S=>{var j=v1(v1({},v),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});h.push(Xg({tooltipEntrySettings:j,dataKey:S.dataKey,payload:S.payload,value:wt(S.payload,S.dataKey),name:S.name}))});else{var E;h.push(Xg({tooltipEntrySettings:v,dataKey:w,payload:_,value:wt(_,w),name:(E=wt(_,N))!==null&&E!==void 0?E:v?.name}))}return h},f)}},pp=ie([sr,at,qN,$m,ir],l_),LR=ie([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),BR=ie([ir,Ps],Ym),ll=ie([LR,sr,BR],Xm,{memoizeOptions:{resultEqualityCheck:zu}}),$R=ie([ll],e=>e.filter(Wu)),UR=ie([ll],qm,{memoizeOptions:{resultEqualityCheck:zu}}),Ms=ie([UR,oi],Zm),HR=ie([$R,oi,sr],GN),xp=ie([Ms,sr,ll],Qm),k_=ie([sr],ep),WR=ie([sr],e=>e.allowDataOverflow),P_=ie([k_,WR],_N),KR=ie([ll],e=>e.filter(Wu)),zR=ie([HR,KR,rl],e_),VR=ie([zR,oi,ir,P_],t_),GR=ie([ll],JN),YR=ie([Ms,sr,GR,Yu,ir],np,{memoizeOptions:{resultEqualityCheck:Ku}}),XR=ie([r_,ir,Ps],Ds),qR=ie([XR,ir],i_),ZR=ie([n_,ir,Ps],Ds),JR=ie([ZR,ir],s_),QR=ie([a_,ir,Ps],Ds),eI=ie([QR,ir],o_),tI=ie([qR,eI,JR],Oc),rI=ie([sr,k_,P_,VR,YR,tI,at,ir],ap),O_=ie([sr,at,Ms,xp,rl,ir,rI],ip),nI=ie([O_,sr,pp],lp),aI=ie([sr,O_,nI,ir],up),D_=e=>{var t=ir(e),r=Ps(e),n=!1;return sl(e,t,r,n)},R_=ie([sr,D_],Uu),I_=ie([sr,pp,aI,R_],op),iI=ie([at,xp,sr,ir],p_),sI=ie([at,xp,sr,ir],x_),oI=(e,t,r,n,a,i,s,l)=>{if(t){var{type:c}=t,d=ni(e,l);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return f=l==="angleAxis"&&a!=null&&a?.length>=2?cr(a[0]-a[1])*2*f:f,d&&s?s.map((h,m)=>({coordinate:n(h)+f,value:h,index:m,offset:f})):n.domain().map((h,m)=>({coordinate:n(h)+f,value:i?i[h]:h,index:m,offset:f}))}}},Fa=ie([at,sr,pp,I_,D_,iI,sI,ir],oI),gp=ie([v_,y_,bR],(e,t,r)=>b_(r.shared,e,t)),F_=e=>e.tooltip.settings.trigger,vp=e=>e.tooltip.settings.defaultIndex,Zu=ie([Fs,gp,F_,vp],T_),qa=ie([Zu,Ms],mp),M_=ie([Fa,qa],w_),L_=ie([Zu],e=>{if(e)return e.dataKey}),B_=ie([Fs,gp,F_,vp],j_),lI=ie([Pa,Oa,at,nr,Fa,vp,B_,ol],C_),cI=ie([Zu,lI],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),uI=ie([Zu],e=>e.active),dI=ie([B_,qa,oi,VN,M_,ol,gp],A_),fI=ie([dI],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function y1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y1(Object(r),!0).forEach(function(n){hI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hI(e,t,r){return(t=mI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mI(e){var t=pI(e,"string");return typeof t=="symbol"?t:t+""}function pI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xI=()=>He(sr),gI=()=>{var e=xI(),t=He(Fa),r=He(I_);return To(b1(b1({},e),{},{scale:r}),t)},vI=()=>He($m),yp=(e,t)=>t,$_=(e,t,r)=>r,bp=(e,t,r,n)=>n,yI=ie(Fa,e=>bu(e,t=>t.coordinate)),wp=ie([Fs,yp,$_,bp],T_),U_=ie([wp,Ms],mp),bI=(e,t,r)=>{if(t!=null){var n=Fs(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},H_=ie([Fs,yp,$_,bp],j_),Dc=ie([Pa,Oa,at,nr,Fa,bp,H_,ol],C_),wI=ie([wp,Dc],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),W_=ie(Fa,U_,w_),NI=ie([H_,U_,oi,VN,W_,ol,yp],A_),_I=ie([wp],e=>({isActive:e.active,activeIndex:e.index})),SI=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i)){var c=Fk(e.chartX,e.chartY,t,r,l);if(c){var d=Lk(c,t),u=_k(d,s,i,n,a),f=Mk(t,i,u,c);return{activeIndex:String(u),activeCoordinate:f}}}};function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ch.apply(null,arguments)}function w1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w1(Object(r),!0).forEach(function(n){EI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EI(e,t,r){return(t=TI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TI(e){var t=CI(e,"string");return typeof t=="symbol"?t:t+""}function CI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jI(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:l,tooltipEventType:c,chartName:d}=e,u=t,f=r,h=n;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var m,x;if(d==="ScatterChart")m=u,x=UP;else if(d==="BarChart")m=HP(s,u,a,i),x=L2;else if(s==="radial"){var{cx:g,cy:v,radius:y,startAngle:b,endAngle:w}=B2(u);m={cx:g,cy:v,startAngle:b,endAngle:w,innerRadius:y,outerRadius:y},x=U2}else m={points:EO(s,u,a)},x=hm;var N=typeof l=="object"&&"className"in l?l.className:void 0,_=Pl(Pl(Pl(Pl({stroke:"#ccc",pointerEvents:"none"},a),m),Ei(l)),{},{payload:f,payloadIndex:h,className:ct("recharts-tooltip-cursor",N)});return p.isValidElement(l)?p.cloneElement(l,_):p.createElement(x,_)}function AI(e){var t=gI(),r=C2(),n=Pu(),a=vI();return p.createElement(jI,ch({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var K_=p.createContext(null),kI=()=>p.useContext(K_),I0={exports:{}},N1;function PI(){return N1||(N1=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,f||c,h),x=r?r+d:d;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],m]:c._events[x].push(m):(c._events[x]=m,c._eventsCount++),c}function s(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,x=new Array(m);h<m;h++)x[h]=f[h].fn;return x},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,x){var g=r?r+d:d;if(!this._events[g])return!1;var v=this._events[g],y=arguments.length,b,w;if(v.fn){switch(v.once&&this.removeListener(d,v.fn,void 0,!0),y){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,f),!0;case 4:return v.fn.call(v.context,u,f,h),!0;case 5:return v.fn.call(v.context,u,f,h,m),!0;case 6:return v.fn.call(v.context,u,f,h,m,x),!0}for(w=1,b=new Array(y-1);w<y;w++)b[w-1]=arguments[w];v.fn.apply(v.context,b)}else{var N=v.length,_;for(w=0;w<N;w++)switch(v[w].once&&this.removeListener(d,v[w].fn,void 0,!0),y){case 1:v[w].fn.call(v[w].context);break;case 2:v[w].fn.call(v[w].context,u);break;case 3:v[w].fn.call(v[w].context,u,f);break;case 4:v[w].fn.call(v[w].context,u,f,h);break;default:if(!b)for(_=1,b=new Array(y-1);_<y;_++)b[_-1]=arguments[_];v[w].fn.apply(v[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return s(this,m),this;var x=this._events[m];if(x.fn)x.fn===u&&(!h||x.once)&&(!f||x.context===f)&&s(this,m);else{for(var g=0,v=[],y=x.length;g<y;g++)(x[g].fn!==u||h&&!x[g].once||f&&x[g].context!==f)&&v.push(x[g]);v.length?this._events[m]=v.length===1?v[0]:v:s(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(I0)),I0.exports}var OI=PI();const DI=ri(OI);var Do=new DI,uh="recharts.syncEvent.tooltip",_1="recharts.syncEvent.brush";function Np(e,t){if(t){var r=Number.parseInt(t,10);if(!jn(r))return e?.[r]}}var RI={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},z_=vn({name:"options",initialState:RI,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),II=z_.reducer,{createEventEmitter:FI}=z_.actions;function MI(e){return e.tooltip.syncInteraction}var LI={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},V_=vn({name:"chartData",initialState:LI,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:S1,setDataStartEndIndexes:BI,setComputedData:wZ}=V_.actions,$I=V_.reducer,UI=["x","y"];function E1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E1(Object(r),!0).forEach(function(n){HI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HI(e,t,r){return(t=WI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WI(e){var t=KI(e,"string");return typeof t=="symbol"?t:t+""}function KI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zI(e,t){if(e==null)return{};var r,n,a=VI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var G_=()=>{};function GI(){var e=He(Um),t=He(Hm),r=Ut(),n=He($N),a=He(Fa),i=Pu(),s=ku(),l=He(c=>c.rootProps.className);p.useEffect(()=>{if(e==null)return G_;var c=(d,u,f)=>{if(t!==f&&e===d){if(n==="index"){var h;if(s&&u!==null&&u!==void 0&&(h=u.payload)!==null&&h!==void 0&&h.coordinate&&u.payload.sourceViewBox){var m=u.payload.coordinate,{x,y:g}=m,v=zI(m,UI),{x:y,y:b,width:w,height:N}=u.payload.sourceViewBox,_=Gi(Gi({},v),{},{x:s.x+(w?(x-y)/w:0)*s.width,y:s.y+(N?(g-b)/N:0)*s.height});r(Gi(Gi({},u),{},{payload:Gi(Gi({},u.payload),{},{coordinate:_})}))}else r(u);return}if(a!=null){var E;if(typeof n=="function"){var S={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},j=n(a,S);E=a[j]}else n==="value"&&(E=a.find(J=>String(J.value)===u.payload.label));var{coordinate:P}=u.payload;if(E==null||u.payload.active===!1||P==null||s==null){r(oh({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:C,y:T}=P,k=Math.min(C,s.x+s.width),W=Math.min(T,s.y+s.height),G={x:i==="horizontal"?E.coordinate:k,y:i==="horizontal"?W:E.coordinate},K=oh({active:u.payload.active,coordinate:G,dataKey:u.payload.dataKey,index:String(E.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox});r(K)}}};return Do.on(uh,c),()=>{Do.off(uh,c)}},[l,r,t,e,n,a,i,s])}function YI(){var e=He(Um),t=He(Hm),r=Ut();p.useEffect(()=>{if(e==null)return G_;var n=(a,i,s)=>{t!==s&&e===a&&r(BI(i))};return Do.on(_1,n),()=>{Do.off(_1,n)}},[r,t,e])}function XI(){var e=Ut();p.useEffect(()=>{e(FI())},[e]),GI(),YI()}function qI(e,t,r,n,a,i){var s=He(m=>bI(m,e,t)),l=He(Hm),c=He(Um),d=He($N),u=He(MI),f=u?.active,h=ku();p.useEffect(()=>{if(!f&&c!=null&&l!=null){var m=oh({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:h});Do.emit(uh,c,m,l)}},[f,r,s,a,n,l,c,d,i,h])}function T1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T1(Object(r),!0).forEach(function(n){ZI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZI(e,t,r){return(t=JI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JI(e){var t=QI(e,"string");return typeof t=="symbol"?t:t+""}function QI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e6(e){return e.dataKey}function t6(e,t){return p.isValidElement(e)?p.cloneElement(e,t):typeof e=="function"?p.createElement(e,t):p.createElement(yP,t)}var j1=[],r6={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ai.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function _p(e){var t=br(e,r6),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:l,isAnimationActive:c,offset:d,payloadUniqBy:u,position:f,reverseDirection:h,useTranslate3d:m,wrapperStyle:x,cursor:g,shared:v,trigger:y,defaultIndex:b,portal:w,axisId:N}=t,_=Ut(),E=typeof b=="number"?String(b):b;p.useEffect(()=>{_(SR({shared:v,trigger:y,axisId:N,active:r,defaultIndex:E}))},[_,v,y,N,r,E]);var S=ku(),j=D2(),P=yR(v),{activeIndex:C,isActive:T}=He(q=>_I(q,P,y,E)),k=He(q=>NI(q,P,y,E)),W=He(q=>W_(q,P,y,E)),G=He(q=>wI(q,P,y,E)),K=k,J=kI(),V=r??T,[Z,Q]=m4([K,V]),Y=P==="axis"?W:void 0;qI(P,y,G,Y,C,V);var le=w??J;if(le==null)return null;var de=K??j1;V||(de=j1),l&&de.length&&(de=$A(K.filter(q=>q.value!=null&&(q.hide!==!0||t.includeHidden)),u,e6));var pe=de.length>0,_e=p.createElement(TP,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:V,coordinate:G,hasPayload:pe,offset:d,position:f,reverseDirection:h,useTranslate3d:m,viewBox:S,wrapperStyle:x,lastBoundingBox:Z,innerRef:Q,hasPortalFromProps:!!w},t6(s,C1(C1({},t),{},{payload:de,label:Y,active:V,coordinate:G,accessibilityLayer:j})));return p.createElement(p.Fragment,null,XT.createPortal(_e,le),V&&p.createElement(AI,{cursor:g,tooltipEventType:P,coordinate:G,payload:K,index:C}))}var cl=e=>null;cl.displayName="Cell";function n6(e,t,r){return(t=a6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a6(e){var t=i6(e,"string");return typeof t=="symbol"?t:t+""}function i6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class s6{constructor(t){n6(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function A1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A1(Object(r),!0).forEach(function(n){l6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l6(e,t,r){return(t=c6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c6(e){var t=u6(e,"string");return typeof t=="symbol"?t:t+""}function u6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d6={cacheSize:2e3,enableCache:!0},Y_=o6({},d6),k1=new s6(Y_.cacheSize),f6={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},P1="recharts_measurement_span";function h6(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l)}var O1=(e,t)=>{try{var r=document.getElementById(P1);r||(r=document.createElement("span"),r.setAttribute("id",P1),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,f6,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},ho=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ai.isSsr)return{width:0,height:0};if(!Y_.enableCache)return O1(t,r);var n=h6(t,r),a=k1.get(n);if(a)return a;var i=O1(t,r);return k1.set(n,i),i},D1=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,R1=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,m6=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,p6=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,X_={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},x6=Object.keys(X_),as="NaN";function g6(e,t){return e*X_[t]}class Qr{static parse(t){var r,[,n,a]=(r=p6.exec(t))!==null&&r!==void 0?r:[];return new Qr(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,jn(t)&&(this.unit=""),r!==""&&!m6.test(r)&&(this.num=NaN,this.unit=""),x6.includes(r)&&(this.num=g6(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Qr(NaN,""):new Qr(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Qr(NaN,""):new Qr(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Qr(NaN,""):new Qr(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Qr(NaN,""):new Qr(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return jn(this.num)}}function q_(e){if(e.includes(as))return as;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=D1.exec(t))!==null&&r!==void 0?r:[],s=Qr.parse(n??""),l=Qr.parse(i??""),c=a==="*"?s.multiply(l):s.divide(l);if(c.isNaN())return as;t=t.replace(D1,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,f,h]=(d=R1.exec(t))!==null&&d!==void 0?d:[],m=Qr.parse(u??""),x=Qr.parse(h??""),g=f==="+"?m.add(x):m.subtract(x);if(g.isNaN())return as;t=t.replace(R1,g.toString())}return t}var I1=/\(([^()]*)\)/;function v6(e){for(var t=e,r;(r=I1.exec(t))!=null;){var[,n]=r;t=t.replace(I1,q_(n))}return t}function y6(e){var t=e.replace(/\s+/g,"");return t=v6(t),t=q_(t),t}function b6(e){try{return y6(e)}catch{return as}}function F0(e){var t=b6(e.slice(5,-1));return t===as?"":t}var w6=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],N6=["dx","dy","angle","className","breakAll"];function dh(){return dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dh.apply(null,arguments)}function F1(e,t){if(e==null)return{};var r,n,a=_6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Z_=/[ \f\n\r\t\v\u2028\u2029]+/,J_=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Pt(t)||(r?a=t.toString().split(""):a=t.toString().split(Z_));var i=a.map(l=>({word:l,width:ho(l,n).width})),s=r?0:ho(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},S6=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:c}=e,d=Ke(i),u=s,f=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return T.reduce((k,W)=>{var{word:G,width:K}=W,J=k[k.length-1];if(J&&(n==null||a||J.width+K+r<Number(n)))J.words.push(G),J.width+=K+r;else{var V={words:[G],width:K};k.push(V)}return k},[])},h=f(t),m=C=>C.reduce((T,k)=>T.width>k.width?T:k);if(!d||a)return h;var x=h.length>i||m(h).width>Number(n);if(!x)return h;for(var g="…",v=C=>{var T=u.slice(0,C),k=J_({breakAll:c,style:l,children:T+g}).wordsWithComputedWidth,W=f(k),G=W.length>i||m(W).width>Number(n);return[G,W]},y=0,b=u.length-1,w=0,N;y<=b&&w<=u.length-1;){var _=Math.floor((y+b)/2),E=_-1,[S,j]=v(E),[P]=v(_);if(!S&&!P&&(y=_+1),S&&P&&(b=_-1),!S&&P){N=j;break}w++}return N||h},M1=e=>{var t=Pt(e)?[]:e.toString().split(Z_);return[{words:t}]},E6=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!ai.isSsr){var l,c,d=J_({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:f}=d;l=u,c=f}else return M1(n);return S6({breakAll:i,children:n,maxLines:s,style:a},l,c,t,r)}return M1(n)},L1="#808080",Ju=p.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:c="end",fill:d=L1}=e,u=F1(e,w6),f=p.useMemo(()=>E6({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:h,dy:m,angle:x,className:g,breakAll:v}=u,y=F1(u,N6);if(!ra(r)||!ra(n)||f.length===0)return null;var b=r+(Ke(h)?h:0),w=n+(Ke(m)?m:0),N;switch(c){case"start":N=F0("calc(".concat(i,")"));break;case"middle":N=F0("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:N=F0("calc(".concat(f.length-1," * -").concat(a,")"));break}var _=[];if(s){var E=f[0].width,{width:S}=u;_.push("scale(".concat(Ke(S)?S/E:1,")"))}return x&&_.push("rotate(".concat(x,", ").concat(b,", ").concat(w,")")),_.length&&(y.transform=_.join(" ")),p.createElement("text",dh({},zr(y),{ref:t,x:b,y:w,className:ct("recharts-text",g),textAnchor:l,fill:d.includes("url")?L1:d}),f.map((j,P)=>{var C=j.words.join(v?"":" ");return p.createElement("tspan",{x:b,dy:P===0?N:a,key:"".concat(C,"-").concat(P)},C)}))});Ju.displayName="Text";var T6=["labelRef"];function C6(e,t){if(e==null)return{};var r,n,a=j6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function j6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function B1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B1(Object(r),!0).forEach(function(n){A6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A6(e,t,r){return(t=k6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k6(e){var t=P6(e,"string");return typeof t=="symbol"?t:t+""}function P6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(){return ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ua.apply(null,arguments)}var Q_=p.createContext(null),O6=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=p.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return p.createElement(Q_.Provider,{value:s},i)},eS=()=>{var e=p.useContext(Q_),t=ku();return e||t},D6=p.createContext(null),R6=()=>{var e=p.useContext(D6),t=He(zN);return e||t},I6=e=>{var{value:t,formatter:r}=e,n=Pt(e.children)?t:e.children;return typeof r=="function"?r(n):n},Sp=e=>e!=null&&typeof e=="function",F6=(e,t)=>{var r=cr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},M6=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:f,endAngle:h,clockWise:m}=a,x=(d+u)/2,g=F6(f,h),v=g>=0?1:-1,y,b;switch(t){case"insideStart":y=f+v*i,b=m;break;case"insideEnd":y=h-v*i,b=!m;break;case"end":y=h+v*i,b=m;break;default:throw new Error("Unsupported position ".concat(t))}b=g<=0?b:!b;var w=Xt(l,c,x,y),N=Xt(l,c,x,y+(b?1:-1)*359),_="M".concat(w.x,",").concat(w.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(b?0:1,`,
    `).concat(N.x,",").concat(N.y),E=Pt(e.id)?No("recharts-radial-line-"):e.id;return p.createElement("text",ua({},n,{dominantBaseline:"central",className:ct("recharts-radial-bar-label",s)}),p.createElement("defs",null,p.createElement("path",{id:E,d:_})),p.createElement("textPath",{xlinkHref:"#".concat(E)},r))},L6=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:f}=Xt(n,a,s+t,d);return{x:u,y:f,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(i+s)/2,{x:m,y:x}=Xt(n,a,h,d);return{x:m,y:x,textAnchor:"middle",verticalAnchor:"middle"}},tS=e=>"cx"in e&&Ke(e.cx),B6=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!tS(r)&&(i=r);var{x:s,y:l,width:c,height:d}=t,u=d>=0?1:-1,f=u*n,h=u>0?"end":"start",m=u>0?"start":"end",x=c>=0?1:-1,g=x*n,v=x>0?"end":"start",y=x>0?"start":"end";if(a==="top"){var b={x:s+c/2,y:l-u*n,textAnchor:"middle",verticalAnchor:h};return Ht(Ht({},b),i?{height:Math.max(l-i.y,0),width:c}:{})}if(a==="bottom"){var w={x:s+c/2,y:l+d+f,textAnchor:"middle",verticalAnchor:m};return Ht(Ht({},w),i?{height:Math.max(i.y+i.height-(l+d),0),width:c}:{})}if(a==="left"){var N={x:s-g,y:l+d/2,textAnchor:v,verticalAnchor:"middle"};return Ht(Ht({},N),i?{width:Math.max(N.x-i.x,0),height:d}:{})}if(a==="right"){var _={x:s+c+g,y:l+d/2,textAnchor:y,verticalAnchor:"middle"};return Ht(Ht({},_),i?{width:Math.max(i.x+i.width-_.x,0),height:d}:{})}var E=i?{width:c,height:d}:{};return a==="insideLeft"?Ht({x:s+g,y:l+d/2,textAnchor:y,verticalAnchor:"middle"},E):a==="insideRight"?Ht({x:s+c-g,y:l+d/2,textAnchor:v,verticalAnchor:"middle"},E):a==="insideTop"?Ht({x:s+c/2,y:l+f,textAnchor:"middle",verticalAnchor:m},E):a==="insideBottom"?Ht({x:s+c/2,y:l+d-f,textAnchor:"middle",verticalAnchor:h},E):a==="insideTopLeft"?Ht({x:s+g,y:l+f,textAnchor:y,verticalAnchor:m},E):a==="insideTopRight"?Ht({x:s+c-g,y:l+f,textAnchor:v,verticalAnchor:m},E):a==="insideBottomLeft"?Ht({x:s+g,y:l+d-f,textAnchor:y,verticalAnchor:h},E):a==="insideBottomRight"?Ht({x:s+c-g,y:l+d-f,textAnchor:v,verticalAnchor:h},E):a&&typeof a=="object"&&(Ke(a.x)||_a(a.x))&&(Ke(a.y)||_a(a.y))?Ht({x:s+kr(a.x,c),y:l+kr(a.y,d),textAnchor:"end",verticalAnchor:"end"},E):Ht({x:s+c/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},E)},$6={offset:5};function Ha(e){var t=br(e,$6),{viewBox:r,position:n,value:a,children:i,content:s,className:l="",textBreakAll:c,labelRef:d}=t,u=R6(),f=eS(),h=n==="center"?f:u??f,m=r||h;if(!m||Pt(a)&&Pt(i)&&!p.isValidElement(s)&&typeof s!="function")return null;var x=Ht(Ht({},t),{},{viewBox:m});if(p.isValidElement(s)){var{labelRef:g}=x,v=C6(x,T6);return p.cloneElement(s,v)}var y;if(typeof s=="function"){if(y=p.createElement(s,x),p.isValidElement(y))return y}else y=I6(t);var b=tS(m),w=zr(t);if(b&&(n==="insideStart"||n==="insideEnd"||n==="end"))return M6(t,n,y,w,m);var N=b?L6(m,t.offset,t.position):B6(t,m);return p.createElement(Ju,ua({ref:d,className:ct("recharts-label",l)},w,N,{breakAll:c}),y)}Ha.displayName="Label";var U6=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?p.createElement(Ha,ua({key:"label-implicit"},n)):ra(e)?p.createElement(Ha,ua({key:"label-implicit",value:e},n)):p.isValidElement(e)?e.type===Ha?p.cloneElement(e,Ht({key:"label-implicit"},n)):p.createElement(Ha,ua({key:"label-implicit",content:e},n)):Sp(e)?p.createElement(Ha,ua({key:"label-implicit",content:e},n)):e&&typeof e=="object"?p.createElement(Ha,ua({},e,{key:"label-implicit"},n)):null};function H6(e){var{label:t,labelRef:r}=e,n=eS();return U6(t,n,r)||null}var M0={},L0={},$1;function W6(){return $1||($1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(L0)),L0}var B0={},U1;function K6(){return U1||(U1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(B0)),B0}var H1;function z6(){return H1||(H1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W6(),r=K6(),n=nm();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(M0)),M0}var $0,W1;function V6(){return W1||(W1=1,$0=z6().last),$0}var G6=V6();const Y6=ri(G6);var X6=["valueAccessor"],q6=["dataKey","clockWise","id","textBreakAll"];function Rc(){return Rc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rc.apply(null,arguments)}function K1(e,t){if(e==null)return{};var r,n,a=Z6(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z6(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var J6=e=>Array.isArray(e.value)?Y6(e.value):e.value,rS=p.createContext(void 0),nS=rS.Provider,aS=p.createContext(void 0),Q6=aS.Provider;function eF(){return p.useContext(rS)}function tF(){return p.useContext(aS)}function ec(e){var{valueAccessor:t=J6}=e,r=K1(e,X6),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,l=K1(r,q6),c=eF(),d=tF(),u=c||d;return!u||!u.length?null:p.createElement(vr,{className:"recharts-label-list"},u.map((f,h)=>{var m,x=Pt(n)?t(f,h):wt(f&&f.payload,n),g=Pt(i)?{}:{id:"".concat(i,"-").concat(h)};return p.createElement(Ha,Rc({key:"label-".concat(h)},zr(f),l,g,{fill:(m=r.fill)!==null&&m!==void 0?m:f.fill,parentViewBox:f.parentViewBox,value:x,textBreakAll:s,viewBox:f.viewBox,index:h}))}))}ec.displayName="LabelList";function Ep(e){var{label:t}=e;return t?t===!0?p.createElement(ec,{key:"labelList-implicit"}):p.isValidElement(t)||Sp(t)?p.createElement(ec,{key:"labelList-implicit",content:t}):typeof t=="object"?p.createElement(ec,Rc({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function fh(){return fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fh.apply(null,arguments)}var iS=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=ct("recharts-dot",a);return t===+t&&r===+r&&n===+n?p.createElement("circle",fh({},xn(e),rm(e),{className:i,cx:t,cy:r,r:n})):null},sS=e=>e.graphicalItems.polarItems,rF=ie([Rt,nl],Ym),Qu=ie([sS,Lt,rF],Xm),nF=ie([Qu],qm),ed=ie([nF,Mm],Zm),aF=ie([ed,Lt,Qu],Qm);ie([ed,Lt,Qu],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=wt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:wt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var z1=()=>{},iF=ie([ed,Lt,Qu,Yu,Rt],np),sF=ie([Lt,tp,rp,z1,iF,z1,at,Rt],ap),oS=ie([Lt,at,ed,aF,rl,Rt,sF],ip),oF=ie([oS,Lt,Rs],lp);ie([Lt,oS,oF,Rt],up);var lF={radiusAxis:{},angleAxis:{}},lS=vn({name:"polarAxis",initialState:lF,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:NZ,removeRadiusAxis:_Z,addAngleAxis:SZ,removeAngleAxis:EZ}=lS.actions,cF=lS.reducer;function V1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function G1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V1(Object(r),!0).forEach(function(n){uF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uF(e,t,r){return(t=dF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dF(e){var t=fF(e,"string");return typeof t=="symbol"?t:t+""}function fF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hF=(e,t)=>t,Tp=ie([sS,hF],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),mF=[],Cp=(e,t,r)=>r?.length===0?mF:r,cS=ie([Mm,Tp,Cp],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>G1(G1({},t.presentationProps),i.props))),a!=null)return a}}),pF=ie([cS,Tp,Cp],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=wt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Cs(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),xF=ie([cS,Tp,Cp,nr],(e,t,r,n)=>{if(!(t==null||e==null))return xM({offset:n,pieSettings:t,displayedData:e,cells:r})}),U0={exports:{}},xt={};var Y1;function gF(){if(Y1)return xt;Y1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function x(g){if(typeof g=="object"&&g!==null){var v=g.$$typeof;switch(v){case e:switch(g=g.type,g){case r:case a:case n:case c:case d:case h:return g;default:switch(g=g&&g.$$typeof,g){case s:case l:case f:case u:return g;case i:return g;default:return v}}case t:return v}}}return xt.ContextConsumer=i,xt.ContextProvider=s,xt.Element=e,xt.ForwardRef=l,xt.Fragment=r,xt.Lazy=f,xt.Memo=u,xt.Portal=t,xt.Profiler=a,xt.StrictMode=n,xt.Suspense=c,xt.SuspenseList=d,xt.isContextConsumer=function(g){return x(g)===i},xt.isContextProvider=function(g){return x(g)===s},xt.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},xt.isForwardRef=function(g){return x(g)===l},xt.isFragment=function(g){return x(g)===r},xt.isLazy=function(g){return x(g)===f},xt.isMemo=function(g){return x(g)===u},xt.isPortal=function(g){return x(g)===t},xt.isProfiler=function(g){return x(g)===a},xt.isStrictMode=function(g){return x(g)===n},xt.isSuspense=function(g){return x(g)===c},xt.isSuspenseList=function(g){return x(g)===d},xt.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===c||g===d||typeof g=="object"&&g!==null&&(g.$$typeof===f||g.$$typeof===u||g.$$typeof===s||g.$$typeof===i||g.$$typeof===l||g.$$typeof===m||g.getModuleId!==void 0)},xt.typeOf=x,xt}var X1;function vF(){return X1||(X1=1,U0.exports=gF()),U0.exports}var yF=vF(),q1=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Z1=null,H0=null,uS=e=>{if(e===Z1&&Array.isArray(H0))return H0;var t=[];return p.Children.forEach(e,r=>{Pt(r)||(yF.isFragment(r)?t=t.concat(uS(r.props.children)):t.push(r))}),H0=t,Z1=e,t};function jp(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>q1(a)):n=[q1(t)],uS(e).forEach(a=>{var i=Ti(a,"type.displayName")||Ti(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var dS=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,W0={},J1;function bF(){return J1||(J1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(W0)),W0}var K0,Q1;function wF(){return Q1||(Q1=1,K0=bF().isPlainObject),K0}var NF=wF();const _F=ri(NF);function ey(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ty(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ey(Object(r),!0).forEach(function(n){SF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ey(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SF(e,t,r){return(t=EF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EF(e){var t=TF(e,"string");return typeof t=="symbol"?t:t+""}function TF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ic(){return Ic=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ic.apply(null,arguments)}var ry=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},CF={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jF=e=>{var t=br(e,CF),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:f}=t,h=p.useRef(null),[m,x]=p.useState(-1),g=p.useRef(a),v=p.useRef(i),y=p.useRef(s),b=p.useRef(r),w=p.useRef(n),N=Zo(e,"trapezoid-");if(p.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var G=h.current.getTotalLength();G&&x(G)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var _=ct("recharts-trapezoid",l);if(!f)return p.createElement("g",null,p.createElement("path",Ic({},zr(t),{className:_,d:ry(r,n,a,i,s)})));var E=g.current,S=v.current,j=y.current,P=b.current,C=w.current,T="0px ".concat(m===-1?1:m,"px"),k="".concat(m,"px 0px"),W=R2(["strokeDasharray"],d,c);return p.createElement(qo,{animationId:N,key:N,canBegin:m>0,duration:d,easing:c,isActive:f,begin:u},G=>{var K=$t(E,a,G),J=$t(S,i,G),V=$t(j,s,G),Z=$t(P,r,G),Q=$t(C,n,G);h.current&&(g.current=K,v.current=J,y.current=V,b.current=Z,w.current=Q);var Y=G>0?{transition:W,strokeDasharray:k}:{strokeDasharray:T};return p.createElement("path",Ic({},zr(t),{className:_,d:ry(Z,Q,K,J,V),ref:h,style:ty(ty({},Y),t.style)}))})},AF=["option","shapeType","propTransformer","activeClassName","isActive"];function kF(e,t){if(e==null)return{};var r,n,a=PF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ny(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ny(Object(r),!0).forEach(function(n){OF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ny(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OF(e,t,r){return(t=DF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DF(e){var t=RF(e,"string");return typeof t=="symbol"?t:t+""}function RF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IF(e,t){return Fc(Fc({},t),e)}function FF(e,t){return e==="symbols"}function ay(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return p.createElement(L2,r);case"trapezoid":return p.createElement(jF,r);case"sector":return p.createElement(U2,r);case"symbols":if(FF(t))return p.createElement(Pw,r);break;default:return null}}function MF(e){return p.isValidElement(e)?e.props:e}function fS(e){var{option:t,shapeType:r,propTransformer:n=IF,activeClassName:a="recharts-active-shape",isActive:i}=e,s=kF(e,AF),l;if(p.isValidElement(t))l=p.cloneElement(t,Fc(Fc({},s),MF(t)));else if(typeof t=="function")l=t(s);else if(_F(t)&&typeof t!="boolean"){var c=n(t,s);l=p.createElement(ay,{shapeType:r,elementProps:c})}else{var d=s;l=p.createElement(ay,{shapeType:r,elementProps:d})}return i?p.createElement(vr,{className:a},l):l}var Ap=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(__({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},kp=e=>{var t=Ut();return(r,n)=>a=>{e?.(r,n,a),t(ER())}},Pp=(e,t)=>{var r=Ut();return(n,a)=>i=>{e?.(n,a,i),r(TR({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Op(e){var{fn:t,args:r}=e,n=Ut(),a=Vr();return p.useLayoutEffect(()=>{if(!a){var i=t(r);return n(NR(i)),()=>{n(_R(i))}}},[t,r,n,a]),null}var hS=()=>{};function mS(e){var{legendPayload:t}=e,r=Ut(),n=Vr();return p.useLayoutEffect(()=>n?hS:(r(P2(t)),()=>{r(O2(t))}),[r,n,t]),null}function LF(e){var{legendPayload:t}=e,r=Ut(),n=He(at);return p.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?hS:(r(P2(t)),()=>{r(O2(t))}),[r,n,t]),null}var z0,BF=()=>{var[e]=p.useState(()=>No("uid-"));return e},$F=(z0=qT.useId)!==null&&z0!==void 0?z0:BF;function UF(e,t){var r=$F();return t||(e?"".concat(e,"-").concat(r):r)}var HF=p.createContext(void 0),Dp=e=>{var{id:t,type:r,children:n}=e,a=UF("recharts-".concat(r),t);return p.createElement(HF.Provider,{value:a},n(a))},WF={cartesianItems:[],polarItems:[]},pS=vn({name:"graphicalItems",initialState:WF,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Br()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ga(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Br()},removeCartesianGraphicalItem:{reducer(e,t){var r=ga(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Br()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Br()},removePolarGraphicalItem:{reducer(e,t){var r=ga(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Br()}}}),{addCartesianGraphicalItem:KF,replaceCartesianGraphicalItem:zF,removeCartesianGraphicalItem:VF,addPolarGraphicalItem:GF,removePolarGraphicalItem:YF}=pS.actions,XF=pS.reducer;function xS(e){var t=Ut(),r=p.useRef(null);return p.useLayoutEffect(()=>{r.current===null?t(KF(e)):r.current!==e&&t(zF({prev:r.current,next:e})),r.current=e},[t,e]),p.useLayoutEffect(()=>()=>{r.current&&(t(VF(r.current)),r.current=null)},[t]),null}function qF(e){var t=Ut();return p.useLayoutEffect(()=>(t(GF(e)),()=>{t(YF(e))}),[t,e]),null}var ZF=["onMouseEnter","onClick","onMouseLeave"],JF=["id"],QF=["id"];function Rp(e,t){if(e==null)return{};var r,n,a=eM(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eM(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function iy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iy(Object(r),!0).forEach(function(n){tM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tM(e,t,r){return(t=rM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rM(e){var t=nM(e,"string");return typeof t=="symbol"?t:t+""}function nM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Za(){return Za=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Za.apply(null,arguments)}function aM(e){var t=p.useMemo(()=>jp(e.children,cl),[e.children]),r=He(n=>pF(n,e.id,t));return r==null?null:p.createElement(LF,{legendPayload:r})}function iM(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:n.map(u=>u.tooltipPayload),positions:n.map(u=>u.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:Cs(l,t),hide:c,type:d,color:s,unit:""}}}var sM=(e,t)=>e>t?"start":e<t?"end":"middle",oM=(e,t,r)=>kr(typeof t=="function"?t(e):t,r,r*.8),lM=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=g2(i,s),c=a+kr(e.cx,i,i/2),d=n+kr(e.cy,s,s/2),u=kr(e.innerRadius,l,0),f=oM(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:f,maxRadius:h}},cM=(e,t)=>{var r=cr(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function uM(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var dM=(e,t)=>{if(p.isValidElement(e))return p.cloneElement(e,t);if(typeof e=="function")return e(t);var r=ct("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return p.createElement(hm,Za({},t,{type:"linear",className:r}))},fM=(e,t,r)=>{if(p.isValidElement(e))return p.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),p.isValidElement(n)))return n;var a=ct("recharts-pie-label-text",uM(e));return p.createElement(Ju,Za({},t,{alignmentBaseline:"middle",className:a}),n)};function hM(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=xn(r),c=Ei(a),d=Ei(i),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((h,m)=>{var x=(h.startAngle+h.endAngle)/2,g=Xt(h.cx,h.cy,h.outerRadius+u,x),v=Ct(Ct(Ct(Ct({},l),h),{},{stroke:"none"},c),{},{index:m,textAnchor:sM(g.x,h.cx)},g),y=Ct(Ct(Ct(Ct({},l),h),{},{fill:"none",stroke:h.fill},d),{},{index:m,points:[Xt(h.cx,h.cy,h.outerRadius,x),g],key:"line"});return p.createElement(vr,{key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(m)},i&&dM(i,y),fM(a,v,wt(h,s)))});return p.createElement(vr,{className:"recharts-pie-labels"},f)}function mM(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?p.createElement(Ep,{label:a}):p.createElement(hM,{sectors:t,props:r,showLabels:n})}function pM(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=He(qa),{onMouseEnter:s,onClick:l,onMouseLeave:c}=a,d=Rp(a,ZF),u=Ap(s,a.dataKey),f=kp(c),h=Pp(l,a.dataKey);return t==null||t.length===0?null:p.createElement(p.Fragment,null,t.map((m,x)=>{if(m?.startAngle===0&&m?.endAngle===0&&t.length!==1)return null;var g=r&&String(x)===i,v=i?n:null,y=g?r:v,b=Ct(Ct({},m),{},{stroke:m.stroke,tabIndex:-1,[N2]:x,[_2]:a.dataKey});return p.createElement(vr,Za({key:"sector-".concat(m?.startAngle,"-").concat(m?.endAngle,"-").concat(m.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},yu(d,m,x),{onMouseEnter:u(m,x),onMouseLeave:f(m,x),onClick:h(m,x)}),p.createElement(fS,Za({option:y,isActive:g,shapeType:"sector"},b)))}))}function xM(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:f}=r,h=Math.abs(r.minAngle),m=cM(l,c),x=Math.abs(m),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,v=n.filter(E=>wt(E,d,0)!==0).length,y=(x>=360?v:v-1)*g,b=x-v*h-y,w=n.reduce((E,S)=>{var j=wt(S,d,0);return E+(Ke(j)?j:0)},0),N;if(w>0){var _;N=n.map((E,S)=>{var j=wt(E,d,0),P=wt(E,u,S),C=lM(r,i,E),T=(Ke(j)?j:0)/w,k,W=Ct(Ct({},E),a&&a[S]&&a[S].props);S?k=_.endAngle+cr(m)*g*(j!==0?1:0):k=l;var G=k+cr(m)*((j!==0?h:0)+T*b),K=(k+G)/2,J=(C.innerRadius+C.outerRadius)/2,V=[{name:P,value:j,payload:W,dataKey:d,type:f}],Z=Xt(C.cx,C.cy,J,K);return _=Ct(Ct(Ct(Ct({},r.presentationProps),{},{percent:T,cornerRadius:s,name:P,tooltipPayload:V,midAngle:K,middleRadius:J,tooltipPosition:Z},W),C),{},{value:j,startAngle:k,endAngle:G,payload:W,paddingAngle:cr(m)*g}),_})}return N}function gM(e){var{showLabels:t,sectors:r,children:n}=e,a=p.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return p.createElement(Q6,{value:t?a:void 0},n)}function vM(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:f}=t,h=Zo(t,"recharts-pie-"),m=r.current,[x,g]=p.useState(!1),v=p.useCallback(()=>{typeof f=="function"&&f(),g(!1)},[f]),y=p.useCallback(()=>{typeof u=="function"&&u(),g(!0)},[u]);return p.createElement(gM,{showLabels:!x,sectors:n},p.createElement(qo,{animationId:h,begin:i,duration:s,isActive:a,easing:l,onAnimationStart:y,onAnimationEnd:v,key:h},b=>{var w=[],N=n&&n[0],_=N?.startAngle;return n?.forEach((E,S)=>{var j=m&&m[S],P=S>0?Ti(E,"paddingAngle",0):0;if(j){var C=$t(j.endAngle-j.startAngle,E.endAngle-E.startAngle,b),T=Ct(Ct({},E),{},{startAngle:_+P,endAngle:_+C+P});w.push(T),_=T.endAngle}else{var{endAngle:k,startAngle:W}=E,G=$t(0,k-W,b),K=Ct(Ct({},E),{},{startAngle:_+P,endAngle:_+G+P});w.push(K),_=K.endAngle}}),r.current=w,p.createElement(vr,null,p.createElement(pM,{sectors:w,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),p.createElement(mM,{showLabels:!x,sectors:n,props:t}),t.children)}var yM={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ai.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function bM(e){var{id:t}=e,r=Rp(e,JF),{hide:n,className:a,rootTabIndex:i}=e,s=p.useMemo(()=>jp(e.children,cl),[e.children]),l=He(u=>xF(u,t,s)),c=p.useRef(null),d=ct("recharts-pie",a);return n||l==null?(c.current=null,p.createElement(vr,{tabIndex:i,className:d})):p.createElement(p.Fragment,null,p.createElement(Op,{fn:iM,args:Ct(Ct({},e),{},{sectors:l})}),p.createElement(vr,{tabIndex:i,className:d},p.createElement(vM,{props:Ct(Ct({},r),{},{sectors:l}),previousSectorsRef:c})))}function gS(e){var t=br(e,yM),{id:r}=t,n=Rp(t,QF),a=xn(n);return p.createElement(Dp,{id:r,type:"pie"},i=>p.createElement(p.Fragment,null,p.createElement(qF,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),p.createElement(aM,Za({},n,{id:i})),p.createElement(bM,Za({},n,{id:i}))))}gS.displayName="Pie";function sy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sy(Object(r),!0).forEach(function(n){wM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wM(e,t,r){return(t=NM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NM(e){var t=_M(e,"string");return typeof t=="symbol"?t:t+""}function _M(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SM={xAxis:{},yAxis:{},zAxis:{}},vS=vn({name:"cartesianAxis",initialState:SM,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Br()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Br()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Br()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Br()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Br()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Br()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=oy(oy({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:EM,removeXAxis:TM,addYAxis:CM,removeYAxis:jM,addZAxis:TZ,removeZAxis:CZ,updateYAxisWidth:AM}=vS.actions,kM=vS.reducer,PM=ie([nr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),OM=ie([PM,Pa,Oa],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Ip=()=>He(OM),DM=()=>He(fI);function ly(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ly(Object(r),!0).forEach(function(n){RM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ly(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RM(e,t,r){return(t=IM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IM(e){var t=FM(e,"string");return typeof t=="symbol"?t:t+""}function FM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MM=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=cy(cy({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Ei(a)),rm(a)),l;return p.isValidElement(a)?l=p.cloneElement(a,s):typeof a=="function"?l=a(s):l=p.createElement(iS,s),p.createElement(vr,{className:"recharts-active-dot"},l)};function LM(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=He(qa),s=DM();if(t==null||s==null)return null;var l=t.find(c=>s.includes(c.payload));return Pt(l)?null:MM({point:l,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var BM="Invariant failed";function $M(e,t){throw new Error(BM)}var UM=["x","y"];function hh(){return hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hh.apply(null,arguments)}function uy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uy(Object(r),!0).forEach(function(n){HM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HM(e,t,r){return(t=WM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WM(e){var t=KM(e,"string");return typeof t=="symbol"?t:t+""}function KM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zM(e,t){if(e==null)return{};var r,n,a=VM(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VM(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GM(e,t){var{x:r,y:n}=e,a=zM(e,UM),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),h=parseInt(f,10);return to(to(to(to(to({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function Fp(e){return p.createElement(fS,hh({shapeType:"rectangle",propTransformer:GM,activeClassName:"recharts-active-bar"},e))}var YM=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Ke(t))return t;var i=Ke(n)||Pt(n);return i?t(n,a):(i||$M(),r)}},XM={},yS=vn({name:"errorBars",initialState:XM,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:jZ,replaceErrorBar:AZ,removeErrorBar:kZ}=yS.actions,qM=yS.reducer,ZM=["children"];function JM(e,t){if(e==null)return{};var r,n,a=QM(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function QM(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var e8={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},t8=p.createContext(e8);function bS(e){var{children:t}=e,r=JM(e,ZM);return p.createElement(t8.Provider,{value:r},t)}function Mp(e,t){var r,n,a=He(d=>Ra(d,e)),i=He(d=>Ia(d,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:nn.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:an.allowDataOverflow,c=s||l;return{needClip:c,needClipX:s,needClipY:l}}function wS(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=Ip(),{needClipX:i,needClipY:s,needClip:l}=Mp(t,r);if(!l)return null;var{x:c,y:d,width:u,height:f}=a;return p.createElement("clipPath",{id:"clipPath-".concat(n)},p.createElement("rect",{x:i?c:c-u/2,y:s?d:d-f/2,width:i?u:u*2,height:s?f:f*2}))}var r8=["onMouseEnter","onMouseLeave","onClick"],n8=["value","background","tooltipPosition"],a8=["id"],i8=["onMouseEnter","onClick","onMouseLeave"];function Ja(){return Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ja.apply(null,arguments)}function dy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dy(Object(r),!0).forEach(function(n){s8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s8(e,t,r){return(t=o8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o8(e){var t=l8(e,"string");return typeof t=="symbol"?t:t+""}function l8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mc(e,t){if(e==null)return{};var r,n,a=c8(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function c8(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var u8=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Cs(r,t),payload:e}]};function d8(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:Cs(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function f8(e){var t=He(qa),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:c}=i,d=Mc(i,r8),u=Ap(s,n),f=kp(l),h=Pp(c,n);if(!a||r==null)return null;var m=Ei(a);return p.createElement(p.Fragment,null,r.map((x,g)=>{var{value:v,background:y,tooltipPosition:b}=x,w=Mc(x,n8);if(!y)return null;var N=u(x,g),_=f(x,g),E=h(x,g),S=$r($r($r($r($r({option:a,isActive:String(g)===t},w),{},{fill:"#eee"},y),m),yu(d,x,g)),{},{onMouseEnter:N,onMouseLeave:_,onClick:E,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return p.createElement(Fp,Ja({key:"background-bar-".concat(g)},S))}))}function h8(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return $r($r({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return p.createElement(nS,{value:t?a:void 0},r)}function m8(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,l=He(qa),c=He(L_),d=r&&String(i)===l&&(c==null||s===c),u=d?r:t;return p.createElement(Fp,Ja({},n,{name:String(n.name)},a,{isActive:d,option:u,index:i,dataKey:s}))}function p8(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return p.createElement(Fp,Ja({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function x8(e){var{data:t,props:r}=e,n=xn(r),{id:a}=n,i=Mc(n,a8),{shape:s,dataKey:l,activeBar:c}=r,{onMouseEnter:d,onClick:u,onMouseLeave:f}=r,h=Mc(r,i8),m=Ap(d,l),x=kp(f),g=Pp(u,l);return t?p.createElement(p.Fragment,null,t.map((v,y)=>p.createElement(vr,Ja({key:"rectangle-".concat(v?.x,"-").concat(v?.y,"-").concat(v?.value,"-").concat(y),className:"recharts-bar-rectangle"},yu(h,v,y),{onMouseEnter:m(v,y),onMouseLeave:x(v,y),onClick:g(v,y)}),c?p.createElement(m8,{shape:s,activeBar:c,baseProps:i,entry:v,index:y,dataKey:l}):p.createElement(p8,{shape:s,baseProps:i,entry:v,index:y,dataKey:l})))):null}function g8(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,f=r.current,h=Zo(t,"recharts-bar-"),[m,x]=p.useState(!1),g=!m,v=p.useCallback(()=>{typeof d=="function"&&d(),x(!1)},[d]),y=p.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return p.createElement(h8,{showLabels:g,rects:n},p.createElement(qo,{animationId:h,begin:s,duration:l,isActive:i,easing:c,onAnimationEnd:v,onAnimationStart:y,key:h},b=>{var w=b===1?n:n?.map((N,_)=>{var E=f&&f[_];if(E)return $r($r({},N),{},{x:$t(E.x,N.x,b),y:$t(E.y,N.y,b),width:$t(E.width,N.width,b),height:$t(E.height,N.height,b)});if(a==="horizontal"){var S=$t(0,N.height,b);return $r($r({},N),{},{y:N.y+N.height-S,height:S})}var j=$t(0,N.width,b);return $r($r({},N),{},{width:j})});return b>0&&(r.current=w??null),w==null?null:p.createElement(vr,null,p.createElement(x8,{props:t,data:w}))}),p.createElement(Ep,{label:t.label}),t.children)}function v8(e){var t=p.useRef(null);return p.createElement(g8,{previousRectanglesRef:t,props:e})}var NS=0,y8=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:wt(e,t)}};class b8 extends p.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=ct("recharts-bar",a),f=d;return p.createElement(vr,{className:u,id:d},l&&p.createElement("defs",null,p.createElement(wS,{clipPathId:f,xAxisId:i,yAxisId:s})),p.createElement(vr,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},p.createElement(f8,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),p.createElement(v8,this.props)))}}var w8={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!ai.isSsr,legendType:"rect",minPointSize:NS,xAxisId:0,yAxisId:0};function N8(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:f}=Mp(t,r),h=Pu(),m=Vr(),x=jp(e.children,cl),g=He(b=>q8(b,t,r,m,e.id,x));if(h!=="vertical"&&h!=="horizontal")return null;var v,y=g?.[0];return y==null||y.height==null||y.width==null?v=0:v=h==="vertical"?y.height/2:y.width/2,p.createElement(bS,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:y8,errorBarOffset:v},p.createElement(b8,Ja({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function _8(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:f,offset:h,cells:m,parentViewBox:x}=e,g=t==="horizontal"?l:s,v=u?g.scale.domain():null,y=Ok({numericAxis:g});return f.map((b,w)=>{var N,_,E,S,j,P;u?N=Tk(u[w],v):(N=wt(b,r),Array.isArray(N)||(N=[y,N]));var C=YM(n,NS)(N[1],w);if(t==="horizontal"){var T,[k,W]=[l.scale(N[0]),l.scale(N[1])];_=Vg({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:b,index:w}),E=(T=W??k)!==null&&T!==void 0?T:void 0,S=a.size;var G=k-W;if(j=jn(G)?0:G,P={x:_,y:h.top,width:S,height:h.height},Math.abs(C)>0&&Math.abs(j)<Math.abs(C)){var K=cr(j||C)*(Math.abs(C)-Math.abs(j));E-=K,j+=K}}else{var[J,V]=[s.scale(N[0]),s.scale(N[1])];if(_=J,E=Vg({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:b,index:w}),S=V-J,j=a.size,P={x:h.left,y:E,width:h.width,height:j},Math.abs(C)>0&&Math.abs(S)<Math.abs(C)){var Z=cr(S||C)*(Math.abs(C)-Math.abs(S));S+=Z}}if(_==null||E==null||S==null||j==null)return null;var Q=$r($r({},b),{},{x:_,y:E,width:S,height:j,value:u?N:N[1],payload:b,background:P,tooltipPosition:{x:_+S/2,y:E+j/2},parentViewBox:x},m&&m[w]&&m[w].props);return Q}).filter(Boolean)}function S8(e){var t=br(e,w8),r=Vr();return p.createElement(Dp,{id:t.id,type:"bar"},n=>p.createElement(p.Fragment,null,p.createElement(mS,{legendPayload:u8(t)}),p.createElement(Op,{fn:d8,args:t}),p.createElement(xS,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:Pk(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),p.createElement(N8,Ja({},t,{id:n}))))}var mh=p.memo(S8);mh.displayName="Bar";function fy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ol(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fy(Object(r),!0).forEach(function(n){E8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E8(e,t,r){return(t=T8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T8(e){var t=C8(e,"string");return typeof t=="symbol"?t:t+""}function C8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j8=(e,t)=>t,A8=(e,t,r)=>r,k8=(e,t,r,n)=>n,P8=(e,t,r,n,a)=>a,ul=ie([Vu,P8],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),O8=ie([ul],e=>e?.maxBarSize),D8=(e,t,r,n,a,i)=>i,hy=(e,t,r)=>{var n=r??e;if(!Pt(n))return kr(n,t,0)},R8=ie([at,Vu,j8,A8,k8],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),I8=(e,t,r,n)=>{var a=at(e);return a==="horizontal"?sh(e,"yAxis",r,n):sh(e,"xAxis",t,n)},F8=(e,t,r)=>{var n=at(e);return n==="horizontal"?m1(e,"xAxis",t):m1(e,"yAxis",r)},M8=(e,t,r)=>{var n={},a=e.filter(Wu),i=e.filter(d=>d.stackId==null),s=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),n),l=Object.entries(s).map(d=>{var[u,f]=d,h=f.map(x=>x.dataKey),m=hy(t,r,f[0].barSize);return{stackId:u,dataKeys:h,barSize:m}}),c=i.map(d=>{var u=[d.dataKey].filter(h=>h!=null),f=hy(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...c]},L8=ie([R8,vD,F8],M8),B8=(e,t,r,n,a)=>{var i,s,l=ul(e,t,r,n,a);if(l!=null){var c=at(e),d=LN(e),{maxBarSize:u}=l,f=Pt(u)?d:u,h,m;return c==="horizontal"?(h=Xa(e,"xAxis",t,n),m=Ya(e,"xAxis",t,n)):(h=Xa(e,"yAxis",r,n),m=Ya(e,"yAxis",r,n)),(i=(s=To(h,m,!0))!==null&&s!==void 0?s:f)!==null&&i!==void 0?i:0}},_S=(e,t,r,n)=>{var a=at(e),i,s;return a==="horizontal"?(i=Xa(e,"xAxis",t,n),s=Ya(e,"xAxis",t,n)):(i=Xa(e,"yAxis",r,n),s=Ya(e,"yAxis",r,n)),To(i,s)};function $8(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=kr(e,r,0,!0),l,c=[];if(Dr(n[0].barSize)){var d=!1,u=r/i,f=n.reduce((y,b)=>y+(b.barSize||0),0);f+=(i-1)*s,f>=r&&(f-=(i-1)*s,s=0),f>=r&&u>0&&(d=!0,u*=.9,f=i*u);var h=(r-f)/2>>0,m={offset:h-s,size:0};l=n.reduce((y,b)=>{var w,N={stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:m.offset+m.size+s,size:d?u:(w=b.barSize)!==null&&w!==void 0?w:0}},_=[...y,N];return m=_[_.length-1].position,_},c)}else{var x=kr(t,r,0,!0);r-2*x-(i-1)*s<=0&&(s=0);var g=(r-2*x-(i-1)*s)/i;g>1&&(g>>=0);var v=Dr(a)?Math.min(g,a):g;l=n.reduce((y,b,w)=>[...y,{stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:x+(g+s)*w+(g-v)/2,size:v}}],c)}return l}}var U8=(e,t,r,n,a,i,s)=>{var l=Pt(s)?t:s,c=$8(r,n,a!==i?a:i,e,l);return a!==i&&c!=null&&(c=c.map(d=>Ol(Ol({},d),{},{position:Ol(Ol({},d.position),{},{offset:d.position.offset-a/2})}))),c},H8=ie([L8,LN,gD,BN,B8,_S,O8],U8),W8=(e,t,r,n)=>Xa(e,"xAxis",t,n),K8=(e,t,r,n)=>Xa(e,"yAxis",r,n),z8=(e,t,r,n)=>Ya(e,"xAxis",t,n),V8=(e,t,r,n)=>Ya(e,"yAxis",r,n),G8=ie([H8,ul],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Y8=(e,t)=>{var r=Vm(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},X8=ie([I8,ul],Y8),q8=ie([nr,um,W8,K8,z8,V8,G8,at,Bu,_S,X8,ul,D8],(e,t,r,n,a,i,s,l,c,d,u,f,h)=>{var{chartData:m,dataStartIndex:x,dataEndIndex:g}=c;if(!(f==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:v}=f,y;if(v!=null&&v.length>0?y=v:y=m?.slice(x,g+1),y!=null)return _8({layout:l,barSettings:f,pos:s,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:u,displayedData:y,offset:e,cells:h})}}),SS=e=>{var{chartData:t}=e,r=Ut(),n=Vr();return p.useEffect(()=>n?()=>{}:(r(S1(t)),()=>{r(S1(void 0))}),[t,r,n]),null},my={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ES=vn({name:"brush",initialState:my,reducers:{setBrushSettings(e,t){return t.payload==null?my:t.payload}}}),{setBrushSettings:PZ}=ES.actions,Z8=ES.reducer;function J8(e,t,r){return(t=Q8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q8(e){var t=eL(e,"string");return typeof t=="symbol"?t:t+""}function eL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Lp{static create(t){return new Lp(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}J8(Lp,"EPS",1e-4);function tL(e){return(e%180+180)%180}var rL=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=tL(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},nL={dots:[],areas:[],lines:[]},TS=vn({name:"referenceElements",initialState:nL,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ga(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ga(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ga(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:OZ,removeDot:DZ,addArea:RZ,removeArea:IZ,addLine:FZ,removeLine:MZ}=TS.actions,aL=TS.reducer,iL=p.createContext(void 0),sL=e=>{var{children:t}=e,[r]=p.useState("".concat(No("recharts"),"-clip")),n=Ip();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return p.createElement(iL.Provider,{value:r},p.createElement("defs",null,p.createElement("clipPath",{id:r},p.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function ws(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function CS(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function oL(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return rL(n,r)}function lL(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function Lc(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function cL(e,t){return CS(e,t+1)}function uL(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,c=0,d=1,u=s,f=function(){var x=n?.[c];if(x===void 0)return{v:CS(n,d)};var g=c,v,y=()=>(v===void 0&&(v=r(x,g)),v),b=x.coordinate,w=c===0||Lc(e,b,y,u,l);w||(c=0,u=s,d+=1),w&&(u=b+e*(y()/2+a),c+=d)},h;d<=i.length;)if(h=f(),h)return h.v;return[]}function py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?py(Object(r),!0).forEach(function(n){dL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):py(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dL(e,t,r){return(t=fL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fL(e){var t=hL(e,"string");return typeof t=="symbol"?t:t+""}function hL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mL(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:c}=t,d=function(h){var m=i[h],x,g=()=>(x===void 0&&(x=r(m,h)),x);if(h===s-1){var v=e*(m.coordinate+e*g()/2-c);i[h]=m=Sr(Sr({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate})}else i[h]=m=Sr(Sr({},m),{},{tickCoord:m.coordinate});var y=Lc(e,m.tickCoord,g,l,c);y&&(c=m.tickCoord-e*(g()/2+a),i[h]=Sr(Sr({},m),{},{isShow:!0}))},u=s-1;u>=0;u--)d(u);return i}function pL(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:c,end:d}=t;if(i){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);s[l-1]=u=Sr(Sr({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=Lc(e,u.tickCoord,()=>f,c,d);m&&(d=u.tickCoord-e*(f/2+a),s[l-1]=Sr(Sr({},u),{},{isShow:!0}))}for(var x=i?l-1:l,g=function(b){var w=s[b],N,_=()=>(N===void 0&&(N=r(w,b)),N);if(b===0){var E=e*(w.coordinate-e*_()/2-c);s[b]=w=Sr(Sr({},w),{},{tickCoord:E<0?w.coordinate-E*e:w.coordinate})}else s[b]=w=Sr(Sr({},w),{},{tickCoord:w.coordinate});var S=Lc(e,w.tickCoord,_,c,d);S&&(c=w.tickCoord+e*(_()/2+a),s[b]=Sr(Sr({},w),{},{isShow:!0}))},v=0;v<x;v++)g(v);return s}function Bp(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:c,tickFormatter:d,unit:u,angle:f}=e;if(!a||!a.length||!n)return[];if(Ke(c)||ai.isSsr){var h;return(h=cL(a,Ke(c)?c:0))!==null&&h!==void 0?h:[]}var m=[],x=l==="top"||l==="bottom"?"width":"height",g=u&&x==="width"?ho(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(w,N)=>{var _=typeof d=="function"?d(w.value,N):w.value;return x==="width"?oL(ho(_,{fontSize:t,letterSpacing:r}),g,f):ho(_,{fontSize:t,letterSpacing:r})[x]},y=a.length>=2?cr(a[1].coordinate-a[0].coordinate):1,b=lL(i,y,x);return c==="equidistantPreserveStart"?uL(y,b,v,a,s):(c==="preserveStart"||c==="preserveStartEnd"?m=pL(y,b,v,a,s,c==="preserveStartEnd"):m=mL(y,b,v,a,s),m.filter(w=>w.isShow))}var xL=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>s&&(s=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+i,d=s+c+l+(r?n:0);return Math.round(d)}return 0},gL=["axisLine","width","height","className","hide","ticks"],vL=["viewBox"],yL=["viewBox"];function ph(e,t){if(e==null)return{};var r,n,a=bL(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bL(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Pi(){return Pi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pi.apply(null,arguments)}function xy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xy(Object(r),!0).forEach(function(n){wL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wL(e,t,r){return(t=NL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NL(e){var t=_L(e,"string");return typeof t=="symbol"?t:t+""}function _L(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $p={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function SL(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=er(er(er({},c),xn(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!s||i==="bottom"&&s);d=er(er({},d),{},{x1:t,y1:r+u*a,x2:t+n,y2:r+u*a})}else{var f=+(i==="left"&&!s||i==="right"&&s);d=er(er({},d),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return p.createElement("line",Pi({},d,{className:ct("recharts-cartesian-axis-line",Ti(l,"className"))}))}function EL(e,t,r,n,a,i,s,l,c){var d,u,f,h,m,x,g=l?-1:1,v=e.tickSize||s,y=Ke(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=u=e.coordinate,h=r+ +!l*a,f=h-g*v,x=f-g*c,m=y;break;case"left":f=h=e.coordinate,u=t+ +!l*n,d=u-g*v,m=d-g*c,x=y;break;case"right":f=h=e.coordinate,u=t+ +l*n,d=u+g*v,m=d+g*c,x=y;break;default:d=u=e.coordinate,h=r+ +l*a,f=h+g*v,x=f+g*c,m=y;break}return{line:{x1:d,y1:f,x2:u,y2:h},tick:{x:m,y:x}}}function TL(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function CL(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function jL(e){var{option:t,tickProps:r,value:n}=e,a,i=ct(r.className,"recharts-cartesian-axis-tick-value");if(p.isValidElement(t))a=p.cloneElement(t,er(er({},r),{},{className:i}));else if(typeof t=="function")a=t(er(er({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=ct(s,t?.className)),a=p.createElement(Ju,Pi({},r,{className:s}),n)}return a}function AL(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:l,tickTextProps:c,orientation:d,mirror:u,x:f,y:h,width:m,height:x,tickSize:g,tickMargin:v,fontSize:y,letterSpacing:b,getTicksConfig:w,events:N}=e,_=Bp(er(er({},w),{},{ticks:t}),y,b),E=TL(d,u),S=CL(d,u),j=xn(w),P=Ei(r),C={};typeof n=="object"&&(C=n);var T=er(er({},j),{},{fill:"none"},C),k=_.map((W,G)=>{var{line:K,tick:J}=EL(W,f,h,m,x,d,g,u,v),V=er(er(er(er({textAnchor:E,verticalAnchor:S},j),{},{stroke:"none",fill:a},P),J),{},{index:G,payload:W,visibleTicksCount:_.length,tickFormatter:i,padding:l},c);return p.createElement(vr,Pi({className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},yu(N,W,G)),n&&p.createElement("line",Pi({},T,K,{className:ct("recharts-cartesian-axis-tick-line",Ti(n,"className"))})),r&&p.createElement(jL,{option:r,tickProps:V,value:"".concat(typeof i=="function"?i(W.value,G):W.value).concat(s||"")}))});return k.length>0?p.createElement("g",{className:"recharts-cartesian-axis-ticks"},k):null}var kL=p.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:l}=e,c=ph(e,gL),[d,u]=p.useState(""),[f,h]=p.useState(""),m=p.useRef(null);p.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return xL({ticks:m.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=p.useCallback(g=>{if(g){var v=g.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=v;var y=v[0];if(y){var b=window.getComputedStyle(y),w=b.fontSize,N=b.letterSpacing;(w!==d||N!==f)&&(u(w),h(N))}}},[d,f]);return s||n!=null&&n<=0||a!=null&&a<=0?null:p.createElement(vr,{className:ct("recharts-cartesian-axis",i),ref:x},p.createElement(SL,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:xn(e)}),p.createElement(AL,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:d,letterSpacing:f,getTicksConfig:e,events:c}),p.createElement(O6,{x:e.x,y:e.y,width:e.width,height:e.height},p.createElement(H6,{label:e.label,labelRef:e.labelRef}),e.children))}),PL=p.memo(kL,(e,t)=>{var{viewBox:r}=e,n=ph(e,vL),{viewBox:a}=t,i=ph(t,yL);return ws(r,a)&&ws(n,i)}),Up=p.forwardRef((e,t)=>{var r=br(e,$p);return p.createElement(PL,Pi({},r,{ref:t}))});Up.displayName="CartesianAxis";var OL=["x1","y1","x2","y2","key"],DL=["offset"],RL=["xAxisId","yAxisId"],IL=["xAxisId","yAxisId"];function gy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gy(Object(r),!0).forEach(function(n){FL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FL(e,t,r){return(t=ML(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ML(e){var t=LL(e,"string");return typeof t=="symbol"?t:t+""}function LL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yi(){return yi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yi.apply(null,arguments)}function Bc(e,t){if(e==null)return{};var r,n,a=BL(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BL(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $L=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return p.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function jS(e,t){var r;if(p.isValidElement(e))r=p.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:l}=t,c=Bc(t,OL),d=xn(c),{offset:u}=d,f=Bc(d,DL);r=p.createElement("line",yi({},f,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function UL(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Bc(e,RL),c=a.map((d,u)=>{var f=jr(jr({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return jS(n,f)});return p.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function HL(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=Bc(e,IL),c=a.map((d,u)=>{var f=jr(jr({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return jS(n,f)});return p.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function WL(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var d=l.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==d[0]&&d.unshift(0);var u=d.map((f,h)=>{var m=!d[h+1],x=m?a+s-f:d[h+1]-f;if(x<=0)return null;var g=h%t.length;return p.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:x,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function KL(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==d[0]&&d.unshift(0);var u=d.map((f,h)=>{var m=!d[h+1],x=m?a+s-f:d[h+1]-f;if(x<=0)return null;var g=h%r.length;return p.createElement("rect",{key:"react-".concat(h),x:f,y:i,width:x,height:l,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var zL=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return y2(Bp(jr(jr(jr({},$p),r),{},{ticks:b2(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},VL=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return y2(Bp(jr(jr(jr({},$p),r),{},{ticks:b2(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},GL={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Hp(e){var t=j2(),r=A2(),n=C2(),a=jr(jr({},br(e,GL)),{},{x:Ke(e.x)?e.x:n.left,y:Ke(e.y)?e.y:n.top,width:Ke(e.width)?e.width:n.width,height:Ke(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:c,width:d,height:u,syncWithTicks:f,horizontalValues:h,verticalValues:m}=a,x=Vr(),g=He(P=>p1(P,"xAxis",i,x)),v=He(P=>p1(P,"yAxis",s,x));if(!Ke(d)||d<=0||!Ke(u)||u<=0||!Ke(l)||l!==+l||!Ke(c)||c!==+c)return null;var y=a.verticalCoordinatesGenerator||zL,b=a.horizontalCoordinatesGenerator||VL,{horizontalPoints:w,verticalPoints:N}=a;if((!w||!w.length)&&typeof b=="function"){var _=h&&h.length,E=b({yAxis:v?jr(jr({},v),{},{ticks:_?h:v.ticks}):void 0,width:t,height:r,offset:n},_?!0:f);gc(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(w=E)}if((!N||!N.length)&&typeof y=="function"){var S=m&&m.length,j=y({xAxis:g?jr(jr({},g),{},{ticks:S?m:g.ticks}):void 0,width:t,height:r,offset:n},S?!0:f);gc(Array.isArray(j),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(N=j)}return p.createElement("g",{className:"recharts-cartesian-grid"},p.createElement($L,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),p.createElement(WL,yi({},a,{horizontalPoints:w})),p.createElement(KL,yi({},a,{verticalPoints:N})),p.createElement(UL,yi({},a,{offset:n,horizontalPoints:w,xAxis:g,yAxis:v})),p.createElement(HL,yi({},a,{offset:n,verticalPoints:N,xAxis:g,yAxis:v})))}Hp.displayName="CartesianGrid";var AS=(e,t,r,n)=>Xa(e,"xAxis",t,n),kS=(e,t,r,n)=>Ya(e,"xAxis",t,n),PS=(e,t,r,n)=>Xa(e,"yAxis",r,n),OS=(e,t,r,n)=>Ya(e,"yAxis",r,n),YL=ie([at,AS,PS,kS,OS],(e,t,r,n,a)=>ni(e,"xAxis")?To(t,n,!1):To(r,a,!1)),XL=(e,t,r,n,a)=>a;function qL(e){return e.type==="line"}var ZL=ie([Vu,XL],(e,t)=>e.filter(qL).find(r=>r.id===t)),JL=ie([at,AS,PS,kS,OS,ZL,YL,Bu],(e,t,r,n,a,i,s,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=l;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:f,data:h}=i,m;if(h!=null&&h.length>0?m=h:m=c?.slice(d,u+1),m!=null)return w7({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:s,displayedData:m})}});function QL(e){var t=Ei(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),l=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(l)||l<0)&&(l=n),{r:s,strokeWidth:l}}return{r,strokeWidth:n}}var e7=["id"],t7=["type","layout","connectNulls","needClip"],r7=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function vy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vy(Object(r),!0).forEach(function(n){n7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n7(e,t,r){return(t=a7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a7(e){var t=i7(e,"string");return typeof t=="symbol"?t:t+""}function i7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wp(e,t){if(e==null)return{};var r,n,a=s7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function s7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oi.apply(null,arguments)}var o7=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:Cs(r,t),payload:e}]};function l7(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:l,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Cs(s,t),hide:l,type:e.tooltipType,color:e.stroke,unit:c}}}var DS=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function c7(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var u7=(e,t,r)=>{var n=r.reduce((f,h)=>f+h);if(!n)return DS(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,l=[],c=0,d=0;c<r.length;d+=r[c],++c)if(d+r[c]>i){l=[...r.slice(0,c),i-d];break}var u=l.length%2===0?[0,s]:[s];return[...c7(r,a),...l,...u].map(f=>"".concat(f,"px")).join(", ")};function d7(e,t){var r;if(p.isValidElement(e))r=p.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=ct("recharts-line-dot",typeof e!="boolean"?e.className:"");r=p.createElement(iS,Oi({},t,{className:n}))}return r}function f7(e,t){return e==null?!1:t?!0:e.length===1}function h7(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!f7(r,a))return null;var{id:l}=n,c=Wp(n,e7),d=dS(a),u=xn(c),f=vj(a),h=r.map((x,g)=>{var v=cn(cn(cn({key:"dot-".concat(g),r:3},u),f),{},{index:g,cx:x.x,cy:x.y,dataKey:i,value:x.value,payload:x.payload,points:r});return d7(a,v)}),m={clipPath:s?"url(#clipPath-".concat(d?"":"dots-").concat(t,")"):void 0};return p.createElement(vr,Oi({className:"recharts-line-dots",key:"dots"},m),h)}function m7(e){var{showLabels:t,children:r,points:n}=e,a=p.useMemo(()=>n?.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return cn(cn({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return p.createElement(nS,{value:t?a:null},r)}function yy(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:l,connectNulls:c,needClip:d}=i,u=Wp(i,t7),f=cn(cn({},zr(u)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:l,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return p.createElement(p.Fragment,null,n?.length>1&&p.createElement(hm,Oi({},f,{pathRef:r})),p.createElement(h7,{points:n,clipPathId:t,props:i}))}function p7(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function x7(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:f,animateNewValues:h,width:m,height:x,onAnimationEnd:g,onAnimationStart:v}=r,y=a.current,b=Zo(r,"recharts-line-"),[w,N]=p.useState(!1),_=!w,E=p.useCallback(()=>{typeof g=="function"&&g(),N(!1)},[g]),S=p.useCallback(()=>{typeof v=="function"&&v(),N(!0)},[v]),j=p7(n.current),P=i.current;return p.createElement(m7,{points:s,showLabels:_},r.children,p.createElement(qo,{animationId:b,begin:d,duration:u,isActive:c,easing:f,onAnimationEnd:E,onAnimationStart:S,key:b},C=>{var T=$t(P,j+P,C),k=Math.min(T,j),W;if(c)if(l){var G="".concat(l).split(/[,\s]+/gim).map(V=>parseFloat(V));W=u7(k,j,G)}else W=DS(j,k);else W=l==null?void 0:String(l);if(y){var K=y.length/s.length,J=C===1?s:s.map((V,Z)=>{var Q=Math.floor(Z*K);if(y[Q]){var Y=y[Q];return cn(cn({},V),{},{x:$t(Y.x,V.x,C),y:$t(Y.y,V.y,C)})}return h?cn(cn({},V),{},{x:$t(m*2,V.x,C),y:$t(x/2,V.y,C)}):cn(cn({},V),{},{x:V.x,y:V.y})});return a.current=J,p.createElement(yy,{props:r,points:J,clipPathId:t,pathRef:n,strokeDasharray:W})}return C>0&&j>0&&(a.current=s,i.current=k),p.createElement(yy,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:W})}),p.createElement(Ep,{label:r.label}))}function g7(e){var{clipPathId:t,props:r}=e,n=p.useRef(null),a=p.useRef(0),i=p.useRef(null);return p.createElement(x7,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var v7=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:wt(e.payload,t)});class y7 extends p.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:l,left:c,width:d,height:u,id:f,needClip:h}=this.props;if(t)return null;var m=ct("recharts-line",a),x=f,{r:g,strokeWidth:v}=QL(r),y=dS(r),b=g*2+v;return p.createElement(p.Fragment,null,p.createElement(vr,{className:m},h&&p.createElement("defs",null,p.createElement(wS,{clipPathId:x,xAxisId:i,yAxisId:s}),!y&&p.createElement("clipPath",{id:"clipPath-dots-".concat(x)},p.createElement("rect",{x:c-b/2,y:l-b/2,width:d+b,height:u+b}))),p.createElement(bS,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:v7,errorBarOffset:0},p.createElement(g7,{props:this.props,clipPathId:x}))),p.createElement(LM,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var RS={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!ai.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function b7(e){var t=br(e,RS),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:l,dot:c,hide:d,isAnimationActive:u,label:f,legendType:h,xAxisId:m,yAxisId:x,id:g}=t,v=Wp(t,r7),{needClip:y}=Mp(m,x),b=Ip(),w=Pu(),N=Vr(),_=He(C=>JL(C,m,x,N,g));if(w!=="horizontal"&&w!=="vertical"||_==null||b==null)return null;var{height:E,width:S,x:j,y:P}=b;return p.createElement(y7,Oi({},v,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:u,hide:d,label:f,legendType:h,xAxisId:m,yAxisId:x,points:_,layout:w,height:E,width:S,left:j,top:P,needClip:y}))}function w7(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:l,displayedData:c}=e;return c.map((d,u)=>{var f=wt(d,s);if(t==="horizontal"){var h=zg({axis:r,ticks:a,bandSize:l,entry:d,index:u}),m=Pt(f)?null:n.scale(f);return{x:h,y:m,value:f,payload:d}}var x=Pt(f)?null:r.scale(f),g=zg({axis:n,ticks:i,bandSize:l,entry:d,index:u});return x==null||g==null?null:{x,y:g,value:f,payload:d}}).filter(Boolean)}function N7(e){var t=br(e,RS),r=Vr();return p.createElement(Dp,{id:t.id,type:"line"},n=>p.createElement(p.Fragment,null,p.createElement(mS,{legendPayload:o7(t)}),p.createElement(Op,{fn:l7,args:t}),p.createElement(xS,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),p.createElement(b7,Oi({},t,{id:n}))))}var IS=p.memo(N7);IS.displayName="Line";var _7=["dangerouslySetInnerHTML","ticks"],S7=["id"],E7=["domain"],T7=["domain"];function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xh.apply(null,arguments)}function $c(e,t){if(e==null)return{};var r,n,a=C7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function C7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function j7(e){var t=Ut();return p.useLayoutEffect(()=>(t(EM(e)),()=>{t(TM(e))}),[e,t]),null}var A7=e=>{var{xAxisId:t,className:r}=e,n=He(um),a=Vr(),i="xAxis",s=He(v=>Is(v,i,t,a)),l=He(v=>g_(v,i,t,a)),c=He(v=>h_(v,t)),d=He(v=>fR(v,t)),u=He(v=>YN(v,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:h}=e,m=$c(e,_7),{id:x}=u,g=$c(u,S7);return p.createElement(Up,xh({},m,g,{scale:s,x:d.x,y:d.y,width:c.width,height:c.height,className:ct("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},k7={allowDataOverflow:nn.allowDataOverflow,allowDecimals:nn.allowDecimals,allowDuplicatedCategory:nn.allowDuplicatedCategory,height:nn.height,hide:!1,mirror:nn.mirror,orientation:nn.orientation,padding:nn.padding,reversed:nn.reversed,scale:nn.scale,tickCount:nn.tickCount,type:nn.type,xAxisId:0},P7=e=>{var t,r,n,a,i,s=br(e,k7);return p.createElement(p.Fragment,null,p.createElement(j7,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),p.createElement(A7,s))},O7=(e,t)=>{var{domain:r}=e,n=$c(e,E7),{domain:a}=t,i=$c(t,T7);return ws(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:ws({domain:r},{domain:a}):!1},Kp=p.memo(P7,O7);Kp.displayName="XAxis";var D7=["dangerouslySetInnerHTML","ticks"],R7=["id"],I7=["domain"],F7=["domain"];function gh(){return gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gh.apply(null,arguments)}function Uc(e,t){if(e==null)return{};var r,n,a=M7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function M7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function L7(e){var t=Ut();return p.useLayoutEffect(()=>(t(CM(e)),()=>{t(jM(e))}),[e,t]),null}var B7=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=p.useRef(null),s=p.useRef(null),l=He(um),c=Vr(),d=Ut(),u="yAxis",f=He(_=>Is(_,u,t,c)),h=He(_=>m_(_,t)),m=He(_=>mR(_,t)),x=He(_=>g_(_,u,t,c)),g=He(_=>XN(_,t));if(p.useLayoutEffect(()=>{if(!(n!=="auto"||!h||Sp(a)||p.isValidElement(a)||g==null)){var _=i.current;if(_){var E=_.getCalculatedWidth();Math.round(h.width)!==Math.round(E)&&d(AM({id:t,width:E}))}}},[x,h,d,a,t,n,g]),h==null||m==null||g==null)return null;var{dangerouslySetInnerHTML:v,ticks:y}=e,b=Uc(e,D7),{id:w}=g,N=Uc(g,R7);return p.createElement(Up,gh({},b,N,{ref:i,labelRef:s,scale:f,x:m.x,y:m.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:h.width,height:h.height,className:ct("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:x}))},$7={allowDataOverflow:an.allowDataOverflow,allowDecimals:an.allowDecimals,allowDuplicatedCategory:an.allowDuplicatedCategory,hide:!1,mirror:an.mirror,orientation:an.orientation,padding:an.padding,reversed:an.reversed,scale:an.scale,tickCount:an.tickCount,type:an.type,width:an.width,yAxisId:0},U7=e=>{var t,r,n,a,i,s=br(e,$7);return p.createElement(p.Fragment,null,p.createElement(L7,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),p.createElement(B7,s))},H7=(e,t)=>{var{domain:r}=e,n=Uc(e,I7),{domain:a}=t,i=Uc(t,F7);return ws(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:ws({domain:r},{domain:a}):!1},zp=p.memo(U7,H7);zp.displayName="YAxis";var V0={exports:{}},G0={};var by;function W7(){if(by)return G0;by=1;var e=mu();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return G0.useSyncExternalStoreWithSelector=function(c,d,u,f,h){var m=a(null);if(m.current===null){var x={hasValue:!1,value:null};m.current=x}else x=m.current;m=s(function(){function v(_){if(!y){if(y=!0,b=_,_=f(_),h!==void 0&&x.hasValue){var E=x.value;if(h(E,_))return w=E}return w=_}if(E=w,r(b,_))return E;var S=f(_);return h!==void 0&&h(E,S)?(b=_,E):(b=_,w=S)}var y=!1,b,w,N=u===void 0?null:u;return[function(){return v(d())},N===null?void 0:function(){return v(N())}]},[d,u,f,h]);var g=n(c,m[0],m[1]);return i(function(){x.hasValue=!0,x.value=g},[g]),l(g),g},G0}var wy;function K7(){return wy||(wy=1,V0.exports=W7()),V0.exports}K7();function z7(e){e()}function V7(){let e=null,t=null;return{clear(){e=null,t=null},notify(){z7(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Ny={notify(){},get:()=>[]};function G7(e,t){let r,n=Ny,a=0,i=!1;function s(g){u();const v=n.subscribe(g);let y=!1;return()=>{y||(y=!0,v(),f())}}function l(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function d(){return i}function u(){a++,r||(r=e.subscribe(c),n=V7())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Ny)}function h(){i||(i=!0,u())}function m(){i&&(i=!1,f())}const x={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:h,tryUnsubscribe:m,getListeners:()=>n};return x}var Y7=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X7=Y7(),q7=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Z7=q7(),J7=()=>X7||Z7?p.useLayoutEffect:p.useEffect,Q7=J7(),e9=Symbol.for("react-redux-context"),t9=typeof globalThis<"u"?globalThis:{};function r9(){if(!p.createContext)return{};const e=t9[e9]??=new Map;let t=e.get(p.createContext);return t||(t=p.createContext(null),e.set(p.createContext,t)),t}var n9=r9();function a9(e){const{children:t,context:r,serverState:n,store:a}=e,i=p.useMemo(()=>{const c=G7(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=p.useMemo(()=>a.getState(),[a]);Q7(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const l=r||n9;return p.createElement(l.Provider,{value:i},t)}var i9=a9,s9=(e,t)=>t,Vp=ie([s9,at,zN,ir,R_,Fa,yI,nr],SI),Gp=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},FS=An("mouseClick"),MS=Yo();MS.startListening({actionCreator:FS,effect:(e,t)=>{var r=e.payload,n=Vp(t.getState(),Gp(r));n?.activeIndex!=null&&t.dispatch(CR({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var vh=An("mouseMove"),LS=Yo();LS.startListening({actionCreator:vh,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=hp(n,n.tooltip.settings.shared),i=Vp(n,Gp(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(E_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(S_()))}});var _y={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},BS=vn({name:"rootProps",initialState:_y,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:_y.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),o9=BS.reducer,{updateOptions:l9}=BS.actions,$S=vn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:c9}=$S.actions,u9=$S.reducer,US=An("keyDown"),HS=An("focus"),Yp=Yo();Yp.startListening({actionCreator:US,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(mp(a,Ms(r))),l=Fa(r);if(i==="Enter"){var c=Dc(r,"axis","hover",String(a.index));t.dispatch(lh({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var d=vR(r),u=d==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,h=s+f*u;if(!(l==null||h>=l.length||h<0)){var m=Dc(r,"axis","hover",String(h));t.dispatch(lh({active:!0,activeIndex:h.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});Yp.startListening({actionCreator:HS,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=Dc(r,"axis","hover",String(i));t.dispatch(lh({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var wn=An("externalEvent"),WS=Yo();WS.startListening({actionCreator:wn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:cI(r),activeDataKey:L_(r),activeIndex:qa(r),activeLabel:M_(r),activeTooltipIndex:qa(r),isTooltipActive:uI(r)};e.payload.handler(n,e.payload.reactEvent)}}});var d9=ie([Fs],e=>e.tooltipItemPayloads),f9=ie([d9,ol,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),KS=An("touchMove"),zS=Yo();zS.startListening({actionCreator:KS,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=hp(n,n.tooltip.settings.shared);if(a==="axis"){var i=Vp(n,Gp({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(E_({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,l=r.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(N2),u=(s=c.getAttribute(_2))!==null&&s!==void 0?s:void 0,f=f9(t.getState(),d,u);t.dispatch(__({activeDataKey:u,activeIndex:d,activeCoordinate:f}))}}});var h9=Vw({brush:Z8,cartesianAxis:kM,chartData:$I,errorBars:qM,graphicalItems:XF,layout:uk,legend:mP,options:II,polarAxis:cF,polarOptions:u9,referenceElements:aL,rootProps:o9,tooltip:jR}),m9=function(t){return I4({reducer:h9,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([MS.middleware,LS.middleware,Yp.middleware,WS.middleware,zS.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(a2({type:"raf"}))},devTools:ai.devToolsEnabled})};function VS(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Vr(),i=p.useRef(null);if(a)return r;i.current==null&&(i.current=m9(t));var s=am;return p.createElement(i9,{context:s,store:i.current},r)}function GS(e){var{layout:t,margin:r}=e,n=Ut(),a=Vr();return p.useEffect(()=>{a||(n(ok(t)),n(sk(r)))},[n,a,t,r]),null}function YS(e){var t=Ut();return p.useEffect(()=>{t(l9(e))},[t,e]),null}var p9=["children"];function x9(e,t){if(e==null)return{};var r,n,a=g9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function g9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Hc(){return Hc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hc.apply(null,arguments)}var v9={width:"100%",height:"100%",display:"block"},y9=p.forwardRef((e,t)=>{var r=j2(),n=A2(),a=D2();if(!gs(r)||!gs(n))return null;var{children:i,otherAttributes:s,title:l,desc:c}=e,d,u;return typeof s.tabIndex=="number"?d=s.tabIndex:d=a?0:void 0,typeof s.role=="string"?u=s.role:u=a?"application":void 0,p.createElement(uw,Hc({},s,{title:l,desc:c,role:u,tabIndex:d,width:r,height:n,style:v9,ref:t}),i)}),b9=e=>{var{children:t}=e,r=He(Au);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return p.createElement(uw,{width:n,height:a,x:s,y:i},t)},Sy=p.forwardRef((e,t)=>{var{children:r}=e,n=x9(e,p9),a=Vr();return a?p.createElement(b9,null,r):p.createElement(y9,Hc({ref:t},n),r)});function w9(){var e=Ut(),[t,r]=p.useState(null),n=He(Bk);return p.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Dr(i)&&i!==n&&e(ck(i))}},[t,e,n]),r}function Ey(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ey(Object(r),!0).forEach(function(n){_9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ey(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _9(e,t,r){return(t=S9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S9(e){var t=E9(e,"string");return typeof t=="symbol"?t:t+""}function E9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Di.apply(null,arguments)}var T9=()=>(XI(),null);function Wc(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var C9=p.forwardRef((e,t)=>{var r,n,a=p.useRef(null),[i,s]=p.useState({containerWidth:Wc((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Wc((n=e.style)===null||n===void 0?void 0:n.height)}),l=p.useCallback((d,u)=>{s(f=>{var h=Math.round(d),m=Math.round(u);return f.containerWidth===h&&f.containerHeight===m?f:{containerWidth:h,containerHeight:m}})},[]),c=p.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null){var{width:u,height:f}=d.getBoundingClientRect();l(u,f);var h=x=>{var{width:g,height:v}=x[0].contentRect;l(g,v)},m=new ResizeObserver(h);m.observe(d),a.current=m}},[t,l]);return p.useEffect(()=>()=>{var d=a.current;d?.disconnect()},[l]),p.createElement(p.Fragment,null,p.createElement(Ou,{width:i.containerWidth,height:i.containerHeight}),p.createElement("div",Di({ref:c},e)))}),j9=p.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=p.useState({containerWidth:Wc(r),containerHeight:Wc(n)}),s=p.useCallback((c,d)=>{i(u=>{var f=Math.round(c),h=Math.round(d);return u.containerWidth===f&&u.containerHeight===h?u:{containerWidth:f,containerHeight:h}})},[]),l=p.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:d,height:u}=c.getBoundingClientRect();s(d,u)}},[t,s]);return p.createElement(p.Fragment,null,p.createElement(Ou,{width:a.containerWidth,height:a.containerHeight}),p.createElement("div",Di({ref:l},e)))}),A9=p.forwardRef((e,t)=>{var{width:r,height:n}=e;return p.createElement(p.Fragment,null,p.createElement(Ou,{width:r,height:n}),p.createElement("div",Di({ref:t},e)))}),k9=p.forwardRef((e,t)=>{var{width:r,height:n}=e;return _a(r)||_a(n)?p.createElement(j9,Di({},e,{ref:t})):p.createElement(A9,Di({},e,{ref:t}))});function P9(e){return e===!0?C9:k9}var O9=p.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:f,onMouseUp:h,onTouchEnd:m,onTouchMove:x,onTouchStart:g,style:v,width:y,responsive:b,dispatchTouchEvents:w=!0}=e,N=p.useRef(null),_=Ut(),[E,S]=p.useState(null),[j,P]=p.useState(null),C=w9(),T=dm(),k=T?.width>0?T.width:y,W=T?.height>0?T.height:a,G=p.useCallback(D=>{C(D),typeof t=="function"&&t(D),S(D),P(D),D!=null&&(N.current=D)},[C,t,S,P]),K=p.useCallback(D=>{_(FS(D)),_(wn({handler:i,reactEvent:D}))},[_,i]),J=p.useCallback(D=>{_(vh(D)),_(wn({handler:d,reactEvent:D}))},[_,d]),V=p.useCallback(D=>{_(S_()),_(wn({handler:u,reactEvent:D}))},[_,u]),Z=p.useCallback(D=>{_(vh(D)),_(wn({handler:f,reactEvent:D}))},[_,f]),Q=p.useCallback(()=>{_(HS())},[_]),Y=p.useCallback(D=>{_(US(D.key))},[_]),le=p.useCallback(D=>{_(wn({handler:s,reactEvent:D}))},[_,s]),de=p.useCallback(D=>{_(wn({handler:l,reactEvent:D}))},[_,l]),pe=p.useCallback(D=>{_(wn({handler:c,reactEvent:D}))},[_,c]),_e=p.useCallback(D=>{_(wn({handler:h,reactEvent:D}))},[_,h]),q=p.useCallback(D=>{_(wn({handler:g,reactEvent:D}))},[_,g]),oe=p.useCallback(D=>{w&&_(KS(D)),_(wn({handler:x,reactEvent:D}))},[_,w,x]),ve=p.useCallback(D=>{_(wn({handler:m,reactEvent:D}))},[_,m]),O=P9(b);return p.createElement(K_.Provider,{value:E},p.createElement(Ej.Provider,{value:j},p.createElement(O,{width:k??v?.width,height:W??v?.height,className:ct("recharts-wrapper",n),style:N9({position:"relative",cursor:"default",width:k,height:W},v),onClick:K,onContextMenu:le,onDoubleClick:de,onFocus:Q,onKeyDown:Y,onMouseDown:pe,onMouseEnter:J,onMouseLeave:V,onMouseMove:Z,onMouseUp:_e,onTouchEnd:ve,onTouchMove:oe,onTouchStart:q,ref:G},p.createElement(T9,null),r)))}),D9=["width","height","responsive","children","className","style","compact","title","desc"];function R9(e,t){if(e==null)return{};var r,n,a=I9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function I9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var XS=p.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:l,compact:c,title:d,desc:u}=e,f=R9(e,D9),h=xn(f);return c?p.createElement(p.Fragment,null,p.createElement(Ou,{width:r,height:n}),p.createElement(Sy,{otherAttributes:h,title:d,desc:u},i)):p.createElement(O9,{className:s,style:l,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},p.createElement(Sy,{otherAttributes:h,title:d,desc:u,ref:t},p.createElement(sL,null,i)))});function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yh.apply(null,arguments)}var F9={top:5,right:5,bottom:5,left:5},M9={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:F9,reverseStackOrder:!1,syncMethod:"index",responsive:!1},qS=p.forwardRef(function(t,r){var n,a=br(t.categoricalChartProps,M9),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:d}=t,u={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return p.createElement(VS,{preloadedState:{options:u},reduxStoreName:(n=d.id)!==null&&n!==void 0?n:i},p.createElement(SS,{chartData:d.data}),p.createElement(GS,{layout:a.layout,margin:a.margin}),p.createElement(YS,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),p.createElement(XS,yh({},a,{ref:r})))}),L9=["axis"],B9=p.forwardRef((e,t)=>p.createElement(qS,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:L9,tooltipPayloadSearcher:Np,categoricalChartProps:e,ref:t})),$9=["axis","item"],U9=p.forwardRef((e,t)=>p.createElement(qS,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:$9,tooltipPayloadSearcher:Np,categoricalChartProps:e,ref:t}));function H9(e){var t=Ut();return p.useEffect(()=>{t(c9(e))},[t,e]),null}var W9=["layout"];function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh.apply(null,arguments)}function K9(e,t){if(e==null)return{};var r,n,a=z9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function z9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var V9={top:5,right:5,bottom:5,left:5},G9={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:V9,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},Y9=p.forwardRef(function(t,r){var n,a=br(t.categoricalChartProps,G9),{layout:i}=a,s=K9(a,W9),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return p.createElement(VS,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},p.createElement(SS,{chartData:a.data}),p.createElement(GS,{layout:i,margin:a.margin}),p.createElement(YS,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),p.createElement(H9,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),p.createElement(XS,bh({},s,{ref:r})))}),X9=["item"],q9={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Z9=p.forwardRef((e,t)=>{var r=br(e,q9);return p.createElement(Y9,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:X9,tooltipPayloadSearcher:Np,categoricalChartProps:r,ref:t})});const J9=({isOpen:e,onClose:t,onSuccess:r,currencyFormatter:n})=>{const[a,i]=p.useState(""),[s,l]=p.useState(""),[c,d]=p.useState(!1),[u,f]=p.useState(null),h=async v=>{if(v.preventDefault(),f(null),!a.trim()){f("Vui lòng nhập tên mục tiêu");return}const y=Number(s.replace(/[^0-9]/g,""));if(!y||y<=0){f("Số tiền mục tiêu phải lớn hơn 0");return}d(!0);try{const b=await fetch("/api/saving-goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goal_name:a.trim(),target_amount:y})});if(!b.ok){const w=await b.json();throw new Error(w.error||"Không thể tạo mục tiêu")}i(""),l(""),r(),t()}catch(b){f(b instanceof Error?b.message:"Lỗi không xác định")}finally{d(!1)}},m=v=>{const y=v.replace(/[^0-9]/g,"");l(y)},x=s?Number(s).toLocaleString("vi-VN"):"";if(!e)return null;const g=o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:o.jsxs("div",{className:"relative w-full max-w-md mx-4 rounded-3xl bg-gradient-to-br from-slate-900 to-slate-950 border border-white/10 p-6 shadow-2xl",children:[o.jsx("button",{onClick:t,className:"absolute right-4 top-4 rounded-full p-2 text-white/60 hover:bg-white/10 hover:text-white transition-colors",children:o.jsx(Dt,{className:"h-5 w-5"})}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Thêm Mục Tiêu Mới"}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"goalName",className:"block text-sm font-medium text-white/80 mb-2",children:"Tên mục tiêu"}),o.jsx("input",{id:"goalName",type:"text",value:a,onChange:v=>i(v.target.value),placeholder:"Ví dụ: Laptop mới, Du lịch...",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:c})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"targetAmount",className:"block text-sm font-medium text-white/80 mb-2",children:"Số tiền mục tiêu"}),o.jsx("input",{id:"targetAmount",type:"text",value:x,onChange:v=>m(v.target.value),placeholder:"0",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:c})]}),u&&o.jsx("div",{className:"rounded-lg bg-red-500/10 border border-red-500/20 px-4 py-3 text-sm text-red-400",children:u}),o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:t,className:"flex-1 rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-sm font-semibold text-white hover:bg-white/10 transition-colors",disabled:c,children:"Hủy"}),o.jsx("button",{type:"submit",className:"flex-1 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3 text-sm font-semibold text-white hover:from-indigo-500 hover:to-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?"Đang lưu...":"Thêm mục tiêu"})]})]})]})});return ZT.createPortal(g,document.body)},Dl=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],Q9=({budgets:e,walletColumns:t,walletRows:r,currencyFormatter:n,goldValue:a})=>{const i=r?.[0],s=p.useMemo(()=>{const d=a&&a>0?[{name:"Vàng (quy VND)",value:a,color:"#FBBF24"}]:[];if(i){const u=t.filter(f=>{const h=String(f.assetCode||"").trim().toUpperCase();return!(String(f.name||"").toLowerCase().includes("hana")||h&&h!=="VND")}).map((f,h)=>({name:f.name||f.field,value:Math.max(0,Number(i.values[f.field]||0)),color:Dl[h%Dl.length]})).filter(f=>f.value>0);if(u.length)return[...u,...d]}return[...e.map((u,f)=>({name:u.name,value:Math.max(0,u.used),color:Dl[f%Dl.length]})).filter(u=>u.value>0),...d]},[e,t,i,a]),l=p.useMemo(()=>s.reduce((d,u)=>d+u.value,0),[s]),c=({payload:d})=>{if(!d||d.length===0)return null;const u=d[0],f=Number(u?.value||0),h=l>0?Math.round(f/l*100):0;return o.jsxs("div",{className:"rounded-lg border border-white/10 bg-slate-900/90 px-3 py-2 text-xs text-white shadow-lg",children:[o.jsx("div",{className:"font-semibold",children:u?.name}),o.jsx("div",{children:n.format(f)}),o.jsxs("div",{className:"text-white/70",children:[h,"%"]})]})};return o.jsxs("div",{className:"relative h-72 w-full",children:[o.jsx("div",{className:"absolute inset-0 rounded-2xl border border-white/20 bg-gradient-to-br from-indigo-900 via-slate-900 to-slate-950 shadow-inner shadow-slate-900/50"}),o.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center text-white/70",children:s.length===0?o.jsx("div",{className:"text-sm",children:"Chưa có dữ liệu chi tiêu"}):o.jsxs(o.Fragment,{children:[o.jsx(fm,{width:"100%",height:"100%",children:o.jsxs(Z9,{children:[o.jsx(gS,{data:s,dataKey:"value",nameKey:"name",innerRadius:75,outerRadius:100,children:s.map((d,u)=>o.jsx(cl,{fill:d.color,stroke:"transparent"},`${d.name}-${u}`))}),o.jsx(_p,{content:c})]})}),l>0&&o.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:o.jsxs("div",{className:"text-center text-white",children:[o.jsx("div",{className:"text-xs uppercase tracking-wide text-white/60",children:"Tài sản"}),o.jsx("div",{className:"text-lg font-bold",children:n.format(l)})]})})]})})]})},Rl=({title:e,value:t,change:r,icon:n})=>{const a=r>=0,i=a?Wh:Hh;return o.jsxs("div",{className:"bg-gradient-to-br from-indigo-950/80 to-purple-950/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:border-white/20 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("div",{className:"p-2 bg-white/5 rounded-lg border border-white/10",children:o.jsx(n,{className:"h-5 w-5 text-indigo-400"})}),o.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold ${a?"bg-emerald-500/20 text-emerald-400":"bg-rose-500/20 text-rose-400"}`,children:[o.jsx(i,{className:"h-3 w-3"}),Math.abs(r),"%"]})]}),o.jsxs("div",{className:"space-y-0.5",children:[o.jsx("p",{className:"text-2xl font-bold text-white",children:t}),o.jsx("p",{className:"text-xs text-white/60",children:e})]})]})},eB=({budgets:e,savingGoals:t,currencyFormatter:r,walletColumns:n,walletRows:a,goldValue:i,onRefetchGoals:s})=>{const[l,c]=p.useState(!1),d=async(x,g)=>{const v=t.find(w=>w.id===x);if(!v)return;const y=g==="down"?(v.priority||0)+1:(v.priority||0)-1,b=t.find(w=>w.id!==x&&w.priority===y);try{const w=[];if(w.push(fetch(`/api/saving-goals/${v.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:y})})),b){const N=g==="down"?b.priority-1:b.priority+1;w.push(fetch(`/api/saving-goals/${b.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:N})}))}await Promise.all(w),s&&s()}catch(w){console.error("Error reordering goal:",w)}},u=async x=>{if(confirm("Bạn có chắc muốn xóa mục tiêu này?"))try{if(!(await fetch(`/api/saving-goals/${x}`,{method:"DELETE"})).ok)throw new Error("Failed to delete goal");s&&s()}catch(g){console.error("Error deleting goal:",g),alert("Không thể xóa mục tiêu. Vui lòng thử lại.")}},f=p.useMemo(()=>{const x=a?.[0];let g=0;if(x){const N=n.find(_=>{const E=String(_.name||"").toLowerCase();return E.includes("quỹ")||E.includes("quy")});N&&(g=Number(x.values[N.field]||0)||0)}const v=t.reduce((N,_)=>N+(Number(_.target_amount)||0),0),y=g,b=Math.max(0,v-y),w=v>0?y/v*100:0;return{totalSaved:y,totalTarget:v,totalRemaining:b,progress:Math.min(100,Math.max(0,w))}},[t,a,n]),h=p.useMemo(()=>{if(f.totalTarget<=0)return[];let x=0;return t.map((g,v)=>{x+=Number(g.target_amount)||0;const y=x/f.totalTarget*100,b=Math.min(100,Math.max(0,y));return{index:v+1,position:b}})},[t,f.totalTarget]),m=p.useMemo(()=>{const x=a?.[0];if(!x)return{cash:0,gold:i||0,investment:0,total:i||0};const g=n.find(_=>{const E=String(_.name||"").toLowerCase();return E.includes("quỹ")||E.includes("quy")}),y=n.filter(_=>{const E=String(_.assetCode||"").trim().toUpperCase();return String(_.name||"").toLowerCase().includes("hana")||g&&_.field===g.field?!1:!E||E==="VND"}).reduce((_,E)=>_+(Number(x.values[E.field]||0)||0),0),b=g&&Number(x.values[g.field]||0)||0,w=i||0,N=y+w+b;return{cash:y,gold:w,investment:b,total:N}},[a,n,i]);return o.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[o.jsxs("div",{className:"rounded-3xl bg-white/70 p-6 space-y-6 shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiêu hàng tháng"}),o.jsx("p",{className:"text-xs text-white/70",children:"Tổng quan tháng hiện tại"})]}),o.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-indigo-500/30 px-3 py-1 text-xs font-semibold text-white shadow-inner shadow-indigo-900/30",children:[o.jsx(Sx,{className:"h-4 w-4"}),o.jsx("span",{children:"Đang theo dõi"})]})]}),o.jsx(Q9,{budgets:e,walletColumns:n,walletRows:a,currencyFormatter:r,goldValue:i}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsx(Rl,{title:"Tiền Mặt",value:r.format(m.cash),change:8.5,icon:hC}),o.jsx(Rl,{title:"Vàng",value:r.format(m.gold),change:-2.3,icon:ej}),o.jsx(Rl,{title:"Đầu Tư",value:r.format(m.investment),change:15.7,icon:wo}),o.jsx(Rl,{title:"Tổng Tài Sản",value:r.format(m.total),change:5.2,icon:VC})]})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"space-y-4 rounded-3xl bg-white/70 p-5 shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Mục tiêu tiết kiệm"}),o.jsx("p",{className:"text-xs text-white/70",children:"Theo dõi tiến độ theo từng hàng mục"})]}),o.jsx(Sx,{className:"h-5 w-5 text-white/70"})]}),o.jsxs("div",{className:"rounded-2xl border border-white/30 bg-white/60 p-4 shadow-[0_16px_32px_-28px_rgba(0,0,0,0.4)]",children:[o.jsxs("div",{className:"flex items-start justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs uppercase tracking-wide text-white/70",children:"Tổng quan"}),o.jsx("p",{className:"text-2xl font-semibold text-white",children:r.format(f.totalSaved)}),o.jsxs("p",{className:"text-xs text-white/70",children:[r.format(f.totalTarget)," mục tiêu : ",t.length," hạng mục"]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-xs text-white/60",children:"Còn lại"}),o.jsx("p",{className:"text-sm font-semibold text-white",children:r.format(f.totalRemaining)})]})]}),o.jsxs("div",{className:"mt-3 relative h-6",children:[o.jsx("div",{className:"absolute inset-x-0 top-1/2 h-2 -translate-y-1/2 overflow-hidden rounded-full bg-white/20",children:o.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-amber-300 via-rose-300 to-emerald-200 shadow-[0_0_14px_rgba(251,191,36,0.55)]",style:{width:`${f.progress}%`}})}),h.map(x=>o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${x.position}%`},children:o.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border border-white/50 bg-slate-900/80 text-[10px] font-semibold text-white shadow-[0_8px_16px_-12px_rgba(0,0,0,0.55)]",children:x.index})},`milestone-${x.index}`))]}),o.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[o.jsxs("span",{children:[f.progress.toFixed(2),"%"]}),o.jsxs("span",{children:["Đã đạt ",r.format(f.totalSaved)]})]})]}),o.jsx("div",{className:"space-y-3",children:t.length===0?o.jsx("div",{className:"rounded-2xl border border-dashed border-white/40 bg-white/40 px-4 py-3 text-xs text-white/70",children:"Chưa có mục tiêu tiết kiệm nào."}):t.map((x,g)=>{const v=Number(x.target_amount)||0,y=f.totalSaved,b=v>0?Math.min(100,y/v*100):0,w=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],N=w[g%w.length];return o.jsxs("div",{className:"rounded-2xl border border-white/35 bg-white/60 p-3 shadow-[0_12px_28px_-26px_rgba(0,0,0,0.35)]",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-white/20 text-[11px] font-semibold text-white/80",children:g+1}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:x.goal_name}),o.jsxs("p",{className:"text-xs text-white/75",children:[r.format(y)," / ",r.format(v)]})]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>d(x.id,"up"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Tăng ưu tiên",children:o.jsx(wo,{className:"h-4 w-4"})}),o.jsx("button",{onClick:()=>d(x.id,"down"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Giảm ưu tiên",children:o.jsx(Hh,{className:"h-4 w-4"})}),o.jsx("div",{className:"h-4 w-px bg-white/20 mx-0.5"}),o.jsx("button",{onClick:()=>u(x.id),className:"rounded-lg p-1.5 text-white/60 hover:bg-red-400/80 hover:text-white transition-colors",title:"Xóa mục tiêu",children:o.jsx(Na,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"mt-3 h-2 overflow-hidden rounded-full bg-white/20",children:o.jsx("div",{className:"h-full rounded-full",style:{width:`${b}%`,background:`linear-gradient(90deg, ${N}, rgba(255,255,255,0.85))`}})}),o.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[o.jsxs("span",{children:[b.toFixed(2),"%"]}),o.jsxs("span",{children:["Đã đạt ",r.format(y)]})]})]},x.id)})}),o.jsx("button",{type:"button",onClick:()=>c(!0),className:"w-full rounded-xl border border-white/30 bg-slate-900/80 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-24px_rgba(0,0,0,0.45)] transition-colors hover:bg-slate-900",children:"Thêm mục tiêu mới"})]})}),o.jsx(J9,{isOpen:l,onClose:()=>c(!1),onSuccess:()=>{s&&s()},currencyFormatter:r})]})},ln={UNPAID:"Chưa Thanh Toán",PROCESSING:"Đang Xử Lý",PAID:"Đã Thanh Toán",REFUNDED:"Đã Hoàn",PENDING_REFUND:"Chờ Hoàn",EXPIRED:"Hết Hạn",RENEWAL:"Cần Gia Hạn"},Ft={idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status"},Yi={orderCode:"id_order",paidDate:"payment_date",amount:"amount",receiver:"receiver",note:"note",sender:"sender"},Y0={id:"id",sourceName:"supplier_name"},X0={sourceId:"supplier_id",price:"price"},Wt={code:"id_product",packageName:"package",variantName:"package_product",pctCtv:"pct_ctv",pctKhach:"pct_khach",pctPromo:"pct_promo",isActive:"is_active",updatedAt:"update"},ZS=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},ja=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),a=String(r.getUTCMonth()+1).padStart(2,"0"),i=r.getUTCFullYear();return`${n}/${a}/${i}`},JS=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,a,i]=e.split("/").map(Number),s=new Date(i,a-1,n);return s.setMonth(s.getMonth()+t),s.setDate(s.getDate()-1),`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()}`},tB=(e,t)=>{const[r,n,a]=e.split("/").map(Number),[i,s,l]=t.split("/").map(Number),c=new Date(a,n-1,r),d=new Date(l,s-1,i),u=1440*60*1e3;return Math.floor((d.getTime()-c.getTime())/u)+1},Ty=e=>String(e).padStart(2,"0"),Xp=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[a,i,s]=t.split("/").map(Number);return!a||!i||!s?null:new Date(s,i-1,a)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r.map(Number);return!s||!i||!a?null:new Date(a,i-1,s)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},Ot=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r;return`${s}/${i}/${a}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,a,i,s]=n;return`${s}/${i}/${a}`}}const t=Xp(e);return t?`${Ty(t.getDate())}/${Ty(t.getMonth()+1)}/${t.getFullYear()}`:""},rB=e=>{const t=Xp(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},QS=e=>{const t=Xp(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},Kc=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},nB=e=>{if(!Number.isFinite(e)||e<=0)return 0;const t=Math.floor(e/12),r=e%12;return t*365+r*30},eE=e=>{const t=Number(e);return Number.isFinite(t)?t:0},Ln=e=>{const t=eE(e),r=1e3;return Number.isFinite(t)?Math.round(t/r)*r:0},Mn=e=>`${Ln(e).toLocaleString("vi-VN")} ₫`,Cy=e=>{const t=eE(e);return t>0?t.toLocaleString("vi-VN"):""},aB=e=>!Number.isFinite(e)||e<=0?"₫0":e>=1e9?`₫${(e/1e9).toFixed(1)}B`:e>=1e6?`₫${(e/1e6).toFixed(1)}M`:e>=1e3?`₫${(e/1e3).toFixed(1)}K`:`₫${Math.round(e).toLocaleString("vi-VN")}`,iB=(e,t,r=[])=>{const n=e||"";if(!n)return;const a=r.find(l=>(l[Y0.sourceName]||l.name||"")===n)?.[Y0.id]??null;if(a!==null){const c=t.find(d=>d[X0.sourceId]===a)?.[X0.price];if(Number.isFinite(c))return Number(c)}const s=t.find(l=>(l[Y0.sourceName]||"")===n)?.[X0.price];return Number.isFinite(s)?Number(s):void 0},jy=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),tE=e=>rE(e).color,Ay=e=>rE(e).priority,sB={[ln.EXPIRED]:{color:"bg-red-600 text-white",priority:1},[ln.RENEWAL]:{color:"bg-orange-500 text-white",priority:2},[ln.UNPAID]:{color:"bg-yellow-500 text-slate-900",priority:3},[ln.PROCESSING]:{color:"bg-sky-500 text-white",priority:4},[ln.PAID]:{color:"bg-green-600 text-white",priority:5},[ln.PENDING_REFUND]:{color:"bg-rose-500 text-white",priority:6},[ln.REFUNDED]:{color:"bg-slate-600 text-white",priority:7}},rE=e=>sB[e?.trim()]||{color:"bg-slate-600 text-white",priority:5},qp=({accountNumber:e,bankCode:t,amount:r,description:n})=>{const a=(e||"").trim(),i=(t||"").trim();if(!a||!i)return"";const s=new URLSearchParams;s.set("acc",a),s.set("bank",i);const l=Number(r);Number.isFinite(l)&&l>0&&s.set("amount",Math.round(l).toString());const c=(n||"").trim();return c&&s.set("des",c),`https://qr.sepay.vn/img?${s.toString()}`},nE=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},oB=({labels:e,totalWallet5:t,currencyFormatter:r,adding:n,onToggleAdd:a})=>o.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),t!==null&&o.jsxs("p",{className:"text-xs text-white/70",children:[e.totalWallet5Label," ",r.format(t)]})]}),o.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20",children:[n?o.jsx(Dt,{className:"h-4 w-4"}):o.jsx(ta,{className:"h-4 w-4"}),n?e.closeLabel:e.addLabel]})]}),lB=({displayColumns:e,rows:t,adding:r,newDate:n,newValues:a,loading:i,onDateChange:s,onValueChange:l,onSave:c,onCancel:d,formatDate:u,formatValue:f,resolveValue:h,labels:m})=>o.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:o.jsxs("table",{className:"min-w-full text-sm text-white",children:[o.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-3 py-2 text-center",children:m.dateHeader}),e.map(x=>o.jsx("th",{className:"px-3 py-2 text-center",children:x.name||x.field},x.field))]})}),o.jsxs("tbody",{className:"divide-y divide-white/10",children:[r&&o.jsxs(o.Fragment,{children:[o.jsxs("tr",{className:"bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("input",{type:"date",className:"w-full rounded-md border border-white/20 bg-white/80 px-2 py-1 text-xs text-slate-900 focus:ring-2 focus:ring-indigo-400",value:n,onChange:x=>s(x.target.value)})}),e.map(x=>x.sourceFields&&x.sourceFields.length?o.jsx("td",{className:"px-3 py-2 text-center whitespace-pre-line",children:o.jsx("div",{className:"flex flex-col gap-1",children:x.sourceFields.map(g=>o.jsx("input",{className:"w-full rounded-md border border-white/20 bg-white/80 px-2 py-1 text-xs text-slate-900 text-center focus:ring-2 focus:ring-indigo-400",placeholder:g,value:a[g]||"",onChange:v=>l(g,v.target.value)},g))})},x.field):o.jsx("td",{className:"px-3 py-2 text-center",children:o.jsx("input",{className:"w-full rounded-md border border-white/20 bg-white/80 px-2 py-1 text-xs text-slate-900 text-center focus:ring-2 focus:ring-indigo-400",placeholder:"0",value:a[x.field]||"",onChange:g=>l(x.field,g.target.value)})},x.field))]}),o.jsx("tr",{className:"bg-white/5",children:o.jsx("td",{className:"px-3 py-2 text-center",colSpan:e.length+1,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"rounded-md bg-emerald-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-emerald-600",onClick:c,children:m.saveLabel}),o.jsx("button",{type:"button",className:"rounded-md bg-rose-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-rose-600",onClick:d,children:m.cancelLabel})]})})})]}),i&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:m.loadingText})}),!i&&t.length===0&&o.jsx("tr",{children:o.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:m.emptyText})}),!i&&t.map((x,g)=>o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-3 py-2 text-center font-semibold",children:u(x.recordDate)}),e.map(v=>{const y=h(x,v);if(Array.isArray(y)){const b=y.map(N=>N.value?f(N.value,N.assetCode||v.assetCode):null).filter(Boolean),w=b.length?b.join(`
`):"-";return o.jsx("td",{className:"px-3 py-2 text-center text-white/90 whitespace-pre-line",children:w},v.field)}return o.jsx("td",{className:"px-3 py-2 text-center text-white/90",children:f(y,v.assetCode)},v.field)})]},`${x.recordDate}-${g}`))]})]})}),cB=e=>Ot(new Date(e))||e,uB=e=>{const t=i=>(i||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),r=e.filter(i=>{const s=t(i.name||i.field||"");return s.includes("hana")||s.includes("gold")||s.includes("vang")}),n=e.filter(i=>!r.includes(i));if(!r.length)return e;const a=Array.from(new Set(r.map(i=>(i.assetCode||"").toUpperCase()).filter(Boolean)));return[...n,{id:0,field:"wallet_gold_combined",name:"HanaGold / Vang",assetCode:a.length===1?a[0]:void 0,sourceFields:r.map(i=>i.field)}]},dB=e=>{const t={};return e.forEach(r=>{t[r.field]=r.assetCode}),t},fB=e=>{const[t,r]=String(e).split("."),n=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r?`${n}.${r}`:n},hB=(e,t,r)=>e?(t||"").toUpperCase()==="VND"?r.format(e):fB(e):"-",mB=(e,t,r)=>t.sourceFields&&t.sourceFields.length?t.sourceFields.map(n=>({field:n,value:Number(e.values[n]||0)||0,assetCode:r[n]})):Number(e.values[t.field]||0),pB={title:"Dòng tiền theo ngày",totalWallet5Label:"Tổng ID 5:",addLabel:"Thêm",closeLabel:"Đóng"},xB={dateHeader:"Ngày",saveLabel:"Lưu",cancelLabel:"Hủy",loadingText:"Đang tải dữ liệu...",emptyText:"Chưa có dữ liệu dòng tiền."},gB=({columns:e,rows:t,loading:r,error:n,onRefresh:a,currencyFormatter:i,goldPrice:s})=>{const l=p.useMemo(()=>uB(e),[e]),c=p.useMemo(()=>dB(e),[e]),[d,u]=p.useState(!1),[f,h]=p.useState(""),[m,x]=p.useState({}),g=p.useMemo(()=>e.find(C=>C.id===5)?.field||null,[e]),v=p.useMemo(()=>g?t.reduce((C,T)=>C+(Number(T.values[g]||0)||0),0):null,[t,g]),y=p.useMemo(()=>{const C=e.find(k=>k.id===7);if(C)return C.field;const T=e.find(k=>(k.assetCode||"").toUpperCase()!=="VND");return T?T.field:null},[e]),b=p.useMemo(()=>!t.length||!y?0:t.reduce((C,T)=>C+(Number(T.values[y]||0)||0),0),[t,y]),w=p.useMemo(()=>s?s/10:null,[s]);p.useMemo(()=>!w||!b?null:b*w,[w,b]);const N=p.useCallback((C,T)=>hB(C,T,i),[i]),_=p.useCallback((C,T)=>mB(C,T,c),[c]),E=p.useCallback((C,T)=>{x(k=>({...k,[C]:T}))},[]),S=p.useCallback(()=>{u(!1),h(""),x({})},[]),j=async()=>{const C=f||Ot(new Date)||"";if(!C)return;const T={};e.forEach(k=>{const G=(m[k.field]||"").replace(/[^\d.-]/g,""),K=Number(G||0);G&&(T[k.field]=Number.isFinite(K)?K:0)});try{await Ze("/api/wallets/daily-balances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordDate:C,values:T})}),S(),a()}catch(k){console.error("Failed to save wallet balances:",k)}},P=p.useCallback(()=>{const C=new Date,T=C.getFullYear(),k=String(C.getMonth()+1).padStart(2,"0"),W=String(C.getDate()).padStart(2,"0");h(`${T}-${k}-${W}`),u(G=>!G)},[]);return o.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/60 to-slate-900/65 p-5 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.7)]",children:[o.jsx(oB,{labels:pB,totalWallet5:v,currencyFormatter:i,adding:d,onToggleAdd:P}),n&&o.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/50 bg-amber-50/10 px-3 py-2 text-xs text-amber-200",children:n}),o.jsx(lB,{displayColumns:l,rows:t,adding:d,newDate:f,newValues:m,loading:r,onDateChange:h,onValueChange:E,onSave:j,onCancel:S,formatDate:cB,formatValue:N,resolveValue:_,labels:xB})]})},vB=({financeSummary:e,budgets:t,savingGoals:r,currencyFormatter:n,goldRows:a,goldLoading:i,goldError:s,onRefreshGold:l,latestGoldBid:c,walletColumns:d,walletRows:u,walletLoading:f,walletError:h,onRefreshWallets:m,onRefetchGoals:x})=>{const g=d.find(C=>C.id===7)?.field||d.find(C=>(C.assetCode||"").toUpperCase()!=="VND")?.field||null,v=p.useMemo(()=>{const C=d.find(k=>k.id===5);if(C)return C.field;const T=d.find(k=>(k.name||"").toLowerCase().includes("hana"));return T?T.field:null},[d]),y=g?u.reduce((C,T)=>C+(Number(T.values[g]||0)||0),0):0,b=v&&u.length?u.reduce((C,T)=>C+(Number(T.values[v]||0)||0),0):null,w=c?c/10:null,N=a.length&&Number(a[0]?.ask||0)||null,_=N?N/10:null,E=_?y*_:null,S=b!==null?b:w?y*w:null,j=E!==null&&S!==null?E-S:E??null,P=a.map((C,T)=>T===0?{...C,totalGoldAmount:y,totalGoldValue:S??void 0,profit:j??void 0}:C);return o.jsxs("div",{className:"space-y-6 rounded-[32px] bg-white/5 border border-white/10 p-6 shadow-[0_24px_60px_-34px_rgba(0,0,0,0.7)] backdrop-blur",children:[o.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:e.map(C=>o.jsx(mj,{...C},C.title))}),o.jsx(pj,{loading:i,error:s,rows:P,onRefresh:l}),o.jsx(eB,{budgets:t,savingGoals:r,currencyFormatter:n,walletColumns:d,walletRows:u,goldValue:E,onRefetchGoals:x}),o.jsx(gB,{columns:d,rows:u,loading:f,error:h,onRefresh:m,currencyFormatter:n,goldPrice:c})]})},xr={sky:{border:"border-sky-100/80",glow:"from-sky-100/70 via-white/80 to-blue-100/70",iconBg:"bg-sky-500/90 text-white"},emerald:{border:"border-emerald-100/80",glow:"from-emerald-100/70 via-white/80 to-lime-100/70",iconBg:"bg-emerald-500/90 text-white"},violet:{border:"border-violet-100/80",glow:"from-violet-100/70 via-white/80 to-fuchsia-100/70",iconBg:"bg-violet-500/90 text-white"},amber:{border:"border-amber-100/80",glow:"from-amber-100/70 via-white/80 to-orange-100/70",iconBg:"bg-amber-500/90 text-white"},rose:{border:"border-rose-100/80",glow:"from-rose-100/70 via-white/80 to-pink-100/70",iconBg:"bg-rose-500/90 text-white"},indigo:{border:"border-indigo-100/80",glow:"from-indigo-100/70 via-white/80 to-purple-100/70",iconBg:"bg-indigo-500/90 text-white"},slate:{border:"border-slate-200/80",glow:"from-slate-100/70 via-white/80 to-slate-200/70",iconBg:"bg-slate-600/90 text-white"},teal:{border:"border-teal-100/80",glow:"from-teal-100/70 via-white/80 to-cyan-100/70",iconBg:"bg-teal-500/90 text-white"}},pa=({title:e,value:t,icon:r,accent:n,subtitle:a,children:i,iconClassName:s="h-6 w-6"})=>o.jsxs("div",{className:"relative isolate overflow-hidden rounded-3xl border border-white/25 bg-gradient-to-br from-slate-200/70 via-indigo-200/60 to-slate-300/70 p-6 shadow-[0_18px_48px_-28px_rgba(0,0,0,0.6),0_12px_30px_-24px_rgba(255,255,255,0.22)] backdrop-blur transition-all hover:shadow-[0_22px_60px_-28px_rgba(0,0,0,0.65),0_16px_36px_-24px_rgba(255,255,255,0.24)]",children:[o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:e}),o.jsx("p",{className:"mt-2 text-2xl font-semibold text-white",children:t}),a&&o.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-wide text-white/80",children:a})]}),o.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20 border border-white/35 shadow-inner shadow-black/15 text-slate-800",children:o.jsx(r,{className:s})})]}),i&&o.jsx("div",{className:"mt-4",children:i})]}),yB=({stats:e})=>o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:e.map((t,r)=>o.jsx(pa,{title:t.name,value:t.value,icon:t.icon,accent:xr[t.accent],children:o.jsx("div",{className:`flex items-center text-sm font-semibold ${t.changeType==="increase"?"text-emerald-200":t.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:t.changeType==="alert"?o.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):t.changeType==="increase"?o.jsxs(o.Fragment,{children:[o.jsx(wo,{className:"mr-1 h-4 w-4"}),t.change]}):o.jsxs(o.Fragment,{children:[o.jsx(Uh,{className:"mr-1 h-4 w-4"}),t.change]})})},`${t.name}-${r}`))})}),bB=({data:e,availableYears:t,selectedYear:r,onYearChange:n})=>{const a=Mn;return o.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[o.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Doanh thu theo tháng"}),o.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-white/80 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:r,onChange:i=>n(Number(i.target.value)),children:t.length===0?o.jsx("option",{value:r,children:r}):t.map(i=>o.jsx("option",{value:i,children:i},i))})]}),o.jsx("div",{className:"w-full",children:o.jsx(fm,{width:"100%",height:320,children:o.jsxs(B9,{data:e,children:[o.jsx(Hp,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),o.jsx(Kp,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(zp,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:i=>`${Math.round(i/1e6)}M`}),o.jsx(_p,{formatter:i=>[a(i),"Doanh thu"],labelStyle:{color:"#111827"}}),o.jsx(IS,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]})},wB=({data:e})=>o.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[o.jsx("h3",{className:"mb-6 text-lg font-semibold text-white",children:"Tổng đơn và đơn hủy theo tháng"}),o.jsx("div",{className:"w-full",children:o.jsx(fm,{width:"100%",height:320,children:o.jsxs(U9,{data:e,children:[o.jsx(Hp,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),o.jsx(Kp,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(zp,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),o.jsx(_p,{formatter:(t,r,n)=>[t,n?.dataKey==="total_orders"?"Tổng đơn":"Đơn hủy"],labelStyle:{color:"#111827"}}),o.jsx(mh,{dataKey:"total_orders",name:"Tổng đơn",fill:"#3b82f6",radius:[4,4,0,0]}),o.jsx(mh,{dataKey:"total_canceled",name:"Đơn hủy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]}),NB=({stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i})=>o.jsxs(o.Fragment,{children:[o.jsx(yB,{stats:e}),o.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[o.jsx(bB,{data:t,availableYears:n,selectedYear:a,onYearChange:i}),o.jsx(wB,{data:r})]})]}),_B=[{key:"overview",label:"Tổng quan"},{key:"finance",label:"Chi tiêu & Ngân sách"}],SB=({activeSection:e,onChange:t})=>o.jsx("div",{className:"w-full grid grid-cols-2 gap-3 rounded-2xl border border-white/15 bg-white/5 p-3 shadow-[0_16px_45px_-28px_rgba(0,0,0,0.55)]",children:_B.map(r=>{const n=e===r.key;return o.jsx("button",{onClick:()=>t(r.key),className:`w-full rounded-full px-4 py-3 text-sm font-semibold transition shadow-sm ${n?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-[0_10px_30px_-18px_rgba(59,130,246,0.8)]":"bg-white/10 text-white/80 hover:bg-white/20"}`,children:r.label},r.key)})}),EB=()=>o.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white sm:p-8",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Bảng Điều Khiển"}),o.jsx("p",{className:"text-sm text-blue-100",children:"Tổng quan hoạt động kinh doanh của bạn"})]}),TB=[],CB=[{name:"Nha cua & Tien ich",used:315e4,total:45e5},{name:"Thuc pham & Thiet yeu",used:226e4,total:45e5},{name:"Cham soc ca nhan",used:189e4,total:45e5},{name:"Phu kien",used:152e4,total:45e5}],jB=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),AB=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",Wr=(e,t={})=>{const{fallback:r="Đã xảy ra lỗi. Vui lòng thử lại sau.",blockPatterns:n}=t,a=AB(e);return!a||Array.isArray(n)&&n.some(i=>i.test(a))?r:a},kB=Mn,aE=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",iE=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,q0=(e,t,r,n)=>{const a=Number.isFinite(Number(t))?Number(t):0,i=Number.isFinite(Number(r))?Number(r):0,s=n?kB(a):a.toLocaleString("vi-VN"),l=iE(a,i);return{name:e,value:s,change:aE(l),changeType:l>=0?"increase":"decrease",accent:"sky"}},PB=e=>[{...q0("Tổng đơn hàng",e.totalOrders.current,e.totalOrders.previous,!1),icon:Gh,accent:"sky"},{name:"Đơn sắp hết hạn",value:e.overdueOrders.count.toLocaleString("vi-VN"),change:"Cần xử lý",changeType:"alert",icon:ew,accent:"rose"},{...q0("Tổng nhập hàng",e.totalImports.current,e.totalImports.previous,!0),icon:$h,accent:"amber"},{...q0("Tổng lợi nhuận",e.totalProfit.current,e.totalProfit.previous,!0),icon:tw,accent:"emerald"}],OB=()=>{const e=p.useMemo(()=>new Date().getFullYear(),[]),t=p.useMemo(()=>new Date().getMonth()+1,[]),[r,n]=p.useState([]),[a,i]=p.useState([]),[s,l]=p.useState([]),[c,d]=p.useState([]),[u,f]=p.useState(e),[h,m]=p.useState(!0),[x,g]=p.useState(null),v=p.useCallback(async y=>{m(!0),g(null);try{const b=await Ze("/api/dashboard/stats");if(!b.ok){const S=await b.text();throw new Error(Wr(S,{fallback:"Không thể tải thống kê tổng quan."}))}const w=await b.json();n(PB(w));const N=await oj(y);i(N.revenueData),l(N.orderStatusData);const _=y===e?t:12,E=N.orderStatusData.filter((S,j)=>j<_&&Number.isFinite(Number(S.total_orders)));if(E.length>=2){const S=Number(E[E.length-1].total_orders)||0,j=Number(E[E.length-2].total_orders)||0,P=iE(S,j);n(C=>C.map((T,k)=>k===0?{...T,change:aE(P),changeType:P>=0?"increase":"decrease"}:T))}}catch(b){console.error("Lỗi khi lấy dữ liệu dashboard:",b),g(b instanceof Error?Wr(b.message,{fallback:"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau."}):"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau.")}finally{m(!1)}},[]);return p.useEffect(()=>{let y=!1;return(async()=>{try{const w=await lj(),N=w.length?w:[e];y||(d(N),f(_=>N.includes(_)?_:N[0]??e))}catch(w){console.error("Failed to load available years:",w),y||(g(w instanceof Error?Wr(w.message,{fallback:"Không thể tải năm dữ liệu dashboard."}):"Không thể tải năm dữ liệu dashboard."),m(!1))}})(),()=>{y=!0}},[e]),p.useEffect(()=>{v(u)},[u,v]),{statsData:r,revenueChartData:a,orderChartData:s,availableYears:c,selectedYear:u,setSelectedYear:f,loading:h,errorMessage:x}},DB=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),s=p.useCallback(async()=>{n(!0),i(null);try{const d=await fetch("https://api.hanagold.vn/app/setting/get-chart-gold");if(!d.ok)throw new Error(`HTTP ${d.status}`);const u=await d.json();if(!u||u.signal!==1||!Array.isArray(u.data))throw new Error("Dữ liệu không hợp lệ");const f=[];u.data.forEach(h=>{const m=h?.time??"";(Array.isArray(h?.data)?h.data:[]).forEach(g=>{(Array.isArray(g?.main_gold_price)?g.main_gold_price:[]).forEach(y=>{const b=Number(y?.ask??NaN),w=Number(y?.bid??NaN);if(!Number.isFinite(b)||!Number.isFinite(w))return;const N=b*1e6,_=w*1e6;f.push({time:m,group:g?.name??"",displayName:y?.display_name??y?.name??"",ask:N,bid:_,trendAsk:y?.trend?.ask,trendBid:y?.trend?.bid})})})}),t(f)}catch(c){console.error("Lỗi khi lấy giá vàng HanaGold:",c),i(c instanceof Error?c.message:"Không thể lấy dữ liệu giá vàng.")}finally{n(!1)}},[]),l=p.useMemo(()=>{if(!e.length)return[];const c=e.filter(u=>{const f=`${u.displayName||""}`.toLowerCase(),h=`${u.group||""}`.toLowerCase();return f.includes("kim kh")||f.includes("kht")||h.includes("kim kh")});if(!c.length)return[];const d=c[c.length-1]?.time||"";return c.filter(u=>u.time===d)},[e]);return{goldPrices:e,goldLoading:r,goldError:a,fetchGoldPrices:s,selectedGoldRows:l}},RB=()=>{const[e,t]=p.useState([]),[r,n]=p.useState([]),[a,i]=p.useState(!1),[s,l]=p.useState(null),c=p.useCallback(async()=>{i(!0),l(null);try{const u=await Ze("/api/wallets/daily-balances");if(!u.ok)throw new Error(`HTTP ${u.status}`);const f=await u.json();t(Array.isArray(f?.wallets)?f.wallets:[]),n(Array.isArray(f?.rows)?f.rows:[])}catch(u){console.error("Failed to fetch wallet balances:",u),l("Không thể tải dữ liệu dòng tiền từ cơ sở dữ liệu.")}finally{i(!1)}},[]);return p.useEffect(()=>{c()},[c]),{walletColumns:p.useMemo(()=>[...e].sort((u,f)=>u.id-f.id),[e]),walletRows:r,walletLoading:a,walletError:s,fetchWalletBalances:c}},IB=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(0),[a,i]=p.useState(!0),[s,l]=p.useState(null),c=p.useCallback(async()=>{try{i(!0),l(null);const d=await Ze("/api/saving-goals");if(!d.ok)throw new Error("Không thể tải danh sách mục tiêu");const u=await d.json();t(u.goals||[]),n(u.totalTarget||0)}catch(d){console.error("Error fetching saving goals:",d),l(d instanceof Error?d.message:"Lỗi không xác định"),t([]),n(0)}finally{i(!1)}},[]);return p.useEffect(()=>{c()},[c]),{goals:e,totalTarget:r,loading:a,error:s,refetch:c}},FB=()=>{const{statsData:e,revenueChartData:t,orderChartData:r,availableYears:n,selectedYear:a,setSelectedYear:i,loading:s,errorMessage:l}=OB(),{goldLoading:c,goldError:d,selectedGoldRows:u,fetchGoldPrices:f}=DB(),{walletColumns:h,walletRows:m,walletLoading:x,walletError:g,fetchWalletBalances:v}=RB(),{goals:y,refetch:b}=IB(),[w,N]=p.useState("overview"),_=u.length&&Number(u[0]?.bid||0)||null;return p.useEffect(()=>{f()},[f]),s?o.jsx("div",{className:"py-10 text-center",children:o.jsx("p",{className:"text-lg font-medium text-white/80",children:"Đang tải dữ liệu dashboard..."})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx(EB,{}),o.jsx(SB,{activeSection:w,onChange:N}),l&&o.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:l}),w==="overview"&&o.jsx(NB,{stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i}),w==="finance"&&o.jsx(vB,{financeSummary:TB,budgets:CB,savingGoals:y,currencyFormatter:jB,goldRows:u,goldLoading:c,goldError:d,onRefreshGold:f,latestGoldBid:_,walletColumns:h,walletRows:m,walletLoading:x,walletError:g,onRefreshWallets:v,onRefetchGoals:b})]})},MB={ID_ORDER:Ft.idOrder,ID_PRODUCT:Ft.idProduct,INFORMATION_ORDER:Ft.informationOrder,CUSTOMER:Ft.customer,CONTACT:Ft.contact,SLOT:Ft.slot,ORDER_DATE:Ft.orderDate,DAYS:Ft.days,ORDER_EXPIRED:Ft.orderExpired,SUPPLY:Ft.supply,COST:Ft.cost,PRICE:Ft.price,NOTE:Ft.note,STATUS:Ft.status,REFUND:Ft.refund},rt={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},U=MB,ft={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},Kt={COLLABORATOR:"MAVC",RETAIL:"MAVL",PROMO:"MAVK",GIFT:"MAVT",IMPORT:"MAVN"},sE=Kt.COLLABORATOR,LB=[{value:Kt.COLLABORATOR,label:"Cộng Tác Viên"},{value:Kt.RETAIL,label:"Khách Lẻ"},{value:Kt.PROMO,label:"Khuyến Mãi"},{value:Kt.GIFT,label:"Quà Tặng"},{value:Kt.IMPORT,label:"Nhập Hàng"}],tr={ORDER_EXPIRED:ln.EXPIRED,CAN_GIA_HAN:ln.RENEWAL,CHUA_THANH_TOAN:ln.UNPAID,DANG_XU_LY:ln.PROCESSING,DA_THANH_TOAN:ln.PAID,CHO_HOAN:ln.PENDING_REFUND},oE={active:{label:"Đơn Hàng",description:"Danh sách đơn đang hoạt động",endpoint:rt.ORDERS},expired:{label:"Hết Hạn",description:"Danh sách các đơn hàng đã hết hạn",endpoint:rt.ORDERS_EXPIRED},canceled:{label:"Hoàn Tiền",description:"Đơn đã hủy/hoàn tiền",endpoint:rt.ORDERS_CANCELED}},BB=["active","expired","canceled"],$B="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",UB="opacity-60 cursor-not-allowed shadow-none pointer-events-none",Qn=ea.forwardRef(({icon:e,className:t="",disabled:r,children:n,...a},i)=>o.jsxs("button",{ref:i,className:`${$B} ${r?UB:"hover:-translate-y-0.5"} ${t}`,disabled:r,...a,children:[e&&o.jsx(e,{className:"h-4 w-4"}),o.jsx("span",{className:"font-semibold",children:n})]}));Qn.displayName="GradientButton";const lE=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,secondaryMessage:i,confirmLabel:s="OK",cancelLabel:l="Hủy",isSubmitting:c=!1})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:o.jsxs("div",{className:"w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[o.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-2",children:n}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm text-white/90",children:a}),i?o.jsx("p",{className:"mt-2 text-sm font-semibold text-rose-300",children:i}):null]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:t,disabled:c,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:l}),o.jsx("button",{type:"button",onClick:r,disabled:c,className:"px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang Xử Lý...":s})]})]})}):null,HB="VPB",ky="9183400998",WB="NGO LE NGOC HUNG",KB=({isOpen:e,orderId:t,productName:r,customerType:n,basePrice:a,normalizedOrderDate:i})=>{const[s,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(null);return p.useEffect(()=>{if(!e||!t||!r){l(null),d(!1),f(null);return}let h=!1;l(a);const m={san_pham_name:r,id_product:r,id_order:t};return i&&(m.order_date=i),n&&(m.customer_type=n),(async()=>{try{d(!0),f(null);const g=await Ze(rt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}),{data:v,rawText:y}=await nE(g);if(!g.ok){const w=v?.error||y||`Server responded with ${g.status}`;throw new Error(w)}const b=v??{};if(!h){const w=Number(b.price??b.gia_ban);l(Number.isFinite(w)&&w>=0?w:a)}}catch(g){console.error("Lỗi khi tính lại giá đơn hàng:",g),h||(f("Không thể tính lại giá đơn hàng. Đang hiển thị giá hiện có."),l(a))}finally{h||d(!1)}})(),()=>{h=!0}},[a,n,e,i,t,r]),{calculatedPrice:s,priceLoading:c,priceError:u}},Py=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,Oy=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},zB=({isOpen:e,onClose:t,order:r,formatCurrency:n})=>{const a=r?.[U.ID_ORDER],i=r?.[U.ID_PRODUCT],s=Number(r?.[U.PRICE])||0,l=r?.[U.SUPPLY]||"",c=r?.customer_type||l||"",d=r?.registration_date||r?.[U.ORDER_DATE]||"",u=ZS(Ot(d)||d)||null,{calculatedPrice:f,priceLoading:h,priceError:m}=KB({isOpen:e,orderId:a,productName:i,customerType:c,basePrice:s,normalizedOrderDate:u}),x=p.useMemo(()=>{if(!r)return 0;const W=Number(r[U.PRICE])||0;return Math.max(0,f??W)},[r,f]);if(!e||!r)return null;const g=String(r[ft.TRANG_THAI_TEXT]||r.trangThaiText||r[U.STATUS]||"").trim()||"Chưa Thanh Toán",v=r[ft.SO_NGAY_CON_LAI]!==void 0&&r[ft.SO_NGAY_CON_LAI]!==null?Number(r[ft.SO_NGAY_CON_LAI]):null,y=Oy(r.so_ngay_con_lai),b=Py(r.expiry_date||r.expiry_date_display||r[ft.EXPIRY_DATE_DISPLAY]||r[U.ORDER_EXPIRED]),w=QS(b)??Oy(r[U.DAYS]),N=v!==null&&Number.isFinite(v)?v:y??w??0,_=Py(r.registration_date_display||r[ft.ORDER_DATE_DISPLAY]||r.registration_date||r[U.ORDER_DATE]),E=(r.registration_date_display||r[ft.ORDER_DATE_DISPLAY]||Ot(_)||String(r[U.ORDER_DATE]||""))??"",S=r.expiry_date_display||r[ft.EXPIRY_DATE_DISPLAY]||Ot(b)||String(r[U.ORDER_EXPIRED]||""),j=x,P=String(r[U.ID_ORDER]||""),C=Math.max(0,Number(j)||0),T=Ln(C),k=qp({accountNumber:ky,bankCode:HB,amount:T,description:P});return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 px-4 py-6",onClick:t,children:o.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:W=>W.stopPropagation(),children:[o.jsxs("div",{className:"flex justify-center items-center p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[o.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Chi tiết đơn hàng:"," ",o.jsx("span",{className:"text-blue-600",children:r[U.ID_ORDER]})]}),o.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Dt,{className:"h-6 w-6"})})]}),o.jsxs("div",{className:"p-6 overflow-y-auto flex-grow space-y-5 text-gray-700",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-sm",children:[o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID Đơn:"}),o.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[U.ID_ORDER]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sản Phẩm:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[U.ID_PRODUCT]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Thông Tin Sản Phẩm:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right break-words",children:r[U.INFORMATION_ORDER]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[U.SLOT]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ghi Chú:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[U.NOTE]||"-"})]}),o.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trạng Thái:"}),o.jsx("dd",{className:"w-2/3 text-right",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${tE(g)}`,children:g})})]})]}),o.jsxs("dl",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khách Hàng:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[U.CUSTOMER]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1 items-start",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3 shrink-0",children:"Liên Hệ:"}),o.jsx("dd",{className:"w-2/3 text-right break-all",children:o.jsx("a",{href:r[U.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[U.CONTACT]||"-"})})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Order:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:E})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[U.DAYS]})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Hết Hạn:"}),o.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:S})]}),o.jsxs("div",{className:"flex justify-between border-b pb-1",children:[o.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày Còn Lại:"}),o.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:N})]})]})]}),o.jsx("hr",{className:"my-4 border-white/10"}),o.jsxs("div",{className:"text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[o.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Quét mã QR để thanh toán (VietQR)"}),k?o.jsx("div",{className:"flex justify-center mb-3",children:o.jsx("img",{src:k,alt:`QR Code thanh toán ${r[U.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40",width:280,height:280})}):o.jsx("p",{className:"text-red-600 font-medium",children:"Không thể tạo mã QR. Vui lòng kiểm tra lại cấu hình"}),o.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[o.jsxs("p",{children:["Ngân hàng: ",o.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),o.jsxs("p",{children:["Số tài khoản: ",o.jsx("strong",{className:"text-indigo-100",children:ky})]}),o.jsxs("p",{children:["Chủ tài khoản: ",o.jsx("strong",{className:"text-indigo-100",children:WB})]}),o.jsxs("p",{children:["Số tiền:"," ",o.jsx("strong",{className:"text-xl text-red-600",children:h?"Đang tính...":n(T)})]}),m&&o.jsx("p",{className:"text-xs text-red-500",children:m}),o.jsxs("p",{children:["Nội dung: ",o.jsx("strong",{className:"text-indigo-200",children:P})," ","(Vui lòng điền đúng)"]})]})]})]})]})})},Dy=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",Ry=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,mo=e=>(e?.supplier_name??e?.source_name??e?.name??"").trim(),Iy=pu,VB=(e,t)=>{const[r,n]=p.useState(null),[a,i]=p.useState([]),[s,l]=p.useState([]),c=p.useRef(e),[d,u]=p.useState(!1),f=p.useCallback(()=>{const N=c.current?.[U.SUPPLY]||"";return N.trim()?{id:-1,supplier_name:N,source_name:N}:null},[]),h=p.useCallback(N=>{const _=f();return _&&!N.some(S=>mo(S)===mo(_))?[_,...N]:N},[f]),m=p.useCallback(async N=>{if(!N){const _=h([]);return i(_),_}try{const _=await fetch(`${Iy}${rt.SUPPLIES_BY_PRODUCT(N)}`,{credentials:"include"});if(!_.ok)throw new Error("Lỗi tải danh sách nguồn.");const E=await _.json(),S=h(E);return i(S),S}catch(_){console.error("Lỗi khi fetch supplies cho sản phẩm:",_);const E=h([]);return i(E),E}},[h]),x=p.useCallback(async N=>{if(!N)return l([]),[];try{const _=await fetch(`${Iy}${rt.SUPPLY_PRICES_BY_PRODUCT_NAME(N)}`,{credentials:"include"});if(!_.ok)throw new Error("Lỗi tải danh sách giá nguồn.");const E=await _.json();return l(E),E}catch(_){return console.error("Lỗi khi fetch giá nguồn cho sản phẩm:",_),l([]),[]}},[]);p.useEffect(()=>{if(t&&e){const N={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(N),c.current=N,i(E=>h(E));const _=e.id_product;_&&(m(_),x(_)),u(!1)}else t||(n(null),i([]),l([]),u(!1))},[t,e,m,x,h]),p.useEffect(()=>{if(!t||!r?.id_product)return;const N=r.id_product;m(N),x(N)},[t,r?.id_product,m,x]);const g=p.useCallback((N,_)=>{n(E=>E&&{...E,[N]:_})},[]),v=p.useCallback(N=>{const _=a.find(P=>P.id===N),E=mo(_)||r?.[U.SUPPLY]||"";u(!1),g(U.SUPPLY,E||"");const S=iB(E,s,a)??s.find(P=>P.source_id===N)?.price??null,j=Number(S);if(Number.isFinite(j))g(U.COST,j);else if(c.current){const P=Number(c.current[U.COST]||0);g(U.COST,P)}},[r,g,a,s]),y=p.useCallback(N=>{u(!0),g(U.SUPPLY,N)},[g]),b=p.useCallback(()=>{u(N=>{const _=!N;return _||g(U.SUPPLY,""),_})},[g]),w=p.useCallback(()=>{n(c.current);const N=c.current?.id_product;N&&(m(N),x(N))},[m,x]);return{formData:r,supplies:a,isCustomSupply:d,supplyPrices:s,handleSupplySelect:v,resetForm:w,setFieldValue:g,handleCustomSupplyChange:y,toggleCustomSupply:b}},Ir="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",qr="block text-sm font-medium text-slate-100 mb-1",Wn="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",GB=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:a,supplies:i,isCustomSupply:s,handleSupplySelect:l,resetForm:c,setFieldValue:d,handleCustomSupplyChange:u,toggleCustomSupply:f}=VB(r,e),[h,m]=p.useState(!1),x=_=>a?String(a[_]??""):"",g=_=>a&&Number(a[_]??0)||0,v=p.useCallback(_=>{const E=_.target,{name:S,value:j}=E,P=E instanceof HTMLInputElement&&E.type==="checkbox"?E.checked:j;d(S,P)},[d]),y=p.useMemo(()=>{if(!a)return"";const _=i.find(E=>mo(E)===a[U.SUPPLY]);return _?String(_.id):""},[a,i]),b=p.useMemo(()=>{if(!a)return"";const _=Ry(a.registration_date_display||a.registration_date||a[U.ORDER_DATE]);return Ot(_)||String(_||"")},[a]),w=p.useMemo(()=>{if(!a)return"";const _=Ry(a.expiry_date_display||a.expiry_date||a[U.ORDER_EXPIRED]);return Ot(_)||String(_||"")},[a]),N=async _=>{if(_.preventDefault(),!!a){m(!0);try{await n(a)}finally{m(!1)}}};return!e||!a?null:o.jsx("div",{className:"edit-order-shell fixed inset-0 z-50 flex items-center justify-center bg-black/55 backdrop-blur-lg px-4 py-6",children:o.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[o.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-6 py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Chỉnh sửa đơn hàng"}),o.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"Đóng",children:o.jsx(Dt,{className:"h-6 w-6"})})]}),o.jsxs("form",{onSubmit:N,className:"p-6 space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Mã đơn hàng"}),o.jsx("input",{type:"text",name:U.ID_ORDER,value:x(U.ID_ORDER),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Khách hàng"}),o.jsx("input",{type:"text",name:U.CUSTOMER,value:x(U.CUSTOMER),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Liên hệ"}),o.jsx("input",{type:"text",name:U.CONTACT,value:x(U.CONTACT),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Slot"}),o.jsx("input",{type:"text",name:U.SLOT,value:x(U.SLOT),onChange:v,className:Ir})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Sản phẩm"}),o.jsx("input",{type:"text",name:U.ID_PRODUCT,value:x(U.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Nguồn"}),o.jsxs("div",{className:"flex items-center gap-2",children:[s?o.jsx("input",{type:"text",name:U.SUPPLY,value:x(U.SUPPLY),onChange:_=>u(_.target.value),className:Ir,placeholder:"Nhập nguồn mới"}):o.jsxs("select",{name:U.SUPPLY,value:y,onChange:_=>l(Number(_.target.value)),className:Ir,children:[o.jsx("option",{value:"",children:"-- Giữ nguyên hoặc chọn --"}),i.map(_=>o.jsx("option",{value:_.id,children:mo(_)},_.id))]}),o.jsx("button",{type:"button",onClick:f,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${s?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":s?"Tắt nhập nguồn mới":"Nhập nguồn mới",children:s?o.jsx(nw,{className:"h-6 w-6","aria-hidden":"true"}):o.jsx(Vh,{className:"h-6 w-6","aria-hidden":"true"})})]}),!i.length&&!s&&o.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Không có danh sách nguồn cho sản phẩm hiện tại."})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Thông tin đơn hàng"}),o.jsx("input",{type:"text",name:U.INFORMATION_ORDER,value:x(U.INFORMATION_ORDER),onChange:v,className:Ir})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ngày đăng ký"}),o.jsx("input",{type:"text",name:U.ORDER_DATE,value:b,readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Số ngày"}),o.jsx("input",{type:"text",name:U.DAYS,value:x(U.DAYS),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ngày hết hạn"}),o.jsx("input",{type:"text",name:U.ORDER_EXPIRED,value:w,readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Giá nhập"}),o.jsx("input",{type:"text",name:U.COST,value:Dy(g(U.COST)),readOnly:!0,disabled:!0,className:`${Ir} ${Wn} font-semibold`})]}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Giá bán"}),o.jsx("input",{type:"text",name:U.PRICE,value:Dy(g(U.PRICE)),readOnly:!0,disabled:!0,className:`${Ir} ${Wn} font-semibold text-emerald-300`})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Trạng thái"}),o.jsx("input",{type:"text",name:U.STATUS,value:x(U.STATUS),readOnly:!0,disabled:!0,className:`${Ir} ${Wn}`})]})}),o.jsxs("div",{children:[o.jsx("label",{className:qr,children:"Ghi chú"}),o.jsx("textarea",{name:U.NOTE,value:x(U.NOTE),rows:4,onChange:v,className:Ir})]}),o.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[o.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hoàn tác"}),o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Đóng"}),o.jsx("button",{type:"submit",disabled:h,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${h?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:h?"Đang lưu...":"Lưu thay đổi"})]})]})]})})},wh=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},Ro=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),a=parseInt(r[1],10),i=parseInt(r[2],10),s=new Date(i,a-1,n);s.setDate(s.getDate()+t-1);const l=String(s.getDate()).padStart(2,"0"),c=String(s.getMonth()+1).padStart(2,"0"),d=s.getFullYear();return`${l}/${c}/${d}`},cE={[U.ID_ORDER]:"",[U.ID_PRODUCT]:"",[U.INFORMATION_ORDER]:"",[U.CUSTOMER]:"",[U.CONTACT]:"",[U.SLOT]:"",[U.ORDER_DATE]:"",[U.DAYS]:"0",[U.ORDER_EXPIRED]:"",[U.SUPPLY]:"",[U.COST]:0,[U.PRICE]:0,[U.NOTE]:"",[U.STATUS]:tr.CHUA_THANH_TOAN},dr="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-all",_r="block text-sm font-medium text-gray-700 mb-1",ro="bg-gray-100 cursor-not-allowed",Fy=({name:e,value:t,options:r,placeholder:n,disabled:a,onChange:i,onClear:s})=>{const l=p.useRef(null),[c,d]=p.useState(!1),[u,f]=p.useState(""),h=p.useMemo(()=>{const x=r.find(g=>g.value===t);return x?x.label:""},[r,t]);p.useEffect(()=>{f(h)},[h]);const m=p.useMemo(()=>{const x=(u||"").toLowerCase().trim();return x?r.filter(g=>g.label.toLowerCase().includes(x)):r},[r,u]);return p.useEffect(()=>{const x=g=>{l.current&&(l.current.contains(g.target)||d(!1))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),o.jsxs("div",{ref:l,className:"relative",children:[o.jsx("input",{name:e,type:"text",value:u,onChange:x=>{const g=x.target.value;f(g),g===""&&s?.(),c||d(!0)},onFocus:()=>d(!0),disabled:a,placeholder:n,className:`${dr} pr-8`,autoComplete:"off"}),!!u&&s&&!a&&o.jsx("button",{type:"button",onMouseDown:x=>{x.preventDefault(),f(""),s(),d(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:"×"}),c&&!a&&o.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:m.length===0?o.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Không có kết quả"}):m.map(x=>o.jsx("div",{className:`px-3 py-2 text-sm cursor-pointer hover:bg-indigo-500/15 ${x.value===t?"bg-gray-50":""}`,onMouseDown:g=>{g.preventDefault(),f(x.label),d(!1),i(x.value,x)},children:x.label},`${String(x.value)}-${x.label}`))})]})},YB=e=>{const[t,r]=p.useState(cE),[n,a]=p.useState(e),[i,s]=p.useState(null),[l,c]=p.useState(!1),d=p.useCallback(u=>{r(f=>({...f,...u}))},[]);return{formData:t,setFormData:r,customerType:n,setCustomerType:a,selectedSupplyId:i,setSelectedSupplyId:s,customProductTouched:l,setCustomProductTouched:c,updateForm:d}},XB=({isOpen:e,customerType:t,setCustomerType:r,setFormData:n,setIsDataLoaded:a,setSelectedSupplyId:i,setSupplies:s,setSupplyPrices:l,setCustomProductTouched:c,fetchProducts:d,fetchAllSupplies:u})=>{const f=p.useMemo(()=>t+jy(5),[t]);p.useEffect(()=>{if(!e)return;const h=sE,m=h+jy(5),x=ja();r(h),n({...cE,[U.ID_ORDER]:m,[U.ORDER_DATE]:x,[U.ORDER_EXPIRED]:x}),a(!1),i(null),s([]),l([]),c(!1),d(),u()},[u,d,e,r,n,a,i,s,l,c]),p.useEffect(()=>{e&&n(h=>({...h,[U.ID_ORDER]:f}))},[f,e,n])},qB=({infoValue:e,infoRef:t,productName:r,orderId:n,registerDate:a,selectedSupplyId:i,customMode:s,customerType:l,recalcPrice:c})=>{p.useEffect(()=>{t.current=e||""},[e,t]),p.useEffect(()=>{if(!r||!n||!a||s)return;const d=i??0;c(d,r,n,a,void 0,{updateCost:!!d})},[l,c,r,n,a,i,s])},ZB=({formData:e,isLoading:t,updateForm:r,onSave:n})=>({handleSubmit:p.useCallback(i=>{if(i.preventDefault(),e&&e[U.ID_PRODUCT]&&e[U.SUPPLY]&&e[U.CUSTOMER]&&e[U.INFORMATION_ORDER]&&!t){const l=Ot(e[U.ORDER_DATE])||e[U.ORDER_DATE]||ja(),c=Ot(e[U.ORDER_EXPIRED])||e[U.ORDER_EXPIRED]||"",d=Number(e[U.DAYS]||0)||0;let u=c;if(!u&&l&&d>0){const x=Ro(l,d);x&&x!=="N/A"&&(u=x,r({[U.ORDER_EXPIRED]:u}))}const f=wh(l),h=u?wh(u):f,m={...e,[U.COST]:Number(e[U.COST]),[U.PRICE]:Number(e[U.PRICE]),[U.ORDER_DATE]:f,[U.ORDER_EXPIRED]:h,[U.CONTACT]:e[U.CONTACT]||null,[U.SLOT]:e[U.SLOT]||null,[U.NOTE]:e[U.NOTE]||null};return n(m),!0}return alert("Vui lòng điền đầy đủ các thông tin"),!1},[e,t,n,r])}),JB=({customerType:e,setFormData:t,productName:r})=>{const[n,a]=p.useState(!1),[i,s]=p.useState(!1),l=p.useRef(""),c=p.useRef(0),d=p.useRef(null);p.useEffect(()=>()=>{d.current?.abort()},[]);const u=p.useCallback(async(m,x,g,v)=>{const y=c.current+1;c.current=y,d.current&&d.current.abort();const b=new AbortController;d.current=b,a(!0),s(!1);try{const w=wh(v)||v||null,N=await Ze(rt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supply_id:m,san_pham_name:x,id_product:x,id_order:g,order_date:w,customer_type:e}),signal:b.signal}),{data:_,rawText:E}=await nE(N);if(y!==c.current)return;if(!N.ok){const k=_?.error||E||"Lỗi tính giá từ Server.";throw new Error(k)}if(!_)throw new Error("Phản hồi không hợp lệ từ server.");const S=_||{},j=Ot(v)||v||ja(),P={cost:Math.max(0,Number(S.gia_nhap??S.cost??0)||0),price:Math.max(0,Number(S.gia_ban??S.price??0)||0),days:Number(S.so_ngay_da_dang_ki??S.days??0)||0,order_expired:""},C=(S.order_expired??S.het_han??"").trim(),T=Ot(C)||C||(P.days>0?Ro(j,P.days):"");return P.order_expired=T,P}catch(w){if(w?.name==="AbortError")return;console.error("Lỗi khi tính giá:",w),s(!1),alert(`Tính giá thất bại: ${w instanceof Error?w.message:"Lỗi không xác định"}`);return}finally{y===c.current&&a(!1)}},[e]),f=p.useCallback((m,x,g,v)=>{if(!m)return;const y=Ot(x)||x||ja();let b=Number(m.days||0)||0,w=m.order_expired||(b>0?Ro(y,b):"");const N=Kc(v?.infoOverride||"")||Kc((v?.productNameOverride||r||"").toString());if(N>0){const _=nB(N),E=JS(y,N);_>0&&(b=_,w=E)}t(_=>{const E=Number(_[U.COST]||0),S=Number.isFinite(m.cost)&&m.cost>0?m.cost:void 0,P=v?.updateCost??!0?S??Number(g??E??0):E,C=Number(_[U.PRICE]||0),T=Number.isFinite(m.price)&&m.price>0?m.price:void 0;let k=T??C??0;return e===Kt.PROMO&&(k=T??P??C??0),{..._,[U.COST]:P,[U.PRICE]:k,[U.DAYS]:b>0?String(b):String(_[U.DAYS]||"0"),[U.ORDER_EXPIRED]:w||_[U.ORDER_EXPIRED]||""}}),s(!0)},[e,r,t]),h=p.useCallback((m,x,g,v,y,b)=>{!x||!g||!v||u(m,x,g,v).then(w=>f(w,v,y,{...b,productNameOverride:x,infoOverride:l.current}))},[f,u]);return{isLoading:n,setIsLoading:a,isDataLoaded:i,setIsDataLoaded:s,calculatePrice:u,applyCalculationResult:f,recalcPrice:h,infoRef:l}},QB=({productName:e,orderId:t,registerDate:r,allSupplies:n,selectedSupplyId:a,customMode:i,todayDate:s,setSelectedSupplyId:l,setCustomProductTouched:c,setFormData:d,setSupplies:u,setSupplyPrices:f,setIsDataLoaded:h,fetchSuppliesByProduct:m,fetchAllSupplyPrices:x,recalcPrice:g})=>(p.useEffect(()=>{e||(l(null),d(y=>{if(!y[U.ID_PRODUCT]&&Number(y[U.PRICE]||0)===0&&String(y[U.DAYS]||"0")==="0")return y;const w=y[U.ORDER_DATE]||ja();return{...y,[U.ID_PRODUCT]:"",[U.SUPPLY]:"",[U.COST]:0,[U.PRICE]:0,[U.DAYS]:"0",[U.ORDER_EXPIRED]:w}}))},[e,d,l]),{handleProductSelect:p.useCallback(y=>{const b=(y||"").trim();if(l(null),c(!1),!b){d(w=>({...w,[U.ID_PRODUCT]:"",[U.SUPPLY]:"",[U.COST]:0,[U.PRICE]:0,[U.DAYS]:"0",[U.ORDER_EXPIRED]:w[U.ORDER_DATE]||s})),u(n),f([]),h(!1);return}if(d(w=>({...w,[U.ID_PRODUCT]:b,[U.SUPPLY]:"",[U.COST]:0,[U.PRICE]:0,[U.DAYS]:"0",[U.ORDER_EXPIRED]:w[U.ORDER_DATE]||s})),u([]),f([]),m(b),x(b),t&&r&&!i){const w=a??0;g(w,b,t,r,void 0,{updateCost:!!w})}},[n,i,x,m,t,g,r,a,c,d,h,l,u,f,s])}),e$=300*1e3,My=new Map,t$=e=>{const t=My.get(e);if(t)return t;const r={ts:0};return My.set(e,r),r},r$=e=>!!(e.data&&Date.now()-e.ts<e$),Il=async(e,t,r=!1)=>{const n=t$(e);if(!r&&r$(n))return n.data;if(n.promise)return n.promise;const a=t().then(i=>(n.data=i,n.ts=Date.now(),n.promise=void 0,i)).catch(i=>{throw n.promise=void 0,i});return n.promise=a,a},Ly=e=>e.trim(),n$=e=>{const[t,r]=p.useState([]),[n,a]=p.useState([]),[i,s]=p.useState([]),[l,c]=p.useState([]),d=p.useCallback(async(m=!1)=>{try{const x=await Il(`products:${e}`,async()=>{const g=await fetch(`${e}${rt.PRODUCTS_ALL}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách sản phẩm.");return await g.json()},m);s(x)}catch(x){console.error("Lỗi khi fetch products:",x)}},[e]),u=p.useCallback(async(m=!1)=>{try{const x=await Il(`supplies:${e}`,async()=>{const g=await fetch(`${e}${rt.SUPPLIES}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách nguồn.");return await g.json()},m);r(x),a(g=>g.length?g:x)}catch(x){console.error("Lỗi khi fetch all supplies:",x),r([])}},[e]),f=p.useCallback(async(m,x=!1)=>{const g=Ly(m);if(!g){a(v=>v.length?v:t);return}try{const v=await Il(`suppliesByProduct:${e}:${g}`,async()=>{const y=await fetch(`${e}${rt.SUPPLIES_BY_PRODUCT(g)}`,{credentials:"include"});if(!y.ok)throw new Error("Lỗi tải danh sách nguồn.");return await y.json()},x);a(v)}catch(v){console.error("Lỗi khi fetch supplies:",v),a(t)}},[e,t]),h=p.useCallback(async(m,x=!1)=>{const g=Ly(m);if(!g){c([]);return}try{const v=await Il(`supplyPricesByProduct:${e}:${g}`,async()=>{const y=await fetch(`${e}${rt.SUPPLY_PRICES_BY_PRODUCT_NAME(g)}`,{credentials:"include"});if(!y.ok)throw new Error("Lỗi tính giá nhập của nguồn.");return await y.json()},x);c(v)}catch(v){console.error("Lỗi khi fetch all supply prices:",v),c([])}},[e]);return{allSupplies:t,supplies:n,products:i,supplyPrices:l,setSupplies:a,setSupplyPrices:c,fetchProducts:d,fetchAllSupplies:u,fetchSuppliesByProduct:f,fetchAllSupplyPrices:h}},a$=({supplies:e,supplyPrices:t,formData:r,customerType:n,productName:a,orderId:i,registerDate:s,setSelectedSupplyId:l,setFormData:c,setIsDataLoaded:d,recalcPrice:u})=>{const f=p.useMemo(()=>{const g=new Map,v=new Map;for(const y of e){g.set(y.id,y);const b=y.supplier_name??y.source_name??"";b&&!v.has(b)&&v.set(b,y.id)}return{byId:g,idByName:v}},[e]),h=p.useMemo(()=>{const g=new Map,v=new Map;for(const y of t){const b=Number(y.price);if(!Number.isFinite(b))continue;g.has(y.source_id)||g.set(y.source_id,b);const w=y.supplier_name??y.source_name;w&&!v.has(w)&&v.set(w,b)}return{byId:g,byName:v}},[t]),m=p.useCallback((g,v,y)=>{if(v){const b=h.byName.get(v);if(b!==void 0&&Number.isFinite(b))return b;const w=f.idByName.get(v);if(w!==void 0){const N=h.byId.get(w);if(N!==void 0&&Number.isFinite(N))return N}}if(g!==0){const b=h.byId.get(g);if(b!==void 0&&Number.isFinite(b))return b}return y},[f.idByName,h.byId,h.byName]);return{handleSourceSelect:p.useCallback(g=>{const v=f.byId.get(g),y=Number(r[U.COST]||0),b=v?.supplier_name??v?.source_name??"",w=m(g,b,y);if(l(g===0?null:g),c(N=>{const _={...N,[U.SUPPLY]:v?b:"",[U.COST]:w};return n===Kt.PROMO&&(_[U.PRICE]=w),_}),!a||!i||!s){d(!1);return}u(g,a,i,s,w,{updateCost:!0})},[n,r,m,i,a,u,s,c,d,l,f.byId])}},i$=pu,s$=(e,t,r)=>{const{formData:n,setFormData:a,customerType:i,setCustomerType:s,selectedSupplyId:l,setSelectedSupplyId:c,customProductTouched:d,setCustomProductTouched:u,updateForm:f}=YB(sE),{allSupplies:h,supplies:m,products:x,supplyPrices:g,setSupplies:v,setSupplyPrices:y,fetchProducts:b,fetchAllSupplies:w,fetchSuppliesByProduct:N,fetchAllSupplyPrices:_}=n$(i$),E=n[U.ID_PRODUCT],S=n[U.ID_ORDER],j=n[U.ORDER_DATE],P=n[U.INFORMATION_ORDER]||"",{isLoading:C,isDataLoaded:T,setIsDataLoaded:k,recalcPrice:W,infoRef:G}=JB({customerType:i,setFormData:a,productName:E}),K=p.useMemo(()=>ja(),[]);XB({isOpen:e,customerType:i,setCustomerType:s,setFormData:a,setIsDataLoaded:k,setSelectedSupplyId:c,setSupplies:v,setSupplyPrices:y,setCustomProductTouched:u,fetchProducts:b,fetchAllSupplies:w}),qB({infoValue:P,infoRef:G,productName:E,orderId:S,registerDate:j,selectedSupplyId:l,customMode:r,customerType:i,recalcPrice:W});const{handleProductSelect:J}=QB({productName:E,orderId:S,registerDate:j,allSupplies:h,selectedSupplyId:l,customMode:r,todayDate:K,setSelectedSupplyId:c,setCustomProductTouched:u,setFormData:a,setSupplies:v,setSupplyPrices:y,setIsDataLoaded:k,fetchSuppliesByProduct:N,fetchAllSupplyPrices:_,recalcPrice:W}),{handleSourceSelect:V}=a$({supplies:m,supplyPrices:g,formData:n,customerType:i,productName:E,orderId:S,registerDate:j,setSelectedSupplyId:c,setFormData:a,setIsDataLoaded:k,recalcPrice:W}),Z=le=>{const{name:de,value:pe}=le.target;f({[de]:pe})},Q=le=>{const de=le.target.value;s(de),c(null),v([]),y([]),k(!1),a(pe=>({...pe,[U.ID_PRODUCT]:"",[U.SUPPLY]:"",[U.COST]:0,[U.PRICE]:0,[U.DAYS]:"0",[U.ORDER_EXPIRED]:pe[U.ORDER_DATE]||ja()}))},{handleSubmit:Y}=ZB({formData:n,isLoading:C,updateForm:f,onSave:t});return{formData:n,supplies:m,allSupplies:h,products:x,isLoading:C,isDataLoaded:T,selectedSupplyId:l,customerType:i,updateForm:f,setIsDataLoaded:k,customProductTouched:d,setCustomProductTouched:u,handleChange:Z,handleProductSelect:J,handleSourceSelect:V,handleCustomerTypeChange:Q,handleSubmit:Y}},o$=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=p.useState(!1),{formData:i,updateForm:s,supplies:l,products:c,isLoading:d,selectedSupplyId:u,customerType:f,setIsDataLoaded:h,customProductTouched:m,setCustomProductTouched:x,handleChange:g,handleProductSelect:v,handleSourceSelect:y,handleCustomerTypeChange:b,handleSubmit:w}=s$(e,r,n),N=i[U.INFORMATION_ORDER]||"",_=i[U.ID_PRODUCT]||"",E=i[U.ORDER_DATE]||ja(),S=i[U.COST],j=i[U.PRICE],P=p.useMemo(()=>i[U.ORDER_EXPIRED]||"",[i]),C=p.useMemo(()=>i[U.ORDER_DATE]||ja(),[i]),T=p.useMemo(()=>Number(i[U.DAYS]||0)||0,[i]),k=p.useMemo(()=>c.map(Z=>({value:Z.san_pham,label:Z.san_pham})),[c]),W=p.useMemo(()=>l.map(Z=>({value:Z.id,label:Z.supplier_name??Z.source_name})),[l]),G=p.useCallback(Z=>Q=>{const le=(Q.target.value||"").replace(/\D/g,""),de=le?parseInt(le,10):0;s({[Z]:de})},[s]),K=p.useCallback(Z=>{const Q=Ot(Z.target.value)||Z.target.value||"",Y=T>0?Ro(Q,T):Q,le={[U.ORDER_DATE]:Q};Y&&Y!=="N/A"?le[U.ORDER_EXPIRED]=Y:T<=0&&Q&&(le[U.ORDER_EXPIRED]=Q),s(le)},[T,s]);p.useEffect(()=>{if(!n||!m)return;const Z=Kc(N)||Kc(_),Q=E;if(Z>0){const Y=JS(Q,Z),le=tB(Q,Y);s({[U.DAYS]:String(le),[U.ORDER_EXPIRED]:Y})}},[n,m,N,_,E,s]),p.useEffect(()=>{if(!P)return;const Z=Ot(P);if(!Z&&C&&T>0){const Q=Ro(C,T);Q&&Q!=="N/A"&&Q!==P&&s({[U.ORDER_EXPIRED]:Q})}else Z&&Z!==P&&s({[U.ORDER_EXPIRED]:Z})},[P,C,T,s]);const J=p.useMemo(()=>{const Z=i[U.ID_PRODUCT]||"",Q=i[U.SUPPLY]||"",Y=i[U.INFORMATION_ORDER]||"",le=i[U.CUSTOMER]||"";return!!Z&&!!Q&&!!Y&&!!le},[i]);if(p.useEffect(()=>{h(J)},[J,h]),!e)return null;const V=!!(i[U.CUSTOMER]&&i[U.ID_PRODUCT]&&i[U.SUPPLY]&&i[U.INFORMATION_ORDER]);return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300",children:o.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col text-slate-100",children:[o.jsxs("div",{className:"p-5 border-b border-slate-700 sticky top-0 bg-slate-800/80 z-10 flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl font-semibold text-white",children:"Tạo Đơn Hàng Mới"}),o.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:o.jsx(Dt,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o.jsx("form",{onSubmit:w,children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border p-4 rounded-lg bg-gray-50",children:[o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Loại Khách Hàng"}),o.jsx("select",{name:"customer_type",value:f,onChange:b,className:dr,children:LB.map(Z=>o.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Mã Đơn Hàng"}),o.jsx("input",{type:"text",name:U.ID_ORDER,value:i[U.ID_ORDER]||"",readOnly:!0,className:`${dr} font-semibold ${ro}`})]}),o.jsxs("div",{children:[o.jsxs("label",{className:_r,children:["Tên Khách Hàng ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:U.CUSTOMER,value:i[U.CUSTOMER]||"",onChange:g,className:dr,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Link Liên Hệ"}),o.jsx("input",{type:"url",name:U.CONTACT,value:i[U.CONTACT]||"",onChange:g,className:dr})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[o.jsxs("div",{className:"md:col-span-5",children:[o.jsxs("label",{className:_r,children:["Sản Phẩm ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(Fy,{name:U.ID_PRODUCT,value:i[U.ID_PRODUCT]||"",options:k,placeholder:"-- Chọn --",onChange:Z=>v(String(Z)),onClear:()=>v(""),disabled:n})]}),o.jsxs("div",{className:"md:col-span-5",children:[o.jsxs("label",{className:_r,children:["Nguồn ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(Fy,{name:U.SUPPLY,value:u??"",options:W,placeholder:"-- Chọn --",disabled:n||!i[U.ID_PRODUCT],onChange:Z=>y(Number(Z)),onClear:()=>y(0)})]}),o.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:o.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{x(!1),a(Z=>!Z)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?o.jsx(nw,{className:"h-6 w-6","aria-hidden":"true"}):o.jsx(Vh,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&o.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Sản Phẩm Mới"}),o.jsx("input",{type:"text",name:U.ID_PRODUCT,value:i[U.ID_PRODUCT]||"",onChange:g,onBlur:()=>x(!0),className:dr,placeholder:"Nhập Tên Sản Phẩm Mới"})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Nguồn Mới"}),o.jsx("input",{type:"text",name:U.SUPPLY,value:i[U.SUPPLY]||"",onChange:g,className:dr,placeholder:"Nhập Tên Nguồn Mới"})]})]}),o.jsxs("div",{className:"md:col-span-12",children:[o.jsxs("label",{className:_r,children:["Thông Tin Sản Phẩm ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:U.INFORMATION_ORDER,value:i[U.INFORMATION_ORDER]||"",onChange:g,className:dr,required:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Ngày Đăng Ký"}),o.jsx("input",{type:"date",name:U.ORDER_DATE,value:ZS(C),onChange:K,className:dr})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Số Ngày Đăng Ký"}),o.jsx("input",{type:"text",name:U.DAYS,value:i[U.DAYS]||"",readOnly:!0,className:`${dr} ${ro}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Ngày Hết Hạn"}),o.jsx("input",{type:"text",name:U.ORDER_EXPIRED,value:i[U.ORDER_EXPIRED]||"",readOnly:!0,className:`${dr} font-medium text-red-600 ${ro}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Slot"}),o.jsx("input",{type:"text",name:U.SLOT,value:i[U.SLOT]||"",onChange:g,className:dr})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Giá Nhập"}),n?o.jsx("input",{type:"text",inputMode:"numeric",name:U.COST,value:Cy(Number(S??0)),onChange:G(U.COST),className:`${dr} font-semibold`}):o.jsx("input",{type:"text",name:U.COST,value:Mn(S??0),readOnly:!0,className:`${dr} font-semibold ${ro}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Giá Bán"}),n?o.jsx("input",{type:"text",inputMode:"numeric",name:U.PRICE,value:Cy(Number(j??0)),onChange:G(U.PRICE),className:`${dr} font-semibold text-green-700`}):o.jsx("input",{type:"text",name:U.PRICE,value:Mn(j??0),readOnly:!0,className:`${dr} font-semibold text-green-700 ${ro}`})]}),o.jsxs("div",{children:[o.jsx("label",{className:_r,children:"Ghi Chú"}),o.jsx("textarea",{name:U.NOTE,value:i[U.NOTE]||"",onChange:g,rows:8,className:dr})]})]})]})]})})}),o.jsxs("div",{className:"p-5 border-t border-gray-200 bg-gray-50 flex justify-end sticky bottom-0 z-10",children:[o.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-indigo-500/15 transition-colors shadow-sm mr-3",children:"Hủy"}),o.jsx("button",{type:"submit",onClick:w,className:`px-6 py-2 text-base font-medium text-white rounded-lg transition-colors shadow-md ${V&&!d?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,disabled:!V||d,children:d?"Đang Tính Giá...":"Tạo Đơn Hàng"})]})]})})},oo=e=>Ln(e).toLocaleString("vi-VN")+" VND",no=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},tc=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),Z0=e=>tc(e).replace(/[^a-z0-9]/g,""),By=(e,t)=>{const r=e??t;return r==null?"":Ot(r)||String(r)},da=e=>{if(e==null)return e;if(typeof e!="boolean"&&(typeof e=="string"||typeof e=="number"||e instanceof Date))return e},l$=e=>e==null?e:typeof e=="boolean"?null:typeof e=="number"||typeof e=="string"?e:null,J0=e=>{if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},$y=e=>{const t=da(e.expiry_date)??da(e[U.ORDER_EXPIRED])??da(e.expiry_date_display)??da(e[ft.EXPIRY_DATE_DISPLAY]),n=(Ot(t)||String(t||"")).split("/");if(n.length===3){const[i,s,l]=n.map(Number);if(Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(l))return new Date(l,s-1,i).getTime()}const a=new Date(String(t||""));return Number.isFinite(a.getTime())?a.getTime():0};function c$(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}const Nh="app:data-refresh",uE=e=>!e||e.length===0?["all"]:e,u$=(e,t)=>e.includes("all")||t.some(r=>e.includes(r)),Xi=(e=["all"])=>{if(typeof window>"u")return;const t={scopes:uE(e)};window.dispatchEvent(new CustomEvent(Nh,{detail:t}))},d$=(e,t)=>{if(typeof window>"u")return()=>{};const r=n=>{const a=n.detail,i=uE(a?.scopes);u$(i,e)&&t()};return window.addEventListener(Nh,r),()=>{window.removeEventListener(Nh,r)}},Fl=[{name:"Tổng Đơn Hàng",value:"0",icon:ms,accent:xr.sky},{name:"Cần Gia Hạn",value:"0",icon:zh,accent:xr.amber},{name:"Hết Hạn",value:"0",icon:Uh,accent:xr.rose},{name:"Đăng Ký Hôm Nay",value:"0",icon:wo,accent:xr.emerald}],ui=pu,f$=e=>{const[t,r]=p.useState([]),[n,a]=p.useState(""),[i,s]=p.useState("all"),[l,c]=p.useState("all"),[d,u]=p.useState(1),[f,h]=p.useState(10),[m,x]=p.useState(!1),[g,v]=p.useState(!1),[y,b]=p.useState(!1),[w,N]=p.useState(!1),[_,E]=p.useState(null),[S,j]=p.useState(null),[P,C]=p.useState(null),[T,k]=p.useState(null),[W,G]=p.useState(null),K=c$(n,300),J=tr.CHO_HOAN,V=X=>X===tr.CHUA_THANH_TOAN||X===J,Z=p.useCallback(async()=>{try{k(null);const X=oE[e].endpoint,fe=await fetch(`${ui}${X}`,{credentials:"include"});if(fe.status===401){window.location.href="/login";return}if(!fe.ok)throw new Error(`Lỗi máy chủ: ${fe.status}`);const Oe=await fe.json();Array.isArray(Oe)?r(Oe):console.error("Dữ liệu nhận được không phải là mảng:",Oe)}catch(X){console.error("Lỗi khi tải đơn hàng:",X);const fe=X instanceof TypeError?"Không thể kết nối đến máy chủ. Vui lòng kiểm tra lại dịch vụ backend.":X instanceof Error?X.message:"Có lỗi không xác định khi tải đơn hàng.";k(fe)}finally{}},[e]);p.useEffect(()=>{Z()},[Z]),p.useEffect(()=>{r([]),a(""),c("all"),u(1),x(!1),v(!1),b(!1),N(!1),E(null),j(null),C(null)},[e]);const Q=p.useMemo(()=>{const X=t.map(Le=>{const dt=da(Le.registration_date??Le[U.ORDER_DATE]),Be=da(Le.expiry_date??Le[U.ORDER_EXPIRED]),it=By(da(Le.registration_date_display),dt),ue=By(da(Le.expiry_date_display),Be),Ie=J0(l$(Le.so_ngay_con_lai)),Ge=QS(Be||ue),Ye=Ie??Ge??0,qe=Le[U.STATUS]||tr.CHUA_THANH_TOAN,ut=String(qe).trim(),Bt=Ln(Number.parseFloat(String(Le[U.PRICE]??0))||0),Nt=Number(Le[U.DAYS])||0,Gr=Math.max(0,Ye);let wr=Nt>0?Bt*Gr/Nt:0;const Ma=Le.can_hoan??Le[U.REFUND]??Le.refund;let Hn=J0(Ma)??(Number.isFinite(wr)?wr:null);if(e==="canceled"){const Yr=J0(Le.refund);Yr!==null&&(wr=Yr,Hn=Yr)}return{...Le,[ft.SO_NGAY_CON_LAI]:Ye,[ft.GIA_TRI_CON_LAI]:wr,[ft.TRANG_THAI_TEXT]:ut,[ft.ORDER_DATE_DISPLAY]:it,[ft.EXPIRY_DATE_DISPLAY]:ue,can_hoan:Hn}}),fe=tc(K),Oe=Z0(K),Me=i==="all"?[U.CUSTOMER,U.ID_ORDER,U.ID_PRODUCT,U.INFORMATION_ORDER,U.SUPPLY,U.CONTACT]:[i],me=l==="all"?"":String(l||"").trim(),we=X.filter(Le=>{const dt=!fe||Me.some(Ge=>{const Ye=Le[Ge],qe=tc(Ye);if(!qe)return!1;if(Ge===U.ID_ORDER){const ut=Z0(Ye);return!!Oe&&ut.includes(Oe)||qe.includes(fe)}return qe.includes(fe)}),Be=!!Oe&&Z0(Le[U.ID_ORDER]).includes(Oe),it=!!fe&&tc(Le[U.ID_PRODUCT]).includes(fe),ue=String(Le[ft.TRANG_THAI_TEXT]||"").trim();return(dt||Be||it)&&(l==="all"||me&&ue===me)});we.sort((Le,dt)=>{const Be=String(Le[ft.TRANG_THAI_TEXT]||"").trim(),it=String(dt[ft.TRANG_THAI_TEXT]||"").trim(),ue=V(Be),Ie=V(it);if(ue!==Ie)return ue?-1:1;if(e==="expired"){const Gr=$y(Le),wr=$y(dt);if(Gr!==wr)return wr-Gr}const Ge=Ay(Be),Ye=Ay(it);if(Ge!==Ye)return Ge-Ye;const qe=Number(Le[ft.SO_NGAY_CON_LAI]??0),ut=Number(dt[ft.SO_NGAY_CON_LAI]??0);if(qe!==ut)return qe-ut;const Bt=Le[U.ID_ORDER]||"",Nt=dt[U.ID_ORDER]||"";return Bt<Nt?-1:Bt>Nt?1:0});const he=X.length,Ce=X.filter(Le=>{const dt=Number(Le[ft.SO_NGAY_CON_LAI]??0);return Number.isFinite(dt)&&dt>0&&dt<=4}).length,ge=X.filter(Le=>{const dt=Number(Le[ft.SO_NGAY_CON_LAI]??0);return Number.isFinite(dt)&&dt<=0}).length,Ve=X.filter(Le=>{const dt=da(Le.registration_date||Le.registration_date_display||Le[ft.ORDER_DATE_DISPLAY]||Le[U.ORDER_DATE]);return rB(dt)}).length,De=[{...Fl[0],value:String(he)},{...Fl[1],value:String(Ce)},{...Fl[2],value:String(ge)},{...Fl[3],value:String(Ve)}],je=Math.ceil(we.length/f),Xe=d*f,tt=Xe-f,Ue=we.slice(tt,Xe);return{filteredOrders:we,currentOrders:Ue,totalPages:je,updatedStats:De,totalRecords:he}},[t,K,i,l,f,d,e]),{filteredOrders:Y,totalPages:le}=Q;p.useEffect(()=>{u(1)},[K,i,l,f]);const de=p.useMemo(()=>{const X=[];if(le<=7){for(let me=1;me<=le;me++)X.push(me);return X}const fe=(me,we,he)=>Math.min(Math.max(me,we),he),Oe=fe(d-1,2,le-3),Me=fe(d+1,4,le-1);X.push(1),Oe>2&&X.push("...");for(let me=Oe;me<=Me;me++)X.push(me);return Me<le-1&&X.push("..."),X.push(le),X},[d,le]),pe=p.useCallback(()=>N(!0),[]),_e=p.useCallback(()=>N(!1),[]),q=p.useCallback(()=>{v(!1),E(null)},[]),oe=p.useCallback(()=>{b(!1),C(null)},[]),ve=p.useCallback(()=>{x(!1),j(null)},[]),O=p.useCallback(X=>{E(X),v(!0)},[]),D=p.useCallback(X=>{const fe={...X,cost:Number(X[U.COST]??0)||0,price:Number(X[U.PRICE]??0)||0};C(fe),b(!0)},[]),M=p.useCallback(X=>{j(X),x(!0)},[]),I=p.useCallback(async X=>{_e();try{const fe=await fetch(`${ui}${rt.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(X)});if(!fe.ok){const Me=await fe.json();throw new Error(Me.error||"Lỗi khi tạo đơn hàng mới từ Máy chủ")}await Z();const Oe=await fe.json();O(Oe),Xi(["orders","dashboard"])}catch(fe){console.error("Lỗi khi tạo đơn hàng:",fe),alert(`Lỗi khi tạo đơn hàng: ${fe instanceof Error?fe.message:String(fe)}`)}},[_e,Z,O]),z=p.useCallback(async X=>{if(!X||!X.id)return;const fe=String(X[U.STATUS]||"").trim();let Oe=null;if(fe===tr.CHUA_THANH_TOAN?Oe={[U.STATUS]:tr.DANG_XU_LY}:fe===tr.DANG_XU_LY&&(Oe={[U.STATUS]:tr.DA_THANH_TOAN}),!!Oe)try{const Me=await fetch(`${ui}${rt.ORDER_BY_ID(X.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Oe)});if(!Me.ok){const me=await no(Me);throw new Error(me||"Lỗi khi cập nhật trạng thái từ máy chủ")}await Z(),Xi(["orders","dashboard"])}catch(Me){console.error("Lỗi khi đánh dấu đã thanh toán:",Me),alert(`Không thể đánh dấu đã thanh toán: ${Me instanceof Error?Me.message:String(Me)}`)}},[Z]),se=p.useCallback(async X=>{if(!X||!X.id)return;const fe=String(X[U.ID_ORDER]||"").trim();G(fe||null);const Oe={[U.STATUS]:tr.DANG_XU_LY};try{const Me=await fetch(`${ui}${rt.ORDER_BY_ID(X.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Oe)});if(!Me.ok){const me=await no(Me);throw new Error(me||"Loi khi cap nhat trang thai tu may chu")}await Z(),Xi(["orders","dashboard"]),alert("Da chuyen don sang Dang Xu Ly.")}catch(Me){console.error("Loi khi chuyen trang thai gia han:",Me),alert(`Khong the chuyen trang thai gia han: ${Me instanceof Error?Me.message:String(Me)}`)}finally{G(null)}},[Z]),ce=p.useCallback(async X=>{if(!(!X||!X.id))try{const fe=await fetch(`${ui}${rt.ORDER_CANCELED_REFUND(X.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!fe.ok){const Oe=await no(fe);throw new Error(Oe||"Lỗi khi xác nhận hoàn tiền từ máy chủ")}await Z(),Xi(["orders","dashboard"])}catch(fe){console.error("Lỗi khi xác nhận hoàn tiền:",fe),alert(`Lỗi khi xác nhận hoàn tiền: ${fe instanceof Error?fe.message:String(fe)}`)}},[Z]),Ae=p.useCallback(async X=>{oe();const fe={[U.ID_ORDER]:X.id_order,[U.ID_PRODUCT]:X.id_product,[U.INFORMATION_ORDER]:X.information_order,[U.CUSTOMER]:X.customer,[U.CONTACT]:X.contact,[U.SLOT]:X.slot,[U.SUPPLY]:X.supply,[U.COST]:Number(X.cost??0)||0,[U.PRICE]:Number(X.price??0)||0,[U.NOTE]:X.note,[U.STATUS]:X.status};try{const Oe=await fetch(`${ui}${rt.ORDER_BY_ID(Number(X.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(fe)});if(!Oe.ok){const Me=await no(Oe);throw new Error(Me||"Lỗi khi cập nhật đơn hàng từ Máy chủ")}await Z(),Xi(["orders","dashboard"])}catch(Oe){console.error("Lỗi khi cập nhật đơn hàng:",Oe),alert(`Lỗi khi cập nhật đơn hàng: ${Oe instanceof Error?Oe.message:String(Oe)}`)}},[oe,Z]),be=p.useCallback(async()=>{if(S){x(!1);try{const X=await fetch(`${ui}${rt.ORDER_BY_ID(S.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:S[ft.GIA_TRI_CON_LAI],gia_tri_con_lai:S[ft.GIA_TRI_CON_LAI]})});if(!X.ok){const fe=await no(X);throw new Error(fe||"Lỗi khi xóa đơn hàng từ Máy chủ")}r(fe=>fe.filter(Oe=>Oe.id!==S.id)),Xi(["orders","dashboard"])}catch(X){console.error("Lỗi khi xóa đơn hàng:",X),alert(`Lỗi khi xóa đơn hàng: ${X instanceof Error?X.message:String(X)}`)}finally{j(null)}}},[S]);return{...Q,filteredOrders:Y,paginationPages:de,searchTerm:n,setSearchTerm:a,searchField:i,setSearchField:s,statusFilter:l,setStatusFilter:c,currentPage:d,setCurrentPage:u,rowsPerPage:f,setRowsPerPage:h,isModalOpen:m,isViewModalOpen:g,isEditModalOpen:y,isCreateModalOpen:w,orderToView:_,orderToDelete:S,orderToEdit:P,openCreateModal:pe,closeCreateModal:_e,closeViewModal:q,closeEditModal:oe,closeModal:ve,handleViewOrder:O,handleEditOrder:D,handleDeleteOrder:M,handleSaveNewOrder:I,handleSaveEdit:Ae,handleConfirmRefund:ce,handleMarkPaid:z,handleRenewOrder:se,confirmDelete:be,fetchError:T,reloadOrders:Z,renewingOrderCode:W}},dE=ea.memo(function({order:t,index:r,isExpanded:n,showRemainingColumn:a,showActionButtons:i,isActiveDataset:s,isCanceled:l,totalColumns:c,renewingOrderCode:d,onToggleDetails:u,onView:f,onEdit:h,onDelete:m,onConfirmRefund:x,onMarkPaid:g,onRenew:v}){const{[ft.SO_NGAY_CON_LAI]:y,[ft.GIA_TRI_CON_LAI]:b,[ft.TRANG_THAI_TEXT]:w}=t,N=Number.isFinite(Number(t[U.COST]))?Number(t[U.COST]):0,_=Number.isFinite(Number(t[U.PRICE]))?Number(t[U.PRICE]):0,E=Number.isFinite(Number(b))?Number(b):0,S=Number.isFinite(Number(t.can_hoan))?Number(t.can_hoan):null,j=l?Math.max(0,S!==null&&Number.isFinite(E)?Math.min(S,E):S??E):E,P=tr.CHO_HOAN,C=String(w||"").trim(),T=l&&C===P,k=C===tr.CAN_GIA_HAN||C===tr.ORDER_EXPIRED,W=C===tr.CHUA_THANH_TOAN,G=C===tr.DANG_XU_LY,K=t[ft.ORDER_DATE_DISPLAY]||"",J=t[ft.EXPIRY_DATE_DISPLAY]||"",V=String(t[U.ID_ORDER]||"").trim(),Z=d===V,Q=Number.isFinite(Number(y))?Number(y):0,Y=l?"text-indigo-600":Q<=0?"text-red-600":Q<=4?"text-orange-500":"text-green-500",le=l?oo(j):Q,de=p.useCallback(()=>{t.id!==void 0&&t.id!==null&&u(t.id)},[u,t.id]),pe=_e=>q=>{q.stopPropagation(),_e(t)};return o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{onClick:de,className:`cursor-pointer transition ${r%2===0?"bg-slate-900/55":"bg-indigo-950/40"} ${n?"bg-indigo-700/25":""} hover:bg-indigo-600/25`,children:[o.jsx("td",{className:"px-4 py-4 text-sm font-medium text-white w-[150px] text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"font-bold whitespace-nowrap truncate max-w-[150px]",children:t[U.ID_ORDER]||""}),o.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[U.ID_PRODUCT]||""})]})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white w-[140px] text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"text-white/80 text-xs whitespace-nowrap truncate max-w-[150px]",children:t[U.INFORMATION_ORDER]||""}),t[U.SLOT]?o.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[U.SLOT]}):null]})}),o.jsx("td",{className:"px-4 py-4 text-sm text-white w-[150px] text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"font-medium whitespace-nowrap truncate max-w-[150px]",children:t[U.CUSTOMER]||""}),o.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",title:String(t[U.CONTACT]||""),children:t[U.CONTACT]||""})]})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm text-white w-[150px] text-center",children:K&&J?`${K} - ${J}`:K||J||""}),a&&o.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm font-bold w-[60px] text-center",children:o.jsx("span",{className:Y,children:le})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate w-[90px] text-center",children:o.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${tE(String(w||""))}`,children:String(w||"")})}),o.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-right text-sm font-medium w-[90px]",children:o.jsxs("div",{className:"flex space-x-2 justify-end",children:[o.jsx("button",{onClick:pe(f),className:"text-blue-600 hover:text-blue-900 p-1 rounded",children:o.jsx(Ts,{className:"h-4 w-4"})}),T&&o.jsx("button",{onClick:pe(x),className:"text-emerald-600 hover:text-emerald-800 p-1 rounded",title:"Xác nhận đã giải/hoàn tiền",children:o.jsx(ms,{className:"h-4 w-4"})}),s&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:pe(h),className:"text-green-600 hover:text-green-900 p-1 rounded",children:o.jsx(ps,{className:"h-4 w-4"})}),o.jsx("button",{onClick:pe(m),className:"text-red-500 hover:text-red-700 p-1 rounded",title:"Xoá đơn hàng",children:o.jsx(Na,{className:"h-4 w-4"})})]})]})})]}),n&&o.jsx("tr",{className:"bg-indigo-900/40",children:o.jsx("td",{colSpan:c,className:"px-6 pb-6 pt-0",children:o.jsxs("div",{className:"rounded-2xl border border-dashed border-indigo-200/60 bg-indigo-600/20 p-5 shadow-lg shadow-indigo-900/30",children:[o.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 text-center",children:[o.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tiết đơn hàng"}),o.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",t[U.ID_ORDER]||""]})]}),i&&o.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[W&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:pe(g),children:"Thanh Toán"}),G&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:pe(g),children:"Thanh Toán"}),k&&o.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:Z,onClick:_e=>{_e.stopPropagation(),Z||v(t)},children:Z?"Đang Gia Hạn...":"Gia Hạn"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Nguồn"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[U.SUPPLY]||"N/A"})]}),o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá nhập"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:oo(N)})]}),o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá bán"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:oo(_)})]}),o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá trị còn lại"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:oo(j)})]}),o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Số ngày"}),o.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[U.DAYS]||0})]}),o.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[o.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi chú"}),o.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:t[U.NOTE]||"Không có ghi chú."})]})]})]})})})]})});dE.displayName="OrderRow";const h$=[{value:"all",label:"Tất cả cột"},{value:U.ID_ORDER,label:"Mã Đơn Hàng"},{value:U.ID_PRODUCT,label:"Sản Phẩm"},{value:U.INFORMATION_ORDER,label:"Thông tin"},{value:U.CUSTOMER,label:"Khách Hàng"},{value:U.SLOT,label:"Slot"},{value:U.SUPPLY,label:"Nguồn"}];function m$(){const[e,t]=p.useState("active"),[r,n]=p.useState({active:0,expired:0,canceled:0}),{currentOrders:a,totalPages:i,updatedStats:s,filteredOrders:l,paginationPages:c,searchTerm:d,setSearchTerm:u,searchField:f,setSearchField:h,statusFilter:m,setStatusFilter:x,currentPage:g,setCurrentPage:v,rowsPerPage:y,setRowsPerPage:b,isModalOpen:w,isViewModalOpen:N,isEditModalOpen:_,isCreateModalOpen:E,orderToView:S,orderToDelete:j,orderToEdit:P,openCreateModal:C,closeCreateModal:T,closeViewModal:k,closeEditModal:W,closeModal:G,handleViewOrder:K,handleEditOrder:J,handleDeleteOrder:V,handleSaveNewOrder:Z,handleSaveEdit:Q,handleConfirmRefund:Y,handleMarkPaid:le,handleRenewOrder:de,confirmDelete:pe,fetchError:_e,reloadOrders:q,totalRecords:oe,renewingOrderCode:ve}=f$(e);p.useEffect(()=>{n(X=>X[e]===oe?X:{...X,[e]:oe})},[e,oe]);const O=e==="active",[D,M]=p.useState(null),I=p.useCallback(X=>{M(fe=>fe===X?null:X)},[]),z=e!=="expired",se=e!=="expired",ce=e==="canceled",Ae=ce?"Giá Trị Còn Lại":"Còn Lại",be=z?7:6;return o.jsxs("div",{className:"space-y-6",children:[_e&&o.jsxs("div",{className:"flex flex-col gap-3 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[o.jsx("span",{children:_e}),o.jsx("button",{type:"button",onClick:q,className:"rounded-md border border-red-300 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-red-700 transition hover:bg-red-100",children:"Thử Lại"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản Lý Đơn Hàng"}),o.jsx("p",{className:"mt-1 text-sm text-gray-200",children:"Quản lý và theo dõi tất cả các đơn hàng của khách hàng"})]}),o.jsx("div",{className:"mt-4 sm:mt-0",children:O&&o.jsx(Qn,{icon:ta,onClick:C,children:"Tạo Đơn Hàng Mới"})})]}),o.jsx("div",{className:"rounded-[28px] bg-gradient-to-r from-indigo-200/60 via-indigo-300/55 to-slate-200/45 p-4 shadow-[0_20px_50px_-28px_rgba(0,0,0,0.5),0_14px_32px_-24px_rgba(255,255,255,0.25)] border border-white/20",children:o.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:BB.map(X=>{const fe=X,Oe=oE[fe],Me=e===fe,me=r[fe]??0;return o.jsxs("button",{type:"button",onClick:()=>t(fe),className:`flex items-center justify-between rounded-2xl px-5 py-4 text-left transition shadow-[0_12px_28px_-16px_rgba(0,0,0,0.65),0_8px_22px_-18px_rgba(255,255,255,0.12)] ${Me?"bg-gradient-to-r from-indigo-500 via-violet-500 to-indigo-500 text-white ring-1 ring-white/25":"bg-indigo-700/70 text-indigo-100 hover:bg-indigo-600/80 ring-1 ring-white/10"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:Oe.label}),o.jsx("p",{className:"text-xs text-indigo-100/80",children:Oe.description})]}),o.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:me.toLocaleString("vi-VN")})]},X)})})}),o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(X=>o.jsx(pa,{title:X.name,value:X.value,icon:X.icon,accent:X.accent},X.name))})}),o.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Bi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Tìm kiếm đơn hàng, khách hàng...",className:"w-full pl-10 pr-44 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:d,onChange:X=>u(X.target.value)}),o.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:o.jsx("select",{className:"min-w-[140px] md:min-w-[180px] px-3 py-1.5 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:f,onChange:X=>h(X.target.value),children:h$.map(X=>o.jsx("option",{value:X.value,children:X.label},X.value))})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(OC,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsxs("select",{className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:m,onChange:X=>x(X.target.value),children:[o.jsx("option",{value:"all",children:"Tất cả trạng thái"}),o.jsx("option",{value:tr.DA_THANH_TOAN,children:"Đã thanh toán"}),o.jsx("option",{value:tr.CHUA_THANH_TOAN,children:"Chưa thanh toán"}),o.jsx("option",{value:tr.DANG_XU_LY,children:"Đang xử lý"}),o.jsx("option",{value:tr.CAN_GIA_HAN,children:"Cần gia hạn"}),o.jsx("option",{value:tr.ORDER_EXPIRED,children:"Hết hạn"})]})]})]})}),o.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-white/10 table-fixed text-white",children:[o.jsx("thead",{className:"bg-slate-900/90",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"ORDER/SẢN PHẨM"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[140px] whitespace-nowrap truncate",children:"THÔNG TIN ĐƠN HÀNG"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"KHÁCH HÀNG"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"HẠN ĐƠN HÀNG"}),z&&o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[60px] whitespace-nowrap truncate",children:Ae}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"TRẠNG THÁI"}),o.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"THAO TÁC"})]})}),o.jsx("tbody",{className:"divide-y divide-white/10",children:a.length===0?o.jsx("tr",{children:o.jsxs("td",{colSpan:be,className:"text-center py-12",children:[o.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy đơn hàng"}),o.jsx("div",{className:"text-white/60",children:"Thử thay đổi bộ lọc tìm kiếm"})]})}):a.map((X,fe)=>o.jsx(dE,{order:X,index:fe,isExpanded:D===X.id,showRemainingColumn:z,showActionButtons:se,isActiveDataset:O,isCanceled:ce,totalColumns:be,renewingOrderCode:ve,onToggleDetails:I,onView:K,onEdit:J,onDelete:V,onConfirmRefund:Y,onMarkPaid:le,onRenew:de},X.id))})]})}),l.length>0&&o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[o.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[o.jsx("span",{children:"Hiển thị"}),o.jsxs("select",{id:"rowsPerPage",value:y,onChange:X=>b(Number(X.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[o.jsx("option",{value:10,children:"10"}),o.jsx("option",{value:25,children:"25"}),o.jsx("option",{value:50,children:"50"})]}),o.jsx("span",{children:"dòng"})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[o.jsx("button",{onClick:()=>v(1),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang đầu",children:"<<"}),o.jsx("button",{onClick:()=>v(X=>Math.max(X-1,1)),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trước",children:"<"}),o.jsx("div",{className:"flex items-center gap-1",children:c.map((X,fe)=>X==="..."?o.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${fe}`):o.jsx("button",{onClick:()=>v(X),disabled:X===g,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${X===g?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:X},X))}),o.jsx("button",{onClick:()=>v(X=>Math.min(X+1,i)),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),o.jsx("button",{onClick:()=>v(i),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cuối",children:">>"})]})]})]}),o.jsx(lE,{isOpen:w,onClose:G,onConfirm:pe,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa đơn hàng: ${j?.id_order}?`}),o.jsx(zB,{isOpen:N,onClose:k,order:S,formatCurrency:oo}),o.jsx(GB,{isOpen:_,onClose:W,order:P,onSave:X=>Q(X)}),o.jsx(o$,{isOpen:E,onClose:T,onSave:X=>{Z(X)}})]})}const p$={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},zc=[{value:"information",label:"Thông tin gói"},{value:"note",label:"Ghi chú"},{value:"supplier",label:"Nhà cung cấp"},{value:"import",label:"Giá nhập (VND)"},{value:"expired",label:"Ngày hết hạn"},{value:"capacity",label:"Tổng dung lượng (GB)"}],_h=e=>e.filter(t=>t!=="capacity"),Ns=5,_s=2e3,Sh=100,x$=.2,g$=2,v$=[{value:"information",label:"Liên kết theo thông tin đơn hàng",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên các trường thông tin như tên sản phẩm, thông tin sản phẩm."},{value:"slot",label:"Liên kết theo vị trí",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên mã định danh vị trí (slot) của đơn hàng."}],Uy=[{value:"all",label:"Tất cả trạng thái"},{value:"full",label:"Còn nhiều"},{value:"low",label:"Sắp hết"},{value:"out",label:"Đã hết"}],y$=Ft.informationOrder,fE=Ft.slot,hE="package_slot_link_prefs",mE=(e,t)=>t<=0||e<=0?"out":e/t<=x$?"low":"ok",lo=e=>e<=0?"out":e<g$?"low":"ok",td=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),Hy=e=>{const t=td(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},Va=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),pE=e=>{const t=Ot(e??"");if(t)return t;const r=(e||"").trim();if(!r)return"";const n=r.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(n){const[,a,i,s]=n;return`${String(a).padStart(2,"0")}/${String(i).padStart(2,"0")}/${s}`}return r},Wy=e=>{const t=Va(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},Eh=e=>{const t=Va(e);return t?t.toLowerCase().replace(/\s+/g,""):""},b$=e=>{const t=Eh(e.informationUser||"");return t?[t]:[]},w$=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",N$=(e,t,r)=>{const n=Va(r);if(t!=="slot")return n?[n]:[];const i=(e.slotDisplay??"").split("|").map(l=>Va(l)).filter(Boolean);if(i.length>=1)return i;const s=Va(e.customerDisplay);return s?[s,`${s} (2)`]:n?[n]:[]},Ky=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},_$=(e,t)=>{let n=t.productKey;if(e){const s=n.indexOf(e);s>=0&&(n=n.slice(s+e.length))}const a=Ky(n);if(a)return a;const i=td(t.base?.id_product??"");return Ky(i)},S$=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):Sh} GB`,E$=e=>e===fE?"slot":"information",Ml=e=>e==="slot"?fE:y$,xE=e=>td(e),Gn=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},Q0=e=>e==null?"":typeof e=="string"?e:String(e),zy=(e,t,r)=>[e&&`Tài khoản: ${e}`,t&&`Mật khẩu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",T$=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):Q0(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):Q0(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:Q0(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}},C$=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(hE);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},j$=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(hE,JSON.stringify(e))}catch{}},Vy=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,a=e.match??e.matchModeValue??null,i=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,s=a?E$(a):e.slotLinkMode??(i==="slot"?"slot":"information"),l=Array.isArray(e.productCodes)?e.productCodes.map(d=>typeof d=="string"?d.trim():"").filter(d=>!!d):[],c=Array.from(new Set(l.map(d=>xE(d)).filter(Boolean)));return{...e,slot:e.slot??Ns,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:s,matchModeValue:a,productCodes:l,normalizedProductCodes:c}},A$=({row:e,showCapacityColumn:t,tableColumnCount:r,isExpanded:n,onToggle:a,onEdit:i,onView:s,onDelete:l})=>{const c=e.slotLimit||Ns,d=e.slotUsed,u=e.remainingSlots,f=c>0?Math.min(u/c*100,100):0,h=lo(u),m=h==="out"?"bg-red-500":h==="low"?"bg-yellow-500":"bg-green-500",x=e.capacityLimit||_s,g=e.capacityUsed,v=e.remainingCapacity,y=x>0?Math.min(v/x*100,100):0,b=mE(v,x),w=b==="out"?"bg-red-500":b==="low"?"bg-yellow-500":"bg-green-500",N=Math.min(d,c),_=e.slotAssignments??[],E=Array.from({length:Math.max(c,0)},(j,P)=>{const C=P+1,T=C<=N,k=_[C-1]??null;return{slotNumber:C,isUsed:T,assignment:k}}),S=t&&!!e.hasCapacityField;return o.jsxs(o.Fragment,{children:[o.jsxs("tr",{onClick:()=>a(e.id),className:`hover:bg-indigo-500/20 ${n?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.package}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.informationUser||""}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm text-white",children:[o.jsx("span",{className:"font-medium",children:d})," / ",c," Vị trí"]}),o.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:o.jsx("div",{className:`h-2 rounded-full ${m}`,style:{width:`${f}%`}})}),o.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Còn trống: ",u]})]}),t&&o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:S?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm text-white",children:[o.jsx("span",{className:"font-medium",children:g})," /"," ",x," GB"]}),o.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:o.jsx("div",{className:`h-2 rounded-full ${w}`,style:{width:`${y}%`}})}),o.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Còn trống: ",v," GB"]})]}):o.jsx("div",{className:"text-sm text-white/70 italic",children:"Không có"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.supplier||""}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[Number(e.import||0).toLocaleString("vi-VN")," VND"]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:pE(e.expired)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.note||""}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition",type:"button","aria-label":"Sửa",onClick:j=>{j.stopPropagation(),i(e)},children:o.jsx(ps,{className:"h-4 w-4"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-purple-50 text-purple-600 hover:bg-purple-100 transition",type:"button","aria-label":"Xem",onClick:j=>{j.stopPropagation(),s(e)},children:o.jsx(Ts,{className:"h-4 w-4"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-red-50 text-red-600 hover:bg-red-100 transition",type:"button","aria-label":"Xóa",onClick:j=>{j.stopPropagation(),l(e)},children:o.jsx(Na,{className:"h-4 w-4"})})]})]}),n&&o.jsx("tr",{children:o.jsx("td",{colSpan:r,className:"bg-indigo-900/30 px-6 py-4 text-white",children:o.jsxs("div",{className:"border border-dashed border-white/40 rounded-lg p-4 space-y-4 text-center",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi Tiết Các vị trí"}),o.jsxs("p",{className:"text-xs text-white/80",children:["Hiển thị ",c," vị trí - ",d," đã dùng,"," ",u," còn trống"]})]}),o.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:E.map(j=>o.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border px-3 py-2 basis-1/2 sm:basis-1/3 lg:basis-1/5 min-w-[120px] ${j.isUsed?"border-yellow-300 bg-yellow-50":"border-green-200 bg-green-50"}`,title:j.assignment?.matchValue||j.assignment?.slotLabel||void 0,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gC,{className:`h-5 w-5 ${j.isUsed?"text-yellow-500":"text-green-500"}`}),o.jsx("span",{className:"text-sm font-semibold text-gray-900 max-w-[170px] truncate",title:j.assignment?.slotLabel||(j.assignment?void 0:`vị trí ${j.slotNumber}`),children:j.assignment?.slotLabel?j.assignment.slotLabel:`vị trí ${j.slotNumber}`})]}),o.jsx("p",{className:`text-xs mt-1 ${j.isUsed?"text-yellow-700":"text-green-700"}`,children:j.assignment&&S?S$(j.assignment.capacityUnits):j.isUsed?"Đã dùng":"Còn trống"})]},j.slotNumber))})]})})})]})},k$=({rows:e,loading:t,showCapacityColumn:r,tableColumnCount:n,onEdit:a,onView:i,onDelete:s})=>{const[l,c]=p.useState(null),d=u=>{c(f=>f===u?null:u)};return o.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden text-white",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Tên Gói"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thông Tin Gói"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Số Lượng"}),r&&o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Dung Lượng"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"NCC"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Giá Nhập"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ngày Hết Hạn"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ghi Chú"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thao Tác"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?o.jsx("tr",{children:o.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"Đang Tải Dữ Liệu..."})}):e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"Không có gói nào để hiển thị."})}):e.map((u,f)=>o.jsx(A$,{row:u,showCapacityColumn:r,tableColumnCount:n,isExpanded:l===u.id,onToggle:d,onEdit:a,onView:i,onDelete:s},`${u.id}-${f}`))})]})})})},Zp=({open:e,title:t,onClose:r,children:n,footer:a})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),o.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"Ž?A3ng",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),o.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:a})]})}):null,P$=({open:e,initialName:t,initialFields:r,onClose:n,onSubmit:a,mode:i})=>{const[s,l]=p.useState(t),[c,d]=p.useState(new Set(r)),[u,f]=p.useState(null);p.useEffect(()=>{e&&(l(t),d(new Set(r)),f(null))},[e,r,t]);const h=v=>{d(y=>{const b=new Set(y);return b.has(v)?b.delete(v):b.add(v),b})},m=()=>d(new Set(zc.map(v=>v.value))),x=()=>d(new Set),g=v=>{v.preventDefault();const y=s.trim();if(!y){f("Vui lòng nhập tên loại gói.");return}if(c.size===0){f("Vui lòng chọn ít nhất một trường dữ liệu.");return}a(y,Array.from(c))};return o.jsx(Zp,{open:e,title:i==="edit"&&t?`Chỉnh sửa loại gói: ${t}`:"Tạo loại gói sản phẩm mới",onClose:n,footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy bỏ"}),o.jsx("button",{onClick:g,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:i==="create"?"Tạo Loại":"Lưu Thay Đổi"})]}),children:o.jsxs("form",{onSubmit:g,className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tên Loại Gói"}),o.jsx("input",{type:"text",value:s,onChange:v=>l(v.target.value),placeholder:"Ví dụ: Google One, Netflix, Spotify...",className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${i==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:i==="edit"}),i==="edit"&&o.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bạn chỉ có thể chỉnh sửa các trường dữ liệu, tên loại gói giữ nguyên."})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Các trường dữ liệu của loại gói này"}),o.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[o.jsx("button",{type:"button",onClick:m,className:"text-blue-600 hover:text-blue-700",children:"Chọn tất cả"}),o.jsx("button",{type:"button",onClick:x,className:"text-rose-600 hover:text-rose-700",children:"Bỏ chọn tất cả"})]})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:zc.map(v=>o.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${c.has(v.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:c.has(v.value),onChange:()=>h(v.value)}),o.jsx("span",{className:"text-sm font-medium text-gray-800",children:v.label})]},v.value))})]}),u&&o.jsx("p",{className:"text-sm text-red-600",children:u})]})})},Gy=({open:e,mode:t,template:r,initialValues:n,onClose:a,onSubmit:i})=>{const s=p.useMemo(()=>({...p$,...n??{}}),[n]),[l,c]=p.useState(s),d=p.useCallback(b=>{const w=b.replace(/[^0-9]/g,"");if(!w)return"";const N=Number(w);return Number.isFinite(N)?N.toLocaleString("vi-VN"):""},[]);p.useEffect(()=>{e&&c({...s,import:d(s.import)})},[e,s,d]);const u=(b,w)=>{const N=w.target.value;if(b==="import"){c(_=>({..._,import:d(N)}));return}c(_=>({..._,[b]:N}))},f=b=>{b.preventDefault(),i(l)},h=b=>{c(w=>({...w,slotLinkMode:b}))},x=["information","note","supplier","import","expired"].some(b=>r.fields.includes(b)),g=r.fields.includes("capacity"),v=x||g,y=x&&g;return o.jsx(Zp,{open:e,title:`${t==="add"?"Thêm Gói":"Sửa Gói"} - ${r.name}`,onClose:a,footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy"}),o.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:t==="add"?"Lưu gói":"Lưu thay đổi"})]}),children:o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[v&&o.jsxs("div",{className:`grid grid-cols-1 gap-4 ${y?"md:grid-cols-2":""}`,children:[x&&o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tiết gói"}),o.jsx("p",{className:"text-xs text-white/80",children:"Nhập các trường mô tả liên quan đến gói này."})]}),r.fields.includes("information")&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),o.jsx("input",{type:"text",value:l.informationUser,onChange:b=>u("informationUser",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),o.jsx("input",{type:"text",value:l.informationPass,onChange:b=>u("informationPass",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),o.jsx("input",{type:"email",value:l.informationMail,onChange:b=>u("informationMail",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),o.jsx("input",{type:"text",value:l.note,onChange:b=>u("note",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi chú cho gói này"})]}),r.fields.includes("supplier")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhà cung cấp"}),o.jsx("input",{type:"text",value:l.supplier,onChange:b=>u("supplier",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Giá nhập (VND)"}),o.jsx("input",{type:"text",inputMode:"numeric",value:l.import,onChange:b=>u("import",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngày hết hạn"}),o.jsx("input",{type:"date",value:l.expired,onChange:b=>u("expired",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),g&&o.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),o.jsx("p",{className:"text-xs text-white/80",children:"Cung cấp thông tin tài khoản dung lượng."})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),o.jsx("input",{type:"text",value:l.accountUser,onChange:b=>u("accountUser",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),o.jsx("input",{type:"text",value:l.accountPass,onChange:b=>u("accountPass",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),o.jsx("input",{type:"email",value:l.accountMail,onChange:b=>u("accountMail",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),o.jsx("textarea",{value:l.accountNote,onChange:b=>u("accountNote",b),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi chú cho tài khoản dung lượng"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lượng (GB)"}),o.jsx("input",{type:"number",min:0,value:l.capacity,onChange:b=>u("capacity",b),placeholder:`Mặc định: ${_s}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số vị trí (slot)"}),o.jsx("input",{type:"number",min:0,value:l.slot,onChange:b=>u("slot",b),placeholder:`Mặc định: ${Ns}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Chọn chế độ ghép lệnh"}),o.jsx("p",{className:"text-xs text-white/80",children:"Chọn phương thức kết nối giữa gói và đơn hàng."})]})}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:v$.map(b=>{const w=l.slotLinkMode===b.value;return o.jsxs("button",{type:"button",onClick:()=>h(b.value),className:`border rounded-lg p-3 text-left transition ${w?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[o.jsx("span",{className:"block text-sm font-semibold",children:b.label}),o.jsx("span",{className:"block text-xs text-white/70 mt-1",children:b.helper})]},b.value)})}),o.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[o.jsx("b",{children:"Link theo thông tin đơn hàng:"})," So khớp thông tin gói (tài khoản, mail, v.v.) với chi tiết trong đơn hàng.",o.jsx("br",{}),o.jsx("b",{children:"Link theo vị trí:"})," So khớp thông tin gói với mã vị trí (slot) khai báo trong đơn hàng.",o.jsx("br",{})]})]}),r.fields.length===0&&o.jsx("p",{className:"text-sm text-white/80",children:"Loại gói này không có trường dữ liệu nào được cấu hình."})]})})},O$=({open:e,row:t,onClose:r})=>{if(!e||!t)return null;const n=[{label:"Tài khoản",value:t.informationUser},{label:"Mật khẩu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi chú",value:t.note},{label:"Nguồn",value:t.supplier},{label:"Giá nhập",value:t.import},{label:"Ngày hết hạn",value:pE(t.expired)}],a=[{label:"Tài khoản",value:t.accountUser},{label:"Mật khẩu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi chú",value:t.accountNote}],i=!!t.hasCapacityField,s=t.capacityLimit||_s,l=t.capacityUsed||0,c=t.remainingCapacity||0,d=s>0?Math.min(c/s*100,100):0,u=mE(c,s),f=u==="out"?"bg-red-500":u==="low"?"bg-yellow-500":"bg-green-500";return o.jsx(Zp,{open:e,title:`Chi Tiết Gói: ${t.package}`,onClose:r,footer:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"Đóng"}),children:o.jsxs("div",{className:`grid grid-cols-1 gap-4 ${i?"md:grid-cols-2":""}`,children:[o.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thông tin gói"}),o.jsx("p",{className:"text-xs text-white/80",children:"Các trường dữ liệu được lưu cho gói này."})]}),o.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(h=>o.jsxs("div",{children:[o.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:h.label}),o.jsx("dd",{className:"text-sm font-medium text-white break-words",children:h.value!==null&&h.value!==void 0&&h.value!==""?h.value:"-"})]},h.label))})]}),i&&o.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),o.jsx("p",{className:"text-xs text-white/80",children:"Tổng quan về tài khoản dung lượng."})]}),o.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:a.map(h=>o.jsxs("div",{children:[o.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:h.label}),o.jsx("dd",{className:"text-sm font-medium text-white break-words",children:h.value!==null&&h.value!==void 0&&h.value!==""?h.value:"-"})]},h.label))}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"text-sm text-white",children:[o.jsx("span",{className:"font-semibold",children:l})," /"," ",s," GB"]}),o.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full ${f}`,style:{width:`${d}%`}})}),o.jsxs("div",{className:"text-xs text-white/80",children:["Còn trống: ",c," GB"]})]})]})]})})},gE=(e,t)=>{const r=e.base;return r?.id!==void 0&&r?.id!==null?`id:${r.id}`:r?.id_order!==void 0&&r?.id_order!==null?`code:${r.id_order}`:`${e.productKey||e.infoKey}-${t}`},D$=(e,t)=>{if(e.size===0)return[];const r=new Map;return e.forEach(n=>{const a=t.get(n);a?.length&&a.forEach(i=>{const s=gE(i,r.size);r.has(s)||r.set(s,i)})}),Array.from(r.values())},R$=()=>{const[e,t]=p.useState(""),[r,n]=p.useState("all"),[a,i]=p.useState("all"),[s,l]=p.useState([]),[c,d]=p.useState([]),[u,f]=p.useState([]),[h,m]=p.useState(!0),[x,g]=p.useState(!0),[v,y]=p.useState(!1),[b,w]=p.useState(()=>C$()),N=p.useRef(b),_=p.useRef(!0),E=p.useMemo(()=>zc.map(q=>q.value),[]);p.useEffect(()=>{N.current=b},[b]),p.useEffect(()=>()=>{_.current=!1},[]);const S=p.useCallback((q,oe)=>{const ve=String(q);w(O=>{if(O[ve]===oe)return O;const D={...O,[ve]:oe};return j$(D),D})},[]);p.useEffect(()=>{let q=!1;return(async()=>{try{m(!0);const oe=await Ze("/api/package-products");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const ve=await oe.json();if(!q)if(Array.isArray(ve)){const O=ve.map(D=>Vy(D,N.current));l(O)}else l([])}catch(oe){console.error("Tải sản phẩm gói thất bại:",oe),q||l([])}finally{q||m(!1)}})(),()=>{q=!0}},[]),p.useEffect(()=>{let q=!1;return(async()=>{try{g(!0),y(!1);const oe=await Ze("/api/orders");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const ve=await oe.json();q||(Array.isArray(ve)?d(ve):d([]),y(!0))}catch(oe){console.error("Tải danh sách đơn hàng thất bại:",oe),q||(d([]),y(!1))}finally{q||g(!1)}})(),()=>{q=!0}},[]);const j=p.useCallback(async()=>{if(_.current){g(!0),y(!1);try{const q=await Ze("/api/orders");if(!q.ok)throw new Error(`HTTP ${q.status}`);const oe=await q.json();if(!_.current)return;Array.isArray(oe)?d(oe):d([]),y(!0)}catch(q){console.error("Failed to refresh orders for packages:",q),_.current&&(d([]),y(!1))}finally{_.current&&g(!1)}}},[]);p.useEffect(()=>d$(["orders"],()=>void j()),[j]);const P=p.useMemo(()=>Array.from(new Set(s.map(q=>q.package))).sort(),[s]);p.useEffect(()=>{f(q=>{const oe=new Map(q.map(O=>[O.name,O]));let ve=!1;return P.forEach(O=>{if(!O)return;const D=s.some(I=>I.package===O&&I.hasCapacityField),M=oe.get(O);if(!M){const I=D?E:_h(E);oe.set(O,{name:O,fields:I,isCustom:!1}),ve=!0;return}if(M.isCustom!==!0&&!D&&M.fields.includes("capacity")){const I=_h(M.fields);oe.set(O,{...M,fields:I}),ve=!0}}),ve?Array.from(oe.values()).sort((O,D)=>O.name.localeCompare(D.name)):q})},[P,s,E]);const C=p.useMemo(()=>c.map(q=>{const oe=Hy(q.id_product??""),ve=Hy(q.information_order??"");return{base:q,productKey:oe.normalized,productLettersKey:oe.lettersOnly,infoKey:ve.normalized,infoLettersKey:ve.lettersOnly,slotDisplay:Va(q.slot),slotKey:Wy(q.slot),slotMatchKey:Eh(q.slot),informationDisplay:Va(q.information_order),informationKey:Wy(q.information_order),informationMatchKey:Eh(q.information_order),customerDisplay:Va(q.customer),productCodeNormalized:xE(q.id_product)}}),[c]),T=p.useMemo(()=>{const q=new Map;return C.forEach(oe=>{if(!oe.productCodeNormalized)return;const ve=oe.productCodeNormalized;q.has(ve)||q.set(ve,[]),q.get(ve).push(oe)}),q},[C]),k=p.useMemo(()=>s.map(q=>{const oe=!!q.hasCapacityField,ve=Gn(q.slot),O=ve&&ve>0?Math.floor(ve):Ns,D=Gn(q.slotUsed),M=td(q.package),I=M.replace(/[0-9]/g,""),se=(q.slotLinkMode??"information")==="information"?"slot":"information",ce=se==="slot"?"information":"slot",Ae=b$(q),be=q.normalizedProductCodes??[],X=be.length>0?new Set(be):null,fe=v&&C.length>0&&(X?.size||M.length>0),Oe=Be=>!X||X.size===0?!1:!!Be.productCodeNormalized&&X.has(Be.productCodeNormalized),Me=Be=>{if(!M)return!1;const it=!!Be.productKey&&(Be.productKey.startsWith(M)||Be.productKey.includes(M))||!!I&&!!Be.productLettersKey&&(Be.productLettersKey.startsWith(I)||Be.productLettersKey.includes(I)),ue=!!Be.infoKey&&(Be.infoKey.startsWith(M)||Be.infoKey.includes(M))||!!I&&!!Be.infoLettersKey&&(Be.infoLettersKey.startsWith(I)||Be.infoLettersKey.includes(I));return it||ue},me=Be=>Oe(Be)||Me(Be),we=Be=>{if(Ae.length===0)return!0;const it=ce==="slot"?Be.slotMatchKey:Be.informationMatchKey;return it?Ae.some(ue=>ue===it||ue.includes(it)||it.includes(ue)):!1},he=fe&&X?.size?D$(X,T):null,Ce=fe?(()=>{const Be=new Map,it=ue=>{const Ie=gE(ue,Be.size);Be.has(Ie)||Be.set(Ie,ue)};return he?.forEach(it),C.forEach(ue=>{me(ue)&&it(ue)}),Array.from(Be.values()).filter(ue=>we(ue))})():[],ge=new Set,Ve=[];fe&&Ce.forEach(Be=>{const it=w$(Be,se),Ie=(ce==="slot"?Be.slotDisplay:Be.informationDisplay)||Be.customerDisplay||"",Ge=Be.base?.id!==void 0&&Be.base?.id!==null?`id:${Be.base.id}`:Be.base?.id_order!==void 0&&Be.base?.id_order!==null?`code:${Be.base.id_order}`:`${Ie}-${Ve.length}`;if(ge.has(Ge))return;ge.add(Ge);const Ye=it||Ie,qe=N$(Be,se,Ye);if(qe.length===0)return;const ut=oe?_$(M,Be):null;qe.forEach(Bt=>{const Nt=Bt||Ye||"";Nt&&Ve.push({slotLabel:Nt,matchValue:Ie||Nt,sourceOrderId:Be.base?.id??null,sourceOrderCode:Be.base?.id_order??null,displayColumn:se,matchColumn:ce,capacityUnits:ut})})});const De=Ve.length>0?Ve.length:D!==null?Math.max(Math.floor(D),0):0,je=Math.min(De,O),Xe=Math.max(O-je,0);let tt=0,Ue=0,Le=0;if(oe){const Be=Gn(q.capacity);tt=Be&&Be>0?Math.floor(Be):_s;const it=Gn(q.capacityUsed),ue=Ve.length>0?Ve.reduce((Ge,Ye)=>Ge+(Ye.capacityUnits??Sh),0):De*Sh,Ie=Math.min(ue,tt);Ue=Math.min(Math.max(it!==null?Math.floor(it):Ie,0),tt),Le=Math.max(tt-Ue,0)}const dt=fe?Ce.map(Be=>Be.base):[];return{...q,slotUsed:je,slotLimit:O,remainingSlots:Xe,capacityLimit:tt,capacityUsed:Ue,remainingCapacity:Le,slotAssignments:Ve,matchedOrders:dt,packageCode:M,hasCapacityField:oe,productCodes:q.productCodes??[],normalizedProductCodes:be,matchModeValue:q.matchModeValue??q.match??null}}),[s,C,v,T]),W=r!=="all"?r:null,G=p.useMemo(()=>W?u.find(q=>q.name===W)??null:null,[u,W]),K=p.useMemo(()=>W?k.filter(q=>q.package===W):k,[k,W]),J=p.useMemo(()=>K.filter(q=>{const oe=e.trim().toLowerCase(),ve=[q.information,q.informationUser,q.informationMail,q.informationPass,q.accountUser,q.accountMail,q.accountPass,q.note],O=oe.length===0||ve.some(z=>(z==null?"":String(z)).toLowerCase().includes(oe)),D=r==="all"||q.package===r,M=lo(q.remainingSlots);return O&&D&&(a==="all"||a==="full"&&M==="ok"||a===M)}),[K,e,r,a]),V=p.useMemo(()=>[...J].sort((q,oe)=>{const ve=Number(q.remainingSlots),O=Number(oe.remainingSlots),D=Number.isFinite(ve)?ve:Number.POSITIVE_INFINITY,M=Number.isFinite(O)?O:Number.POSITIVE_INFINITY,I=D<=0?Number.POSITIVE_INFINITY:D,z=M<=0?Number.POSITIVE_INFINITY:M;return I===z?0:I-z}),[J]),Q=J.some(q=>q.hasCapacityField??!1)||J.length===0&&(G?.fields.includes("capacity")??!1),Y=Q?9:8,le=p.useMemo(()=>{const q=K.reduce((ve,O)=>lo(O.remainingSlots)==="low"?ve+1:ve,0),oe=K.reduce((ve,O)=>lo(O.remainingSlots)==="out"?ve+1:ve,0);return{total:K.length,low:q,out:oe}},[K]),de=p.useMemo(()=>{const q=new Set;return k.forEach(oe=>{const ve=(oe.package||"").trim();ve&&q.add(ve)}),u.forEach(oe=>{oe.name&&q.add(oe.name)}),Array.from(q).sort((oe,ve)=>oe.localeCompare(ve))},[k,u]),pe=p.useMemo(()=>{const q=new Map;return de.forEach(oe=>q.set(oe,{total:0,low:0,out:0})),k.forEach(oe=>{const ve=(oe.package||"").trim();if(!ve)return;const O=q.get(ve);if(!O)return;O.total+=1;const D=lo(oe.remainingSlots);D==="low"&&(O.low+=1),D==="out"&&(O.out+=1)}),de.map(oe=>({name:oe,...q.get(oe)??{total:0,low:0,out:0}}))},[de,k]),_e=p.useCallback(q=>Vy(q,N.current),[]);return{data:{rows:s,templates:u,computedRows:k,filteredRows:J,sortedRows:V,scopedRows:K,selectedPackage:W,selectedTemplate:G,packageSummaries:pe,slotStats:le,showCapacityColumn:Q,tableColumnCount:Y,loading:h||x,packagesLoading:h,ordersLoading:x,ordersReady:v,defaultTemplateFields:E},filters:{searchTerm:e,categoryFilter:r,statusFilter:a},actions:{setSearchTerm:t,setCategoryFilter:n,setStatusFilter:i,setRows:l,setTemplates:f,persistSlotLinkPreference:S,applySlotLinkPrefs:_e}}},Yy=[{border:"border-sky-100/70",glow:"from-sky-100/80 via-white/80 to-blue-100/70",link:"text-sky-600 hover:text-sky-700"},{border:"border-emerald-100/70",glow:"from-emerald-100/80 via-white/80 to-lime-100/70",link:"text-emerald-600 hover:text-emerald-700"},{border:"border-violet-100/70",glow:"from-violet-100/80 via-white/80 to-fuchsia-100/70",link:"text-violet-600 hover:text-violet-700"},{border:"border-amber-100/70",glow:"from-amber-100/80 via-white/80 to-orange-100/70",link:"text-amber-600 hover:text-amber-700"}],I$=()=>{const{data:{templates:e,filteredRows:t,sortedRows:r,selectedPackage:n,selectedTemplate:a,packageSummaries:i,slotStats:s,showCapacityColumn:l,tableColumnCount:c,loading:d,defaultTemplateFields:u},filters:{searchTerm:f,categoryFilter:h,statusFilter:m},actions:{setSearchTerm:x,setCategoryFilter:g,setStatusFilter:v,setRows:y,setTemplates:b,persistSlotLinkPreference:w,applySlotLinkPrefs:N}}=R$(),[_,E]=p.useState(!1),[S,j]=p.useState(""),[P,C]=p.useState(zc.map(ue=>ue.value)),[T,k]=p.useState("create"),[W,G]=p.useState(!1),[K,J]=p.useState(!1),[V,Z]=p.useState(null),[Q,Y]=p.useState(!1),[le,de]=p.useState(null),[pe,_e]=p.useState(!1),[q,oe]=p.useState(!1),[ve,O]=p.useState(new Set),[D,M]=p.useState(null),[I,z]=p.useState(!1),[se,ce]=p.useState(null),Ae=Bh(),be=Qb();p.useEffect(()=>{const Ge=new URLSearchParams(Ae.search).get("package")||"all";g(Ye=>Ye===Ge?Ye:Ge)},[Ae.search,g]);const X=p.useCallback(ue=>{const Ie=ue==="all"||h===ue?"all":ue;Ie!==h&&g(Ie);const Ge=new URLSearchParams(Ae.search);Ie==="all"?Ge.delete("package"):Ge.set("package",Ie);const Ye=Ge.toString(),qe=Ye?`?${Ye}`:"";qe!==Ae.search&&be({pathname:Ae.pathname,search:qe},{replace:!0})},[h,Ae.pathname,Ae.search,be,g]),fe=()=>{if(n&&a){Me({name:n,fields:a.fields,mode:"edit"});return}Me()},Oe=()=>{if(n){if(!a){Me({name:n,fields:u,mode:"create"});return}G(!0)}},Me=p.useCallback(ue=>{j(ue?.name??""),C(ue?.fields&&ue.fields.length>0?ue.fields:u),k(ue?.mode??"create"),E(!0)},[u]),me=p.useCallback((ue,Ie)=>{const Ge=ue.trim();Ge&&(b(Ye=>{const qe=Ye.filter(ut=>ut.name!==Ge);return qe.push({name:Ge,fields:Ie,isCustom:!0}),qe.sort((ut,Bt)=>ut.name.localeCompare(Bt.name))}),E(!1),X(Ge))},[X,b]),we=p.useCallback(ue=>{const Ie=e.find(Ge=>Ge.name===ue)??null;Me({name:ue,fields:Ie?.fields??u,mode:"edit"})},[e,Me,u]),he=p.useCallback(()=>{_e(!1),O(new Set)},[]),Ce=p.useCallback(ue=>{const Ie=ue.trim();Ie&&O(Ge=>{const Ye=new Set(Ge);return Ye.has(Ie)?Ye.delete(Ie):Ye.add(Ie),Ye})},[]),ge=p.useCallback(async()=>{if(ve.size===0){he();return}oe(!0);const ue=Array.from(ve);try{const Ie=await Ze("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:ue})});if(!Ie.ok){const qe=await Ie.text();throw new Error(qe||`HTTP ${Ie.status}`)}const Ge=await Ie.json().catch(()=>({})),Ye=Array.isArray(Ge.deletedNames)?Ge.deletedNames:ue;y(qe=>qe.filter(ut=>!Ye.includes((ut.package||"").trim()))),b(qe=>qe.filter(ut=>!Ye.includes(ut.name))),n&&Ye.includes(n)&&X("all")}catch(Ie){console.error("Xóa nhóm thất bại:",Ie),alert(`Xóa nhóm thất bại: ${Ie instanceof Error?Ie.message:"Lỗi không xác định"}`)}finally{oe(!1),he()}},[ve,he,n,X,y,b]),Ve=p.useCallback(ue=>{const Ie=e.find(Ge=>Ge.name===ue.package)??{name:ue.package,fields:ue.hasCapacityField?u:_h(u),isCustom:!1};Z({rowId:ue.id,template:Ie,initialValues:T$(ue),accountStorageId:ue.accountStorageId??null}),J(!0)},[e,u]),De=p.useCallback(()=>{J(!1),Z(null)},[]),je=p.useCallback(ue=>{de(ue),Y(!0)},[]),Xe=p.useCallback(()=>{Y(!1),de(null)},[]),tt=p.useCallback(ue=>{ce(null),M(ue)},[]),Ue=p.useCallback(()=>{z(!1),ce(null),M(null)},[]),Le=p.useCallback(async()=>{if(!D||I)return;const ue=D.id,Ie=(D.package||"").trim();if(ue==null){ce("Không tìm thấy ID gói để xóa.");return}z(!0);const Ge=async Ye=>{const qe=await Ye.text().catch(()=>""),ut=qe?qe.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim():"",Bt=Ye.status?` (HTTP ${Ye.status})`:"",Nt=ut||Ye.statusText||"Không thể thực hiện xóa trên máy chủ";throw new Error(`Không thể xóa gói${Bt}: ${Nt}`)};try{const Ye=await Ze(`/api/package-products/${ue}`,{method:"DELETE"});Ye.ok||await Ge(Ye);const qe=await Ye.json().catch(()=>({}));console.log("Delete package product response",{targetId:ue,targetName:Ie,data:qe});const ut=new Set((qe.deletedIds&&qe.deletedIds.length?qe.deletedIds:[ue]).map(Bt=>String(Bt)));y(Bt=>Bt.filter(Nt=>{const Gr=Nt.id!==void 0&&Nt.id!==null?String(Nt.id):"__";return!ut.has(Gr)})),Ue()}catch(Ye){console.error("Xóa gói thất bại:",Ye),ce(Ye instanceof Error?Ye.message:"Lỗi không xác định"),z(!1)}},[I,D,y,b,n,X,Ue,ce]),dt=p.useCallback(async ue=>{if(!a)return;const Ie=a.fields.includes("capacity"),Ge=a.fields.includes("information"),Ye=a.fields.includes("note"),qe=a.fields.includes("supplier"),ut=a.fields.includes("import"),Bt=Gn(ue.slot),Nt=Bt!==null&&Bt>0?Math.floor(Bt):Ns,Gr=Gn(ue.capacity),wr=Gr!==null&&Gr>0?Math.floor(Gr):_s,Ma=Ge?zy(ue.informationUser||null,ue.informationPass||null,ue.informationMail||null):"",Hn={packageName:a.name,informationUser:Ge&&ue.informationUser||null,informationPass:Ge&&ue.informationPass||null,informationMail:Ge&&ue.informationMail||null,note:Ye&&ue.note||null,supplier:qe&&ue.supplier||null,importPrice:ut?Gn(ue.import)??0:null,accountUser:Ie&&ue.accountUser||null,accountPass:Ie&&ue.accountPass||null,accountMail:Ie&&ue.accountMail||null,accountNote:Ie&&ue.accountNote||null,capacity:Ie?wr:null,hasCapacityField:Ie,expired:ue.expired||null,slotLimit:Nt,matchMode:Ml(ue.slotLinkMode)};try{const Yr=await Ze("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Hn)});if(!Yr.ok)throw new Error(`HTTP ${Yr.status}`);const Dn=await Yr.json(),Ws=N({...Dn,slot:Nt,slotUsed:0,capacity:Ie?wr:Dn.capacity,information:Ge?Ma||null:Dn.information,match:Dn.match??Ml(ue.slotLinkMode),hasCapacityField:Ie});y(sa=>[...sa,Ws]),Dn.id!==void 0&&Dn.id!==null&&w(Dn.id,ue.slotLinkMode),G(!1)}catch(Yr){console.error("Lỗi khi tạo gói sản phẩm:",Yr)}},[a,N,y,w]),Be=p.useCallback(async ue=>{if(!V)return;const{template:Ie,rowId:Ge,accountStorageId:Ye}=V,qe=Ie.fields.includes("capacity"),ut=Ie.fields.includes("information"),Bt=Ie.fields.includes("note"),Nt=Ie.fields.includes("supplier"),Gr=Ie.fields.includes("import"),wr=Gn(ue.slot),Ma=wr!==null&&wr>0?Math.floor(wr):Ns,Hn=Gn(ue.capacity),Yr=Hn!==null&&Hn>0?Math.floor(Hn):_s,Dn=ut?zy(ue.informationUser||null,ue.informationPass||null,ue.informationMail||null):"",Ws={packageName:Ie.name,informationUser:ut&&ue.informationUser||null,informationPass:ut&&ue.informationPass||null,informationMail:ut&&ue.informationMail||null,note:Bt&&ue.note||null,supplier:Nt&&ue.supplier||null,importPrice:Gr?Gn(ue.import)??0:null,expired:ue.expired||null,slotLimit:Ma,accountStorageId:Ye??null,accountUser:qe&&ue.accountUser||null,accountPass:qe&&ue.accountPass||null,accountMail:qe&&ue.accountMail||null,accountNote:qe&&ue.accountNote||null,capacity:qe?Yr:null,hasCapacityField:qe,matchMode:Ml(ue.slotLinkMode)};try{const sa=await Ze(`/api/package-products/${Ge}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ws)});if(!sa.ok)throw new Error(`HTTP ${sa.status}`);const La=await sa.json(),hd=N({...La,slot:Ma,capacity:qe?Yr:La.capacity,information:ut?Dn||null:La.information,match:La.match??Ml(ue.slotLinkMode),hasCapacityField:qe});y(md=>md.map(pl=>pl.id===Ge?hd:pl)),w(Ge,ue.slotLinkMode),De()}catch(sa){console.error(`Cập nhật Gói Sản Phẩm ${Ge} Lỗi:`,sa)}},[V,De,N,y,w]),it=p.useMemo(()=>[{name:"Tổng",value:String(s.total),icon:ms,accent:xr.sky},{name:"Gói sắp hết",value:String(s.low),icon:zh,accent:xr.amber},{name:"Gói đã hết",value:String(s.out),icon:Uh,accent:xr.rose},{name:"Thêm hôm nay",value:"0",icon:wo,accent:xr.emerald}],[s]);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản lý Gói Sản phẩm"}),o.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Quản lý các loại gói sản phẩm và các gói con."})]}),o.jsxs("div",{className:"mt-4 sm:mt-0 flex flex-wrap gap-3",children:[pe?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:ge,className:"flex items-center justify-center gap-1 rounded-lg bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-600 transition disabled:opacity-60",disabled:q,title:"Xác nhận xóa",children:o.jsx(Ga,{className:"h-5 w-5"})}),o.jsx("button",{type:"button",onClick:he,className:"flex items-center justify-center gap-1 rounded-lg bg-white/20 px-3 py-2 text-sm font-semibold text-gray-800 shadow hover:bg-gray-300 transition disabled:opacity-60",disabled:q,title:"Hủy xóa",children:o.jsx(Dt,{className:"h-5 w-5"})})]}):o.jsx(Qn,{icon:Na,onClick:()=>{_e(!0),O(new Set)},disabled:q,children:"Xóa Loại gói"}),o.jsx(Qn,{icon:ta,onClick:fe,children:"Tạo Loại Gói"}),o.jsx(Qn,{icon:ta,onClick:Oe,disabled:!n,children:"Thêm Gói"})]})]}),o.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-white/5 via-indigo-900/35 to-indigo-950/55 border border-white/10 p-6 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:it.map(ue=>o.jsx(pa,{title:ue.name,value:ue.value,icon:ue.icon,accent:ue.accent},ue.name))})}),o.jsxs("div",{className:"bg-white/10 rounded-xl shadow-sm p-6 text-white",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tổng quan các loại gói"}),o.jsx("p",{className:"text-sm text-white/80",children:"Chọn một loại gói để xem chi tiết hoặc xóa."})]})}),i.length===0?o.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Không có loại gói nào được tìm thấy."}):o.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:i.map((ue,Ie)=>{const Ge=ue.name===n,Ye=Yy[Ie%Yy.length],qe=ve.has(ue.name.trim());return o.jsxs("div",{className:`relative isolate rounded-3xl border ${Ye.border} bg-white/80 p-5 text-white shadow-[0_20px_50px_-35px_rgba(15,23,42,0.7)] backdrop-blur transition duration-200 ${Ge?"ring-2 ring-blue-400 shadow-[0_25px_65px_-35px_rgba(37,99,235,0.7)]":"hover:shadow-[0_30px_75px_-40px_rgba(15,23,42,0.55)]"}`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/70",children:"Loại Gói"}),o.jsx("h3",{className:"text-lg font-semibold",children:ue.name}),o.jsxs("p",{className:"mt-1 text-sm text-white/80",children:["Số lượng gói: ",ue.total]})]}),pe?o.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:qe,disabled:q,onChange:()=>Ce(ue.name)}),"Chọn để xóa"]}):o.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:()=>X(ue.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${Ge?"text-blue-300":"text-white/80"}`,title:"Xem chi tiết",children:o.jsx(Ts,{className:"h-5 w-5"})}),o.jsx("button",{type:"button",onClick:()=>we(ue.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chỉnh sửa Loại Gói",children:o.jsx(ps,{className:"h-5 w-5"})})]})})]}),o.jsxs("dl",{className:"mt-5 grid grid-cols-3 gap-4 text-sm",children:[o.jsxs("div",{className:"rounded-2xl border border-white/60 bg-white/70 p-3 text-center shadow-inner",children:[o.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tổng"}),o.jsx("dd",{className:"mt-1 text-2xl font-bold text-white",children:ue.total})]}),o.jsxs("div",{className:"rounded-2xl border border-amber-100/70 bg-amber-50/60 p-3 text-center shadow-inner",children:[o.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-amber-600",children:"Sắp hết"}),o.jsx("dd",{className:"mt-1 text-2xl font-bold text-amber-500",children:ue.low})]}),o.jsxs("div",{className:"rounded-2xl border border-rose-100/70 bg-rose-50/60 p-3 text-center shadow-inner",children:[o.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-rose-600",children:"Hết"}),o.jsx("dd",{className:"mt-1 text-2xl font-bold text-rose-500",children:ue.out})]})]})]},ue.name)})})]}),n&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-3",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[o.jsxs("div",{className:"relative",children:[o.jsx(Bi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:`Tìm kiếm trong các gói của ${n}...`,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 placeholder:text-gray-400",value:f,onChange:ue=>x(ue.target.value)})]}),o.jsx("select",{className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900",value:m,onChange:ue=>v(ue.target.value),children:Uy.map(ue=>o.jsx("option",{value:ue.value,children:ue.label},ue.value))}),o.jsx("button",{className:`px-4 py-2 rounded-lg transition-colors ${t.length?"bg-gray-100 text-gray-800 hover:bg-indigo-50":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,disabled:!t.length,children:"Xuất Excel"})]}),o.jsxs("div",{className:"text-sm text-white/80",children:["Đang xem loại gói:"," ",o.jsx("span",{className:"font-medium text-white",children:n??"Tất cả"}),m!=="all"&&o.jsxs(o.Fragment,{children:[" ","›"," ",o.jsx("span",{className:"font-medium text-white",children:Uy.find(ue=>ue.value===m)?.label})]})]})]}),o.jsx(k$,{rows:r,loading:d,showCapacityColumn:l,tableColumnCount:c,onEdit:Ve,onView:je,onDelete:tt})]}),o.jsx(P$,{open:_,initialName:S,initialFields:P,mode:T,onClose:()=>E(!1),onSubmit:me}),a&&o.jsx(Gy,{mode:"add",open:W,template:a,onClose:()=>G(!1),onSubmit:dt}),K&&V&&o.jsx(Gy,{mode:"edit",open:K,template:V.template,initialValues:V.initialValues,onClose:De,onSubmit:Be}),o.jsx(O$,{open:Q,row:le,onClose:Xe}),o.jsx(lE,{isOpen:!!D,onClose:Ue,onConfirm:Le,title:"Xác nhận xóa gói",message:`Bạn có chắc muốn xóa gói "${D?.package}"?`,secondaryMessage:se||void 0,confirmLabel:"OK",cancelLabel:"Hủy",isSubmitting:I})]})},F$=({searchTerm:e,onSearchChange:t,onAddClick:r,onAddCategoryClick:n})=>o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsxs("div",{className:"relative flex-1 min-w-[220px] max-w-xl",children:[o.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên hoặc mã sản phẩm...",className:"w-full bg-[#0f1729] border border-white/10 text-white placeholder:text-white/50 rounded-lg pl-10 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:e,onChange:a=>t(a.target.value)}),o.jsx(Bi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"})]}),o.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold rounded-lg shadow",onClick:r,type:"button",children:"Thêm Sản Phẩm Mới"}),n&&o.jsx("button",{className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white text-sm font-semibold rounded-lg shadow",onClick:n,type:"button",children:"Thêm Danh Mục"})]}),M$=({viewMode:e,onViewModeChange:t})=>o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("button",{type:"button",onClick:()=>t("products"),"aria-pressed":e==="products",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="products"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[o.jsx("p",{className:"text-lg font-semibold text-white",children:"Sản phẩm"}),o.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Hiển thị thông tin sản phẩm"})]}),o.jsxs("button",{type:"button",onClick:()=>t("categories"),"aria-pressed":e==="categories",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="categories"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[o.jsx("p",{className:"text-lg font-semibold text-white",children:"Danh mục"}),o.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Danh sách sản phẩm theo danh mục"})]})]}),Th=(e,t,r)=>Math.min(Math.max(e,t),r),L$=(e,t)=>{const r=[];if(e<=5){for(let i=1;i<=e;i++)r.push(i);return r}const n=Th(t-1,2,e-3),a=Th(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let i=n;i<=a;i++)r.push(i);return a<e-1&&r.push("..."),r.push(e),r};function B$({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:a=""}){const i=r>0?r:10,s=Math.max(1,Math.ceil(t/i)),l=Th(e,1,s),c=l>1,d=l<s,u="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition disabled:opacity-40 disabled:cursor-not-allowed",f="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition",h="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]",m=t===0?0:(l-1)*i+1,x=Math.min(l*i,t),g=L$(s,l);return o.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${a}`,children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("button",{className:u,onClick:()=>n(1),disabled:!c,children:"<<"}),o.jsx("button",{className:u,onClick:()=>n(l-1),disabled:!c,children:"<"}),o.jsx("div",{className:"flex items-center gap-1.5",children:g.map((v,y)=>v==="..."?o.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${y}`):o.jsx("button",{className:`${f} ${v===l?h:""}`,onClick:()=>n(v),disabled:v===l,children:v},v))}),o.jsx("button",{className:u,onClick:()=>n(l+1),disabled:!d,children:">"}),o.jsx("button",{className:u,onClick:()=>n(s),disabled:!d,children:">>"})]}),o.jsx("div",{className:"text-white/70",children:t===0?"0 mục":`${m}-${x} trong ${t}`})]})}const rc=10,$$=e=>{const t=e.trim();return t?t.slice(0,2).toUpperCase():"--"},zt=e=>e?e.replace(/--\d+m$/i,"").trim():"",en=e=>(e||"").replace(/\n/g,"<br/>"),qi=e=>zt(e).toLowerCase(),ef=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),co=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),a=s=>{if(s.nodeType===Node.TEXT_NODE)return ef(s.textContent||"");if(s.nodeType===Node.ELEMENT_NODE){const l=s;if(l.tagName==="BR")return"<br/>";if(l.tagName==="A"){const d=l.getAttribute("href")||"#",u=ef(d),f=Array.from(l.childNodes).map(a).join("");return`<a href="${u}" title="${u}" target="_blank" rel="noopener noreferrer">${f}</a>`}const c=Array.from(l.childNodes).map(a).join("");return n.has(l.tagName)?`${c}<br/>`:c}return""};return Array.from(r.body.childNodes).map(a).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return ef(e)}},U$=e=>e?co(e):"",tf=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=/(Thông tin\s*&\s*tên sản phẩm|thông tin sản phẩm|mô tả|nội dung|tên sản phẩm)/i,i=n.match(a),s=l=>l.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(i&&(i.index??0)>=3){const l=i.index??0,c=r.slice(0,l).trim(),d=r.slice(l).trim();return{rulesHtml:s(c),descriptionHtml:s(d)}}return{rulesHtml:e||"",descriptionHtml:t||""}},H$=(e,t,r)=>{const n=(r||"").toLowerCase().trim(),a=new Map;t.forEach(l=>{const c=qi(l.san_pham||""),d=qi(l.package_product||"");[c,d].filter(Boolean).forEach(f=>{a.has(f)||a.set(f,l)})});const i=new Map;for(const l of e){const c=qi(l.productId||""),d=c?a.get(c):null,u={...l,priceId:d?.id??null,productId:zt(l.productId||""),productName:l.productName||(d?zt(d.package_product||d.san_pham||""):null)||l.productId,packageProduct:d?zt(d.package_product||d.san_pham||""):null,packageName:d?zt(d.package||d.san_pham||""):null,category:d?.category??null,categories:Array.isArray(d?.categories)?d?.categories??[]:[],imageUrl:l.imageUrl??d?.image_url??null,packageImageUrl:d?.image_url??null,rulesHtml:l.rulesHtml||en(l.rules||""),descriptionHtml:l.descriptionHtml||en(l.description||"")},f=c||qi(u.productName||"");f&&(i.has(f)||i.set(f,u))}for(const l of t){const c=qi(l.san_pham||""),d=qi(l.package_product||""),u=c||d,f=c&&i.has(c)||d&&i.has(d);!u||f||i.set(u,{id:l.id,priceId:l.id,productId:zt(l.san_pham||""),productName:zt(l.package_product||l.san_pham||""),packageProduct:zt(l.package_product||l.san_pham||""),packageName:zt(l.package||""),category:l.category??null,categories:Array.isArray(l.categories)?l.categories??[]:[],rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:null})}let s=Array.from(i.values());return n&&(s=s.filter(l=>`${l.productId||""} ${l.productName||""} ${l.description||""} ${l.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),s},W$=({item:e,size:t="small"})=>{const r=e.productName||e.productId||"--",n=$$(r),a=t==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs",i="rounded-md bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold";return e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:r,className:`${a} rounded-md object-cover`,onError:s=>{s.currentTarget.style.display="none"}}):o.jsx("div",{className:`${a} ${i}`,children:o.jsx("span",{children:n})})},K$=({item:e,isExpanded:t,onToggle:r,onEdit:n})=>{const a=e.packageProduct||e.productName||e.productId||"--",i=(e.packageName||"").trim(),s=e.rulesHtml||en(e.rules||""),l=e.descriptionHtml||en(e.description||""),{rulesHtml:c,descriptionHtml:d}=tf(s,l),u=co(c)||"Không có thông tin bán hàng",f=co(d||en(e.description||""))||"Không có thông tin sản phẩm";return o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{className:`hover:bg-white/5 cursor-pointer ${t?"bg-white/5":""}`,onClick:()=>r(t?null:Number(e.id)),children:[o.jsx("td",{className:"px-4 py-3",children:e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:a,className:"h-12 w-12 rounded-lg object-cover",onError:h=>{h.currentTarget.src="https://via.placeholder.com/48?text=No+Image"}}):o.jsx("div",{className:"h-12 w-12 rounded-lg bg-gray-700 flex items-center justify-center text-white/50 text-xs",children:"No Image"})}),o.jsx("td",{className:"px-4 py-3 text-white",children:o.jsx("div",{className:"flex flex-col",children:o.jsx("span",{className:"font-semibold text-white",children:zt(e.productId||"")||"--"})})}),o.jsx("td",{className:"px-4 py-3 text-white",children:zt(a)||"--"}),o.jsx("td",{className:"px-4 py-3 text-white/80 border-r border-white/10 min-w-[160px]",children:o.jsx("span",{className:"block truncate",title:i||void 0,children:i||"--"})}),o.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:o.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.rulesHtml?void 0:e.rules||"",dangerouslySetInnerHTML:{__html:u}})}),o.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:o.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.descriptionHtml?void 0:e.description||"",dangerouslySetInnerHTML:{__html:f}})}),o.jsxs("td",{className:"px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",children:o.jsx(Ts,{className:"h-5 w-5 text-blue-400"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Sửa",type:"button",onClick:h=>{h.stopPropagation(),n(e)},children:o.jsx(zo,{className:"h-5 w-5 text-green-400"})}),o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xóa",type:"button",children:o.jsx(Na,{className:"h-5 w-5 text-red-400"})})]})]}),t&&o.jsx("tr",{className:"bg-white/5",children:o.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin chi tiết"}),o.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:zt(e.packageProduct||e.productName||e.productId||"")||"Không có thông tin chi tiết."})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[o.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:o.jsx(W$,{item:e,size:"large"})}),o.jsxs("div",{className:"flex-1 space-y-3",children:[o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy tắc bán hàng"}),o.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:co(tf(e.rulesHtml||en(e.rules||""),e.descriptionHtml||en(e.description||"")).rulesHtml)||"Không có quy tắc bán hàng."}})]}),o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:co(tf(e.rulesHtml||en(e.rules||""),e.descriptionHtml||en(e.description||"")).descriptionHtml||en(e.description||""))||"Không có thông tin sản phẩm."}})]})]})]})]})})]},`${e.id}-${e.productId}`)},z$=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,expandedId:s,onToggleExpand:l,onEdit:c})=>o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-[#0b1220] shadow-xl overflow-hidden",children:[o.jsxs("div",{className:"border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sản phẩm"}),r&&o.jsx("span",{className:"text-xs text-white/60",children:"Đang tải..."})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"13%"}}),o.jsx("col",{style:{width:"15%"}}),o.jsx("col",{style:{width:"12%",minWidth:"160px"}}),o.jsx("col",{style:{width:"22%",minWidth:"240px"}}),o.jsx("col",{style:{width:"21%",minWidth:"240px"}}),o.jsx("col",{style:{width:"7%",minWidth:"120px"}})]}),o.jsx("thead",{className:"bg-white/5 text-white",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Hình ảnh"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Mã sản phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Tên sản phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold border-r border-white/10 min-w-[160px]",children:"Danh mục"}),o.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy tắc"}),o.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"Mô tả"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[e.map(d=>o.jsx(K$,{item:d,isExpanded:s===d.id,onToggle:l,onEdit:c},`${d.id}-${d.productId}`)),!r&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có sản phẩm nào được hiển thị."})}),r&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách sản phẩm..."})})]})]})}),o.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:o.jsx(B$,{currentPage:n,totalItems:t,pageSize:a,onPageChange:i})})]}),V$=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,expandedId:i,onPageChange:s,onToggleExpand:l,onEdit:c})=>o.jsx(z$,{products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:s,expandedId:i,onToggleExpand:l,onEdit:c}),G$=({categoryRows:e,loading:t,onEditCategory:r,getCategoryColor:n})=>{const[a,i]=p.useState(null);return o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-[#0b1220] shadow-xl overflow-hidden",children:[o.jsxs("div",{className:"border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Danh Mục"}),t?o.jsx("span",{className:"text-xs text-white/60",children:"Đang tải..."}):o.jsxs("span",{className:"text-xs text-white/60",children:[e.length," danh mục"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[o.jsxs("colgroup",{children:[o.jsx("col",{style:{width:"10%"}}),o.jsx("col",{style:{width:"30%"}}),o.jsx("col",{style:{width:"40%"}}),o.jsx("col",{style:{width:"20%",minWidth:"140px"}})]}),o.jsx("thead",{className:"bg-white/5 text-white",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Hình Ảnh"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Gói Sản Phẩm"}),o.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Danh Mục"}),o.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Thao Tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[!t&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có danh mục nào để hiển thị."})}),t&&e.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách danh mục..."})}),e.map(s=>o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-4 py-3",children:s.imageUrl?o.jsx("img",{src:s.imageUrl,alt:s.packageName,className:"h-12 w-12 rounded-lg object-cover",onError:l=>{l.currentTarget.src="https://via.placeholder.com/48?text=No+Image"}}):o.jsx("div",{className:"h-12 w-12 rounded-lg bg-gray-700 flex items-center justify-center text-white/50 text-xs",children:"No Image"})}),o.jsx("td",{className:"px-4 py-3 text-white font-semibold",children:s.packageName}),o.jsx("td",{className:"px-4 py-3 text-white/80",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:(s.categories||[]).map((l,c)=>o.jsx("span",{className:"category-pill",style:{backgroundColor:n(l,c)},children:l.name},`${s.key}-${l.id||l.name}`))})}),o.jsxs("td",{className:"px-4 py-3 text-center",children:[o.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",onClick:()=>i(l=>l===s.key?null:s.key),children:o.jsx(Ts,{className:"h-5 w-5 text-blue-400"})}),o.jsx("button",{className:"ml-2 inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",type:"button",onClick:()=>r(s),children:o.jsx(zo,{className:"h-5 w-5 text-green-400"})})]})]}),a===s.key&&o.jsx("tr",{className:"bg-white/5",children:o.jsx("td",{colSpan:3,className:"px-6 py-4",children:o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-2",children:s.items.map(l=>{const c=zt(l.productId||""),d=zt(l.packageProduct||l.productName||l.productId||"");return o.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:c}),o.jsx("p",{className:"text-xs text-white/60 truncate",children:d})]},`${s.key}-${l.id}-${l.productId}`)})})})})]},s.key))]})]})})]})},Y$=({categoryRows:e,loading:t,onEditCategory:r,getCategoryColor:n})=>o.jsx(G$,{categoryRows:e,loading:t,onEditCategory:r,getCategoryColor:n}),X$=({open:e,name:t,color:r,saving:n,error:a,onNameChange:i,onColorChange:s,onClose:l,onSave:c})=>{if(!e)return null;const d=(t||"").trim(),u=n||!d;return o.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:o.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tạo danh mục mới"}),o.jsx("button",{type:"button",className:"rounded-full p-2 text-white/60 hover:text-white hover:bg-white/10 transition",onClick:l,"aria-label":"Đóng",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"px-5 py-5 space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Tên danh mục"}),o.jsx("input",{type:"text",value:t,onChange:f=>i(f.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"Nhập tên danh mục"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Màu sắc"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("input",{type:"color",value:r,onChange:f=>s(f.target.value),className:"h-10 w-14 rounded border border-white/10 bg-white/10"}),o.jsx("input",{type:"text",value:r,onChange:f=>s(f.target.value),className:"flex-1 rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"#facc15"}),o.jsx("div",{className:"h-10 w-10 rounded-lg border border-white/10",style:{backgroundColor:r||"#facc15"}})]})]}),a&&o.jsx("div",{className:"rounded-lg border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:a})]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-4",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/10 px-4 py-2 text-sm font-semibold text-white/70 hover:text-white hover:bg-white/10 transition",onClick:l,disabled:n,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-500 transition disabled:opacity-60",onClick:c,disabled:u,children:n?"Đang tạo...":"Tạo danh mục"})]})]})})},Xy=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],q$=(e,t)=>e.color||Xy[t%Xy.length],Z$=({open:e,packageName:t,categoryOptions:r,selectedCategoryIds:n,saving:a,error:i,onPackageNameChange:s,onToggleCategory:l,onClose:c,onSave:d})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:o.jsxs("div",{className:"w-full max-w-3xl rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Chỉnh sửa gói sản phẩm và danh mục"}),o.jsx("button",{type:"button",className:"rounded-full p-2 text-white/60 hover:text-white hover:bg-white/10 transition",onClick:c,"aria-label":"Đóng",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"px-5 py-5 space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Gói sản phẩm"}),o.jsx("input",{type:"text",value:t,onChange:u=>s(u.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"Nhập tên gói sản phẩm"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60",children:"Danh mục"}),o.jsxs("span",{className:"text-xs text-white/50",children:["Đã chọn: ",n.length]})]}),o.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.map((u,f)=>{const h=n.includes(u.id);return o.jsxs("button",{type:"button",onClick:()=>l(u.id),className:`category-pill inline-flex items-center gap-1 transition ${h?"ring-2 ring-white/40":"opacity-80 hover:opacity-100"}`,style:{backgroundColor:q$(u,f)},children:[h&&o.jsx(Ga,{className:"h-3 w-3"}),u.name]},u.id)}),r.length===0&&o.jsx("div",{className:"text-sm text-white/60",children:"Không có danh mục để chọn."})]})]}),i&&o.jsx("div",{className:"rounded-lg border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:i})]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-4",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/10 px-4 py-2 text-sm font-semibold text-white/70 hover:text-white hover:bg-white/10 transition",onClick:c,disabled:a,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500 transition disabled:opacity-60",onClick:d,disabled:a,children:a?"Đang lưu...":"Lưu thay đổi"})]})]})}):null,J$=({open:e,url:t,error:r,onChange:n,onClose:a,onConfirm:i})=>e?o.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 px-4",children:o.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-[#0b1220] border border-white/10 p-5 shadow-2xl space-y-4",children:[o.jsx("h4",{className:"text-white font-semibold",children:"Chỉnh sửa liên kết"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70",children:"Đường dẫn"}),o.jsx("input",{type:"text",value:t,onChange:s=>n(s.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."}),r&&o.jsx("div",{className:"text-xs text-rose-300",children:r})]}),o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{className:"px-3 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:a,type:"button",children:"Hủy bỏ"}),o.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:i,type:"button",children:"Chỉnh sửa liên kết"})]})]})}):null,qy=({label:e,toolbar:t,editorRef:r,editorKey:n,context:a,onFocusEditor:i,onSyncEditor:s})=>o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:e}),t,o.jsx("div",{ref:r,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>i(a),onInput:l=>s(a,l.currentTarget),onBlur:l=>s(a,l.currentTarget)},n)]}),Q$=({labels:e,rulesEditorRef:t,descriptionEditorRef:r,rulesEditorKey:n,descriptionEditorKey:a,renderToolbar:i,onFocusEditor:s,onSyncEditor:l})=>o.jsxs("div",{className:"space-y-4 lg:col-span-3",children:[o.jsx(qy,{label:e.rules,toolbar:i("rules"),editorRef:t,editorKey:n,context:"rules",onFocusEditor:s,onSyncEditor:l}),o.jsx(qy,{label:e.description,toolbar:i("description"),editorRef:r,editorKey:a,context:"description",onFocusEditor:s,onSyncEditor:l})]}),eU=({saving:e,onClose:t,onSave:r,labels:n})=>o.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-3",children:[o.jsx("button",{className:"px-4 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:t,disabled:e,type:"button",children:n.cancel}),o.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:r,disabled:e,type:"button",children:e?n.saving:n.save})]}),tU=({title:e})=>o.jsx("div",{className:"flex items-center justify-center border-b border-white/10 px-5 py-3",children:o.jsx("h3",{className:"text-lg font-semibold text-white text-center",children:e})}),rU=async e=>{const t=await Ze("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(Wr(n,{fallback:"Không thể lưu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phản hồi không hợp lệ từ server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},nU=async e=>{const t=new FormData;t.append("image",e);const r=await Ze("/api/product-descriptions/upload-image",{method:"POST",body:t});if(!r.ok){const a=await r.text().catch(()=>"");throw new Error(Wr(a,{fallback:"Upload failed."}))}const n=await r.json().catch(()=>null);if(!n||typeof n.url!="string")throw new Error("Invalid upload response.");return n},aU=async()=>{const e=await Ze("/api/product-descriptions/images");if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(Wr(r,{fallback:"Failed to load images."}))}const t=await e.json().catch(()=>null);return!t||!Array.isArray(t.items)?{items:[],count:0}:{items:t.items,count:typeof t.count=="number"&&Number.isFinite(t.count)?t.count:t.items.length}},iU=async e=>{const t=encodeURIComponent(e||""),r=await Ze(`/api/product-descriptions/images/${t}`,{method:"DELETE"});if(!r.ok){const n=await r.text().catch(()=>"");throw new Error(Wr(n,{fallback:"Delete failed."}))}},sU=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Ze(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(Wr(l,{fallback:"Không thể tải thông tin sản phẩm."}))}const a=await n.json().catch(()=>null);if(!a||!Array.isArray(a.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const i=typeof a.count=="number"&&Number.isFinite(a.count)?a.count:a.items.length,s=typeof a.total=="number"&&Number.isFinite(a.total)?a.total:i;return{...a,count:i,total:s,offset:typeof a.offset=="number"&&Number.isFinite(a.offset)?a.offset:e.offset??0,limit:typeof a.limit=="number"&&Number.isFinite(a.limit)?a.limit:e.limit??a.items.length}},oU=({open:e,images:t,selectedImage:r,loading:n,uploading:a,deleting:i,error:s,uploadError:l,onClose:c,onSelect:d,onUseSelected:u,onUploadClick:f,onDeleteSelected:h})=>e?o.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/70 px-4 py-6",children:o.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-white/10 bg-[#0b1220] shadow-2xl",children:[o.jsx("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:o.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chọn hình ảnh"})}),o.jsxs("div",{className:"p-4 space-y-4",children:[n?o.jsx("p",{className:"text-sm text-white/70",children:"Đang tải hình ảnh..."}):t.length===0?o.jsx("p",{className:"text-sm text-white/70",children:"Chưa có hình ảnh nào."}):o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:t.map(m=>{const x=r?.fileName===m.fileName;return o.jsxs("button",{type:"button",className:`rounded-xl border p-2 text-left transition ${x?"border-blue-400 ring-2 ring-blue-400/40":"border-white/10 hover:border-white/30"}`,onClick:()=>d(m),children:[o.jsx("div",{className:"aspect-[4/3] w-full overflow-hidden rounded-lg bg-black/30",children:o.jsx("img",{src:m.url,alt:m.fileName,className:"h-full w-full object-contain"})}),o.jsx("p",{className:"mt-2 truncate text-xs text-white/70",children:m.fileName})]},m.fileName)})}),(s||l)&&o.jsxs("div",{className:"space-y-1",children:[s&&o.jsx("p",{className:"text-xs text-rose-300",children:s}),l&&o.jsx("p",{className:"text-xs text-rose-300",children:l})]}),o.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-white/40 bg-transparent px-4 py-2 text-sm font-semibold text-white/90 hover:border-white hover:text-white disabled:opacity-60",onClick:f,disabled:a,children:a?"Đang tải...":"Tải hình mới"}),o.jsx("button",{type:"button",className:"rounded-lg border border-rose-400/60 bg-transparent px-4 py-2 text-sm font-semibold text-rose-200 hover:border-rose-300 hover:text-rose-100 disabled:opacity-60",onClick:h,disabled:!r||i,children:i?"Đang xóa...":"Xoá hình đã chọn"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white/70 hover:text-white",onClick:c,children:"Hủy"}),o.jsx("button",{type:"button",className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:u,disabled:!r,children:"Sử dụng hình đã chọn"})]})]})]})]})}):null,lU=({form:e,labels:t,onProductIdChange:r,onProductNameChange:n,onImageUrlChange:a})=>o.jsx(cU,{form:e,labels:t,onProductIdChange:r,onProductNameChange:n,onImageUrlChange:a}),cU=({form:e,labels:t,onProductIdChange:r,onProductNameChange:n,onImageUrlChange:a})=>{const i=p.useRef(null),[s,l]=p.useState(!1),[c,d]=p.useState([]),[u,f]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState(null),[v,y]=p.useState(!1),[b,w]=p.useState(null),[N,_]=p.useState(!1),E=async W=>{f(!0),m(null);try{const G=await aU(),K=Array.isArray(G.items)?G.items:[];d(K);let J=W||x;J&&(J=K.find(V=>V.fileName===J?.fileName||V.url===J?.url)||null),!J&&e.imageUrl&&(J=K.find(V=>V.url===e.imageUrl)||null),!J&&K.length&&(J=K[0]),g(J)}catch(G){m(G instanceof Error?G.message:"Failed to load images."),d([])}finally{f(!1)}},S=()=>{l(!0),m(null),w(null),E()},j=()=>{l(!1)},P=()=>{i.current?.click()},C=async W=>{const G=W.target.files?.[0];if(G){y(!0),w(null);try{const K=await nU(G);a(K.url);const J=K.fileName?{fileName:K.fileName,url:K.url}:null;g(J),await E(J)}catch(K){w(K instanceof Error?K.message:"Upload failed.")}finally{y(!1),W.target.value=""}}},T=()=>{x&&(a(x.url),l(!1))},k=async()=>{if(!(!x||N)){_(!0),m(null);try{await iU(x.fileName),e.imageUrl===x.url&&a(""),await E(null)}catch(W){m(W instanceof Error?W.message:"Delete failed.")}finally{_(!1)}}};return o.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[o.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3",children:o.jsxs("div",{className:"relative aspect-[4/5] min-h-[300px] overflow-hidden rounded-xl border border-white/10 bg-black/20",children:[e.imageUrl?o.jsx("img",{src:e.imageUrl,alt:"Product preview",className:"h-full w-full object-contain",onError:W=>{W.currentTarget.style.display="none"}}):o.jsx("div",{className:"h-full w-full"}),o.jsx("button",{type:"button",className:"absolute left-1/2 top-1/2 z-10 -translate-x-1/2 -translate-y-1/2 rounded-lg border border-white/70 bg-black/40 px-4 py-2 text-sm font-semibold text-white shadow-lg backdrop-blur-sm hover:border-white hover:bg-black/50 disabled:opacity-60",onClick:S,children:"Upload"}),o.jsx("input",{ref:i,type:"file",accept:"image/*",className:"hidden",onChange:C})]})}),o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:t.productId}),o.jsx("input",{type:"text",value:e.productId,onChange:W=>r(W.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:t.productName}),o.jsx("input",{type:"text",value:e.productName,onChange:W=>n(W.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),o.jsx(oU,{open:s,images:c,selectedImage:x,loading:u,uploading:v,deleting:N,error:h,uploadError:b,onClose:j,onSelect:g,onUseSelected:T,onUploadClick:P,onDeleteSelected:k})]})},uU=({context:e,onCommand:t,onOpenLink:r,onOpenColor:n,headingPrompt:a,headingDefault:i})=>o.jsx("div",{className:"rich-toolbar-wrapper",children:o.jsxs("div",{className:"rich-toolbar mb-2",children:[o.jsx("button",{type:"button",onClick:()=>t("bold"),children:"B"}),o.jsx("button",{type:"button",onClick:()=>t("italic"),children:"I"}),o.jsx("button",{type:"button",onClick:()=>t("underline"),children:"U"}),o.jsx("button",{type:"button",onClick:r,children:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[o.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),o.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.71"})]})}),o.jsx("button",{type:"button","data-color-button":"true",onClick:()=>n("foreColor",e),children:"A"}),o.jsx("button",{type:"button","data-color-button":"true",onClick:()=>n("hiliteColor",e),children:"Bg"}),o.jsx("button",{type:"button",className:"rich-toolbar-heading",onClick:()=>{const s=window.prompt(a,i),l=Number(s);Number.isInteger(l)&&l>=1&&l<=6&&t("formatBlock",`h${l}`)},children:"H"}),o.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:s=>{const l=s.target.value;s.target.value="",l&&t("fontName",l)},children:[o.jsx("option",{value:"",children:"Font"}),o.jsx("option",{value:"Arial",children:"Arial"}),o.jsx("option",{value:"Georgia",children:"Georgia"}),o.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),o.jsx("option",{value:"Verdana",children:"Verdana"}),o.jsx("option",{value:"Tahoma",children:"Tahoma"}),o.jsx("option",{value:"Roboto",children:"Roboto"}),o.jsx("option",{value:"Inter",children:"Inter"}),o.jsx("option",{value:"Poppins",children:"Poppins"}),o.jsx("option",{value:"Montserrat",children:"Montserrat"}),o.jsx("option",{value:"Open Sans",children:"Open Sans"}),o.jsx("option",{value:"Nunito",children:"Nunito"}),o.jsx("option",{value:"Raleway",children:"Raleway"}),o.jsx("option",{value:"Merriweather",children:"Merriweather"}),o.jsx("option",{value:"Playfair Display",children:"Playfair Display"}),o.jsx("option",{value:"Courier New",children:"Courier New"}),o.jsx("option",{value:"Fira Code",children:"Fira Code"}),o.jsx("option",{value:"Source Sans Pro",children:"Source Sans Pro"})]}),o.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:s=>{const l=s.target.value;s.target.value="",l&&t("fontSize",l)},children:[o.jsx("option",{value:"",children:"Size"}),o.jsx("option",{value:"2",children:"12px"}),o.jsx("option",{value:"3",children:"16px"}),o.jsx("option",{value:"4",children:"18px"}),o.jsx("option",{value:"5",children:"24px"}),o.jsx("option",{value:"6",children:"32px"}),o.jsx("option",{value:"7",children:"48px"})]})]})}),dU=({product:e,saving:t,onClose:r,onSave:n})=>{const a={title:"Chỉnh sửa thông tin sản phẩm",productId:"Mã sản phẩm",productName:"Tên sản phẩm / Loại gói sản phẩm",rules:"Quy tắc sản phẩm",description:"Mô tả sản phẩm",cancel:"Hủy bỏ",save:"Lưu thay đổi",saving:"Đang Lưu...",headingPrompt:"Chọn heading (1-6):",headingDefault:"2"},i=p.useMemo(()=>({productId:zt(e?.productId||""),productName:zt(e?.packageProduct||e?.productName||"")||"",rules:e?.rules||"",rulesHtml:e?.rulesHtml||en(e?.rules||""),description:e?.description||"",descriptionHtml:e?.descriptionHtml||en(e?.description||""),imageUrl:e?.imageUrl||""}),[e]),[s,l]=p.useState(i),[c,d]=p.useState(null),u=p.useRef(null),f=p.useRef(null),h=p.useRef(null),m=p.useRef(!1),[x,g]=p.useState(null),[v,y]=p.useState("#38bdf8"),b=p.useRef(null),[w,N]=p.useState(!1),[_,E]=p.useState("https://"),[S,j]=p.useState(null);p.useEffect(()=>{e&&(l(i),d(null),N(!1),E("https://"),j(null))},[i,e]);const P=()=>c==="rules"?u.current:f.current,C=(Y,le)=>{if(!le)return;const de=document.getSelection(),pe=de&&de.rangeCount>0?de.getRangeAt(0).cloneRange():null,_e=U$(le.innerHTML),q=le.innerText;m.current=!0,l(ve=>({...ve,[Y]:q,[`${Y}Html`]:_e}));const oe=document.activeElement===le;pe&&oe&&(de?.removeAllRanges(),de?.addRange(pe))};p.useEffect(()=>{const Y=u.current;if(Y){if(m.current){m.current=!1;return}Y.innerHTML=s.rulesHtml||en(s.rules)}},[s.rules,s.rulesHtml]),p.useEffect(()=>{const Y=f.current;if(Y){if(m.current){m.current=!1;return}Y.innerHTML=s.descriptionHtml||en(s.description)}},[s.description,s.descriptionHtml]),p.useEffect(()=>{if(!x)return;const Y=b.current;Y&&requestAnimationFrame(()=>{typeof Y.showPicker=="function"?Y.showPicker():Y.click()})},[x]);const T=()=>{const Y=P();if(!Y){h.current=null;return}const le=document.getSelection();le&&le.rangeCount>0&&Y.contains(le.focusNode)?h.current=le.getRangeAt(0).cloneRange():h.current=null},k=(Y,le,de=!1)=>{const pe=P();if(pe){if(de&&h.current){const _e=document.getSelection();_e&&(_e.removeAllRanges(),_e.addRange(h.current))}else T();pe.focus(),document.execCommand(Y,!1,le),C(c||"rules",pe)}},W=()=>{P()&&(T(),E("https://"),j(null),N(!0))},G=()=>{N(!1),j(null),E("https://")},K=()=>{const Y=P();if(!Y){j("Vui lòng chọn nút dung trước khi chọn link.");return}const le=_.trim();if(!/^https?:\/\//i.test(le)){j("URL phải bắt đầu bằng http:// hoặc https://");return}Y.focus();const de=document.getSelection();de&&h.current&&(de.removeAllRanges(),de.addRange(h.current)),document.execCommand("createLink",!1,le),C(c||"rules",Y),G()},J=(Y,le)=>{d(le),T(),g(Y),y(Y==="hiliteColor"?"#fef08a":"#38bdf8")},V=Y=>{const le=x;le&&(y(Y),g(null),k(le,Y,!0))},Z=Y=>{if(!Y){g(null);return}y(Y),V(Y)},Q=Y=>o.jsx(uU,{context:Y,onCommand:k,onOpenLink:W,onOpenColor:J,headingPrompt:a.headingPrompt,headingDefault:a.headingDefault});return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:o.jsxs("div",{className:"w-full max-w-5xl max-h-[90vh] overflow-y-auto rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl custom-scroll",children:[o.jsx("input",{ref:b,type:"color",className:"rich-color-native",value:v,onChange:Y=>Z(Y.target.value),onBlur:()=>g(null)}),o.jsx(tU,{title:a.title}),o.jsx("div",{className:"px-5 py-4",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[o.jsx(lU,{form:s,labels:{productId:a.productId,productName:a.productName},onProductIdChange:Y=>l(le=>({...le,productId:Y})),onProductNameChange:Y=>l(le=>({...le,productName:Y})),onImageUrlChange:Y=>l(le=>({...le,imageUrl:Y}))}),o.jsx(Q$,{labels:{rules:a.rules,description:a.description},rulesEditorRef:u,descriptionEditorRef:f,rulesEditorKey:(e?.id??"rules")+"-editor",descriptionEditorKey:(e?.id??"description")+"-editor",renderToolbar:Q,onFocusEditor:Y=>d(Y),onSyncEditor:C})]})}),o.jsx(eU,{saving:t,onClose:r,onSave:()=>n(s),labels:{cancel:a.cancel,save:a.save,saving:a.saving}})]})}),o.jsx(J$,{open:!!e&&w,url:_,error:S,onChange:Y=>{E(Y),j(null)},onClose:G,onConfirm:K})]}):null},xa=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],fU=(e,t)=>{if(e.color)return e.color;const r=Number(e.id);return Number.isFinite(r)?xa[Math.abs(r)%xa.length]:xa[t%xa.length]},hU=(e,t)=>t||(Number.isFinite(e)?xa[Math.abs(e)%xa.length]:xa[0]),mU=({reloadCategories:e})=>{const[t,r]=p.useState(!1),[n,a]=p.useState(""),[i,s]=p.useState(xa[0]),[l,c]=p.useState(!1),[d,u]=p.useState(null),f=p.useCallback(()=>{r(!0),u(null),a(""),s(xa[0])},[]),h=p.useCallback(()=>{r(!1),c(!1),u(null),a("")},[]),m=p.useCallback(async()=>{const x=n.trim();if(!x){u("Category name is required.");return}c(!0),u(null);try{const g=await Ze("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x,color:(i||"").trim()||null})});if(!g.ok){const v=await g.text().catch(()=>"");throw new Error(v||`Failed to create category (${g.status}).`)}await g.json().catch(()=>null),await e(),r(!1),a("")}catch(g){u(Wr(g instanceof Error?g.message:String(g??""),{fallback:"Cannot create category."}))}finally{c(!1)}},[n,i,e]);return{createCategoryOpen:t,newCategoryName:n,setNewCategoryName:a,newCategoryColor:i,setNewCategoryColor:s,creatingCategory:l,createCategoryError:d,openCreateCategory:f,closeCreateCategory:h,handleCreateCategory:m}},pU=async(e,t)=>{const r=await Ze(`/api/product-prices/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!r.ok){const n=await r.text();throw new Error(Wr(n,{fallback:"Cannot update product categories."}))}return r.json().catch(()=>({}))},xU=async e=>{const t=await Ze(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(Wr(n,{fallback:"Không thể xóa sản phẩm khỏi bảng giá.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},gU=({categoryOptions:e,reloadProducts:t,onOpenEdit:r})=>{const[n,a]=p.useState(null),[i,s]=p.useState(""),[l,c]=p.useState([]),[d,u]=p.useState(!1),[f,h]=p.useState(null),m=p.useCallback(y=>{a(y),s(y.packageName||"");const b=(y.categories||[]).map(w=>Number(w.id)).filter(w=>Number.isFinite(w));c(Array.from(new Set(b))),h(null),r&&r()},[r]),x=p.useCallback(()=>{a(null),u(!1),h(null)},[]),g=p.useCallback(y=>{c(b=>b.includes(y)?b.filter(w=>w!==y):[...b,y])},[]),v=p.useCallback(async()=>{if(!n)return;const y=n.items.find(_=>Number.isFinite(Number(_.priceId)))||n.items.find(_=>Number.isFinite(Number(_.id))),b=y?Number(y.priceId??y.id):null;if(!b){h("Missing product id for update.");return}u(!0),h(null);const w=i.trim(),N=l.reduce((_,E)=>{const S=e.find(j=>j.id===E);return _[E]=hU(E,S?.color??null),_},{});try{await pU(b,{packageName:w,categoryIds:l,categoryColors:N}),await t(),a(null)}catch(_){h(Wr(_ instanceof Error?_.message:String(_??""),{fallback:"Cannot update category."}))}finally{u(!1)}},[n,i,l,e,t]);return{editingCategoryGroup:n,categoryPackageName:i,setCategoryPackageName:s,selectedCategoryIds:l,categorySaving:d,categorySaveError:f,openCategoryEdit:m,closeCategoryEdit:x,handleToggleCategory:g,handleSaveCategory:v}},vU=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),s=p.useRef(!0);p.useEffect(()=>()=>{s.current=!1},[]);const l=p.useCallback(async()=>{if(s.current){n(!0),i(null);try{const c=await Ze("/api/categories");if(!c.ok){const f=await c.text().catch(()=>"");throw new Error(f||`Failed to load categories (${c.status}).`)}const d=await c.json().catch(()=>[]);if(!s.current)return;const u=Array.isArray(d)?d:[];u.sort((f,h)=>String(f?.name||"").localeCompare(String(h?.name||""),"vi",{sensitivity:"base"})),t(u)}catch(c){if(!s.current)return;t([]),i(Wr(c instanceof Error?c.message:String(c??""),{fallback:"Cannot load categories."}))}finally{s.current&&n(!1)}}},[]);return p.useEffect(()=>{l()},[l]),{categoryOptions:e,loading:r,error:a,reload:l}},yU=({setProductDescs:e,setError:t})=>{const[r,n]=p.useState(null),[a,i]=p.useState(!1),s=p.useCallback(u=>{n(u)},[]),l=p.useCallback(()=>{n(null),i(!1)},[]),c=p.useCallback(()=>{n(null)},[]),d=p.useCallback(async u=>{if(!r)return;i(!0);const f={productId:u.productId.trim()||r.productId||"",rules:u.rulesHtml||u.rules,description:u.descriptionHtml||u.description,imageUrl:u.imageUrl||null};try{const h=await rU(f),m=h.rulesHtml||h.rules||u.rulesHtml||u.rules||"",x=h.descriptionHtml||h.description||u.descriptionHtml||u.description||"",g={...r,id:h.id||r.id,productId:h.productId,productName:zt(u.productName||r.productName||"")||r.productName,rules:h.rules||"",rulesHtml:m,description:h.description||"",descriptionHtml:x,imageUrl:h.imageUrl||u.imageUrl||null};e(v=>{const y=zt(h.productId||r.productId||"").toLowerCase(),b=v.findIndex(N=>zt(N.productId||"").toLowerCase()===y);if(b===-1)return[...v,{id:h.id||r.id,productId:h.productId,productName:g.productName||null,rules:h.rules||"",rulesHtml:m,description:h.description||"",descriptionHtml:x,imageUrl:h.imageUrl||null}];const w=[...v];return w[b]={...w[b],id:h.id||w[b].id,productId:h.productId,productName:g.productName||w[b].productName||null,rules:h.rules||"",rulesHtml:m,description:h.description||"",descriptionHtml:x,imageUrl:h.imageUrl||null},w}),n(null)}catch(h){t(Wr(h instanceof Error?h.message:String(h??""),{fallback:"Không thể lưu thông tin sản phẩm."}))}finally{i(!1)}},[r,e,t]);return{editingProduct:r,editSaving:a,openEditForm:s,closeEditForm:l,handleSaveEdit:d,clearEditingProduct:c}},bU=()=>{const[e,t]=p.useState(null),[r,n]=p.useState(1),[a,i]=p.useState([]),[s,l]=p.useState([]),[c,d]=p.useState(""),[u,f]=p.useState(!1),[h,m]=p.useState(null),x=p.useMemo(()=>H$(a,s,c),[a,s,c]),g=p.useMemo(()=>Math.max(1,Math.ceil(x.length/rc)),[x.length]),v=p.useMemo(()=>{const w=(r-1)*rc,N=w+rc;return x.slice(w,N)},[x,r]),y=p.useCallback(async()=>{f(!0),m(null);try{const[w,N]=await Promise.all([sU({}),Ze("/api/products")]),_=await N.json().catch(()=>[]);i(Array.isArray(w.items)?w.items:[]),l(Array.isArray(_)?_:[])}catch(w){i([]),l([]),m(Wr(w instanceof Error?w.message:String(w??""),{fallback:"Không thể tải danh sách sản phẩm."}))}finally{f(!1)}},[]);return p.useEffect(()=>{y()},[y]),p.useEffect(()=>{r>g&&n(g)},[r,g]),{data:{mergedProducts:x,pagedProducts:v,loading:u,error:h,currentPage:r,totalPages:g,expandedId:e,searchTerm:c},actions:{handleSearchChange:w=>{d(w),n(1)},setCurrentPage:n,setExpandedId:t,reload:y,setProductDescs:i,setError:m}}},wU=e=>{const t=new Map;return e.forEach(r=>{const n=(r.packageName||"").trim();if(!n)return;const a=n;t.has(a)||t.set(a,{key:a,packageName:n,imageUrl:r.packageImageUrl??null,categories:[],items:[]}),t.get(a)?.items.push(r)}),Array.from(t.entries()).map(([,r])=>{const n=new Map;return r.items.forEach(a=>{(a.categories||[]).forEach(i=>{if(!i||!i.name)return;const s=i.id?String(i.id):i.name;n.has(s)||n.set(s,i)})}),{...r,categories:Array.from(n.values()).sort((a,i)=>String(a?.name||"").localeCompare(String(i?.name||""),"vi",{sensitivity:"base"})),items:[...r.items].sort((a,i)=>{const s=zt(a.productId||a.packageProduct||a.productName||""),l=zt(i.productId||i.packageProduct||i.productName||"");return s.localeCompare(l,"vi",{sensitivity:"base"})})}}).sort((r,n)=>r.packageName.localeCompare(n.packageName,"vi",{sensitivity:"base"}))},NU=()=>{const{data:{mergedProducts:e,pagedProducts:t,loading:r,error:n,currentPage:a,expandedId:i,searchTerm:s},actions:{handleSearchChange:l,setCurrentPage:c,setExpandedId:d,reload:u,setProductDescs:f,setError:h}}=bU(),[m,x]=p.useState("products"),{categoryOptions:g,loading:v,error:y,reload:b}=vU(),{editingProduct:w,editSaving:N,openEditForm:_,closeEditForm:E,handleSaveEdit:S,clearEditingProduct:j}=yU({setProductDescs:f,setError:h}),{editingCategoryGroup:P,categoryPackageName:C,setCategoryPackageName:T,selectedCategoryIds:k,categorySaving:W,categorySaveError:G,openCategoryEdit:K,closeCategoryEdit:J,handleToggleCategory:V,handleSaveCategory:Z}=gU({categoryOptions:g,reloadProducts:u,onOpenEdit:j}),{createCategoryOpen:Q,newCategoryName:Y,setNewCategoryName:le,newCategoryColor:de,setNewCategoryColor:pe,creatingCategory:_e,createCategoryError:q,openCreateCategory:oe,closeCreateCategory:ve,handleCreateCategory:O}=mU({reloadCategories:b}),D=p.useMemo(()=>wU(e),[e]);return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thông Tin Sản Phẩm"}),o.jsx("p",{className:"text-sm text-white/70",children:"Đồng bộ với bảng product_desc trong database."})]}),o.jsx(F$,{searchTerm:s,onSearchChange:l,onAddClick:u,onAddCategoryClick:oe}),n&&o.jsx("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),o.jsx(M$,{viewMode:m,onViewModeChange:x}),m==="products"?o.jsx(V$,{products:t,mergedTotal:e.length,loading:r,currentPage:a,pageSize:rc,onPageChange:c,expandedId:i,onToggleExpand:d,onEdit:_}):o.jsx(Y$,{categoryRows:D,loading:r,onEditCategory:K,getCategoryColor:fU}),Q&&o.jsx(X$,{open:Q,name:Y,color:de,saving:_e,error:q,onNameChange:le,onColorChange:pe,onClose:ve,onSave:O}),P&&o.jsx(Z$,{open:!!P,packageName:C,categoryOptions:g,selectedCategoryIds:k,saving:W||v,error:G||y,onPackageNameChange:T,onToggleCategory:V,onClose:J,onSave:Z}),w&&o.jsx(dU,{product:w,saving:N,onClose:E,onSave:S})]})},_U=({searchTerm:e,statusFilter:t,isLoading:r,isRefreshing:n,error:a,onSearchChange:i,onStatusChange:s,onRefresh:l})=>o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/70 via-slate-900/60 to-indigo-950/70 p-6 text-white shadow-lg backdrop-blur",children:[o.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[o.jsxs("div",{className:"relative md:col-span-2",children:[o.jsx(Bi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-white/60"}),o.jsx("input",{type:"text",placeholder:"Tìm Kiếm Sản Phẩm...",className:"w-full rounded-lg border border-white/20 bg-white/10 px-10 py-2 text-white placeholder:text-white/60 focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:e,onChange:c=>i(c.target.value)})]}),o.jsxs("select",{className:"w-full rounded-lg border border-white/20 bg-white/10 px-4 py-2 text-white focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:t,onChange:c=>s(c.target.value),children:[o.jsx("option",{value:"all",children:"Trạng Thái"}),o.jsx("option",{value:"active",children:"Đang Hoạt Động"}),o.jsx("option",{value:"inactive",children:"Tạm Dừng"})]}),o.jsx(Qn,{className:"w-full justify-center",type:"button",onClick:l,disabled:r||n,children:r||n?"Đang Đồng Bộ...":"Đồng Bộ Lại"})]}),a&&o.jsx("div",{className:"mt-4 rounded-lg border border-red-400/40 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:a})]}),SU=({stats:e,onAddProduct:t})=>o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex flex-col justify-between gap-3 sm:flex-row sm:items-center",children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bảng Giá Sản Phẩm"}),o.jsx(Qn,{icon:ta,onClick:t,children:"Thêm Sản Phẩm"})]}),o.jsx("div",{className:"rounded-[28px] border border-white/10 bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:o.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(r=>o.jsx(pa,{title:r.name,value:r.value,icon:r.icon,subtitle:r.subtitle,accent:xr[r.accent]},r.name))})})]}),Ch=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),jh=0,rf=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},vE=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},Zy=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),EU=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",TU=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Tháng`},CU=(e,t)=>{const r=TU(t);return e&&r?`${e} ${r}`:e||r||EU(t)||"Không Xác Định"},Ba=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},jU=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},AU=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t))return null;const r=t>1?t/100:t;return r<0||r>=1?null:1-r},Vc=(e,t,r)=>typeof e!="number"||!Number.isFinite(e)||e<jh||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?!1:AU(t,e)!==null,kU=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",PU=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${kU(r.sourceName)}`,a=t.get(n);if(!a){t.set(n,r);continue}const i=a.price??Number.POSITIVE_INFINITY,s=r.price??Number.POSITIVE_INFINITY,l=Date.parse(a.lastOrderDate??"")||0,c=Date.parse(r.lastOrderDate??"")||0;(s<i||s===i&&c>l)&&t.set(n,r)}return Array.from(t.values())},Ll=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(n!==a)return n-a;const i=Date.parse(t.lastOrderDate??"")||0,s=Date.parse(r.lastOrderDate??"")||0;return i!==s?s-i:t.sourceName.localeCompare(r.sourceName)}),ts=(e,t)=>`${e}-${t}`,Io=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,yE=(e,t)=>Io(t,e),bE=(e,t,r,n,a)=>{const i=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof a=="number"&&Number.isFinite(a)&&a>0&&a||null;if(i===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!Vc(t,e,r))return null;const s=t>1?t/100:t,l=e&&e>1?e:e||1,c=i*l,d=c-c*s;return Math.min(c,Math.max(i,d))},uo=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=yE(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,a=Io(n??t,e.pctKhach),i=bE(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.retailPrice,promoPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.promoPrice}},Ah=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},wE=e=>{if(e==null)return"";const t=String(e).replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?new Intl.NumberFormat("vi-VN").format(r):""},Tn=e=>{if(e==null)return null;const t=e.toString().replace(",",".").trim();return t?Ba(t):null},Jy=({multiplier:e,price:t,basePrice:r})=>"",Zr=e=>{const t=vE(e);return t===null||t<=0?"-":Ch.format(t)},nf=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},OU=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},po=e=>(e||"").trim(),Qy=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=vE(e)??0;return t===0?Ch.format(0):Ch.format(t)},DU=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,a=typeof r=="number"&&Number.isFinite(r)?r-e:null,i=Qy(n),s=Qy(a);return`${i} - ${s}`},Gc=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},RU=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(a<n)return r;if(a>n)return t;const i=Gc(t.lastOrderDate);return Gc(r.lastOrderDate)>i?r:t},null):null,$a=(e,t)=>{const r=e.reduce((n,a)=>{const i=typeof a.price=="number"&&Number.isFinite(a.price)?a.price:Number.NEGATIVE_INFINITY;return i>n?i:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},NE=(e,t)=>{const r=Zy(e?.[Wt.packageName]??e?.package_label),n=Zy(e?.[Wt.variantName]??e?.package_product_label),a=(e?.[Wt.code]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Không xác định",packageProduct:n,sanPhamRaw:a,variantLabel:CU(n,a),pctCtv:Ba(e?.[Wt.pctCtv]),pctKhach:Ba(e?.[Wt.pctKhach]),pctPromo:Ba(e?.[Wt.pctPromo]),isActive:jU(e?.[Wt.isActive]),baseSupplyPrice:Ba(e?.max_supply_price),wholesalePrice:Ba(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:Ba(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:Ba(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[Wt.updatedAt]=="string"?e[Wt.updatedAt]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:typeof e?.update=="string"?e.update:null}},IU=({item:e,productKey:t,isExpanded:r,statusOverride:n,updatedTimestamp:a,supplyState:i,pendingNewSupply:s,supplierOptions:l,isLoadingSuppliers:c,editingProductId:d,productEditForm:u,productEditError:f,isSavingProductEdit:h,isDeletingProduct:m,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:y,onToggleProductDetails:b,onStartProductEdit:w,onProductEditChange:N,onCancelProductEdit:_,onSubmitProductEdit:E,onRequestDeleteProduct:S,onStartEditingSupply:j,onSupplyInputChange:P,onCancelSupplyEditing:C,onConfirmSupplyEditing:T,onStartAddSupplierRow:k,onNewSupplierInputChange:W,onCancelAddSupplierRow:G,onConfirmAddSupplierRow:K,onDeleteSupplyRow:J,onToggleStatus:V,fetchSupplyPricesForProduct:Z})=>{const Q=i?.items??[],Y=s??null,le=RU(Q),de=le?.price??e.baseSupplyPrice,pe=le?.sourceName??"-",_e=$a(Q,e.baseSupplyPrice),q=[...Q.map(me=>({kind:"existing",supplier:me})),...Y?[{kind:"new"}]:[]],oe=n??e.isActive??!1,ve=a??e.lastUpdated??"",O=ve?OU(ve):"-",D=Vc(e.pctPromo,e.pctKhach,e.pctCtv),M=d===e.id,I=M?u:null,z=I?{pctCtv:Tn(I.pctCtv),pctKhach:Tn(I.pctKhach),pctPromo:Tn(I.pctPromo)}:null,se=z?yE(z.pctCtv,_e):null,ce=typeof se=="number"&&Number.isFinite(se)&&se>0?se:_e,Ae=z?Io(ce,z.pctKhach):null,be=z?bE(z.pctKhach,z.pctPromo,z.pctCtv,se,_e):null,X=nf(z?.pctPromo??null),fe=Vc(z?.pctPromo??null,z?.pctKhach??null,z?.pctCtv??null)&&Number.isFinite(be??NaN),Oe=typeof _e=="number"&&Number.isFinite(_e)&&_e>0?Zr(_e):"Chưa có dữ liệu",Me=()=>{Z(e.sanPhamRaw)};return o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{className:"cursor-pointer bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 transition hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70",onClick:()=>b(e),children:[o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(rw,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${r?"rotate-180":""}`}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold text-white",children:e.packageName}),o.jsx("div",{className:"text-xs text-white/70",children:e.variantLabel})]})]})}),o.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[o.jsx("div",{className:"text-sm font-semibold text-white",children:Zr(e.wholesalePrice)}),o.jsx("div",{className:"text-xs text-white/70",children:Jy({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),o.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[o.jsx("div",{className:"text-sm font-semibold text-amber-300",children:Zr(e.retailPrice)}),o.jsx("div",{className:"text-xs text-white/70",children:Jy({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:D?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-pink-200",children:Zr(e.promoPrice)}),o.jsx("div",{className:"text-xs text-white/70",children:nf(e.pctPromo)??"-"})]}):o.jsx("div",{className:"text-sm text-white/60",children:"-"})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsx("div",{className:"flex flex-col items-center",children:o.jsx("button",{type:"button",onClick:me=>{me.stopPropagation(),V(e)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${oe?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":oe,children:o.jsx(aw,{className:"h-4 w-4"})})})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:o.jsx("div",{className:"text-sm text-white",children:O})}),o.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:o.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:me=>w(me,e),children:o.jsx(ps,{className:"h-4 w-4"})}),o.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${m?"cursor-not-allowed opacity-60":""}`,onClick:me=>S(me,e),disabled:m,children:o.jsx(Na,{className:"h-4 w-4"})})]})})]}),M&&I&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 pb-6",children:o.jsxs("div",{className:"space-y-6 rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[o.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thông Tin Sản Phẩm"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tên sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:I.packageName,onChange:me=>N("packageName",me.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Gói sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:I.packageProduct,onChange:me=>N("packageProduct",me.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Mã sản phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:I.sanPham,onChange:me=>N("sanPham",me.target.value)})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"Tỷ giá"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá CTV"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:I.pctCtv,onChange:me=>N("pctCtv",me.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khách"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:I.pctKhach,onChange:me=>N("pctKhach",me.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khuyến mãi"}),o.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:I.pctPromo,onChange:me=>N("pctPromo",me.target.value)})]})]})]})]}),I&&o.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-4 shadow-lg backdrop-blur",children:[o.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[o.jsx("span",{children:"Giá dự kiến theo tỉ giá"}),o.jsxs("span",{className:"font-medium normal-case text-amber-200",children:["Giá nguồn cao nhất:"," ",o.jsx("span",{className:"font-semibold",children:Oe})]})]}),o.jsxs("div",{className:`mt-4 grid gap-3 text-center text-sm ${fe?"md:grid-cols-3":"md:grid-cols-2"}`,children:[o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá Sỉ dự kiến"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(se)}),o.jsx("p",{className:"text-[11px] text-white/70",children:I.pctCtv?`Tỷ Giá: ${I.pctCtv}`:"Nhập tỉ giá CTV"})]}),o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá Khách dự kiến"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(Ae)}),o.jsx("p",{className:"text-[11px] text-white/70",children:I.pctKhach?`Tỷ Giá: ${I.pctKhach}`:"Nhập tỉ giá khách"})]}),fe&&o.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá Khuyến mãi dự kiến"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(be)}),o.jsx("p",{className:"text-[11px] text-white/70",children:X??"Nhập tỉ giá khuyến mãi"})]})]})]}),f&&o.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:f}),o.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[o.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:_,disabled:h,children:"Hủy bỏ"}),o.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:E,disabled:h,children:h?"Đang Lưu...":"Lưu thay đổi"})]})]})})}),r&&o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 pb-6",children:o.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 p-4 text-white",children:o.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiết giá sản phẩm"})}),o.jsxs("div",{className:`grid gap-4 text-center ${D?"md:grid-cols-4":"md:grid-cols-3"}`,children:[o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá nguồn thấp nhất"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(de)}),o.jsx("p",{className:"text-xs text-white/70",children:pe})]}),o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá sỉ hiện tại"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(e.wholesalePrice)})]}),o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá khách hiện tại"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(e.retailPrice)})]}),D&&o.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[o.jsx("p",{className:"text-xs uppercase text-white/70",children:"Giá khuyến mãi hiện tại"}),o.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:Zr(e.promoPrice)}),o.jsx("p",{className:"text-xs text-white/70",children:nf(e.pctPromo)??"-"})]})]}),o.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/15",children:[o.jsx("div",{className:"flex justify-end border-b border-white/10 bg-white/5 px-4 py-2",children:o.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>k(e.id),disabled:!!Y,children:[o.jsx(Vh,{className:"h-4 w-4"}),"Thêm nguồn"]})}),o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-white/5 text-[11px] uppercase tracking-wide text-white/70",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 text-left",children:"NCC"}),o.jsx("th",{className:"px-4 py-2 text-center",children:"Giá nhập"}),o.jsx("th",{className:"px-4 py-2 text-center",children:"Lợi nhuận"}),o.jsx("th",{className:"px-4 py-2 text-center",children:"Thao tác"})]})}),o.jsx("tbody",{children:i?.loading?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Đang Tải Dữ Liệu"})}):i?.error?o.jsx("tr",{children:o.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white",children:[o.jsx("span",{children:i.error})," ",o.jsx("button",{type:"button",className:"text-xs text-red-400 hover:text-red-200 hover:underline",onClick:Me,children:"Thử Lại"})]})}):Q.length===0&&q.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Chưa có dữ liệu từ NCC"})}):q.map(me=>{if(me.kind==="existing"&&me.supplier){const we=me.supplier,he=ts(e.id,we.sourceId),Ce=x[he]??!1,ge=v[he]??!1,Ve=g[he]??(we.price??"").toString();y[he];const De=!Ce||ge,je=Zr(we.price);return o.jsxs("tr",{className:"border-t border-dashed border-white/10",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"text-sm font-semibold text-white",children:we.sourceName})}),o.jsx("td",{className:"px-4 py-3",children:Ce?o.jsxs("div",{className:"flex flex-col items-center gap-1",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("input",{type:"text",className:"w-28 rounded-lg border border-white/25 bg-white/5 px-2 py-1 text-center text-sm text-white placeholder:text-white/50 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/30 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:Ve,onChange:Xe=>P(e.id,we.sourceId,Xe.target.value),disabled:De}),o.jsx("span",{className:"text-xs text-white/70",children:"đ"})]}),o.jsx("span",{className:"text-[11px] text-white/60",children:"Nhập giá mới"})]}):o.jsx("div",{className:"flex justify-center",children:o.jsx("span",{className:"inline-flex min-w-[112px] justify-center rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white",children:je})})}),o.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:DU(we.price,e.wholesalePrice,e.retailPrice)}),o.jsx("td",{className:"px-4 py-3",children:Ce?o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:ge,onClick:()=>T(e.id,we.sourceId,t,e.sanPhamRaw),children:o.jsx(Ga,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:ge,onClick:()=>C(e.id,we.sourceId),children:o.jsx(Dt,{className:"h-4 w-4"})})]}):o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:ge,onClick:()=>j(e.id,we.sourceId,we.price),children:o.jsx(ps,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:ge,onClick:()=>J(e.id,we.sourceId,t,e.sanPhamRaw),children:o.jsx(iw,{className:"h-4 w-4"})})]})})]},he)}if(me.kind==="new"&&Y){const we=Y,he=we.useCustomName?"__custom__":we.sourceId!==null?`id:${we.sourceId}`:we.sourceName?`name:${we.sourceName}`:"",Ce=l.length>0,ge=Ve=>{const De=Ve.target.value;if(De==="__custom__"){W(e.id,"useCustomName",!0),W(e.id,"sourceName",""),W(e.id,"sourceId",null);return}if(W(e.id,"useCustomName",!1),!De){W(e.id,"sourceId",null),W(e.id,"sourceName","");return}const je=l.find(Xe=>(Xe.id!==null?`id:${Xe.id}`:`name:${Xe.name}`)===De);W(e.id,"sourceId",je?.id??null),W(e.id,"sourceName",je?.name??De.replace(/^name:/,"").trim())};return o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{className:"border-t border-dashed border-white/15 bg-slate-900/50",children:[o.jsx("td",{className:"px-4 py-3",children:o.jsx("div",{className:"flex flex-col gap-2",children:Ce&&!we.useCustomName?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("select",{className:"w-60 max-w-xs rounded-lg border border-white/20 bg-slate-900/80 px-3 py-2 text-sm text-white shadow-sm focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/30 disabled:opacity-60",value:he,onChange:ge,disabled:we.isSaving,children:[o.jsx("option",{value:"",children:c?"Đang tải Nhà Cung Cấp...":"Chọn Nhà Cung Cấp..."}),l.map(Ve=>{const De=Ve.id!==null?`id:${Ve.id}`:`name:${Ve.name}`;return o.jsx("option",{value:De,children:Ve.name},De)}),o.jsx("option",{value:"__custom__",children:"Nhập tên Nhà Cung Cấp khác"})]}),o.jsx("button",{type:"button",className:"rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>W(e.id,"useCustomName",!0),disabled:we.isSaving,children:"Nhập"})]}):o.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ce&&o.jsxs("button",{type:"button",className:"flex items-center gap-1 rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>W(e.id,"useCustomName",!1),disabled:we.isSaving,children:[o.jsx("span",{className:"text-sm",children:"←"}),o.jsx("span",{className:"sr-only",children:"Chọn từ danh sách"})]}),o.jsx("input",{type:"text",className:"w-60 max-w-xs rounded-lg border border-indigo-300/60 bg-white/95 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200",placeholder:"Tên NCC",value:we.sourceName,onChange:Ve=>W(e.id,"sourceName",Ve.target.value),disabled:we.isSaving})]})})}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("input",{type:"text",className:"w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Giá nhập",value:we.price,onChange:Ve=>W(e.id,"price",Ve.target.value),disabled:we.isSaving}),o.jsx("span",{className:"text-xs text-white/70",children:"đ"})]})}),o.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:"-"}),o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>K(e),children:o.jsx(Ga,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>G(e.id),children:o.jsx(Dt,{className:"h-4 w-4"})})]})})]}),we.error&&o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:we.error})})]},`new-${e.id}`)}return null})})]})]})]})})})})]})},FU=ea.memo(IU),MU=({items:e,totalRows:t,currentPage:r,rowsPerPage:n,onPageChange:a,onRowsPerPageChange:i,isLoading:s,error:l,expandedProductId:c,supplyPriceMap:d,statusOverrides:u,updatedTimestampMap:f,supplierOptions:h,isLoadingSuppliers:m,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:y,newSupplyRows:b,editingProductId:w,productEditForm:N,productEditError:_,isSavingProductEdit:E,deleteProductState:S,onToggleProductDetails:j,onStartProductEdit:P,onProductEditChange:C,onCancelProductEdit:T,onSubmitProductEdit:k,onRequestDeleteProduct:W,onStartEditingSupply:G,onSupplyInputChange:K,onCancelSupplyEditing:J,onConfirmSupplyEditing:V,onStartAddSupplierRow:Z,onNewSupplierInputChange:Q,onCancelAddSupplierRow:Y,onConfirmAddSupplierRow:le,onDeleteSupplyRow:de,onToggleStatus:pe,fetchSupplyPricesForProduct:_e})=>{const q=Math.max(1,Math.ceil(t/n)),oe=Math.min(Math.max(r,1),q),ve=[10,20,50],O=ea.useMemo(()=>{const se=(X,fe)=>{X>=1&&X<=q&&fe.add(X)},ce=new Set([1,q]);se(oe-1,ce),se(oe,ce),se(oe+1,ce),oe<=2&&(se(2,ce),se(3,ce),se(4,ce)),oe>=q-1&&(se(q-1,ce),se(q-2,ce),se(q-3,ce));const Ae=Array.from(ce).sort((X,fe)=>X-fe),be=[];return Ae.forEach((X,fe)=>{fe>0&&X-Ae[fe-1]>1&&be.push("ellipsis"),be.push(X)}),be},[oe,q]),D=se=>{const ce=Math.min(Math.max(se,1),q);a(ce)},M="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 transition hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed",I="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 transition hover:bg-white/10",z="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]";return o.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/10 bg-white/10 text-white shadow-lg backdrop-blur",children:[o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[o.jsx("thead",{className:"bg-white/5",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Sản Phẩm"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Sỉ"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Lẻ"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Khuyến Mãi"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Tình Trạng Sản Phẩm"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Cập Nhật"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Thao Tác"})]})}),o.jsx("tbody",{className:"divide-y divide-white/10 bg-white/5",children:s?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"Đang Tải Dữ Liệu..."})}):e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Không thể tải dữ liệu. Vui lòng thử lại.":"Không có sản phẩm."})}):e.map(se=>{const ce=c===se.id,Ae=po(se.sanPhamRaw),be=d[Ae],X=b[se.id]||null,fe=S.product?.id===se.id&&S.loading;return o.jsx(FU,{item:se,productKey:Ae,isExpanded:ce,statusOverride:u[se.id],updatedTimestamp:f[se.id],supplyState:be,pendingNewSupply:X,supplierOptions:h,isLoadingSuppliers:m,editingProductId:w,productEditForm:N,productEditError:_,isSavingProductEdit:E,isDeletingProduct:fe,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:y,onToggleProductDetails:j,onStartProductEdit:P,onProductEditChange:C,onCancelProductEdit:T,onSubmitProductEdit:k,onRequestDeleteProduct:W,onStartEditingSupply:G,onSupplyInputChange:K,onCancelSupplyEditing:J,onConfirmSupplyEditing:V,onStartAddSupplierRow:Z,onNewSupplierInputChange:Q,onCancelAddSupplierRow:Y,onConfirmAddSupplierRow:le,onDeleteSupplyRow:de,onToggleStatus:pe,fetchSupplyPricesForProduct:_e},se.id)})})]})}),o.jsxs("div",{className:"flex flex-col gap-3 border-t border-white/10 bg-slate-950/70 px-4 py-3 text-sm text-white/80 md:flex-row md:items-center md:justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Hiển thị"}),o.jsx("select",{className:"rounded-lg border border-white/20 bg-slate-900 px-3 py-1 text-white shadow-sm focus:border-indigo-400 focus:outline-none",value:n,onChange:se=>i(Number(se.target.value)),children:ve.map(se=>o.jsx("option",{value:se,children:se},se))}),o.jsx("span",{children:"dòng"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[o.jsx("button",{className:M,onClick:()=>D(1),disabled:oe===1,"aria-label":"Trang đầu",children:"<<"}),o.jsx("button",{className:M,onClick:()=>D(oe-1),disabled:oe===1,"aria-label":"Trang trước",children:"<"}),O.map((se,ce)=>se==="ellipsis"?o.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${ce}`):o.jsx("button",{className:`${I} ${oe===se?z:""}`,onClick:()=>D(se),children:se},se)),o.jsx("button",{className:M,onClick:()=>D(oe+1),disabled:oe===q,"aria-label":"Trang sau",children:">"}),o.jsx("button",{className:M,onClick:()=>D(q),disabled:oe===q,"aria-label":"Trang cuối",children:">>"})]})]})]})},LU=({isOpen:e,createForm:t,createSuppliers:r,supplierOptions:n,bankOptions:a,isLoadingSuppliers:i,isLoadingBanks:s,isSubmitting:l,createError:c,onClose:d,onFormChange:u,onSupplierChange:f,onSupplierSelectChange:h,onSupplierPriceInput:m,onEnableCustomSupplier:x,onAddSupplier:g,onRemoveSupplier:v,onSubmit:y})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-black/40 px-2 py-4 sm:px-4 sm:py-6",children:o.jsxs("div",{className:"relative flex w-full max-w-5xl flex-col rounded-2xl bg-white shadow-2xl max-h-[95vh]",children:[o.jsx("button",{className:"absolute right-4 top-4 text-white/60 hover:text-white/70",onClick:d,children:o.jsx(Dt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto px-4 py-6 sm:px-6 sm:py-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-sky-100",children:"Thêm Sản Phẩm mới"}),o.jsx("p",{className:"text-base text-sky-200/90",children:"Nhập Thông tin Sản Phẩm, Nhà Cung Cấp, Tỷ Giá"})]}),o.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[o.jsxs("div",{className:"rounded-2xl border border-sky-100 bg-gradient-to-br from-white via-sky-50 to-sky-100/40 p-5 shadow-sm",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-600",children:"Thông Tin Sản Phẩm"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Sản Phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageName,onChange:b=>u("packageName",b.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gói Sản Phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageProduct,onChange:b=>u("packageProduct",b.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Mã Sản Phẩm"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.sanPham,onChange:b=>u("sanPham",b.target.value)})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-purple-100 bg-gradient-to-br from-white via-purple-50 to-purple-100/40 p-5 shadow-sm",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-600",children:"Tỷ Giá"}),o.jsxs("div",{className:"mt-4 space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tỷ Giá CTV"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctCtv,onChange:b=>u("pctCtv",b.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tỷ Giá Khách"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctKhach,onChange:b=>u("pctKhach",b.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tỷ Giá Khuyến Mãi"}),o.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctPromo,onChange:b=>u("pctPromo",b.target.value)})]})]})]})]}),o.jsx("div",{className:"rounded-2xl border border-gray-100 bg-gradient-to-br from-white via-gray-50 to-gray-100/40 p-5 shadow-sm",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Thông Tin Nhà Cung Cấp"}),o.jsx("div",{className:"space-y-4",children:r.map(b=>o.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/80 p-4 shadow-inner",children:[o.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[o.jsx("p",{className:"text-sm font-semibold text-white",children:"Nhà Cung Cấp"}),r.length>1&&o.jsx("button",{type:"button",className:"text-xs text-red-500 hover:text-red-600",onClick:()=>v(b.id),children:"Xóa"})]}),o.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tên Nhà Cung Cấp"}),o.jsxs("div",{className:"mt-1 flex items-stretch gap-2",children:[o.jsx("div",{className:"flex-1",children:b.useCustomName?o.jsx("input",{type:"text",className:"w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",placeholder:"Nhập tên Nhà Cung Cấp",value:b.sourceName,onChange:w=>f(b.id,"sourceName",w.target.value)}):o.jsxs("select",{className:"supplier-select w-full rounded-xl border border-gray-200 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:b.sourceId!==null?String(b.sourceId):b.sourceName,onChange:w=>h(b.id,w.target.value),children:[o.jsx("option",{value:"",children:i?"Đang tải Nhà Cung Cấp...":"Chọn Nhà Cung Cấp"}),n.map(w=>{const N=w.id!==null?String(w.id):w.name;return o.jsx("option",{value:N,children:w.name},N)})]})}),o.jsx("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-xl border border-blue-300/70 bg-white/90 text-blue-600 hover:bg-blue-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-60",onClick:()=>b.useCustomName?h(b.id,""):x(b.id),title:b.useCustomName?"Quay lại chọn Nhà Cung Cấp có sẵn":"Thêm Nhà Cung Cấp mới (điền tên thủ công)",children:b.useCustomName?o.jsx(LC,{className:"h-5 w-5"}):o.jsx(ta,{className:"h-5 w-5"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Giá Nhập"}),o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:wE(b.price),onChange:w=>m(b.id,w.target.value),placeholder:"0"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Số Tài Khoản"}),(()=>{const w=!b.useCustomName&&!!b.sourceId&&!!(b.bankBin||b.numberBank);return o.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:b.numberBank,onChange:N=>f(b.id,"numberBank",N.target.value),disabled:w,style:w?{opacity:.7,cursor:"not-allowed"}:void 0})})()]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Ngân Hàng"}),(()=>{const w=!b.useCustomName&&!!b.sourceId&&!!(b.bankBin||b.numberBank);return o.jsxs("select",{className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:b.bankBin,onChange:N=>f(b.id,"bankBin",N.target.value),disabled:w,style:w?{opacity:.7,cursor:"not-allowed"}:void 0,children:[o.jsx("option",{value:"",children:"Chọn Ngân Hàng"}),a.map(N=>o.jsx("option",{value:N.bin,children:N.name},N.bin))]})})(),s&&o.jsx("p",{className:"mt-1 text-[11px] text-white/60",children:"Đang Tải Danh Sách Ngân Hàng..."})]}),o.jsx("div",{className:"md:col-span-2",children:(()=>{const w=Number((b.price||"").replace(/\D+/g,"")),N=Tn(t.pctCtv),_=Tn(t.pctKhach),E=w&&N?Io(w,N):null,S=_&&(E||w)?Io(E||w,_):null;return o.jsxs("div",{className:"mt-3 rounded-xl border border-white/20 bg-white/10 px-4 py-3 shadow-inner",children:[o.jsx("p",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Xem trước giá"}),o.jsxs("div",{className:"mt-2 grid gap-3 md:grid-cols-2",children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Giá sỉ (theo Tỷ giá CTV)"}),o.jsx("span",{className:"text-sm font-semibold text-white",children:E?Zr(E):"-"})]}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Giá lẻ (theo Tỷ giá Khách)"}),o.jsx("span",{className:"text-sm font-semibold text-white",children:S?Zr(S):"-"})]})]})]})})()})]})]},b.id))}),o.jsx("div",{className:"flex justify-center",children:o.jsxs("button",{type:"button",className:"inline-flex items-center rounded-full border border-dashed border-blue-300 px-4 py-2 text-sm font-semibold text-blue-600 hover:border-blue-400 hover:text-blue-700",onClick:g,children:[o.jsx(JC,{className:"mr-2 h-4 w-4"}),"Thêm Nhà Cung Cấp"]})})]})}),c&&o.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:c}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:d,disabled:l,children:"Hủy Bỏ"}),o.jsx(Qn,{className:"px-5 py-2 text-sm font-semibold",onClick:y,disabled:l,children:l?"Đang Lưu...":"Lưu Sản Phẩm"})]})]})]})}):null,BU=({product:e,loading:t,error:r,onClose:n,onConfirm:a})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:()=>{t||n()},children:o.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:i=>i.stopPropagation(),children:[o.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xác Định Xóa"}),o.jsx("p",{className:"text-sm text-sky-200/90",children:"Hành động này sẽ Xóa Sản Phẩm khỏi bảng Giá."})]}),o.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:n,disabled:t,children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-bold text-sky-100",children:e.packageName||e.packageProduct||e.sanPhamRaw||`Sản Phẩm #${e.id}`}),o.jsxs("p",{className:"text-sm text-sky-200/90",children:["Mã: ",e.sanPhamRaw||"Không xác định"]})]}),o.jsx("p",{children:"Bạn có chắc chắn muốn xóa sản phẩm này? Hành động không thể hoàn tác và dữ liệu liên quan sẽ được cập nhật."})]}),r&&o.jsx("p",{className:"mt-4 text-xs text-red-500",children:r}),o.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[o.jsx("button",{type:"button",className:"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-white/70 hover:bg-indigo-500/10 disabled:opacity-50",onClick:n,disabled:t,children:"Hủy"}),o.jsx("button",{type:"button",className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60",onClick:a,disabled:t,children:t?"Đang Xóa...":"Xóa Sản Phẩm"})]})]})}):null,$U=e=>{const[t,r]=p.useState(""),[n,a]=p.useState("all"),[i,s]=p.useState(1),[l,c]=p.useState(10),[d,u]=p.useState([]),[f,h]=p.useState(!1),[m,x]=p.useState(null),[g,v]=p.useState(null),[y,b]=p.useState({}),[w,N]=p.useState({}),[_,E]=p.useState(!1),S=p.useCallback(async()=>{h(!0),x(null);try{const T=await fetch(`${e}${rt.PRODUCT_PRICES}`,{credentials:"include"});if(T.status===401){window.location.href="/login";return}if(!T.ok)throw new Error("Không thể tải dữ liệu sản phẩm.");const k=await T.json(),K=(Array.isArray(k)?k:Array.isArray(k?.items)?k.items:[]).map((V,Z)=>NE(V,Z)).map(V=>uo(V,V.baseSupplyPrice)),J=K.reduce((V,Z)=>(Z.lastUpdated&&(V[Z.id]=Z.lastUpdated),V),{});u(K),b({}),N(J)}catch(T){console.error("Lỗi khi tải dữ liệu:",T),u([]),x(T instanceof Error?T.message:"Không thể tải dữ liệu pricing.")}finally{h(!1)}},[e]),j=p.useMemo(()=>{const T=t.trim().toLowerCase();return d.filter(k=>n==="active"&&!k.isActive||n==="inactive"&&k.isActive?!1:T?[k.packageName,k.packageProduct,k.sanPhamRaw,k.variantLabel].join(" ").toLowerCase().includes(T):!0).sort((k,W)=>{const G=!(y[k.id]??k.isActive),K=!(y[W.id]??W.isActive);if(G!==K)return G?1:-1;const J=Gc(w[k.id]??k.lastUpdated),V=Gc(w[W.id]??W.lastUpdated);return J!==V?V-J:k.id-W.id})},[d,t,n,y,w]),P=p.useMemo(()=>{const T=(i-1)*l,k=T+l;return j.slice(T,k)},[j,i,l]),C=j.length;return{currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:c,totalRows:C,searchTerm:t,setSearchTerm:r,statusFilter:n,setStatusFilter:a,productPrices:d,setProductPrices:u,isLoading:f,setIsLoading:h,error:m,setError:x,statusOverrides:y,setStatusOverrides:b,updatedTimestampMap:w,setUpdatedTimestampMap:N,expandedProductId:g,setExpandedProductId:v,isRefreshing:_,setIsRefreshing:E,fetchProductPrices:S,filteredPricing:P}},UU=e=>({packageName:e.packageName||"",packageProduct:e.packageProduct||"",sanPham:e.sanPhamRaw||"",pctCtv:e.pctCtv!==null&&e.pctCtv!==void 0?String(e.pctCtv):"",pctKhach:e.pctKhach!==null&&e.pctKhach!==void 0?String(e.pctKhach):"",pctPromo:e.pctPromo!==null&&e.pctPromo!==void 0?String(e.pctPromo):""}),HU=({apiBase:e,productPrices:t,setProductPrices:r,fetchProductPrices:n,statusOverrides:a,setStatusOverrides:i,updatedTimestampMap:s,setUpdatedTimestampMap:l})=>{const[c,d]=p.useState(null),[u,f]=p.useState(null),[h,m]=p.useState(null),[x,g]=p.useState(!1),[v,y]=p.useState(!1),[b,w]=p.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[N,_]=p.useState([rf()]),[E,S]=p.useState(null),[j,P]=p.useState(!1),[C,T]=p.useState([]),[k,W]=p.useState(!1),[G,K]=p.useState([]),[J,V]=p.useState(!1),[Z,Q]=p.useState({product:null,loading:!1,error:null}),Y=p.useCallback(async()=>{if(!(J||G.length>0)){V(!0);try{const me=await fetch(`${e}${rt.BANK_LIST}`,{credentials:"include"});if(!me.ok)throw new Error("Không thể tải danh sách ngân hàng.");const we=await me.json(),he=Array.isArray(we)?we.map(Ce=>({bin:Ce?.bin?.toString().trim()??"",name:Ce?.bank_name?.toString().trim()??Ce?.name??""})).filter(Ce=>Ce.bin&&Ce.name):[];K(he)}catch(me){console.error("Lỗi khi tải danh sách ngân hàng:",me)}finally{V(!1)}}},[e,G.length,J]),le=p.useCallback(async()=>{if(!(k||C.length>0)){W(!0);try{const me=await fetch(`${e}${rt.SUPPLIES}`,{credentials:"include"});if(!me.ok)throw new Error("Không thể tải danh sách NCC.");const we=await me.json().catch(()=>null),Ce=(Array.isArray(we?.items)?we.items:Array.isArray(we)?we:[]).map(De=>{const je=De?.id??De?.sourceId??De?.source_id,Xe=typeof je=="number"&&Number.isFinite(je)?je:Number.isFinite(Number(je))?Number(je):null,tt=De?.supplier_name??De?.source_name??De?.name??De?.sourceName??De?.source??"";return{id:Xe??null,name:(tt||"").trim(),numberBank:De?.number_bank??De?.numberBank??De?.bankNumber??"",binBank:De?.bin_bank??De?.binBank??De?.bankBin??""}}).filter(De=>De.name.length>0),ge=[],Ve=new Set;for(const De of Ce){const je=De.id!==null?`id:${De.id}`:`name:${De.name.toLowerCase().trim()}`;Ve.has(je)||(Ve.add(je),ge.push(De))}T(ge)}catch(me){console.error("Lỗi khi tải danh sách NCC:",me)}finally{W(!1)}}},[e,k,C.length]);p.useEffect(()=>{!k&&C.length===0&&le()},[k,C.length,le]),p.useEffect(()=>{v&&G.length===0&&!J&&Y(),v&&C.length===0&&!k&&le()},[v,G.length,J,Y,C.length,k,le]);const de=(me,we)=>{if(me.stopPropagation(),g(!1),c===we.id){d(null),f(null),m(null);return}m(null),d(we.id),f(UU(we))},pe=(me,we)=>{f(he=>he&&{...he,[me]:we})},_e=()=>{d(null),f(null),m(null),g(!1)},q=async()=>{if(!u||c===null)return;const me=u.packageName?.trim()??"",we=u.packageProduct?.trim()??"",he=u.sanPham?.trim()??"";if(!he){m("Vui lòng nhập mã sản phẩm hợp lệ");return}const Ce=Tn(u.pctCtv),ge=Tn(u.pctKhach),Ve=Tn(u.pctPromo);if(!Ce||Ce<=0){m("Tỷ giá CTV phải lớn hơn 0");return}if(!ge||ge<=0){m("Tỷ giá Khách phải lớn hơn 0");return}if(Ve!==null){if(Ve<jh){m("Tỷ lệ khuyến mãi không được âm.");return}const De=Math.max(0,ge-1);if(De===0&&Ve>0){m("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(Ve>De){m(`Tỷ lệ khuyến mãi không được vượt ${De.toFixed(2)}`);return}}g(!0),m(null);try{const De=await fetch(`${e}${rt.PRODUCT_PRICE_DETAIL(c)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:me,packageProduct:we,sanPham:he,pctCtv:Ce,pctKhach:ge,pctPromo:Ve}),credentials:"include"}),je=await De.text();let Xe=null;if(je)try{Xe=JSON.parse(je)}catch{Xe=null}if(!De.ok){const Ue=Xe?.error||je?.trim()||"Không thể cập nhật giá sản phẩm";throw new Error(Ue)}const tt=NE(Xe,c);r(Ue=>Ue.map(Le=>Le.id===c?tt:Le)),tt?.id!==void 0&&l(Ue=>({...Ue,[tt.id]:tt.lastUpdated||new Date().toISOString()})),await n(),d(null),f(null)}catch(De){console.error("Lỗi khi cập nhật giá sản phẩm:",De),m(De instanceof Error?De.message:"Không thể cập nhật giá sản phẩm")}finally{g(!1)}},oe=p.useCallback((me,we)=>{me.stopPropagation(),Q({product:we,loading:!1,error:null})},[]),ve=p.useCallback(()=>{Q({product:null,loading:!1,error:null})},[]),O=p.useCallback(async()=>{const me=Z.product;if(me){Q(we=>({...we,loading:!0,error:null}));try{const we=await xU(me.id);if(!we.success)throw new Error(we.message||"Không thể xóa sản phẩm.");r(he=>he.filter(Ce=>Ce.id!==me.id)),i(he=>{const Ce={...he};return delete Ce[me.id],Ce}),l(he=>{const Ce={...he};return delete Ce[me.id],Ce}),ve()}catch(we){console.error("Failed to delete product price:",we),Q(he=>({...he,loading:!1,error:we instanceof Error?we.message:"Không thể xóa sản phẩm. Vui lòng thử lại."}))}}},[ve,Z.product,r,i,l]),D=()=>{w({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),_([rf()]),S(null),P(!1)},M=()=>{D(),y(!0),G.length===0&&!J&&Y(),C.length===0&&!k&&le()},I=()=>{y(!1),D()};return{editingProductId:c,productEditForm:u,productEditError:h,isSavingProductEdit:x,isCreateModalOpen:v,createForm:b,createSuppliers:N,createError:E,isSubmittingCreate:j,supplierOptions:C,isLoadingSuppliers:k,bankOptions:G,isLoadingBanks:J,deleteProductState:Z,handleStartProductEdit:de,handleProductEditChange:pe,handleCancelProductEdit:_e,handleSubmitProductEdit:q,handleRequestDeleteProduct:oe,confirmDeleteProduct:O,closeDeleteProductModal:ve,handleOpenCreateModal:M,handleCloseCreateModal:I,handleCreateFormChange:(me,we)=>{w(he=>({...he,[me]:we}))},handleSupplierChange:(me,we,he)=>{_(Ce=>Ce.map(ge=>ge.id===me?{...ge,[we]:we==="sourceId"?he&&Number(he)||null:we==="useCustomName"?he==="true":he}:ge))},handleSupplierSelectChange:(me,we)=>{const he=C.find(Ce=>Ce.id!==null&&we===String(Ce.id)||Ce.id===null&&we===Ce.name)||null;_(Ce=>Ce.map(ge=>ge.id===me?{...ge,sourceId:he?.id??null,sourceName:he?.name??"",numberBank:he?.numberBank??"",bankBin:he?.binBank??"",useCustomName:!1}:ge))},handleSupplierPriceInput:(me,we)=>{const he=Ah(we);_(Ce=>Ce.map(ge=>ge.id===me?{...ge,price:he}:ge))},handleEnableCustomSupplier:me=>{_(we=>we.map(he=>he.id===me?{...he,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:he))},handleAddSupplierRow:()=>{_(me=>[...me,rf()])},handleRemoveSupplierRow:me=>{_(we=>we.length===1?we:we.filter(he=>he.id!==me))},handleSubmitCreateProduct:async()=>{const me=b.packageName.trim(),we=b.packageProduct.trim(),he=b.sanPham.trim(),Ce=Tn(b.pctCtv),ge=Tn(b.pctKhach),Ve=Tn(b.pctPromo);if(!he){S("Vui lòng nhập mã sản phẩm");return}if(Ce!==null&&Ce<=0){S("Tỷ giá CTV phải lớn hơn 0.");return}if(ge!==null&&ge<=0){S("Tỷ giá khách phải lớn hơn 0.");return}if(Ve!==null){if(Ve<jh){S("Tỷ lệ khuyến mãi không được âm.");return}if(ge!==null&&ge>0){const je=Math.max(0,ge-1);if(je===0&&Ve>0){S("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(Ve>je){S(`Tỷ lệ khuyến mãi không được vượt ${je.toFixed(2)}`);return}}}const De=N.map(je=>{const Xe=je.sourceName.trim(),tt=Number((je.price||"").replace(/\D+/g,"")),Ue=Number.isFinite(tt)&&tt>0?tt:null;return!Xe&&Ue===null?null:{sourceId:je.sourceId!==null&&Number.isFinite(je.sourceId)?je.sourceId:void 0,sourceName:Xe||void 0,price:Ue,numberBank:je.numberBank.trim()||void 0,binBank:je.bankBin.trim()||void 0}}).filter(je=>!!(je&&(je.sourceId!==void 0||je.sourceName)));P(!0),S(null);try{const je=await fetch(`${e}${rt.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:me,packageProduct:we,sanPham:he,pctCtv:Ce,pctKhach:ge,pctPromo:Ve,suppliers:De}),credentials:"include"}),Xe=await je.text();let tt=null;if(Xe)try{tt=JSON.parse(Xe)}catch{tt=null}if(!je.ok){const Ue=tt?.error||Xe?.trim()||"Không thể tạo sản phẩm";throw new Error(Ue)}await n(),I()}catch(je){console.error("Lỗi khi tạo sản phẩm:",je),S(je instanceof Error?je.message:"Không thể tạo sản phẩm")}finally{P(!1)}},handleToggleStatus:async me=>{const he=!(a[me.id]??me.isActive??!1),Ce=a[me.id],ge=s[me.id],Ve=new Date().toISOString();i(De=>({...De,[me.id]:he})),r(De=>De.map(je=>je.id===me.id?{...je,isActive:he}:je)),l(De=>({...De,[me.id]:Ve}));try{const De=await fetch(`${e}${rt.PRODUCT_PRICES}/${me.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:he}),credentials:"include"});if(!De.ok)throw new Error("Lỗi khi cập nhật trạng thái");const je=await De.json(),Xe=je?.is_active??he,tt=typeof je?.update=="string"?je.update:Ve;i(Ue=>({...Ue,[me.id]:Xe})),r(Ue=>Ue.map(Le=>Le.id===me.id?{...Le,isActive:Xe,lastUpdated:tt}:Le)),l(Ue=>({...Ue,[me.id]:tt}))}catch(De){console.error("Failed to toggle product status:",De),i(je=>{const Xe={...je};return Ce===void 0?delete Xe[me.id]:Xe[me.id]=Ce,Xe}),r(je=>je.map(Xe=>Xe.id===me.id?{...Xe,isActive:Ce??me.isActive??!1}:Xe)),l(je=>{const Xe={...je};return ge?Xe[me.id]=ge:delete Xe[me.id],Xe}),alert("Cập nhật thất bại. Vui lòng thử lại")}}}},WU=({apiBase:e,setProductPrices:t,fetchProductPrices:r})=>{const[n,a]=p.useState({}),[i,s]=p.useState({}),[l,c]=p.useState({}),[d,u]=p.useState({}),[f,h]=p.useState({}),[m,x]=p.useState({}),g=p.useCallback(async C=>{const T=po(C);if(T){a(k=>({...k,[T]:{items:k[T]?.items??[],loading:!0,error:null,productName:k[T]?.productName??C}}));try{const k=await fetch(`${e}${rt.SUPPLY_PRICES_BY_PRODUCT_NAME(C)}`,{credentials:"include"});if(!k.ok)throw new Error("Không thể tải giá nguồn. Vui lòng thử lại.");const W=await k.json(),G=Array.isArray(W)?W.map((V,Z)=>({sourceId:Number.isFinite(Number(V?.sourceId??V?.source_id))?Number(V?.sourceId??V?.source_id):Z,sourceName:V?.supplier_name?.toString().trim()||V?.sourceName?.toString().trim()||V?.source_name?.toString().trim()||`Nhà Cung Cấp #${Number(V?.sourceId)||Z+1}`,price:typeof V?.price=="number"&&Number.isFinite(V.price)?V.price:null,lastOrderDate:typeof V?.last_order_date=="string"?V.last_order_date:null})):[],K=Ll(PU(G)),J=$a(K,null);typeof J=="number"&&Number.isFinite(J)&&J>0&&t(V=>{let Z=!1;const Q=V.map(Y=>{if(po(Y.sanPhamRaw)!==T)return Y;const le=typeof Y.baseSupplyPrice=="number"&&Number.isFinite(Y.baseSupplyPrice)&&Math.abs(Y.baseSupplyPrice-J)<1e-5,de=typeof Y.wholesalePrice=="number"&&Number.isFinite(Y.wholesalePrice)&&Y.wholesalePrice>0,pe=typeof Y.retailPrice=="number"&&Number.isFinite(Y.retailPrice)&&Y.retailPrice>0,_e=Vc(Y.pctPromo,Y.pctKhach,Y.pctCtv),q=typeof Y.promoPrice=="number"&&Number.isFinite(Y.promoPrice)&&Y.promoPrice>0;return le&&de&&pe&&(!_e||q)?Y:(Z=!0,uo({...Y,baseSupplyPrice:J},J))});return Z?Q:V}),a(V=>({...V,[T]:{loading:!1,error:null,items:K,productName:C}}))}catch(k){a(W=>({...W,[T]:{loading:!1,items:W[T]?.items??[],error:k instanceof Error?k.message:"Không thể tải giá nguồn. Vui lòng thử lại.",productName:W[T]?.productName??C}}))}}},[e,t]),v=C=>{s(T=>{const k={...T};return delete k[C],k}),c(T=>{const k={...T};return delete k[C],k}),h(T=>{const k={...T};return delete k[C],k})},y=(C,T,k)=>{const W=ts(C,T);s(G=>({...G,[W]:!0})),c(G=>({...G,[W]:k==null?"":wE(k)})),h(G=>({...G,[W]:null}))},b=(C,T,k)=>{const W=ts(C,T),G=Ah(k);c(K=>({...K,[W]:G})),h(K=>({...K,[W]:null}))},w=(C,T)=>{const k=ts(C,T);v(k),u(W=>{const G={...W};return delete G[k],G})},N=async(C,T,k,W)=>{const G=ts(C,T),J=l[G]?.toString().trim()??"";if(!J){h(Z=>({...Z,[G]:"Vui lòng nhập giá hợp lệ."}));return}const V=Number(J.replace(/\D+/g,""));if(!Number.isFinite(V)||V<0){h(Z=>({...Z,[G]:"Giá nhập không được thấp hơn 0."}));return}u(Z=>({...Z,[G]:!0}));try{const Z=await fetch(`${e}${rt.UPDATE_SUPPLY_PRICE(C,T)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:V}),credentials:"include"}),Q=await Z.json().catch(()=>null);if(!Z.ok)throw new Error(Q?.error||"Không thể cập nhật giá nguồn.");const Y=Number.isFinite(Number(Q?.price))?Number(Q?.price):V;let le=null,de=!1;if(a(pe=>{const _e=pe[k];if(!_e)return pe;const q=$a(_e.items,null),oe=_e.items.find(se=>se.sourceId===T),ve=typeof oe?.price=="number"?oe.price:null,O=typeof ve=="number"&&typeof q=="number"&&Math.abs(ve-q)<1e-5,D=Ll(_e.items.map(se=>se.sourceId===T?{...se,price:Y}:se)),M=$a(D,null),I=ve===null||ve!==Y;return typeof M=="number"&&Number.isFinite(M)&&M>0?(le=M,(M!==q||O&&I)&&(de=!0)):O&&I&&(le=M??null,de=!0),{...pe,[k]:{..._e,items:D}}}),de&&t(pe=>pe.map(_e=>_e.id===C?uo(_e,le):_e)),v(G),await g(W),de)try{await r()}catch(pe){console.error("Failed to refresh product pricing:",pe)}}catch(Z){h(Q=>({...Q,[G]:Z instanceof Error?Z.message:"Không thể cập nhật giá nguồn."}))}finally{u(Z=>{const Q={...Z};return delete Q[G],Q})}},_=C=>{x(T=>T[C]?T:{...T,[C]:{sourceName:"",sourceId:null,useCustomName:!1,price:"",error:null,isSaving:!1}})},E=(C,T,k)=>{let W=k;if(T==="price")W=Ah(String(k??""));else if(T==="sourceId"){const G=Number(k);W=k===null||Number.isNaN(G)||!Number.isFinite(G)?null:G}else T==="useCustomName"?W=!!k:W=String(k??"");x(G=>{const K=G[C];if(!K)return G;const J={...K,[T]:W,error:null};return T==="useCustomName"&&(W?(J.sourceId=null,J.sourceName=""):!J.sourceName&&K.sourceName&&(J.sourceName=K.sourceName)),{...G,[C]:J}})},S=C=>{x(T=>{const k={...T};return delete k[C],k})};return{supplyPriceMap:n,editingSupplyRows:i,supplyPriceDrafts:l,savingSupplyRows:d,supplyRowErrors:f,newSupplyRows:m,fetchSupplyPricesForProduct:g,handleStartEditingSupply:y,handleSupplyInputChange:b,handleCancelSupplyEditing:w,handleConfirmSupplyEditing:N,handleStartAddSupplierRow:_,handleNewSupplierInputChange:E,handleCancelAddSupplierRow:S,handleConfirmAddSupplierRow:async C=>{const T=m[C.id];if(!T)return;const k=T.sourceName.trim(),W=T.useCustomName||T.sourceId===null?null:T.sourceId,G=Number((T.price||"").replace(/\D+/g,""));if(!k){x(K=>({...K,[C.id]:{...T,error:"Vui lòng chọn hoặc nhập tên nguồn hợp lệ."}}));return}if(!Number.isFinite(G)||G<=0){x(K=>({...K,[C.id]:{...T,error:"Giá nhập phải lớn hơn 0."}}));return}x(K=>({...K,[C.id]:{...T,isSaving:!0,error:null}}));try{const K=await fetch(`${e}${rt.CREATE_SUPPLY_PRICE(C.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:k,sourceId:W,price:G}),credentials:"include"}),J=await K.json().catch(()=>null);if(!K.ok)throw new Error(J?.error||"Không thể thêm nguồn mới.");const V=po(C.sanPhamRaw),Z=Number(J?.sourceId),Y=(typeof W=="number"&&Number.isFinite(W)&&W>0?W:null)??Date.now(),le=Number.isFinite(Z)&&Z>0?Z:Y,de=Number.isFinite(Number(J?.price))?Number(J?.price):G;let pe=null,_e=!1;if(a(q=>{const oe=q[V],ve=oe?.items??[],O=ve.some(se=>se.sourceId===le),D=Ll(O?ve.map(se=>se.sourceId===le?{...se,price:de}:se):[...ve,{sourceId:le,sourceName:k,price:de,lastOrderDate:null}]),M=$a(ve,null),I=$a(D,null);return(typeof M=="number"&&typeof I=="number"?Math.abs(I-M)>1e-5:M!==I)&&(_e=!0),pe=I,{...q,[V]:{loading:oe?.loading??!1,error:null,items:D}}}),_e&&t(q=>q.map(oe=>oe.id===C.id?uo(oe,pe):oe)),await g(C.sanPhamRaw),S(C.id),_e)try{await r()}catch(q){console.error("Failed to refresh product pricing:",q)}}catch(K){x(J=>({...J,[C.id]:{...T,isSaving:!1,error:K instanceof Error?K.message:"Không thể thêm nguồn mới."}}))}},handleDeleteSupplyRow:async(C,T,k,W)=>{const G=ts(C,T);h(V=>({...V,[G]:null})),u(V=>({...V,[G]:!0}));let K=null,J=!1;try{const V=await fetch(`${e}${rt.DELETE_SUPPLY_PRICE(C,T)}`,{method:"DELETE",credentials:"include"}),Z=await V.json().catch(()=>null);if(!V.ok)throw new Error(Z?.error||"Không thể xóa nguồn này.");if(a(Q=>{const Y=Q[k];if(!Y)return Q;const le=Ll(Y.items.filter(q=>q.sourceId!==T)),de=$a(Y.items,null),pe=$a(le,null);return(typeof de=="number"&&typeof pe=="number"?Math.abs(pe-de)>1e-5:de!==pe)&&(J=!0),K=pe,{...Q,[k]:{...Y,items:le}}}),v(G),J&&t(Q=>Q.map(Y=>Y.id===C?uo(Y,K):Y)),await g(W),J)try{await r()}catch(Q){console.error("Failed to refresh product pricing:",Q)}}catch(V){h(Z=>({...Z,[G]:V instanceof Error?V.message:"Không thể xóa nguồn này."}))}finally{u(V=>{const Z={...V};return delete Z[G],Z})}}}};var KU={};const af=typeof import.meta<"u"&&"https://admin.mavrykpremium.store"||typeof process<"u"&&KU?.VITE_API_BASE_URL||""||"http://localhost:3001",zU=()=>{const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:c,productPrices:d,setProductPrices:u,isLoading:f,error:h,statusOverrides:m,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v,expandedProductId:y,setExpandedProductId:b,isRefreshing:w,setIsRefreshing:N,fetchProductPrices:_,filteredPricing:E}=$U(af),S=WU({apiBase:af,setProductPrices:u,fetchProductPrices:_}),{supplyPriceMap:j,fetchSupplyPricesForProduct:P}=S,C=HU({apiBase:af,productPrices:d,setProductPrices:u,fetchProductPrices:_,statusOverrides:m,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v});p.useEffect(()=>{_()},[_]);const T=p.useCallback(async()=>{if(!w){N(!0);try{await _();const G=new Set;Object.values(j).forEach(K=>{K?.productName&&G.add(K.productName)}),await Promise.all(Array.from(G).map(K=>P(K)))}catch(G){console.error("Failed to refresh pricing data:",G)}finally{N(!1)}}},[w,_,N,j,P]),k=G=>{const K=y===G.id?null:G.id;if(b(K),K===G.id){const J=po(G.sanPhamRaw),V=S.supplyPriceMap[J];(!V||!V.loading&&V.items.length===0)&&S.fetchSupplyPricesForProduct(G.sanPhamRaw)}},W=p.useMemo(()=>{const G=d.length,K=d.filter(V=>V.isActive).length,J=G-K;return[{name:"Tổng Sản Phẩm",value:G.toString(),icon:Kh,accent:"emerald",subtitle:"Tất cả sản phẩm"},{name:"Đang Hoạt Động",value:K.toString(),icon:Wh,accent:"sky",subtitle:"Sẵn sàng bán"},{name:"Tạm Dừng",value:J.toString(),icon:ps,accent:"violet",subtitle:"Đang ẩn trên bảng giá"}]},[d]);return{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:c,filteredPricing:E,pricingStats:W,isLoading:f,error:h,isRefreshing:w,expandedProductId:y,supplyPriceMap:j,editingSupplyRows:S.editingSupplyRows,supplyPriceDrafts:S.supplyPriceDrafts,savingSupplyRows:S.savingSupplyRows,supplyRowErrors:S.supplyRowErrors,newSupplyRows:S.newSupplyRows,editingProductId:C.editingProductId,productEditForm:C.productEditForm,productEditError:C.productEditError,isSavingProductEdit:C.isSavingProductEdit,isCreateModalOpen:C.isCreateModalOpen,createForm:C.createForm,createSuppliers:C.createSuppliers,createError:C.createError,isSubmittingCreate:C.isSubmittingCreate,supplierOptions:C.supplierOptions,isLoadingSuppliers:C.isLoadingSuppliers,bankOptions:C.bankOptions,isLoadingBanks:C.isLoadingBanks,statusOverrides:m,updatedTimestampMap:g,deleteProductState:C.deleteProductState,handleRefreshAll:T,handleToggleProductDetails:k,handleStartEditingSupply:S.handleStartEditingSupply,handleSupplyInputChange:S.handleSupplyInputChange,handleCancelSupplyEditing:S.handleCancelSupplyEditing,handleConfirmSupplyEditing:S.handleConfirmSupplyEditing,handleStartAddSupplierRow:S.handleStartAddSupplierRow,handleNewSupplierInputChange:S.handleNewSupplierInputChange,handleCancelAddSupplierRow:S.handleCancelAddSupplierRow,handleConfirmAddSupplierRow:S.handleConfirmAddSupplierRow,handleDeleteSupplyRow:S.handleDeleteSupplyRow,handleStartProductEdit:C.handleStartProductEdit,handleProductEditChange:C.handleProductEditChange,handleCancelProductEdit:C.handleCancelProductEdit,handleSubmitProductEdit:C.handleSubmitProductEdit,handleRequestDeleteProduct:C.handleRequestDeleteProduct,confirmDeleteProduct:C.confirmDeleteProduct,closeDeleteProductModal:C.closeDeleteProductModal,handleOpenCreateModal:C.handleOpenCreateModal,handleCloseCreateModal:C.handleCloseCreateModal,handleCreateFormChange:C.handleCreateFormChange,handleSupplierChange:C.handleSupplierChange,handleSupplierSelectChange:C.handleSupplierSelectChange,handleSupplierPriceInput:C.handleSupplierPriceInput,handleEnableCustomSupplier:C.handleEnableCustomSupplier,handleAddSupplierRow:C.handleAddSupplierRow,handleRemoveSupplierRow:C.handleRemoveSupplierRow,handleSubmitCreateProduct:C.handleSubmitCreateProduct,handleToggleStatus:C.handleToggleStatus,fetchSupplyPricesForProduct:S.fetchSupplyPricesForProduct}};function VU(){const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,totalRows:a,currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:c,pricingStats:d,filteredPricing:u,isLoading:f,error:h,isRefreshing:m,expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:y,editingSupplyRows:b,supplyPriceDrafts:w,savingSupplyRows:N,supplyRowErrors:_,newSupplyRows:E,editingProductId:S,productEditForm:j,productEditError:P,isSavingProductEdit:C,deleteProductState:T,isCreateModalOpen:k,createForm:W,createSuppliers:G,createError:K,isSubmittingCreate:J,supplierOptions:V,isLoadingSuppliers:Z,bankOptions:Q,isLoadingBanks:Y,handleRefreshAll:le,handleToggleProductDetails:de,handleStartProductEdit:pe,handleProductEditChange:_e,handleCancelProductEdit:q,handleSubmitProductEdit:oe,handleRequestDeleteProduct:ve,confirmDeleteProduct:O,closeDeleteProductModal:D,handleStartEditingSupply:M,handleSupplyInputChange:I,handleCancelSupplyEditing:z,handleConfirmSupplyEditing:se,handleStartAddSupplierRow:ce,handleNewSupplierInputChange:Ae,handleCancelAddSupplierRow:be,handleConfirmAddSupplierRow:X,handleDeleteSupplyRow:fe,handleToggleStatus:Oe,handleOpenCreateModal:Me,handleCloseCreateModal:me,handleCreateFormChange:we,handleSupplierChange:he,handleSupplierSelectChange:Ce,handleSupplierPriceInput:ge,handleEnableCustomSupplier:Ve,handleAddSupplierRow:De,handleRemoveSupplierRow:je,handleSubmitCreateProduct:Xe,fetchSupplyPricesForProduct:tt}=zU();return o.jsxs(o.Fragment,{children:[o.jsx(BU,{product:T.product,loading:T.loading,error:T.error,onClose:D,onConfirm:O}),o.jsx(LU,{isOpen:k,createForm:W,createSuppliers:G,supplierOptions:V,bankOptions:Q,isLoadingSuppliers:Z,isLoadingBanks:Y,createError:K,isSubmitting:J,onClose:me,onFormChange:we,onSupplierChange:he,onSupplierSelectChange:Ce,onSupplierPriceInput:ge,onEnableCustomSupplier:Ve,onAddSupplier:De,onRemoveSupplier:je,onSubmit:Xe,parseRatioInput:Tn}),o.jsxs("div",{className:"space-y-6",children:[o.jsx(SU,{stats:d,onAddProduct:Me}),o.jsx(_U,{searchTerm:e,statusFilter:r,isLoading:f,isRefreshing:m,error:h,onSearchChange:t,onStatusChange:n,onRefresh:le}),o.jsx(MU,{items:u,isLoading:f,error:h,totalRows:a,currentPage:i,rowsPerPage:l,onPageChange:s,onRowsPerPageChange:Ue=>{c(Ue),s(1)},expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:y,supplierOptions:V,isLoadingSuppliers:Z,editingSupplyRows:b,supplyPriceDrafts:w,savingSupplyRows:N,supplyRowErrors:_,newSupplyRows:E,editingProductId:S,productEditForm:j,productEditError:P,isSavingProductEdit:C,deleteProductState:T,onToggleProductDetails:de,onStartProductEdit:pe,onProductEditChange:_e,onCancelProductEdit:q,onSubmitProductEdit:oe,onRequestDeleteProduct:ve,onStartEditingSupply:M,onSupplyInputChange:I,onCancelSupplyEditing:z,onConfirmSupplyEditing:se,onStartAddSupplierRow:ce,onNewSupplierInputChange:Ae,onCancelAddSupplierRow:be,onConfirmAddSupplierRow:X,onDeleteSupplyRow:fe,onToggleStatus:Oe,fetchSupplyPricesForProduct:tt})]})]})}const GU=()=>{const e=p.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]);return o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:o.jsxs("linearGradient",{id:e,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[o.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),o.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),o.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),o.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[o.jsx("div",{className:"retro-grid"}),o.jsx("div",{className:"retro-sun"}),o.jsx("div",{className:"retro-planet"}),o.jsx("div",{className:"retro-glow"})]})]})},YU=({children:e})=>o.jsxs("div",{className:"retro-card",children:[o.jsx("div",{className:"card-top",children:o.jsxs("div",{className:"title",children:[o.jsx("p",{className:"eyebrow",children:"Chào mừng trở lại"}),o.jsx("h1",{className:"gradient-title",children:"Mavryk Premium"}),o.jsx("p",{className:"subtitle",children:"Nhập thông tin của bạn để vào trang quản trị."})]})}),e]}),XU=({email:e,password:t,loading:r,error:n,onEmailChange:a,onPasswordChange:i,onSubmit:s})=>o.jsxs("form",{className:"form",onSubmit:s,children:[o.jsxs("label",{className:"field",children:[o.jsx("span",{children:"Tài khoản"}),o.jsx("input",{type:"text",required:!0,value:e,onChange:l=>a(l.target.value),placeholder:"Nhập tên đăng nhập"})]}),o.jsxs("label",{className:"field",children:[o.jsx("span",{children:"Mật khẩu"}),o.jsx("input",{type:"password",required:!0,value:t,onChange:l=>i(l.target.value),placeholder:"Nhập mật khẩu"})]}),o.jsxs("div",{className:"controls",children:[o.jsxs("label",{className:"remember",children:[o.jsx("input",{type:"checkbox",defaultChecked:!0}),o.jsx("span",{children:"Ghi nhớ đăng nhập"})]}),o.jsx("button",{type:"button",className:"ghost",children:"Quên mật khẩu?"})]}),o.jsx("button",{type:"submit",className:"cta",disabled:r,children:r?"Đang đăng nhập...":"Đăng nhập"}),n&&o.jsx("p",{className:"error-msg",children:n})]}),qU=()=>{const[e,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState(null),[s,l]=p.useState(!1),{setUser:c}=Yh(),d=Qb();return{email:e,password:r,error:a,loading:s,setEmail:t,setPassword:n,handleSubmit:f=>{f.preventDefault(),i(null),l(!0),Ze("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async h=>{if(!h.ok){const x=await h.json().catch(()=>({}));throw new Error(x.error||"Login failed")}const m=await h.json();c(m.user||null),d("/dashboard",{replace:!0})}).catch(h=>{i(h instanceof Error?h.message:"Login failed")}).finally(()=>l(!1))}}},ZU=()=>{const{email:e,password:t,error:r,loading:n,setEmail:a,setPassword:i,handleSubmit:s}=qU();return o.jsx("div",{className:"retro-login",children:o.jsxs("div",{className:"retro-shell",children:[o.jsx(GU,{}),o.jsx(YU,{children:o.jsx(XU,{email:e,password:t,loading:n,error:r,onEmailChange:a,onPasswordChange:i,onSubmit:s})})]})})},JU=async e=>{const t=await Ze(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Nguồn đã được xóa trước đó."};if(!t.ok){const n=await t.text();throw new Error(n||"Không thể xóa nguồn.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},QU=({stats:e})=>o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx(pa,{title:"Tổng NCC",value:e.totalSuppliers,icon:qC,accent:xr.sky}),o.jsx(pa,{title:"Đang hoạt động",value:e.activeSuppliers,icon:ms,accent:xr.emerald}),o.jsx(pa,{title:"Tổng đơn",value:e.monthlyOrders,icon:Gh,accent:xr.violet}),o.jsx(pa,{title:"Tổng nhập",value:aB(e.totalImportValue),icon:Kh,accent:xr.amber})]}),eb=e=>e.trim().toLowerCase(),sf=e=>{const r=String(e||"").replace(/[^\d-]/g,""),n=r.startsWith("-")?"-"+r.slice(1).replace(/-/g,""):r.replace(/-/g,""),a=Number(n);return Number.isFinite(a)?a:0},eH=qp,tb=Mn,tH=({supplyId:e,onRefreshSupplies:t})=>{const[r,n]=p.useState([]),[a,i]=p.useState(!1),[s,l]=p.useState({round:"",import:"",paid:"",isEditing:!1}),[c,d]=p.useState(null),[u,f]=p.useState(""),h=y=>{const b=String(y||"").replace(/[^\d-]/g,""),w=b.startsWith("-")?"-"+b.slice(1).replace(/-/g,""):b.replace(/-/g,"");if(w==="-")return"-";const N=Number(w);return Number.isFinite(N)?N.toLocaleString("vi-VN"):""},m=p.useCallback(async()=>{i(!0);try{const y=await Ze(`/api/supplies/${e}/payments?offset=0&limit=20`);if(y.ok){const b=await y.json();n(b.payments||[])}}finally{i(!1)}},[e]);p.useEffect(()=>{m()},[m]);const x=async()=>{if(s.round)try{const y={round:s.round,totalImport:sf(s.import),paid:sf(s.paid),status:"Chưa Thanh Toán"};(await Ze(`/api/supplies/${e}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).ok&&(l({round:"",import:"",paid:"",isEditing:!1}),m(),t?.())}catch(y){console.error(y)}},g=async y=>{try{await Ze(`/api/supplies/${e}/payments/${y}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:sf(u)})}),d(null),m(),t?.()}catch(b){console.error(b)}},v=y=>(y||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();return o.jsxs("div",{className:"bg-slate-900/80 rounded-xl border border-white/10 overflow-hidden",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center",children:[o.jsx("h4",{className:"text-sm font-semibold text-white",children:"Lịch Sử Thanh Toán"}),o.jsxs("button",{onClick:()=>l({...s,isEditing:!0}),className:"text-xs flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-white transition",children:[o.jsx(ta,{className:"h-3 w-3"})," Thêm Chu Kỳ"]})]}),o.jsxs("table",{className:"w-full text-sm text-left text-white/80",children:[o.jsx("thead",{className:"bg-white/5 text-xs uppercase text-white/60",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2",children:"Chu Kỳ"}),o.jsx("th",{className:"px-4 py-2",children:"Tổng Nhập"}),o.jsx("th",{className:"px-4 py-2",children:"Đã Thanh Toán"}),o.jsx("th",{className:"px-4 py-2",children:"Trạng Thái"}),o.jsx("th",{className:"px-4 py-2 text-right",children:"Thao Tác"})]})}),o.jsxs("tbody",{className:"divide-y divide-white/5",children:[s.isEditing&&o.jsxs("tr",{className:"bg-indigo-500/10",children:[o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"Tên chu kỳ...",value:s.round,onChange:y=>l({...s,round:y.target.value})})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:s.import,onChange:y=>l({...s,import:h(y.target.value)})})}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:s.paid,onChange:y=>l({...s,paid:h(y.target.value)})})}),o.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"Mới"}),o.jsxs("td",{className:"px-4 py-2 text-right",children:[o.jsx("button",{onClick:x,className:"text-emerald-400 hover:text-emerald-300 mr-2",children:o.jsx(Ga,{className:"h-5 w-5 inline"})}),o.jsx("button",{onClick:()=>l({...s,isEditing:!1}),className:"text-rose-400 hover:text-rose-300",children:o.jsx(Dt,{className:"h-5 w-5 inline"})})]})]}),a?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"text-center py-4",children:"Đang tải..."})}):r.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"text-center py-4 opacity-50",children:"Chưa có dữ liệu thanh toán"})}):r.map(y=>{const b=v(y.status)==="chua thanh toan";return o.jsxs("tr",{className:"hover:bg-white/5",children:[o.jsx("td",{className:"px-4 py-2",children:y.round}),o.jsx("td",{className:"px-4 py-2",children:c===y.id?o.jsx("input",{className:"bg-black/20 border border-white/20 rounded px-1 w-24 text-right",value:u,onChange:w=>f(h(w.target.value))}):tb(y.totalImport)}),o.jsx("td",{className:"px-4 py-2",children:tb(y.paid)}),o.jsx("td",{className:"px-4 py-2",children:y.status}),o.jsx("td",{className:"px-4 py-2 text-right",children:c===y.id?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>g(y.id),className:"text-emerald-400 mr-2",children:o.jsx(Ga,{className:"h-4 w-4 inline"})}),o.jsx("button",{onClick:()=>d(null),className:"text-rose-400",children:o.jsx(Dt,{className:"h-4 w-4 inline"})})]}):b&&o.jsx("button",{onClick:()=>{d(y.id),f(y.totalImport.toLocaleString("vi-VN"))},className:"text-white/40 hover:text-blue-300",children:o.jsx(zo,{className:"h-4 w-4 inline"})})})]},y.id)})]})]})]})},Bl=Mn,rH=e=>e?Ot(e):"--",nH=({supplies:e,loading:t,expandedId:r,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l,onRefreshSupplies:c})=>o.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden shadow-2xl backdrop-blur-sm",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-left",children:[o.jsx("thead",{className:"bg-black/20 text-xs uppercase text-white/60 font-semibold",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3",children:"Nhà cung cấp"}),o.jsx("th",{className:"px-4 py-3",children:"Tài khoản"}),o.jsx("th",{className:"px-4 py-3",children:"Tháng này"}),o.jsx("th",{className:"px-4 py-3",children:"Lần cuối"}),o.jsx("th",{className:"px-4 py-3",children:"Đã trả"}),o.jsx("th",{className:"px-4 py-3",children:"Còn nợ"}),o.jsx("th",{className:"px-4 py-3",children:"Thanh toán"}),o.jsx("th",{className:"px-4 py-3 text-center",children:"TT"}),o.jsx("th",{className:"px-4 py-3 text-right",children:"Thao tác"})]})}),o.jsx("tbody",{className:"divide-y divide-white/5",children:t?o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"text-center py-8 text-white/50",children:"Đang tải..."})}):e.map(d=>o.jsx(aH,{supply:d,isExpanded:r===d.id,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l,onRefreshSupplies:c},d.id))})]})})}),aH=({supply:e,isExpanded:t,onToggle:r,onEdit:n,onDelete:a,onView:i,onToggleStatus:s,onRefreshSupplies:l})=>o.jsxs(o.Fragment,{children:[o.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:bg-white/5 cursor-pointer transition border-b border-white/5",onClick:()=>r(e.id),children:[o.jsxs("td",{className:"px-4 py-4",children:[o.jsx("div",{className:"font-medium text-white",children:e.sourceName||"Không Tên"}),o.jsxs("div",{className:"text-xs text-white/60",children:["Tổng đơn: ",e.totalOrders]})]}),o.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[o.jsx("div",{children:e.numberBank||"--"}),o.jsx("div",{className:"text-xs text-white/50",children:e.bankName})]}),o.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[o.jsxs("div",{children:[e.monthlyOrders," Đơn"]}),o.jsx("div",{className:"text-xs text-emerald-400",children:Bl(e.monthlyImportValue)})]}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:rH(e.lastOrderDate)}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Bl(e.totalPaidImport)}),o.jsx("td",{className:"px-4 py-4 font-bold text-orange-400 text-sm",children:Bl(Math.min(0,e.totalUnpaidImport||0))}),o.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Bl(Math.max(0,e.totalUnpaidImport||0))}),o.jsx("td",{className:"px-4 py-4 text-center",children:o.jsx("button",{onClick:c=>{c.stopPropagation(),s(e)},className:`w-8 h-8 rounded-full flex items-center justify-center transition ${e.isActive?"bg-emerald-500 text-white":"bg-gray-600 text-gray-300"}`,children:o.jsx(aw,{className:"h-4 w-4"})})}),o.jsx("td",{className:"px-4 py-4 text-right",children:o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{onClick:c=>{c.stopPropagation(),i(e)},className:"p-1 text-blue-400 hover:text-blue-300",children:o.jsx(Ts,{className:"h-5 w-5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),n(e)},className:"p-1 text-green-400 hover:text-green-300",children:o.jsx(zo,{className:"h-5 w-5"})}),o.jsx("button",{onClick:c=>{c.stopPropagation(),a(e)},className:"p-1 text-rose-400 hover:text-rose-300",children:o.jsx(Na,{className:"h-5 w-5"})})]})})]}),t&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-0 pb-4 pt-0 bg-indigo-950/30",children:o.jsx("div",{className:"p-4 border-b border-white/10 shadow-inner",children:o.jsx(tH,{supplyId:e.id,onRefreshSupplies:l})})})})]}),iH=(e,t)=>{const[r,n]=p.useState(!1),[a,i]=p.useState(null),[s,l]=p.useState(null),c=p.useCallback(async()=>{if(e){n(!0),i(null);try{const d=await Ze(`/api/supplies/${e}/overview`),u=await d.json();if(!d.ok)throw new Error(u?.error||"Không tải được chi tiết");l(u)}catch(d){i(d?.message||"Đã có lỗi xảy ra")}finally{n(!1)}}},[e]);return p.useEffect(()=>{t&&e?c():t||(l(null),i(null))},[t,e,c]),{overview:s,loading:r,error:a,fetchOverview:c,setError:i}},sH=({supply:e,fetchOverview:t,onRefreshList:r})=>{const[n,a]=p.useState(null),[i,s]=p.useState(null);return{confirmingId:n,qrPayment:i,confirmPayment:async d=>{a(d);try{const u=await Ze(`/api/payment-supply/${d}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!u.ok){const f=await u.json().catch(()=>({}));throw new Error(f?.error||"Không thể thanh toán chu kỳ")}return await t(),s(null),r?.(),{success:!0}}catch(u){return{success:!1,error:u?.message||"Không thể thanh toán chu kỳ"}}finally{a(null)}},showQrForPayment:d=>{const u=(d.totalImport||0)-(d.paid||0),f=Math.abs(u),h=u>0,m=(()=>{const y=new Date,b=String(y.getDate()).padStart(2,"0"),w=String(y.getMonth()+1).padStart(2,"0"),N=y.getFullYear();return`${b}/${w}/${N}`})(),x=h?e?.numberBank||"":"MAVPRE",g=h?e?.binBank||"":"970432",v=eH({accountNumber:x,bankCode:g,amount:f,description:d.round||m});s({id:d.id,amount:f,url:v,round:d.round||""})},setQrPayment:s}},oH=({payment:e,onClose:t})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4",onClick:t,children:o.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl border border-white/10 shadow-2xl p-6 w-full max-w-sm",onClick:r=>r.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Chu kỳ"}),o.jsx("p",{className:"text-lg font-bold",children:e.round||"QR thanh toán"})]}),o.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),e.url?o.jsx("img",{src:e.url,alt:"QR thanh toán",className:"rounded-lg border border-white/10 bg-white p-4 w-full"}):o.jsx("div",{className:"w-full aspect-square rounded-lg border border-dashed border-white/20 flex items-center justify-center text-white/60",children:"Thiếu thông tin để tạo QR"}),o.jsx("p",{className:"text-xs text-white/60 text-center mt-3",children:"Quét QR để thanh toán số tiền chu kỳ."})]})}):null,lH=({isOpen:e,onClose:t,supplyId:r,banks:n=[],onRefreshList:a})=>{const{overview:i,loading:s,error:l,fetchOverview:c,setError:d}=iH(r,e),{confirmingId:u,qrPayment:f,confirmPayment:h,showQrForPayment:m,setQrPayment:x}=sH({supply:i?.supply,fetchOverview:c,onRefreshList:a});if(!e||!r)return null;const g=i?.supply,v=i?.stats,y=i?.unpaidPayments||[],b=y.reduce((C,T)=>C+Math.max(0,(T.totalImport||0)-(T.paid||0)),0),w=v?.monthlyOrders||[],N=g?.isActive?"Đang hoạt động":"Tạm dừng",_=g?.isActive?"bg-emerald-500/20 text-emerald-200":"bg-gray-500/20 text-gray-200",E=g?.bankName||n.find(C=>(C.bin||"").trim()===(g?.binBank||"").trim())?.name||g?.binBank||"--",S=[{label:"Tổng đơn",value:v?.totalOrders??0},{label:"Đã thanh toán",value:v?.paidOrders??0},{label:"Chưa thanh toán",value:v?.unpaidOrders??0},{label:"Đã hủy",value:v?.canceledOrders??0}],j=async C=>{const T=await h(C);T.success||d(T.error||"Không thể thanh toán chu kỳ")},P=()=>{x(null),t()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60 p-4",onClick:P,children:o.jsxs("div",{className:"bg-slate-900 border border-white/20 p-6 rounded-2xl text-white w-full max-w-4xl max-h-[90vh] shadow-2xl overflow-y-auto",onClick:C=>C.stopPropagation(),children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-white/60",children:["Chi tiết Supplier #",r]}),o.jsx("h2",{className:"text-2xl font-bold",children:g?.sourceName||"Đang tải..."}),g&&o.jsx("span",{className:`inline-flex mt-2 px-3 py-1 rounded-full text-xs font-semibold ${_}`,children:N})]}),o.jsx("button",{onClick:P,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70","aria-label":"Đóng",children:o.jsx(Dt,{className:"h-6 w-6"})})]}),s?o.jsx("div",{className:"mt-6 text-center text-white/70",children:"Đang tải chi tiết..."}):l?o.jsxs("div",{className:"mt-6 bg-rose-500/10 text-rose-200 border border-rose-500/40 rounded-xl p-4 flex items-center justify-between gap-3",children:[o.jsx("span",{children:l}),o.jsx("button",{onClick:c,className:"px-3 py-1 rounded-lg bg-rose-500 text-white text-sm hover:bg-rose-600",children:"Thử lại"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Thông tin chung"}),o.jsxs("div",{className:"text-sm text-white/80 space-y-1",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-white/50",children:"Ngân hàng: "}),E]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-white/50",children:"Số tài khoản: "}),g?.numberBank||"--"]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-white/50",children:"Trạng thái: "}),N]})]})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Tổng quan thanh toán"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-white/80",children:[o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:"Đã thanh toán"}),o.jsx("p",{className:"text-lg font-semibold",children:Mn(v?.totalPaidAmount||0)})]}),o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:"Còn nợ"}),o.jsx("p",{className:"text-lg font-semibold text-orange-300",children:Mn(b)})]}),o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:"Đơn chưa thanh toán"}),o.jsx("p",{className:"text-lg font-semibold",children:v?.unpaidOrders??0})]}),o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:"Đơn đã thanh toán"}),o.jsx("p",{className:"text-lg font-semibold",children:v?.paidOrders??0})]})]})]})]}),o.jsx("div",{className:"grid md:grid-cols-4 gap-3 mt-4",children:S.map(C=>o.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[o.jsx("p",{className:"text-white/50 text-xs",children:C.label}),o.jsx("p",{className:"text-xl font-semibold",children:C.value})]},C.label))}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Chu kỳ chưa thanh toán"}),o.jsxs("span",{className:"text-xs text-white/60",children:["Còn nợ ",Mn(b)]})]}),y.length===0?o.jsx("p",{className:"text-white/50 text-sm",children:"Không có chu kỳ nợ."}):o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:y.map(C=>o.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5 gap-3",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:C.round||"Chu kỳ"}),o.jsx("p",{className:"text-xs text-white/60",children:C.status})]}),o.jsxs("div",{className:"text-right text-sm",children:[o.jsxs("p",{children:["Nhập: ",Mn(C.totalImport||0)]}),o.jsxs("p",{className:"text-white/60 text-xs",children:["Đã trả: ",Mn(C.paid||0)]})]}),o.jsx("div",{className:"flex-shrink-0",children:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:()=>m(C),className:"px-3 py-1.5 text-xs rounded-lg bg-indigo-500 text-white hover:bg-indigo-600",children:"Xem QR"}),o.jsx("button",{disabled:u===C.id,onClick:()=>j(C.id),className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-60",children:u===C.id?"Đang xử lý...":"Thanh toán"})]})})]},C.id))})]}),o.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Đơn theo tháng"}),o.jsxs("span",{className:"text-xs text-white/60",children:[w.length," tháng"]})]}),w.length===0?o.jsx("p",{className:"text-white/50 text-sm",children:"Chưa có dữ liệu."}):o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:w.map(C=>o.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5",children:[o.jsxs("span",{className:"text-sm font-semibold",children:["Tháng ",C.month]}),o.jsxs("span",{className:"text-sm",children:[C.orders," đơn"]})]},C.month))})]})]}),o.jsx("div",{className:"mt-6 text-right",children:o.jsx("button",{onClick:P,className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white",children:"Đóng"})})]})]})}),o.jsx(oH,{payment:f,onClose:()=>x(null)})]})},cH=()=>{const[e,t]=p.useState([]),[r,n]=p.useState({totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0}),[a,i]=p.useState(!1),[s,l]=p.useState(null),c=p.useCallback(async()=>{i(!0);try{const u=await Ze("/api/supply-insights");if(!u.ok)throw new Error("Lỗi tải dữ liệu");const f=await u.json(),h=(f.supplies||[]).map(m=>{const x=m.isActive??(m.status!=="inactive"&&m.status!=="tạm dừng");return{...m,isActive:x,status:x?"active":"inactive",products:Array.isArray(m.products)?m.products.filter(Boolean):[]}});t(h),n({totalSuppliers:Number(f.stats?.totalSuppliers)||0,activeSuppliers:Number(f.stats?.activeSuppliers)||h.filter(m=>m.isActive).length,monthlyOrders:Number(f.stats?.monthlyOrders)||0,totalImportValue:Number(f.stats?.totalImportValue)||0})}catch(u){l(u instanceof Error?u.message:"Lỗi không xác định")}finally{i(!1)}},[]);return{supplies:e,stats:r,loading:a,error:s,fetchSupplies:c,setSupplies:t,toggleStatus:async(u,f)=>{t(h=>h.map(m=>m.id===u?{...m,isActive:!f,status:f?"inactive":"active"}:m));try{await Ze(`/api/supplies/${u}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!f})}),await c()}catch{t(h=>h.map(m=>m.id===u?{...m,isActive:f,status:f?"active":"inactive"}:m)),alert("Không thể cập nhật trạng thái")}}}},uH=({isOpen:e,onClose:t,onSuccess:r,banks:n})=>{const[a,i]=p.useState({sourceName:"",numberBank:"",bankBin:"",status:"active"}),[s,l]=p.useState(!1),[c,d]=p.useState(null);if(p.useEffect(()=>{e&&n.length>0&&!a.bankBin&&i(f=>({...f,bankBin:n[0].bin}))},[e,n,a.bankBin]),!e)return null;const u=async f=>{if(f.preventDefault(),!a.sourceName.trim())return d("Tên không được để trống");l(!0),d(null);try{const h=await Ze("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:a.sourceName,number_bank:a.numberBank,bin_bank:a.bankBin,status:a.status})});if(!h.ok)throw new Error((await h.json()).error||"Lỗi khi tạo");r(),t(),i({sourceName:"",numberBank:"",bankBin:n[0]?.bin||"",status:"active"})}catch(h){d(h instanceof Error?h.message:"Lỗi tạo nhà cung cấp")}finally{l(!1)}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-md p-6",onClick:f=>f.stopPropagation(),children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Thêm Nhà Cung Cấp Mới"}),c&&o.jsx("p",{className:"text-sm text-red-600 mb-3",children:c}),o.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tên Nhà Cung Cấp"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1 focus:ring-2 focus:ring-blue-500",value:a.sourceName,onChange:f=>i({...a,sourceName:f.target.value}),placeholder:"Nhập tên..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.numberBank,onChange:f=>i({...a,numberBank:f.target.value}),placeholder:"STK..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),o.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:a.bankBin,onChange:f=>i({...a,bankBin:f.target.value}),children:n.map(f=>o.jsx("option",{value:f.bin,children:f.name||f.bin},f.bin))})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hủy"}),o.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:s?"Đang xử lý...":"Thêm Mới"})]})]})]})})},dH=({isOpen:e,onClose:t,onSuccess:r,supply:n,banks:a})=>{const[i,s]=p.useState({sourceName:"",numberBank:"",bankBin:""}),[l,c]=p.useState(!1),[d,u]=p.useState(null);if(p.useEffect(()=>{n&&s({sourceName:n.sourceName||"",numberBank:n.numberBank||"",bankBin:n.binBank||a[0]?.bin||""})},[n,a]),!e||!n)return null;const f=async h=>{h.preventDefault(),c(!0);try{if(!(await Ze(`/api/supplies/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:i.sourceName,number_bank:i.numberBank,bin_bank:i.bankBin})})).ok)throw new Error("Lỗi cập nhật");r(),t()}catch(m){u(m instanceof Error?m.message:"Lỗi cập nhật")}finally{c(!1)}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:o.jsxs("div",{className:"w-full max-w-lg bg-white rounded-2xl p-6 shadow-2xl",onClick:h=>h.stopPropagation(),children:[o.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Chỉnh Sửa Thông Tin"}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tên Nhà Cung Cấp"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.sourceName,onChange:h=>s({...i,sourceName:h.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),o.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.numberBank,onChange:h=>s({...i,numberBank:h.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),o.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:i.bankBin,onChange:h=>s({...i,bankBin:h.target.value}),children:a.map(h=>o.jsx("option",{value:h.bin,children:h.name||h.bin},h.bin))})]}),d&&o.jsx("p",{className:"text-sm text-red-500",children:d}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hủy"}),o.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Lưu Thay Đổi"})]})]})]})})},fH=({isOpen:e,onClose:t,onConfirm:r,supplyName:n})=>e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:o.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full shadow-2xl",children:[o.jsx("h3",{className:"text-lg font-bold text-rose-600 mb-2",children:"Xóa Nhà Cung Cấp?"}),o.jsxs("p",{className:"text-gray-600 mb-6",children:["Bạn có chắc muốn xóa ",o.jsx("b",{children:n}),"? Hành động này không thể hoàn tác."]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:"Hủy"}),o.jsx("button",{onClick:r,className:"px-4 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700",children:"Xóa Vĩnh Viễn"})]})]})}):null;function hH(){const{supplies:e,stats:t,loading:r,fetchSupplies:n,toggleStatus:a}=cH(),[i,s]=p.useState(""),[l,c]=p.useState("all"),[d,u]=p.useState([]),[f,h]=p.useState(null),[m,x]=p.useState(!1),[g,v]=p.useState(null),[y,b]=p.useState(null),[w,N]=p.useState(null);p.useEffect(()=>{n(),Ze("/api/banks").then(S=>S.json()).then(S=>{Array.isArray(S)&&u(S.map(j=>({bin:j.bin,name:j.bank_name||j.bankName||j.name||j.bank||j.bin})))}).catch(console.error)},[n]);const _=p.useMemo(()=>{const S=eb(i),j=e.filter(C=>{const T=!S||eb(C.sourceName).includes(S),k=l==="all"||(l==="active"?C.isActive:!C.isActive);return T&&k}),P=C=>{if(!C)return 0;const T=new Date(C).getTime();return Number.isFinite(T)?T:0};return j.sort((C,T)=>{const k=Number(C.totalUnpaidImport)||0,W=Number(T.totalUnpaidImport)||0,G=k>0,K=W>0;if(G!==K)return G?-1:1;const J=k<0,V=W<0;if(J!==V)return J?-1:1;if((G||J)&&k!==W)return W-k;const Z=P(C.lastOrderDate),Q=P(T.lastOrderDate),Y=Z>0,le=Q>0;if(Y!==le)return Y?-1:1;if(Z!==Q)return Q-Z;const de=(T.totalOrders||0)-(C.totalOrders||0);return de!==0?de:C.sourceName.localeCompare(T.sourceName)})},[e,i,l]),E=async()=>{if(w){const S=await JU(w.id);S.success?(await n(),N(null)):alert(S.message)}};return o.jsxs("div",{className:"space-y-6 pb-20",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản Lý Nguồn Hàng"}),o.jsx("p",{className:"text-white/60 text-sm",children:"Theo dõi công nợ và chu kỳ thanh toán"})]}),o.jsx(Qn,{icon:ta,onClick:()=>x(!0),children:"Thêm NCC"})]}),o.jsx(QU,{stats:t}),o.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-2xl flex flex-col md:flex-row gap-4",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Bi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-white/40"}),o.jsx("input",{className:"w-full bg-black/20 border border-white/10 rounded-xl py-2 pl-10 text-white focus:outline-none focus:border-indigo-500",placeholder:"Tìm kiếm...",value:i,onChange:S=>s(S.target.value)})]}),o.jsxs("select",{className:"bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-white focus:outline-none",value:l,onChange:S=>c(S.target.value),children:[o.jsx("option",{value:"all",children:"Tất cả trạng thái"}),o.jsx("option",{value:"active",children:"Đang hoạt động"}),o.jsx("option",{value:"inactive",children:"Tạm dừng"})]})]}),o.jsx(nH,{supplies:_,loading:r,expandedId:f,onToggle:S=>h(j=>j===S?null:S),onEdit:v,onDelete:N,onView:S=>b(S.id),onToggleStatus:S=>a(S.id,S.isActive),onRefreshSupplies:n}),o.jsx(uH,{isOpen:m,onClose:()=>x(!1),onSuccess:n,banks:d}),o.jsx(dH,{isOpen:!!g,onClose:()=>v(null),onSuccess:n,supply:g,banks:d}),o.jsx(fH,{isOpen:!!w,onClose:()=>N(null),onConfirm:E,supplyName:w?.sourceName}),o.jsx(lH,{isOpen:!!y,onClose:()=>b(null),supplyId:y,banks:d,onRefreshList:n})]})}const of=e=>e.toLocaleString("vi-VN"),pi=e=>{const t=Number(e);return Number.isFinite(t)?t:0},$l=e=>(e||"").trim().toLowerCase(),Ul=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},rs=e=>(e||"").trim().toLowerCase(),lf=e=>{const t=Number(e);return Number.isFinite(t)?t:0},mH=e=>{const t=lf(e?.price),r=lf(e?.resellPrice),n=lf(e?.promoPrice);return{price:t||r||n||0,promoPrice:n||0,resellPrice:r||void 0}},pH=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},xH=(e,t)=>{if(e){const d=Ln(e.price||0),u=e.promoPrice>0?Ln(e.promoPrice):0;return{unitPrice:d,discount:u}}const r=t?.basePrice??t?.unitPrice??0,n=t?.pctPromo!==void 0?pi(t.pctPromo):0,a=n>1?n/100:Math.max(0,n),i=t?.pctKhach!==void 0&&t?.pctKhach>0?t.pctKhach:1,s=t?.pctCtv!==void 0&&t?.pctCtv>0?t.pctCtv:1,l=Ln(r*i*s),c=a>0?Ln(l*a):0;return{unitPrice:l,discount:c}},rb=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),a=[],i=(l,c)=>{if(l.nodeType===Node.TEXT_NODE){c.push((l.textContent||"").replace(/\u00a0/g," "));return}if(l.nodeType===Node.ELEMENT_NODE){const d=l;if(d.tagName==="BR"){c.push(`
`);return}const u=[];d.childNodes.forEach(h=>i(h,u));const f=u.join("");c.push(f),n.has(d.tagName)&&c.push(`
`)}},s=[];return r.body.childNodes.forEach(l=>i(l,s)),s.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e||""}},gH=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},vH=(e,t)=>{const r=new Set,n=[];return e.forEach(a=>{const s=(a?.[Wt.code]||a?.san_pham||"").trim();if(!s)return;const l=s.toLowerCase();if(r.has(l))return;r.add(l);const c=pH(s),d=pi(a?.pct_khach??a?.[Wt.pctKhach]),u=pi(a?.pct_ctv??a?.[Wt.pctCtv]),f=d>10?d/100:d>0?d:1,h=u>10?u/100:u>0?u:1,m=pi(a?.pct_promo??a?.[Wt.pctPromo]),x=m>1?m/100:Math.max(0,m),g=pi(a?.max_supply_price),v=pi(a?.computed_retail_price??a?.retail_price??a?.gia_le??a?.gia_ban)||0,y=pi(a?.computed_promo_price??a?.promo_price??a?.gia_khuyen_mai??a?.gia_km)||0,b=g>0?Ln(g):0,N=(v||y||b)*(h>0?h:1)*(f>0?f:1),_=Ln(N),E=_*(1-x),S=Ln(E),j=Math.min(_,b>0?Math.max(b,S):S),P=j>0?_-j:0,C=a?.[Wt.variantName]||a?.package_product||a?.package_product_label||"",T=C?`${C} (${s})`:a?.package?`${a?.package} (${s})`:s,k=rs(s),W=t[k];n.push({productId:s,value:s,productDisplay:a?.package||s,packageDisplay:C||a?.package||s,label:T,durationMonths:c.months,durationDays:c.days,term:c.days?`${c.days} ngày`:"",unitPrice:_,discountValue:P,basePrice:W?.price??W?.resellPrice??v??_,promoPrice:W?.promoPrice??0,pctPromo:x,pctKhach:f,pctCtv:h,wholesalePrice:b})}),n.sort((a,i)=>a.label.localeCompare(i.label,"vi"))},Zi="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",yH=({recipient:e,onRecipientChange:t,quoteDate:r,onQuoteDateChange:n,quoteCode:a,contact:i,onContactChange:s,productSearch:l,onProductSearchChange:c,filteredOptions:d,selectedProductKeys:u,onToggleProduct:f,onAddSelectedProduct:h,onResetSearch:m,lines:x,onRemoveLine:g,onDownload:v})=>o.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[o.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thông tin báo giá"})}),o.jsxs("div",{className:"px-6 py-5 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Kính gửi"}),o.jsx("input",{type:"text",value:e,onChange:y=>t(y.target.value),className:Zi})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Ngày"}),o.jsx("input",{type:"date",value:r,onChange:y=>n(y.target.value),className:Zi})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Mã báo giá"}),o.jsx("input",{value:a,readOnly:!0,className:`${Zi} opacity-80`})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Liên hệ"}),o.jsx("input",{type:"text",value:i,onChange:y=>s(y.target.value),className:Zi,placeholder:"Email / SDT"})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi chú (tùy chọn)"}),o.jsx("input",{type:"text",className:Zi,placeholder:"Thông tin thêm cho báo giá"})]})]}),o.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[o.jsx("label",{className:"text-sm font-semibold text-white block",children:"Mã sản phẩm"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[o.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),className:`${Zi} text-sm`,placeholder:"Tìm sản phẩm..."}),o.jsx("button",{type:"button",onClick:m,className:"px-3 py-2 text-sm rounded-lg border border-white/20 bg-white/5 text-white hover:border-white/40 transition-colors",children:"Xóa Tìm Kiếm"})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:d.map(y=>{const b=u.includes(y.value);return o.jsx("button",{type:"button",onClick:()=>f(y.value),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${b?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:y.label,children:y.label},y.value)})}),o.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[o.jsx("button",{type:"button",onClick:h,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!u.length,children:"Thêm"}),o.jsx("button",{type:"button",onClick:v,className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),x.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.map(y=>o.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[y.product,o.jsx("button",{type:"button",onClick:()=>g(y.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xoa",children:"x"})]},y.id))})]})]})]}),bH=({rows:e})=>o.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[o.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),o.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TÊN SẢN PHẨM"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GÓI"}),o.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THỜI GIAN"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"ĐƠN GIÁ"}),o.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIẢM GIÁ"}),o.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THANH TIỀN"}),o.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CHÚ"})]})}),o.jsx("tbody",{children:e.map((t,r)=>o.jsxs("tr",{className:"align-top",children:[o.jsx("td",{className:"border border-slate-600 text-center py-2",children:r+1}),o.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:t.product,children:t.product}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.packageName||t.term}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.durationMonths?`${t.durationMonths} tháng`:t.durationDays?`${t.durationDays} ngày`:t.term||"--"}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:of(t.unitPrice)}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:of(t.discount||0)}),o.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:of(t.total)}),o.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:t.note||""})]},t.id))})]}),wH=({sections:e})=>{const t=o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Quy Tắc"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."}),o.jsx("p",{className:"font-semibold mt-3",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."})]});return o.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[e.length===0?t:e.map(r=>o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"font-semibold",children:r.name}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Quy tắc"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.rules||"Chưa cập nhật."})]}),o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Thông tin sản phẩm"}),o.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.description||"Chưa cập nhật."})]})]},r.name)),o.jsxs("div",{className:"pt-2 text-sm",children:[o.jsx("p",{className:"font-semibold",children:"Mọi thông tin chi tiết có thể liên hệ:"}),o.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Tài Khoản Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]})},NH="/assets/sign-DzA7EGyE.png",_H=()=>o.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:o.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[o.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),o.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(Ký, ghi rõ họ tên)"}),o.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:o.jsx("img",{src:NH,alt:"Chữ ký",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}})})]})});var SH={};const EH="/mavryk-logo.png",nb=typeof import.meta<"u"&&"https://admin.mavrykpremium.store"||typeof process<"u"&&SH?.VITE_API_BASE_URL||""||"http://localhost:3001";function TH(){p.useEffect(()=>{const K=document.title;return document.title="Mavryk Premium Store",()=>{document.title=K}},[]);const[e,t]=p.useState(new Date().toISOString().slice(0,10)),[r,n]=p.useState(""),[a,i]=p.useState(""),[s,l]=p.useState([]),[c,d]=p.useState([]),[u,f]=p.useState(""),[h,m]=p.useState({}),x=p.useRef({}),[g,v]=p.useState([]),[y,b]=p.useState([]),w=p.useMemo(()=>{const K=y.map(V=>({...V,total:(V.unitPrice-(V.discount||0))*V.quantity})),J=K.reduce((V,Z)=>V+Z.total,0);return{rows:K,grandTotal:J}},[y]);p.useEffect(()=>{let K=!0;return(async()=>{try{const Z=await fetch(`${nb}${rt.PRODUCT_PRICES}`,{credentials:"include"});if(!Z.ok)throw new Error("Failed to load variant pricing");const Q=await Z.json();if(!K)return;Array.isArray(Q)?l(Q):Q?.items&&Array.isArray(Q.items)?l(Q.items):l([])}catch(Z){console.error("Khong the tai pricing:",Z)}})(),(async()=>{try{const Z=await fetch(`${nb}${rt.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!Z.ok)throw new Error("Failed to load product_desc");const Q=await Z.json();K&&Q?.items&&Array.isArray(Q.items)&&d(Q.items.map(Y=>({productId:Y.productId||Y.product_id||"",rules:Y.rules??"",description:Y.description??""})))}catch(Z){console.error("Khong the tai product_desc:",Z)}})(),()=>{K=!1}},[]);const N=p.useCallback(async K=>{const J=K.map(Y=>({original:Y,key:rs(Y)})).filter(Y=>Y.key);if(!J.length)return h;const V=J.filter(Y=>!h[Y.key]);if(!V.length)return h;const Z={},Q=[];return V.forEach(({original:Y,key:le})=>{if(x.current[le]){Q.push(x.current[le].then(pe=>{pe&&(Z[le]=pe)}));return}const de=(async()=>{try{const pe=await Ze(rt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({san_pham_name:Y,id_product:Y,customer_type:"LE",for_quote:!0})}),_e=await pe.json().catch(()=>null);if(!pe.ok)throw new Error(_e?.error||"Fail calculate-price");return mH(_e)}catch(pe){return console.error("calculate-price failed",Y,pe),null}})();x.current[le]=de,Q.push(de.then(pe=>{pe&&(Z[le]=pe)}).finally(()=>{delete x.current[le]}))}),Q.length&&await Promise.all(Q),Object.keys(Z).length?(m(Y=>({...Y,...Z})),{...h,...Z}):h},[h]),_=p.useMemo(()=>vH(s,h),[s,h]),E=p.useMemo(()=>{const K=new Map;return _.forEach(J=>{K.set(rs(J.value),J)}),K},[_]),S=p.useMemo(()=>{const K=new Map;return s.forEach(J=>{const V=J?.[Wt.code]||J?.san_pham||"",Z=J?.[Wt.variantName]||J?.package_product||J?.package_product_label||"",Q=$l(Ul(V));Q&&Z&&K.set(Q,Z)}),K},[s]),j=p.useMemo(()=>{const K=new Map;return c.forEach(J=>{const V=$l(Ul(J.productId));V&&K.set(V,J)}),K},[c]),P=p.useMemo(()=>{const K=u.trim().toLowerCase();return K?_.filter(J=>{const V=J.label.toLowerCase(),Z=J.value.toLowerCase(),Q=J.productDisplay.toLowerCase();return V.includes(K)||Z.includes(K)||Q.includes(K)}):_},[_,u]),C=p.useMemo(()=>{const K=new Set,J=[];return y.forEach(V=>{const Z=V.productCode||V.product||"",Q=$l(Ul(Z));if(!Q||K.has(Q))return;K.add(Q);const Y=j.get(Q),le=S.get(Q)||V.packageName||V.product;J.push({name:le,rules:rb(Y?.rules),description:rb(Y?.description)})}),J},[y,j,S]),T=async()=>{if(!g.length)return;const K=g.map(V=>V.trim()).filter(Boolean);if(!K.length)return;const J=await N(K);b(V=>{const Z=[...V];return K.forEach(Q=>{const Y=E.get(rs(Q))??E.get(rs(Q.normalize("NFD").replace(/[\u0300-\u036f]/g,""))),le=(Z.length+1).toString(),de=Y?.durationDays?`${Y.durationDays} ngày`:Y?.term||"",pe=rs(Q),_e=J[pe],{unitPrice:q,discount:oe}=xH(_e,Y||{});Z.push({id:le,productCode:Q,product:Y?.productDisplay||Q,packageName:Y?.packageDisplay||S.get($l(Ul(Q)))||"",term:de,durationMonths:Y?.durationMonths??null,durationDays:Y?.durationDays??null,unitPrice:q,quantity:1,discount:oe})}),Z}),v([])},k=K=>b(J=>J.filter(V=>V.id!==K)),W=`BG-${(e||"").replaceAll("-","")||"----"}`;return o.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[o.jsx("style",{children:`
    /* Hide scrollbars while keeping scroll functionality */
    body {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    body::-webkit-scrollbar {
      display: none;
    }

    @media print {
      /* Hide everything except the printable quote */
      body { background: white !important; margin: 0 !important; padding: 0 !important; }
      body * { visibility: hidden !important; }
      #quote-print-area,
      #quote-print-area * { visibility: visible !important; }
      #quote-print-area {
        position: absolute;
        left: 0;
        top: 0;
        box-shadow: none !important;
        border: none !important;
      }
      .no-print { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
    }
  `}),o.jsx(yH,{recipient:r,onRecipientChange:n,quoteDate:e,onQuoteDateChange:t,quoteCode:W,contact:a,onContactChange:i,productSearch:u,onProductSearchChange:f,filteredOptions:P,selectedProductKeys:g,onToggleProduct:K=>v(J=>J.includes(K)?J.filter(V=>V!==K):[...J,K]),onAddSelectedProduct:T,onResetSearch:()=>f(""),lines:y,onRemoveLine:k,onDownload:()=>window.print()}),o.jsx("div",{className:"print-wrapper flex justify-center",children:o.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[o.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:o.jsx("img",{src:EH,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:K=>{K.currentTarget.style.display="none"}})}),o.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),o.jsx("p",{children:"SDT: 0378.304.963"}),o.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),o.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BẢNG BÁO GIÁ"}),o.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800 space-y-1",children:[o.jsxs("p",{children:["Ngày: ",o.jsx("strong",{children:gH(e)||"..."})]}),o.jsxs("p",{children:["Kính gửi: ",o.jsx("strong",{children:r})]}),a?o.jsxs("p",{children:["Thông tin liên hệ: ",o.jsx("strong",{children:a})]}):null,o.jsx("p",{className:"mt-3 italic",children:"Mavryk Premium Store trân trọng gửi lời cảm ơn và bản báo giá chi tiết sản phẩm theo yêu cầu của Quý khách. Chúng tôi cam kết mọi sản phẩm đều đạt tiêu chuẩn chất lượng cao cấp nhất, đảm bảo mang lại trải nghiệm tuyệt vời và xứng đáng với sự đầu tư của Quý khách."})]}),o.jsx(bH,{rows:w.rows}),o.jsx(wH,{sections:C}),o.jsx(_H,{})]})})})]})}const CH=({form:e,invoiceCodes:t,onChange:r,onAddInvoiceCode:n,onRemoveInvoiceCode:a,onSubmit:i})=>{const s=p.useId(),[l,c]=p.useState(null),d="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",u="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",f="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",h=m=>{m.key==="Enter"&&(m.preventDefault(),n())};return o.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[o.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thông tin hóa đơn"})}),o.jsxs("form",{className:"px-6 py-5 space-y-4",onSubmit:i,children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:s,className:"text-sm font-medium text-slate-100",children:"Hóa đơn"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:u,onMouseLeave:()=>c(null),children:t.map(m=>o.jsxs("button",{type:"button",onClick:()=>a(m.id),onMouseEnter:()=>c(m.id),onMouseLeave:()=>c(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xóa hóa đơn ${m.code}`,children:[o.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:m.code}),o.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${l===m.id?"bg-white/20 text-red-500":""}`,children:o.jsx(Dt,{className:"h-4 w-4"})})]},m.id))}),o.jsx("div",{className:f,children:o.jsx("input",{id:s,type:"text",onMouseEnter:()=>c(null),onFocus:()=>c(null),onBlur:()=>c(null),value:e.invoiceCode,onChange:m=>r("invoiceCode",m.target.value),onKeyDown:h,className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhập mã hóa đơn và nhấn Enter"})})]})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngày"}),o.jsx("input",{type:"date",value:e.invoiceDate,onChange:m=>r("invoiceDate",m.target.value),className:d})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Mã số thuế"}),o.jsx("input",{type:"text",value:e.taxCode,onChange:m=>r("taxCode",m.target.value),className:d})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khách hàng / Công ty"}),o.jsx("input",{type:"text",value:e.customerName,onChange:m=>r("customerName",m.target.value),className:d})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),o.jsx("input",{type:"text",value:e.fax,onChange:m=>r("fax",m.target.value),className:d})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Địa chỉ"}),o.jsx("textarea",{value:e.address,onChange:m=>r("address",m.target.value),rows:2,className:`${d} resize-none`})]}),o.jsxs("label",{className:"space-y-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-100",children:"SĐT"}),o.jsx("input",{type:"text",value:e.phone,onChange:m=>r("phone",m.target.value),className:d})]})]}),o.jsx("div",{className:"pt-2",children:o.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cập nhật thông tin"})})]})]})};let ab=0;const jH=e=>(ab+=1,{id:`inv-${Date.now().toString(36)}-${ab.toString(36)}`,code:e}),Hl=e=>(e||"").trim().toLowerCase(),ib=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},AH=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith(Kt.COLLABORATOR)?Kt.COLLABORATOR:t.startsWith(Kt.RETAIL)?Kt.RETAIL:t.startsWith(Kt.PROMO)?Kt.PROMO:t.startsWith(Kt.GIFT)?Kt.GIFT:null},cf=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},kH=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},Ji={name:"MAVRYK PREMIUM",address:"Phan Văn Trị, Phường 11, Quận Bình Thạnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ngô Lê Ngọc Hương"},PH={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},uf="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",df=e=>`${e.toLocaleString("vi-VN")} đ`,OH=({form:e,invoiceLines:t,totals:r,dateDisplay:n,onDownload:a})=>{const i=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${uf};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${uf} !important;
      }
    }
  `;return o.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[o.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:o.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trước & tải về"})}),o.jsxs("div",{className:"p-6",children:[o.jsx("style",{children:i}),o.jsx("div",{id:"invoice-print-area",children:o.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:uf},children:[o.jsxs("div",{className:"text-center leading-7",children:[o.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:Ji.name}),o.jsxs("p",{children:["Địa chỉ: ",Ji.address]}),o.jsxs("p",{children:["Điện thoại: ",Ji.phone]}),o.jsxs("p",{children:["Ngân hàng: ",Ji.bank]}),o.jsxs("p",{children:["STK: ",Ji.accountNumber]}),o.jsxs("p",{children:["Tên người nhận: ",Ji.receiver]})]}),o.jsx("div",{className:"my-4 h-px bg-slate-300"}),o.jsxs("div",{className:"text-center space-y-2 leading-7",children:[o.jsx("h2",{className:"text-xl font-bold uppercase",children:"HÓA ĐƠN BÁN HÀNG"}),o.jsx("div",{className:"text-sm",children:o.jsxs("p",{children:["Ngày: ",n]})})]}),o.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Khách hàng: "}),e.customerName||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Địa chỉ: "}),e.address||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",o.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:"Mã số Thuế: "}),e.taxCode||"---"]})]}),o.jsx("div",{className:"mt-8 px-2",children:o.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:o.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tên hàng hóa / Dịch vụ"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Đơn giá"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chiết khấu"}),o.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thành tiền"})]})}),o.jsx("tbody",{children:t.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Chưa có mã hóa đơn nào được chọn."})}):t.map(s=>o.jsxs("tr",{children:[o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:o.jsx("div",{className:"font-semibold",children:s.description})}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:df(s.unitPrice)}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:s.quantity}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${s.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),o.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:df(s.total)})]},s.id))})]})})}),o.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tổng tiền hàng: ",df(r.subtotal)]}),o.jsx("div",{className:"mt-8 text-center text-sm italic",children:"Cảm ơn và hẹn gặp lại!"})]})}),o.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:o.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[o.jsx(iC,{className:"h-5 w-5"}),"Download PDF"]})})]})]})};var DH={};const sb=typeof import.meta<"u"&&"https://admin.mavrykpremium.store"||typeof process<"u"&&DH?.VITE_API_BASE_URL||""||"http://localhost:3001";function RH(){p.useEffect(()=>{const b=document.title;return document.title="Mavryk Premium Store",()=>{document.title=b}},[]);const[e,t]=p.useState(PH),[r,n]=p.useState([]),[a,i]=p.useState([]),[s,l]=p.useState([]);p.useEffect(()=>{let b=!0;const w=async()=>{try{const _=await fetch(`${sb}${rt.ORDERS}`,{credentials:"include"});if(!_.ok)throw new Error("Failed to load orders");const E=await _.json();b&&Array.isArray(E)&&i(E)}catch(_){console.error("Không thể tải dữ liệu order_list:",_)}},N=async()=>{try{const _=await fetch(`${sb}${rt.PRODUCT_PRICES}`,{credentials:"include"});if(!_.ok)throw new Error("Failed to load product pricing");const E=await _.json();b&&E?.items&&Array.isArray(E.items)&&l(E.items)}catch(_){console.error("Không thể tải dữ liệu pricing:",_)}};return w(),N(),()=>{b=!1}},[]);const c=p.useMemo(()=>{const b=new Map;return a.forEach(w=>{const N=Hl(w?.[Ft.idOrder]);N&&b.set(N,w)}),b},[a]),d=p.useMemo(()=>{const b=new Map;return s.forEach(w=>{const N=Hl(w?.[Wt.code]);N&&b.set(N,w)}),b},[s]),u=p.useMemo(()=>r.map(b=>{const w=c.get(Hl(b.code)),N=Hl(w?.[Ft.idProduct]),_=d.get(N),E=AH(w?.[Ft.idOrder]||b.code),S=ib(w?.[Ft.idProduct])||ib(_?.[Wt.code]),j=S?`${S} tháng`:"",P=_?.[Wt.variantName]||_?.[Wt.packageName]||w?.[Ft.idProduct]||b.code,C=j?`${P} ${j}`:P,T=cf(_?.computed_wholesale_price)||cf(w?.[Ft.price]),k=cf(_?.computed_retail_price)||T;let W=k;E===Kt.COLLABORATOR?W=T:E===Kt.GIFT?W=0:E===Kt.RETAIL||E===Kt.PROMO?W=k:W=k||T;const G=E===Kt.PROMO?kH(_?.[Wt.pctPromo]):0,K=Number((G*100).toFixed(2)),J=1,V=Math.max(0,W*J*(1-G));return{id:b.id,code:b.code,description:C,unitPrice:W,quantity:J,discountPct:K,total:V}}),[r,c,d]),f=p.useMemo(()=>({subtotal:u.reduce((w,N)=>w+N.total,0)}),[u]),h=p.useMemo(()=>{if(!e.invoiceDate)return"..... tháng ..... năm 20..";const b=new Date(e.invoiceDate);return Number.isNaN(b.getTime())?"..... tháng ..... năm 20..":new Intl.DateTimeFormat("vi-VN").format(b)},[e.invoiceDate]),m=(b,w)=>{t(N=>({...N,[b]:w}))},x=()=>{const b=e.invoiceCode.trim();b&&(n(w=>w.some(N=>N.code===b)?w:[...w,jH(b)]),t(w=>({...w,invoiceCode:""})))},g=b=>{n(w=>w.filter(N=>N.id!==b))},v=b=>{b.preventDefault()},y=()=>{window.print()};return o.jsxs("div",{className:"space-y-6 print-wrapper",children:[o.jsx(CH,{form:e,invoiceCodes:r,onChange:m,onAddInvoiceCode:x,onRemoveInvoiceCode:g,onSubmit:v}),o.jsx(OH,{form:e,invoiceLines:u,totals:f,dateDisplay:h,onDownload:y})]})}var Yc={};Yc.version="0.20.3";var fa=1200,Fo=function(e){fa=e};function IH(){Fo(1200)}var Wl=function(t){return String.fromCharCode(t)},ob=function(t){return String.fromCharCode(t)},Ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xc(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),s=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Ar.charAt(i)+Ar.charAt(s)+Ar.charAt(l)+Ar.charAt(c);return t}function FH(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(d++),n>255&&(n=95),s=(r&3)<<4|n>>4,a=e.charCodeAt(d++),a>255&&(a=95),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Ar.charAt(i)+Ar.charAt(s)+Ar.charAt(l)+Ar.charAt(c);return t}function MH(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0,d=0;d<e.length;)r=e[d++],i=r>>2,n=e[d++],s=(r&3)<<4|n>>4,a=e[d++],l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Ar.charAt(i)+Ar.charAt(s)+Ar.charAt(l)+Ar.charAt(c);return t}function Qa(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,c=0;if(e.slice(0,5)=="data:"){var d=e.slice(0,1024).indexOf(";base64,");d>-1&&(e=e.slice(d+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Ar.indexOf(e.charAt(d++)),s=Ar.indexOf(e.charAt(d++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=Ar.indexOf(e.charAt(d++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Ar.indexOf(e.charAt(d++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var lt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ia=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),qc=(function(){if(typeof Buffer>"u")return!1;var e=ia([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function Ri(e){return lt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function lb(e){return lt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var un=function(t){return lt?ia(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function rd(e){if(typeof ArrayBuffer>"u")return un(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ii(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function LH(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Yt=lt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ia(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(un(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function BH(e){for(var t=[],r=0,n=e.length+250,a=Ri(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ri(65535),n=65530)}return t.push(a.slice(0,r)),Yt(t)}var xo=/\u0000/g,Kl=/[\u0001-\u0006]/g;function os(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Bn(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}function Jp(e,t){var r=""+e;return r.length>=t?r:jt(" ",t-r.length)+r}function Zc(e,t){var r=""+e;return r.length>=t?r:r+jt(" ",t-r.length)}function $H(e,t){var r=""+Math.round(e);return r.length>=t?r:jt("0",t-r.length)+r}function UH(e,t){var r=""+e;return r.length>=t?r:jt("0",t-r.length)+r}var cb=Math.pow(2,32);function Qi(e,t){if(e>cb||e<-cb)return $H(e,t);var r=Math.round(e);return UH(r,t)}function Jc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ub=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ff=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function HH(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var St={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},db={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},WH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qc(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,c=1,d=0,u=0,f=Math.floor(a);d<t&&(f=Math.floor(a),l=f*s+i,u=f*d+c,!(a-f<5e-8));)a=1/(a-f),i=s,s=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=s)),!r)return[0,n*l,u];var h=Math.floor(n*l/u);return[h,n*l-h*u,u]}function KH(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+jt("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+jt("0",t.length-15);return Number(n)}function es(e,t,r){if(e>2958465||e<0)return null;e=KH(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=XH(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}function Qp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function VH(e){var t=e<0?12:11,r=Qp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function GH(e){var t=Qp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function YH(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=VH(e):t===10?r=e.toFixed(10).substr(0,12):r=GH(e),Qp(zH(r.toUpperCase()))}function kh(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):YH(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Aa(14,yr(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function XH(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function qH(e,t,r,n){var a="",i=0,s=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return ff[r.m-1][1];case 5:return ff[r.m-1][0];default:return ff[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return ub[r.q][0];default:return ub[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Bn(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Bn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?Bn(c,d):"";return u}function Ka(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var _E=/%/g;function ZH(e,t,r){var n=t.replace(_E,""),a=t.length-n.length;return ya(e,n,r*Math.pow(10,2*a))+jt("%",a)}function JH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ya(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function SE(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+SE(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var EE=/# (\?+)( ?)\/( ?)(\d+)/;function QH(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?jt(" ",e[1].length+1+e[4].length):Jp(s,e[1].length)+e[2]+"/"+e[3]+Bn(l,e[4].length))}function eW(e,t,r){return r+(t===0?"":""+t)+jt(" ",e[1].length+2+e[4].length)}var TE=/^#*0*\.([0#]+)/,CE=/\)[^)]*[0#]/,jE=/\(###\) ###\\?-####/;function Mr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function fb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function hb(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function tW(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function rW(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(CE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Nn("n",n,r):"("+Nn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return JH(e,t,r);if(t.indexOf("%")!==-1)return ZH(e,t,r);if(t.indexOf("E")!==-1)return SE(t,r);if(t.charCodeAt(0)===36)return"$"+Nn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Qi(c,t.length);if(t.match(/^[#?]+$/))return a=Qi(r,0),a==="0"&&(a=""),a.length>t.length?a:Mr(t.substr(0,t.length-a.length))+a;if(i=t.match(EE))return QH(i,c,d);if(t.match(/^#+0+$/))return d+Qi(c,t.length-t.indexOf("0"));if(i=t.match(TE))return a=fb(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Mr(i[1])).replace(/\.$/,"."+Mr(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+jt("0",Mr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+fb(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ka(Qi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Nn(e,t,-r):Ka(""+(Math.floor(r)+tW(r,i[1].length)))+"."+Bn(hb(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Nn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=os(Nn(e,t.replace(/[\\-]/g,""),r)),s=0,os(os(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(jE))return a=Nn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Qc(c,Math.pow(10,s)-1,!1),a=""+d,u=ya("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zc(l[2],s),u.length<i[4].length&&(u=Mr(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Qc(c,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Jp(l[1],s)+i[2]+"/"+i[3]+Zc(l[2],s):jt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Qi(r,0),t.length<=a.length?a:Mr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return Mr(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=hb(r,i[1].length),r<0?"-"+Nn(e,t,-r):Ka(rW(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Bn(0,3-x.length):"")+x})+"."+Bn(s,i[1].length);switch(t){case"###,##0.00":return Nn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ka(Qi(c,0));return m!=="0"?d+m:"";case"###,###.00":return Nn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Nn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function nW(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ya(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aW(e,t,r){var n=t.replace(_E,""),a=t.length-n.length;return ya(e,n,r*Math.pow(10,2*a))+jt("%",a)}function AE(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+AE(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Kn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(CE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Kn("n",n,r):"("+Kn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return nW(e,t,r);if(t.indexOf("%")!==-1)return aW(e,t,r);if(t.indexOf("E")!==-1)return AE(t,r);if(t.charCodeAt(0)===36)return"$"+Kn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Bn(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Mr(t.substr(0,t.length-a.length))+a;if(i=t.match(EE))return eW(i,c,d);if(t.match(/^#+0+$/))return d+Bn(c,t.length-t.indexOf("0"));if(i=t.match(TE))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Mr(i[1])).replace(/\.$/,"."+Mr(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+jt("0",Mr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ka(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Kn(e,t,-r):Ka(""+r)+"."+jt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Kn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=os(Kn(e,t.replace(/[\\-]/g,""),r)),s=0,os(os(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(jE))return a=Kn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Qc(c,Math.pow(10,s)-1,!1),a=""+d,u=ya("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zc(l[2],s),u.length<i[4].length&&(u=Mr(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Qc(c,Math.pow(10,s)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Jp(l[1],s)+i[2]+"/"+i[3]+Zc(l[2],s):jt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Mr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return Mr(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Kn(e,t,-r):Ka(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Bn(0,3-x.length):"")+x})+"."+Bn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Ka(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return Kn(e,t.slice(0,t.lastIndexOf(".")),r)+Mr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ya(e,t,r){return(r|0)===r?Kn(e,t,r):Nn(e,t,r)}function iW(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var kE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fi(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Jc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(kE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function sW(e,t,r,n){for(var a=[],i="",s=0,l="",c="t",d,u,f,h="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!Jc(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var m=e.charAt(++s),x=m==="("||m===")"?m:"t";a[a.length]={t:x,v:m},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(d==null&&(d=es(t,r,e.charAt(s+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=es(t,r),d==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var g={t:l,v:l};if(d==null&&(d=es(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?e.charAt(s+2):l),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(d!=null&&(g.v=d.H>=12?"下午":"上午"),g.t="T",s+=5,h="h"):(g.t="t",++s),d==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(kE)){if(d==null&&(d=es(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fi(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var v=0,y=0,b;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",v<1&&(v=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(y=Math.max(y,b[0].length-1),v=4),v<3&&(v=3);case"d":case"y":case"e":c=a[s].t;break;case"M":c=a[s].t,v<2&&(v=2);break;case"m":c==="s"&&(a[s].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[s].v.match(/[Hh]/)&&(v=1),v<2&&a[s].v.match(/[Mm]/)&&(v=2),v<3&&a[s].v.match(/[Ss]/)&&(v=3)}var w;switch(v){case 0:break;case 1:case 2:case 3:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,w=es(d.D),w.u=d.u,w.S=d.S,w.M=d.M,w.H=d.H,d=w);break;case 4:switch(y){case 1:d.u=Math.round(d.u*10)/10;break;case 2:d.u=Math.round(d.u*100)/100;break;case 3:d.u=Math.round(d.u*1e3)/1e3;break}d.u>=1&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,w=es(d.D),w.u=d.u,w.S=d.S,w.M=d.M,w.H=d.H,d=w);break}var N="",_;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=qH(a[s].t.charCodeAt(0),a[s].v,d,y),a[s].t="t";break;case"n":case"?":for(_=s+1;a[_]!=null&&((l=a[_].t)==="?"||l==="D"||(l===" "||l==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[s].v+=a[_].v,a[_]={v:"",t:";"},++_;N+=a[s].v,s=_-1;break;case"G":a[s].t="t",a[s].v=kh(t,r);break}var E="",S,j;if(N.length>0){N.charCodeAt(0)==40?(S=t<0&&N.charCodeAt(0)===45?-t:t,j=ya("n",N,S)):(S=t<0&&n>1?-t:t,j=ya("n",N,S),S<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),_=j.length-1;var P=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){P=s;break}var C=a.length;if(P===a.length&&j.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(_>=a[s].v.length-1?(_-=a[s].v.length,a[s].v=j.substr(_+1,a[s].v.length)):_<0?a[s].v="":(a[s].v=j.substr(0,_+1),_=-1),a[s].t="t",C=s);_>=0&&C<a.length&&(a[C].v=j.substr(0,_+1)+a[C].v)}else if(P!==a.length&&j.indexOf("E")===-1){for(_=j.indexOf(".")-1,s=P;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")-1:a[s].v.length-1,E=a[s].v.substr(u+1);u>=0;--u)_>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(E=j.charAt(_--)+E);a[s].v=E,a[s].t="t",C=s}for(_>=0&&C<a.length&&(a[C].v=j.substr(0,_+1)+a[C].v),_=j.indexOf(".")+1,s=P;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==P)){for(u=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")+1:0,E=a[s].v.substr(0,u);u<a[s].v.length;++u)_<j.length&&(E+=j.charAt(_++));a[s].v=E,a[s].t="t",C=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(S=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=ya(a[s].t,a[s].v,S),a[s].t="t");var T="";for(s=0;s!==a.length;++s)a[s]!=null&&(T+=a[s].v);return T}var mb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function oW(e,t){var r=iW(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(mb),l=r[1].match(mb);return pb(t,s)?[n,r[0]]:pb(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function Aa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:St)[e],n==null&&(n=r.table&&r.table[db[e]]||St[db[e]]),n==null&&(n=WH[e]||"General");break}if(Jc(n,0))return kh(t,r);t instanceof Date&&(t=yr(t,r.date1904));var a=oW(n,t);if(Jc(a[1]))return kh(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return sW(a[1],t,r,a[0])}function PE(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(St[r]==null){t<0&&(t=r);continue}if(St[r]==e){t=r;break}}t<0&&(t=391)}return St[t]=e,t}function nd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&PE(e[t],t)}function ad(){St=HH()}var eu=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function lW(e){var t=typeof e=="number"?St[e]:e;return t=t.replace(eu,"(\\d+)"),eu.lastIndex=0,new RegExp("^"+t+"$")}function cW(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,c=-1;(t.match(eu)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":s=m;break;case"s":c=m;break;case"m":s>=0?l=m:a=m;break}}),eu.lastIndex=0,c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&i==-1?u:d+"T"+u}var uW={"d.m":"d\\.m"};function dW(e,t){return PE(uW[e]||e,t)}var xb=(function(){var e={};e.version="1.2.0";function t(){for(var S=0,j=new Array(256),P=0;P!=256;++P)S=P,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,j[P]=S;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(S){var j=0,P=0,C=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)T[C]=S[C];for(C=0;C!=256;++C)for(P=S[C],j=256+C;j<4096;j+=256)P=T[j]=P>>>8^S[P&255];var k=[];for(C=1;C!=16;++C)k[C-1]=typeof Int32Array<"u"&&typeof T.subarray=="function"?T.subarray(C*256,C*256+256):T.slice(C*256,C*256+256);return k}var a=n(r),i=a[0],s=a[1],l=a[2],c=a[3],d=a[4],u=a[5],f=a[6],h=a[7],m=a[8],x=a[9],g=a[10],v=a[11],y=a[12],b=a[13],w=a[14];function N(S,j){for(var P=j^-1,C=0,T=S.length;C<T;)P=P>>>8^r[(P^S.charCodeAt(C++))&255];return~P}function _(S,j){for(var P=j^-1,C=S.length-15,T=0;T<C;)P=w[S[T++]^P&255]^b[S[T++]^P>>8&255]^y[S[T++]^P>>16&255]^v[S[T++]^P>>>24]^g[S[T++]]^x[S[T++]]^m[S[T++]]^h[S[T++]]^f[S[T++]]^u[S[T++]]^d[S[T++]]^c[S[T++]]^l[S[T++]]^s[S[T++]]^i[S[T++]]^r[S[T++]];for(C+=15;T<C;)P=P>>>8^r[(P^S[T++])&255];return~P}function E(S,j){for(var P=j^-1,C=0,T=S.length,k=0,W=0;C<T;)k=S.charCodeAt(C++),k<128?P=P>>>8^r[(P^k)&255]:k<2048?(P=P>>>8^r[(P^(192|k>>6&31))&255],P=P>>>8^r[(P^(128|k&63))&255]):k>=55296&&k<57344?(k=(k&1023)+64,W=S.charCodeAt(C++)&1023,P=P>>>8^r[(P^(240|k>>8&7))&255],P=P>>>8^r[(P^(128|k>>2&63))&255],P=P>>>8^r[(P^(128|W>>6&15|(k&3)<<4))&255],P=P>>>8^r[(P^(128|W&63))&255]):(P=P>>>8^r[(P^(224|k>>12&15))&255],P=P>>>8^r[(P^(128|k>>6&63))&255],P=P>>>8^r[(P^(128|k&63))&255]);return~P}return e.table=r,e.bstr=N,e.buf=_,e.str=E,e})(),vt=(function(){var t={};t.version="1.2.2";function r(A,B){for(var R=A.split("/"),F=B.split("/"),L=0,H=0,re=Math.min(R.length,F.length);L<re;++L){if(H=R[L].length-F[L].length)return H;if(R[L]!=F[L])return R[L]<F[L]?-1:1}return R.length-F.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(0,B+1)}function a(A){if(A.charAt(A.length-1)=="/")return a(A.slice(0,-1));var B=A.lastIndexOf("/");return B===-1?A:A.slice(B+1)}function i(A,B){typeof B=="string"&&(B=new Date(B));var R=B.getHours();R=R<<6|B.getMinutes(),R=R<<5|B.getSeconds()>>>1,A.write_shift(2,R);var F=B.getFullYear()-1980;F=F<<4|B.getMonth()+1,F=F<<5|B.getDate(),A.write_shift(2,F)}function s(A){var B=A.read_shift(2)&65535,R=A.read_shift(2)&65535,F=new Date,L=R&31;R>>>=5;var H=R&15;R>>>=4,F.setMilliseconds(0),F.setFullYear(R+1980),F.setMonth(H-1),F.setDate(L);var re=B&31;B>>>=5;var xe=B&63;return B>>>=6,F.setHours(B),F.setMinutes(xe),F.setSeconds(re<<1),F}function l(A){Lr(A,0);for(var B={},R=0;A.l<=A.length-4;){var F=A.read_shift(2),L=A.read_shift(2),H=A.l+L,re={};switch(F){case 21589:R=A.read_shift(1),R&1&&(re.mtime=A.read_shift(4)),L>5&&(R&2&&(re.atime=A.read_shift(4)),R&4&&(re.ctime=A.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break;case 1:{var xe=A.read_shift(4),ee=A.read_shift(4);re.usz=ee*Math.pow(2,32)+xe,xe=A.read_shift(4),ee=A.read_shift(4),re.csz=ee*Math.pow(2,32)+xe}break}A.l=H,B[F]=re}return B}var c;function d(){return c||(c=fW)}function u(A,B){if(A[0]==80&&A[1]==75)return qe(A,B);if((A[0]|32)==109&&(A[1]|32)==105)return Dn(A,B);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var R=3,F=512,L=0,H=0,re=0,xe=0,ee=0,ne=[],ae=A.slice(0,512);Lr(ae,0);var Se=f(ae);switch(R=Se[0],R){case 3:F=512;break;case 4:F=4096;break;case 0:if(Se[1]==0)return qe(A,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}F!==512&&(ae=A.slice(0,F),Lr(ae,28));var ke=A.slice(0,F);h(ae,R);var Re=ae.read_shift(4,"i");if(R===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);ae.l+=4,re=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),xe=ae.read_shift(4,"i"),L=ae.read_shift(4,"i"),ee=ae.read_shift(4,"i"),H=ae.read_shift(4,"i");for(var Ee=-1,Pe=0;Pe<109&&(Ee=ae.read_shift(4,"i"),!(Ee<0));++Pe)ne[Pe]=Ee;var Je=m(A,F);v(ee,H,Je,F,ne);var Tt=b(Je,re,ne,F);re<Tt.length&&(Tt[re].name="!Directory"),L>0&&xe!==W&&(Tt[xe].name="!MiniFAT"),Tt[ne[0]].name="!FAT",Tt.fat_addrs=ne,Tt.ssz=F;var It={},Nr=[],Ks=[],zs=[];w(re,Tt,Je,Nr,L,It,Ks,xe),x(Ks,zs,Nr),Nr.shift();var Vs={FileIndex:Ks,FullPaths:zs};return B&&B.raw&&(Vs.raw={header:ke,sectors:Je}),Vs}function f(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(G,"Header Signature: "),A.l+=16;var B=A.read_shift(2,"u");return[A.read_shift(2,"u"),B]}function h(A,B){var R=9;switch(A.l+=2,R=A.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function m(A,B){for(var R=Math.ceil(A.length/B)-1,F=[],L=1;L<R;++L)F[L-1]=A.slice(L*B,(L+1)*B);return F[R-1]=A.slice(R*B),F}function x(A,B,R){for(var F=0,L=0,H=0,re=0,xe=0,ee=R.length,ne=[],ae=[];F<ee;++F)ne[F]=ae[F]=F,B[F]=R[F];for(;xe<ae.length;++xe)F=ae[xe],L=A[F].L,H=A[F].R,re=A[F].C,ne[F]===F&&(L!==-1&&ne[L]!==L&&(ne[F]=ne[L]),H!==-1&&ne[H]!==H&&(ne[F]=ne[H])),re!==-1&&(ne[re]=F),L!==-1&&F!=ne[F]&&(ne[L]=ne[F],ae.lastIndexOf(L)<xe&&ae.push(L)),H!==-1&&F!=ne[F]&&(ne[H]=ne[F],ae.lastIndexOf(H)<xe&&ae.push(H));for(F=1;F<ee;++F)ne[F]===F&&(H!==-1&&ne[H]!==H?ne[F]=ne[H]:L!==-1&&ne[L]!==L&&(ne[F]=ne[L]));for(F=1;F<ee;++F)if(A[F].type!==0){if(xe=F,xe!=ne[xe])do xe=ne[xe],B[F]=B[xe]+"/"+B[F];while(xe!==0&&ne[xe]!==-1&&xe!=ne[xe]);ne[F]=-1}for(B[0]+="/",F=1;F<ee;++F)A[F].type!==2&&(B[F]+="/")}function g(A,B,R){for(var F=A.start,L=A.size,H=[],re=F;R&&L>0&&re>=0;)H.push(B.slice(re*k,re*k+k)),L-=k,re=xi(R,re*4);return H.length===0?te(0):Yt(H).slice(0,A.size)}function v(A,B,R,F,L){var H=W;if(A===W){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var re=R[A],xe=(F>>>2)-1;if(!re)return;for(var ee=0;ee<xe&&(H=xi(re,ee*4))!==W;++ee)L.push(H);B>=1&&v(xi(re,F-4),B-1,R,F,L)}}function y(A,B,R,F,L){var H=[],re=[];L||(L=[]);var xe=F-1,ee=0,ne=0;for(ee=B;ee>=0;){L[ee]=!0,H[H.length]=ee,re.push(A[ee]);var ae=R[Math.floor(ee*4/F)];if(ne=ee*4&xe,F<4+ne)throw new Error("FAT boundary crossed: "+ee+" 4 "+F);if(!A[ae])break;ee=xi(A[ae],ne)}return{nodes:H,data:_b([re])}}function b(A,B,R,F){var L=A.length,H=[],re=[],xe=[],ee=[],ne=F-1,ae=0,Se=0,ke=0,Re=0;for(ae=0;ae<L;++ae)if(xe=[],ke=ae+B,ke>=L&&(ke-=L),!re[ke]){ee=[];var Ee=[];for(Se=ke;Se>=0;){Ee[Se]=!0,re[Se]=!0,xe[xe.length]=Se,ee.push(A[Se]);var Pe=R[Math.floor(Se*4/F)];if(Re=Se*4&ne,F<4+Re)throw new Error("FAT boundary crossed: "+Se+" 4 "+F);if(!A[Pe]||(Se=xi(A[Pe],Re),Ee[Se]))break}H[ke]={nodes:xe,data:_b([ee])}}return H}function w(A,B,R,F,L,H,re,xe){for(var ee=0,ne=F.length?2:0,ae=B[A].data,Se=0,ke=0,Re;Se<ae.length;Se+=128){var Ee=ae.slice(Se,Se+128);Lr(Ee,64),ke=Ee.read_shift(2),Re=ix(Ee,0,ke-ne),F.push(Re);var Pe={name:Re,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Je=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Je!==0&&(Pe.ct=N(Ee,Ee.l-8));var Tt=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Tt!==0&&(Pe.mt=N(Ee,Ee.l-8)),Pe.start=Ee.read_shift(4,"i"),Pe.size=Ee.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=W,Pe.name=""),Pe.type===5?(ee=Pe.start,L>0&&ee!==W&&(B[ee].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",B[Pe.start]===void 0&&(B[Pe.start]=y(R,Pe.start,B.fat_addrs,B.ssz)),B[Pe.start].name=Pe.name,Pe.content=B[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ee!==W&&Pe.start!==W&&B[ee]&&(Pe.content=g(Pe,B[ee].data,(B[xe]||{}).data))),Pe.content&&Lr(Pe.content,0),H[Re]=Pe,re.push(Pe)}}function N(A,B){return new Date((fn(A,B+4)/1e7*Math.pow(2,32)+fn(A,B)/1e7-11644473600)*1e3)}function _(A,B){return d(),u(c.readFileSync(A),B)}function E(A,B){var R=B&&B.type;switch(R||lt&&Buffer.isBuffer(A)&&(R="buffer"),R||"base64"){case"file":return _(A,B);case"base64":return u(un(Qa(A)),B);case"binary":return u(un(A),B)}return u(A,B)}function S(A,B){var R=B||{},F=R.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=F+"/",A.FileIndex[0]={name:F,type:5}),R.CLSID&&(A.FileIndex[0].clsid=R.CLSID),j(A)}function j(A){var B="Sh33tJ5";if(!vt.find(A,"/"+B)){var R=te(4);R[0]=55,R[1]=R[3]=50,R[2]=54,A.FileIndex.push({name:B,type:2,content:R,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+B),P(A)}}function P(A,B){S(A);for(var R=!1,F=!1,L=A.FullPaths.length-1;L>=0;--L){var H=A.FileIndex[L];switch(H.type){case 0:F?R=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(H.R*H.L*H.C)&&(R=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!B)){var re=new Date(1987,1,19),xe=0,ee=Object.create?Object.create(null):{},ne=[];for(L=0;L<A.FullPaths.length;++L)ee[A.FullPaths[L]]=!0,A.FileIndex[L].type!==0&&ne.push([A.FullPaths[L],A.FileIndex[L]]);for(L=0;L<ne.length;++L){var ae=n(ne[L][0]);for(F=ee[ae];!F;){for(;n(ae)&&!ee[n(ae)];)ae=n(ae);ne.push([ae,{name:a(ae).replace("/",""),type:1,clsid:J,ct:re,mt:re,content:null}]),ee[ae]=!0,ae=n(ne[L][0]),F=ee[ae]}}for(ne.sort(function(Re,Ee){return r(Re[0],Ee[0])}),A.FullPaths=[],A.FileIndex=[],L=0;L<ne.length;++L)A.FullPaths[L]=ne[L][0],A.FileIndex[L]=ne[L][1];for(L=0;L<ne.length;++L){var Se=A.FileIndex[L],ke=A.FullPaths[L];if(Se.name=a(ke).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||J,L===0)Se.C=ne.length>1?1:-1,Se.size=0,Se.type=5;else if(ke.slice(-1)=="/"){for(xe=L+1;xe<ne.length&&n(A.FullPaths[xe])!=ke;++xe);for(Se.C=xe>=ne.length?-1:xe,xe=L+1;xe<ne.length&&n(A.FullPaths[xe])!=n(ke);++xe);Se.R=xe>=ne.length?-1:xe,Se.type=1}else n(A.FullPaths[L+1]||"")==n(ke)&&(Se.R=L+1),Se.type=2}}}function C(A,B){var R=B||{};if(R.fileType=="mad")return Ws(A,R);switch(P(A),R.fileType){case"zip":return Bt(A,R)}var F=(function(Re){for(var Ee=0,Pe=0,Je=0;Je<Re.FileIndex.length;++Je){var Tt=Re.FileIndex[Je];if(Tt.content){var It=Tt.content.length;It>0&&(It<4096?Ee+=It+63>>6:Pe+=It+511>>9)}}for(var Nr=Re.FullPaths.length+3>>2,Ks=Ee+7>>3,zs=Ee+127>>7,Vs=Ks+Pe+Nr+zs,ci=Vs+127>>7,pd=ci<=109?0:Math.ceil((ci-109)/127);Vs+ci+pd+127>>7>ci;)pd=++ci<=109?0:Math.ceil((ci-109)/127);var oa=[1,pd,ci,zs,Nr,Pe,Ee,0];return Re.FileIndex[0].size=Ee<<6,oa[7]=(Re.FileIndex[0].start=oa[0]+oa[1]+oa[2]+oa[3]+oa[4]+oa[5])+(oa[6]+7>>3),oa})(A),L=te(F[7]<<9),H=0,re=0;{for(H=0;H<8;++H)L.write_shift(1,K[H]);for(H=0;H<8;++H)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),H=0;H<3;++H)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:W),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:W),L.write_shift(4,F[1]),H=0;H<109;++H)L.write_shift(-4,H<F[2]?F[1]+H:-1)}if(F[1])for(re=0;re<F[1];++re){for(;H<236+re*127;++H)L.write_shift(-4,H<F[2]?F[1]+H:-1);L.write_shift(-4,re===F[1]-1?W:re+1)}var xe=function(Re){for(re+=Re;H<re-1;++H)L.write_shift(-4,H+1);Re&&(++H,L.write_shift(-4,W))};for(re=H=0,re+=F[1];H<re;++H)L.write_shift(-4,V.DIFSECT);for(re+=F[2];H<re;++H)L.write_shift(-4,V.FATSECT);xe(F[3]),xe(F[4]);for(var ee=0,ne=0,ae=A.FileIndex[0];ee<A.FileIndex.length;++ee)ae=A.FileIndex[ee],ae.content&&(ne=ae.content.length,!(ne<4096)&&(ae.start=re,xe(ne+511>>9)));for(xe(F[6]+7>>3);L.l&511;)L.write_shift(-4,V.ENDOFCHAIN);for(re=H=0,ee=0;ee<A.FileIndex.length;++ee)ae=A.FileIndex[ee],ae.content&&(ne=ae.content.length,!(!ne||ne>=4096)&&(ae.start=re,xe(ne+63>>6)));for(;L.l&511;)L.write_shift(-4,V.ENDOFCHAIN);for(H=0;H<F[4]<<2;++H){var Se=A.FullPaths[H];if(!Se||Se.length===0){for(ee=0;ee<17;++ee)L.write_shift(4,0);for(ee=0;ee<3;++ee)L.write_shift(4,-1);for(ee=0;ee<12;++ee)L.write_shift(4,0);continue}ae=A.FileIndex[H],H===0&&(ae.start=ae.size?ae.start-1:W);var ke=H===0&&R.root||ae.name;if(ke.length>31&&(console.error("Name "+ke+" will be truncated to "+ke.slice(0,31)),ke=ke.slice(0,31)),ne=2*(ke.length+1),L.write_shift(64,ke,"utf16le"),L.write_shift(2,ne),L.write_shift(1,ae.type),L.write_shift(1,ae.color),L.write_shift(-4,ae.L),L.write_shift(-4,ae.R),L.write_shift(-4,ae.C),ae.clsid)L.write_shift(16,ae.clsid,"hex");else for(ee=0;ee<4;++ee)L.write_shift(4,0);L.write_shift(4,ae.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ae.start),L.write_shift(4,ae.size),L.write_shift(4,0)}for(H=1;H<A.FileIndex.length;++H)if(ae=A.FileIndex[H],ae.size>=4096)if(L.l=ae.start+1<<9,lt&&Buffer.isBuffer(ae.content))ae.content.copy(L,L.l,0,ae.size),L.l+=ae.size+511&-512;else{for(ee=0;ee<ae.size;++ee)L.write_shift(1,ae.content[ee]);for(;ee&511;++ee)L.write_shift(1,0)}for(H=1;H<A.FileIndex.length;++H)if(ae=A.FileIndex[H],ae.size>0&&ae.size<4096)if(lt&&Buffer.isBuffer(ae.content))ae.content.copy(L,L.l,0,ae.size),L.l+=ae.size+63&-64;else{for(ee=0;ee<ae.size;++ee)L.write_shift(1,ae.content[ee]);for(;ee&63;++ee)L.write_shift(1,0)}if(lt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function T(A,B){var R=A.FullPaths.map(function(ee){return ee.toUpperCase()}),F=R.map(function(ee){var ne=ee.split("/");return ne[ne.length-(ee.slice(-1)=="/"?2:1)]}),L=!1;B.charCodeAt(0)===47?(L=!0,B=R[0].slice(0,-1)+B):L=B.indexOf("/")!==-1;var H=B.toUpperCase(),re=L===!0?R.indexOf(H):F.indexOf(H);if(re!==-1)return A.FileIndex[re];var xe=!H.match(Kl);for(H=H.replace(xo,""),xe&&(H=H.replace(Kl,"!")),re=0;re<R.length;++re)if((xe?R[re].replace(Kl,"!"):R[re]).replace(xo,"")==H||(xe?F[re].replace(Kl,"!"):F[re]).replace(xo,"")==H)return A.FileIndex[re];return null}var k=64,W=-2,G="d0cf11e0a1b11ae1",K=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(A,B,R){d();var F=C(A,R);c.writeFileSync(B,F)}function Q(A){for(var B=new Array(A.length),R=0;R<A.length;++R)B[R]=String.fromCharCode(A[R]);return B.join("")}function Y(A,B){var R=C(A,B);switch(B&&B.type||"buffer"){case"file":return d(),c.writeFileSync(B.filename,R),R;case"binary":return typeof R=="string"?R:Q(R);case"base64":return Xc(typeof R=="string"?R:Q(R));case"buffer":if(lt)return Buffer.isBuffer(R)?R:ia(R);case"array":return typeof R=="string"?un(R):R}return R}var le;function de(A){try{var B=A.InflateRaw,R=new B;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)le=A;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function pe(A,B){if(!le)return Ge(A,B);var R=le.InflateRaw,F=new R,L=F._processChunk(A.slice(A.l),F._finishFlushFlag);return A.l+=F.bytesRead,L}function _e(A){return le?le.deflateRawSync(A):tt(A)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(A){var B=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(B>>16|B>>8|B)&255}for(var D=typeof Uint8Array<"u",M=D?new Uint8Array(256):[],I=0;I<256;++I)M[I]=O(I);function z(A,B){var R=M[A&255];return B<=8?R>>>8-B:(R=R<<8|M[A>>8&255],B<=16?R>>>16-B:(R=R<<8|M[A>>16&255],R>>>24-B))}function se(A,B){var R=B&7,F=B>>>3;return(A[F]|(R<=6?0:A[F+1]<<8))>>>R&3}function ce(A,B){var R=B&7,F=B>>>3;return(A[F]|(R<=5?0:A[F+1]<<8))>>>R&7}function Ae(A,B){var R=B&7,F=B>>>3;return(A[F]|(R<=4?0:A[F+1]<<8))>>>R&15}function be(A,B){var R=B&7,F=B>>>3;return(A[F]|(R<=3?0:A[F+1]<<8))>>>R&31}function X(A,B){var R=B&7,F=B>>>3;return(A[F]|(R<=1?0:A[F+1]<<8))>>>R&127}function fe(A,B,R){var F=B&7,L=B>>>3,H=(1<<R)-1,re=A[L]>>>F;return R<8-F||(re|=A[L+1]<<8-F,R<16-F)||(re|=A[L+2]<<16-F,R<24-F)||(re|=A[L+3]<<24-F),re&H}function Oe(A,B,R){var F=B&7,L=B>>>3;return F<=5?A[L]|=(R&7)<<F:(A[L]|=R<<F&255,A[L+1]=(R&7)>>8-F),B+3}function Me(A,B,R){var F=B&7,L=B>>>3;return R=(R&1)<<F,A[L]|=R,B+1}function me(A,B,R){var F=B&7,L=B>>>3;return R<<=F,A[L]|=R&255,R>>>=8,A[L+1]=R,B+8}function we(A,B,R){var F=B&7,L=B>>>3;return R<<=F,A[L]|=R&255,R>>>=8,A[L+1]=R&255,A[L+2]=R>>>8,B+16}function he(A,B){var R=A.length,F=2*R>B?2*R:B+5,L=0;if(R>=B)return A;if(lt){var H=lb(F);if(A.copy)A.copy(H);else for(;L<A.length;++L)H[L]=A[L];return H}else if(D){var re=new Uint8Array(F);if(re.set)re.set(A);else for(;L<R;++L)re[L]=A[L];return re}return A.length=F,A}function Ce(A){for(var B=new Array(A),R=0;R<A;++R)B[R]=0;return B}function ge(A,B,R){var F=1,L=0,H=0,re=0,xe=0,ee=A.length,ne=D?new Uint16Array(32):Ce(32);for(H=0;H<32;++H)ne[H]=0;for(H=ee;H<R;++H)A[H]=0;ee=A.length;var ae=D?new Uint16Array(ee):Ce(ee);for(H=0;H<ee;++H)ne[L=A[H]]++,F<L&&(F=L),ae[H]=0;for(ne[0]=0,H=1;H<=F;++H)ne[H+16]=xe=xe+ne[H-1]<<1;for(H=0;H<ee;++H)xe=A[H],xe!=0&&(ae[H]=ne[xe+16]++);var Se=0;for(H=0;H<ee;++H)if(Se=A[H],Se!=0)for(xe=z(ae[H],F)>>F-Se,re=(1<<F+4-Se)-1;re>=0;--re)B[xe|re<<Se]=Se&15|H<<4;return F}var Ve=D?new Uint16Array(512):Ce(512),De=D?new Uint16Array(32):Ce(32);if(!D){for(var je=0;je<512;++je)Ve[je]=0;for(je=0;je<32;++je)De[je]=0}(function(){for(var A=[],B=0;B<32;B++)A.push(5);ge(A,De,32);var R=[];for(B=0;B<=143;B++)R.push(8);for(;B<=255;B++)R.push(9);for(;B<=279;B++)R.push(7);for(;B<=287;B++)R.push(8);ge(R,Ve,288)})();var Xe=(function(){for(var B=D?new Uint8Array(32768):[],R=0,F=0;R<ve.length-1;++R)for(;F<ve[R+1];++F)B[F]=R;for(;F<32768;++F)B[F]=29;var L=D?new Uint8Array(259):[];for(R=0,F=0;R<oe.length-1;++R)for(;F<oe[R+1];++F)L[F]=R;function H(xe,ee){for(var ne=0;ne<xe.length;){var ae=Math.min(65535,xe.length-ne),Se=ne+ae==xe.length;for(ee.write_shift(1,+Se),ee.write_shift(2,ae),ee.write_shift(2,~ae&65535);ae-- >0;)ee[ee.l++]=xe[ne++]}return ee.l}function re(xe,ee){for(var ne=0,ae=0,Se=D?new Uint16Array(32768):[];ae<xe.length;){var ke=Math.min(65535,xe.length-ae);if(ke<10){for(ne=Oe(ee,ne,+(ae+ke==xe.length)),ne&7&&(ne+=8-(ne&7)),ee.l=ne/8|0,ee.write_shift(2,ke),ee.write_shift(2,~ke&65535);ke-- >0;)ee[ee.l++]=xe[ae++];ne=ee.l*8;continue}ne=Oe(ee,ne,+(ae+ke==xe.length)+2);for(var Re=0;ke-- >0;){var Ee=xe[ae];Re=(Re<<5^Ee)&32767;var Pe=-1,Je=0;if((Pe=Se[Re])&&(Pe|=ae&-32768,Pe>ae&&(Pe-=32768),Pe<ae))for(;xe[Pe+Je]==xe[ae+Je]&&Je<250;)++Je;if(Je>2){Ee=L[Je],Ee<=22?ne=me(ee,ne,M[Ee+1]>>1)-1:(me(ee,ne,3),ne+=5,me(ee,ne,M[Ee-23]>>5),ne+=3);var Tt=Ee<8?0:Ee-4>>2;Tt>0&&(we(ee,ne,Je-oe[Ee]),ne+=Tt),Ee=B[ae-Pe],ne=me(ee,ne,M[Ee]>>3),ne-=3;var It=Ee<4?0:Ee-2>>1;It>0&&(we(ee,ne,ae-Pe-ve[Ee]),ne+=It);for(var Nr=0;Nr<Je;++Nr)Se[Re]=ae&32767,Re=(Re<<5^xe[ae])&32767,++ae;ke-=Je-1}else Ee<=143?Ee=Ee+48:ne=Me(ee,ne,1),ne=me(ee,ne,M[Ee]),Se[Re]=ae&32767,++ae}ne=me(ee,ne,0)-1}return ee.l=(ne+7)/8|0,ee.l}return function(ee,ne){return ee.length<8?H(ee,ne):re(ee,ne)}})();function tt(A){var B=te(50+Math.floor(A.length*1.1)),R=Xe(A,B);return B.slice(0,R)}var Ue=D?new Uint16Array(32768):Ce(32768),Le=D?new Uint16Array(32768):Ce(32768),dt=D?new Uint16Array(128):Ce(128),Be=1,it=1;function ue(A,B){var R=be(A,B)+257;B+=5;var F=be(A,B)+1;B+=5;var L=Ae(A,B)+4;B+=4;for(var H=0,re=D?new Uint8Array(19):Ce(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,ne=D?new Uint8Array(8):Ce(8),ae=D?new Uint8Array(8):Ce(8),Se=re.length,ke=0;ke<L;++ke)re[q[ke]]=H=ce(A,B),ee<H&&(ee=H),ne[H]++,B+=3;var Re=0;for(ne[0]=0,ke=1;ke<=ee;++ke)ae[ke]=Re=Re+ne[ke-1]<<1;for(ke=0;ke<Se;++ke)(Re=re[ke])!=0&&(xe[ke]=ae[Re]++);var Ee=0;for(ke=0;ke<Se;++ke)if(Ee=re[ke],Ee!=0){Re=M[xe[ke]]>>8-Ee;for(var Pe=(1<<7-Ee)-1;Pe>=0;--Pe)dt[Re|Pe<<Ee]=Ee&7|ke<<3}var Je=[];for(ee=1;Je.length<R+F;)switch(Re=dt[X(A,B)],B+=Re&7,Re>>>=3){case 16:for(H=3+se(A,B),B+=2,Re=Je[Je.length-1];H-- >0;)Je.push(Re);break;case 17:for(H=3+ce(A,B),B+=3;H-- >0;)Je.push(0);break;case 18:for(H=11+X(A,B),B+=7;H-- >0;)Je.push(0);break;default:Je.push(Re),ee<Re&&(ee=Re);break}var Tt=Je.slice(0,R),It=Je.slice(R);for(ke=R;ke<286;++ke)Tt[ke]=0;for(ke=F;ke<30;++ke)It[ke]=0;return Be=ge(Tt,Ue,286),it=ge(It,Le,30),B}function Ie(A,B){if(A[0]==3&&!(A[1]&3))return[Ri(B),2];for(var R=0,F=0,L=lb(B||1<<18),H=0,re=L.length>>>0,xe=0,ee=0;(F&1)==0;){if(F=ce(A,R),R+=3,F>>>1)F>>1==1?(xe=9,ee=5):(R=ue(A,R),xe=Be,ee=it);else{R&7&&(R+=8-(R&7));var ne=A[R>>>3]|A[(R>>>3)+1]<<8;if(R+=32,ne>0)for(!B&&re<H+ne&&(L=he(L,H+ne),re=L.length);ne-- >0;)L[H++]=A[R>>>3],R+=8;continue}for(;;){!B&&re<H+32767&&(L=he(L,H+32767),re=L.length);var ae=fe(A,R,xe),Se=F>>>1==1?Ve[ae]:Ue[ae];if(R+=Se&15,Se>>>=4,(Se>>>8&255)===0)L[H++]=Se;else{if(Se==256)break;Se-=257;var ke=Se<8?0:Se-4>>2;ke>5&&(ke=0);var Re=H+oe[Se];ke>0&&(Re+=fe(A,R,ke),R+=ke),ae=fe(A,R,ee),Se=F>>>1==1?De[ae]:Le[ae],R+=Se&15,Se>>>=4;var Ee=Se<4?0:Se-2>>1,Pe=ve[Se];for(Ee>0&&(Pe+=fe(A,R,Ee),R+=Ee),!B&&re<Re&&(L=he(L,Re+100),re=L.length);H<Re;)L[H]=L[H-Pe],++H}}}return B?[L,R+7>>>3]:[L.slice(0,H),R+7>>>3]}function Ge(A,B){var R=A.slice(A.l||0),F=Ie(R,B);return A.l+=F[1],F[0]}function Ye(A,B){if(A)typeof console<"u"&&console.error(B);else throw new Error(B)}function qe(A,B){var R=A;Lr(R,0);var F=[],L=[],H={FileIndex:F,FullPaths:L};S(H,{root:B.root});for(var re=R.length-4;(R[re]!=80||R[re+1]!=75||R[re+2]!=5||R[re+3]!=6)&&re>=0;)--re;R.l=re+4,R.l+=4;var xe=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,re=0;re<xe;++re){R.l+=20;var ne=R.read_shift(4),ae=R.read_shift(4),Se=R.read_shift(2),ke=R.read_shift(2),Re=R.read_shift(2);R.l+=8;var Ee=R.read_shift(4),Pe=l(R.slice(R.l+Se,R.l+Se+ke));R.l+=Se+ke+Re;var Je=R.l;R.l=Ee+4,Pe&&Pe[1]&&((Pe[1]||{}).usz&&(ae=Pe[1].usz),(Pe[1]||{}).csz&&(ne=Pe[1].csz)),ut(R,ne,ae,H,Pe),R.l=Je}return H}function ut(A,B,R,F,L){A.l+=2;var H=A.read_shift(2),re=A.read_shift(2),xe=s(A);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ee=A.read_shift(4),ne=A.read_shift(4),ae=A.read_shift(4),Se=A.read_shift(2),ke=A.read_shift(2),Re="",Ee=0;Ee<Se;++Ee)Re+=String.fromCharCode(A[A.l++]);if(ke){var Pe=l(A.slice(A.l,A.l+ke));(Pe[21589]||{}).mt&&(xe=Pe[21589].mt),(Pe[1]||{}).usz&&(ae=Pe[1].usz),(Pe[1]||{}).csz&&(ne=Pe[1].csz),L&&((L[21589]||{}).mt&&(xe=L[21589].mt),(L[1]||{}).usz&&(ae=L[1].usz),(L[1]||{}).csz&&(ne=L[1].csz))}A.l+=ke;var Je=A.slice(A.l,A.l+ne);switch(re){case 8:Je=pe(A,ae);break;case 0:A.l+=ne;break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Tt=!1;H&8&&(ee=A.read_shift(4),ee==134695760&&(ee=A.read_shift(4),Tt=!0),ne=A.read_shift(4),ae=A.read_shift(4)),ne!=B&&Ye(Tt,"Bad compressed size: "+B+" != "+ne),ae!=R&&Ye(Tt,"Bad uncompressed size: "+R+" != "+ae),La(F,Re,Je,{unsafe:!0,mt:xe})}function Bt(A,B){var R=B||{},F=[],L=[],H=te(1),re=R.compression?8:0,xe=0,ee=0,ne=0,ae=0,Se=0,ke=A.FullPaths[0],Re=ke,Ee=A.FileIndex[0],Pe=[],Je=0;for(ee=1;ee<A.FullPaths.length;++ee)if(Re=A.FullPaths[ee].slice(ke.length),Ee=A.FileIndex[ee],!(!Ee.size||!Ee.content||Array.isArray(Ee.content)&&Ee.content.length==0||Re=="Sh33tJ5")){var Tt=ae,It=te(Re.length);for(ne=0;ne<Re.length;++ne)It.write_shift(1,Re.charCodeAt(ne)&127);It=It.slice(0,It.l),Pe[Se]=typeof Ee.content=="string"?xb.bstr(Ee.content,0):xb.buf(Ee.content,0);var Nr=typeof Ee.content=="string"?un(Ee.content):Ee.content;re==8&&(Nr=_e(Nr)),H=te(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,xe),H.write_shift(2,re),Ee.mt?i(H,Ee.mt):H.write_shift(4,0),H.write_shift(-4,Pe[Se]),H.write_shift(4,Nr.length),H.write_shift(4,Ee.content.length),H.write_shift(2,It.length),H.write_shift(2,0),ae+=H.length,F.push(H),ae+=It.length,F.push(It),ae+=Nr.length,F.push(Nr),H=te(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,xe),H.write_shift(2,re),H.write_shift(4,0),H.write_shift(-4,Pe[Se]),H.write_shift(4,Nr.length),H.write_shift(4,Ee.content.length),H.write_shift(2,It.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Tt),Je+=H.l,L.push(H),Je+=It.length,L.push(It),++Se}return H=te(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Se),H.write_shift(2,Se),H.write_shift(4,Je),H.write_shift(4,ae),H.write_shift(2,0),Yt([Yt(F),Yt(L),H])}var Nt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Gr(A,B){if(A.ctype)return A.ctype;var R=A.name||"",F=R.match(/\.([^\.]+)$/);return F&&Nt[F[1]]||B&&(F=(R=B).match(/[\.\\]([^\.\\])+$/),F&&Nt[F[1]])?Nt[F[1]]:"application/octet-stream"}function wr(A){for(var B=Xc(A),R=[],F=0;F<B.length;F+=76)R.push(B.slice(F,F+76));return R.join(`\r
`)+`\r
`}function Ma(A){var B=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var ae=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],F=B.split(`\r
`),L=0;L<F.length;++L){var H=F[L];if(H.length==0){R.push("");continue}for(var re=0;re<H.length;){var xe=76,ee=H.slice(re,re+xe);ee.charAt(xe-1)=="="?xe--:ee.charAt(xe-2)=="="?xe-=2:ee.charAt(xe-3)=="="&&(xe-=3),ee=H.slice(re,re+xe),re+=xe,re<H.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function Hn(A){for(var B=[],R=0;R<A.length;++R){for(var F=A[R];R<=A.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+A[++R];B.push(F)}for(var L=0;L<B.length;++L)B[L]=B[L].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return un(B.join(`\r
`))}function Yr(A,B,R){for(var F="",L="",H="",re,xe=0;xe<10;++xe){var ee=B[xe];if(!ee||ee.match(/^\s*$/))break;var ne=ee.match(/^([^:]*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":F=ne[2].trim();break;case"content-type":H=ne[2].trim();break;case"content-transfer-encoding":L=ne[2].trim();break}}switch(++xe,L.toLowerCase()){case"base64":re=un(Qa(B.slice(xe).join("")));break;case"quoted-printable":re=Hn(B.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ae=La(A,F.slice(R.length),re,{unsafe:!0});H&&(ae.ctype=H)}function Dn(A,B){if(Q(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=B&&B.root||"",F=(lt&&Buffer.isBuffer(A)?A.toString("binary"):Q(A)).split(`\r
`),L=0,H="";for(L=0;L<F.length;++L)if(H=F[L],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),R||(R=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),H.slice(0,R.length)!=R););var re=(F[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var xe="--"+(re[1]||""),ee=[],ne=[],ae={FileIndex:ee,FullPaths:ne};S(ae);var Se,ke=0;for(L=0;L<F.length;++L){var Re=F[L];Re!==xe&&Re!==xe+"--"||(ke++&&Yr(ae,F.slice(Se,L),R),Se=L)}return ae}function Ws(A,B){var R=B||{},F=R.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],H=A.FullPaths[0],re=H,xe=A.FileIndex[0],ee=1;ee<A.FullPaths.length;++ee)if(re=A.FullPaths[ee].slice(H.length),xe=A.FileIndex[ee],!(!xe.size||!xe.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var ne=xe.content,ae=lt&&Buffer.isBuffer(ne)?ne.toString("binary"):Q(ne),Se=0,ke=Math.min(1024,ae.length),Re=0,Ee=0;Ee<=ke;++Ee)(Re=ae.charCodeAt(Ee))>=32&&Re<128&&++Se;var Pe=Se>=ke*4/5;L.push(F),L.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+re),L.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),L.push("Content-Type: "+Gr(xe,re)),L.push(""),L.push(Pe?Ma(ae):wr(ae))}return L.push(F+`--\r
`),L.join(`\r
`)}function sa(A){var B={};return S(B,A),B}function La(A,B,R,F){var L=F&&F.unsafe;L||S(A);var H=!L&&vt.find(A,B);if(!H){var re=A.FullPaths[0];B.slice(0,re.length)==re?re=B:(re.slice(-1)!="/"&&(re+="/"),re=(re+B).replace("//","/")),H={name:a(B),type:2},A.FileIndex.push(H),A.FullPaths.push(re),L||vt.utils.cfb_gc(A)}return H.content=R,H.size=R?R.length:0,F&&(F.CLSID&&(H.clsid=F.CLSID),F.mt&&(H.mt=F.mt),F.ct&&(H.ct=F.ct)),H}function hd(A,B){S(A);var R=vt.find(A,B);if(R){for(var F=0;F<A.FileIndex.length;++F)if(A.FileIndex[F]==R)return A.FileIndex.splice(F,1),A.FullPaths.splice(F,1),!0}return!1}function md(A,B,R){S(A);var F=vt.find(A,B);if(F){for(var L=0;L<A.FileIndex.length;++L)if(A.FileIndex[L]==F)return A.FileIndex[L].name=a(R),A.FullPaths[L]=R,!0}return!1}function pl(A){P(A,!0)}return t.find=T,t.read=E,t.parse=u,t.write=Y,t.writeFile=Z,t.utils={cfb_new:sa,cfb_add:La,cfb_del:hd,cfb_mov:md,cfb_gc:pl,ReadShift:go,CheckField:YE,prep_blob:Lr,bconcat:Yt,use_zlib:de,_deflateRaw:tt,_inflateRaw:Ge,consts:V},t})(),fW;function gb(e){return typeof e=="string"?rd(e):Array.isArray(e)?LH(e):e}function dl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=rd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([gb(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+MH(new Uint8Array(gb(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Ii(t)),c.write(t),c.close(),t}catch(d){if(!d.message||d.message.indexOf("onstruct")==-1)throw d}throw new Error("cannot save file "+e)}function qt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function vb(e,t){for(var r=[],n=qt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function ex(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function id(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function hW(e){for(var t=[],r=qt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var OE=Date.UTC(1899,11,30,0,0,0),mW=Date.UTC(1899,11,31,0,0,0),pW=Date.UTC(1904,0,1,0,0,0);function yr(e,t){var r=e.getTime(),n=(r-OE)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function ls(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+OE),t}var xW=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,gW=/^(\d+)-(\d+)-(\d+)$/,DE=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function rn(e,t){if(e instanceof Date)return e;var r=e.match(xW);if(r)return new Date((t?pW:mW)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(gW),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(DE),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function tx(e,t){if(lt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function Rr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Rr(e[r]));return t}function jt(e,t){for(var r="";r.length<t;)r+=e;return r}function ba(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var vW=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,yW=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,bW=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,wW=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function NW(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function _W(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var SW=["january","february","march","april","may","june","july","august","september","october","november","december"];function tu(e){if(bW.test(e))return e.indexOf("Z")==-1?sd(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(vW);if(n)return NW(n);if(n=r.match(yW),n)return _W(n);if(n=r.match(DE),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(wW&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear();a.getMonth();var l=a.getDate();if(isNaN(l))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&SW.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}function Ss(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function sd(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function Qe(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return lt?n=ia(r):n=BH(r),vt.utils.cfb_add(e,t,n)}vt.utils.cfb_add(e,t,r)}else e.file(t,r)}function rx(){return vt.utils.cfb_new()}var Qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,EW={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},nx=ex(EW),ax=/[&<>'"]/g,TW=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function et(e){var t=e+"";return t.replace(ax,function(r){return nx[r]}).replace(TW,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function yb(e){return et(e).replace(/ /g,"_x0020_")}var RE=/[\u0000-\u001f]/g;function hf(e){var t=e+"";return t.replace(ax,function(r){return nx[r]}).replace(/\n/g,"<br/>").replace(RE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function CW(e){var t=e+"";return t.replace(ax,function(r){return nx[r]}).replace(RE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function jW(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function AW(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function mf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function bb(e){var t=Ri(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function wb(e){return ia(e,"binary").toString("utf8")}var zl="foo bar bazâð£",cs=lt&&(wb(zl)==mf(zl)&&wb||bb(zl)==mf(zl)&&bb)||mf,Mo=lt?function(e){return ia(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},kW=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),IE=/(^\s|\s$|\n)/;function pr(e,t){return"<"+e+(t.match(IE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lo(e){return qt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Te(e,t,r){return"<"+e+(r!=null?Lo(r):"")+(t!=null?(t.match(IE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ph(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function PW(e,t){switch(typeof e){case"string":var r=Te("vt:lpwstr",et(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",et(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",Ph(e));throw new Error("Unable to serialize "+e)}var lr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ls=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function OW(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function DW(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var Nb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},_b=lt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ia(t)})):Nb(e)}:Nb,Sb=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(fo(e,a)));return n.join("").replace(xo,"")},ix=lt?function(e,t,r){return!Buffer.isBuffer(e)||!qc?Sb(e,t,r):e.toString("utf16le",t,r).replace(xo,"")}:Sb,Eb=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},FE=lt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Eb(e,t,r)}:Eb,Tb=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ns(e,a)));return n.join("")},fl=lt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Tb(t,r,n)}:Tb,ME=function(e,t){var r=fn(e,t);return r>0?fl(e,t+4,t+4+r-1):""},LE=ME,BE=function(e,t){var r=fn(e,t);return r>0?fl(e,t+4,t+4+r-1):""},$E=BE,UE=function(e,t){var r=2*fn(e,t);return r>0?fl(e,t+4,t+4+r-1):""},HE=UE,WE=function(t,r){var n=fn(t,r);return n>0?ix(t,r+4,r+4+n):""},KE=WE,zE=function(e,t){var r=fn(e,t);return r>0?fl(e,t+4,t+4+r):""},VE=zE,GE=function(e,t){return OW(e,t)},ru=GE,sx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};lt&&(LE=function(t,r){if(!Buffer.isBuffer(t))return ME(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$E=function(t,r){if(!Buffer.isBuffer(t))return BE(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},HE=function(t,r){if(!Buffer.isBuffer(t)||!qc)return UE(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},KE=function(t,r){if(!Buffer.isBuffer(t)||!qc)return WE(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},VE=function(t,r){if(!Buffer.isBuffer(t))return zE(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ru=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):GE(t,r)},sx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ns=function(e,t){return e[t]},fo=function(e,t){return e[t+1]*256+e[t]},RW=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},IW=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function go(e,t){var r="",n,a,i=[],s,l,c,d;switch(t){case"dbcs":if(d=this.l,lt&&Buffer.isBuffer(this)&&qc)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(fo(this,d)),d+=2;e*=2;break;case"utf8":r=fl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ix(this,this.l,this.l+e);break;case"wstr":return go.call(this,e,"dbcs");case"lpstr-ansi":r=LE(this,this.l),e=4+fn(this,this.l);break;case"lpstr-cp":r=$E(this,this.l),e=4+fn(this,this.l);break;case"lpwstr":r=HE(this,this.l),e=4+2*fn(this,this.l);break;case"lpp4":e=4+fn(this,this.l),r=KE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fn(this,this.l),r=VE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=ns(this,this.l+e++))!==0;)i.push(Wl(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=fo(this,this.l+e))!==0;)i.push(Wl(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return s=ns(this,d),this.l=d+1,l=go.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Wl(fo(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return s=ns(this,d),this.l=d+1,l=go.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Wl(ns(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=ns(this,this.l),this.l++,n;case 2:return n=(t==="i"?RW:fo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?xi:IW)(this,this.l),this.l+=4,n):(a=fn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ru(this,this.l):a=ru([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=FE(this,this.l,e);break}}return this.l+=e,r}var FW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},MW=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},LW=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function BW(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)LW(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,FW(this,t,this.l);break;case 8:if(n=8,r==="f"){DW(this,t,this.l);break}case 16:break;case-4:n=4,MW(this,t,this.l);break}return this.l+=n,this}function YE(e,t){var r=FE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Lr(e,t){e.l=t,e.read_shift=go,e.chk=YE,e.write_shift=BW}function aa(e,t){e.l+=t}function te(e){var t=Ri(e);return Lr(t,0),t}function Pr(){var e=[],t=lt?16384:2048;lt&&te(t).copy;var r=function(u){var f=te(u);return Lr(f,0),f},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),Yt(e)},l=function(){return a(),e},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e,end2:l}}function ye(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=VX[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&sx(r)&&e.push(r)}}function vo(e,t,r){var n=Rr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Cb(e,t,r){var n=Rr(e);return n.s=vo(n.s,t.s,r),n.e=vo(n.e,t.s,r),n}function yo(e,t){if(e.cRel&&e.c<0)for(e=Rr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Rr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Mt(e);return!e.cRel&&e.cRel!=null&&(r=HW(r)),!e.rRel&&e.rRel!=null&&(r=$W(r)),r}function pf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+pt(e.s.c)+":"+(e.e.cRel?"":"$")+pt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gt(e.s.r)+":"+(e.e.rRel?"":"$")+gt(e.e.r):yo(e.s,t.biff)+":"+yo(e.e,t.biff)}function ox(e){return parseInt(UW(e),10)-1}function gt(e){return""+(e+1)}function $W(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function UW(e){return e.replace(/\$(\d+)$/,"$1")}function lx(e){for(var t=WW(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function pt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function HW(e){return e.replace(/^([A-Z])/,"$$$1")}function WW(e){return e.replace(/^\$([A-Z])/,"$1")}function KW(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Mt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gr(e){var t=e.indexOf(":");return t==-1?{s:kt(e),e:kt(e)}:{s:kt(e.slice(0,t)),e:kt(e.slice(t+1))}}function Zt(e,t){return typeof t>"u"||typeof t=="number"?Zt(e.s,e.e):(typeof e!="string"&&(e=Mt(e)),typeof t!="string"&&(t=Mt(t)),e==t?e:e+":"+t)}function Bo(e){var t=gr(e);return"$"+pt(t.s.c)+"$"+gt(t.s.r)+":$"+pt(t.e.c)+"$"+gt(t.e.r)}function $o(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function jb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Aa(e.z,r?yr(t):t)}catch{}try{return e.w=Aa((e.XF||{}).numFmtId||(r?14:0),r?yr(t):t)}catch{return""+t}}function ka(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Kr[e.v]||e.v:t==null?jb(e,e.v):jb(e,t))}function Bs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function zW(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function XE(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?kt(n.origin):n.origin;s=c.r,l=c.c}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Et(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),s==-1&&(d.e.r=s=i["!ref"]?u.e.r+1:0)}else d.s.c=d.e.c=d.s.r=d.e.r=0;for(var f=[],h=!1,m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");var x=s+m;a&&(i["!data"][x]||(i["!data"][x]=[]),f=i["!data"][x]);for(var g=t[m],v=0;v!=g.length;++v)if(!(typeof g[v]>"u")){var y={v:g[v],t:""},b=l+v;if(d.s.r>x&&(d.s.r=x),d.s.c>b&&(d.s.c=b),d.e.r<x&&(d.e.r=x),d.e.c<b&&(d.e.c=b),h=!0,g[v]&&typeof g[v]=="object"&&!Array.isArray(g[v])&&!(g[v]instanceof Date))y=g[v];else if(Array.isArray(y.v)&&(y.f=g[v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?isFinite(y.v)?y.t="n":isNaN(y.v)?(y.t="e",y.v=15):(y.t="e",y.v=7):typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||St[14],n.UTC||(y.v=sd(y.v)),n.cellDates?(y.t="d",y.w=Aa(y.z,yr(y.v,n.date1904))):(y.t="n",y.v=yr(y.v,n.date1904),y.w=Aa(y.z,y.v))):y.t="s";if(a)f[b]&&f[b].z&&(y.z=f[b].z),f[b]=y;else{var w=pt(b)+(x+1);i[w]&&i[w].z&&(y.z=i[w].z),i[w]=y}}}return h&&d.s.c<104e5&&(i["!ref"]=Zt(d)),i}function $s(e,t){return XE(null,e,t)}function VW(e){return e.read_shift(4,"i")}function $n(e,t){return t||(t=te(4)),t.write_shift(4,e),t}function Or(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function rr(e,t){var r=!1;return t==null&&(r=!0,t=te(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function GW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YW(e,t){return t||(t=te(4)),t.write_shift(2,0),t.write_shift(2,0),t}function cx(e,t){var r=e.l,n=e.read_shift(1),a=Or(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(GW(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function XW(e,t){var r=!1;return t==null&&(r=!0,t=te(15+4*e.t.length)),t.write_shift(1,0),rr(e.t,t),r?t.slice(0,t.l):t}var qW=cx;function ZW(e,t){var r=!1;return t==null&&(r=!0,t=te(23+4*e.t.length)),t.write_shift(1,1),rr(e.t,t),t.write_shift(4,1),YW({},t),r?t.slice(0,t.l):t}function On(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Hi(e,t){return t==null&&(t=te(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Wi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ki(e,t){return t==null&&(t=te(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var JW=Or,qE=rr;function od(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Uo(e,t){var r=!1;return t==null&&(r=!0,t=te(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var QW=Or,Oh=od,ux=Uo;function dx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ru([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):xi(t,0)>>2;return r?a/100:a}function ZE(e,t){t==null&&(t=te(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function JE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function eK(e,t){return t||(t=te(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var zi=JE,Us=eK;function Hs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mi(e,t){return(t||te(8)).write_shift(8,e,"f")}function tK(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=uK[a];d&&(t.rgb=$b(d));break;case 2:t.rgb=$b([s,l,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function nu(e,t){if(t||(t=te(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function rK(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function nK(e,t){t||(t=te(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var QE=2,sn=3,Vl=11,au=19,Gl=64,aK=65,iK=71,sK=4108,oK=4126,hr=80,Ab={1:{n:"CodePage",t:QE},2:{n:"Category",t:hr},3:{n:"PresentationFormat",t:hr},4:{n:"ByteCount",t:sn},5:{n:"LineCount",t:sn},6:{n:"ParagraphCount",t:sn},7:{n:"SlideCount",t:sn},8:{n:"NoteCount",t:sn},9:{n:"HiddenCount",t:sn},10:{n:"MultimediaClipCount",t:sn},11:{n:"ScaleCrop",t:Vl},12:{n:"HeadingPairs",t:sK},13:{n:"TitlesOfParts",t:oK},14:{n:"Manager",t:hr},15:{n:"Company",t:hr},16:{n:"LinksUpToDate",t:Vl},17:{n:"CharacterCount",t:sn},19:{n:"SharedDoc",t:Vl},22:{n:"HyperlinksChanged",t:Vl},23:{n:"AppVersion",t:sn,p:"version"},24:{n:"DigSig",t:aK},26:{n:"ContentType",t:hr},27:{n:"ContentStatus",t:hr},28:{n:"Language",t:hr},29:{n:"Version",t:hr},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}},kb={1:{n:"CodePage",t:QE},2:{n:"Title",t:hr},3:{n:"Subject",t:hr},4:{n:"Author",t:hr},5:{n:"Keywords",t:hr},6:{n:"Comments",t:hr},7:{n:"Template",t:hr},8:{n:"LastAuthor",t:hr},9:{n:"RevNumber",t:hr},10:{n:"EditTime",t:Gl},11:{n:"LastPrinted",t:Gl},12:{n:"CreatedDate",t:Gl},13:{n:"ModifiedDate",t:Gl},14:{n:"PageCount",t:sn},15:{n:"WordCount",t:sn},16:{n:"CharCount",t:sn},17:{n:"Thumbnail",t:iK},18:{n:"Application",t:hr},19:{n:"DocSecurity",t:sn},255:{},2147483648:{n:"Locale",t:au},2147483651:{n:"Behavior",t:au},1919054434:{}};function lK(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var cK=lK([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),uK=Rr(cK),Kr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Zn={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},dK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],fK={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Yl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function eT(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function tT(e,t,r){var n=hW(fK),a=[],i;a[a.length]=Qt,a[a.length]=Te("Types",null,{xmlns:lr.CT,"xmlns:xsd":lr.xsd,"xmlns:xsi":lr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Te("Default",null,{Extension:d[0],ContentType:d[1]})}));var s=function(d){e[d]&&e[d].length>0&&(i=e[d][0],a[a.length]=Te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Yl[d][t.bookType]||Yl[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(u){a[a.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Yl[d][t.bookType]||Yl[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(u){a[a.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[d][0]})})};return s("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rT(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function us(e){var t=[Qt,Te("Relationships",null,{xmlns:lr.RELS})];return qt(e["!id"]).forEach(function(r){t[t.length]=Te("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ot(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function hK(e){var t=[Qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Pb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function mK(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function pK(e){var t=[Qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Pb(e[r][0],e[r][1])),t.push(mK("",e[r][0]));return t.push(Pb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function nT(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Yc.version+"</meta:generator></office:meta></office:document-meta>"}var Si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function xf(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=et(t),n[n.length]=r?Te(e,t,r):pr(e,t))}function aT(e,t){var r=t||{},n=[Qt,Te("cp:coreProperties",null,{"xmlns:cp":lr.CORE_PROPS,"xmlns:dc":lr.dc,"xmlns:dcterms":lr.dcterms,"xmlns:dcmitype":lr.dcmitype,"xmlns:xsi":lr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&xf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ph(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&xf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ph(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Si.length;++i){var s=Si[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&xf(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ds=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],iT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function sT(e){var t=[],r=Te;return e||(e={}),e.Application="SheetJS",t[t.length]=Qt,t[t.length]=Te("Properties",null,{xmlns:lr.EXT_PROPS,"xmlns:vt":lr.vt}),ds.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=et(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+et(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function oT(e){var t=[Qt,Te("Properties",null,{xmlns:lr.CUST_PROPS,"xmlns:vt":lr.vt})];if(!e)return t.join("");var r=1;return qt(e).forEach(function(a){++r,t[t.length]=Te("property",PW(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:et(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ob={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function xK(e,t){var r=[];return qt(Ob).map(function(n){for(var a=0;a<Si.length;++a)if(Si[a][1]==n)return Si[a];for(a=0;a<ds.length;++a)if(ds[a][1]==n)return ds[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(pr(Ob[n[1]]||n[1],a))}}),Te("DocumentProperties",r.join(""),{xmlns:dn.o})}function gK(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&qt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Si.length;++s)if(i==Si[s][1])return;for(s=0;s<ds.length;++s)if(i==ds[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Te(yb(i),l,{"dt:dt":c}))}}),t&&qt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Te(yb(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+dn.o+'">'+a.join("")+"</"+n+">"}function vK(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=te(8);return s.write_shift(4,n),s.write_shift(4,a),s}function Db(e,t){var r=te(4),n=te(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=te(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=vK(t);break;case 31:case 80:for(n=te(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Yt([r,n])}var lT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function yK(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Rb(e,t,r){var n=te(8),a=[],i=[],s=8,l=0,c=te(8),d=te(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),a.push(d),s+=8+c.length,!t){d=te(8),d.write_shift(4,0),a.unshift(d);var u=[te(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=te(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Yt(u),i.unshift(c),s+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(lT.indexOf(e[l][0])>-1||iT.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=Db(x.t,h)}else{var v=yK(h);v==-1&&(v=31,h=String(h)),c=Db(v,h)}i.push(c),d=te(8),d.write_shift(4,t?m:2+l),a.push(d),s+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,y),y+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),Yt([n].concat(a).concat(i))}function Ib(e,t,r,n,a,i){var s=te(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,vt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=Rb(e,r,n);if(l.push(c),a){var d=Rb(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),l.push(d)}return Yt(l)}function bK(e,t){t||(t=te(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function wK(e,t){return e.read_shift(t)===1}function Cr(e,t){return t||(t=te(2)),t.write_shift(2,+!!e),t}function nc(e){return e.read_shift(2,"u")}function Sn(e,t){return t||(t=te(2)),t.write_shift(2,e),t}function cT(e,t,r){return r||(r=te(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function uT(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=fa;if(r&&r.biff>=8&&(fa=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return fa=i,l}function NK(e){var t=e.t||"",r=te(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=te(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Yt(a)}function _K(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function SK(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):_K(e,n,r)}function EK(e,t,r){if(r.biff>5)return SK(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function dT(e,t,r){return r||(r=te(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Fb(e,t){t||(t=te(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function TK(e){var t=te(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Fb(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Fb(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Li(e,t,r,n){return n||(n=te(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function CK(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function jK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function fT(e,t){return t||(t=te(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function fx(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=te(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function AK(e,t){var r=!t||t.biff==8,n=te(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function kK(e,t){var r=!t||t.biff>=8?2:1,n=te(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function PK(e,t){var r=te(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=NK(e[a]);var i=Yt([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function OK(){var e=te(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function DK(e){var t=te(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function RK(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=te(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function IK(e,t,r,n){var a=te(10);return Li(e,t,n,a),a.write_shift(4,r),a}function FK(e,t,r,n,a){var i=!a||a.biff==8,s=te(8+ +i+(1+i)*r.length);return Li(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function MK(e,t,r,n){var a=r&&r.biff==5;n||(n=te(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function LK(e){var t=te(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function BK(e){var t=te(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function $K(e,t){var r=t.biff==8||!t.biff?4:2,n=te(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Mb(e,t,r,n){var a=r&&r.biff==5;n||(n=te(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function UK(e){var t=te(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function hT(e){var t=te(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var HK=hT;function WK(e){var t=te(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function gf(e,t,r,n,a,i){var s=te(8);return Li(e,t,n,s),cT(r,i,s),s}function KK(e,t,r,n){var a=te(14);return Li(e,t,n,a),Mi(r,a),a}function zK(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return Lb(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(CK(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Lb(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=uT(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function vf(e,t,r,n){var a=te(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function VK(e){var t=te(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)fT(e[r],t);return t}function GK(e){var t=te(24),r=kt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Yt([t,TK(e[1])])}function YK(e){var t=e[1].Tooltip,r=te(10+2*(t.length+1));r.write_shift(2,2048);var n=kt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function XK(e){return e||(e=te(4)),e.write_shift(2,1),e.write_shift(2,1),e}function qK(e,t,r){if(!r.cellStyles)return aa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:s,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function ZK(e,t){var r=te(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function JK(e){for(var t=te(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function hl(e,t,r,n,a){return e||(e=te(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function QK(e,t,r,n,a){var i=te(15);return hl(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function ez(e,t,r,n,a){var i=te(9);return hl(i,e,t,n||0,a||0),i.write_shift(2,r),i}var tz=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ex({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Ri(1);switch(c.type){case"base64":u=un(Qa(l));break;case"binary":u=un(l);break;case"buffer":case"array":u=l;break}Lr(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,v=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(v=u.read_shift(2));var y=u.read_shift(2);c.codepage,f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&e[u[u.l]],u.l+=1,u.l+=2),x&&(u.l+=36);for(var b=[],w={},N=Math.min(u.length,f==2?521:v-10-(m?264:0)),_=x?32:11;u.l<N&&u[u.l]!=13;)switch(w={},w.name=Ii(u.slice(u.l,u.l+_)).replace(/[\u0000\r\n][\S\s]*$/g,""),u.l+=_,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&b.push(w),f!=2&&(u.l+=x?13:14),w.type){case"B":(!m||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var E=0,S=0;for(d[0]=[],S=0;S!=b.length;++S)d[0][S]=b[S].name;for(;g-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++E]=[],S=0,S=0;S!=b.length;++S){var j=u.slice(u.l,u.l+b[S].len);u.l+=b[S].len,Lr(j,0);var P=Ii(j);switch(b[S].type){case"C":P.trim().length&&(d[E][S]=P.replace(/([^\s])\s+$/,"$1"));break;case"D":P.length===8?(d[E][S]=new Date(Date.UTC(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8),0,0,0,0)),c&&c.UTC||(d[E][S]=Ss(d[E][S]))):d[E][S]=P;break;case"F":d[E][S]=parseFloat(P.trim());break;case"+":case"I":d[E][S]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":d[E][S]=!0;break;case"N":case"F":d[E][S]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[E][S]="##MEMO##"+(x?parseInt(P.trim(),10):j.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(d[E][S]=+P||0);break;case"@":d[E][S]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":{var C=j.read_shift(4),T=j.read_shift(4);if(C==0&&T==0)break;d[E][S]=new Date((C-2440588)*864e5+T),c&&c.UTC||(d[E][S]=Ss(d[E][S]))}break;case"Y":d[E][S]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][S]=-j.read_shift(-8,"f");break;case"B":if(m&&b[S].len==8){d[E][S]=j.read_shift(8,"f");break}case"G":case"P":j.l+=b[S].len;break;case"0":if(b[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=b,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=$s(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function a(l,c){try{var d=Bs(n(l,c),c);return d.bookType="dbf",d}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var d=c||{},u=fa;if(+d.codepage>=0&&Fo(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=Pr(),h=Fh(l,{header:1,raw:!0,cellDates:!0}),m=h[0],x=h.slice(1),g=l["!cols"]||[],v=0,y=0,b=0,w=1;for(v=0;v<m.length;++v){if(((g[v]||{}).DBF||{}).name){m[v]=g[v].DBF.name,++b;continue}if(m[v]!=null){if(++b,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(y=0;y<1024;++y)if(m.indexOf(m[v]+"_"+y)==-1){m[v]+="_"+y;break}}}}var N=Et(l["!ref"]),_=[],E=[],S=[];for(v=0;v<=N.e.c-N.s.c;++v){var j="",P="",C=0,T=[];for(y=0;y<x.length;++y)x[y][v]!=null&&T.push(x[y][v]);if(T.length==0||m[v]==null){_[v]="?";continue}for(y=0;y<T.length;++y){switch(typeof T[y]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=T[y]instanceof Date?"D":"C";break;default:P="C"}C=Math.max(C,String(T[y]).length),j=j&&j!=P?"C":P}C>250&&(C=250),P=((g[v]||{}).DBF||{}).type,P=="C"&&g[v].DBF.len>C&&(C=g[v].DBF.len),j=="B"&&P=="N"&&(j="N",S[v]=g[v].DBF.dec,C=g[v].DBF.len),E[v]=j=="C"||P=="N"?C:i[j]||0,w+=E[v],_[v]=j}var k=f.next(32);for(k.write_shift(4,318902576),k.write_shift(4,x.length),k.write_shift(2,296+32*b),k.write_shift(2,w),v=0;v<4;++v)k.write_shift(4,0);var W=+t[fa]||3;for(k.write_shift(4,0|W<<8),e[W]!=+d.codepage&&(d.codepage&&console.error("DBF Unsupported codepage "+fa+", using 1252"),fa=1252),v=0,y=0;v<m.length;++v)if(m[v]!=null){var G=f.next(32),K=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,K,"sbcs"),G.write_shift(1,_[v]=="?"?"C":_[v],"sbcs"),G.write_shift(4,y),G.write_shift(1,E[v]||i[_[v]]||0),G.write_shift(1,S[v]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),y+=E[v]||i[_[v]]||0}var J=f.next(264);for(J.write_shift(4,13),v=0;v<65;++v)J.write_shift(4,0);for(v=0;v<x.length;++v){var V=f.next(w);for(V.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(_[y]){case"L":V.write_shift(1,x[v][y]==null?63:x[v][y]?84:70);break;case"B":V.write_shift(8,x[v][y]||0,"f");break;case"N":var Z="0";for(typeof x[v][y]=="number"&&(Z=x[v][y].toFixed(S[y]||0)),Z.length>E[y]&&(Z=Z.slice(0,E[y])),b=0;b<E[y]-Z.length;++b)V.write_shift(1,32);V.write_shift(1,Z,"sbcs");break;case"D":x[v][y]?(V.write_shift(4,("0000"+x[v][y].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(x[v][y].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+x[v][y].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var Q=V.l,Y=String(x[v][y]!=null?x[v][y]:"").slice(0,E[y]);for(V.write_shift(1,Y,"cpstr"),Q+=E[y]-V.l,b=0;b<Q;++b)V.write_shift(1,32);break}}return fa=u,f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),rz=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+qt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+qt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(m,x){var g=e[x];return typeof g=="number"?ob(g):g},n=function(m,x,g){var v=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?m:ob(v)};e["|"]=254;var a=function(m){return m.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(m,x){switch(x.type){case"base64":return s(Qa(m),x);case"binary":return s(m,x);case"buffer":return s(lt&&Buffer.isBuffer(m)?m.toString("binary"):Ii(m),x);case"array":return s(tx(m),x)}throw new Error("Unrecognized type "+x.type)}function s(m,x){var g=m.split(/[\n\r]+/),v=-1,y=-1,b=0,w=0,N=[],_=[],E=null,S={},j=[],P=[],C=[],T=0,k,W={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&Fo(+x.codepage);b!==g.length;++b){T=0;var G=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=G.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),J=K[0],V;if(G.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"V":{var Z=parseInt(K[w].slice(1),10);Z>=1&&Z<=4&&(W.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(K[1].charAt(0)){case"P":_.push(G.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Q={Sheet:0};for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"N":Q.Name=K[w].slice(1);break;case"E":Q.Ref=(x&&x.sheet||"Sheet1")+"!"+Wb(K[w].slice(1));break}W.Workbook.Names.push(Q)}break;case"C":var Y=!1,le=!1,de=!1,pe=!1,_e=-1,q=-1,oe="",ve="z",O="";for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"A":O=K[w].slice(1);break;case"X":y=parseInt(K[w].slice(1),10)-1,le=!0;break;case"Y":for(v=parseInt(K[w].slice(1),10)-1,le||(y=0),k=N.length;k<=v;++k)N[k]=[];break;case"K":V=K[w].slice(1),V.charAt(0)==='"'?(V=V.slice(1,V.length-1),ve="s"):V==="TRUE"||V==="FALSE"?(V=V==="TRUE",ve="b"):V.charAt(0)=="#"&&Zn[V]!=null?(ve="e",V=Zn[V]):isNaN(ba(V))||(V=ba(V),ve="n",E!==null&&Fi(E)&&x.cellDates&&(V=ls(W.Workbook.WBProps.date1904?V+1462:V),ve=typeof V=="number"?"n":"d")),Y=!0;break;case"E":pe=!0,oe=Wb(K[w].slice(1),{r:v,c:y});break;case"S":de=!0;break;case"G":break;case"R":_e=parseInt(K[w].slice(1),10)-1;break;case"C":q=parseInt(K[w].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}if(Y&&(N[v][y]?(N[v][y].t=ve,N[v][y].v=V):N[v][y]={t:ve,v:V},E&&(N[v][y].z=E),x.cellText!==!1&&E&&(N[v][y].w=Aa(N[v][y].z,N[v][y].v,{date1904:W.Workbook.WBProps.date1904})),E=null),de){if(pe)throw new Error("SYLK shared formula cannot have own formula");var D=_e>-1&&N[_e][q];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");oe=nV(D[1],{r:v-_e,c:y-q})}oe&&(N[v][y]?N[v][y].f=oe:N[v][y]={t:"n",f:oe}),O&&(N[v][y]||(N[v][y]={t:"z"}),N[v][y].c=[{a:"SheetJSYLK",t:O}]);break;case"F":var M=0;for(w=1;w<K.length;++w)switch(K[w].charAt(0)){case"X":y=parseInt(K[w].slice(1),10)-1,++M;break;case"Y":for(v=parseInt(K[w].slice(1),10)-1,k=N.length;k<=v;++k)N[k]=[];break;case"M":T=parseInt(K[w].slice(1),10)/20;break;case"F":break;case"G":break;case"P":E=_[parseInt(K[w].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(C=K[w].slice(1).split(" "),k=parseInt(C[0],10);k<=parseInt(C[1],10);++k)T=parseInt(C[2],10),P[k-1]=T===0?{hidden:!0}:{wch:T};break;case"C":y=parseInt(K[w].slice(1),10)-1,P[y]||(P[y]={});break;case"R":v=parseInt(K[w].slice(1),10)-1,j[v]||(j[v]={}),T>0?(j[v].hpt=T,j[v].hpx=gT(T)):T===0&&(j[v].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}M<1&&(E=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}}return j.length>0&&(S["!rows"]=j),P.length>0&&(S["!cols"]=P),P.forEach(function(I){hx(I)}),x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),[N,S,W]}function l(m,x){var g=i(m,x),v=g[0],y=g[1],b=g[2],w=Rr(x);w.date1904=(((b||{}).Workbook||{}).WBProps||{}).date1904;var N=$s(v,w);qt(y).forEach(function(E){N[E]=y[E]});var _=Bs(N,x);return qt(b).forEach(function(E){_[E]=b[E]}),_.bookType="sylk",_}function c(m,x,g,v,y,b){var w="C;Y"+(g+1)+";X"+(v+1)+";K";switch(m.t){case"n":w+=isFinite(m.v)?m.v||0:Kr[isNaN(m.v)?36:7],m.f&&!m.F&&(w+=";E"+cd(m.f,{r:g,c:v}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||Kr[m.v]||m.v;break;case"d":w+=yr(rn(m.v,b),b);break;case"s":w+='"'+(m.v==null?"":String(m.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(m,x,g){var v="C;Y"+(x+1)+";X"+(g+1)+";A";return v+=a(m.map(function(y){return y.t}).join("")),v}function u(m,x){x.forEach(function(g,v){var y="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?y+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=iu(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=su(g.wpx)),typeof g.wch=="number"&&(y+=Math.round(g.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function f(m,x){x.forEach(function(g,v){var y="F;";g.hidden?y+="M0;":g.hpt?y+="M"+20*g.hpt+";":g.hpx&&(y+="M"+20*ou(g.hpx)+";"),y.length>2&&m.push(y+"R"+(v+1))})}function h(m,x,g){x||(x={}),x._formats=["General"];var v=["ID;PSheetJS;N;E"],y=[],b=Et(m["!ref"]||"A1"),w,N=m["!data"]!=null,_=`\r
`,E=(((g||{}).Workbook||{}).WBProps||{}).date1904,S="General";v.push("P;PGeneral");var j=b.s.r,P=b.s.c,C=[];if(m["!ref"]){for(j=b.s.r;j<=b.e.r;++j)if(!(N&&!m["!data"][j])){for(C=[],P=b.s.c;P<=b.e.c;++P)w=N?m["!data"][j][P]:m[pt(P)+gt(j)],!(!w||!w.c)&&C.push(d(w.c,j,P));C.length&&y.push(C.join(_))}}if(m["!ref"]){for(j=b.s.r;j<=b.e.r;++j)if(!(N&&!m["!data"][j])){for(C=[],P=b.s.c;P<=b.e.c;++P)if(w=N?m["!data"][j][P]:m[pt(P)+gt(j)],!(!w||w.v==null&&(!w.f||w.F))){if((w.z||(w.t=="d"?St[14]:"General"))!=S){var T=x._formats.indexOf(w.z);T==-1&&(x._formats.push(w.z),T=x._formats.length-1,v.push("P;P"+w.z.replace(/;/g,";;"))),C.push("F;P"+T+";Y"+(j+1)+";X"+(P+1))}C.push(c(w,m,j,P,x,E))}y.push(C.join(_))}}return v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&f(v,m["!rows"]),m["!ref"]&&v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" ")),v.push("O;L;D;B"+(E?";V4":"")+";K47;G100 0.001"),delete x._formats,v.join(_)+_+y.join(_)+_+"E"+_}return{to_workbook:l,from_sheet:h}})(),nz=(function(){function e(l,c){switch(c.type){case"base64":return t(Qa(l),c);case"binary":return t(l,c);case"buffer":return t(lt&&Buffer.isBuffer(l)?l.toString("binary"):Ii(l),c);case"array":return t(tx(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var d=l.split(`
`),u=-1,f=-1,h=0,m=[];h!==d.length;++h){if(d[h].trim()==="BOT"){m[++u]=[],f=0;continue}if(!(u<0)){var x=d[h].trim().split(","),g=x[0],v=x[1];++h;for(var y=d[h]||"";(y.match(/["]/g)||[]).length&1&&h<d.length-1;)y+=`
`+d[++h];switch(y=y.trim(),+g){case-1:if(y==="BOT"){m[++u]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?m[u][f]=!0:y==="FALSE"?m[u][f]=!1:isNaN(ba(v))?isNaN(tu(v).getDate())?m[u][f]=v:(m[u][f]=rn(v),c&&c.UTC||(m[u][f]=Ss(m[u][f]))):m[u][f]=ba(v),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),m[u][f++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(m=m.slice(0,c.sheetRows)),m}function r(l,c){return $s(e(l,c),c)}function n(l,c){var d=Bs(r(l,c),c);return d.bookType="dif",d}function a(l,c){return"0,"+String(l)+`\r
`+c}function i(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function s(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var c=Et(l["!ref"]),d=l["!data"]!=null,u=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],f=c.s.r;f<=c.e.r;++f){for(var h=d?l["!data"][f]:[],m=`-1,0\r
BOT\r
`,x=c.s.c;x<=c.e.c;++x){var g=d?h&&h[x]:l[Mt({r:f,c:x})];if(g==null){m+=`1,0\r
""\r
`;continue}switch(g.t){case"n":g.w!=null?m+="0,"+g.w+`\r
V`:g.v!=null?m+=a(g.v,"V"):g.f!=null&&!g.F?m+=i("="+g.f):m+=`1,0\r
""`;break;case"b":m+=g.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":m+=i(isNaN(+g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Aa(g.z||St[14],yr(rn(g.v)))),m+=a(g.w,"V");break;default:m+=`1,0\r
""`}m+=`\r
`}u.push(m)}return u.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),mT=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,g=-1,v=0,y=[];v!==m.length;++v){var b=m[v].trim().split(":");if(b[0]==="cell"){var w=kt(b[1]);if(y.length<=w.r)for(x=y.length;x<=w.r;++x)y[x]||(y[x]=[]);switch(x=w.r,g=w.c,b[2]){case"t":y[x][g]=e(b[3]);break;case"v":y[x][g]=+b[3];break;case"vtf":var N=b[b.length-1];case"vtc":switch(b[3]){case"nl":y[x][g]=!!+b[4];break;default:y[x][g]=b[b.length-1].charAt(0)=="#"?{t:"e",v:Zn[b[b.length-1]]}:+b[4];break}b[2]=="vtf"&&(y[x][g]=[y[x][g],N])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return $s(r(f,h),h)}function a(f,h){return Bs(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,g="",v=gr(f["!ref"]),y=f["!data"]!=null,b=v.s.r;b<=v.e.r;++b)for(var w=v.s.c;w<=v.e.c;++w)if(g=Mt({r:b,c:w}),x=y?(f["!data"][b]||[])[w]:f[g],!(!x||x.v==null||x.t==="z")){switch(m=["cell",g,"t"],x.t){case"s":m.push(t(x.v));break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=yr(rn(x.v));m[2]="vtc",m[3]="nd",m[4]=""+N,m[5]=x.w||Aa(x.z||St[14],N);break;case"n":isFinite(x.v)?x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v):(m[2]="vt"+(x.f?"f":"c"),m[3]="e"+Kr[isNaN(x.v)?36:7],m[4]="0",m[5]=x.f||m[3].slice(1),m[6]="e",m[7]=m[3].slice(1));break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,s,l,s,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}})(),az=(function(){function e(u,f,h,m,x){x.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(ba(u))?isNaN(tu(u).getDate())?u.charCodeAt(0)==35&&Zn[u]!=null?f[h][m]={t:"e",v:Zn[u],w:u}:f[h][m]=u:f[h][m]=rn(u):f[h][m]=ba(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var v=10,y=0,b=0;b<=g;++b)y=x[b].indexOf(" "),y==-1?y=x[b].length:y++,v=Math.max(v,y);for(b=0;b<=g;++b){m[b]=[];var w=0;for(e(x[b].slice(0,v).trim(),m,b,w,h),w=1;w<=(x[b].length-v)/10+1;++w)e(x[b].slice(v+(w-1)*10,v+w*10).trim(),m,b,w,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},h=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},m="",x={};h.dense&&(x["!data"]=[]);var g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=a(u.slice(0,1024)):h&&h.FS?m=h.FS:m=a(u.slice(0,1024));var v=0,y=0,b=0,w=0,N=0,_=m.charCodeAt(0),E=!1,S=0,j=u.charCodeAt(0),P=h.dateNF!=null?lW(h.dateNF):null;function C(){var T=u.slice(w,N);T.slice(-1)=="\r"&&(T=T.slice(0,-1));var k={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(k.w=T),T.length===0)k.t="z";else if(h.raw)k.t="s",k.v=T;else if(T.trim().length===0)k.t="s",k.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(k.t="s",k.v=T.slice(2,-1).replace(/""/g,'"')):aV(T)?(k.t="s",k.f=T.slice(1),k.v=T):(k.t="s",k.v=T);else if(T=="TRUE")k.t="b",k.v=!0;else if(T=="FALSE")k.t="b",k.v=!1;else if(!isNaN(b=ba(T)))k.t="n",k.v=b;else if(!isNaN((b=tu(T)).getDate())||P&&T.match(P)){if(k.z=h.dateNF||St[14],P&&T.match(P)){var W=cW(T,h.dateNF,T.match(P)||[]);b=rn(W),h&&h.UTC===!1&&(b=Ss(b))}else h&&h.UTC===!1?b=Ss(b):h.cellText!==!1&&h.dateNF&&(k.w=Aa(k.z,b));h.cellDates?(k.t="d",k.v=b):(k.t="n",k.v=yr(b)),h.cellNF||delete k.z}else T.charCodeAt(0)==35&&Zn[T]!=null?(k.t="e",k.w=T,k.v=Zn[T]):(k.t="s",k.v=T);if(k.t=="z"||(h.dense?(x["!data"][v]||(x["!data"][v]=[]),x["!data"][v][y]=k):x[Mt({c:y,r:v})]=k),w=N+1,j=u.charCodeAt(w),g.e.c<y&&(g.e.c=y),g.e.r<v&&(g.e.r=v),S==_)++y;else if(y=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;N<u.length;++N)switch(S=u.charCodeAt(N)){case 34:j===34&&(E=!E);break;case 13:if(E)break;u.charCodeAt(N+1)==10&&++N;case _:case 10:if(!E&&C())break e;break}return N-w>0&&C(),x["!ref"]=Zt(g),x}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):$s(t(u,f),f)}function l(u,f){var h="",m=f.type=="string"?[0,0,0,0]:Pq(u,f);switch(f.type){case"base64":h=Qa(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):(f.codepage,h=lt&&Buffer.isBuffer(u)?u.toString("binary"):Ii(u));break;case"array":h=tx(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=cs(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=cs(h):f.type=="binary",h.slice(0,19)=="socialcalc:version:"?mT.to_sheet(f.type=="string"?h:cs(h),f):s(h,f)}function c(u,f){return Bs(l(u,f),f)}function d(u){var f=[];if(!u["!ref"])return"";for(var h=Et(u["!ref"]),m,x=u["!data"]!=null,g=h.s.r;g<=h.e.r;++g){for(var v=[],y=h.s.c;y<=h.e.c;++y){var b=Mt({r:g,c:y});if(m=x?(u["!data"][g]||[])[y]:u[b],!m||m.v==null){v.push("          ");continue}for(var w=(m.w||(ka(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";v.push(w+(y===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})(),Bb=(function(){function e(O,D,M){if(O){Lr(O,O.l||0);for(var I=M.Enum||pe;O.l<O.length;){var z=O.read_shift(2),se=I[z]||I[65535],ce=O.read_shift(2),Ae=O.l+ce,be=se.f&&se.f(O,ce,M);if(O.l=Ae,D(be,se,z))return}}}function t(O,D){switch(D.type){case"base64":return n(un(Qa(O)),D);case"binary":return n(un(O),D);case"buffer":case"array":return n(O,D)}throw"Unsupported type "+D.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(O,D){if(!O)return O;var M=D||{},I={},z="Sheet1",se="",ce=0,Ae={},be=[],X=[],fe=[];M.dense&&(fe=I["!data"]=[]);var Oe={s:{r:0,c:0},e:{r:0,c:0}},Me=M.sheetRows||0,me={};if(O[4]==81&&O[5]==80&&O[6]==87)return ve(O,D);if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)M.Enum=pe,e(O,function(ge,Ve,De){switch(De){case 0:M.vers=ge,ge>=4096&&(M.qpro=!0);break;case 255:M.vers=ge,M.works=!0;break;case 6:Oe=ge;break;case 204:ge&&(se=ge);break;case 222:se=ge;break;case 15:case 51:(!M.qpro&&!M.works||De==51)&&ge[1].v.charCodeAt(0)<48&&(ge[1].v=ge[1].v.slice(1)),(M.works||M.works2)&&(ge[1].v=ge[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=M.dateNF||r[(ge[2]&15)-1]||St[14],M.cellDates&&(ge[1].v=ls(ge[1].v),ge[1].t=typeof ge[1].v=="number"?"n":"d")),M.qpro&&ge[3]>ce&&(I["!ref"]=Zt(Oe),Ae[z]=I,be.push(z),I={},M.dense&&(fe=I["!data"]=[]),Oe={s:{r:0,c:0},e:{r:0,c:0}},ce=ge[3],z=se||"Sheet"+(ce+1),se="");var je=M.dense?(fe[ge[0].r]||[])[ge[0].c]:I[Mt(ge[0])];if(je){je.t=ge[1].t,je.v=ge[1].v,ge[1].z!=null&&(je.z=ge[1].z),ge[1].f!=null&&(je.f=ge[1].f),me=je;break}M.dense?(fe[ge[0].r]||(fe[ge[0].r]=[]),fe[ge[0].r][ge[0].c]=ge[1]):I[Mt(ge[0])]=ge[1],me=ge[1];break;case 21509:M.works2=!0;break;case 21506:ge==5281&&(me.z="hh:mm:ss",M.cellDates&&me.t=="n"&&(me.v=ls(me.v),me.t=typeof me.v=="number"?"n":"d"));break}},M);else if(O[2]==26||O[2]==14)M.Enum=_e,O[2]==14&&(M.qpro=!0,O.l=0),e(O,function(ge,Ve,De){switch(De){case 204:z=ge;break;case 22:ge[1].v.charCodeAt(0)<48&&(ge[1].v=ge[1].v.slice(1)),ge[1].v=ge[1].v.replace(/\x0F./g,function(je){return String.fromCharCode(je.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>ce&&(I["!ref"]=Zt(Oe),Ae[z]=I,be.push(z),I={},M.dense&&(fe=I["!data"]=[]),Oe={s:{r:0,c:0},e:{r:0,c:0}},ce=ge[3],z="Sheet"+(ce+1)),Me>0&&ge[0].r>=Me)break;M.dense?(fe[ge[0].r]||(fe[ge[0].r]=[]),fe[ge[0].r][ge[0].c]=ge[1]):I[Mt(ge[0])]=ge[1],Oe.e.c<ge[0].c&&(Oe.e.c=ge[0].c),Oe.e.r<ge[0].r&&(Oe.e.r=ge[0].r);break;case 27:ge[14e3]&&(X[ge[14e3][0]]=ge[14e3][1]);break;case 1537:X[ge[0]]=ge[1],ge[0]==ce&&(z=ge[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(I["!ref"]=Zt(Oe),Ae[se||z]=I,be.push(se||z),!X.length)return{SheetNames:be,Sheets:Ae};for(var we={},he=[],Ce=0;Ce<X.length;++Ce)Ae[be[Ce]]?(he.push(X[Ce]||be[Ce]),we[X[Ce]]=Ae[X[Ce]]||Ae[be[Ce]]):(he.push(X[Ce]),we[X[Ce]]={"!ref":"A1"});return{SheetNames:he,Sheets:we}}function a(O,D){var M=D||{};if(+M.codepage>=0&&Fo(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Pr();if(!O["!ref"])throw new Error("Cannot export empty sheet to WK1");var z=Et(O["!ref"]),se=O["!data"]!=null,ce=[];Ne(I,0,s(1030)),Ne(I,6,d(z));for(var Ae=Math.min(z.e.r,8191),be=z.s.c;be<=z.e.c;++be)ce[be]=pt(be);for(var X=z.s.r;X<=Ae;++X){var fe=gt(X);for(be=z.s.c;be<=z.e.c;++be){var Oe=se?(O["!data"][X]||[])[be]:O[ce[be]+fe];if(!(!Oe||Oe.t=="z"))switch(Oe.t){case"n":(Oe.v|0)==Oe.v&&Oe.v>=-32768&&Oe.v<=32767?Ne(I,13,v(X,be,Oe)):Ne(I,14,b(X,be,Oe));break;case"d":var Me=yr(Oe.v);(Me|0)==Me&&Me>=-32768&&Me<=32767?Ne(I,13,v(X,be,{v:Me,z:Oe.z||St[14]})):Ne(I,14,b(X,be,{v:Me,z:Oe.z||St[14]}));break;default:var me=ka(Oe);Ne(I,15,m(X,be,me.slice(0,239)))}}}return Ne(I,1),I.end()}function i(O,D){var M=D||{};if(+M.codepage>=0&&Fo(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Pr();Ne(I,0,l(O));for(var z=0,se=0;z<O.SheetNames.length;++z)(O.Sheets[O.SheetNames[z]]||{})["!ref"]&&Ne(I,27,de(O.SheetNames[z],se++));var ce=0;for(z=0;z<O.SheetNames.length;++z){var Ae=O.Sheets[O.SheetNames[z]];if(!(!Ae||!Ae["!ref"])){for(var be=Et(Ae["!ref"]),X=Ae["!data"]!=null,fe=[],Oe=Math.min(be.e.r,8191),Me=be.s.r;Me<=Oe;++Me)for(var me=gt(Me),we=be.s.c;we<=be.e.c;++we){Me===be.s.r&&(fe[we]=pt(we));var he=fe[we]+me,Ce=X?(Ae["!data"][Me]||[])[we]:Ae[he];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")Ne(I,23,W(Me,we,ce,Ce.v));else{var ge=ka(Ce);Ne(I,22,C(Me,we,ce,ge.slice(0,239)))}}++ce}}return Ne(I,1),I.end()}function s(O){var D=te(2);return D.write_shift(2,O),D}function l(O){var D=te(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var M=0,I=0,z=0,se=0;se<O.SheetNames.length;++se){var ce=O.SheetNames[se],Ae=O.Sheets[ce];if(!(!Ae||!Ae["!ref"])){++z;var be=gr(Ae["!ref"]);M<be.e.r&&(M=be.e.r),I<be.e.c&&(I=be.e.c)}}return M>8191&&(M=8191),D.write_shift(2,M),D.write_shift(1,z),D.write_shift(1,I),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function c(O,D,M){var I={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&M.qpro?(I.s.c=O.read_shift(1),O.l++,I.s.r=O.read_shift(2),I.e.c=O.read_shift(1),O.l++,I.e.r=O.read_shift(2),I):(I.s.c=O.read_shift(2),I.s.r=O.read_shift(2),D==12&&M.qpro&&(O.l+=2),I.e.c=O.read_shift(2),I.e.r=O.read_shift(2),D==12&&M.qpro&&(O.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function d(O){var D=te(8);return D.write_shift(2,O.s.c),D.write_shift(2,O.s.r),D.write_shift(2,O.e.c),D.write_shift(2,O.e.r),D}function u(O,D,M){var I=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(I[0].c=O.read_shift(1),I[3]=O.read_shift(1),I[0].r=O.read_shift(2),O.l+=2):M.works?(I[0].c=O.read_shift(2),I[0].r=O.read_shift(2),I[2]=O.read_shift(2)):(I[2]=O.read_shift(1),I[0].c=O.read_shift(2),I[0].r=O.read_shift(2)),I}function f(O){return O.z&&Fi(O.z)?240|(r.indexOf(O.z)+1||2):255}function h(O,D,M){var I=O.l+D,z=u(O,D,M);if(z[1].t="s",(M.vers&65534)==20768){O.l++;var se=O.read_shift(1);return z[1].v=O.read_shift(se,"utf8"),z}return M.qpro&&O.l++,z[1].v=O.read_shift(I-O.l,"cstr"),z}function m(O,D,M){var I=te(7+M.length);I.write_shift(1,255),I.write_shift(2,D),I.write_shift(2,O),I.write_shift(1,39);for(var z=0;z<I.length;++z){var se=M.charCodeAt(z);I.write_shift(1,se>=128?95:se)}return I.write_shift(1,0),I}function x(O,D,M){var I=O.l+D,z=u(O,D,M);if(z[1].t="s",M.vers==20768){var se=O.read_shift(1);return z[1].v=O.read_shift(se,"utf8"),z}return z[1].v=O.read_shift(I-O.l,"cstr"),z}function g(O,D,M){var I=u(O,D,M);return I[1].v=O.read_shift(2,"i"),I}function v(O,D,M){var I=te(7);return I.write_shift(1,f(M)),I.write_shift(2,D),I.write_shift(2,O),I.write_shift(2,M.v,"i"),I}function y(O,D,M){var I=u(O,D,M);return I[1].v=O.read_shift(8,"f"),I}function b(O,D,M){var I=te(13);return I.write_shift(1,f(M)),I.write_shift(2,D),I.write_shift(2,O),I.write_shift(8,M.v,"f"),I}function w(O,D,M){var I=O.l+D,z=u(O,D,M);if(z[1].v=O.read_shift(8,"f"),M.qpro)O.l=I;else{var se=O.read_shift(2);S(O.slice(O.l,O.l+se),z),O.l+=se}return z}function N(O,D,M){var I=D&32768;return D&=-32769,D=(I?O:0)+(D>=8192?D-16384:D),(I?"":"$")+(M?pt(D):gt(D))}var _={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(O,D){Lr(O,0);for(var M=[],I=0,z="",se="",ce="",Ae="";O.l<O.length;){var be=O[O.l++];switch(be){case 0:M.push(O.read_shift(8,"f"));break;case 1:se=N(D[0].c,O.read_shift(2),!0),z=N(D[0].r,O.read_shift(2),!1),M.push(se+z);break;case 2:{var X=N(D[0].c,O.read_shift(2),!0),fe=N(D[0].r,O.read_shift(2),!1);se=N(D[0].c,O.read_shift(2),!0),z=N(D[0].r,O.read_shift(2),!1),M.push(X+fe+":"+se+z)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(O.read_shift(2));break;case 6:{for(var Oe="";be=O[O.l++];)Oe+=String.fromCharCode(be);M.push('"'+Oe.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:Ae=M.pop(),ce=M.pop(),M.push(["AND","OR"][be-20]+"("+ce+","+Ae+")");break;default:if(be<32&&E[be])Ae=M.pop(),ce=M.pop(),M.push(ce+E[be]+Ae);else if(_[be]){if(I=_[be][1],I==69&&(I=O[O.l++]),I>M.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+M.join("|")+"|");return}var Me=M.slice(-I);M.length-=I,M.push(_[be][0]+"("+Me.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}M.length==1?D[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function j(O){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=O.read_shift(2),D[3]=O[O.l++],D[0].c=O[O.l++],D}function P(O,D){var M=j(O);return M[1].t="s",M[1].v=O.read_shift(D-4,"cstr"),M}function C(O,D,M,I){var z=te(6+I.length);z.write_shift(2,O),z.write_shift(1,M),z.write_shift(1,D),z.write_shift(1,39);for(var se=0;se<I.length;++se){var ce=I.charCodeAt(se);z.write_shift(1,ce>=128?95:ce)}return z.write_shift(1,0),z}function T(O,D){var M=j(O);M[1].v=O.read_shift(2);var I=M[1].v>>1;if(M[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return M[1].v=I,M}function k(O,D){var M=j(O),I=O.read_shift(4),z=O.read_shift(4),se=O.read_shift(2);if(se==65535)return I===0&&z===3221225472?(M[1].t="e",M[1].v=15):I===0&&z===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ce=se&32768;return se=(se&32767)-16446,M[1].v=(1-ce*2)*(z*Math.pow(2,se+32)+I*Math.pow(2,se)),M}function W(O,D,M,I){var z=te(14);if(z.write_shift(2,O),z.write_shift(1,M),z.write_shift(1,D),I==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var se=0,ce=0,Ae=0,be=0;return I<0&&(se=1,I=-I),ce=Math.log2(I)|0,I/=Math.pow(2,ce-31),be=I>>>0,(be&2147483648)==0&&(I/=2,++ce,be=I>>>0),I-=be,be|=2147483648,be>>>=0,I*=Math.pow(2,32),Ae=I>>>0,z.write_shift(4,Ae),z.write_shift(4,be),ce+=16383+(se?32768:0),z.write_shift(2,ce),z}function G(O,D){var M=k(O);return O.l+=D-14,M}function K(O,D){var M=j(O),I=O.read_shift(4);return M[1].v=I>>6,M}function J(O,D){var M=j(O),I=O.read_shift(8,"f");return M[1].v=I,M}function V(O,D){var M=J(O);return O.l+=D-12,M}function Z(O,D){return O[O.l+D-1]==0?O.read_shift(D,"cstr"):""}function Q(O,D){var M=O[O.l++];M>D-1&&(M=D-1);for(var I="";I.length<M;)I+=String.fromCharCode(O[O.l++]);return I}function Y(O,D,M){if(!(!M.qpro||D<21)){var I=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var z=O.read_shift(D-21,"cstr");return[I,z]}}function le(O,D){for(var M={},I=O.l+D;O.l<I;){var z=O.read_shift(2);if(z==14e3){for(M[z]=[0,""],M[z][0]=O.read_shift(2);O[O.l];)M[z][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return M}function de(O,D){var M=te(5+O.length);M.write_shift(2,14e3),M.write_shift(2,D);for(var I=0;I<O.length;++I){var z=O.charCodeAt(I);M[M.l++]=z>127?95:z}return M[M.l++]=0,M}var pe={0:{n:"BOF",f:nc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:Q},255:{n:"BOF",f:nc},21506:{n:"WKSNF",f:nc},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},q={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function oe(O){var D=O.read_shift(2),M=O.read_shift(1);if(M!=0)throw"unsupported QPW string type "+M.toString(16);return O.read_shift(D,"sbcs-cont")}function ve(O,D){Lr(O,0);var M=D||{},I={};M.dense&&(I["!data"]=[]);var z=[],se="",ce={s:{r:-1,c:-1},e:{r:-1,c:-1}},Ae=0,be=0,X=0,fe=0,Oe={SheetNames:[],Sheets:{}},Me=[];e:for(;O.l<O.length;){var me=O.read_shift(2),we=O.read_shift(2),he=O.slice(O.l,O.l+we);switch(Lr(he,0),me){case 1:if(he.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Ce=he.read_shift(4),ge=(he.length-he.l)/Ce|0,Ve=0;Ve<Ce;++Ve){var De=he.l+ge,je={};he.l+=2,je.numFmtId=he.read_shift(2),q[je.numFmtId]&&(je.z=q[je.numFmtId]),he.l=De,Me.push(je)}break;case 1025:break;case 1026:break;case 1031:for(he.l+=12;he.l<he.length;)Ae=he.read_shift(2),be=he.read_shift(1),z.push(he.read_shift(Ae,"cstr"));break;case 1032:break;case 1537:{var Xe=he.read_shift(2);I={},M.dense&&(I["!data"]=[]),ce.s.c=he.read_shift(2),ce.e.c=he.read_shift(2),ce.s.r=he.read_shift(4),ce.e.r=he.read_shift(4),he.l+=4,he.l+2<he.length&&(Ae=he.read_shift(2),be=he.read_shift(1),se=Ae==0?"":he.read_shift(Ae,"cstr")),se||(se=pt(Xe))}break;case 1538:{if(ce.s.c>255||ce.s.r>999999)break;ce.e.c<ce.s.c&&(ce.e.c=ce.s.c),ce.e.r<ce.s.r&&(ce.e.r=ce.s.r),I["!ref"]=Zt(ce),vx(Oe,I,se)}break;case 2561:X=he.read_shift(2),ce.e.c<X&&(ce.e.c=X),ce.s.c>X&&(ce.s.c=X),fe=he.read_shift(4),ce.s.r>fe&&(ce.s.r=fe),fe=he.read_shift(4),ce.e.r<fe&&(ce.e.r=fe);break;case 3073:{fe=he.read_shift(4),Ae=he.read_shift(4),ce.s.r>fe&&(ce.s.r=fe),ce.e.r<fe+Ae-1&&(ce.e.r=fe+Ae-1);for(var tt=pt(X);he.l<he.length;){var Ue={t:"z"},Le=he.read_shift(1),dt=-1;Le&128&&(dt=he.read_shift(2));var Be=Le&64?he.read_shift(2)-1:0;switch(Le&31){case 0:break;case 1:break;case 2:Ue={t:"n",v:he.read_shift(2)};break;case 3:Ue={t:"n",v:he.read_shift(2,"i")};break;case 4:Ue={t:"n",v:dx(he)};break;case 5:Ue={t:"n",v:he.read_shift(8,"f")};break;case 7:Ue={t:"s",v:z[be=he.read_shift(4)-1]};break;case 8:Ue={t:"n",v:he.read_shift(8,"f")},he.l+=2,he.l+=4,isNaN(Ue.v)&&(Ue={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Le&31)}dt!=-1&&(Me[dt-1]||{}).z&&(Ue.z=Me[dt-1].z);var it=0;if(Le&32)switch(Le&31){case 2:it=he.read_shift(2);break;case 3:it=he.read_shift(2,"i");break;case 7:it=he.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Le&31)}if(!(!M.sheetStubs&&Ue.t=="z")){var ue=Rr(Ue);Ue.t=="n"&&Ue.z&&Fi(Ue.z)&&M.cellDates&&(ue.v=ls(Ue.v),ue.t=typeof ue.v=="number"?"n":"d"),I["!data"]!=null?(I["!data"][fe]||(I["!data"][fe]=[]),I["!data"][fe][X]=ue):I[tt+gt(fe)]=ue}for(++fe,--Ae;Be-- >0&&Ae>=0;){if(Le&32)switch(Le&31){case 2:Ue={t:"n",v:Ue.v+it&65535};break;case 3:Ue={t:"n",v:Ue.v+it&65535},Ue.v>32767&&(Ue.v-=65536);break;case 7:Ue={t:"s",v:z[be=be+it>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Le&31)}else switch(Le&31){case 1:Ue={t:"z"};break;case 2:Ue={t:"n",v:he.read_shift(2)};break;case 7:Ue={t:"s",v:z[be=he.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Le&31)}!M.sheetStubs&&Ue.t=="z"||(I["!data"]!=null?(I["!data"][fe]||(I["!data"][fe]=[]),I["!data"][fe][X]=Ue):I[tt+gt(fe)]=Ue),++fe,--Ae}}}break;case 3074:{X=he.read_shift(2),fe=he.read_shift(4);var Ie=oe(he);I["!data"]!=null?(I["!data"][fe]||(I["!data"][fe]=[]),I["!data"][fe][X]={t:"s",v:Ie}):I[pt(X)+gt(fe)]={t:"s",v:Ie}}break}O.l+=we}return Oe}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})(),iz=/^\s|\s$|[\t\n\r]/;function sz(e,t){if(!t.bookSST)return"";var r=[Qt];r[r.length]=Te("sst",null,{xmlns:Ls[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(iz)&&(i+=' xml:space="preserve"'),i+=">"+et(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oz(e){return[e.read_shift(4),e.read_shift(4)]}function lz(e,t){return t||(t=te(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var cz=XW;function uz(e){var t=Pr();ye(t,159,lz(e));for(var r=0;r<e.length;++r)ye(t,19,cz(e[r]));return ye(t,160),t.end()}function dz(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function pT(e){var t=0,r,n=dz(e),a=n.length+1,i,s,l,c,d;for(r=Ri(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^s;return t^52811}function fz(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=Et(e["!ref"]),a,i=e["!data"]!=null,s=[],l=n.s.r;l<=n.e.r;++l){r.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),i&&(s=e["!data"][l]||[]),c=n.s.c;c<=n.e.c;++c){var d=Mt({r:l,c});if(a=i?s[c]:e[d],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(ka(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function $b(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var hz=6,wa=hz;function iu(e){return Math.floor((e+Math.round(128/wa)/256)*wa)}function su(e){return Math.floor((e-5)/wa*100+.5)/100}function Dh(e){return Math.round((e*wa+5)/wa*256)/256}function hx(e){e.width?(e.wpx=iu(e.width),e.wch=su(e.wpx),e.MDW=wa):e.wpx?(e.wch=su(e.wpx),e.width=Dh(e.wch),e.MDW=wa):typeof e.wch=="number"&&(e.width=Dh(e.wch),e.wpx=iu(e.width),e.MDW=wa),e.customWidth&&delete e.customWidth}var mz=96,xT=mz;function ou(e){return e*96/xT}function gT(e){return e*xT/96}function pz(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Te("numFmt",null,{numFmtId:n,formatCode:et(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function xz(e){var t=[];return t[t.length]=Te("cellXfs",null),e.forEach(function(r){t[t.length]=Te("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function gz(e,t){var r=[Qt,Te("styleSheet",null,{xmlns:Ls[0],"xmlns:vt":lr.vt})],n;return e.SSF&&(n=pz(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=xz(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function vz(e,t){var r=e.read_shift(2),n=Or(e);return[r,n]}function yz(e,t,r){r||(r=te(6+4*t.length)),r.write_shift(2,e),rr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function bz(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=rK(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=tK(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Or(e),n}function wz(e,t){t||(t=te(153)),t.write_shift(2,e.sz*20),nK(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nu(e.color,t);var n=0;return n=2,t.write_shift(1,n),rr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Nz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],yf,_z=aa;function Ub(e,t){t||(t=te(84)),yf||(yf=ex(Nz));var r=yf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(nu({auto:1},t),nu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Sz(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function vT(e,t,r){r||(r=te(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ao(e,t){return t||(t=te(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ez=aa;function Tz(e,t){return t||(t=te(51)),t.write_shift(1,0),ao(null,t),ao(null,t),ao(null,t),ao(null,t),ao(null,t),t.length>t.l?t.slice(0,t.l):t}function Cz(e,t){return t||(t=te(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Uo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function jz(e,t,r){var n=te(2052);return n.write_shift(4,e),Uo(t,n),Uo(r,n),n.length>n.l?n.slice(0,n.l):n}function Az(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ye(e,615,$n(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,44,yz(a,t[a]))}),ye(e,616))}}function kz(e){var t=1;ye(e,611,$n(t)),ye(e,43,wz({sz:12,color:{theme:1},name:"Calibri",family:2})),ye(e,612)}function Pz(e){var t=2;ye(e,603,$n(t)),ye(e,45,Ub({patternType:"none"})),ye(e,45,Ub({patternType:"gray125"})),ye(e,604)}function Oz(e){var t=1;ye(e,613,$n(t)),ye(e,46,Tz()),ye(e,614)}function Dz(e){var t=1;ye(e,626,$n(t)),ye(e,47,vT({numFmtId:0},65535)),ye(e,627)}function Rz(e,t){ye(e,617,$n(t.length)),t.forEach(function(r){ye(e,47,vT(r,0))}),ye(e,618)}function Iz(e){var t=1;ye(e,619,$n(t)),ye(e,48,Cz({xfId:0,name:"Normal"})),ye(e,620)}function Fz(e){var t=0;ye(e,505,$n(t)),ye(e,506)}function Mz(e){var t=0;ye(e,508,jz(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function Lz(e,t){var r=Pr();return ye(r,278),Az(r,e.SSF),kz(r),Pz(r),Oz(r),Dz(r),Rz(r,t.cellXfs),Iz(r),Fz(r),Mz(r),ye(r,279),r.end()}function yT(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Bz(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Or(e)}}function $z(e){var t=te(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),rr(e.name,t),t.slice(0,t.l)}function Uz(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Hz(e){var t=te(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Wz(e,t){var r=te(8+2*t.length);return r.write_shift(4,e),rr(t,r),r.slice(0,r.l)}function Kz(e){return e.l+=4,e.read_shift(4)!=0}function zz(e,t){var r=te(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Vz(){var e=Pr();return ye(e,332),ye(e,334,$n(1)),ye(e,335,$z({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,Wz(1,"XLDAPR")),ye(e,52),ye(e,35,$n(514)),ye(e,4096,$n(0)),ye(e,4097,Sn(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,zz(1)),ye(e,51,Hz([[1,0]])),ye(e,338),ye(e,333),e.end()}function Gz(){var e=[Qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Yz(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Mt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function bT(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Te("xml",null,{"xmlns:v":dn.v,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:mv":dn.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,l=t||[];return l.length>0&&i.push(Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),l.forEach(function(c){++s,i.push(Xz(c,s))}),i.push("</xml>"),i.join("")}function Xz(e,t,r){var n=kt(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Te("v:fill",i,a),l={on:"t",obscured:"t"};return["<v:shape"+Lo({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Te("v:shadow",null,l),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pr("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),pr("x:AutoFill","False"),pr("x:Row",String(n.r)),pr("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function qz(e){var t=[Qt,Te("comments",null,{xmlns:Ls[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=et(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(d){d.a&&(a=r.indexOf(et(d.a))),d.T&&++s,i.push(d.t==null?"":et(d.t))}),s===0)n[1].forEach(function(d){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(et(d.a))+'"><text>'),t.push(pr("t",d.t==null?"":et(d.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(pr("t",et(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wT(e,t,r){var n=[Qt,Te("ThreadedComments",null,{xmlns:lr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Te("threadedComment",pr("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function NT(e){var t=[Qt,Te("personList",null,{xmlns:lr.TCMNT,"xmlns:x":Ls[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Zz(e){var t={};t.iauthor=e.read_shift(4);var r=zi(e);return t.rfx=r.s,t.ref=Mt(r.s),e.l+=16,t}function Jz(e,t){return t==null&&(t=te(36)),t.write_shift(4,e[1].iauthor),Us(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Qz=Or;function Hb(e){return rr(e.slice(0,54))}function eV(e){var t=Pr(),r=[];return ye(t,628),ye(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ye(t,632,Hb(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),ye(t,632,Hb("tc="+a.ID))))})}),ye(t,631),ye(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var s={s:kt(n[0]),e:kt(n[0])};ye(t,635,Jz([s,a])),a.t&&a.t.length>0&&ye(t,637,ZW(a)),ye(t,636),delete a.iauthor})}),ye(t,634),ye(t,629),t.end()}function tV(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&vt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var rV=["xlsb","xlsm","xlam","biff8","xla"],Wb=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,a+(l?"":"$")+pt(u)+(c?"":"$")+gt(d)}return function(a,i){return t=i,a.replace(e,r)}})(),ld=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{ld=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var cd=(function(){return function(t,r){return t.replace(ld,function(n,a,i,s,l,c){var d=lx(s)-(i?0:r.c),u=ox(c)-(l?0:r.r),f=l=="$"?u+1:u==0?"":"["+u+"]",h=i=="$"?d+1:d==0?"":"["+d+"]";return a+"R"+f+"C"+h})}})();function nV(e,t){return e.replace(ld,function(r,n,a,i,s,l){return n+(a=="$"?a+i:pt(lx(i)+t.c))+(s=="$"?s+l:gt(ox(l)+t.r))})}function aV(e){return e.length!=1}function Vt(e){e.l+=1}function ei(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function _T(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ST(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=ei(e),l=ei(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function ST(e){var t=ei(e),r=ei(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function iV(e,t,r){if(r.biff<8)return ST(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=ei(e),s=ei(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function ET(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return sV(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ei(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function sV(e){var t=ei(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function oV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return cV(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function cV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function uV(e,t,r){var n=(e[e.l++]&96)>>5,a=_T(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function dV(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=_T(e,i,r);return[n,a,s]}function fV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function hV(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function mV(e,t,r){var n=(e[e.l++]&96)>>5,a=iV(e,t-1,r);return[n,a]}function pV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Kb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function xV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function gV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function yV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function bV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function TT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function wV(e){return e.read_shift(2),TT(e)}function NV(e){return e.read_shift(2),TT(e)}function _V(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=ET(e,0,r);return[n,a]}function SV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=lV(e,0,r);return[n,a]}function EV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=ET(e,0,r);return[n,a,i]}function TV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[MG[a],AT[a],n]}function CV(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:jV(e);return[a,(i[0]===0?AT:FG)[i[1]]]}function jV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function AV(e,t,r){e.l+=r&&r.biff==2?3:4}function kV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function PV(e){return e.l++,Kr[e.read_shift(1)]}function OV(e){return e.l++,e.read_shift(2)}function DV(e){return e.l++,e.read_shift(1)!==0}function RV(e){return e.l++,Hs(e)}function IV(e,t,r){return e.l++,uT(e,t-1,r)}function FV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wK(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Kr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Hs(e);break;case 2:r[1]=EK(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function MV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?zi:jK)(e));return a}function LV(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=FV(e,r.biff);return s}function BV(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function $V(e,t,r){if(r.biff==5)return UV(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function UV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function HV(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function WV(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function KV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function zV(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var VV=aa,GV=aa,YV=aa;function ml(e,t,r){return e.l+=2,[oV(e)]}function mx(e){return e.l+=6,[]}var XV=ml,qV=mx,ZV=mx,JV=ml;function CT(e){return e.l+=2,[nc(e),e.read_shift(2)&1]}var QV=ml,eG=CT,tG=mx,rG=ml,nG=ml,aG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function iG(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=aG[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function sG(e){return e.l+=2,[e.read_shift(4)]}function oG(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function lG(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function cG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dG(e){return e.l+=4,[0,0]}var zb={1:{n:"PtgExp",f:kV},2:{n:"PtgTbl",f:YV},3:{n:"PtgAdd",f:Vt},4:{n:"PtgSub",f:Vt},5:{n:"PtgMul",f:Vt},6:{n:"PtgDiv",f:Vt},7:{n:"PtgPower",f:Vt},8:{n:"PtgConcat",f:Vt},9:{n:"PtgLt",f:Vt},10:{n:"PtgLe",f:Vt},11:{n:"PtgEq",f:Vt},12:{n:"PtgGe",f:Vt},13:{n:"PtgGt",f:Vt},14:{n:"PtgNe",f:Vt},15:{n:"PtgIsect",f:Vt},16:{n:"PtgUnion",f:Vt},17:{n:"PtgRange",f:Vt},18:{n:"PtgUplus",f:Vt},19:{n:"PtgUminus",f:Vt},20:{n:"PtgPercent",f:Vt},21:{n:"PtgParen",f:Vt},22:{n:"PtgMissArg",f:Vt},23:{n:"PtgStr",f:IV},26:{n:"PtgSheet",f:oG},27:{n:"PtgEndSheet",f:lG},28:{n:"PtgErr",f:PV},29:{n:"PtgBool",f:DV},30:{n:"PtgInt",f:OV},31:{n:"PtgNum",f:RV},32:{n:"PtgArray",f:pV},33:{n:"PtgFunc",f:TV},34:{n:"PtgFuncVar",f:CV},35:{n:"PtgName",f:BV},36:{n:"PtgRef",f:_V},37:{n:"PtgArea",f:uV},38:{n:"PtgMemArea",f:HV},39:{n:"PtgMemErr",f:VV},40:{n:"PtgMemNoMem",f:GV},41:{n:"PtgMemFunc",f:WV},42:{n:"PtgRefErr",f:KV},43:{n:"PtgAreaErr",f:fV},44:{n:"PtgRefN",f:SV},45:{n:"PtgAreaN",f:mV},46:{n:"PtgMemAreaN",f:cG},47:{n:"PtgMemNoMemN",f:uG},57:{n:"PtgNameX",f:$V},58:{n:"PtgRef3d",f:EV},59:{n:"PtgArea3d",f:dV},60:{n:"PtgRefErr3d",f:zV},61:{n:"PtgAreaErr3d",f:hV},255:{}},fG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hG={1:{n:"PtgElfLel",f:CT},2:{n:"PtgElfRw",f:rG},3:{n:"PtgElfCol",f:XV},6:{n:"PtgElfRwV",f:nG},7:{n:"PtgElfColV",f:JV},10:{n:"PtgElfRadical",f:QV},11:{n:"PtgElfRadicalS",f:tG},13:{n:"PtgElfColS",f:qV},15:{n:"PtgElfColSV",f:ZV},16:{n:"PtgElfRadicalLel",f:eG},25:{n:"PtgList",f:iG},29:{n:"PtgSxName",f:sG},255:{}},mG={0:{n:"PtgAttrNoop",f:dG},1:{n:"PtgAttrSemi",f:bV},2:{n:"PtgAttrIf",f:vV},4:{n:"PtgAttrChoose",f:xV},8:{n:"PtgAttrGoto",f:gV},16:{n:"PtgAttrSum",f:AV},32:{n:"PtgAttrBaxcel",f:Kb},33:{n:"PtgAttrBaxcel",f:Kb},64:{n:"PtgAttrSpace",f:wV},65:{n:"PtgAttrSpaceSemi",f:NV},128:{n:"PtgAttrIfError",f:yV},255:{}};function pG(e,t,r,n){if(n.biff<8)return aa(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=LV(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=MV(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(aa(e,t)),i}function xG(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=zb[i]||zb[fG[i]],(i===24||i===25)&&(a=(i===24?hG:mG)[e[e.l+1]]),!a||!a.f?aa(e,t):s.push([a.n,a.f(e,t,r)]);return s}function gG(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var vG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yG(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function jT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Vb(e,t,r){var n=jT(e,t,r);return n=="#REF"?n:$o(n,r)}function Es(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],c,d,u,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,v="",y=0,b=e[0].length;y<b;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:v=jt(" ",e[0][g][1][1]);break;case 1:v=jt("\r",e[0][g][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}d=d+v,g=-1}l.push(d+vG[w[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(yG(d,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=vo(w[1][1],s,a),l.push(yo(u,i));break;case"PtgRefN":u=r?vo(w[1][1],r,a):w[1][1],l.push(yo(u,i));break;case"PtgRef3d":f=w[1][1],u=vo(w[1][2],s,a),x=Vb(n,f,a),l.push(x+"!"+yo(u,i));break;case"PtgFunc":case"PtgFuncVar":var N=w[1][0],_=w[1][1];N||(N=0),N&=127;var E=N==0?[]:l.slice(-N);l.length-=N,_==="User"&&(_=E.shift()),l.push(_+"("+E.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":m=Cb(w[1][1],r?{s:r}:s,a),l.push(pf(m,a));break;case"PtgArea":m=Cb(w[1][1],s,a),l.push(pf(m,a));break;case"PtgArea3d":f=w[1][1],m=w[1][2],x=Vb(n,f,a),l.push(x+"!"+pf(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],j=S?S.Name:"SH33TJSNAME"+String(h);j&&j.slice(0,6)=="_xlfn."&&!a.xlfn&&(j=j.slice(6)),l.push(j);break;case"PtgNameX":var P=w[1][1];h=w[1][2];var C;if(a.biff<=5)P<0&&(P=-P),n[P]&&(C=n[P][h]);else{var T="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(T=n.SheetNames[n[P][h].itab-1]+"!"):T=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])T+=n[P][h].Name;else if(n[0]&&n[0][h])T+=n[0][h].Name;else{var k=(jT(n,P,a)||"").split(";;");k[h-1]?T=k[h-1]:T+="SH33TJSERRX"}l.push(T);break}C||(C={Name:"SH33TJSERRY"}),l.push(C.Name);break;case"PtgParen":var W="(",G=")";if(g>=0){switch(v="",e[0][g][1][0]){case 2:W=jt(" ",e[0][g][1][1])+W;break;case 3:W=jt("\r",e[0][g][1][1])+W;break;case 4:G=jt(" ",e[0][g][1][1])+G;break;case 5:G=jt("\r",e[0][g][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(W+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var K={c:r.c,r:r.r};if(n.sharedf[Mt(u)]){var J=n.sharedf[Mt(u)];l.push(Es(J,s,K,n,a))}else{var V=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Es(d[1],s,K,n,a)),V=!0;break}V||l.push(w[1])}break;case"PtgArray":l.push("{"+gG(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Z.indexOf(e[0][y][0])==-1){w=e[0][g];var Q=!0;switch(w[1][0]){case 4:Q=!1;case 0:v=jt(" ",w[1][1]);break;case 5:Q=!1;case 1:v=jt("\r",w[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((Q?v:"")+l.pop()+(Q?"":v)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function bG(e){if(e==null){var t=te(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Mi(e);return Mi(0)}function wG(e,t,r,n,a){var i=Li(t,r,a),s=bG(e.v),l=te(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=te(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Yt([i,s,l,d]);return f}function ud(e,t,r){var n=e.read_shift(4),a=xG(e,n,r),i=e.read_shift(4),s=i>0?pG(e,i,a,r):null;return[a,s]}var NG=ud,dd=ud,_G=ud,SG=ud;function Gb(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=te(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=te(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function EG(e){var t=te(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function TG(e){var t=te(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function CG(e){var t=te(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=te(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=te(4);return n.write_shift(4,0),Yt([t,r,n])}function jG(e){var t=kt(e),r=te(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function AG(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=kt(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=te(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function kG(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=te(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function PG(e){var t=e.split(":"),r=t[0],n=te(23);n.write_shift(4,15),r=t[0];var a=kt(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=kt(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function OG(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=te(27);i.write_shift(4,19);var s=a[0],l=kt(s);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=a[1],l=kt(s),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function DG(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=gr(e),i=te(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function RG(e,t){if(typeof e=="number")return Gb(e);if(typeof e=="boolean")return TG(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return EG(+Zn[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return jG(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return PG(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return DG(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return AG(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return OG(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return kG(e,t);if(/^".*"$/.test(e))return CG(e);if(/^[+-]\d+$/.test(e))return Gb(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var IG=RG,FG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},MG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function LG(e){var t="of:="+e.replace(ld,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function kT(e){return e.replace(/!/,".").replace(/:/,":.")}var bo=typeof Map<"u";function px(e,t,r){var n=0,a=e.length;if(r){if(bo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=bo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(bo?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function fd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(wa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=su(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Dh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function PT(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function li(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){dW(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function BG(e,t,r){if(e&&e["!ref"]){var n=Et(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function $G(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Zt(e[r])+'"/>';return t+"</mergeCells>"}function UG(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=Mo(et(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Te("outlinePr",null,d)}!i&&!l||(a[a.length]=Te("sheetPr",l,s))}var HG=["objects","scenarios","selectLockedCells","selectUnlockedCells"],WG=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KG(e){var t={sheet:1};return HG.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),WG.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=pT(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,t)}function zG(e){return PT(e),Te("pageMargins",null,e)}function VG(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Te("col",null,fd(a,n)));return r[r.length]="</cols>",r.join("")}function GG(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Zt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=gr(a);s.s.r==s.e.r&&(s.e.r=gr(t["!ref"]).e.r,a=Zt(s));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=$o(r.SheetNames[n])+"!"+Bo(a);break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Te("autoFilter",null,{ref:a})}function YG(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,a),{})}function XG(e,t,r,n,a,i,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var l="",c=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=Kr[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=Kr[e.v=7]);break;case"e":l=Kr[e.v];break;case"d":if(n&&n.cellDates){var u=rn(e.v,s);l=u.toISOString(),u.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else e=Rr(e),e.t="n",l=""+(e.v=yr(rn(e.v,s),s));typeof e.z>"u"&&(e.z=St[14]);break;default:l=e.v;break}var f=e.t=="z"||e.v==null?"":pr("v",et(l)),h={r:t},m=li(n.cellXfs,e,n);switch(m!==0&&(h.s=m),e.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){f=pr("v",""+px(n.Strings,e.v,n.revStrings)),h.t="s";break}else h.t="str";break}if(e.t!=c&&(e.t=c,e.v=d),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Te("f",et(e.f),x)+(e.v!=null?f:"")}return e.l&&(e.l.display=et(l),r["!links"].push([t,e.l])),e.D&&(h.cm=1),Te("c",f,h)}function qG(e,t,r,n){var a=[],i=[],s=Et(e["!ref"]),l="",c,d="",u=[],f=0,h=0,m=e["!rows"],x=e["!data"]!=null,g=x?e["!data"]:[],v={r:d},y,b=-1,w=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(h=s.s.c;h<=s.e.c;++h)u[h]=pt(h);for(f=s.s.r;f<=s.e.r;++f){i=[],d=gt(f);var N=x?g[f]:[];for(h=s.s.c;h<=s.e.c;++h){c=u[h]+d;var _=x?N[h]:e[c];_!==void 0&&(l=XG(_,c,e,t,r,n,w))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(v={r:d},m&&m[f]&&(y=m[f],y.hidden&&(v.hidden=1),b=-1,y.hpx?b=ou(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(v.ht=b,v.customHeight=1),y.level&&(v.outlineLevel=y.level)),a[a.length]=Te("row",i.join(""),v))}if(m)for(;f<m.length;++f)m&&m[f]&&(v={r:f+1},y=m[f],y.hidden&&(v.hidden=1),b=-1,y.hpx?b=ou(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(v.ht=b,v.customHeight=1),y.level&&(v.outlineLevel=y.level),a[a.length]=Te("row","",v));return a.join("")}function ZG(e,t,r,n){var a=[Qt,Te("worksheet",null,{xmlns:Ls[0],"xmlns:r":lr.r})],i=r.SheetNames[e],s=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Et(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Zt(u)}n||(n={}),c["!comments"]=[];var f=[];UG(c,r,e,t,a),a[a.length]=Te("dimension",null,{ref:d}),a[a.length]=YG(c,t,e,r),t.sheetFormat&&(a[a.length]=Te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=VG(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=qG(c,t,e,r),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=KG(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=GG(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=$G(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=ot(n,-1,et(g[1].Target).replace(/#[\s\S]*$/,""),nt.HLINK),m["r:id"]="rId"+x),(h=g[1].Target.indexOf("#"))>-1&&(m.location=et(g[1].Target.slice(h+1))),g[1].Tooltip&&(m.tooltip=et(g[1].Tooltip)),m.display=g[1].display,a[a.length]=Te("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=zG(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=pr("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=ot(n,-1,"../drawings/drawing"+(e+1)+".xml",nt.DRAW),a[a.length]=Te("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",nt.VML),a[a.length]=Te("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function JG(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function QG(e,t,r){var n=te(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=ou(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=r["!data"]!=null,f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,m=-1,x=f<<10;x<f+1<<10;++x){d.c=x;var g=u?(r["!data"][d.r]||[])[d.c]:r[Mt(d)];g&&(h<0&&(h=x),m=x)}h<0||(++l,n.write_shift(4,h),n.write_shift(4,m))}var v=n.l;return n.l=c,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function eY(e,t,r,n){var a=QG(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ye(e,0,a)}var tY=zi,rY=Us;function nY(){}function aY(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=JW(e),r}function iY(e,t,r){r==null&&(r=te(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return nu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qE(e,r),r.slice(0,r.l)}function sY(e){var t=On(e);return[t]}function oY(e,t,r){return r==null&&(r=te(8)),Hi(t,r)}function lY(e){var t=Wi(e);return[t]}function cY(e,t,r){return r==null&&(r=te(4)),Ki(t,r)}function uY(e){var t=On(e),r=e.read_shift(1);return[t,r,"b"]}function dY(e,t,r){return r==null&&(r=te(9)),Hi(t,r),r.write_shift(1,e.v?1:0),r}function fY(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"b"]}function hY(e,t,r){return r==null&&(r=te(5)),Ki(t,r),r.write_shift(1,e.v?1:0),r}function mY(e){var t=On(e),r=e.read_shift(1);return[t,r,"e"]}function bf(e,t,r){return r==null&&(r=te(9)),Hi(t,r),r.write_shift(1,e.v),r}function pY(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"e"]}function wf(e,t,r){return r==null&&(r=te(8)),Ki(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function xY(e){var t=On(e),r=e.read_shift(4);return[t,r,"s"]}function gY(e,t,r){return r==null&&(r=te(12)),Hi(t,r),r.write_shift(4,t.v),r}function vY(e){var t=Wi(e),r=e.read_shift(4);return[t,r,"s"]}function yY(e,t,r){return r==null&&(r=te(8)),Ki(t,r),r.write_shift(4,t.v),r}function bY(e){var t=On(e),r=Hs(e);return[t,r,"n"]}function wY(e,t,r){return r==null&&(r=te(16)),Hi(t,r),Mi(e.v,r),r}function NY(e){var t=Wi(e),r=Hs(e);return[t,r,"n"]}function _Y(e,t,r){return r==null&&(r=te(12)),Ki(t,r),Mi(e.v,r),r}function SY(e){var t=On(e),r=dx(e);return[t,r,"n"]}function EY(e,t,r){return r==null&&(r=te(12)),Hi(t,r),ZE(e.v,r),r}function TY(e){var t=Wi(e),r=dx(e);return[t,r,"n"]}function CY(e,t,r){return r==null&&(r=te(8)),Ki(t,r),ZE(e.v,r),r}function jY(e){var t=On(e),r=cx(e);return[t,r,"is"]}function AY(e){var t=On(e),r=Or(e);return[t,r,"str"]}function kY(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=te(12+4*e.v.length)),Hi(t,r),rr(n,r),r.length>r.l?r.slice(0,r.l):r}function PY(e){var t=Wi(e),r=Or(e);return[t,r,"str"]}function OY(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=te(8+4*n.length)),Ki(t,r),rr(n,r),r.length>r.l?r.slice(0,r.l):r}function DY(e,t,r){var n=e.l+t,a=On(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=dd(e,n-e.l,r);s[3]=Es(l,null,a,r.supbooks,r)}else e.l=n;return s}function RY(e,t,r){var n=e.l+t,a=On(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=dd(e,n-e.l,r);s[3]=Es(l,null,a,r.supbooks,r)}else e.l=n;return s}function IY(e,t,r){var n=e.l+t,a=On(e);a.r=r["!row"];var i=Hs(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=dd(e,n-e.l,r);s[3]=Es(l,null,a,r.supbooks,r)}else e.l=n;return s}function FY(e,t,r){var n=e.l+t,a=On(e);a.r=r["!row"];var i=Or(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=dd(e,n-e.l,r);s[3]=Es(l,null,a,r.supbooks,r)}else e.l=n;return s}var MY=zi,LY=Us;function BY(e,t){return t==null&&(t=te(4)),t.write_shift(4,e),t}function $Y(e,t){var r=e.l+t,n=zi(e),a=od(e),i=Or(e),s=Or(e),l=Or(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:l};return s&&(c.Tooltip=s),c}function UY(e,t){var r=te(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Us({s:kt(e[0]),e:kt(e[0])},r),ux("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return rr(a||"",r),rr(e[1].Tooltip||"",r),rr("",r),r.slice(0,r.l)}function HY(){}function WY(e,t,r){var n=e.l+t,a=JE(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=NG(e,n-e.l,r);s[1]=l}else e.l=n;return s}function KY(e,t,r){var n=e.l+t,a=zi(e),i=[a];if(r.cellFormula){var s=SG(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function zY(e,t,r){r==null&&(r=te(18));var n=fd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var OT=["left","right","top","bottom","header","footer"];function VY(e){var t={};return OT.forEach(function(r){t[r]=Hs(e)}),t}function GY(e,t){return t==null&&(t=te(48)),PT(e),OT.forEach(function(r){Mi(e[r],t)}),t}function YY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function XY(e,t,r){r==null&&(r=te(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function qY(e){var t=te(24);return t.write_shift(4,4),t.write_shift(4,1),Us(e,t),t}function ZY(e,t){return t==null&&(t=te(66)),t.write_shift(2,e.password?pT(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function JY(){}function QY(){}function eX(e,t,r,n,a,i,s,l){var c={r,c:n};if(t.c&&i["!comments"].push([Mt(c),t.c]),t.v===void 0)return!1;var d="";switch(t.t){case"b":d=t.v?"1":"0";break;case"d":t=Rr(t),t.z=t.z||St[14],t.v=yr(rn(t.v,l),l),t.t="n";break;case"n":case"e":d=""+t.v;break;default:d=t.v;break}switch(c.s=li(a.cellXfs,t,a),t.l&&i["!links"].push([Mt(c),t.l]),t.t){case"s":case"str":return a.bookSST?(d=px(a.Strings,t.v==null?"":String(t.v),a.revStrings),c.t="s",c.v=d,s?ye(e,18,yY(t,c)):ye(e,7,gY(t,c))):(c.t="str",s?ye(e,17,OY(t,c)):ye(e,6,kY(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?ye(e,13,CY(t,c)):ye(e,2,EY(t,c)):isFinite(t.v)?s?ye(e,16,_Y(t,c)):ye(e,5,wY(t,c)):(c.t="e",isNaN(t.v)?s?ye(e,14,wf({v:36},c)):ye(e,3,bf({v:36},c)):s?ye(e,14,wf({v:7},c)):ye(e,3,bf({v:7},c))),!0;case"b":return c.t="b",s?ye(e,15,hY(t,c)):ye(e,4,dY(t,c)),!0;case"e":return c.t="e",s?ye(e,14,wf(t,c)):ye(e,3,bf(t,c)),!0}return s?ye(e,12,cY(t,c)):ye(e,1,oY(t,c)),!0}function tX(e,t,r,n,a){var i=Et(t["!ref"]||"A1"),s="",l=[],c=(((a||{}).Workbook||{}).WBProps||{}).date1904;ye(e,145);var d=t["!data"]!=null,u=d?t["!data"][i.s.r]:[],f=i.e.r;t["!rows"]&&(f=Math.max(i.e.r,t["!rows"].length-1));for(var h=i.s.r;h<=f;++h)if(s=gt(h),d&&(u=t["!data"][h]),eY(e,t,i,h),!(d&&!u)){var m=!1;if(h<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){h===i.s.r&&(l[x]=pt(x));var g=d?u[x]:t[l[x]+s];if(!g){m=!1;continue}m=eX(e,g,h,x,n,t,m,c)}}ye(e,146)}function rX(e,t){!t||!t["!merges"]||(ye(e,177,BY(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,LY(r))}),ye(e,178))}function nX(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,n){r&&ye(e,60,zY(n,r))}),ye(e,391))}function aX(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,qY(Et(t["!ref"]))),ye(e,650))}function iX(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=ot(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),nt.HLINK);ye(e,494,UY(n,a))}}),delete t["!links"]}function sX(e,t,r,n){if(t["!comments"].length>0){var a=ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);ye(e,551,ux("rId"+a)),t["!legacy"]=a}}function oX(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Zt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=gr(i);l.s.r==l.e.r&&(l.e.r=gr(t["!ref"]).e.r,i=Zt(l));for(var c=0;c<s.length;++c){var d=s[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref=$o(r.SheetNames[n])+"!"+Bo(i);break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:$o(r.SheetNames[n])+"!"+Bo(i)}),ye(e,161,Us(Et(i))),ye(e,162)}}function lX(e,t,r){ye(e,133),ye(e,137,XY(t,r)),ye(e,138),ye(e,134)}function cX(e,t){t["!protect"]&&ye(e,535,ZY(t["!protect"]))}function uX(e,t,r,n){var a=Pr(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Et(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ye(a,129),(r.vbaraw||s["!outline"])&&ye(a,147,iY(l,s["!outline"])),ye(a,148,rY(c)),lX(a,s,r.Workbook),nX(a,s),tX(a,s,e,t,r),cX(a,s),oX(a,s,r,e),rX(a,s),iX(a,s,n),s["!margins"]&&ye(a,476,GY(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&aX(a,s),sX(a,s,e,n),ye(a,130),a.end()}function dX(e,t){e.l+=10;var r=Or(e);return{name:r}}var fX=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function hX(e){return!e.Workbook||!e.Workbook.WBProps?"false":AW(e.Workbook.WBProps.date1904)?"true":"false"}var mX=":][*?/\\".split("");function DT(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");mX.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function pX(e,t,r){e.forEach(function(n,a){DT(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function xX(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pX(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)BG(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a&&(s=c)});var l=$o(n)+"!"+Bo(i["!autofilter"].ref);s?s.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:l})}})}function gX(e){var t=[Qt];t[t.length]=Te("workbook",null,{xmlns:Ls[0],"xmlns:r":lr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(fX.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Te("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:et(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Te("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Te("definedName",et(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function vX(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Oh(e),r.name=Or(e),r}function yX(e,t){return t||(t=te(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ux(e.strRelID,t),rr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function bX(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Or(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function wX(e,t){t||(t=te(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),qE(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NX(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=QW(e),l,c="";try{l=_G(e,0,r);try{c=od(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var d={Name:s,Ptg:l,Flags:a};return i<268435455&&(d.Sheet=i),c&&(d.Comment=c),d}function _X(e,t){var r=te(9),n=0,a=e.Name;dK.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,rr(a),IG(e.Ref,t)];if(e.Comment)i.push(Uo(e.Comment));else{var s=te(4);s.write_shift(4,4294967295),i.push(s)}return Yt(i)}function SX(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,yX(a))}ye(e,144)}function EX(e,t){t||(t=te(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return rr("SheetJS",t),rr(Yc.version,t),rr(Yc.version,t),rr("7262",t),t.length>t.l?t.slice(0,t.l):t}function TX(e,t){t||(t=te(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function CX(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(ye(e,135),ye(e,158,TX(a)),ye(e,136))}}function jX(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;ye(e,39,_X(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function AX(e){var t=e.SheetNames.length,r=te(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function kX(e,t){ye(e,353),ye(e,357),ye(e,362,AX(t)),ye(e,354)}function PX(e,t){var r=Pr();return ye(r,131),ye(r,128,EX()),ye(r,153,wX(e.Workbook&&e.Workbook.WBProps||null)),CX(r,e),SX(r,e),kX(r,e),(e.Workbook||{}).Names&&jX(r,e),ye(r,132),r.end()}function OX(e,t){var r=[];return e.Props&&r.push(xK(e.Props,t)),e.Custprops&&r.push(gK(e.Props,e.Custprops)),r.join("")}function DX(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function RX(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Te("NumberFormat",null,{"ss:Format":et(St[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Te("Style",i.join(""),s))}),Te("Styles",r.join(""))}function RT(e){return Te("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+cd(e.Ref,{r:0,c:0})})}function IX(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(RT(a)))}return Te("Names",r.join(""))}function FX(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(RT(l)))}return i.join("")}function MX(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(pr("ProtectContents","True")),e["!protect"].objects&&a.push(pr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(pr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(pr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Te("WorksheetOptions",a.join(""),{xmlns:dn.x})}function LX(e){return e.map(function(t){var r=jW(t.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Te("Comment",n,a)}).join("")}function BX(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+et(cd(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=kt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=et(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=et(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=s.c||d[u].s.r!=s.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(f="Number",h=String(e.v)):(f="Error",h=Kr[isNaN(e.v)?36:7]);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Kr[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||St[14]);break;case"s":f="String",h=CW(e.v||"");break}var m=li(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=s.c+1;var x=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=LX(e.c)),Te("Cell",g,l)}function $X(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=gT(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function UX(e,t,r,n){if(!e["!ref"])return"";var a=Et(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,y){hx(v);var b=!!v.width,w=fd(y,v),N={"ss:Index":y+1};b&&(N["ss:Width"]=iu(w.width)),v.hidden&&(N["ss:Hidden"]="1"),l.push(Te("Column",null,N))});for(var c=e["!data"]!=null,d={r:0,c:0},u=a.s.r;u<=a.e.r;++u){var f=[$X(u,(e["!rows"]||[])[u])];d.r=u;for(var h=a.s.c;h<=a.e.c;++h){d.c=h;var m=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>u)&&!(i[s].e.c<h)&&!(i[s].e.r<u)){(i[s].s.c!=h||i[s].s.r!=u)&&(m=!0);break}if(!m){var x=pt(h)+gt(u),g=c?(e["!data"][u]||[])[h]:e[x];f.push(BX(g,x,e,t,r,n,d))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function HX(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?FX(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?UX(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(MX(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+cd(Bo(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function WX(e,t){t||(t={}),e.SSF||(e.SSF=Rr(St)),e.SSF&&(ad(),nd(e.SSF),t.revssf=id(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(OX(e,t)),r.push(DX(e)),r.push(""),r.push(IX(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Te("Worksheet",HX(n,t,e),{"ss:Name":et(e.SheetNames[n])}));return r[2]=RX(e,t),Qt+Te("Workbook",r.join(""),{xmlns:dn.ss,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:ss":dn.ss,"xmlns:dt":dn.dt,"xmlns:html":dn.html})}var Nf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KX(e,t){var r=[],n=[],a=[],i=0,s,l=vb(Ab,"n"),c=vb(kb,"n");if(e.Props)for(s=qt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=qt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var d=[];for(i=0;i<a.length;++i)lT.indexOf(a[i][0])>-1||iT.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&vt.utils.cfb_add(t,"/SummaryInformation",Ib(n,Nf.SI,c,kb)),(r.length||d.length)&&vt.utils.cfb_add(t,"/DocumentSummaryInformation",Ib(r,Nf.DSI,l,Ab,d.length?d:null,Nf.UDI))}function zX(e,t){var r=t||{},n=vt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return vt.utils.cfb_add(n,a,FT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&KX(e,n),r.biff==8&&e.vbaraw&&tV(n,vt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var VX={0:{f:JG},1:{f:sY},2:{f:SY},3:{f:mY},4:{f:uY},5:{f:bY},6:{f:AY},7:{f:xY},8:{f:FY},9:{f:IY},10:{f:DY},11:{f:RY},12:{f:lY},13:{f:TY},14:{f:pY},15:{f:fY},16:{f:NY},17:{f:PY},18:{f:vY},19:{f:cx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:NX},40:{},42:{},43:{f:bz},44:{f:vz},45:{f:_z},46:{f:Ez},47:{f:Sz},48:{},49:{f:VW},50:{},51:{f:Uz},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qK},62:{f:jY},63:{f:Yz},64:{f:JY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:aa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:YY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:aY},148:{f:tY,p:16},151:{f:HY},152:{},153:{f:bX},154:{},155:{},156:{f:vX},157:{},158:{},159:{T:1,f:oz},160:{T:-1},161:{T:1,f:zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bz},336:{T:-1},337:{f:Kz,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Oh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:zK},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WY},427:{f:KY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:nY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$Y},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Oh},551:{f:od},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Qz},633:{T:1},634:{T:-1},635:{T:1,f:Zz},636:{T:-1},637:{f:qW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:QY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ne(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&sx(r)&&e.push(r)}}function GX(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ne(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,c=0,d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(s[l]||8224)<=8224;)d+=s[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function _f(e,t,r,n){var a=te(9);return hl(a,e,t),cT(r,n||"b",a),a}function YX(e,t,r){var n=te(8+2*r.length);return hl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function IT(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return Ne(e,28,vf(n,r[1],r[2]));Ne(e,28,vf(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)Ne(e,28,vf(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function XX(e,t,r,n,a,i){var s=0;t.z!=null&&(s=a._BIFF2FmtTable.indexOf(t.z),s==-1&&(a._BIFF2FmtTable.push(t.z),s=a._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<a.cellXfs.length&&a.cellXfs[l].numFmtId!=s;++l);l==a.cellXfs.length&&a.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var c=t.t=="d"?yr(rn(t.v,i),i):t.v;a.biff==2&&c==(c|0)&&c>=0&&c<65536?Ne(e,2,ez(r,n,c,l,s)):isNaN(c)?Ne(e,5,_f(r,n,36,"e")):isFinite(c)?Ne(e,3,QK(r,n,c,l,s)):Ne(e,5,_f(r,n,7,"e"));return;case"b":case"e":Ne(e,5,_f(r,n,t.v,t.t));return;case"s":case"str":Ne(e,4,YX(r,n,t.v==null?"":String(t.v).slice(0,255)));return}Ne(e,1,hl(null,r,n))}function qX(e,t,r,n,a){var i=t["!data"]!=null,s=Et(t["!ref"]||"A1"),l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var d=(((a||{}).Workbook||{}).WBProps||{}).date1904,u=[],f=[],h=s.s.c;h<=s.e.c;++h)c[h]=pt(h);for(var m=s.s.r;m<=s.e.r;++m)for(i&&(u=t["!data"][m]||[]),l=gt(m),h=s.s.c;h<=s.e.c;++h){var x=i?u[h]:t[c[h]+l];x&&(XX(e,x,m,h,n,d),x.c&&f.push([x.c,m,h]))}IT(e,f)}function ZX(e,t){for(var r=t||{},n=Pr(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);Ne(n,r.biff==4?1033:r.biff==3?521:9,fx(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&Ne(n,34,Cr(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=Pr();return qX(s,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(l){r.biff<=3?Ne(n,30,LK(l)):Ne(n,1054,BK(l))}),r.cellXfs.forEach(function(l){switch(r.biff){case 2:Ne(n,67,UK(l));break;case 3:Ne(n,579,hT(l));break;case 4:Ne(n,1091,HK(l));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),Ne(n,10),n.end()}var Rn=1,_n=[];function JX(){var e=te(82+8*_n.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*_n.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*_n.length);{e.write_shift(4,Rn),e.write_shift(4,_n.length+1);for(var t=0,r=0;r<_n.length;++r)t+=_n[r]&&_n[r][1]||0;e.write_shift(4,t),e.write_shift(4,_n.length)}_n.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function QX(e,t){var r=[],n=0,a=Pr(),i=Rn,s;t.forEach(function(c,d){var u="",f=c[0].map(function(w){return w.a&&!u&&(u=w.a),w.t}).join("");++Rn;{var h=te(150);h.write_shift(2,15),h.write_shift(2,61444),h.write_shift(4,150),h.write_shift(2,3234),h.write_shift(2,61450),h.write_shift(4,8),h.write_shift(4,Rn),h.write_shift(4,2560),h.write_shift(2,227),h.write_shift(2,61451),h.write_shift(4,84),h.write_shift(2,128),h.write_shift(4,0),h.write_shift(2,139),h.write_shift(4,2),h.write_shift(2,191),h.write_shift(4,524296),h.write_shift(2,344),h.l+=4,h.write_shift(2,385),h.write_shift(4,134217808),h.write_shift(2,387),h.write_shift(4,134217808),h.write_shift(2,389),h.write_shift(4,268435700),h.write_shift(2,447),h.write_shift(4,1048592),h.write_shift(2,448),h.write_shift(4,134217809),h.write_shift(2,451),h.write_shift(4,268435700),h.write_shift(2,513),h.write_shift(4,134217809),h.write_shift(2,515),h.write_shift(4,268435700),h.write_shift(2,575),h.write_shift(4,196609),h.write_shift(2,959),h.write_shift(4,131072|(c[0].hidden?2:0)),h.l+=2,h.write_shift(2,61456),h.write_shift(4,18),h.write_shift(2,3),h.write_shift(2,c[2]+2),h.l+=2,h.write_shift(2,c[1]+1),h.l+=2,h.write_shift(2,c[2]+4),h.l+=2,h.write_shift(2,c[1]+5),h.l+=2,h.l+=2,h.write_shift(2,61457),h.l+=4,h.l=150,d==0?s=h:Ne(a,236,h)}n+=150;{var m=te(52);m.write_shift(2,21),m.write_shift(2,18),m.write_shift(2,25),m.write_shift(2,Rn),m.write_shift(2,0),m.l=22,m.write_shift(2,13),m.write_shift(2,22),m.write_shift(4,1651663474),m.write_shift(4,2503426821),m.write_shift(4,2150634280),m.write_shift(4,1768515844+Rn*256),m.write_shift(2,0),m.write_shift(4,0),m.l+=4,Ne(a,93,m)}{var x=te(8);x.l+=2,x.write_shift(2,61453),x.l+=4,Ne(a,236,x)}n+=8;{var g=te(18);g.write_shift(2,18),g.l+=8,g.write_shift(2,f.length),g.write_shift(2,16),g.l+=4,Ne(a,438,g);{var v=te(1+f.length);v.write_shift(1,0),v.write_shift(f.length,f,"sbcs"),Ne(a,60,v)}{var y=te(16);y.l+=8,y.write_shift(2,f.length),y.l+=6,Ne(a,60,y)}}{var b=te(12+u.length);b.write_shift(2,c[1]),b.write_shift(2,c[2]),b.write_shift(2,0|(c[0].hidden?0:2)),b.write_shift(2,Rn),b.write_shift(2,u.length),b.write_shift(1,0),b.write_shift(u.length,u,"sbcs"),b.l++,r.push(b)}});{var l=te(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Rn),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,i),l.write_shift(4,5),Ne(e,236,s?Yt([l,s]):l)}e.push(a.end()),r.forEach(function(c){Ne(e,28,c)}),_n.push([i,t.length+1,Rn]),++Rn}function eq(e,t,r){Ne(e,49,RK({sz:12,name:"Arial"},r))}function tq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ne(e,1054,MK(a,t[a],r))})}function rq(e,t){var r=te(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ne(e,2151,r),r=te(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),fT(Et(t["!ref"]||"A1"),r),r.write_shift(4,4),Ne(e,2152,r)}function nq(e,t){for(var r=0;r<16;++r)Ne(e,224,Mb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ne(e,224,Mb(n,0,t))})}function aq(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ne(e,440,GK(n)),n[1].Tooltip&&Ne(e,2048,YK(n))}delete t["!links"]}function iq(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ne(e,125,ZK(fd(a,n),a))})}}function sq(e,t,r,n,a,i){var s=16+li(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ne(e,513,Li(r,n,s));return}if(t.bf)Ne(e,6,wG(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?yr(rn(t.v,i),i):t.v;isNaN(l)?Ne(e,517,gf(r,n,36,s,a,"e")):isFinite(l)?Ne(e,515,KK(r,n,l,s)):Ne(e,517,gf(r,n,7,s,a,"e"));break;case"b":case"e":Ne(e,517,gf(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var c=px(a.Strings,t.v==null?"":String(t.v),a.revStrings);Ne(e,253,IK(r,n,c,s))}else Ne(e,516,FK(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,a));break;default:Ne(e,513,Li(r,n,s))}}function oq(e,t,r){var n=Pr(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=i["!data"]!=null,d=t.biff==8,u="",f=[],h=Et(i["!ref"]||"A1"),m=d?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+m);h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.r,m-1)}Ne(n,2057,fx(r,16,t)),Ne(n,13,Sn(1)),Ne(n,12,Sn(100)),Ne(n,15,Cr(!0)),Ne(n,17,Cr(!1)),Ne(n,16,Mi(.001)),Ne(n,95,Cr(!0)),Ne(n,42,Cr(!1)),Ne(n,43,Cr(!1)),Ne(n,130,Sn(1)),Ne(n,128,WK()),Ne(n,131,Cr(!1)),Ne(n,132,Cr(!1)),d&&iq(n,i["!cols"]),Ne(n,512,$K(h,t));var x=(((r||{}).Workbook||{}).WBProps||{}).date1904;d&&(i["!links"]=[]);for(var g=h.s.c;g<=h.e.c;++g)f[g]=pt(g);for(var v=[],y=[],b=h.s.r;b<=h.e.r;++b)for(c&&(y=i["!data"][b]||[]),u=gt(b),g=h.s.c;g<=h.e.c;++g){var w=c?y[g]:i[f[g]+u];w&&(sq(n,w,b,g,t,x),d&&w.l&&i["!links"].push([f[g]+u,w.l]),w.c&&v.push([w.c,b,g]))}var N=l.CodeName||l.name||a;return d?QX(n,v):IT(n,v),d&&Ne(n,574,DK((s.Views||[])[0])),d&&(i["!merges"]||[]).length&&Ne(n,229,VK(i["!merges"])),d&&aq(n,i),Ne(n,442,dT(N)),d&&rq(n,i),Ne(n,10),n.end()}function lq(e,t,r){var n=Pr(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Ne(n,2057,fx(e,5,r)),r.bookType=="xla"&&Ne(n,135),Ne(n,225,l?Sn(1200):null),Ne(n,193,bK(2)),c&&Ne(n,191),c&&Ne(n,192),Ne(n,226),Ne(n,92,AK("SheetJS",r)),Ne(n,66,Sn(l?1200:1252)),l&&Ne(n,353,Sn(0)),l&&Ne(n,448),Ne(n,317,JK(e.SheetNames.length)),l&&e.vbaraw&&Ne(n,211),l&&e.vbaraw){var d=s.CodeName||"ThisWorkbook";Ne(n,442,dT(d))}Ne(n,156,Sn(17)),Ne(n,25,Cr(!1)),Ne(n,18,Cr(!1)),Ne(n,19,Sn(0)),l&&Ne(n,431,Cr(!1)),l&&Ne(n,444,Sn(0)),Ne(n,61,OK()),Ne(n,64,Cr(!1)),Ne(n,141,Sn(0)),Ne(n,34,Cr(hX(e)=="true")),Ne(n,14,Cr(!0)),l&&Ne(n,439,Cr(!1)),Ne(n,218,Sn(0)),eq(n,e,r),tq(n,e.SSF,r),nq(n,r),l&&Ne(n,352,Cr(!1));var u=n.end(),f=Pr();l&&Ne(f,140,XK()),l&&_n.length&&Ne(f,235,JX()),l&&r.Strings&&GX(f,252,PK(r.Strings)),Ne(f,10);var h=f.end(),m=Pr(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var v=u.length+x+h.length;for(g=0;g<e.SheetNames.length;++g){var y=i[g]||{};Ne(m,133,kK({pos:v,hs:y.Hidden||0,dt:0,name:e.SheetNames[g]},r)),v+=t[g].length}var b=m.end();if(x!=b.length)throw new Error("BS8 "+x+" != "+b.length);var w=[];return u.length&&w.push(u),b.length&&w.push(b),h.length&&w.push(h),Yt(w)}function cq(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Rr(St)),e&&e.SSF&&(ad(),nd(e.SSF),r.revssf=id(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),Rn=1,_n=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,xx(r),r.cellXfs=[],li(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=oq(a,r,e);return n.unshift(lq(e,n,r)),Yt(n)}function FT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=gr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return cq(e,t);case 4:case 3:case 2:return ZX(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function uq(e,t,r,n){for(var a=e["!merges"]||[],i=[],s={},l=e["!data"]!=null,c=t.s.c;c<=t.e.c;++c){for(var d=0,u=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>c)&&!(a[f].e.r<r||a[f].e.c<c)){if(a[f].s.r<r||a[f].s.c<c){d=-1;break}d=a[f].e.r-a[f].s.r+1,u=a[f].e.c-a[f].s.c+1;break}if(!(d<0)){var h=pt(c)+gt(r),m=l?(e["!data"][r]||[])[c]:e[h];m&&m.t=="n"&&m.v!=null&&!isFinite(m.v)&&(isNaN(m.v)?m={t:"e",v:36,w:Kr[36]}:m={t:"e",v:7,w:Kr[7]});var x=m&&m.v!=null&&(m.h||hf(m.w||(ka(m),m.w)||""))||"";s={},d>1&&(s.rowspan=d),u>1&&(s.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(s["data-t"]=m&&m.t||"z",m.v!=null&&(s["data-v"]=hf(m.v instanceof Date?m.v.toISOString():m.v)),m.z!=null&&(s["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+hf(m.l.Target)+'">'+x+"</a>")),s.id=(n.id||"sjs")+"-"+h,i.push(Te("td",x,s))}}var g="<tr>";return g+i.join("")+"</tr>"}var dq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fq="</body></html>";function hq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function MT(e,t){var r=t||{},n=r.header!=null?r.header:dq,a=r.footer!=null?r.footer:fq,i=[n],s=gr(e["!ref"]||"A1");if(i.push(hq(e,s,r)),e["!ref"])for(var l=s.s.r;l<=s.e.r;++l)i.push(uq(e,s,l,r));return i.push("</table>"+a),i.join("")}function LT(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?kt(a.origin):a.origin;s=c.r,l=c.c}var d=Math.min(a.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var f=gr(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var h=[],m=0,x=e["!rows"]||(e["!rows"]=[]),g=0,v=0,y=0,b=0,w=0,N=0;for(e["!cols"]||(e["!cols"]=[]);g<n.length&&v<d;++g){var _=n[g];if(Yb(_)){if(a.display)continue;x[v]={hidden:!0}}var E=_.cells;for(y=b=0;y<E.length;++y){var S=E[y];if(!(a.display&&Yb(S))){var j=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):kW(S.innerHTML),P=S.getAttribute("data-z")||S.getAttribute("z");for(m=0;m<h.length;++m){var C=h[m];C.s.c==b+l&&C.s.r<v+s&&v+s<=C.e.r&&(b=C.e.c+1-l,m=-1)}N=+S.getAttribute("colspan")||1,((w=+S.getAttribute("rowspan")||1)>1||N>1)&&h.push({s:{r:v+s,c:b+l},e:{r:v+s+(w||1)-1,c:b+l+(N||1)-1}});var T={t:"s",v:j},k=S.getAttribute("data-t")||S.getAttribute("t")||"";j!=null&&(j.length==0?T.t=k||"z":a.raw||j.trim().length==0||k=="s"||(k=="e"&&Kr[+j]?T={t:"e",v:+j,w:Kr[+j]}:j==="TRUE"?T={t:"b",v:!0}:j==="FALSE"?T={t:"b",v:!1}:isNaN(ba(j))?isNaN(tu(j).getDate())?j.charCodeAt(0)==35&&Zn[j]!=null&&(T={t:"e",v:Zn[j],w:j}):(T={t:"d",v:rn(j)},a.UTC&&(T.v=sd(T.v)),a.cellDates||(T={t:"n",v:yr(T.v)}),T.z=a.dateNF||St[14]):T={t:"n",v:ba(j)})),T.z===void 0&&P!=null&&(T.z=P);var W="",G=S.getElementsByTagName("A");if(G&&G.length)for(var K=0;K<G.length&&!(G[K].hasAttribute("href")&&(W=G[K].getAttribute("href"),W.charAt(0)!="#"));++K);W&&W.charAt(0)!="#"&&W.slice(0,11).toLowerCase()!="javascript:"&&(T.l={Target:W}),i?(e["!data"][v+s]||(e["!data"][v+s]=[]),e["!data"][v+s][b+l]=T):e[Mt({c:b+l,r:v+s})]=T,u.e.c<b+l&&(u.e.c=b+l),b+=N}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,v-1+s),e["!ref"]=Zt(u),v>=d&&(e["!fullref"]=Zt((u.e.r=n.length-g+v-1+s,u))),e}function BT(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),LT(n,e,t)}function mq(e,t){var r=Bs(BT(e,t),t);return r}function Yb(e){var t="",r=pq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var xq=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qt+t}})();function gq(e,t){var r="number",n="",a={"style:name":t},i="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+et(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+et(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var l=e.match(/# (\?+)\/(\?+)/);if(l){n+=Te("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=e.match(/# (\?+)\/(\d+)/)){n+=Te("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Te("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"s":c=!0,--s;break t;case"m":r:for(var d=s+1;d<e.length;++d)switch(e[d]){case"y":case"d":break r;case"h":case"s":c=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+et(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++s],n+="<number:text>"+et(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+et(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!c)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do i+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+et(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+et(i)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+et(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+et(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var u=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!u||!u[0])console.error("Could not find numeric part of "+e);else{var f=u[1].replace(/,/g,"");n+="<number:"+(u[3]?"scientific-":"")+'number number:min-integer-digits="'+(f.indexOf("0")==-1?"0":f.length-f.indexOf("0"))+'"'+(u[0].indexOf(",")>-1?' number:grouping="true"':"")+(u[2]&&' number:decimal-places="'+(u[2].length-1)+'"'||' number:decimal-places="0"')+(u[3]&&u[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(u[3]?' number:min-exponent-digits="'+u[3].match(/0+/)[0].length+'"':"")+"></number:"+(u[3]?"scientific-":"")+"number>",s=u.index+u[0].length}if(e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+et(i.replace(/""/g,'"'))+"</number:text>"}}return n?Te("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function Xb(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var l=(r==-1?"$":"")+kT(s.Ref);return"        "+Te("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var qb=(function(){var e=function(a,i){return et(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,s,l,c,d){var u=[];u.push('      <table:table table:name="'+et(i.SheetNames[s])+`" table:style-name="ta1">
`);var f=0,h=0,m=gr(a["!ref"]||"A1"),x=a["!merges"]||[],g=0,v=a["!data"]!=null;if(a["!cols"])for(h=0;h<=m.e.c;++h)u.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",b=a["!rows"]||[];for(f=0;f<m.s.r;++f)y=b[f]?' table:style-name="ro'+b[f].ods+'"':"",u.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=m.e.r;++f){for(y=b[f]?' table:style-name="ro'+b[f].ods+'"':"",u.push("        <table:table-row"+y+`>
`),h=0;h<m.s.c;++h)u.push(t);for(;h<=m.e.c;++h){var w=!1,N={},_="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>h)&&!(x[g].s.r>f)&&!(x[g].e.c<h)&&!(x[g].e.r<f)){(x[g].s.c!=h||x[g].s.r!=f)&&(w=!0),N["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,N["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(w){u.push(`          <table:covered-table-cell/>
`);continue}var E=Mt({r:f,c:h}),S=v?(a["!data"][f]||[])[h]:a[E];if(S&&S.f&&(N["table:formula"]=et(LG(S.f)),S.F&&S.F.slice(0,E.length)==E)){var j=gr(S.F);N["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,N["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!S){u.push(t);continue}switch(S.t){case"b":_=S.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=S.v?"true":"false";break;case"n":isFinite(S.v)?(_=S.w||String(S.v||0),N["office:value-type"]="float",N["office:value"]=S.v||0):(isNaN(S.v)?(_="#NUM!",N["table:formula"]="of:=#NUM!"):(_="#DIV/0!",N["table:formula"]="of:="+(S.v<0?"-":"")+"1/0"),N["office:string-value"]="",N["office:value-type"]="string",N["calcext:value-type"]="error");break;case"s":case"str":_=S.v==null?"":S.v,N["office:value-type"]="string";break;case"d":_=S.w||rn(S.v,d).toISOString(),N["office:value-type"]="date",N["office:date-value"]=rn(S.v,d).toISOString(),N["table:style-name"]="ce1";break;default:u.push(t);continue}var P=e(_);if(S.l&&S.l.Target){var C=S.l.Target;C=C.charAt(0)=="#"?"#"+kT(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),P=Te("text:a",P,{"xlink:href":C.replace(/&/g,"&amp;")})}c[S.z]&&(N["table:style-name"]="ce"+c[S.z].slice(1));var T=Te("text:p",P,{});if(S.c){for(var k="",W="",G={},K=0;K<S.c.length;++K)!k&&S.c[K].a&&(k=S.c[K].a),W+="<text:p>"+e(S.c[K].t)+"</text:p>";S.c.hidden||(G["office:display"]=!0),T=Te("office:annotation",W,G)+T}u.push("          "+Te("table:table-cell",T,N)+`
`)}u.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&u.push(Xb(i.Workbook.Names,i.SheetNames,s)),u.push(`      </table:table>
`),u.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var s=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var h=u["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;hx(h),h.ods=s;var m=u["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++s}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var h=u["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c={},d=69;return i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u){var f=u["!data"]!=null;if(u["!ref"])for(var h=gr(u["!ref"]),m=0;m<=h.e.r;++m)for(var x=0;x<=h.e.c;++x){var g=f?(u["!data"][m]||[])[x]:u[Mt({r:m,c:x})];if(!(!g||!g.z||g.z.toLowerCase()=="general")&&!c[g.z]){var v=gq(g.z,"N"+d);v&&(c[g.z]="N"+d,++d,a.push(v+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),qt(c).forEach(function(u){a.push('<style:style style:name="ce'+c[u].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+c[u]+`"/>
`)}),a.push(` </office:automatic-styles>
`),c};return function(i,s){var l=[Qt],c=Lo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Lo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(nT().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+c+`>
`);var u=n(l,i);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var f=0;f!=i.SheetNames.length;++f)l.push(r(i.Sheets[i.SheetNames[f]],i,f,s,u,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&l.push(Xb(i.Workbook.Names,i.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),s.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function $T(e,t){if(t.bookType=="fods")return qb(e,t);var r=rx(),n="",a=[],i=[];return n="mimetype",Qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qe(r,n,qb(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Qe(r,n,xq(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Qe(r,n,Qt+nT()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Qe(r,n,pK(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qe(r,n,hK(a)),r}var Hr=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function lu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ho(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):cs(Ii(e))}function Fr(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):un(Mo(e))}function ti(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],s=i.length;if(s<250)for(var l=0;l<s;++l)n[a++]=i[l];else n.set(i,a),a+=s}return n}function vq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Wo(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function $e(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[Hr](0,r)}function UT(e){for(var t={l:0},r=[];t.l<e.length;)r.push(Wo(e,t));return r}function HT(e){return ti(e.map(function(t){return $e(t)}))}function mn(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function ze(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=Wo(e,r),i=a&7;a=a/8|0;var s,l=r.l;switch(i){case 0:{for(;e[l++]>=128;);s=e[Hr](r.l,l),r.l=l}break;case 1:s=e[Hr](l,l+8),r.l=l+8;break;case 2:{var c=Wo(e,r);s=e[Hr](r.l,r.l+c),r.l+=c}break;case 5:s=e[Hr](l,l+4),r.l=l+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:s,type:i};t[a]==null&&(t[a]=[]),t[a].push(d)}return t}function We(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push($e(n*8+a.type)),a.type==2&&t.push($e(a.data.length)),t.push(a.data))})}),ti(t)}function cu(e,t){return e?.map(function(r){return t(r.data)})||[]}function uu(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Wo(e,n),i=ze(e[Hr](n.l,n.l+a));n.l+=a;var s={id:mn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=ze(l.data),d=mn(c[3][0].data);s.messages.push({meta:c,data:e[Hr](n.l,n.l+d)}),n.l+=d}),(t=i[3])!=null&&t[0]&&(s.merge=mn(i[3][0].data)>>>0>0),r.push(s)}return r}function fs(e){var t=[];return e.forEach(function(r){var n=[[],[{data:$e(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:$e(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:$e(s.data.length)}],n[2].push({data:We(s.meta),type:2})});var i=We(n);t.push($e(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ti(t)}function yq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Wo(t,r),a=[],i=r.l;i<t.length;){var s=t[i]&3;if(s==0){var l=t[i++]>>2;if(l<60)++l;else{var c=l-59;l=t[i],c>1&&(l|=t[i+1]<<8),c>2&&(l|=t[i+2]<<16),c>3&&(l|=t[i+3]<<24),l>>>=0,l++,i+=c}a.push(t[Hr](i,i+l)),i+=l;continue}else{var d=0,u=0;if(s==1?(u=(t[i]>>2&7)+4,d=(t[i++]&224)<<3,d|=t[i++]):(u=(t[i++]>>2)+1,s==2?(d=t[i]|t[i+1]<<8,i+=2):(d=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),d==0)throw new Error("Invalid offset 0");for(var f=a.length-1,h=d;f>=0&&h>=a[f].length;)h-=a[f].length,--f;if(f<0)if(h==0)h=a[f=0].length;else throw new Error("Invalid offset beyond length");if(u<h)a.push(a[f][Hr](a[f].length-h,a[f].length-h+u));else{for(h>0&&(a.push(a[f][Hr](a[f].length-h)),u-=h),++f;u>=a[f].length;)a.push(a[f]),u-=a[f].length,++f;u&&a.push(a[f][Hr](0,u))}a.length>25&&(a=[ti(a)])}}for(var m=0,x=0;x<a.length;++x)m+=a[x].length;if(m!=n)throw new Error("Unexpected length: ".concat(m," != ").concat(n));return a}function du(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,yq(n,e[Hr](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:ti(t)}function hs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=$e(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[Hr](r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ti(t)}function Sf(e,t){var r=new Uint8Array(32),n=lu(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&Fi(e.z)){r[1]=5,n.setFloat64(a,(ls(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,vq(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var l=t.rsst.findIndex(function(d){var u;return d.v==s&&d.l==((u=e.l)==null?void 0:u.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=16,a+=4}else{var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(bq(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[Hr](0,a)}function Ef(e,t){var r=new Uint8Array(32),n=lu(r),a=12,i=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var l=t.rsst.findIndex(function(d){var u;return d.v==s&&d.l==((u=e.l)==null?void 0:u.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var c=t.sst.indexOf(s);c==-1&&(t.sst[c=t.sst.length]=s),r[1]=3,n.setUint32(a,c,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[Hr](0,a)}function Gt(e){var t=ze(e);return mn(t[1][0].data)}function Tr(e){return We([[],[{type:0,data:$e(e)}]])}function Er(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?UT(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:HT(n)}])}function la(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?UT(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:HT(n.filter(function(a){return a!=t}))}]}function bq(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function wq(e,t,r){var n,a,i,s=[[],[{type:0,data:$e(0)}],[{type:0,data:$e(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:$e(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:$e(1)}]];if(!((n=s[6])!=null&&n[0])||!((a=s[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(s[7][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(s[7][0].data),s[7][0].data=c}if(s[4][0].data.length<2*e.length){var d=new Uint8Array(2*e.length);d.set(s[4][0].data),s[4][0].data=d}for(var u=lu(s[7][0].data),f=0,h=[],m=lu(s[4][0].data),x=0,g=[],v=4,y=0;y<e.length;++y){if(e[y]==null||e[y].t=="z"&&!((i=e[y].c)!=null&&i.length)||e[y].t=="e"){u.setUint16(y*2,65535,!0),m.setUint16(y*2,65535);continue}u.setUint16(y*2,f/v,!0),m.setUint16(y*2,x/v,!0);var b,w;switch(e[y].t){case"d":if(e[y].v instanceof Date){b=Sf(e[y],t),w=Ef(e[y],t);break}b=Sf(e[y],t),w=Ef(e[y],t);break;case"s":case"n":case"b":case"z":b=Sf(e[y],t),w=Ef(e[y],t);break;default:throw new Error("Unsupported value "+e[y])}h.push(b),f+=b.length,g.push(w),x+=w.length,++l}for(s[2][0].data=$e(l),s[5][0].data=$e(5);y<s[7][0].data.length/2;++y)u.setUint16(y*2,65535,!0),m.setUint16(y*2,65535,!0);return s[6][0].data=ti(h),s[3][0].data=ti(g),s[8]=[{type:0,data:$e(1)}],s}function Rh(e,t){return{meta:[[],[{type:0,data:$e(e)}]],data:t}}function Yn(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function Nq(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&uu(du(a.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:i,type:mn(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&uu(du(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(s){i.meta[s]&&i.meta[s].forEach(function(l){t[a.id].deps.push(mn(l.data))})})})})}),t}function Xl(e,t,r){return We([[],[{type:0,data:$e(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:$e(1)}]])}function Zb(e){switch(e){case 0:return Xl(99,222,171);case 1:return Xl(162,197,240);case 2:return Xl(255,189,189)}return Xl(Math.random()*255,Math.random()*255,Math.random()*255)}function _q(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=vt.read(t.numbers,{type:"base64"}),n=Nq(r),a=Xn(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=cu(ze(a.messages[0].data)[1],Gt);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,l){l>=1&&(Eq(r,n,l+1),a=Xn(r,n,1),i=cu(ze(a.messages[0].data)[1],Gt)),Tq(r,n,e.Sheets[s],s,l,i[l])}),r}function ht(e,t,r,n){var a=vt.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=uu(du(a.content)),s=i.find(function(l){return l.id==r});n(s,i),a.content=hs(fs(i)),a.size=a.content.length}function Xn(e,t,r){var n=vt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=uu(du(n.content)),i=a.find(function(s){return s.id==r});return i}function Ih(e,t,r){e[3].push({type:2,data:We([[],[{type:0,data:$e(t)}],[{type:2,data:Fr(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:Fr(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:$e(0)}],[],[{type:0,data:$e(0)}]])}),e[1]=[{type:0,data:$e(Math.max(t+1,mn(e[1][0].data)))}]}function di(e,t,r,n,a,i){i||(i=Yn({deps:[],location:"",type:t},a));var s="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+s,vt.utils.cfb_add(e,s,hs(fs([{id:i,messages:[Rh(t,We(r))]}])));var l=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return ht(e,a,2,function(c){var d=ze(c.messages[0].data);Ih(d,i||0,l),c.messages[0].data=We(d)}),i}function Jr(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,d,u=ze(l.data);return(c=u[3])!=null&&c[0]?Ho(u[3][0].data)==a:!!((d=u[2])!=null&&d[0]&&Ho(u[2][0].data)==a)}),s=ze(e[3][i].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){s[6].push({type:2,data:We([[],[{type:0,data:$e(l)}]])})}),e[3][i].data=We(s)}function Sq(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,d,u=ze(l.data);return(c=u[3])!=null&&c[0]?Ho(u[3][0].data)==a:!!((d=u[2])!=null&&d[0]&&Ho(u[2][0].data)==a)}),s=ze(e[3][i].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(l){return mn(ze(l.data)[1][0].data)!=n}),e[3][i].data=We(s)}function Eq(e,t,r){var n=-1,a=-1,i={};ht(e,t,1,function(c,d){var u=ze(c.messages[0].data);n=Gt(ze(c.messages[0].data)[1][0].data),a=Yn({deps:[1],location:t[n].location,type:2},t),i[n]=a,Er(c,a),u[1].push({type:2,data:Tr(a)});var f=Xn(e,t,n);f.id=a,t[1].location==t[a].location?d.push(f):ht(e,t,a,function(h,m){return m.push(f)}),c.messages[0].data=We(u)});var s=-1;ht(e,t,a,function(c,d){for(var u=ze(c.messages[0].data),f=3;f<=69;++f)delete u[f];var h=cu(u[2],Gt);h.forEach(function(x){return la(c,x)}),s=Yn({deps:[a],location:t[h[0]].location,type:t[h[0]].type},t),Er(c,s),i[h[0]]=s,u[2]=[{type:2,data:Tr(s)}];var m=Xn(e,t,h[0]);m.id=s,t[h[0]].location==t[a].location?d.push(m):(ht(e,t,2,function(x){var g=ze(x.messages[0].data);Jr(g,t,a,s),x.messages[0].data=We(g)}),ht(e,t,s,function(x,g){return g.push(m)})),c.messages[0].data=We(u)});var l=-1;ht(e,t,s,function(c,d){for(var u=ze(c.messages[0].data),f=ze(u[1][0].data),h=3;h<=69;++h)delete f[h];var m=Gt(f[2][0].data);f[2][0].data=Tr(i[m]),u[1][0].data=We(f);var x=Gt(u[2][0].data);la(c,x),l=Yn({deps:[s],location:t[x].location,type:t[x].type},t),Er(c,l),i[x]=l,u[2][0].data=Tr(l);var g=Xn(e,t,x);g.id=l,t[s].location==t[l].location?d.push(g):ht(e,t,l,function(v,y){return y.push(g)}),c.messages[0].data=We(u)}),ht(e,t,l,function(c,d){var u,f,h=ze(c.messages[0].data),m=Ho(h[1][0].data),x=m.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(h[1][0].data=Fr(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(_){return delete h[_]}),h[45]){var g=ze(h[45][0].data),v=Gt(g[1][0].data);la(c,v),delete h[45]}if(h[70]){var y=ze(h[70][0].data);(u=y[2])==null||u.forEach(function(_){var E=ze(_.data);[2,3].map(function(S){return E[S][0]}).forEach(function(S){var j=ze(S.data);if(j[8]){var P=Gt(j[8][0].data);la(c,P)}})}),delete h[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(_){if(h[_]){var E=Gt(h[_][0].data);delete h[_],la(c,E)}});var b=ze(h[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(_){var E;if((E=b[_])!=null&&E[0]){var S=Gt(b[_][0].data),j=Yn({deps:[l],location:t[S].location,type:t[S].type},t);la(c,S),Er(c,j),i[S]=j;var P=Xn(e,t,S);if(P.id=j,t[S].location==t[l].location)d.push(P);else{t[j].location=t[S].location.replace(S.toString(),j.toString()),t[j].location==t[S].location&&(t[j].location=t[j].location.replace(/\.iwa/,"-".concat(j,".iwa"))),vt.utils.cfb_add(e,t[j].location,hs(fs([P])));var C=t[j].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");ht(e,t,2,function(T){var k=ze(T.messages[0].data);Ih(k,j,C),Jr(k,t,l,j),T.messages[0].data=We(k)})}b[_][0].data=Tr(j)}});var w=ze(b[1][0].data);(f=w[2])==null||f.forEach(function(_){var E=Gt(_.data),S=Yn({deps:[l],location:t[E].location,type:t[E].type},t);la(c,E),Er(c,S),i[E]=S;var j=Xn(e,t,E);if(j.id=S,t[E].location==t[l].location)d.push(j);else{t[S].location=t[E].location.replace(E.toString(),S.toString()),t[S].location==t[E].location&&(t[S].location=t[S].location.replace(/\.iwa/,"-".concat(S,".iwa"))),vt.utils.cfb_add(e,t[S].location,hs(fs([j])));var P=t[S].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");ht(e,t,2,function(C){var T=ze(C.messages[0].data);Ih(T,S,P),Jr(T,t,l,S),C.messages[0].data=We(T)})}_.data=Tr(S)}),b[1][0].data=We(w);var N=ze(b[3][0].data);N[1].forEach(function(_){var E=ze(_.data),S=Gt(E[2][0].data),j=i[S];if(!i[S]){j=Yn({deps:[l],location:"",type:t[S].type},t),t[j].location="Root Entry/Index/Tables/Tile-".concat(j,".iwa"),i[S]=j;var P=Xn(e,t,S);P.id=j,la(c,S),Er(c,j),vt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(j,".iwa"),hs(fs([P]))),ht(e,t,2,function(C){var T=ze(C.messages[0].data);T[3].push({type:2,data:We([[],[{type:0,data:$e(j)}],[{type:2,data:Fr("Tables/Tile")}],[{type:2,data:Fr("Tables/Tile-".concat(j))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:$e(0)}],[],[{type:0,data:$e(0)}]])}),T[1]=[{type:0,data:$e(Math.max(j+1,mn(T[1][0].data)))}],Jr(T,t,l,j),C.messages[0].data=We(T)})}E[2][0].data=Tr(j),_.data=We(E)}),b[3][0].data=We(N)}h[4][0].data=We(b),c.messages[0].data=We(h)})}function Tq(e,t,r,n,a,i){var s=[];ht(e,t,i,function(d){var u=ze(d.messages[0].data);u[1]=[{type:2,data:Fr(n)}],s=cu(u[2],Gt),d.messages[0].data=We(u)});var l=Xn(e,t,s[0]),c=Gt(ze(l.messages[0].data)[2][0].data);ht(e,t,c,function(d,u){return Cq(e,t,r,d,u,c)})}function Cq(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=gr(r["!ref"]);s.s.r=s.s.c=0;var l=!1;s.e.c>999&&(l=!0,s.e.c=999),s.e.r>999999&&(l=!0,s.e.r=999999),l&&console.error("Truncating to ".concat(Zt(s)));var c=[];if(r["!data"])c=r["!data"];else{for(var d=[],u=0;u<=s.e.c;++u)d[u]=pt(u);for(var f=0;f<=s.e.r;++f){c[f]=[];var h=""+(f+1);for(u=0;u<=s.e.c;++u){var m=r[d[u]+h];m&&(c[f][u]=m)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},g=ze(n.messages[0].data);{g[6][0].data=$e(s.e.r+1),g[7][0].data=$e(s.e.c+1),delete g[46];var v=ze(g[4][0].data);{var y=Gt(ze(v[1][0].data)[2][0].data);ht(e,t,y,function(de,pe){var _e,q=ze(de.messages[0].data);if((_e=q?.[2])!=null&&_e[0])for(var oe=0;oe<c.length;++oe){var ve=ze(q[2][0].data);ve[1][0].data=$e(oe),ve[4][0].data=$e(c[oe].length),q[2][oe]={type:q[2][0].type,data:We(ve)}}de.messages[0].data=We(q)});var b=Gt(v[2][0].data);ht(e,t,b,function(de,pe){for(var _e=ze(de.messages[0].data),q=0;q<=s.e.c;++q){var oe=ze(_e[2][0].data);oe[1][0].data=$e(q),oe[4][0].data=$e(s.e.r+1),_e[2][q]={type:_e[2][0].type,data:We(oe)}}de.messages[0].data=We(_e)});var w=ze(v[9][0].data);w[1]=[];var N=ze(v[3][0].data);{var _=256;N[2]=[{type:0,data:$e(_)}];var E=Gt(ze(N[1][0].data)[2][0].data),S=(function(){var de=Xn(e,t,2),pe=ze(de.messages[0].data),_e=pe[3].filter(function(q){return mn(ze(q.data)[1][0].data)==E});return _e?.length?mn(ze(_e[0].data)[12][0].data):0})();vt.utils.cfb_del(e,t[E].location),ht(e,t,2,function(de){var pe=ze(de.messages[0].data);pe[3]=pe[3].filter(function(_e){return mn(ze(_e.data)[1][0].data)!=E}),Sq(pe,t,i,E),de.messages[0].data=We(pe)}),la(n,E),N[1]=[];for(var j=Math.ceil((s.e.r+1)/_),P=0;P<j;++P){var C=Yn({deps:[],location:"",type:6002},t);t[C].location="Root Entry/Index/Tables/Tile-".concat(C,".iwa");for(var T=[[],[{type:0,data:$e(0)}],[{type:0,data:$e(Math.min(s.e.r+1,(P+1)*_))}],[{type:0,data:$e(0)}],[{type:0,data:$e(Math.min((P+1)*_,s.e.r+1)-P*_)}],[],[{type:0,data:$e(5)}],[{type:0,data:$e(1)}],[{type:0,data:$e(1)}]],k=P*_;k<=Math.min(s.e.r,(P+1)*_-1);++k){var W=wq(c[k],x);W[1][0].data=$e(k-P*_),T[5].push({data:We(W),type:2})}N[1].push({type:2,data:We([[],[{type:0,data:$e(P)}],[{type:2,data:Tr(C)}]])});var G={id:C,messages:[Rh(6002,We(T))]},K=hs(fs([G]));vt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(C,".iwa"),K),ht(e,t,2,function(de){var pe=ze(de.messages[0].data);pe[3].push({type:2,data:We([[],[{type:0,data:$e(C)}],[{type:2,data:Fr("Tables/Tile")}],[{type:2,data:Fr("Tables/Tile-".concat(C))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:$e(0)}],[],[{type:0,data:$e(S)}]])}),pe[1]=[{type:0,data:$e(Math.max(C+1,mn(pe[1][0].data)))}],Jr(pe,t,i,C),de.messages[0].data=We(pe)}),Er(n,C),w[1].push({type:2,data:We([[],[{type:0,data:$e(P*_)}],[{type:0,data:$e(P)}]])})}}if(v[3][0].data=We(N),v[9][0].data=We(w),v[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var J=Yn({type:6144,deps:[i],location:t[i].location},t);a.push({id:J,messages:[Rh(6144,We([[],r["!merges"].map(function(de){return{type:2,data:We([[],[{type:2,data:We([[],[{type:5,data:new Uint8Array(new Uint16Array([de.s.r,de.s.c]).buffer)}]])}],[{type:2,data:We([[],[{type:5,data:new Uint8Array(new Uint16Array([de.e.r-de.s.r+1,de.e.c-de.s.c+1]).buffer)}]])}]])}})]))]}),v[13]=[{type:2,data:Tr(J)}],ht(e,t,2,function(de){var pe=ze(de.messages[0].data);Jr(pe,t,i,J),de.messages[0].data=We(pe)}),Er(n,J)}else delete v[13];var V=Gt(v[4][0].data);ht(e,t,V,function(de){var pe=ze(de.messages[0].data);pe[3]=[],x.sst.forEach(function(_e,q){q!=0&&pe[3].push({type:2,data:We([[],[{type:0,data:$e(q)}],[{type:0,data:$e(1)}],[{type:2,data:Fr(_e)}]])})}),de.messages[0].data=We(pe)});var Z=Gt(v[17][0].data);if(ht(e,t,Z,function(de){var pe=ze(de.messages[0].data);pe[3]=[];var _e=[904980,903835,903815,903845];x.rsst.forEach(function(q,oe){if(oe!=0){var ve=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Fr(q.v)}]];ve[10]=[{type:0,data:new Uint8Array([1])}],ve[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],ve[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],ve[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],ve[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],ve[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],ve[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],ve[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],ve[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var O=Yn({deps:[],location:"",type:2001},t),D=[];if(q.l){var M=di(e,2032,[[],[],[{type:2,data:Fr(q.l)}]],"/Index/Tables/DataList",t);ve[11]=[];var I=[[],[]];I[1]||(I[1]=[]),I[1].push({type:2,data:We([[],[{type:0,data:$e(0)}],[{type:2,data:Tr(M)}]])}),ve[11][0]={type:2,data:We(I)},D.push(M)}di(e,2001,ve,"/Index/Tables/DataList",t,O),ht(e,t,O,function(se){_e.forEach(function(ce){return Er(se,ce)}),D.forEach(function(ce){return Er(se,ce)})});var z=di(e,6218,[[],[{type:2,data:Tr(O)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);ht(e,t,z,function(se){return Er(se,O)}),pe[3].push({type:2,data:We([[],[{type:0,data:$e(oe)}],[{type:0,data:$e(1)}],[],[],[],[],[],[],[{type:2,data:Tr(z)}]])}),Er(de,z),ht(e,t,2,function(se){var ce=ze(se.messages[0].data);Jr(ce,t,Z,z),Jr(ce,t,z,O),Jr(ce,t,O,D),Jr(ce,t,O,_e),se.messages[0].data=We(ce)})}}),de.messages[0].data=We(pe)}),x.cmnt.length>1){var Q=Gt(v[19][0].data),Y={},le=0;ht(e,t,Q,function(de){var pe=ze(de.messages[0].data);pe[3]=[],x.cmnt.forEach(function(_e,q){if(q!=0){var oe=[];_e.replies&&_e.replies.forEach(function(D){Y[D.a||""]||(Y[D.a||""]=di(e,212,[[],[{type:2,data:Fr(D.a||"")}],[{type:2,data:Zb(++le)}],[],[{type:0,data:$e(0)}]],"/Index/Tables/DataList",t));var M=Y[D.a||""],I=di(e,3056,[[],[{type:2,data:Fr(D.t||"")}],[{type:2,data:We([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Tr(M)}]],"/Index/Tables/DataList",t);ht(e,t,I,function(z){return Er(z,M)}),oe.push(I),ht(e,t,2,function(z){var se=ze(z.messages[0].data);Jr(se,t,I,M),z.messages[0].data=We(se)})}),Y[_e.a||""]||(Y[_e.a||""]=di(e,212,[[],[{type:2,data:Fr(_e.a||"")}],[{type:2,data:Zb(++le)}],[],[{type:0,data:$e(0)}]],"/Index/Tables/DataList",t));var ve=Y[_e.a||""],O=di(e,3056,[[],[{type:2,data:Fr(_e.t||"")}],[{type:2,data:We([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Tr(ve)}],oe.map(function(D){return{type:2,data:Tr(D)}}),[{type:2,data:We([[],[{type:0,data:$e(q)}],[{type:0,data:$e(0)}]])}]],"/Index/Tables/DataList",t);ht(e,t,O,function(D){Er(D,ve),oe.forEach(function(M){return Er(D,M)})}),pe[3].push({type:2,data:We([[],[{type:0,data:$e(q)}],[{type:0,data:$e(1)}],[],[],[],[],[],[],[],[{type:2,data:Tr(O)}]])}),Er(de,O),ht(e,t,2,function(D){var M=ze(D.messages[0].data);Jr(M,t,Q,O),Jr(M,t,O,ve),oe.length&&Jr(M,t,O,oe),D.messages[0].data=We(M)})}}),pe[2][0].data=$e(x.cmnt.length+1),de.messages[0].data=We(pe)})}}g[4][0].data=We(v)}n.messages[0].data=We(g)}function jq(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function xx(e){jq([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Aq(e,t){e&&!e.SSF&&(e.SSF=Rr(St)),e&&e.SSF&&(ad(),nd(e.SSF),t.revssf=id(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=eT();xx(t=t||{});var i=rx(),s="",l=0;if(t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Qe(i,s,aT(e.Props,t)),a.coreprops.push(s),ot(t.rels,2,s,nt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(i,s,sT(e.Props)),a.extprops.push(s),ot(t.rels,3,s,nt.EXT_PROPS),e.Custprops!==e.Props&&qt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Qe(i,s,oT(e.Custprops)),a.custprops.push(s),ot(t.rels,4,s,nt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,Qe(i,s,uX(l-1,t,e,f)),a.sheets.push(s),ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(h){var x=h["!comments"],g=!1,v="";if(x&&x.length>0){var y=!1;x.forEach(function(w){w[1].forEach(function(N){N.T==!0&&(y=!0)})}),y&&(v="xl/threadedComments/threadedComment"+l+".xml",Qe(i,v,wT(x,u,t)),a.threadedcomments.push(v),ot(f,-1,"../threadedComments/threadedComment"+l+".xml",nt.TCMNT)),v="xl/comments"+l+"."+r,Qe(i,v,eV(x)),a.comments.push(v),ot(f,-1,"../comments"+l+"."+r,nt.CMNT),g=!0}h["!legacy"]&&g&&Qe(i,"xl/drawings/vmlDrawing"+l+".vml",bT(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Qe(i,rT(s),us(f))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Qe(i,s,uz(t.Strings)),a.strs.push(s),ot(t.wbrels,-1,"sharedStrings."+r,nt.SST)),s="xl/workbook."+r,Qe(i,s,PX(e)),a.workbooks.push(s),ot(t.rels,1,s,nt.WB),s="xl/theme/theme1.xml";var b=yT(e.Themes,t);return Qe(i,s,b),a.themes.push(s),ot(t.wbrels,-1,"theme/theme1.xml",nt.THEME),s="xl/styles."+r,Qe(i,s,Lz(e,t)),a.styles.push(s),ot(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Qe(i,s,e.vbaraw),a.vba.push(s),ot(t.wbrels,-1,"vbaProject.bin",nt.VBA)),s="xl/metadata."+r,Qe(i,s,Vz()),a.metadata.push(s),ot(t.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(s="xl/persons/person.xml",Qe(i,s,NT(u)),a.people.push(s),ot(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Qe(i,"[Content_Types].xml",tT(a,t)),Qe(i,"_rels/.rels",us(t.rels)),Qe(i,"xl/_rels/workbook."+r+".rels",us(t.wbrels)),delete t.revssf,delete t.ssf,i}function kq(e,t){e&&!e.SSF&&(e.SSF=Rr(St)),e&&e.SSF&&(ad(),nd(e.SSF),t.revssf=id(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=rV.indexOf(t.bookType)>-1,a=eT();xx(t=t||{});var i=rx(),s="",l=0;if(t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Qe(i,s,aT(e.Props,t)),a.coreprops.push(s),ot(t.rels,2,s,nt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(i,s,sT(e.Props)),a.extprops.push(s),ot(t.rels,3,s,nt.EXT_PROPS),e.Custprops!==e.Props&&qt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Qe(i,s,oT(e.Custprops)),a.custprops.push(s),ot(t.rels,4,s,nt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,Qe(i,s,ZG(l-1,t,e,f)),a.sheets.push(s),ot(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(h){var x=h["!comments"],g=!1,v="";if(x&&x.length>0){var y=!1;x.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(v="xl/threadedComments/threadedComment"+l+".xml",Qe(i,v,wT(x,u,t)),a.threadedcomments.push(v),ot(f,-1,"../threadedComments/threadedComment"+l+".xml",nt.TCMNT)),v="xl/comments"+l+"."+r,Qe(i,v,qz(x)),a.comments.push(v),ot(f,-1,"../comments"+l+"."+r,nt.CMNT),g=!0}h["!legacy"]&&g&&Qe(i,"xl/drawings/vmlDrawing"+l+".vml",bT(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Qe(i,rT(s),us(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Qe(i,s,sz(t.Strings,t)),a.strs.push(s),ot(t.wbrels,-1,"sharedStrings."+r,nt.SST)),s="xl/workbook."+r,Qe(i,s,gX(e)),a.workbooks.push(s),ot(t.rels,1,s,nt.WB),s="xl/theme/theme1.xml",Qe(i,s,yT(e.Themes,t)),a.themes.push(s),ot(t.wbrels,-1,"theme/theme1.xml",nt.THEME),s="xl/styles."+r,Qe(i,s,gz(e,t)),a.styles.push(s),ot(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Qe(i,s,e.vbaraw),a.vba.push(s),ot(t.wbrels,-1,"vbaProject.bin",nt.VBA)),s="xl/metadata."+r,Qe(i,s,Gz()),a.metadata.push(s),ot(t.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(s="xl/persons/person.xml",Qe(i,s,NT(u)),a.people.push(s),ot(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Qe(i,"[Content_Types].xml",tT(a,t)),Qe(i,"_rels/.rels",us(t.rels)),Qe(i,"xl/_rels/workbook."+r+".rels",us(t.wbrels)),delete t.revssf,delete t.ssf,i}function Pq(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function WT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return dl(t.file,vt.write(e,{type:lt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return vt.write(e,t)}function Oq(e,t){switch(t.bookType){case"ods":return $T(e,t);case"numbers":return _q(e,t);case"xlsb":return Aq(e,t);default:return kq(e,t)}}function Dq(e,t){var r=Rr(t||{}),n=Oq(e,r);return Rq(n,r)}function Rq(e,t){var r={},n=lt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?vt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(rd(a))}return t.password&&typeof encrypt_agile<"u"?WT(encrypt_agile(a,t.password),t):t.type==="file"?dl(t.file,a):t.type=="string"?cs(a):a}function Iq(e,t){var r=t||{},n=zX(e,r);return WT(n,r)}function zn(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Xc(Mo(n));case"binary":return Mo(n);case"string":return e;case"file":return dl(t.file,n,"utf8");case"buffer":return lt?ia(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):zn(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Fq(e,t){switch(t.type){case"base64":return FH(e);case"binary":return e;case"string":return e;case"file":return dl(t.file,e,"binary");case"buffer":return lt?ia(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ql(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Xc(r):t.type=="string"?cs(r):r;case"file":return dl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function KT(e,t){IH(),xX(e);var r=Rr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=KT(e,r);return r.type="array",rd(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return zn(WX(e,r),r);case"slk":case"sylk":return zn(rz.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return zn(MT(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Fq(zT(e.Sheets[e.SheetNames[a]],r),r);case"csv":return zn(gx(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return zn(nz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return ql(tz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return zn(az.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return zn(fz(e.Sheets[e.SheetNames[a]]),r);case"eth":return zn(mT.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return zn($T(e,r),r);case"wk1":return ql(Bb.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return ql(Bb.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ql(FT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Iq(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Dq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Mq(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Lq(e,t,r){var n=r||{};return n.type="file",n.file=t,Mq(n),KT(e,n)}function Bq(e,t,r,n,a,i,s){var l=gt(r),c=s.defval,d=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),u=!0,f=e["!data"]!=null,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!f||e["!data"][r])for(var m=t.s.c;m<=t.e.c;++m){var x=f?(e["!data"][r]||[])[m]:e[n[m]+l];if(x==null||x.t===void 0){if(c===void 0)continue;i[m]!=null&&(h[i[m]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!Fi(x.z)||(g=ls(g),typeof g=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(g=Ss(new Date(g)));break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(g==null)if(x.t=="e"&&g===null)h[i[m]]=null;else if(c!==void 0)h[i[m]]=c;else if(d&&g===null)h[i[m]]=null;else continue;else h[i[m]]=(x.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:d)?g:ka(x,g,s);g!=null&&(u=!1)}}return{row:h,isempty:u}}function Fh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Et(u);break;case"number":c=Et(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var f=gt(c.s.r),h=[],m=[],x=0,g=0,v=e["!data"]!=null,y=c.s.r,b=0,w={};v&&!e["!data"][y]&&(e["!data"][y]=[]);var N=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(N[b]||{}).hidden)switch(h[b]=pt(b),r=v?e["!data"][y][b]:e[h[b]+f],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=d.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=ka(r,null,d),g=w[s]||0,!g)w[s]=1;else{do l=s+"_"+g++;while(w[l]);w[s]=g,w[l]=1}i[b]=l}for(y=c.s.r+a;y<=c.e.r;++y)if(!(_[y]||{}).hidden){var E=Bq(e,c,y,h,n,i,d);(E.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[x++]=E.row)}return m.length=x,m}var Jb=/"/g;function $q(e,t,r,n,a,i,s,l,c){for(var d=!0,u=[],f="",h=gt(r),m=e["!data"]!=null,x=m&&e["!data"][r]||[],g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=m?x[g]:e[n[g]+h];if(v==null)f="";else if(v.v!=null){d=!1,f=""+(c.rawNumbers&&v.t=="n"?v.v:ka(v,null,c));for(var y=0,b=0;y!==f.length;++y)if((b=f.charCodeAt(y))===a||b===i||b===34||c.forceQuotes){f='"'+f.replace(Jb,'""')+'"';break}f=="ID"&&l==0&&u.length==0&&(f='"ID"')}else v.f!=null&&!v.F?(d=!1,f="="+v.f,f.indexOf(",")>=0&&(f='"'+f.replace(Jb,'""')+'"')):f="";u.push(f)}if(c.strip)for(;u[u.length-1]==="";)--u.length;return c.blankrows===!1&&d?null:u.join(s)}function gx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=Et(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d="",u=[],f=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(f[m]||{}).hidden||(u[m]=pt(m));for(var x=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(d=$q(e,a,g,u,s,c,i,x,n),d!=null&&(d||n.blankrows!==!1)&&r.push((x++?l:"")+d));return r.join("")}function zT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=gx(e,t);return r}function Uq(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=Et(e["!ref"]),s="",l=[],c,d=[],u=e["!data"]!=null;for(c=i.s.c;c<=i.e.c;++c)l[c]=pt(c);for(var f=i.s.r;f<=i.e.r;++f)for(s=gt(f),c=i.s.c;c<=i.e.c;++c)if(r=l[c]+s,n=u?(e["!data"][f]||[])[c]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}d[d.length]=r+"="+a}return d}function VT(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var l=0,c=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?kt(n.origin):n.origin;l=d.r,c=d.c}var u={s:{c:0,r:0},e:{c,r:l+t.length-1+i}};if(s["!ref"]){var f=Et(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),l==-1&&(l=f.e.r+1,u.e.r=l+t.length-1+i)}else l==-1&&(l=0,u.e.r=t.length-1+i);var h=n.header||[],m=0,x=[];t.forEach(function(v,y){a&&!s["!data"][l+y+i]&&(s["!data"][l+y+i]=[]),a&&(x=s["!data"][l+y+i]),qt(v).forEach(function(b){(m=h.indexOf(b))==-1&&(h[m=h.length]=b);var w=v[b],N="z",_="",E=a?"":pt(c+m)+gt(l+y+i),S=a?x[c+m]:s[E];w&&typeof w=="object"&&!(w instanceof Date)?a?x[c+m]=w:s[E]=w:(typeof w=="number"?N="n":typeof w=="boolean"?N="b":typeof w=="string"?N="s":w instanceof Date?(N="d",n.UTC||(w=sd(w)),n.cellDates||(N="n",w=yr(w)),_=S!=null&&S.z&&Fi(S.z)?S.z:n.dateNF||St[14]):w===null&&n.nullError&&(N="e",w=0),S?(S.t=N,S.v=w,delete S.w,delete S.R,_&&(S.z=_)):a?x[c+m]=S={t:N,v:w}:s[E]=S={t:N,v:w},_&&(S.z=_))})}),u.e.c=Math.max(u.e.c,c+h.length-1);var g=gt(l);if(a&&!s["!data"][l]&&(s["!data"][l]=[]),i)for(m=0;m<h.length;++m)a?s["!data"][l][m+c]={t:"s",v:h[m]}:s[pt(m+c)+g]={t:"s",v:h[m]};return s["!ref"]=Zt(u),s}function Hq(e,t){return VT(null,e,t)}function fu(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=kt(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?fu(e,Mt(t)):fu(e,pt(r||0)+gt(t))}function Wq(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Kq(e,t){var r={SheetNames:[],Sheets:{}};return e&&vx(r,e,t||"Sheet1"),r}function vx(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var s=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(DT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zq(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Wq(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Vq(e,t){return e.z=t,e}function GT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Gq(e,t,r){return GT(e,"#"+t,r)}function Yq(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Xq(e,t,r,n){for(var a=typeof t!="string"?t:Et(t),i=typeof t=="string"?t:Zt(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=fu(e,s,l);c.t="n",c.F=i,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}var d=gr(e["!ref"]);return d.s.r>a.s.r&&(d.s.r=a.s.r),d.s.c>a.s.c&&(d.s.c=a.s.c),d.e.r<a.e.r&&(d.e.r=a.e.r),d.e.c<a.e.c&&(d.e.c=a.e.c),e["!ref"]=Zt(d),e}var Mh={encode_col:pt,encode_row:gt,encode_cell:Mt,encode_range:Zt,decode_col:lx,decode_row:ox,split_cell:KW,decode_cell:kt,decode_range:gr,format_cell:ka,sheet_new:zW,sheet_add_aoa:XE,sheet_add_json:VT,sheet_add_dom:LT,aoa_to_sheet:$s,json_to_sheet:Hq,table_to_sheet:BT,table_to_book:mq,sheet_to_csv:gx,sheet_to_txt:zT,sheet_to_json:Fh,sheet_to_html:MT,sheet_to_formulae:Uq,sheet_to_row_object_array:Fh,sheet_get_cell:fu,book_new:Kq,book_append_sheet:vx,book_set_sheet_visibility:zq,cell_set_number_format:Vq,cell_set_hyperlink:GT,cell_set_internal_link:Gq,cell_add_comment:Yq,sheet_set_array_formula:Xq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const hu=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",qq=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")} VND`:"0 VND",Zq=e=>{if(!e)return null;const t=e.match(/nhan tu\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},Ko=e=>Zq(e.note)||e.sender||"",Lh=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},Jq=[{value:"receipt",label:"Biên Nhận",description:"Mã đơn bắt đầu bằng MAV"},{value:"refund",label:"Hoàn tiền",description:"Các biên nhận khác"}],Vn={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankBin:"970432"},Tf=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return null;const[,r,n,a]=t.map(Number);return new Date(a,n-1,r).getTime()},Qq=e=>{const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return e;const[,r,n,a]=t;return`${a}/${n}/${r}`},eZ=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return"";const[,r,n,a]=t;return`${a}-${n}-${r}`},tZ=e=>{const t=r=>typeof r=="string"?r:"";return{id:Number(e?.id)||0,orderCode:t(e?.orderCode??e?.[Yi.orderCode]),paidAt:t(e?.paidAt??e?.[Yi.paidDate]),amount:Number(e?.amount??e?.[Yi.amount])||0,sender:t(e?.sender??e?.[Yi.sender]),receiver:t(e?.receiver??e?.[Yi.receiver]),note:t(e?.note??e?.[Yi.note])}},rZ=e=>{const t=["#","Mã đơn","Người gửi","Người nhận","Số tiền gốc","Số tiền định dạng","Nội dung chuyển khoản","Ngày thanh toán","Nhóm"],r=e.map((a,i)=>[i+1,a.orderCode||"",Ko(a),a.receiver||"",a.amount,hu(a.amount),a.note||"",a.paidAt?Ot(a.paidAt):"",Lh(a.orderCode)==="receipt"?"Biên nhận":"Hoàn tiền"]),n=Mh.aoa_to_sheet([t,...r]);return n["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}],n},nZ=({stats:e})=>o.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e.map(t=>o.jsx(pa,{title:t.name,value:t.value,icon:t.icon,accent:t.accent},t.name))})}),aZ=({searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:n,dateRangeDisplay:a,rangePickerOpen:i,setRangePickerOpen:s,dateRangeRef:l,toDisplayDate:c,toISODate:d,onDateStartChange:u,onDateEndChange:f,onExport:h,exportDisabled:m})=>o.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4 relative z-50",children:o.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(Bi,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx("input",{type:"text",placeholder:"Tìm mã đơn, người gửi hoặc ghi chú...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 bg-gray-50/60 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:e,onChange:x=>t(x.target.value)})]}),o.jsxs("div",{className:"relative z-[120] flex items-stretch",ref:l,children:[o.jsxs("button",{type:"button",onClick:()=>s(!i),className:`flex items-center justify-between gap-3 px-4 py-3 rounded-2xl border transition w-full lg:w-64 ${i?"border-indigo-400/70 bg-indigo-900/60 shadow-[0_10px_30px_-18px_rgba(79,70,229,0.65)]":"border-white/15 bg-slate-900/70 text-white hover:bg-slate-800/70 shadow-[0_10px_26px_-18px_rgba(0,0,0,0.65)]"} text-white`,children:[o.jsx("div",{className:"flex flex-col text-left",children:o.jsx("span",{className:"text-sm font-medium",children:a})}),o.jsx(ew,{className:`w-5 h-5 ${i?"text-indigo-300":"text-slate-200"}`})]}),i&&o.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-80 bg-white border border-gray-200 rounded-2xl shadow-xl z-[150] p-4 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"Từ Ngày"}),o.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:d(r),onChange:x=>u(x.target.value?c(x.target.value):"")})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"Đến Ngày"}),o.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:d(n),onChange:x=>f(x.target.value?c(x.target.value):"")})]})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[o.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-800",onClick:()=>{u(""),f("")},children:"Xóa Khoảng"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 border border-gray-200 rounded-lg hover:bg-indigo-500/10",onClick:()=>s(!1),children:"Đóng"}),o.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",onClick:()=>s(!1),children:"Áp Dụng"})]})]})]})]}),o.jsx("button",{type:"button",onClick:h,disabled:m,className:`px-5 py-3 rounded-2xl bg-gray-900 text-white text-sm font-semibold transition-colors shadow-sm ${m?"opacity-60 cursor-not-allowed":"hover:bg-gray-700"}`,children:"Tải Về"})]})}),iZ=({activeCategory:e,counts:t,onChange:r})=>o.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-slate-800/75 via-slate-800/60 to-slate-900/80 border border-white/12 p-4 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.8),0_14px_36px_-28px_rgba(255,255,255,0.18)] backdrop-blur-sm flex flex-col sm:flex-row gap-3 text-slate-200",children:Jq.map(n=>{const a=e===n.value;return o.jsx("button",{type:"button",onClick:()=>r(n.value),className:`flex-1 min-w-[180px] text-left rounded-2xl border p-4 transition shadow-[0_12px_28px_-18px_rgba(0,0,0,0.65)] ${a?"bg-gradient-to-r from-indigo-500 to-violet-500 text-white border-white/50 shadow-[0_16px_45px_-22px_rgba(79,70,229,0.65)]":"bg-slate-800/70 text-slate-100 border-white/12 hover:bg-slate-700/70 hover:border-white/20"}`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-semibold drop-shadow-sm",children:n.label}),o.jsx("p",{className:"text-xs text-slate-300 mt-1",children:n.description})]}),o.jsx("span",{className:`text-lg font-semibold ${a?"text-white":"text-slate-100"}`,children:t[n.value]})]})},n.value)})}),sZ=({receipts:e,expandedReceiptId:t,onToggle:r,onSelectReceipt:n})=>o.jsx("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[o.jsx("thead",{className:"bg-slate-900/90",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Mã Đơn"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Người Gửi"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Người Nhận"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Số Tiền"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Nội Dung Chuyển Khoản"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngày Thanh Toán"})]})}),o.jsx("tbody",{className:"divide-y divide-white/10",children:e.map((a,i)=>{const s=t===a.id;return o.jsxs(ea.Fragment,{children:[o.jsxs("tr",{className:`transition ${i%2===0?"bg-slate-900/55":"bg-indigo-950/40"} hover:bg-indigo-600/25 ${s?"ring-2 ring-indigo-400/60":""} cursor-pointer`,onClick:()=>r(a.id),onDoubleClick:()=>n?n(a):void 0,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-semibold",children:a.orderCode||"--"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-white",children:Ko(a)||"--"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-white",children:a.receiver||Vn.accountNumber})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-white",children:hu(a.amount)}),o.jsx("td",{className:"px-6 py-4 text-sm text-white/90 max-w-xs",children:o.jsx("span",{className:"block truncate text-white/90",children:a.note||"--"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:a.paidAt?Ot(a.paidAt):"--"})]}),s&&o.jsx("tr",{className:"bg-indigo-900/35",children:o.jsx("td",{colSpan:6,className:"px-6 pb-5 pt-2",children:o.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-900/70 p-4 text-sm text-white/90 space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Mã đơn"}),o.jsx("p",{className:"font-semibold text-white",children:a.orderCode||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Người gửi"}),o.jsx("p",{className:"font-semibold text-white",children:Ko(a)||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Người nhận"}),o.jsx("p",{className:"font-semibold text-white",children:Vn.accountNumber})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Số tiền"}),o.jsx("p",{className:"font-semibold text-emerald-200",children:hu(a.amount)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Ngày thanh toán"}),o.jsx("p",{className:"font-semibold text-white",children:a.paidAt?Ot(a.paidAt):"--"})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-white/60",children:"Nội dung chuyển khoản"}),o.jsx("p",{className:"mt-1 rounded-xl bg-white/5 px-3 py-2 text-white",children:a.note||"Không có ghi chú"})]})]})})})]},a.id)})})]})})}),oZ=({open:e,amount:t,note:r,onClose:n,onAmountChange:a,onNoteChange:i})=>{const[s,l]=p.useState(t),[c,d]=p.useState(r);p.useEffect(()=>{e&&(l(t),d(r))},[e,t,r]);const u=p.useMemo(()=>{const v=s.replace(/[^\d]/g,"");if(!v)return 0;const y=Number(v);return Number.isFinite(y)?y:0},[s]),f=u>0?`${u.toLocaleString("vi-VN")} VND`:"Chưa Cập Nhật",h=p.useMemo(()=>qp({accountNumber:Vn.accountNumber,bankCode:Vn.bankBin,amount:u,description:c.trim()}),[u,c]),m=c.trim()||"Chưa có nội dung",x=()=>{const v=s.replace(/[^\d]/g,"");l(v),a(v)},g=()=>{const v=c.trim();d(v),i(v)};return e?o.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:o.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative",children:[o.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:n,children:o.jsx(Dt,{className:"h-6 w-6"})}),o.jsxs("div",{className:"px-6 py-10 space-y-6",children:[o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("h2",{className:"text-2xl font-semibold",children:"Tạo thông tin thanh toán qua QR Code"}),o.jsx("p",{className:"text-sm text-slate-300",children:"Quét mã QR để chuyển khoản nhanh. Nhập số tiền và nội dung để cập nhật chi tiết."})]}),o.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[o.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[o.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Quét mã QR để thanh toán"}),o.jsx("div",{className:"rounded-2xl bg-white p-4",children:o.jsx("img",{src:h,alt:"QR thanh toan",className:"h-64 w-64 object-contain"})}),o.jsx("a",{href:h,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400",children:"Tải ảnh QR"}),o.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[o.jsxs("p",{children:["Ngân hàng: ",o.jsx("span",{className:"font-semibold",children:Vn.bankName})]}),o.jsxs("p",{children:["Số tài khoản:"," ",o.jsx("span",{className:"font-semibold",children:Vn.accountNumber})]}),o.jsxs("p",{children:["Chủ tài khoản:"," ",o.jsx("span",{className:"font-semibold uppercase",children:Vn.accountHolder})]}),o.jsxs("p",{children:["Số tiền:"," ",o.jsx("span",{className:"font-semibold text-rose-200",children:f})]}),o.jsxs("p",{children:["Nội dung:"," ",o.jsx("span",{className:"font-semibold text-violet-200",children:m})]})]})]}),o.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[o.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[o.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngân hàng"}),o.jsx("p",{className:"text-lg font-semibold text-white",children:Vn.bankName})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[o.jsx("span",{children:"Thụ hưởng"}),o.jsx("span",{className:"font-semibold text-white",children:Vn.accountHolder})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm text-slate-300",children:"Số Tài Khoản"}),o.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:Vn.accountNumber})]})]}),o.jsxs("div",{className:"space-y-5",children:[o.jsxs("div",{children:[o.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:x,children:"+ Thêm số tiền"}),o.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[o.jsx("input",{type:"text",placeholder:"Ví dụ: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:s,onChange:v=>l(v.target.value),onBlur:x}),o.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:x,children:"OK"})]})]}),o.jsxs("div",{children:[o.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:g,children:"+ Thêm nội dung"}),o.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[o.jsx("input",{type:"text",placeholder:"Nhập nội dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:c,onChange:v=>d(v.target.value),onBlur:g}),o.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:g,children:"Lưu"})]})]})]})]})]})]})]})}):null},lZ=({open:e,receipt:t,onClose:r})=>!e||!t?null:o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl",children:[o.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[o.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tiet bien nhan"}),o.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Đóng",children:o.jsx(Dt,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"px-5 py-4 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Mã đơn"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.orderCode||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Ngày Thanh Toán"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.paidAt?Ot(t.paidAt):"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Người Gửi"}),o.jsx("p",{className:"font-semibold text-gray-900",children:Ko(t)||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Người Nhận"}),o.jsx("p",{className:"font-semibold text-gray-900",children:t.receiver||"--"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1",children:"Số Tiền"}),o.jsx("p",{className:"font-semibold text-gray-900",children:hu(t.amount)})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Nội Dung Chuyển Khoản"}),o.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:t.note||"Không có ghi chú"})]})]}),o.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:o.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"Đóng"})})]})});function cZ(){const[e,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState(""),[s,l]=p.useState("receipt"),[c,d]=p.useState([]),[u,f]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState(!1),[v,y]=p.useState(null),[b,w]=p.useState(!1),[N,_]=p.useState(""),[E,S]=p.useState(""),[j,P]=p.useState(null),C=p.useRef(null);p.useEffect(()=>{(async()=>{try{f(!0),m(null);const le=await Ze("/api/payment-receipts");if(!le.ok)throw new Error("Không thể tải biên nhận.");const de=await le.json(),pe=Array.isArray(de?.receipts)?de.receipts:Array.isArray(de)?de:[];d(pe.map(tZ))}catch(le){console.error(le),m(le instanceof Error?le.message:"Không thể tải biên nhận.")}finally{f(!1)}})()},[]);const T=p.useMemo(()=>{const Y=e.trim().toLowerCase(),le=Tf(r),de=Tf(a);return c.filter(pe=>{const _e=Lh(pe.orderCode),q=!Y||[pe.orderCode,pe.note,Ko(pe)].map(M=>M?.toLowerCase()??"").some(M=>M.includes(Y)),oe=Tf(Ot(pe.paidAt)||""),ve=le===null||oe===null||oe>=le,O=de===null||oe===null||oe<=de;return q&&ve&&O&&_e===s})},[c,e,r,a,s]),k=p.useMemo(()=>{const Y=c.reduce((de,pe)=>(pe.orderCode||"").toUpperCase().startsWith("MAV")?de+pe.amount:de,0),le=c.length>0?c[0].paidAt??"":"";return[{name:"Tổng Biên Nhận",value:c.length.toString(),icon:ms,accent:xr.sky},{name:"Tổng Số Tiền",value:qq(Y),icon:ms,accent:xr.emerald},{name:"Biên Nhận Gần Nhất",value:le?Ot(le)??"--":"--",icon:iw,accent:xr.violet}]},[c]),W=p.useMemo(()=>c.reduce((Y,le)=>{const de=Lh(le.orderCode);return Y[de]+=1,Y},{receipt:0,refund:0}),[c]),G=()=>{if(!T.length)return;const Y=rZ(T),le=Mh.book_new();Mh.book_append_sheet(le,Y,"Biên nhận thanh toán");const de=new Date().toISOString().slice(0,10).replace(/-/g,"");Lq(le,`payment_receipts_${de}.xlsx`)},K=u||T.length===0;p.useEffect(()=>{const Y=le=>{C.current&&!C.current.contains(le.target)&&g(!1)};return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[]);const J=r&&a?`${r} - ${a}`:"dd/mm/yyyy - dd/mm/yyyy",V=Y=>{y(le=>le===Y?null:Y)},Z=Y=>{P(Y)},Q=()=>{P(null)};return o.jsxs(o.Fragment,{children:[o.jsx(oZ,{open:b,amount:N,note:E,onClose:()=>w(!1),onAmountChange:_,onNoteChange:S}),o.jsx(lZ,{open:!!j,receipt:j,onClose:Q}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-white drop-shadow-sm",children:"Biên nhận thanh toán"}),o.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Theo dõi giao dịch chuyển khoản được lưu trong hệ thống"})]}),o.jsx(Qn,{icon:ta,className:"mt-4 sm:mt-0",onClick:()=>w(!0),children:"Thêm biên nhận"})]}),o.jsx(nZ,{stats:k}),o.jsx(aZ,{searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:a,dateRangeDisplay:J,rangePickerOpen:x,setRangePickerOpen:g,dateRangeRef:C,toDisplayDate:Qq,toISODate:eZ,onDateStartChange:n,onDateEndChange:i,onExport:G,exportDisabled:K}),h&&o.jsx("div",{className:"text-sm text-red-600 px-1",children:h}),o.jsx(iZ,{activeCategory:s,counts:W,onChange:l}),o.jsx(sZ,{receipts:T,expandedReceiptId:v,onToggle:V,onSelectReceipt:Z}),!u&&T.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không có Biên Nhận"}),o.jsx("div",{className:"text-white/60",children:"Thử từ khóa khác"})]}),u&&o.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"Đang tải dữ liệu..."})]})]})}const uZ=()=>o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx($h,{className:"h-7 w-7 text-indigo-300"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-white",children:"Lưu trữ"}),o.jsx("p",{className:"text-sm text-white/70",children:"Hàng đang còn tồn kho (chưa ghép vào đơn hàng)"})]})]}),dZ=({search:e,onSearchChange:t,onCreate:r,loading:n,error:a})=>o.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/5 shadow-lg shadow-indigo-900/40 p-4 space-y-3",children:o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3",children:[o.jsxs("div",{className:"flex-1 relative",children:[o.jsx(Bi,{className:"h-5 w-5 text-white/60 absolute left-3 top-2.5"}),o.jsx("input",{className:"w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60 pl-10",placeholder:"Tìm theo gói, tài khoản, nhà cung cấp...",value:e,onChange:s=>t(s.target.value)})]}),o.jsxs("button",{type:"button",onClick:r,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm font-semibold disabled:opacity-60",disabled:n,children:[o.jsx(ta,{className:"h-4 w-4"}),"Thêm mới"]}),n&&o.jsxs("div",{className:"text-sm text-white/80 flex items-center gap-2",children:[o.jsx("span",{className:"animate-spin h-4 w-4 rounded-full border-2 border-white/40 border-t-transparent"}),"Đang tải..."]}),a&&o.jsxs("div",{className:"text-sm text-rose-200 flex items-center gap-2",children:[o.jsx(zh,{className:"h-5 w-5"}),a]})]})}),fZ="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",Zl=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),hZ=({items:e,draft:t,editingId:r,loading:n,onDraftChange:a,onSave:i,onDelete:s,onCancel:l,onStartEdit:c})=>{const d=(u,f)=>o.jsx("input",{className:`${fZ} bg-white/10 border-white/20`,value:f||"",onChange:h=>a(u,h.target.value)});return o.jsx("div",{className:"overflow-auto rounded-xl border border-white/10 bg-white/5",children:o.jsxs("table",{className:"min-w-full text-sm text-white",children:[o.jsx("thead",{className:"bg-white/10 text-left",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Loại"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Tài khoản"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mật khẩu"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mail dự phòng"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"2FA"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Trạng thái"}),o.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ghi chú"}),o.jsx("th",{className:"px-4 py-2 font-semibold text-center",children:"Thao tác"})]})}),o.jsxs("tbody",{children:[r==="new"&&t&&o.jsxs("tr",{className:"border-t border-white/5 bg-white/5",children:[o.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:d("category",t.category)}),o.jsx("td",{className:"px-4 py-2",children:d("account",t.account)}),o.jsx("td",{className:"px-4 py-2",children:d("password",t.password)}),o.jsx("td",{className:"px-4 py-2",children:d("backup_email",t.backup_email)}),o.jsx("td",{className:"px-4 py-2",children:d("two_fa",t.two_fa)}),o.jsx("td",{className:"px-4 py-2",children:d("status",t.status)}),o.jsx("td",{className:"px-4 py-2",children:d("note",t.note)}),o.jsx("td",{className:"px-4 py-2 text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>i(void 0),disabled:n,title:"Lưu",children:o.jsx(Ga,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:l,disabled:n,title:"Hủy",children:o.jsx(Dt,{className:"h-4 w-4"})})]})})]}),e.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-white/70",children:"Không có hàng tồn kho"})}):e.map(u=>{const f=r===u.id,h=f&&t||u;return o.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[o.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:f?d("category",h.category):u.category||"N/A"}),o.jsx("td",{className:"px-4 py-2",children:f?d("account",h.account):o.jsx("div",{className:"font-medium",children:u.account||"Chưa có tài khoản"})}),o.jsx("td",{className:"px-4 py-2",children:f?d("password",h.password):u.password||o.jsx("span",{className:"text-white/60",children:"--"})}),o.jsx("td",{className:"px-4 py-2",children:f?d("backup_email",h.backup_email):u.backup_email||o.jsx("span",{className:"text-white/60",children:"--"})}),o.jsx("td",{className:"px-4 py-2",children:f?d("two_fa",h.two_fa):u.two_fa||o.jsx("span",{className:"text-white/60",children:"--"})}),o.jsx("td",{className:"px-4 py-2",children:f?d("status",h.status):o.jsx("span",{className:"inline-flex rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white",children:u.status||"--"})}),o.jsx("td",{className:"px-4 py-2",children:f?d("note",h.note):o.jsx("div",{className:"text-white/80 whitespace-pre-wrap break-words",children:u.note||"--"})}),o.jsx("td",{className:"px-4 py-2 text-center",children:o.jsx("div",{className:"inline-flex items-center gap-2",children:f?o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>i(u.id),disabled:n,title:"Lưu",children:o.jsx(Ga,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-rose-600/70 hover:bg-rose-600 text-white transition disabled:opacity-60",onClick:()=>s(u.id),disabled:n,title:"Xoá",children:o.jsx(Na,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:l,disabled:n,title:"Hủy",children:o.jsx(Dt,{className:"h-4 w-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-indigo-100 hover:text-white transition disabled:opacity-60",onClick:()=>c(u),disabled:n,title:"Sửa",children:o.jsx(zo,{className:"h-4 w-4"})}),o.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-rose-200 hover:text-rose-100 transition disabled:opacity-60",onClick:()=>s(u.id),disabled:n,title:"Xoá",children:o.jsx(Na,{className:"h-4 w-4"})})]})})})]},u.id??`${u.category??""}-${u.account??""}`)})]})]})})};function mZ(){const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),[s,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState(null);p.useEffect(()=>{let w=!0;const N=E=>E?Array.isArray(E)?E:Array.isArray(E.items)?E.items:[]:[];return(async()=>{n(!0),i(null);try{let E=await Ze(rt.WAREHOUSE);if(E.status===404&&(E=await Ze("/api/warehouses")),!E.ok)throw new Error(`Không thể tải dữ liệu (${E.status})`);const S=await E.json(),j=N(S);w&&t(j)}catch(E){w&&i(E?.message||"Lỗi không xác định")}finally{w&&n(!1)}})(),()=>{w=!1}},[]);const h=w=>{d(w.id??null),f({...w})},m=()=>{d(null),f(null)},x=(w,N)=>{f(_=>({..._||{},[w]:N}))},g=async w=>{if(!(!w&&c!=="new"||!u)){n(!0),i(null);try{if(c==="new"){const N=await Ze(rt.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!N.ok)throw new Error(`Tạo mới thất bại (${N.status})`);const _=await N.json();t(E=>[...E,_]),m()}else{const N=await Ze(`${rt.WAREHOUSE}/${w}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!N.ok)throw new Error(`Cập nhật thất bại (${N.status})`);const _=await N.json();t(E=>E.map(S=>S.id===w?{...S,..._}:S)),m()}}catch(N){i(N?.message||"Lỗi khi cập nhật")}finally{n(!1)}}},v=async w=>{if(w&&confirm("Bạn có chắc muốn xóa bản ghi này?")){n(!0),i(null);try{const N=await Ze(`${rt.WAREHOUSE}/${w}`,{method:"DELETE"});if(!N.ok)throw new Error(`Xoá thất bại (${N.status})`);t(_=>_.filter(E=>E.id!==w)),c===w&&m()}catch(N){i(N?.message||"Lỗi khi xóa")}finally{n(!1)}}},y=()=>{d("new"),f({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Tồn"})},b=p.useMemo(()=>({filtered:e.filter(N=>{if(!s.trim())return!0;const _=Zl(s);return[N.category,N.account,N.password,N.backup_email,N.two_fa,N.note,N.status].some(E=>Zl(E).includes(_))}).sort((N,_)=>{const E=Zl(N.category),S=Zl(_.category);return E.localeCompare(S,"vi")})}),[e,s]);return o.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[o.jsx(uZ,{}),o.jsx(dZ,{search:s,onSearchChange:l,onCreate:y,loading:r,error:a}),o.jsx(hZ,{items:b.filtered,draft:u,editingId:c,loading:r,onDraftChange:x,onSave:g,onDelete:v,onCancel:m,onStartEdit:h,onStartCreate:y})]})}class pZ extends p.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r})}handleReload=()=>{window.location.reload()};render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-red-100 p-4",children:o.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-xl p-8",children:[o.jsx("div",{className:"flex items-center justify-center w-16 h-16 mx-auto bg-red-100 rounded-full mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:"Đã xảy ra lỗi"}),o.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Ứng dụng gặp sự cố không mong muốn. Vui lòng thử tải lại trang."}),!1,o.jsxs("div",{className:"flex gap-4 justify-center",children:[o.jsx("button",{onClick:this.handleReload,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Tải lại trang"}),o.jsx("button",{onClick:()=>window.history.back(),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Quay lại"})]})]})}):this.props.children}}function xZ({children:e}){const{user:t,loading:r}=Yh(),n=Bh();return r?null:t?o.jsx(o.Fragment,{children:e}):o.jsx(Cf,{to:"/login",replace:!0,state:{from:n.pathname}})}function gZ(){const[e,t]=p.useState(!1);return o.jsx(pZ,{children:o.jsx(JT,{children:o.jsx(cj,{children:o.jsxs(bx,{children:[o.jsx(Xr,{path:"/login",element:o.jsx(ZU,{})}),o.jsx(Xr,{path:"/*",element:o.jsx(xZ,{children:o.jsxs("div",{className:"min-h-screen app-aurora",children:[o.jsx(hj,{isOpen:e,setIsOpen:t}),o.jsxs("div",{className:"transition-all duration-300 ease-in-out lg:ml-64 print-shell",children:[o.jsx("div",{className:"h-16 lg:hidden"}),o.jsx("main",{className:"p-0 pt-[10px] pl-[10px] max-w-none",children:o.jsxs(bx,{children:[o.jsx(Xr,{path:"/",element:o.jsx(Cf,{to:"/dashboard",replace:!0})}),o.jsx(Xr,{path:"/dashboard",element:o.jsx(FB,{})}),o.jsx(Xr,{path:"/orders",element:o.jsx(m$,{})}),o.jsx(Xr,{path:"/package-products",element:o.jsx(I$,{})}),o.jsx(Xr,{path:"/product-info",element:o.jsx(NU,{})}),o.jsx(Xr,{path:"/sources",element:o.jsx(hH,{})}),o.jsx(Xr,{path:"/pricing",element:o.jsx(VU,{})}),o.jsx(Xr,{path:"/bill-order",element:o.jsx(RH,{})}),o.jsx(Xr,{path:"/show-price",element:o.jsx(TH,{})}),o.jsx(Xr,{path:"/invoices",element:o.jsx(cZ,{})}),o.jsx(Xr,{path:"/warehouse",element:o.jsx(mZ,{})}),o.jsx(Xr,{path:"*",element:o.jsx(Cf,{to:"/dashboard",replace:!0})})]})})]})]})})})]})})})})}rC.createRoot(document.getElementById("root")).render(o.jsx(gZ,{}));
