import{r as md,a as sT,b as p,u as BN,c as pp,N as Kf,L as Qg,g as wi,d as $N,R as oT,e as lT,f as ua,h as UN,i as Jt,B as cT}from"./vendor-Ddpc7B7A.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var j0={exports:{}},Co={};var ev;function uT(){if(ev)return Co;ev=1;var e=md(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var u,h={},f=null,m=null;d!==void 0&&(f=""+d),c.key!==void 0&&(f=""+c.key),c.ref!==void 0&&(m=c.ref);for(u in c)n.call(c,u)&&!i.hasOwnProperty(u)&&(h[u]=c[u]);if(l&&l.defaultProps)for(u in c=l.defaultProps,c)h[u]===void 0&&(h[u]=c[u]);return{$$typeof:t,type:l,key:f,ref:m,props:h,_owner:a.current}}return Co.Fragment=r,Co.jsx=o,Co.jsxs=o,Co}var tv;function dT(){return tv||(tv=1,j0.exports=uT()),j0.exports}var s=dT(),tc={},rv;function hT(){if(rv)return tc;rv=1;var e=sT();return tc.createRoot=e.createRoot,tc.hydrateRoot=e.hydrateRoot,tc}var fT=hT();const mT=()=>{const e=p.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]);return s.jsxs(s.Fragment,{children:[s.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:s.jsxs("linearGradient",{id:e,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[s.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),s.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),s.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),s.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[s.jsx("div",{className:"retro-grid"}),s.jsx("div",{className:"retro-sun"}),s.jsx("div",{className:"retro-planet"}),s.jsx("div",{className:"retro-glow"})]})]})},pT=({children:e})=>s.jsxs("div",{className:"login-card retro-card",children:[s.jsx("div",{className:"login-card__header card-top",children:s.jsxs("div",{className:"login-card__title-wrap title",children:[s.jsx("p",{className:"login-card__eyebrow eyebrow",children:"Chào mừng trở lại"}),s.jsx("h1",{className:"login-card__title gradient-title",children:"Mavryk Premium"}),s.jsx("p",{className:"login-card__subtitle subtitle",children:"Nhập thông tin của bạn để vào trang quản trị."})]})}),e]}),xT=({email:e,password:t,loading:r,error:n,onEmailChange:a,onPasswordChange:i,onSubmit:o})=>s.jsxs("form",{className:"form",onSubmit:o,children:[s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Tài khoản"}),s.jsx("input",{type:"text",required:!0,value:e,onChange:l=>a(l.target.value),placeholder:"Nhập tên đăng nhập"})]}),s.jsxs("label",{className:"field",children:[s.jsx("span",{children:"Mật khẩu"}),s.jsx("input",{type:"password",required:!0,value:t,onChange:l=>i(l.target.value),placeholder:"Nhập mật khẩu"})]}),s.jsxs("div",{className:"controls",children:[s.jsxs("label",{className:"remember",children:[s.jsx("input",{type:"checkbox",defaultChecked:!0}),s.jsx("span",{children:"Ghi nhớ đăng nhập"})]}),s.jsx("button",{type:"button",className:"ghost",children:"Quên mật khẩu?"})]}),s.jsx("button",{type:"submit",className:"cta",disabled:r,children:r?"Đang đăng nhập...":"Đăng nhập"}),n&&s.jsx("p",{className:"error-msg",children:n})]}),gT={};var vT={};const bT=(()=>{const e=typeof import.meta<"u"&&gT?.VITE_API_BASE_URL||"";if(e)return e;const t=typeof process<"u"&&vT?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function yT(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const Cl=yT(bT),wT=e=>{if(e.startsWith("http"))return e;const t=Cl.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Ue(e,t){const r=wT(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(a){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw a}}async function NT(e=new Date().getFullYear()){const t=await Ue(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Không thể tải dữ liệu biểu đồ dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],a=l=>{const c=l.month||l.month_label||(Number.isFinite(l.month_num)?`T${l.month_num}`:"");return String(c||"").trim()},i=n.map(l=>({month:a(l),total_sales:Number(l.total_revenue??l.total_sales)||0})),o=n.map(l=>({month:a(l),total_orders:Number(l.total_orders)||0,total_canceled:Number(l.total_canceled)||0}));return{revenueData:i,orderStatusData:o,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function _T(){const e=await Ue("/api/dashboard/years");if(!e.ok)throw new Error("Lỗi khi tải danh sách năm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const HN=p.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),xp=()=>p.useContext(HN),jT=({children:e})=>{const[t,r]=p.useState(null),[n,a]=p.useState(!0),i=async()=>{try{const o=await Ue("/api/auth/me");if(!o.ok){r(null);return}const l=await o.json();r(l.user||null)}catch{r(null)}finally{a(!1)}};return p.useEffect(()=>{i()},[]),s.jsx(HN.Provider,{value:{user:t,setUser:r,loading:n,refresh:i},children:e})},ST=()=>{const[e,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState(null),[o,l]=p.useState(!1),{setUser:c}=xp(),d=BN();return{email:e,password:r,error:a,loading:o,setEmail:t,setPassword:n,handleSubmit:h=>{h.preventDefault(),i(null),l(!0),Ue("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async f=>{if(!f.ok){const x=await f.json().catch(()=>({}));throw new Error(x.error||"Login failed")}const m=await f.json();c(m.user||null),d("/dashboard",{replace:!0})}).catch(f=>{i(f instanceof Error?f.message:"Login failed")}).finally(()=>l(!1))}}},ET=()=>{const{email:e,password:t,error:r,loading:n,setEmail:a,setPassword:i,handleSubmit:o}=ST();return s.jsx("div",{className:"login-page retro-login",children:s.jsxs("div",{className:"login-page__shell retro-shell",children:[s.jsx(mT,{}),s.jsx(pT,{children:s.jsx(xT,{email:e,password:t,loading:n,error:r,onEmailChange:a,onPasswordChange:i,onSubmit:o})})]})})},CT={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};class TT extends p.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r),this.setState({error:t,errorInfo:r});try{const n=CT?.VITE_API_BASE_URL||"http://localhost:3001";fetch(`${n}/api/error-report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:t?.message||String(t),stack:t?.stack,url:window.location.href,extra:r?.componentStack?.slice(0,200)})}).catch(()=>{})}catch{}}handleReload=()=>{window.location.reload()};render(){return this.state.hasError?s.jsx("div",{className:"error-boundary min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 to-red-100 p-4",children:s.jsxs("div",{className:"error-boundary__container max-w-2xl w-full bg-white rounded-lg shadow-xl p-8",children:[s.jsx("div",{className:"error-boundary__icon-wrap flex items-center justify-center w-16 h-16 mx-auto bg-red-100 rounded-full mb-4",children:s.jsx("svg",{className:"error-boundary__icon w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),s.jsx("h1",{className:"error-boundary__title text-2xl font-bold text-gray-900 text-center mb-2",children:"Đã xảy ra lỗi"}),s.jsx("p",{className:"error-boundary__message text-gray-600 text-center mb-6",children:"Ứng dụng gặp sự cố không mong muốn. Vui lòng thử tải lại trang."}),!1,s.jsxs("div",{className:"error-boundary__actions flex gap-4 justify-center",children:[s.jsx("button",{onClick:this.handleReload,className:"error-boundary__btn error-boundary__btn--reload px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Tải lại trang"}),s.jsx("button",{onClick:()=>window.history.back(),className:"error-boundary__btn error-boundary__btn--back px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Quay lại"})]})]})}):this.props.children}}function kT({children:e}){const{user:t,loading:r}=xp(),n=pp();return r?null:t?s.jsx(s.Fragment,{children:e}):s.jsx(Kf,{to:"/login",replace:!0,state:{from:n.pathname}})}function AT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const zN=p.forwardRef(AT);function PT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const OT=p.forwardRef(PT);function DT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const gp=p.forwardRef(DT);function IT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const RT=p.forwardRef(IT);function MT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const vp=p.forwardRef(MT);function FT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const bp=p.forwardRef(FT);function LT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const Jo=p.forwardRef(LT);function BT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm3 0h.008v.008H18V10.5Zm-12 0h.008v.008H6V10.5Z"}))}const WN=p.forwardRef(BT);function $T({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const UT=p.forwardRef($T);function HT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinejoin:"round",d:"M6.75 3.744h-.753v8.25h7.125a4.125 4.125 0 0 0 0-8.25H6.75Zm0 0v.38m0 16.122h6.747a4.5 4.5 0 0 0 0-9.001h-7.5v9h.753Zm0 0v-.37m0-15.751h6a3.75 3.75 0 1 1 0 7.5h-6m0-7.5v7.5m0 0v8.25m0-8.25h6.375a4.125 4.125 0 0 1 0 8.25H6.75m.747-15.38h4.875a3.375 3.375 0 0 1 0 6.75H7.497v-6.75Zm0 7.5h5.25a3.75 3.75 0 0 1 0 7.5h-5.25v-7.5Z"}))}const zT=p.forwardRef(HT);function WT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const VT=p.forwardRef(WT);function KT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const VN=p.forwardRef(KT);function GT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const KN=p.forwardRef(GT);function XT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const YT=p.forwardRef(XT);function qT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Vi=p.forwardRef(qT);function ZT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Wn=p.forwardRef(ZT);function JT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const yp=p.forwardRef(JT);function QT({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"}))}const ek=p.forwardRef(QT);function tk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const rk=p.forwardRef(tk);function nk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const ak=p.forwardRef(nk);function ik({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const pd=p.forwardRef(ik);function sk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ok=p.forwardRef(sk);function lk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const S0=p.forwardRef(lk);function ck({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const wp=p.forwardRef(ck);function uk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const dr=p.forwardRef(uk);function dk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const hk=p.forwardRef(dk);function fk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.248 20.246H9.05m0 0h3.696m-3.696 0 5.893-16.502m0 0h-3.697m3.697 0h3.803"}))}const mk=p.forwardRef(fk);function pk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"}))}const xk=p.forwardRef(pk);function gk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"}))}const vk=p.forwardRef(gk);function bk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const yk=p.forwardRef(bk);function wk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const vn=p.forwardRef(wk);function Nk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const GN=p.forwardRef(Nk);function _k({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const jk=p.forwardRef(_k);function Sk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const ls=p.forwardRef(Sk);function Ek({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const cr=p.forwardRef(Ek);function Ck({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const XN=p.forwardRef(Ck);function Tk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Np=p.forwardRef(Tk);function kk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Ra=p.forwardRef(kk);function Ak({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const xd=p.forwardRef(Ak);function Pk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const nv=p.forwardRef(Pk);function Ok({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0 0 12 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 0 1-2.031.352 5.988 5.988 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971Zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0 2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 0 1-2.031.352 5.989 5.989 0 0 1-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971Z"}))}const Dk=p.forwardRef(Ok);function Ik({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const gd=p.forwardRef(Ik);function Rk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const Mk=p.forwardRef(Rk);function Fk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Xr=p.forwardRef(Fk);function Lk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.995 3.744v7.5a6 6 0 1 1-12 0v-7.5m-2.25 16.502h16.5"}))}const Bk=p.forwardRef(Lk);function $k({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const YN=p.forwardRef($k);function Uk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const Hk=p.forwardRef(Uk);function zk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a2.25 2.25 0 0 0-2.25-2.25H15a3 3 0 1 1-6 0H5.25A2.25 2.25 0 0 0 3 12m18 0v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6m18 0V9M3 12V9m18 0a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 9m18 0V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v3"}))}const Wk=p.forwardRef(zk);function Vk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const qN=p.forwardRef(Vk);function Kk({title:e,titleId:t,...r},n){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Pt=p.forwardRef(Kk),av=[{title:"Tổng Quan",items:[{name:"Tổng Quan",href:"/dashboard",icon:KN}]},{title:"Sản Phẩm",items:[{name:"Đơn Hàng",href:"/orders",icon:gd},{name:"Gói Sản Phẩm",href:"/package-products",icon:ak},{name:"Bảng Giá",href:"/pricing",icon:pd},{name:"Thông Tin Sản Phẩm",href:"/product-info",icon:hk}]},{title:"Cung Cấp",items:[{name:"Nhà Cung Cấp",href:"/sources",icon:ok},{name:"Báo Giá",href:"/show-price",icon:S0},{name:"Hóa Đơn",href:"/bill-order",icon:S0},{name:"Biên Lai",href:"/invoices",icon:S0},{name:"Lô Hàng",href:"/warehouse",icon:zN}]},{title:"Khách hàng & CTV",items:[{name:"Danh sách CTV",href:"/ctv",icon:YN},{name:"Danh sách mã khuyến mãi",href:"/promo-codes",icon:Mk},{name:"Trạng thái khách hàng",href:"/customer-status",icon:ek},{name:"Add Mcoin",href:"/add-mcoin",icon:WN},{name:"Quản lí Key active",href:"/active-keys",icon:xk}]}],iv=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,a])=>`${n}=${a}`).sort().join("&")},E0=(e,t,r)=>{const[n,a]=r.split("?"),i=a?`?${a}`:"";return e!==n?!1:iv(t)===iv(i)},Gk=({section:e,isStaticSection:t,isOpenSection:r,currentPath:n,currentSearch:a,onToggle:i,onNavigate:o})=>{const l=e.items.some(c=>n===c.href||E0(n,a,c.href));return s.jsx("div",{className:`w-full rounded-2xl border border-white/5 bg-white/0 mb-3 transition-all duration-500 ${l?"ring-1 ring-indigo-500/30 bg-indigo-500/5 shadow-[0_20px_40px_-15px_rgba(79,70,229,0.15)]":""}`,children:t?s.jsx("div",{className:"space-y-1 px-2 py-1",children:e.items.map(c=>{const d=n===c.href||E0(n,a,c.href);return s.jsx("div",{className:"space-y-2",children:s.jsxs(Qg,{to:c.href,onClick:o,className:`
                    group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-300 ease-[cubic-bezier(0.23,1,0.32,1)]
                    ${d?"bg-indigo-500/20 text-white border border-indigo-500/30 shadow-[0_0_20px_rgba(99,102,241,0.2)]":"text-indigo-100/70 hover:bg-white/5 hover:text-white border border-transparent"}
                  `,children:[s.jsx(c.icon,{className:`h-5 w-5 transition-colors ${d?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})}):s.jsxs(s.Fragment,{children:[s.jsxs("button",{type:"button",onClick:()=>i(e.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[s.jsx("span",{children:e.title}),s.jsx(yp,{className:`h-4 w-4 transition-transform ${r?"rotate-180":""}`})]}),r&&s.jsx("div",{className:"space-y-1 px-2.5 py-2",children:e.items.map(c=>{const d=n===c.href||E0(n,a,c.href);return s.jsx("div",{className:"space-y-2",children:s.jsxs(Qg,{to:c.href,onClick:o,className:`
                        group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-300 ease-[cubic-bezier(0.23,1,0.32,1)]
                        ${d?"bg-indigo-500/20 text-white border border-indigo-500/30 shadow-[0_0_20px_rgba(99,102,241,0.2)]":"text-indigo-100/70 hover:bg-white/5 hover:text-white border border-transparent"}
                      `,children:[s.jsx(c.icon,{className:`h-5 w-5 transition-colors ${d?"text-white":"text-indigo-200 group-hover:text-white"}`}),c.name]})},c.name)})})]})})},Xk=({user:e,onLogout:t,onChangePassword:r})=>{const[n,a]=p.useState(!1);return s.jsxs("div",{className:"relative p-5 mt-auto border-t border-white/5 bg-white/0 backdrop-blur-md rounded-b-[32px]",children:[s.jsxs("div",{className:"w-full flex items-center justify-between",children:[s.jsxs("button",{type:"button",onClick:()=>a(i=>!i),className:"flex items-center flex-1",children:[s.jsxs("div",{className:"group/avatar relative w-11 h-11 transition-all duration-300 transform group-hover/account:scale-105",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-indigo-500 to-purple-500 rounded-full blur-[2px] opacity-40 group-hover/avatar:opacity-60 transition-opacity"}),s.jsx("div",{className:"relative w-full h-full bg-slate-900 border border-white/20 rounded-full flex items-center justify-center overflow-hidden shadow-[inset_0_2px_4px_rgba(255,255,255,0.1)]",children:s.jsx("span",{className:"text-white text-base font-black tracking-tighter",children:(e?.username||"A").slice(0,1).toUpperCase()})})]}),s.jsxs("div",{className:"ml-3 flex-1 text-left",children:[s.jsx("p",{className:"text-sm font-semibold text-white truncate",children:e?.username||"Tài Khoản"}),s.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:e?.role?`Role: ${e.role}`:"Chưa đăng nhập"})]})]}),s.jsx("button",{type:"button",onClick:t,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"Đăng Xuất",children:s.jsx(RT,{className:"h-5 w-5"})})]}),n&&s.jsx("div",{className:"absolute bottom-[calc(100%+8px)] left-4 right-4 glass-panel rounded-2xl shadow-2xl z-50 overflow-hidden animate-in fade-in slide-in-from-bottom-2 duration-300",children:s.jsx("ul",{className:"py-2 text-[13px] font-medium text-indigo-100/90 divide-y divide-white/5",children:["Thông Tin","Thông Tin Admin","Thông Tin Quản Lý","Thay Đổi Mật Khẩu"].map((i,o)=>s.jsx("li",{children:s.jsx("button",{type:"button",className:"w-full text-left px-4 py-2.5 hover:bg-indigo-500/10 hover:text-white transition-colors",onClick:()=>{a(!1),o===3&&r()},children:i})},i))})})]})},Yk=({isOpen:e,onClose:t})=>{const[r,n]=p.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[a,i]=p.useState(null),[o,l]=p.useState(null),[c,d]=p.useState(!1),u=()=>{n({currentPassword:"",newPassword:"",confirmPassword:""}),i(null),l(null)};p.useEffect(()=>{e&&u()},[e]);const h=()=>{t(),u()},f=async m=>{if(m.preventDefault(),i(null),l(null),!r.currentPassword||!r.newPassword||!r.confirmPassword){i("Vui lòng nhập đủ thông tin.");return}if(r.newPassword!==r.confirmPassword){i("Mật khẩu mới không khớp.");return}d(!0);try{const x=await Ue("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:r.currentPassword,newPassword:r.newPassword,confirmPassword:r.confirmPassword})});if(!x.ok){const g=await x.json().catch(()=>null);i(g?.error||"Không thay đổi được mật khẩu.");return}l("Thay đổi mật khẩu thành công."),n({currentPassword:"",newPassword:"",confirmPassword:""})}catch{i("Không thay đổi được mật khẩu.")}finally{d(!1)}};return e?s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/60 px-4",onClick:h,children:s.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Thay đổi mật khẩu"}),s.jsx("button",{type:"button",onClick:h,className:"text-white/70 hover:text-white transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-indigo-400/60","aria-label":"Đóng",children:s.jsx(Pt,{className:"h-5 w-5"})})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("label",{className:"block text-sm text-indigo-100",children:[s.jsx("span",{children:"Mật khẩu cũ"}),s.jsx("input",{type:"password",autoComplete:"current-password",value:r.currentPassword,onChange:m=>n(x=>({...x,currentPassword:m.target.value})),placeholder:"Nhập mật khẩu cũ",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),s.jsxs("label",{className:"block text-sm text-indigo-100",children:[s.jsx("span",{children:"Mật khẩu mới"}),s.jsx("input",{type:"password",autoComplete:"new-password",value:r.newPassword,onChange:m=>n(x=>({...x,newPassword:m.target.value})),placeholder:"Nhập mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),s.jsxs("label",{className:"block text-sm text-indigo-100",children:[s.jsx("span",{children:"Nhập lại mật khẩu mới"}),s.jsx("input",{type:"password",autoComplete:"new-password",value:r.confirmPassword,onChange:m=>n(x=>({...x,confirmPassword:m.target.value})),placeholder:"Nhập lại mật khẩu mới",className:"mt-1 w-full rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-indigo-200/60 focus:outline-none focus:ring-2 focus:ring-indigo-400/60"})]}),a&&s.jsx("p",{className:"text-sm text-rose-300",children:a}),o&&s.jsx("p",{className:"text-sm text-emerald-200",children:o}),s.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:h,disabled:c,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:"Hủy bỏ"}),s.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 rounded-md bg-indigo-500 text-white hover:bg-indigo-600 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang xử lý...":"Xác nhận"})]})]})]})}):null};function qk({isOpen:e,setIsOpen:t}){const r=pp(),{user:n,setUser:a}=xp(),[i,o]=p.useState(()=>Object.fromEntries(av.map(m=>[m.title,!0]))),[l,c]=p.useState(!1),d=m=>{o(x=>({...x,[m]:!x[m]}))},u=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{a(null),window.location.href="/login"}},h=()=>{c(!0)},f=()=>{c(!1)};return s.jsxs(s.Fragment,{children:[e&&s.jsx("div",{className:"sidebar__backdrop lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>t(!1)}),s.jsx("div",{className:`sidebar ${e?"sidebar--open":"sidebar--closed"}
          fixed top-4 left-4 bottom-4 z-40 w-64 glass-panel rounded-[32px] 
          transform transition-all duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)]
          ${e?"translate-x-0 opacity-100":"-translate-x-[110%] lg:translate-x-0 opacity-0 lg:opacity-100"}
          border border-white/10 shadow-[0_32px_64px_-16px_rgba(0,0,0,0.6)]
        `,children:s.jsxs("div",{className:"sidebar__inner flex flex-col h-full",children:[s.jsx("div",{className:"sidebar__brand px-5 pt-6 pb-2",children:s.jsxs("div",{className:"group relative overflow-hidden rounded-xl bg-gradient-to-tr from-indigo-500/10 to-purple-500/10 p-[1px] transition-all hover:scale-[1.02]",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-indigo-600 to-purple-600 opacity-10 group-hover:opacity-20 transition-opacity"}),s.jsx("div",{className:"relative rounded-[11px] bg-[#0c1222]/80 py-3 backdrop-blur-md border border-white/5 overflow-hidden [mask-image:linear-gradient(to_right,transparent,black_20%,black_80%,transparent)]",children:s.jsxs("div",{className:"animate-marquee-seamless",style:{animationDuration:"25s"},children:[s.jsxs("h1",{className:"text-[11px] font-bold text-white uppercase tracking-[0.2em] whitespace-nowrap px-6",children:["Mavryk ",s.jsx("span",{className:"text-indigo-400",children:"Store"})]}),s.jsxs("h1",{className:"text-[11px] font-bold text-white uppercase tracking-[0.2em] whitespace-nowrap px-6",children:["Mavryk ",s.jsx("span",{className:"text-indigo-400",children:"Store"})]})]})})]})}),s.jsx("nav",{className:"sidebar__nav flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:av.map((m,x)=>s.jsx(Gk,{section:m,isStaticSection:x===0,isOpenSection:i[m.title]??!0,currentPath:r.pathname,currentSearch:r.search,onToggle:d,onNavigate:()=>t(!1)},m.title))}),s.jsx(Xk,{user:n,onLogout:u,onChangePassword:h})]})}),s.jsx(Yk,{isOpen:l,onClose:f})]})}function Zk({children:e}){const[t,r]=p.useState(!1);return s.jsxs("div",{className:"min-h-screen app-aurora",children:[s.jsx(qk,{isOpen:t,setIsOpen:r}),s.jsxs("div",{className:"transition-all duration-500 ease-in-out lg:ml-72 min-h-screen flex flex-col",children:[!t&&s.jsx("div",{className:"lg:hidden fixed top-6 left-6 z-40 animate-in fade-in duration-500",children:s.jsxs("button",{onClick:()=>r(!0),className:"p-3 rounded-2xl glass-panel-light border border-white/10 text-white shadow-2xl backdrop-blur-xl",type:"button",children:[s.jsx("span",{className:"sr-only",children:"Open sidebar"}),s.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})]})}),s.jsx("main",{className:"flex-1 px-6 pt-4 pb-12 overflow-x-hidden",children:s.jsx("div",{className:"max-w-[1600px] mx-auto animate-in fade-in slide-in-from-bottom-4 duration-700",children:e})})]})]})}const Jk=({title:e,value:t,delta:r,trend:n,accent:a,icon:i})=>{const o=a==="amber"?{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"}:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"},l=n==="up"?bp:vp;return s.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4 bg-white/70 border border-white/40 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`h-10 w-10 rounded-xl ${o.iconBg} flex items-center justify-center`,children:s.jsx(i,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:e}),s.jsx("p",{className:"text-xl font-bold text-white",children:t})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-semibold ${o.chip}`,children:[s.jsx(l,{className:"h-3.5 w-3.5"}),r]})})]})},Qk=({loading:e,error:t,rows:r,onRefresh:n})=>s.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/60 via-slate-700/50 to-slate-900/60 p-6 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.75),0_14px_36px_-24px_rgba(255,255,255,0.2)]",children:[s.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Bảng giá HanaGold"}),s.jsx("p",{className:"text-xs text-white/70",children:"Mua/Bán theo ngày"})]}),s.jsx("button",{type:"button",onClick:n,className:"rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20 border border-white/20",children:"Làm mới"})]}),t&&s.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/60 bg-amber-50/10 px-3 py-2 text-sm text-amber-200",children:t}),s.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:s.jsxs("table",{className:"min-w-full text-sm text-white",children:[s.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left",children:"Mục"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Mua"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng tiền mua vàng"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Tổng vàng (chỉ)"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Lợi nhuận"}),s.jsx("th",{className:"px-3 py-2 text-right",children:"Bán"}),s.jsx("th",{className:"px-3 py-2 text-center",children:"Xu hướng"})]})}),s.jsxs("tbody",{className:"divide-y divide-white/10",children:[e&&s.jsx("tr",{children:s.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Đang tải giá vàng..."})}),!e&&r.length===0&&s.jsx("tr",{children:s.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:7,children:"Chưa có dữ liệu."})}),!e&&r.map((a,i)=>s.jsxs("tr",{className:"hover:bg-white/5",children:[s.jsx("td",{className:"px-3 py-2 font-semibold",children:a.displayName||"Không tên"}),s.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.bid/10).toLocaleString("vi-VN")," đ"]}),s.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldValue!==void 0?a.totalGoldValue.toLocaleString("vi-VN"):"—"}),s.jsx("td",{className:"px-3 py-2 text-right",children:a.totalGoldAmount!==void 0?a.totalGoldAmount.toFixed(4):"—"}),s.jsx("td",{className:"px-3 py-2 text-right",children:a.profit!==void 0?a.profit.toLocaleString("vi-VN"):"—"}),s.jsxs("td",{className:"px-3 py-2 text-right",children:[(a.ask/10).toLocaleString("vi-VN")," đ"]}),s.jsx("td",{className:"px-3 py-2 text-center",children:s.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-[11px] font-semibold ${a.trendBid==="up"?"bg-emerald-500/20 text-emerald-200":a.trendBid==="down"?"bg-rose-500/20 text-rose-200":"bg-white/10 text-white/80"}`,children:a.trendBid==="up"?"Tăng":a.trendBid==="down"?"Giảm":"Ổn định"})})]},`${a.displayName}-${a.time}-${i}`))]})]})})]}),eA="modulepreload",tA=function(e){return"/"+e},sv={},Xc=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=c(r.map(d=>{if(d=tA(d),d in sv)return;sv[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":eA,u||(f.as="script"),f.crossOrigin="",f.href=d,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((m,x)=>{f.addEventListener("load",m),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function ZN(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=ZN(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function lt(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=ZN(e))&&(n&&(n+=" "),n+=t);return n}var rA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function _p(e){if(typeof e!="string")return!1;var t=rA;return t.includes(e)}var nA=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],aA=new Set(nA);function JN(e){return typeof e!="string"?!1:aA.has(e)}function QN(e){return typeof e=="string"&&e.startsWith("data-")}function bn(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(JN(r)||QN(r))&&(t[r]=e[r]);return t}function Ki(e){if(e==null)return null;if(p.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return bn(t)}return typeof e=="object"&&!Array.isArray(e)?bn(e):null}function Yr(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(JN(r)||QN(r)||_p(r))&&(t[r]=e[r]);return t}function iA(e){return e==null?null:p.isValidElement(e)?Yr(e.props):typeof e=="object"&&!Array.isArray(e)?Yr(e):null}var sA=["children","width","height","viewBox","className","style","title","desc"];function Gf(){return Gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gf.apply(null,arguments)}function oA(e,t){if(e==null)return{};var r,n,a=lA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lA(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var e_=p.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:o,style:l,title:c,desc:d}=e,u=oA(e,sA),h=i||{width:n,height:a,x:0,y:0},f=lt("recharts-surface",o);return p.createElement("svg",Gf({},Yr(u),{className:f,width:n,height:a,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),p.createElement("title",null,c),p.createElement("desc",null,d),r)}),cA=["children","className"];function Xf(){return Xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xf.apply(null,arguments)}function uA(e,t){if(e==null)return{};var r,n,a=dA(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dA(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ur=p.forwardRef((e,t)=>{var{children:r,className:n}=e,a=uA(e,cA),i=lt("recharts-layer",n);return p.createElement("g",Xf({className:i},Yr(a),{ref:t}),r)}),hA=p.createContext(null);function bt(e){return function(){return e}}const t_=Math.cos,Yc=Math.sin,Xn=Math.sqrt,qc=Math.PI,vd=2*qc,Yf=Math.PI,qf=2*Yf,Pi=1e-6,fA=qf-Pi;function r_(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function mA(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return r_;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class pA{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?r_:mA(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,u=o-t,h=l-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Pi)if(!(Math.abs(h*c-d*u)>Pi)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,x=a-l,g=c*c+d*d,v=m*m+x*x,b=Math.sqrt(g),w=Math.sqrt(f),y=i*Math.tan((Yf-Math.acos((g+f-v)/(2*b*w)))/2),N=y/w,_=y/b;Math.abs(N-1)>Pi&&this._append`L${t+N*u},${r+N*h}`,this._append`A${i},${i},0,0,${+(h*m>u*x)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,h=1^o,f=o?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Pi||Math.abs(this._y1-u)>Pi)&&this._append`L${d},${u}`,n&&(f<0&&(f=f%qf+qf),f>fA?this._append`A${n},${n},0,1,${h},${t-l},${r-c}A${n},${n},0,1,${h},${this._x1=d},${this._y1=u}`:f>Pi&&this._append`A${n},${n},0,${+(f>=Yf)},${h},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function jp(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new pA(t)}function Sp(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function n_(e){this._context=e}n_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function bd(e){return new n_(e)}function a_(e){return e[0]}function i_(e){return e[1]}function s_(e,t){var r=bt(!0),n=null,a=bd,i=null,o=jp(l);e=typeof e=="function"?e:e===void 0?a_:bt(e),t=typeof t=="function"?t:t===void 0?i_:bt(t);function l(c){var d,u=(c=Sp(c)).length,h,f=!1,m;for(n==null&&(i=a(m=o())),d=0;d<=u;++d)!(d<u&&r(h=c[d],d,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,d,c),+t(h,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:bt(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:bt(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:bt(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function rc(e,t,r){var n=null,a=bt(!0),i=null,o=bd,l=null,c=jp(d);e=typeof e=="function"?e:e===void 0?a_:bt(+e),t=typeof t=="function"?t:bt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?i_:bt(+r);function d(h){var f,m,x,g=(h=Sp(h)).length,v,b=!1,w,y=new Array(g),N=new Array(g);for(i==null&&(l=o(w=c())),f=0;f<=g;++f){if(!(f<g&&a(v=h[f],f,h))===b)if(b=!b)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=f-1;x>=m;--x)l.point(y[x],N[x]);l.lineEnd(),l.areaEnd()}b&&(y[f]=+e(v,f,h),N[f]=+t(v,f,h),l.point(n?+n(v,f,h):y[f],r?+r(v,f,h):N[f]))}if(w)return l=null,w+""||null}function u(){return s_().defined(a).curve(o).context(i)}return d.x=function(h){return arguments.length?(e=typeof h=="function"?h:bt(+h),n=null,d):e},d.x0=function(h){return arguments.length?(e=typeof h=="function"?h:bt(+h),d):e},d.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:bt(+h),d):n},d.y=function(h){return arguments.length?(t=typeof h=="function"?h:bt(+h),r=null,d):t},d.y0=function(h){return arguments.length?(t=typeof h=="function"?h:bt(+h),d):t},d.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:bt(+h),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(h){return arguments.length?(a=typeof h=="function"?h:bt(!!h),d):a},d.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),d):o},d.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),d):i},d}class o_{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function xA(e){return new o_(e,!0)}function gA(e){return new o_(e,!1)}const Ep={draw(e,t){const r=Xn(t/qc);e.moveTo(r,0),e.arc(0,0,r,0,vd)}},vA={draw(e,t){const r=Xn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},l_=Xn(1/3),bA=l_*2,yA={draw(e,t){const r=Xn(t/bA),n=r*l_;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},wA={draw(e,t){const r=Xn(t),n=-r/2;e.rect(n,n,r,r)}},NA=.8908130915292852,c_=Yc(qc/10)/Yc(7*qc/10),_A=Yc(vd/10)*c_,jA=-t_(vd/10)*c_,SA={draw(e,t){const r=Xn(t*NA),n=_A*r,a=jA*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const o=vd*i/5,l=t_(o),c=Yc(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},C0=Xn(3),EA={draw(e,t){const r=-Xn(t/(C0*3));e.moveTo(0,r*2),e.lineTo(-C0*r,-r),e.lineTo(C0*r,-r),e.closePath()}},_n=-.5,jn=Xn(3)/2,Zf=1/Xn(12),CA=(Zf/2+1)*3,TA={draw(e,t){const r=Xn(t/CA),n=r/2,a=r*Zf,i=n,o=r*Zf+r,l=-i,c=o;e.moveTo(n,a),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(_n*n-jn*a,jn*n+_n*a),e.lineTo(_n*i-jn*o,jn*i+_n*o),e.lineTo(_n*l-jn*c,jn*l+_n*c),e.lineTo(_n*n+jn*a,_n*a-jn*n),e.lineTo(_n*i+jn*o,_n*o-jn*i),e.lineTo(_n*l+jn*c,_n*c-jn*l),e.closePath()}};function kA(e,t){let r=null,n=jp(a);e=typeof e=="function"?e:bt(e||Ep),t=typeof t=="function"?t:bt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:bt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:bt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Zc(){}function Jc(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function u_(e){this._context=e}u_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function AA(e){return new u_(e)}function d_(e){this._context=e}d_.prototype={areaStart:Zc,areaEnd:Zc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Jc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PA(e){return new d_(e)}function h_(e){this._context=e}h_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Jc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OA(e){return new h_(e)}function f_(e){this._context=e}f_.prototype={areaStart:Zc,areaEnd:Zc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function DA(e){return new f_(e)}function ov(e){return e<0?-1:1}function lv(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(ov(i)+ov(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function cv(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function T0(e,t,r){var n=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function Qc(e){this._context=e}Qc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:T0(this,this._t0,cv(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,T0(this,cv(this,r=lv(this,e,t)),r);break;default:T0(this,this._t0,r=lv(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function m_(e){this._context=new p_(e)}(m_.prototype=Object.create(Qc.prototype)).point=function(e,t){Qc.prototype.point.call(this,t,e)};function p_(e){this._context=e}p_.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function IA(e){return new Qc(e)}function RA(e){return new m_(e)}function x_(e){this._context=e}x_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=uv(e),a=uv(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function uv(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function MA(e){return new x_(e)}function yd(e,t){this._context=e,this._t=t}yd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function FA(e){return new yd(e,.5)}function LA(e){return new yd(e,0)}function BA(e){return new yd(e,1)}function Gi(e,t){if((o=e.length)>1)for(var r=1,n,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Jf(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function $A(e,t){return e[t]}function UA(e){const t=[];return t.key=e,t}function HA(){var e=bt([]),t=Jf,r=Gi,n=$A;function a(i){var o=Array.from(e.apply(this,arguments),UA),l,c=o.length,d=-1,u;for(const h of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(h,o[l].key,d,i)]).data=h;for(l=0,u=Sp(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:bt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:bt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Jf:typeof i=="function"?i:bt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Gi,a):r},a}function zA(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}Gi(e,t)}}function WA(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Gi(e,t)}}function VA(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],h=u[n][1]||0,f=u[n-1][1]||0,m=(h-f)/2,x=0;x<l;++x){var g=e[t[x]],v=g[n][1]||0,b=g[n-1][1]||0;m+=v-b}c+=h,d+=m*h}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,Gi(e,t)}}var k0={},A0={},dv;function KA(){return dv||(dv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(A0)),A0}var P0={},hv;function g_(){return hv||(hv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(P0)),P0}var O0={},fv;function Cp(){return fv||(fv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(O0)),O0}var D0={},I0={},mv;function GA(){return mv||(mv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(I0)),I0}var pv;function Tp(){return pv||(pv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GA(),r=Cp();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],o=a.length;if(o===0)return i;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(i.push(""),l++);l<o;){const h=a[l];d?h==="\\"&&l+1<o?(l++,c+=a[l]):h===d?d="":c+=h:u?h==='"'||h==="'"?d=h:h==="]"?(u=!1,i.push(c),c=""):c+=h:h==="["?(u=!0,c&&(i.push(c),c="")):h==="."?c&&(i.push(c),c=""):c+=h,l++}return c&&i.push(c),i}e.toPath=n})(D0)),D0}var xv;function kp(){return xv||(xv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KA(),r=g_(),n=Cp(),a=Tp();function i(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?r.isDeepKey(c)?i(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let h=0;h<c.length;h++){if(u==null||t.isUnsafeProperty(c[h]))return d;u=u[c[h]]}return u===void 0?d:u}e.get=i})(k0)),k0}var R0,gv;function XA(){return gv||(gv=1,R0=kp().get),R0}var YA=XA();const Xi=wi(YA);var qA=4;function li(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qA,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Bt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,i,o)=>{var l=r[o-1];return typeof l=="string"?a+l+i:l!==void 0?a+li(l)+i:a+i},"")}var lr=e=>e===0?0:e>0?1:-1,da=e=>typeof e=="number"&&e!=+e,Yi=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Ie=e=>(typeof e=="number"||e instanceof Number)&&!da(e),ha=e=>Ie(e)||typeof e=="string",ZA=0,Qo=e=>{var t=++ZA;return"".concat(e||"").concat(t)},Or=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ie(t)&&typeof t!="string")return n;var i;if(Yi(t)){if(r==null)return n;var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return da(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},v_=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Ct(e,t,r){return Ie(e)&&Ie(t)?li(e+r*(t-e)):t}function b_(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Xi(n,t))===r)}var Mt=e=>e===null||typeof e>"u",Tl=e=>Mt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function tn(e){return e!=null}function cs(){}var JA=["type","size","sizeType"];function Qf(){return Qf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qf.apply(null,arguments)}function vv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vv(Object(r),!0).forEach(function(n){QA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QA(e,t,r){return(t=e3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e3(e){var t=t3(e,"string");return typeof t=="symbol"?t:t+""}function t3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r3(e,t){if(e==null)return{};var r,n,a=n3(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function n3(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var y_={symbolCircle:Ep,symbolCross:vA,symbolDiamond:yA,symbolSquare:wA,symbolStar:SA,symbolTriangle:EA,symbolWye:TA},a3=Math.PI/180,i3=e=>{var t="symbol".concat(Tl(e));return y_[t]||Ep},s3=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*a3;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},o3=(e,t)=>{y_["symbol".concat(Tl(e))]=t},w_=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=r3(e,JA),i=bv(bv({},a),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var f=i3(o),m=kA().type(f).size(s3(r,n,o)),x=m();if(x!==null)return x},{className:c,cx:d,cy:u}=i,h=Yr(i);return Ie(d)&&Ie(u)&&Ie(r)?p.createElement("path",Qf({},h,{className:lt("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};w_.registerSymbol=o3;var N_=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Ap=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(p.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{_p(a)&&(n[a]=(i=>r[a](r,i)))}),n},l3=(e,t,r)=>n=>(e(t,r,n),null),wd=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];_p(a)&&typeof i=="function"&&(n||(n={}),n[a]=l3(i,t,r))}),n};function yv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function c3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yv(Object(r),!0).forEach(function(n){u3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u3(e,t,r){return(t=d3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d3(e){var t=h3(e,"string");return typeof t=="symbol"?t:t+""}function h3(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hr(e,t){var r=c3({},e),n=t,a=Object.keys(t),i=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return i}var M0={},F0={},wv;function f3(){return wv||(wv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const o=r[i],l=n(o,i,r);a.has(l)||a.set(l,o)}return Array.from(a.values())}e.uniqBy=t})(F0)),F0}var L0={},Nv;function m3(){return Nv||(Nv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(L0)),L0}var B0={},_v;function __(){return _v||(_v=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(B0)),B0}var $0={},U0={},H0={},jv;function p3(){return jv||(jv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(H0)),H0}var Sv;function Pp(){return Sv||(Sv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=p3();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(U0)),U0}var z0={},Ev;function x3(){return Ev||(Ev=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(z0)),z0}var Cv;function g3(){return Cv||(Cv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pp(),r=x3();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})($0)),$0}var W0={},V0={},Tv;function v3(){return Tv||(Tv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kp();function r(n){return function(a){return t.get(a,n)}}e.property=r})(V0)),V0}var K0={},G0={},X0={},Y0={},kv;function j_(){return kv||(kv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Y0)),Y0}var q0={},Av;function S_(){return Av||(Av=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(q0)),q0}var Z0={},Pv;function E_(){return Pv||(Pv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(Z0)),Z0}var Ov;function b3(){return Ov||(Ov=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j_(),r=S_(),n=E_();function a(u,h,f){return typeof f!="function"?a(u,h,()=>{}):i(u,h,function m(x,g,v,b,w,y){const N=f(x,g,v,b,w,y);return N!==void 0?!!N:i(x,g,m,y)},new Map)}function i(u,h,f,m){if(h===u)return!0;switch(typeof h){case"object":return o(u,h,f,m);case"function":return Object.keys(h).length>0?i(u,{...h},f,m):n.isEqualsSameValueZero(u,h);default:return t.isObject(u)?typeof h=="string"?h==="":!0:n.isEqualsSameValueZero(u,h)}}function o(u,h,f,m){if(h==null)return!0;if(Array.isArray(h))return c(u,h,f,m);if(h instanceof Map)return l(u,h,f,m);if(h instanceof Set)return d(u,h,f,m);const x=Object.keys(h);if(u==null||r.isPrimitive(u))return x.length===0;if(x.length===0)return!0;if(m?.has(h))return m.get(h)===u;m?.set(h,u);try{for(let g=0;g<x.length;g++){const v=x[g];if(!r.isPrimitive(u)&&!(v in u)||h[v]===void 0&&u[v]!==void 0||h[v]===null&&u[v]!==null||!f(u[v],h[v],v,u,h,m))return!1}return!0}finally{m?.delete(h)}}function l(u,h,f,m){if(h.size===0)return!0;if(!(u instanceof Map))return!1;for(const[x,g]of h.entries()){const v=u.get(x);if(f(v,g,x,u,h,m)===!1)return!1}return!0}function c(u,h,f,m){if(h.length===0)return!0;if(!Array.isArray(u))return!1;const x=new Set;for(let g=0;g<h.length;g++){const v=h[g];let b=!1;for(let w=0;w<u.length;w++){if(x.has(w))continue;const y=u[w];let N=!1;if(f(y,v,g,u,h,m)&&(N=!0),N){x.add(w),b=!0;break}}if(!b)return!1}return!0}function d(u,h,f,m){return h.size===0?!0:u instanceof Set?c([...u],[...h],f,m):!1}e.isMatchWith=a,e.isSetMatch=d})(X0)),X0}var Dv;function C_(){return Dv||(Dv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=b3();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(G0)),G0}var J0={},Q0={},eh={},Iv;function y3(){return Iv||(Iv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(eh)),eh}var th={},Rv;function Op(){return Rv||(Rv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(th)),th}var rh={},Mv;function T_(){return Mv||(Mv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",h="[object Function]",f="[object ArrayBuffer]",m="[object Object]",x="[object Error]",g="[object DataView]",v="[object Uint8Array]",b="[object Uint8ClampedArray]",w="[object Uint16Array]",y="[object Uint32Array]",N="[object BigUint64Array]",_="[object Int8Array]",S="[object Int16Array]",j="[object Int32Array]",E="[object BigInt64Array]",k="[object Float32Array]",T="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=u,e.bigInt64ArrayTag=E,e.bigUint64ArrayTag=N,e.booleanTag=a,e.dataViewTag=g,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=k,e.float64ArrayTag=T,e.functionTag=h,e.int16ArrayTag=S,e.int32ArrayTag=j,e.int8ArrayTag=_,e.mapTag=c,e.numberTag=n,e.objectTag=m,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=w,e.uint32ArrayTag=y,e.uint8ArrayTag=v,e.uint8ClampedArrayTag=b})(rh)),rh}var nh={},Fv;function w3(){return Fv||(Fv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(nh)),nh}var Lv;function k_(){return Lv||(Lv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=y3(),r=Op(),n=T_(),a=S_(),i=w3();function o(u,h){return l(u,void 0,u,new Map,h)}function l(u,h,f,m=new Map,x=void 0){const g=x?.(u,h,f,m);if(g!==void 0)return g;if(a.isPrimitive(u))return u;if(m.has(u))return m.get(u);if(Array.isArray(u)){const v=new Array(u.length);m.set(u,v);for(let b=0;b<u.length;b++)v[b]=l(u[b],b,f,m,x);return Object.hasOwn(u,"index")&&(v.index=u.index),Object.hasOwn(u,"input")&&(v.input=u.input),v}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const v=new RegExp(u.source,u.flags);return v.lastIndex=u.lastIndex,v}if(u instanceof Map){const v=new Map;m.set(u,v);for(const[b,w]of u)v.set(b,l(w,b,f,m,x));return v}if(u instanceof Set){const v=new Set;m.set(u,v);for(const b of u)v.add(l(b,void 0,f,m,x));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(i.isTypedArray(u)){const v=new(Object.getPrototypeOf(u)).constructor(u.length);m.set(u,v);for(let b=0;b<u.length;b++)v[b]=l(u[b],b,f,m,x);return v}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const v=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return m.set(u,v),c(v,u,f,m,x),v}if(typeof File<"u"&&u instanceof File){const v=new File([u],u.name,{type:u.type});return m.set(u,v),c(v,u,f,m,x),v}if(typeof Blob<"u"&&u instanceof Blob){const v=new Blob([u],{type:u.type});return m.set(u,v),c(v,u,f,m,x),v}if(u instanceof Error){const v=new u.constructor;return m.set(u,v),v.message=u.message,v.name=u.name,v.stack=u.stack,v.cause=u.cause,c(v,u,f,m,x),v}if(u instanceof Boolean){const v=new Boolean(u.valueOf());return m.set(u,v),c(v,u,f,m,x),v}if(u instanceof Number){const v=new Number(u.valueOf());return m.set(u,v),c(v,u,f,m,x),v}if(u instanceof String){const v=new String(u.valueOf());return m.set(u,v),c(v,u,f,m,x),v}if(typeof u=="object"&&d(u)){const v=Object.create(Object.getPrototypeOf(u));return m.set(u,v),c(v,u,f,m,x),v}return u}function c(u,h,f=u,m,x){const g=[...Object.keys(h),...t.getSymbols(h)];for(let v=0;v<g.length;v++){const b=g[v],w=Object.getOwnPropertyDescriptor(u,b);(w==null||w.writable)&&(u[b]=l(h[b],b,f,m,x))}}function d(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(Q0)),Q0}var Bv;function N3(){return Bv||(Bv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=k_();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(J0)),J0}var $v;function _3(){return $v||($v=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=C_(),r=N3();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(K0)),K0}var ah={},ih={},sh={},Uv;function j3(){return Uv||(Uv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=k_(),r=Op(),n=T_();function a(i,o){return t.cloneDeepWith(i,(l,c,d,u)=>{const h=o?.(l,c,d,u);if(h!==void 0)return h;if(typeof i=="object"){if(r.getTag(i)===n.objectTag&&typeof i.constructor!="function"){const f={};return u.set(i,f),t.copyProperties(f,i,d,u),f}switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const f=new i.constructor(i?.valueOf());return t.copyProperties(f,i),f}case n.argumentsTag:{const f={};return t.copyProperties(f,i),f.length=i.length,f[Symbol.iterator]=i[Symbol.iterator],f}default:return}}})}e.cloneDeepWith=a})(sh)),sh}var Hv;function S3(){return Hv||(Hv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=j3();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(ih)),ih}var oh={},lh={},zv;function A_(){return zv||(zv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(lh)),lh}var ch={},Wv;function E3(){return Wv||(Wv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Op();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(ch)),ch}var Vv;function C3(){return Vv||(Vv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=g_(),r=A_(),n=E3(),a=Tp();function i(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&o?.[l]==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const h=c[u];if((d==null||!Object.hasOwn(d,h))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(h)&&h<d.length))return!1;d=d[h]}return!0}e.has=i})(oh)),oh}var Kv;function T3(){return Kv||(Kv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=C_(),r=Cp(),n=S3(),a=kp(),i=C3();function o(l,c){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?i.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(ah)),ah}var Gv;function k3(){return Gv||(Gv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=__(),r=v3(),n=_3(),a=T3();function i(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=i})(W0)),W0}var Xv;function A3(){return Xv||(Xv=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=f3(),r=m3(),n=__(),a=g3(),i=k3();function o(l,c=n.identity){return a.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(i.iteratee(c),1)):[]}e.uniqBy=o})(M0)),M0}var uh,Yv;function P3(){return Yv||(Yv=1,uh=A3().uniqBy),uh}var O3=P3();const qv=wi(O3);function D3(e,t,r){return t===!0?qv(e,r):typeof t=="function"?qv(e,t):e}var dh={exports:{}},hh={},fh={exports:{}},mh={};var Zv;function I3(){if(Zv)return mh;Zv=1;var e=md();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,o=e.useDebugValue;function l(h,f){var m=f(),x=n({inst:{value:m,getSnapshot:f}}),g=x[0].inst,v=x[1];return i(function(){g.value=m,g.getSnapshot=f,c(g)&&v({inst:g})},[h,m,f]),a(function(){return c(g)&&v({inst:g}),h(function(){c(g)&&v({inst:g})})},[h]),o(m),m}function c(h){var f=h.getSnapshot;h=h.value;try{var m=f();return!r(h,m)}catch{return!0}}function d(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return mh.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,mh}var Jv;function R3(){return Jv||(Jv=1,fh.exports=I3()),fh.exports}var Qv;function M3(){if(Qv)return hh;Qv=1;var e=md(),t=R3();function r(d,u){return d===u&&(d!==0||1/d===1/u)||d!==d&&u!==u}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;return hh.useSyncExternalStoreWithSelector=function(d,u,h,f,m){var x=i(null);if(x.current===null){var g={hasValue:!1,value:null};x.current=g}else g=x.current;x=l(function(){function b(S){if(!w){if(w=!0,y=S,S=f(S),m!==void 0&&g.hasValue){var j=g.value;if(m(j,S))return N=j}return N=S}if(j=N,n(y,S))return j;var E=f(S);return m!==void 0&&m(j,E)?(y=S,j):(y=S,N=E)}var w=!1,y,N,_=h===void 0?null:h;return[function(){return b(u())},_===null?void 0:function(){return b(_())}]},[u,h,f,m]);var v=a(d,x[0],x[1]);return o(function(){g.hasValue=!0,g.value=v},[v]),c(v),v},hh}var e1;function F3(){return e1||(e1=1,dh.exports=M3()),dh.exports}var L3=F3(),Dp=p.createContext(null),B3=e=>e,Ot=()=>{var e=p.useContext(Dp);return e?e.store.dispatch:B3},Lc=()=>{},$3=()=>Lc,U3=(e,t)=>e===t;function Fe(e){var t=p.useContext(Dp),r=p.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Lc,[t,e]);return L3.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:$3,t?t.store.getState:Lc,t?t.store.getState:Lc,r,U3)}function H3(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function z3(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function W3(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var t1=e=>Array.isArray(e)?e:[e];function V3(e){const t=Array.isArray(e[0])?e[0]:e;return W3(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function K3(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var G3=class{constructor(e){this.value=e}deref(){return this.value}},X3=typeof WeakRef<"u"?WeakRef:G3,Y3=0,r1=1;function nc(){return{s:Y3,v:void 0,o:null,p:null}}function P_(e,t={}){let r=nc();const{resultEqualityCheck:n}=t;let a,i=0;function o(){let l=r;const{length:c}=arguments;for(let h=0,f=c;h<f;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let x=l.o;x===null&&(l.o=x=new WeakMap);const g=x.get(m);g===void 0?(l=nc(),x.set(m,l)):l=g}else{let x=l.p;x===null&&(l.p=x=new Map);const g=x.get(m);g===void 0?(l=nc(),x.set(m,l)):l=g}}const d=l;let u;if(l.s===r1)u=l.v;else if(u=e.apply(null,arguments),i++,n){const h=a?.deref?.()??a;h!=null&&n(h,u)&&(u=h,i!==0&&i--),a=typeof u=="object"&&u!==null||typeof u=="function"?new X3(u):u}return d.s=r1,d.v=u,u}return o.clearCache=()=>{r=nc(),o.resetResultsCount()},o.resultsCount=()=>i,o.resetResultsCount=()=>{i=0},o}function q3(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,o=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),H3(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...r,...c},{memoize:h,memoizeOptions:f=[],argsMemoize:m=P_,argsMemoizeOptions:x=[]}=u,g=t1(f),v=t1(x),b=V3(a),w=h(function(){return i++,d.apply(null,arguments)},...g),y=m(function(){o++;const _=K3(b,arguments);return l=w.apply(null,_),l},...v);return Object.assign(y,{resultFunc:d,memoizedResultFunc:w,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var Q=q3(P_),Z3=Object.assign((e,t=Q)=>{z3(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>Z3}),ph={},xh={},gh={},n1;function J3(){return n1||(n1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const o=t(n),l=t(a);if(o===l&&o===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-o:o-l}return 0};e.compareValues=r})(gh)),gh}var vh={},bh={},a1;function O_(){return a1||(a1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(bh)),bh}var i1;function Q3(){return i1||(i1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O_(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,o){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||o!=null&&Object.hasOwn(o,i)}e.isKey=a})(vh)),vh}var s1;function eP(){return s1||(s1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J3(),r=Q3(),n=Tp();function a(i,o,l,c){if(i==null)return[];l=c?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(m=>String(m));const d=(m,x)=>{let g=m;for(let v=0;v<x.length&&g!=null;++v)g=g[x[v]];return g},u=(m,x)=>x==null||m==null?x:typeof m=="object"&&"key"in m?Object.hasOwn(x,m.key)?x[m.key]:d(x,m.path):typeof m=="function"?m(x):Array.isArray(m)?d(x,m):typeof x=="object"?x[m]:x,h=o.map(m=>(Array.isArray(m)&&m.length===1&&(m=m[0]),m==null||typeof m=="function"||Array.isArray(m)||r.isKey(m)?m:{key:m,path:n.toPath(m)}));return i.map(m=>({original:m,criteria:h.map(x=>u(x,m))})).slice().sort((m,x)=>{for(let g=0;g<h.length;g++){const v=t.compareValues(m.criteria[g],x.criteria[g],l[g]);if(v!==0)return v}return 0}).map(m=>m.original)}e.orderBy=a})(xh)),xh}var yh={},o1;function tP(){return o1||(o1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<i?o(u,c+1):a.push(u)}};return o(r,0),a}e.flatten=t})(yh)),yh}var wh={},l1;function D_(){return l1||(l1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A_(),r=Pp(),n=j_(),a=E_();function i(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=i})(wh)),wh}var c1;function rP(){return c1||(c1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eP(),r=tP(),n=D_();function a(i,...o){const l=o.length;return l>1&&n.isIterateeCall(i,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(i,r.flatten(o),["asc"])}e.sortBy=a})(ph)),ph}var Nh,u1;function nP(){return u1||(u1=1,Nh=rP().sortBy),Nh}var aP=nP();const Nd=wi(aP);var I_=e=>e.legend.settings,iP=e=>e.legend.size,sP=e=>e.legend.payload;Q([sP,I_],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Nd(n,r):n});var ac=1;function oP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=p.useState({height:0,left:0,top:0,width:0}),n=p.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),o={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(o.height-t.height)>ac||Math.abs(o.left-t.left)>ac||Math.abs(o.top-t.top)>ac||Math.abs(o.width-t.width)>ac)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function xr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var lP=typeof Symbol=="function"&&Symbol.observable||"@@observable",d1=lP,_h=()=>Math.random().toString(36).substring(7).split("").join("."),cP={INIT:`@@redux/INIT${_h()}`,REPLACE:`@@redux/REPLACE${_h()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${_h()}`},eu=cP;function Ip(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function R_(e,t,r){if(typeof e!="function")throw new Error(xr(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(xr(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(xr(1));return r(R_)(e,t)}let n=e,a=t,i=new Map,o=i,l=0,c=!1;function d(){o===i&&(o=new Map,i.forEach((v,b)=>{o.set(b,v)}))}function u(){if(c)throw new Error(xr(3));return a}function h(v){if(typeof v!="function")throw new Error(xr(4));if(c)throw new Error(xr(5));let b=!0;d();const w=l++;return o.set(w,v),function(){if(b){if(c)throw new Error(xr(6));b=!1,d(),o.delete(w),i=null}}}function f(v){if(!Ip(v))throw new Error(xr(7));if(typeof v.type>"u")throw new Error(xr(8));if(typeof v.type!="string")throw new Error(xr(17));if(c)throw new Error(xr(9));try{c=!0,a=n(a,v)}finally{c=!1}return(i=o).forEach(w=>{w()}),v}function m(v){if(typeof v!="function")throw new Error(xr(10));n=v,f({type:eu.REPLACE})}function x(){const v=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(xr(11));function w(){const N=b;N.next&&N.next(u())}return w(),{unsubscribe:v(w)}},[d1](){return this}}}return f({type:eu.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:m,[d1]:x}}function uP(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:eu.INIT})>"u")throw new Error(xr(12));if(typeof r(void 0,{type:eu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(xr(13))})}function M_(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const o=t[i];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{uP(r)}catch(i){a=i}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<n.length;u++){const h=n[u],f=r[h],m=o[h],x=f(m,l);if(typeof x>"u")throw l&&l.type,new Error(xr(14));d[h]=x,c=c||x!==m}return c=c||n.length!==Object.keys(o).length,c?d:o}}function tu(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function dP(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(xr(15))};const o={getState:a.getState,dispatch:(c,...d)=>i(c,...d)},l=e.map(c=>c(o));return i=tu(...l)(a.dispatch),{...a,dispatch:i}}}function F_(e){return Ip(e)&&"type"in e&&typeof e.type=="string"}var L_=Symbol.for("immer-nothing"),h1=Symbol.for("immer-draftable"),qr=Symbol.for("immer-state");function $n(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var pn=Object,Qs=pn.getPrototypeOf,ru="constructor",_d="prototype",em="configurable",nu="enumerable",Bc="writable",el="value",Ma=e=>!!e&&!!e[qr];function Gn(e){return e?B_(e)||Sd(e)||!!e[h1]||!!e[ru]?.[h1]||Ed(e)||Cd(e):!1}var hP=pn[_d][ru].toString(),f1=new WeakMap;function B_(e){if(!e||!Rp(e))return!1;const t=Qs(e);if(t===null||t===pn[_d])return!0;const r=pn.hasOwnProperty.call(t,ru)&&t[ru];if(r===Object)return!0;if(!Is(r))return!1;let n=f1.get(r);return n===void 0&&(n=Function.toString.call(r),f1.set(r,n)),n===hP}function jd(e,t,r=!0){kl(e)===0?(r?Reflect.ownKeys(e):pn.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function kl(e){const t=e[qr];return t?t.type_:Sd(e)?1:Ed(e)?2:Cd(e)?3:0}var m1=(e,t,r=kl(e))=>r===2?e.has(t):pn[_d].hasOwnProperty.call(e,t),tm=(e,t,r=kl(e))=>r===2?e.get(t):e[t],au=(e,t,r,n=kl(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function fP(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Sd=Array.isArray,Ed=e=>e instanceof Map,Cd=e=>e instanceof Set,Rp=e=>typeof e=="object",Is=e=>typeof e=="function",jh=e=>typeof e=="boolean";function mP(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Na=e=>e.copy_||e.base_,Mp=e=>e.modified_?e.copy_:e.base_;function rm(e,t){if(Ed(e))return new Map(e);if(Cd(e))return new Set(e);if(Sd(e))return Array[_d].slice.call(e);const r=B_(e);if(t===!0||t==="class_only"&&!r){const n=pn.getOwnPropertyDescriptors(e);delete n[qr];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],l=n[o];l[Bc]===!1&&(l[Bc]=!0,l[em]=!0),(l.get||l.set)&&(n[o]={[em]:!0,[Bc]:!0,[nu]:l[nu],[el]:e[o]})}return pn.create(Qs(e),n)}else{const n=Qs(e);if(n!==null&&r)return{...e};const a=pn.create(n);return pn.assign(a,e)}}function Fp(e,t=!1){return Td(e)||Ma(e)||!Gn(e)||(kl(e)>1&&pn.defineProperties(e,{set:ic,add:ic,clear:ic,delete:ic}),pn.freeze(e),t&&jd(e,(r,n)=>{Fp(n,!0)},!1)),e}function pP(){$n(2)}var ic={[el]:pP};function Td(e){return e===null||!Rp(e)?!0:pn.isFrozen(e)}var iu="MapSet",nm="Patches",p1="ArrayMethods",$_={};function qi(e){const t=$_[e];return t||$n(0,e),t}var x1=e=>!!$_[e],tl,U_=()=>tl,xP=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:x1(iu)?qi(iu):void 0,arrayMethodsPlugin_:x1(p1)?qi(p1):void 0});function g1(e,t){t&&(e.patchPlugin_=qi(nm),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function am(e){im(e),e.drafts_.forEach(gP),e.drafts_=null}function im(e){e===tl&&(tl=e.parent_)}var v1=e=>tl=xP(tl,e);function gP(e){const t=e[qr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function b1(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[qr].modified_&&(am(t),$n(4)),Gn(e)&&(e=y1(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[qr].base_,e,t)}else e=y1(t,r);return vP(t,e,!0),am(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==L_?e:void 0}function y1(e,t){if(Td(t))return t;const r=t[qr];if(!r)return su(t,e.handledSet_,e);if(!kd(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);W_(r,e)}return r.copy_}function vP(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Fp(t,r)}function H_(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var kd=(e,t)=>e.scope_===t,bP=[];function z_(e,t,r,n){const a=Na(e),i=e.type_;if(n!==void 0&&tm(a,n,i)===t){au(a,n,r,i);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;jd(a,(c,d)=>{if(Ma(d)){const u=l.get(d)||[];u.push(c),l.set(d,u)}})}const o=e.draftLocations_.get(t)??bP;for(const l of o)au(a,l,r,i)}function yP(e,t,r){e.callbacks_.push(function(a){const i=t;if(!i||!kd(i,a))return;a.mapSetPlugin_?.fixSetContents(i);const o=Mp(i);z_(e,i.draft_??i,o,r),W_(i,a)})}function W_(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const a=n.getPath(e);a&&n.generatePatches_(e,a,t)}H_(e)}}function wP(e,t,r){const{scope_:n}=e;if(Ma(r)){const a=r[qr];kd(a,n)&&a.callbacks_.push(function(){$c(e);const o=Mp(a);z_(e,r,o,t)})}else Gn(r)&&e.callbacks_.push(function(){const i=Na(e);e.type_===3?i.has(r)&&su(r,n.handledSet_,n):tm(i,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&su(tm(e.copy_,t,e.type_),n.handledSet_,n)})}function su(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Ma(e)||t.has(e)||!Gn(e)||Td(e)||(t.add(e),jd(e,(n,a)=>{if(Ma(a)){const i=a[qr];if(kd(i,r)){const o=Mp(i);au(e,n,o,e.type_),H_(i)}}else Gn(a)&&su(a,t,r)})),e}function NP(e,t){const r=Sd(e),n={type_:r?1:0,scope_:t?t.scope_:U_(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=ou;r&&(a=[n],i=rl);const{revoke:o,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=o,[l,n]}var ou={get(e,t){if(t===qr)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r?.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=Na(e);if(!m1(a,t,e.type_))return _P(e,a,t);const i=a[t];if(e.finalized_||!Gn(i)||n&&e.operationMethod&&r?.isMutatingArrayMethod(e.operationMethod)&&mP(t))return i;if(i===Sh(e.base_,t)){$c(e);const o=e.type_===1?+t:t,l=om(e.scope_,i,e,o);return e.copy_[o]=l}return i},has(e,t){return t in Na(e)},ownKeys(e){return Reflect.ownKeys(Na(e))},set(e,t,r){const n=V_(Na(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Sh(Na(e),t),i=a?.[qr];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(fP(r,a)&&(r!==void 0||m1(e.base_,t,e.type_)))return!0;$c(e),sm(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),wP(e,t,r)),!0},deleteProperty(e,t){return $c(e),Sh(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),sm(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Na(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Bc]:!0,[em]:e.type_!==1||t!=="length",[nu]:n[nu],[el]:r[t]}},defineProperty(){$n(11)},getPrototypeOf(e){return Qs(e.base_)},setPrototypeOf(){$n(12)}},rl={};for(let e in ou){let t=ou[e];rl[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}rl.deleteProperty=function(e,t){return rl.set.call(this,e,t,void 0)};rl.set=function(e,t,r){return ou.set.call(this,e[0],t,r,e[0])};function Sh(e,t){const r=e[qr];return(r?Na(r):e)[t]}function _P(e,t,r){const n=V_(t,r);return n?el in n?n[el]:n.get?.call(e.draft_):void 0}function V_(e,t){if(!(t in e))return;let r=Qs(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Qs(r)}}function sm(e){e.modified_||(e.modified_=!0,e.parent_&&sm(e.parent_))}function $c(e){e.copy_||(e.assigned_=new Map,e.copy_=rm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var jP=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Is(r)&&!Is(n)){const o=n;n=r;const l=this;return function(d=o,...u){return l.produce(d,h=>n.call(this,h,...u))}}Is(n)||$n(6),a!==void 0&&!Is(a)&&$n(7);let i;if(Gn(r)){const o=v1(this),l=om(o,r,void 0);let c=!0;try{i=n(l),c=!1}finally{c?am(o):im(o)}return g1(o,a),b1(i,o)}else if(!r||!Rp(r)){if(i=n(r),i===void 0&&(i=r),i===L_&&(i=void 0),this.autoFreeze_&&Fp(i,!0),a){const o=[],l=[];qi(nm).generateReplacementPatches_(r,i,{patches_:o,inversePatches_:l}),a(o,l)}return i}else $n(1,r)},this.produceWithPatches=(r,n)=>{if(Is(r))return(l,...c)=>this.produceWithPatches(l,d=>r(d,...c));let a,i;return[this.produce(r,n,(l,c)=>{a=l,i=c}),a,i]},jh(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),jh(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),jh(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Gn(t)||$n(8),Ma(t)&&(t=Vn(t));const r=v1(this),n=om(r,t,void 0);return n[qr].isManual_=!0,im(r),n}finishDraft(t,r){const n=t&&t[qr];(!n||!n.isManual_)&&$n(9);const{scope_:a}=n;return g1(a,r),b1(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const i=r[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(r=r.slice(n+1));const a=qi(nm).applyPatches_;return Ma(t)?a(t,r):this.produce(t,i=>a(i,r))}};function om(e,t,r,n){const[a,i]=Ed(t)?qi(iu).proxyMap_(t,r):Cd(t)?qi(iu).proxySet_(t,r):NP(t,r);return(r?.scope_??U_()).drafts_.push(a),i.callbacks_=r?.callbacks_??[],i.key_=n,r&&n!==void 0?yP(r,i,n):i.callbacks_.push(function(c){c.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:d}=c;i.modified_&&d&&d.generatePatches_(i,[],c)}),a}function Vn(e){return Ma(e)||$n(10,e),K_(e)}function K_(e){if(!Gn(e)||Td(e))return e;const t=e[qr];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=rm(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=rm(e,!0);return jd(r,(a,i)=>{au(r,a,K_(i))},n),t&&(t.finalized_=!1),r}var SP=new jP,G_=SP.produce;function X_(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var EP=X_(),CP=X_,TP=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?tu:tu.apply(null,arguments)};function Dn(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(gn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>F_(n)&&n.type===e,r}var Y_=class $o extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,$o.prototype)}static get[Symbol.species](){return $o}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new $o(...t[0].concat(this)):new $o(...t.concat(this))}};function w1(e){return Gn(e)?G_(e,()=>{}):e}function sc(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function kP(e){return typeof e=="boolean"}var AP=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let o=new Y_;return r&&(kP(r)?o.push(EP):o.push(CP(r.extraArgument))),o},q_="RTK_autoBatch",Et=()=>e=>({payload:e,meta:{[q_]:!0}}),N1=e=>t=>{setTimeout(t,e)},Z_=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:N1(10):e.type==="callback"?e.queueNotification:N1(e.timeout),d=()=>{o=!1,i&&(i=!1,l.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>a&&u(),f=n.subscribe(h);return l.add(u),()=>{f(),l.delete(u)}},dispatch(u){try{return a=!u?.meta?.[q_],i=!a,i&&(o||(o=!0,c(d))),n.dispatch(u)}finally{a=!0}}})},PP=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new Y_(e);return n&&a.push(Z_(typeof n=="object"?n:void 0)),a};function OP(e){const t=AP(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(Ip(r))l=M_(r);else throw new Error(gn(1));let c;typeof n=="function"?c=n(t):c=t();let d=tu;a&&(d=TP({trace:!1,...typeof a=="object"&&a}));const u=dP(...c),h=PP(u);let f=typeof o=="function"?o(h):h();const m=d(...f);return R_(l,i,m)}function J_(e){const t={},r=[];let n;const a={addCase(i,o){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(gn(28));if(l in t)throw new Error(gn(29));return t[l]=o,a},addAsyncThunk(i,o){return o.pending&&(t[i.pending.type]=o.pending),o.rejected&&(t[i.rejected.type]=o.rejected),o.fulfilled&&(t[i.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:i.settled,reducer:o.settled}),a},addMatcher(i,o){return r.push({matcher:i,reducer:o}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function DP(e){return typeof e=="function"}function IP(e,t){let[r,n,a]=J_(t),i;if(DP(e))i=()=>w1(e());else{const l=w1(e);i=()=>l}function o(l=i(),c){let d=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,h)=>{if(h)if(Ma(u)){const m=h(u,c);return m===void 0?u:m}else{if(Gn(u))return G_(u,f=>h(f,c));{const f=h(u,c);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},l)}return o.getInitialState=i,o}var RP="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",MP=(e=21)=>{let t="",r=e;for(;r--;)t+=RP[Math.random()*64|0];return t},FP=Symbol.for("rtk-slice-createasyncthunk");function LP(e,t){return`${e}/${t}`}function BP({creators:e}={}){const t=e?.asyncThunk?.[FP];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(gn(11));const o=(typeof n.reducers=="function"?n.reducers(UP()):n.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(y,N){const _=typeof y=="string"?y:y.type;if(!_)throw new Error(gn(12));if(_ in c.sliceCaseReducersByType)throw new Error(gn(13));return c.sliceCaseReducersByType[_]=N,d},addMatcher(y,N){return c.sliceMatchers.push({matcher:y,reducer:N}),d},exposeAction(y,N){return c.actionCreators[y]=N,d},exposeCaseReducer(y,N){return c.sliceCaseReducersByName[y]=N,d}};l.forEach(y=>{const N=o[y],_={reducerName:y,type:LP(a,y),createNotation:typeof n.reducers=="function"};zP(N)?VP(_,N,d,t):HP(_,N,d)});function u(){const[y={},N=[],_=void 0]=typeof n.extraReducers=="function"?J_(n.extraReducers):[n.extraReducers],S={...y,...c.sliceCaseReducersByType};return IP(n.initialState,j=>{for(let E in S)j.addCase(E,S[E]);for(let E of c.sliceMatchers)j.addMatcher(E.matcher,E.reducer);for(let E of N)j.addMatcher(E.matcher,E.reducer);_&&j.addDefaultCase(_)})}const h=y=>y,f=new Map,m=new WeakMap;let x;function g(y,N){return x||(x=u()),x(y,N)}function v(){return x||(x=u()),x.getInitialState()}function b(y,N=!1){function _(j){let E=j[y];return typeof E>"u"&&N&&(E=sc(m,_,v)),E}function S(j=h){const E=sc(f,N,()=>new WeakMap);return sc(E,j,()=>{const k={};for(const[T,A]of Object.entries(n.selectors??{}))k[T]=$P(A,j,()=>sc(m,j,v),N);return k})}return{reducerPath:y,getSelectors:S,get selectors(){return S(_)},selectSlice:_}}const w={name:a,reducer:g,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...b(i),injectInto(y,{reducerPath:N,..._}={}){const S=N??i;return y.inject({reducerPath:S,reducer:g},_),{...w,...b(S,!0)}}};return w}}function $P(e,t,r,n){function a(i,...o){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return a.unwrapped=e,a}var sn=BP();function UP(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function HP({type:e,reducerName:t,createNotation:r},n,a){let i,o;if("reducer"in n){if(r&&!WP(n))throw new Error(gn(17));i=n.reducer,o=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,o?Dn(e,o):Dn(e))}function zP(e){return e._reducerDefinitionType==="asyncThunk"}function WP(e){return e._reducerDefinitionType==="reducerWithPrepare"}function VP({type:e,reducerName:t},r,n,a){if(!a)throw new Error(gn(18));const{payloadCreator:i,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=r,h=a(e,i,u);n.exposeAction(t,h),o&&n.addCase(h.fulfilled,o),l&&n.addCase(h.pending,l),c&&n.addCase(h.rejected,c),d&&n.addMatcher(h.settled,d),n.exposeCaseReducer(t,{fulfilled:o||oc,pending:l||oc,rejected:c||oc,settled:d||oc})}function oc(){}var KP="task",Q_="listener",e5="completed",Lp="cancelled",GP=`task-${Lp}`,XP=`task-${e5}`,lm=`${Q_}-${Lp}`,YP=`${Q_}-${e5}`,Ad=class{constructor(e){this.code=e,this.message=`${KP} ${Lp} (reason: ${e})`}name="TaskAbortError";message},Bp=(e,t)=>{if(typeof e!="function")throw new TypeError(gn(32))},lu=()=>{},t5=(e,t=lu)=>(e.catch(t),e),r5=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ui=e=>{if(e.aborted)throw new Ad(e.reason)};function n5(e,t){let r=lu;return new Promise((n,a)=>{const i=()=>a(new Ad(e.reason));if(e.aborted){i();return}r=r5(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=lu})}var qP=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Ad?"cancelled":"rejected",error:r}}finally{t?.()}},cu=e=>t=>t5(n5(e,t).then(r=>(Ui(e),r))),a5=e=>{const t=cu(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:zs}=Object,_1={},Pd="listenerMiddleware",ZP=(e,t)=>{const r=n=>r5(e,()=>n.abort(e.reason));return(n,a)=>{Bp(n);const i=new AbortController;r(i);const o=qP(async()=>{Ui(e),Ui(i.signal);const l=await n({pause:cu(i.signal),delay:a5(i.signal),signal:i.signal});return Ui(i.signal),l},()=>i.abort(XP));return a?.autoJoin&&t.push(o.catch(lu)),{result:cu(e)(o),cancel(){i.abort(GP)}}}},JP=(e,t)=>{const r=async(n,a)=>{Ui(t);let i=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:n,effect:(h,f)=>{f.unsubscribe(),c([h,f.getState(),f.getOriginalState()])}});i=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await n5(t,Promise.race(l));return Ui(t),c}finally{i()}};return(n,a)=>t5(r(n,a))},i5=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Dn(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(gn(21));return Bp(i),{predicate:a,type:t,effect:i}},s5=zs(e=>{const{type:t,predicate:r,effect:n}=i5(e);return{id:MP(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(gn(22))}}},{withTypes:()=>s5}),j1=(e,t)=>{const{type:r,effect:n,predicate:a}=i5(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},cm=e=>{e.pending.forEach(t=>{t.abort(lm)})},QP=(e,t)=>()=>{for(const r of t.keys())cm(r);e.clear()},S1=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},o5=zs(Dn(`${Pd}/add`),{withTypes:()=>o5}),eO=Dn(`${Pd}/removeAll`),l5=zs(Dn(`${Pd}/remove`),{withTypes:()=>l5}),tO=(...e)=>{console.error(`${Pd}/error`,...e)},Al=(e={})=>{const t=new Map,r=new Map,n=m=>{const x=r.get(m)??0;r.set(m,x+1)},a=m=>{const x=r.get(m)??1;x===1?r.delete(m):r.set(m,x-1)},{extra:i,onError:o=tO}=e;Bp(o);const l=m=>(m.unsubscribe=()=>t.delete(m.id),t.set(m.id,m),x=>{m.unsubscribe(),x?.cancelActive&&cm(m)}),c=m=>{const x=j1(t,m)??s5(m);return l(x)};zs(c,{withTypes:()=>c});const d=m=>{const x=j1(t,m);return x&&(x.unsubscribe(),m.cancelActive&&cm(x)),!!x};zs(d,{withTypes:()=>d});const u=async(m,x,g,v)=>{const b=new AbortController,w=JP(c,b.signal),y=[];try{m.pending.add(b),n(m),await Promise.resolve(m.effect(x,zs({},g,{getOriginalState:v,condition:(N,_)=>w(N,_).then(Boolean),take:w,delay:a5(b.signal),pause:cu(b.signal),extra:i,signal:b.signal,fork:ZP(b.signal,y),unsubscribe:m.unsubscribe,subscribe:()=>{t.set(m.id,m)},cancelActiveListeners:()=>{m.pending.forEach((N,_,S)=>{N!==b&&(N.abort(lm),S.delete(N))})},cancel:()=>{b.abort(lm),m.pending.delete(b)},throwIfCancelled:()=>{Ui(b.signal)}})))}catch(N){N instanceof Ad||S1(o,N,{raisedBy:"effect"})}finally{await Promise.all(y),b.abort(YP),a(m),m.pending.delete(b)}},h=QP(t,r);return{middleware:m=>x=>g=>{if(!F_(g))return x(g);if(o5.match(g))return c(g.payload);if(eO.match(g)){h();return}if(l5.match(g))return d(g.payload);let v=m.getState();const b=()=>{if(v===_1)throw new Error(gn(23));return v};let w;try{if(w=x(g),t.size>0){const y=m.getState(),N=Array.from(t.values());for(const _ of N){let S=!1;try{S=_.predicate(g,y,v)}catch(j){S=!1,S1(o,j,{raisedBy:"predicate"})}S&&u(_,g,m,b)}}}finally{v=_1}return w},startListening:c,stopListening:d,clearListeners:h}};function gn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var rO={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},c5=sn({name:"chartLayout",initialState:rO,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:nO,setLayout:aO,setChartSize:iO,setScale:sO}=c5.actions,oO=c5.reducer;function u5(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function et(e){return Number.isFinite(e)}function fa(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function E1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E1(Object(r),!0).forEach(function(n){lO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lO(e,t,r){return(t=cO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cO(e){var t=uO(e,"string");return typeof t=="symbol"?t:t+""}function uO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xt(e,t,r){return Mt(e)||Mt(t)?r:ha(t)?Xi(e,t,r):typeof t=="function"?t(e):r}var dO=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&i!=="center"&&Ie(e[i]))return Ls(Ls({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&o!=="middle"&&Ie(e[o]))return Ls(Ls({},e),{},{[o]:e[o]+(a||0)})}return e},Ga=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",d5=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,o=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||o.push(t),i||o.push(r),o},h5=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:h,niceTicks:f,axisType:m}=e;if(!o)return null;var x=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=a==="category"&&o.bandwidth?o.bandwidth()/x:0;if(g=m==="angleAxis"&&i&&i.length>=2?lr(i[0]-i[1])*2*g:g,h||f){var v=(h||f||[]).map((b,w)=>{var y=n?n.indexOf(b):b,N=o.map(y);return et(N)?{coordinate:N+g,value:b,offset:g,index:w}:null}).filter(tn);return v}return c&&d?d.map((b,w)=>{var y=o.map(b);return et(y)?{coordinate:y+g,value:b,index:w,offset:g}:null}).filter(tn):o.ticks&&u!=null?o.ticks(u).map((b,w)=>{var y=o.map(b);return et(y)?{coordinate:y+g,value:b,index:w,offset:g}:null}).filter(tn):o.domain().map((b,w)=>{var y=o.map(b);return et(y)?{coordinate:y+g,value:n?n[b]:b,index:w,offset:g}:null}).filter(tn)},hO=(e,t)=>{if(!t||t.length!==2||!Ie(t[0])||!Ie(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Ie(e[0])||e[0]<r)&&(a[0]=r),(!Ie(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},fO=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,o=0,l=0;l<r;++l){var c=e[l],d=c?.[a];if(d!=null){var u=d[1],h=d[0],f=da(u)?h:u;f>=0?(d[0]=i,i+=f,d[1]=i):(d[0]=o,o+=f,d[1]=o)}}}},mO=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,o=0;o<r;++o){var l=e[o],c=l?.[a];if(c!=null){var d=da(c[1])?c[0]:c[1];d>=0?(c[0]=i,i+=d,c[1]=i):(c[0]=0,c[1]=0)}}}},pO={sign:fO,expand:zA,none:Gi,silhouette:WA,wiggle:VA,positive:mO},xO=(e,t,r)=>{var n,a=(n=pO[r])!==null&&n!==void 0?n:Gi,i=HA().keys(t).value((l,c)=>Number(xt(l,c,0))).order(Jf).offset(a),o=i(e);return o.forEach((l,c)=>{l.forEach((d,u)=>{var h=xt(e[u],t[c],0);Array.isArray(h)&&h.length===2&&Ie(h[0])&&Ie(h[1])&&(d[0]=h[0],d[1]=h[1])})}),o};function gO(e){return e==null?void 0:String(e)}function C1(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Mt(a[t.dataKey])){var l=b_(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[i]?r[i].coordinate+n/2:null}var c=xt(a,Mt(o)?t.dataKey:o),d=t.scale.map(c);return Ie(d)?d:null}var T1=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=xt(i,t.dataKey,t.scale.domain()[o]);if(Mt(l))return null;var c=t.scale.map(l);return Ie(c)?c-a/2+n:null},vO=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},bO=e=>{var t=e.flat(2).filter(Ie);return[Math.min(...t),Math.max(...t)]},yO=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],wO=(e,t,r)=>{if(e!=null)return yO(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:o}=i,l=o.reduce((c,d)=>{var u=u5(d,t,r),h=bO(u);return!et(h[0])||!et(h[1])?c:[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},k1=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,A1=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,eo=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Nd(t,u=>u.coordinate),i=1/0,o=1,l=a.length;o<l;o++){var c=a[o],d=a[o-1];i=Math.min((c?.coordinate||0)-(d?.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function P1(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Ls(Ls({},t),{},{dataKey:r,payload:n,value:a,name:i})}function oo(e,t){if(e)return String(e);if(typeof t=="string")return t}var NO=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},_O=(e,t)=>t==="centric"?e.angle:e.radius,Xa=e=>e.layout.width,Ya=e=>e.layout.height,jO=e=>e.layout.scale,f5=e=>e.layout.margin,Od=Q(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Dd=Q(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),m5="data-recharts-item-index",p5="data-recharts-item-id",Pl=60;function O1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O1(Object(r),!0).forEach(function(n){SO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SO(e,t,r){return(t=EO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EO(e){var t=CO(e,"string");return typeof t=="symbol"?t:t+""}function CO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TO=e=>e.brush.height;function kO(e){var t=Dd(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Pl;return r+a}return r},0)}function AO(e){var t=Dd(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Pl;return r+a}return r},0)}function PO(e){var t=Od(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function OO(e){var t=Od(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var tr=Q([Xa,Ya,f5,TO,kO,AO,PO,OO,I_,iP],(e,t,r,n,a,i,o,l,c,d)=>{var u={left:(r.left||0)+a,right:(r.right||0)+i},h={top:(r.top||0)+o,bottom:(r.bottom||0)+l},f=lc(lc({},h),u),m=f.bottom;f.bottom+=n,f=dO(f,c,d);var x=e-f.left-f.right,g=t-f.top-f.bottom;return lc(lc({brushBottom:m},f),{},{width:Math.max(x,0),height:Math.max(g,0)})}),DO=Q(tr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),$p=Q(Xa,Ya,(e,t)=>({x:0,y:0,width:e,height:t})),IO=p.createContext(null),Mr=()=>p.useContext(IO)!=null,Id=e=>e.brush,Rd=Q([Id,tr,f5],(e,t,r)=>({height:e.height,x:Ie(e.x)?e.x:t.left,y:Ie(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:Ie(e.width)?e.width:t.width})),Eh={},Ch={},Th={},D1;function RO(){return D1||(D1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let o,l=null;const c=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},h=()=>{d&&u(),g()};let f=null;const m=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,h()},n)},x=()=>{f!==null&&(clearTimeout(f),f=null)},g=()=>{x(),o=void 0,l=null},v=()=>{u()},b=function(...w){if(a?.aborted)return;o=this,l=w;const y=f==null;m(),c&&y&&u()};return b.schedule=m,b.cancel=g,b.flush=v,a?.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Th)),Th}var I1;function MO(){return I1||(I1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RO();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:o=!1,trailing:l=!0,maxWait:c}=i,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,h=null;const f=t.debounce(function(...g){u=n.apply(this,g),h=null},a,{edges:d}),m=function(...g){return c!=null&&(h===null&&(h=Date.now()),Date.now()-h>=c)?(u=n.apply(this,g),h=Date.now(),f.cancel(),f.schedule(),u):(f.apply(this,g),u)},x=()=>(f.flush(),u);return m.cancel=f.cancel,m.flush=x,m}e.debounce=r})(Ch)),Ch}var R1;function FO(){return R1||(R1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MO();function r(n,a=0,i={}){const{leading:o=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:o,maxWait:a,trailing:l})}e.throttle=r})(Eh)),Eh}var kh,M1;function LO(){return M1||(M1=1,kh=FO().throttle),kh}var BO=LO();const $O=wi(BO);var uu=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},sa={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},x5=(e,t,r)=>{var{width:n=sa.width,height:a=sa.height,aspect:i,maxHeight:o}=r,l=Yi(n)?e:Number(n),c=Yi(a)?t:Number(a);return i&&i>0&&(l?c=l/i:c&&(l=c*i),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},UO={width:0,height:0,overflow:"visible"},HO={width:0,overflowX:"visible"},zO={height:0,overflowY:"visible"},WO={},VO=e=>{var{width:t,height:r}=e,n=Yi(t),a=Yi(r);return n&&a?UO:n?HO:a?zO:WO};function KO(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a=sa.width,i=sa.height):a===void 0?a=n&&n>0?void 0:sa.width:i===void 0&&(i=n&&n>0?void 0:sa.height),{width:a,height:i}}function um(){return um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},um.apply(null,arguments)}function F1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function L1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F1(Object(r),!0).forEach(function(n){GO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GO(e,t,r){return(t=XO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XO(e){var t=YO(e,"string");return typeof t=="symbol"?t:t+""}function YO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g5=p.createContext(sa.initialDimension);function qO(e){return fa(e.width)&&fa(e.height)}function v5(e){var{children:t,width:r,height:n}=e,a=p.useMemo(()=>({width:r,height:n}),[r,n]);return qO(a)?p.createElement(g5.Provider,{value:a},t):null}var Up=()=>p.useContext(g5),ZO=p.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=sa.initialDimension,width:a,height:i,minWidth:o=sa.minWidth,minHeight:l,maxHeight:c,children:d,debounce:u=sa.debounce,id:h,className:f,onResize:m,style:x={}}=e,g=p.useRef(null),v=p.useRef();v.current=m,p.useImperativeHandle(t,()=>g.current);var[b,w]=p.useState({containerWidth:n.width,containerHeight:n.height}),y=p.useCallback((E,k)=>{w(T=>{var A=Math.round(E),C=Math.round(k);return T.containerWidth===A&&T.containerHeight===C?T:{containerWidth:A,containerHeight:C}})},[]);p.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return cs;var E=C=>{var R,G=C[0];if(G!=null){var{width:V,height:X}=G.contentRect;y(V,X),(R=v.current)===null||R===void 0||R.call(v,V,X)}};u>0&&(E=$O(E,u,{trailing:!0,leading:!1}));var k=new ResizeObserver(E),{width:T,height:A}=g.current.getBoundingClientRect();return y(T,A),k.observe(g.current),()=>{k.disconnect()}},[y,u]);var{containerWidth:N,containerHeight:_}=b;uu(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:S,calculatedHeight:j}=x5(N,_,{width:a,height:i,aspect:r,maxHeight:c});return uu(S!=null&&S>0||j!=null&&j>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,j,a,i,o,l,r),p.createElement("div",{id:h?"".concat(h):void 0,className:lt("recharts-responsive-container",f),style:L1(L1({},x),{},{width:a,height:i,minWidth:o,minHeight:l,maxHeight:c}),ref:g},p.createElement("div",{style:VO({width:a,height:i})},p.createElement(v5,{width:S,height:j},d)))}),Hp=p.forwardRef((e,t)=>{var r=Up();if(fa(r.width)&&fa(r.height))return e.children;var{width:n,height:a}=KO({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:o}=x5(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Ie(i)&&Ie(o)?p.createElement(v5,{width:i,height:o},e.children):p.createElement(ZO,um({},e,{width:n,height:a,ref:t}))});function zp(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Md=()=>{var e,t=Mr(),r=Fe(DO),n=Fe(Rd),a=(e=Fe(Id))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},JO={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},b5=()=>{var e;return(e=Fe(tr))!==null&&e!==void 0?e:JO},y5=()=>Fe(Xa),w5=()=>Fe(Ya),at=e=>e.layout.layoutType,us=()=>Fe(at),N5=()=>{var e=us();if(e==="horizontal"||e==="vertical")return e},_5=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},QO=()=>{var e=us();return e!==void 0},Ol=e=>{var t=Ot(),r=Mr(),{width:n,height:a}=e,i=Up(),o=n,l=a;return i&&(o=i.width>0?i.width:n,l=i.height>0?i.height:a),p.useEffect(()=>{!r&&fa(o)&&fa(l)&&t(iO({width:o,height:l}))},[t,r,o,l]),null},j5=Symbol.for("immer-nothing"),B1=Symbol.for("immer-draftable"),yn=Symbol.for("immer-state");function Un(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var nl=Object.getPrototypeOf;function to(e){return!!e&&!!e[yn]}function Zi(e){return e?S5(e)||Array.isArray(e)||!!e[B1]||!!e.constructor?.[B1]||Dl(e)||Ld(e):!1}var eD=Object.prototype.constructor.toString(),$1=new WeakMap;function S5(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=$1.get(r);return n===void 0&&(n=Function.toString.call(r),$1.set(r,n)),n===eD}function du(e,t,r=!0){Fd(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Fd(e){const t=e[yn];return t?t.type_:Array.isArray(e)?1:Dl(e)?2:Ld(e)?3:0}function dm(e,t){return Fd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function E5(e,t,r){const n=Fd(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function tD(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Dl(e){return e instanceof Map}function Ld(e){return e instanceof Set}function Oi(e){return e.copy_||e.base_}function hm(e,t){if(Dl(e))return new Map(e);if(Ld(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=S5(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[yn];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const o=a[i],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(nl(e),n)}else{const n=nl(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Wp(e,t=!1){return Bd(e)||to(e)||!Zi(e)||(Fd(e)>1&&Object.defineProperties(e,{set:cc,add:cc,clear:cc,delete:cc}),Object.freeze(e),t&&Object.values(e).forEach(r=>Wp(r,!0))),e}function rD(){Un(2)}var cc={value:rD};function Bd(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var nD={};function Ji(e){const t=nD[e];return t||Un(0,e),t}var al;function C5(){return al}function aD(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function U1(e,t){t&&(Ji("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function fm(e){mm(e),e.drafts_.forEach(iD),e.drafts_=null}function mm(e){e===al&&(al=e.parent_)}function H1(e){return al=aD(al,e)}function iD(e){const t=e[yn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function z1(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[yn].modified_&&(fm(t),Un(4)),Zi(e)&&(e=hu(t,e),t.parent_||fu(t,e)),t.patches_&&Ji("Patches").generateReplacementPatches_(r[yn].base_,e,t.patches_,t.inversePatches_)):e=hu(t,r,[]),fm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==j5?e:void 0}function hu(e,t,r){if(Bd(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[yn];if(!a)return du(t,(i,o)=>W1(e,a,t,i,o,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return fu(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let o=i,l=!1;a.type_===3&&(o=new Set(i),i.clear(),l=!0),du(o,(c,d)=>W1(e,a,i,c,d,r,l),n),fu(e,i,!1),r&&e.patches_&&Ji("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function W1(e,t,r,n,a,i,o){if(a==null||typeof a!="object"&&!o)return;const l=Bd(a);if(!(l&&!o)){if(to(a)){const c=i&&t&&t.type_!==3&&!dm(t.assigned_,n)?i.concat(n):void 0,d=hu(e,a,c);if(E5(r,n,d),to(d))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(Zi(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&l)return;hu(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Dl(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&fu(e,a)}}}function fu(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Wp(t,r)}function sD(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:C5(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Vp;r&&(a=[n],i=il);const{revoke:o,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=o,l}var Vp={get(e,t){if(t===yn)return e;const r=Oi(e);if(!dm(r,t))return oD(e,r,t);const n=r[t];return e.finalized_||!Zi(n)?n:n===Ah(e.base_,t)?(Ph(e),e.copy_[t]=xm(n,e)):n},has(e,t){return t in Oi(e)},ownKeys(e){return Reflect.ownKeys(Oi(e))},set(e,t,r){const n=T5(Oi(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Ah(Oi(e),t),i=a?.[yn];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(tD(r,a)&&(r!==void 0||dm(e.base_,t)))return!0;Ph(e),pm(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ah(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ph(e),pm(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Oi(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Un(11)},getPrototypeOf(e){return nl(e.base_)},setPrototypeOf(){Un(12)}},il={};du(Vp,(e,t)=>{il[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});il.deleteProperty=function(e,t){return il.set.call(this,e,t,void 0)};il.set=function(e,t,r){return Vp.set.call(this,e[0],t,r,e[0])};function Ah(e,t){const r=e[yn];return(r?Oi(r):e)[t]}function oD(e,t,r){const n=T5(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function T5(e,t){if(!(t in e))return;let r=nl(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=nl(r)}}function pm(e){e.modified_||(e.modified_=!0,e.parent_&&pm(e.parent_))}function Ph(e){e.copy_||(e.copy_=hm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var lD=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...d){return o.produce(c,u=>r.call(this,u,...d))}}typeof r!="function"&&Un(6),n!==void 0&&typeof n!="function"&&Un(7);let a;if(Zi(t)){const i=H1(this),o=xm(t,void 0);let l=!0;try{a=r(o),l=!1}finally{l?fm(i):mm(i)}return U1(i,n),z1(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===j5&&(a=void 0),this.autoFreeze_&&Wp(a,!0),n){const i=[],o=[];Ji("Patches").generateReplacementPatches_(t,a,i,o),n(i,o)}return a}else Un(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,a;return[this.produce(t,r,(o,l)=>{n=o,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Zi(e)||Un(8),to(e)&&(e=cD(e));const t=H1(this),r=xm(e,void 0);return r[yn].isManual_=!0,mm(t),r}finishDraft(e,t){const r=e&&e[yn];(!r||!r.isManual_)&&Un(9);const{scope_:n}=r;return U1(n,t),z1(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Ji("Patches").applyPatches_;return to(e)?n(e,t):this.produce(e,a=>n(a,t))}};function xm(e,t){const r=Dl(e)?Ji("MapSet").proxyMap_(e,t):Ld(e)?Ji("MapSet").proxySet_(e,t):sD(e,t);return(t?t.scope_:C5()).drafts_.push(r),r}function cD(e){return to(e)||Un(10,e),k5(e)}function k5(e){if(!Zi(e)||Bd(e))return e;const t=e[yn];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=hm(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=hm(e,!0);return du(r,(a,i)=>{E5(r,a,k5(i))},n),t&&(t.finalized_=!1),r}var uD=new lD;uD.produce;var dD={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},A5=sn({name:"legend",initialState:dD,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Et()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Vn(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:Et()},removeLegendPayload:{reducer(e,t){var r=Vn(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Et()}}}),{setLegendSize:wne,setLegendSettings:Nne,addLegendPayload:P5,replaceLegendPayload:O5,removeLegendPayload:D5}=A5.actions,hD=A5.reducer;function gm(){return gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gm.apply(null,arguments)}function V1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function To(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V1(Object(r),!0).forEach(function(n){fD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fD(e,t,r){return(t=mD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mD(e){var t=pD(e,"string");return typeof t=="symbol"?t:t+""}function pD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xD(e){return Array.isArray(e)&&ha(e[0])&&ha(e[1])?e.join(" ~ "):e}var Ns={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},gD=e=>{var{separator:t=Ns.separator,contentStyle:r,itemStyle:n,labelStyle:a=Ns.labelStyle,payload:i,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:h,accessibilityLayer:f=Ns.accessibilityLayer}=e,m=()=>{if(i&&i.length){var _={padding:0,margin:0},S=(l?Nd(i,l):i).map((j,E)=>{if(j.type==="none")return null;var k=j.formatter||o||xD,{value:T,name:A}=j,C=T,R=A;if(k){var G=k(T,A,j,E,i);if(Array.isArray(G))[C,R]=G;else if(G!=null)C=G;else return null}var V=To(To({},Ns.itemStyle),{},{color:j.color||Ns.itemStyle.color},n);return p.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(E),style:V},ha(R)?p.createElement("span",{className:"recharts-tooltip-item-name"},R):null,ha(R)?p.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,p.createElement("span",{className:"recharts-tooltip-item-value"},C),p.createElement("span",{className:"recharts-tooltip-item-unit"},j.unit||""))});return p.createElement("ul",{className:"recharts-tooltip-item-list",style:_},S)}return null},x=To(To({},Ns.contentStyle),r),g=To({margin:0},a),v=!Mt(u),b=v?u:"",w=lt("recharts-default-tooltip",c),y=lt("recharts-tooltip-label",d);v&&h&&i!==void 0&&i!==null&&(b=h(u,i));var N=f?{role:"status","aria-live":"assertive"}:{};return p.createElement("div",gm({className:w,style:x},N),p.createElement("p",{className:y,style:g},p.isValidElement(b)?b:"".concat(b)),m())},ko="recharts-tooltip-wrapper",vD={visibility:"hidden"};function bD(e){var{coordinate:t,translateX:r,translateY:n}=e;return lt(ko,{["".concat(ko,"-right")]:Ie(r)&&t&&Ie(t.x)&&r>=t.x,["".concat(ko,"-left")]:Ie(r)&&t&&Ie(t.x)&&r<t.x,["".concat(ko,"-bottom")]:Ie(n)&&t&&Ie(t.y)&&n>=t.y,["".concat(ko,"-top")]:Ie(n)&&t&&Ie(t.y)&&n<t.y})}function K1(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:a,position:i,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(i&&Ie(i[n]))return i[n];var u=r[n]-l-(a>0?a:0),h=r[n]+a;if(t[n])return o[n]?u:h;var f=c[n];if(f==null)return 0;if(o[n]){var m=u,x=f;return m<x?Math.max(h,f):Math.max(u,f)}if(d==null)return 0;var g=h+l,v=f+d;return g>v?Math.max(u,f):Math.max(h,f)}function yD(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function wD(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:a,position:i,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:d}=e,u,h,f;return l.height>0&&l.width>0&&r?(h=K1({allowEscapeViewBox:t,coordinate:r,key:"x",offset:a,position:i,reverseDirection:o,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),f=K1({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:i,reverseDirection:o,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),u=yD({translateX:h,translateY:f,useTranslate3d:c})):u=vD,{cssProperties:u,cssClasses:bD({translateX:h,translateY:f,coordinate:r})}}function G1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G1(Object(r),!0).forEach(function(n){vm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vm(e,t,r){return(t=ND(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ND(e){var t=_D(e,"string");return typeof t=="symbol"?t:t+""}function _D(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jD extends p.PureComponent{constructor(){super(...arguments),vm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),vm(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:h,useTranslate3d:f,viewBox:m,wrapperStyle:x,lastBoundingBox:g,innerRef:v,hasPortalFromProps:b}=this.props,w=typeof d=="number"?d:d.x,y=typeof d=="number"?d:d.y,{cssClasses:N,cssProperties:_}=wD({allowEscapeViewBox:r,coordinate:o,offsetLeft:w,offsetTop:y,position:u,reverseDirection:h,tooltipBox:{height:g.height,width:g.width},useTranslate3d:f,viewBox:m}),S=b?{}:uc(uc({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),j=uc(uc({},S),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return p.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:N,style:j,ref:v},i)}}var I5=()=>{var e;return(e=Fe(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function bm(){return bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bm.apply(null,arguments)}function X1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X1(Object(r),!0).forEach(function(n){SD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SD(e,t,r){return(t=ED(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ED(e){var t=CD(e,"string");return typeof t=="symbol"?t:t+""}function CD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q1={curveBasisClosed:PA,curveBasisOpen:OA,curveBasis:AA,curveBumpX:xA,curveBumpY:gA,curveLinearClosed:DA,curveLinear:bd,curveMonotoneX:IA,curveMonotoneY:RA,curveNatural:MA,curveStep:FA,curveStepAfter:BA,curveStepBefore:LA},mu=e=>et(e.x)&&et(e.y),Z1=e=>e.base!=null&&mu(e.base)&&mu(e),Ao=e=>e.x,Po=e=>e.y,TD=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Tl(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=q1["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return q1[r]||bd},J1={connectNulls:!1,type:"linear"},kD=e=>{var{type:t=J1.type,points:r=[],baseLine:n,layout:a,connectNulls:i=J1.connectNulls}=e,o=TD(t,a),l=i?r.filter(mu):r;if(Array.isArray(n)){var c,d=r.map((x,g)=>Y1(Y1({},x),{},{base:n[g]}));a==="vertical"?c=rc().y(Po).x1(Ao).x0(x=>x.base.x):c=rc().x(Ao).y1(Po).y0(x=>x.base.y);var u=c.defined(Z1).curve(o),h=i?d.filter(Z1):d;return u(h)}var f;a==="vertical"&&Ie(n)?f=rc().y(Po).x1(Ao).x0(n):Ie(n)?f=rc().x(Ao).y1(Po).y0(n):f=s_().x(Ao).y(Po);var m=f.defined(mu).curve(o);return m(l)},Kp=e=>{var{className:t,points:r,path:n,pathRef:a}=e,i=us();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},l=r&&r.length?kD(o):n;return p.createElement("path",bm({},bn(e),Ap(e),{className:lt("recharts-curve",t),d:l===null?void 0:l,ref:a}))},AD=["x","y","top","left","width","height","className"];function ym(){return ym=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ym.apply(null,arguments)}function Q1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q1(Object(r),!0).forEach(function(n){OD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OD(e,t,r){return(t=DD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DD(e){var t=ID(e,"string");return typeof t=="symbol"?t:t+""}function ID(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RD(e,t){if(e==null)return{};var r,n,a=MD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function MD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FD=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),LD=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:o=0,className:l}=e,c=RD(e,AD),d=PD({x:t,y:r,top:n,left:a,width:i,height:o},c);return!Ie(t)||!Ie(r)||!Ie(i)||!Ie(o)||!Ie(n)||!Ie(a)?null:p.createElement("path",ym({},Yr(d),{className:lt("recharts-cross",l),d:FD(t,r,i,o,n,a)}))};function BD(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eb(Object(r),!0).forEach(function(n){$D(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $D(e,t,r){return(t=UD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UD(e){var t=HD(e,"string");return typeof t=="symbol"?t:t+""}function HD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zD=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),R5=(e,t,r)=>e.map(n=>"".concat(zD(n)," ").concat(t,"ms ").concat(r)).join(","),WD=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),sl=(e,t)=>Object.keys(t).reduce((r,n)=>tb(tb({},r),{},{[n]:e(n,t[n])}),{});function rb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rb(Object(r),!0).forEach(function(n){VD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VD(e,t,r){return(t=KD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KD(e){var t=GD(e,"string");return typeof t=="symbol"?t:t+""}function GD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pu=(e,t,r)=>e+(t-e)*r,wm=e=>{var{from:t,to:r}=e;return t!==r},M5=(e,t,r)=>{var n=sl((a,i)=>{if(wm(i)){var[o,l]=e(i.from,i.to,i.velocity);return Qt(Qt({},i),{},{from:o,velocity:l})}return i},t);return r<1?sl((a,i)=>wm(i)&&n[a]!=null?Qt(Qt({},i),{},{velocity:pu(i.velocity,n[a].velocity,r),from:pu(i.from,n[a].from,r)}):i,t):M5(e,n,r-1)};function XD(e,t,r,n,a,i){var o,l=n.reduce((f,m)=>Qt(Qt({},f),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),c=()=>sl((f,m)=>m.from,l),d=()=>!Object.values(l).filter(wm).length,u=null,h=f=>{o||(o=f);var m=f-o,x=m/r.dt;l=M5(r,l,x),a(Qt(Qt(Qt({},e),t),c())),o=f,d()||(u=i.setTimeout(h))};return()=>(u=i.setTimeout(h),()=>{var f;(f=u)===null||f===void 0||f()})}function YD(e,t,r,n,a,i,o){var l=null,c=a.reduce((h,f)=>{var m=e[f],x=t[f];return m==null||x==null?h:Qt(Qt({},h),{},{[f]:[m,x]})},{}),d,u=h=>{d||(d=h);var f=(h-d)/n,m=sl((g,v)=>pu(...v,r(f)),c);if(i(Qt(Qt(Qt({},e),t),m)),f<1)l=o.setTimeout(u);else{var x=sl((g,v)=>pu(...v,r(1)),c);i(Qt(Qt(Qt({},e),t),x))}};return()=>(l=o.setTimeout(u),()=>{var h;(h=l)===null||h===void 0||h()})}const qD=(e,t,r,n,a,i)=>{var o=WD(e,t);return r==null?()=>(a(Qt(Qt({},e),t)),()=>{}):r.isStepper===!0?XD(e,t,r,o,a,i):YD(e,t,r,n,o,a,i)};var xu=1e-4,F5=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],L5=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),nb=(e,t)=>r=>{var n=F5(e,t);return L5(n,r)},ZD=(e,t)=>r=>{var n=F5(e,t),a=[...n.map((i,o)=>i*o).slice(1),0];return L5(a,r)},JD=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},QD=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=JD(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},eI=(e,t,r,n)=>{var a=nb(e,r),i=nb(t,n),o=ZD(e,r),l=d=>d>1?1:d<0?0:d,c=d=>{for(var u=d>1?1:d,h=u,f=0;f<8;++f){var m=a(h)-u,x=o(h);if(Math.abs(m-u)<xu||x<xu)return i(h);h=l(h-m/x)}return i(h)};return c.isStepper=!1,c},ab=function(){return eI(...QD(...arguments))},tI=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(o,l,c)=>{var d=-(o-l)*r,u=c*n,h=c+(d-u)*a/1e3,f=c*a/1e3+o;return Math.abs(f-l)<xu&&Math.abs(h)<xu?[l,0]:[f,h]};return i.isStepper=!0,i.dt=a,i},rI=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return ab(e);case"spring":return tI();default:if(e.split("(")[0]==="cubic-bezier")return ab(e)}return typeof e=="function"?e:null};function nI(e){var t,r=()=>null,n=!1,a=null,i=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){a=e.setTimeout(i.bind(null,d),c);return}i(c),a=e.setTimeout(i.bind(null,d));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),i(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class aI{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function iI(){return nI(new aI)}var sI=p.createContext(iI);function oI(e,t){var r=p.useContext(sI);return p.useMemo(()=>t??r(e),[e,t,r])}var lI=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),$d={isSsr:lI()},cI={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},ib={t:0},Oh={t:1};function Il(e){var t=hr(e,cI),{isActive:r,canBegin:n,duration:a,easing:i,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=r==="auto"?!$d.isSsr:r,h=oI(t.animationId,t.animationManager),[f,m]=p.useState(u?ib:Oh),x=p.useRef(null);return p.useEffect(()=>{u||m(Oh)},[u]),p.useEffect(()=>{if(!u||!n)return cs;var g=qD(ib,Oh,rI(i),a,m,h.getTimeoutController()),v=()=>{x.current=g()};return h.start([c,o,v,a,l]),()=>{h.stop(),x.current&&x.current(),l()}},[u,n,a,i,o,c,l,h]),d(f.t)}function Rl(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=p.useRef(Qo(t)),n=p.useRef(e);return n.current!==e&&(r.current=Qo(t),n.current=e),r.current}var uI=["radius"],dI=["radius"],sb,ob,lb,cb,ub,db,hb,fb,mb,pb;function xb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xb(Object(r),!0).forEach(function(n){hI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hI(e,t,r){return(t=fI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fI(e){var t=mI(e,"string");return typeof t=="symbol"?t:t+""}function mI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gu(){return gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gu.apply(null,arguments)}function vb(e,t){if(e==null)return{};var r,n,a=pI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qn(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var bb=(e,t,r,n,a)=>{var i=li(r),o=li(n),l=Math.min(Math.abs(i)/2,Math.abs(o)/2),c=o>=0?1:-1,d=i>=0?1:-1,u=o>=0&&i>=0||o<0&&i<0?1:0,h;if(l>0&&Array.isArray(a)){for(var f=[0,0,0,0],m=0,x=4;m<x;m++){var g,v=(g=a[m])!==null&&g!==void 0?g:0;f[m]=v>l?l:v}h=Bt(sb||(sb=qn(["M",",",""])),e,t+c*f[0]),f[0]>0&&(h+=Bt(ob||(ob=qn(["A ",",",",0,0,",",",",",""])),f[0],f[0],u,e+d*f[0],t)),h+=Bt(lb||(lb=qn(["L ",",",""])),e+r-d*f[1],t),f[1]>0&&(h+=Bt(cb||(cb=qn(["A ",",",",0,0,",`,
        `,",",""])),f[1],f[1],u,e+r,t+c*f[1])),h+=Bt(ub||(ub=qn(["L ",",",""])),e+r,t+n-c*f[2]),f[2]>0&&(h+=Bt(db||(db=qn(["A ",",",",0,0,",`,
        `,",",""])),f[2],f[2],u,e+r-d*f[2],t+n)),h+=Bt(hb||(hb=qn(["L ",",",""])),e+d*f[3],t+n),f[3]>0&&(h+=Bt(fb||(fb=qn(["A ",",",",0,0,",`,
        `,",",""])),f[3],f[3],u,e,t+n-c*f[3])),h+="Z"}else if(l>0&&a===+a&&a>0){var b=Math.min(l,a);h=Bt(mb||(mb=qn(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,u,e+d*b,t,e+r-d*b,t,b,b,u,e+r,t+c*b,e+r,t+n-c*b,b,b,u,e+r-d*b,t+n,e+d*b,t+n,b,b,u,e,t+n-c*b)}else h=Bt(pb||(pb=qn(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return h},yb={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},B5=e=>{var t=hr(e,yb),r=p.useRef(null),[n,a]=p.useState(-1);p.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&a(K)}catch{}},[]);var{x:i,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:h,animationDuration:f,animationBegin:m,isAnimationActive:x,isUpdateAnimationActive:g}=t,v=p.useRef(l),b=p.useRef(c),w=p.useRef(i),y=p.useRef(o),N=p.useMemo(()=>({x:i,y:o,width:l,height:c,radius:d}),[i,o,l,c,d]),_=Rl(N,"rectangle-");if(i!==+i||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var S=lt("recharts-rectangle",u);if(!g){var j=Yr(t),{radius:E}=j,k=vb(j,uI);return p.createElement("path",gu({},k,{x:li(i),y:li(o),width:li(l),height:li(c),radius:typeof d=="number"?d:void 0,className:S,d:bb(i,o,l,c,d)}))}var T=v.current,A=b.current,C=w.current,R=y.current,G="0px ".concat(n===-1?1:n,"px"),V="".concat(n,"px 0px"),X=R5(["strokeDasharray"],f,typeof h=="string"?h:yb.animationEasing);return p.createElement(Il,{animationId:_,key:_,canBegin:n>0,duration:f,easing:h,isActive:g,begin:m},K=>{var Y=Ct(T,l,K),q=Ct(A,c,K),Z=Ct(C,i,K),le=Ct(R,o,K);r.current&&(v.current=Y,b.current=q,w.current=Z,y.current=le);var ce;x?K>0?ce={transition:X,strokeDasharray:V}:ce={strokeDasharray:G}:ce={strokeDasharray:V};var pe=Yr(t),{radius:Ne}=pe,ee=vb(pe,dI);return p.createElement("path",gu({},ee,{radius:typeof d=="number"?d:void 0,className:S,d:bb(Z,le,Y,q,d),ref:r,style:gb(gb({},ce),t.style)}))})};function wb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wb(Object(r),!0).forEach(function(n){xI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xI(e,t,r){return(t=gI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gI(e){var t=vI(e,"string");return typeof t=="symbol"?t:t+""}function vI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vu=Math.PI/180,bI=e=>e*180/Math.PI,Kt=(e,t,r,n)=>({x:e+Math.cos(-vu*n)*r,y:t+Math.sin(-vu*n)*r}),$5=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},yI=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},wI=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,o=yI({x:r,y:n},{x:a,y:i});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>i&&(c=2*Math.PI-c),{radius:o,angle:bI(c),angleInRadian:c}},NI=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},_I=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return e+o*360},jI=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:i}=wI({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:d}=NI(t),u=i,h;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;h=u>=d&&u<=c}return h?Nb(Nb({},t),{},{radius:a,angle:_I(u,t)}):null};function U5(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,o=Kt(t,r,n,a),l=Kt(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}var _b,jb,Sb,Eb,Cb,Tb,kb;function Nm(){return Nm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nm.apply(null,arguments)}function Fi(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var SI=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},dc=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+n,u=Math.asin(l/d)/vu,h=c?a:a+i*u,f=Kt(t,r,d,h),m=Kt(t,r,n,h),x=c?a-i*u:a,g=Kt(t,r,d*Math.cos(u*vu),x);return{center:f,circleTangency:m,lineTangency:g,theta:u}},H5=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:o}=e,l=SI(i,o),c=i+l,d=Kt(t,r,a,i),u=Kt(t,r,a,c),h=Bt(_b||(_b=Fi(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),d.x,d.y,a,a,+(Math.abs(l)>180),+(i>c),u.x,u.y);if(n>0){var f=Kt(t,r,n,i),m=Kt(t,r,n,c);h+=Bt(jb||(jb=Fi(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),m.x,m.y,n,n,+(Math.abs(l)>180),+(i<=c),f.x,f.y)}else h+=Bt(Sb||(Sb=Fi(["L ",","," Z"])),t,r);return h},EI=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=lr(d-c),{circleTangency:h,lineTangency:f,theta:m}=dc({cx:t,cy:r,radius:a,angle:c,sign:u,cornerRadius:i,cornerIsExternal:l}),{circleTangency:x,lineTangency:g,theta:v}=dc({cx:t,cy:r,radius:a,angle:d,sign:-u,cornerRadius:i,cornerIsExternal:l}),b=l?Math.abs(c-d):Math.abs(c-d)-m-v;if(b<0)return o?Bt(Eb||(Eb=Fi(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),f.x,f.y,i,i,i*2,i,i,-i*2):H5({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:d});var w=Bt(Cb||(Cb=Fi(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),f.x,f.y,i,i,+(u<0),h.x,h.y,a,a,+(b>180),+(u<0),x.x,x.y,i,i,+(u<0),g.x,g.y);if(n>0){var{circleTangency:y,lineTangency:N,theta:_}=dc({cx:t,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:S,lineTangency:j,theta:E}=dc({cx:t,cy:r,radius:n,angle:d,sign:-u,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),k=l?Math.abs(c-d):Math.abs(c-d)-_-E;if(k<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+=Bt(Tb||(Tb=Fi(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),j.x,j.y,i,i,+(u<0),S.x,S.y,n,n,+(k>180),+(u>0),y.x,y.y,i,i,+(u<0),N.x,N.y)}else w+=Bt(kb||(kb=Fi(["L",",","Z"])),t,r);return w},CI={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},z5=e=>{var t=hr(e,CI),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:h}=t;if(i<a||d===u)return null;var f=lt("recharts-sector",h),m=i-a,x=Or(o,m,0,!0),g;return x>0&&Math.abs(d-u)<360?g=EI({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):g=H5({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u}),p.createElement("path",Nm({},Yr(t),{className:f,d:g}))};function TI(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(N_(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:o,angle:l}=t,c=Kt(n,a,i,l),d=Kt(n,a,o,l);return[{x:c.x,y:c.y},{x:d.x,y:d.y}]}return U5(t)}}var Dh={},Ih={},Rh={},Ab;function kI(){return Ab||(Ab=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O_();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Rh)),Rh}var Pb;function AI(){return Pb||(Pb=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kI();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Ih)),Ih}var Ob;function PI(){return Ob||(Ob=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D_(),r=AI();function n(a,i,o){o&&typeof o!="number"&&t.isIterateeCall(a,i,o)&&(i=o=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),o=o===void 0?a<i?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((i-a)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=o;return c}e.range=n})(Dh)),Dh}var Mh,Db;function OI(){return Db||(Db=1,Mh=PI().range),Mh}var DI=OI();const W5=wi(DI);function ui(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function II(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gp(e){let t,r,n;e.length!==2?(t=ui,r=(l,c)=>ui(e(l),c),n=(l,c)=>e(l)-c):(t=e===ui||e===II?e:RI,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<0?d=h+1:u=h}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<=0?d=h+1:u=h}while(d<u)}return d}function o(l,c,d=0,u=l.length){const h=a(l,c,d,u-1);return h>d&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:a,center:o,right:i}}function RI(){return 0}function V5(e){return e===null?NaN:+e}function*MI(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const FI=Gp(ui),Ml=FI.right;Gp(V5).center;class Ib extends Map{constructor(t,r=$I){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(Rb(this,t))}has(t){return super.has(Rb(this,t))}set(t,r){return super.set(LI(this,t),r)}delete(t){return super.delete(BI(this,t))}}function Rb({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function LI({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function BI({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function $I(e){return e!==null&&typeof e=="object"?e.valueOf():e}function UI(e=ui){if(e===ui)return K5;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function K5(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const HI=Math.sqrt(50),zI=Math.sqrt(10),WI=Math.sqrt(2);function bu(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=HI?10:i>=zI?5:i>=WI?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?bu(e,t,r*2):[l,c,d]}function _m(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,o]=n?bu(t,e,r):bu(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function jm(e,t,r){return t=+t,e=+e,r=+r,bu(e,t,r)[2]}function Sm(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?jm(t,e,r):jm(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Mb(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Fb(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function G5(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?K5:UI(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(c-h)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*h/c+f)),x=Math.min(n,Math.floor(t+(c-d)*h/c+f));G5(e,t,m,x,a)}const i=e[t];let o=r,l=n;for(Oo(e,r,t),a(e[n],i)>0&&Oo(e,r,n);o<l;){for(Oo(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?Oo(e,r,l):(++l,Oo(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Oo(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function VI(e,t,r){if(e=Float64Array.from(MI(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Fb(e);if(t>=1)return Mb(e);var n,a=(n-1)*t,i=Math.floor(a),o=Mb(G5(e,i).subarray(0,i+1)),l=Fb(e.subarray(i+1));return o+(l-o)*(a-i)}}function KI(e,t,r=V5){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function GI(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Rn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function qa(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Em=Symbol("implicit");function Xp(){var e=new Ib,t=[],r=[],n=Em;function a(i){let o=e.get(i);if(o===void 0){if(n!==Em)return n;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Ib;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Xp(t,r).unknown(n)},Rn.apply(a,arguments),a}function Yp(){var e=Xp().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function h(){var f=t().length,m=a<n,x=m?a:n,g=m?n:a;i=(g-x)/Math.max(1,f-c+d*2),l&&(i=Math.floor(i)),x+=(g-x-i*(f-c))*u,o=i*(1-c),l&&(x=Math.round(x),o=Math.round(o));var v=GI(f).map(function(b){return x+i*b});return r(m?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([n,a]=f,n=+n,a=+a,h()):[n,a]},e.rangeRound=function(f){return[n,a]=f,n=+n,a=+a,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,h()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,d=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(d=+f,h()):d},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},e.copy=function(){return Yp(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},Rn.apply(h(),arguments)}function X5(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return X5(t())},e}function XI(){return X5(Yp.apply(null,arguments).paddingInner(1))}function qp(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Y5(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Fl(){}var ol=.7,yu=1/ol,Ws="\\s*([+-]?\\d+)\\s*",ll="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",YI=/^#([0-9a-f]{3,8})$/,qI=new RegExp(`^rgb\\(${Ws},${Ws},${Ws}\\)$`),ZI=new RegExp(`^rgb\\(${ca},${ca},${ca}\\)$`),JI=new RegExp(`^rgba\\(${Ws},${Ws},${Ws},${ll}\\)$`),QI=new RegExp(`^rgba\\(${ca},${ca},${ca},${ll}\\)$`),eR=new RegExp(`^hsl\\(${ll},${ca},${ca}\\)$`),tR=new RegExp(`^hsla\\(${ll},${ca},${ca},${ll}\\)$`),Lb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qp(Fl,cl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Bb,formatHex:Bb,formatHex8:rR,formatHsl:nR,formatRgb:$b,toString:$b});function Bb(){return this.rgb().formatHex()}function rR(){return this.rgb().formatHex8()}function nR(){return q5(this).formatHsl()}function $b(){return this.rgb().formatRgb()}function cl(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=YI.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ub(t):r===3?new rn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?hc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?hc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qI.exec(e))?new rn(t[1],t[2],t[3],1):(t=ZI.exec(e))?new rn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=JI.exec(e))?hc(t[1],t[2],t[3],t[4]):(t=QI.exec(e))?hc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eR.exec(e))?Wb(t[1],t[2]/100,t[3]/100,1):(t=tR.exec(e))?Wb(t[1],t[2]/100,t[3]/100,t[4]):Lb.hasOwnProperty(e)?Ub(Lb[e]):e==="transparent"?new rn(NaN,NaN,NaN,0):null}function Ub(e){return new rn(e>>16&255,e>>8&255,e&255,1)}function hc(e,t,r,n){return n<=0&&(e=t=r=NaN),new rn(e,t,r,n)}function aR(e){return e instanceof Fl||(e=cl(e)),e?(e=e.rgb(),new rn(e.r,e.g,e.b,e.opacity)):new rn}function Cm(e,t,r,n){return arguments.length===1?aR(e):new rn(e,t,r,n??1)}function rn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}qp(rn,Cm,Y5(Fl,{brighter(e){return e=e==null?yu:Math.pow(yu,e),new rn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ol:Math.pow(ol,e),new rn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new rn(Hi(this.r),Hi(this.g),Hi(this.b),wu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hb,formatHex:Hb,formatHex8:iR,formatRgb:zb,toString:zb}));function Hb(){return`#${Li(this.r)}${Li(this.g)}${Li(this.b)}`}function iR(){return`#${Li(this.r)}${Li(this.g)}${Li(this.b)}${Li((isNaN(this.opacity)?1:this.opacity)*255)}`}function zb(){const e=wu(this.opacity);return`${e===1?"rgb(":"rgba("}${Hi(this.r)}, ${Hi(this.g)}, ${Hi(this.b)}${e===1?")":`, ${e})`}`}function wu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Li(e){return e=Hi(e),(e<16?"0":"")+e.toString(16)}function Wb(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Hn(e,t,r,n)}function q5(e){if(e instanceof Hn)return new Hn(e.h,e.s,e.l,e.opacity);if(e instanceof Fl||(e=cl(e)),!e)return new Hn;if(e instanceof Hn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new Hn(o,l,c,e.opacity)}function sR(e,t,r,n){return arguments.length===1?q5(e):new Hn(e,t,r,n??1)}function Hn(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}qp(Hn,sR,Y5(Fl,{brighter(e){return e=e==null?yu:Math.pow(yu,e),new Hn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ol:Math.pow(ol,e),new Hn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new rn(Fh(e>=240?e-240:e+120,a,n),Fh(e,a,n),Fh(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Hn(Vb(this.h),fc(this.s),fc(this.l),wu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=wu(this.opacity);return`${e===1?"hsl(":"hsla("}${Vb(this.h)}, ${fc(this.s)*100}%, ${fc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Vb(e){return e=(e||0)%360,e<0?e+360:e}function fc(e){return Math.max(0,Math.min(1,e||0))}function Fh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Zp=e=>()=>e;function oR(e,t){return function(r){return e+r*t}}function lR(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function cR(e){return(e=+e)==1?Z5:function(t,r){return r-t?lR(t,r,e):Zp(isNaN(t)?r:t)}}function Z5(e,t){var r=t-e;return r?oR(e,r):Zp(isNaN(e)?t:e)}const Kb=(function e(t){var r=cR(t);function n(a,i){var o=r((a=Cm(a)).r,(i=Cm(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=Z5(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n})(1);function uR(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function dR(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hR(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=lo(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function fR(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Nu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function mR(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=lo(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Tm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lh=new RegExp(Tm.source,"g");function pR(e){return function(){return e}}function xR(e){return function(t){return e(t)+""}}function gR(e,t){var r=Tm.lastIndex=Lh.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Tm.exec(e))&&(a=Lh.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:Nu(n,a)})),r=Lh.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?xR(c[0].x):pR(t):(t=c.length,function(d){for(var u=0,h;u<t;++u)l[(h=c[u]).i]=h.x(d);return l.join("")})}function lo(e,t){var r=typeof t,n;return t==null||r==="boolean"?Zp(t):(r==="number"?Nu:r==="string"?(n=cl(t))?(t=n,Kb):gR:t instanceof cl?Kb:t instanceof Date?fR:dR(t)?uR:Array.isArray(t)?hR:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?mR:Nu)(e,t)}function Jp(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function vR(e,t){t===void 0&&(t=e,e=lo);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function bR(e){return function(){return e}}function _u(e){return+e}var Gb=[0,1];function Wr(e){return e}function km(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:bR(isNaN(t)?NaN:.5)}function yR(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function wR(e,t,r){var n=e[0],a=e[1],i=t[0],o=t[1];return a<n?(n=km(a,n),i=r(o,i)):(n=km(n,a),i=r(i,o)),function(l){return i(n(l))}}function NR(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=km(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=Ml(e,l,1,n)-1;return i[c](a[c](l))}}function Ll(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Ud(){var e=Gb,t=Gb,r=lo,n,a,i,o=Wr,l,c,d;function u(){var f=Math.min(e.length,t.length);return o!==Wr&&(o=yR(e[0],e[f-1])),l=f>2?NR:wR,c=d=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(n),t,r)))(n(o(f)))}return h.invert=function(f){return o(a((d||(d=l(t,e.map(n),Nu)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,_u),u()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=Jp,u()},h.clamp=function(f){return arguments.length?(o=f?!0:Wr,u()):o!==Wr},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return n=f,a=m,u()}}function Qp(){return Ud()(Wr,Wr)}function _R(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ju(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function ro(e){return e=ju(Math.abs(e)),e?e[1]:NaN}function jR(e,t){return function(r,n){for(var a=r.length,i=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function SR(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var ER=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ul(e){if(!(t=ER.exec(e)))throw new Error("invalid format: "+e);var t;return new ex({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ul.prototype=ex.prototype;function ex(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ex.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function CR(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Su;function TR(e,t){var r=ju(e,t);if(!r)return Su=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(Su=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ju(e,Math.max(0,t+i-1))[0]}function Xb(e,t){var r=ju(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Yb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:_R,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Xb(e*100,t),r:Xb,s:TR,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function qb(e){return e}var Zb=Array.prototype.map,Jb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function kR(e){var t=e.grouping===void 0||e.thousands===void 0?qb:jR(Zb.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?qb:SR(Zb.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(h,f){h=ul(h);var m=h.fill,x=h.align,g=h.sign,v=h.symbol,b=h.zero,w=h.width,y=h.comma,N=h.precision,_=h.trim,S=h.type;S==="n"?(y=!0,S="g"):Yb[S]||(N===void 0&&(N=12),_=!0,S="g"),(b||m==="0"&&x==="=")&&(b=!0,m="0",x="=");var j=(f&&f.prefix!==void 0?f.prefix:"")+(v==="$"?r:v==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():""),E=(v==="$"?n:/[%p]/.test(S)?o:"")+(f&&f.suffix!==void 0?f.suffix:""),k=Yb[S],T=/[defgprs%]/.test(S);N=N===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function A(C){var R=j,G=E,V,X,K;if(S==="c")G=k(C)+G,C="";else{C=+C;var Y=C<0||1/C<0;if(C=isNaN(C)?c:k(Math.abs(C),N),_&&(C=CR(C)),Y&&+C==0&&g!=="+"&&(Y=!1),R=(Y?g==="("?g:l:g==="-"||g==="("?"":g)+R,G=(S==="s"&&!isNaN(C)&&Su!==void 0?Jb[8+Su/3]:"")+G+(Y&&g==="("?")":""),T){for(V=-1,X=C.length;++V<X;)if(K=C.charCodeAt(V),48>K||K>57){G=(K===46?a+C.slice(V+1):C.slice(V))+G,C=C.slice(0,V);break}}}y&&!b&&(C=t(C,1/0));var q=R.length+C.length+G.length,Z=q<w?new Array(w-q+1).join(m):"";switch(y&&b&&(C=t(Z+C,Z.length?w-G.length:1/0),Z=""),x){case"<":C=R+C+G+Z;break;case"=":C=R+Z+C+G;break;case"^":C=Z.slice(0,q=Z.length>>1)+R+C+G+Z.slice(q);break;default:C=Z+R+C+G;break}return i(C)}return A.toString=function(){return h+""},A}function u(h,f){var m=Math.max(-8,Math.min(8,Math.floor(ro(f)/3)))*3,x=Math.pow(10,-m),g=d((h=ul(h),h.type="f",h),{suffix:Jb[8+m/3]});return function(v){return g(x*v)}}return{format:d,formatPrefix:u}}var mc,tx,J5;AR({thousands:",",grouping:[3],currency:["$",""]});function AR(e){return mc=kR(e),tx=mc.format,J5=mc.formatPrefix,mc}function PR(e){return Math.max(0,-ro(Math.abs(e)))}function OR(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ro(t)/3)))*3-ro(Math.abs(e)))}function DR(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ro(t)-ro(e))+1}function Q5(e,t,r,n){var a=Sm(e,t,r),i;switch(n=ul(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=OR(a,o))&&(n.precision=i),J5(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=DR(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=PR(a))&&(n.precision=i-(n.type==="%")*2);break}}return tx(n)}function Ni(e){var t=e.domain;return e.ticks=function(r){var n=t();return _m(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return Q5(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=jm(o,l,r),d===c)return n[a]=o,n[i]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function ej(){var e=Qp();return e.copy=function(){return Ll(e,ej())},Rn.apply(e,arguments),Ni(e)}function tj(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,_u),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return tj(e).unknown(t)},e=arguments.length?Array.from(e,_u):[0,1],Ni(r)}function rj(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Qb(e){return Math.log(e)}function ey(e){return Math.exp(e)}function IR(e){return-Math.log(-e)}function RR(e){return-Math.exp(-e)}function MR(e){return isFinite(e)?+("1e"+e):e<0?0:e}function FR(e){return e===10?MR:e===Math.E?Math.exp:t=>Math.pow(e,t)}function LR(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function ty(e){return(t,r)=>-e(-t,r)}function rx(e){const t=e(Qb,ey),r=t.domain;let n=10,a,i;function o(){return a=LR(n),i=FR(n),r()[0]<0?(a=ty(a),i=ty(i),e(IR,RR)):e(Qb,ey),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const h=u<d;h&&([d,u]=[u,d]);let f=a(d),m=a(u),x,g;const v=l==null?10:+l;let b=[];if(!(n%1)&&m-f<v){if(f=Math.floor(f),m=Math.ceil(m),d>0){for(;f<=m;++f)for(x=1;x<n;++x)if(g=f<0?x/i(-f):x*i(f),!(g<d)){if(g>u)break;b.push(g)}}else for(;f<=m;++f)for(x=n-1;x>=1;--x)if(g=f>0?x/i(-f):x*i(f),!(g<d)){if(g>u)break;b.push(g)}b.length*2<v&&(b=_m(d,u,v))}else b=_m(f,m,Math.min(m-f,v)).map(i);return h?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ul(c)).precision==null&&(c.trim=!0),c=tx(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let h=u/i(Math.round(a(u)));return h*n<n-.5&&(h*=n),h<=d?c(u):""}},t.nice=()=>r(rj(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function nj(){const e=rx(Ud()).domain([1,10]);return e.copy=()=>Ll(e,nj()).base(e.base()),Rn.apply(e,arguments),e}function ry(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function ny(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function nx(e){var t=1,r=e(ry(t),ny(t));return r.constant=function(n){return arguments.length?e(ry(t=+n),ny(t)):t},Ni(r)}function aj(){var e=nx(Ud());return e.copy=function(){return Ll(e,aj()).constant(e.constant())},Rn.apply(e,arguments)}function ay(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function BR(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function $R(e){return e<0?-e*e:e*e}function ax(e){var t=e(Wr,Wr),r=1;function n(){return r===1?e(Wr,Wr):r===.5?e(BR,$R):e(ay(r),ay(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Ni(t)}function ix(){var e=ax(Ud());return e.copy=function(){return Ll(e,ix()).exponent(e.exponent())},Rn.apply(e,arguments),e}function UR(){return ix.apply(null,arguments).exponent(.5)}function iy(e){return Math.sign(e)*e*e}function HR(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function ij(){var e=Qp(),t=[0,1],r=!1,n;function a(i){var o=HR(e(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return e.invert(iy(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,_u)).map(iy)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return ij(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Rn.apply(a,arguments),Ni(a)}function sj(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=KI(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[Ml(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(ui),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return sj().domain(e).range(t).unknown(n)},Rn.apply(i,arguments)}function oj(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[Ml(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return oj().domain([e,t]).range(a).unknown(i)},Rn.apply(Ni(o),arguments)}function lj(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Ml(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return lj().domain(e).range(t).unknown(r)},Rn.apply(a,arguments)}const Bh=new Date,$h=new Date;function rr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},a.filter=i=>rr(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(Bh.setTime(+i),$h.setTime(+o),e(Bh),e($h),Math.floor(r(Bh,$h))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const Eu=rr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Eu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?rr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Eu);Eu.range;const Sa=1e3,Pn=Sa*60,Ea=Pn*60,Fa=Ea*24,sx=Fa*7,sy=Fa*30,Uh=Fa*365,Bi=rr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Sa)},(e,t)=>(t-e)/Sa,e=>e.getUTCSeconds());Bi.range;const ox=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sa)},(e,t)=>{e.setTime(+e+t*Pn)},(e,t)=>(t-e)/Pn,e=>e.getMinutes());ox.range;const lx=rr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Pn)},(e,t)=>(t-e)/Pn,e=>e.getUTCMinutes());lx.range;const cx=rr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Sa-e.getMinutes()*Pn)},(e,t)=>{e.setTime(+e+t*Ea)},(e,t)=>(t-e)/Ea,e=>e.getHours());cx.range;const ux=rr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ea)},(e,t)=>(t-e)/Ea,e=>e.getUTCHours());ux.range;const Bl=rr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Pn)/Fa,e=>e.getDate()-1);Bl.range;const Hd=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fa,e=>e.getUTCDate()-1);Hd.range;const cj=rr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fa,e=>Math.floor(e/Fa));cj.range;function ds(e){return rr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Pn)/sx)}const zd=ds(0),Cu=ds(1),zR=ds(2),WR=ds(3),no=ds(4),VR=ds(5),KR=ds(6);zd.range;Cu.range;zR.range;WR.range;no.range;VR.range;KR.range;function hs(e){return rr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/sx)}const Wd=hs(0),Tu=hs(1),GR=hs(2),XR=hs(3),ao=hs(4),YR=hs(5),qR=hs(6);Wd.range;Tu.range;GR.range;XR.range;ao.range;YR.range;qR.range;const dx=rr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());dx.range;const hx=rr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hx.range;const La=rr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());La.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});La.range;const Ba=rr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ba.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:rr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Ba.range;function uj(e,t,r,n,a,i){const o=[[Bi,1,Sa],[Bi,5,5*Sa],[Bi,15,15*Sa],[Bi,30,30*Sa],[i,1,Pn],[i,5,5*Pn],[i,15,15*Pn],[i,30,30*Pn],[a,1,Ea],[a,3,3*Ea],[a,6,6*Ea],[a,12,12*Ea],[n,1,Fa],[n,2,2*Fa],[r,1,sx],[t,1,sy],[t,3,3*sy],[e,1,Uh]];function l(d,u,h){const f=u<d;f&&([d,u]=[u,d]);const m=h&&typeof h.range=="function"?h:c(d,u,h),x=m?m.range(d,+u+1):[];return f?x.reverse():x}function c(d,u,h){const f=Math.abs(u-d)/h,m=Gp(([,,v])=>v).right(o,f);if(m===o.length)return e.every(Sm(d/Uh,u/Uh,h));if(m===0)return Eu.every(Math.max(Sm(d,u,h),1));const[x,g]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return x.every(g)}return[l,c]}const[ZR,JR]=uj(Ba,hx,Wd,cj,ux,lx),[QR,e6]=uj(La,dx,zd,Bl,cx,ox);function Hh(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Do(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function t6(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=Io(a),u=Ro(a),h=Io(i),f=Ro(i),m=Io(o),x=Ro(o),g=Io(l),v=Ro(l),b=Io(c),w=Ro(c),y={a:K,A:Y,b:q,B:Z,c:null,d:hy,e:hy,f:j6,g:I6,G:M6,H:w6,I:N6,j:_6,L:dj,m:S6,M:E6,p:le,q:ce,Q:py,s:xy,S:C6,u:T6,U:k6,V:A6,w:P6,W:O6,x:null,X:null,y:D6,Y:R6,Z:F6,"%":my},N={a:pe,A:Ne,b:ee,B:oe,c:null,d:fy,e:fy,f:U6,g:Z6,G:Q6,H:L6,I:B6,j:$6,L:fj,m:H6,M:z6,p:he,q:O,Q:py,s:xy,S:W6,u:V6,U:K6,V:G6,w:X6,W:Y6,x:null,X:null,y:q6,Y:J6,Z:e8,"%":my},_={a:T,A,b:C,B:R,c:G,d:uy,e:uy,f:g6,g:cy,G:ly,H:dy,I:dy,j:f6,L:x6,m:h6,M:m6,p:k,q:d6,Q:b6,s:y6,S:p6,u:s6,U:o6,V:l6,w:i6,W:c6,x:V,X,y:cy,Y:ly,Z:u6,"%":v6};y.x=S(r,y),y.X=S(n,y),y.c=S(t,y),N.x=S(r,N),N.X=S(n,N),N.c=S(t,N);function S(I,L){return function(F){var W=[],J=-1,se=0,ke=I.length,ye,Pe,ue;for(F instanceof Date||(F=new Date(+F));++J<ke;)I.charCodeAt(J)===37&&(W.push(I.slice(se,J)),(Pe=oy[ye=I.charAt(++J)])!=null?ye=I.charAt(++J):Pe=ye==="e"?" ":"0",(ue=L[ye])&&(ye=ue(F,Pe)),W.push(ye),se=J+1);return W.push(I.slice(se,J)),W.join("")}}function j(I,L){return function(F){var W=Do(1900,void 0,1),J=E(W,I,F+="",0),se,ke;if(J!=F.length)return null;if("Q"in W)return new Date(W.Q);if("s"in W)return new Date(W.s*1e3+("L"in W?W.L:0));if(L&&!("Z"in W)&&(W.Z=0),"p"in W&&(W.H=W.H%12+W.p*12),W.m===void 0&&(W.m="q"in W?W.q:0),"V"in W){if(W.V<1||W.V>53)return null;"w"in W||(W.w=1),"Z"in W?(se=zh(Do(W.y,0,1)),ke=se.getUTCDay(),se=ke>4||ke===0?Tu.ceil(se):Tu(se),se=Hd.offset(se,(W.V-1)*7),W.y=se.getUTCFullYear(),W.m=se.getUTCMonth(),W.d=se.getUTCDate()+(W.w+6)%7):(se=Hh(Do(W.y,0,1)),ke=se.getDay(),se=ke>4||ke===0?Cu.ceil(se):Cu(se),se=Bl.offset(se,(W.V-1)*7),W.y=se.getFullYear(),W.m=se.getMonth(),W.d=se.getDate()+(W.w+6)%7)}else("W"in W||"U"in W)&&("w"in W||(W.w="u"in W?W.u%7:"W"in W?1:0),ke="Z"in W?zh(Do(W.y,0,1)).getUTCDay():Hh(Do(W.y,0,1)).getDay(),W.m=0,W.d="W"in W?(W.w+6)%7+W.W*7-(ke+5)%7:W.w+W.U*7-(ke+6)%7);return"Z"in W?(W.H+=W.Z/100|0,W.M+=W.Z%100,zh(W)):Hh(W)}}function E(I,L,F,W){for(var J=0,se=L.length,ke=F.length,ye,Pe;J<se;){if(W>=ke)return-1;if(ye=L.charCodeAt(J++),ye===37){if(ye=L.charAt(J++),Pe=_[ye in oy?L.charAt(J++):ye],!Pe||(W=Pe(I,F,W))<0)return-1}else if(ye!=F.charCodeAt(W++))return-1}return W}function k(I,L,F){var W=d.exec(L.slice(F));return W?(I.p=u.get(W[0].toLowerCase()),F+W[0].length):-1}function T(I,L,F){var W=m.exec(L.slice(F));return W?(I.w=x.get(W[0].toLowerCase()),F+W[0].length):-1}function A(I,L,F){var W=h.exec(L.slice(F));return W?(I.w=f.get(W[0].toLowerCase()),F+W[0].length):-1}function C(I,L,F){var W=b.exec(L.slice(F));return W?(I.m=w.get(W[0].toLowerCase()),F+W[0].length):-1}function R(I,L,F){var W=g.exec(L.slice(F));return W?(I.m=v.get(W[0].toLowerCase()),F+W[0].length):-1}function G(I,L,F){return E(I,t,L,F)}function V(I,L,F){return E(I,r,L,F)}function X(I,L,F){return E(I,n,L,F)}function K(I){return o[I.getDay()]}function Y(I){return i[I.getDay()]}function q(I){return c[I.getMonth()]}function Z(I){return l[I.getMonth()]}function le(I){return a[+(I.getHours()>=12)]}function ce(I){return 1+~~(I.getMonth()/3)}function pe(I){return o[I.getUTCDay()]}function Ne(I){return i[I.getUTCDay()]}function ee(I){return c[I.getUTCMonth()]}function oe(I){return l[I.getUTCMonth()]}function he(I){return a[+(I.getUTCHours()>=12)]}function O(I){return 1+~~(I.getUTCMonth()/3)}return{format:function(I){var L=S(I+="",y);return L.toString=function(){return I},L},parse:function(I){var L=j(I+="",!1);return L.toString=function(){return I},L},utcFormat:function(I){var L=S(I+="",N);return L.toString=function(){return I},L},utcParse:function(I){var L=j(I+="",!0);return L.toString=function(){return I},L}}}var oy={"-":"",_:" ",0:"0"},fr=/^\s*\d+/,r6=/^%/,n6=/[\\^$*+?|[\]().{}]/g;function nt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function a6(e){return e.replace(n6,"\\$&")}function Io(e){return new RegExp("^(?:"+e.map(a6).join("|")+")","i")}function Ro(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function i6(e,t,r){var n=fr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function s6(e,t,r){var n=fr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function o6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function l6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function c6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ly(e,t,r){var n=fr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function cy(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function u6(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function d6(e,t,r){var n=fr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function h6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function uy(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function f6(e,t,r){var n=fr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function dy(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function m6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function p6(e,t,r){var n=fr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function x6(e,t,r){var n=fr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function g6(e,t,r){var n=fr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function v6(e,t,r){var n=r6.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function b6(e,t,r){var n=fr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function y6(e,t,r){var n=fr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function hy(e,t){return nt(e.getDate(),t,2)}function w6(e,t){return nt(e.getHours(),t,2)}function N6(e,t){return nt(e.getHours()%12||12,t,2)}function _6(e,t){return nt(1+Bl.count(La(e),e),t,3)}function dj(e,t){return nt(e.getMilliseconds(),t,3)}function j6(e,t){return dj(e,t)+"000"}function S6(e,t){return nt(e.getMonth()+1,t,2)}function E6(e,t){return nt(e.getMinutes(),t,2)}function C6(e,t){return nt(e.getSeconds(),t,2)}function T6(e){var t=e.getDay();return t===0?7:t}function k6(e,t){return nt(zd.count(La(e)-1,e),t,2)}function hj(e){var t=e.getDay();return t>=4||t===0?no(e):no.ceil(e)}function A6(e,t){return e=hj(e),nt(no.count(La(e),e)+(La(e).getDay()===4),t,2)}function P6(e){return e.getDay()}function O6(e,t){return nt(Cu.count(La(e)-1,e),t,2)}function D6(e,t){return nt(e.getFullYear()%100,t,2)}function I6(e,t){return e=hj(e),nt(e.getFullYear()%100,t,2)}function R6(e,t){return nt(e.getFullYear()%1e4,t,4)}function M6(e,t){var r=e.getDay();return e=r>=4||r===0?no(e):no.ceil(e),nt(e.getFullYear()%1e4,t,4)}function F6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+nt(t/60|0,"0",2)+nt(t%60,"0",2)}function fy(e,t){return nt(e.getUTCDate(),t,2)}function L6(e,t){return nt(e.getUTCHours(),t,2)}function B6(e,t){return nt(e.getUTCHours()%12||12,t,2)}function $6(e,t){return nt(1+Hd.count(Ba(e),e),t,3)}function fj(e,t){return nt(e.getUTCMilliseconds(),t,3)}function U6(e,t){return fj(e,t)+"000"}function H6(e,t){return nt(e.getUTCMonth()+1,t,2)}function z6(e,t){return nt(e.getUTCMinutes(),t,2)}function W6(e,t){return nt(e.getUTCSeconds(),t,2)}function V6(e){var t=e.getUTCDay();return t===0?7:t}function K6(e,t){return nt(Wd.count(Ba(e)-1,e),t,2)}function mj(e){var t=e.getUTCDay();return t>=4||t===0?ao(e):ao.ceil(e)}function G6(e,t){return e=mj(e),nt(ao.count(Ba(e),e)+(Ba(e).getUTCDay()===4),t,2)}function X6(e){return e.getUTCDay()}function Y6(e,t){return nt(Tu.count(Ba(e)-1,e),t,2)}function q6(e,t){return nt(e.getUTCFullYear()%100,t,2)}function Z6(e,t){return e=mj(e),nt(e.getUTCFullYear()%100,t,2)}function J6(e,t){return nt(e.getUTCFullYear()%1e4,t,4)}function Q6(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ao(e):ao.ceil(e),nt(e.getUTCFullYear()%1e4,t,4)}function e8(){return"+0000"}function my(){return"%"}function py(e){return+e}function xy(e){return Math.floor(+e/1e3)}var _s,pj,xj;t8({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function t8(e){return _s=t6(e),pj=_s.format,_s.parse,xj=_s.utcFormat,_s.utcParse,_s}function r8(e){return new Date(e)}function n8(e){return e instanceof Date?+e:+new Date(+e)}function fx(e,t,r,n,a,i,o,l,c,d){var u=Qp(),h=u.invert,f=u.domain,m=d(".%L"),x=d(":%S"),g=d("%I:%M"),v=d("%I %p"),b=d("%a %d"),w=d("%b %d"),y=d("%B"),N=d("%Y");function _(S){return(c(S)<S?m:l(S)<S?x:o(S)<S?g:i(S)<S?v:n(S)<S?a(S)<S?b:w:r(S)<S?y:N)(S)}return u.invert=function(S){return new Date(h(S))},u.domain=function(S){return arguments.length?f(Array.from(S,n8)):f().map(r8)},u.ticks=function(S){var j=f();return e(j[0],j[j.length-1],S??10)},u.tickFormat=function(S,j){return j==null?_:d(j)},u.nice=function(S){var j=f();return(!S||typeof S.range!="function")&&(S=t(j[0],j[j.length-1],S??10)),S?f(rj(j,S)):u},u.copy=function(){return Ll(u,fx(e,t,r,n,a,i,o,l,c,d))},u}function a8(){return Rn.apply(fx(QR,e6,La,dx,zd,Bl,cx,ox,Bi,pj).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function i8(){return Rn.apply(fx(ZR,JR,Ba,hx,Wd,Hd,ux,lx,Bi,xj).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Vd(){var e=0,t=1,r,n,a,i,o=Wr,l=!1,c;function d(h){return h==null||isNaN(h=+h)?c:o(a===0?.5:(h=(i(h)-r)*a,l?Math.max(0,Math.min(1,h)):h))}d.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(h){return arguments.length?(l=!!h,d):l},d.interpolator=function(h){return arguments.length?(o=h,d):o};function u(h){return function(f){var m,x;return arguments.length?([m,x]=f,o=h(m,x),d):[o(0),o(1)]}}return d.range=u(lo),d.rangeRound=u(Jp),d.unknown=function(h){return arguments.length?(c=h,d):c},function(h){return i=h,r=h(e),n=h(t),a=r===n?0:1/(n-r),d}}function _i(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function gj(){var e=Ni(Vd()(Wr));return e.copy=function(){return _i(e,gj())},qa.apply(e,arguments)}function vj(){var e=rx(Vd()).domain([1,10]);return e.copy=function(){return _i(e,vj()).base(e.base())},qa.apply(e,arguments)}function bj(){var e=nx(Vd());return e.copy=function(){return _i(e,bj()).constant(e.constant())},qa.apply(e,arguments)}function mx(){var e=ax(Vd());return e.copy=function(){return _i(e,mx()).exponent(e.exponent())},qa.apply(e,arguments)}function s8(){return mx.apply(null,arguments).exponent(.5)}function yj(){var e=[],t=Wr;function r(n){if(n!=null&&!isNaN(n=+n))return t((Ml(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ui),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>VI(e,i/n))},r.copy=function(){return yj(t).domain(e)},qa.apply(r,arguments)}function Kd(){var e=0,t=.5,r=1,n=1,a,i,o,l,c,d=Wr,u,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+u(g))-i)*(n*g<n*i?l:c),d(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),o=u(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(d=g,m):d};function x(g){return function(v){var b,w,y;return arguments.length?([b,w,y]=v,d=vR(g,[b,w,y]),m):[d(0),d(.5),d(1)]}}return m.range=x(lo),m.rangeRound=x(Jp),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return u=g,a=g(e),i=g(t),o=g(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m}}function wj(){var e=Ni(Kd()(Wr));return e.copy=function(){return _i(e,wj())},qa.apply(e,arguments)}function Nj(){var e=rx(Kd()).domain([.1,1,10]);return e.copy=function(){return _i(e,Nj()).base(e.base())},qa.apply(e,arguments)}function _j(){var e=nx(Kd());return e.copy=function(){return _i(e,_j()).constant(e.constant())},qa.apply(e,arguments)}function px(){var e=ax(Kd());return e.copy=function(){return _i(e,px()).exponent(e.exponent())},qa.apply(e,arguments)}function o8(){return px.apply(null,arguments).exponent(.5)}const Uo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Yp,scaleDiverging:wj,scaleDivergingLog:Nj,scaleDivergingPow:px,scaleDivergingSqrt:o8,scaleDivergingSymlog:_j,scaleIdentity:tj,scaleImplicit:Em,scaleLinear:ej,scaleLog:nj,scaleOrdinal:Xp,scalePoint:XI,scalePow:ix,scaleQuantile:sj,scaleQuantize:oj,scaleRadial:ij,scaleSequential:gj,scaleSequentialLog:vj,scaleSequentialPow:mx,scaleSequentialQuantile:yj,scaleSequentialSqrt:s8,scaleSequentialSymlog:bj,scaleSqrt:UR,scaleSymlog:aj,scaleThreshold:lj,scaleTime:a8,scaleUtc:i8,tickFormat:Q5},Symbol.toStringTag,{value:"Module"}));var Za=e=>e.chartData,Gd=Q([Za],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),xx=(e,t,r,n)=>n?Gd(e):Za(e),l8=(e,t,r)=>r?Gd(e):Za(e);function $a(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(et(t)&&et(r))return!0}return!1}function gy(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function jj(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(et(r))a=r;else if(typeof r=="function")return;if(et(n))i=n;else if(typeof n=="function")return;var o=[a,i];if($a(o))return o}}function c8(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if($a(n))return gy(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,o,l;if(a==="auto")t!=null&&(o=Math.min(...t));else if(Ie(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[0]))}catch{}else if(typeof a=="string"&&k1.test(a)){var c=k1.exec(a);if(c==null||c[1]==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(Ie(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&A1.test(i)){var u=A1.exec(i);if(u==null||u[1]==null||t==null)l=void 0;else{var h=+u[1];l=t[1]+h}}else l=t?.[1];var f=[o,l];if($a(f))return t==null?f:gy(f,t,r)}}}var co=1e9,u8={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vx,kt=!0,In="[DecimalError] ",zi=In+"Invalid argument: ",gx=In+"Exponent out of range: ",uo=Math.floor,Di=Math.pow,d8=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,mn,sr=1e7,Nt=7,Sj=9007199254740991,ku=uo(Sj/Nt),Re={};Re.absoluteValue=Re.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Re.comparedTo=Re.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};Re.decimalPlaces=Re.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Nt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Re.dividedBy=Re.div=function(e){return Aa(this,new this.constructor(e))};Re.dividedToIntegerBy=Re.idiv=function(e){var t=this,r=t.constructor;return vt(Aa(t,new r(e),0,1),r.precision)};Re.equals=Re.eq=function(e){return!this.cmp(e)};Re.exponent=function(){return qt(this)};Re.greaterThan=Re.gt=function(e){return this.cmp(e)>0};Re.greaterThanOrEqualTo=Re.gte=function(e){return this.cmp(e)>=0};Re.isInteger=Re.isint=function(){return this.e>this.d.length-2};Re.isNegative=Re.isneg=function(){return this.s<0};Re.isPositive=Re.ispos=function(){return this.s>0};Re.isZero=function(){return this.s===0};Re.lessThan=Re.lt=function(e){return this.cmp(e)<0};Re.lessThanOrEqualTo=Re.lte=function(e){return this.cmp(e)<1};Re.logarithm=Re.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(mn))throw Error(In+"NaN");if(r.s<1)throw Error(In+(r.s?"NaN":"-Infinity"));return r.eq(mn)?new n(0):(kt=!1,t=Aa(dl(r,i),dl(e,i),i),kt=!0,vt(t,a))};Re.minus=Re.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Tj(t,e):Ej(t,(e.s=-e.s,e))};Re.modulo=Re.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(In+"NaN");return r.s?(kt=!1,t=Aa(r,e,0,1).times(e),kt=!0,r.minus(t)):vt(new n(r),a)};Re.naturalExponential=Re.exp=function(){return Cj(this)};Re.naturalLogarithm=Re.ln=function(){return dl(this)};Re.negated=Re.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Re.plus=Re.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ej(t,e):Tj(t,(e.s=-e.s,e))};Re.precision=Re.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(zi+e);if(t=qt(a)+1,n=a.d.length-1,r=n*Nt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Re.squareRoot=Re.sqrt=function(){var e,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(In+"NaN")}for(e=qt(l),kt=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=oa(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=uo((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(Aa(l,i,o+2)).times(.5),oa(i.d).slice(0,o)===(t=oa(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(vt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return kt=!0,vt(n,r)};Re.times=Re.mul=function(e){var t,r,n,a,i,o,l,c,d,u=this,h=u.constructor,f=u.d,m=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,c=f.length,d=m.length,c<d&&(i=f,f=m,m=i,o=c,c=d,d=o),i=[],o=c+d,n=o;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+m[n]*f[a-n-1]+t,i[a--]=l%sr|0,t=l/sr|0;i[a]=(i[a]+t)%sr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,kt?vt(e,h.precision):e};Re.toDecimalPlaces=Re.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ma(e,0,co),t===void 0?t=n.rounding:ma(t,0,8),vt(r,e+qt(r)+1,t))};Re.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Qi(n,!0):(ma(e,0,co),t===void 0?t=a.rounding:ma(t,0,8),n=vt(new a(n),e+1,t),r=Qi(n,!0,e+1)),r};Re.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Qi(a):(ma(e,0,co),t===void 0?t=i.rounding:ma(t,0,8),n=vt(new i(a),e+qt(a)+1,t),r=Qi(n.abs(),!1,e+qt(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};Re.toInteger=Re.toint=function(){var e=this,t=e.constructor;return vt(new t(e),qt(e)+1,t.rounding)};Re.toNumber=function(){return+this};Re.toPower=Re.pow=function(e){var t,r,n,a,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(mn);if(l=new c(l),!l.s){if(e.s<1)throw Error(In+"Infinity");return l}if(l.eq(mn))return l;if(n=c.precision,e.eq(mn))return vt(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=Sj){for(a=new c(mn),t=Math.ceil(n/Nt+4),kt=!1;r%2&&(a=a.times(l),by(a.d,t)),r=uo(r/2),r!==0;)l=l.times(l),by(l.d,t);return kt=!0,e.s<0?new c(mn).div(a):vt(a,n)}}else if(i<0)throw Error(In+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,kt=!1,a=e.times(dl(l,n+d)),kt=!0,a=Cj(a),a.s=i,a};Re.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=qt(a),n=Qi(a,r<=i.toExpNeg||r>=i.toExpPos)):(ma(e,1,co),t===void 0?t=i.rounding:ma(t,0,8),a=vt(new i(a),e,t),r=qt(a),n=Qi(a,e<=r||r<=i.toExpNeg,e)),n};Re.toSignificantDigits=Re.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ma(e,1,co),t===void 0?t=n.rounding:ma(t,0,8)),vt(new n(r),e,t)};Re.toString=Re.valueOf=Re.val=Re.toJSON=Re[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=qt(e),r=e.constructor;return Qi(e,t<=r.toExpNeg||t>=r.toExpPos)};function Ej(e,t){var r,n,a,i,o,l,c,d,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),kt?vt(t,h):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(h/Nt),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/sr|0,c[i]%=sr;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,kt?vt(t,h):t}function ma(e,t,r){if(e!==~~e||e<t||e>r)throw Error(zi+e)}function oa(e){var t,r,n,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)n=e[t]+"",r=Nt-n.length,r&&(i+=ii(r)),i+=n;o=e[t],n=o+"",r=Nt-n.length,r&&(i+=ii(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Aa=(function(){function e(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%sr|0,o=i/sr|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*sr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,d,u,h,f,m,x,g,v,b,w,y,N,_,S,j,E,k=n.constructor,T=n.s==a.s?1:-1,A=n.d,C=a.d;if(!n.s)return new k(n);if(!a.s)throw Error(In+"Division by zero");for(c=n.e-a.e,j=C.length,_=A.length,m=new k(T),x=m.d=[],d=0;C[d]==(A[d]||0);)++d;if(C[d]>(A[d]||0)&&--c,i==null?w=i=k.precision:o?w=i+(qt(n)-qt(a))+1:w=i,w<0)return new k(0);if(w=w/Nt+2|0,d=0,j==1)for(u=0,C=C[0],w++;(d<_||u)&&w--;d++)y=u*sr+(A[d]||0),x[d]=y/C|0,u=y%C|0;else{for(u=sr/(C[0]+1)|0,u>1&&(C=e(C,u),A=e(A,u),j=C.length,_=A.length),N=j,g=A.slice(0,j),v=g.length;v<j;)g[v++]=0;E=C.slice(),E.unshift(0),S=C[0],C[1]>=sr/2&&++S;do u=0,l=t(C,g,j,v),l<0?(b=g[0],j!=v&&(b=b*sr+(g[1]||0)),u=b/S|0,u>1?(u>=sr&&(u=sr-1),h=e(C,u),f=h.length,v=g.length,l=t(h,g,f,v),l==1&&(u--,r(h,j<f?E:C,f))):(u==0&&(l=u=1),h=C.slice()),f=h.length,f<v&&h.unshift(0),r(g,h,v),l==-1&&(v=g.length,l=t(C,g,j,v),l<1&&(u++,r(g,j<v?E:C,v))),v=g.length):l===0&&(u++,g=[0]),x[d++]=u,l&&g[0]?g[v++]=A[N]||0:(g=[A[N]],v=1);while((N++<_||g[0]!==void 0)&&w--)}return x[0]||x.shift(),m.e=c,vt(m,o?i+qt(m)+1:i)}})();function Cj(e,t){var r,n,a,i,o,l,c=0,d=0,u=e.constructor,h=u.precision;if(qt(e)>16)throw Error(gx+qt(e));if(!e.s)return new u(mn);for(kt=!1,l=h,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(n=Math.log(Di(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(mn),u.precision=l;;){if(a=vt(a.times(e),l),r=r.times(++c),o=i.plus(Aa(a,r,l)),oa(o.d).slice(0,l)===oa(i.d).slice(0,l)){for(;d--;)i=vt(i.times(i),l);return u.precision=h,t==null?(kt=!0,vt(i,h)):i}i=o}}function qt(e){for(var t=e.e*Nt,r=e.d[0];r>=10;r/=10)t++;return t}function Wh(e,t,r){if(t>e.LN10.sd())throw kt=!0,r&&(e.precision=r),Error(In+"LN10 precision limit exceeded");return vt(new e(e.LN10),t)}function ii(e){for(var t="";e--;)t+="0";return t}function dl(e,t){var r,n,a,i,o,l,c,d,u,h=1,f=10,m=e,x=m.d,g=m.constructor,v=g.precision;if(m.s<1)throw Error(In+(m.s?"NaN":"-Infinity"));if(m.eq(mn))return new g(0);if(t==null?(kt=!1,d=v):d=t,m.eq(10))return t==null&&(kt=!0),Wh(g,d);if(d+=f,g.precision=d,r=oa(x),n=r.charAt(0),i=qt(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=oa(m.d),n=r.charAt(0),h++;i=qt(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return c=Wh(g,d+2,v).times(i+""),m=dl(new g(n+"."+r.slice(1)),d-f).plus(c),g.precision=v,t==null?(kt=!0,vt(m,v)):m;for(l=o=m=Aa(m.minus(mn),m.plus(mn),d),u=vt(m.times(m),d),a=3;;){if(o=vt(o.times(u),d),c=l.plus(Aa(o,new g(a),d)),oa(c.d).slice(0,d)===oa(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(Wh(g,d+2,v).times(i+""))),l=Aa(l,new g(h),d),g.precision=v,t==null?(kt=!0,vt(l,v)):l;l=c,a+=2}}function vy(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=uo(r/Nt),e.d=[],n=(r+1)%Nt,r<0&&(n+=Nt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Nt;n<a;)e.d.push(+t.slice(n,n+=Nt));t=t.slice(n),n=Nt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),kt&&(e.e>ku||e.e<-ku))throw Error(gx+r)}else e.s=0,e.e=0,e.d=[0];return e}function vt(e,t,r){var n,a,i,o,l,c,d,u,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=Nt,a=t,d=h[u=0];else{if(u=Math.ceil((n+1)/Nt),i=h.length,u>=i)return e;for(d=i=h[u],o=1;i>=10;i/=10)o++;n%=Nt,a=n-Nt+o}if(r!==void 0&&(i=Di(10,o-a-1),l=d/i%10|0,c=t<0||h[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/Di(10,o-a):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(i=qt(e),h.length=1,t=t-i-1,h[0]=Di(10,(Nt-t%Nt)%Nt),e.e=uo(-t/Nt)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=u,i=1,u--):(h.length=u+1,i=Di(10,Nt-n),h[u]=a>0?(d/Di(10,o-a)%Di(10,a)|0)*i:0),c)for(;;)if(u==0){(h[0]+=i)==sr&&(h[0]=1,++e.e);break}else{if(h[u]+=i,h[u]!=sr)break;h[u--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(kt&&(e.e>ku||e.e<-ku))throw Error(gx+qt(e));return e}function Tj(e,t){var r,n,a,i,o,l,c,d,u,h,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),kt?vt(t,m):t;if(c=e.d,h=t.d,n=t.e,d=e.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=h.length):(r=h,n=d,l=c.length),a=Math.max(Math.ceil(m/Nt),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=h.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){u=c[a]<h[a];break}o=0}for(u&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>o;){if(c[--a]<h[a]){for(i=a;i&&c[--i]===0;)c[i]=sr-1;--c[i],c[a]+=sr}c[a]-=h[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,kt?vt(t,m):t):new f(0)}function Qi(e,t,r){var n,a=qt(e),i=oa(e.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ii(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+ii(-a-1)+i,r&&(n=r-o)>0&&(i+=ii(n))):a>=o?(i+=ii(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+ii(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=ii(n))),e.s<0?"-"+i:i}function by(e,t){if(e.length>t)return e.length=t,!0}function kj(e){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(zi+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return vy(o,i.toString())}else if(typeof i!="string")throw Error(zi+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,d8.test(i))vy(o,i);else throw Error(zi+i)}if(a.prototype=Re,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=kj,a.config=a.set=h8,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function h8(e){if(!e||typeof e!="object")throw Error(In+"Object expected");var t,r,n,a=["precision",1,co,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(uo(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(zi+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(zi+r+": "+n);return this}var vx=kj(u8);mn=new vx(1);const ht=vx;function Aj(e){var t;return e===0?t=1:t=Math.floor(new ht(e).abs().log(10).toNumber())+1,t}function Pj(e,t,r){for(var n=new ht(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var Oj=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},Dj=(e,t,r)=>{if(e.lte(0))return new ht(0);var n=Aj(e.toNumber()),a=new ht(10).pow(n),i=e.div(a),o=n!==1?.05:.1,l=new ht(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?new ht(c.toNumber()):new ht(Math.ceil(c.toNumber()))},f8=(e,t,r)=>{var n=new ht(1),a=new ht(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ht(10).pow(Aj(e)-1),a=new ht(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ht(Math.floor(e)))}else e===0?a=new ht(Math.floor((t-1)/2)):r||(a=new ht(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(a.add(new ht(c-o).mul(n)).toNumber());return l},Ij=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ht(0),tickMin:new ht(0),tickMax:new ht(0)};var o=Dj(new ht(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new ht(0):(l=new ht(t).add(r).div(2),l=l.sub(new ht(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new ht(r).sub(l).div(o).toNumber()),u=c+d+1;return u>n?Ij(t,r,n,a,i+1):(u<n&&(d=r>0?d+(n-u):d,c=r>0?c:c+(n-u)),{step:o,tickMin:l.sub(new ht(c).mul(o)),tickMax:l.add(new ht(d).mul(o))})},m8=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=Oj([r,n]);if(l===-1/0||c===1/0){var d=c===1/0?[l,...Array(a-1).fill(1/0)]:[...Array(a-1).fill(-1/0),c];return r>n?d.reverse():d}if(l===c)return f8(l,a,i);var{step:u,tickMin:h,tickMax:f}=Ij(l,c,o,i,0),m=Pj(h,f.add(new ht(.1).mul(u)),u);return r>n?m.reverse():m},p8=function(t,r){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=Oj([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),d=Dj(new ht(l).sub(o).div(c-1),i,0),u=[...Pj(new ht(o),new ht(l),d),l];return i===!1&&(u=u.map(h=>Math.round(h))),n>a?u.reverse():u},Rj=e=>e.rootProps.maxBarSize,x8=e=>e.rootProps.barGap,Mj=e=>e.rootProps.barCategoryGap,g8=e=>e.rootProps.barSize,$l=e=>e.rootProps.stackOffset,Fj=e=>e.rootProps.reverseStackOrder,bx=e=>e.options.chartName,yx=e=>e.rootProps.syncId,Lj=e=>e.rootProps.syncMethod,wx=e=>e.options.eventEmitter,Gt={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},ki={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Zn={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Xd=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Yd(e,t,r){if(r!=="auto")return r;if(e!=null)return Ga(e,t)?"category":"number"}function yy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Au(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yy(Object(r),!0).forEach(function(n){v8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v8(e,t,r){return(t=b8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b8(e){var t=y8(e,"string");return typeof t=="symbol"?t:t+""}function y8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wy={allowDataOverflow:ki.allowDataOverflow,allowDecimals:ki.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ki.angleAxisId,includeHidden:!1,name:void 0,reversed:ki.reversed,scale:ki.scale,tick:ki.tick,tickCount:void 0,ticks:void 0,type:ki.type,unit:void 0},Ny={allowDataOverflow:Zn.allowDataOverflow,allowDecimals:Zn.allowDecimals,allowDuplicatedCategory:Zn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Zn.radiusAxisId,includeHidden:Zn.includeHidden,name:void 0,reversed:Zn.reversed,scale:Zn.scale,tick:Zn.tick,tickCount:Zn.tickCount,ticks:void 0,type:Zn.type,unit:void 0},w8=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},Nx=Q([w8,_5],(e,t)=>{var r;if(e!=null)return e;var n=(r=Yd(t,"angleAxis",wy.type))!==null&&r!==void 0?r:"category";return Au(Au({},wy),{},{type:n})}),N8=(e,t)=>e.polarAxis.radiusAxis[t],_x=Q([N8,_5],(e,t)=>{var r;if(e!=null)return e;var n=(r=Yd(t,"radiusAxis",Ny.type))!==null&&r!==void 0?r:"category";return Au(Au({},Ny),{},{type:n})}),qd=e=>e.polarOptions,jx=Q([Xa,Ya,tr],$5),Bj=Q([qd,jx],(e,t)=>{if(e!=null)return Or(e.innerRadius,t,0)}),$j=Q([qd,jx],(e,t)=>{if(e!=null)return Or(e.outerRadius,t,t*.8)}),_8=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},Uj=Q([qd],_8);Q([Nx,Uj],Xd);var Hj=Q([jx,Bj,$j],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Q([_x,Hj],Xd);var zj=Q([at,qd,Bj,$j,Xa,Ya],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:Or(o,a,a/2),cy:Or(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:d,clockWise:!1}}}),Ft=(e,t)=>t,Ul=(e,t,r)=>r;function Sx(e){return e?.id}function Wj(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:n;if(!(d==null||d.length===0)){var u=Sx(l);d.forEach((h,f)=>{var m=i==null||a?f:String(xt(h,i,null)),x=xt(h,l.dataKey,0),g;o.has(m)?g=o.get(m):g={},Object.assign(g,{[u]:x}),o.set(m,g)})}}),Array.from(o.values())}function Zd(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Jd=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Qd(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function j8(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var mr=e=>{var t=at(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ho=e=>e.tooltip.settings.axisId;function S8(e){if(e in Uo)return Uo[e]();var t="scale".concat(Tl(e));if(t in Uo)return Uo[t]()}function _y(e){var t=e.ticks,r=e.bandwidth,n=e.range(),a=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:(function(i){function o(){return i.apply(this,arguments)}return o.toString=function(){return i.toString()},o})(()=>a),rangeMin:()=>a[0],rangeMax:()=>a[1],isInRange(i){var o=a[0],l=a[1];return o<=l?i>=o&&i<=l:i>=l&&i<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?i=>t.call(e,i):void 0,map:(i,o)=>{var l=e(i);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function jy(e,t,r){if(typeof e=="function")return _y(e.copy().domain(t).range(r));if(e!=null){var n=S8(e);if(n!=null)return n.domain(t).range(r),_y(n)}}var Vj=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!$a(t)){for(var r,n,a=0;a<t.length;a++){var i=t[a];et(i)&&((r===void 0||i<r)&&(r=i),(n===void 0||i>n)&&(n=i))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function Sy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sy(Object(r),!0).forEach(function(n){E8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E8(e,t,r){return(t=C8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C8(e){var t=T8(e,"string");return typeof t=="symbol"?t:t+""}function T8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Am=[0,"auto"],ar={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Kj=(e,t)=>e.cartesianAxis.xAxis[t],Ja=(e,t)=>{var r=Kj(e,t);return r??ar},ir={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Am,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Pl},Gj=(e,t)=>e.cartesianAxis.yAxis[t],Qa=(e,t)=>{var r=Gj(e,t);return r??ir},k8={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Ex=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??k8},Ut=(e,t,r)=>{switch(t){case"xAxis":return Ja(e,r);case"yAxis":return Qa(e,r);case"zAxis":return Ex(e,r);case"angleAxis":return Nx(e,r);case"radiusAxis":return _x(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},A8=(e,t,r)=>{switch(t){case"xAxis":return Ja(e,r);case"yAxis":return Qa(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},fo=(e,t,r)=>{switch(t){case"xAxis":return Ja(e,r);case"yAxis":return Qa(e,r);case"angleAxis":return Nx(e,r);case"radiusAxis":return _x(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Xj=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Cx(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var e0=e=>e.graphicalItems.cartesianItems,P8=Q([Ft,Ul],Cx),Tx=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Hl=Q([e0,Ut,P8],Tx,{memoizeOptions:{resultEqualityCheck:Qd}}),Yj=Q([Hl],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Zd)),qj=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),O8=Q([Hl],qj),kx=e=>e.map(t=>t.data).filter(Boolean).flat(1),D8=Q([Hl],kx,{memoizeOptions:{resultEqualityCheck:Qd}}),Ax=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Px=Q([D8,xx],Ax),Ox=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:xt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:xt(a,n)}))):e.map(n=>({value:n})),t0=Q([Px,Ut,Hl],Ox);function Zj(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Uc(e){if(ha(e)||e instanceof Date){var t=Number(e);if(et(t))return t}}function Ey(e){if(Array.isArray(e)){var t=[Uc(e[0]),Uc(e[1])];return $a(t)?t:void 0}var r=Uc(e);if(r!=null)return[r,r]}function Ua(e){return e.map(Uc).filter(tn)}function I8(e,t,r){return!r||typeof t!="number"||da(t)?[]:r.length?Ua(r.flatMap(n=>{var a=xt(e,n.dataKey),i,o;if(Array.isArray(a)?[i,o]=a:i=o=a,!(!et(i)||!et(o)))return[t-i,t+o]})):[]}var nr=e=>{var t=mr(e),r=ho(e);return fo(e,t,r)},zl=Q([nr],e=>e?.dataKey),R8=Q([Yj,xx,nr],Wj),Jj=(e,t,r,n)=>{var a={},i=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(i).map(o=>{var[l,c]=o,d=n?[...c].reverse():c,u=d.map(Sx);return[l,{stackedData:xO(e,u,r),graphicalItems:d}]}))},Pm=Q([R8,Yj,$l,Fj],Jj),Qj=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var o=wO(e,a,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},M8=Q([Ut],e=>e.allowDataOverflow),Dx=e=>{var t;if(e==null||!("domain"in e))return Am;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=Ua(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:Am},Ix=Q([Ut],Dx),Rx=Q([Ix,M8],jj),F8=Q([Pm,Za,Ft,Rx],Qj,{memoizeOptions:{resultEqualityCheck:Jd}}),r0=e=>e.errorBars,L8=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>Zj(r,n)),Ou=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),o=Math.min(...i),l=Math.max(...i);return[o,l]}},Mx=(e,t,r,n,a)=>{var i,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var d,u,h=(d=n[c.id])===null||d===void 0?void 0:d.filter(b=>Zj(a,b)),f=xt(l,(u=t.dataKey)!==null&&u!==void 0?u:c.dataKey),m=I8(l,f,h);if(m.length>=2){var x=Math.min(...m),g=Math.max(...m);(i==null||x<i)&&(i=x),(o==null||g>o)&&(o=g)}var v=Ey(f);v!=null&&(i=i==null?v[0]:Math.min(i,v[0]),o=o==null?v[1]:Math.max(o,v[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var c=Ey(xt(l,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),et(i)&&et(o))return[i,o]},B8=Q([Px,Ut,O8,r0,Ft],Mx,{memoizeOptions:{resultEqualityCheck:Jd}});function $8(e){var{value:t}=e;if(ha(t)||t instanceof Date)return t}var U8=(e,t,r)=>{var n=e.map($8).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&v_(n))?W5(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},eS=e=>e.referenceElements.dots,mo=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),H8=Q([eS,Ft,Ul],mo),tS=e=>e.referenceElements.areas,z8=Q([tS,Ft,Ul],mo),rS=e=>e.referenceElements.lines,W8=Q([rS,Ft,Ul],mo),nS=(e,t)=>{if(e!=null){var r=Ua(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},V8=Q(H8,Ft,nS),aS=(e,t)=>{if(e!=null){var r=Ua(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},K8=Q([z8,Ft],aS);function G8(e){var t;if(e.x!=null)return Ua([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:Ua(r)}function X8(e){var t;if(e.y!=null)return Ua([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:Ua(r)}var iS=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?G8(n):X8(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Y8=Q([W8,Ft],iS),q8=Q(V8,Y8,K8,(e,t,r)=>Ou(e,r,t)),Fx=(e,t,r,n,a,i,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",d=c?Ou(n,i,a):Ou(i,a);return c8(t,d,e.allowDataOverflow)},Z8=Q([Ut,Ix,Rx,F8,B8,q8,at,Ft],Fx,{memoizeOptions:{resultEqualityCheck:Jd}}),J8=[0,1],Lx=(e,t,r,n,a,i,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=Ga(t,i);if(d&&l==null){var u;return W5(0,(u=r?.length)!==null&&u!==void 0?u:0)}return c==="category"?U8(n,e,d):a==="expand"?J8:o}},Bx=Q([Ut,at,Px,t0,$l,Ft,Z8],Lx);function Q8(e){return e in Uo}var sS=(e,t,r)=>{if(e!=null){var{scale:n,type:a}=e;if(n==="auto")return a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":a==="category"?"band":"linear";if(typeof n=="string"){var i="scale".concat(Tl(n));return Q8(i)?i:"point"}}},ji=Q([Ut,Xj,bx],sS);function $x(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?jy(e.scale,r,n):jy(t,r,n)}var Ux=(e,t,r)=>{var n=Dx(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&$a(e))return m8(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&$a(e))return p8(e,t.tickCount,t.allowDecimals)}},Hx=Q([Bx,fo,ji],Ux),zx=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&$a(t)&&Array.isArray(r)&&r.length>0){var a,i,o=t[0],l=(a=r[0])!==null&&a!==void 0?a:0,c=t[1],d=(i=r[r.length-1])!==null&&i!==void 0?i:0;return[Math.min(o,l),Math.max(c,d)]}return t},eM=Q([Ut,Bx,Hx,Ft],zx),tM=Q(t0,Ut,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Ua(e.map(h=>h.value))).sort((h,f)=>h-f),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var o=i-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],d=n[l+1];if(!(c==null||d==null)){var u=d-c;r=Math.min(r,u)}}return r/o}}),oS=Q(tM,at,Mj,tr,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!et(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var o=Or(r,e*i),l=e*i/2;return l-o-(l-o)/i*o}return 0}),rM=(e,t,r)=>{var n=Ja(e,t);return n==null||typeof n.padding!="string"?0:oS(e,"xAxis",t,r,n.padding)},nM=(e,t,r)=>{var n=Qa(e,t);return n==null||typeof n.padding!="string"?0:oS(e,"yAxis",t,r,n.padding)},aM=Q(Ja,rM,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),iM=Q(Qa,nM,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),sM=Q([tr,aM,Rd,Id,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),oM=Q([tr,at,iM,Rd,Id,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:o}=a;return i?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Wl=(e,t,r,n)=>{var a;switch(t){case"xAxis":return sM(e,r,n);case"yAxis":return oM(e,r,n);case"zAxis":return(a=Ex(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return Uj(e);case"radiusAxis":return Hj(e,r);default:return}},lS=Q([Ut,Wl],Xd),lM=Q([ji,eM],Vj),n0=Q([Ut,ji,lM,lS],$x);Q([Hl,r0,Ft],L8);function cS(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var a0=(e,t)=>t,i0=(e,t,r)=>r,cM=Q(Od,a0,i0,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(cS)),uM=Q(Dd,a0,i0,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(cS)),uS=(e,t)=>({width:e.width,height:t.height}),dM=(e,t)=>{var r=typeof t.width=="number"?t.width:Pl;return{width:r,height:e.height}},dS=Q(tr,Ja,uS),hM=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},fM=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},mM=Q(Ya,tr,cM,a0,i0,(e,t,r,n,a)=>{var i={},o;return r.forEach(l=>{var c=uS(t,l);o==null&&(o=hM(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),i}),pM=Q(Xa,tr,uM,a0,i0,(e,t,r,n,a)=>{var i={},o;return r.forEach(l=>{var c=dM(t,l);o==null&&(o=fM(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),i}),xM=(e,t)=>{var r=Ja(e,t);if(r!=null)return mM(e,r.orientation,r.mirror)},gM=Q([tr,Ja,xM,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),vM=(e,t)=>{var r=Qa(e,t);if(r!=null)return pM(e,r.orientation,r.mirror)},bM=Q([tr,Qa,vM,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),hS=Q(tr,Qa,(e,t)=>{var r=typeof t.width=="number"?t.width:Pl;return{width:r,height:e.height}}),Cy=(e,t,r)=>{switch(t){case"xAxis":return dS(e,r).width;case"yAxis":return hS(e,r).height;default:return}},fS=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:o}=r,l=Ga(e,n),c=t.map(d=>d.value);if(o&&l&&i==="category"&&a&&v_(c))return c}},Wx=Q([at,t0,Ut,Ft],fS),mS=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,o=Ga(e,n);if(o&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},Vx=Q([at,t0,fo,Ft],mS),Ty=Q([at,A8,ji,n0,Wx,Vx,Wl,Hx,Ft],(e,t,r,n,a,i,o,l,c)=>{if(t!=null){var d=Ga(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:r,scale:n}}}),yM=(e,t,r,n,a,i,o,l,c)=>{if(!(t==null||n==null)){var d=Ga(e,c),{type:u,ticks:h,tickCount:f}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=u==="category"&&n.bandwidth?n.bandwidth()/m:0;x=c==="angleAxis"&&i!=null&&i.length>=2?lr(i[0]-i[1])*2*x:x;var g=h||a;return g?g.map((v,b)=>{var w=o?o.indexOf(v):v,y=n.map(w);return et(y)?{index:b,coordinate:y+x,value:v,offset:x}:null}).filter(tn):d&&l?l.map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:v,index:b,offset:x}:null}).filter(tn):n.ticks?n.ticks(f).map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:v,index:b,offset:x}:null}).filter(tn):n.domain().map((v,b)=>{var w=n.map(v);return et(w)?{coordinate:w+x,value:o?o[v]:v,index:b,offset:x}:null}).filter(tn)}},pS=Q([at,fo,ji,n0,Hx,Wl,Wx,Vx,Ft],yM),wM=(e,t,r,n,a,i,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=Ga(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&n?.length>=2?lr(n[0]-n[1])*2*d:d,l&&i?i.map((u,h)=>{var f=r.map(u);return et(f)?{coordinate:f+d,value:u,index:h,offset:d}:null}).filter(tn):r.ticks?r.ticks(c).map((u,h)=>{var f=r.map(u);return et(f)?{coordinate:f+d,value:u,index:h,offset:d}:null}).filter(tn):r.domain().map((u,h)=>{var f=r.map(u);return et(f)?{coordinate:f+d,value:a?a[u]:u,index:h,offset:d}:null}).filter(tn)}},fi=Q([at,fo,n0,Wl,Wx,Vx,Ft],wM),mi=Q(Ut,n0,(e,t)=>{if(!(e==null||t==null))return Pu(Pu({},e),{},{scale:t})}),NM=Q([Ut,ji,Bx,lS],$x);Q((e,t,r)=>Ex(e,r),NM,(e,t)=>{if(!(e==null||t==null))return Pu(Pu({},e),{},{scale:t})});var _M=Q([at,Od,Dd],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),xS=e=>e.options.defaultTooltipEventType,gS=e=>e.options.validateTooltipEventTypes;function vS(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Kx(e,t){var r=xS(e),n=gS(e);return vS(t,r,n)}function jM(e){return Fe(t=>Kx(t,e))}var bS=(e,t)=>{var r,n=Number(t);if(!(da(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},SM=e=>e.tooltip.settings,oi={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},EM={itemInteraction:{click:oi,hover:oi},axisInteraction:{click:oi,hover:oi},keyboardInteraction:oi,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},yS=sn({name:"tooltip",initialState:EM,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Et()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Vn(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:Et()},removeTooltipEntrySettings:{reducer(e,t){var r=Vn(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Et()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:CM,replaceTooltipEntrySettings:TM,removeTooltipEntrySettings:kM,setTooltipSettingsState:AM,setActiveMouseOverItemIndex:wS,mouseLeaveItem:PM,mouseLeaveChart:NS,setActiveClickItemIndex:OM,setMouseOverAxisIndex:_S,setMouseClickAxisIndex:DM,setSyncInteraction:Om,setKeyboardInteraction:Dm}=yS.actions,IM=yS.reducer;function ky(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ky(Object(r),!0).forEach(function(n){RM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ky(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RM(e,t,r){return(t=MM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MM(e){var t=FM(e,"string");return typeof t=="symbol"?t:t+""}function FM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LM(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function BM(e){return e.index!=null}var jS=(e,t,r,n)=>{if(t==null)return oi;var a=LM(e,t,r);if(a==null)return oi;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(BM(a)){if(i)return pc(pc({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return pc(pc({},oi),{},{coordinate:a.coordinate})};function $M(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function UM(e,t){var r=$M(e),n=t[0],a=t[1];if(r===void 0)return!1;var i=Math.min(n,a),o=Math.max(n,a);return r>=i&&r<=o}function HM(e,t,r){if(r==null||t==null)return!0;var n=xt(e,t);return n==null||!$a(r)?!0:UM(n,r)}var Gx=(e,t,r,n)=>{var a=e?.index;if(a==null)return null;var i=Number(a);if(!et(i))return a;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(i,l)),d=t[c];return d==null||HM(d,r,n)?String(c):null},SS=(e,t,r,n,a,i,o)=>{if(i!=null){var l=o[0],c=l?.getPosition(i);if(c!=null)return c;var d=a?.[Number(i)];if(d)return r==="horizontal"?{x:d.coordinate,y:(n.top+t)/2}:{x:(n.left+e)/2,y:d.coordinate}}},ES=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},CS=e=>e.options.tooltipPayloadSearcher,po=e=>e.tooltip;function Ay(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Py(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ay(Object(r),!0).forEach(function(n){zM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ay(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zM(e,t,r){return(t=WM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WM(e){var t=VM(e,"string");return typeof t=="symbol"?t:t+""}function VM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KM(e,t){return e??t}var TS=(e,t,r,n,a,i,o)=>{if(!(t==null||i==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=r,h=[];return e.reduce((f,m)=>{var x,{dataDefinedOnItem:g,settings:v}=m,b=KM(g,l),w=Array.isArray(b)?u5(b,d,u):b,y=(x=v?.dataKey)!==null&&x!==void 0?x:n,N=v?.nameKey,_;if(n&&Array.isArray(w)&&!Array.isArray(w[0])&&o==="axis"?_=b_(w,n,a):_=i(w,t,c,N),Array.isArray(_))_.forEach(j=>{var E=Py(Py({},v),{},{name:j.name,unit:j.unit,color:void 0,fill:void 0});f.push(P1({tooltipEntrySettings:E,dataKey:j.dataKey,payload:j.payload,value:xt(j.payload,j.dataKey),name:j.name}))});else{var S;f.push(P1({tooltipEntrySettings:v,dataKey:y,payload:_,value:xt(_,y),name:(S=xt(_,N))!==null&&S!==void 0?S:v?.name}))}return f},h)}},Xx=Q([nr,Xj,bx],sS),GM=Q([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),XM=Q([mr,ho],Cx),xo=Q([GM,nr,XM],Tx,{memoizeOptions:{resultEqualityCheck:Qd}}),YM=Q([xo],e=>e.filter(Zd)),qM=Q([xo],kx,{memoizeOptions:{resultEqualityCheck:Qd}}),go=Q([qM,Za],Ax),ZM=Q([YM,Za,nr],Wj),Yx=Q([go,nr,xo],Ox),kS=Q([nr],Dx),JM=Q([nr],e=>e.allowDataOverflow),AS=Q([kS,JM],jj),QM=Q([xo],e=>e.filter(Zd)),eF=Q([ZM,QM,$l,Fj],Jj),tF=Q([eF,Za,mr,AS],Qj),rF=Q([xo],qj),nF=Q([go,nr,rF,r0,mr],Mx,{memoizeOptions:{resultEqualityCheck:Jd}}),aF=Q([eS,mr,ho],mo),iF=Q([aF,mr],nS),sF=Q([tS,mr,ho],mo),oF=Q([sF,mr],aS),lF=Q([rS,mr,ho],mo),cF=Q([lF,mr],iS),uF=Q([iF,cF,oF],Ou),dF=Q([nr,kS,AS,tF,nF,uF,at,mr],Fx),Vl=Q([nr,at,go,Yx,$l,mr,dF],Lx),hF=Q([Vl,nr,Xx],Ux),fF=Q([nr,Vl,hF,mr],zx),PS=e=>{var t=mr(e),r=ho(e),n=!1;return Wl(e,t,r,n)},OS=Q([nr,PS],Xd),DS=Q([nr,Xx,fF,OS],$x),mF=Q([at,Yx,nr,mr],fS),pF=Q([at,Yx,nr,mr],mS),xF=(e,t,r,n,a,i,o,l)=>{if(t){var{type:c}=t,d=Ga(e,l);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=l==="angleAxis"&&a!=null&&a?.length>=2?lr(a[0]-a[1])*2*h:h,d&&o?o.map((f,m)=>{var x=n.map(f);return et(x)?{coordinate:x+h,value:f,index:m,offset:h}:null}).filter(tn):n.domain().map((f,m)=>{var x=n.map(f);return et(x)?{coordinate:x+h,value:i?i[f]:f,index:m,offset:h}:null}).filter(tn)}}},ei=Q([at,nr,Xx,DS,PS,mF,pF,mr],xF),qx=Q([xS,gS,SM],(e,t,r)=>vS(r.shared,e,t)),IS=e=>e.tooltip.settings.trigger,Zx=e=>e.tooltip.settings.defaultIndex,Kl=Q([po,qx,IS,Zx],jS),pi=Q([Kl,go,zl,Vl],Gx),RS=Q([ei,pi],bS),Jx=Q([Kl],e=>{if(e)return e.dataKey}),gF=Q([Kl],e=>{if(e)return e.graphicalItemId}),MS=Q([po,qx,IS,Zx],ES),vF=Q([Xa,Ya,at,tr,ei,Zx,MS],SS),bF=Q([Kl,vF],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),yF=Q([Kl],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),wF=Q([MS,pi,Za,zl,RS,CS,qx],TS),NF=Q([wF],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Oy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oy(Object(r),!0).forEach(function(n){_F(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _F(e,t,r){return(t=jF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jF(e){var t=SF(e,"string");return typeof t=="symbol"?t:t+""}function SF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EF=()=>Fe(nr),CF=()=>{var e=EF(),t=Fe(ei),r=Fe(DS);return eo(!e||!r?void 0:Dy(Dy({},e),{},{scale:r}),t)};function Iy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function js(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iy(Object(r),!0).forEach(function(n){TF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TF(e,t,r){return(t=kF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kF(e){var t=AF(e,"string");return typeof t=="symbol"?t:t+""}function AF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PF=(e,t,r,n)=>{var a=t.find(i=>i&&i.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},OF=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="centric"){var i=a.coordinate,{radius:o}=n;return js(js(js({},n),Kt(n.cx,n.cy,o,i)),{},{angle:i,radius:o})}var l=a.coordinate,{angle:c}=n;return js(js(js({},n),Kt(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function DF(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var FS=(e,t,r,n,a)=>{var i,o=(i=t?.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,d,u,h,f,m=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(d=r[o-1])===null||d===void 0?void 0:d.coordinate,x=(u=r[l])===null||u===void 0?void 0:u.coordinate,g=l>=o-1?(h=r[0])===null||h===void 0?void 0:h.coordinate:(f=r[l+1])===null||f===void 0?void 0:f.coordinate,v=void 0;if(!(m==null||x==null||g==null))if(lr(x-m)!==lr(g-x)){var b=[];if(lr(g-x)===lr(a[1]-a[0])){v=g;var w=x+a[1]-a[0];b[0]=Math.min(w,(w+m)/2),b[1]=Math.max(w,(w+m)/2)}else{v=m;var y=g+a[1]-a[0];b[0]=Math.min(x,(y+x)/2),b[1]=Math.max(x,(y+x)/2)}var N=[Math.min(x,(v+x)/2),Math.max(x,(v+x)/2)];if(e>N[0]&&e<=N[1]||e>=b[0]&&e<=b[1]){var _;return(_=r[l])===null||_===void 0?void 0:_.index}}else{var S=Math.min(m,g),j=Math.max(m,g);if(e>(S+x)/2&&e<=(j+x)/2){var E;return(E=r[l])===null||E===void 0?void 0:E.index}}}else if(t)for(var k=0;k<o;k++){var T=t[k];if(T!=null){var A=t[k+1],C=t[k-1];if(k===0&&A!=null&&e<=(T.coordinate+A.coordinate)/2||k===o-1&&C!=null&&e>(T.coordinate+C.coordinate)/2||k>0&&k<o-1&&C!=null&&A!=null&&e>(T.coordinate+C.coordinate)/2&&e<=(T.coordinate+A.coordinate)/2)return T.index}}return-1},IF=()=>Fe(bx),Qx=(e,t)=>t,LS=(e,t,r)=>r,eg=(e,t,r,n)=>n,RF=Q(ei,e=>Nd(e,t=>t.coordinate)),tg=Q([po,Qx,LS,eg],jS),rg=Q([tg,go,zl,Vl],Gx),MF=(e,t,r)=>{if(t!=null){var n=po(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},BS=Q([po,Qx,LS,eg],ES),Du=Q([Xa,Ya,at,tr,ei,eg,BS],SS),FF=Q([tg,Du],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),$S=Q([ei,rg],bS),LF=Q([BS,rg,Za,zl,$S,CS,Qx],TS),BF=Q([tg,rg],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),$F=(e,t,r,n,a,i,o)=>{if(!(!e||!r||!n||!a)&&DF(e,o)){var l=NO(e,t),c=FS(l,i,a,r,n),d=PF(t,a,c,e);return{activeIndex:String(c),activeCoordinate:d}}},UF=(e,t,r,n,a,i,o)=>{if(!(!e||!n||!a||!i||!r)){var l=jI(e,r);if(l){var c=_O(l,t),d=FS(c,o,i,n,a),u=OF(t,i,d,l);return{activeIndex:String(d),activeCoordinate:u}}}},HF=(e,t,r,n,a,i,o,l)=>{if(!(!e||!t||!n||!a||!i))return t==="horizontal"||t==="vertical"?$F(e,t,n,a,i,o,l):UF(e,t,r,n,a,i,o)},zF=Q(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),WF=Q(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Gt)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:j8}});function Ry(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function My(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ry(Object(r),!0).forEach(function(n){VF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ry(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VF(e,t,r){return(t=KF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KF(e){var t=GF(e,"string");return typeof t=="symbol"?t:t+""}function GF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XF={},YF={zIndexMap:Object.values(Gt).reduce((e,t)=>My(My({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),XF)},qF=new Set(Object.values(Gt));function ZF(e){return qF.has(e)}var US=sn({name:"zIndex",initialState:YF,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Et()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!ZF(r)&&delete e.zIndexMap[r])},prepare:Et()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Et()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:Et()}}}),{registerZIndexPortal:JF,unregisterZIndexPortal:QF,registerZIndexPortalElement:eL,unregisterZIndexPortalElement:tL}=US.actions,rL=US.reducer;function on(e){var{zIndex:t,children:r}=e,n=QO(),a=n&&t!==void 0&&t!==0,i=Mr(),o=Ot();p.useLayoutEffect(()=>a?(o(JF({zIndex:t})),()=>{o(QF({zIndex:t}))}):cs,[o,t,a]);var l=Fe(c=>zF(c,t,i));return a?l?$N.createPortal(r,l):null:r}function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Im.apply(null,arguments)}function Fy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fy(Object(r),!0).forEach(function(n){nL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nL(e,t,r){return(t=aL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aL(e){var t=iL(e,"string");return typeof t=="symbol"?t:t+""}function iL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sL(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return p.isValidElement(t)?p.cloneElement(t,n):p.createElement(r,n)}function oL(e){var t,{coordinate:r,payload:n,index:a,offset:i,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:d,chartName:u}=e,h=r,f=n,m=a;if(!c||!h||u!=="ScatterChart"&&d!=="axis")return null;var x,g,v;if(u==="ScatterChart")x=h,g=LD,v=Gt.cursorLine;else if(u==="BarChart")x=BD(l,h,i,o),g=B5,v=Gt.cursorRectangle;else if(l==="radial"&&N_(h)){var{cx:b,cy:w,radius:y,startAngle:N,endAngle:_}=U5(h);x={cx:b,cy:w,startAngle:N,endAngle:_,innerRadius:y,outerRadius:y},g=z5,v=Gt.cursorLine}else x={points:TI(l,h,i)},g=Kp,v=Gt.cursorLine;var S=typeof c=="object"&&"className"in c?c.className:void 0,j=xc(xc(xc(xc({stroke:"#ccc",pointerEvents:"none"},i),x),Ki(c)),{},{payload:f,payloadIndex:m,className:lt("recharts-tooltip-cursor",S)});return p.createElement(on,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:v},p.createElement(sL,{cursor:c,cursorComp:g,cursorProps:j}))}function lL(e){var t=CF(),r=b5(),n=us(),a=IF();return t==null||r==null||n==null||a==null?null:p.createElement(oL,Im({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var HS=p.createContext(null),cL=()=>p.useContext(HS),Vh={exports:{}},Ly;function uL(){return Ly||(Ly=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,h||c,f),x=r?r+d:d;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],m]:c._events[x].push(m):(c._events[x]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,h;if(this._eventsCount===0)return d;for(h in u=this._events)t.call(u,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,x=new Array(m);f<m;f++)x[f]=h[f].fn;return x},l.prototype.listenerCount=function(d){var u=r?r+d:d,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,u,h,f,m,x){var g=r?r+d:d;if(!this._events[g])return!1;var v=this._events[g],b=arguments.length,w,y;if(v.fn){switch(v.once&&this.removeListener(d,v.fn,void 0,!0),b){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,f),!0;case 5:return v.fn.call(v.context,u,h,f,m),!0;case 6:return v.fn.call(v.context,u,h,f,m,x),!0}for(y=1,w=new Array(b-1);y<b;y++)w[y-1]=arguments[y];v.fn.apply(v.context,w)}else{var N=v.length,_;for(y=0;y<N;y++)switch(v[y].once&&this.removeListener(d,v[y].fn,void 0,!0),b){case 1:v[y].fn.call(v[y].context);break;case 2:v[y].fn.call(v[y].context,u);break;case 3:v[y].fn.call(v[y].context,u,h);break;case 4:v[y].fn.call(v[y].context,u,h,f);break;default:if(!w)for(_=1,w=new Array(b-1);_<b;_++)w[_-1]=arguments[_];v[y].fn.apply(v[y].context,w)}}return!0},l.prototype.on=function(d,u,h){return i(this,d,u,h,!1)},l.prototype.once=function(d,u,h){return i(this,d,u,h,!0)},l.prototype.removeListener=function(d,u,h,f){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var x=this._events[m];if(x.fn)x.fn===u&&(!f||x.once)&&(!h||x.context===h)&&o(this,m);else{for(var g=0,v=[],b=x.length;g<b;g++)(x[g].fn!==u||f&&!x[g].once||h&&x[g].context!==h)&&v.push(x[g]);v.length?this._events[m]=v.length===1?v[0]:v:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Vh)),Vh.exports}var dL=uL();const hL=wi(dL);var hl=new hL,Rm="recharts.syncEvent.tooltip",By="recharts.syncEvent.brush",ng=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!da(r))return e[r]}},fL={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},zS=sn({name:"options",initialState:fL,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),mL=zS.reducer,{createEventEmitter:pL}=zS.actions;function xL(e){return e.tooltip.syncInteraction}var gL={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},WS=sn({name:"chartData",initialState:gL,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:$y,setDataStartEndIndexes:vL,setComputedData:_ne}=WS.actions,bL=WS.reducer,yL=["x","y"];function Uy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ss(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uy(Object(r),!0).forEach(function(n){wL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wL(e,t,r){return(t=NL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NL(e){var t=_L(e,"string");return typeof t=="symbol"?t:t+""}function _L(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jL(e,t){if(e==null)return{};var r,n,a=SL(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function SL(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function EL(){var e=Fe(yx),t=Fe(wx),r=Ot(),n=Fe(Lj),a=Fe(ei),i=us(),o=Md(),l=Fe(c=>c.rootProps.className);p.useEffect(()=>{if(e==null)return cs;var c=(d,u,h)=>{if(t!==h&&e===d){if(n==="index"){var f;if(o&&u!==null&&u!==void 0&&(f=u.payload)!==null&&f!==void 0&&f.coordinate&&u.payload.sourceViewBox){var m=u.payload.coordinate,{x,y:g}=m,v=jL(m,yL),{x:b,y:w,width:y,height:N}=u.payload.sourceViewBox,_=Ss(Ss({},v),{},{x:o.x+(y?(x-b)/y:0)*o.width,y:o.y+(N?(g-w)/N:0)*o.height});r(Ss(Ss({},u),{},{payload:Ss(Ss({},u.payload),{},{coordinate:_})}))}else r(u);return}if(a!=null){var S;if(typeof n=="function"){var j={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},E=n(a,j);S=a[E]}else n==="value"&&(S=a.find(X=>String(X.value)===u.payload.label));var{coordinate:k}=u.payload;if(S==null||u.payload.active===!1||k==null||o==null){r(Om({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:T,y:A}=k,C=Math.min(T,o.x+o.width),R=Math.min(A,o.y+o.height),G={x:i==="horizontal"?S.coordinate:C,y:i==="horizontal"?R:S.coordinate},V=Om({active:u.payload.active,coordinate:G,dataKey:u.payload.dataKey,index:String(S.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox,graphicalItemId:u.payload.graphicalItemId});r(V)}}};return hl.on(Rm,c),()=>{hl.off(Rm,c)}},[l,r,t,e,n,a,i,o])}function CL(){var e=Fe(yx),t=Fe(wx),r=Ot();p.useEffect(()=>{if(e==null)return cs;var n=(a,i,o)=>{t!==o&&e===a&&r(vL(i))};return hl.on(By,n),()=>{hl.off(By,n)}},[r,t,e])}function TL(){var e=Ot();p.useEffect(()=>{e(pL())},[e]),EL(),CL()}function kL(e,t,r,n,a,i){var o=Fe(m=>MF(m,e,t)),l=Fe(wx),c=Fe(yx),d=Fe(Lj),u=Fe(xL),h=u?.active,f=Md();p.useEffect(()=>{if(!h&&c!=null&&l!=null){var m=Om({active:i,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:f,graphicalItemId:void 0});hl.emit(Rm,c,m,l)}},[h,r,o,a,n,l,c,d,i,f])}function Hy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hy(Object(r),!0).forEach(function(n){AL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AL(e,t,r){return(t=PL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PL(e){var t=OL(e,"string");return typeof t=="symbol"?t:t+""}function OL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DL(e){return e.dataKey}function IL(e,t){return p.isValidElement(e)?p.cloneElement(e,t):typeof e=="function"?p.createElement(e,t):p.createElement(gD,t)}var Wy=[],RL={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function ag(e){var t,r,n=hr(e,RL),{active:a,allowEscapeViewBox:i,animationDuration:o,animationEasing:l,content:c,filterNull:d,isAnimationActive:u,offset:h,payloadUniqBy:f,position:m,reverseDirection:x,useTranslate3d:g,wrapperStyle:v,cursor:b,shared:w,trigger:y,defaultIndex:N,portal:_,axisId:S}=n,j=Ot(),E=typeof N=="number"?String(N):N;p.useEffect(()=>{j(AM({shared:w,trigger:y,axisId:S,active:a,defaultIndex:E}))},[j,w,y,S,a,E]);var k=Md(),T=I5(),A=jM(w),{activeIndex:C,isActive:R}=(t=Fe(he=>BF(he,A,y,E)))!==null&&t!==void 0?t:{},G=Fe(he=>LF(he,A,y,E)),V=Fe(he=>$S(he,A,y,E)),X=Fe(he=>FF(he,A,y,E)),K=G,Y=cL(),q=(r=a??R)!==null&&r!==void 0?r:!1,[Z,le]=oP([K,q]),ce=A==="axis"?V:void 0;kL(A,y,X,ce,C,q);var pe=_??Y;if(pe==null||k==null||A==null)return null;var Ne=K??Wy;q||(Ne=Wy),d&&Ne.length&&(Ne=D3(Ne.filter(he=>he.value!=null&&(he.hide!==!0||n.includeHidden)),f,DL));var ee=Ne.length>0,oe=p.createElement(jD,{allowEscapeViewBox:i,animationDuration:o,animationEasing:l,isAnimationActive:u,active:q,coordinate:X,hasPayload:ee,offset:h,position:m,reverseDirection:x,useTranslate3d:g,viewBox:k,wrapperStyle:v,lastBoundingBox:Z,innerRef:le,hasPortalFromProps:!!_},IL(c,zy(zy({},n),{},{payload:Ne,label:ce,active:q,activeIndex:C,coordinate:X,accessibilityLayer:T})));return p.createElement(p.Fragment,null,$N.createPortal(oe,pe),q&&p.createElement(lL,{cursor:b,tooltipEventType:A,coordinate:X,payload:Ne,index:C}))}var Gl=e=>null;Gl.displayName="Cell";function ML(e,t,r){return(t=FL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FL(e){var t=LL(e,"string");return typeof t=="symbol"?t:t+""}function LL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class BL{constructor(t){ML(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function Vy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vy(Object(r),!0).forEach(function(n){UL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UL(e,t,r){return(t=HL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HL(e){var t=zL(e,"string");return typeof t=="symbol"?t:t+""}function zL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WL={cacheSize:2e3,enableCache:!0},VS=$L({},WL),Ky=new BL(VS.cacheSize),VL={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Gy="recharts_measurement_span";function KL(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(o,"|").concat(l)}var Xy=(e,t)=>{try{var r=document.getElementById(Gy);r||(r=document.createElement("span"),r.setAttribute("id",Gy),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,VL,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Vo=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||$d.isSsr)return{width:0,height:0};if(!VS.enableCache)return Xy(t,r);var n=KL(t,r),a=Ky.get(n);if(a)return a;var i=Xy(t,r);return Ky.set(n,i),i},KS;function GL(e,t,r){return(t=XL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XL(e){var t=YL(e,"string");return typeof t=="symbol"?t:t+""}function YL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qL=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZL=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,JL={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},QL=["cm","mm","pt","pc","in","Q","px"];function e7(e){return QL.includes(e)}var Bs="NaN";function t7(e,t){return e*JL[t]}class gr{static parse(t){var r,[,n,a]=(r=ZL.exec(t))!==null&&r!==void 0?r:[];return n==null?gr.NaN:new gr(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,da(t)&&(this.unit=""),r!==""&&!qL.test(r)&&(this.num=NaN,this.unit=""),e7(r)&&(this.num=t7(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new gr(NaN,""):new gr(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new gr(NaN,""):new gr(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new gr(NaN,""):new gr(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new gr(NaN,""):new gr(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return da(this.num)}}KS=gr;GL(gr,"NaN",new KS(NaN,""));function GS(e){if(e==null||e.includes(Bs))return Bs;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=Yy.exec(t))!==null&&r!==void 0?r:[],o=gr.parse(n??""),l=gr.parse(i??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Bs;t=t.replace(Yy,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,h,f]=(d=qy.exec(t))!==null&&d!==void 0?d:[],m=gr.parse(u??""),x=gr.parse(f??""),g=h==="+"?m.add(x):m.subtract(x);if(g.isNaN())return Bs;t=t.replace(qy,g.toString())}return t}var Zy=/\(([^()]*)\)/;function r7(e){for(var t=e,r;(r=Zy.exec(t))!=null;){var[,n]=r;t=t.replace(Zy,GS(n))}return t}function n7(e){var t=e.replace(/\s+/g,"");return t=r7(t),t=GS(t),t}function a7(e){try{return n7(e)}catch{return Bs}}function Kh(e){var t=a7(e.slice(5,-1));return t===Bs?"":t}var i7=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],s7=["dx","dy","angle","className","breakAll"];function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mm.apply(null,arguments)}function Jy(e,t){if(e==null)return{};var r,n,a=o7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function o7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var XS=/[ \f\n\r\t\v\u2028\u2029]+/,YS=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Mt(t)||(r?a=t.toString().split(""):a=t.toString().split(XS));var i=a.map(l=>({word:l,width:Vo(l,n).width})),o=r?0:Vo(" ",n).width;return{wordsWithComputedWidth:i,spaceWidth:o}}catch{return null}};function l7(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var qS=(e,t,r,n)=>e.reduce((a,i)=>{var{word:o,width:l}=i,c=a[a.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var d={words:[o],width:l};a.push(d)}return a},[]),ZS=e=>e.reduce((t,r)=>t.width>r.width?t:r),c7="…",Qy=(e,t,r,n,a,i,o,l)=>{var c=e.slice(0,t),d=YS({breakAll:r,style:n,children:c+c7});if(!d)return[!1,[]];var u=qS(d.wordsWithComputedWidth,i,o,l),h=u.length>a||ZS(u).width>Number(i);return[h,u]},u7=(e,t,r,n,a)=>{var{maxLines:i,children:o,style:l,breakAll:c}=e,d=Ie(i),u=String(o),h=qS(t,n,r,a);if(!d||a)return h;var f=h.length>i||ZS(h).width>Number(n);if(!f)return h;for(var m=0,x=u.length-1,g=0,v;m<=x&&g<=u.length-1;){var b=Math.floor((m+x)/2),w=b-1,[y,N]=Qy(u,w,c,l,i,n,r,a),[_]=Qy(u,b,c,l,i,n,r,a);if(!y&&!_&&(m=b+1),y&&_&&(x=b-1),!y&&_){v=N;break}g++}return v||h},ew=e=>{var t=Mt(e)?[]:e.toString().split(XS);return[{words:t,width:void 0}]},d7=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:o}=e;if((t||r)&&!$d.isSsr){var l,c,d=YS({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:h}=d;l=u,c=h}else return ew(n);return u7({breakAll:i,children:n,maxLines:o,style:a},l,c,t,!!r)}return ew(n)},JS="#808080",h7={angle:0,breakAll:!1,capHeight:"0.71em",fill:JS,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},s0=p.forwardRef((e,t)=>{var r=hr(e,h7),{x:n,y:a,lineHeight:i,capHeight:o,fill:l,scaleToFit:c,textAnchor:d,verticalAnchor:u}=r,h=Jy(r,i7),f=p.useMemo(()=>d7({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:m,dy:x,angle:g,className:v,breakAll:b}=h,w=Jy(h,s7);if(!ha(n)||!ha(a)||f.length===0)return null;var y=Number(n)+(Ie(m)?m:0),N=Number(a)+(Ie(x)?x:0);if(!et(y)||!et(N))return null;var _;switch(u){case"start":_=Kh("calc(".concat(o,")"));break;case"middle":_=Kh("calc(".concat((f.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:_=Kh("calc(".concat(f.length-1," * -").concat(i,")"));break}var S=[],j=f[0];if(c&&j!=null){var E=j.width,{width:k}=h;S.push("scale(".concat(Ie(k)&&Ie(E)?k/E:1,")"))}return g&&S.push("rotate(".concat(g,", ").concat(y,", ").concat(N,")")),S.length&&(w.transform=S.join(" ")),p.createElement("text",Mm({},Yr(w),{ref:t,x:y,y:N,className:lt("recharts-text",v),textAnchor:d,fill:l.includes("url")?JS:l}),f.map((T,A)=>{var C=T.words.join(b?"":" ");return p.createElement("tspan",{x:y,dy:A===0?_:i,key:"".concat(C,"-").concat(A)},C)}))});s0.displayName="Text";function tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tw(Object(r),!0).forEach(function(n){f7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function f7(e,t,r){return(t=m7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m7(e){var t=p7(e,"string");return typeof t=="symbol"?t:t+""}function p7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x7=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:a}=e,{x:i,y:o,height:l,upperWidth:c,lowerWidth:d}=zp(t),u=i,h=i+(c-d)/2,f=(u+h)/2,m=(c+d)/2,x=u+c/2,g=l>=0?1:-1,v=g*n,b=g>0?"end":"start",w=g>0?"start":"end",y=c>=0?1:-1,N=y*n,_=y>0?"end":"start",S=y>0?"start":"end",j=a;if(r==="top"){var E={x:u+c/2,y:o-v,horizontalAnchor:"middle",verticalAnchor:b};return j&&(E.height=Math.max(o-j.y,0),E.width=c),E}if(r==="bottom"){var k={x:h+d/2,y:o+l+v,horizontalAnchor:"middle",verticalAnchor:w};return j&&(k.height=Math.max(j.y+j.height-(o+l),0),k.width=d),k}if(r==="left"){var T={x:f-N,y:o+l/2,horizontalAnchor:_,verticalAnchor:"middle"};return j&&(T.width=Math.max(T.x-j.x,0),T.height=l),T}if(r==="right"){var A={x:f+m+N,y:o+l/2,horizontalAnchor:S,verticalAnchor:"middle"};return j&&(A.width=Math.max(j.x+j.width-A.x,0),A.height=l),A}var C=j?{width:m,height:l}:{};return r==="insideLeft"?Jn({x:f+N,y:o+l/2,horizontalAnchor:S,verticalAnchor:"middle"},C):r==="insideRight"?Jn({x:f+m-N,y:o+l/2,horizontalAnchor:_,verticalAnchor:"middle"},C):r==="insideTop"?Jn({x:u+c/2,y:o+v,horizontalAnchor:"middle",verticalAnchor:w},C):r==="insideBottom"?Jn({x:h+d/2,y:o+l-v,horizontalAnchor:"middle",verticalAnchor:b},C):r==="insideTopLeft"?Jn({x:u+N,y:o+v,horizontalAnchor:S,verticalAnchor:w},C):r==="insideTopRight"?Jn({x:u+c-N,y:o+v,horizontalAnchor:_,verticalAnchor:w},C):r==="insideBottomLeft"?Jn({x:h+N,y:o+l-v,horizontalAnchor:S,verticalAnchor:b},C):r==="insideBottomRight"?Jn({x:h+d-N,y:o+l-v,horizontalAnchor:_,verticalAnchor:b},C):r&&typeof r=="object"&&(Ie(r.x)||Yi(r.x))&&(Ie(r.y)||Yi(r.y))?Jn({x:i+Or(r.x,m),y:o+Or(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},C):Jn({x,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},C)},g7=["labelRef"],v7=["content"];function rw(e,t){if(e==null)return{};var r,n,a=b7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function nw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ho(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nw(Object(r),!0).forEach(function(n){y7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y7(e,t,r){return(t=w7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w7(e){var t=N7(e,"string");return typeof t=="symbol"?t:t+""}function N7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _a(){return _a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_a.apply(null,arguments)}var QS=p.createContext(null),_7=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:o,children:l}=e,c=p.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:o}),[t,r,n,a,i,o]);return p.createElement(QS.Provider,{value:c},l)},eE=()=>{var e=p.useContext(QS),t=Md();return e||(t?zp(t):void 0)},j7=p.createContext(null),S7=()=>{var e=p.useContext(j7),t=Fe(zj);return e||t},E7=e=>{var{value:t,formatter:r}=e,n=Mt(e.children)?t:e.children;return typeof r=="function"?r(n):n},ig=e=>e!=null&&typeof e=="function",C7=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},T7=(e,t,r,n,a)=>{var{offset:i,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:h,endAngle:f,clockWise:m}=a,x=(d+u)/2,g=C7(h,f),v=g>=0?1:-1,b,w;switch(t){case"insideStart":b=h+v*i,w=m;break;case"insideEnd":b=f-v*i,w=!m;break;case"end":b=f+v*i,w=m;break;default:throw new Error("Unsupported position ".concat(t))}w=g<=0?w:!w;var y=Kt(l,c,x,b),N=Kt(l,c,x,b+(w?1:-1)*359),_="M".concat(y.x,",").concat(y.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(w?0:1,`,
    `).concat(N.x,",").concat(N.y),S=Mt(e.id)?Qo("recharts-radial-line-"):e.id;return p.createElement("text",_a({},n,{dominantBaseline:"central",className:lt("recharts-radial-bar-label",o)}),p.createElement("defs",null,p.createElement("path",{id:S,d:_})),p.createElement("textPath",{xlinkHref:"#".concat(S)},r))},k7=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(r==="outside"){var{x:u,y:h}=Kt(n,a,o+t,d);return{x:u,y:h,textAnchor:u>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var f=(i+o)/2,{x:m,y:x}=Kt(n,a,f,d);return{x:m,y:x,textAnchor:"middle",verticalAnchor:"middle"}},Hc=e=>e!=null&&"cx"in e&&Ie(e.cx),A7={angle:0,offset:5,zIndex:Gt.label,position:"middle",textBreakAll:!1};function P7(e){if(!Hc(e))return e;var{cx:t,cy:r,outerRadius:n}=e,a=n*2;return{x:t-n,y:r-n,width:a,upperWidth:a,lowerWidth:a,height:a}}function si(e){var t=hr(e,A7),{viewBox:r,parentViewBox:n,position:a,value:i,children:o,content:l,className:c="",textBreakAll:d,labelRef:u}=t,h=S7(),f=eE(),m=a==="center"?f:h??f,x,g,v;r==null?x=m:Hc(r)?x=r:x=zp(r);var b=P7(x);if(!x||Mt(i)&&Mt(o)&&!p.isValidElement(l)&&typeof l!="function")return null;var w=Ho(Ho({},t),{},{viewBox:x});if(p.isValidElement(l)){var{labelRef:y}=w,N=rw(w,g7);return p.cloneElement(l,N)}if(typeof l=="function"){var{content:_}=w,S=rw(w,v7);if(g=p.createElement(l,S),p.isValidElement(g))return g}else g=E7(t);var j=Yr(t);if(Hc(x)){if(a==="insideStart"||a==="insideEnd"||a==="end")return T7(t,a,g,j,x);v=k7(x,t.offset,t.position)}else{if(!b)return null;var E=x7({viewBox:b,position:a,offset:t.offset,parentViewBox:Hc(n)?void 0:n});v=Ho(Ho({x:E.x,y:E.y,textAnchor:E.horizontalAnchor,verticalAnchor:E.verticalAnchor},E.width!==void 0?{width:E.width}:{}),E.height!==void 0?{height:E.height}:{})}return p.createElement(on,{zIndex:t.zIndex},p.createElement(s0,_a({ref:u,className:lt("recharts-label",c)},j,v,{textAnchor:l7(j.textAnchor)?j.textAnchor:v.textAnchor,breakAll:d}),g))}si.displayName="Label";var O7=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?p.createElement(si,_a({key:"label-implicit"},n)):ha(e)?p.createElement(si,_a({key:"label-implicit",value:e},n)):p.isValidElement(e)?e.type===si?p.cloneElement(e,Ho({key:"label-implicit"},n)):p.createElement(si,_a({key:"label-implicit",content:e},n)):ig(e)?p.createElement(si,_a({key:"label-implicit",content:e},n)):e&&typeof e=="object"?p.createElement(si,_a({},e,{key:"label-implicit"},n)):null};function D7(e){var{label:t,labelRef:r}=e,n=eE();return O7(t,n,r)||null}var Gh={},Xh={},aw;function I7(){return aw||(aw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Xh)),Xh}var Yh={},iw;function R7(){return iw||(iw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Yh)),Yh}var sw;function M7(){return sw||(sw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I7(),r=R7(),n=Pp();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Gh)),Gh}var qh,ow;function F7(){return ow||(ow=1,qh=M7().last),qh}var L7=F7();const B7=wi(L7);var $7=["valueAccessor"],U7=["dataKey","clockWise","id","textBreakAll","zIndex"];function Iu(){return Iu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iu.apply(null,arguments)}function lw(e,t){if(e==null)return{};var r,n,a=H7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function H7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var z7=e=>Array.isArray(e.value)?B7(e.value):e.value,tE=p.createContext(void 0),rE=tE.Provider,nE=p.createContext(void 0),W7=nE.Provider;function V7(){return p.useContext(tE)}function K7(){return p.useContext(nE)}function zc(e){var{valueAccessor:t=z7}=e,r=lw(e,$7),{dataKey:n,clockWise:a,id:i,textBreakAll:o,zIndex:l}=r,c=lw(r,U7),d=V7(),u=K7(),h=d||u;return!h||!h.length?null:p.createElement(on,{zIndex:l??Gt.label},p.createElement(ur,{className:"recharts-label-list"},h.map((f,m)=>{var x,g=Mt(n)?t(f,m):xt(f.payload,n),v=Mt(i)?{}:{id:"".concat(i,"-").concat(m)};return p.createElement(si,Iu({key:"label-".concat(m)},Yr(f),c,v,{fill:(x=r.fill)!==null&&x!==void 0?x:f.fill,parentViewBox:f.parentViewBox,value:g,textBreakAll:o,viewBox:f.viewBox,index:m,zIndex:0}))})))}zc.displayName="LabelList";function sg(e){var{label:t}=e;return t?t===!0?p.createElement(zc,{key:"labelList-implicit"}):p.isValidElement(t)||ig(t)?p.createElement(zc,{key:"labelList-implicit",content:t}):typeof t=="object"?p.createElement(zc,Iu({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Fm(){return Fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fm.apply(null,arguments)}var aE=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=lt("recharts-dot",a);return Ie(t)&&Ie(r)&&Ie(n)?p.createElement("circle",Fm({},bn(e),Ap(e),{className:i,cx:t,cy:r,r:n})):null},iE=e=>e.graphicalItems.polarItems,G7=Q([Ft,Ul],Cx),o0=Q([iE,Ut,G7],Tx),X7=Q([o0],kx),l0=Q([X7,Gd],Ax),Y7=Q([l0,Ut,o0],Ox);Q([l0,Ut,o0],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,o=xt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:xt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var cw=()=>{},q7=Q([l0,Ut,o0,r0,Ft],Mx),Z7=Q([Ut,Ix,Rx,cw,q7,cw,at,Ft],Fx),sE=Q([Ut,at,l0,Y7,$l,Ft,Z7],Lx),J7=Q([sE,fo,ji],Ux),Q7=Q([Ut,sE,J7,Ft],zx);Q([ji,Q7],Vj);var e9={radiusAxis:{},angleAxis:{}},oE=sn({name:"polarAxis",initialState:e9,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:jne,removeRadiusAxis:Sne,addAngleAxis:Ene,removeAngleAxis:Cne}=oE.actions,t9=oE.reducer;function lE(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function uw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uw(Object(r),!0).forEach(function(n){r9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r9(e,t,r){return(t=n9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n9(e){var t=a9(e,"string");return typeof t=="symbol"?t:t+""}function a9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i9=(e,t)=>t,og=Q([iE,i9],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),s9=[],lg=(e,t,r)=>r?.length===0?s9:r,cE=Q([Gd,og,lg],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>dw(dw({},t.presentationProps),i.props))),a!=null)return a}}),o9=Q([cE,og,lg],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,o=xt(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:oo(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),l9=Q([cE,og,lg,tr],(e,t,r,n)=>{if(!(t==null||e==null))return cB({offset:n,pieSettings:t,displayedData:e,cells:r})}),Zh={exports:{}},mt={};var hw;function c9(){if(hw)return mt;hw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function x(g){if(typeof g=="object"&&g!==null){var v=g.$$typeof;switch(v){case e:switch(g=g.type,g){case r:case a:case n:case c:case d:case f:return g;default:switch(g=g&&g.$$typeof,g){case o:case l:case h:case u:return g;case i:return g;default:return v}}case t:return v}}}return mt.ContextConsumer=i,mt.ContextProvider=o,mt.Element=e,mt.ForwardRef=l,mt.Fragment=r,mt.Lazy=h,mt.Memo=u,mt.Portal=t,mt.Profiler=a,mt.StrictMode=n,mt.Suspense=c,mt.SuspenseList=d,mt.isContextConsumer=function(g){return x(g)===i},mt.isContextProvider=function(g){return x(g)===o},mt.isElement=function(g){return typeof g=="object"&&g!==null&&g.$$typeof===e},mt.isForwardRef=function(g){return x(g)===l},mt.isFragment=function(g){return x(g)===r},mt.isLazy=function(g){return x(g)===h},mt.isMemo=function(g){return x(g)===u},mt.isPortal=function(g){return x(g)===t},mt.isProfiler=function(g){return x(g)===a},mt.isStrictMode=function(g){return x(g)===n},mt.isSuspense=function(g){return x(g)===c},mt.isSuspenseList=function(g){return x(g)===d},mt.isValidElementType=function(g){return typeof g=="string"||typeof g=="function"||g===r||g===a||g===n||g===c||g===d||typeof g=="object"&&g!==null&&(g.$$typeof===h||g.$$typeof===u||g.$$typeof===o||g.$$typeof===i||g.$$typeof===l||g.$$typeof===m||g.getModuleId!==void 0)},mt.typeOf=x,mt}var fw;function u9(){return fw||(fw=1,Zh.exports=c9()),Zh.exports}var d9=u9(),mw=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",pw=null,Jh=null,uE=e=>{if(e===pw&&Array.isArray(Jh))return Jh;var t=[];return p.Children.forEach(e,r=>{Mt(r)||(d9.isFragment(r)?t=t.concat(uE(r.props.children)):t.push(r))}),Jh=t,pw=e,t};function cg(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>mw(a)):n=[mw(t)],uE(e).forEach(a=>{var i=Xi(a,"type.displayName")||Xi(a,"type.name");i&&n.indexOf(i)!==-1&&r.push(a)}),r}var dE=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Qh={},xw;function h9(){return xw||(xw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Qh)),Qh}var ef,gw;function f9(){return gw||(gw=1,ef=h9().isPlainObject),ef}var m9=f9();const p9=wi(m9);var vw,bw,yw,ww,Nw;function _w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_w(Object(r),!0).forEach(function(n){x9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_w(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x9(e,t,r){return(t=g9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g9(e){var t=v9(e,"string");return typeof t=="symbol"?t:t+""}function v9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ru(){return Ru=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ru.apply(null,arguments)}function Mo(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Sw=(e,t,r,n,a)=>{var i=r-n,o;return o=Bt(vw||(vw=Mo(["M ",",",""])),e,t),o+=Bt(bw||(bw=Mo(["L ",",",""])),e+r,t),o+=Bt(yw||(yw=Mo(["L ",",",""])),e+r-i/2,t+a),o+=Bt(ww||(ww=Mo(["L ",",",""])),e+r-i/2-n,t+a),o+=Bt(Nw||(Nw=Mo(["L ",","," Z"])),e,t),o},b9={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},y9=e=>{var t=hr(e,b9),{x:r,y:n,upperWidth:a,lowerWidth:i,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:h}=t,f=p.useRef(null),[m,x]=p.useState(-1),g=p.useRef(a),v=p.useRef(i),b=p.useRef(o),w=p.useRef(r),y=p.useRef(n),N=Rl(e,"trapezoid-");if(p.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var G=f.current.getTotalLength();G&&x(G)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||o!==+o||a===0&&i===0||o===0)return null;var _=lt("recharts-trapezoid",l);if(!h)return p.createElement("g",null,p.createElement("path",Ru({},Yr(t),{className:_,d:Sw(r,n,a,i,o)})));var S=g.current,j=v.current,E=b.current,k=w.current,T=y.current,A="0px ".concat(m===-1?1:m,"px"),C="".concat(m,"px 0px"),R=R5(["strokeDasharray"],d,c);return p.createElement(Il,{animationId:N,key:N,canBegin:m>0,duration:d,easing:c,isActive:h,begin:u},G=>{var V=Ct(S,a,G),X=Ct(j,i,G),K=Ct(E,o,G),Y=Ct(k,r,G),q=Ct(T,n,G);f.current&&(g.current=V,v.current=X,b.current=K,w.current=Y,y.current=q);var Z=G>0?{transition:R,strokeDasharray:C}:{strokeDasharray:A};return p.createElement("path",Ru({},Yr(t),{className:_,d:Sw(Y,q,V,X,K),ref:f,style:jw(jw({},Z),t.style)}))})},w9=["option","shapeType","activeClassName"];function N9(e,t){if(e==null)return{};var r,n,a=_9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ew(Object(r),!0).forEach(function(n){j9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ew(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j9(e,t,r){return(t=S9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S9(e){var t=E9(e,"string");return typeof t=="symbol"?t:t+""}function E9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C9(e,t){return Mu(Mu({},t),e)}function T9(e,t){return e==="symbols"}function Cw(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return p.createElement(B5,r);case"trapezoid":return p.createElement(y9,r);case"sector":return p.createElement(z5,r);case"symbols":if(T9(t))return p.createElement(w_,r);break;case"curve":return p.createElement(Kp,r);default:return null}}function k9(e){return p.isValidElement(e)?e.props:e}function ug(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=N9(e,w9),i;if(p.isValidElement(t))i=p.cloneElement(t,Mu(Mu({},a),k9(t)));else if(typeof t=="function")i=t(a,a.index);else if(p9(t)&&typeof t!="boolean"){var o=C9(t,a);i=p.createElement(Cw,{shapeType:r,elementProps:o})}else{var l=a;i=p.createElement(Cw,{shapeType:r,elementProps:l})}return a.isActive?p.createElement(ur,{className:n},i):i}var dg=(e,t,r)=>{var n=Ot();return(a,i)=>o=>{e?.(a,i,o),n(wS({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},hg=e=>{var t=Ot();return(r,n)=>a=>{e?.(r,n,a),t(PM())}},fg=(e,t,r)=>{var n=Ot();return(a,i)=>o=>{e?.(a,i,o),n(OM({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function mg(e){var{tooltipEntrySettings:t}=e,r=Ot(),n=Mr(),a=p.useRef(null);return p.useLayoutEffect(()=>{n||(a.current===null?r(CM(t)):a.current!==t&&r(TM({prev:a.current,next:t})),a.current=t)},[t,r,n]),p.useLayoutEffect(()=>()=>{a.current&&(r(kM(a.current)),a.current=null)},[r]),null}function hE(e){var{legendPayload:t}=e,r=Ot(),n=Mr(),a=p.useRef(null);return p.useLayoutEffect(()=>{n||(a.current===null?r(P5(t)):a.current!==t&&r(O5({prev:a.current,next:t})),a.current=t)},[r,n,t]),p.useLayoutEffect(()=>()=>{a.current&&(r(D5(a.current)),a.current=null)},[r]),null}function A9(e){var{legendPayload:t}=e,r=Ot(),n=Fe(at),a=p.useRef(null);return p.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(P5(t)):a.current!==t&&r(O5({prev:a.current,next:t})),a.current=t)},[r,n,t]),p.useLayoutEffect(()=>()=>{a.current&&(r(D5(a.current)),a.current=null)},[r]),null}var tf,P9=()=>{var[e]=p.useState(()=>Qo("uid-"));return e},O9=(tf=oT.useId)!==null&&tf!==void 0?tf:P9;function D9(e,t){var r=O9();return t||(e?"".concat(e,"-").concat(r):r)}var I9=p.createContext(void 0),pg=e=>{var{id:t,type:r,children:n}=e,a=D9("recharts-".concat(r),t);return p.createElement(I9.Provider,{value:a},n(a))},R9={cartesianItems:[],polarItems:[]},fE=sn({name:"graphicalItems",initialState:R9,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Et()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Vn(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Et()},removeCartesianGraphicalItem:{reducer(e,t){var r=Vn(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Et()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Et()},removePolarGraphicalItem:{reducer(e,t){var r=Vn(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Et()}}}),{addCartesianGraphicalItem:M9,replaceCartesianGraphicalItem:F9,removeCartesianGraphicalItem:L9,addPolarGraphicalItem:B9,removePolarGraphicalItem:$9}=fE.actions,U9=fE.reducer,H9=e=>{var t=Ot(),r=p.useRef(null);return p.useLayoutEffect(()=>{r.current===null?t(M9(e)):r.current!==e&&t(F9({prev:r.current,next:e})),r.current=e},[t,e]),p.useLayoutEffect(()=>()=>{r.current&&(t(L9(r.current)),r.current=null)},[t]),null},mE=p.memo(H9);function z9(e){var t=Ot();return p.useLayoutEffect(()=>(t(B9(e)),()=>{t($9(e))}),[t,e]),null}var W9=["key"],V9=["onMouseEnter","onClick","onMouseLeave"],K9=["id"],G9=["id"];function Tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tw(Object(r),!0).forEach(function(n){X9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X9(e,t,r){return(t=Y9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y9(e){var t=q9(e,"string");return typeof t=="symbol"?t:t+""}function q9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xi(){return xi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xi.apply(null,arguments)}function c0(e,t){if(e==null)return{};var r,n,a=Z9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Z9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function J9(e){var t=p.useMemo(()=>cg(e.children,Gl),[e.children]),r=Fe(n=>o9(n,e.id,t));return r==null?null:p.createElement(A9,{legendPayload:r})}var Q9=p.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:o,name:l,hide:c,tooltipType:d,id:u}=e,h={dataDefinedOnItem:n.map(f=>f.tooltipPayload),getPosition:f=>{var m;return(m=n[Number(f)])===null||m===void 0?void 0:m.tooltipPosition},settings:{stroke:a,strokeWidth:i,fill:o,dataKey:t,nameKey:r,name:oo(l,t),hide:c,type:d,color:o,unit:"",graphicalItemId:u}};return p.createElement(mg,{tooltipEntrySettings:h})}),eB=(e,t)=>e>t?"start":e<t?"end":"middle",tB=(e,t,r)=>Or(typeof t=="function"?t(e):t,r,r*.8),rB=(e,t,r)=>{var{top:n,left:a,width:i,height:o}=t,l=$5(i,o),c=a+Or(e.cx,i,i/2),d=n+Or(e.cy,o,o/2),u=Or(e.innerRadius,l,0),h=tB(r,e.outerRadius,l),f=e.maxRadius||Math.sqrt(i*i+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:h,maxRadius:f}},nB=(e,t)=>{var r=lr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},aB=(e,t)=>{if(p.isValidElement(e))return p.cloneElement(e,t);if(typeof e=="function")return e(t);var r=lt("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=c0(t,W9);return p.createElement(Kp,xi({},a,{type:"linear",className:r}))},iB=(e,t,r)=>{if(p.isValidElement(e))return p.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),p.isValidElement(n)))return n;var a=lt("recharts-pie-label-text",lE(e));return p.createElement(s0,xi({},t,{alignmentBaseline:"middle",className:a}),n)};function sB(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:o}=r;if(!n||!a||!t)return null;var l=bn(r),c=Ki(a),d=Ki(i),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,h=t.map((f,m)=>{var x=(f.startAngle+f.endAngle)/2,g=Kt(f.cx,f.cy,f.outerRadius+u,x),v=$t($t($t($t({},l),f),{},{stroke:"none"},c),{},{index:m,textAnchor:eB(g.x,f.cx)},g),b=$t($t($t($t({},l),f),{},{fill:"none",stroke:f.fill},d),{},{index:m,points:[Kt(f.cx,f.cy,f.outerRadius,x),g],key:"line"});return p.createElement(on,{zIndex:Gt.label,key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(m)},p.createElement(ur,null,i&&aB(i,b),iB(a,v,xt(f,o))))});return p.createElement(ur,{className:"recharts-pie-labels"},h)}function oB(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?p.createElement(sg,{label:a}):p.createElement(sB,{sectors:t,props:r,showLabels:n})}function lB(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:i,id:o}=e,l=Fe(pi),c=Fe(Jx),d=Fe(gF),{onMouseEnter:u,onClick:h,onMouseLeave:f}=a,m=c0(a,V9),x=dg(u,a.dataKey,o),g=hg(f),v=fg(h,a.dataKey,o);return t==null||t.length===0?null:p.createElement(p.Fragment,null,t.map((b,w)=>{if(b?.startAngle===0&&b?.endAngle===0&&t.length!==1)return null;var y=d==null||d===o,N=String(w)===l&&(c==null||a.dataKey===c)&&y,_=l?n:null,S=r&&N?r:_,j=$t($t({},b),{},{stroke:b.stroke,tabIndex:-1,[m5]:w,[p5]:o});return p.createElement(ur,xi({key:"sector-".concat(b?.startAngle,"-").concat(b?.endAngle,"-").concat(b.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},wd(m,b,w),{onMouseEnter:x(b,w),onMouseLeave:g(b,w),onClick:v(b,w)}),p.createElement(ug,xi({option:i??S,index:w,shapeType:"sector",isActive:N},j)))}))}function cB(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:h}=r,f=Math.abs(r.minAngle),m=nB(l,c),x=Math.abs(m),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,v=n.filter(S=>xt(S,d,0)!==0).length,b=(x>=360?v:v-1)*g,w=x-v*f-b,y=n.reduce((S,j)=>{var E=xt(j,d,0);return S+(Ie(E)?E:0)},0),N;if(y>0){var _;N=n.map((S,j)=>{var E=xt(S,d,0),k=xt(S,u,j),T=rB(r,i,S),A=(Ie(E)?E:0)/y,C,R=$t($t({},S),a&&a[j]&&a[j].props);j?C=_.endAngle+lr(m)*g*(E!==0?1:0):C=l;var G=C+lr(m)*((E!==0?f:0)+A*w),V=(C+G)/2,X=(T.innerRadius+T.outerRadius)/2,K=[{name:k,value:E,payload:R,dataKey:d,type:h,graphicalItemId:r.id}],Y=Kt(T.cx,T.cy,X,V);return _=$t($t($t($t({},r.presentationProps),{},{percent:A,cornerRadius:typeof o=="string"?parseFloat(o):o,name:k,tooltipPayload:K,midAngle:V,middleRadius:X,tooltipPosition:Y},R),T),{},{value:E,dataKey:d,startAngle:C,endAngle:G,payload:R,paddingAngle:lr(m)*g}),_})}return N}function uB(e){var{showLabels:t,sectors:r,children:n}=e,a=p.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return p.createElement(W7,{value:t?a:void 0},n)}function dB(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:h,onAnimationEnd:f}=t,m=Rl(t,"recharts-pie-"),x=r.current,[g,v]=p.useState(!1),b=p.useCallback(()=>{typeof f=="function"&&f(),v(!1)},[f]),w=p.useCallback(()=>{typeof h=="function"&&h(),v(!0)},[h]);return p.createElement(uB,{showLabels:!g,sectors:a},p.createElement(Il,{animationId:m,begin:o,duration:l,isActive:i,easing:c,onAnimationStart:w,onAnimationEnd:b,key:m},y=>{var N,_=[],S=a&&a[0],j=(N=S?.startAngle)!==null&&N!==void 0?N:0;return a?.forEach((E,k)=>{var T=x&&x[k],A=k>0?Xi(E,"paddingAngle",0):0;if(T){var C=Ct(T.endAngle-T.startAngle,E.endAngle-E.startAngle,y),R=$t($t({},E),{},{startAngle:j+A,endAngle:j+C+A});_.push(R),j=R.endAngle}else{var{endAngle:G,startAngle:V}=E,X=Ct(0,G-V,y),K=$t($t({},E),{},{startAngle:j+A,endAngle:j+X+A});_.push(K),j=K.endAngle}}),r.current=_,p.createElement(ur,null,p.createElement(lB,{sectors:_,activeShape:d,inactiveShape:u,allOtherPieProps:t,shape:t.shape,id:n}))}),p.createElement(oB,{showLabels:!g,sectors:a,props:t}),t.children)}var hB={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Gt.area};function fB(e){var{id:t}=e,r=c0(e,K9),{hide:n,className:a,rootTabIndex:i}=e,o=p.useMemo(()=>cg(e.children,Gl),[e.children]),l=Fe(u=>l9(u,t,o)),c=p.useRef(null),d=lt("recharts-pie",a);return n||l==null?(c.current=null,p.createElement(ur,{tabIndex:i,className:d})):p.createElement(on,{zIndex:e.zIndex},p.createElement(Q9,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),p.createElement(ur,{tabIndex:i,className:d},p.createElement(dB,{props:$t($t({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function pE(e){var t=hr(e,hB),{id:r}=t,n=c0(t,G9),a=bn(n);return p.createElement(pg,{id:r,type:"pie"},i=>p.createElement(p.Fragment,null,p.createElement(z9,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),p.createElement(J9,xi({},n,{id:i})),p.createElement(fB,xi({},n,{id:i}))))}pE.displayName="Pie";var mB=["points"];function kw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kw(Object(r),!0).forEach(function(n){pB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pB(e,t,r){return(t=xB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xB(e){var t=gB(e,"string");return typeof t=="symbol"?t:t+""}function gB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fu(){return Fu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fu.apply(null,arguments)}function vB(e,t){if(e==null)return{};var r,n,a=bB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yB(e){var{option:t,dotProps:r,className:n}=e;if(p.isValidElement(t))return p.cloneElement(t,r);if(typeof t=="function")return t(r);var a=lt(n,typeof t!="boolean"?t.className:""),i=r??{},{points:o}=i,l=vB(i,mB);return p.createElement(aE,Fu({},l,{className:a}))}function wB(e,t){return e==null?!1:t?!0:e.length===1}function NB(e){var{points:t,dot:r,className:n,dotClassName:a,dataKey:i,baseProps:o,needClip:l,clipPathId:c,zIndex:d=Gt.scatter}=e;if(!wB(t,r))return null;var u=dE(r),h=iA(r),f=t.map((x,g)=>{var v,b,w=rf(rf(rf({r:3},o),h),{},{index:g,cx:(v=x.x)!==null&&v!==void 0?v:void 0,cy:(b=x.y)!==null&&b!==void 0?b:void 0,dataKey:i,value:x.value,payload:x.payload,points:t});return p.createElement(yB,{key:"dot-".concat(g),option:r,dotProps:w,className:a})}),m={};return l&&c!=null&&(m.clipPath="url(#clipPath-".concat(u?"":"dots-").concat(c,")")),p.createElement(on,{zIndex:d},p.createElement(ur,Fu({className:n},m),f))}function Aw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aw(Object(r),!0).forEach(function(n){_B(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _B(e,t,r){return(t=jB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jB(e){var t=SB(e,"string");return typeof t=="symbol"?t:t+""}function SB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xE=0,EB={xAxis:{},yAxis:{},zAxis:{}},gE=sn({name:"cartesianAxis",initialState:EB,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Et()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:Et()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Et()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Et()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:Et()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Et()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Et()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:Et()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Et()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i,o=a.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==a.width&&Math.abs(n-((i=o[0])!==null&&i!==void 0?i:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=Pw(Pw({},a),{},{width:n,widthHistory:l})}}}}),{addXAxis:CB,replaceXAxis:TB,removeXAxis:kB,addYAxis:AB,replaceYAxis:PB,removeYAxis:OB,addZAxis:Tne,replaceZAxis:kne,removeZAxis:Ane,updateYAxisWidth:DB}=gE.actions,IB=gE.reducer,RB=Q([tr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),MB=Q([RB,Xa,Ya],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),xg=()=>Fe(MB),FB=()=>Fe(NF);function Ow(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ow(Object(r),!0).forEach(function(n){LB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ow(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LB(e,t,r){return(t=BB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BB(e){var t=$B(e,"string");return typeof t=="symbol"?t:t+""}function $B(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UB=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i,clipPath:o}=e;if(a===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=nf(nf(nf({},l),Ki(a)),Ap(a)),d;return p.isValidElement(a)?d=p.cloneElement(a,c):typeof a=="function"?d=a(c):d=p.createElement(aE,c),p.createElement(ur,{className:"recharts-active-dot",clipPath:o},d)};function HB(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a,clipPath:i,zIndex:o=Gt.activeDot}=e,l=Fe(pi),c=FB();if(t==null||c==null)return null;var d=t.find(u=>c.includes(u.payload));return Mt(d)?null:p.createElement(on,{zIndex:o},p.createElement(UB,{point:d,childIndex:Number(l),mainColor:r,dataKey:a,activeDot:n,clipPath:i}))}var Dw=(e,t,r)=>{var n=r??e;if(!Mt(n))return Or(n,t,0)},zB=(e,t,r)=>{var n={},a=e.filter(Zd),i=e.filter(d=>d.stackId==null),o=a.reduce((d,u)=>{var h=d[u.stackId];return h==null&&(h=[]),h.push(u),d[u.stackId]=h,d},n),l=Object.entries(o).map(d=>{var u,[h,f]=d,m=f.map(g=>g.dataKey),x=Dw(t,r,(u=f[0])===null||u===void 0?void 0:u.barSize);return{stackId:h,dataKeys:m,barSize:x}}),c=i.map(d=>{var u=[d.dataKey].filter(f=>f!=null),h=Dw(t,r,d.barSize);return{stackId:void 0,dataKeys:u,barSize:h}});return[...l,...c]};function Iw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iw(Object(r),!0).forEach(function(n){WB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WB(e,t,r){return(t=VB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VB(e){var t=KB(e,"string");return typeof t=="symbol"?t:t+""}function KB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GB(e,t,r,n,a){var i,o=n.length;if(!(o<1)){var l=Or(e,r,0,!0),c,d=[];if(et((i=n[0])===null||i===void 0?void 0:i.barSize)){var u=!1,h=r/o,f=n.reduce((w,y)=>w+(y.barSize||0),0);f+=(o-1)*l,f>=r&&(f-=(o-1)*l,l=0),f>=r&&h>0&&(u=!0,h*=.9,f=o*h);var m=(r-f)/2>>0,x={offset:m-l,size:0};c=n.reduce((w,y)=>{var N,_={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:x.offset+x.size+l,size:u?h:(N=y.barSize)!==null&&N!==void 0?N:0}},S=[...w,_];return x=_.position,S},d)}else{var g=Or(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var v=(r-2*g-(o-1)*l)/o;v>1&&(v>>=0);var b=et(a)?Math.min(v,a):v;c=n.reduce((w,y,N)=>[...w,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:g+(v+l)*N+(v-b)/2,size:b}}],d)}return c}}var XB=(e,t,r,n,a,i,o)=>{var l=Mt(o)?t:o,c=GB(r,n,a!==i?a:i,e,l);return a!==i&&c!=null&&(c=c.map(d=>gc(gc({},d),{},{position:gc(gc({},d.position),{},{offset:d.position.offset-a/2})}))),c},YB=(e,t)=>{var r=Sx(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(o=>o.key===r)}}}},qB=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function ZB(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&et(e.zIndex)?e.zIndex:t}var vE=e=>{var{chartData:t}=e,r=Ot(),n=Mr();return p.useEffect(()=>n?()=>{}:(r($y(t)),()=>{r($y(void 0))}),[t,r,n]),null},Rw={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},bE=sn({name:"brush",initialState:Rw,reducers:{setBrushSettings(e,t){return t.payload==null?Rw:t.payload}}}),{setBrushSettings:Pne}=bE.actions,JB=bE.reducer;function QB(e){return(e%180+180)%180}var e$=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=QB(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},t$={dots:[],areas:[],lines:[]},yE=sn({name:"referenceElements",initialState:t$,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Vn(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Vn(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Vn(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:One,removeDot:Dne,addArea:Ine,removeArea:Rne,addLine:Mne,removeLine:Fne}=yE.actions,r$=yE.reducer,n$=p.createContext(void 0),a$=e=>{var{children:t}=e,[r]=p.useState("".concat(Qo("recharts"),"-clip")),n=xg();if(n==null)return null;var{x:a,y:i,width:o,height:l}=n;return p.createElement(n$.Provider,{value:r},p.createElement("defs",null,p.createElement("clipPath",{id:r},p.createElement("rect",{x:a,y:i,height:l,width:o}))),t)};function wE(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function i$(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return e$(n,r)}function s$(e,t,r){var n=r==="width",{x:a,y:i,width:o,height:l}=e;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function fl(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function o$(e,t){return wE(e,t+1)}function l$(e,t,r,n,a){for(var i=(n||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,h=function(){var x=n?.[c];if(x===void 0)return{v:wE(n,d)};var g=c,v,b=()=>(v===void 0&&(v=r(x,g)),v),w=x.coordinate,y=c===0||fl(e,w,b,u,l);y||(c=0,u=o,d+=1),y&&(u=w+e*(b()/2+a),c+=d)},f;d<=i.length;)if(f=h(),f)return f.v;return[]}function c$(e,t,r,n,a){var i=(n||[]).slice(),o=i.length;if(o===0)return[];for(var{start:l,end:c}=t,d=1;d<=o;d++){for(var u=(o-1)%d,h=l,f=!0,m=function(){var N=n[g];if(N==null)return 0;var _=g,S,j=()=>(S===void 0&&(S=r(N,_)),S),E=N.coordinate,k=g===u||fl(e,E,j,h,c);if(!k)return f=!1,1;k&&(h=E+e*(j()/2+a))},x,g=u;g<o&&(x=m(),!(x!==0&&x===1));g+=d);if(f){for(var v=[],b=u;b<o;b+=d){var w=n[b];w!=null&&v.push(w)}return v}}return[]}function Mw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Er(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mw(Object(r),!0).forEach(function(n){u$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u$(e,t,r){return(t=d$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d$(e){var t=h$(e,"string");return typeof t=="symbol"?t:t+""}function h$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f$(e,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,{start:l}=t,{end:c}=t,d=function(f){var m=i[f];if(m==null)return 1;var x=m,g,v=()=>(g===void 0&&(g=r(m,f)),g);if(f===o-1){var b=e*(x.coordinate+e*v()/2-c);i[f]=x=Er(Er({},x),{},{tickCoord:b>0?x.coordinate-b*e:x.coordinate})}else i[f]=x=Er(Er({},x),{},{tickCoord:x.coordinate});if(x.tickCoord!=null){var w=fl(e,x.tickCoord,v,l,c);w&&(c=x.tickCoord-e*(v()/2+a),i[f]=Er(Er({},x),{},{isShow:!0}))}},u=o-1;u>=0;u--)d(u);return i}function m$(e,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,{start:c,end:d}=t;if(i){var u=n[l-1];if(u!=null){var h=r(u,l-1),f=e*(u.coordinate+e*h/2-d);if(o[l-1]=u=Er(Er({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate}),u.tickCoord!=null){var m=fl(e,u.tickCoord,()=>h,c,d);m&&(d=u.tickCoord-e*(h/2+a),o[l-1]=Er(Er({},u),{},{isShow:!0}))}}}for(var x=i?l-1:l,g=function(w){var y=o[w];if(y==null)return 1;var N=y,_,S=()=>(_===void 0&&(_=r(y,w)),_);if(w===0){var j=e*(N.coordinate-e*S()/2-c);o[w]=N=Er(Er({},N),{},{tickCoord:j<0?N.coordinate-j*e:N.coordinate})}else o[w]=N=Er(Er({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var E=fl(e,N.tickCoord,S,c,d);E&&(c=N.tickCoord+e*(S()/2+a),o[w]=Er(Er({},N),{},{isShow:!0}))}},v=0;v<x;v++)g(v);return o}function gg(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:h}=e;if(!a||!a.length||!n)return[];if(Ie(c)||$d.isSsr){var f;return(f=o$(a,Ie(c)?c:0))!==null&&f!==void 0?f:[]}var m=[],x=l==="top"||l==="bottom"?"width":"height",g=u&&x==="width"?Vo(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(_,S)=>{var j=typeof d=="function"?d(_.value,S):_.value;return x==="width"?i$(Vo(j,{fontSize:t,letterSpacing:r}),g,h):Vo(j,{fontSize:t,letterSpacing:r})[x]},b=a[0],w=a[1],y=a.length>=2&&b!=null&&w!=null?lr(w.coordinate-b.coordinate):1,N=s$(i,y,x);return c==="equidistantPreserveStart"?l$(y,N,v,a,o):c==="equidistantPreserveEnd"?c$(y,N,v,a,o):(c==="preserveStart"||c==="preserveStartEnd"?m=m$(y,N,v,a,o,c==="preserveStartEnd"):m=f$(y,N,v,a,o),m.filter(_=>_.isShow))}var p$=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,o=0;if(t){Array.from(t).forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>o&&(o=h.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+i,d=o+c+l+(r?n:0);return Math.round(d)}return 0},x$=["axisLine","width","height","className","hide","ticks","axisType"];function g$(e,t){if(e==null)return{};var r,n,a=v$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function es(){return es=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},es.apply(null,arguments)}function Fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fw(Object(r),!0).forEach(function(n){b$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b$(e,t,r){return(t=y$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y$(e){var t=w$(e,"string");return typeof t=="symbol"?t:t+""}function w$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pa={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Gt.axis};function N$(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=Lt(Lt(Lt({},c),bn(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var u=+(i==="top"&&!o||i==="bottom"&&o);d=Lt(Lt({},d),{},{x1:t,y1:r+u*a,x2:t+n,y2:r+u*a})}else{var h=+(i==="left"&&!o||i==="right"&&o);d=Lt(Lt({},d),{},{x1:t+h*n,y1:r,x2:t+h*n,y2:r+a})}return p.createElement("line",es({},d,{className:lt("recharts-cartesian-axis-line",Xi(l,"className"))}))}function _$(e,t,r,n,a,i,o,l,c){var d,u,h,f,m,x,g=l?-1:1,v=e.tickSize||o,b=Ie(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=u=e.coordinate,f=r+ +!l*a,h=f-g*v,x=h-g*c,m=b;break;case"left":h=f=e.coordinate,u=t+ +!l*n,d=u-g*v,m=d-g*c,x=b;break;case"right":h=f=e.coordinate,u=t+ +l*n,d=u+g*v,m=d+g*c,x=b;break;default:d=u=e.coordinate,f=r+ +l*a,h=f+g*v,x=h+g*c,m=b;break}return{line:{x1:d,y1:h,x2:u,y2:f},tick:{x:m,y:x}}}function j$(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function S$(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function E$(e){var{option:t,tickProps:r,value:n}=e,a,i=lt(r.className,"recharts-cartesian-axis-tick-value");if(p.isValidElement(t))a=p.cloneElement(t,Lt(Lt({},r),{},{className:i}));else if(typeof t=="function")a=t(Lt(Lt({},r),{},{className:i}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=lt(o,lE(t))),a=p.createElement(s0,es({},r,{className:o}),n)}return a}var C$=p.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:i,tickFormatter:o,unit:l,padding:c,tickTextProps:d,orientation:u,mirror:h,x:f,y:m,width:x,height:g,tickSize:v,tickMargin:b,fontSize:w,letterSpacing:y,getTicksConfig:N,events:_,axisType:S}=e,j=gg(Lt(Lt({},N),{},{ticks:r}),w,y),E=j$(u,h),k=S$(u,h),T=bn(N),A=Ki(n),C={};typeof a=="object"&&(C=a);var R=Lt(Lt({},T),{},{fill:"none"},C),G=j.map(K=>Lt({entry:K},_$(K,f,m,x,g,u,v,h,b))),V=G.map(K=>{var{entry:Y,line:q}=K;return p.createElement(ur,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},a&&p.createElement("line",es({},R,q,{className:lt("recharts-cartesian-axis-tick-line",Xi(a,"className"))})))}),X=G.map((K,Y)=>{var q,Z,{entry:le,tick:ce}=K,pe=Lt(Lt(Lt(Lt({verticalAnchor:k},T),{},{textAnchor:E,stroke:"none",fill:i},ce),{},{index:Y,payload:le,visibleTicksCount:j.length,tickFormatter:o,padding:c},d),{},{angle:(q=(Z=d?.angle)!==null&&Z!==void 0?Z:T.angle)!==null&&q!==void 0?q:0}),Ne=Lt(Lt({},pe),A);return p.createElement(ur,es({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(le.value,"-").concat(le.coordinate,"-").concat(le.tickCoord)},wd(_,le,Y)),n&&p.createElement(E$,{option:n,tickProps:Ne,value:"".concat(typeof o=="function"?o(le.value,Y):le.value).concat(l||"")}))});return p.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(S,"-ticks")},X.length>0&&p.createElement(on,{zIndex:Gt.label},p.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(S,"-tick-labels"),ref:t},X)),V.length>0&&p.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(S,"-tick-lines")},V))}),T$=p.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:o,ticks:l,axisType:c}=e,d=g$(e,x$),[u,h]=p.useState(""),[f,m]=p.useState(""),x=p.useRef(null);p.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return p$({ticks:x.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=p.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=b;var w=b[0];if(w){var y=window.getComputedStyle(w),N=y.fontSize,_=y.letterSpacing;(N!==u||_!==f)&&(h(N),m(_))}}},[u,f]);return o||n!=null&&n<=0||a!=null&&a<=0?null:p.createElement(on,{zIndex:e.zIndex},p.createElement(ur,{className:lt("recharts-cartesian-axis",i)},p.createElement(N$,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:bn(e)}),p.createElement(C$,{ref:g,axisType:c,events:d,fontSize:u,getTicksConfig:e,height:e.height,letterSpacing:f,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),p.createElement(_7,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},p.createElement(D7,{label:e.label,labelRef:e.labelRef}),e.children)))}),vg=p.forwardRef((e,t)=>{var r=hr(e,Pa);return p.createElement(T$,es({},r,{ref:t}))});vg.displayName="CartesianAxis";var k$=["x1","y1","x2","y2","key"],A$=["offset"],P$=["xAxisId","yAxisId"],O$=["xAxisId","yAxisId"];function Lw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lw(Object(r),!0).forEach(function(n){D$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D$(e,t,r){return(t=I$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I$(e){var t=R$(e,"string");return typeof t=="symbol"?t:t+""}function R$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $i(){return $i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$i.apply(null,arguments)}function Lu(e,t){if(e==null)return{};var r,n,a=M$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function M$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var F$=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:o,ry:l}=e;return p.createElement("rect",{x:n,y:a,ry:l,width:i,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function NE(e){var{option:t,lineItemProps:r}=e,n;if(p.isValidElement(t))n=p.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:i,y1:o,x2:l,y2:c,key:d}=r,u=Lu(r,k$),h=(a=bn(u))!==null&&a!==void 0?a:{},{offset:f}=h,m=Lu(h,A$);n=p.createElement("line",$i({},m,{x1:i,y1:o,x2:l,y2:c,fill:"none",key:d}))}return n}function L$(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Lu(e,P$),c=a.map((d,u)=>{var h=Ar(Ar({},l),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(u),index:u});return p.createElement(NE,{key:"line-".concat(u),option:n,lineItemProps:h})});return p.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function B$(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:o}=e,l=Lu(e,O$),c=a.map((d,u)=>{var h=Ar(Ar({},l),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(u),index:u});return p.createElement(NE,{option:n,lineItemProps:h,key:"line-".concat(u)})});return p.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function $$(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var d=l.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var u=d.map((h,f)=>{var m=d[f+1],x=m==null,g=x?a+o-h:m-h;if(g<=0)return null;var v=f%t.length;return p.createElement("rect",{key:"react-".concat(f),y:h,x:n,height:g,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function U$(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var d=c.map(h=>Math.round(h+a-a)).sort((h,f)=>h-f);a!==d[0]&&d.unshift(0);var u=d.map((h,f)=>{var m=d[f+1],x=m==null,g=x?a+o-h:m-h;if(g<=0)return null;var v=f%r.length;return p.createElement("rect",{key:"react-".concat(f),x:h,y:i,width:g,height:l,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var H$=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return d5(gg(Ar(Ar(Ar({},Pa),r),{},{ticks:h5(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},z$=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return d5(gg(Ar(Ar(Ar({},Pa),r),{},{ticks:h5(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},W$={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Gt.grid};function bg(e){var t=y5(),r=w5(),n=b5(),a=Ar(Ar({},hr(e,W$)),{},{x:Ie(e.x)?e.x:n.left,y:Ie(e.y)?e.y:n.top,width:Ie(e.width)?e.width:n.width,height:Ie(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:h,horizontalValues:f,verticalValues:m}=a,x=Mr(),g=Fe(k=>Ty(k,"xAxis",i,x)),v=Fe(k=>Ty(k,"yAxis",o,x));if(!fa(d)||!fa(u)||!Ie(l)||!Ie(c))return null;var b=a.verticalCoordinatesGenerator||H$,w=a.horizontalCoordinatesGenerator||z$,{horizontalPoints:y,verticalPoints:N}=a;if((!y||!y.length)&&typeof w=="function"){var _=f&&f.length,S=w({yAxis:v?Ar(Ar({},v),{},{ticks:_?f:v.ticks}):void 0,width:t??d,height:r??u,offset:n},_?!0:h);uu(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(y=S)}if((!N||!N.length)&&typeof b=="function"){var j=m&&m.length,E=b({xAxis:g?Ar(Ar({},g),{},{ticks:j?m:g.ticks}):void 0,width:t??d,height:r??u,offset:n},j?!0:h);uu(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(N=E)}return p.createElement(on,{zIndex:a.zIndex},p.createElement("g",{className:"recharts-cartesian-grid"},p.createElement(F$,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),p.createElement($$,$i({},a,{horizontalPoints:y})),p.createElement(U$,$i({},a,{verticalPoints:N})),p.createElement(L$,$i({},a,{offset:n,horizontalPoints:y,xAxis:g,yAxis:v})),p.createElement(B$,$i({},a,{offset:n,verticalPoints:N,xAxis:g,yAxis:v}))))}bg.displayName="CartesianGrid";var V$={},_E=sn({name:"errorBars",initialState:V$,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:Lne,replaceErrorBar:Bne,removeErrorBar:$ne}=_E.actions,K$=_E.reducer,G$=["children"];function X$(e,t){if(e==null)return{};var r,n,a=Y$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Y$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var q$={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Z$=p.createContext(q$);function jE(e){var{children:t}=e,r=X$(e,G$);return p.createElement(Z$.Provider,{value:r},t)}function yg(e,t){var r,n,a=Fe(d=>Ja(d,e)),i=Fe(d=>Qa(d,t)),o=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:ar.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:ir.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function SE(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=xg(),{needClipX:i,needClipY:o,needClip:l}=yg(t,r);if(!l||!a)return null;var{x:c,y:d,width:u,height:h}=a;return p.createElement("clipPath",{id:"clipPath-".concat(n)},p.createElement("rect",{x:i?c:c-u/2,y:o?d:d-h/2,width:i?u:u*2,height:o?h:h*2}))}var EE=(e,t,r,n)=>mi(e,"xAxis",t,n),CE=(e,t,r,n)=>fi(e,"xAxis",t,n),TE=(e,t,r,n)=>mi(e,"yAxis",r,n),kE=(e,t,r,n)=>fi(e,"yAxis",r,n),J$=Q([at,EE,TE,CE,kE],(e,t,r,n,a)=>Ga(e,"xAxis")?eo(t,n,!1):eo(r,a,!1)),Q$=(e,t,r,n,a)=>a;function eU(e){return e.type==="line"}var tU=Q([e0,Q$],(e,t)=>e.filter(eU).find(r=>r.id===t)),rU=Q([at,EE,TE,CE,kE,tU,J$,xx],(e,t,r,n,a,i,o,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=l;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:h,data:f}=i,m;if(f!=null&&f.length>0?m=f:m=c?.slice(d,u+1),m!=null)return zU({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:h,bandSize:o,displayedData:m})}});function nU(e){var t=Ki(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,o=Number(a),l=Number(i);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var af={exports:{}},sf={};var Bw;function aU(){if(Bw)return sf;Bw=1;var e=md();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,l=e.useDebugValue;return sf.useSyncExternalStoreWithSelector=function(c,d,u,h,f){var m=a(null);if(m.current===null){var x={hasValue:!1,value:null};m.current=x}else x=m.current;m=o(function(){function v(_){if(!b){if(b=!0,w=_,_=h(_),f!==void 0&&x.hasValue){var S=x.value;if(f(S,_))return y=S}return y=_}if(S=y,r(w,_))return S;var j=h(_);return f!==void 0&&f(S,j)?(w=_,S):(w=_,y=j)}var b=!1,w,y,N=u===void 0?null:u;return[function(){return v(d())},N===null?void 0:function(){return v(N())}]},[d,u,h,f]);var g=n(c,m[0],m[1]);return i(function(){x.hasValue=!0,x.value=g},[g]),l(g),g},sf}var $w;function iU(){return $w||($w=1,af.exports=aU()),af.exports}iU();function sU(e){e()}function oU(){let e=null,t=null;return{clear(){e=null,t=null},notify(){sU(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Uw={notify(){},get:()=>[]};function lU(e,t){let r,n=Uw,a=0,i=!1;function o(g){u();const v=n.subscribe(g);let b=!1;return()=>{b||(b=!0,v(),h())}}function l(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function d(){return i}function u(){a++,r||(r=e.subscribe(c),n=oU())}function h(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Uw)}function f(){i||(i=!0,u())}function m(){i&&(i=!1,h())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:f,tryUnsubscribe:m,getListeners:()=>n};return x}var cU=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uU=cU(),dU=()=>typeof navigator<"u"&&navigator.product==="ReactNative",hU=dU(),fU=()=>uU||hU?p.useLayoutEffect:p.useEffect,mU=fU();function Hw(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function pU(e,t){if(Hw(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!Hw(e[r[a]],t[r[a]]))return!1;return!0}var xU=Symbol.for("react-redux-context"),gU=typeof globalThis<"u"?globalThis:{};function vU(){if(!p.createContext)return{};const e=gU[xU]??=new Map;let t=e.get(p.createContext);return t||(t=p.createContext(null),e.set(p.createContext,t)),t}var bU=vU();function yU(e){const{children:t,context:r,serverState:n,store:a}=e,i=p.useMemo(()=>{const c=lU(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=p.useMemo(()=>a.getState(),[a]);mU(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,o]);const l=r||bU;return p.createElement(l.Provider,{value:i},t)}var wU=yU,NU=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function _U(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function u0(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(NU.has(n)){if(e[n]==null&&t[n]==null)continue;if(!pU(e[n],t[n]))return!1}else if(!_U(e[n],t[n]))return!1;return!0}var jU=["id"],SU=["type","layout","connectNulls","needClip","shape"],EU=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function ml(){return ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ml.apply(null,arguments)}function zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zw(Object(r),!0).forEach(function(n){CU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CU(e,t,r){return(t=TU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TU(e){var t=kU(e,"string");return typeof t=="symbol"?t:t+""}function kU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wg(e,t){if(e==null)return{};var r,n,a=AU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var PU=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:oo(r,t),payload:e}]},OU=p.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:o,hide:l,unit:c,tooltipType:d,id:u}=e,h={dataDefinedOnItem:r,getPosition:cs,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:oo(o,t),hide:l,type:d,color:n,unit:c,graphicalItemId:u}};return p.createElement(mg,{tooltipEntrySettings:h})}),AE=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function DU(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var IU=(e,t,r)=>{var n=r.reduce((m,x)=>m+x);if(!n)return AE(t,e);for(var a=Math.floor(e/n),i=e%n,o=t-e,l=[],c=0,d=0;c<r.length;d+=(u=r[c])!==null&&u!==void 0?u:0,++c){var u,h=r[c];if(h!=null&&d+h>i){l=[...r.slice(0,c),i-d];break}}var f=l.length%2===0?[0,o]:[o];return[...DU(r,a),...l,...f].map(m=>"".concat(m,"px")).join(", ")};function RU(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:o}=n,{id:l}=n,c=wg(n,jU),d=bn(c);return p.createElement(NB,{points:r,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:d,needClip:o,clipPathId:t})}function MU(e){var{showLabels:t,children:r,points:n}=e,a=p.useMemo(()=>n?.map(i=>{var o,l,c={x:(o=i.x)!==null&&o!==void 0?o:0,y:(l=i.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ra(ra({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return p.createElement(rE,{value:t?a:void 0},r)}function Ww(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:o,layout:l,connectNulls:c,needClip:d,shape:u}=i,h=wg(i,SU),f=ra(ra({},Yr(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return p.createElement(p.Fragment,null,n?.length>1&&p.createElement(ug,ml({shapeType:"curve",option:u},f,{pathRef:r})),p.createElement(RU,{points:n,clipPathId:t,props:i}))}function FU(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function LU(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:h,animateNewValues:f,width:m,height:x,onAnimationEnd:g,onAnimationStart:v}=r,b=a.current,w=Rl(o,"recharts-line-"),y=p.useRef(w),[N,_]=p.useState(!1),S=!N,j=p.useCallback(()=>{typeof g=="function"&&g(),_(!1)},[g]),E=p.useCallback(()=>{typeof v=="function"&&v(),_(!0)},[v]),k=FU(n.current),T=p.useRef(0);y.current!==w&&(T.current=i.current,y.current=w);var A=T.current;return p.createElement(MU,{points:o,showLabels:S},r.children,p.createElement(Il,{animationId:w,begin:d,duration:u,isActive:c,easing:h,onAnimationEnd:j,onAnimationStart:E,key:w},C=>{var R=Ct(A,k+A,C),G=Math.min(R,k),V;if(c)if(l){var X="".concat(l).split(/[,\s]+/gim).map(q=>parseFloat(q));V=IU(G,k,X)}else V=AE(k,G);else V=l==null?void 0:String(l);if(C>0&&k>0&&(a.current=o,i.current=Math.max(i.current,G)),b){var K=b.length/o.length,Y=C===1?o:o.map((q,Z)=>{var le=Math.floor(Z*K);if(b[le]){var ce=b[le];return ra(ra({},q),{},{x:Ct(ce.x,q.x,C),y:Ct(ce.y,q.y,C)})}return f?ra(ra({},q),{},{x:Ct(m*2,q.x,C),y:Ct(x/2,q.y,C)}):ra(ra({},q),{},{x:q.x,y:q.y})});return a.current=Y,p.createElement(Ww,{props:r,points:Y,clipPathId:t,pathRef:n,strokeDasharray:V})}return p.createElement(Ww,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:V})}),p.createElement(sg,{label:r.label}))}function BU(e){var{clipPathId:t,props:r}=e,n=p.useRef(null),a=p.useRef(0),i=p.useRef(null);return p.createElement(LU,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var $U=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:xt(e.payload,t)}};class UU extends p.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:o,top:l,left:c,width:d,height:u,id:h,needClip:f,zIndex:m}=this.props;if(t)return null;var x=lt("recharts-line",a),g=h,{r:v,strokeWidth:b}=nU(r),w=dE(r),y=v*2+b,N=f?"url(#clipPath-".concat(w?"":"dots-").concat(g,")"):void 0;return p.createElement(on,{zIndex:m},p.createElement(ur,{className:x},f&&p.createElement("defs",null,p.createElement(SE,{clipPathId:g,xAxisId:i,yAxisId:o}),!w&&p.createElement("clipPath",{id:"clipPath-dots-".concat(g)},p.createElement("rect",{x:c-y/2,y:l-y/2,width:d+y,height:u+y}))),p.createElement(jE,{xAxisId:i,yAxisId:o,data:n,dataPointFormatter:$U,errorBarOffset:0},p.createElement(BU,{props:this.props,clipPathId:g}))),p.createElement(HB,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:N}))}}var PE={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Gt.line,type:"linear"};function HU(e){var t=hr(e,PE),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,connectNulls:l,dot:c,hide:d,isAnimationActive:u,label:h,legendType:f,xAxisId:m,yAxisId:x,id:g}=t,v=wg(t,EU),{needClip:b}=yg(m,x),w=xg(),y=us(),N=Mr(),_=Fe(T=>rU(T,m,x,N,g));if(y!=="horizontal"&&y!=="vertical"||_==null||w==null)return null;var{height:S,width:j,x:E,y:k}=w;return p.createElement(UU,ml({},v,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:o,isAnimationActive:u,hide:d,label:h,legendType:f,xAxisId:m,yAxisId:x,points:_,layout:y,height:S,width:j,left:E,top:k,needClip:b}))}function zU(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((d,u)=>{var h=xt(d,o);if(t==="horizontal"){var f=C1({axis:r,ticks:a,bandSize:l,entry:d,index:u}),m=Mt(h)?null:n.scale.map(h);return{x:f,y:m??null,value:h,payload:d}}var x=Mt(h)?null:r.scale.map(h),g=C1({axis:n,ticks:i,bandSize:l,entry:d,index:u});return x==null||g==null?null:{x,y:g,value:h,payload:d}}).filter(Boolean)}function WU(e){var t=hr(e,PE),r=Mr();return p.createElement(pg,{id:t.id,type:"line"},n=>p.createElement(p.Fragment,null,p.createElement(hE,{legendPayload:PU(t)}),p.createElement(OU,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),p.createElement(mE,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),p.createElement(HU,ml({},t,{id:n}))))}var OE=p.memo(WU,u0);OE.displayName="Line";function fs(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:xE}function ms(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:xE}var VU="Invariant failed";function KU(e,t){throw new Error(VU)}function Lm(){return Lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lm.apply(null,arguments)}function Bu(e){return p.createElement(ug,Lm({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var GU=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Ie(t))return t;var i=Ie(n)||Mt(n);return i?t(n,a):(i||KU(),r)}},XU=(e,t,r)=>r,YU=(e,t)=>t,Xl=Q([e0,YU],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),qU=Q([Xl],e=>e?.maxBarSize),ZU=(e,t,r,n)=>n,JU=Q([at,e0,fs,ms,XU],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),QU=(e,t,r)=>{var n=at(e),a=fs(e,t),i=ms(e,t);if(!(a==null||i==null))return n==="horizontal"?Pm(e,"yAxis",i,r):Pm(e,"xAxis",a,r)},eH=(e,t)=>{var r=at(e),n=fs(e,t),a=ms(e,t);if(!(n==null||a==null))return r==="horizontal"?Cy(e,"xAxis",n):Cy(e,"yAxis",a)},tH=Q([JU,g8,eH],zB),rH=(e,t,r)=>{var n,a,i=Xl(e,t);if(i==null)return 0;var o=fs(e,t),l=ms(e,t);if(o==null||l==null)return 0;var c=at(e),d=Rj(e),{maxBarSize:u}=i,h=Mt(u)?d:u,f,m;return c==="horizontal"?(f=mi(e,"xAxis",o,r),m=fi(e,"xAxis",o,r)):(f=mi(e,"yAxis",l,r),m=fi(e,"yAxis",l,r)),(n=(a=eo(f,m,!0))!==null&&a!==void 0?a:h)!==null&&n!==void 0?n:0},DE=(e,t,r)=>{var n=at(e),a=fs(e,t),i=ms(e,t);if(!(a==null||i==null)){var o,l;return n==="horizontal"?(o=mi(e,"xAxis",a,r),l=fi(e,"xAxis",a,r)):(o=mi(e,"yAxis",i,r),l=fi(e,"yAxis",i,r)),eo(o,l)}},nH=Q([tH,Rj,x8,Mj,rH,DE,qU],XB),aH=(e,t,r)=>{var n=fs(e,t);if(n!=null)return mi(e,"xAxis",n,r)},iH=(e,t,r)=>{var n=ms(e,t);if(n!=null)return mi(e,"yAxis",n,r)},sH=(e,t,r)=>{var n=fs(e,t);if(n!=null)return fi(e,"xAxis",n,r)},oH=(e,t,r)=>{var n=ms(e,t);if(n!=null)return fi(e,"yAxis",n,r)},lH=Q([nH,Xl],qB),cH=Q([QU,Xl],YB),uH=Q([tr,$p,aH,iH,sH,oH,lH,at,l8,DE,cH,Xl,ZU],(e,t,r,n,a,i,o,l,c,d,u,h,f)=>{var{chartData:m,dataStartIndex:x,dataEndIndex:g}=c;if(!(h==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:v}=h,b;if(v!=null&&v.length>0?b=v:b=m?.slice(x,g+1),b!=null)return LH({layout:l,barSettings:h,pos:o,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:u,displayedData:b,offset:e,cells:f,dataStartIndex:x})}}),dH=["index"];function Bm(){return Bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bm.apply(null,arguments)}function hH(e,t){if(e==null)return{};var r,n,a=fH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var IE=p.createContext(void 0),mH=e=>{var t=p.useContext(IE);if(t!=null)return t.stackId;if(e!=null)return gO(e)},pH=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),xH=e=>{var t=p.useContext(IE);if(t!=null){var{stackId:r}=t;return"url(#".concat(pH(r,e),")")}},RE=e=>{var{index:t}=e,r=hH(e,dH),n=xH(t);return p.createElement(ur,Bm({className:"recharts-bar-stack-layer",clipPath:n},r))},gH=["onMouseEnter","onMouseLeave","onClick"],vH=["value","background","tooltipPosition"],bH=["id"],yH=["onMouseEnter","onClick","onMouseLeave"];function Ha(){return Ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ha.apply(null,arguments)}function Vw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vw(Object(r),!0).forEach(function(n){wH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wH(e,t,r){return(t=NH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NH(e){var t=_H(e,"string");return typeof t=="symbol"?t:t+""}function _H(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $u(e,t){if(e==null)return{};var r,n,a=jH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SH=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:oo(r,t),payload:e}]},EH=p.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:o,unit:l,tooltipType:c,id:d}=e,u={dataDefinedOnItem:void 0,getPosition:cs,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:oo(i,t),hide:o,type:c,color:a,unit:l,graphicalItemId:d}};return p.createElement(mg,{tooltipEntrySettings:u})});function CH(e){var t=Fe(pi),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=i,d=$u(i,gH),u=dg(o,n,i.id),h=hg(l),f=fg(c,n,i.id);if(!a||r==null)return null;var m=Ki(a);return p.createElement(on,{zIndex:ZB(a,Gt.barBackground)},r.map((x,g)=>{var{value:v,background:b,tooltipPosition:w}=x,y=$u(x,vH);if(!b)return null;var N=u(x,g),_=h(x,g),S=f(x,g),j=zr(zr(zr(zr(zr({option:a,isActive:String(g)===t},y),{},{fill:"#eee"},b),m),wd(d,x,g)),{},{onMouseEnter:N,onMouseLeave:_,onClick:S,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return p.createElement(Bu,Ha({key:"background-bar-".concat(g)},j))}))}function TH(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var o={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return zr(zr({},o),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:o,fill:i.fill})});return p.createElement(rE,{value:t?a:void 0},r)}function kH(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:o}=e,l=Fe(pi),c=Fe(Jx),d=r&&String(i)===l&&(c==null||o===c),u=d?r:t;return d?p.createElement(on,{zIndex:Gt.activeBar},p.createElement(RE,{index:i},p.createElement(Bu,Ha({},n,{name:String(n.name)},a,{isActive:d,option:u,index:i,dataKey:o})))):p.createElement(Bu,Ha({},n,{name:String(n.name)},a,{isActive:d,option:u,index:i,dataKey:o}))}function AH(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return p.createElement(Bu,Ha({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function PH(e){var t,{data:r,props:n}=e,a=(t=bn(n))!==null&&t!==void 0?t:{},{id:i}=a,o=$u(a,bH),{shape:l,dataKey:c,activeBar:d}=n,{onMouseEnter:u,onClick:h,onMouseLeave:f}=n,m=$u(n,yH),x=dg(u,c,i),g=hg(f),v=fg(h,c,i);return r?p.createElement(p.Fragment,null,r.map((b,w)=>p.createElement(RE,Ha({index:w,key:"rectangle-".concat(b?.x,"-").concat(b?.y,"-").concat(b?.value,"-").concat(w),className:"recharts-bar-rectangle"},wd(m,b,w),{onMouseEnter:x(b,w),onMouseLeave:g(b,w),onClick:v(b,w)}),d?p.createElement(kH,{shape:l,activeBar:d,baseProps:o,entry:b,index:w,dataKey:c}):p.createElement(AH,{shape:l,baseProps:o,entry:b,index:w,dataKey:c})))):null}function OH(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,h=r.current,f=Rl(t,"recharts-bar-"),[m,x]=p.useState(!1),g=!m,v=p.useCallback(()=>{typeof d=="function"&&d(),x(!1)},[d]),b=p.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return p.createElement(TH,{showLabels:g,rects:n},p.createElement(Il,{animationId:f,begin:o,duration:l,isActive:i,easing:c,onAnimationEnd:v,onAnimationStart:b,key:f},w=>{var y=w===1?n:n?.map((N,_)=>{var S=h&&h[_];if(S)return zr(zr({},N),{},{x:Ct(S.x,N.x,w),y:Ct(S.y,N.y,w),width:Ct(S.width,N.width,w),height:Ct(S.height,N.height,w)});if(a==="horizontal"){var j=Ct(0,N.height,w),E=Ct(N.stackedBarStart,N.y,w);return zr(zr({},N),{},{y:E,height:j})}var k=Ct(0,N.width,w),T=Ct(N.stackedBarStart,N.x,w);return zr(zr({},N),{},{width:k,x:T})});return w>0&&(r.current=y??null),y==null?null:p.createElement(ur,null,p.createElement(PH,{props:t,data:y}))}),p.createElement(sg,{label:t.label}),t.children)}function DH(e){var t=p.useRef(null);return p.createElement(OH,{previousRectanglesRef:t,props:e})}var ME=0,IH=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:xt(e,t)}};class RH extends p.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||r==null)return null;var u=lt("recharts-bar",a),h=d;return p.createElement(ur,{className:u,id:d},l&&p.createElement("defs",null,p.createElement(SE,{clipPathId:h,xAxisId:i,yAxisId:o})),p.createElement(ur,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(h,")"):void 0},p.createElement(CH,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),p.createElement(DH,this.props)))}}var MH={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:ME,xAxisId:0,yAxisId:0,zIndex:Gt.bar};function FH(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:h}=yg(t,r),f=us(),m=Mr(),x=cg(e.children,Gl),g=Fe(w=>uH(w,e.id,m,x));if(f!=="vertical"&&f!=="horizontal")return null;var v,b=g?.[0];return b==null||b.height==null||b.width==null?v=0:v=f==="vertical"?b.height/2:b.width/2,p.createElement(jE,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:IH,errorBarOffset:v},p.createElement(RH,Ha({},e,{layout:f,needClip:h,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function LH(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:h,offset:f,cells:m,parentViewBox:x,dataStartIndex:g}=e,v=t==="horizontal"?l:o,b=u?v.scale.domain():null,w=vO({numericAxis:v}),y=v.scale.map(w);return h.map((N,_)=>{var S,j,E,k,T,A;if(u){var C=u[_+g];if(C==null)return null;S=hO(C,b)}else S=xt(N,r),Array.isArray(S)||(S=[w,S]);var R=GU(n,ME)(S[1],_);if(t==="horizontal"){var G,V=l.scale.map(S[0]),X=l.scale.map(S[1]);if(V==null||X==null)return null;j=T1({axis:o,ticks:c,bandSize:i,offset:a.offset,entry:N,index:_}),E=(G=X??V)!==null&&G!==void 0?G:void 0,k=a.size;var K=V-X;if(T=da(K)?0:K,A={x:j,y:f.top,width:k,height:f.height},Math.abs(R)>0&&Math.abs(T)<Math.abs(R)){var Y=lr(T||R)*(Math.abs(R)-Math.abs(T));E-=Y,T+=Y}}else{var q=o.scale.map(S[0]),Z=o.scale.map(S[1]);if(q==null||Z==null)return null;if(j=q,E=T1({axis:l,ticks:d,bandSize:i,offset:a.offset,entry:N,index:_}),k=Z-q,T=a.size,A={x:f.left,y:E,width:f.width,height:T},Math.abs(R)>0&&Math.abs(k)<Math.abs(R)){var le=lr(k||R)*(Math.abs(R)-Math.abs(k));k+=le}}if(j==null||E==null||k==null||T==null)return null;var ce=zr(zr({},N),{},{stackedBarStart:y,x:j,y:E,width:k,height:T,value:u?S:S[1],payload:N,background:A,tooltipPosition:{x:j+k/2,y:E+T/2},parentViewBox:x},m&&m[_]&&m[_].props);return ce}).filter(Boolean)}function BH(e){var t=hr(e,MH),r=mH(t.stackId),n=Mr();return p.createElement(pg,{id:t.id,type:"bar"},a=>p.createElement(p.Fragment,null,p.createElement(hE,{legendPayload:SH(t)}),p.createElement(EH,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),p.createElement(mE,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),p.createElement(on,{zIndex:t.zIndex},p.createElement(FH,Ha({},t,{id:a})))))}var $m=p.memo(BH,u0);$m.displayName="Bar";var $H=["domain","range"],UH=["domain","range"];function Kw(e,t){if(e==null)return{};var r,n,a=HH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function HH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gw(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function FE(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=Kw(e,$H),{domain:i,range:o}=t,l=Kw(t,UH);return!Gw(r,i)||!Gw(n,o)?!1:u0(a,l)}var zH=["type"],WH=["dangerouslySetInnerHTML","ticks","scale"],VH=["id","scale"];function Um(){return Um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Um.apply(null,arguments)}function Xw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xw(Object(r),!0).forEach(function(n){KH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KH(e,t,r){return(t=GH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GH(e){var t=XH(e,"string");return typeof t=="symbol"?t:t+""}function XH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hm(e,t){if(e==null)return{};var r,n,a=YH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qH(e){var t=Ot(),r=p.useRef(null),n=N5(),{type:a}=e,i=Hm(e,zH),o=Yd(n,"xAxis",a),l=p.useMemo(()=>{if(o!=null)return Yw(Yw({},i),{},{type:o})},[i,o]);return p.useLayoutEffect(()=>{l!=null&&(r.current===null?t(CB(l)):r.current!==l&&t(TB({prev:r.current,next:l})),r.current=l)},[l,t]),p.useLayoutEffect(()=>()=>{r.current&&(t(kB(r.current)),r.current=null)},[t]),null}var ZH=e=>{var{xAxisId:t,className:r}=e,n=Fe($p),a=Mr(),i="xAxis",o=Fe(b=>pS(b,i,t,a)),l=Fe(b=>dS(b,t)),c=Fe(b=>gM(b,t)),d=Fe(b=>Kj(b,t));if(l==null||c==null||d==null)return null;var{dangerouslySetInnerHTML:u,ticks:h,scale:f}=e,m=Hm(e,WH),{id:x,scale:g}=d,v=Hm(d,VH);return p.createElement(vg,Um({},m,v,{x:c.x,y:c.y,width:l.width,height:l.height,className:lt("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:o,axisType:i}))},JH={allowDataOverflow:ar.allowDataOverflow,allowDecimals:ar.allowDecimals,allowDuplicatedCategory:ar.allowDuplicatedCategory,angle:ar.angle,axisLine:Pa.axisLine,height:ar.height,hide:!1,includeHidden:ar.includeHidden,interval:ar.interval,label:!1,minTickGap:ar.minTickGap,mirror:ar.mirror,orientation:ar.orientation,padding:ar.padding,reversed:ar.reversed,scale:ar.scale,tick:ar.tick,tickCount:ar.tickCount,tickLine:Pa.tickLine,tickSize:Pa.tickSize,type:ar.type,xAxisId:0},QH=e=>{var t=hr(e,JH);return p.createElement(p.Fragment,null,p.createElement(qH,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),p.createElement(ZH,t))},Ng=p.memo(QH,FE);Ng.displayName="XAxis";var ez=["type"],tz=["dangerouslySetInnerHTML","ticks","scale"],rz=["id","scale"];function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zm.apply(null,arguments)}function qw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qw(Object(r),!0).forEach(function(n){nz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nz(e,t,r){return(t=az(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function az(e){var t=iz(e,"string");return typeof t=="symbol"?t:t+""}function iz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wm(e,t){if(e==null)return{};var r,n,a=sz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function oz(e){var t=Ot(),r=p.useRef(null),n=N5(),{type:a}=e,i=Wm(e,ez),o=Yd(n,"yAxis",a),l=p.useMemo(()=>{if(o!=null)return Zw(Zw({},i),{},{type:o})},[o,i]);return p.useLayoutEffect(()=>{l!=null&&(r.current===null?t(AB(l)):r.current!==l&&t(PB({prev:r.current,next:l})),r.current=l)},[l,t]),p.useLayoutEffect(()=>()=>{r.current&&(t(OB(r.current)),r.current=null)},[t]),null}function lz(e){var{yAxisId:t,className:r,width:n,label:a}=e,i=p.useRef(null),o=p.useRef(null),l=Fe($p),c=Mr(),d=Ot(),u="yAxis",h=Fe(S=>hS(S,t)),f=Fe(S=>bM(S,t)),m=Fe(S=>pS(S,u,t,c)),x=Fe(S=>Gj(S,t));if(p.useLayoutEffect(()=>{if(!(n!=="auto"||!h||ig(a)||p.isValidElement(a)||x==null)){var S=i.current;if(S){var j=S.getCalculatedWidth();Math.round(h.width)!==Math.round(j)&&d(DB({id:t,width:j}))}}},[m,h,d,a,t,n,x]),h==null||f==null||x==null)return null;var{dangerouslySetInnerHTML:g,ticks:v,scale:b}=e,w=Wm(e,tz),{id:y,scale:N}=x,_=Wm(x,rz);return p.createElement(vg,zm({},w,_,{ref:i,labelRef:o,x:f.x,y:f.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:h.width,height:h.height,className:lt("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:m,axisType:u}))}var cz={allowDataOverflow:ir.allowDataOverflow,allowDecimals:ir.allowDecimals,allowDuplicatedCategory:ir.allowDuplicatedCategory,angle:ir.angle,axisLine:Pa.axisLine,hide:!1,includeHidden:ir.includeHidden,interval:ir.interval,label:!1,minTickGap:ir.minTickGap,mirror:ir.mirror,orientation:ir.orientation,padding:ir.padding,reversed:ir.reversed,scale:ir.scale,tick:ir.tick,tickCount:ir.tickCount,tickLine:Pa.tickLine,tickSize:Pa.tickSize,type:ir.type,width:ir.width,yAxisId:0},uz=e=>{var t=hr(e,cz);return p.createElement(p.Fragment,null,p.createElement(oz,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),p.createElement(lz,t))},_g=p.memo(uz,FE);_g.displayName="YAxis";var dz=(e,t)=>t,jg=Q([dz,at,zj,mr,OS,ei,RF,tr],HF),Sg=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},LE=Dn("mouseClick"),BE=Al();BE.startListening({actionCreator:LE,effect:(e,t)=>{var r=e.payload,n=jg(t.getState(),Sg(r));n?.activeIndex!=null&&t.dispatch(DM({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Vm=Dn("mouseMove"),$E=Al(),vc=null;$E.startListening({actionCreator:Vm,effect:(e,t)=>{var r=e.payload;vc!==null&&cancelAnimationFrame(vc);var n=Sg(r);vc=requestAnimationFrame(()=>{var a=t.getState(),i=Kx(a,a.tooltip.settings.shared);if(i==="axis"){var o=jg(a,n);o?.activeIndex!=null?t.dispatch(_S({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(NS())}vc=null})}});function hz(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var Jw={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},UE=sn({name:"rootProps",initialState:Jw,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Jw.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),fz=UE.reducer,{updateOptions:mz}=UE.actions,pz=null,xz={updatePolarOptions:(e,t)=>t.payload},HE=sn({name:"polarOptions",initialState:pz,reducers:xz}),{updatePolarOptions:gz}=HE.actions,vz=HE.reducer,zE=Dn("keyDown"),WE=Dn("focus"),Eg=Al();Eg.startListening({actionCreator:zE,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var o=Gx(a,go(r),zl(r),Vl(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=ei(r);if(i==="Enter"){var d=Du(r,"axis","hover",String(a.index));t.dispatch(Dm({active:!a.active,activeIndex:a.index,activeCoordinate:d}));return}var u=_M(r),h=u==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,m=l+f*h;if(!(c==null||m>=c.length||m<0)){var x=Du(r,"axis","hover",String(m));t.dispatch(Dm({active:!0,activeIndex:m.toString(),activeCoordinate:x}))}}}}}});Eg.startListening({actionCreator:WE,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",o=Du(r,"axis","hover",String(i));t.dispatch(Dm({active:!0,activeIndex:i,activeCoordinate:o}))}}}});var Sn=Dn("externalEvent"),VE=Al(),of=new Map;VE.startListening({actionCreator:Sn,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,i=of.get(a);i!==void 0&&cancelAnimationFrame(i);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:bF(l),activeDataKey:Jx(l),activeIndex:pi(l),activeLabel:RS(l),activeTooltipIndex:pi(l),isTooltipActive:yF(l)};r(c,n)}finally{of.delete(a)}});of.set(a,o)}}});var bz=Q([po],e=>e.tooltipItemPayloads),yz=Q([bz,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(i=>i.settings.graphicalItemId===r);if(n!=null){var{getPosition:a}=n;if(a!=null)return a(t)}}}),KE=Dn("touchMove"),GE=Al();GE.startListening({actionCreator:KE,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=Kx(n,n.tooltip.settings.shared);if(a==="axis"){var i=r.touches[0];if(i==null)return;var o=jg(n,Sg({clientX:i.clientX,clientY:i.clientY,currentTarget:r.currentTarget}));o?.activeIndex!=null&&t.dispatch(_S({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(m5),h=(l=d.getAttribute(p5))!==null&&l!==void 0?l:void 0,f=xo(n).find(g=>g.id===h);if(u==null||f==null||h==null)return;var{dataKey:m}=f,x=yz(n,u,h);t.dispatch(wS({activeDataKey:m,activeIndex:u,activeCoordinate:x,activeGraphicalItemId:h}))}}}});var wz=M_({brush:JB,cartesianAxis:IB,chartData:bL,errorBars:K$,graphicalItems:U9,layout:oO,legend:hD,options:mL,polarAxis:t9,polarOptions:vz,referenceElements:r$,rootProps:fz,tooltip:IM,zIndex:rL}),Nz=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return OP({reducer:wz,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([BE.middleware,$E.middleware,Eg.middleware,VE.middleware,GE.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(Z_({type:"raf"}))},devTools:{serialize:{replacer:hz},name:"recharts-".concat(r)}})};function XE(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Mr(),i=p.useRef(null);if(a)return r;i.current==null&&(i.current=Nz(t,n));var o=Dp;return p.createElement(wU,{context:o,store:i.current},r)}function _z(e){var{layout:t,margin:r}=e,n=Ot(),a=Mr();return p.useEffect(()=>{a||(n(aO(t)),n(nO(r)))},[n,a,t,r]),null}var YE=p.memo(_z,u0);function qE(e){var t=Ot();return p.useEffect(()=>{t(mz(e))},[t,e]),null}function Qw(e){var{zIndex:t,isPanorama:r}=e,n=p.useRef(null),a=Ot();return p.useLayoutEffect(()=>(n.current&&a(eL({zIndex:t,element:n.current,isPanorama:r})),()=>{a(tL({zIndex:t,isPanorama:r}))}),[a,t,r]),p.createElement("g",{tabIndex:-1,ref:n})}function e2(e){var{children:t,isPanorama:r}=e,n=Fe(WF);if(!n||n.length===0)return t;var a=n.filter(o=>o<0),i=n.filter(o=>o>0);return p.createElement(p.Fragment,null,a.map(o=>p.createElement(Qw,{key:o,zIndex:o,isPanorama:r})),t,i.map(o=>p.createElement(Qw,{key:o,zIndex:o,isPanorama:r})))}var jz=["children"];function Sz(e,t){if(e==null)return{};var r,n,a=Ez(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ez(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uu.apply(null,arguments)}var Cz={width:"100%",height:"100%",display:"block"},Tz=p.forwardRef((e,t)=>{var r=y5(),n=w5(),a=I5();if(!fa(r)||!fa(n))return null;var{children:i,otherAttributes:o,title:l,desc:c}=e,d,u;return o!=null&&(typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?u=o.role:u=a?"application":void 0),p.createElement(e_,Uu({},o,{title:l,desc:c,role:u,tabIndex:d,width:r,height:n,style:Cz,ref:t}),i)}),kz=e=>{var{children:t}=e,r=Fe(Rd);if(!r)return null;var{width:n,height:a,y:i,x:o}=r;return p.createElement(e_,{width:n,height:a,x:o,y:i},t)},t2=p.forwardRef((e,t)=>{var{children:r}=e,n=Sz(e,jz),a=Mr();return a?p.createElement(kz,null,p.createElement(e2,{isPanorama:!0},r)):p.createElement(Tz,Uu({ref:t},n),p.createElement(e2,{isPanorama:!1},r))});function Az(){var e=Ot(),[t,r]=p.useState(null),n=Fe(jO);return p.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;et(i)&&i!==n&&e(sO(i))}},[t,e,n]),r}function r2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pz(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r2(Object(r),!0).forEach(function(n){Oz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oz(e,t,r){return(t=Dz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dz(e){var t=Iz(e,"string");return typeof t=="symbol"?t:t+""}function Iz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function di(){return di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},di.apply(null,arguments)}var Rz=()=>(TL(),null);function Hu(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Mz=p.forwardRef((e,t)=>{var r,n,a=p.useRef(null),[i,o]=p.useState({containerWidth:Hu((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Hu((n=e.style)===null||n===void 0?void 0:n.height)}),l=p.useCallback((d,u)=>{o(h=>{var f=Math.round(d),m=Math.round(u);return h.containerWidth===f&&h.containerHeight===m?h:{containerWidth:f,containerHeight:m}})},[]),c=p.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null&&typeof ResizeObserver<"u"){var{width:u,height:h}=d.getBoundingClientRect();l(u,h);var f=x=>{var g=x[0];if(g!=null){var{width:v,height:b}=g.contentRect;l(v,b)}},m=new ResizeObserver(f);m.observe(d),a.current=m}},[t,l]);return p.useEffect(()=>()=>{var d=a.current;d?.disconnect()},[l]),p.createElement(p.Fragment,null,p.createElement(Ol,{width:i.containerWidth,height:i.containerHeight}),p.createElement("div",di({ref:c},e)))}),Fz=p.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=p.useState({containerWidth:Hu(r),containerHeight:Hu(n)}),o=p.useCallback((c,d)=>{i(u=>{var h=Math.round(c),f=Math.round(d);return u.containerWidth===h&&u.containerHeight===f?u:{containerWidth:h,containerHeight:f}})},[]),l=p.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:d,height:u}=c.getBoundingClientRect();o(d,u)}},[t,o]);return p.createElement(p.Fragment,null,p.createElement(Ol,{width:a.containerWidth,height:a.containerHeight}),p.createElement("div",di({ref:l},e)))}),Lz=p.forwardRef((e,t)=>{var{width:r,height:n}=e;return p.createElement(p.Fragment,null,p.createElement(Ol,{width:r,height:n}),p.createElement("div",di({ref:t},e)))}),Bz=p.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?p.createElement(Fz,di({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?p.createElement(Lz,di({},e,{width:r,height:n,ref:t})):p.createElement(p.Fragment,null,p.createElement(Ol,{width:r,height:n}),p.createElement("div",di({ref:t},e)))});function $z(e){return e?Mz:Bz}var Uz=p.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:h,onMouseUp:f,onTouchEnd:m,onTouchMove:x,onTouchStart:g,style:v,width:b,responsive:w,dispatchTouchEvents:y=!0}=e,N=p.useRef(null),_=Ot(),[S,j]=p.useState(null),[E,k]=p.useState(null),T=Az(),A=Up(),C=A?.width>0?A.width:b,R=A?.height>0?A.height:a,G=p.useCallback(I=>{T(I),typeof t=="function"&&t(I),j(I),k(I),I!=null&&(N.current=I)},[T,t,j,k]),V=p.useCallback(I=>{_(LE(I)),_(Sn({handler:i,reactEvent:I}))},[_,i]),X=p.useCallback(I=>{_(Vm(I)),_(Sn({handler:d,reactEvent:I}))},[_,d]),K=p.useCallback(I=>{_(NS()),_(Sn({handler:u,reactEvent:I}))},[_,u]),Y=p.useCallback(I=>{_(Vm(I)),_(Sn({handler:h,reactEvent:I}))},[_,h]),q=p.useCallback(()=>{_(WE())},[_]),Z=p.useCallback(I=>{_(zE(I.key))},[_]),le=p.useCallback(I=>{_(Sn({handler:o,reactEvent:I}))},[_,o]),ce=p.useCallback(I=>{_(Sn({handler:l,reactEvent:I}))},[_,l]),pe=p.useCallback(I=>{_(Sn({handler:c,reactEvent:I}))},[_,c]),Ne=p.useCallback(I=>{_(Sn({handler:f,reactEvent:I}))},[_,f]),ee=p.useCallback(I=>{_(Sn({handler:g,reactEvent:I}))},[_,g]),oe=p.useCallback(I=>{y&&_(KE(I)),_(Sn({handler:x,reactEvent:I}))},[_,y,x]),he=p.useCallback(I=>{_(Sn({handler:m,reactEvent:I}))},[_,m]),O=$z(w);return p.createElement(HS.Provider,{value:S},p.createElement(hA.Provider,{value:E},p.createElement(O,{width:C??v?.width,height:R??v?.height,className:lt("recharts-wrapper",n),style:Pz({position:"relative",cursor:"default",width:C,height:R},v),onClick:V,onContextMenu:le,onDoubleClick:ce,onFocus:q,onKeyDown:Z,onMouseDown:pe,onMouseEnter:X,onMouseLeave:K,onMouseMove:Y,onMouseUp:Ne,onTouchEnd:he,onTouchMove:oe,onTouchStart:ee,ref:G},p.createElement(Rz,null),r)))}),Hz=["width","height","responsive","children","className","style","compact","title","desc"];function zz(e,t){if(e==null)return{};var r,n,a=Wz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Wz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZE=p.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:o,style:l,compact:c,title:d,desc:u}=e,h=zz(e,Hz),f=bn(h);return c?p.createElement(p.Fragment,null,p.createElement(Ol,{width:r,height:n}),p.createElement(t2,{otherAttributes:f,title:d,desc:u},i)):p.createElement(Uz,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},p.createElement(t2,{otherAttributes:f,title:d,desc:u,ref:t},p.createElement(a$,null,i)))});function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Km.apply(null,arguments)}var Vz={top:5,right:5,bottom:5,left:5},Kz={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Vz,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},JE=p.forwardRef(function(t,r){var n,a=hr(t.categoricalChartProps,Kz),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:d}=t,u={chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return p.createElement(XE,{preloadedState:{options:u},reduxStoreName:(n=d.id)!==null&&n!==void 0?n:i},p.createElement(vE,{chartData:d.data}),p.createElement(YE,{layout:a.layout,margin:a.margin}),p.createElement(qE,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),p.createElement(ZE,Km({},a,{ref:r})))}),Gz=["axis"],Xz=p.forwardRef((e,t)=>p.createElement(JE,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Gz,tooltipPayloadSearcher:ng,categoricalChartProps:e,ref:t})),Yz=["axis","item"],qz=p.forwardRef((e,t)=>p.createElement(JE,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Yz,tooltipPayloadSearcher:ng,categoricalChartProps:e,ref:t}));function Zz(e){var t=Ot();return p.useEffect(()=>{t(gz(e))},[t,e]),null}var Jz=["layout"];function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gm.apply(null,arguments)}function Qz(e,t){if(e==null)return{};var r,n,a=eW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tW={top:5,right:5,bottom:5,left:5},QE={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:tW,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},rW=p.forwardRef(function(t,r){var n,a=hr(t.categoricalChartProps,QE),{layout:i}=a,o=Qz(a,Jz),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u}=t,h={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return p.createElement(XE,{preloadedState:{options:h},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},p.createElement(vE,{chartData:a.data}),p.createElement(YE,{layout:i,margin:a.margin}),p.createElement(qE,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),p.createElement(Zz,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),p.createElement(ZE,Gm({},o,{ref:r})))});function n2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function a2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n2(Object(r),!0).forEach(function(n){nW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nW(e,t,r){return(t=aW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aW(e){var t=iW(e,"string");return typeof t=="symbol"?t:t+""}function iW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sW=["item"],oW=a2(a2({},QE),{},{layout:"centric",startAngle:0,endAngle:360}),lW=p.forwardRef((e,t)=>{var r=hr(e,oW);return p.createElement(rW,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:sW,tooltipPayloadSearcher:ng,categoricalChartProps:r,ref:t})});const en={UNPAID:"Chưa Thanh Toán",PROCESSING:"Đang Xử Lý",PAID:"Đã Thanh Toán",REFUNDED:"Đã Hoàn",PENDING_REFUND:"Chờ Hoàn",EXPIRED:"Hết Hạn",RENEWAL:"Cần Gia Hạn"},It={idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status"},Es={orderCode:"id_order",paidDate:"payment_date",amount:"amount",receiver:"receiver",note:"note",sender:"sender"},lf={id:"id",sourceName:"supplier_name"},cf={sourceId:"supplier_id",price:"price"},Ht={code:"id_product",packageName:"package",variantName:"package_product",pctCtv:"pct_ctv",pctKhach:"pct_khach",pctPromo:"pct_promo",isActive:"is_active",updatedAt:"update"},cW=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},za=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),a=String(r.getUTCMonth()+1).padStart(2,"0"),i=r.getUTCFullYear();return`${n}/${a}/${i}`},e4=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,a,i]=e.split("/").map(Number),o=new Date(i,a-1,n);return o.setMonth(o.getMonth()+t),o.setDate(o.getDate()-1),`${String(o.getDate()).padStart(2,"0")}/${String(o.getMonth()+1).padStart(2,"0")}/${o.getFullYear()}`},uW=(e,t)=>{const[r,n,a]=e.split("/").map(Number),[i,o,l]=t.split("/").map(Number),c=new Date(a,n-1,r),d=new Date(l,o-1,i),u=1440*60*1e3;return Math.floor((d.getTime()-c.getTime())/u)+1},i2=e=>String(e).padStart(2,"0"),Cg=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[a,i,o]=t.split("/").map(Number);return!a||!i||!o?null:new Date(o,i-1,a)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,o]=r.map(Number);return!o||!i||!a?null:new Date(a,i-1,o)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},yt=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,o]=r;return`${o}/${i}/${a}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,a,i,o]=n;return`${o}/${i}/${a}`}}const t=Cg(e);return t?`${i2(t.getDate())}/${i2(t.getMonth()+1)}/${t.getFullYear()}`:""},dW=e=>{const t=Cg(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},t4=e=>{const t=Cg(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},zu=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},hW=e=>{if(!Number.isFinite(e)||e<=0)return 0;const t=Math.floor(e/12),r=e%12;return t*365+r*30},r4=e=>{const t=Number(e);return Number.isFinite(t)?t:0},On=e=>{const t=r4(e),r=1e3;return Number.isFinite(t)?Math.round(t/r)*r:0},An=e=>`${On(e).toLocaleString("vi-VN")} ₫`,s2=e=>{const t=r4(e);return t>0?t.toLocaleString("vi-VN"):""},n4=e=>{const t=e.replace(/[^\d]/g,"");if(!t)return"";const r=parseInt(t,10);return isNaN(r)?"":r.toLocaleString("vi-VN").replace(/,/g,".")},fW=e=>{let t=e.replace(/,/g,".");t=t.replace(/[^\d.]/g,"");const r=t.split(".");return r.length>2&&(t=r[0]+"."+r.slice(1).join("")),t},mW=e=>!Number.isFinite(e)||e<=0?"₫0":e>=1e9?`₫${(e/1e9).toFixed(1)}B`:e>=1e6?`₫${(e/1e6).toFixed(1)}M`:e>=1e3?`₫${(e/1e3).toFixed(1)}K`:`₫${Math.round(e).toLocaleString("vi-VN")}`,pW=(e,t,r=[])=>{const n=e||"";if(!n)return;const a=r.find(l=>(l[lf.sourceName]||l.name||"")===n)?.[lf.id]??null;if(a!==null){const c=t.find(d=>d[cf.sourceId]===a)?.[cf.price];if(Number.isFinite(c))return Number(c)}const o=t.find(l=>(l[lf.sourceName]||"")===n)?.[cf.price];return Number.isFinite(o)?Number(o):void 0},o2=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),a4=e=>i4(e).color,l2=e=>i4(e).priority,xW={[en.EXPIRED]:{color:"bg-red-600 text-white",priority:1},[en.RENEWAL]:{color:"bg-orange-500 text-white",priority:2},[en.UNPAID]:{color:"bg-yellow-500 text-slate-900",priority:3},[en.PROCESSING]:{color:"bg-sky-500 text-white",priority:4},[en.PAID]:{color:"bg-green-600 text-white",priority:5},[en.PENDING_REFUND]:{color:"bg-rose-500 text-white",priority:6},[en.REFUNDED]:{color:"bg-slate-600 text-white",priority:7}},i4=e=>xW[e?.trim()]||{color:"bg-slate-600 text-white",priority:5},d0=({accountNumber:e,bankCode:t,amount:r,description:n,accountName:a})=>{const i=(e||"").trim(),o=(t||"").trim();if(!i||!o)return"";const l=new URLSearchParams,c=Number(r);Number.isFinite(c)&&c>0&&l.set("amount",Math.round(c).toString());const d=(n||"").trim();d&&l.set("addInfo",d);const u=(a||"").trim();u&&l.set("accountName",u);const h=l.toString();return`https://img.vietqr.io/image/${o}-${i}-compact.png${h?`?${h}`:""}`},s4=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},gW=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,a]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(null),h=async g=>{if(g.preventDefault(),u(null),!n.trim()){u("Vui lòng nhập tên mục tiêu");return}const v=Number(i.replace(/\./g,""));if(!v||v<=0){u("Số tiền mục tiêu phải lớn hơn 0");return}c(!0);try{const b=await fetch("/api/saving-goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({goal_name:n.trim(),target_amount:v})});if(!b.ok){const w=await b.json();throw new Error(w.error||"Không thể tạo mục tiêu")}a(""),o(""),r(),t()}catch(b){u(b instanceof Error?b.message:"Lỗi không xác định")}finally{c(!1)}},f=g=>{o(n4(g))},m=i;if(!e)return null;const x=s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:s.jsxs("div",{className:"relative w-full max-w-md mx-4 rounded-3xl bg-gradient-to-br from-slate-900 to-slate-950 border border-white/10 p-6 shadow-2xl",children:[s.jsx("button",{onClick:t,className:"absolute right-4 top-4 rounded-full p-2 text-white/60 hover:bg-white/10 hover:text-white transition-colors",children:s.jsx(Pt,{className:"h-5 w-5"})}),s.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Thêm Mục Tiêu Mới"}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"goalName",className:"block text-sm font-medium text-white/80 mb-2",children:"Tên mục tiêu"}),s.jsx("input",{id:"goalName",type:"text",value:n,onChange:g=>a(g.target.value),placeholder:"Ví dụ: Laptop mới, Du lịch...",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:l})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"targetAmount",className:"block text-sm font-medium text-white/80 mb-2",children:"Số tiền mục tiêu"}),s.jsx("input",{id:"targetAmount",type:"text",value:m,onChange:g=>f(g.target.value),placeholder:"0",className:"w-full rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-white placeholder-white/40 focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50",disabled:l})]}),d&&s.jsx("div",{className:"rounded-lg bg-red-500/10 border border-red-500/20 px-4 py-3 text-sm text-red-400",children:d}),s.jsxs("div",{className:"flex gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:t,className:"flex-1 rounded-xl border border-white/20 bg-white/5 px-4 py-3 text-sm font-semibold text-white hover:bg-white/10 transition-colors",disabled:l,children:"Hủy"}),s.jsx("button",{type:"submit",className:"flex-1 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-3 text-sm font-semibold text-white hover:from-indigo-500 hover:to-purple-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?"Đang lưu...":"Thêm mục tiêu"})]})]})]})});return lT.createPortal(x,document.body)},Xm="app-notification",br=e=>{typeof window>"u"||window.dispatchEvent(new CustomEvent(Xm,{detail:e}))},bc=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],vW=({budgets:e,walletColumns:t,walletRows:r,currencyFormatter:n,goldValue:a})=>{const i=r?.[0],o=p.useMemo(()=>{const d=a&&a>0?[{name:"Vàng (quy VND)",value:a,color:"#FBBF24"}]:[];if(i){const u=t.filter(h=>{const f=String(h.assetCode||"").trim().toUpperCase();return!(String(h.name||"").toLowerCase().includes("hana")||f&&f!=="VND")}).map((h,f)=>({name:h.name||h.field,value:Math.max(0,Number(i.values[h.field]||0)),color:bc[f%bc.length]})).filter(h=>h.value>0);if(u.length)return[...u,...d]}return[...e.map((u,h)=>({name:u.name,value:Math.max(0,u.used),color:bc[h%bc.length]})).filter(u=>u.value>0),...d]},[e,t,i,a]),l=p.useMemo(()=>o.reduce((d,u)=>d+u.value,0),[o]),c=({payload:d})=>{if(!d||d.length===0)return null;const u=d[0],h=Number(u?.value||0),f=l>0?Math.round(h/l*100):0;return s.jsxs("div",{className:"rounded-lg border border-white/10 bg-slate-900/90 px-3 py-2 text-xs text-white shadow-lg",children:[s.jsx("div",{className:"font-semibold",children:u?.name}),s.jsx("div",{children:n.format(h)}),s.jsxs("div",{className:"text-white/70",children:[f,"%"]})]})};return s.jsxs("div",{className:"relative h-72 w-full",children:[s.jsx("div",{className:"absolute inset-0 rounded-2xl border border-white/20 bg-gradient-to-br from-indigo-900 via-slate-900 to-slate-950 shadow-inner shadow-slate-900/50"}),s.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center text-white/70",children:o.length===0?s.jsx("div",{className:"text-sm",children:"Chưa có dữ liệu chi tiêu"}):s.jsxs(s.Fragment,{children:[s.jsx(Hp,{width:"100%",height:"100%",children:s.jsxs(lW,{children:[s.jsx(pE,{data:o,dataKey:"value",nameKey:"name",innerRadius:75,outerRadius:100,children:o.map((d,u)=>s.jsx(Gl,{fill:d.color,stroke:"transparent"},`${d.name}-${u}`))}),s.jsx(ag,{content:c})]})}),l>0&&s.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center text-white",children:[s.jsx("div",{className:"text-xs uppercase tracking-wide text-white/80",children:"Tài sản"}),s.jsx("div",{className:"text-lg font-bold",children:n.format(l)})]})})]})})]})},yc=({title:e,value:t,change:r,icon:n})=>{const a=r>=0,i=a?bp:vp;return s.jsxs("div",{className:"bg-gradient-to-br from-indigo-950/80 to-purple-950/60 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:border-white/20 transition-all duration-300",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("div",{className:"p-2 bg-white/5 rounded-lg border border-white/10",children:s.jsx(n,{className:"h-5 w-5 text-indigo-400"})}),s.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold ${a?"bg-emerald-500/20 text-emerald-400":"bg-rose-500/20 text-rose-400"}`,children:[s.jsx(i,{className:"h-3 w-3"}),Math.abs(r),"%"]})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("p",{className:"text-2xl font-bold text-white",children:t}),s.jsx("p",{className:"text-xs text-white/60",children:e})]})]})},bW=({budgets:e,savingGoals:t,currencyFormatter:r,walletColumns:n,walletRows:a,goldValue:i,goldCost:o,onRefetchGoals:l})=>{const[c,d]=p.useState(!1),u=async(g,v)=>{const b=t.find(N=>N.id===g);if(!b)return;const w=v==="down"?(b.priority||0)+1:(b.priority||0)-1,y=t.find(N=>N.id!==g&&N.priority===w);try{const N=[];if(N.push(fetch(`/api/saving-goals/${b.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:w})})),y){const _=v==="down"?y.priority-1:y.priority+1;N.push(fetch(`/api/saving-goals/${y.id}/priority`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({priority:_})}))}await Promise.all(N),l&&l()}catch(N){console.error("Error reordering goal:",N);const{handleNetworkError:_}=await Xc(async()=>{const{handleNetworkError:S}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:S}},[]);br({type:"error",title:"Lỗi sắp xếp mục tiêu",message:_(N)})}},h=async g=>{if(confirm("Bạn có chắc muốn xóa mục tiêu này?"))try{if(!(await fetch(`/api/saving-goals/${g}`,{method:"DELETE"})).ok)throw new Error("Failed to delete goal");l&&l()}catch(v){console.error("Error deleting goal:",v);const{handleNetworkError:b}=await Xc(async()=>{const{handleNetworkError:w}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:w}},[]);br({type:"error",title:"Lỗi xóa mục tiêu",message:b(v)})}},f=p.useMemo(()=>{const g=a?.[0];let v=0;if(g){const _=n.find(S=>{const j=String(S.name||"").toLowerCase();return j.includes("quỹ")||j.includes("quy")});_&&(v=Number(g.values[_.field]||0)||0)}const b=t.reduce((_,S)=>_+(Number(S.target_amount)||0),0),w=v,y=Math.max(0,b-w),N=b>0?w/b*100:0;return{totalSaved:w,totalTarget:b,totalRemaining:y,progress:Math.min(100,Math.max(0,N))}},[t,a,n]),m=p.useMemo(()=>{if(f.totalTarget<=0)return[];let g=0;return t.map((v,b)=>{g+=Number(v.target_amount)||0;const w=g/f.totalTarget*100,y=Math.min(100,Math.max(0,w));return{index:b+1,position:y}})},[t,f.totalTarget]),x=p.useMemo(()=>{const g=a?.[0],v=a?.[1],b=_=>{if(!_)return{cash:0,gold:0,investment:0,total:0};const S=n.find(C=>{const R=String(C.name||"").toLowerCase();return R.includes("quỹ")||R.includes("quy")}),j=n.find(C=>{const R=String(C.name||"").toLowerCase();return R.includes("vàng")||R.includes("gold")||R.includes("vang")}),k=n.filter(C=>{const R=String(C.assetCode||"").trim().toUpperCase(),G=String(C.name||"").toLowerCase();return G.includes("hana")||G.includes("gold")||G.includes("vàng")||G.includes("vang")||S&&C.field===S.field?!1:!R||R==="VND"}).reduce((C,R)=>C+(Number(_.values[R.field]||0)||0),0),T=S&&Number(_.values[S.field]||0)||0,A=j&&Number(_.values[j.field]||0)||0;return{cash:k,gold:A,investment:T,total:k+A+T}},w=b(g),y=b(v);i!=null&&(w.gold=i,w.total=w.cash+w.gold+w.investment);const N=(_,S)=>S===0?_>0?100:0:Number(((_-S)/S*100).toFixed(1));if(o&&w.gold>0){w.total=w.cash+w.gold+w.investment;const _=Number(((w.gold-o)/o*100).toFixed(1));return{current:w,changes:{cash:N(w.cash,y.cash),gold:_,investment:N(w.investment,y.investment),total:N(w.total,y.total)}}}return{current:w,changes:{cash:N(w.cash,y.cash),gold:N(w.gold,y.gold),investment:N(w.investment,y.investment),total:N(w.total,y.total)}}},[a,n,i,o]);return s.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[s.jsxs("div",{className:"rounded-3xl bg-white/70 p-6 space-y-6 shadow-xl",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiêu hàng tháng"}),s.jsx("p",{className:"text-xs text-white/70",children:"Tổng quan tháng hiện tại"})]}),s.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-indigo-500/30 px-3 py-1 text-xs font-semibold text-white shadow-inner shadow-indigo-900/30",children:[s.jsx(nv,{className:"h-4 w-4"}),s.jsx("span",{children:"Đang theo dõi"})]})]}),s.jsx(vW,{budgets:e,walletColumns:n,walletRows:a,currencyFormatter:r,goldValue:i}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(yc,{title:"Tiền Mặt",value:r.format(x.current.cash),change:x.changes.cash,icon:WN}),s.jsx(yc,{title:"Vàng",value:r.format(x.current.gold),change:x.changes.gold,icon:Wk}),s.jsx(yc,{title:"Đầu Tư",value:r.format(x.current.investment),change:x.changes.investment,icon:Jo}),s.jsx(yc,{title:"Tổng Tài Sản",value:r.format(x.current.total),change:x.changes.total,icon:Dk})]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"space-y-4 rounded-3xl bg-white/70 p-5 shadow-xl",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Mục tiêu tiết kiệm"}),s.jsx("p",{className:"text-xs text-white/70",children:"Theo dõi tiến độ theo từng hàng mục"})]}),s.jsx(nv,{className:"h-5 w-5 text-white/70"})]}),s.jsxs("div",{className:"rounded-2xl border border-white/30 bg-white/60 p-4 shadow-[0_16px_32px_-28px_rgba(0,0,0,0.4)]",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wide text-white/80",children:"Tổng quan"}),s.jsx("p",{className:"text-2xl font-semibold text-white",children:r.format(f.totalSaved)}),s.jsxs("p",{className:"text-xs text-white/70",children:[r.format(f.totalTarget)," mục tiêu : ",t.length," hạng mục"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-white/60",children:"Còn lại"}),s.jsx("p",{className:"text-sm font-semibold text-white",children:r.format(f.totalRemaining)})]})]}),s.jsxs("div",{className:"mt-3 relative h-6",children:[s.jsx("div",{className:"absolute inset-x-0 top-1/2 h-2 -translate-y-1/2 overflow-hidden rounded-full bg-white/20",children:s.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-amber-300 via-rose-300 to-emerald-200 shadow-[0_0_14px_rgba(251,191,36,0.55)]",style:{width:`${f.progress}%`}})}),m.map(g=>s.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:`${g.position}%`},children:s.jsx("div",{className:"flex h-5 w-5 items-center justify-center rounded-full border border-white/70 bg-slate-900/90 text-[11px] font-semibold text-white shadow-[0_8px_16px_-12px_rgba(0,0,0,0.55)]",children:g.index})},`milestone-${g.index}`))]}),s.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[s.jsxs("span",{children:[f.progress.toFixed(2),"%"]}),s.jsxs("span",{children:["Đã đạt ",r.format(f.totalSaved)]})]})]}),s.jsx("div",{className:"space-y-3",children:t.length===0?s.jsx("div",{className:"rounded-2xl border border-dashed border-white/40 bg-white/40 px-4 py-3 text-xs text-white/70",children:"Chưa có mục tiêu tiết kiệm nào."}):t.map((g,v)=>{const b=Number(g.target_amount)||0,w=f.totalSaved,y=b>0?Math.min(100,w/b*100):0,N=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],_=N[v%N.length];return s.jsxs("div",{className:"rounded-2xl border border-white/35 bg-white/60 p-3 shadow-[0_12px_28px_-26px_rgba(0,0,0,0.35)]",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-white/20 text-[11px] font-semibold text-white/80",children:v+1}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:g.goal_name}),s.jsxs("p",{className:"text-xs text-white/75",children:[r.format(w)," / ",r.format(b)]})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>u(g.id,"up"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Tăng ưu tiên",children:s.jsx(Jo,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>u(g.id,"down"),className:"rounded-lg p-1.5 text-white/60 hover:bg-white/10 hover:text-white transition-colors",title:"Giảm ưu tiên",children:s.jsx(vp,{className:"h-4 w-4"})}),s.jsx("div",{className:"h-4 w-px bg-white/20 mx-0.5"}),s.jsx("button",{onClick:()=>h(g.id),className:"rounded-lg p-1.5 text-white/60 hover:bg-red-400/80 hover:text-white transition-colors",title:"Xóa mục tiêu",children:s.jsx(Xr,{className:"h-4 w-4"})})]})]}),s.jsx("div",{className:"mt-3 h-2 overflow-hidden rounded-full bg-white/20",children:s.jsx("div",{className:"h-full rounded-full",style:{width:`${y}%`,background:`linear-gradient(90deg, ${_}, rgba(255,255,255,0.85))`}})}),s.jsxs("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/70",children:[s.jsxs("span",{children:[y.toFixed(2),"%"]}),s.jsxs("span",{children:["Đã đạt ",r.format(w)]})]})]},g.id)})}),s.jsx("button",{type:"button",onClick:()=>d(!0),className:"w-full rounded-xl border border-white/30 bg-slate-900/80 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-24px_rgba(0,0,0,0.45)] transition-colors hover:bg-slate-900",children:"Thêm mục tiêu mới"})]})}),s.jsx(gW,{isOpen:c,onClose:()=>d(!1),onSuccess:()=>{l&&l()}})]})},yW=({labels:e,totalWallet5:t,currencyFormatter:r,adding:n,onToggleAdd:a})=>s.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:e.title}),t!==null&&s.jsxs("p",{className:"text-xs text-white/70",children:[e.totalWallet5Label," ",r.format(t)]})]}),s.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-lg border border-white/20 bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20",children:[n?s.jsx(Pt,{className:"h-4 w-4"}):s.jsx(Ra,{className:"h-4 w-4"}),n?e.closeLabel:e.addLabel]})]}),wW=({displayColumns:e,rows:t,adding:r,newDate:n,newValues:a,loading:i,onDateChange:o,onValueChange:l,onSave:c,onCancel:d,formatDate:u,formatValue:h,resolveValue:f,labels:m})=>s.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:s.jsxs("table",{className:"min-w-full text-sm text-white",children:[s.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-center",children:m.dateHeader}),e.map(x=>s.jsx("th",{className:"px-3 py-2 text-center",children:x.name||x.field},x.field))]})}),s.jsxs("tbody",{className:"divide-y divide-white/10",children:[r&&s.jsxs(s.Fragment,{children:[s.jsxs("tr",{className:"bg-white/5",children:[s.jsx("td",{className:"px-3 py-2 text-center",children:s.jsx("input",{type:"date",className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:n,onChange:x=>o(x.target.value)})}),e.map(x=>x.sourceFields&&x.sourceFields.length?s.jsx("td",{className:"px-3 py-2 text-center whitespace-pre-line",children:s.jsx("div",{className:"flex flex-col gap-1",children:x.sourceFields.map(g=>s.jsx("input",{className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white text-center focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all placeholder:text-white/20",placeholder:g,value:a[g]||"",onChange:v=>l(g,v.target.value)},g))})},x.field):s.jsx("td",{className:"px-3 py-2 text-center",children:s.jsx("input",{className:"w-full rounded-md border border-white/10 bg-white/5 px-2 py-1 text-xs text-white text-center focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all placeholder:text-white/20",placeholder:"0",value:a[x.field]||"",onChange:g=>l(x.field,g.target.value)})},x.field))]}),s.jsx("tr",{className:"bg-white/5",children:s.jsx("td",{className:"px-3 py-2 text-center",colSpan:e.length+1,children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("button",{type:"button",className:"rounded-md bg-emerald-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-emerald-600",onClick:c,children:m.saveLabel}),s.jsx("button",{type:"button",className:"rounded-md bg-rose-500 px-4 py-1.5 text-xs font-semibold text-white hover:bg-rose-600",onClick:d,children:m.cancelLabel})]})})})]}),i&&s.jsx("tr",{children:s.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:m.loadingText})}),!i&&t.length===0&&s.jsx("tr",{children:s.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:e.length+1,children:m.emptyText})}),!i&&t.map((x,g)=>s.jsxs("tr",{className:"hover:bg-white/5",children:[s.jsx("td",{className:"px-3 py-2 text-center font-semibold",children:u(x.recordDate)}),e.map(v=>{const b=f(x,v);if(Array.isArray(b)){const w=b.map(N=>N.value?h(N.value,N.assetCode||v.assetCode):null).filter(Boolean),y=w.length?w.join(`
`):"-";return s.jsx("td",{className:"px-3 py-2 text-center text-white/90 whitespace-pre-line",children:y},v.field)}return s.jsx("td",{className:"px-3 py-2 text-center text-white/90",children:h(b,v.assetCode)},v.field)})]},`${x.recordDate}-${g}`))]})]})}),NW=e=>yt(new Date(e))||e,_W=e=>{const t=i=>(i||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),r=e.filter(i=>{const o=t(i.name||i.field||"");return o.includes("hana")||o.includes("gold")||o.includes("vang")}),n=e.filter(i=>!r.includes(i));if(!r.length)return e;const a=Array.from(new Set(r.map(i=>(i.assetCode||"").toUpperCase()).filter(Boolean)));return[...n,{id:0,field:"wallet_gold_combined",name:"HanaGold / Vang",assetCode:a.length===1?a[0]:void 0,sourceFields:r.map(i=>i.field)}]},jW=e=>{const t={};return e.forEach(r=>{t[r.field]=r.assetCode}),t},SW=e=>{const[t,r]=String(e).split("."),n=t.replace(/\B(?=(\d{3})+(?!\d))/g,".");return r?`${n}.${r}`:n},EW=(e,t,r)=>e?(t||"").toUpperCase()==="VND"?r.format(e):SW(e):"-",CW=(e,t,r)=>t.sourceFields&&t.sourceFields.length?t.sourceFields.map(n=>({field:n,value:Number(e.values[n]||0)||0,assetCode:r[n]})):Number(e.values[t.field]||0),TW={title:"Dòng tiền theo ngày",totalWallet5Label:"Tổng ID 5:",addLabel:"Thêm",closeLabel:"Đóng"},kW={dateHeader:"Ngày",saveLabel:"Lưu",cancelLabel:"Hủy",loadingText:"Đang tải dữ liệu...",emptyText:"Chưa có dữ liệu dòng tiền."},AW=({columns:e,rows:t,loading:r,error:n,onRefresh:a,currencyFormatter:i})=>{const o=p.useMemo(()=>_W(e),[e]),l=p.useMemo(()=>jW(e),[e]),[c,d]=p.useState(!1),[u,h]=p.useState(""),[f,m]=p.useState({}),x=p.useMemo(()=>e.find(S=>S.id===5)?.field||null,[e]),g=p.useMemo(()=>x?t.reduce((S,j)=>S+(Number(j.values[x]||0)||0),0):null,[t,x]),v=p.useCallback((S,j)=>EW(S,j,i),[i]),b=p.useCallback((S,j)=>CW(S,j,l),[l]),w=p.useCallback((S,j)=>{const E=e.find(T=>T.field===S),k=!E?.assetCode||E.assetCode.toUpperCase()==="VND";m(T=>({...T,[S]:k?n4(j):fW(j)}))},[e]),y=p.useCallback(()=>{d(!1),h(""),m({})},[]),N=async()=>{const S=u||yt(new Date)||"";if(!S)return;const j={};e.forEach(E=>{const k=f[E.field]||"",A=!E.assetCode||E.assetCode.toUpperCase()==="VND"?k.replace(/\./g,""):k,C=Number(A||0);A&&(j[E.field]=Number.isFinite(C)?C:0)});try{await Ue("/api/wallets/daily-balances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordDate:S,values:j})}),y(),a()}catch(E){console.error("Failed to save wallet balances:",E)}},_=p.useCallback(()=>{const S=new Date,j=S.getFullYear(),E=String(S.getMonth()+1).padStart(2,"0"),k=String(S.getDate()).padStart(2,"0");h(`${j}-${E}-${k}`),d(T=>!T)},[]);return s.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/60 to-slate-900/65 p-5 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.7)]",children:[s.jsx(yW,{labels:TW,totalWallet5:g,currencyFormatter:i,adding:c,onToggleAdd:_}),n&&s.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/50 bg-amber-50/10 px-3 py-2 text-xs text-amber-200",children:n}),s.jsx(wW,{displayColumns:o,rows:t,adding:c,newDate:u,newValues:f,loading:r,onDateChange:h,onValueChange:w,onSave:N,onCancel:y,formatDate:NW,formatValue:v,resolveValue:b,labels:kW})]})},PW=({financeSummary:e,budgets:t,savingGoals:r,currencyFormatter:n,goldRows:a,goldLoading:i,goldError:o,onRefreshGold:l,latestGoldBid:c,walletColumns:d,walletRows:u,walletLoading:h,walletError:f,onRefreshWallets:m,onRefetchGoals:x})=>{const g=d.find(E=>(E.assetCode||"").toUpperCase()!=="VND"&&/vàng|gold|hana/i.test(E.name))?.field||d.find(E=>(E.assetCode||"").toUpperCase()!=="VND")?.field||d.find(E=>E.id===7)?.field||null,v=d.find(E=>(E.assetCode||"").toUpperCase()==="VND"&&/hana|vàng|gold/i.test(E.name))?.field||d.find(E=>E.id===5)?.field||null,b=g&&u.length>0?u.reduce((E,k)=>E+(Number(k.values[g]||0)||0),0):0,w=v&&u.length>0?u.reduce((E,k)=>E+(Number(k.values[v]||0)||0),0):null,y=c?c/10:null;a.length&&Number(a[0]?.ask||0);const N=y?b*y:null,_=w!==null?w:y?b*y:null,S=N!==null&&_!==null?N-_:N??null,j=a.map((E,k)=>k===0?{...E,totalGoldAmount:b,totalGoldValue:_??void 0,profit:S??void 0}:E);return s.jsxs("div",{className:"space-y-6 rounded-[32px] bg-white/5 border border-white/10 p-6 shadow-[0_24px_60px_-34px_rgba(0,0,0,0.7)] backdrop-blur",children:[s.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:e.map(E=>s.jsx(Jk,{...E},E.title))}),s.jsx(Qk,{loading:i,error:o,rows:j,onRefresh:l}),s.jsx(bW,{budgets:t,savingGoals:r,currencyFormatter:n,walletColumns:d,walletRows:u,goldValue:N,goldCost:_,onRefetchGoals:x}),s.jsx(AW,{columns:d,rows:u,loading:h,error:f,onRefresh:m,currencyFormatter:n,goldPrice:c})]})},wr={sky:{border:"border-sky-500/30",glow:"bg-sky-500/20",iconBg:"bg-sky-500 text-white shadow-[0_0_15px_rgba(14,165,233,0.5)]"},emerald:{border:"border-emerald-500/30",glow:"bg-emerald-500/20",iconBg:"bg-emerald-500 text-white shadow-[0_0_15px_rgba(16,185,129,0.5)]"},violet:{border:"border-violet-500/30",glow:"bg-violet-500/20",iconBg:"bg-violet-500 text-white shadow-[0_0_15px_rgba(139,92,246,0.5)]"},amber:{border:"border-amber-500/30",glow:"bg-amber-500/20",iconBg:"bg-amber-500 text-white shadow-[0_0_15px_rgba(245,158,11,0.5)]"},rose:{border:"border-rose-500/30",glow:"bg-rose-500/20",iconBg:"bg-rose-500 text-white shadow-[0_0_15px_rgba(244,63,94,0.5)]"},indigo:{border:"border-indigo-500/30",glow:"bg-indigo-500/20",iconBg:"bg-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.5)]"},slate:{border:"border-slate-500/30",glow:"bg-slate-500/20",iconBg:"bg-slate-500 text-white shadow-[0_0_15px_rgba(100,116,139,0.5)]"},teal:{border:"border-teal-500/30",glow:"bg-teal-500/20",iconBg:"bg-teal-500 text-white shadow-[0_0_15px_rgba(20,184,166,0.5)]"}},Ca=({title:e,value:t,icon:r,accent:n,subtitle:a,children:i})=>s.jsxs("div",{className:`stat-card group relative isolate overflow-hidden rounded-[24px] glass-panel p-4 sm:p-5 transition-all duration-500 holographic-hover z-10 ${n.border}`,children:[s.jsx("div",{className:`stat-card__glow absolute -right-12 -top-12 h-32 w-32 rounded-full blur-[60px] opacity-10 transition-opacity group-hover:opacity-25 ${n.glow}`}),s.jsxs("div",{className:"stat-card__content flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"stat-card__text relative z-10",children:[s.jsx("p",{className:"stat-card__title text-[10px] sm:text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80 leading-none mb-1.5",children:e}),s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("h3",{className:"stat-card__value text-xl sm:text-2xl font-bold text-white tracking-tight leading-none",children:t}),a&&s.jsx("p",{className:"text-[10px] sm:text-xs font-medium text-emerald-400/80 tracking-wide",children:a})]})]}),s.jsxs("div",{className:`stat-card__icon relative flex h-11 w-11 shrink-0 items-center justify-center rounded-xl border border-white/10 overflow-hidden transform transition-all duration-500 group-hover:rotate-[10deg] group-hover:scale-110 ${n.iconBg}`,children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent pointer-events-none"}),s.jsx(r,{className:"h-5 w-5 relative z-10"})]})]}),i&&s.jsx("div",{className:"mt-6 relative z-10 animate-in fade-in slide-in-from-bottom-2 duration-700",children:i})]}),OW=({stats:e})=>s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 sm:p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsx("div",{className:"grid grid-cols-1 gap-3 sm:gap-4 sm:grid-cols-2 lg:grid-cols-4",children:e.map((t,r)=>s.jsx(Ca,{title:t.name,value:t.value,icon:t.icon,accent:wr[t.accent],children:s.jsx("div",{className:`flex items-center text-sm font-semibold ${t.changeType==="increase"?"text-emerald-200":t.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:t.changeType==="alert"?s.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):t.changeType==="increase"?s.jsxs(s.Fragment,{children:[s.jsx(Jo,{className:"mr-1 h-4 w-4"}),t.change]}):s.jsxs(s.Fragment,{children:[s.jsx(gp,{className:"mr-1 h-4 w-4"}),t.change]})})},`${t.name}-${r}`))})}),DW=({data:e,availableYears:t,selectedYear:r,onYearChange:n})=>{const a=An;return s.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[s.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Doanh thu theo tháng"}),s.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-white/80 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:r,onChange:i=>n(Number(i.target.value)),children:t.length===0?s.jsx("option",{value:r,children:r}):t.map(i=>s.jsx("option",{value:i,children:i},i))})]}),s.jsx("div",{className:"w-full",children:s.jsx(Hp,{width:"100%",height:320,children:s.jsxs(Xz,{data:e,children:[s.jsx(bg,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),s.jsx(Ng,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),s.jsx(_g,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:i=>`${Math.round(i/1e6)}M`}),s.jsx(ag,{formatter:i=>[a(i),"Doanh thu"],labelStyle:{color:"#111827"}}),s.jsx(OE,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]})},IW=({data:e})=>s.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[s.jsx("h3",{className:"mb-6 text-lg font-semibold text-white",children:"Tổng đơn và đơn hủy theo tháng"}),s.jsx("div",{className:"w-full",children:s.jsx(Hp,{width:"100%",height:320,children:s.jsxs(qz,{data:e,children:[s.jsx(bg,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),s.jsx(Ng,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),s.jsx(_g,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),s.jsx(ag,{formatter:(t,r,n)=>[t,n?.dataKey==="total_orders"?"Tổng đơn":"Đơn hủy"],labelStyle:{color:"#111827"}}),s.jsx($m,{dataKey:"total_orders",name:"Tổng đơn",fill:"#3b82f6",radius:[4,4,0,0]}),s.jsx($m,{dataKey:"total_canceled",name:"Đơn hủy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]}),RW=({stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i})=>s.jsxs("div",{className:"overview-section",children:[s.jsx(OW,{stats:e}),s.jsxs("div",{className:"overview-section__charts grid grid-cols-1 gap-4 sm:gap-6 md:grid-cols-1 xl:grid-cols-2",children:[s.jsx(DW,{data:t,availableYears:n,selectedYear:a,onYearChange:i}),s.jsx(IW,{data:r})]})]}),MW=[{key:"overview",label:"Tổng quan"},{key:"finance",label:"Chi tiêu & Ngân sách"}],FW=({activeSection:e,onChange:t})=>s.jsx("div",{className:"w-full flex p-1.5 rounded-[28px] glass-panel-light border border-white/5 shadow-2xl relative z-10 transition-all duration-300",children:s.jsx("div",{className:"flex-1 grid grid-cols-2 gap-2",children:MW.map(r=>{const n=e===r.key;return s.jsx("button",{onClick:()=>t(r.key),className:`w-full rounded-[22px] px-6 py-4 text-sm font-black uppercase tracking-[0.15em] transition-all duration-500 relative overflow-hidden ${n?"text-white shadow-[0_0_30px_rgba(99,102,241,0.3)] bg-indigo-600/40 border border-indigo-400/30":"text-indigo-100/50 hover:text-white/80 hover:bg-white/5 border border-transparent"}`,children:r.label},r.key)})})}),LW=()=>s.jsxs("div",{className:"dashboard-hero relative group overflow-hidden rounded-[32px] glass-panel-light p-8 lg:p-10 transition-all duration-700 holographic-hover",children:[s.jsx("div",{className:"dashboard-hero__glow dashboard-hero__glow--right absolute -right-20 -top-20 w-96 h-96 bg-indigo-500/10 rounded-full blur-[100px] animate-pulse"}),s.jsx("div",{className:"dashboard-hero__glow dashboard-hero__glow--left absolute -left-20 -bottom-20 w-96 h-96 bg-purple-500/10 rounded-full blur-[100px] animate-pulse [animation-delay:2s]"}),s.jsx("div",{className:"dashboard-hero__content relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:s.jsxs("div",{className:"dashboard-hero__text space-y-2",children:[s.jsxs("h1",{className:"dashboard-hero__title text-4xl lg:text-5xl font-bold text-white tracking-tighter",children:["Bảng Điều ",s.jsx("span",{className:"text-indigo-400",children:"Khiển"})]}),s.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Digital Control Hub & Analysis"})]})})]}),BW=[],$W=[{name:"Nha cua & Tien ich",used:315e4,total:45e5},{name:"Thuc pham & Thiet yeu",used:226e4,total:45e5},{name:"Cham soc ca nhan",used:189e4,total:45e5},{name:"Phu kien",used:152e4,total:45e5}],UW=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),HW=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",Kr=(e,t={})=>{const{fallback:r="Đã xảy ra lỗi. Vui lòng thử lại sau.",blockPatterns:n}=t,a=HW(e);return!a||Array.isArray(n)&&n.some(i=>i.test(a))?r:a},zW=An,o4=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",l4=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,uf=(e,t,r,n)=>{const a=Number.isFinite(Number(t))?Number(t):0,i=Number.isFinite(Number(r))?Number(r):0,o=n?zW(a):a.toLocaleString("vi-VN"),l=l4(a,i);return{name:e,value:o,change:o4(l),changeType:l>=0?"increase":"decrease",accent:"sky"}},WW=e=>[{...uf("Tổng đơn hàng",e.totalOrders.current,e.totalOrders.previous,!1),icon:gd,accent:"sky"},{name:"Đơn sắp hết hạn",value:e.overdueOrders.count.toLocaleString("vi-VN"),change:"Cần xử lý",changeType:"alert",icon:VN,accent:"rose"},{...uf("Tổng nhập hàng",e.totalImports.current,e.totalImports.previous,!0),icon:zN,accent:"amber"},{...uf("Tổng lợi nhuận",e.totalProfit.current,e.totalProfit.previous,!0),icon:KN,accent:"emerald"}],VW=()=>{const e=p.useMemo(()=>new Date().getFullYear(),[]),t=p.useMemo(()=>new Date().getMonth()+1,[]),[r,n]=p.useState([]),[a,i]=p.useState([]),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,h]=p.useState(e),[f,m]=p.useState(!0),[x,g]=p.useState(null),v=p.useCallback(async b=>{m(!0),g(null);try{const w=await Ue("/api/dashboard/stats");if(!w.ok){const j=await w.text();throw new Error(Kr(j,{fallback:"Không thể tải thống kê tổng quan."}))}const y=await w.json();n(WW(y));const N=await NT(b);i(N.revenueData),l(N.orderStatusData);const _=b===e?t:12,S=N.orderStatusData.filter((j,E)=>E<_&&Number.isFinite(Number(j.total_orders)));if(S.length>=2){const j=Number(S[S.length-1].total_orders)||0,E=Number(S[S.length-2].total_orders)||0,k=l4(j,E);n(T=>T.map((A,C)=>C===0?{...A,change:o4(k),changeType:k>=0?"increase":"decrease"}:A))}}catch(w){console.error("Lỗi khi lấy dữ liệu dashboard:",w),g(w instanceof Error?Kr(w.message,{fallback:"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau."}):"Đã có lỗi khi tải dữ liệu dashboard. Vui lòng thử lại sau.")}finally{m(!1)}},[]);return p.useEffect(()=>{let b=!1;return(async()=>{try{const y=await _T(),N=y.length?y:[e];b||(d(N),h(_=>N.includes(_)?_:N[0]??e))}catch(y){console.error("Failed to load available years:",y),b||(g(y instanceof Error?Kr(y.message,{fallback:"Không thể tải năm dữ liệu dashboard."}):"Không thể tải năm dữ liệu dashboard."),m(!1))}})(),()=>{b=!0}},[e]),p.useEffect(()=>{v(u)},[u,v]),{statsData:r,revenueChartData:a,orderChartData:o,availableYears:c,selectedYear:u,setSelectedYear:h,loading:f,errorMessage:x}},KW=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),o=p.useCallback(async()=>{n(!0),i(null);try{const d=await fetch("https://api.hanagold.vn/app/setting/get-chart-gold");if(!d.ok)throw new Error(`HTTP ${d.status}`);const u=await d.json();if(!u||u.signal!==1||!Array.isArray(u.data))throw new Error("Dữ liệu không hợp lệ");const h=[];u.data.forEach(f=>{const m=f?.time??"";(Array.isArray(f?.data)?f.data:[]).forEach(g=>{(Array.isArray(g?.main_gold_price)?g.main_gold_price:[]).forEach(b=>{const w=Number(b?.ask??NaN),y=Number(b?.bid??NaN);if(!Number.isFinite(w)||!Number.isFinite(y))return;const N=w*1e6,_=y*1e6;h.push({time:m,group:g?.name??"",displayName:b?.display_name??b?.name??"",ask:N,bid:_,trendAsk:b?.trend?.ask,trendBid:b?.trend?.bid})})})}),t(h)}catch(c){console.error("Lỗi khi lấy giá vàng HanaGold:",c),i(c instanceof Error?c.message:"Không thể lấy dữ liệu giá vàng.")}finally{n(!1)}},[]),l=p.useMemo(()=>{if(!e.length)return[];const c=e.filter(u=>{const h=`${u.displayName||""}`.toLowerCase(),f=`${u.group||""}`.toLowerCase();return h.includes("kim kh")||h.includes("kht")||f.includes("kim kh")});if(!c.length)return[];const d=c[c.length-1]?.time||"";return c.filter(u=>u.time===d)},[e]);return{goldPrices:e,goldLoading:r,goldError:a,fetchGoldPrices:o,selectedGoldRows:l}},GW=()=>{const[e,t]=p.useState([]),[r,n]=p.useState([]),[a,i]=p.useState(!1),[o,l]=p.useState(null),c=p.useCallback(async()=>{i(!0),l(null);try{const u=await Ue("/api/wallets/daily-balances");if(!u.ok)throw new Error(`HTTP ${u.status}`);const h=await u.json();t(Array.isArray(h?.wallets)?h.wallets:[]),n(Array.isArray(h?.rows)?h.rows:[])}catch(u){console.error("Failed to fetch wallet balances:",u),l("Không thể tải dữ liệu dòng tiền từ cơ sở dữ liệu.")}finally{i(!1)}},[]);return p.useEffect(()=>{c()},[c]),{walletColumns:p.useMemo(()=>[...e].sort((u,h)=>u.id-h.id),[e]),walletRows:r,walletLoading:a,walletError:o,fetchWalletBalances:c}},XW=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(0),[a,i]=p.useState(!0),[o,l]=p.useState(null),c=p.useCallback(async()=>{try{i(!0),l(null);const d=await Ue("/api/saving-goals");if(!d.ok)throw new Error("Không thể tải danh sách mục tiêu");const u=await d.json();t(u.goals||[]),n(u.totalTarget||0)}catch(d){console.error("Error fetching saving goals:",d),l(d instanceof Error?d.message:"Lỗi không xác định"),t([]),n(0)}finally{i(!1)}},[]);return p.useEffect(()=>{c()},[c]),{goals:e,totalTarget:r,loading:a,error:o,refetch:c}},YW=()=>{const{statsData:e,revenueChartData:t,orderChartData:r,availableYears:n,selectedYear:a,setSelectedYear:i,loading:o,errorMessage:l}=VW(),{goldLoading:c,goldError:d,selectedGoldRows:u,fetchGoldPrices:h}=KW(),{walletColumns:f,walletRows:m,walletLoading:x,walletError:g,fetchWalletBalances:v}=GW(),{goals:b,refetch:w}=XW(),[y,N]=p.useState("overview"),_=u.length&&Number(u[0]?.bid||0)||null;return p.useEffect(()=>{h()},[h]),o?s.jsx("div",{className:"py-10 text-center",children:s.jsx("p",{className:"text-lg font-medium text-white/80",children:"Đang tải dữ liệu dashboard..."})}):s.jsxs("div",{className:"dashboard space-y-6",children:[s.jsx(LW,{}),s.jsx(FW,{activeSection:y,onChange:N}),l&&s.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:l}),y==="overview"&&s.jsx(RW,{stats:e,revenueData:t,orderData:r,availableYears:n,selectedYear:a,onYearChange:i}),y==="finance"&&s.jsx(PW,{financeSummary:BW,budgets:$W,savingGoals:b,currencyFormatter:UW,goldRows:u,goldLoading:c,goldError:d,onRefreshGold:h,latestGoldBid:_,walletColumns:f,walletRows:m,walletLoading:x,walletError:g,onRefreshWallets:v,onRefetchGoals:w})]})},qW={ID_ORDER:It.idOrder,ID_PRODUCT:It.idProduct,INFORMATION_ORDER:It.informationOrder,CUSTOMER:It.customer,CONTACT:It.contact,SLOT:It.slot,ORDER_DATE:It.orderDate,DAYS:It.days,ORDER_EXPIRED:It.orderExpired,SUPPLY:It.supply,COST:It.cost,PRICE:It.price,NOTE:It.note,STATUS:It.status,REFUND:It.refund},Je={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},H=qW,st={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},wt={COLLABORATOR:"MAVC",RETAIL:"MAVL",PROMO:"MAVK",GIFT:"MAVT",IMPORT:"MAVN",STUDENT:"MAVS"},c4=wt.COLLABORATOR,ZW=[{value:wt.COLLABORATOR,label:"Cộng Tác Viên"},{value:wt.STUDENT,label:"Sinh Viên"},{value:wt.RETAIL,label:"Khách Lẻ"},{value:wt.PROMO,label:"Khuyến Mãi"},{value:wt.GIFT,label:"Quà Tặng"},{value:wt.IMPORT,label:"Nhập Hàng"}],rt={ORDER_EXPIRED:en.EXPIRED,CAN_GIA_HAN:en.RENEWAL,CHUA_THANH_TOAN:en.UNPAID,DANG_XU_LY:en.PROCESSING,DA_THANH_TOAN:en.PAID,CHO_HOAN:en.PENDING_REFUND,DA_HOAN:en.REFUNDED},u4={active:{label:"Đơn Hàng",description:"Danh sách đơn đang hoạt động",endpoint:Je.ORDERS},expired:{label:"Hết Hạn",description:"Danh sách các đơn hàng đã hết hạn",endpoint:Je.ORDERS_EXPIRED},canceled:{label:"Hoàn Tiền",description:"Đơn đã hủy/hoàn tiền",endpoint:Je.ORDERS_CANCELED}},JW=["active","expired","canceled"],wc=[{name:"Tổng Đơn Hàng",value:"0",icon:Vi,accent:wr.sky},{name:"Cần Gia Hạn",value:"0",icon:wp,accent:wr.amber},{name:"Hết Hạn",value:"0",icon:gp,accent:wr.rose},{name:"Đăng Ký Hôm Nay",value:"0",icon:Jo,accent:wr.emerald}],QW=[{value:"all",label:"Tất cả cột"},{value:H.ID_ORDER,label:"Mã Đơn Hàng"},{value:H.ID_PRODUCT,label:"Sản Phẩm"},{value:H.INFORMATION_ORDER,label:"Thông tin"},{value:H.CUSTOMER,label:"Khách Hàng"},{value:H.SLOT,label:"Slot"},{value:H.SUPPLY,label:"Nguồn"}],eV="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",tV="opacity-60 cursor-not-allowed shadow-none pointer-events-none",nn=ua.forwardRef(({icon:e,className:t="",disabled:r,children:n,...a},i)=>s.jsxs("button",{ref:i,className:`${eV} ${r?tV:"hover:-translate-y-0.5"} ${t}`,disabled:r,...a,children:[e&&s.jsx(e,{className:"h-4 w-4"}),s.jsx("span",{className:"font-semibold",children:n})]}));nn.displayName="GradientButton";const d4=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,secondaryMessage:i,confirmLabel:o="OK",cancelLabel:l="Hủy",isSubmitting:c=!1})=>e?s.jsx("div",{className:"confirm-modal fixed inset-0 z-70 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:s.jsxs("div",{className:"confirm-modal__container w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[s.jsx("h3",{className:"confirm-modal__title text-lg font-semibold leading-6 text-white mb-2",children:n}),s.jsxs("div",{className:"confirm-modal__body mb-4",children:[s.jsx("p",{className:"confirm-modal__message text-sm text-white/90",children:a}),i?s.jsx("p",{className:"mt-2 text-sm font-semibold text-rose-300",children:i}):null]}),s.jsxs("div",{className:"confirm-modal__actions flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:t,disabled:c,className:"confirm-modal__btn confirm-modal__btn--cancel px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:l}),s.jsx("button",{type:"button",onClick:r,disabled:c,className:"confirm-modal__btn confirm-modal__btn--confirm px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:c?"Đang Xử Lý...":o})]})]})}):null,rV="VPB",c2="9183400998",u2="NGO LE NGOC HUNG",nV=({isOpen:e,orderId:t,productName:r,customerType:n,basePrice:a,normalizedOrderDate:i,skipRecalc:o=!1})=>{const[l,c]=p.useState(null),[d,u]=p.useState(!1),[h,f]=p.useState(null);return p.useEffect(()=>{if(!e||!t||!r){c(null),u(!1),f(null);return}let m=!1;if(c(a),o){u(!1),f(null);return}const x={san_pham_name:r,id_product:r,id_order:t};return i&&(x.order_date=i),n&&(x.customer_type=n),(async()=>{try{u(!0),f(null);const v=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),{data:b,rawText:w}=await s4(v);if(!v.ok){const N=b?.error||w||`Server responded with ${v.status}`;throw new Error(N)}const y=b??{};if(!m){const N=Number(y.price??y.gia_ban);c(Number.isFinite(N)&&N>=0?N:a)}}catch(v){console.error("Lỗi khi tính lại giá đơn hàng:",v),m||(f("Không thể tính lại giá đơn hàng. Đang hiển thị giá hiện có."),c(a))}finally{m||u(!1)}})(),()=>{m=!0}},[a,n,e,i,t,r,o]),{calculatedPrice:l,priceLoading:d,priceError:h}},d2=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,h2=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},aV=({isOpen:e,onClose:t,order:r,formatCurrency:n,keepOrderPrice:a=!1})=>{const i=r?.[H.ID_ORDER],o=r?.[H.ID_PRODUCT],l=Number(r?.[H.PRICE])||0,c=r?.[H.SUPPLY]||"",d=r?.customer_type||c||"",u=r?.registration_date||r?.[H.ORDER_DATE]||"",h=cW(yt(u)||u)||null,{calculatedPrice:f,priceLoading:m,priceError:x}=nV({isOpen:e,orderId:i,productName:o,customerType:d,basePrice:l,normalizedOrderDate:h,skipRecalc:a}),g=p.useMemo(()=>Math.max(0,Number(r?.[H.PRICE])||0),[r]),b=On(a?g:f??g);if(!e||!r)return null;const w=String(r[st.TRANG_THAI_TEXT]||r.trangThaiText||r[H.STATUS]||"").trim()||"Chưa Thanh Toán",y=r[st.SO_NGAY_CON_LAI]!==void 0&&r[st.SO_NGAY_CON_LAI]!==null?Number(r[st.SO_NGAY_CON_LAI]):null,N=h2(r.so_ngay_con_lai),_=d2(r.expiry_date||r.expiry_date_display||r[st.EXPIRY_DATE_DISPLAY]||r[H.ORDER_EXPIRED]),S=t4(_)??h2(r[H.DAYS]),j=y!==null&&Number.isFinite(y)?y:N??S??0,E=d2(r.registration_date_display||r[st.ORDER_DATE_DISPLAY]||r.registration_date||r[H.ORDER_DATE]),k=(r.registration_date_display||r[st.ORDER_DATE_DISPLAY]||yt(E)||String(r[H.ORDER_DATE]||""))??"",T=r.expiry_date_display||r[st.EXPIRY_DATE_DISPLAY]||yt(_)||String(r[H.ORDER_EXPIRED]||""),A=String(r[H.ID_ORDER]||""),C=On(g),R=d0({accountNumber:c2,bankCode:rV,amount:C,description:A,accountName:u2});return s.jsx("div",{className:"view-order-modal fixed inset-0 z-70 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 p-2 sm:p-4 md:p-6",onClick:t,children:s.jsxs("div",{className:"view-order-modal__container bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[98vh] sm:max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:G=>G.stopPropagation(),children:[s.jsxs("div",{className:"view-order-modal__header flex justify-center items-center p-3 sm:p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[s.jsxs("h3",{className:"view-order-modal__title text-lg sm:text-xl font-semibold text-white",children:["Chi tiết đơn hàng:"," ",s.jsx("span",{className:"text-blue-600",children:r[H.ID_ORDER]})]}),s.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Pt,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"view-order-modal__body p-3 sm:p-6 overflow-y-auto flex-grow space-y-4 sm:space-y-5 text-gray-700",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-xs sm:text-sm",children:[s.jsxs("dl",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID Đơn:"}),s.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[H.ID_ORDER]})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sản Phẩm:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.ID_PRODUCT]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 mb-1 sm:mb-0",children:"Thông Tin Sản Phẩm:"}),s.jsx("dd",{className:"text-slate-100 w-full sm:w-2/3 text-left sm:text-right break-words",children:r[H.INFORMATION_ORDER]})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.SLOT]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 mb-1 sm:mb-0",children:"Ghi Chú:"}),s.jsx("dd",{className:"text-slate-100 w-full sm:w-2/3 text-left sm:text-right break-words",children:r[H.NOTE]||"-"})]}),s.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trạng Thái:"}),s.jsx("dd",{className:"w-2/3 text-right",children:s.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${a4(w)}`,children:w})})]})]}),s.jsxs("dl",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khách Hàng:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.CUSTOMER]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between border-b pb-1 items-start",children:[s.jsx("dt",{className:"font-medium text-slate-400 sm:w-1/3 shrink-0 mb-1 sm:mb-0",children:"Liên Hệ:"}),s.jsx("dd",{className:"w-full sm:w-2/3 text-left sm:text-right break-all",children:s.jsx("a",{href:r[H.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[H.CONTACT]||"-"})})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Order:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:k})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[H.DAYS]})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngày Hết Hạn:"}),s.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:T})]}),s.jsxs("div",{className:"flex justify-between border-b pb-1",children:[s.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Số Ngày Còn Lại:"}),s.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:j})]})]})]}),s.jsx("hr",{className:"my-4 border-white/10"}),s.jsxs("div",{className:"view-order-modal__qr text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[s.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Quét mã QR để thanh toán (VietQR)"}),R?s.jsx("div",{className:"flex justify-center mb-3",children:s.jsx("img",{src:R,alt:`QR Code thanh toán ${r[H.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40 w-full max-w-[240px] sm:max-w-[280px] h-auto",width:280,height:280})}):s.jsx("p",{className:"text-red-600 font-medium",children:"Không thể tạo mã QR. Vui lòng kiểm tra lại cấu hình"}),s.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[s.jsxs("p",{children:["Ngân hàng: ",s.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),s.jsxs("p",{children:["Số tài khoản: ",s.jsx("strong",{className:"text-indigo-100",children:c2})]}),s.jsxs("p",{children:["Chủ tài khoản: ",s.jsx("strong",{className:"text-indigo-100",children:u2})]}),s.jsxs("p",{children:["Số tiền:"," ",s.jsx("strong",{className:"text-xl text-red-600",children:n(a?C:b)})]}),!a&&m&&s.jsx("p",{className:"text-xs text-slate-400",children:"Đang tính lại giá..."}),x&&s.jsx("p",{className:"text-xs text-red-500",children:x}),s.jsxs("p",{children:["Nội dung: ",s.jsx("strong",{className:"text-indigo-200",children:A})," ","(Vui lòng điền đúng)"]})]})]})]})]})})},f2=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",m2=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,Ko=e=>(e?.supplier_name??e?.source_name??e?.name??"").trim(),p2=Cl,iV=(e,t)=>{const[r,n]=p.useState(null),[a,i]=p.useState([]),[o,l]=p.useState([]),c=p.useRef(e),[d,u]=p.useState(!1),h=p.useCallback(()=>{const N=c.current?.[H.SUPPLY]||"";return N.trim()?{id:-1,supplier_name:N,source_name:N}:null},[]),f=p.useCallback(N=>{const _=h();return _&&!N.some(j=>Ko(j)===Ko(_))?[_,...N]:N},[h]),m=p.useCallback(async N=>{if(!N){const _=f([]);return i(_),_}try{const _=await fetch(`${p2}${Je.SUPPLIES_BY_PRODUCT(N)}`,{credentials:"include"});if(!_.ok)throw new Error("Lỗi tải danh sách nguồn.");const S=await _.json(),j=f(S);return i(j),j}catch(_){console.error("Lỗi khi fetch supplies cho sản phẩm:",_);const S=f([]);return i(S),S}},[f]),x=p.useCallback(async N=>{if(!N)return l([]),[];try{const _=await fetch(`${p2}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(N)}`,{credentials:"include"});if(!_.ok)throw new Error("Lỗi tải danh sách giá nguồn.");const S=await _.json();return l(S),S}catch(_){return console.error("Lỗi khi fetch giá nguồn cho sản phẩm:",_),l([]),[]}},[]);p.useEffect(()=>{if(t&&e){const N={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(N),c.current=N,i(S=>f(S));const _=e.id_product;_&&(m(_),x(_)),u(!1)}else t||(n(null),i([]),l([]),u(!1))},[t,e,m,x,f]),p.useEffect(()=>{if(!t||!r?.id_product)return;const N=r.id_product;m(N),x(N)},[t,r?.id_product,m,x]);const g=p.useCallback((N,_)=>{n(S=>S&&{...S,[N]:_})},[]),v=p.useCallback(N=>{const _=a.find(k=>k.id===N),S=Ko(_)||r?.[H.SUPPLY]||"";u(!1),g(H.SUPPLY,S||"");const j=pW(S,o,a)??o.find(k=>k.source_id===N)?.price??null,E=Number(j);if(Number.isFinite(E))g(H.COST,E);else if(c.current){const k=Number(c.current[H.COST]||0);g(H.COST,k)}},[r,g,a,o]),b=p.useCallback(N=>{u(!0),g(H.SUPPLY,N)},[g]),w=p.useCallback(()=>{u(N=>{const _=!N;return _||g(H.SUPPLY,""),_})},[g]),y=p.useCallback(()=>{n(c.current);const N=c.current?.id_product;N&&(m(N),x(N))},[m,x]);return{formData:r,supplies:a,isCustomSupply:d,supplyPrices:o,handleSupplySelect:v,resetForm:y,setFieldValue:g,handleCustomSupplyChange:b,toggleCustomSupply:w}},Lr="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",Zr="block text-sm font-medium text-slate-100 mb-1",Qn="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",sV=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:a,supplies:i,isCustomSupply:o,handleSupplySelect:l,resetForm:c,setFieldValue:d,handleCustomSupplyChange:u,toggleCustomSupply:h}=iV(r,e),[f,m]=p.useState(!1),x=_=>a?String(a[_]??""):"",g=_=>a&&Number(a[_]??0)||0,v=p.useCallback(_=>{const S=_.target,{name:j,value:E}=S,k=S instanceof HTMLInputElement&&S.type==="checkbox"?S.checked:E;d(j,k)},[d]),b=p.useMemo(()=>{if(!a)return"";const _=i.find(S=>Ko(S)===a[H.SUPPLY]);return _?String(_.id):""},[a,i]),w=p.useMemo(()=>{if(!a)return"";const _=m2(a.registration_date_display||a.registration_date||a[H.ORDER_DATE]);return yt(_)||String(_||"")},[a]),y=p.useMemo(()=>{if(!a)return"";const _=m2(a.expiry_date_display||a.expiry_date||a[H.ORDER_EXPIRED]);return yt(_)||String(_||"")},[a]),N=async _=>{if(_.preventDefault(),!!a){m(!0);try{await n(a)}finally{m(!1)}}};return!e||!a?null:s.jsx("div",{className:"edit-order-shell fixed inset-0 z-70 flex items-center justify-center bg-black/55 backdrop-blur-lg p-2 sm:p-4 md:p-6",children:s.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[s.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-4 sm:px-6 py-3 sm:py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-100",children:"Chỉnh sửa đơn hàng"}),s.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"Đóng",children:s.jsx(Pt,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:N,className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Mã đơn hàng"}),s.jsx("input",{type:"text",name:H.ID_ORDER,value:x(H.ID_ORDER),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Khách hàng"}),s.jsx("input",{type:"text",name:H.CUSTOMER,value:x(H.CUSTOMER),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Liên hệ"}),s.jsx("input",{type:"text",name:H.CONTACT,value:x(H.CONTACT),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Slot"}),s.jsx("input",{type:"text",name:H.SLOT,value:x(H.SLOT),onChange:v,className:Lr})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Sản phẩm"}),s.jsx("input",{type:"text",name:H.ID_PRODUCT,value:x(H.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Nguồn"}),s.jsxs("div",{className:"flex items-center gap-2",children:[o?s.jsx("input",{type:"text",name:H.SUPPLY,value:x(H.SUPPLY),onChange:_=>u(_.target.value),className:Lr,placeholder:"Nhập nguồn mới"}):s.jsxs("select",{name:H.SUPPLY,value:b,onChange:_=>l(Number(_.target.value)),className:Lr,children:[s.jsx("option",{value:"",children:"-- Giữ nguyên hoặc chọn --"}),i.map(_=>s.jsx("option",{value:_.id,children:Ko(_)},_.id))]}),s.jsx("button",{type:"button",onClick:h,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${o?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":o?"Tắt nhập nguồn mới":"Nhập nguồn mới",children:o?s.jsx(GN,{className:"h-6 w-6","aria-hidden":"true"}):s.jsx(Np,{className:"h-6 w-6","aria-hidden":"true"})})]}),!i.length&&!o&&s.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Không có danh sách nguồn cho sản phẩm hiện tại."})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Thông tin đơn hàng"}),s.jsx("input",{type:"text",name:H.INFORMATION_ORDER,value:x(H.INFORMATION_ORDER),onChange:v,className:Lr})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Ngày đăng ký"}),s.jsx("input",{type:"text",name:H.ORDER_DATE,value:w,readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Số ngày"}),s.jsx("input",{type:"text",name:H.DAYS,value:x(H.DAYS),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Ngày hết hạn"}),s.jsx("input",{type:"text",name:H.ORDER_EXPIRED,value:y,readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Giá nhập"}),s.jsx("input",{type:"text",name:H.COST,value:f2(g(H.COST)),readOnly:!0,disabled:!0,className:`${Lr} ${Qn} font-semibold`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Giá bán"}),s.jsx("input",{type:"text",name:H.PRICE,value:f2(g(H.PRICE)),readOnly:!0,disabled:!0,className:`${Lr} ${Qn} font-semibold text-emerald-300`})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Trạng thái"}),s.jsx("input",{type:"text",name:H.STATUS,value:x(H.STATUS),readOnly:!0,disabled:!0,className:`${Lr} ${Qn}`})]})}),s.jsxs("div",{children:[s.jsx("label",{className:Zr,children:"Ghi chú"}),s.jsx("textarea",{name:H.NOTE,value:x(H.NOTE),rows:4,onChange:v,className:Lr})]}),s.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[s.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hoàn tác"}),s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Đóng"}),s.jsx("button",{type:"submit",disabled:f,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${f?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:f?"Đang lưu...":"Lưu thay đổi"})]})]})]})})},Ym=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},pl=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),a=parseInt(r[1],10),i=parseInt(r[2],10),o=new Date(i,a-1,n);o.setDate(o.getDate()+t-1);const l=String(o.getDate()).padStart(2,"0"),c=String(o.getMonth()+1).padStart(2,"0"),d=o.getFullYear();return`${l}/${c}/${d}`},h4={[H.ID_ORDER]:"",[H.ID_PRODUCT]:"",[H.INFORMATION_ORDER]:"",[H.CUSTOMER]:"",[H.CONTACT]:"",[H.SLOT]:"",[H.ORDER_DATE]:"",[H.DAYS]:"0",[H.ORDER_EXPIRED]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.NOTE]:"",[H.STATUS]:rt.CHUA_THANH_TOAN},pr="w-full transition-all",Sr="block text-[11px] font-black uppercase tracking-[0.15em] text-indigo-300/80 mb-2 px-1",Fo="opacity-60 cursor-not-allowed bg-indigo-500/5",x2=({name:e,value:t,options:r,placeholder:n,disabled:a,onChange:i,onClear:o})=>{const l=p.useRef(null),[c,d]=p.useState(!1),[u,h]=p.useState(""),f=p.useMemo(()=>{const x=r.find(g=>g.value===t);return x?x.label:""},[r,t]);p.useEffect(()=>{h(f)},[f]);const m=p.useMemo(()=>{const x=(u||"").toLowerCase().trim();return x?r.filter(g=>g.label.toLowerCase().includes(x)):r},[r,u]);return p.useEffect(()=>{const x=g=>{l.current&&(l.current.contains(g.target)||d(!1))};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),s.jsxs("div",{ref:l,className:"relative",children:[s.jsx("input",{name:e,type:"text",value:u,onChange:x=>{const g=x.target.value;h(g),g===""&&o?.(),c||d(!0)},onFocus:()=>d(!0),disabled:a,placeholder:n,className:`${pr} pr-8`,autoComplete:"off"}),!!u&&o&&!a&&s.jsx("button",{type:"button",onMouseDown:x=>{x.preventDefault(),h(""),o(),d(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:"×"}),c&&!a&&s.jsx("div",{className:"absolute z-20 mt-2 w-full glass-panel-dark border-white/10 shadow-2xl max-h-60 overflow-auto animate-in fade-in slide-in-from-top-2 duration-200",children:m.length===0?s.jsx("div",{className:"px-4 py-3 text-sm text-indigo-300/60 italic",children:"Không có kết quả"}):m.map(x=>s.jsx("div",{className:`px-4 py-2.5 text-sm cursor-pointer transition-colors hover:bg-indigo-500/20 active:bg-indigo-500/30 ${x.value===t?"bg-indigo-500/10 text-indigo-300":"text-slate-200"}`,onMouseDown:g=>{g.preventDefault(),h(x.label),d(!1),i(x.value,x)},children:x.label},`${String(x.value)}-${x.label}`))})]})},oV=e=>{const[t,r]=p.useState(h4),[n,a]=p.useState(e),[i,o]=p.useState(null),[l,c]=p.useState(!1),d=p.useCallback(u=>{r(h=>({...h,...u}))},[]);return{formData:t,setFormData:r,customerType:n,setCustomerType:a,selectedSupplyId:i,setSelectedSupplyId:o,customProductTouched:l,setCustomProductTouched:c,updateForm:d}},lV=({isOpen:e,customerType:t,setCustomerType:r,setFormData:n,setIsDataLoaded:a,setSelectedSupplyId:i,setSupplies:o,setSupplyPrices:l,setCustomProductTouched:c,fetchProducts:d,fetchAllSupplies:u})=>{const h=p.useMemo(()=>t+o2(5),[t]);p.useEffect(()=>{if(!e)return;const f=c4,m=f+o2(5),x=za();r(f),n({...h4,[H.ID_ORDER]:m,[H.ORDER_DATE]:x,[H.ORDER_EXPIRED]:x}),a(!1),i(null),o([]),l([]),c(!1),d(),u()},[u,d,e,r,n,a,i,o,l,c]),p.useEffect(()=>{e&&n(f=>({...f,[H.ID_ORDER]:h}))},[h,e,n])},cV=({infoValue:e,infoRef:t,productName:r,orderId:n,registerDate:a,selectedSupplyId:i,customMode:o,customerType:l,recalcPrice:c})=>{p.useEffect(()=>{t.current=e||""},[e,t]),p.useEffect(()=>{if(!r||!n||!a||o)return;const d=i??0;c(d,r,n,a,void 0,{updateCost:!!d})},[l,c,r,n,a,i,o])},uV=({formData:e,isLoading:t,updateForm:r,onSave:n})=>({handleSubmit:p.useCallback(i=>{if(i.preventDefault(),e&&e[H.ID_PRODUCT]&&e[H.SUPPLY]&&e[H.CUSTOMER]&&e[H.INFORMATION_ORDER]&&!t){const l=yt(e[H.ORDER_DATE])||e[H.ORDER_DATE]||za(),c=yt(e[H.ORDER_EXPIRED])||e[H.ORDER_EXPIRED]||"",d=Number(e[H.DAYS]||0)||0;let u=c;if(!u&&l&&d>0){const x=pl(l,d);x&&x!=="N/A"&&(u=x,r({[H.ORDER_EXPIRED]:u}))}const h=Ym(l),f=u?Ym(u):h,m={...e,[H.COST]:Number(e[H.COST]),[H.PRICE]:Number(e[H.PRICE]),[H.ORDER_DATE]:h,[H.ORDER_EXPIRED]:f,[H.CONTACT]:e[H.CONTACT]||null,[H.SLOT]:e[H.SLOT]||null,[H.NOTE]:e[H.NOTE]||null};return n(m),!0}return br({type:"error",title:"Thiếu thông tin",message:"Vui lòng điền đầy đủ các thông tin."}),!1},[e,t,n,r])}),dV=({customerType:e,setFormData:t,productName:r})=>{const[n,a]=p.useState(!1),[i,o]=p.useState(!1),l=p.useRef(""),c=p.useRef(0),d=p.useRef(null);p.useEffect(()=>()=>{d.current?.abort()},[]);const u=p.useCallback(async(m,x,g,v)=>{const b=c.current+1;c.current=b,d.current&&d.current.abort();const w=new AbortController;d.current=w,a(!0),o(!1);try{const y=Ym(v)||v||null,N=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supply_id:m,san_pham_name:x,id_product:x,id_order:g,order_date:y,customer_type:e}),signal:w.signal}),{data:_,rawText:S}=await s4(N);if(b!==c.current)return;if(!N.ok){const C=_?.error||S||"Lỗi tính giá từ Server.";throw new Error(C)}if(!_)throw new Error("Phản hồi không hợp lệ từ server.");const j=_||{},E=yt(v)||v||za(),k={cost:Math.max(0,Number(j.gia_nhap??j.cost??0)||0),price:Math.max(0,Number(j.gia_ban??j.price??0)||0),days:Number(j.so_ngay_da_dang_ki??j.days??0)||0,order_expired:""},T=(j.order_expired??j.het_han??"").trim(),A=yt(T)||T||(k.days>0?pl(E,k.days):"");return k.order_expired=A,k}catch(y){if(y?.name==="AbortError")return;console.error("Lỗi khi tính giá:",y),o(!1),br({type:"error",title:"Lỗi tính giá",message:`Tính giá thất bại: ${y instanceof Error?y.message:"Lỗi không xác định"}`});return}finally{b===c.current&&a(!1)}},[e]),h=p.useCallback((m,x,g,v)=>{if(!m)return;const b=yt(x)||x||za();let w=Number(m.days||0)||0,y=m.order_expired||(w>0?pl(b,w):"");const N=zu(v?.infoOverride||"")||zu((v?.productNameOverride||r||"").toString());if(N>0){const _=hW(N),S=e4(b,N);_>0&&(w=_,y=S)}t(_=>{const S=Number(_[H.COST]||0),j=Number.isFinite(m.cost)&&m.cost>0?m.cost:void 0,k=v?.updateCost??!0?j??Number(g??S??0):S,T=Number(_[H.PRICE]||0),A=Number.isFinite(m.price)&&m.price>0?m.price:void 0;let C=A??T??0;return e===wt.PROMO&&(C=A??k??T??0),{..._,[H.COST]:k,[H.PRICE]:C,[H.DAYS]:w>0?String(w):String(_[H.DAYS]||"0"),[H.ORDER_EXPIRED]:y||_[H.ORDER_EXPIRED]||""}}),o(!0)},[e,r,t]),f=p.useCallback((m,x,g,v,b,w)=>{!x||!g||!v||u(m,x,g,v).then(y=>h(y,v,b,{...w,productNameOverride:x,infoOverride:l.current}))},[h,u]);return{isLoading:n,setIsLoading:a,isDataLoaded:i,setIsDataLoaded:o,calculatePrice:u,applyCalculationResult:h,recalcPrice:f,infoRef:l}},hV=({productName:e,orderId:t,registerDate:r,allSupplies:n,selectedSupplyId:a,customMode:i,todayDate:o,setSelectedSupplyId:l,setCustomProductTouched:c,setFormData:d,setSupplies:u,setSupplyPrices:h,setIsDataLoaded:f,fetchSuppliesByProduct:m,fetchAllSupplyPrices:x,recalcPrice:g})=>(p.useEffect(()=>{e||(l(null),d(b=>{if(!b[H.ID_PRODUCT]&&Number(b[H.PRICE]||0)===0&&String(b[H.DAYS]||"0")==="0")return b;const y=b[H.ORDER_DATE]||za();return{...b,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y}}))},[e,d,l]),{handleProductSelect:p.useCallback(b=>{const w=(b||"").trim();if(l(null),c(!1),!w){d(y=>({...y,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y[H.ORDER_DATE]||o})),u(n),h([]),f(!1);return}if(d(y=>({...y,[H.ID_PRODUCT]:w,[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:y[H.ORDER_DATE]||o})),u([]),h([]),m(w),x(w),t&&r&&!i){const y=a??0;g(y,w,t,r,void 0,{updateCost:!!y})}},[n,i,x,m,t,g,r,a,c,d,f,l,u,h,o])}),fV=300*1e3,g2=new Map,mV=e=>{const t=g2.get(e);if(t)return t;const r={ts:0};return g2.set(e,r),r},pV=e=>!!(e.data&&Date.now()-e.ts<fV),Nc=async(e,t,r=!1)=>{const n=mV(e);if(!r&&pV(n))return n.data;if(n.promise)return n.promise;const a=t().then(i=>(n.data=i,n.ts=Date.now(),n.promise=void 0,i)).catch(i=>{throw n.promise=void 0,i});return n.promise=a,a},v2=e=>e.trim(),xV=e=>{const[t,r]=p.useState([]),[n,a]=p.useState([]),[i,o]=p.useState([]),[l,c]=p.useState([]),d=p.useCallback(async(m=!1)=>{try{const x=await Nc(`products:${e}`,async()=>{const g=await fetch(`${e}${Je.PRODUCTS_ALL}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách sản phẩm.");return await g.json()},m);o(x)}catch(x){console.error("Lỗi khi fetch products:",x)}},[e]),u=p.useCallback(async(m=!1)=>{try{const x=await Nc(`supplies:${e}`,async()=>{const g=await fetch(`${e}${Je.SUPPLIES}`,{credentials:"include"});if(!g.ok)throw new Error("Lỗi tải danh sách nguồn.");return await g.json()},m);r(x),a(g=>g.length?g:x)}catch(x){console.error("Lỗi khi fetch all supplies:",x),r([])}},[e]),h=p.useCallback(async(m,x=!1)=>{const g=v2(m);if(!g){a(v=>v.length?v:t);return}try{const v=await Nc(`suppliesByProduct:${e}:${g}`,async()=>{const b=await fetch(`${e}${Je.SUPPLIES_BY_PRODUCT(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Lỗi tải danh sách nguồn.");return await b.json()},x);a(v)}catch(v){console.error("Lỗi khi fetch supplies:",v),a(t)}},[e,t]),f=p.useCallback(async(m,x=!1)=>{const g=v2(m);if(!g){c([]);return}try{const v=await Nc(`supplyPricesByProduct:${e}:${g}`,async()=>{const b=await fetch(`${e}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Lỗi tính giá nhập của nguồn.");return await b.json()},x);c(v)}catch(v){console.error("Lỗi khi fetch all supply prices:",v),c([])}},[e]);return{allSupplies:t,supplies:n,products:i,supplyPrices:l,setSupplies:a,setSupplyPrices:c,fetchProducts:d,fetchAllSupplies:u,fetchSuppliesByProduct:h,fetchAllSupplyPrices:f}},gV=({supplies:e,supplyPrices:t,formData:r,customerType:n,productName:a,orderId:i,registerDate:o,setSelectedSupplyId:l,setFormData:c,setIsDataLoaded:d,recalcPrice:u})=>{const h=p.useMemo(()=>{const g=new Map,v=new Map;for(const b of e){g.set(b.id,b);const w=b.supplier_name??b.source_name??"";w&&!v.has(w)&&v.set(w,b.id)}return{byId:g,idByName:v}},[e]),f=p.useMemo(()=>{const g=new Map,v=new Map;for(const b of t){const w=Number(b.price);if(!Number.isFinite(w))continue;g.has(b.source_id)||g.set(b.source_id,w);const y=b.supplier_name??b.source_name;y&&!v.has(y)&&v.set(y,w)}return{byId:g,byName:v}},[t]),m=p.useCallback((g,v,b)=>{if(v){const w=f.byName.get(v);if(w!==void 0&&Number.isFinite(w))return w;const y=h.idByName.get(v);if(y!==void 0){const N=f.byId.get(y);if(N!==void 0&&Number.isFinite(N))return N}}if(g!==0){const w=f.byId.get(g);if(w!==void 0&&Number.isFinite(w))return w}return b},[h.idByName,f.byId,f.byName]);return{handleSourceSelect:p.useCallback(g=>{const v=h.byId.get(g),b=Number(r[H.COST]||0),w=v?.supplier_name??v?.source_name??"",y=m(g,w,b);if(l(g===0?null:g),c(N=>{const _={...N,[H.SUPPLY]:v?w:"",[H.COST]:y};return n===wt.PROMO&&(_[H.PRICE]=y),_}),!a||!i||!o){d(!1);return}u(g,a,i,o,y,{updateCost:!0})},[n,r,m,i,a,u,o,c,d,l,h.byId])}},vV=Cl,bV=(e,t,r)=>{const{formData:n,setFormData:a,customerType:i,setCustomerType:o,selectedSupplyId:l,setSelectedSupplyId:c,customProductTouched:d,setCustomProductTouched:u,updateForm:h}=oV(c4),{allSupplies:f,supplies:m,products:x,supplyPrices:g,setSupplies:v,setSupplyPrices:b,fetchProducts:w,fetchAllSupplies:y,fetchSuppliesByProduct:N,fetchAllSupplyPrices:_}=xV(vV),S=n[H.ID_PRODUCT],j=n[H.ID_ORDER],E=n[H.ORDER_DATE],k=n[H.INFORMATION_ORDER]||"",{isLoading:T,isDataLoaded:A,setIsDataLoaded:C,recalcPrice:R,infoRef:G}=dV({customerType:i,setFormData:a,productName:S}),V=p.useMemo(()=>za(),[]);lV({isOpen:e,customerType:i,setCustomerType:o,setFormData:a,setIsDataLoaded:C,setSelectedSupplyId:c,setSupplies:v,setSupplyPrices:b,setCustomProductTouched:u,fetchProducts:w,fetchAllSupplies:y}),cV({infoValue:k,infoRef:G,productName:S,orderId:j,registerDate:E,selectedSupplyId:l,customMode:r,customerType:i,recalcPrice:R});const{handleProductSelect:X}=hV({productName:S,orderId:j,registerDate:E,allSupplies:f,selectedSupplyId:l,customMode:r,todayDate:V,setSelectedSupplyId:c,setCustomProductTouched:u,setFormData:a,setSupplies:v,setSupplyPrices:b,setIsDataLoaded:C,fetchSuppliesByProduct:N,fetchAllSupplyPrices:_,recalcPrice:R}),{handleSourceSelect:K}=gV({supplies:m,supplyPrices:g,formData:n,customerType:i,productName:S,orderId:j,registerDate:E,setSelectedSupplyId:c,setFormData:a,setIsDataLoaded:C,recalcPrice:R}),Y=le=>{const{name:ce,value:pe}=le.target;h({[ce]:pe})},q=le=>{const ce=le.target.value;o(ce),c(null),v([]),b([]),C(!1),a(pe=>({...pe,[H.ID_PRODUCT]:"",[H.SUPPLY]:"",[H.COST]:0,[H.PRICE]:0,[H.DAYS]:"0",[H.ORDER_EXPIRED]:pe[H.ORDER_DATE]||za()}))},{handleSubmit:Z}=uV({formData:n,isLoading:T,updateForm:h,onSave:t});return{formData:n,supplies:m,allSupplies:f,products:x,isLoading:T,isDataLoaded:A,selectedSupplyId:l,customerType:i,updateForm:h,setIsDataLoaded:C,customProductTouched:d,setCustomProductTouched:u,handleChange:Y,handleProductSelect:X,handleSourceSelect:K,handleCustomerTypeChange:q,handleSubmit:Z}},yV=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=p.useState(!1),{formData:i,updateForm:o,supplies:l,products:c,isLoading:d,selectedSupplyId:u,customerType:h,setIsDataLoaded:f,customProductTouched:m,setCustomProductTouched:x,handleChange:g,handleProductSelect:v,handleSourceSelect:b,handleCustomerTypeChange:w,handleSubmit:y}=bV(e,r,n),N=i[H.INFORMATION_ORDER]||"",_=i[H.ID_PRODUCT]||"",S=i[H.ORDER_DATE]||za(),j=i[H.COST],E=i[H.PRICE],k=p.useMemo(()=>i[H.ORDER_EXPIRED]||"",[i]),T=p.useMemo(()=>i[H.ORDER_DATE]||za(),[i]),A=p.useMemo(()=>Number(i[H.DAYS]||0)||0,[i]),C=p.useMemo(()=>c.map(Y=>({value:Y.san_pham,label:Y.san_pham})),[c]),R=p.useMemo(()=>l.map(Y=>({value:Y.id,label:Y.supplier_name??Y.source_name})),[l]),G=p.useCallback(Y=>q=>{const le=(q.target.value||"").replace(/\D/g,""),ce=le?parseInt(le,10):0;o({[Y]:ce})},[o]),V=p.useCallback(Y=>{const q=yt(Y.target.value)||Y.target.value||"",Z=A>0?pl(q,A):q,le={[H.ORDER_DATE]:q};Z&&Z!=="N/A"?le[H.ORDER_EXPIRED]=Z:A<=0&&q&&(le[H.ORDER_EXPIRED]=q),o(le)},[A,o]);p.useEffect(()=>{if(!n||!m)return;const Y=zu(N)||zu(_),q=S;if(Y>0){const Z=e4(q,Y),le=uW(q,Z);o({[H.DAYS]:String(le),[H.ORDER_EXPIRED]:Z})}},[n,m,N,_,S,o]),p.useEffect(()=>{if(!k)return;const Y=yt(k);if(!Y&&T&&A>0){const q=pl(T,A);q&&q!=="N/A"&&q!==k&&o({[H.ORDER_EXPIRED]:q})}else Y&&Y!==k&&o({[H.ORDER_EXPIRED]:Y})},[k,T,A,o]);const X=p.useMemo(()=>{const Y=i[H.ID_PRODUCT]||"",q=i[H.SUPPLY]||"",Z=i[H.INFORMATION_ORDER]||"",le=i[H.CUSTOMER]||"";return!!Y&&!!q&&!!Z&&!!le},[i]);if(p.useEffect(()=>{f(X)},[X,f]),!e)return null;const K=!!(i[H.CUSTOMER]&&i[H.ID_PRODUCT]&&i[H.SUPPLY]&&i[H.INFORMATION_ORDER]);return s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 p-2 sm:p-4",children:s.jsxs("div",{className:"glass-panel border-white/10 rounded-[32px] shadow-[0_32px_64px_-16px_rgba(0,0,0,0.6)] w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col text-slate-100 overflow-hidden",children:[s.jsxs("div",{className:"p-6 sm:p-8 border-b border-white/5 sticky top-0 bg-[#0c1222]/80 backdrop-blur-xl z-20 flex justify-between items-center",children:[s.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-white tracking-tight",children:"Tạo Đơn Hàng Mới"}),s.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:s.jsx(Pt,{className:"h-6 w-6"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:s.jsx("form",{onSubmit:y,children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-6 rounded-2xl bg-white/5 border border-white/5",children:[s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Loại Khách Hàng"}),s.jsx("select",{name:"customer_type",value:h,onChange:w,className:pr,children:ZW.map(Y=>s.jsx("option",{value:Y.value,children:Y.label},Y.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Mã Đơn Hàng"}),s.jsx("input",{type:"text",name:H.ID_ORDER,value:i[H.ID_ORDER]||"",readOnly:!0,className:`${pr} font-semibold ${Fo}`})]}),s.jsxs("div",{children:[s.jsxs("label",{className:Sr,children:["Tên Khách Hàng ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:H.CUSTOMER,value:i[H.CUSTOMER]||"",onChange:g,className:pr,required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Link Liên Hệ"}),s.jsx("input",{type:"url",name:H.CONTACT,value:i[H.CONTACT]||"",onChange:g,className:pr})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[s.jsxs("div",{className:"md:col-span-5",children:[s.jsxs("label",{className:Sr,children:["Sản Phẩm ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(x2,{name:H.ID_PRODUCT,value:i[H.ID_PRODUCT]||"",options:C,placeholder:"-- Chọn --",onChange:Y=>v(String(Y)),onClear:()=>v(""),disabled:n})]}),s.jsxs("div",{className:"md:col-span-5",children:[s.jsxs("label",{className:Sr,children:["Nguồn ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(x2,{name:H.SUPPLY,value:u??"",options:R,placeholder:"-- Chọn --",disabled:n||!i[H.ID_PRODUCT],onChange:Y=>b(Number(Y)),onClear:()=>b(0)})]}),s.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:s.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{x(!1),a(Y=>!Y)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?s.jsx(GN,{className:"h-6 w-6","aria-hidden":"true"}):s.jsx(Np,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&s.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Sản Phẩm Mới"}),s.jsx("input",{type:"text",name:H.ID_PRODUCT,value:i[H.ID_PRODUCT]||"",onChange:g,onBlur:()=>x(!0),className:pr,placeholder:"Nhập Tên Sản Phẩm Mới"})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Nguồn Mới"}),s.jsx("input",{type:"text",name:H.SUPPLY,value:i[H.SUPPLY]||"",onChange:g,className:pr,placeholder:"Nhập Tên Nguồn Mới"})]})]}),s.jsxs("div",{className:"md:col-span-12",children:[s.jsxs("label",{className:Sr,children:["Thông Tin Sản Phẩm ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",name:H.INFORMATION_ORDER,value:i[H.INFORMATION_ORDER]||"",onChange:g,className:pr,required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Ngày Đăng Ký (dd/mm/yyyy)"}),s.jsx("input",{type:"text",name:H.ORDER_DATE,value:T,placeholder:"dd/mm/yyyy",onChange:V,className:pr})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Số Ngày Đăng Ký"}),s.jsx("input",{type:"text",name:H.DAYS,value:i[H.DAYS]||"",readOnly:!0,className:`${pr} ${Fo}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Ngày Hết Hạn"}),s.jsx("input",{type:"text",name:H.ORDER_EXPIRED,value:i[H.ORDER_EXPIRED]||"",readOnly:!0,className:`${pr} font-bold text-rose-400 ${Fo}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Slot"}),s.jsx("input",{type:"text",name:H.SLOT,value:i[H.SLOT]||"",onChange:g,className:pr})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Giá Nhập"}),n?s.jsx("input",{type:"text",inputMode:"numeric",name:H.COST,value:s2(Number(j??0)),onChange:G(H.COST),className:`${pr} font-semibold`}):s.jsx("input",{type:"text",name:H.COST,value:An(j??0),readOnly:!0,className:`${pr} font-semibold ${Fo}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Giá Bán"}),n?s.jsx("input",{type:"text",inputMode:"numeric",name:H.PRICE,value:s2(Number(E??0)),onChange:G(H.PRICE),className:`${pr} font-bold text-emerald-400`}):s.jsx("input",{type:"text",name:H.PRICE,value:An(E??0),readOnly:!0,className:`${pr} font-bold text-emerald-400 ${Fo}`})]}),s.jsxs("div",{children:[s.jsx("label",{className:Sr,children:"Ghi Chú"}),s.jsx("textarea",{name:H.NOTE,value:i[H.NOTE]||"",onChange:g,rows:8,className:pr})]})]})]})]})})}),s.jsxs("div",{className:"p-6 sm:p-8 border-t border-white/5 bg-[#0c1222]/50 backdrop-blur-xl flex justify-end sticky bottom-0 z-20",children:[s.jsx("button",{type:"button",onClick:t,className:"px-8 py-2.5 text-sm font-bold text-slate-300 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-all shadow-lg mr-4",children:"Hủy"}),s.jsx("button",{type:"submit",onClick:y,className:`px-8 py-2.5 text-sm font-bold text-white rounded-xl transition-all shadow-[0_0_20px_rgba(16,185,129,0.3)] ${K&&!d?"bg-emerald-500 hover:bg-emerald-600 hover:scale-[1.02] active:scale-[0.98]":"bg-slate-700 opacity-50 cursor-not-allowed"}`,disabled:!K||d,children:d?"Đang Tính Giá...":"Tạo Đơn Hàng"})]})]})})},wV=Cl;function NV(e){const[t,r]=p.useState([]),[n,a]=p.useState(null),i=p.useCallback(async()=>{try{a(null);const o=u4[e].endpoint,l=await fetch(`${wV}${o}`,{credentials:"include"});if(l.status===401){window.location.href="/login";return}if(!l.ok)throw new Error(`Lỗi máy chủ: ${l.status}`);const c=await l.json();Array.isArray(c)?r(c):console.error("Dữ liệu nhận được không phải là mảng:",c)}catch(o){console.error("Lỗi khi tải đơn hàng:",o);const{handleNetworkError:l}=await Xc(async()=>{const{handleNetworkError:d}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:d}},[]),c=l(o);a(c)}},[e]);return p.useEffect(()=>{i()},[i]),{orders:t,setOrders:r,fetchError:n,fetchOrders:i}}function _V(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}const $s=e=>On(e).toLocaleString("vi-VN")+" VND",Lo=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},Wc=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),df=e=>Wc(e).replace(/[^a-z0-9]/g,""),b2=(e,t)=>{const r=e??t;return r==null?"":yt(r)||String(r)},Ta=e=>{if(e==null)return e;if(typeof e!="boolean"&&(typeof e=="string"||typeof e=="number"||e instanceof Date))return e},jV=e=>e==null?e:typeof e=="boolean"?null:typeof e=="number"||typeof e=="string"?e:null,hf=e=>{if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},y2=e=>{const t=Ta(e.expiry_date)??Ta(e[H.ORDER_EXPIRED])??Ta(e.expiry_date_display)??Ta(e[st.EXPIRY_DATE_DISPLAY]),n=(yt(t)||String(t||"")).split("/");if(n.length===3){const[i,o,l]=n.map(Number);if(Number.isFinite(i)&&Number.isFinite(o)&&Number.isFinite(l))return new Date(l,o-1,i).getTime()}const a=new Date(String(t||""));return Number.isFinite(a.getTime())?a.getTime():0};function SV(e,t){return e.map(r=>{const n=Ta(r.registration_date??r[H.ORDER_DATE]),a=Ta(r.expiry_date??r[H.ORDER_EXPIRED]),i=b2(Ta(r.registration_date_display),n),o=b2(Ta(r.expiry_date_display),a),l=hf(jV(r.so_ngay_con_lai)),c=t4(a||o),d=l??c??0,u=r[H.STATUS]||rt.CHUA_THANH_TOAN,h=String(u).trim(),f=On(Number.parseFloat(String(r[H.PRICE]??0))||0),m=Number(r[H.DAYS])||0,x=Math.max(0,d);let g=m>0?f*x/m:0;const v=r.can_hoan??r[H.REFUND]??r.refund;let b=hf(v)??(Number.isFinite(g)?g:null);if(t==="canceled"){const w=hf(r.refund);w!==null&&(g=w,b=w)}return{...r,[st.SO_NGAY_CON_LAI]:d,[st.GIA_TRI_CON_LAI]:g,[st.TRANG_THAI_TEXT]:h,[st.ORDER_DATE_DISPLAY]:i,[st.EXPIRY_DATE_DISPLAY]:o,can_hoan:b}})}const w2=e=>e===rt.CHUA_THANH_TOAN||e===rt.CHO_HOAN;function EV(e,t){const{searchTerm:r,searchField:n,statusFilter:a,dataset:i}=t,o=Wc(r),l=df(r),c=n==="all"?[H.CUSTOMER,H.ID_ORDER,H.ID_PRODUCT,H.INFORMATION_ORDER,H.SUPPLY,H.CONTACT]:[n],d=a==="all"?"":String(a||"").trim();return[...e.filter(f=>{const m=!o||c.some(w=>{const y=f[w],N=Wc(y);if(!N)return!1;if(w===H.ID_ORDER){const _=df(y);return!!l&&_.includes(l)||N.includes(o)}return N.includes(o)}),x=!!l&&df(f[H.ID_ORDER]).includes(l),g=!!o&&Wc(f[H.ID_PRODUCT]).includes(o),v=String(f[st.TRANG_THAI_TEXT]||"").trim();return(m||x||g)&&(a==="all"||d&&v===d)})].sort((f,m)=>{const x=String(f[st.TRANG_THAI_TEXT]||"").trim(),g=String(m[st.TRANG_THAI_TEXT]||"").trim(),v=w2(x),b=w2(g);if(v!==b)return v?-1:1;if(i==="expired"){const E=y2(f),k=y2(m);if(E!==k)return k-E}const w=l2(x),y=l2(g);if(w!==y)return w-y;const N=Number(f[st.SO_NGAY_CON_LAI]??0),_=Number(m[st.SO_NGAY_CON_LAI]??0);if(N!==_)return N-_;const S=f[H.ID_ORDER]||"",j=m[H.ID_ORDER]||"";return S<j?-1:S>j?1:0})}function CV(e){const t=e.length,r=e.filter(o=>{const l=Number(o[st.SO_NGAY_CON_LAI]??0);return Number.isFinite(l)&&l>0&&l<=4}).length,n=e.filter(o=>{const l=Number(o[st.SO_NGAY_CON_LAI]??0);return Number.isFinite(l)&&l<=0}).length,a=e.filter(o=>{const l=Ta(o.registration_date||o.registration_date_display||o[st.ORDER_DATE_DISPLAY]||o[H.ORDER_DATE]);return dW(l)}).length;return{updatedStats:[{...wc[0],value:String(t)},{...wc[1],value:String(r)},{...wc[2],value:String(n)},{...wc[3],value:String(a)}],totalRecords:t}}function TV(e,t,r){const n=Math.max(1,Math.ceil(e.length/r)),a=t*r,i=a-r;return{currentOrders:e.slice(i,a),totalPages:n}}function kV(e,t){const r=[];if(t<=7){for(let o=1;o<=t;o++)r.push(o);return r}const n=(o,l,c)=>Math.min(Math.max(o,l),c),a=n(e-1,2,t-3),i=n(e+1,4,t-1);r.push(1),a>2&&r.push("...");for(let o=a;o<=i;o++)r.push(o);return i<t-1&&r.push("..."),r.push(t),r}function AV({orders:e,searchTerm:t,searchField:r,statusFilter:n,rowsPerPage:a,currentPage:i,setCurrentPage:o,dataset:l}){const c=_V(t,300),d=p.useMemo(()=>{const h=SV(e,l),f=EV(h,{searchTerm:c,searchField:r,statusFilter:n,dataset:l}),{updatedStats:m,totalRecords:x}=CV(h),{currentOrders:g,totalPages:v}=TV(f,i,a);return{filteredOrders:f,currentOrders:g,totalPages:v,updatedStats:m,totalRecords:x}},[e,l,c,r,n,a,i]);p.useEffect(()=>{o(1)},[c,r,n,a,o]);const u=p.useMemo(()=>kV(i,d.totalPages),[i,d.totalPages]);return{...d,paginationPages:u}}function PV(){const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[a,i]=p.useState(!1),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,h]=p.useState("view"),[f,m]=p.useState(null),[x,g]=p.useState(null),v=p.useCallback(()=>l(!0),[]),b=p.useCallback(()=>l(!1),[]),w=p.useCallback(()=>{n(!1),d(null),h("view")},[]),y=p.useCallback(()=>{i(!1),g(null)},[]),N=p.useCallback(()=>{t(!1),m(null)},[]),_=p.useCallback((k,T="view")=>{d(k),h(T),n(!0)},[]),S=p.useCallback(k=>{const T={...k,cost:Number(k[H.COST]??0)||0,price:Number(k[H.PRICE]??0)||0};g(T),i(!0)},[]),j=p.useCallback(k=>{m(k),t(!0)},[]),E=p.useCallback(()=>{t(!1),n(!1),i(!1),l(!1),d(null),h("view"),m(null),g(null)},[]);return{isModalOpen:e,isViewModalOpen:r,viewModalSource:u,isEditModalOpen:a,isCreateModalOpen:o,orderToView:c,orderToDelete:f,orderToEdit:x,openCreateModal:v,closeCreateModal:b,closeViewModal:w,closeEditModal:y,closeModal:N,handleViewOrder:_,handleEditOrder:S,handleDeleteOrder:j,resetModals:E,setOrderToDelete:m}}const qm="app:data-refresh",f4=e=>!e||e.length===0?["all"]:e,OV=(e,t)=>e.includes("all")||t.some(r=>e.includes(r)),Cs=(e=["all"])=>{if(typeof window>"u")return;const t={scopes:f4(e)};window.dispatchEvent(new CustomEvent(qm,{detail:t}))},DV=(e,t)=>{if(typeof window>"u")return()=>{};const r=n=>{const a=n.detail,i=f4(a?.scopes);OV(i,e)&&t()};return window.addEventListener(qm,r),()=>{window.removeEventListener(qm,r)}},Ts=Cl;function IV(e){const{fetchOrders:t,closeCreateModal:r,closeEditModal:n,closeModal:a,handleViewOrder:i,orderToDelete:o,setOrderToDelete:l,setOrders:c}=e,[d,u]=p.useState(null),h=p.useCallback(async b=>{r();try{const w=await fetch(`${Ts}${Je.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(b)});if(!w.ok){const N=await w.json();throw new Error(N.error||"Lỗi khi tạo đơn hàng mới từ Máy chủ")}await t();const y=await w.json();i(y,"create"),Cs(["orders","dashboard"])}catch(w){console.error("Lỗi khi tạo đơn hàng:",w),br({type:"error",title:"Lỗi tạo đơn hàng",message:`Lỗi khi tạo đơn hàng: ${w instanceof Error?w.message:String(w)}`})}},[r,t,i]),f=p.useCallback(async b=>{if(!b||!b.id)return;const w=String(b[H.STATUS]||"").trim();let y=null;if(w===rt.CHUA_THANH_TOAN?y={[H.STATUS]:rt.DANG_XU_LY}:w===rt.DANG_XU_LY&&(y={[H.STATUS]:rt.DA_THANH_TOAN}),!!y)try{const N=await fetch(`${Ts}${Je.ORDER_BY_ID(b.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(y)});if(!N.ok){const _=await Lo(N);throw new Error(_||"Lỗi khi cập nhật trạng thái từ máy chủ")}await t(),Cs(["orders","dashboard"])}catch(N){console.error("Lỗi khi đánh dấu đã thanh toán:",N),br({type:"error",title:"Lỗi cập nhật thanh toán",message:`Không thể đánh dấu đã thanh toán: ${N instanceof Error?N.message:String(N)}`})}},[t]),m=p.useCallback(async b=>{if(!b)return;const w=String(b[H.ID_ORDER]||"").trim();if(w){u(w);try{const y=await fetch(`${Ts}${Je.ORDER_RENEW(w)}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({forceRenewal:!0})});if(!y.ok){const N=await Lo(y);throw new Error(N||"Không thể gia hạn thủ công cho đơn hàng.")}await t(),Cs(["orders","dashboard"]),br({type:"success",title:"Gia hạn thành công",message:`Gia hạn đơn hàng thành công.
Đơn đã được xử lý renewal thủ công.`})}catch(y){console.error("Lỗi khi chạy gia hạn thủ công:",y),br({type:"error",title:"Lỗi gia hạn",message:`Không thể gia hạn đơn hàng: ${y instanceof Error?y.message:String(y)}`})}finally{u(null)}}},[t]),x=p.useCallback(async b=>{if(!(!b||!b.id))try{const w=await fetch(`${Ts}${Je.ORDER_CANCELED_REFUND(b.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!w.ok){const y=await Lo(w);throw new Error(y||"Lỗi khi xác nhận hoàn tiền từ máy chủ")}await t(),Cs(["orders","dashboard"])}catch(w){console.error("Lỗi khi xác nhận hoàn tiền:",w),br({type:"error",title:"Lỗi xác nhận hoàn tiền",message:`Lỗi khi xác nhận hoàn tiền: ${w instanceof Error?w.message:String(w)}`})}},[t]),g=p.useCallback(async b=>{n();const w={[H.ID_ORDER]:b.id_order,[H.ID_PRODUCT]:b.id_product,[H.INFORMATION_ORDER]:b.information_order,[H.CUSTOMER]:b.customer,[H.CONTACT]:b.contact,[H.SLOT]:b.slot,[H.SUPPLY]:b.supply,[H.COST]:Number(b.cost??0)||0,[H.PRICE]:Number(b.price??0)||0,[H.NOTE]:b.note,[H.STATUS]:b.status};try{const y=await fetch(`${Ts}${Je.ORDER_BY_ID(Number(b.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(w)});if(!y.ok){const N=await Lo(y);throw new Error(N||"Lỗi khi cập nhật đơn hàng từ Máy chủ")}await t(),Cs(["orders","dashboard"])}catch(y){console.error("Lỗi khi cập nhật đơn hàng:",y),br({type:"error",title:"Lỗi cập nhật đơn hàng",message:`Lỗi khi cập nhật đơn hàng: ${y instanceof Error?y.message:String(y)}`})}},[n,t]),v=p.useCallback(async()=>{if(o){a();try{const b=await fetch(`${Ts}${Je.ORDER_BY_ID(o.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:o[st.GIA_TRI_CON_LAI],gia_tri_con_lai:o[st.GIA_TRI_CON_LAI]})});if(!b.ok){const w=await Lo(b);throw new Error(w||"Lỗi khi xóa đơn hàng từ Máy chủ")}c(w=>w.filter(y=>y.id!==o.id)),Cs(["orders","dashboard"])}catch(b){console.error("Lỗi khi xóa đơn hàng:",b),br({type:"error",title:"Lỗi xóa đơn hàng",message:`Lỗi khi xóa đơn hàng: ${b instanceof Error?b.message:String(b)}`})}finally{l(null)}}},[a,o,l,c]);return{handleSaveNewOrder:h,handleMarkPaid:f,handleRenewOrder:m,handleConfirmRefund:x,handleSaveEdit:g,confirmDelete:v,renewingOrderCode:d}}function RV(e){const{orders:t,setOrders:r,fetchError:n,fetchOrders:a}=NV(e),[i,o]=p.useState(""),[l,c]=p.useState("all"),[d,u]=p.useState("all"),[h,f]=p.useState(1),[m,x]=p.useState(10),g=PV(),v=AV({orders:t,searchTerm:i,searchField:l,statusFilter:d,rowsPerPage:m,currentPage:h,setCurrentPage:f,dataset:e}),b=IV({fetchOrders:a,closeCreateModal:g.closeCreateModal,closeEditModal:g.closeEditModal,closeModal:g.closeModal,handleViewOrder:g.handleViewOrder,orderToDelete:g.orderToDelete,setOrderToDelete:g.setOrderToDelete,setOrders:r});return p.useEffect(()=>{r([]),o(""),u("all"),f(1),g.resetModals()},[e,r,g.resetModals]),{...v,searchTerm:i,setSearchTerm:o,searchField:l,setSearchField:c,statusFilter:d,setStatusFilter:u,currentPage:h,setCurrentPage:f,rowsPerPage:m,setRowsPerPage:x,isModalOpen:g.isModalOpen,isViewModalOpen:g.isViewModalOpen,viewModalSource:g.viewModalSource,isEditModalOpen:g.isEditModalOpen,isCreateModalOpen:g.isCreateModalOpen,orderToView:g.orderToView,orderToDelete:g.orderToDelete,orderToEdit:g.orderToEdit,openCreateModal:g.openCreateModal,closeCreateModal:g.closeCreateModal,closeViewModal:g.closeViewModal,closeEditModal:g.closeEditModal,closeModal:g.closeModal,handleViewOrder:g.handleViewOrder,handleEditOrder:g.handleEditOrder,handleDeleteOrder:g.handleDeleteOrder,handleSaveNewOrder:b.handleSaveNewOrder,handleSaveEdit:b.handleSaveEdit,handleConfirmRefund:b.handleConfirmRefund,handleMarkPaid:b.handleMarkPaid,handleRenewOrder:b.handleRenewOrder,confirmDelete:b.confirmDelete,renewingOrderCode:b.renewingOrderCode,fetchError:n,reloadOrders:a}}const m4=ua.memo(function({order:t,isExpanded:r,showRemainingColumn:n,showActionButtons:a,isCanceled:i,totalColumns:o,renewingOrderCode:l,onToggleDetails:c,onView:d,onEdit:u,onDelete:h,onConfirmRefund:f,onMarkPaid:m,onRenew:x}){const{[st.SO_NGAY_CON_LAI]:g,[st.GIA_TRI_CON_LAI]:v,[st.TRANG_THAI_TEXT]:b}=t,w=Number.isFinite(Number(t[H.COST]))?Number(t[H.COST]):0,y=Number.isFinite(Number(t[H.PRICE]))?Number(t[H.PRICE]):0,N=Number.isFinite(Number(v))?Number(v):0,_=Number.isFinite(Number(t.can_hoan))?Number(t.can_hoan):null,S=i?Math.max(0,_!==null&&Number.isFinite(N)?Math.min(_,N):_??N):N,j=rt.CHO_HOAN,E=String(b||"").trim(),k=i&&E===j,T=E===rt.CAN_GIA_HAN||E===rt.ORDER_EXPIRED,A=E===rt.CHUA_THANH_TOAN,C=E===rt.DANG_XU_LY,R=t[st.ORDER_DATE_DISPLAY]||"",G=t[st.EXPIRY_DATE_DISPLAY]||"",V=String(t[H.ID_ORDER]||"").trim(),X=l===V,K=Number.isFinite(Number(g))?Number(g):0,Y=i?"text-indigo-600":K<=0?"text-red-600":K<=4?"text-orange-500":"text-green-500",q=i?$s(S):K,Z=p.useCallback(()=>{t.id!==void 0&&t.id!==null&&c(t.id)},[c,t.id]),le=ce=>pe=>{pe.stopPropagation(),ce(t)};return s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{onClick:Z,className:`order-row ${r?"order-row--expanded":""} group/row cursor-pointer transition-all duration-500 ${r?"z-20":"z-10"}`,children:[s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 first:rounded-l-[16px] sm:first:rounded-l-[24px] last:rounded-r-[16px] sm:last:rounded-r-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:s.jsxs("div",{className:"flex flex-col items-center w-full",children:[s.jsx("span",{className:"text-xs sm:text-sm font-bold text-white tracking-normal sm:tracking-wider uppercase truncate w-full block text-center",children:t[H.ID_ORDER]||""}),s.jsx("span",{className:"text-indigo-400/80 text-[10px] sm:text-[11px] font-bold mt-1 uppercase tracking-normal sm:tracking-wider truncate w-full block text-center",children:t[H.ID_PRODUCT]||""})]})}),s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:s.jsxs("div",{className:"flex flex-col items-center w-full",children:[s.jsx("span",{className:"text-indigo-100/90 text-xs font-medium tracking-wide text-center truncate w-full block",children:t[H.INFORMATION_ORDER]||"—"}),t[H.SLOT]?s.jsx("div",{className:"mt-1 px-2 py-0.5 rounded-md bg-white/5 border border-white/10 text-[11px] font-bold text-indigo-300/80 uppercase w-full truncate text-center block",children:t[H.SLOT]}):null]})}),s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 overflow-hidden max-w-0",children:s.jsxs("div",{className:"flex flex-col items-center w-full",children:[s.jsx("span",{className:"text-sm font-bold text-white tracking-tight truncate w-full block text-center",children:t[H.CUSTOMER]||"Khách ẩn"}),s.jsx("span",{className:"text-white/60 text-[11px] font-medium mt-0.5 truncate w-full block text-center",children:t[H.CONTACT]||""})]})}),s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:s.jsxs("div",{className:"inline-flex items-center justify-center gap-1.5 px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[10px] sm:text-[11px] font-bold text-indigo-200 w-full truncate",children:[s.jsx("span",{className:"truncate",children:R||"—"}),s.jsx("span",{className:"text-white/20 shrink-0",children:"/"}),s.jsx("span",{className:"truncate",children:G||"—"})]})}),n&&s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:s.jsx("span",{className:`text-sm font-black transition-all group-hover/row:scale-110 inline-block w-full truncate ${Y}`,children:q})}),s.jsx("td",{className:"order-row__cell px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-center",children:s.jsx("span",{className:`inline-block px-2 py-1 text-[9px] sm:text-[10px] font-bold uppercase tracking-wider rounded-full border shadow-[inset_0_1px_2px_rgba(255,255,255,0.1)] whitespace-nowrap w-full truncate overflow-hidden text-ellipsis ${a4(String(b||""))}`,children:String(b||"")})}),s.jsx("td",{className:"order-row__actions px-2 sm:px-4 py-3 sm:py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 last:rounded-r-[16px] sm:last:rounded-r-[24px]",children:s.jsxs("div",{className:"flex space-x-2 justify-end flex-shrink-0",children:[s.jsx("button",{onClick:le(d),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-indigo-300/60 hover:text-white hover:bg-indigo-500/20 hover:border-indigo-500/40 transition-all flex-shrink-0",children:s.jsx(dr,{className:"h-4 w-4"})}),k&&s.jsx("button",{onClick:le(f),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 hover:bg-emerald-500/30 transition-all flex-shrink-0",title:"Xác nhận đã giải/hoàn tiền",children:s.jsx(Vi,{className:"h-4 w-4"})}),!i&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:le(u),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-400 hover:bg-amber-500/30 transition-all flex-shrink-0",children:s.jsx(cr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:le(h),className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500/30 transition-all flex-shrink-0",title:"Xoá đơn hàng",children:s.jsx(Xr,{className:"h-4 w-4"})})]})]})})]}),r&&s.jsx("tr",{className:"order-row__expandable animate-in fade-in slide-in-from-top-2 duration-300",children:s.jsx("td",{colSpan:o,className:"order-row__expandable-cell px-6 pb-8 pt-2",children:s.jsxs("div",{className:"order-row__expandable-content rounded-[32px] glass-panel-light p-6 shadow-2xl border border-indigo-500/20",children:[s.jsxs("div",{className:"order-row__expandable-header mb-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1 text-center",children:[s.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tiết đơn hàng"}),s.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",t[H.ID_ORDER]||""]})]}),a&&s.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[A&&s.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:le(m),children:"Thanh Toán"}),C&&s.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:le(m),children:"Thanh Toán"}),T&&s.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:X,onClick:ce=>{ce.stopPropagation(),X||x(t)},children:X?"Đang Gia Hạn...":"Gia Hạn"})]})]}),s.jsxs("div",{className:"order-row__detail-grid grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[s.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Nguồn"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[H.SUPPLY]||"N/A"})]}),s.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá nhập"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:$s(w)})]}),s.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá bán"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:$s(y)})]}),s.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Giá trị còn lại"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:$s(S)})]}),s.jsxs("div",{className:"order-row__detail-item rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Số ngày"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[H.DAYS]||0})]}),s.jsxs("div",{className:"order-row__detail-item order-row__detail-item--note rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi chú"}),s.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:t[H.NOTE]||"Không có ghi chú."})]})]})]})})})]})});m4.displayName="OrderRow";const MV=({order:e,showRemainingColumn:t,showActionButtons:r,isCanceled:n,renewingOrderCode:a,onView:i,onEdit:o,onDelete:l,onConfirmRefund:c,onMarkPaid:d,onRenew:u})=>{const h=e[H.ID_ORDER]||"--",f=e[H.CUSTOMER]||"--",m=e[H.ID_PRODUCT]||"--",x=e[H.SUPPLY]||"",g=e[H.ORDER_EXPIRED]||"",v=e[st.TRANG_THAI_TEXT]||"",b=Number(e[H.PRICE]||0),w=Number(e[st.SO_NGAY_CON_LAI]||0),y={[rt.DA_THANH_TOAN]:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",[rt.CHUA_THANH_TOAN]:"bg-amber-500/20 text-amber-300 border-amber-500/30",[rt.ORDER_EXPIRED]:"bg-rose-500/20 text-rose-300 border-rose-500/30",[rt.CAN_GIA_HAN]:"bg-sky-500/20 text-sky-300 border-sky-500/30",[rt.CHO_HOAN]:"bg-rose-500/20 text-rose-300 border-rose-500/30",[rt.DA_HOAN]:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",[rt.DANG_XU_LY]:"bg-indigo-500/20 text-indigo-300 border-indigo-500/30"},N=String(v||"").trim(),_=y[N]||"bg-slate-500/20 text-slate-300 border-slate-500/30",S=N,j=String(e[H.ID_ORDER]||"").trim(),E=N===rt.CAN_GIA_HAN||N===rt.ORDER_EXPIRED,k=N===rt.CHUA_THANH_TOAN,T=N===rt.DANG_XU_LY,A=a===j;return s.jsxs("div",{className:"order-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[s.jsx("div",{className:`order-card__glow absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${S===rt.DA_THANH_TOAN?"bg-emerald-500":S===rt.CHUA_THANH_TOAN?"bg-amber-500":S===rt.ORDER_EXPIRED||S===rt.CHO_HOAN?"bg-rose-500":"bg-indigo-500"}`}),s.jsxs("div",{className:"order-card__inner relative z-10 flex flex-col gap-4",children:[s.jsxs("div",{className:"order-card__header flex flex-col gap-2.5",children:[s.jsxs("div",{className:"order-card__title-row flex items-center gap-2",children:[s.jsx("span",{className:"order-card__dot w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),s.jsx("h3",{className:"order-card__title text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:h})]}),s.jsxs("div",{className:"order-card__tags flex items-center flex-wrap gap-2",children:[s.jsx("div",{className:"order-card__product-tag inline-flex self-start px-2.5 py-1 rounded-lg bg-indigo-500/10 border border-indigo-500/20 backdrop-blur-md min-w-0",children:s.jsx("p",{className:"text-[10px] sm:text-[11px] font-bold text-indigo-300 uppercase tracking-wide truncate max-w-[140px] sm:max-w-[200px]",children:m})}),x&&s.jsx("div",{className:"order-card__supply-tag inline-flex self-start px-2.5 py-1 rounded-lg bg-purple-500/10 border border-purple-500/20 backdrop-blur-md min-w-0",children:s.jsxs("p",{className:"text-[10px] sm:text-[11px] font-bold text-purple-300 uppercase tracking-wide truncate max-w-[120px] sm:max-w-[160px]",children:["NCC: ",x]})})]}),s.jsxs("div",{className:"order-card__status-row flex items-center justify-between gap-2",children:[s.jsx("span",{className:`order-card__status px-2.5 py-1 shrink-0 rounded-xl text-[10px] font-bold uppercase tracking-wide border shadow-lg ${_}`,children:v}),r&&(k||T||E)&&s.jsxs("div",{className:"flex items-center gap-2",children:[(k||T)&&d&&s.jsx("button",{className:"inline-flex whitespace-nowrap px-2.5 py-0.5 rounded-xl bg-emerald-500/20 border border-emerald-500/30 text-[10px] font-bold text-emerald-300 uppercase tracking-wide transition-all hover:bg-emerald-500/30 active:scale-95 shadow-lg",onClick:C=>{C.stopPropagation(),d(e)},children:"Thanh Toán"}),E&&u&&s.jsx("button",{className:"inline-flex whitespace-nowrap px-2.5 py-0.5 rounded-xl bg-blue-500/20 border border-blue-500/30 text-[10px] font-bold text-blue-300 uppercase tracking-wide transition-all hover:bg-blue-500/30 active:scale-95 shadow-lg disabled:opacity-70 disabled:cursor-not-allowed",disabled:A,onClick:C=>{C.stopPropagation(),A||u(e)},children:A?"Đang Gia Hạn...":"Gia Hạn"})]})]})]}),s.jsxs("div",{className:"order-card__info flex items-center justify-between gap-4 p-3.5 rounded-2xl bg-white/5 border border-white/5 backdrop-blur-sm group-hover:bg-white/[0.08] transition-colors",children:[s.jsxs("div",{className:"order-card__customer flex flex-col min-w-0",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Khách hàng"}),s.jsx("p",{className:"text-[13px] font-bold text-white truncate",children:f})]}),s.jsxs("div",{className:"order-card__price flex flex-col items-end shrink-0 pl-4 border-l border-white/10",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Tổng tiền"}),s.jsx("p",{className:"text-sm sm:text-base font-black text-indigo-200 tabular-nums",children:$s(b)})]})]}),s.jsxs("div",{className:"order-card__footer flex items-center justify-between pt-1",children:[s.jsxs("div",{className:"order-card__timeline flex items-center gap-4",children:[s.jsxs("div",{className:"order-card__timeline-item flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Hạn đơn"}),s.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:g?yt(g):"—"})]}),t&&s.jsxs("div",{className:"order-card__timeline-item flex flex-col border-l border-white/10 pl-4",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Còn"}),s.jsxs("p",{className:`text-[11px] font-black tabular-nums transition-all ${w<=3?"text-rose-400 drop-shadow-[0_0_8px_rgba(251,113,133,0.3)]":"text-emerald-400"}`,children:[w," ngày"]})]})]}),r&&s.jsxs("div",{className:"order-card__actions flex items-center gap-2",children:[s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 hover:bg-indigo-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:()=>i(e),title:"Xem",children:s.jsx(dr,{className:"h-5 w-5"})}),c&&n&&S==="cho_hoan"&&s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 hover:bg-emerald-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(16,185,129,0.3)] active:scale-90",onClick:()=>c(e),children:s.jsx(Vi,{className:"h-5 w-5"})}),!n&&s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-500 hover:bg-amber-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(245,158,11,0.3)] active:scale-90",onClick:()=>o(e),title:"Sửa",children:s.jsx(cr,{className:"h-5 w-5"})}),s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90",onClick:()=>l(e),title:"Xóa",children:s.jsx(Xr,{className:"h-5 w-5"})})]})]})]})]})},Wa=({children:e,className:t="",cardView:r,showCardOnMobile:n=!1})=>n&&r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"block md:hidden",children:r}),s.jsx("div",{className:`hidden md:block ${t}`,children:s.jsx("div",{className:"overflow-x-visible",children:s.jsx("div",{className:"inline-block min-w-full align-middle",children:e})})})]}):s.jsx("div",{className:`overflow-x-auto ${t}`,children:e}),Si=({data:e,renderCard:t,className:r=""})=>s.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 gap-4 ${r}`,children:e.map((n,a)=>s.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-3 duration-500",style:{animationDelay:`${a*50}ms`},children:t(n,a)},a))});function FV(){const[e,t]=p.useState("active"),[r,n]=p.useState({active:0,expired:0,canceled:0}),{currentOrders:a,totalPages:i,updatedStats:o,filteredOrders:l,paginationPages:c,searchTerm:d,setSearchTerm:u,searchField:h,setSearchField:f,statusFilter:m,setStatusFilter:x,currentPage:g,setCurrentPage:v,rowsPerPage:b,setRowsPerPage:w,isModalOpen:y,isViewModalOpen:N,viewModalSource:_,isEditModalOpen:S,isCreateModalOpen:j,orderToView:E,orderToDelete:k,orderToEdit:T,openCreateModal:A,closeCreateModal:C,closeViewModal:R,closeEditModal:G,closeModal:V,handleViewOrder:X,handleEditOrder:K,handleDeleteOrder:Y,handleSaveNewOrder:q,handleSaveEdit:Z,handleConfirmRefund:le,handleMarkPaid:ce,handleRenewOrder:pe,confirmDelete:Ne,fetchError:ee,reloadOrders:oe,totalRecords:he,renewingOrderCode:O}=RV(e);p.useEffect(()=>{n(ue=>ue[e]===he?ue:{...ue,[e]:he})},[e,he]);const I=e==="active",[L,F]=p.useState(null),W=p.useCallback(ue=>{F(Be=>Be===ue?null:ue)},[]),J=e!=="expired",se=!0,ke=e==="canceled",ye=ke?"Giá Trị Còn Lại":"Còn Lại",Pe=J?7:6;return s.jsxs("div",{className:"space-y-4",children:[ee&&s.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-rose-500/20 bg-rose-500/10 p-4 text-sm text-rose-200 shadow-xl backdrop-blur-md sm:flex-row sm:items-center sm:justify-between animate-in fade-in slide-in-from-top-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-rose-500 animate-pulse"}),s.jsx("span",{className:"font-medium",children:ee})]}),s.jsx("button",{type:"button",onClick:oe,className:"rounded-xl border border-rose-500/30 bg-rose-500/20 px-4 py-2 text-xs font-bold uppercase tracking-wider text-rose-100 transition hover:bg-rose-500/30 active:scale-95",children:"Thử Lại"})]}),s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Quản Lý ",s.jsx("span",{className:"text-indigo-400",children:"Đơn Hàng"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Control and monitor all customer transactions"})]})}),s.jsx("div",{className:"rounded-[32px] glass-panel-dark p-4 shadow-2xl border border-white/5",children:s.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:JW.map(ue=>{const Be=ue,Ve=u4[Be],ve=e===Be,we=r[Be]??0;return s.jsxs("button",{type:"button",onClick:()=>t(Be),className:`flex items-center justify-between rounded-2xl px-6 py-4 text-left transition-all duration-300 border ${ve?"bg-gradient-to-br from-indigo-500/80 to-purple-600/80 text-white border-white/20 shadow-[0_12px_40px_-12px_rgba(99,102,241,0.5)] scale-[1.02]":"bg-white/5 text-slate-400 hover:bg-white/10 border-white/5 hover:text-slate-200"}`,children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:Ve.label}),s.jsx("p",{className:"text-xs text-indigo-100/80",children:Ve.description})]}),s.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:we.toLocaleString("vi-VN")})]},ue)})})}),s.jsx("div",{className:"rounded-[24px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.map(ue=>s.jsx(Ca,{title:ue.name,value:ue.value,icon:ue.icon,accent:ue.accent},ue.name))})}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap gap-4 items-stretch lg:items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[280px]",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:"Tìm kiếm đơn hàng, khách hàng...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:d,onChange:ue=>u(ue.target.value)})]}),s.jsxs("div",{className:"flex flex-wrap gap-3 items-center w-full lg:w-auto lg:flex-shrink-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1","aria-hidden":!0}),s.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[140px] lg:w-[170px]",children:s.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:h,onChange:ue=>f(ue.target.value),children:QW.map(ue=>s.jsx("option",{value:ue.value,className:"bg-slate-900 text-white",children:ue.label},ue.value))})}),s.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[160px] lg:w-[220px]",children:s.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:m,onChange:ue=>x(ue.target.value),children:[s.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Tất cả trạng thái"}),s.jsx("option",{value:rt.DA_THANH_TOAN,className:"bg-slate-900 text-white",children:"Đã thanh toán"}),s.jsx("option",{value:rt.CHUA_THANH_TOAN,className:"bg-slate-900 text-white",children:"Chưa thanh toán"}),s.jsx("option",{value:rt.DANG_XU_LY,className:"bg-slate-900 text-white",children:"Đang xử lý"}),s.jsx("option",{value:rt.CAN_GIA_HAN,className:"bg-slate-900 text-white",children:"Cần gia hạn"}),s.jsx("option",{value:rt.ORDER_EXPIRED,className:"bg-slate-900 text-white",children:"Hết hạn"})]})}),I&&s.jsx(nn,{icon:Ra,onClick:A,children:"Tạo Đơn"})]})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:a.length===0?s.jsxs("div",{className:"p-4 text-center",children:[s.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy đơn hàng"}),s.jsx("div",{className:"text-white/60",children:"Thử thay đổi bộ lọc tìm kiếm"})]}):s.jsx(Si,{data:a,renderCard:ue=>s.jsx(MV,{order:ue,showRemainingColumn:J,showActionButtons:se,isCanceled:ke,renewingOrderCode:O,onView:X,onEdit:K,onDelete:Y,onConfirmRefund:le,onMarkPaid:ce,onRenew:pe}),className:"p-2"}),children:s.jsxs("table",{className:"min-w-full table-fixed border-separate border-spacing-y-4 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:pb-2 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:sm:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-center",children:[s.jsx("th",{className:"w-[14%]",children:"SẢN PHẨM"}),s.jsx("th",{className:"w-[18%]",children:"THÔNG TIN ĐƠN"}),s.jsx("th",{className:"w-[14%]",children:"KHÁCH HÀNG"}),s.jsx("th",{className:"w-[16%]",children:"THỜI HẠN"}),J&&s.jsx("th",{className:"w-[8%] whitespace-nowrap",children:ye}),s.jsx("th",{className:"w-[12%]",children:"TRẠNG THÁI"}),s.jsx("th",{className:"w-[18%] text-right pr-4",children:"THAO TÁC"})]})}),s.jsx("tbody",{className:"",children:a.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:Pe,className:"text-center py-12",children:[s.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy đơn hàng"}),s.jsx("div",{className:"text-white/60",children:"Thử thay đổi bộ lọc tìm kiếm"})]})}):a.map((ue,Be)=>s.jsx(m4,{order:ue,index:Be,isExpanded:L===ue.id,showRemainingColumn:J,showActionButtons:se,isCanceled:ke,totalColumns:Pe,renewingOrderCode:O,onToggleDetails:W,onView:X,onEdit:K,onDelete:Y,onConfirmRefund:le,onMarkPaid:ce,onRenew:pe},ue.id))})]})}),l.length>0&&s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[s.jsx("span",{children:"Hiển thị"}),s.jsxs("select",{id:"rowsPerPage",value:b,onChange:ue=>w(Number(ue.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[s.jsx("option",{value:10,children:"10"}),s.jsx("option",{value:25,children:"25"}),s.jsx("option",{value:50,children:"50"})]}),s.jsx("span",{children:"dòng"})]}),s.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[s.jsx("button",{onClick:()=>v(1),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang đầu",children:"<<"}),s.jsx("button",{onClick:()=>v(ue=>Math.max(ue-1,1)),disabled:g===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trước",children:"<"}),s.jsx("div",{className:"flex items-center gap-1",children:c.map((ue,Be)=>ue==="..."?s.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${Be}`):s.jsx("button",{onClick:()=>v(ue),disabled:ue===g,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${ue===g?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:ue},ue))}),s.jsx("button",{onClick:()=>v(ue=>Math.min(ue+1,i)),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),s.jsx("button",{onClick:()=>v(i),disabled:g===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cuối",children:">>"})]})]})]}),s.jsx(d4,{isOpen:y,onClose:V,onConfirm:Ne,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa đơn hàng: ${k?.id_order}?`}),s.jsx(aV,{isOpen:N,onClose:R,order:E,formatCurrency:$s,keepOrderPrice:_==="create"}),s.jsx(sV,{isOpen:S,onClose:G,order:T,onSave:ue=>Z(ue)}),s.jsx(yV,{isOpen:j,onClose:C,onSave:ue=>{q(ue)}})]})}const LV={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},Wu=[{value:"information",label:"Thông tin gói"},{value:"note",label:"Ghi chú"},{value:"supplier",label:"Nhà cung cấp"},{value:"import",label:"Giá nhập (VND)"},{value:"expired",label:"Ngày hết hạn"},{value:"capacity",label:"Tổng dung lượng (GB)"}],Zm=e=>e.filter(t=>t!=="capacity"),ts=5,rs=2e3,Jm=100,BV=.2,$V=2,UV=[{value:"information",label:"Liên kết theo thông tin đơn hàng",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên các trường thông tin như tên sản phẩm, thông tin sản phẩm."},{value:"slot",label:"Liên kết theo vị trí",helper:"Các gói sẽ được liên kết với đơn hàng dựa trên mã định danh vị trí (slot) của đơn hàng."}],N2=[{value:"all",label:"Tất cả trạng thái"},{value:"full",label:"Còn nhiều"},{value:"low",label:"Sắp hết"},{value:"out",label:"Đã hết"}],HV=It.informationOrder,p4=It.slot,x4="package_slot_link_prefs",Tg=(e,t)=>t<=0||e<=0?"out":e/t<=BV?"low":"ok",Us=e=>e<=0?"out":e<$V?"low":"ok",Yl=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),_2=e=>{const t=Yl(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},hi=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),kg=e=>{const t=yt(e??"");if(t)return t;const r=(e||"").trim();if(!r)return"";const n=r.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(n){const[,a,i,o]=n;return`${String(a).padStart(2,"0")}/${String(i).padStart(2,"0")}/${o}`}return r},j2=e=>{const t=hi(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},Qm=e=>{const t=hi(e);return t?t.toLowerCase().replace(/\s+/g,""):""},g4=e=>{const t=Qm(e.informationUser||"");return t?[t]:[]},zV=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",WV=(e,t,r)=>{const n=hi(r);if(t!=="slot")return n?[n]:[];const i=(e.slotDisplay??"").split("|").map(l=>hi(l)).filter(Boolean);if(i.length>=1)return i;const o=hi(e.customerDisplay);return o?[o,`${o} (2)`]:n?[n]:[]},S2=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},VV=(e,t)=>{let n=t.productKey;if(e){const o=n.indexOf(e);o>=0&&(n=n.slice(o+e.length))}const a=S2(n);if(a)return a;const i=Yl(t.base?.id_product??"");return S2(i)},KV=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):Jm} GB`,GV=e=>e===p4?"slot":"information",_c=e=>e==="slot"?p4:HV,v4=e=>Yl(e),na=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},ff=e=>e==null?"":typeof e=="string"?e:String(e),E2=(e,t,r)=>[e&&`Tài khoản: ${e}`,t&&`Mật khẩu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",XV=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):ff(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):ff(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:ff(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}},YV=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(x4);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},qV=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(x4,JSON.stringify(e))}catch{}},C2=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,a=e.match??e.matchModeValue??null,i=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,o=a?GV(a):e.slotLinkMode??(i==="slot"?"slot":"information"),l=Array.isArray(e.productCodes)?e.productCodes.map(d=>typeof d=="string"?d.trim():"").filter(d=>!!d):[],c=Array.from(new Set(l.map(d=>v4(d)).filter(Boolean)));return{...e,slot:e.slot??ts,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:o,matchModeValue:a,productCodes:l,normalizedProductCodes:c}},ZV=({row:e,showCapacityColumn:t,tableColumnCount:r,isExpanded:n,onToggle:a,onEdit:i,onView:o,onDelete:l})=>{const c=e.slotLimit||ts,d=e.slotUsed,u=e.remainingSlots,h=c>0?Math.min(u/c*100,100):0,f=Us(u),m=f==="out"?"bg-red-500":f==="low"?"bg-yellow-500":"bg-green-500",x=e.capacityLimit||rs,g=e.capacityUsed,v=e.remainingCapacity,b=x>0?Math.min(v/x*100,100):0,w=Tg(v,x),y=w==="out"?"bg-red-500":w==="low"?"bg-yellow-500":"bg-green-500",N=Math.min(d,c),_=e.slotAssignments??[],S=Array.from({length:Math.max(c,0)},(E,k)=>{const T=k+1,A=T<=N,C=_[T-1]??null;return{slotNumber:T,isUsed:A,assignment:C}}),j=t&&!!e.hasCapacityField;return s.jsxs(s.Fragment,{children:[s.jsxs("tr",{onClick:()=>a(e.id),className:`package-row ${n?"package-row--expanded":""} hover:bg-indigo-500/20 ${n?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] font-medium text-white",children:s.jsx("div",{className:"whitespace-normal break-words line-clamp-2",title:e.package||"",children:e.package})}),s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:s.jsx("div",{className:"whitespace-normal break-all line-clamp-1",title:e.informationUser||"",children:e.informationUser||""})}),s.jsxs("td",{className:"package-row__cell px-1 py-4 lg:px-2",children:[s.jsxs("div",{className:"package-row__slot-summary text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-indigo-400",children:d}),s.jsx("span",{className:"text-white/20",children:"/"}),s.jsxs("span",{children:[c," Vị trí"]})]}),s.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 mt-2 overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${m} shadow-[0_0_8px_rgba(34,197,94,0.4)]`,style:{width:`${h}%`}})}),s.jsxs("div",{className:"text-[11px] font-bold uppercase tracking-wider text-white/50 mt-2",children:["Trống: ",u]})]}),t&&s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2",children:j?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-sm font-bold text-white flex items-center gap-2",children:[s.jsx("span",{className:"text-purple-400",children:g}),s.jsx("span",{className:"text-white/20",children:"/"}),s.jsxs("span",{children:[x," GB"]})]}),s.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 mt-2 overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${y} shadow-[0_0_8px_rgba(168,85,247,0.4)]`,style:{width:`${b}%`}})}),s.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wider text-white/30 mt-2",children:["Trống: ",v," GB"]})]}):s.jsx("div",{className:"text-xs text-white/30 font-bold uppercase tracking-widest italic",children:"N/A"})}),s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:s.jsx("div",{className:"truncate",title:e.supplier||"",children:e.supplier||""})}),s.jsxs("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white whitespace-nowrap",children:[Number(e.import||0).toLocaleString("vi-VN")," ",s.jsx("span",{className:"text-[10px] text-white/50",children:"VND"})]}),s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] whitespace-nowrap",children:s.jsx("span",{className:"font-mono font-semibold text-white/95 tracking-tight",children:kg(e.expired)||"---"})}),s.jsx("td",{className:"package-row__cell px-1 py-4 lg:px-2 text-[12px] text-white/80",children:s.jsx("div",{className:"whitespace-normal break-words line-clamp-1",title:e.note||"",children:e.note||""})}),s.jsx("td",{className:"package-row__actions px-1 py-4 lg:px-2 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex items-center justify-center gap-1 flex-wrap md:flex-nowrap",children:[s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",type:"button","aria-label":"Sửa",onClick:E=>{E.stopPropagation(),i(e)},children:s.jsx(cr,{className:"h-3.5 w-3.5"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-purple-400 border border-white/10 hover:bg-purple-500/10 hover:border-purple-500/30 transition-all active:scale-90",type:"button","aria-label":"Xem",onClick:E=>{E.stopPropagation(),o(e)},children:s.jsx(dr,{className:"h-3.5 w-3.5"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",type:"button","aria-label":"Xóa",onClick:E=>{E.stopPropagation(),l(e)},children:s.jsx(Xr,{className:"h-3.5 w-3.5"})})]})})]}),n&&s.jsx("tr",{className:"package-row__expandable-row",children:s.jsx("td",{colSpan:r,className:"package-row__expandable-cell bg-indigo-900/30 px-6 py-4 text-white",children:s.jsxs("div",{className:"package-row__expandable-content glass-panel-dark border border-white/5 bg-slate-900/40 rounded-3xl p-6 space-y-6",children:[s.jsxs("div",{className:"package-row__expandable-header flex items-center justify-between border-b border-white/5 pb-4",children:[s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/70",children:"Chi Tiết Các Vị Trí"}),s.jsx("p",{className:"text-xl font-bold text-white tracking-tight mt-1",children:"Slot Distribution Maps"})]}),s.jsxs("div",{className:"px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-[11px] font-bold uppercase tracking-widest text-white/70",children:[d," Dùng / ",u," Trống"]})]}),s.jsx("div",{className:"package-row__slot-grid grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3",children:S.map(E=>s.jsxs("div",{className:`package-row__slot-cell ${E.isUsed?"package-row__slot-cell--used":"package-row__slot-cell--available"} flex flex-col items-center justify-center rounded-2xl border p-4 transition-all duration-300 hover:scale-[1.05] ${E.isUsed?"border-amber-500/20 bg-amber-500/5 text-amber-200":"border-emerald-500/20 bg-emerald-500/5 text-emerald-200"}`,children:[s.jsxs("div",{className:"flex flex-col items-center gap-2",children:[s.jsx("div",{className:`p-2 rounded-xl backdrop-blur-md ${E.isUsed?"bg-amber-500/10":"bg-emerald-500/10"}`,children:s.jsx(VT,{className:"h-5 w-5"})}),s.jsx("span",{className:"text-xs font-bold tracking-tight text-white/90",children:E.assignment?.slotLabel||`Slot ${E.slotNumber}`})]}),s.jsx("p",{className:`text-[11px] font-bold uppercase tracking-widest mt-2 ${E.isUsed?"text-amber-500/80":"text-emerald-500/80"}`,children:E.assignment&&j?KV(E.assignment.capacityUnits):E.isUsed?"ASSIGNED":"AVAILABLE"})]},E.slotNumber))})]})})})]})},JV=({row:e,showCapacityColumn:t,onEdit:r,onView:n,onDelete:a})=>{const i=e.slotLimit||ts,o=e.slotUsed,l=e.remainingSlots,c=i>0?Math.min(l/i*100,100):0,d=Us(l),u=d==="out"?"bg-red-500":d==="low"?"bg-yellow-500":"bg-green-500",h=d==="out"?"bg-red-500":d==="low"?"bg-amber-500":"bg-emerald-500",f=t&&!!e.hasCapacityField,m=e.capacityLimit||rs,x=e.capacityUsed,g=e.remainingCapacity,v=m>0?Math.min(g/m*100,100):0,b=Tg(g,m),w=b==="out"?"bg-red-500":b==="low"?"bg-yellow-500":"bg-green-500";return s.jsxs("div",{className:"package-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[s.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${h}`}),s.jsxs("div",{className:"relative z-10 flex flex-col gap-3",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),s.jsx("h3",{className:"text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:e.package||"--"})]}),s.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[e.informationUser&&s.jsx("div",{className:"inline-flex px-2.5 py-1 rounded-lg bg-indigo-500/10 border border-indigo-500/20 backdrop-blur-md min-w-0",children:s.jsx("p",{className:"text-[10px] sm:text-[11px] font-bold text-indigo-300 uppercase tracking-wide truncate max-w-[200px]",children:e.informationUser})}),e.supplier&&s.jsx("div",{className:"inline-flex px-2.5 py-1 rounded-lg bg-purple-500/10 border border-purple-500/20 backdrop-blur-md min-w-0",children:s.jsxs("p",{className:"text-[10px] sm:text-[11px] font-bold text-purple-300 uppercase tracking-wide truncate max-w-[120px]",children:["NCC: ",e.supplier]})})]})]}),s.jsxs("div",{className:"flex items-stretch gap-3",children:[s.jsxs("div",{className:"flex-1 p-3 rounded-2xl bg-white/5 border border-white/5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Vị trí"}),s.jsxs("span",{className:"text-xs font-bold text-white",children:[s.jsx("span",{className:"text-indigo-400",children:o}),s.jsx("span",{className:"text-white/20 mx-0.5",children:"/"}),i]})]}),s.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${u} shadow-[0_0_8px_rgba(34,197,94,0.4)]`,style:{width:`${c}%`}})}),s.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-wider text-white/40 mt-1.5",children:["Trống: ",l]})]}),f&&s.jsxs("div",{className:"flex-1 p-3 rounded-2xl bg-white/5 border border-white/5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em]",children:"Dung lượng"}),s.jsxs("span",{className:"text-xs font-bold text-white",children:[s.jsx("span",{className:"text-purple-400",children:x}),s.jsx("span",{className:"text-white/20 mx-0.5",children:"/"}),m," GB"]})]}),s.jsx("div",{className:"w-full bg-white/5 rounded-full h-1.5 overflow-hidden border border-white/5",children:s.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${w} shadow-[0_0_8px_rgba(168,85,247,0.4)]`,style:{width:`${v}%`}})}),s.jsxs("p",{className:"text-[10px] font-bold uppercase tracking-wider text-white/30 mt-1.5",children:["Trống: ",g," GB"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 rounded-2xl bg-white/5 border border-white/5 backdrop-blur-sm",children:[s.jsxs("div",{className:"flex flex-col min-w-0",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Giá nhập"}),s.jsxs("p",{className:"text-sm font-black text-indigo-200 tabular-nums",children:[Number(e.import||0).toLocaleString("vi-VN")," ",s.jsx("span",{className:"text-[10px] text-white/40",children:"VND"})]})]}),s.jsxs("div",{className:"flex flex-col items-end shrink-0 pl-4 border-l border-white/10",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.2em] mb-1",children:"Hết hạn"}),s.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums font-mono",children:kg(e.expired)||"---"})]})]}),e.note&&s.jsx("div",{className:"px-3 py-2 rounded-xl bg-white/[0.03] border border-white/5",children:s.jsxs("p",{className:"text-[11px] text-white/50 truncate",title:e.note,children:["📝 ",e.note]})}),s.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:()=>r(e),title:"Sửa",children:s.jsx(cr,{className:"h-5 w-5"})}),s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-purple-500/10 border border-purple-500/20 text-purple-400 hover:bg-purple-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(168,85,247,0.3)] active:scale-90",onClick:()=>n(e),title:"Xem",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90",onClick:()=>a(e),title:"Xóa",children:s.jsx(Xr,{className:"h-5 w-5"})})]})]})]})},QV=({rows:e,loading:t,showCapacityColumn:r,tableColumnCount:n,onEdit:a,onView:i,onDelete:o})=>{const[l,c]=p.useState(null),d=u=>{c(h=>h===u?null:u)};return s.jsxs("div",{className:"package-table glass-panel-dark rounded-[32px] shadow-2xl overflow-hidden text-white border border-white/5",children:[s.jsx("div",{className:"md:hidden",children:t?s.jsx("div",{className:"px-6 py-8 text-center text-white/80 text-sm",children:"Đang Tải Dữ Liệu..."}):e.length===0?s.jsx("div",{className:"px-6 py-8 text-center text-white/80 text-sm",children:"Không có gói nào để hiển thị."}):s.jsx("div",{className:"p-3 space-y-3",children:e.map((u,h)=>s.jsx(JV,{row:u,showCapacityColumn:r,onEdit:a,onView:i,onDelete:o},`card-${u.id}-${h}`))})}),s.jsx("div",{className:"package-table__inner overflow-x-auto hidden md:block",children:s.jsx("div",{className:"inline-block min-w-full align-middle",children:s.jsxs("table",{className:"package-table__table w-full table-fixed divide-y divide-white/5",children:[s.jsxs("colgroup",{children:[s.jsx("col",{className:r?"w-[12%]":"w-[14%]"}),s.jsx("col",{className:r?"w-[17%]":"w-[20%]"}),s.jsx("col",{className:"w-[10%]"}),r&&s.jsx("col",{className:"w-[8%]"}),s.jsx("col",{className:r?"w-[8%]":"w-[9%]"}),s.jsx("col",{className:r?"w-[10%]":"w-[11%]"}),s.jsx("col",{className:"w-[10%]"}),s.jsx("col",{className:r?"w-[15%]":"w-[17%]"}),s.jsx("col",{className:"w-[10%]"})]}),s.jsx("thead",{className:"package-table__head bg-white/5",children:s.jsxs("tr",{children:[s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Tên Gói"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Thông Tin Gói"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Số Lượng"}),r&&s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Dung Lượng"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"NCC"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Giá Nhập"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Ngày Hết Hạn"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-left text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Ghi Chú"}),s.jsx("th",{className:"package-table__th px-2 py-4 lg:px-4 text-center text-[10px] font-bold text-indigo-300/70 uppercase tracking-widest whitespace-nowrap",children:"Thao Tác"})]})}),s.jsx("tbody",{className:"package-table__body divide-y divide-white/5",children:t?s.jsx("tr",{className:"package-table__loading-row",children:s.jsx("td",{colSpan:n,className:"package-table__loading-cell px-6 py-8 text-center text-white/80 text-sm",children:"Đang Tải Dữ Liệu..."})}):e.length===0?s.jsx("tr",{className:"package-table__empty-row",children:s.jsx("td",{colSpan:n,className:"package-table__empty-cell px-6 py-8 text-center text-white/80 text-sm",children:"Không có gói nào để hiển thị."})}):e.map((u,h)=>s.jsx(ZV,{row:u,showCapacityColumn:r,tableColumnCount:n,isExpanded:l===u.id,onToggle:d,onEdit:a,onView:i,onDelete:o},`${u.id}-${h}`))})]})})})]})},Ag=({open:e,title:t,onClose:r,children:n,footer:a})=>e?s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-black/40 px-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),s.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"Ž?A3ng",children:s.jsx(Pt,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),s.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:a})]})}):null,eK=({open:e,initialProductId:t,initialName:r,initialFields:n,onClose:a,onSubmit:i,mode:o})=>{const[l,c]=p.useState(t),[d,u]=p.useState(r),[h,f]=p.useState(new Set(n)),[m,x]=p.useState(null),[g,v]=p.useState([]),[b,w]=p.useState(!1);p.useEffect(()=>{e&&(c(t),u(r),f(new Set(n)),x(null))},[e,n,r,t]),p.useEffect(()=>{if(!e)return;let j=!1;return w(!0),Ue("/api/products/packages").then(E=>E.json()).then(E=>{j||!Array.isArray(E)||v(E)}).catch(()=>{j||v([])}).finally(()=>{j||w(!1)}),()=>{j=!0}},[e]);const y=j=>{f(E=>{const k=new Set(E);return k.has(j)?k.delete(j):k.add(j),k})},N=()=>f(new Set(Wu.map(j=>j.value))),_=()=>f(new Set),S=j=>{j.preventDefault();const E=l!=null?Number(l):null,k=d?.trim()??"";if(E==null||!Number.isFinite(E)||E<1){x("Vui lòng chọn loại gói (sản phẩm).");return}if(h.size===0){x("Vui lòng chọn ít nhất một trường dữ liệu.");return}i(E,k||String(E),Array.from(h))};return s.jsx(Ag,{open:e,title:o==="edit"&&(r||t!=null)?`Chỉnh sửa loại gói: ${r||t}`:"Tạo loại gói sản phẩm mới",onClose:a,footer:s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy bỏ"}),s.jsx("button",{onClick:S,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:o==="create"?"Tạo Loại":"Lưu Thay Đổi"})]}),children:s.jsxs("form",{onSubmit:S,className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tên Loại Gói (chọn từ Sản phẩm)"}),b?s.jsx("p",{className:"text-sm text-white/70 py-2",children:"Đang tải danh sách..."}):s.jsxs("select",{value:l??"",onChange:j=>{const E=j.target.value,k=E===""?null:Number(E),T=g.find(A=>A.id===k);c(k!=null&&Number.isFinite(k)?k:null),u(T?.package_name??"")},className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${o==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:o==="edit",children:[s.jsx("option",{value:"",children:o==="create"?"-- Chọn loại gói (sản phẩm) --":(r||t)??"--"}),o==="edit"&&t!=null&&!g.some(j=>j.id===t)&&s.jsx("option",{value:t,children:r||t}),g.map(j=>s.jsx("option",{value:j.id,children:j.package_name},j.id))]}),o==="edit"&&s.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bạn chỉ có thể chỉnh sửa các trường dữ liệu, tên loại gói giữ nguyên."})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Các trường dữ liệu của loại gói này"}),s.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[s.jsx("button",{type:"button",onClick:N,className:"text-blue-600 hover:text-blue-700",children:"Chọn tất cả"}),s.jsx("button",{type:"button",onClick:_,className:"text-rose-600 hover:text-rose-700",children:"Bỏ chọn tất cả"})]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Wu.map(j=>s.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${h.has(j.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:h.has(j.value),onChange:()=>y(j.value)}),s.jsx("span",{className:"text-sm font-medium text-gray-800",children:j.label})]},j.value))})]}),m&&s.jsx("p",{className:"text-sm text-red-600",children:m})]})})},T2=({open:e,mode:t,template:r,initialValues:n,onClose:a,onSubmit:i})=>{const o=p.useMemo(()=>({...LV,...n??{}}),[n]),[l,c]=p.useState(o),d=p.useCallback(y=>{const N=y.replace(/[^0-9]/g,"");if(!N)return"";const _=Number(N);return Number.isFinite(_)?_.toLocaleString("vi-VN"):""},[]);p.useEffect(()=>{e&&c({...o,import:d(o.import)})},[e,o,d]);const u=(y,N)=>{const _=N.target.value;if(y==="import"){c(S=>({...S,import:d(_)}));return}c(S=>({...S,[y]:_}))},h=(l.slotLinkMode==="slot"||l.slotLinkMode==="information")&&!(l.informationUser??"").trim()?"Khi chọn Match theo Slot hoặc Information, Thông tin gói (Tài khoản) là bắt buộc.":null,f=y=>{y.preventDefault(),!h&&i(l)},m=y=>{c(N=>({...N,slotLinkMode:y}))},g=["information","note","supplier","import","expired"].some(y=>r.fields.includes(y)),v=r.fields.includes("capacity"),b=g||v,w=g&&v;return s.jsx(Ag,{open:e,title:`${t==="add"?"Thêm Gói":"Sửa Gói"} - ${r.name}`,onClose:a,footer:s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hủy"}),s.jsx("button",{type:"submit",onClick:f,disabled:!!h,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:t==="add"?"Lưu gói":"Lưu thay đổi"})]}),children:s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[b&&s.jsxs("div",{className:`grid grid-cols-1 gap-4 ${w?"md:grid-cols-2":""}`,children:[g&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tiết gói"}),s.jsx("p",{className:"text-xs text-white/80",children:"Nhập các trường mô tả liên quan đến gói này."})]}),r.fields.includes("information")&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),s.jsx("input",{type:"text",value:l.informationUser,onChange:y=>u("informationUser",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),s.jsx("input",{type:"text",value:l.informationPass,onChange:y=>u("informationPass",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),s.jsx("input",{type:"email",value:l.informationMail,onChange:y=>u("informationMail",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),s.jsx("input",{type:"text",value:l.note,onChange:y=>u("note",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi chú cho gói này"})]}),r.fields.includes("supplier")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nhà cung cấp"}),s.jsx("input",{type:"text",value:l.supplier,onChange:y=>u("supplier",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Giá nhập (VND)"}),s.jsx("input",{type:"text",inputMode:"numeric",value:l.import,onChange:y=>u("import",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngày hết hạn"}),s.jsx("input",{type:"date",value:l.expired,onChange:y=>u("expired",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),v&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),s.jsx("p",{className:"text-xs text-white/80",children:"Cung cấp thông tin tài khoản dung lượng."})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tài khoản"}),s.jsx("input",{type:"text",value:l.accountUser,onChange:y=>u("accountUser",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tên đăng nhập"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu"}),s.jsx("input",{type:"text",value:l.accountPass,onChange:y=>u("accountPass",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mật khẩu"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),s.jsx("input",{type:"email",value:l.accountMail,onChange:y=>u("accountMail",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),s.jsx("textarea",{value:l.accountNote,onChange:y=>u("accountNote",y),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi chú cho tài khoản dung lượng"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lượng (GB)"}),s.jsx("input",{type:"number",min:0,value:l.capacity,onChange:y=>u("capacity",y),placeholder:`Mặc định: ${rs}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số vị trí (slot)"}),s.jsx("input",{type:"number",min:0,value:l.slot,onChange:y=>u("slot",y),placeholder:`Mặc định: ${ts}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Chọn chế độ ghép lệnh"}),s.jsx("p",{className:"text-xs text-white/80",children:"Chọn phương thức kết nối giữa gói và đơn hàng."})]})}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:UV.map(y=>{const N=l.slotLinkMode===y.value;return s.jsxs("button",{type:"button",onClick:()=>m(y.value),className:`border rounded-lg p-3 text-left transition ${N?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[s.jsx("span",{className:"block text-sm font-semibold",children:y.label}),s.jsx("span",{className:"block text-xs text-white/70 mt-1",children:y.helper})]},y.value)})}),s.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[s.jsx("b",{children:"Link theo thông tin đơn hàng:"})," So khớp thông tin gói (tài khoản, mail, v.v.) với chi tiết trong đơn hàng.",s.jsx("br",{}),s.jsx("b",{children:"Link theo vị trí:"})," So khớp thông tin gói với mã vị trí (slot) khai báo trong đơn hàng.",s.jsx("br",{})]}),h&&s.jsx("p",{className:"text-sm text-amber-400 mt-2",role:"alert",children:h})]}),r.fields.length===0&&s.jsx("p",{className:"text-sm text-white/80",children:"Loại gói này không có trường dữ liệu nào được cấu hình."})]})})},tK=({open:e,row:t,onClose:r})=>{if(!e||!t)return null;const n=[{label:"Tài khoản",value:t.informationUser},{label:"Mật khẩu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi chú",value:t.note},{label:"Nguồn",value:t.supplier},{label:"Giá nhập",value:t.import},{label:"Ngày hết hạn",value:kg(t.expired)}],a=[{label:"Tài khoản",value:t.accountUser},{label:"Mật khẩu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi chú",value:t.accountNote}],i=!!t.hasCapacityField,o=t.capacityLimit||rs,l=t.capacityUsed||0,c=t.remainingCapacity||0,d=o>0?Math.min(c/o*100,100):0,u=Tg(c,o),h=u==="out"?"bg-red-500":u==="low"?"bg-yellow-500":"bg-green-500";return s.jsx(Ag,{open:e,title:`Chi Tiết Gói: ${t.package}`,onClose:r,footer:s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"Đóng"}),children:s.jsxs("div",{className:`grid grid-cols-1 gap-4 ${i?"md:grid-cols-2":""}`,children:[s.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thông tin gói"}),s.jsx("p",{className:"text-xs text-white/80",children:"Các trường dữ liệu được lưu cho gói này."})]}),s.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(f=>s.jsxs("div",{children:[s.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:f.label}),s.jsx("dd",{className:"text-sm font-medium text-white break-words",children:f.value!==null&&f.value!==void 0&&f.value!==""?f.value:"-"})]},f.label))})]}),i&&s.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-semibold text-white",children:"Tài khoản dung lượng"}),s.jsx("p",{className:"text-xs text-white/80",children:"Tổng quan về tài khoản dung lượng."})]}),s.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:a.map(f=>s.jsxs("div",{children:[s.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:f.label}),s.jsx("dd",{className:"text-sm font-medium text-white break-words",children:f.value!==null&&f.value!==void 0&&f.value!==""?f.value:"-"})]},f.label))}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"text-sm text-white",children:[s.jsx("span",{className:"font-semibold",children:l})," /"," ",o," GB"]}),s.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full ${h}`,style:{width:`${d}%`}})}),s.jsxs("div",{className:"text-xs text-white/80",children:["Còn trống: ",c," GB"]})]})]})]})})},b4=(e,t)=>{const r=e.base;return r?.id!==void 0&&r?.id!==null?`id:${r.id}`:r?.id_order!==void 0&&r?.id_order!==null?`code:${r.id_order}`:`${e.productKey||e.infoKey}-${t}`};function rK(e,t){if(e.size===0)return[];const r=new Map;return e.forEach(n=>{const a=t.get(n);a?.length&&a.forEach(i=>{const o=b4(i,r.size);r.has(o)||r.set(o,i)})}),Array.from(r.values())}function y4(e){return e==="information"?"information":"slot"}function nK(e){return e==="information"?"slot":"information"}function aK(e,t){const r=Yl(t.package??""),n=t.normalizedProductCodes??[],a=n.length>0?new Set(n):null;return a?.size&&e.productCodeNormalized&&a.has(e.productCodeNormalized)?!0:!r||!e.productCodeNormalized?!1:e.productCodeNormalized===r}function iK(e,t){const r=g4(t);if(r.length===0)return!0;const n=t.slotLinkMode??"information",i=y4(n)==="slot"?e.slotMatchKey:e.informationMatchKey;return i?r.some(o=>o===i||o.includes(i)||i.includes(o)):!1}function sK(e){const{item:t,orderMatchers:r,ordersByProductCode:n,ordersReady:a}=e,i=!!t.hasCapacityField,o=na(t.slot),l=o&&o>0?Math.floor(o):ts,c=na(t.slotUsed),d=Yl(t.package??""),u=t.slotLinkMode??"information",h=nK(u),f=y4(u);g4(t);const m=t.normalizedProductCodes??[],x=m.length>0?new Set(m):null,g=a&&r.length>0&&(x!=null&&x.size>0||d.length>0),v=R=>aK(R,{...t,normalizedProductCodes:m}),b=R=>iK(R,{...t,slotLinkMode:u}),w=g&&x?.size?rK(x,n):null,y=g?(()=>{const R=new Map,G=V=>{const X=b4(V,R.size);R.has(X)||R.set(X,V)};return w?.forEach(G),r.forEach(V=>{v(V)&&G(V)}),Array.from(R.values()).filter(b)})():[],N=new Set,_=[];g&&y.forEach(R=>{const G=zV(R,h),X=(f==="slot"?R.slotDisplay:R.informationDisplay)||R.customerDisplay||"",K=R.base?.id!==void 0&&R.base?.id!==null?`id:${R.base.id}`:R.base?.id_order!==void 0&&R.base?.id_order!==null?`code:${R.base.id_order}`:`${X}-${_.length}`;if(N.has(K))return;N.add(K);const Y=G||X,q=WV(R,h,Y);if(q.length===0)return;const Z=i?VV(d,R):null;q.forEach(le=>{const ce=le||Y||"";ce&&_.push({slotLabel:ce,matchValue:X||ce,sourceOrderId:R.base?.id??null,sourceOrderCode:R.base?.id_order??null,displayColumn:h,matchColumn:f,capacityUnits:Z})})});const S=_.length>0?_.length:c!==null?Math.max(Math.floor(c),0):0,j=Math.min(S,l),E=Math.max(l-j,0);let k=0,T=0,A=0;if(i){const R=na(t.capacity);k=R&&R>0?Math.floor(R):rs;const G=na(t.capacityUsed),V=_.length>0?_.reduce((K,Y)=>K+(Y.capacityUnits??Jm),0):S*Jm,X=Math.min(V,k);T=Math.min(Math.max(G!==null?Math.floor(G):X,0),k),A=Math.max(k-T,0)}const C=g?y.map(R=>R.base):[];return{slotUsed:j,slotLimit:l,remainingSlots:E,capacityLimit:k,capacityUsed:T,remainingCapacity:A,slotAssignments:_,matchedOrders:C,packageCode:d,hasCapacityField:i,productCodes:t.productCodes??[],normalizedProductCodes:m,matchModeValue:t.matchModeValue??t.match??null}}const oK=()=>{const[e,t]=p.useState(""),[r,n]=p.useState("all"),[a,i]=p.useState("all"),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,h]=p.useState([]),[f,m]=p.useState(!0),[x,g]=p.useState(!0),[v,b]=p.useState(!1),[w,y]=p.useState(()=>YV()),N=p.useRef(w),_=p.useRef(!0),S=p.useMemo(()=>Wu.map(ee=>ee.value),[]);p.useEffect(()=>{N.current=w},[w]),p.useEffect(()=>()=>{_.current=!1},[]);const j=p.useCallback((ee,oe)=>{const he=String(ee);y(O=>{if(O[he]===oe)return O;const I={...O,[he]:oe};return qV(I),I})},[]);p.useEffect(()=>{let ee=!1;return(async()=>{try{m(!0);const oe=await Ue("/api/package-products");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const he=await oe.json();if(!ee)if(Array.isArray(he)){const O=he.map(I=>C2(I,N.current));l(O)}else l([])}catch(oe){if(console.error("Tải sản phẩm gói thất bại:",oe),!ee){const{handleNetworkError:he}=await Xc(async()=>{const{handleNetworkError:O}=await import("./errorHandler-Dx5Ymd-k.js");return{handleNetworkError:O}},[]);console.error(he(oe)),l([])}}finally{ee||m(!1)}})(),()=>{ee=!0}},[]),p.useEffect(()=>{let ee=!1;return(async()=>{try{g(!0),b(!1);const oe=await Ue("/api/orders");if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const he=await oe.json();ee||(Array.isArray(he)?d(he):d([]),b(!0))}catch(oe){console.error("Tải danh sách đơn hàng thất bại:",oe),ee||(d([]),b(!1))}finally{ee||g(!1)}})(),()=>{ee=!0}},[]);const E=p.useCallback(async()=>{if(_.current){g(!0),b(!1);try{const ee=await Ue("/api/orders");if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const oe=await ee.json();if(!_.current)return;Array.isArray(oe)?d(oe):d([]),b(!0)}catch(ee){console.error("Failed to refresh orders for packages:",ee),_.current&&(d([]),b(!1))}finally{_.current&&g(!1)}}},[]);p.useEffect(()=>DV(["orders"],()=>{E()}),[E]);const k=p.useMemo(()=>Array.from(new Set(o.map(ee=>ee.package))).sort(),[o]);p.useEffect(()=>{h(ee=>{const oe=new Map(ee.map(O=>[O.name,O]));let he=!1;return k.forEach(O=>{if(!O)return;const L=o.find(J=>J.package===O)?.productId??null,F=o.some(J=>J.package===O&&J.hasCapacityField),W=oe.get(O);if(!W){const J=F?S:Zm(S);oe.set(O,{name:O,productId:L,fields:J,isCustom:!1}),he=!0;return}if(W.isCustom!==!0&&!F&&W.fields.includes("capacity")){const J=Zm(W.fields);oe.set(O,{...W,productId:W.productId??L,fields:J}),he=!0}}),he?Array.from(oe.values()).sort((O,I)=>O.name.localeCompare(I.name)):ee})},[k,o,S]);const T=p.useMemo(()=>c.map(ee=>{const oe=ee.id_product??ee.idProduct??"",he=ee.information_order??ee.informationOrder??"",O=ee.slot,I=_2(oe),L=_2(he);return{base:ee,productKey:I.normalized,productLettersKey:I.lettersOnly,infoKey:L.normalized,infoLettersKey:L.lettersOnly,slotDisplay:hi(O),slotKey:j2(O),slotMatchKey:Qm(O),informationDisplay:hi(he),informationKey:j2(he),informationMatchKey:Qm(he),customerDisplay:hi(ee.customer),productCodeNormalized:v4(oe)}}),[c]),A=p.useMemo(()=>{const ee=new Map;return T.forEach(oe=>{if(!oe.productCodeNormalized)return;const he=oe.productCodeNormalized;ee.has(he)||ee.set(he,[]),ee.get(he).push(oe)}),ee},[T]),C=p.useMemo(()=>o.map(ee=>({...ee,...sK({item:ee,orderMatchers:T,ordersByProductCode:A,ordersReady:v})})),[o,T,v,A]),R=r!=="all"?r:null,G=p.useMemo(()=>R?u.find(ee=>ee.name===R)??null:null,[u,R]),V=p.useMemo(()=>R?C.filter(ee=>ee.package===R):C,[C,R]),X=p.useMemo(()=>V.filter(ee=>{const oe=e.trim().toLowerCase(),he=[ee.information,ee.informationUser,ee.informationMail,ee.informationPass,ee.accountUser,ee.accountMail,ee.accountPass,ee.note],O=oe.length===0||he.some(W=>(W==null?"":String(W)).toLowerCase().includes(oe)),I=r==="all"||ee.package===r,L=Us(ee.remainingSlots);return O&&I&&(a==="all"||a==="full"&&L==="ok"||a===L)}),[V,e,r,a]),K=p.useMemo(()=>[...X].sort((ee,oe)=>{const he=Number(ee.remainingSlots),O=Number(oe.remainingSlots),I=Number.isFinite(he)?he:Number.POSITIVE_INFINITY,L=Number.isFinite(O)?O:Number.POSITIVE_INFINITY,F=I<=0?Number.POSITIVE_INFINITY:I,W=L<=0?Number.POSITIVE_INFINITY:L;return F===W?0:F-W}),[X]),q=X.some(ee=>ee.hasCapacityField??!1)||X.length===0&&(G?.fields.includes("capacity")??!1),Z=q?9:8,le=p.useMemo(()=>{const ee=V.reduce((he,O)=>Us(O.remainingSlots)==="low"?he+1:he,0),oe=V.reduce((he,O)=>Us(O.remainingSlots)==="out"?he+1:he,0);return{total:V.length,low:ee,out:oe}},[V]),ce=p.useMemo(()=>{const ee=new Set;return C.forEach(oe=>{const he=(oe.package||"").trim();he&&ee.add(he)}),u.forEach(oe=>{oe.name&&ee.add(oe.name)}),Array.from(ee).sort((oe,he)=>oe.localeCompare(he))},[C,u]),pe=p.useMemo(()=>{const ee=new Map;return ce.forEach(oe=>ee.set(oe,{total:0,low:0,out:0})),C.forEach(oe=>{const he=(oe.package||"").trim();if(!he)return;const O=ee.get(he);if(!O)return;O.total+=1;const I=Us(oe.remainingSlots);I==="low"&&(O.low+=1),I==="out"&&(O.out+=1)}),ce.map(oe=>({name:oe,...ee.get(oe)??{total:0,low:0,out:0}}))},[ce,C]),Ne=p.useCallback(ee=>C2(ee,N.current),[]);return{data:{rows:o,templates:u,computedRows:C,filteredRows:X,sortedRows:K,scopedRows:V,selectedPackage:R,selectedTemplate:G,packageSummaries:pe,slotStats:le,showCapacityColumn:q,tableColumnCount:Z,loading:f||x,packagesLoading:f,ordersLoading:x,ordersReady:v,defaultTemplateFields:S},filters:{searchTerm:e,categoryFilter:r,statusFilter:a},actions:{setSearchTerm:t,setCategoryFilter:n,setStatusFilter:i,setRows:l,setTemplates:h,persistSlotLinkPreference:j,applySlotLinkPrefs:Ne}}},k2=[{border:"border-sky-500/30",glow:"bg-sky-500/20",link:"text-sky-400 hover:text-sky-300"},{border:"border-emerald-500/30",glow:"bg-emerald-500/20",link:"text-emerald-400 hover:text-emerald-300"},{border:"border-violet-500/30",glow:"bg-violet-500/20",link:"text-violet-400 hover:text-violet-300"},{border:"border-amber-500/30",glow:"bg-amber-500/20",link:"text-amber-400 hover:text-amber-300"}],lK=()=>{const{data:{rows:e,templates:t,filteredRows:r,sortedRows:n,selectedPackage:a,selectedTemplate:i,packageSummaries:o,slotStats:l,showCapacityColumn:c,tableColumnCount:d,loading:u,defaultTemplateFields:h},filters:{searchTerm:f,categoryFilter:m,statusFilter:x},actions:{setSearchTerm:g,setCategoryFilter:v,setStatusFilter:b,setRows:w,setTemplates:y,persistSlotLinkPreference:N,applySlotLinkPrefs:_}}=oK(),[S,j]=p.useState(!1),[E,k]=p.useState(null),[T,A]=p.useState(""),[C,R]=p.useState(Wu.map(ge=>ge.value)),[G,V]=p.useState("create"),[X,K]=p.useState(!1),[Y,q]=p.useState(!1),[Z,le]=p.useState(null),[ce,pe]=p.useState(!1),[Ne,ee]=p.useState(null),[oe,he]=p.useState(!1),[O,I]=p.useState(!1),[L,F]=p.useState(new Set),[W,J]=p.useState(null),[se,ke]=p.useState(!1),[ye,Pe]=p.useState(null),ue=pp(),Be=BN();p.useEffect(()=>{const Ge=new URLSearchParams(ue.search).get("package")||"all";v(ze=>ze===Ge?ze:Ge)},[ue.search,v]);const Ve=p.useCallback(ge=>{const Ke=ge==="all"||m===ge?"all":ge;Ke!==m&&v(Ke);const Ge=new URLSearchParams(ue.search);Ke==="all"?Ge.delete("package"):Ge.set("package",Ke);const ze=Ge.toString(),Qe=ze?`?${ze}`:"";Qe!==ue.search&&Be({pathname:ue.pathname,search:Qe},{replace:!0})},[m,ue.pathname,ue.search,Be,v]),ve=()=>{if(a&&i){fe({productId:i.productId??null,name:a,fields:i.fields,mode:"edit"});return}fe()},we=()=>{if(a){if(!i){fe({productId:null,name:a,fields:h,mode:"create"});return}K(!0)}},fe=p.useCallback(ge=>{k(ge?.productId??null),A(ge?.name??""),R(ge?.fields&&ge.fields.length>0?ge.fields:h),V(ge?.mode??"create"),j(!0)},[h]),Ce=p.useCallback(async(ge,Ke,Ge)=>{if(!(!Number.isFinite(ge)||ge<1))try{const ze=await Ue("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageId:ge,slotLimit:0,matchMode:null,informationUser:null,informationPass:null,informationMail:null,note:null,supplier:null,importPrice:null,expired:null})});if(!ze.ok)throw new Error(`HTTP ${ze.status}`);const Qe=await ze.json();w(Fr=>[...Fr,Qe]),j(!1),Ve(Qe.package??Ke)}catch(ze){console.error("Tạo loại gói thất bại:",ze),br({type:"error",title:"Lỗi tạo loại gói",message:ze instanceof Error?ze.message:"Không thể tạo loại gói."})}},[Ve,w]),me=p.useCallback(ge=>{const Ke=t.find(Ge=>Ge.name===ge)??null;fe({productId:Ke?.productId??null,name:ge,fields:Ke?.fields??h,mode:"edit"})},[t,fe,h]),We=p.useCallback(()=>{he(!1),F(new Set)},[]),Oe=p.useCallback(ge=>{const Ke=ge.trim();Ke&&F(Ge=>{const ze=new Set(Ge);return ze.has(Ke)?ze.delete(Ke):ze.add(Ke),ze})},[]),Ae=p.useCallback(async()=>{if(L.size===0){We();return}I(!0);const ge=Array.from(L),Ke=ge.map(Ge=>e.find(ze=>(ze.package||"").trim()===Ge)?.productId).filter(Ge=>Ge!=null&&Number.isFinite(Ge));if(Ke.length===0){I(!1),We();return}try{const Ge=await Ue("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageIds:Ke})});if(!Ge.ok){const ze=await Ge.text();throw new Error(ze||`HTTP ${Ge.status}`)}w(ze=>ze.filter(Qe=>!Ke.includes(Qe.productId??-1))),y(ze=>ze.filter(Qe=>!Ke.includes(Qe.productId??-1))),a&&ge.includes(a)&&Ve("all")}catch(Ge){console.error("Xóa nhóm thất bại:",Ge),br({type:"error",title:"Lỗi xóa loại gói",message:`Xóa nhóm thất bại: ${Ge instanceof Error?Ge.message:"Lỗi không xác định"}`})}finally{I(!1),We()}},[L,We,a,Ve,w,y,e]),Ye=p.useCallback(ge=>{const Ke=t.find(Ge=>Ge.name===ge.package)??{name:ge.package,fields:ge.hasCapacityField?h:Zm(h),isCustom:!1};le({rowId:ge.id,template:Ke,initialValues:XV(ge),accountStorageId:ge.accountStorageId??null}),q(!0)},[t,h]),ct=p.useCallback(()=>{q(!1),le(null)},[]),He=p.useCallback(ge=>{ee(ge),pe(!0)},[]),ut=p.useCallback(()=>{pe(!1),ee(null)},[]),wn=p.useCallback(ge=>{Pe(null),J(ge)},[]),ti=p.useCallback(()=>{ke(!1),Pe(null),J(null)},[]),Fn=p.useCallback(async()=>{if(!W||se)return;const ge=W.id,Ke=(W.package||"").trim();if(ge==null){Pe("Không tìm thấy ID gói để xóa.");return}ke(!0);const Ge=async ze=>{const Qe=await ze.text().catch(()=>""),Fr=Qe?Qe.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim():"",ln=ze.status?` (HTTP ${ze.status})`:"",Nn=Fr||ze.statusText||"Không thể thực hiện xóa trên máy chủ";throw new Error(`Không thể xóa gói${ln}: ${Nn}`)};try{const ze=await Ue(`/api/package-products/${ge}`,{method:"DELETE"});ze.ok||await Ge(ze);const Qe=await ze.json().catch(()=>({}));console.log("Delete package product response",{targetId:ge,targetName:Ke,data:Qe});const Fr=new Set((Qe.deletedIds&&Qe.deletedIds.length?Qe.deletedIds:[ge]).map(ln=>String(ln)));w(ln=>ln.filter(Nn=>{const va=Nn.id!==void 0&&Nn.id!==null?String(Nn.id):"__";return!Fr.has(va)})),ti()}catch(ze){console.error("Xóa gói thất bại:",ze),Pe(ze instanceof Error?ze.message:"Lỗi không xác định"),ke(!1)}},[se,W,w,y,a,Ve,ti,Pe]),ga=p.useCallback(async ge=>{if(!i)return;const Ke=i.fields.includes("capacity"),Ge=i.fields.includes("information"),ze=i.fields.includes("note"),Qe=i.fields.includes("supplier"),Fr=i.fields.includes("import"),ln=na(ge.slot),Nn=ln!==null&&ln>0?Math.floor(ln):ts,va=na(ge.capacity),ri=va!==null&&va>0?Math.floor(va):rs,ys=Ge?E2(ge.informationUser||null,ge.informationPass||null,ge.informationMail||null):"",Ci={packageId:i.productId??void 0,informationUser:Ge&&ge.informationUser||null,informationPass:Ge&&ge.informationPass||null,informationMail:Ge&&ge.informationMail||null,note:ze&&ge.note||null,supplier:Qe&&ge.supplier||null,importPrice:Fr?na(ge.import)??0:null,accountUser:Ke&&ge.accountUser||null,accountPass:Ke&&ge.accountPass||null,accountMail:Ke&&ge.accountMail||null,accountNote:Ke&&ge.accountNote||null,capacity:Ke?ri:null,hasCapacityField:Ke,expired:ge.expired||null,slotLimit:Nn,matchMode:_c(ge.slotLinkMode)};try{const Yn=await Ue("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ci)});if(!Yn.ok)throw new Error(`HTTP ${Yn.status}`);const cn=await Yn.json(),_o=_({...cn,slot:Nn,slotUsed:0,capacity:Ke?ri:cn.capacity,information:Ge?ys||null:cn.information,match:cn.match??_c(ge.slotLinkMode),hasCapacityField:Ke});w(ba=>[...ba,_o]),cn.id!==void 0&&cn.id!==null&&N(cn.id,ge.slotLinkMode),K(!1)}catch(Yn){console.error("Lỗi khi tạo gói sản phẩm:",Yn)}},[i,_,w,N]),bs=p.useCallback(async ge=>{if(!Z)return;const{template:Ke,rowId:Ge,accountStorageId:ze}=Z,Qe=Ke.fields.includes("capacity"),Fr=Ke.fields.includes("information"),ln=Ke.fields.includes("note"),Nn=Ke.fields.includes("supplier"),va=Ke.fields.includes("import"),ri=na(ge.slot),ys=ri!==null&&ri>0?Math.floor(ri):ts,Ci=na(ge.capacity),Yn=Ci!==null&&Ci>0?Math.floor(Ci):rs,cn=Fr?E2(ge.informationUser||null,ge.informationPass||null,ge.informationMail||null):"",_o={informationUser:Fr&&ge.informationUser||null,informationPass:Fr&&ge.informationPass||null,informationMail:Fr&&ge.informationMail||null,note:ln&&ge.note||null,supplier:Nn&&ge.supplier||null,importPrice:va?na(ge.import)??0:null,expired:ge.expired||null,slotLimit:ys,accountStorageId:ze??null,accountUser:Qe&&ge.accountUser||null,accountPass:Qe&&ge.accountPass||null,accountMail:Qe&&ge.accountMail||null,accountNote:Qe&&ge.accountNote||null,capacity:Qe?Yn:null,hasCapacityField:Qe,matchMode:_c(ge.slotLinkMode)};try{const ba=await Ue(`/api/package-products/${Ge}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_o)});if(!ba.ok)throw new Error(`HTTP ${ba.status}`);const ws=await ba.json(),P=_({...ws,slot:ys,capacity:Qe?Yn:ws.capacity,information:Fr?cn||null:ws.information,match:ws.match??_c(ge.slotLinkMode),hasCapacityField:Qe});w(B=>B.map(D=>D.id===Ge?P:D)),N(Ge,ge.slotLinkMode),ct()}catch(ba){console.error(`Cập nhật Gói Sản Phẩm ${Ge} Lỗi:`,ba)}},[Z,ct,_,w,N]),ec=p.useMemo(()=>[{name:"Tổng",value:String(l.total),icon:Vi,accent:wr.sky},{name:"Gói sắp hết",value:String(l.low),icon:wp,accent:wr.amber},{name:"Gói đã hết",value:String(l.out),icon:gp,accent:wr.rose},{name:"Thêm hôm nay",value:"0",icon:Jo,accent:wr.emerald}],[l]);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản lý Gói Sản phẩm"}),s.jsx("p",{className:"text-sm text-white/50",children:"Quản lý các loại gói sản phẩm và các gói con."})]}),s.jsx("div",{className:"rounded-[32px] glass-panel p-6 shadow-2xl border border-white/5",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:ec.map(ge=>s.jsx(Ca,{title:ge.name,value:ge.value,icon:ge.icon,accent:ge.accent},ge.name))})}),s.jsxs("div",{className:"glass-panel-dark rounded-3xl shadow-2xl p-6 text-white border border-white/5",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white tracking-tight",children:"Tổng quan các loại gói"}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Manage and organize your product categories"})]}),s.jsx(nn,{icon:Ra,onClick:ve,className:"!py-2 !px-4 text-xs shrink-0",children:"Tạo Loại Gói"})]}),o.length===0?s.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Không có loại gói nào được tìm thấy."}):s.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:o.map((ge,Ke)=>{const Ge=ge.name===a,ze=k2[Ke%k2.length],Qe=L.has(ge.name.trim());return s.jsxs("div",{className:`relative isolate rounded-[28px] border ${ze.border} bg-white/5 p-6 text-white shadow-xl backdrop-blur-xl transition-all duration-300 hover:scale-[1.02] ${Ge?"ring-2 ring-indigo-500/50 shadow-indigo-500/20":"hover:bg-white/10 border-white/10"}`,children:[s.jsx("div",{className:`absolute -right-8 -top-8 h-24 w-24 rounded-full blur-[40px] opacity-10 ${ze.glow}`}),s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-[10px] font-bold uppercase tracking-[0.2em] text-indigo-300/50",children:"Loại Gói"}),s.jsx("h3",{className:"text-xl font-bold tracking-tight mt-1",children:ge.name}),s.jsxs("p",{className:"mt-1 text-sm font-medium text-white/40",children:["Số lượng: ",ge.total]})]}),oe?s.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:Qe,disabled:O,onChange:()=>Oe(ge.name)}),"Chọn để xóa"]}):s.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:()=>Ve(ge.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${Ge?"text-blue-300":"text-white/80"}`,title:"Xem chi tiết",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:()=>me(ge.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chỉnh sửa Loại Gói",children:s.jsx(cr,{className:"h-5 w-5"})})]})})]}),s.jsxs("dl",{className:"mt-6 grid grid-cols-3 gap-3 text-sm",children:[s.jsxs("div",{className:"rounded-2xl border border-white/5 bg-white/5 p-3 text-center transition-colors hover:bg-white/10",children:[s.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-indigo-300/40",children:"Tổng"}),s.jsx("dd",{className:"mt-1 text-xl font-bold text-white",children:ge.total})]}),s.jsxs("div",{className:"rounded-2xl border border-amber-500/10 bg-amber-500/5 p-3 text-center transition-colors hover:bg-amber-500/10",children:[s.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-amber-500/60",children:"Sắp hết"}),s.jsx("dd",{className:"mt-1 text-xl font-bold text-amber-400",children:ge.low})]}),s.jsxs("div",{className:"rounded-2xl border border-rose-500/10 bg-rose-500/5 p-3 text-center transition-colors hover:bg-rose-500/10",children:[s.jsx("dt",{className:"text-[9px] font-bold uppercase tracking-widest text-rose-500/60",children:"Hết"}),s.jsx("dd",{className:"mt-1 text-xl font-bold text-rose-400",children:ge.out})]})]})]},ge.name)})})]}),a&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:`Tìm kiếm trong các gói của ${a}...`,className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:f,onChange:ge=>g(ge.target.value)})]}),s.jsxs("div",{className:"flex w-full lg:w-auto gap-3 items-center",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx("div",{className:"relative w-full lg:w-[180px]",children:s.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:x,onChange:ge=>b(ge.target.value),children:N2.map(ge=>s.jsx("option",{value:ge.value,className:"bg-slate-900 text-white",children:ge.label},ge.value))})})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),oe?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:Ae,className:"flex items-center justify-center gap-1 rounded-xl bg-emerald-500/80 px-3 py-2 text-sm font-semibold text-white shadow-lg hover:bg-emerald-600 transition disabled:opacity-60",disabled:O,title:"Xác nhận xóa",children:s.jsx(Wn,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:We,className:"flex items-center justify-center gap-1 rounded-xl bg-white/10 px-3 py-2 text-sm font-semibold text-white shadow-lg hover:bg-white/20 transition disabled:opacity-60",disabled:O,title:"Hủy xóa",children:s.jsx(Pt,{className:"h-5 w-5"})})]}):s.jsx(nn,{icon:Xr,onClick:()=>{he(!0),F(new Set)},disabled:O,className:"!py-2 !px-4 text-xs",children:"Xóa Loại gói"}),s.jsx(nn,{icon:Ra,onClick:we,disabled:!a,className:"!py-2 !px-4 text-xs",children:"Thêm Gói"}),s.jsx("button",{className:`px-4 py-2 rounded-xl text-xs font-semibold transition-all border ${r.length?"bg-white/5 text-white border-white/10 hover:bg-white/10":"bg-white/5 text-white/30 border-white/5 cursor-not-allowed"}`,disabled:!r.length,children:"Xuất Excel"})]})]})}),s.jsxs("div",{className:"text-xs font-medium text-indigo-300/60 flex items-center gap-2 px-4 py-1",children:[s.jsx("span",{className:"opacity-70",children:"Đang xem:"}),s.jsx("span",{className:"text-indigo-300",children:a}),x!=="all"&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-white/20",children:"/"}),s.jsx("span",{className:"text-indigo-300",children:N2.find(ge=>ge.value===x)?.label})]})]}),s.jsx(QV,{rows:n,loading:u,showCapacityColumn:c,tableColumnCount:d,onEdit:Ye,onView:He,onDelete:wn})]}),s.jsx(eK,{open:S,initialProductId:E,initialName:T,initialFields:C,mode:G,onClose:()=>j(!1),onSubmit:Ce}),i&&s.jsx(T2,{mode:"add",open:X,template:i,onClose:()=>K(!1),onSubmit:ga}),Y&&Z&&s.jsx(T2,{mode:"edit",open:Y,template:Z.template,initialValues:Z.initialValues,onClose:ct,onSubmit:bs}),s.jsx(tK,{open:ce,row:Ne,onClose:ut}),s.jsx(d4,{isOpen:!!W,onClose:ti,onConfirm:Fn,title:"Xác nhận xóa gói",message:`Bạn có chắc muốn xóa gói "${W?.package}"?`,secondaryMessage:ye||void 0,confirmLabel:"OK",cancelLabel:"Hủy",isSubmitting:se})]})},cK=({searchTerm:e,onSearchChange:t,onAddCategoryClick:r})=>s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:"Tìm kiếm theo tên hoặc mã sản phẩm...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:n=>t(n.target.value)})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),r&&s.jsx("button",{className:"px-5 py-2.5 bg-white/5 border border-white/10 hover:bg-white/10 text-white text-sm font-semibold rounded-2xl transition-all flex items-center gap-2",onClick:r,type:"button",children:"Thêm Danh Mục"})]})]})}),uK=({viewMode:e,onViewModeChange:t})=>s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("button",{type:"button",onClick:()=>t("products"),"aria-pressed":e==="products",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="products"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:"Sản phẩm"}),s.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Hiển thị thông tin sản phẩm"})]}),s.jsxs("button",{type:"button",onClick:()=>t("categories"),"aria-pressed":e==="categories",className:`rounded-2xl border px-5 py-4 text-left transition-all ${e==="categories"?"border-blue-400/50 bg-blue-500/15 shadow-lg shadow-blue-500/10":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:"Danh mục"}),s.jsx("p",{className:"mt-1 text-xs text-white/60",children:"Danh sách sản phẩm theo danh mục"})]})]}),ep=(e,t,r)=>Math.min(Math.max(e,t),r),dK=(e,t)=>{const r=[];if(e<=5){for(let i=1;i<=e;i++)r.push(i);return r}const n=ep(t-1,2,e-3),a=ep(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let i=n;i<=a;i++)r.push(i);return a<e-1&&r.push("..."),r.push(e),r};function gi({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:a=""}){const i=r>0?r:10,o=Math.max(1,Math.ceil(t/i)),l=ep(e,1,o),c=l>1,d=l<o,u="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition disabled:opacity-40 disabled:cursor-not-allowed",h="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition",f="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]",m=t===0?0:(l-1)*i+1,x=Math.min(l*i,t),g=dK(o,l);return s.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${a}`,children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("button",{className:u,onClick:()=>n(1),disabled:!c,children:"<<"}),s.jsx("button",{className:u,onClick:()=>n(l-1),disabled:!c,children:"<"}),s.jsx("div",{className:"flex items-center gap-1.5",children:g.map((v,b)=>v==="..."?s.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${b}`):s.jsx("button",{className:`${h} ${v===l?f:""}`,onClick:()=>n(v),disabled:v===l,children:v},v))}),s.jsx("button",{className:u,onClick:()=>n(l+1),disabled:!d,children:">"}),s.jsx("button",{className:u,onClick:()=>n(o),disabled:!d,children:">>"})]}),s.jsx("div",{className:"text-white/70",children:t===0?"0 mục":`${m}-${x} trong ${t}`})]})}const Vc=10,Qr=e=>(e||"").replace(/\n/g,"<br/>"),Ri=e=>(e||"").trim().toLowerCase(),mf=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Hs=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),a=o=>{if(o.nodeType===Node.TEXT_NODE)return mf(o.textContent||"");if(o.nodeType===Node.ELEMENT_NODE){const l=o;if(l.tagName==="BR")return"<br/>";if(l.tagName==="A"){const d=l.getAttribute("href")||"#",u=mf(d),h=Array.from(l.childNodes).map(a).join("");return`<a href="${u}" title="${u}" target="_blank" rel="noopener noreferrer">${h}</a>`}const c=Array.from(l.childNodes).map(a).join("");return n.has(l.tagName)?`${c}<br/>`:c}return""};return Array.from(r.body.childNodes).map(a).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return mf(e)}},pf=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=/(Thông tin\s*&\s*tên sản phẩm|thông tin sản phẩm|mô tả|nội dung|tên sản phẩm)/i,i=n.match(a),o=l=>l.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(i&&(i.index??0)>=3){const l=i.index??0,c=r.slice(0,l).trim(),d=r.slice(l).trim();return{rulesHtml:o(c),descriptionHtml:o(d)}}return{rulesHtml:e||"",descriptionHtml:t||""}},hK=(e,t,r)=>{const n=(r||"").toLowerCase().trim(),a=new Map;t.forEach(c=>{const d=Ri(c.san_pham||""),u=Ri(c.package_product||"");[d,u].filter(Boolean).forEach(f=>{a.has(f)||a.set(f,c)})});const i=[],o=new Set;for(const c of e){const d=Ri(c.productId||"");d&&o.add(d);const u=d?a.get(d):null;i.push({...c,priceId:u?.id??null,productId:c.productId||"",productName:c.productName||(u?u.package_product||u.san_pham||"":null)||c.productId,packageProduct:u?u.package_product||u.san_pham||"":null,packageName:u?u.package||u.san_pham||"":null,category:u?.category??null,categories:Array.isArray(u?.categories)?u?.categories??[]:[],imageUrl:c.imageUrl??null,packageImageUrl:c.imageUrl??null,rulesHtml:c.rulesHtml||Qr(c.rules||""),descriptionHtml:c.descriptionHtml||Qr(c.description||"")})}for(const c of t){const d=Ri(c.san_pham||""),u=Ri(c.package_product||""),h=d||u,f=d&&o.has(d)||u&&o.has(u);!h||f||i.push({id:c.id,priceId:c.id,productId:c.san_pham||"",productName:c.package_product||c.san_pham||"",packageProduct:c.package_product||c.san_pham||"",packageName:c.package||"",category:c.category??null,categories:Array.isArray(c.categories)?c.categories??[]:[],rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:null,packageImageUrl:null})}let l=i;return n&&(l=l.filter(c=>`${c.productId||""} ${c.productName||""} ${c.description||""} ${c.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),l},fK=({item:e,size:t="small"})=>{const r=e.productName||e.productId||"--",n=t==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs";return e.imageUrl?s.jsx("img",{src:e.imageUrl,alt:r,className:`${n} rounded-md object-cover`,onError:a=>{a.currentTarget.style.display="none"}}):null},mK=({item:e,isExpanded:t,onToggle:r,onEdit:n})=>{const a=e.packageProduct||e.productName||e.productId||"--",i=(e.packageName||"").trim(),o=e.rulesHtml||Qr(e.rules||""),l=e.descriptionHtml||Qr(e.description||""),{rulesHtml:c,descriptionHtml:d}=pf(o,l),u=Hs(c)||"Không có thông tin bán hàng",h=Hs(d||Qr(e.description||""))||"Không có thông tin sản phẩm";return s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{className:`product-row ${t?"product-row--expanded":""} hover:bg-white/5 cursor-pointer ${t?"bg-white/5":""}`,onClick:()=>r(t?null:Number(e.id)),children:[s.jsx("td",{className:"product-row__cell px-4 py-3",children:e.imageUrl?s.jsx("img",{src:e.imageUrl,alt:a,className:"h-12 w-12 rounded-lg object-cover",onError:f=>{f.currentTarget.style.display="none"}}):null}),s.jsx("td",{className:"px-4 py-3 text-white",children:s.jsx("div",{className:"flex flex-col",children:s.jsx("span",{className:"font-semibold text-white",children:e.productId||"--"})})}),s.jsx("td",{className:"px-4 py-3 text-white",children:a}),s.jsx("td",{className:"px-4 py-3 text-white/80 border-r border-white/10 min-w-[160px]",children:s.jsx("span",{className:"block truncate",title:i||void 0,children:i||"--"})}),s.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:s.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.rulesHtml?void 0:e.rules||"",dangerouslySetInnerHTML:{__html:u}})}),s.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:s.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.descriptionHtml?void 0:e.description||"",dangerouslySetInnerHTML:{__html:h}})}),s.jsxs("td",{className:"product-row__actions px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",title:"Xem",type:"button",children:s.jsx(dr,{className:"h-3.5 w-3.5"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-90",title:"Sửa",type:"button",onClick:f=>{f.stopPropagation(),n(e)},children:s.jsx(ls,{className:"h-3.5 w-3.5"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-8 h-8 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",title:"Xóa",type:"button",children:s.jsx(Xr,{className:"h-3.5 w-3.5"})})]})]}),t&&s.jsx("tr",{className:"bg-white/5",children:s.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin chi tiết"}),s.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:e.packageProduct||e.productName||e.productId||"Không có thông tin chi tiết."})]}),s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:s.jsx(fK,{item:e,size:"large"})}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy tắc bán hàng"}),s.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Hs(pf(e.rulesHtml||Qr(e.rules||""),e.descriptionHtml||Qr(e.description||"")).rulesHtml)||"Không có quy tắc bán hàng."}})]}),s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Thông tin sản phẩm"}),s.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Hs(pf(e.rulesHtml||Qr(e.rules||""),e.descriptionHtml||Qr(e.description||"")).descriptionHtml||Qr(e.description||""))||"Không có thông tin sản phẩm."}})]})]})]})]})})]},`${e.id}-${e.productId}`)},pK=({item:e,onEdit:t,onView:r})=>{const n=e.packageProduct||e.productName||e.productId||"--",a=(e.packageName||"").trim(),i=Hs(e.rulesHtml||Qr(e.rules||""))||"Không có thông tin bán hàng",o=Hs(e.descriptionHtml||Qr(e.description||""))||"Không có thông tin sản phẩm";return s.jsxs("div",{className:"product-card glass-panel-dark rounded-2xl p-4 border border-white/5 space-y-4 shadow-xl",children:[s.jsxs("div",{className:"product-card__header flex items-start gap-3",children:[e.imageUrl?s.jsx("img",{src:e.imageUrl,alt:n,className:"h-16 w-16 rounded-lg object-cover flex-shrink-0",onError:l=>{l.currentTarget.style.display="none"}}):null,s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-white text-base truncate",children:n}),s.jsxs("p",{className:"text-sm text-white/70 mt-1",children:["Mã: ",e.productId||"--"]}),a&&s.jsxs("p",{className:"text-xs text-white/60 mt-1",children:["Danh mục: ",a]})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs font-semibold text-white/80 uppercase tracking-wide",children:"Quy tắc bán hàng"}),s.jsx("div",{className:"text-sm text-white/70 line-clamp-2 rich-display",dangerouslySetInnerHTML:{__html:i}})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs font-semibold text-white/80 uppercase tracking-wide",children:"Mô tả"}),s.jsx("div",{className:"text-sm text-white/70 line-clamp-2 rich-display",dangerouslySetInnerHTML:{__html:o}})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 pt-3 border-t border-white/5",children:[r&&s.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-95",title:"Xem",type:"button",onClick:()=>r(e),children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-95",title:"Sửa",type:"button",onClick:()=>t(e),children:s.jsx(ls,{className:"h-4 w-4"})}),s.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-xl bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-95",title:"Xóa",type:"button",children:s.jsx(Xr,{className:"h-4 w-4"})})]})]})},xK=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,expandedId:o,onToggleExpand:l,onEdit:c})=>s.jsxs("div",{className:"product-table rounded-[32px] border border-white/5 bg-slate-900/40 shadow-2xl backdrop-blur-xl overflow-hidden",children:[s.jsxs("div",{className:"product-table__header border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[s.jsx("h2",{className:"product-table__title text-lg font-semibold text-white",children:"Sản phẩm"}),r&&s.jsx("span",{className:"product-table__loading text-xs text-white/60",children:"Đang tải..."})]}),s.jsx(Wa,{showCardOnMobile:!0,cardView:s.jsx(Si,{data:e,renderCard:d=>s.jsx(pK,{item:d,onEdit:c}),className:"p-2"}),children:s.jsxs("table",{className:"product-table__table min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[s.jsxs("colgroup",{children:[s.jsx("col",{style:{width:"10%"}}),s.jsx("col",{style:{width:"13%"}}),s.jsx("col",{style:{width:"15%"}}),s.jsx("col",{style:{width:"12%",minWidth:"160px"}}),s.jsx("col",{style:{width:"22%",minWidth:"240px"}}),s.jsx("col",{style:{width:"21%",minWidth:"240px"}}),s.jsx("col",{style:{width:"7%",minWidth:"120px"}})]}),s.jsx("thead",{className:"product-table__head bg-white/5 text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/40",children:s.jsxs("tr",{children:[s.jsx("th",{className:"product-table__th px-4 py-3 text-left font-semibold",children:"Hình ảnh"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Mã sản phẩm"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Tên sản phẩm"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold border-r border-white/10 min-w-[160px]",children:"Danh mục"}),s.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy tắc"}),s.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"Mô tả"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao tác"})]})}),s.jsxs("tbody",{className:"divide-y divide-white/5",children:[e.map(d=>s.jsx(mK,{item:d,isExpanded:o===d.id,onToggle:l,onEdit:c},`${d.id}-${d.productId}`)),!r&&e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có sản phẩm nào được hiển thị."})}),r&&e.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách sản phẩm..."})})]})]})}),s.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:s.jsx(gi,{currentPage:n,totalItems:t,pageSize:a,onPageChange:i})})]}),gK=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,expandedId:i,onPageChange:o,onToggleExpand:l,onEdit:c})=>s.jsx(xK,{products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:o,expandedId:i,onToggleExpand:l,onEdit:c}),vK=({categoryRows:e,allCategoryRows:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,onEditCategory:o,getCategoryColor:l})=>{const[c,d]=p.useState(null);return s.jsxs("div",{className:"category-table rounded-[32px] border border-white/5 bg-slate-900/40 shadow-2xl backdrop-blur-xl overflow-hidden",children:[s.jsxs("div",{className:"category-table__header border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[s.jsx("h2",{className:"category-table__title text-lg font-semibold text-white",children:"Danh Mục"}),r?s.jsx("span",{className:"text-xs text-white/60",children:"Đang tải..."}):s.jsxs("span",{className:"text-xs text-white/60",children:[t.length," danh mục"]})]}),s.jsx("div",{className:"category-table__inner overflow-x-auto",children:s.jsxs("table",{className:"category-table__table min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[s.jsxs("colgroup",{children:[s.jsx("col",{style:{width:"10%"}}),s.jsx("col",{style:{width:"30%"}}),s.jsx("col",{style:{width:"40%"}}),s.jsx("col",{style:{width:"20%",minWidth:"140px"}})]}),s.jsx("thead",{className:"category-table__head bg-white/5 text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/70",children:s.jsxs("tr",{children:[s.jsx("th",{className:"category-table__th px-4 py-3 text-left font-semibold",children:"Hình Ảnh"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Gói Sản Phẩm"}),s.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Danh Mục"}),s.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Thao Tác"})]})}),s.jsxs("tbody",{className:"divide-y divide-white/5",children:[!r&&t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/70",children:"Không có danh mục nào để hiển thị."})}),r&&t.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-sm text-white/80",children:"Đang tải danh sách danh mục..."})}),e.map(u=>s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{className:"hover:bg-white/5",children:[s.jsx("td",{className:"px-4 py-3",children:u.imageUrl?s.jsx("img",{src:u.imageUrl,alt:u.packageName,className:"h-12 w-12 rounded-lg object-cover",onError:h=>{h.currentTarget.style.display="none"}}):null}),s.jsx("td",{className:"px-4 py-3 text-white font-semibold",children:u.packageName}),s.jsx("td",{className:"px-4 py-3 text-white/80",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:(u.categories||[]).map((h,f)=>s.jsx("span",{className:"category-pill",style:{backgroundColor:l(h,f)},children:h.name},`${u.key}-${h.id||h.name}`))})}),s.jsxs("td",{className:"px-4 py-3 text-center",children:[s.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",onClick:()=>d(h=>h===u.key?null:u.key),children:s.jsx(dr,{className:"h-5 w-5 text-blue-400"})}),s.jsx("button",{className:"ml-2 inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",type:"button",onClick:()=>o(u),children:s.jsx(ls,{className:"h-5 w-5 text-green-400"})})]})]}),c===u.key&&s.jsx("tr",{className:"bg-white/5",children:s.jsx("td",{colSpan:3,className:"px-6 py-4",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-2",children:u.items.map(h=>{const f=h.productId||"",m=h.packageProduct||h.productName||h.productId||"";return s.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:f}),s.jsx("p",{className:"text-xs text-white/60 truncate",children:m})]},`${u.key}-${h.id}-${h.productId}`)})})})})]},u.key))]})]})}),!r&&t.length>0&&s.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:s.jsx(gi,{currentPage:n,totalItems:t.length,pageSize:a,onPageChange:i})})]})},xf=8,bK=({categoryRows:e,loading:t,onEditCategory:r,getCategoryColor:n})=>{const[a,i]=p.useState(1);p.useEffect(()=>{i(1)},[e.length]);const o=p.useMemo(()=>{const l=(a-1)*xf,c=l+xf;return e.slice(l,c)},[e,a]);return s.jsx(vK,{categoryRows:o,allCategoryRows:e,loading:t,currentPage:a,pageSize:xf,onPageChange:i,onEditCategory:r,getCategoryColor:n})},yK=({open:e,name:t,color:r,saving:n,error:a,onNameChange:i,onColorChange:o,onClose:l,onSave:c})=>{if(!e)return null;const d=(t||"").trim(),u=n||!d;return s.jsx("div",{className:"fixed inset-0 z-70 flex items-start justify-center bg-black/50 px-4 py-8",children:s.jsxs("div",{className:"w-full max-w-xl rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tạo danh mục mới"}),s.jsx("button",{type:"button",className:"rounded-full p-2 text-white/60 hover:text-white hover:bg-white/10 transition",onClick:l,"aria-label":"Đóng",children:s.jsx(Pt,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"px-5 py-5 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Tên danh mục"}),s.jsx("input",{type:"text",value:t,onChange:h=>i(h.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"Nhập tên danh mục"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/60 mb-2",children:"Màu sắc"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("input",{type:"color",value:r,onChange:h=>o(h.target.value),className:"h-10 w-14 rounded border border-white/10 bg-white/10"}),s.jsx("input",{type:"text",value:r,onChange:h=>o(h.target.value),className:"flex-1 rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-white placeholder:text-white/40 focus:outline-none focus:ring-2 focus:ring-blue-500/40",placeholder:"#facc15"}),s.jsx("div",{className:"h-10 w-10 rounded-lg border border-white/10",style:{backgroundColor:r||"#facc15"}})]})]}),a&&s.jsx("div",{className:"rounded-lg border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:a})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-4",children:[s.jsx("button",{type:"button",className:"rounded-lg border border-white/10 px-4 py-2 text-sm font-semibold text-white/70 hover:text-white hover:bg-white/10 transition",onClick:l,disabled:n,children:"Hủy bỏ"}),s.jsx("button",{type:"button",className:"rounded-lg bg-emerald-600 px-4 py-2 text-sm font-semibold text-white hover:bg-emerald-500 transition disabled:opacity-60",onClick:c,disabled:u,children:n?"Đang tạo...":"Tạo danh mục"})]})]})})},w4=async e=>{const t=new FormData;t.append("image",e);const r=await Ue("/api/product-images/upload",{method:"POST",body:t});if(!r.ok){const a=await r.text().catch(()=>"");throw new Error(Kr(a,{fallback:"Upload failed."}))}const n=await r.json().catch(()=>null);if(!n||typeof n.url!="string")throw new Error("Invalid upload response.");return n},N4=async()=>{const e=await Ue("/api/product-images");if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(Kr(r,{fallback:"Failed to load images."}))}const t=await e.json().catch(()=>null);return!t||!Array.isArray(t.items)?{items:[],count:0}:{items:t.items,count:typeof t.count=="number"&&Number.isFinite(t.count)?t.count:t.items.length}},_4=async e=>{const t=encodeURIComponent(e||""),r=await Ue(`/api/product-images/${t}`,{method:"DELETE"});if(!r.ok){const n=await r.text().catch(()=>"");throw new Error(Kr(n,{fallback:"Delete failed."}))}},wK=({open:e,images:t,selectedImage:r,loading:n,uploading:a,deleting:i,error:o,uploadError:l,onClose:c,onSelect:d,onUseSelected:u,onUploadClick:h,onDeleteSelected:f})=>e?s.jsx("div",{className:"fixed inset-0 z-[80] flex items-center justify-center bg-black/70 px-4 py-6",children:s.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-white/10 bg-[#0b1220] shadow-2xl",children:[s.jsx("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chọn hình ảnh sản phẩm"})}),s.jsxs("div",{className:"p-4 space-y-4",children:[n?s.jsx("p",{className:"text-sm text-white/70",children:"Đang tải hình ảnh..."}):t.length===0?s.jsx("p",{className:"text-sm text-white/70",children:"Chưa có hình ảnh nào."}):s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 max-h-[400px] overflow-y-auto",children:t.map(m=>{const x=r?.fileName===m.fileName;return s.jsxs("button",{type:"button",className:`rounded-xl border p-2 text-left transition ${x?"border-blue-400 ring-2 ring-blue-400/40":"border-white/10 hover:border-white/30"}`,onClick:()=>d(m),children:[s.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-lg bg-black/30",children:s.jsx("img",{src:m.url,alt:m.fileName,className:"h-full w-full object-contain"})}),s.jsx("p",{className:"mt-2 truncate text-xs text-white/70",children:m.fileName})]},m.fileName)})}),(o||l)&&s.jsxs("div",{className:"space-y-1",children:[o&&s.jsx("p",{className:"text-xs text-rose-300",children:o}),l&&s.jsx("p",{className:"text-xs text-rose-300",children:l})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"rounded-lg border border-white/40 bg-transparent px-4 py-2 text-sm font-semibold text-white/90 hover:border-white hover:text-white disabled:opacity-60",onClick:h,disabled:a,children:a?"Đang tải...":"Tải hình mới"}),s.jsx("button",{type:"button",className:"rounded-lg border border-rose-400/60 bg-transparent px-4 py-2 text-sm font-semibold text-rose-200 hover:border-rose-300 hover:text-rose-100 disabled:opacity-60",onClick:f,disabled:!r||i,children:i?"Đang xóa...":"Xoá hình đã chọn"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white/70 hover:text-white",onClick:c,children:"Hủy"}),s.jsx("button",{type:"button",className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:u,disabled:!r,children:"Sử dụng hình đã chọn"})]})]})]})]})}):null,NK=({imageUrl:e,onImageUrlChange:t})=>{const r=p.useRef(null),[n,a]=p.useState(!1),[i,o]=p.useState([]),[l,c]=p.useState(!1),[d,u]=p.useState(null),[h,f]=p.useState(null),[m,x]=p.useState(!1),[g,v]=p.useState(null),[b,w]=p.useState(!1),y=async T=>{c(!0),u(null);try{const A=await N4(),C=Array.isArray(A.items)?A.items:[];o(C);let R=T||h;R&&(R=C.find(G=>G.fileName===R?.fileName||G.url===R?.url)||null),!R&&e&&(R=C.find(G=>G.url===e)||null),!R&&C.length&&(R=C[0]),f(R)}catch(A){u(A instanceof Error?A.message:"Failed to load images."),o([])}finally{c(!1)}},N=()=>{a(!0),u(null),v(null),y()},_=()=>{a(!1)},S=()=>{r.current?.click()},j=async T=>{const A=T.target.files?.[0];if(A){x(!0),v(null);try{const C=await w4(A);t(C.url);const R=C.fileName?{fileName:C.fileName,url:C.url}:null;f(R),await y(R)}catch(C){v(C instanceof Error?C.message:"Upload failed.")}finally{x(!1),T.target.value=""}}},E=()=>{h&&(t(h.url),a(!1))},k=async()=>{if(!(!h||b)){w(!0),u(null);try{await _4(h.fileName),e===h.url&&t(""),await y(null)}catch(T){u(T instanceof Error?T.message:"Delete failed.")}finally{w(!1)}}};return s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold text-slate-300 uppercase tracking-wide mb-3",children:"Hình ảnh sản phẩm"}),s.jsxs("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 shadow-sm backdrop-blur-sm",children:[e?s.jsx("img",{src:e,alt:"Product",className:"h-full w-full object-contain p-3",onError:T=>{T.currentTarget.style.display="none"}}):s.jsx("div",{className:"flex h-full w-full items-center justify-center",children:s.jsx(XN,{className:"h-16 w-16 text-white/20"})}),s.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 hover:opacity-100 transition-opacity backdrop-blur-sm",onClick:N,children:s.jsx("span",{className:"rounded-xl border border-white/70 bg-black/60 px-4 py-2.5 text-sm font-semibold text-white shadow-lg backdrop-blur-sm",children:e?"Thay đổi":"Chọn ảnh"})}),s.jsx("input",{ref:r,type:"file",accept:"image/*",className:"hidden",onChange:j})]}),s.jsx(wK,{open:n,images:i,selectedImage:h,loading:l,uploading:m,deleting:b,error:d,uploadError:g,onClose:_,onSelect:f,onUseSelected:E,onUploadClick:S,onDeleteSelected:k})]})},_K=["#facc15","#f97316","#ef4444","#f43f5e","#a855f7","#8b5cf6","#3b82f6","#38bdf8","#14b8a6","#22c55e","#84cc16","#eab308"],A2=({value:e,onChange:t,label:r})=>s.jsxs("div",{className:"space-y-2",children:[r&&s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:r}),s.jsx("div",{className:"grid grid-cols-6 gap-2",children:_K.map(n=>s.jsx("button",{type:"button",onClick:()=>t(n),className:`h-10 w-full rounded-lg border-2 transition-all ${e===n?"border-white ring-2 ring-white/50 scale-110":"border-white/20 hover:border-white/40 hover:scale-105"}`,style:{backgroundColor:n},title:n},n))}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"color",value:e||"#facc15",onChange:n=>t(n.target.value),className:"h-10 w-16 rounded-lg border border-white/20 bg-slate-950/40 cursor-pointer"}),s.jsx("input",{type:"text",value:e||"",onChange:n=>t(n.target.value),placeholder:"#000000",className:"flex-1 rounded-lg border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-white placeholder:text-slate-400 focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all"})]})]}),jK=async()=>{const e=await Ue("/api/categories");if(!e.ok){const r=await e.text().catch(()=>"");throw new Error(r||`Failed to load categories (${e.status}).`)}const t=await e.json();return Array.isArray(t)?t:[]},SK=async e=>{const t=await Ue("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.text().catch(()=>"");throw new Error(r||`Failed to create category (${t.status}).`)}return await t.json()},EK=async(e,t)=>{const r=await Ue(`/api/categories/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const n=await r.text().catch(()=>"");throw new Error(n||`Failed to update category (${r.status}).`)}return await r.json()},CK=async e=>{const t=await Ue(`/api/categories/${e}`,{method:"DELETE"});if(!t.ok){const r=await t.text().catch(()=>"");throw new Error(r||`Failed to delete category (${t.status}).`)}},TK=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),[o,l]=p.useState(!1),[c,d]=p.useState(!1),[u,h]=p.useState(!1),f=p.useCallback(async()=>{n(!0),i(null);try{const v=await jK();t(v)}catch(v){i(v instanceof Error?v.message:"Failed to load categories"),t([])}finally{n(!1)}},[]),m=p.useCallback(async v=>{l(!0),i(null);try{const b=await SK(v);return await f(),b}catch(b){const w=b instanceof Error?b.message:"Failed to create category";throw i(w),b}finally{l(!1)}},[f]),x=p.useCallback(async(v,b)=>{d(!0),i(null);try{const w=await EK(v,b);return await f(),w}catch(w){const y=w instanceof Error?w.message:"Failed to update category";throw i(y),w}finally{d(!1)}},[f]),g=p.useCallback(async v=>{h(!0),i(null);try{await CK(v),await f()}catch(b){const w=b instanceof Error?b.message:"Failed to delete category";throw i(w),b}finally{h(!1)}},[f]);return{categories:e,loading:r,error:a,creating:o,updating:c,deleting:u,reload:f,create:m,update:x,remove:g}},kK=({onCategoriesChange:e})=>{const{categories:t,loading:r,error:n,creating:a,updating:i,deleting:o,reload:l,create:c,update:d,remove:u}=TK(),[h,f]=p.useState(null),[m,x]=p.useState(""),[g,v]=p.useState("#facc15"),[b,w]=p.useState(!1),[y,N]=p.useState(""),[_,S]=p.useState("#facc15"),[j,E]=p.useState(null);p.useEffect(()=>{l()},[l]);const k=X=>{f(X.id),x(X.name),v(X.color||"#facc15")},T=()=>{f(null),x(""),v("#facc15")},A=async()=>{if(!(!h||!m.trim()))try{await d(h,{name:m.trim(),color:g}),f(null),x(""),v("#facc15"),e?.()}catch{}},C=()=>{w(!0),N(""),S("#facc15")},R=()=>{w(!1),N(""),S("#facc15")},G=async()=>{if(y.trim())try{await c({name:y.trim(),color:_}),w(!1),N(""),S("#facc15"),e?.()}catch{}},V=async X=>{try{await u(X),E(null),e?.()}catch{}};return r&&t.length===0?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Đang tải danh mục..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-white",children:"Quản Lý Danh Mục"}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Thêm, sửa, hoặc xóa các danh mục sản phẩm"})]}),s.jsxs("button",{type:"button",onClick:C,disabled:b||a,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-5 py-3 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 hover:shadow-xl disabled:opacity-50",children:[s.jsx(Ra,{className:"h-4 w-4"}),"Thêm Danh Mục"]})]}),n&&s.jsxs("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-5 py-4 text-sm text-rose-200 flex items-start gap-3",children:[s.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s.jsx("span",{children:n})]}),b&&s.jsxs("div",{className:"rounded-2xl border border-indigo-400/50 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10 p-6 space-y-4 shadow-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Tên Danh Mục"}),s.jsx("input",{type:"text",value:y,onChange:X=>N(X.target.value),placeholder:"Nhập tên danh mục...",className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",autoFocus:!0})]}),s.jsx(A2,{label:"Màu Sắc",value:_,onChange:S}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:R,disabled:a,className:"px-5 py-2.5 text-sm font-semibold text-slate-300 hover:text-white transition-colors disabled:opacity-50",children:"Hủy"}),s.jsxs("button",{type:"button",onClick:G,disabled:!y.trim()||a,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:[s.jsx(Wn,{className:"h-4 w-4"}),a?"Đang tạo...":"Tạo"]})]})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.map(X=>{const K=h===X.id,Y=j===X.id;return K?s.jsxs("div",{className:"sm:col-span-2 rounded-2xl border border-indigo-400/50 bg-gradient-to-br from-indigo-500/10 via-purple-500/10 to-pink-500/10 p-6 space-y-4 shadow-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Tên Danh Mục"}),s.jsx("input",{type:"text",value:m,onChange:q=>x(q.target.value),className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all"})]}),s.jsx(A2,{label:"Màu Sắc",value:g,onChange:v}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-2",children:[s.jsx("button",{type:"button",onClick:T,disabled:i,className:"px-5 py-2.5 text-sm font-semibold text-slate-300 hover:text-white transition-colors disabled:opacity-50",children:"Hủy"}),s.jsxs("button",{type:"button",onClick:A,disabled:!m.trim()||i,className:"inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-2.5 text-sm font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:[s.jsx(Wn,{className:"h-4 w-4"}),i?"Đang lưu...":"Lưu"]})]})]},X.id):s.jsx("div",{className:"group rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm hover:border-white/25 transition-all",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"h-14 w-14 rounded-xl border-2 border-white/20 flex-shrink-0 shadow-md",style:{backgroundColor:X.color||"#facc15"}}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"text-base font-semibold text-white truncate",children:X.name}),s.jsx("p",{className:"text-xs text-slate-400 mt-1 font-mono",children:X.color||"#facc15"})]}),Y?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:()=>E(null),disabled:o,className:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-white/10 transition-colors disabled:opacity-50",title:"Hủy",children:s.jsx(Pt,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>V(X.id),disabled:o,className:"p-2 rounded-lg text-red-400 hover:text-red-300 hover:bg-red-500/20 transition-colors disabled:opacity-50",title:"Xác nhận xóa",children:s.jsx(Wn,{className:"h-4 w-4"})})]}):s.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{type:"button",onClick:()=>k(X),disabled:h!==null||i,className:"p-2 rounded-lg text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/20 transition-colors disabled:opacity-50",title:"Sửa",children:s.jsx(cr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>E(X.id),disabled:h!==null||o,className:"p-2 rounded-lg text-slate-400 hover:text-red-400 hover:bg-red-500/20 transition-colors disabled:opacity-50",title:"Xóa",children:s.jsx(Xr,{className:"h-4 w-4"})})]})]})},X.id)}),t.length===0&&!r&&s.jsxs("div",{className:"sm:col-span-2 text-center py-12",children:[s.jsx("svg",{className:"w-16 h-16 text-slate-600 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),s.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"Chưa có danh mục nào"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Nhấn "Thêm Danh Mục" để tạo danh mục mới'})]})]})]})},P2=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],AK=(e,t)=>e.color||P2[t%P2.length],PK=({open:e,packageName:t,imageUrl:r,categoryOptions:n,selectedCategoryIds:a,saving:i,error:o,onPackageNameChange:l,onImageUrlChange:c,onToggleCategory:d,onClose:u,onSave:h,onCategoriesReload:f})=>{const[m,x]=p.useState("edit");if(!e)return null;const g=()=>{f?.()};return s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative flex w-full max-w-6xl flex-col rounded-[32px] border border-white/20 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl max-h-[95vh] overflow-hidden",children:[s.jsx("button",{type:"button",onClick:u,className:"absolute right-6 top-6 z-10 rounded-full bg-slate-800/80 p-2 text-slate-400 backdrop-blur-sm transition-all hover:bg-slate-700 hover:text-white","aria-label":"Đóng",children:s.jsx(Pt,{className:"h-6 w-6"})}),s.jsxs("div",{className:"border-b border-white/10 px-8 py-6",children:[s.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Chỉnh sửa gói sản phẩm và danh mục"}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Quản lý thông tin gói sản phẩm và danh mục"})]}),s.jsxs("div",{className:"flex border-b border-white/10 px-8 bg-slate-900/50",children:[s.jsxs("button",{type:"button",onClick:()=>x("edit"),className:`px-6 py-4 text-sm font-semibold transition-all relative ${m==="edit"?"text-indigo-400":"text-slate-400 hover:text-slate-300"}`,children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Chỉnh Sửa Gói"]}),m==="edit"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]}),s.jsxs("button",{type:"button",onClick:()=>x("manage"),className:`px-6 py-4 text-sm font-semibold transition-all relative ${m==="manage"?"text-indigo-400":"text-slate-400 hover:text-slate-300"}`,children:[s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Quản Lý Danh Mục"]}),m==="manage"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto px-8 py-6",children:m==="edit"?s.jsxs("div",{className:"grid gap-8 lg:grid-cols-3",children:[s.jsx("div",{className:"lg:col-span-1",children:s.jsx("div",{className:"sticky top-0",children:s.jsx(NK,{imageUrl:r,onImageUrlChange:c})})}),s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-6 shadow-sm backdrop-blur-sm",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide mb-2 block",children:"Gói Sản Phẩm"}),s.jsx("input",{type:"text",value:t,onChange:w=>l(w.target.value),className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",placeholder:"Nhập tên gói sản phẩm..."})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:"Danh Mục"}),s.jsxs("span",{className:"text-xs font-medium text-indigo-400 bg-indigo-500/20 px-3 py-1.5 rounded-full",children:["Đã chọn: ",a.length]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[n.map((w,y)=>{const N=a.includes(w.id),_=AK(w,y);return s.jsxs("button",{type:"button",onClick:()=>d(w.id),className:`group relative inline-flex items-center gap-1.5 px-4 py-2 rounded-lg font-semibold text-xs transition-all duration-200 ${N?"shadow-lg scale-105":"opacity-70 hover:opacity-90 shadow-sm hover:shadow-md hover:scale-102"}`,style:{background:`linear-gradient(135deg, ${_} 0%, ${_}dd 100%)`,color:"#ffffff",textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",border:N?"2px solid rgba(255, 255, 255, 0.8)":"1px solid rgba(255, 255, 255, 0.15)",boxShadow:N?`0 0 0 3px ${_}40, 0 4px 12px rgba(0, 0, 0, 0.3)`:void 0},children:[N&&s.jsx("div",{className:"absolute inset-0 rounded-lg",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 100%)"}}),!N&&s.jsx("div",{className:"absolute inset-0 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",style:{background:"linear-gradient(135deg, rgba(255,255,255,0.15) 0%, rgba(255,255,255,0) 100%)"}}),s.jsxs("span",{className:"relative z-10 flex items-center gap-1.5",children:[N&&s.jsx(Wn,{className:"h-3.5 w-3.5"}),w.name]})]},w.id)}),n.length===0&&s.jsxs("div",{className:"w-full text-center py-12 rounded-2xl border border-white/10 bg-slate-800/30",children:[s.jsx("svg",{className:"w-12 h-12 text-slate-600 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),s.jsx("p",{className:"text-sm text-slate-400 font-medium",children:"Không có danh mục để chọn"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:'Hãy tạo danh mục mới trong tab "Quản Lý Danh Mục"'})]})]})]}),o&&s.jsxs("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-5 py-4 text-sm text-rose-200 flex items-start gap-3",children:[s.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s.jsx("span",{children:o})]})]})]}):s.jsx(kK,{onCategoriesChange:g})}),m==="edit"&&s.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-8 py-5 bg-slate-900/50",children:[s.jsx("button",{type:"button",className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",onClick:u,disabled:i,children:"Hủy bỏ"}),s.jsx("button",{type:"button",className:"rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-8 py-3 font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",onClick:h,disabled:i,children:i?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Đang lưu..."]}):"Lưu thay đổi"})]})]})})},OK=({open:e,images:t,selectedImage:r,loading:n,uploading:a,deleting:i,error:o,uploadError:l,onClose:c,onSelect:d,onUseSelected:u,onUploadClick:h,onDeleteSelected:f})=>e?s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 px-4 py-6",children:s.jsxs("div",{className:"w-full max-w-4xl rounded-2xl border border-white/10 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl",children:[s.jsx("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:s.jsx("h3",{className:"text-lg font-semibold text-white",children:"Chọn hình ảnh sản phẩm"})}),s.jsxs("div",{className:"p-4 space-y-4",children:[n?s.jsx("p",{className:"text-sm text-white/70",children:"Đang tải hình ảnh..."}):t.length===0?s.jsx("p",{className:"text-sm text-white/70",children:"Chưa có hình ảnh nào."}):s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 max-h-[400px] overflow-y-auto",children:t.map(m=>{const x=r?.fileName===m.fileName;return s.jsxs("button",{type:"button",className:`rounded-xl border p-2 text-left transition ${x?"border-indigo-400 ring-2 ring-indigo-400/40":"border-white/10 hover:border-white/30"}`,onClick:()=>d(m),children:[s.jsx("div",{className:"aspect-square w-full overflow-hidden rounded-lg bg-black/30",children:s.jsx("img",{src:m.url,alt:m.fileName,className:"h-full w-full object-contain"})}),s.jsx("p",{className:"mt-2 truncate text-xs text-white/70",children:m.fileName})]},m.fileName)})}),(o||l)&&s.jsxs("div",{className:"space-y-1",children:[o&&s.jsx("p",{className:"text-xs text-rose-300",children:o}),l&&s.jsx("p",{className:"text-xs text-rose-300",children:l})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"rounded-lg border border-white/40 bg-transparent px-4 py-2 text-sm font-semibold text-white/90 hover:border-white hover:text-white disabled:opacity-60",onClick:h,disabled:a,children:a?"Đang tải...":"Tải hình mới"}),s.jsx("button",{type:"button",className:"rounded-lg border border-rose-400/60 bg-transparent px-4 py-2 text-sm font-semibold text-rose-200 hover:border-rose-300 hover:text-rose-100 disabled:opacity-60",onClick:f,disabled:!r||i,children:i?"Đang xóa...":"Xoá hình đã chọn"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("button",{type:"button",className:"px-4 py-2 text-sm font-semibold text-white/70 hover:text-white",onClick:c,children:"Hủy"}),s.jsx("button",{type:"button",className:"rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-700 disabled:opacity-60",onClick:u,disabled:!r,children:"Sử dụng hình đã chọn"})]})]})]})]})}):null,DK=({imageUrl:e,onImageChange:t,onImageRemove:r})=>{const n=p.useRef(null),[a,i]=p.useState(!1),[o,l]=p.useState(!1),[c,d]=p.useState([]),[u,h]=p.useState(!1),[f,m]=p.useState(null),[x,g]=p.useState(null),[v,b]=p.useState(!1),[w,y]=p.useState(null),[N,_]=p.useState(!1),S=async V=>{h(!0),m(null);try{const X=await N4(),K=Array.isArray(X.items)?X.items:[];d(K);let Y=V||x;Y&&(Y=K.find(q=>q.fileName===Y?.fileName||q.url===Y?.url)||null),!Y&&e&&(Y=K.find(q=>q.url===e)||null),!Y&&K.length&&(Y=K[0]),g(Y)}catch(X){m(X instanceof Error?X.message:"Failed to load images."),d([])}finally{h(!1)}},j=()=>{l(!0),m(null),y(null),S()},E=V=>{if(V&&V.type.startsWith("image/")){const X=new FileReader;X.onload=K=>{K.target?.result&&t(K.target.result)},X.readAsDataURL(V)}},k=V=>{V.preventDefault(),i(!1);const X=V.dataTransfer.files[0];X&&E(X)},T=V=>{V.preventDefault(),i(!0)},A=()=>{i(!1)},C=async V=>{const X=V.target.files?.[0];if(X){b(!0),y(null);try{const K=await w4(X);t(K.url);const Y=K.fileName?{fileName:K.fileName,url:K.url}:null;g(Y),await S(Y)}catch(K){y(K instanceof Error?K.message:"Upload failed.")}finally{b(!1),V.target.value=""}}},R=()=>{x&&(t(x.url),l(!1))},G=async()=>{if(!(!x||N)){_(!0),m(null);try{await _4(x.fileName),e===x.url&&r(),await S(null)}catch(V){m(V instanceof Error?V.message:"Delete failed.")}finally{_(!1)}}};return s.jsxs("div",{className:"relative h-full",children:[s.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:C,className:"hidden"}),e?s.jsxs("div",{className:"relative h-full rounded-2xl overflow-hidden border border-white/15 bg-slate-950/40 group",children:[s.jsx("img",{src:e,alt:"Product preview",className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[s.jsx("button",{type:"button",onClick:j,className:"px-4 py-2 rounded-lg bg-indigo-500 text-white font-semibold hover:bg-indigo-600 transition-colors",children:"Chọn từ Server"}),s.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded-lg bg-red-500 text-white font-semibold hover:bg-red-600 transition-colors",children:"Xóa"})]})]}):s.jsxs("div",{onClick:j,onDrop:k,onDragOver:T,onDragLeave:A,className:`h-full rounded-2xl border-2 border-dashed cursor-pointer transition-all flex flex-col items-center justify-center gap-4 p-6 ${a?"border-indigo-400 bg-indigo-500/20":"border-white/20 bg-slate-950/40 hover:border-indigo-400/60 hover:bg-slate-900/60"}`,children:[s.jsx(XN,{className:"h-16 w-16 text-slate-400"}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm font-semibold text-white mb-1",children:"Chọn hình ảnh sản phẩm"}),s.jsx("p",{className:"text-xs text-slate-400",children:"Nhấp để chọn từ server hoặc kéo thả file"})]})]}),s.jsx(OK,{open:o,images:c,selectedImage:x,loading:u,uploading:v,deleting:N,error:f,uploadError:w,onClose:()=>l(!1),onSelect:g,onUseSelected:R,onUploadClick:()=>n.current?.click(),onDeleteSelected:G})]})},O2=({label:e,value:t,onChange:r,placeholder:n="Nhập nội dung...",minHeight:a="200px"})=>{const i=p.useRef(null),o=p.useRef(!1);p.useEffect(()=>{i.current&&!o.current&&i.current.innerHTML!==t&&(i.current.innerHTML=t||"")},[t]);const l=()=>{i.current&&(o.current=!0,r(i.current.innerHTML),setTimeout(()=>{o.current=!1},0))},c=(m,x)=>{document.execCommand(m,!1,x),i.current?.focus(),l()},d=m=>{c("formatBlock",m)},u=()=>{const m=prompt("Nhập URL:");m&&c("createLink",m)},h="p-2.5 rounded-lg border border-white/10 bg-slate-800/60 text-slate-300 hover:bg-slate-700/80 hover:text-white hover:border-white/20 transition-all flex items-center justify-center min-w-[40px]";return s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-semibold text-slate-300 uppercase tracking-wide",children:e}),s.jsxs("div",{className:"flex flex-wrap gap-2 p-3 rounded-xl border border-white/10 bg-slate-950/40",children:[s.jsxs("select",{onChange:m=>{m.target.value&&(d(m.target.value),m.target.value="")},className:"px-3 py-2 rounded-lg border border-white/10 bg-slate-800/60 text-slate-300 text-sm hover:bg-slate-700/80 hover:border-white/20 transition-all cursor-pointer min-w-[140px]",defaultValue:"",children:[s.jsx("option",{value:"",disabled:!0,children:"Định dạng tiêu đề"}),s.jsx("option",{value:"h1",children:"H1 - Tiêu đề chính"}),s.jsx("option",{value:"h2",children:"H2 - Tiêu đề phụ"}),s.jsx("option",{value:"h3",children:"H3 - Tiêu đề cấp 3"}),s.jsx("option",{value:"h4",children:"H4 - Tiêu đề cấp 4"}),s.jsx("option",{value:"h5",children:"H5 - Tiêu đề cấp 5"}),s.jsx("option",{value:"h6",children:"H6 - Tiêu đề cấp 6"}),s.jsx("option",{value:"p",children:"Đoạn văn bản"})]}),s.jsx("div",{className:"w-px h-10 bg-white/10"}),s.jsx("button",{type:"button",onClick:()=>c("bold"),className:h,title:"Bold (Ctrl+B)",children:s.jsx(zT,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>c("italic"),className:h,title:"Italic (Ctrl+I)",children:s.jsx(mk,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>c("underline"),className:h,title:"Underline (Ctrl+U)",children:s.jsx(Bk,{className:"h-4 w-4"})}),s.jsx("div",{className:"w-px h-10 bg-white/10"}),s.jsx("button",{type:"button",onClick:()=>c("insertUnorderedList"),className:h,title:"Danh sách không thứ tự",children:s.jsx(yk,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>c("insertOrderedList"),className:h,title:"Danh sách có thứ tự",children:s.jsx(UT,{className:"h-4 w-4"})}),s.jsx("div",{className:"w-px h-10 bg-white/10"}),s.jsx("button",{type:"button",onClick:u,className:h,title:"Chèn liên kết",children:s.jsx(vk,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>d("blockquote"),className:h,title:"Trích dẫn",children:s.jsx(YT,{className:"h-4 w-4"})}),s.jsx("div",{className:"w-px h-10 bg-white/10"}),s.jsx("button",{type:"button",onClick:()=>c("removeFormat"),className:`${h} text-red-400 hover:text-red-300`,title:"Xóa định dạng",children:s.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),s.jsx("div",{ref:i,contentEditable:!0,onInput:l,className:"w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all overflow-y-auto prose prose-invert prose-headings:text-white prose-h1:text-2xl prose-h2:text-xl prose-h3:text-lg prose-h4:text-base prose-h5:text-sm prose-h6:text-xs prose-p:text-sm prose-a:text-indigo-400 prose-blockquote:border-l-4 prose-blockquote:border-indigo-500 prose-blockquote:pl-4 prose-blockquote:italic max-w-none",style:{minHeight:a},"data-placeholder":n}),s.jsx("style",{children:`
        [contentEditable][data-placeholder]:empty:before {
          content: attr(data-placeholder);
          color: rgb(148 163 184);
          pointer-events: none;
        }
        
        /* SEO-friendly heading styles */
        [contentEditable] h1 {
          font-size: 1.5rem;
          font-weight: 700;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.2;
        }
        
        [contentEditable] h2 {
          font-size: 1.25rem;
          font-weight: 700;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.3;
        }
        
        [contentEditable] h3 {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
          line-height: 1.4;
        }
        
        [contentEditable] h4 {
          font-size: 1rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] h5 {
          font-size: 0.875rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] h6 {
          font-size: 0.75rem;
          font-weight: 600;
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] p {
          margin-top: 0.5rem;
          margin-bottom: 0.5rem;
        }
        
        [contentEditable] blockquote {
          border-left: 4px solid rgb(99 102 241);
          padding-left: 1rem;
          font-style: italic;
          color: rgb(203 213 225);
          margin: 0.5rem 0;
        }
        
        [contentEditable] ul, [contentEditable] ol {
          margin: 0.5rem 0;
          padding-left: 1.5rem;
        }
        
        [contentEditable] li {
          margin: 0.25rem 0;
        }
        
        [contentEditable] a {
          color: rgb(129 140 248);
          text-decoration: underline;
        }
        
        [contentEditable] a:hover {
          color: rgb(165 180 252);
        }
      `})]})},IK=({product:e,saving:t,onClose:r,onSave:n})=>{const a=p.useMemo(()=>({productId:e?.productId||"",productName:e?.packageProduct||e?.productName||"",packageName:e?.packageName||"",shortDescription:e?.shortDescription||"",rules:e?.rules||"",rulesHtml:e?.rulesHtml||Qr(e?.rules||""),description:e?.description||"",descriptionHtml:e?.descriptionHtml||Qr(e?.description||""),imageUrl:e?.imageUrl||"",priceId:e?.priceId??null}),[e]),[i,o]=p.useState(a);p.useEffect(()=>{e&&o(a)},[a,e]);const l=()=>{n(i)};if(!e)return null;const c="w-full rounded-xl border border-white/10 bg-slate-950/40 px-4 py-3 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",d="text-xs font-semibold text-slate-300 uppercase tracking-wide";return s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"relative flex w-full max-w-7xl flex-col rounded-[32px] border border-white/20 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 shadow-2xl max-h-[95vh] overflow-hidden",children:[s.jsx("button",{onClick:r,className:"absolute right-6 top-6 z-10 rounded-full bg-slate-800/80 p-2 text-slate-400 backdrop-blur-sm transition-all hover:bg-slate-700 hover:text-white","aria-label":"Close",children:s.jsx(Pt,{className:"h-6 w-6"})}),s.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto px-4 py-6 sm:px-6 sm:py-8",children:[s.jsx("div",{className:"text-center",children:s.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Chỉnh sửa thông tin sản phẩm"})}),s.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-5",children:[s.jsx("div",{style:{height:"400px"},children:s.jsx(DK,{imageUrl:i.imageUrl,onImageChange:u=>o(h=>({...h,imageUrl:u})),onImageRemove:()=>o(u=>({...u,imageUrl:""}))})}),s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-sm backdrop-blur-sm",children:[s.jsx("h3",{className:"mb-4 text-lg font-semibold text-white",children:"Thông Tin Cơ Bản"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:d,children:"Mã Sản Phẩm"}),s.jsx("input",{type:"text",value:i.productId,onChange:u=>o(h=>({...h,productId:u.target.value})),placeholder:"Nhập mã sản phẩm...",className:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:d,children:"Tên Sản Phẩm"}),s.jsx("input",{type:"text",value:i.productName,onChange:u=>o(h=>({...h,productName:u.target.value})),placeholder:"Nhập tên sản phẩm...",className:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:d,children:"Gói Sản Phẩm"}),s.jsx("input",{type:"text",value:i.packageName,onChange:u=>o(h=>({...h,packageName:u.target.value})),placeholder:"Nhập gói sản phẩm...",className:c})]}),s.jsxs("div",{children:[s.jsx("label",{className:d,children:"Mô Tả Ngắn"}),s.jsx("textarea",{value:i.shortDescription,onChange:u=>o(h=>({...h,shortDescription:u.target.value})),rows:3,placeholder:"Nhập mô tả ngắn về sản phẩm...",className:c})]})]})]})]}),s.jsx("div",{className:"lg:col-span-2 space-y-5",children:s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-sm backdrop-blur-sm space-y-4",children:[s.jsx(O2,{label:"Quy Tắc Sản Phẩm",value:i.rulesHtml||"",onChange:u=>{o(h=>({...h,rulesHtml:u,rules:u.replace(/<[^>]*>/g,"")}))},placeholder:"Nhập quy tắc sản phẩm...",minHeight:"150px"}),s.jsx(O2,{label:"Mô Tả Sản Phẩm",value:i.descriptionHtml||"",onChange:u=>{o(h=>({...h,descriptionHtml:u,description:u.replace(/<[^>]*>/g,"")}))},placeholder:"Nhập mô tả chi tiết sản phẩm...",minHeight:"200px"})]})})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("button",{type:"button",onClick:r,disabled:t,className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",children:"Hủy bỏ"}),s.jsx("button",{type:"button",onClick:l,disabled:t,className:"rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 px-6 py-3 font-semibold text-white shadow-lg transition-all hover:from-indigo-600 hover:to-purple-700 disabled:opacity-50",children:t?"Đang Lưu...":"Lưu thay đổi"})]})]})]})})},ka=["#facc15","#f97316","#22c55e","#38bdf8","#a855f7","#f43f5e","#14b8a6","#eab308"],RK=(e,t)=>{if(e.color)return e.color;const r=Number(e.id);return Number.isFinite(r)?ka[Math.abs(r)%ka.length]:ka[t%ka.length]},MK=(e,t)=>t||(Number.isFinite(e)?ka[Math.abs(e)%ka.length]:ka[0]),FK=({reloadCategories:e})=>{const[t,r]=p.useState(!1),[n,a]=p.useState(""),[i,o]=p.useState(ka[0]),[l,c]=p.useState(!1),[d,u]=p.useState(null),h=p.useCallback(()=>{r(!0),u(null),a(""),o(ka[0])},[]),f=p.useCallback(()=>{r(!1),c(!1),u(null),a("")},[]),m=p.useCallback(async()=>{const x=n.trim();if(!x){u("Category name is required.");return}c(!0),u(null);try{const g=await Ue("/api/categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x,color:(i||"").trim()||null})});if(!g.ok){const v=await g.text().catch(()=>"");throw new Error(v||`Failed to create category (${g.status}).`)}await g.json().catch(()=>null),await e(),r(!1),a("")}catch(g){u(Kr(g instanceof Error?g.message:String(g??""),{fallback:"Cannot create category."}))}finally{c(!1)}},[n,i,e]);return{createCategoryOpen:t,newCategoryName:n,setNewCategoryName:a,newCategoryColor:i,setNewCategoryColor:o,creatingCategory:l,createCategoryError:d,openCreateCategory:h,closeCreateCategory:f,handleCreateCategory:m}},j4=async(e,t)=>{const r=await Ue(`/api/product-prices/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!r.ok){const n=await r.text();throw new Error(Kr(n,{fallback:"Cannot update product categories."}))}return r.json().catch(()=>({}))},LK=async e=>{const t=await Ue(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(Kr(n,{fallback:"Không thể xóa sản phẩm khỏi bảng giá.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},BK=({categoryOptions:e,reloadProducts:t,onOpenEdit:r})=>{const[n,a]=p.useState(null),[i,o]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState([]),[h,f]=p.useState(!1),[m,x]=p.useState(null),g=p.useCallback(y=>{a(y),o(y.packageName||""),c(y.imageUrl||"");const N=(y.categories||[]).map(_=>Number(_.id)).filter(_=>Number.isFinite(_));u(Array.from(new Set(N))),x(null),r&&r()},[r]),v=p.useCallback(()=>{a(null),f(!1),x(null)},[]),b=p.useCallback(y=>{u(N=>N.includes(y)?N.filter(_=>_!==y):[...N,y])},[]),w=p.useCallback(async()=>{if(!n)return;const y=n.items.find(j=>Number.isFinite(Number(j.priceId)))||n.items.find(j=>Number.isFinite(Number(j.id))),N=y?Number(y.priceId??y.id):null;if(!N){x("Missing product id for update.");return}f(!0),x(null);const _=i.trim(),S=d.reduce((j,E)=>{const k=e.find(T=>T.id===E);return j[E]=MK(E,k?.color??null),j},{});try{await j4(N,{packageName:_,categoryIds:d,categoryColors:S,imageUrl:l.trim()||null}),await t(),a(null)}catch(j){x(Kr(j instanceof Error?j.message:String(j??""),{fallback:"Cannot update category."}))}finally{f(!1)}},[n,i,l,d,e,t]);return{editingCategoryGroup:n,categoryPackageName:i,setCategoryPackageName:o,categoryImageUrl:l,setCategoryImageUrl:c,selectedCategoryIds:d,categorySaving:h,categorySaveError:m,openCategoryEdit:g,closeCategoryEdit:v,handleToggleCategory:b,handleSaveCategory:w}},$K=()=>{const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),o=p.useRef(!0);p.useEffect(()=>()=>{o.current=!1},[]);const l=p.useCallback(async()=>{if(o.current){n(!0),i(null);try{const c=await Ue("/api/categories");if(!c.ok){const h=await c.text().catch(()=>"");throw new Error(h||`Failed to load categories (${c.status}).`)}const d=await c.json().catch(()=>[]);if(!o.current)return;const u=Array.isArray(d)?d:[];u.sort((h,f)=>String(h?.name||"").localeCompare(String(f?.name||""),"vi",{sensitivity:"base"})),t(u)}catch(c){if(!o.current)return;t([]),i(Kr(c instanceof Error?c.message:String(c??""),{fallback:"Cannot load categories."}))}finally{o.current&&n(!1)}}},[]);return p.useEffect(()=>{l()},[l]),{categoryOptions:e,loading:r,error:a,reload:l}},UK=async e=>{const t=await Ue("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(Kr(n,{fallback:"Không thể lưu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phản hồi không hợp lệ từ server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},HK=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Ue(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(Kr(l,{fallback:"Không thể tải thông tin sản phẩm."}))}const a=await n.json().catch(()=>null);if(!a||!Array.isArray(a.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const i=typeof a.count=="number"&&Number.isFinite(a.count)?a.count:a.items.length,o=typeof a.total=="number"&&Number.isFinite(a.total)?a.total:i;return{...a,count:i,total:o,offset:typeof a.offset=="number"&&Number.isFinite(a.offset)?a.offset:e.offset??0,limit:typeof a.limit=="number"&&Number.isFinite(a.limit)?a.limit:e.limit??a.items.length}},zK=({setProductDescs:e,setError:t,reloadProducts:r})=>{const[n,a]=p.useState(null),[i,o]=p.useState(!1),l=p.useCallback(h=>{a(h)},[]),c=p.useCallback(()=>{a(null),o(!1)},[]),d=p.useCallback(()=>{a(null)},[]),u=p.useCallback(async h=>{if(!n)return;o(!0);const f={productId:h.productId.trim()||n.productId||"",rules:h.rulesHtml||h.rules,description:h.descriptionHtml||h.description,imageUrl:h.imageUrl||null};try{const m=await UK(f),x=h.priceId??n.priceId;x&&Number.isFinite(x)&&await j4(x,{packageName:h.packageName.trim()||null,packageProduct:h.productName.trim()||null});const g=m.rulesHtml||m.rules||h.rulesHtml||h.rules||"",v=m.descriptionHtml||m.description||h.descriptionHtml||h.description||"",b={...n,id:m.id||n.id,productId:m.productId,productName:h.productName||n.productName||n.productName,packageName:h.packageName||n.packageName,rules:m.rules||"",rulesHtml:g,description:m.description||"",descriptionHtml:v,imageUrl:m.imageUrl||h.imageUrl||null};e(w=>{const y=Ri(m.productId||n.productId||""),N=w.findIndex(S=>Ri(S.productId||"")===y);if(N===-1)return[...w,{id:m.id||n.id,productId:m.productId,productName:b.productName||null,rules:m.rules||"",rulesHtml:g,description:m.description||"",descriptionHtml:v,imageUrl:m.imageUrl||null}];const _=[...w];return _[N]={..._[N],id:m.id||_[N].id,productId:m.productId,productName:b.productName||_[N].productName||null,rules:m.rules||"",rulesHtml:g,description:m.description||"",descriptionHtml:v,imageUrl:m.imageUrl||null},_}),a(null),await r()}catch(m){t(Kr(m instanceof Error?m.message:String(m??""),{fallback:"Không thể lưu thông tin sản phẩm."}))}finally{o(!1)}},[n,e,t,r]);return{editingProduct:n,editSaving:i,openEditForm:l,closeEditForm:c,handleSaveEdit:u,clearEditingProduct:d}},WK=()=>{const[e,t]=p.useState(null),[r,n]=p.useState(1),[a,i]=p.useState([]),[o,l]=p.useState([]),[c,d]=p.useState(""),[u,h]=p.useState(!1),[f,m]=p.useState(null),x=p.useMemo(()=>hK(a,o,c),[a,o,c]),g=p.useMemo(()=>Math.max(1,Math.ceil(x.length/Vc)),[x.length]),v=p.useMemo(()=>{const y=(r-1)*Vc,N=y+Vc;return x.slice(y,N)},[x,r]),b=p.useCallback(async()=>{h(!0),m(null);try{const[y,N]=await Promise.all([HK({limit:1e3}),Ue("/api/products")]),_=await N.json().catch(()=>[]);i(Array.isArray(y.items)?y.items:[]),l(Array.isArray(_)?_:[])}catch(y){i([]),l([]),m(Kr(y instanceof Error?y.message:String(y??""),{fallback:"Không thể tải danh sách sản phẩm."}))}finally{h(!1)}},[]);return p.useEffect(()=>{b()},[b]),p.useEffect(()=>{r>g&&n(g)},[r,g]),{data:{mergedProducts:x,pagedProducts:v,loading:u,error:f,currentPage:r,totalPages:g,expandedId:e,searchTerm:c},actions:{handleSearchChange:y=>{d(y),n(1)},setCurrentPage:n,setExpandedId:t,reload:b,setProductDescs:i,setError:m}}},VK=e=>{const t=new Map;return e.forEach(r=>{const n=(r.packageName||"").trim();if(!n)return;const a=n;t.has(a)||t.set(a,{key:a,packageName:n,imageUrl:r.imageUrl??null,categories:[],items:[]}),t.get(a)?.items.push(r)}),Array.from(t.entries()).map(([,r])=>{const n=new Map;return r.items.forEach(a=>{(a.categories||[]).forEach(i=>{if(!i||!i.name)return;const o=i.id?String(i.id):i.name;n.has(o)||n.set(o,i)})}),{...r,categories:Array.from(n.values()).sort((a,i)=>String(a?.name||"").localeCompare(String(i?.name||""),"vi",{sensitivity:"base"})),items:[...r.items].sort((a,i)=>{const o=a.productId||a.packageProduct||a.productName||"",l=i.productId||i.packageProduct||i.productName||"";return o.localeCompare(l,"vi",{sensitivity:"base"})})}}).sort((r,n)=>r.packageName.localeCompare(n.packageName,"vi",{sensitivity:"base"}))},KK=()=>{const{data:{mergedProducts:e,pagedProducts:t,loading:r,error:n,currentPage:a,expandedId:i,searchTerm:o},actions:{handleSearchChange:l,setCurrentPage:c,setExpandedId:d,reload:u,setProductDescs:h,setError:f}}=WK(),[m,x]=p.useState("products"),{categoryOptions:g,loading:v,error:b,reload:w}=$K(),{editingProduct:y,editSaving:N,openEditForm:_,closeEditForm:S,handleSaveEdit:j,clearEditingProduct:E}=zK({setProductDescs:h,setError:f,reloadProducts:u}),{editingCategoryGroup:k,categoryPackageName:T,setCategoryPackageName:A,categoryImageUrl:C,setCategoryImageUrl:R,selectedCategoryIds:G,categorySaving:V,categorySaveError:X,openCategoryEdit:K,closeCategoryEdit:Y,handleToggleCategory:q,handleSaveCategory:Z}=BK({categoryOptions:g,reloadProducts:u,onOpenEdit:E}),{createCategoryOpen:le,newCategoryName:ce,setNewCategoryName:pe,newCategoryColor:Ne,setNewCategoryColor:ee,creatingCategory:oe,createCategoryError:he,openCreateCategory:O,closeCreateCategory:I,handleCreateCategory:L}=FK({reloadCategories:w}),F=p.useMemo(()=>VK(e),[e]);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thông Tin Sản Phẩm"}),s.jsx("p",{className:"text-sm text-white/70",children:"Đồng bộ với bảng product_desc trong database."})]}),s.jsx(cK,{searchTerm:o,onSearchChange:l,onAddCategoryClick:O}),n&&s.jsx("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),s.jsx(uK,{viewMode:m,onViewModeChange:x}),m==="products"?s.jsx(gK,{products:t,mergedTotal:e.length,loading:r,currentPage:a,pageSize:Vc,onPageChange:c,expandedId:i,onToggleExpand:d,onEdit:_}):s.jsx(bK,{categoryRows:F,loading:r,onEditCategory:K,getCategoryColor:RK}),le&&s.jsx(yK,{open:le,name:ce,color:Ne,saving:oe,error:he,onNameChange:pe,onColorChange:ee,onClose:I,onSave:L}),k&&s.jsx(PK,{open:!!k,packageName:T,imageUrl:C,categoryOptions:g,selectedCategoryIds:G,saving:V||v,error:X||b,onPackageNameChange:A,onImageUrlChange:R,onToggleCategory:q,onClose:Y,onSave:Z,onCategoriesReload:w}),y&&s.jsx(IK,{product:y,saving:N,onClose:S,onSave:j})]})},GK=({searchTerm:e,statusFilter:t,isLoading:r,isRefreshing:n,error:a,onSearchChange:i,onStatusChange:o,onRefresh:l,onAddProduct:c})=>s.jsxs("div",{className:"pricing-filters space-y-4",children:[s.jsx("div",{className:"pricing-filters__panel rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"pricing-filters__row flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"pricing-filters__search relative w-full lg:flex-1",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:"Tìm Kiếm Sản Phẩm...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:d=>i(d.target.value)})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full lg:w-auto",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx("div",{className:"relative w-full lg:w-[170px]",children:s.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:t,onChange:d=>o(d.target.value),children:[s.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Trạng Thái"}),s.jsx("option",{value:"active",className:"bg-slate-900 text-white",children:"Đang Hoạt Động"}),s.jsx("option",{value:"inactive",className:"bg-slate-900 text-white",children:"Tạm Dừng"})]})}),s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx(nn,{onClick:c,className:"!py-2.5 !px-5 text-sm",children:"Thêm Sản Phẩm"}),s.jsx("button",{type:"button",onClick:l,disabled:r||n,className:`px-5 py-2.5 rounded-2xl text-sm font-semibold transition-all border ${r||n?"bg-white/5 text-white/30 border-white/5 cursor-not-allowed":"bg-white/5 text-white border-white/10 hover:bg-white/10"}`,children:r||n?"Đang Đồng Bộ...":"Đồng Bộ Lại"})]})]})}),a&&s.jsx("div",{className:"mt-6 rounded-2xl border border-rose-500/20 bg-rose-500/10 px-5 py-3 text-sm text-rose-200 backdrop-blur-md shadow-xl animate-in fade-in slide-in-from-top-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-rose-500 animate-pulse"}),s.jsx("span",{children:a})]})})]}),XK=({stats:e})=>s.jsx("div",{className:"pricing-stats space-y-4",children:s.jsx("div",{className:"pricing-stats__panel rounded-[32px] border border-white/5 bg-gradient-to-br from-indigo-500/10 via-purple-500/5 to-slate-900/40 p-6 shadow-2xl backdrop-blur-xl",children:s.jsx("div",{className:"pricing-stats__grid grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(t=>s.jsx(Ca,{title:t.name,value:t.value,icon:t.icon,subtitle:t.subtitle,accent:wr[t.accent]},t.name))})})}),tp=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),rp=0,gf=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},Vu=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},D2=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),YK=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",qK=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Tháng`},ZK=(e,t)=>{const r=qK(t);return e&&r?`${e} ${r}`:e||r||YK(t)||"Không Xác Định"},ni=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},JK=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},QK=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t))return null;const r=t>1?t/100:t;return r<0||r>=1?null:1-r},xl=(e,t,r)=>typeof e!="number"||!Number.isFinite(e)||e<rp||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?!1:QK(t,e)!==null,eG=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",tG=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${eG(r.sourceName)}`,a=t.get(n);if(!a){t.set(n,r);continue}const i=a.price??Number.POSITIVE_INFINITY,o=r.price??Number.POSITIVE_INFINITY,l=Date.parse(a.lastOrderDate??"")||0,c=Date.parse(r.lastOrderDate??"")||0;(o<i||o===i&&c>l)&&t.set(n,r)}return Array.from(t.values())},jc=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(n!==a)return n-a;const i=Date.parse(t.lastOrderDate??"")||0,o=Date.parse(r.lastOrderDate??"")||0;return i!==o?o-i:t.sourceName.localeCompare(r.sourceName)}),Rs=(e,t)=>`${e}-${t}`,gl=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,S4=(e,t)=>gl(t,e),E4=(e,t,r,n,a)=>{const i=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof a=="number"&&Number.isFinite(a)&&a>0&&a||null;if(i===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!xl(t,e,r))return null;const o=t>1?t/100:t,l=e&&e>1?e:e||1,c=i*l,d=c-c*o;return Math.min(c,Math.max(i,d))},zo=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=S4(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,a=gl(n??t,e.pctKhach),i=E4(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.retailPrice,promoPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.promoPrice}},np=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},ap=e=>{if(e==null)return"";const t=typeof e=="number"&&Number.isFinite(e)?Math.round(e):e,r=String(t).replace(/\D+/g,"");if(!r)return"";const n=Number(r);return Number.isFinite(n)?new Intl.NumberFormat("vi-VN").format(n):""},kn=e=>{if(e==null)return null;const t=e.toString().replace(",",".").trim();return t?ni(t):null},Ku=({multiplier:e,price:t,basePrice:r})=>"",Br=e=>{const t=Vu(e);return t===null||t<=0?"-":tp.format(t)},Kc=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},C4=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},Vs=e=>(e||"").trim(),I2=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=Vu(e)??0;return t===0?tp.format(0):tp.format(t)},rG=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,a=typeof r=="number"&&Number.isFinite(r)?r-e:null,i=I2(n),o=I2(a);return`${i} - ${o}`},Gu=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},nG=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(a<n)return r;if(a>n)return t;const i=Gu(t.lastOrderDate);return Gu(r.lastOrderDate)>i?r:t},null):null,ai=(e,t)=>{const r=e.reduce((n,a)=>{const i=typeof a.price=="number"&&Number.isFinite(a.price)?a.price:Number.NEGATIVE_INFINITY;return i>n?i:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},T4=(e,t)=>{const r=D2(e?.[Ht.packageName]??e?.package_label),n=D2(e?.[Ht.variantName]??e?.package_product_label),a=(e?.[Ht.code]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Không xác định",packageProduct:n,sanPhamRaw:a,variantLabel:ZK(n,a),pctCtv:ni(e?.[Ht.pctCtv]),pctKhach:ni(e?.[Ht.pctKhach]),pctPromo:ni(e?.[Ht.pctPromo]),isActive:JK(e?.[Ht.isActive]),baseSupplyPrice:ni(e?.max_supply_price),wholesalePrice:ni(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:ni(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:ni(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[Ht.updatedAt]=="string"?e[Ht.updatedAt]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:typeof e?.update=="string"?e.update:null}},aG=({item:e,productKey:t,isExpanded:r,statusOverride:n,updatedTimestamp:a,supplyState:i,pendingNewSupply:o,supplierOptions:l,isLoadingSuppliers:c,editingProductId:d,productEditForm:u,productEditError:h,isSavingProductEdit:f,isDeletingProduct:m,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:w,onStartProductEdit:y,onProductEditChange:N,onCancelProductEdit:_,onSubmitProductEdit:S,onRequestDeleteProduct:j,onStartEditingSupply:E,onSupplyInputChange:k,onCancelSupplyEditing:T,onConfirmSupplyEditing:A,onStartAddSupplierRow:C,onNewSupplierInputChange:R,onCancelAddSupplierRow:G,onConfirmAddSupplierRow:V,onDeleteSupplyRow:X,onToggleStatus:K,fetchSupplyPricesForProduct:Y})=>{const q=i?.items??[],Z=o??null,le=nG(q),ce=le?.price??e.baseSupplyPrice,pe=le?.sourceName??"-",Ne=ai(q,e.baseSupplyPrice),ee=[...q.map(ve=>({kind:"existing",supplier:ve})),...Z?[{kind:"new"}]:[]],oe=n??e.isActive??!1,he=a??e.lastUpdated??"",O=he?C4(he):"-",I=xl(e.pctPromo,e.pctKhach,e.pctCtv),L=d===e.id,F=L?u:null,W=F?{pctCtv:kn(F.pctCtv),pctKhach:kn(F.pctKhach),pctPromo:kn(F.pctPromo)}:null,J=W?S4(W.pctCtv,Ne):null,se=typeof J=="number"&&Number.isFinite(J)&&J>0?J:Ne,ke=W?gl(se,W.pctKhach):null,ye=W?E4(W.pctKhach,W.pctPromo,W.pctCtv,J,Ne):null,Pe=Kc(W?.pctPromo??null),ue=xl(W?.pctPromo??null,W?.pctKhach??null,W?.pctCtv??null)&&Number.isFinite(ye??NaN),Be=typeof Ne=="number"&&Number.isFinite(Ne)&&Ne>0?Br(Ne):"Chưa có dữ liệu",Ve=()=>{Y(e.sanPhamRaw)};return s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{className:"hidden md:table-row cursor-pointer bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 transition hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70",onClick:()=>w(e),children:[s.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(yp,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${r?"rotate-180":""}`}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-white",children:e.packageName}),s.jsx("div",{className:"text-xs text-white/70",children:e.variantLabel})]})]})}),s.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[s.jsx("div",{className:"text-sm font-semibold text-white",children:Br(e.wholesalePrice)}),s.jsx("div",{className:"text-xs text-white/70",children:Ku({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),s.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[s.jsx("div",{className:"text-sm font-semibold text-amber-300",children:Br(e.retailPrice)}),s.jsx("div",{className:"text-xs text-white/70",children:Ku({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),s.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:I?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"text-sm font-semibold text-pink-200",children:Br(e.promoPrice)}),s.jsx("div",{className:"text-xs text-white/70",children:Kc(e.pctPromo)??"-"})]}):s.jsx("div",{className:"text-sm text-white/60",children:"-"})}),s.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:s.jsx("div",{className:"flex flex-col items-center",children:s.jsx("button",{type:"button",onClick:ve=>{ve.stopPropagation(),K(e)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${oe?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":oe,children:s.jsx(xd,{className:"h-4 w-4"})})})}),s.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:s.jsx("div",{className:"text-sm text-white",children:O})}),s.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:ve=>y(ve,e),children:s.jsx(cr,{className:"h-4 w-4"})}),s.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${m?"cursor-not-allowed opacity-60":""}`,onClick:ve=>j(ve,e),disabled:m,children:s.jsx(Xr,{className:"h-4 w-4"})})]})})]}),L&&F&&s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-2 md:px-6 pb-4 md:pb-6",children:s.jsxs("div",{className:"space-y-4 md:space-y-6 rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-3 py-4 md:px-6 md:py-5 text-white shadow-lg",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3 md:p-5 shadow-lg",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thông Tin Sản Phẩm"}),s.jsxs("div",{className:"mt-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tên sản phẩm"}),s.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:F.packageName,onChange:ve=>N("packageName",ve.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Gói sản phẩm"}),s.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:F.packageProduct,onChange:ve=>N("packageProduct",ve.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Mã sản phẩm"}),s.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:F.sanPham,onChange:ve=>N("sanPham",ve.target.value)})]})]})]}),s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-3 md:p-5 shadow-lg",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"Tỷ giá"}),s.jsxs("div",{className:"mt-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá CTV"}),s.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:F.pctCtv,onChange:ve=>N("pctCtv",ve.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khách"}),s.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:F.pctKhach,onChange:ve=>N("pctKhach",ve.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tỷ giá khuyến mãi"}),s.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:F.pctPromo,onChange:ve=>N("pctPromo",ve.target.value)})]})]})]})]}),F&&s.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-3 md:p-4 shadow-lg backdrop-blur",children:[s.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("span",{children:"Giá dự kiến theo tỉ giá"}),s.jsxs("span",{className:"font-medium normal-case text-amber-200",children:["Giá nguồn cao nhất:"," ",s.jsx("span",{className:"font-semibold",children:Be})]})]}),s.jsxs("div",{className:`mt-3 md:mt-4 grid gap-2 md:gap-3 text-center text-sm grid-cols-2 ${ue?"md:grid-cols-3":"md:grid-cols-2"}`,children:[s.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Sỉ dự kiến"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(J)}),s.jsx("p",{className:"text-[11px] text-white/70",children:F.pctCtv?`Tỷ Giá: ${F.pctCtv}`:"Nhập tỉ giá CTV"})]}),s.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Khách dự kiến"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(ke)}),s.jsx("p",{className:"text-[11px] text-white/70",children:F.pctKhach?`Tỷ Giá: ${F.pctKhach}`:"Nhập tỉ giá khách"})]}),ue&&s.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3 shadow-lg backdrop-blur-sm",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá Khuyến mãi dự kiến"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(ye)}),s.jsx("p",{className:"text-[11px] text-white/70",children:Pe??"Nhập tỉ giá khuyến mãi"})]})]})]}),h&&s.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:h}),s.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[s.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-4 md:px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:_,disabled:f,children:"Hủy bỏ"}),s.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-4 md:px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:S,disabled:f,children:f?"Đang Lưu...":"Lưu thay đổi"})]})]})})}),r&&s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-2 md:px-6 pb-4 md:pb-6",children:s.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 p-2 md:p-4 text-white",children:s.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-3 py-4 md:px-6 md:py-5 text-white shadow-lg",children:[s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiết giá sản phẩm"})}),s.jsxs("div",{className:`grid gap-2 md:gap-4 text-center grid-cols-2 ${I?"md:grid-cols-4":"md:grid-cols-3"}`,children:[s.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá nguồn thấp nhất"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(ce)}),s.jsx("p",{className:"text-[10px] md:text-xs text-white/70 truncate max-w-full",children:pe})]}),s.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá sỉ hiện tại"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(e.wholesalePrice)})]}),s.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá khách hiện tại"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(e.retailPrice)})]}),I&&s.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-2 py-2 md:px-4 md:py-3",children:[s.jsx("p",{className:"text-[10px] md:text-xs uppercase text-white/70",children:"Giá KM hiện tại"}),s.jsx("p",{className:"mt-1 text-base md:text-lg font-semibold text-white",children:Br(e.promoPrice)}),s.jsx("p",{className:"text-[10px] md:text-xs text-white/70",children:Kc(e.pctPromo)??"-"})]})]}),s.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/15",children:[s.jsx("div",{className:"flex justify-end border-b border-white/10 bg-white/5 px-4 py-2",children:s.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>C(e.id),disabled:!!Z,children:[s.jsx(Np,{className:"h-4 w-4"}),"Thêm nguồn"]})}),s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-white/5 text-[11px] uppercase tracking-wide text-white/70",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 md:px-4 py-2 text-left",children:"NCC"}),s.jsx("th",{className:"px-2 md:px-4 py-2 text-center",children:"Giá nhập"}),s.jsx("th",{className:"hidden md:table-cell px-4 py-2 text-center",children:"Lợi nhuận"}),s.jsx("th",{className:"px-2 md:px-4 py-2 text-center",children:"Thao tác"})]})}),s.jsx("tbody",{children:i?.loading?s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Đang Tải Dữ Liệu"})}):i?.error?s.jsx("tr",{children:s.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white",children:[s.jsx("span",{children:i.error})," ",s.jsx("button",{type:"button",className:"text-xs text-red-400 hover:text-red-200 hover:underline",onClick:Ve,children:"Thử Lại"})]})}):q.length===0&&ee.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Chưa có dữ liệu từ NCC"})}):ee.map(ve=>{if(ve.kind==="existing"&&ve.supplier){const we=ve.supplier,fe=Rs(e.id,we.sourceId),Ce=x[fe]??!1,me=v[fe]??!1,We=g[fe]??(we.price??"").toString();b[fe];const Oe=!Ce||me,Ae=Br(we.price);return s.jsxs("tr",{className:"border-t border-dashed border-white/10",children:[s.jsx("td",{className:"px-2 md:px-4 py-3",children:s.jsx("div",{className:"text-xs md:text-sm font-semibold text-white truncate max-w-[80px] md:max-w-none",children:we.sourceName})}),s.jsx("td",{className:"px-2 md:px-4 py-3",children:Ce?s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"text",className:"w-20 md:w-28 rounded-lg border border-white/25 bg-white/5 px-2 py-1 text-center text-xs md:text-sm text-white placeholder:text-white/50 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/30 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:We,onChange:Ye=>k(e.id,we.sourceId,Ye.target.value),disabled:Oe}),s.jsx("span",{className:"text-xs text-white/70",children:"đ"})]}),s.jsx("span",{className:"hidden md:inline text-[11px] text-white/60",children:"Nhập giá mới"})]}):s.jsx("div",{className:"flex justify-center",children:s.jsx("span",{className:"inline-flex min-w-0 md:min-w-[112px] justify-center rounded-lg bg-white/10 px-2 md:px-3 py-1.5 md:py-2 text-xs md:text-sm font-semibold text-white",children:Ae})})}),s.jsx("td",{className:"hidden md:table-cell px-4 py-3 text-center text-xs text-white/70",children:rG(we.price,e.wholesalePrice,e.retailPrice)}),s.jsx("td",{className:"px-2 md:px-4 py-3",children:Ce?s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:me,onClick:()=>A(e.id,we.sourceId,t,e.sanPhamRaw),children:s.jsx(Wn,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:me,onClick:()=>T(e.id,we.sourceId),children:s.jsx(Pt,{className:"h-4 w-4"})})]}):s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:me,onClick:()=>E(e.id,we.sourceId,we.price),children:s.jsx(cr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:me,onClick:()=>X(e.id,we.sourceId,t,e.sanPhamRaw),children:s.jsx(qN,{className:"h-4 w-4"})})]})})]},fe)}if(ve.kind==="new"&&Z){const we=Z,fe=we.useCustomName?"__custom__":we.sourceId!==null?`id:${we.sourceId}`:we.sourceName?`name:${we.sourceName}`:"",Ce=l.length>0,me=We=>{const Oe=We.target.value;if(Oe==="__custom__"){R(e.id,"useCustomName",!0),R(e.id,"sourceName",""),R(e.id,"sourceId",null);return}if(R(e.id,"useCustomName",!1),!Oe){R(e.id,"sourceId",null),R(e.id,"sourceName","");return}const Ae=l.find(Ye=>(Ye.id!==null?`id:${Ye.id}`:`name:${Ye.name}`)===Oe);R(e.id,"sourceId",Ae?.id??null),R(e.id,"sourceName",Ae?.name??Oe.replace(/^name:/,"").trim())};return s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{className:"border-t border-dashed border-white/15 bg-slate-900/50",children:[s.jsx("td",{className:"px-2 md:px-4 py-3",children:s.jsx("div",{className:"flex flex-col gap-2",children:Ce&&!we.useCustomName?s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-2",children:[s.jsxs("select",{className:"w-full md:w-60 md:max-w-xs rounded-lg border border-white/20 bg-slate-900/80 px-2 md:px-3 py-2 text-xs md:text-sm text-white shadow-sm focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/30 disabled:opacity-60",value:fe,onChange:me,disabled:we.isSaving,children:[s.jsx("option",{value:"",children:c?"Đang tải Nhà Cung Cấp...":"Chọn Nhà Cung Cấp..."}),l.map(We=>{const Oe=We.id!==null?`id:${We.id}`:`name:${We.name}`;return s.jsx("option",{value:Oe,children:We.name},Oe)}),s.jsx("option",{value:"__custom__",children:"Nhập tên Nhà Cung Cấp khác"})]}),s.jsx("button",{type:"button",className:"rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>R(e.id,"useCustomName",!0),disabled:we.isSaving,children:"Nhập"})]}):s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Ce&&s.jsxs("button",{type:"button",className:"flex items-center gap-1 rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>R(e.id,"useCustomName",!1),disabled:we.isSaving,children:[s.jsx("span",{className:"text-sm",children:"←"}),s.jsx("span",{className:"sr-only",children:"Chọn từ danh sách"})]}),s.jsx("input",{type:"text",className:"w-60 max-w-xs rounded-lg border border-indigo-300/60 bg-white/95 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200",placeholder:"Tên NCC",value:we.sourceName,onChange:We=>R(e.id,"sourceName",We.target.value),disabled:we.isSaving})]})})}),s.jsx("td",{className:"px-2 md:px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s.jsx("input",{type:"text",className:"w-20 md:w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-xs md:text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Giá nhập",value:we.price,onChange:We=>R(e.id,"price",We.target.value),disabled:we.isSaving}),s.jsx("span",{className:"text-xs text-white/70",children:"đ"})]})}),s.jsx("td",{className:"hidden md:table-cell px-4 py-3 text-center text-xs text-white/70",children:"-"}),s.jsx("td",{className:"px-2 md:px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-center gap-2",children:[s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>V(e),children:s.jsx(Wn,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:we.isSaving,onClick:()=>G(e.id),children:s.jsx(Pt,{className:"h-4 w-4"})})]})})]}),we.error&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:we.error})})]},`new-${e.id}`)}return null})})]})]})]})})})})]})},R2=ua.memo(aG),iG=({item:e,isExpanded:t,statusOverride:r,updatedTimestamp:n,isDeletingProduct:a,onToggleProductDetails:i,onStartProductEdit:o,onRequestDeleteProduct:l,onToggleStatus:c})=>{const d=r??e.isActive??!1,u=n??e.lastUpdated??"",h=u?C4(u):"-",f=xl(e.pctPromo,e.pctKhach,e.pctCtv);return s.jsxs("div",{className:"price-card relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50 cursor-pointer",onClick:()=>i(e),children:[s.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${d?"bg-emerald-500":"bg-slate-500"}`}),s.jsxs("div",{className:"relative z-10 flex flex-col gap-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex items-start gap-2 min-w-0 flex-1",children:[s.jsx(yp,{className:`mt-0.5 h-4 w-4 shrink-0 text-white/60 transition-transform ${t?"rotate-180":""}`}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h3",{className:"text-[12px] sm:text-sm font-bold text-white tracking-widest uppercase truncate leading-none",children:e.packageName}),e.variantLabel&&s.jsx("p",{className:"text-[10px] text-white/60 mt-1 truncate",children:e.variantLabel})]})]}),s.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),c(e)},className:`relative shrink-0 flex h-8 w-8 items-center justify-center rounded-full border-2 shadow-inner transition ${d?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":d,children:s.jsx(xd,{className:"h-3.5 w-3.5"})})]}),s.jsxs("div",{className:`grid gap-2 ${f?"grid-cols-3":"grid-cols-2"}`,children:[s.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"Giá Sỉ"}),s.jsx("p",{className:"text-[13px] font-bold text-white tabular-nums",children:Br(e.wholesalePrice)}),s.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:Ku({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),s.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"Giá Lẻ"}),s.jsx("p",{className:"text-[13px] font-bold text-amber-300 tabular-nums",children:Br(e.retailPrice)}),s.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:Ku({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),f&&s.jsxs("div",{className:"p-2.5 rounded-2xl bg-white/5 border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-[0.15em] block mb-1",children:"KM"}),s.jsx("p",{className:"text-[13px] font-bold text-pink-200 tabular-nums",children:Br(e.promoPrice)}),s.jsx("p",{className:"text-[9px] text-white/40 mt-0.5 truncate",children:Kc(e.pctPromo)??"-"})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-0.5",children:"Cập nhật"}),s.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:h})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-xl bg-indigo-500/10 border border-indigo-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(99,102,241,0.3)] active:scale-90",onClick:m=>{m.stopPropagation(),o(m,e)},title:"Sửa",children:s.jsx(cr,{className:"h-5 w-5"})}),s.jsx("button",{className:`w-10 h-10 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-500/70 hover:bg-rose-500 hover:text-white transition-all duration-300 hover:shadow-[0_0_15px_rgba(244,63,94,0.3)] active:scale-90 ${a?"cursor-not-allowed opacity-60":""}`,onClick:m=>{m.stopPropagation(),l(m,e)},disabled:a,title:"Xóa",children:s.jsx(Xr,{className:"h-5 w-5"})})]})]})]})]})},sG=({items:e,totalRows:t,currentPage:r,rowsPerPage:n,onPageChange:a,onRowsPerPageChange:i,isLoading:o,error:l,expandedProductId:c,supplyPriceMap:d,statusOverrides:u,updatedTimestampMap:h,supplierOptions:f,isLoadingSuppliers:m,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,newSupplyRows:w,editingProductId:y,productEditForm:N,productEditError:_,isSavingProductEdit:S,deleteProductState:j,onToggleProductDetails:E,onStartProductEdit:k,onProductEditChange:T,onCancelProductEdit:A,onSubmitProductEdit:C,onRequestDeleteProduct:R,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:pe,fetchSupplyPricesForProduct:Ne})=>{const ee=Math.max(1,Math.ceil(t/n)),oe=Math.min(Math.max(r,1),ee),he=[10,20,50],O=ua.useMemo(()=>{const J=(Pe,ue)=>{Pe>=1&&Pe<=ee&&ue.add(Pe)},se=new Set([1,ee]);J(oe-1,se),J(oe,se),J(oe+1,se),oe<=2&&(J(2,se),J(3,se),J(4,se)),oe>=ee-1&&(J(ee-1,se),J(ee-2,se),J(ee-3,se));const ke=Array.from(se).sort((Pe,ue)=>Pe-ue),ye=[];return ke.forEach((Pe,ue)=>{ue>0&&Pe-ke[ue-1]>1&&ye.push("ellipsis"),ye.push(Pe)}),ye},[oe,ee]),I=J=>{const se=Math.min(Math.max(J,1),ee);a(se)},L="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 transition-all hover:bg-white/10 hover:border-white/20 disabled:opacity-40 disabled:cursor-not-allowed active:scale-95",F="w-10 h-10 flex items-center justify-center rounded-xl font-bold border border-white/10 bg-white/5 text-white/80 transition-all hover:bg-white/10 hover:border-white/20 active:scale-95",W="bg-gradient-to-br from-indigo-500 to-purple-600 text-white border-white/20 shadow-[0_8px_20px_-6px_rgba(99,102,241,0.6)]";return s.jsxs("div",{className:"overflow-hidden rounded-[32px] border border-white/5 bg-white/5 text-white shadow-2xl backdrop-blur-xl",children:[s.jsx("div",{className:"md:hidden",children:o?s.jsx("div",{className:"px-6 py-8 text-center text-sm text-white/80",children:"Đang Tải Dữ Liệu..."}):e.length===0?s.jsx("div",{className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Không thể tải dữ liệu. Vui lòng thử lại.":"Không có sản phẩm."}):s.jsx("div",{className:"p-3 space-y-3",children:e.map(J=>{const se=c===J.id,ke=j.product?.id===J.id&&j.loading,ye=Vs(J.sanPhamRaw),Pe=d[ye],ue=w[J.id]||null;return s.jsxs("div",{children:[s.jsx(iG,{item:J,isExpanded:se,statusOverride:u[J.id],updatedTimestamp:h[J.id],isDeletingProduct:ke,onToggleProductDetails:E,onStartProductEdit:(Be,Ve)=>{se||E(Ve),k(Be,Ve)},onRequestDeleteProduct:R,onToggleStatus:pe}),se&&s.jsx("div",{className:"mt-1 overflow-x-auto rounded-2xl border border-white/10 bg-slate-900/60",children:s.jsx("table",{className:"w-full text-white",children:s.jsx("tbody",{children:s.jsx(R2,{item:J,productKey:ye,isExpanded:!0,statusOverride:u[J.id],updatedTimestamp:h[J.id],supplyState:Pe,pendingNewSupply:ue,supplierOptions:f,isLoadingSuppliers:m,editingProductId:y,productEditForm:N,productEditError:_,isSavingProductEdit:S,isDeletingProduct:ke,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:E,onStartProductEdit:k,onProductEditChange:T,onCancelProductEdit:A,onSubmitProductEdit:C,onRequestDeleteProduct:R,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:pe,fetchSupplyPricesForProduct:Ne})})})})]},`card-${J.id}`)})})}),s.jsx("div",{className:"overflow-x-auto hidden md:block",children:s.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[s.jsx("thead",{className:"bg-white/5",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Sản Phẩm"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Sỉ"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Lẻ"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Giá Khuyến Mãi"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Tình Trạng Sản Phẩm"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Cập Nhật"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Thao Tác"})]})}),s.jsx("tbody",{className:"divide-y divide-white/10 bg-white/5",children:o?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"Đang Tải Dữ Liệu..."})}):e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Không thể tải dữ liệu. Vui lòng thử lại.":"Không có sản phẩm."})}):e.map(J=>{const se=c===J.id,ke=Vs(J.sanPhamRaw),ye=d[ke],Pe=w[J.id]||null,ue=j.product?.id===J.id&&j.loading;return s.jsx(R2,{item:J,productKey:ke,isExpanded:se,statusOverride:u[J.id],updatedTimestamp:h[J.id],supplyState:ye,pendingNewSupply:Pe,supplierOptions:f,isLoadingSuppliers:m,editingProductId:y,productEditForm:N,productEditError:_,isSavingProductEdit:S,isDeletingProduct:ue,editingSupplyRows:x,supplyPriceDrafts:g,savingSupplyRows:v,supplyRowErrors:b,onToggleProductDetails:E,onStartProductEdit:k,onProductEditChange:T,onCancelProductEdit:A,onSubmitProductEdit:C,onRequestDeleteProduct:R,onStartEditingSupply:G,onSupplyInputChange:V,onCancelSupplyEditing:X,onConfirmSupplyEditing:K,onStartAddSupplierRow:Y,onNewSupplierInputChange:q,onCancelAddSupplierRow:Z,onConfirmAddSupplierRow:le,onDeleteSupplyRow:ce,onToggleStatus:pe,fetchSupplyPricesForProduct:Ne},J.id)})})]})}),s.jsxs("div",{className:"flex flex-col gap-3 border-t border-white/10 bg-slate-950/70 px-4 py-3 text-sm text-white/80 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:"Hiển thị"}),s.jsx("select",{className:"rounded-lg border border-white/20 bg-slate-900 px-3 py-1 text-white shadow-sm focus:border-indigo-400 focus:outline-none",value:n,onChange:J=>i(Number(J.target.value)),children:he.map(J=>s.jsx("option",{value:J,children:J},J))}),s.jsx("span",{children:"dòng"})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[s.jsx("button",{className:L,onClick:()=>I(1),disabled:oe===1,"aria-label":"Trang đầu",children:"<<"}),s.jsx("button",{className:L,onClick:()=>I(oe-1),disabled:oe===1,"aria-label":"Trang trước",children:"<"}),O.map((J,se)=>J==="ellipsis"?s.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${se}`):s.jsx("button",{className:`${F} ${oe===J?W:""}`,onClick:()=>I(J),children:J},J)),s.jsx("button",{className:L,onClick:()=>I(oe+1),disabled:oe===ee,"aria-label":"Trang sau",children:">"}),s.jsx("button",{className:L,onClick:()=>I(ee),disabled:oe===ee,"aria-label":"Trang cuối",children:">>"})]})]})]})},oG=({isOpen:e,createForm:t,createSuppliers:r,supplierOptions:n,bankOptions:a,isLoadingSuppliers:i,isLoadingBanks:o,isSubmitting:l,createError:c,onClose:d,onFormChange:u,onSupplierChange:h,onSupplierSelectChange:f,onSupplierPriceInput:m,onEnableCustomSupplier:x,onAddSupplier:g,onRemoveSupplier:v,onSubmit:b})=>{if(!e)return null;const w="mt-1 w-full rounded-xl border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-white placeholder:text-slate-400 shadow-inner focus:border-indigo-400 focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",y="text-xs font-semibold text-slate-300 uppercase tracking-wide";return s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-start justify-center overflow-y-auto bg-black/50 px-2 py-4 sm:px-4 sm:py-6",style:{zIndex:9999},children:s.jsxs("div",{className:"relative flex w-full max-w-4xl flex-col rounded-[32px] border border-white/15 bg-gradient-to-br from-slate-800/95 via-slate-700/90 to-slate-900/95 shadow-2xl backdrop-blur-sm",style:{zIndex:1e4},children:[s.jsx("button",{className:"absolute right-4 top-4 text-slate-400 hover:text-white transition-colors z-10",onClick:d,children:s.jsx(Pt,{className:"h-6 w-6"})}),s.jsxs("div",{className:"space-y-6 px-4 py-6 sm:px-6 sm:py-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Thêm Sản Phẩm mới"}),s.jsx("p",{className:"text-base text-slate-300",children:"Nhập Thông tin Sản Phẩm, Tỷ Giá và Nhà Cung Cấp"})]}),s.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300 mb-4",children:"Thông Tin Cơ Bản"}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Tên Sản Phẩm"}),s.jsx("input",{type:"text",className:w,placeholder:"Nhập tên sản phẩm",value:t.packageName,onChange:N=>u("packageName",N.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Gói Sản Phẩm"}),s.jsx("input",{type:"text",className:w,placeholder:"Nhập gói sản phẩm",value:t.packageProduct,onChange:N=>u("packageProduct",N.target.value)})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:y,children:"Mã Sản Phẩm"}),s.jsx("input",{type:"text",className:w,placeholder:"Nhập mã sản phẩm",value:t.sanPham,onChange:N=>u("sanPham",N.target.value)})]})]})]}),s.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300 mb-4",children:"Tỷ Giá"}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Tỷ Giá CTV"}),s.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctCtv,onChange:N=>u("pctCtv",N.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Tỷ Giá Khách"}),s.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctKhach,onChange:N=>u("pctKhach",N.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Tỷ Giá Khuyến Mãi"}),s.jsx("input",{type:"number",step:"0.01",min:"0",className:`${w} appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none`,placeholder:"0.00",value:t.pctPromo,onChange:N=>u("pctPromo",N.target.value)})]})]})]}),s.jsx("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 p-5 shadow-sm backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-300",children:"Thông Tin Nhà Cung Cấp"}),s.jsxs("div",{className:"space-y-4",children:[r.map(N=>s.jsxs("div",{className:"rounded-xl border border-white/10 bg-slate-900/40 p-4",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-semibold text-white",children:"Nhà Cung Cấp"}),r.length>1&&s.jsx("button",{type:"button",onClick:()=>v(N.id),className:"text-red-400 hover:text-red-300 transition-colors",children:s.jsx(jk,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Tên Nhà Cung Cấp"}),N.useCustomName?s.jsx("input",{type:"text",className:w,placeholder:"Nhập tên nhà cung cấp",value:N.sourceName,onChange:_=>h(N.id,"sourceName",_.target.value)}):s.jsxs("div",{className:"relative",children:[s.jsxs("select",{className:w,value:N.sourceId??"",onChange:_=>f(N.id,_.target.value),disabled:i,children:[s.jsx("option",{value:"",children:"Chọn Nhà Cung Cấp"}),n.map(_=>s.jsx("option",{value:_.id??"",children:_.name},_.id))]}),i&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"})})]}),s.jsx("button",{type:"button",onClick:()=>x(N.id),className:"mt-2 text-xs text-indigo-400 hover:text-indigo-300 transition-colors",children:N.useCustomName?"← Chọn từ danh sách":"+ Thêm nhà cung cấp mới"})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Giá Nhập"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",className:w,placeholder:"0",value:N.price,onChange:_=>m(N.id,_.target.value)}),s.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400",children:"VNĐ"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Số Tài Khoản"}),s.jsx("input",{type:"text",className:w,placeholder:"Nhập số tài khoản",value:N.numberBank,onChange:_=>h(N.id,"numberBank",_.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:y,children:"Ngân Hàng"}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{className:w,value:N.bankBin,onChange:_=>h(N.id,"bankBin",_.target.value),disabled:o,children:[s.jsx("option",{value:"",children:"Chọn Ngân Hàng"}),a.map(_=>s.jsx("option",{value:_.bin,children:_.name},_.bin))]}),o&&s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-indigo-500 border-t-transparent"})})]})]})]}),(()=>{const _=N.price?Number(String(N.price).replace(/\D/g,"")):null,S=_!=null&&Number.isFinite(_)&&_>0,j=S?gl(_,kn(t.pctCtv)):null,E=j!=null?gl(j,kn(t.pctKhach)):null,k=Vu(j),T=Vu(E);return S?s.jsxs("div",{className:"mt-4 grid gap-2 rounded-lg border border-white/5 bg-slate-950/30 p-3 text-xs",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Xem Trước Giá (theo Tỷ Giá CTV):"}),s.jsx("span",{className:"font-semibold text-white",children:ap(k)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Giá Lẻ (từ giá CTV × Tỷ Giá Khách):"}),s.jsx("span",{className:"font-semibold text-white",children:ap(T)})]})]}):null})()]},N.id)),s.jsxs("button",{type:"button",onClick:g,className:"flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed border-white/20 bg-slate-900/20 px-4 py-3 text-sm font-semibold text-indigo-300 transition-all hover:border-indigo-400/50 hover:bg-slate-800/40 hover:text-indigo-200",children:[s.jsx(Hk,{className:"h-5 w-5"}),"Thêm Nhà Cung Cấp"]})]})]})}),c&&s.jsx("div",{className:"rounded-xl border border-red-500/20 bg-red-500/10 p-4",children:s.jsx("p",{className:"text-sm text-red-300",children:c})}),s.jsxs("div",{className:"flex items-center justify-end gap-3 rounded-2xl border border-white/10 bg-white/5 p-4 backdrop-blur-sm",children:[s.jsx("button",{type:"button",onClick:d,disabled:l,className:"rounded-xl border border-white/20 bg-transparent px-6 py-3 font-semibold text-white transition-all hover:bg-white/10 disabled:opacity-50",children:"Hủy bỏ"}),s.jsx(nn,{onClick:b,disabled:l,className:"px-6 py-3",children:l?"Đang Lưu...":"Thêm Sản Phẩm"})]})]})]})})},lG=({product:e,loading:t,error:r,onClose:n,onConfirm:a})=>e?s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 px-4 py-6",style:{zIndex:9999},onClick:()=>{t||n()},children:s.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:i=>i.stopPropagation(),children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xác Định Xóa"}),s.jsx("p",{className:"text-sm text-sky-200/90",children:"Hành động này sẽ Xóa Sản Phẩm khỏi bảng Giá."})]}),s.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:n,disabled:t,children:s.jsx(Pt,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-sky-100",children:e.packageName||e.packageProduct||e.sanPhamRaw||`Sản Phẩm #${e.id}`}),s.jsxs("p",{className:"text-sm text-sky-200/90",children:["Mã: ",e.sanPhamRaw||"Không xác định"]})]}),s.jsx("p",{children:"Bạn có chắc chắn muốn xóa sản phẩm này? Hành động không thể hoàn tác và dữ liệu liên quan sẽ được cập nhật."})]}),r&&s.jsx("p",{className:"mt-4 text-xs text-red-500",children:r}),s.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[s.jsx("button",{type:"button",className:"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-white/70 hover:bg-indigo-500/10 disabled:opacity-50",onClick:n,disabled:t,children:"Hủy"}),s.jsx("button",{type:"button",className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60",onClick:a,disabled:t,children:t?"Đang Xóa...":"Xóa Sản Phẩm"})]})]})}):null,cG=e=>{const[t,r]=p.useState(""),[n,a]=p.useState("all"),[i,o]=p.useState(1),[l,c]=p.useState(10),[d,u]=p.useState([]),[h,f]=p.useState(!1),[m,x]=p.useState(null),[g,v]=p.useState(null),[b,w]=p.useState({}),[y,N]=p.useState({}),[_,S]=p.useState(!1),j=p.useCallback(async()=>{f(!0),x(null);try{const A=await fetch(`${e}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(A.status===401){window.location.href="/login";return}if(!A.ok)throw new Error("Không thể tải dữ liệu sản phẩm.");const C=await A.json(),V=(Array.isArray(C)?C:Array.isArray(C?.items)?C.items:[]).map((K,Y)=>T4(K,Y)).map(K=>zo(K,K.baseSupplyPrice)),X=V.reduce((K,Y)=>(Y.lastUpdated&&(K[Y.id]=Y.lastUpdated),K),{});u(V),w({}),N(X)}catch(A){console.error("Lỗi khi tải dữ liệu:",A),u([]),x(A instanceof Error?A.message:"Không thể tải dữ liệu pricing.")}finally{f(!1)}},[e]),E=p.useMemo(()=>{const A=t.trim().toLowerCase();return d.filter(C=>n==="active"&&!C.isActive||n==="inactive"&&C.isActive?!1:A?[C.packageName,C.packageProduct,C.sanPhamRaw,C.variantLabel].join(" ").toLowerCase().includes(A):!0).sort((C,R)=>{const G=!(b[C.id]??C.isActive),V=!(b[R.id]??R.isActive);if(G!==V)return G?1:-1;const X=Gu(y[C.id]??C.lastUpdated),K=Gu(y[R.id]??R.lastUpdated);return X!==K?K-X:C.id-R.id})},[d,t,n,b,y]),k=p.useMemo(()=>{const A=(i-1)*l,C=A+l;return E.slice(A,C)},[E,i,l]),T=E.length;return{currentPage:i,setCurrentPage:o,rowsPerPage:l,setRowsPerPage:c,totalRows:T,searchTerm:t,setSearchTerm:r,statusFilter:n,setStatusFilter:a,productPrices:d,setProductPrices:u,isLoading:h,setIsLoading:f,error:m,setError:x,statusOverrides:b,setStatusOverrides:w,updatedTimestampMap:y,setUpdatedTimestampMap:N,expandedProductId:g,setExpandedProductId:v,isRefreshing:_,setIsRefreshing:S,fetchProductPrices:j,filteredPricing:k}},uG=e=>({packageName:e.packageName||"",packageProduct:e.packageProduct||"",sanPham:e.sanPhamRaw||"",pctCtv:e.pctCtv!==null&&e.pctCtv!==void 0?String(e.pctCtv):"",pctKhach:e.pctKhach!==null&&e.pctKhach!==void 0?String(e.pctKhach):"",pctPromo:e.pctPromo!==null&&e.pctPromo!==void 0?String(e.pctPromo):""}),dG=({apiBase:e,productPrices:t,setProductPrices:r,fetchProductPrices:n,statusOverrides:a,setStatusOverrides:i,updatedTimestampMap:o,setUpdatedTimestampMap:l})=>{const[c,d]=p.useState(null),[u,h]=p.useState(null),[f,m]=p.useState(null),[x,g]=p.useState(!1),[v,b]=p.useState(!1),[w,y]=p.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[N,_]=p.useState([gf()]),[S,j]=p.useState(null),[E,k]=p.useState(!1),[T,A]=p.useState([]),[C,R]=p.useState(!1),[G,V]=p.useState([]),[X,K]=p.useState(!1),[Y,q]=p.useState({product:null,loading:!1,error:null}),Z=p.useCallback(async()=>{if(!(X||G.length>0)){K(!0);try{const ve=await fetch(`${e}${Je.BANK_LIST}`,{credentials:"include"});if(!ve.ok)throw new Error("Không thể tải danh sách ngân hàng.");const we=await ve.json(),fe=Array.isArray(we)?we.map(Ce=>({bin:Ce?.bin?.toString().trim()??"",name:Ce?.bank_name?.toString().trim()??Ce?.name??""})).filter(Ce=>Ce.bin&&Ce.name):[];V(fe)}catch(ve){console.error("Lỗi khi tải danh sách ngân hàng:",ve)}finally{K(!1)}}},[e,G.length,X]),le=p.useCallback(async()=>{if(!(C||T.length>0)){R(!0);try{const ve=await fetch(`${e}${Je.SUPPLIES}`,{credentials:"include"});if(!ve.ok)throw new Error("Không thể tải danh sách NCC.");const we=await ve.json().catch(()=>null),Ce=(Array.isArray(we?.items)?we.items:Array.isArray(we)?we:[]).map(Oe=>{const Ae=Oe?.id??Oe?.sourceId??Oe?.source_id,Ye=typeof Ae=="number"&&Number.isFinite(Ae)?Ae:Number.isFinite(Number(Ae))?Number(Ae):null,ct=Oe?.supplier_name??Oe?.source_name??Oe?.name??Oe?.sourceName??Oe?.source??"";return{id:Ye??null,name:(ct||"").trim(),numberBank:Oe?.number_bank??Oe?.numberBank??Oe?.bankNumber??"",binBank:Oe?.bin_bank??Oe?.binBank??Oe?.bankBin??""}}).filter(Oe=>Oe.name.length>0),me=[],We=new Set;for(const Oe of Ce){const Ae=Oe.id!==null?`id:${Oe.id}`:`name:${Oe.name.toLowerCase().trim()}`;We.has(Ae)||(We.add(Ae),me.push(Oe))}A(me)}catch(ve){console.error("Lỗi khi tải danh sách NCC:",ve)}finally{R(!1)}}},[e,C,T.length]);p.useEffect(()=>{!C&&T.length===0&&le()},[C,T.length,le]),p.useEffect(()=>{v&&G.length===0&&!X&&Z(),v&&T.length===0&&!C&&le()},[v,G.length,X,Z,T.length,C,le]);const ce=(ve,we)=>{if(ve.stopPropagation(),g(!1),c===we.id){d(null),h(null),m(null);return}m(null),d(we.id),h(uG(we))},pe=(ve,we)=>{h(fe=>fe&&{...fe,[ve]:we})},Ne=()=>{d(null),h(null),m(null),g(!1)},ee=async()=>{if(!u||c===null)return;const ve=u.packageName?.trim()??"",we=u.packageProduct?.trim()??"",fe=u.sanPham?.trim()??"";if(!fe){m("Vui lòng nhập mã sản phẩm hợp lệ");return}const Ce=kn(u.pctCtv),me=kn(u.pctKhach),We=kn(u.pctPromo);if(!Ce||Ce<=0){m("Tỷ giá CTV phải lớn hơn 0");return}if(!me||me<=0){m("Tỷ giá Khách phải lớn hơn 0");return}if(We!==null){if(We<rp){m("Tỷ lệ khuyến mãi không được âm.");return}const Oe=Math.max(0,me-1);if(Oe===0&&We>0){m("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(We>Oe){m(`Tỷ lệ khuyến mãi không được vượt ${Oe.toFixed(2)}`);return}}g(!0),m(null);try{const Oe=await fetch(`${e}${Je.PRODUCT_PRICE_DETAIL(c)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:ve,packageProduct:we,sanPham:fe,pctCtv:Ce,pctKhach:me,pctPromo:We}),credentials:"include"}),Ae=await Oe.text();let Ye=null;if(Ae)try{Ye=JSON.parse(Ae)}catch{Ye=null}if(!Oe.ok){const He=Ye?.error||Ae?.trim()||"Không thể cập nhật giá sản phẩm";throw new Error(He)}const ct=T4(Ye,c);r(He=>He.map(ut=>ut.id===c?ct:ut)),ct?.id!==void 0&&l(He=>({...He,[ct.id]:ct.lastUpdated||new Date().toISOString()})),await n(),d(null),h(null)}catch(Oe){console.error("Lỗi khi cập nhật giá sản phẩm:",Oe),m(Oe instanceof Error?Oe.message:"Không thể cập nhật giá sản phẩm")}finally{g(!1)}},oe=p.useCallback((ve,we)=>{ve.stopPropagation(),q({product:we,loading:!1,error:null})},[]),he=p.useCallback(()=>{q({product:null,loading:!1,error:null})},[]),O=p.useCallback(async()=>{const ve=Y.product;if(ve){q(we=>({...we,loading:!0,error:null}));try{const we=await LK(ve.id);if(!we.success)throw new Error(we.message||"Không thể xóa sản phẩm.");r(fe=>fe.filter(Ce=>Ce.id!==ve.id)),i(fe=>{const Ce={...fe};return delete Ce[ve.id],Ce}),l(fe=>{const Ce={...fe};return delete Ce[ve.id],Ce}),he()}catch(we){console.error("Failed to delete product price:",we),q(fe=>({...fe,loading:!1,error:we instanceof Error?we.message:"Không thể xóa sản phẩm. Vui lòng thử lại."}))}}},[he,Y.product,r,i,l]),I=()=>{y({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),_([gf()]),j(null),k(!1)},L=()=>{I(),b(!0),G.length===0&&!X&&Z(),T.length===0&&!C&&le()},F=()=>{b(!1),I()};return{editingProductId:c,productEditForm:u,productEditError:f,isSavingProductEdit:x,isCreateModalOpen:v,createForm:w,createSuppliers:N,createError:S,isSubmittingCreate:E,supplierOptions:T,isLoadingSuppliers:C,bankOptions:G,isLoadingBanks:X,deleteProductState:Y,handleStartProductEdit:ce,handleProductEditChange:pe,handleCancelProductEdit:Ne,handleSubmitProductEdit:ee,handleRequestDeleteProduct:oe,confirmDeleteProduct:O,closeDeleteProductModal:he,handleOpenCreateModal:L,handleCloseCreateModal:F,handleCreateFormChange:(ve,we)=>{y(fe=>({...fe,[ve]:we}))},handleSupplierChange:(ve,we,fe)=>{_(Ce=>Ce.map(me=>me.id===ve?{...me,[we]:we==="sourceId"?fe&&Number(fe)||null:we==="useCustomName"?fe==="true":fe}:me))},handleSupplierSelectChange:(ve,we)=>{const fe=T.find(Ce=>Ce.id!==null&&we===String(Ce.id)||Ce.id===null&&we===Ce.name)||null;_(Ce=>Ce.map(me=>me.id===ve?{...me,sourceId:fe?.id??null,sourceName:fe?.name??"",numberBank:fe?.numberBank??"",bankBin:fe?.binBank??"",useCustomName:!1}:me))},handleSupplierPriceInput:(ve,we)=>{const fe=np(we);_(Ce=>Ce.map(me=>me.id===ve?{...me,price:fe}:me))},handleEnableCustomSupplier:ve=>{_(we=>we.map(fe=>fe.id===ve?{...fe,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:fe))},handleAddSupplierRow:()=>{_(ve=>[...ve,gf()])},handleRemoveSupplierRow:ve=>{_(we=>we.length===1?we:we.filter(fe=>fe.id!==ve))},handleSubmitCreateProduct:async()=>{const ve=w.packageName.trim(),we=w.packageProduct.trim(),fe=w.sanPham.trim(),Ce=kn(w.pctCtv),me=kn(w.pctKhach),We=kn(w.pctPromo);if(!fe){j("Vui lòng nhập mã sản phẩm");return}if(Ce!==null&&Ce<=0){j("Tỷ giá CTV phải lớn hơn 0.");return}if(me!==null&&me<=0){j("Tỷ giá khách phải lớn hơn 0.");return}if(We!==null){if(We<rp){j("Tỷ lệ khuyến mãi không được âm.");return}if(me!==null&&me>0){const Ae=Math.max(0,me-1);if(Ae===0&&We>0){j("Tỷ giá khuyến mãi không áp dụng khi Tỷ giá Khách ở mức 1.");return}if(We>Ae){j(`Tỷ lệ khuyến mãi không được vượt ${Ae.toFixed(2)}`);return}}}const Oe=N.map(Ae=>{const Ye=(Ae.sourceName||"").trim(),ct=Number((Ae.price||"").replace(/\D+/g,"")),He=Number.isFinite(ct)&&ct>0?ct:null,ut=Ae.sourceId,wn=ut!=null&&Number.isFinite(Number(ut))?Number(ut):void 0;return!wn&&!Ye?null:{sourceId:wn,sourceName:Ye||void 0,price:He,numberBank:(Ae.numberBank||"").trim()||void 0,binBank:(Ae.bankBin||"").trim()||void 0}}).filter(Ae=>!!(Ae&&(Ae.sourceId!==void 0||Ae.sourceName&&Ae.sourceName.length>0)));if(Oe.length===0){j("Vui lòng chọn hoặc nhập ít nhất một Nhà Cung Cấp và giá nhập.");return}k(!0),j(null);try{const Ae=await fetch(`${e}${Je.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:ve||void 0,packageProduct:we||void 0,sanPham:fe,pctCtv:Ce??void 0,pctKhach:me??void 0,pctPromo:We??void 0,suppliers:Oe}),credentials:"include"}),Ye=await Ae.text();let ct=null;if(Ye)try{ct=JSON.parse(Ye)}catch{ct=null}if(!Ae.ok){const He=ct?.error||Ye?.trim()||"Không thể tạo sản phẩm";throw new Error(He)}await n(),F()}catch(Ae){console.error("Lỗi khi tạo sản phẩm:",Ae),j(Ae instanceof Error?Ae.message:"Không thể tạo sản phẩm")}finally{k(!1)}},handleToggleStatus:async ve=>{const fe=!(a[ve.id]??ve.isActive??!1),Ce=a[ve.id],me=o[ve.id],We=new Date().toISOString();i(Oe=>({...Oe,[ve.id]:fe})),r(Oe=>Oe.map(Ae=>Ae.id===ve.id?{...Ae,isActive:fe}:Ae)),l(Oe=>({...Oe,[ve.id]:We}));try{const Oe=await fetch(`${e}${Je.PRODUCT_PRICES}/${ve.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:fe}),credentials:"include"});if(!Oe.ok)throw new Error("Lỗi khi cập nhật trạng thái");const Ae=await Oe.json(),Ye=Ae?.is_active??fe,ct=typeof Ae?.update=="string"?Ae.update:We;i(He=>({...He,[ve.id]:Ye})),r(He=>He.map(ut=>ut.id===ve.id?{...ut,isActive:Ye,lastUpdated:ct}:ut)),l(He=>({...He,[ve.id]:ct}))}catch(Oe){console.error("Failed to toggle product status:",Oe),i(Ae=>{const Ye={...Ae};return Ce===void 0?delete Ye[ve.id]:Ye[ve.id]=Ce,Ye}),r(Ae=>Ae.map(Ye=>Ye.id===ve.id?{...Ye,isActive:Ce??ve.isActive??!1}:Ye)),l(Ae=>{const Ye={...Ae};return me?Ye[ve.id]=me:delete Ye[ve.id],Ye}),br({type:"error",title:"Lỗi cập nhật trạng thái giá",message:"Cập nhật thất bại. Vui lòng thử lại."})}}}},hG=({apiBase:e,setProductPrices:t,fetchProductPrices:r})=>{const[n,a]=p.useState({}),[i,o]=p.useState({}),[l,c]=p.useState({}),[d,u]=p.useState({}),[h,f]=p.useState({}),[m,x]=p.useState({}),g=p.useCallback(async T=>{const A=Vs(T);if(A){a(C=>({...C,[A]:{items:C[A]?.items??[],loading:!0,error:null,productName:C[A]?.productName??T}}));try{const C=await fetch(`${e}${Je.SUPPLY_PRICES_BY_PRODUCT_NAME(T)}`,{credentials:"include"});if(!C.ok)throw new Error("Không thể tải giá nguồn. Vui lòng thử lại.");const R=await C.json(),G=Array.isArray(R)?R.map((K,Y)=>({sourceId:Number.isFinite(Number(K?.sourceId??K?.source_id))?Number(K?.sourceId??K?.source_id):Y,sourceName:K?.supplier_name?.toString().trim()||K?.sourceName?.toString().trim()||K?.source_name?.toString().trim()||`Nhà Cung Cấp #${Number(K?.sourceId)||Y+1}`,price:typeof K?.price=="number"&&Number.isFinite(K.price)?K.price:null,lastOrderDate:typeof K?.last_order_date=="string"?K.last_order_date:null})):[],V=jc(tG(G)),X=ai(V,null);typeof X=="number"&&Number.isFinite(X)&&X>0&&t(K=>{let Y=!1;const q=K.map(Z=>{if(Vs(Z.sanPhamRaw)!==A)return Z;const le=typeof Z.baseSupplyPrice=="number"&&Number.isFinite(Z.baseSupplyPrice)&&Math.abs(Z.baseSupplyPrice-X)<1e-5,ce=typeof Z.wholesalePrice=="number"&&Number.isFinite(Z.wholesalePrice)&&Z.wholesalePrice>0,pe=typeof Z.retailPrice=="number"&&Number.isFinite(Z.retailPrice)&&Z.retailPrice>0,Ne=xl(Z.pctPromo,Z.pctKhach,Z.pctCtv),ee=typeof Z.promoPrice=="number"&&Number.isFinite(Z.promoPrice)&&Z.promoPrice>0;return le&&ce&&pe&&(!Ne||ee)?Z:(Y=!0,zo({...Z,baseSupplyPrice:X},X))});return Y?q:K}),a(K=>({...K,[A]:{loading:!1,error:null,items:V,productName:T}}))}catch(C){a(R=>({...R,[A]:{loading:!1,items:R[A]?.items??[],error:C instanceof Error?C.message:"Không thể tải giá nguồn. Vui lòng thử lại.",productName:R[A]?.productName??T}}))}}},[e,t]),v=T=>{o(A=>{const C={...A};return delete C[T],C}),c(A=>{const C={...A};return delete C[T],C}),f(A=>{const C={...A};return delete C[T],C})},b=(T,A,C)=>{const R=Rs(T,A);o(G=>({...G,[R]:!0})),c(G=>({...G,[R]:C==null?"":ap(C)})),f(G=>({...G,[R]:null}))},w=(T,A,C)=>{const R=Rs(T,A),G=np(C);c(V=>({...V,[R]:G})),f(V=>({...V,[R]:null}))},y=(T,A)=>{const C=Rs(T,A);v(C),u(R=>{const G={...R};return delete G[C],G})},N=async(T,A,C,R)=>{const G=Rs(T,A),X=l[G]?.toString().trim()??"";if(!X){f(Y=>({...Y,[G]:"Vui lòng nhập giá hợp lệ."}));return}const K=Number(X.replace(/\D+/g,""));if(!Number.isFinite(K)||K<0){f(Y=>({...Y,[G]:"Giá nhập không được thấp hơn 0."}));return}u(Y=>({...Y,[G]:!0}));try{const Y=await fetch(`${e}${Je.UPDATE_SUPPLY_PRICE(T,A)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:K}),credentials:"include"}),q=await Y.json().catch(()=>null);if(!Y.ok)throw new Error(q?.error||"Không thể cập nhật giá nguồn.");const Z=Number.isFinite(Number(q?.price))?Number(q?.price):K;let le=null,ce=!1;if(a(pe=>{const Ne=pe[C];if(!Ne)return pe;const ee=ai(Ne.items,null),oe=Ne.items.find(J=>J.sourceId===A),he=typeof oe?.price=="number"?oe.price:null,O=typeof he=="number"&&typeof ee=="number"&&Math.abs(he-ee)<1e-5,I=jc(Ne.items.map(J=>J.sourceId===A?{...J,price:Z}:J)),L=ai(I,null),F=he===null||he!==Z;return typeof L=="number"&&Number.isFinite(L)&&L>0?(le=L,(L!==ee||O&&F)&&(ce=!0)):O&&F&&(le=L??null,ce=!0),{...pe,[C]:{...Ne,items:I}}}),ce&&t(pe=>pe.map(Ne=>Ne.id===T?zo(Ne,le):Ne)),v(G),await g(R),ce)try{await r()}catch(pe){console.error("Failed to refresh product pricing:",pe)}}catch(Y){f(q=>({...q,[G]:Y instanceof Error?Y.message:"Không thể cập nhật giá nguồn."}))}finally{u(Y=>{const q={...Y};return delete q[G],q})}},_=T=>{x(A=>A[T]?A:{...A,[T]:{sourceName:"",sourceId:null,useCustomName:!1,price:"",error:null,isSaving:!1}})},S=(T,A,C)=>{let R=C;if(A==="price")R=np(String(C??""));else if(A==="sourceId"){const G=Number(C);R=C===null||Number.isNaN(G)||!Number.isFinite(G)?null:G}else A==="useCustomName"?R=!!C:R=String(C??"");x(G=>{const V=G[T];if(!V)return G;const X={...V,[A]:R,error:null};return A==="useCustomName"&&(R?(X.sourceId=null,X.sourceName=""):!X.sourceName&&V.sourceName&&(X.sourceName=V.sourceName)),{...G,[T]:X}})},j=T=>{x(A=>{const C={...A};return delete C[T],C})};return{supplyPriceMap:n,editingSupplyRows:i,supplyPriceDrafts:l,savingSupplyRows:d,supplyRowErrors:h,newSupplyRows:m,fetchSupplyPricesForProduct:g,handleStartEditingSupply:b,handleSupplyInputChange:w,handleCancelSupplyEditing:y,handleConfirmSupplyEditing:N,handleStartAddSupplierRow:_,handleNewSupplierInputChange:S,handleCancelAddSupplierRow:j,handleConfirmAddSupplierRow:async T=>{const A=m[T.id];if(!A)return;const C=A.sourceName.trim(),R=A.useCustomName||A.sourceId===null?null:A.sourceId,G=Number((A.price||"").replace(/\D+/g,""));if(!C){x(V=>({...V,[T.id]:{...A,error:"Vui lòng chọn hoặc nhập tên nguồn hợp lệ."}}));return}if(!Number.isFinite(G)||G<=0){x(V=>({...V,[T.id]:{...A,error:"Giá nhập phải lớn hơn 0."}}));return}x(V=>({...V,[T.id]:{...A,isSaving:!0,error:null}}));try{const V=await fetch(`${e}${Je.CREATE_SUPPLY_PRICE(T.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:C,sourceId:R,price:G}),credentials:"include"}),X=await V.json().catch(()=>null);if(!V.ok)throw new Error(X?.error||"Không thể thêm nguồn mới.");const K=Vs(T.sanPhamRaw),Y=Number(X?.sourceId),Z=(typeof R=="number"&&Number.isFinite(R)&&R>0?R:null)??Date.now(),le=Number.isFinite(Y)&&Y>0?Y:Z,ce=Number.isFinite(Number(X?.price))?Number(X?.price):G;let pe=null,Ne=!1;if(a(ee=>{const oe=ee[K],he=oe?.items??[],O=he.some(J=>J.sourceId===le),I=jc(O?he.map(J=>J.sourceId===le?{...J,price:ce}:J):[...he,{sourceId:le,sourceName:C,price:ce,lastOrderDate:null}]),L=ai(he,null),F=ai(I,null);return(typeof L=="number"&&typeof F=="number"?Math.abs(F-L)>1e-5:L!==F)&&(Ne=!0),pe=F,{...ee,[K]:{loading:oe?.loading??!1,error:null,items:I}}}),Ne&&t(ee=>ee.map(oe=>oe.id===T.id?zo(oe,pe):oe)),await g(T.sanPhamRaw),j(T.id),Ne)try{await r()}catch(ee){console.error("Failed to refresh product pricing:",ee)}}catch(V){x(X=>({...X,[T.id]:{...A,isSaving:!1,error:V instanceof Error?V.message:"Không thể thêm nguồn mới."}}))}},handleDeleteSupplyRow:async(T,A,C,R)=>{const G=Rs(T,A);f(K=>({...K,[G]:null})),u(K=>({...K,[G]:!0}));let V=null,X=!1;try{const K=await fetch(`${e}${Je.DELETE_SUPPLY_PRICE(T,A)}`,{method:"DELETE",credentials:"include"}),Y=await K.json().catch(()=>null);if(!K.ok)throw new Error(Y?.error||"Không thể xóa nguồn này.");if(a(q=>{const Z=q[C];if(!Z)return q;const le=jc(Z.items.filter(ee=>ee.sourceId!==A)),ce=ai(Z.items,null),pe=ai(le,null);return(typeof ce=="number"&&typeof pe=="number"?Math.abs(pe-ce)>1e-5:ce!==pe)&&(X=!0),V=pe,{...q,[C]:{...Z,items:le}}}),v(G),X&&t(q=>q.map(Z=>Z.id===T?zo(Z,V):Z)),await g(R),X)try{await r()}catch(q){console.error("Failed to refresh product pricing:",q)}}catch(K){f(Y=>({...Y,[G]:K instanceof Error?K.message:"Không thể xóa nguồn này."}))}finally{u(K=>{const Y={...K};return delete Y[G],Y})}}}},fG={};var mG={};const vf=typeof import.meta<"u"&&fG?.VITE_API_BASE_URL||typeof process<"u"&&mG?.VITE_API_BASE_URL||""||"http://localhost:3001",pG=()=>{const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:o,setRowsPerPage:l,totalRows:c,productPrices:d,setProductPrices:u,isLoading:h,error:f,statusOverrides:m,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v,expandedProductId:b,setExpandedProductId:w,isRefreshing:y,setIsRefreshing:N,fetchProductPrices:_,filteredPricing:S}=cG(vf),j=hG({apiBase:vf,setProductPrices:u,fetchProductPrices:_}),{supplyPriceMap:E,fetchSupplyPricesForProduct:k}=j,T=dG({apiBase:vf,productPrices:d,setProductPrices:u,fetchProductPrices:_,statusOverrides:m,setStatusOverrides:x,updatedTimestampMap:g,setUpdatedTimestampMap:v});p.useEffect(()=>{_()},[_]);const A=p.useCallback(async()=>{if(!y){N(!0);try{await _();const G=new Set;Object.values(E).forEach(V=>{V?.productName&&G.add(V.productName)}),await Promise.all(Array.from(G).map(V=>k(V)))}catch(G){console.error("Failed to refresh pricing data:",G)}finally{N(!1)}}},[y,_,N,E,k]),C=G=>{const V=b===G.id?null:G.id;if(w(V),V===G.id){const X=Vs(G.sanPhamRaw),K=j.supplyPriceMap[X];(!K||!K.loading&&K.items.length===0)&&j.fetchSupplyPricesForProduct(G.sanPhamRaw)}},R=p.useMemo(()=>{const G=d.length,V=d.filter(K=>K.isActive).length,X=G-V;return[{name:"Tổng Sản Phẩm",value:G.toString(),icon:pd,accent:"emerald",subtitle:"Tất cả sản phẩm"},{name:"Đang Hoạt Động",value:V.toString(),icon:bp,accent:"sky",subtitle:"Sẵn sàng bán"},{name:"Tạm Dừng",value:X.toString(),icon:cr,accent:"violet",subtitle:"Đang ẩn trên bảng giá"}]},[d]);return{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:o,setRowsPerPage:l,totalRows:c,filteredPricing:S,pricingStats:R,isLoading:h,error:f,isRefreshing:y,expandedProductId:b,supplyPriceMap:E,editingSupplyRows:j.editingSupplyRows,supplyPriceDrafts:j.supplyPriceDrafts,savingSupplyRows:j.savingSupplyRows,supplyRowErrors:j.supplyRowErrors,newSupplyRows:j.newSupplyRows,editingProductId:T.editingProductId,productEditForm:T.productEditForm,productEditError:T.productEditError,isSavingProductEdit:T.isSavingProductEdit,isCreateModalOpen:T.isCreateModalOpen,createForm:T.createForm,createSuppliers:T.createSuppliers,createError:T.createError,isSubmittingCreate:T.isSubmittingCreate,supplierOptions:T.supplierOptions,isLoadingSuppliers:T.isLoadingSuppliers,bankOptions:T.bankOptions,isLoadingBanks:T.isLoadingBanks,statusOverrides:m,updatedTimestampMap:g,deleteProductState:T.deleteProductState,handleRefreshAll:A,handleToggleProductDetails:C,handleStartEditingSupply:j.handleStartEditingSupply,handleSupplyInputChange:j.handleSupplyInputChange,handleCancelSupplyEditing:j.handleCancelSupplyEditing,handleConfirmSupplyEditing:j.handleConfirmSupplyEditing,handleStartAddSupplierRow:j.handleStartAddSupplierRow,handleNewSupplierInputChange:j.handleNewSupplierInputChange,handleCancelAddSupplierRow:j.handleCancelAddSupplierRow,handleConfirmAddSupplierRow:j.handleConfirmAddSupplierRow,handleDeleteSupplyRow:j.handleDeleteSupplyRow,handleStartProductEdit:T.handleStartProductEdit,handleProductEditChange:T.handleProductEditChange,handleCancelProductEdit:T.handleCancelProductEdit,handleSubmitProductEdit:T.handleSubmitProductEdit,handleRequestDeleteProduct:T.handleRequestDeleteProduct,confirmDeleteProduct:T.confirmDeleteProduct,closeDeleteProductModal:T.closeDeleteProductModal,handleOpenCreateModal:T.handleOpenCreateModal,handleCloseCreateModal:T.handleCloseCreateModal,handleCreateFormChange:T.handleCreateFormChange,handleSupplierChange:T.handleSupplierChange,handleSupplierSelectChange:T.handleSupplierSelectChange,handleSupplierPriceInput:T.handleSupplierPriceInput,handleEnableCustomSupplier:T.handleEnableCustomSupplier,handleAddSupplierRow:T.handleAddSupplierRow,handleRemoveSupplierRow:T.handleRemoveSupplierRow,handleSubmitCreateProduct:T.handleSubmitCreateProduct,handleToggleStatus:T.handleToggleStatus,fetchSupplyPricesForProduct:j.fetchSupplyPricesForProduct}};function xG(){const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,totalRows:a,currentPage:i,setCurrentPage:o,rowsPerPage:l,setRowsPerPage:c,pricingStats:d,filteredPricing:u,isLoading:h,error:f,isRefreshing:m,expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:b,editingSupplyRows:w,supplyPriceDrafts:y,savingSupplyRows:N,supplyRowErrors:_,newSupplyRows:S,editingProductId:j,productEditForm:E,productEditError:k,isSavingProductEdit:T,deleteProductState:A,isCreateModalOpen:C,createForm:R,createSuppliers:G,createError:V,isSubmittingCreate:X,supplierOptions:K,isLoadingSuppliers:Y,bankOptions:q,isLoadingBanks:Z,handleRefreshAll:le,handleToggleProductDetails:ce,handleStartProductEdit:pe,handleProductEditChange:Ne,handleCancelProductEdit:ee,handleSubmitProductEdit:oe,handleRequestDeleteProduct:he,confirmDeleteProduct:O,closeDeleteProductModal:I,handleStartEditingSupply:L,handleSupplyInputChange:F,handleCancelSupplyEditing:W,handleConfirmSupplyEditing:J,handleStartAddSupplierRow:se,handleNewSupplierInputChange:ke,handleCancelAddSupplierRow:ye,handleConfirmAddSupplierRow:Pe,handleDeleteSupplyRow:ue,handleToggleStatus:Be,handleOpenCreateModal:Ve,handleCloseCreateModal:ve,handleCreateFormChange:we,handleSupplierChange:fe,handleSupplierSelectChange:Ce,handleSupplierPriceInput:me,handleEnableCustomSupplier:We,handleAddSupplierRow:Oe,handleRemoveSupplierRow:Ae,handleSubmitCreateProduct:Ye,fetchSupplyPricesForProduct:ct}=pG();return s.jsxs(s.Fragment,{children:[s.jsx(lG,{product:A.product,loading:A.loading,error:A.error,onClose:I,onConfirm:O}),s.jsx(oG,{isOpen:C,createForm:R,createSuppliers:G,supplierOptions:K,bankOptions:q,isLoadingSuppliers:Y,isLoadingBanks:Z,createError:V,isSubmitting:X,onClose:ve,onFormChange:we,onSupplierChange:fe,onSupplierSelectChange:Ce,onSupplierPriceInput:me,onEnableCustomSupplier:We,onAddSupplier:Oe,onRemoveSupplier:Ae,onSubmit:Ye,parseRatioInput:kn}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(XK,{stats:d,onAddProduct:Ve}),s.jsx(GK,{searchTerm:e,statusFilter:r,isLoading:h,isRefreshing:m,error:f,onSearchChange:t,onStatusChange:n,onRefresh:le,onAddProduct:Ve}),s.jsx(sG,{items:u,isLoading:h,error:f,totalRows:a,currentPage:i,rowsPerPage:l,onPageChange:o,onRowsPerPageChange:He=>{c(He),o(1)},expandedProductId:x,supplyPriceMap:g,statusOverrides:v,updatedTimestampMap:b,supplierOptions:K,isLoadingSuppliers:Y,editingSupplyRows:w,supplyPriceDrafts:y,savingSupplyRows:N,supplyRowErrors:_,newSupplyRows:S,editingProductId:j,productEditForm:E,productEditError:k,isSavingProductEdit:T,deleteProductState:A,onToggleProductDetails:ce,onStartProductEdit:pe,onProductEditChange:Ne,onCancelProductEdit:ee,onSubmitProductEdit:oe,onRequestDeleteProduct:he,onStartEditingSupply:L,onSupplyInputChange:F,onCancelSupplyEditing:W,onConfirmSupplyEditing:J,onStartAddSupplierRow:se,onNewSupplierInputChange:ke,onCancelAddSupplierRow:ye,onConfirmAddSupplierRow:Pe,onDeleteSupplyRow:ue,onToggleStatus:Be,fetchSupplyPricesForProduct:ct})]})]})}const gG=async e=>{const t=await Ue(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Nguồn đã được xóa trước đó."};if(!t.ok){const n=await t.text();throw new Error(n||"Không thể xóa nguồn.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},vG=({stats:e})=>s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(Ca,{title:"Tổng NCC",value:e.totalSuppliers,icon:YN,accent:wr.sky}),s.jsx(Ca,{title:"Đang hoạt động",value:e.activeSuppliers,icon:Vi,accent:wr.emerald}),s.jsx(Ca,{title:"Tổng đơn",value:e.monthlyOrders,icon:gd,accent:wr.violet}),s.jsx(Ca,{title:"Tổng nhập",value:mW(e.totalImportValue),icon:pd,accent:wr.amber})]}),M2=e=>e.trim().toLowerCase(),bf=e=>{const r=String(e||"").replace(/[^\d-]/g,""),n=r.startsWith("-")?"-"+r.slice(1).replace(/-/g,""):r.replace(/-/g,""),a=Number(n);return Number.isFinite(a)?a:0},bG=d0,yf=An,yG=({supplyId:e,onRefreshSupplies:t})=>{const[r,n]=p.useState([]),[a,i]=p.useState(!1),[o,l]=p.useState({round:"",import:"",paid:"",isEditing:!1}),[c,d]=p.useState(null),[u,h]=p.useState(""),f=b=>{const w=String(b||"").replace(/[^\d-]/g,""),y=w.startsWith("-")?"-"+w.slice(1).replace(/-/g,""):w.replace(/-/g,"");if(y==="-")return"-";const N=Number(y);return Number.isFinite(N)?N.toLocaleString("vi-VN"):""},m=p.useCallback(async()=>{i(!0);try{const b=await Ue(`/api/supplies/${e}/payments?offset=0&limit=20`);if(b.ok){const w=await b.json();n(w.payments||[])}}finally{i(!1)}},[e]);p.useEffect(()=>{m()},[m]);const x=async()=>{if(o.round)try{const b={round:o.round,totalImport:bf(o.import),paid:bf(o.paid),status:"Chưa Thanh Toán"};(await Ue(`/api/supplies/${e}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok&&(l({round:"",import:"",paid:"",isEditing:!1}),m(),t?.())}catch(b){console.error(b)}},g=async b=>{try{await Ue(`/api/supplies/${e}/payments/${b}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:bf(u)})}),d(null),m(),t?.()}catch(w){console.error(w)}},v=b=>(b||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();return s.jsxs("div",{className:"bg-slate-900/80 rounded-xl border border-white/10 overflow-hidden",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center",children:[s.jsx("h4",{className:"text-sm font-semibold text-white",children:"Lịch Sử Thanh Toán"}),s.jsxs("button",{onClick:()=>l({...o,isEditing:!0}),className:"text-xs flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-white transition",children:[s.jsx(Ra,{className:"h-3 w-3"})," Thêm Chu Kỳ"]})]}),s.jsxs("table",{className:"w-full text-sm text-left text-white/80",children:[s.jsx("thead",{className:"bg-white/5 text-xs uppercase text-white/60",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2",children:"Chu Kỳ"}),s.jsx("th",{className:"px-4 py-2",children:"Tổng Nhập"}),s.jsx("th",{className:"px-4 py-2",children:"Còn Nợ"}),s.jsx("th",{className:"px-4 py-2",children:"Đã Thanh Toán"}),s.jsx("th",{className:"px-4 py-2",children:"Trạng Thái"}),s.jsx("th",{className:"px-4 py-2 text-right",children:"Thao Tác"})]})}),s.jsxs("tbody",{className:"divide-y divide-white/5",children:[o.isEditing&&s.jsxs("tr",{className:"bg-indigo-500/10",children:[s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"Tên chu kỳ...",value:o.round,onChange:b=>l({...o,round:b.target.value})})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:o.import,onChange:b=>l({...o,import:f(b.target.value)})})}),s.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"—"}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:o.paid,onChange:b=>l({...o,paid:f(b.target.value)})})}),s.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"Mới"}),s.jsxs("td",{className:"px-4 py-2 text-right",children:[s.jsx("button",{onClick:x,className:"text-emerald-400 hover:text-emerald-300 mr-2",children:s.jsx(Wn,{className:"h-5 w-5 inline"})}),s.jsx("button",{onClick:()=>l({...o,isEditing:!1}),className:"text-rose-400 hover:text-rose-300",children:s.jsx(Pt,{className:"h-5 w-5 inline"})})]})]}),a?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-center py-4",children:"Đang tải..."})}):r.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"text-center py-4 opacity-50",children:"Chưa có dữ liệu thanh toán"})}):r.map(b=>{const w=v(b.status)==="chua thanh toan";return s.jsxs("tr",{className:"hover:bg-white/5",children:[s.jsx("td",{className:"px-4 py-2",children:b.round}),s.jsx("td",{className:"px-4 py-2",children:c===b.id?s.jsx("input",{className:"bg-black/20 border border-white/20 rounded px-1 w-24 text-right",value:u,onChange:y=>h(f(y.target.value))}):b.totalImport>=0?yf(b.totalImport):"—"}),s.jsx("td",{className:`px-4 py-2 ${b.totalImport<0?"text-rose-400 font-semibold":""}`,children:b.totalImport<0?yf(Math.abs(b.totalImport)):"—"}),s.jsx("td",{className:"px-4 py-2",children:yf(b.paid)}),s.jsx("td",{className:"px-4 py-2",children:b.status}),s.jsx("td",{className:"px-4 py-2 text-right",children:c===b.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>g(b.id),className:"text-emerald-400 mr-2",children:s.jsx(Wn,{className:"h-4 w-4 inline"})}),s.jsx("button",{onClick:()=>d(null),className:"text-rose-400",children:s.jsx(Pt,{className:"h-4 w-4 inline"})})]}):w&&s.jsx("button",{onClick:()=>{d(b.id),h(b.totalImport.toLocaleString("vi-VN"))},className:"text-white/40 hover:text-blue-300",children:s.jsx(ls,{className:"h-4 w-4 inline"})})})]},b.id)})]})]})]})},wf=An,wG=e=>e?yt(e):"--",NG=({supply:e,onToggleStatus:t,onView:r,onEdit:n,onDelete:a})=>{const i=e.isActive?"bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"bg-slate-500/20 text-slate-300 border-slate-500/30";return s.jsxs("div",{className:"relative group overflow-hidden glass-panel rounded-[24px] p-4 transition-all duration-500 hover:border-indigo-500/40 shadow-2xl border border-white/10 bg-slate-900/40 backdrop-blur-xl hover:bg-slate-900/50",children:[s.jsx("div",{className:`absolute -right-10 -top-10 w-28 h-28 rounded-full blur-3xl opacity-10 transition-all duration-700 group-hover:opacity-20 ${e.isActive?"bg-emerald-500":"bg-slate-500"}`}),s.jsxs("div",{className:"relative z-10 flex flex-col gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[s.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.8)]"}),s.jsx("h3",{className:"text-sm font-bold text-white truncate",children:e.sourceName||"Không Tên"})]}),s.jsx("span",{className:`px-2.5 py-1 shrink-0 rounded-xl text-[10px] font-bold uppercase tracking-wide border shadow-lg ${i}`,children:e.isActive?"Hoạt động":"Tạm dừng"})]}),s.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-2xl bg-white/5 border border-white/5",children:[s.jsx(rk,{className:"w-5 h-5 text-indigo-300 shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex flex-col min-w-0",children:[s.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-widest mb-0.5",children:"Tài khoản"}),s.jsx("p",{className:"text-sm font-bold text-white truncate",children:e.numberBank||"--"}),s.jsx("p",{className:"text-xs text-indigo-200/70 truncate",children:e.bankName})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{className:"flex flex-col p-2.5 rounded-xl bg-white/5 border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Tháng này"}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(gd,{className:"w-3.5 h-3.5 text-emerald-400"}),s.jsxs("span",{className:"text-xs font-bold text-white",children:[e.monthlyOrders," đơn"]})]}),s.jsx("span",{className:"text-[10px] font-medium text-emerald-400/80 mt-0.5 ml-5",children:wf(e.monthlyImportValue)})]}),s.jsxs("div",{className:"flex flex-col p-2.5 rounded-xl bg-white/5 border border-white/5",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Công nợ"}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(pd,{className:"w-3.5 h-3.5 text-orange-400"}),s.jsx("span",{className:"text-xs font-bold text-orange-400",children:wf(Math.min(0,e.totalUnpaidImport||0))})]}),s.jsxs("span",{className:"text-[10px] font-medium text-white/40 mt-0.5 ml-5",children:["Đã trả: ",wf(e.totalPaidImport)]})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-1 border-t border-white/5 mt-1",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-[9px] font-bold text-white/30 uppercase tracking-widest mb-1",children:"Lần cuối"}),s.jsx("p",{className:"text-[11px] font-bold text-slate-300 tabular-nums",children:wG(e.lastOrderDate)})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>t(e),className:`w-9 h-9 flex items-center justify-center rounded-xl border transition-all active:scale-90 ${e.isActive?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400 hover:bg-emerald-500 hover:text-white":"bg-white/5 border-white/10 text-white/30 hover:bg-white/10 hover:text-white"}`,children:s.jsx(xd,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>r(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-blue-500/10 border border-blue-500/20 text-blue-400 hover:bg-blue-500 hover:text-white transition-all active:scale-90",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>n(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-amber-500/10 border border-amber-500/20 text-amber-400 hover:bg-amber-500 hover:text-white transition-all active:scale-90",children:s.jsx(ls,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>a(e),className:"w-9 h-9 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500 hover:text-white transition-all active:scale-90",children:s.jsx(Xr,{className:"h-4 w-4"})})]})]})]})]})},Sc=An,_G=e=>e?yt(e):"--",jG=({supplies:e,loading:t,expandedId:r,onToggle:n,onEdit:a,onDelete:i,onView:o,onToggleStatus:l,onRefreshSupplies:c})=>s.jsx("div",{className:"supply-list glass-panel-dark border border-white/5 rounded-[32px] overflow-hidden shadow-2xl backdrop-blur-xl",children:s.jsx(Wa,{className:"supply-list__inner",showCardOnMobile:!0,cardView:t?s.jsx("div",{className:"p-8 text-center text-white/50",children:"Đang tải..."}):e.length===0?s.jsx("div",{className:"p-8 text-center text-white/50",children:"Chưa có nhà cung cấp nào"}):s.jsx(Si,{data:e,renderCard:d=>s.jsx(NG,{supply:d,onToggleStatus:l,onView:o,onEdit:a,onDelete:i}),className:"p-4"}),children:s.jsxs("table",{className:"supply-list__table w-full text-left",children:[s.jsx("thead",{className:"supply-list__head bg-white/5 text-[10px] uppercase text-indigo-300/40 font-bold tracking-[0.2em]",children:s.jsxs("tr",{children:[s.jsx("th",{className:"supply-list__th px-4 py-3",children:"Nhà cung cấp"}),s.jsx("th",{className:"px-4 py-3",children:"Tài khoản"}),s.jsx("th",{className:"px-4 py-3",children:"Tháng này"}),s.jsx("th",{className:"px-4 py-3",children:"Lần cuối"}),s.jsx("th",{className:"px-4 py-3",children:"Đã trả"}),s.jsx("th",{className:"px-4 py-3",children:"Còn nợ"}),s.jsx("th",{className:"px-4 py-3",children:"Thanh toán"}),s.jsx("th",{className:"px-4 py-3 text-center",children:"TT"}),s.jsx("th",{className:"px-4 py-3 text-right",children:"Thao tác"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:t?s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"text-center py-8 text-white/50",children:"Đang tải..."})}):e.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:9,className:"text-center py-8 text-white/50",children:"Chưa có nhà cung cấp nào"})}):e.map(d=>s.jsx(SG,{supply:d,isExpanded:r===d.id,onToggle:n,onEdit:a,onDelete:i,onView:o,onToggleStatus:l,onRefreshSupplies:c},d.id))})]})})}),SG=({supply:e,isExpanded:t,onToggle:r,onEdit:n,onDelete:a,onView:i,onToggleStatus:o,onRefreshSupplies:l})=>s.jsxs(s.Fragment,{children:[s.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:bg-white/5 cursor-pointer transition border-b border-white/5",onClick:()=>r(e.id),children:[s.jsxs("td",{className:"px-4 py-4",children:[s.jsx("div",{className:"font-medium text-white",children:e.sourceName||"Không Tên"}),s.jsxs("div",{className:"text-xs text-white/60",children:["Tổng đơn: ",e.totalOrders]})]}),s.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[s.jsx("div",{children:e.numberBank||"--"}),s.jsx("div",{className:"text-xs text-white/50",children:e.bankName})]}),s.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[s.jsxs("div",{children:[e.monthlyOrders," Đơn"]}),s.jsx("div",{className:"text-xs text-emerald-400",children:Sc(e.monthlyImportValue)})]}),s.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:_G(e.lastOrderDate)}),s.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Sc(e.totalPaidImport)}),s.jsx("td",{className:"px-4 py-4 font-bold text-orange-400 text-sm",children:Sc(Math.min(0,e.totalUnpaidImport||0))}),s.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:Sc(Math.max(0,e.totalUnpaidImport||0))}),s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsx("button",{onClick:c=>{c.stopPropagation(),o(e)},className:`w-8 h-8 rounded-xl flex items-center justify-center transition-all active:scale-90 ${e.isActive?"bg-emerald-500 text-white shadow-[0_0_12px_rgba(16,185,129,0.3)]":"bg-white/5 text-white/30 border border-white/10"}`,children:s.jsx(xd,{className:"h-4 w-4"})})}),s.jsx("td",{className:"px-4 py-4 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:c=>{c.stopPropagation(),i(e)},className:"p-1.5 rounded-lg bg-white/5 text-blue-400 border border-white/10 hover:bg-blue-500/10 hover:border-blue-500/30 transition-all active:scale-90",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{onClick:c=>{c.stopPropagation(),n(e)},className:"p-1.5 rounded-lg bg-white/5 text-emerald-400 border border-white/10 hover:bg-emerald-500/10 hover:border-emerald-500/30 transition-all active:scale-90",children:s.jsx(ls,{className:"h-4 w-4"})}),s.jsx("button",{onClick:c=>{c.stopPropagation(),a(e)},className:"p-1.5 rounded-lg bg-white/5 text-rose-400 border border-white/10 hover:bg-rose-500/10 hover:border-rose-500/30 transition-all active:scale-90",children:s.jsx(Xr,{className:"h-4 w-4"})})]})})]}),t&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-0 pb-4 pt-0 bg-indigo-950/30",children:s.jsx("div",{className:"p-4 border-b border-white/10 shadow-inner",children:s.jsx(yG,{supplyId:e.id,onRefreshSupplies:l})})})})]}),EG=(e,t)=>{const[r,n]=p.useState(!1),[a,i]=p.useState(null),[o,l]=p.useState(null),c=p.useCallback(async()=>{if(e){n(!0),i(null);try{const d=await Ue(`/api/supplies/${e}/overview`),u=await d.json();if(!d.ok)throw new Error(u?.error||"Không tải được chi tiết");l(u)}catch(d){i(d?.message||"Đã có lỗi xảy ra")}finally{n(!1)}}},[e]);return p.useEffect(()=>{t&&e?c():t||(l(null),i(null))},[t,e,c]),{overview:o,loading:r,error:a,fetchOverview:c,setError:i}},CG=({supply:e,fetchOverview:t,onRefreshList:r})=>{const[n,a]=p.useState(null),[i,o]=p.useState(null);return{confirmingId:n,qrPayment:i,confirmPayment:async d=>{a(d);try{const u=await Ue(`/api/payment-supply/${d}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!u.ok){const h=await u.json().catch(()=>({}));throw new Error(h?.error||"Không thể thanh toán chu kỳ")}return await t(),o(null),r?.(),{success:!0}}catch(u){return{success:!1,error:u?.message||"Không thể thanh toán chu kỳ"}}finally{a(null)}},showQrForPayment:d=>{const u=(d.totalImport||0)-(d.paid||0),h=Math.abs(u),f=u>0,m=(()=>{const w=new Date,y=String(w.getDate()).padStart(2,"0"),N=String(w.getMonth()+1).padStart(2,"0"),_=w.getFullYear();return`${y}/${N}/${_}`})(),x=f?e?.numberBank||"":"9183400998",g=f?e?.binBank||"":"VPB",v=f?e?.nameBank||"":"NGO LE NGOC HUNG",b=bG({accountNumber:x,bankCode:g,amount:h,description:d.round||m,accountName:v});o({id:d.id,amount:h,url:b,round:d.round||""})},setQrPayment:o}},TG=({isOpen:e,onClose:t,supplyId:r,banks:n=[],onRefreshList:a})=>{const{overview:i,loading:o,error:l,fetchOverview:c,setError:d}=EG(r,e),{confirmingId:u,confirmPayment:h}=CG({supply:i?.supply,fetchOverview:c,onRefreshList:a}),[f,m]=p.useState(null),x=i?.supply,g=i?.stats,v=i?.unpaidPayments||[],b=v.find(T=>T.id===f)||v[0]||null,w=p.useMemo(()=>{if(!x||!b)return null;const T=Number(b.totalImport||b.import_value||0),A=b.round||`PAY ${x.id}`;return!x.numberBank||!x.binBank?null:d0({accountNumber:x.numberBank,bankCode:x.binBank,amount:Math.max(0,T),description:A,accountName:x.nameBank||x.sourceName||""})},[x,b]),y=async T=>{const A=await h(T);A.success||d(A.error||"Không thể thanh toán chu kỳ")},N=()=>{m(null),t()};if(!e||!r)return null;const _=v.reduce((T,A)=>T+Math.max(0,(A.totalImport||0)-(A.paid||0)),0),S=g?.monthlyOrders||[],j=x?.isActive?"Đang hoạt động":"Tạm dừng";x?.isActive;const E=x?.bankName||n.find(T=>(T.bin||"").trim()===(x?.binBank||"").trim())?.name||x?.binBank||"--",k=[{label:"Tổng đơn",value:g?.totalOrders??0},{label:"Đã thanh toán",value:g?.paidOrders??0},{label:"Chưa thanh toán",value:g?.unpaidOrders??0},{label:"Đã hủy",value:g?.canceledOrders??0}];return s.jsx(s.Fragment,{children:s.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60 p-2",onClick:N,children:s.jsxs("div",{className:"glass-panel-dark border border-white/5 p-5 md:p-6 rounded-[32px] text-white w-full max-w-4xl max-h-[95vh] shadow-2xl overflow-y-auto custom-scroll",onClick:T=>T.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex-1"}),s.jsx("h2",{className:"text-xl font-bold text-center",children:"Chi tiết Nhà Cung Cấp"}),s.jsx("div",{className:"flex-1 flex justify-end",children:s.jsx("button",{onClick:N,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70","aria-label":"Đóng",children:s.jsx(Pt,{className:"h-6 w-6"})})})]}),o?s.jsx("div",{className:"mt-6 text-center text-white/70",children:"Đang tải chi tiết..."}):l?s.jsxs("div",{className:"mt-6 bg-rose-500/10 text-rose-200 border border-rose-500/40 rounded-xl p-4 flex items-center justify-between gap-3",children:[s.jsx("span",{children:l}),s.jsx("button",{onClick:c,className:"px-3 py-1 rounded-lg bg-rose-500 text-white text-sm hover:bg-rose-600",children:"Thử lại"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-5",children:[s.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/5 p-5 space-y-4",children:[s.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80",children:"Thông tin chung"}),s.jsxs("div",{className:"text-sm text-white/80 space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-white/40",children:"Tên NCC"}),s.jsx("span",{className:"font-bold text-white",children:x?.sourceName||"--"})]}),s.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-white/40",children:"Ngân hàng"}),s.jsx("span",{className:"font-semibold text-white",children:E})]}),s.jsxs("div",{className:"flex justify-between items-center border-b border-white/5 pb-2",children:[s.jsx("span",{className:"text-white/40",children:"Số tài khoản"}),s.jsx("span",{className:"font-mono font-semibold text-white",children:x?.numberBank||"--"})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-white/40",children:"Trạng thái"}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-[11px] font-bold uppercase ${x?.isActive?"text-emerald-400 bg-emerald-500/10":"text-white/50 bg-white/5"}`,children:j})]})]})]}),s.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/5 p-5 space-y-4",children:[s.jsx("h3",{className:"text-[11px] font-bold uppercase tracking-[0.2em] text-indigo-300/80",children:"Tổng quan thanh toán"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-white/80",children:[s.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[s.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Đã trả"}),s.jsx("p",{className:"text-lg font-bold text-white mt-1",children:An(g?.totalPaidAmount||0)})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[s.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Còn nợ"}),s.jsx("p",{className:"text-lg font-bold text-orange-400 mt-1",children:An(_)})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[s.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Nợ đơn"}),s.jsx("p",{className:"text-lg font-bold text-white mt-1",children:g?.unpaidOrders??0})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl p-3 border border-white/5 transition-colors hover:bg-white/10",children:[s.jsx("p",{className:"text-white/50 text-[11px] font-bold uppercase tracking-wider",children:"Đã xong"}),s.jsx("p",{className:"text-lg font-bold text-white mt-1",children:g?.paidOrders??0})]})]})]})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-3",children:k.map(T=>s.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[s.jsx("p",{className:"text-white/50 text-xs",children:T.label}),s.jsx("p",{className:"text-xl font-semibold",children:T.value})]},T.label))}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-3 mt-3 items-start",children:[s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Chu kỳ chưa thanh toán"}),s.jsxs("span",{className:"text-xs text-white/60",children:["Còn nợ ",An(_)]})]}),v.length===0?s.jsx("p",{className:"text-white/50 text-sm",children:"Không có chu kỳ nợ."}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-1.5 max-h-28 overflow-y-auto custom-scroll scroll-overlay mb-3",children:v.map(T=>s.jsxs("div",{onClick:()=>m(T.id),className:`w-full flex items-center justify-between rounded-lg px-3 py-2 border transition cursor-pointer ${b?.id===T.id?"border-indigo-500 bg-indigo-500/20":"border-white/5 bg-white/5 hover:bg-white/10"}`,children:[s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:T.round||"Chu kỳ"}),s.jsx("p",{className:"text-xs text-white/60",children:T.status})]}),s.jsxs("div",{className:"text-right text-sm mr-2",children:[s.jsx("p",{className:"text-rose-400 font-semibold",children:An(T.totalImport||0)}),s.jsxs("p",{className:"text-white/40 text-xs",children:["Đã trả: ",An(T.paid||0)]})]}),s.jsx("button",{disabled:u===T.id,onClick:A=>{A.stopPropagation(),y(T.id)},className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-60 font-semibold transition flex-shrink-0",children:u===T.id?"...":"Thanh toán"})]},T.id))}),b&&s.jsx("div",{className:"flex justify-center mt-2",children:w?s.jsx("img",{src:w,alt:"QR",className:"w-64 rounded-lg shadow-lg"}):s.jsx("div",{className:"w-64 h-64 bg-white/10 rounded-lg flex items-center justify-center text-xs text-center p-2",children:"Thiếu thông tin NH"})})]})]}),s.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Đơn theo tháng"}),s.jsxs("span",{className:"text-xs text-white/60",children:[S.length," tháng"]})]}),S.length===0?s.jsx("p",{className:"text-white/50 text-sm",children:"Chưa có dữ liệu."}):s.jsx("div",{className:"space-y-1.5 max-h-80 overflow-y-auto custom-scroll scroll-overlay",children:S.map(T=>s.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5",children:[s.jsxs("span",{className:"text-sm font-semibold",children:["Tháng ",T.month]}),s.jsxs("span",{className:"text-sm",children:[T.orders," đơn"]})]},T.month))})]})]}),s.jsx("div",{className:"mt-4 text-right",children:s.jsx("button",{onClick:N,className:"px-10 py-2.5 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 text-white font-bold transition-all active:scale-95",children:"Đóng"})})]})]})})})},kG=()=>{const[e,t]=p.useState([]),[r,n]=p.useState({totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0}),[a,i]=p.useState(!1),[o,l]=p.useState(null),c=p.useCallback(async()=>{i(!0);try{const u=await Ue("/api/supply-insights");if(!u.ok)throw new Error("Lỗi tải dữ liệu");const h=await u.json(),f=(h.supplies||[]).map(m=>{const x=m.isActive??(m.status!=="inactive"&&m.status!=="tạm dừng");return{...m,isActive:x,status:x?"active":"inactive",products:Array.isArray(m.products)?m.products.filter(Boolean):[]}});t(f),n({totalSuppliers:Number(h.stats?.totalSuppliers)||0,activeSuppliers:Number(h.stats?.activeSuppliers)||f.filter(m=>m.isActive).length,monthlyOrders:Number(h.stats?.monthlyOrders)||0,totalImportValue:Number(h.stats?.totalImportValue)||0})}catch(u){l(u instanceof Error?u.message:"Lỗi không xác định")}finally{i(!1)}},[]);return{supplies:e,stats:r,loading:a,error:o,fetchSupplies:c,setSupplies:t,toggleStatus:async(u,h)=>{t(f=>f.map(m=>m.id===u?{...m,isActive:!h,status:h?"inactive":"active"}:m));try{await Ue(`/api/supplies/${u}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!h})}),await c()}catch{t(f=>f.map(m=>m.id===u?{...m,isActive:h,status:h?"active":"inactive"}:m)),br({type:"error",title:"Lỗi cập nhật trạng thái",message:"Không thể cập nhật trạng thái"})}}}},AG=({isOpen:e,onClose:t,onSuccess:r,banks:n})=>{const[a,i]=p.useState({sourceName:"",numberBank:"",bankBin:"",status:"active"}),[o,l]=p.useState(!1),[c,d]=p.useState(null);if(p.useEffect(()=>{e&&n.length>0&&!a.bankBin&&i(h=>({...h,bankBin:n[0].bin}))},[e,n,a.bankBin]),!e)return null;const u=async h=>{if(h.preventDefault(),!a.sourceName.trim())return d("Tên không được để trống");l(!0),d(null);try{const f=await Ue("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:a.sourceName,number_bank:a.numberBank,bin_bank:a.bankBin,status:a.status})});if(!f.ok)throw new Error((await f.json()).error||"Lỗi khi tạo");r(),t(),i({sourceName:"",numberBank:"",bankBin:n[0]?.bin||"",status:"active"})}catch(f){d(f instanceof Error?f.message:"Lỗi tạo nhà cung cấp")}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4 animate-in fade-in",onClick:t,children:s.jsxs("div",{className:"glass-panel-dark rounded-[32px] shadow-2xl w-full max-w-md p-8 border border-white/10 animate-in zoom-in-95 duration-300",onClick:h=>h.stopPropagation(),children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-6 tracking-tight",children:"Thêm Nhà Cung Cấp Mới"}),c&&s.jsx("p",{className:"text-sm text-red-600 mb-3",children:c}),s.jsxs("form",{onSubmit:u,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-indigo-300/50 mb-2 ml-1",children:"Tên Nhà Cung Cấp"}),s.jsx("input",{className:"w-full bg-white/5 border border-white/10 rounded-2xl p-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-white/20",value:a.sourceName,onChange:h=>i({...a,sourceName:h.target.value}),placeholder:"Nhập tên..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),s.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.numberBank,onChange:h=>i({...a,numberBank:h.target.value}),placeholder:"STK..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),s.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:a.bankBin,onChange:h=>i({...a,bankBin:h.target.value}),children:n.map(h=>s.jsx("option",{value:h.bin,children:h.name||h.bin},h.bin))})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),s.jsx(nn,{type:"submit",disabled:o,className:"!py-2.5 !px-8 text-sm",children:o?"Đang xử lý...":"Thêm Mới"})]})]})]})})},PG=({isOpen:e,onClose:t,onSuccess:r,supply:n,banks:a})=>{const[i,o]=p.useState({sourceName:"",numberBank:"",bankBin:""}),[l,c]=p.useState(!1),[d,u]=p.useState(null);if(p.useEffect(()=>{n&&o({sourceName:n.sourceName||"",numberBank:n.numberBank||"",bankBin:n.binBank||a[0]?.bin||""})},[n,a]),!e||!n)return null;const h=async f=>{f.preventDefault(),c(!0);try{if(!(await Ue(`/api/supplies/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({supplier_name:i.sourceName,number_bank:i.numberBank,bin_bank:i.bankBin})})).ok)throw new Error("Lỗi cập nhật");r(),t()}catch(m){u(m instanceof Error?m.message:"Lỗi cập nhật")}finally{c(!1)}};return s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4 animate-in fade-in",onClick:t,children:s.jsxs("div",{className:"glass-panel-dark rounded-[32px] shadow-2xl w-full max-w-lg p-8 border border-white/10 animate-in zoom-in-95 duration-300",onClick:f=>f.stopPropagation(),children:[s.jsx("h3",{className:"text-2xl font-bold text-white mb-6 tracking-tight",children:"Chỉnh Sửa Thông Tin"}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tên Nhà Cung Cấp"}),s.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.sourceName,onChange:f=>o({...i,sourceName:f.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Số Tài Khoản"}),s.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.numberBank,onChange:f=>o({...i,numberBank:f.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngân Hàng"}),s.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:i.bankBin,onChange:f=>o({...i,bankBin:f.target.value}),children:a.map(f=>s.jsx("option",{value:f.bin,children:f.name||f.bin},f.bin))})]}),d&&s.jsx("p",{className:"text-sm text-red-500",children:d}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),s.jsx(nn,{type:"submit",disabled:l,className:"!py-2.5 !px-8 text-sm",children:"Lưu Thay Đổi"})]})]})]})})},OG=({isOpen:e,onClose:t,onConfirm:r,supplyName:n})=>e?s.jsx("div",{className:"fixed inset-0 z-70 flex items-center justify-center bg-slate-950/90 backdrop-blur-md p-4 animate-in fade-in",children:s.jsxs("div",{className:"glass-panel-dark rounded-[32px] p-8 max-w-sm w-full shadow-2xl border border-rose-500/20 animate-in zoom-in-95 duration-300",children:[s.jsx("h3",{className:"text-2xl font-bold text-rose-500 mb-2 tracking-tight",children:"Xóa Nhà Cung Cấp?"}),s.jsxs("p",{className:"text-white/60 mb-8 leading-relaxed",children:["Bạn có chắc muốn xóa ",s.jsx("b",{children:n}),"? Hành động này không thể hoàn tác."]}),s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),s.jsx("button",{onClick:r,className:"px-6 py-2.5 bg-rose-500 text-white font-bold rounded-2xl hover:bg-rose-600 transition-all active:scale-95 shadow-lg shadow-rose-500/20",children:"Xóa Vĩnh Viễn"})]})]})}):null;function DG(){const{supplies:e,stats:t,loading:r,fetchSupplies:n,toggleStatus:a}=kG(),[i,o]=p.useState(""),[l,c]=p.useState("all"),[d,u]=p.useState([]),[h,f]=p.useState(null),[m,x]=p.useState(!1),[g,v]=p.useState(null),[b,w]=p.useState(null),[y,N]=p.useState(null);p.useEffect(()=>{n(),Ue("/api/banks").then(j=>j.json()).then(j=>{Array.isArray(j)&&u(j.map(E=>({bin:E.bin,name:E.bank_name||E.bankName||E.name||E.bank||E.bin})))}).catch(console.error)},[n]);const _=p.useMemo(()=>{const j=M2(i),E=e.filter(T=>{const A=!j||M2(T.sourceName).includes(j),C=l==="all"||(l==="active"?T.isActive:!T.isActive);return A&&C}),k=T=>{if(!T)return 0;const A=new Date(T).getTime();return Number.isFinite(A)?A:0};return E.sort((T,A)=>{const C=Number(T.totalUnpaidImport)||0,R=Number(A.totalUnpaidImport)||0,G=C>0,V=R>0;if(G!==V)return G?-1:1;const X=C<0,K=R<0;if(X!==K)return X?-1:1;if((G||X)&&C!==R)return R-C;const Y=k(T.lastOrderDate),q=k(A.lastOrderDate),Z=Y>0,le=q>0;if(Z!==le)return Z?-1:1;if(Y!==q)return q-Y;const ce=(A.totalOrders||0)-(T.totalOrders||0);return ce!==0?ce:T.sourceName.localeCompare(A.sourceName)})},[e,i,l]),S=async()=>{if(y){const j=await gG(y.id);j.success?(await n(),N(null)):br({type:"error",title:"Lỗi xóa nhà cung cấp",message:j.message||"Không thể xóa nhà cung cấp."})}};return s.jsxs("div",{className:"space-y-6 pb-20",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Quản Lý Nguồn Hàng"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Theo dõi công nợ và chu kỳ thanh toán từ các đối tác cung cấp."})]}),s.jsx(vG,{stats:t}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:"Tìm kiếm nhà cung cấp...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:i,onChange:j=>o(j.target.value)})]}),s.jsxs("div",{className:"flex w-full lg:w-auto gap-3 items-center",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx("div",{className:"relative w-full lg:w-[180px]",children:s.jsxs("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:l,onChange:j=>c(j.target.value),children:[s.jsx("option",{value:"all",className:"bg-slate-900 text-white",children:"Tất cả trạng thái"}),s.jsx("option",{value:"active",className:"bg-slate-900 text-white",children:"Đang hoạt động"}),s.jsx("option",{value:"inactive",className:"bg-slate-900 text-white",children:"Tạm dừng"})]})})]}),s.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx(nn,{icon:Ra,onClick:()=>x(!0),className:"!py-2.5 !px-5 text-sm",children:"Thêm NCC"})]})]})}),s.jsx(jG,{supplies:_,loading:r,expandedId:h,onToggle:j=>f(E=>E===j?null:j),onEdit:v,onDelete:N,onView:j=>w(j.id),onToggleStatus:j=>a(j.id,j.isActive),onRefreshSupplies:n}),s.jsx(AG,{isOpen:m,onClose:()=>x(!1),onSuccess:n,banks:d}),s.jsx(PG,{isOpen:!!g,onClose:()=>v(null),onSuccess:n,supply:g,banks:d}),s.jsx(OG,{isOpen:!!y,onClose:()=>N(null),onConfirm:S,supplyName:y?.sourceName}),s.jsx(TG,{isOpen:!!b,onClose:()=>w(null),supplyId:b,banks:d,onRefreshList:n})]})}const Nf=e=>e.toLocaleString("vi-VN"),Ii=e=>{const t=Number(e);return Number.isFinite(t)?t:0},Ec=e=>(e||"").trim().toLowerCase(),Cc=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},Ms=e=>(e||"").trim().toLowerCase(),_f=e=>{const t=Number(e);return Number.isFinite(t)?t:0},IG=e=>{const t=_f(e?.price),r=_f(e?.resellPrice),n=_f(e?.promoPrice);return{price:t||r||n||0,promoPrice:n||0,resellPrice:r||void 0}},RG=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},MG=(e,t)=>{if(e){const d=On(e.price||0),u=e.promoPrice>0?On(e.promoPrice):0;return{unitPrice:d,discount:u}}const r=t?.basePrice??t?.unitPrice??0,n=t?.pctPromo!==void 0?Ii(t.pctPromo):0,a=n>1?n/100:Math.max(0,n),i=t?.pctKhach!==void 0&&t?.pctKhach>0?t.pctKhach:1,o=t?.pctCtv!==void 0&&t?.pctCtv>0?t.pctCtv:1,l=On(r*i*o),c=a>0?On(l*a):0;return{unitPrice:l,discount:c}},F2=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),a=[],i=(l,c)=>{if(l.nodeType===Node.TEXT_NODE){c.push((l.textContent||"").replace(/\u00a0/g," "));return}if(l.nodeType===Node.ELEMENT_NODE){const d=l;if(d.tagName==="BR"){c.push(`
`);return}const u=[];d.childNodes.forEach(f=>i(f,u));const h=u.join("");c.push(h),n.has(d.tagName)&&c.push(`
`)}},o=[];return r.body.childNodes.forEach(l=>i(l,o)),o.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e||""}},FG=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},LG=(e,t)=>{const r=new Set,n=[];return e.forEach(a=>{const o=(a?.[Ht.code]||a?.san_pham||"").trim();if(!o)return;const l=o.toLowerCase();if(r.has(l))return;r.add(l);const c=RG(o),d=Ii(a?.pct_khach??a?.[Ht.pctKhach]),u=Ii(a?.pct_ctv??a?.[Ht.pctCtv]),h=d>10?d/100:d>0?d:1,f=u>10?u/100:u>0?u:1,m=Ii(a?.pct_promo??a?.[Ht.pctPromo]),x=m>1?m/100:Math.max(0,m),g=Ii(a?.max_supply_price),v=Ii(a?.computed_retail_price??a?.retail_price??a?.gia_le??a?.gia_ban)||0,b=Ii(a?.computed_promo_price??a?.promo_price??a?.gia_khuyen_mai??a?.gia_km)||0,w=g>0?On(g):0,N=(v||b||w)*(f>0?f:1)*(h>0?h:1),_=On(N),S=_*(1-x),j=On(S),E=Math.min(_,w>0?Math.max(w,j):j),k=E>0?_-E:0,T=a?.[Ht.variantName]||a?.package_product||a?.package_product_label||"",A=T?`${T} (${o})`:a?.package?`${a?.package} (${o})`:o,C=Ms(o),R=t[C];n.push({productId:o,value:o,productDisplay:a?.package||o,packageDisplay:T||a?.package||o,label:A,durationMonths:c.months,durationDays:c.days,term:c.days?`${c.days} ngày`:"",unitPrice:_,discountValue:k,basePrice:R?.price??R?.resellPrice??v??_,promoPrice:R?.promoPrice??0,pctPromo:x,pctKhach:h,pctCtv:f,wholesalePrice:w})}),n.sort((a,i)=>a.label.localeCompare(i.label,"vi"))},ks="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",BG=({recipient:e,onRecipientChange:t,quoteDate:r,onQuoteDateChange:n,quoteCode:a,contact:i,onContactChange:o,productSearch:l,onProductSearchChange:c,filteredOptions:d,selectedProductKeys:u,onToggleProduct:h,onAddSelectedProduct:f,onResetSearch:m,lines:x,onRemoveLine:g,onDownload:v})=>s.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[s.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:s.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thông tin báo giá"})}),s.jsxs("div",{className:"px-6 py-5 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-white",children:"Kính gửi"}),s.jsx("input",{type:"text",value:e,onChange:b=>t(b.target.value),className:ks})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-white",children:"Ngày"}),s.jsx("input",{type:"date",value:r,onChange:b=>n(b.target.value),className:ks})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-white",children:"Mã báo giá"}),s.jsx("input",{value:a,readOnly:!0,className:`${ks} opacity-80`})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-white",children:"Liên hệ"}),s.jsx("input",{type:"text",value:i,onChange:b=>o(b.target.value),className:ks,placeholder:"Email / SDT"})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi chú (tùy chọn)"}),s.jsx("input",{type:"text",className:ks,placeholder:"Thông tin thêm cho báo giá"})]})]}),s.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[s.jsx("label",{className:"text-sm font-semibold text-white block",children:"Mã sản phẩm"}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[s.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),className:`${ks} text-sm`,placeholder:"Tìm sản phẩm..."}),s.jsx("button",{type:"button",onClick:m,className:"px-3 py-2 text-sm rounded-lg border border-white/20 bg-white/5 text-white hover:border-white/40 transition-colors",children:"Xóa Tìm Kiếm"})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:d.map(b=>{const w=u.includes(b.value);return s.jsx("button",{type:"button",onClick:()=>h(b.value),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${w?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:b.label,children:b.label},b.value)})}),s.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[s.jsx("button",{type:"button",onClick:f,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!u.length,children:"Thêm"}),s.jsx("button",{type:"button",onClick:v,className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),x.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:x.map(b=>s.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[b.product,s.jsx("button",{type:"button",onClick:()=>g(b.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xoa",children:"x"})]},b.id))})]})]})]}),$G=({rows:e})=>s.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[s.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),s.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TÊN SẢN PHẨM"}),s.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GÓI"}),s.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THỜI GIAN"}),s.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"ĐƠN GIÁ"}),s.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIẢM GIÁ"}),s.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THANH TIỀN"}),s.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CHÚ"})]})}),s.jsx("tbody",{children:e.map((t,r)=>s.jsxs("tr",{className:"align-top",children:[s.jsx("td",{className:"border border-slate-600 text-center py-2",children:r+1}),s.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:t.product,children:t.product}),s.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.packageName||t.term}),s.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.durationMonths?`${t.durationMonths} tháng`:t.durationDays?`${t.durationDays} ngày`:t.term||"--"}),s.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:Nf(t.unitPrice)}),s.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:Nf(t.discount||0)}),s.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:Nf(t.total)}),s.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:t.note||""})]},t.id))})]}),UG=({sections:e})=>{const t=s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Quy Tắc"}),s.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."}),s.jsx("p",{className:"font-semibold mt-3",children:"Thông tin sản phẩm"}),s.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chưa cập nhật."})]});return s.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[e.length===0?t:e.map(r=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"font-semibold",children:r.name}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Quy tắc"}),s.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.rules||"Chưa cập nhật."})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Thông tin sản phẩm"}),s.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.description||"Chưa cập nhật."})]})]},r.name)),s.jsxs("div",{className:"pt-2 text-sm",children:[s.jsx("p",{className:"font-semibold",children:"Mọi thông tin chi tiết có thể liên hệ:"}),s.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Tài Khoản Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]})},k4="/assets/sign-DzA7EGyE.png",HG=()=>s.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:s.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[s.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),s.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(Ký, ghi rõ họ tên)"}),s.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:s.jsx("img",{src:k4,alt:"Chữ ký",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}})})]})}),zG={};var WG={};const VG="/mavryk-logo.png",L2=typeof import.meta<"u"&&zG?.VITE_API_BASE_URL||typeof process<"u"&&WG?.VITE_API_BASE_URL||""||"http://localhost:3001";function KG(){p.useEffect(()=>{const V=document.title;return document.title="Mavryk Premium Store",()=>{document.title=V}},[]);const[e,t]=p.useState(new Date().toISOString().slice(0,10)),[r,n]=p.useState(""),[a,i]=p.useState(""),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,h]=p.useState(""),[f,m]=p.useState({}),x=p.useRef({}),[g,v]=p.useState([]),[b,w]=p.useState([]),y=p.useMemo(()=>{const V=b.map(K=>({...K,total:(K.unitPrice-(K.discount||0))*K.quantity})),X=V.reduce((K,Y)=>K+Y.total,0);return{rows:V,grandTotal:X}},[b]);p.useEffect(()=>{let V=!0;return(async()=>{try{const Y=await fetch(`${L2}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(!Y.ok)throw new Error("Failed to load variant pricing");const q=await Y.json();if(!V)return;Array.isArray(q)?l(q):q?.items&&Array.isArray(q.items)?l(q.items):l([])}catch(Y){console.error("Khong the tai pricing:",Y)}})(),(async()=>{try{const Y=await fetch(`${L2}${Je.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!Y.ok)throw new Error("Failed to load product_desc");const q=await Y.json();V&&q?.items&&Array.isArray(q.items)&&d(q.items.map(Z=>({productId:Z.productId||Z.product_id||"",rules:Z.rules??"",description:Z.description??""})))}catch(Y){console.error("Khong the tai product_desc:",Y)}})(),()=>{V=!1}},[]);const N=p.useCallback(async V=>{const X=V.map(Z=>({original:Z,key:Ms(Z)})).filter(Z=>Z.key);if(!X.length)return f;const K=X.filter(Z=>!f[Z.key]);if(!K.length)return f;const Y={},q=[];return K.forEach(({original:Z,key:le})=>{if(x.current[le]){q.push(x.current[le].then(pe=>{pe&&(Y[le]=pe)}));return}const ce=(async()=>{try{const pe=await Ue(Je.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({san_pham_name:Z,id_product:Z,customer_type:"LE",for_quote:!0})}),Ne=await pe.json().catch(()=>null);if(!pe.ok)throw new Error(Ne?.error||"Fail calculate-price");return IG(Ne)}catch(pe){return console.error("calculate-price failed",Z,pe),null}})();x.current[le]=ce,q.push(ce.then(pe=>{pe&&(Y[le]=pe)}).finally(()=>{delete x.current[le]}))}),q.length&&await Promise.all(q),Object.keys(Y).length?(m(Z=>({...Z,...Y})),{...f,...Y}):f},[f]),_=p.useMemo(()=>LG(o,f),[o,f]),S=p.useMemo(()=>{const V=new Map;return _.forEach(X=>{V.set(Ms(X.value),X)}),V},[_]),j=p.useMemo(()=>{const V=new Map;return o.forEach(X=>{const K=X?.[Ht.code]||X?.san_pham||"",Y=X?.[Ht.variantName]||X?.package_product||X?.package_product_label||"",q=Ec(Cc(K));q&&Y&&V.set(q,Y)}),V},[o]),E=p.useMemo(()=>{const V=new Map;return c.forEach(X=>{const K=Ec(Cc(X.productId));K&&V.set(K,X)}),V},[c]),k=p.useMemo(()=>{const V=u.trim().toLowerCase();return V?_.filter(X=>{const K=X.label.toLowerCase(),Y=X.value.toLowerCase(),q=X.productDisplay.toLowerCase();return K.includes(V)||Y.includes(V)||q.includes(V)}):_},[_,u]),T=p.useMemo(()=>{const V=new Set,X=[];return b.forEach(K=>{const Y=K.productCode||K.product||"",q=Ec(Cc(Y));if(!q||V.has(q))return;V.add(q);const Z=E.get(q),le=j.get(q)||K.packageName||K.product;X.push({name:le,rules:F2(Z?.rules),description:F2(Z?.description)})}),X},[b,E,j]),A=async()=>{if(!g.length)return;const V=g.map(K=>K.trim()).filter(Boolean);if(!V.length)return;const X=await N(V);w(K=>{const Y=[...K];return V.forEach(q=>{const Z=S.get(Ms(q))??S.get(Ms(q.normalize("NFD").replace(/[\u0300-\u036f]/g,""))),le=(Y.length+1).toString(),ce=Z?.durationDays?`${Z.durationDays} ngày`:Z?.term||"",pe=Ms(q),Ne=X[pe],{unitPrice:ee,discount:oe}=MG(Ne,Z||{});Y.push({id:le,productCode:q,product:Z?.productDisplay||q,packageName:Z?.packageDisplay||j.get(Ec(Cc(q)))||"",term:ce,durationMonths:Z?.durationMonths??null,durationDays:Z?.durationDays??null,unitPrice:ee,quantity:1,discount:oe})}),Y}),v([])},C=V=>w(X=>X.filter(K=>K.id!==V)),R=`BG-${(e||"").replaceAll("-","")||"----"}`;return s.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[s.jsx("style",{children:`
    /* Hide scrollbars while keeping scroll functionality */
    body {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    body::-webkit-scrollbar {
      display: none;
    }

    @media print {
      /* Hide everything except the printable quote */
      body { background: white !important; margin: 0 !important; padding: 0 !important; }
      body * { visibility: hidden !important; }
      #quote-print-area,
      #quote-print-area * { visibility: visible !important; }
      #quote-print-area {
        position: absolute;
        left: 0;
        top: 0;
        box-shadow: none !important;
        border: none !important;
      }
      .no-print { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
    }
  `}),s.jsx(BG,{recipient:r,onRecipientChange:n,quoteDate:e,onQuoteDateChange:t,quoteCode:R,contact:a,onContactChange:i,productSearch:u,onProductSearchChange:h,filteredOptions:k,selectedProductKeys:g,onToggleProduct:V=>v(X=>X.includes(V)?X.filter(K=>K!==V):[...X,V]),onAddSelectedProduct:A,onResetSearch:()=>h(""),lines:b,onRemoveLine:C,onDownload:()=>window.print()}),s.jsx("div",{className:"print-wrapper flex justify-center",children:s.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:s.jsxs("div",{children:[s.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[s.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:s.jsx("img",{src:VG,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:V=>{V.currentTarget.style.display="none"}})}),s.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),s.jsx("p",{children:"SDT: 0378.304.963"}),s.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),s.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BẢNG BÁO GIÁ"}),s.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800 space-y-1",children:[s.jsxs("p",{children:["Ngày: ",s.jsx("strong",{children:FG(e)||"..."})]}),s.jsxs("p",{children:["Kính gửi: ",s.jsx("strong",{children:r})]}),a?s.jsxs("p",{children:["Thông tin liên hệ: ",s.jsx("strong",{children:a})]}):null,s.jsx("p",{className:"mt-3 italic",children:"Mavryk Premium Store trân trọng gửi lời cảm ơn và bản báo giá chi tiết sản phẩm theo yêu cầu của Quý khách. Chúng tôi cam kết mọi sản phẩm đều đạt tiêu chuẩn chất lượng cao cấp nhất, đảm bảo mang lại trải nghiệm tuyệt vời và xứng đáng với sự đầu tư của Quý khách."})]}),s.jsx($G,{rows:y.rows}),s.jsx(UG,{sections:T}),s.jsx(HG,{})]})})})]})}const GG=({form:e,invoiceCodes:t,onChange:r,onAddInvoiceCode:n,onRemoveInvoiceCode:a,onSubmit:i})=>{const o=p.useId(),[l,c]=p.useState(null),d="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",u="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",h="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",f=m=>{m.key==="Enter"&&(m.preventDefault(),n())};return s.jsxs("div",{className:"bill-order-form rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[s.jsx("div",{className:"bill-order-form__header border-b border-slate-200 px-6 py-4",children:s.jsx("h2",{className:"bill-order-form__title text-lg font-semibold text-white",children:"Thông tin hóa đơn"})}),s.jsxs("form",{className:"bill-order-form__form px-6 py-5 space-y-4",onSubmit:i,children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{htmlFor:o,className:"text-sm font-medium text-slate-100",children:"Hóa đơn"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:u,onMouseLeave:()=>c(null),children:t.map(m=>s.jsxs("button",{type:"button",onClick:()=>a(m.id),onMouseEnter:()=>c(m.id),onMouseLeave:()=>c(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xóa hóa đơn ${m.code}`,children:[s.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:m.code}),s.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${l===m.id?"bg-white/20 text-red-500":""}`,children:s.jsx(Pt,{className:"h-4 w-4"})})]},m.id))}),s.jsx("div",{className:h,children:s.jsx("input",{id:o,type:"text",onMouseEnter:()=>c(null),onFocus:()=>c(null),onBlur:()=>c(null),value:e.invoiceCode,onChange:m=>r("invoiceCode",m.target.value),onKeyDown:f,className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhập mã hóa đơn và nhấn Enter"})})]})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngày"}),s.jsx("input",{type:"date",value:e.invoiceDate,onChange:m=>r("invoiceDate",m.target.value),className:d})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Mã số thuế"}),s.jsx("input",{type:"text",value:e.taxCode,onChange:m=>r("taxCode",m.target.value),className:d})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khách hàng / Công ty"}),s.jsx("input",{type:"text",value:e.customerName,onChange:m=>r("customerName",m.target.value),className:d})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),s.jsx("input",{type:"text",value:e.fax,onChange:m=>r("fax",m.target.value),className:d})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Địa chỉ"}),s.jsx("textarea",{value:e.address,onChange:m=>r("address",m.target.value),rows:2,className:`${d} resize-none`})]}),s.jsxs("label",{className:"space-y-1",children:[s.jsx("span",{className:"text-sm font-medium text-slate-100",children:"SĐT"}),s.jsx("input",{type:"text",value:e.phone,onChange:m=>r("phone",m.target.value),className:d})]})]}),s.jsx("div",{className:"pt-2",children:s.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cập nhật thông tin"})})]})]})};let B2=0;const XG=e=>(B2+=1,{id:`inv-${Date.now().toString(36)}-${B2.toString(36)}`,code:e}),Tc=e=>(e||"").trim().toLowerCase(),$2=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},YG=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith(wt.COLLABORATOR)?wt.COLLABORATOR:t.startsWith(wt.STUDENT)?wt.STUDENT:t.startsWith(wt.RETAIL)?wt.RETAIL:t.startsWith(wt.PROMO)?wt.PROMO:t.startsWith(wt.GIFT)?wt.GIFT:null},jf=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},qG=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},As={name:"MAVRYK PREMIUM",address:"Phan Văn Trị, Phường 11, Quận Bình Thạnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ngô Lê Ngọc Hương"},ZG={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},Sf="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",Ef=e=>`${e.toLocaleString("vi-VN")} đ`,JG=({form:e,invoiceLines:t,totals:r,dateDisplay:n,onDownload:a})=>{const i=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${Sf};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${Sf} !important;
      }
      #invoice-preview .invoice-signature img {
        max-width: 200px !important;
        height: auto !important;
        object-fit: contain !important;
        filter: none !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }
    }
  `;return s.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[s.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:s.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trước & tải về"})}),s.jsxs("div",{className:"p-6",children:[s.jsx("style",{children:i}),s.jsx("div",{id:"invoice-print-area",children:s.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:Sf},children:[s.jsxs("div",{className:"text-center leading-7",children:[s.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:As.name}),s.jsxs("p",{children:["Địa chỉ: ",As.address]}),s.jsxs("p",{children:["Điện thoại: ",As.phone]}),s.jsxs("p",{children:["Ngân hàng: ",As.bank]}),s.jsxs("p",{children:["STK: ",As.accountNumber]}),s.jsxs("p",{children:["Tên người nhận: ",As.receiver]})]}),s.jsx("div",{className:"my-4 h-px bg-slate-300"}),s.jsxs("div",{className:"text-center space-y-2 leading-7",children:[s.jsx("h2",{className:"text-xl font-bold uppercase",children:"HÓA ĐƠN BÁN HÀNG"}),s.jsx("div",{className:"text-sm",children:s.jsxs("p",{children:["Ngày: ",n]})})]}),s.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Khách hàng: "}),e.customerName||"---"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Địa chỉ: "}),e.address||"---"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",s.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Mã số Thuế: "}),e.taxCode||"---"]})]}),s.jsx("div",{className:"mt-8 px-2",children:s.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:s.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[s.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tên hàng hóa / Dịch vụ"}),s.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Đơn giá"}),s.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),s.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chiết khấu"}),s.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thành tiền"})]})}),s.jsx("tbody",{children:t.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Chưa có mã hóa đơn nào được chọn."})}):t.map(o=>s.jsxs("tr",{children:[s.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:s.jsx("div",{className:"font-semibold",children:o.description})}),s.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Ef(o.unitPrice)}),s.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:o.quantity}),s.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${o.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),s.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:Ef(o.total)})]},o.id))})]})})}),s.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tổng tiền hàng: ",Ef(r.subtotal)]}),s.jsxs("div",{className:"mt-8 space-y-4",children:[s.jsx("div",{className:"text-center text-sm italic",children:"Cảm ơn và hẹn gặp lại!"}),s.jsx("div",{className:"flex justify-end items-end mt-6 invoice-signature",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mb-2 text-sm font-semibold",children:"Người lập hóa đơn"}),s.jsx("img",{src:k4,alt:"Chữ ký",className:"h-20 w-auto object-contain max-w-[200px]",style:{filter:"none"}})]})})]})]})}),s.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:s.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[s.jsx(OT,{className:"h-5 w-5"}),"Download PDF"]})})]})]})},QG={};var eX={};const U2=typeof import.meta<"u"&&QG?.VITE_API_BASE_URL||typeof process<"u"&&eX?.VITE_API_BASE_URL||""||"http://localhost:3001";function tX(){p.useEffect(()=>{const w=document.title;return document.title="Mavryk Premium Store",()=>{document.title=w}},[]);const[e,t]=p.useState(ZG),[r,n]=p.useState([]),[a,i]=p.useState([]),[o,l]=p.useState([]);p.useEffect(()=>{let w=!0;const y=async()=>{try{const _=await fetch(`${U2}${Je.ORDERS}`,{credentials:"include"});if(!_.ok)throw new Error("Failed to load orders");const S=await _.json();w&&Array.isArray(S)&&i(S)}catch(_){console.error("Không thể tải dữ liệu order_list:",_)}},N=async()=>{try{const _=await fetch(`${U2}${Je.PRODUCT_PRICES}`,{credentials:"include"});if(!_.ok)throw new Error("Failed to load product pricing");const S=await _.json();w&&S?.items&&Array.isArray(S.items)&&l(S.items)}catch(_){console.error("Không thể tải dữ liệu pricing:",_)}};return y(),N(),()=>{w=!1}},[]);const c=p.useMemo(()=>{const w=new Map;return a.forEach(y=>{const N=Tc(y?.[It.idOrder]);N&&w.set(N,y)}),w},[a]),d=p.useMemo(()=>{const w=new Map;return o.forEach(y=>{const N=Tc(y?.[Ht.code]);N&&w.set(N,y)}),w},[o]),u=p.useMemo(()=>r.map(w=>{const y=c.get(Tc(w.code)),N=Tc(y?.[It.idProduct]),_=d.get(N),S=YG(y?.[It.idOrder]||w.code),j=$2(y?.[It.idProduct])||$2(_?.[Ht.code]),E=j?`${j} tháng`:"",k=_?.[Ht.variantName]||_?.[Ht.packageName]||y?.[It.idProduct]||w.code,T=E?`${k} ${E}`:k,A=jf(_?.computed_wholesale_price)||jf(y?.[It.price]),C=jf(_?.computed_retail_price)||A;let R=C;S===wt.COLLABORATOR||S===wt.STUDENT?R=A:S===wt.GIFT?R=0:S===wt.RETAIL||S===wt.PROMO?R=C:R=C||A;const G=S===wt.PROMO?qG(_?.[Ht.pctPromo]):0,V=Number((G*100).toFixed(2)),X=1,K=Math.max(0,R*X*(1-G));return{id:w.id,code:w.code,description:T,unitPrice:R,quantity:X,discountPct:V,total:K}}),[r,c,d]),h=p.useMemo(()=>({subtotal:u.reduce((y,N)=>y+N.total,0)}),[u]),f=p.useMemo(()=>{if(!e.invoiceDate)return"..... tháng ..... năm 20..";const w=new Date(e.invoiceDate);return Number.isNaN(w.getTime())?"..... tháng ..... năm 20..":new Intl.DateTimeFormat("vi-VN").format(w)},[e.invoiceDate]),m=(w,y)=>{t(N=>({...N,[w]:y}))},x=()=>{const w=e.invoiceCode.trim();w&&(n(y=>y.some(N=>N.code===w)?y:[...y,XG(w)]),t(y=>({...y,invoiceCode:""})))},g=w=>{n(y=>y.filter(N=>N.id!==w))},v=w=>{w.preventDefault()},b=()=>{window.print()};return s.jsxs("div",{className:"space-y-6 print-wrapper",children:[s.jsx(GG,{form:e,invoiceCodes:r,onChange:m,onAddInvoiceCode:x,onRemoveInvoiceCode:g,onSubmit:v}),s.jsx(JG,{form:e,invoiceLines:u,totals:h,dateDisplay:f,onDownload:b})]})}var Xu={};Xu.version="0.20.3";var ja=1200,vl=function(e){ja=e};function rX(){vl(1200)}var kc=function(t){return String.fromCharCode(t)},H2=function(t){return String.fromCharCode(t)},Pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yu(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Pr.charAt(i)+Pr.charAt(o)+Pr.charAt(l)+Pr.charAt(c);return t}function nX(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(d++),n>255&&(n=95),o=(r&3)<<4|n>>4,a=e.charCodeAt(d++),a>255&&(a=95),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Pr.charAt(i)+Pr.charAt(o)+Pr.charAt(l)+Pr.charAt(c);return t}function aX(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e[d++],i=r>>2,n=e[d++],o=(r&3)<<4|n>>4,a=e[d++],l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Pr.charAt(i)+Pr.charAt(o)+Pr.charAt(l)+Pr.charAt(c);return t}function vi(e){var t="",r=0,n=0,a=0,i=0,o=0,l=0,c=0;if(e.slice(0,5)=="data:"){var d=e.slice(0,1024).indexOf(";base64,");d>-1&&(e=e.slice(d+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Pr.indexOf(e.charAt(d++)),o=Pr.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Pr.indexOf(e.charAt(d++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Pr.indexOf(e.charAt(d++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var ot=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),xa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),qu=(function(){if(typeof Buffer>"u")return!1;var e=xa([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function ns(e){return ot?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function z2(e){return ot?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var dn=function(t){return ot?xa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function h0(e){if(typeof ArrayBuffer>"u")return dn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function as(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function iX(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Vt=ot?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(dn(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function sX(e){for(var t=[],r=0,n=e.length+250,a=ns(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ns(65535),n=65530)}return t.push(a.slice(0,r)),Vt(t)}var Go=/\u0000/g,Ac=/[\u0001-\u0006]/g;function Ks(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function zn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function Pg(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function Zu(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function oX(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function lX(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var W2=Math.pow(2,32);function Ps(e,t){if(e>W2||e<-W2)return oX(e,t);var r=Math.round(e);return lX(r,t)}function Ju(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var V2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Cf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cX(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var _t={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},K2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},uX={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qu(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,o=1,l=0,c=1,d=0,u=0,h=Math.floor(a);d<t&&(h=Math.floor(a),l=h*o+i,u=h*d+c,!(a-h<5e-8));)a=1/(a-h),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function dX(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+Tt("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Tt("0",t.length-15);return Number(n)}function Os(e,t,r){if(e>2958465||e<0)return null;e=dX(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=xX(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}function Og(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hX(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fX(e){var t=e<0?12:11,r=Og(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function mX(e){var t=Og(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function pX(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=fX(e):t===10?r=e.toFixed(10).substr(0,12):r=mX(e),Og(hX(r.toUpperCase()))}function ip(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pX(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Va(14,_r(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function xX(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gX(e,t,r,n){var a="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Cf[r.m-1][1];case 5:return Cf[r.m-1][0];default:return Cf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return V2[r.q][0];default:return V2[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?zn(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(a=zn(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?zn(c,d):"";return u}function ci(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var A4=/%/g;function vX(e,t,r){var n=t.replace(A4,""),a=t.length-n.length;return Oa(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function bX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function P4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+P4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var O4=/# (\?+)( ?)\/( ?)(\d+)/;function yX(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),o=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(o===0?Tt(" ",e[1].length+1+e[4].length):Pg(o,e[1].length)+e[2]+"/"+e[3]+zn(l,e[4].length))}function wX(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var D4=/^#*0*\.([0#]+)/,I4=/\)[^)]*[0#]/,R4=/\(###\) ###\\?-####/;function Ur(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function G2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function X2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function NX(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function _X(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function En(e,t,r){if(e.charCodeAt(0)===40&&!t.match(I4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?En("n",n,r):"("+En("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return bX(e,t,r);if(t.indexOf("%")!==-1)return vX(e,t,r);if(t.indexOf("E")!==-1)return P4(t,r);if(t.charCodeAt(0)===36)return"$"+En(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ps(c,t.length);if(t.match(/^[#?]+$/))return a=Ps(r,0),a==="0"&&(a=""),a.length>t.length?a:Ur(t.substr(0,t.length-a.length))+a;if(i=t.match(O4))return yX(i,c,d);if(t.match(/^#+0+$/))return d+Ps(c,t.length-t.indexOf("0"));if(i=t.match(D4))return a=G2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Ur(i[1])).replace(/\.$/,"."+Ur(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Tt("0",Ur(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+G2(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ci(Ps(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+En(e,t,-r):ci(""+(Math.floor(r)+NX(r,i[1].length)))+"."+zn(X2(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return En(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ks(En(e,t.replace(/[\\-]/g,""),r)),o=0,Ks(Ks(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(R4))return a=En(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Qu(c,Math.pow(10,o)-1,!1),a=""+d,u=Oa("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zu(l[2],o),u.length<i[4].length&&(u=Ur(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Qu(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Pg(l[1],o)+i[2]+"/"+i[3]+Zu(l[2],o):Tt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Ps(r,0),t.length<=a.length?a:Ur(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,f=t.length-a.length-h;return Ur(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=X2(r,i[1].length),r<0?"-"+En(e,t,-r):ci(_X(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zn(0,3-x.length):"")+x})+"."+zn(o,i[1].length);switch(t){case"###,##0.00":return En(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ci(Ps(c,0));return m!=="0"?d+m:"";case"###,###.00":return En(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return En(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jX(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oa(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function SX(e,t,r){var n=t.replace(A4,""),a=t.length-n.length;return Oa(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function M4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+M4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ea(e,t,r){if(e.charCodeAt(0)===40&&!t.match(I4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ea("n",n,r):"("+ea("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jX(e,t,r);if(t.indexOf("%")!==-1)return SX(e,t,r);if(t.indexOf("E")!==-1)return M4(t,r);if(t.charCodeAt(0)===36)return"$"+ea(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+zn(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ur(t.substr(0,t.length-a.length))+a;if(i=t.match(O4))return wX(i,c,d);if(t.match(/^#+0+$/))return d+zn(c,t.length-t.indexOf("0"));if(i=t.match(D4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ur(i[1])).replace(/\.$/,"."+Ur(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+Tt("0",Ur(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ci(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ea(e,t,-r):ci(""+r)+"."+Tt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ea(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ks(ea(e,t.replace(/[\\-]/g,""),r)),o=0,Ks(Ks(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<a.length?a.charAt(o++):x==="0"?"0":""}));if(t.match(R4))return a=ea(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=Qu(c,Math.pow(10,o)-1,!1),a=""+d,u=Oa("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Zu(l[2],o),u.length<i[4].length&&(u=Ur(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=Qu(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Pg(l[1],o)+i[2]+"/"+i[3]+Zu(l[2],o):Tt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ur(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var h=t.indexOf(".")-o,f=t.length-a.length-h;return Ur(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ea(e,t,-r):ci(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?zn(0,3-x.length):"")+x})+"."+zn(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ci(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return ea(e,t.slice(0,t.lastIndexOf(".")),r)+Ur(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Oa(e,t,r){return(r|0)===r?ea(e,t,r):En(e,t,r)}function EX(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var F4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function is(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ju(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(F4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function CX(e,t,r,n){for(var a=[],i="",o=0,l="",c="t",d,u,h,f="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!Ju(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),x=m==="("||m===")"?m:"t";a[a.length]={t:x,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Os(t,r,e.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Os(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var g={t:l,v:l};if(d==null&&(d=Os(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?e.charAt(o+2):l),g.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(g.v=d.H>=12?"下午":"上午"),g.t="T",o+=5,f="h"):(g.t="t",++o),d==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(F4)){if(d==null&&(d=Os(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",is(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var v=0,b=0,w;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=f,c="h",v<1&&(v=1);break;case"s":(w=a[o].v.match(/\.0+$/))&&(b=Math.max(b,w[0].length-1),v=4),v<3&&(v=3);case"d":case"y":case"e":c=a[o].t;break;case"M":c=a[o].t,v<2&&(v=2);break;case"m":c==="s"&&(a[o].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[o].v.match(/[Hh]/)&&(v=1),v<2&&a[o].v.match(/[Mm]/)&&(v=2),v<3&&a[o].v.match(/[Ss]/)&&(v=3)}var y;switch(v){case 0:break;case 1:case 2:case 3:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,y=Os(d.D),y.u=d.u,y.S=d.S,y.M=d.M,y.H=d.H,d=y);break;case 4:switch(b){case 1:d.u=Math.round(d.u*10)/10;break;case 2:d.u=Math.round(d.u*100)/100;break;case 3:d.u=Math.round(d.u*1e3)/1e3;break}d.u>=1&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,y=Os(d.D),y.u=d.u,y.S=d.S,y.M=d.M,y.H=d.H,d=y);break}var N="",_;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=gX(a[o].t.charCodeAt(0),a[o].v,d,b),a[o].t="t";break;case"n":case"?":for(_=o+1;a[_]!=null&&((l=a[_].t)==="?"||l==="D"||(l===" "||l==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[o].v+=a[_].v,a[_]={v:"",t:";"},++_;N+=a[o].v,o=_-1;break;case"G":a[o].t="t",a[o].v=ip(t,r);break}var S="",j,E;if(N.length>0){N.charCodeAt(0)==40?(j=t<0&&N.charCodeAt(0)===45?-t:t,E=Oa("n",N,j)):(j=t<0&&n>1?-t:t,E=Oa("n",N,j),j<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),_=E.length-1;var k=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){k=o;break}var T=a.length;if(k===a.length&&E.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(_>=a[o].v.length-1?(_-=a[o].v.length,a[o].v=E.substr(_+1,a[o].v.length)):_<0?a[o].v="":(a[o].v=E.substr(0,_+1),_=-1),a[o].t="t",T=o);_>=0&&T<a.length&&(a[T].v=E.substr(0,_+1)+a[T].v)}else if(k!==a.length&&E.indexOf("E")===-1){for(_=E.indexOf(".")-1,o=k;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(u=a[o].v.indexOf(".")>-1&&o===k?a[o].v.indexOf(".")-1:a[o].v.length-1,S=a[o].v.substr(u+1);u>=0;--u)_>=0&&(a[o].v.charAt(u)==="0"||a[o].v.charAt(u)==="#")&&(S=E.charAt(_--)+S);a[o].v=S,a[o].t="t",T=o}for(_>=0&&T<a.length&&(a[T].v=E.substr(0,_+1)+a[T].v),_=E.indexOf(".")+1,o=k;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==k)){for(u=a[o].v.indexOf(".")>-1&&o===k?a[o].v.indexOf(".")+1:0,S=a[o].v.substr(0,u);u<a[o].v.length;++u)_<E.length&&(S+=E.charAt(_++));a[o].v=S,a[o].t="t",T=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(j=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=Oa(a[o].t,a[o].v,j),a[o].t="t");var A="";for(o=0;o!==a.length;++o)a[o]!=null&&(A+=a[o].v);return A}var Y2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function q2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function TX(e,t){var r=EX(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Y2),l=r[1].match(Y2);return q2(t,o)?[n,r[0]]:q2(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,i]}function Va(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:_t)[e],n==null&&(n=r.table&&r.table[K2[e]]||_t[K2[e]]),n==null&&(n=uX[e]||"General");break}if(Ju(n,0))return ip(t,r);t instanceof Date&&(t=_r(t,r.date1904));var a=TX(n,t);if(Ju(a[1]))return ip(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return CX(a[1],t,r,a[0])}function L4(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(_t[r]==null){t<0&&(t=r);continue}if(_t[r]==e){t=r;break}}t<0&&(t=391)}return _t[t]=e,t}function f0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&L4(e[t],t)}function m0(){_t=cX()}var ed=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function kX(e){var t=typeof e=="number"?_t[e]:e;return t=t.replace(ed,"(\\d+)"),ed.lastIndex=0,new RegExp("^"+t+"$")}function AX(e,t,r){var n=-1,a=-1,i=-1,o=-1,l=-1,c=-1;(t.match(ed)||[]).forEach(function(h,f){var m=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:a=m;break}}),ed.lastIndex=0,c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:n==-1&&a==-1&&i==-1?u:d+"T"+u}var PX={"d.m":"d\\.m"};function OX(e,t){return L4(PX[e]||e,t)}var Z2=(function(){var e={};e.version="1.2.0";function t(){for(var j=0,E=new Array(256),k=0;k!=256;++k)j=k,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,E[k]=j;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(j){var E=0,k=0,T=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)A[T]=j[T];for(T=0;T!=256;++T)for(k=j[T],E=256+T;E<4096;E+=256)k=A[E]=k>>>8^j[k&255];var C=[];for(T=1;T!=16;++T)C[T-1]=typeof Int32Array<"u"&&typeof A.subarray=="function"?A.subarray(T*256,T*256+256):A.slice(T*256,T*256+256);return C}var a=n(r),i=a[0],o=a[1],l=a[2],c=a[3],d=a[4],u=a[5],h=a[6],f=a[7],m=a[8],x=a[9],g=a[10],v=a[11],b=a[12],w=a[13],y=a[14];function N(j,E){for(var k=E^-1,T=0,A=j.length;T<A;)k=k>>>8^r[(k^j.charCodeAt(T++))&255];return~k}function _(j,E){for(var k=E^-1,T=j.length-15,A=0;A<T;)k=y[j[A++]^k&255]^w[j[A++]^k>>8&255]^b[j[A++]^k>>16&255]^v[j[A++]^k>>>24]^g[j[A++]]^x[j[A++]]^m[j[A++]]^f[j[A++]]^h[j[A++]]^u[j[A++]]^d[j[A++]]^c[j[A++]]^l[j[A++]]^o[j[A++]]^i[j[A++]]^r[j[A++]];for(T+=15;A<T;)k=k>>>8^r[(k^j[A++])&255];return~k}function S(j,E){for(var k=E^-1,T=0,A=j.length,C=0,R=0;T<A;)C=j.charCodeAt(T++),C<128?k=k>>>8^r[(k^C)&255]:C<2048?(k=k>>>8^r[(k^(192|C>>6&31))&255],k=k>>>8^r[(k^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,R=j.charCodeAt(T++)&1023,k=k>>>8^r[(k^(240|C>>8&7))&255],k=k>>>8^r[(k^(128|C>>2&63))&255],k=k>>>8^r[(k^(128|R>>6&15|(C&3)<<4))&255],k=k>>>8^r[(k^(128|R&63))&255]):(k=k>>>8^r[(k^(224|C>>12&15))&255],k=k>>>8^r[(k^(128|C>>6&63))&255],k=k>>>8^r[(k^(128|C&63))&255]);return~k}return e.table=r,e.bstr=N,e.buf=_,e.str=S,e})(),gt=(function(){var t={};t.version="1.2.2";function r(P,B){for(var D=P.split("/"),M=B.split("/"),U=0,z=0,ne=Math.min(D.length,M.length);U<ne;++U){if(z=D[U].length-M[U].length)return z;if(D[U]!=M[U])return D[U]<M[U]?-1:1}return D.length-M.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(0,B+1)}function a(P){if(P.charAt(P.length-1)=="/")return a(P.slice(0,-1));var B=P.lastIndexOf("/");return B===-1?P:P.slice(B+1)}function i(P,B){typeof B=="string"&&(B=new Date(B));var D=B.getHours();D=D<<6|B.getMinutes(),D=D<<5|B.getSeconds()>>>1,P.write_shift(2,D);var M=B.getFullYear()-1980;M=M<<4|B.getMonth()+1,M=M<<5|B.getDate(),P.write_shift(2,M)}function o(P){var B=P.read_shift(2)&65535,D=P.read_shift(2)&65535,M=new Date,U=D&31;D>>>=5;var z=D&15;D>>>=4,M.setMilliseconds(0),M.setFullYear(D+1980),M.setMonth(z-1),M.setDate(U);var ne=B&31;B>>>=5;var de=B&63;return B>>>=6,M.setHours(B),M.setMinutes(de),M.setSeconds(ne<<1),M}function l(P){Hr(P,0);for(var B={},D=0;P.l<=P.length-4;){var M=P.read_shift(2),U=P.read_shift(2),z=P.l+U,ne={};switch(M){case 21589:D=P.read_shift(1),D&1&&(ne.mtime=P.read_shift(4)),U>5&&(D&2&&(ne.atime=P.read_shift(4)),D&4&&(ne.ctime=P.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break;case 1:{var de=P.read_shift(4),te=P.read_shift(4);ne.usz=te*Math.pow(2,32)+de,de=P.read_shift(4),te=P.read_shift(4),ne.csz=te*Math.pow(2,32)+de}break}P.l=z,B[M]=ne}return B}var c;function d(){return c||(c=DX)}function u(P,B){if(P[0]==80&&P[1]==75)return Ke(P,B);if((P[0]|32)==109&&(P[1]|32)==105)return ys(P,B);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var D=3,M=512,U=0,z=0,ne=0,de=0,te=0,ae=[],ie=P.slice(0,512);Hr(ie,0);var _e=h(ie);switch(D=_e[0],D){case 3:M=512;break;case 4:M=4096;break;case 0:if(_e[1]==0)return Ke(P,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}M!==512&&(ie=P.slice(0,M),Hr(ie,28));var Ee=P.slice(0,M);f(ie,D);var De=ie.read_shift(4,"i");if(D===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);ie.l+=4,ne=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),de=ie.read_shift(4,"i"),U=ie.read_shift(4,"i"),te=ie.read_shift(4,"i"),z=ie.read_shift(4,"i");for(var je=-1,Te=0;Te<109&&(je=ie.read_shift(4,"i"),!(je<0));++Te)ae[Te]=je;var Xe=m(P,M);v(te,z,Xe,M,ae);var St=w(Xe,ne,ae,M);ne<St.length&&(St[ne].name="!Directory"),U>0&&de!==R&&(St[de].name="!MiniFAT"),St[ae[0]].name="!FAT",St.fat_addrs=ae,St.ssz=M;var Dt={},jr=[],jo=[],So=[];y(ne,St,Xe,jr,U,Dt,jo,de),x(jo,So,jr),jr.shift();var Eo={FileIndex:jo,FullPaths:So};return B&&B.raw&&(Eo.raw={header:Ee,sectors:Xe}),Eo}function h(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(G,"Header Signature: "),P.l+=16;var B=P.read_shift(2,"u");return[P.read_shift(2,"u"),B]}function f(P,B){var D=9;switch(P.l+=2,D=P.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function m(P,B){for(var D=Math.ceil(P.length/B)-1,M=[],U=1;U<D;++U)M[U-1]=P.slice(U*B,(U+1)*B);return M[D-1]=P.slice(D*B),M}function x(P,B,D){for(var M=0,U=0,z=0,ne=0,de=0,te=D.length,ae=[],ie=[];M<te;++M)ae[M]=ie[M]=M,B[M]=D[M];for(;de<ie.length;++de)M=ie[de],U=P[M].L,z=P[M].R,ne=P[M].C,ae[M]===M&&(U!==-1&&ae[U]!==U&&(ae[M]=ae[U]),z!==-1&&ae[z]!==z&&(ae[M]=ae[z])),ne!==-1&&(ae[ne]=M),U!==-1&&M!=ae[M]&&(ae[U]=ae[M],ie.lastIndexOf(U)<de&&ie.push(U)),z!==-1&&M!=ae[M]&&(ae[z]=ae[M],ie.lastIndexOf(z)<de&&ie.push(z));for(M=1;M<te;++M)ae[M]===M&&(z!==-1&&ae[z]!==z?ae[M]=ae[z]:U!==-1&&ae[U]!==U&&(ae[M]=ae[U]));for(M=1;M<te;++M)if(P[M].type!==0){if(de=M,de!=ae[de])do de=ae[de],B[M]=B[de]+"/"+B[M];while(de!==0&&ae[de]!==-1&&de!=ae[de]);ae[M]=-1}for(B[0]+="/",M=1;M<te;++M)P[M].type!==2&&(B[M]+="/")}function g(P,B,D){for(var M=P.start,U=P.size,z=[],ne=M;D&&U>0&&ne>=0;)z.push(B.slice(ne*C,ne*C+C)),U-=C,ne=Mi(D,ne*4);return z.length===0?re(0):Vt(z).slice(0,P.size)}function v(P,B,D,M,U){var z=R;if(P===R){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var ne=D[P],de=(M>>>2)-1;if(!ne)return;for(var te=0;te<de&&(z=Mi(ne,te*4))!==R;++te)U.push(z);B>=1&&v(Mi(ne,M-4),B-1,D,M,U)}}function b(P,B,D,M,U){var z=[],ne=[];U||(U=[]);var de=M-1,te=0,ae=0;for(te=B;te>=0;){U[te]=!0,z[z.length]=te,ne.push(P[te]);var ie=D[Math.floor(te*4/M)];if(ae=te*4&de,M<4+ae)throw new Error("FAT boundary crossed: "+te+" 4 "+M);if(!P[ie])break;te=Mi(P[ie],ae)}return{nodes:z,data:aN([ne])}}function w(P,B,D,M){var U=P.length,z=[],ne=[],de=[],te=[],ae=M-1,ie=0,_e=0,Ee=0,De=0;for(ie=0;ie<U;++ie)if(de=[],Ee=ie+B,Ee>=U&&(Ee-=U),!ne[Ee]){te=[];var je=[];for(_e=Ee;_e>=0;){je[_e]=!0,ne[_e]=!0,de[de.length]=_e,te.push(P[_e]);var Te=D[Math.floor(_e*4/M)];if(De=_e*4&ae,M<4+De)throw new Error("FAT boundary crossed: "+_e+" 4 "+M);if(!P[Te]||(_e=Mi(P[Te],De),je[_e]))break}z[Ee]={nodes:de,data:aN([te])}}return z}function y(P,B,D,M,U,z,ne,de){for(var te=0,ae=M.length?2:0,ie=B[P].data,_e=0,Ee=0,De;_e<ie.length;_e+=128){var je=ie.slice(_e,_e+128);Hr(je,64),Ee=je.read_shift(2),De=Lg(je,0,Ee-ae),M.push(De);var Te={name:De,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},Xe=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);Xe!==0&&(Te.ct=N(je,je.l-8));var St=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);St!==0&&(Te.mt=N(je,je.l-8)),Te.start=je.read_shift(4,"i"),Te.size=je.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=R,Te.name=""),Te.type===5?(te=Te.start,U>0&&te!==R&&(B[te].name="!StreamData")):Te.size>=4096?(Te.storage="fat",B[Te.start]===void 0&&(B[Te.start]=b(D,Te.start,B.fat_addrs,B.ssz)),B[Te.start].name=Te.name,Te.content=B[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:te!==R&&Te.start!==R&&B[te]&&(Te.content=g(Te,B[te].data,(B[de]||{}).data))),Te.content&&Hr(Te.content,0),z[De]=Te,ne.push(Te)}}function N(P,B){return new Date((fn(P,B+4)/1e7*Math.pow(2,32)+fn(P,B)/1e7-11644473600)*1e3)}function _(P,B){return d(),u(c.readFileSync(P),B)}function S(P,B){var D=B&&B.type;switch(D||ot&&Buffer.isBuffer(P)&&(D="buffer"),D||"base64"){case"file":return _(P,B);case"base64":return u(dn(vi(P)),B);case"binary":return u(dn(P),B)}return u(P,B)}function j(P,B){var D=B||{},M=D.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=M+"/",P.FileIndex[0]={name:M,type:5}),D.CLSID&&(P.FileIndex[0].clsid=D.CLSID),E(P)}function E(P){var B="Sh33tJ5";if(!gt.find(P,"/"+B)){var D=re(4);D[0]=55,D[1]=D[3]=50,D[2]=54,P.FileIndex.push({name:B,type:2,content:D,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+B),k(P)}}function k(P,B){j(P);for(var D=!1,M=!1,U=P.FullPaths.length-1;U>=0;--U){var z=P.FileIndex[U];switch(z.type){case 0:M?D=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(z.R*z.L*z.C)&&(D=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!B)){var ne=new Date(1987,1,19),de=0,te=Object.create?Object.create(null):{},ae=[];for(U=0;U<P.FullPaths.length;++U)te[P.FullPaths[U]]=!0,P.FileIndex[U].type!==0&&ae.push([P.FullPaths[U],P.FileIndex[U]]);for(U=0;U<ae.length;++U){var ie=n(ae[U][0]);for(M=te[ie];!M;){for(;n(ie)&&!te[n(ie)];)ie=n(ie);ae.push([ie,{name:a(ie).replace("/",""),type:1,clsid:X,ct:ne,mt:ne,content:null}]),te[ie]=!0,ie=n(ae[U][0]),M=te[ie]}}for(ae.sort(function(De,je){return r(De[0],je[0])}),P.FullPaths=[],P.FileIndex=[],U=0;U<ae.length;++U)P.FullPaths[U]=ae[U][0],P.FileIndex[U]=ae[U][1];for(U=0;U<ae.length;++U){var _e=P.FileIndex[U],Ee=P.FullPaths[U];if(_e.name=a(Ee).replace("/",""),_e.L=_e.R=_e.C=-(_e.color=1),_e.size=_e.content?_e.content.length:0,_e.start=0,_e.clsid=_e.clsid||X,U===0)_e.C=ae.length>1?1:-1,_e.size=0,_e.type=5;else if(Ee.slice(-1)=="/"){for(de=U+1;de<ae.length&&n(P.FullPaths[de])!=Ee;++de);for(_e.C=de>=ae.length?-1:de,de=U+1;de<ae.length&&n(P.FullPaths[de])!=n(Ee);++de);_e.R=de>=ae.length?-1:de,_e.type=1}else n(P.FullPaths[U+1]||"")==n(Ee)&&(_e.R=U+1),_e.type=2}}}function T(P,B){var D=B||{};if(D.fileType=="mad")return Ci(P,D);if(k(P),D.fileType==="zip")return ze(P,D);var M=(function(De){for(var je=0,Te=0,Xe=0;Xe<De.FileIndex.length;++Xe){var St=De.FileIndex[Xe];if(St.content){var Dt=St.content.length;Dt>0&&(Dt<4096?je+=Dt+63>>6:Te+=Dt+511>>9)}}for(var jr=De.FullPaths.length+3>>2,jo=je+7>>3,So=je+127>>7,Eo=jo+Te+jr+So,Ti=Eo+127>>7,_0=Ti<=109?0:Math.ceil((Ti-109)/127);Eo+Ti+_0+127>>7>Ti;)_0=++Ti<=109?0:Math.ceil((Ti-109)/127);var ya=[1,_0,Ti,So,jr,Te,je,0];return De.FileIndex[0].size=je<<6,ya[7]=(De.FileIndex[0].start=ya[0]+ya[1]+ya[2]+ya[3]+ya[4]+ya[5])+(ya[6]+7>>3),ya})(P),U=re(M[7]<<9),z=0,ne=0;{for(z=0;z<8;++z)U.write_shift(1,V[z]);for(z=0;z<8;++z)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),z=0;z<3;++z)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,M[2]),U.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:R),U.write_shift(4,M[3]),U.write_shift(-4,M[1]?M[0]-1:R),U.write_shift(4,M[1]),z=0;z<109;++z)U.write_shift(-4,z<M[2]?M[1]+z:-1)}if(M[1])for(ne=0;ne<M[1];++ne){for(;z<236+ne*127;++z)U.write_shift(-4,z<M[2]?M[1]+z:-1);U.write_shift(-4,ne===M[1]-1?R:ne+1)}var de=function(De){for(ne+=De;z<ne-1;++z)U.write_shift(-4,z+1);De&&(++z,U.write_shift(-4,R))};for(ne=z=0,ne+=M[1];z<ne;++z)U.write_shift(-4,K.DIFSECT);for(ne+=M[2];z<ne;++z)U.write_shift(-4,K.FATSECT);de(M[3]),de(M[4]);for(var te=0,ae=0,ie=P.FileIndex[0];te<P.FileIndex.length;++te)ie=P.FileIndex[te],ie.content&&(ae=ie.content.length,!(ae<4096)&&(ie.start=ne,de(ae+511>>9)));for(de(M[6]+7>>3);U.l&511;)U.write_shift(-4,K.ENDOFCHAIN);for(ne=z=0,te=0;te<P.FileIndex.length;++te)ie=P.FileIndex[te],ie.content&&(ae=ie.content.length,!(!ae||ae>=4096)&&(ie.start=ne,de(ae+63>>6)));for(;U.l&511;)U.write_shift(-4,K.ENDOFCHAIN);for(z=0;z<M[4]<<2;++z){var _e=P.FullPaths[z];if(!_e||_e.length===0){for(te=0;te<17;++te)U.write_shift(4,0);for(te=0;te<3;++te)U.write_shift(4,-1);for(te=0;te<12;++te)U.write_shift(4,0);continue}ie=P.FileIndex[z],z===0&&(ie.start=ie.size?ie.start-1:R);var Ee=z===0&&D.root||ie.name;if(Ee.length>31&&(console.error("Name "+Ee+" will be truncated to "+Ee.slice(0,31)),Ee=Ee.slice(0,31)),ae=2*(Ee.length+1),U.write_shift(64,Ee,"utf16le"),U.write_shift(2,ae),U.write_shift(1,ie.type),U.write_shift(1,ie.color),U.write_shift(-4,ie.L),U.write_shift(-4,ie.R),U.write_shift(-4,ie.C),ie.clsid)U.write_shift(16,ie.clsid,"hex");else for(te=0;te<4;++te)U.write_shift(4,0);U.write_shift(4,ie.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ie.start),U.write_shift(4,ie.size),U.write_shift(4,0)}for(z=1;z<P.FileIndex.length;++z)if(ie=P.FileIndex[z],ie.size>=4096)if(U.l=ie.start+1<<9,ot&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+511&-512;else{for(te=0;te<ie.size;++te)U.write_shift(1,ie.content[te]);for(;te&511;++te)U.write_shift(1,0)}for(z=1;z<P.FileIndex.length;++z)if(ie=P.FileIndex[z],ie.size>0&&ie.size<4096)if(ot&&Buffer.isBuffer(ie.content))ie.content.copy(U,U.l,0,ie.size),U.l+=ie.size+63&-64;else{for(te=0;te<ie.size;++te)U.write_shift(1,ie.content[te]);for(;te&63;++te)U.write_shift(1,0)}if(ot)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function A(P,B){var D=P.FullPaths.map(function(te){return te.toUpperCase()}),M=D.map(function(te){var ae=te.split("/");return ae[ae.length-(te.slice(-1)=="/"?2:1)]}),U=!1;B.charCodeAt(0)===47?(U=!0,B=D[0].slice(0,-1)+B):U=B.indexOf("/")!==-1;var z=B.toUpperCase(),ne=U===!0?D.indexOf(z):M.indexOf(z);if(ne!==-1)return P.FileIndex[ne];var de=!z.match(Ac);for(z=z.replace(Go,""),de&&(z=z.replace(Ac,"!")),ne=0;ne<D.length;++ne)if((de?D[ne].replace(Ac,"!"):D[ne]).replace(Go,"")==z||(de?M[ne].replace(Ac,"!"):M[ne]).replace(Go,"")==z)return P.FileIndex[ne];return null}var C=64,R=-2,G="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(P,B,D){d();var M=T(P,D);c.writeFileSync(B,M)}function q(P){for(var B=new Array(P.length),D=0;D<P.length;++D)B[D]=String.fromCharCode(P[D]);return B.join("")}function Z(P,B){var D=T(P,B);switch(B&&B.type||"buffer"){case"file":return d(),c.writeFileSync(B.filename,D),D;case"binary":return typeof D=="string"?D:q(D);case"base64":return Yu(typeof D=="string"?D:q(D));case"buffer":if(ot)return Buffer.isBuffer(D)?D:xa(D);case"array":return typeof D=="string"?dn(D):D}return D}var le;function ce(P){try{var B=P.InflateRaw,D=new B;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)le=P;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function pe(P,B){if(!le)return ec(P,B);var D=le.InflateRaw,M=new D,U=M._processChunk(P.slice(P.l),M._finishFlushFlag);return P.l+=M.bytesRead,U}function Ne(P){return le?le.deflateRawSync(P):ct(P)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function O(P){var B=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(B>>16|B>>8|B)&255}for(var I=typeof Uint8Array<"u",L=I?new Uint8Array(256):[],F=0;F<256;++F)L[F]=O(F);function W(P,B){var D=L[P&255];return B<=8?D>>>8-B:(D=D<<8|L[P>>8&255],B<=16?D>>>16-B:(D=D<<8|L[P>>16&255],D>>>24-B))}function J(P,B){var D=B&7,M=B>>>3;return(P[M]|(D<=6?0:P[M+1]<<8))>>>D&3}function se(P,B){var D=B&7,M=B>>>3;return(P[M]|(D<=5?0:P[M+1]<<8))>>>D&7}function ke(P,B){var D=B&7,M=B>>>3;return(P[M]|(D<=4?0:P[M+1]<<8))>>>D&15}function ye(P,B){var D=B&7,M=B>>>3;return(P[M]|(D<=3?0:P[M+1]<<8))>>>D&31}function Pe(P,B){var D=B&7,M=B>>>3;return(P[M]|(D<=1?0:P[M+1]<<8))>>>D&127}function ue(P,B,D){var M=B&7,U=B>>>3,z=(1<<D)-1,ne=P[U]>>>M;return D<8-M||(ne|=P[U+1]<<8-M,D<16-M)||(ne|=P[U+2]<<16-M,D<24-M)||(ne|=P[U+3]<<24-M),ne&z}function Be(P,B,D){var M=B&7,U=B>>>3;return M<=5?P[U]|=(D&7)<<M:(P[U]|=D<<M&255,P[U+1]=(D&7)>>8-M),B+3}function Ve(P,B,D){var M=B&7,U=B>>>3;return D=(D&1)<<M,P[U]|=D,B+1}function ve(P,B,D){var M=B&7,U=B>>>3;return D<<=M,P[U]|=D&255,D>>>=8,P[U+1]=D,B+8}function we(P,B,D){var M=B&7,U=B>>>3;return D<<=M,P[U]|=D&255,D>>>=8,P[U+1]=D&255,P[U+2]=D>>>8,B+16}function fe(P,B){var D=P.length,M=2*D>B?2*D:B+5,U=0;if(D>=B)return P;if(ot){var z=z2(M);if(P.copy)P.copy(z);else for(;U<P.length;++U)z[U]=P[U];return z}else if(I){var ne=new Uint8Array(M);if(ne.set)ne.set(P);else for(;U<D;++U)ne[U]=P[U];return ne}return P.length=M,P}function Ce(P){for(var B=new Array(P),D=0;D<P;++D)B[D]=0;return B}function me(P,B,D){var M=1,U=0,z=0,ne=0,de=0,te=P.length,ae=I?new Uint16Array(32):Ce(32);for(z=0;z<32;++z)ae[z]=0;for(z=te;z<D;++z)P[z]=0;te=P.length;var ie=I?new Uint16Array(te):Ce(te);for(z=0;z<te;++z)ae[U=P[z]]++,M<U&&(M=U),ie[z]=0;for(ae[0]=0,z=1;z<=M;++z)ae[z+16]=de=de+ae[z-1]<<1;for(z=0;z<te;++z)de=P[z],de!=0&&(ie[z]=ae[de+16]++);var _e=0;for(z=0;z<te;++z)if(_e=P[z],_e!=0)for(de=W(ie[z],M)>>M-_e,ne=(1<<M+4-_e)-1;ne>=0;--ne)B[de|ne<<_e]=_e&15|z<<4;return M}var We=I?new Uint16Array(512):Ce(512),Oe=I?new Uint16Array(32):Ce(32);if(!I){for(var Ae=0;Ae<512;++Ae)We[Ae]=0;for(Ae=0;Ae<32;++Ae)Oe[Ae]=0}(function(){for(var P=[],B=0;B<32;B++)P.push(5);me(P,Oe,32);var D=[];for(B=0;B<=143;B++)D.push(8);for(;B<=255;B++)D.push(9);for(;B<=279;B++)D.push(7);for(;B<=287;B++)D.push(8);me(D,We,288)})();var Ye=(function(){for(var B=I?new Uint8Array(32768):[],D=0,M=0;D<he.length-1;++D)for(;M<he[D+1];++M)B[M]=D;for(;M<32768;++M)B[M]=29;var U=I?new Uint8Array(259):[];for(D=0,M=0;D<oe.length-1;++D)for(;M<oe[D+1];++M)U[M]=D;function z(de,te){for(var ae=0;ae<de.length;){var ie=Math.min(65535,de.length-ae),_e=ae+ie==de.length;for(te.write_shift(1,+_e),te.write_shift(2,ie),te.write_shift(2,~ie&65535);ie-- >0;)te[te.l++]=de[ae++]}return te.l}function ne(de,te){for(var ae=0,ie=0,_e=I?new Uint16Array(32768):[];ie<de.length;){var Ee=Math.min(65535,de.length-ie);if(Ee<10){for(ae=Be(te,ae,+(ie+Ee==de.length)),ae&7&&(ae+=8-(ae&7)),te.l=ae/8|0,te.write_shift(2,Ee),te.write_shift(2,~Ee&65535);Ee-- >0;)te[te.l++]=de[ie++];ae=te.l*8;continue}ae=Be(te,ae,+(ie+Ee==de.length)+2);for(var De=0;Ee-- >0;){var je=de[ie];De=(De<<5^je)&32767;var Te=-1,Xe=0;if((Te=_e[De])&&(Te|=ie&-32768,Te>ie&&(Te-=32768),Te<ie))for(;de[Te+Xe]==de[ie+Xe]&&Xe<250;)++Xe;if(Xe>2){je=U[Xe],je<=22?ae=ve(te,ae,L[je+1]>>1)-1:(ve(te,ae,3),ae+=5,ve(te,ae,L[je-23]>>5),ae+=3);var St=je<8?0:je-4>>2;St>0&&(we(te,ae,Xe-oe[je]),ae+=St),je=B[ie-Te],ae=ve(te,ae,L[je]>>3),ae-=3;var Dt=je<4?0:je-2>>1;Dt>0&&(we(te,ae,ie-Te-he[je]),ae+=Dt);for(var jr=0;jr<Xe;++jr)_e[De]=ie&32767,De=(De<<5^de[ie])&32767,++ie;Ee-=Xe-1}else je<=143?je=je+48:ae=Ve(te,ae,1),ae=ve(te,ae,L[je]),_e[De]=ie&32767,++ie}ae=ve(te,ae,0)-1}return te.l=(ae+7)/8|0,te.l}return function(te,ae){return te.length<8?z(te,ae):ne(te,ae)}})();function ct(P){var B=re(50+Math.floor(P.length*1.1)),D=Ye(P,B);return B.slice(0,D)}var He=I?new Uint16Array(32768):Ce(32768),ut=I?new Uint16Array(32768):Ce(32768),wn=I?new Uint16Array(128):Ce(128),ti=1,Fn=1;function ga(P,B){var D=ye(P,B)+257;B+=5;var M=ye(P,B)+1;B+=5;var U=ke(P,B)+4;B+=4;for(var z=0,ne=I?new Uint8Array(19):Ce(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ae=I?new Uint8Array(8):Ce(8),ie=I?new Uint8Array(8):Ce(8),_e=ne.length,Ee=0;Ee<U;++Ee)ne[ee[Ee]]=z=se(P,B),te<z&&(te=z),ae[z]++,B+=3;var De=0;for(ae[0]=0,Ee=1;Ee<=te;++Ee)ie[Ee]=De=De+ae[Ee-1]<<1;for(Ee=0;Ee<_e;++Ee)(De=ne[Ee])!=0&&(de[Ee]=ie[De]++);var je=0;for(Ee=0;Ee<_e;++Ee)if(je=ne[Ee],je!=0){De=L[de[Ee]]>>8-je;for(var Te=(1<<7-je)-1;Te>=0;--Te)wn[De|Te<<je]=je&7|Ee<<3}var Xe=[];for(te=1;Xe.length<D+M;)switch(De=wn[Pe(P,B)],B+=De&7,De>>>=3){case 16:for(z=3+J(P,B),B+=2,De=Xe[Xe.length-1];z-- >0;)Xe.push(De);break;case 17:for(z=3+se(P,B),B+=3;z-- >0;)Xe.push(0);break;case 18:for(z=11+Pe(P,B),B+=7;z-- >0;)Xe.push(0);break;default:Xe.push(De),te<De&&(te=De);break}var St=Xe.slice(0,D),Dt=Xe.slice(D);for(Ee=D;Ee<286;++Ee)St[Ee]=0;for(Ee=M;Ee<30;++Ee)Dt[Ee]=0;return ti=me(St,He,286),Fn=me(Dt,ut,30),B}function bs(P,B){if(P[0]==3&&!(P[1]&3))return[ns(B),2];for(var D=0,M=0,U=z2(B||1<<18),z=0,ne=U.length>>>0,de=0,te=0;(M&1)==0;){if(M=se(P,D),D+=3,M>>>1)M>>1==1?(de=9,te=5):(D=ga(P,D),de=ti,te=Fn);else{D&7&&(D+=8-(D&7));var ae=P[D>>>3]|P[(D>>>3)+1]<<8;if(D+=32,ae>0)for(!B&&ne<z+ae&&(U=fe(U,z+ae),ne=U.length);ae-- >0;)U[z++]=P[D>>>3],D+=8;continue}for(;;){!B&&ne<z+32767&&(U=fe(U,z+32767),ne=U.length);var ie=ue(P,D,de),_e=M>>>1==1?We[ie]:He[ie];if(D+=_e&15,_e>>>=4,(_e>>>8&255)===0)U[z++]=_e;else{if(_e==256)break;_e-=257;var Ee=_e<8?0:_e-4>>2;Ee>5&&(Ee=0);var De=z+oe[_e];Ee>0&&(De+=ue(P,D,Ee),D+=Ee),ie=ue(P,D,te),_e=M>>>1==1?Oe[ie]:ut[ie],D+=_e&15,_e>>>=4;var je=_e<4?0:_e-2>>1,Te=he[_e];for(je>0&&(Te+=ue(P,D,je),D+=je),!B&&ne<De&&(U=fe(U,De+100),ne=U.length);z<De;)U[z]=U[z-Te],++z}}}return B?[U,D+7>>>3]:[U.slice(0,z),D+7>>>3]}function ec(P,B){var D=P.slice(P.l||0),M=bs(D,B);return P.l+=M[1],M[0]}function ge(P,B){if(P)typeof console<"u"&&console.error(B);else throw new Error(B)}function Ke(P,B){var D=P;Hr(D,0);var M=[],U=[],z={FileIndex:M,FullPaths:U};j(z,{root:B.root});for(var ne=D.length-4;(D[ne]!=80||D[ne+1]!=75||D[ne+2]!=5||D[ne+3]!=6)&&ne>=0;)--ne;D.l=ne+4,D.l+=4;var de=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,ne=0;ne<de;++ne){D.l+=20;var ae=D.read_shift(4),ie=D.read_shift(4),_e=D.read_shift(2),Ee=D.read_shift(2),De=D.read_shift(2);D.l+=8;var je=D.read_shift(4),Te=l(D.slice(D.l+_e,D.l+_e+Ee));D.l+=_e+Ee+De;var Xe=D.l;D.l=je+4,Te&&Te[1]&&((Te[1]||{}).usz&&(ie=Te[1].usz),(Te[1]||{}).csz&&(ae=Te[1].csz)),Ge(D,ae,ie,z,Te),D.l=Xe}return z}function Ge(P,B,D,M,U){P.l+=2;var z=P.read_shift(2),ne=P.read_shift(2),de=o(P);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var te=P.read_shift(4),ae=P.read_shift(4),ie=P.read_shift(4),_e=P.read_shift(2),Ee=P.read_shift(2),De="",je=0;je<_e;++je)De+=String.fromCharCode(P[P.l++]);if(Ee){var Te=l(P.slice(P.l,P.l+Ee));(Te[21589]||{}).mt&&(de=Te[21589].mt),(Te[1]||{}).usz&&(ie=Te[1].usz),(Te[1]||{}).csz&&(ae=Te[1].csz),U&&((U[21589]||{}).mt&&(de=U[21589].mt),(U[1]||{}).usz&&(ie=U[1].usz),(U[1]||{}).csz&&(ae=U[1].csz))}P.l+=Ee;var Xe=P.slice(P.l,P.l+ae);switch(ne){case 8:Xe=pe(P,ie);break;case 0:P.l+=ae;break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var St=!1;z&8&&(te=P.read_shift(4),te==134695760&&(te=P.read_shift(4),St=!0),ae=P.read_shift(4),ie=P.read_shift(4)),ae!=B&&ge(St,"Bad compressed size: "+B+" != "+ae),ie!=D&&ge(St,"Bad uncompressed size: "+D+" != "+ie),cn(M,De,Xe,{unsafe:!0,mt:de})}function ze(P,B){var D=B||{},M=[],U=[],z=re(1),ne=D.compression?8:0,de=0,te=0,ae=0,ie=0,_e=0,Ee=P.FullPaths[0],De=Ee,je=P.FileIndex[0],Te=[],Xe=0;for(te=1;te<P.FullPaths.length;++te)if(De=P.FullPaths[te].slice(Ee.length),je=P.FileIndex[te],!(!je.size||!je.content||Array.isArray(je.content)&&je.content.length==0||De=="Sh33tJ5")){var St=ie,Dt=re(De.length);for(ae=0;ae<De.length;++ae)Dt.write_shift(1,De.charCodeAt(ae)&127);Dt=Dt.slice(0,Dt.l),Te[_e]=typeof je.content=="string"?Z2.bstr(je.content,0):Z2.buf(je.content,0);var jr=typeof je.content=="string"?dn(je.content):je.content;ne==8&&(jr=Ne(jr)),z=re(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,de),z.write_shift(2,ne),je.mt?i(z,je.mt):z.write_shift(4,0),z.write_shift(-4,Te[_e]),z.write_shift(4,jr.length),z.write_shift(4,je.content.length),z.write_shift(2,Dt.length),z.write_shift(2,0),ie+=z.length,M.push(z),ie+=Dt.length,M.push(Dt),ie+=jr.length,M.push(jr),z=re(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,de),z.write_shift(2,ne),z.write_shift(4,0),z.write_shift(-4,Te[_e]),z.write_shift(4,jr.length),z.write_shift(4,je.content.length),z.write_shift(2,Dt.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,St),Xe+=z.l,U.push(z),Xe+=Dt.length,U.push(Dt),++_e}return z=re(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,_e),z.write_shift(2,_e),z.write_shift(4,Xe),z.write_shift(4,ie),z.write_shift(2,0),Vt([Vt(M),Vt(U),z])}var Qe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Fr(P,B){if(P.ctype)return P.ctype;var D=P.name||"",M=D.match(/\.([^\.]+)$/);return M&&Qe[M[1]]||B&&(M=(D=B).match(/[\.\\]([^\.\\])+$/),M&&Qe[M[1]])?Qe[M[1]]:"application/octet-stream"}function ln(P){for(var B=Yu(P),D=[],M=0;M<B.length;M+=76)D.push(B.slice(M,M+76));return D.join(`\r
`)+`\r
`}function Nn(P){var B=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var ie=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],M=B.split(`\r
`),U=0;U<M.length;++U){var z=M[U];if(z.length==0){D.push("");continue}for(var ne=0;ne<z.length;){var de=76,te=z.slice(ne,ne+de);te.charAt(de-1)=="="?de--:te.charAt(de-2)=="="?de-=2:te.charAt(de-3)=="="&&(de-=3),te=z.slice(ne,ne+de),ne+=de,ne<z.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function va(P){for(var B=[],D=0;D<P.length;++D){for(var M=P[D];D<=P.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+P[++D];B.push(M)}for(var U=0;U<B.length;++U)B[U]=B[U].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return dn(B.join(`\r
`))}function ri(P,B,D){for(var M="",U="",z="",ne,de=0;de<10;++de){var te=B[de];if(!te||te.match(/^\s*$/))break;var ae=te.match(/^([^:]*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":M=ae[2].trim();break;case"content-type":z=ae[2].trim();break;case"content-transfer-encoding":U=ae[2].trim();break}}switch(++de,U.toLowerCase()){case"base64":ne=dn(vi(B.slice(de).join("")));break;case"quoted-printable":ne=va(B.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ie=cn(P,M.slice(D.length),ne,{unsafe:!0});z&&(ie.ctype=z)}function ys(P,B){if(q(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=B&&B.root||"",M=(ot&&Buffer.isBuffer(P)?P.toString("binary"):q(P)).split(`\r
`),U=0,z="";for(U=0;U<M.length;++U)if(z=M[U],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),D||(D=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),z.slice(0,D.length)!=D););var ne=(M[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var de="--"+(ne[1]||""),te=[],ae=[],ie={FileIndex:te,FullPaths:ae};j(ie);var _e,Ee=0;for(U=0;U<M.length;++U){var De=M[U];De!==de&&De!==de+"--"||(Ee++&&ri(ie,M.slice(_e,U),D),_e=U)}return ie}function Ci(P,B){var D=B||{},M=D.boundary||"SheetJS";M="------="+M;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],z=P.FullPaths[0],ne=z,de=P.FileIndex[0],te=1;te<P.FullPaths.length;++te)if(ne=P.FullPaths[te].slice(z.length),de=P.FileIndex[te],!(!de.size||!de.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var ae=de.content,ie=ot&&Buffer.isBuffer(ae)?ae.toString("binary"):q(ae),_e=0,Ee=Math.min(1024,ie.length),De=0,je=0;je<=Ee;++je)(De=ie.charCodeAt(je))>=32&&De<128&&++_e;var Te=_e>=Ee*4/5;U.push(M),U.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ne),U.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),U.push("Content-Type: "+Fr(de,ne)),U.push(""),U.push(Te?Nn(ie):ln(ie))}return U.push(M+`--\r
`),U.join(`\r
`)}function Yn(P){var B={};return j(B,P),B}function cn(P,B,D,M){var U=M&&M.unsafe;U||j(P);var z=!U&&gt.find(P,B);if(!z){var ne=P.FullPaths[0];B.slice(0,ne.length)==ne?ne=B:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+B).replace("//","/")),z={name:a(B),type:2},P.FileIndex.push(z),P.FullPaths.push(ne),U||gt.utils.cfb_gc(P)}return z.content=D,z.size=D?D.length:0,M&&(M.CLSID&&(z.clsid=M.CLSID),M.mt&&(z.mt=M.mt),M.ct&&(z.ct=M.ct)),z}function _o(P,B){j(P);var D=gt.find(P,B);if(D){for(var M=0;M<P.FileIndex.length;++M)if(P.FileIndex[M]==D)return P.FileIndex.splice(M,1),P.FullPaths.splice(M,1),!0}return!1}function ba(P,B,D){j(P);var M=gt.find(P,B);if(M){for(var U=0;U<P.FileIndex.length;++U)if(P.FileIndex[U]==M)return P.FileIndex[U].name=a(D),P.FullPaths[U]=D,!0}return!1}function ws(P){k(P,!0)}return t.find=A,t.read=S,t.parse=u,t.write=Z,t.writeFile=Y,t.utils={cfb_new:Yn,cfb_add:cn,cfb_del:_o,cfb_mov:ba,cfb_gc:ws,ReadShift:Xo,CheckField:tC,prep_blob:Hr,bconcat:Vt,use_zlib:ce,_deflateRaw:ct,_inflateRaw:ec,consts:K},t})(),DX;function J2(e){return typeof e=="string"?h0(e):Array.isArray(e)?iX(e):e}function ql(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=h0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?bl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([J2(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+aX(new Uint8Array(J2(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=as(t)),c.write(t),c.close(),t}catch(d){if(!d.message||d.message.indexOf("onstruct")==-1)throw d}throw new Error("cannot save file "+e)}function Xt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Q2(e,t){for(var r=[],n=Xt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Dg(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function p0(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function IX(e){for(var t=[],r=Xt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var B4=Date.UTC(1899,11,30,0,0,0),RX=Date.UTC(1899,11,31,0,0,0),MX=Date.UTC(1904,0,1,0,0,0);function _r(e,t){var r=e.getTime(),n=(r-B4)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Gs(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+B4),t}var FX=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,LX=/^(\d+)-(\d+)-(\d+)$/,$4=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function an(e,t){if(e instanceof Date)return e;var r=e.match(FX);if(r)return new Date((t?MX:RX)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(LX),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match($4),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function Ig(e,t){if(ot&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function Rr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Rr(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function Da(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var BX=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,$X=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,UX=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,HX=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function zX(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function WX(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var VX=["january","february","march","april","may","june","july","august","september","october","november","december"];function td(e){if(UX.test(e))return e.indexOf("Z")==-1?x0(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(BX);if(n)return zX(n);if(n=r.match($X),n)return WX(n);if(n=r.match($4),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(HX&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),o=a.getYear();a.getMonth();var l=a.getDate();if(isNaN(l))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&VX.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return o<0||o>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}function io(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function x0(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function qe(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return ot?n=xa(r):n=sX(r),gt.utils.cfb_add(e,t,n)}gt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Rg(){return gt.utils.cfb_new()}var Zt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,KX={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Mg=Dg(KX),Fg=/[&<>'"]/g,GX=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Ze(e){var t=e+"";return t.replace(Fg,function(r){return Mg[r]}).replace(GX,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eN(e){return Ze(e).replace(/ /g,"_x0020_")}var U4=/[\u0000-\u001f]/g;function Tf(e){var t=e+"";return t.replace(Fg,function(r){return Mg[r]}).replace(/\n/g,"<br/>").replace(U4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function XX(e){var t=e+"";return t.replace(Fg,function(r){return Mg[r]}).replace(U4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function YX(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function qX(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function kf(e){for(var t="",r=0,n=0,a=0,i=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function tN(e){var t=ns(2*e.length),r,n,a=1,i=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function rN(e){return xa(e,"binary").toString("utf8")}var Pc="foo bar bazâð£",Xs=ot&&(rN(Pc)==kf(Pc)&&rN||tN(Pc)==kf(Pc)&&tN)||kf,bl=ot?function(e){return xa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ZX=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),H4=/(^\s|\s$|\n)/;function yr(e,t){return"<"+e+(t.match(H4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function yl(e){return Xt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Se(e,t,r){return"<"+e+(r!=null?yl(r):"")+(t!=null?(t.match(H4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function JX(e,t){switch(typeof e){case"string":var r=Se("vt:lpwstr",Ze(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Se((e|0)==e?"vt:i4":"vt:r8",Ze(String(e)));case"boolean":return Se("vt:bool",e?"true":"false")}if(e instanceof Date)return Se("vt:filetime",sp(e));throw new Error("Unable to serialize "+e)}var or={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],hn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function QX(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function eY(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,o=n?-t:t;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var nN=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},aN=ot?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xa(t)})):nN(e)}:nN,iN=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Wo(e,a)));return n.join("").replace(Go,"")},Lg=ot?function(e,t,r){return!Buffer.isBuffer(e)||!qu?iN(e,t,r):e.toString("utf16le",t,r).replace(Go,"")}:iN,sN=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},z4=ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sN(e,t,r)}:sN,oN=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Fs(e,a)));return n.join("")},Zl=ot?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):oN(t,r,n)}:oN,W4=function(e,t){var r=fn(e,t);return r>0?Zl(e,t+4,t+4+r-1):""},V4=W4,K4=function(e,t){var r=fn(e,t);return r>0?Zl(e,t+4,t+4+r-1):""},G4=K4,X4=function(e,t){var r=2*fn(e,t);return r>0?Zl(e,t+4,t+4+r-1):""},Y4=X4,q4=function(t,r){var n=fn(t,r);return n>0?Lg(t,r+4,r+4+n):""},Z4=q4,J4=function(e,t){var r=fn(e,t);return r>0?Zl(e,t+4,t+4+r):""},Q4=J4,eC=function(e,t){return QX(e,t)},rd=eC,Bg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ot&&(V4=function(t,r){if(!Buffer.isBuffer(t))return W4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},G4=function(t,r){if(!Buffer.isBuffer(t))return K4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Y4=function(t,r){if(!Buffer.isBuffer(t)||!qu)return X4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Z4=function(t,r){if(!Buffer.isBuffer(t)||!qu)return q4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Q4=function(t,r){if(!Buffer.isBuffer(t))return J4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},rd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):eC(t,r)},Bg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fs=function(e,t){return e[t]},Wo=function(e,t){return e[t+1]*256+e[t]},tY=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Mi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},rY=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xo(e,t){var r="",n,a,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,ot&&Buffer.isBuffer(this)&&qu)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Wo(this,d)),d+=2;e*=2;break;case"utf8":r=Zl(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Lg(this,this.l,this.l+e);break;case"wstr":return Xo.call(this,e,"dbcs");case"lpstr-ansi":r=V4(this,this.l),e=4+fn(this,this.l);break;case"lpstr-cp":r=G4(this,this.l),e=4+fn(this,this.l);break;case"lpwstr":r=Y4(this,this.l),e=4+2*fn(this,this.l);break;case"lpp4":e=4+fn(this,this.l),r=Z4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fn(this,this.l),r=Q4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Fs(this,this.l+e++))!==0;)i.push(kc(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Wo(this,this.l+e))!==0;)i.push(kc(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Fs(this,d),this.l=d+1,l=Xo.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(kc(Wo(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Fs(this,d),this.l=d+1,l=Xo.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(kc(Fs(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Fs(this,this.l),this.l++,n;case 2:return n=(t==="i"?tY:Wo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Mi:rY)(this,this.l),this.l+=4,n):(a=fn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=rd(this,this.l):a=rd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=z4(this,this.l,e);break}}return this.l+=e,r}var nY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},aY=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},iY=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function sY(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)iY(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,nY(this,t,this.l);break;case 8:if(n=8,r==="f"){eY(this,t,this.l);break}case 16:break;case-4:n=4,aY(this,t,this.l);break}return this.l+=n,this}function tC(e,t){var r=z4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Hr(e,t){e.l=t,e.read_shift=Xo,e.chk=tC,e.write_shift=sY}function pa(e,t){e.l+=t}function re(e){var t=ns(e);return Hr(t,0),t}function Dr(){var e=[],t=ot?16384:2048;ot&&re(t).copy;var r=function(u){var h=re(u);return Hr(h,0),h},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},o=function(){return a(),Vt(e)},l=function(){return a(),e},c=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:o,_bufs:e,end2:l}}function xe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=fte[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=e.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Bg(r)&&e.push(r)}}function Yo(e,t,r){var n=Rr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function lN(e,t,r){var n=Rr(e);return n.s=Yo(n.s,t.s,r),n.e=Yo(n.e,t.s,r),n}function qo(e,t){if(e.cRel&&e.c<0)for(e=Rr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Rr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Rt(e);return!e.cRel&&e.cRel!=null&&(r=cY(r)),!e.rRel&&e.rRel!=null&&(r=oY(r)),r}function Af(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ft(e.s.c)+":"+(e.e.cRel?"":"$")+ft(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+pt(e.s.r)+":"+(e.e.rRel?"":"$")+pt(e.e.r):qo(e.s,t.biff)+":"+qo(e.e,t.biff)}function $g(e){return parseInt(lY(e),10)-1}function pt(e){return""+(e+1)}function oY(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lY(e){return e.replace(/\$(\d+)$/,"$1")}function Ug(e){for(var t=uY(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ft(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function cY(e){return e.replace(/^([A-Z])/,"$$$1")}function uY(e){return e.replace(/^\$([A-Z])/,"$1")}function dY(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function At(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Nr(e){var t=e.indexOf(":");return t==-1?{s:At(e),e:At(e)}:{s:At(e.slice(0,t)),e:At(e.slice(t+1))}}function Yt(e,t){return typeof t>"u"||typeof t=="number"?Yt(e.s,e.e):(typeof e!="string"&&(e=Rt(e)),typeof t!="string"&&(t=Rt(t)),e==t?e:e+":"+t)}function wl(e){var t=Nr(e);return"$"+ft(t.s.c)+"$"+pt(t.s.r)+":$"+ft(t.e.c)+"$"+pt(t.e.r)}function Nl(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function jt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function cN(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Va(e.z,r?_r(t):t)}catch{}try{return e.w=Va((e.XF||{}).numFmtId||(r?14:0),r?_r(t):t)}catch{return""+t}}function Ka(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Gr[e.v]||e.v:t==null?cN(e,e.v):cN(e,t))}function bo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function hY(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function rC(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var o=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?At(n.origin):n.origin;o=c.r,l=c.c}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=jt(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=i["!ref"]?u.e.r+1:0)}else d.s.c=d.e.c=d.s.r=d.e.r=0;for(var h=[],f=!1,m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");var x=o+m;a&&(i["!data"][x]||(i["!data"][x]=[]),h=i["!data"][x]);for(var g=t[m],v=0;v!=g.length;++v)if(!(typeof g[v]>"u")){var b={v:g[v],t:""},w=l+v;if(d.s.r>x&&(d.s.r=x),d.s.c>w&&(d.s.c=w),d.e.r<x&&(d.e.r=x),d.e.c<w&&(d.e.c=w),f=!0,g[v]&&typeof g[v]=="object"&&!Array.isArray(g[v])&&!(g[v]instanceof Date))b=g[v];else if(Array.isArray(b.v)&&(b.f=g[v][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(n.nullError)b.t="e",b.v=0;else if(n.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?isFinite(b.v)?b.t="n":isNaN(b.v)?(b.t="e",b.v=15):(b.t="e",b.v=7):typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=n.dateNF||_t[14],n.UTC||(b.v=x0(b.v)),n.cellDates?(b.t="d",b.w=Va(b.z,_r(b.v,n.date1904))):(b.t="n",b.v=_r(b.v,n.date1904),b.w=Va(b.z,b.v))):b.t="s";if(a)h[w]&&h[w].z&&(b.z=h[w].z),h[w]=b;else{var y=ft(w)+(x+1);i[y]&&i[y].z&&(b.z=i[y].z),i[y]=b}}}return f&&d.s.c<104e5&&(i["!ref"]=Yt(d)),i}function yo(e,t){return rC(null,e,t)}function fY(e){return e.read_shift(4,"i")}function Kn(e,t){return t||(t=re(4)),t.write_shift(4,e),t}function Ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function er(e,t){var r=!1;return t==null&&(r=!0,t=re(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function mY(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function pY(e,t){return t||(t=re(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Hg(e,t){var r=e.l,n=e.read_shift(1),a=Ir(e),i=[],o={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(mY(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function xY(e,t){var r=!1;return t==null&&(r=!0,t=re(15+4*e.t.length)),t.write_shift(1,0),er(e.t,t),r?t.slice(0,t.l):t}var gY=Hg;function vY(e,t){var r=!1;return t==null&&(r=!0,t=re(23+4*e.t.length)),t.write_shift(1,1),er(e.t,t),t.write_shift(4,1),pY({},t),r?t.slice(0,t.l):t}function Mn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ps(e,t){return t==null&&(t=re(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function xs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function gs(e,t){return t==null&&(t=re(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var bY=Ir,nC=er;function g0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function _l(e,t){var r=!1;return t==null&&(r=!0,t=re(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var yY=Ir,op=g0,zg=_l;function Wg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?rd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Mi(t,0)>>2;return r?a/100:a}function aC(e,t){t==null&&(t=re(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function iC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function wY(e,t){return t||(t=re(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var vs=iC,wo=wY;function No(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ss(e,t){return(t||re(8)).write_shift(8,e,"f")}function NY(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=PY[a];d&&(t.rgb=wN(d));break;case 2:t.rgb=wN([o,l,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function nd(e,t){if(t||(t=re(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function _Y(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jY(e,t){t||(t=re(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var sC=2,un=3,Oc=11,ad=19,Dc=64,SY=65,EY=71,CY=4108,TY=4126,vr=80,uN={1:{n:"CodePage",t:sC},2:{n:"Category",t:vr},3:{n:"PresentationFormat",t:vr},4:{n:"ByteCount",t:un},5:{n:"LineCount",t:un},6:{n:"ParagraphCount",t:un},7:{n:"SlideCount",t:un},8:{n:"NoteCount",t:un},9:{n:"HiddenCount",t:un},10:{n:"MultimediaClipCount",t:un},11:{n:"ScaleCrop",t:Oc},12:{n:"HeadingPairs",t:CY},13:{n:"TitlesOfParts",t:TY},14:{n:"Manager",t:vr},15:{n:"Company",t:vr},16:{n:"LinksUpToDate",t:Oc},17:{n:"CharacterCount",t:un},19:{n:"SharedDoc",t:Oc},22:{n:"HyperlinksChanged",t:Oc},23:{n:"AppVersion",t:un,p:"version"},24:{n:"DigSig",t:SY},26:{n:"ContentType",t:vr},27:{n:"ContentStatus",t:vr},28:{n:"Language",t:vr},29:{n:"Version",t:vr},255:{},2147483648:{n:"Locale",t:ad},2147483651:{n:"Behavior",t:ad},1919054434:{}},dN={1:{n:"CodePage",t:sC},2:{n:"Title",t:vr},3:{n:"Subject",t:vr},4:{n:"Author",t:vr},5:{n:"Keywords",t:vr},6:{n:"Comments",t:vr},7:{n:"Template",t:vr},8:{n:"LastAuthor",t:vr},9:{n:"RevNumber",t:vr},10:{n:"EditTime",t:Dc},11:{n:"LastPrinted",t:Dc},12:{n:"CreatedDate",t:Dc},13:{n:"ModifiedDate",t:Dc},14:{n:"PageCount",t:un},15:{n:"WordCount",t:un},16:{n:"CharCount",t:un},17:{n:"Thumbnail",t:EY},18:{n:"Application",t:vr},19:{n:"DocSecurity",t:un},255:{},2147483648:{n:"Locale",t:ad},2147483651:{n:"Behavior",t:ad},1919054434:{}};function kY(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var AY=kY([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),PY=Rr(AY),Gr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},la={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},OY=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],DY={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ic={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function oC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lC(e,t,r){var n=IX(DY),a=[],i;a[a.length]=Zt,a[a.length]=Se("Types",null,{xmlns:or.CT,"xmlns:xsd":or.xsd,"xmlns:xsi":or.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Se("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){e[d]&&e[d].length>0&&(i=e[d][0],a[a.length]=Se("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ic[d][t.bookType]||Ic[d].xlsx}))},l=function(d){(e[d]||[]).forEach(function(u){a[a.length]=Se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ic[d][t.bookType]||Ic[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(u){a[a.length]=Se("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[d][0]})})};return o("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cC(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ys(e){var t=[Zt,Se("Relationships",null,{xmlns:or.RELS})];return Xt(e["!id"]).forEach(function(r){t[t.length]=Se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function it(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function IY(e){var t=[Zt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function hN(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function RY(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function MY(e){var t=[Zt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(hN(e[r][0],e[r][1])),t.push(RY("",e[r][0]));return t.push(hN("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function uC(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xu.version+"</meta:generator></office:meta></office:document-meta>"}var Wi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Pf(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ze(t),n[n.length]=r?Se(e,t,r):yr(e,t))}function dC(e,t){var r=t||{},n=[Zt,Se("cp:coreProperties",null,{"xmlns:cp":or.CORE_PROPS,"xmlns:dc":or.dc,"xmlns:dcterms":or.dcterms,"xmlns:dcmitype":or.dcmitype,"xmlns:xsi":or.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Pf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:sp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Pf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:sp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Wi.length;++i){var o=Wi[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Pf(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fC(e){var t=[],r=Se;return e||(e={}),e.Application="SheetJS",t[t.length]=Zt,t[t.length]=Se("Properties",null,{xmlns:or.EXT_PROPS,"xmlns:vt":or.vt}),qs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ze(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ze(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function mC(e){var t=[Zt,Se("Properties",null,{xmlns:or.CUST_PROPS,"xmlns:vt":or.vt})];if(!e)return t.join("");var r=1;return Xt(e).forEach(function(a){++r,t[t.length]=Se("property",JX(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ze(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function FY(e,t){var r=[];return Xt(fN).map(function(n){for(var a=0;a<Wi.length;++a)if(Wi[a][1]==n)return Wi[a];for(a=0;a<qs.length;++a)if(qs[a][1]==n)return qs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(yr(fN[n[1]]||n[1],a))}}),Se("DocumentProperties",r.join(""),{xmlns:hn.o})}function LY(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Xt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Wi.length;++o)if(i==Wi[o][1])return;for(o=0;o<qs.length;++o)if(i==qs[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Se(eN(i),l,{"dt:dt":c}))}}),t&&Xt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Se(eN(i),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+hn.o+'">'+a.join("")+"</"+n+">"}function BY(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=re(8);return o.write_shift(4,n),o.write_shift(4,a),o}function mN(e,t){var r=re(4),n=re(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=re(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=BY(t);break;case 31:case 80:for(n=re(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vt([r,n])}var pC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $Y(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function pN(e,t,r){var n=re(8),a=[],i=[],o=8,l=0,c=re(8),d=re(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),a.push(d),o+=8+c.length,!t){d=re(8),d.write_shift(4,0),a.unshift(d);var u=[re(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(c=re(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Vt(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(pC.indexOf(e[l][0])>-1||hC.indexOf(e[l][0])>-1)&&e[l][1]!=null){var f=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}c=mN(x.t,f)}else{var v=$Y(f);v==-1&&(v=31,f=String(f)),c=mN(v,f)}i.push(c),d=re(8),d.write_shift(4,t?m:2+l),a.push(d),o+=8+c.length}var b=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,b),b+=i[l].length;return n.write_shift(4,o),n.write_shift(4,i.length),Vt([n].concat(a).concat(i))}function xN(e,t,r,n,a,i){var o=re(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,gt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=pN(e,r,n);if(l.push(c),a){var d=pN(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Vt(l)}function UY(e,t){t||(t=re(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function HY(e,t){return e.read_shift(t)===1}function kr(e,t){return t||(t=re(2)),t.write_shift(2,+!!e),t}function Gc(e){return e.read_shift(2,"u")}function Tn(e,t){return t||(t=re(2)),t.write_shift(2,e),t}function xC(e,t,r){return r||(r=re(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function gC(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=ja;if(r&&r.biff>=8&&(ja=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return ja=i,l}function zY(e){var t=e.t||"",r=re(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=re(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Vt(a)}function WY(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function VY(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):WY(e,n,r)}function KY(e,t,r){if(r.biff>5)return VY(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function vC(e,t,r){return r||(r=re(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function gN(e,t){t||(t=re(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function GY(e){var t=re(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)n=n.slice(1),gN(n,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&gN(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function os(e,t,r,n){return n||(n=re(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function XY(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,i,o]}function YY(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function bC(e,t){return t||(t=re(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Vg(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=re(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function qY(e,t){var r=!t||t.biff==8,n=re(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function ZY(e,t){var r=!t||t.biff>=8?2:1,n=re(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function JY(e,t){var r=re(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=zY(e[a]);var i=Vt([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function QY(){var e=re(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function eq(e){var t=re(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function tq(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=re(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function rq(e,t,r,n){var a=re(10);return os(e,t,n,a),a.write_shift(4,r),a}function nq(e,t,r,n,a){var i=!a||a.biff==8,o=re(8+ +i+(1+i)*r.length);return os(e,t,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function aq(e,t,r,n){var a=r&&r.biff==5;n||(n=re(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function iq(e){var t=re(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function sq(e){var t=re(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function oq(e,t){var r=t.biff==8||!t.biff?4:2,n=re(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function vN(e,t,r,n){var a=r&&r.biff==5;n||(n=re(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function lq(e){var t=re(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function yC(e){var t=re(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var cq=yC;function uq(e){var t=re(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Of(e,t,r,n,a,i){var o=re(8);return os(e,t,n,o),xC(r,i,o),o}function dq(e,t,r,n){var a=re(14);return os(e,t,n,a),ss(r,a),a}function hq(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return bN(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(XY(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function bN(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=gC(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Df(e,t,r,n){var a=re(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function fq(e){var t=re(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)bC(e[r],t);return t}function mq(e){var t=re(24),r=At(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Vt([t,GY(e[1])])}function pq(e){var t=e[1].Tooltip,r=re(10+2*(t.length+1));r.write_shift(2,2048);var n=At(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function xq(e){return e||(e=re(4)),e.write_shift(2,1),e.write_shift(2,1),e}function gq(e,t,r){if(!r.cellStyles)return pa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function vq(e,t){var r=re(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function bq(e){for(var t=re(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Jl(e,t,r,n,a){return e||(e=re(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function yq(e,t,r,n,a){var i=re(15);return Jl(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function wq(e,t,r,n,a){var i=re(9);return Jl(i,e,t,n||0,a||0),i.write_shift(2,r),i}var Nq=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Dg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=ns(1);switch(c.type){case"base64":u=dn(vi(l));break;case"binary":u=dn(l);break;case"buffer":case"array":u=l;break}Hr(u,0);var h=u.read_shift(1),f=!!(h&136),m=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,f=!0;break;case 49:m=!0,f=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,v=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(v=u.read_shift(2));var b=u.read_shift(2);c.codepage,h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&e[u[u.l]],u.l+=1,u.l+=2),x&&(u.l+=36);for(var w=[],y={},N=Math.min(u.length,h==2?521:v-10-(m?264:0)),_=x?32:11;u.l<N&&u[u.l]!=13;)switch(y={},y.name=as(u.slice(u.l,u.l+_)).replace(/[\u0000\r\n][\S\s]*$/g,""),u.l+=_,y.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(y.offset=u.read_shift(4)),y.len=u.read_shift(1),h==2&&(y.offset=u.read_shift(2)),y.dec=u.read_shift(1),y.name.length&&w.push(y),h!=2&&(u.l+=x?13:14),y.type){case"B":(!m||y.len!=8)&&c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+y.name+":"+y.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+y.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var S=0,j=0;for(d[0]=[],j=0;j!=w.length;++j)d[0][j]=w[j].name;for(;g-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,d[++S]=[],j=0,j=0;j!=w.length;++j){var E=u.slice(u.l,u.l+w[j].len);u.l+=w[j].len,Hr(E,0);var k=as(E);switch(w[j].type){case"C":k.trim().length&&(d[S][j]=k.replace(/([^\s])\s+$/,"$1"));break;case"D":k.length===8?(d[S][j]=new Date(Date.UTC(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8),0,0,0,0)),c&&c.UTC||(d[S][j]=io(d[S][j]))):d[S][j]=k;break;case"F":d[S][j]=parseFloat(k.trim());break;case"+":case"I":d[S][j]=x?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":d[S][j]=!0;break;case"N":case"F":d[S][j]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));d[S][j]="##MEMO##"+(x?parseInt(k.trim(),10):E.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(d[S][j]=+k||0);break;case"@":d[S][j]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":{var T=E.read_shift(4),A=E.read_shift(4);if(T==0&&A==0)break;d[S][j]=new Date((T-2440588)*864e5+A),c&&c.UTC||(d[S][j]=io(d[S][j]))}break;case"Y":d[S][j]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[S][j]=-E.read_shift(-8,"f");break;case"B":if(m&&w[j].len==8){d[S][j]=E.read_shift(8,"f");break}case"G":case"P":E.l+=w[j].len;break;case"0":if(w[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[j].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=w,d}function n(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=yo(r(l,d),d);return u["!cols"]=d.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete d.DBF,u}function a(l,c){try{var d=bo(n(l,c),c);return d.bookType="dbf",d}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var d=c||{},u=ja;if(+d.codepage>=0&&vl(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=Dr(),f=dp(l,{header:1,raw:!0,cellDates:!0}),m=f[0],x=f.slice(1),g=l["!cols"]||[],v=0,b=0,w=0,y=1;for(v=0;v<m.length;++v){if(((g[v]||{}).DBF||{}).name){m[v]=g[v].DBF.name,++w;continue}if(m[v]!=null){if(++w,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(b=0;b<1024;++b)if(m.indexOf(m[v]+"_"+b)==-1){m[v]+="_"+b;break}}}}var N=jt(l["!ref"]),_=[],S=[],j=[];for(v=0;v<=N.e.c-N.s.c;++v){var E="",k="",T=0,A=[];for(b=0;b<x.length;++b)x[b][v]!=null&&A.push(x[b][v]);if(A.length==0||m[v]==null){_[v]="?";continue}for(b=0;b<A.length;++b){switch(typeof A[b]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=A[b]instanceof Date?"D":"C";break;default:k="C"}T=Math.max(T,String(A[b]).length),E=E&&E!=k?"C":k}T>250&&(T=250),k=((g[v]||{}).DBF||{}).type,k=="C"&&g[v].DBF.len>T&&(T=g[v].DBF.len),E=="B"&&k=="N"&&(E="N",j[v]=g[v].DBF.dec,T=g[v].DBF.len),S[v]=E=="C"||k=="N"?T:i[E]||0,y+=S[v],_[v]=E}var C=h.next(32);for(C.write_shift(4,318902576),C.write_shift(4,x.length),C.write_shift(2,296+32*w),C.write_shift(2,y),v=0;v<4;++v)C.write_shift(4,0);var R=+t[ja]||3;for(C.write_shift(4,0|R<<8),e[R]!=+d.codepage&&(d.codepage&&console.error("DBF Unsupported codepage "+ja+", using 1252"),ja=1252),v=0,b=0;v<m.length;++v)if(m[v]!=null){var G=h.next(32),V=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,V,"sbcs"),G.write_shift(1,_[v]=="?"?"C":_[v],"sbcs"),G.write_shift(4,b),G.write_shift(1,S[v]||i[_[v]]||0),G.write_shift(1,j[v]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),b+=S[v]||i[_[v]]||0}var X=h.next(264);for(X.write_shift(4,13),v=0;v<65;++v)X.write_shift(4,0);for(v=0;v<x.length;++v){var K=h.next(y);for(K.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(_[b]){case"L":K.write_shift(1,x[v][b]==null?63:x[v][b]?84:70);break;case"B":K.write_shift(8,x[v][b]||0,"f");break;case"N":var Y="0";for(typeof x[v][b]=="number"&&(Y=x[v][b].toFixed(j[b]||0)),Y.length>S[b]&&(Y=Y.slice(0,S[b])),w=0;w<S[b]-Y.length;++w)K.write_shift(1,32);K.write_shift(1,Y,"sbcs");break;case"D":x[v][b]?(K.write_shift(4,("0000"+x[v][b].getFullYear()).slice(-4),"sbcs"),K.write_shift(2,("00"+(x[v][b].getMonth()+1)).slice(-2),"sbcs"),K.write_shift(2,("00"+x[v][b].getDate()).slice(-2),"sbcs")):K.write_shift(8,"00000000","sbcs");break;case"C":var q=K.l,Z=String(x[v][b]!=null?x[v][b]:"").slice(0,S[b]);for(K.write_shift(1,Z,"cpstr"),q+=S[b]-K.l,w=0;w<q;++w)K.write_shift(1,32);break}}return ja=u,h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),_q=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Xt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+Xt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(m,x){var g=e[x];return typeof g=="number"?H2(g):g},n=function(m,x,g){var v=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?m:H2(v)};e["|"]=254;var a=function(m){return m.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(m,x){switch(x.type){case"base64":return o(vi(m),x);case"binary":return o(m,x);case"buffer":return o(ot&&Buffer.isBuffer(m)?m.toString("binary"):as(m),x);case"array":return o(Ig(m),x)}throw new Error("Unrecognized type "+x.type)}function o(m,x){var g=m.split(/[\n\r]+/),v=-1,b=-1,w=0,y=0,N=[],_=[],S=null,j={},E=[],k=[],T=[],A=0,C,R={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&vl(+x.codepage);w!==g.length;++w){A=0;var G=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=G.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),X=V[0],K;if(G.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"V":{var Y=parseInt(V[y].slice(1),10);Y>=1&&Y<=4&&(R.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":V[1].charAt(0)==="P"&&_.push(G.slice(3).replace(/;;/g,";"));break;case"NN":{var q={Sheet:0};for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"N":q.Name=V[y].slice(1);break;case"E":q.Ref=(x&&x.sheet||"Sheet1")+"!"+jN(V[y].slice(1));break}R.Workbook.Names.push(q)}break;case"C":var Z=!1,le=!1,ce=!1,pe=!1,Ne=-1,ee=-1,oe="",he="z",O="";for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":O=V[y].slice(1);break;case"X":b=parseInt(V[y].slice(1),10)-1,le=!0;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,le||(b=0),C=N.length;C<=v;++C)N[C]=[];break;case"K":K=V[y].slice(1),K.charAt(0)==='"'?(K=K.slice(1,K.length-1),he="s"):K==="TRUE"||K==="FALSE"?(K=K==="TRUE",he="b"):K.charAt(0)=="#"&&la[K]!=null?(he="e",K=la[K]):isNaN(Da(K))||(K=Da(K),he="n",S!==null&&is(S)&&x.cellDates&&(K=Gs(R.Workbook.WBProps.date1904?K+1462:K),he=typeof K=="number"?"n":"d")),Z=!0;break;case"E":pe=!0,oe=jN(V[y].slice(1),{r:v,c:b});break;case"S":ce=!0;break;case"G":break;case"R":Ne=parseInt(V[y].slice(1),10)-1;break;case"C":ee=parseInt(V[y].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}if(Z&&(N[v][b]?(N[v][b].t=he,N[v][b].v=K):N[v][b]={t:he,v:K},S&&(N[v][b].z=S),x.cellText!==!1&&S&&(N[v][b].w=Va(N[v][b].z,N[v][b].v,{date1904:R.Workbook.WBProps.date1904})),S=null),ce){if(pe)throw new Error("SYLK shared formula cannot have own formula");var I=Ne>-1&&N[Ne][ee];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");oe=jZ(I[1],{r:v-Ne,c:b-ee})}oe&&(N[v][b]?N[v][b].f=oe:N[v][b]={t:"n",f:oe}),O&&(N[v][b]||(N[v][b]={t:"z"}),N[v][b].c=[{a:"SheetJSYLK",t:O}]);break;case"F":var L=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":b=parseInt(V[y].slice(1),10)-1,++L;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,C=N.length;C<=v;++C)N[C]=[];break;case"M":A=parseInt(V[y].slice(1),10)/20;break;case"F":break;case"G":break;case"P":S=_[parseInt(V[y].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(T=V[y].slice(1).split(" "),C=parseInt(T[0],10);C<=parseInt(T[1],10);++C)A=parseInt(T[2],10),k[C-1]=A===0?{hidden:!0}:{wch:A};break;case"C":b=parseInt(V[y].slice(1),10)-1,k[b]||(k[b]={});break;case"R":v=parseInt(V[y].slice(1),10)-1,E[v]||(E[v]={}),A>0?(E[v].hpt=A,E[v].hpx=jC(A)):A===0&&(E[v].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}L<1&&(S=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+G)}}return E.length>0&&(j["!rows"]=E),k.length>0&&(j["!cols"]=k),k.forEach(function(F){Kg(F)}),x&&x.sheetRows&&(N=N.slice(0,x.sheetRows)),[N,j,R]}function l(m,x){var g=i(m,x),v=g[0],b=g[1],w=g[2],y=Rr(x);y.date1904=(((w||{}).Workbook||{}).WBProps||{}).date1904;var N=yo(v,y);Xt(b).forEach(function(S){N[S]=b[S]});var _=bo(N,x);return Xt(w).forEach(function(S){_[S]=w[S]}),_.bookType="sylk",_}function c(m,x,g,v,b,w){var y="C;Y"+(g+1)+";X"+(v+1)+";K";switch(m.t){case"n":y+=isFinite(m.v)?m.v||0:Gr[isNaN(m.v)?36:7],m.f&&!m.F&&(y+=";E"+b0(m.f,{r:g,c:v}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||Gr[m.v]||m.v;break;case"d":y+=_r(an(m.v,w),w);break;case"s":y+='"'+(m.v==null?"":String(m.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function d(m,x,g){var v="C;Y"+(x+1)+";X"+(g+1)+";A";return v+=a(m.map(function(b){return b.t}).join("")),v}function u(m,x){x.forEach(function(g,v){var b="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?b+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=id(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=sd(g.wpx)),typeof g.wch=="number"&&(b+=Math.round(g.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function h(m,x){x.forEach(function(g,v){var b="F;";g.hidden?b+="M0;":g.hpt?b+="M"+20*g.hpt+";":g.hpx&&(b+="M"+20*od(g.hpx)+";"),b.length>2&&m.push(b+"R"+(v+1))})}function f(m,x,g){x||(x={}),x._formats=["General"];var v=["ID;PSheetJS;N;E"],b=[],w=jt(m["!ref"]||"A1"),y,N=m["!data"]!=null,_=`\r
`,S=(((g||{}).Workbook||{}).WBProps||{}).date1904,j="General";v.push("P;PGeneral");var E=w.s.r,k=w.s.c,T=[];if(m["!ref"]){for(E=w.s.r;E<=w.e.r;++E)if(!(N&&!m["!data"][E])){for(T=[],k=w.s.c;k<=w.e.c;++k)y=N?m["!data"][E][k]:m[ft(k)+pt(E)],!(!y||!y.c)&&T.push(d(y.c,E,k));T.length&&b.push(T.join(_))}}if(m["!ref"]){for(E=w.s.r;E<=w.e.r;++E)if(!(N&&!m["!data"][E])){for(T=[],k=w.s.c;k<=w.e.c;++k)if(y=N?m["!data"][E][k]:m[ft(k)+pt(E)],!(!y||y.v==null&&(!y.f||y.F))){if((y.z||(y.t=="d"?_t[14]:"General"))!=j){var A=x._formats.indexOf(y.z);A==-1&&(x._formats.push(y.z),A=x._formats.length-1,v.push("P;P"+y.z.replace(/;/g,";;"))),T.push("F;P"+A+";Y"+(E+1)+";X"+(k+1))}T.push(c(y,m,E,k,x,S))}b.push(T.join(_))}}return v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&h(v,m["!rows"]),m["!ref"]&&v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" ")),v.push("O;L;D;B"+(S?";V4":"")+";K47;G100 0.001"),delete x._formats,v.join(_)+_+b.join(_)+_+"E"+_}return{to_workbook:l,from_sheet:f}})(),jq=(function(){function e(l,c){switch(c.type){case"base64":return t(vi(l),c);case"binary":return t(l,c);case"buffer":return t(ot&&Buffer.isBuffer(l)?l.toString("binary"):as(l),c);case"array":return t(Ig(l),c)}throw new Error("Unrecognized type "+c.type)}function t(l,c){for(var d=l.split(`
`),u=-1,h=-1,f=0,m=[];f!==d.length;++f){if(d[f].trim()==="BOT"){m[++u]=[],h=0;continue}if(!(u<0)){var x=d[f].trim().split(","),g=x[0],v=x[1];++f;for(var b=d[f]||"";(b.match(/["]/g)||[]).length&1&&f<d.length-1;)b+=`
`+d[++f];switch(b=b.trim(),+g){case-1:if(b==="BOT"){m[++u]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?m[u][h]=!0:b==="FALSE"?m[u][h]=!1:isNaN(Da(v))?isNaN(td(v).getDate())?m[u][h]=v:(m[u][h]=an(v),c&&c.UTC||(m[u][h]=io(m[u][h]))):m[u][h]=Da(v),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),m[u][h++]=b!==""?b:null;break}if(b==="EOD")break}}return c&&c.sheetRows&&(m=m.slice(0,c.sheetRows)),m}function r(l,c){return yo(e(l,c),c)}function n(l,c){var d=bo(r(l,c),c);return d.bookType="dif",d}function a(l,c){return"0,"+String(l)+`\r
`+c}function i(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function o(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var c=jt(l["!ref"]),d=l["!data"]!=null,u=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],h=c.s.r;h<=c.e.r;++h){for(var f=d?l["!data"][h]:[],m=`-1,0\r
BOT\r
`,x=c.s.c;x<=c.e.c;++x){var g=d?f&&f[x]:l[Rt({r:h,c:x})];if(g==null){m+=`1,0\r
""\r
`;continue}switch(g.t){case"n":g.w!=null?m+="0,"+g.w+`\r
V`:g.v!=null?m+=a(g.v,"V"):g.f!=null&&!g.F?m+=i("="+g.f):m+=`1,0\r
""`;break;case"b":m+=g.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":m+=i(isNaN(+g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Va(g.z||_t[14],_r(an(g.v)))),m+=a(g.w,"V");break;default:m+=`1,0\r
""`}m+=`\r
`}u.push(m)}return u.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:o}})(),wC=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var m=h.split(`
`),x=-1,g=-1,v=0,b=[];v!==m.length;++v){var w=m[v].trim().split(":");if(w[0]==="cell"){var y=At(w[1]);if(b.length<=y.r)for(x=b.length;x<=y.r;++x)b[x]||(b[x]=[]);switch(x=y.r,g=y.c,w[2]){case"t":b[x][g]=e(w[3]);break;case"v":b[x][g]=+w[3];break;case"vtf":var N=w[w.length-1];case"vtc":w[3]==="nl"?b[x][g]=!!+w[4]:b[x][g]=w[w.length-1].charAt(0)=="#"?{t:"e",v:la[w[w.length-1]]}:+w[4],w[2]=="vtf"&&(b[x][g]=[b[x][g],N])}}}return f&&f.sheetRows&&(b=b.slice(0,f.sheetRows)),b}function n(h,f){return yo(r(h,f),f)}function a(h,f){return bo(n(h,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(h){if(!h||!h["!ref"])return"";for(var f=[],m=[],x,g="",v=Nr(h["!ref"]),b=h["!data"]!=null,w=v.s.r;w<=v.e.r;++w)for(var y=v.s.c;y<=v.e.c;++y)if(g=Rt({r:w,c:y}),x=b?(h["!data"][w]||[])[y]:h[g],!(!x||x.v==null||x.t==="z")){switch(m=["cell",g,"t"],x.t){case"s":m.push(t(x.v));break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=_r(an(x.v));m[2]="vtc",m[3]="nd",m[4]=""+N,m[5]=x.w||Va(x.z||_t[14],N);break;case"n":isFinite(x.v)?x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v):(m[2]="vt"+(x.f?"f":"c"),m[3]="e"+Gr[isNaN(x.v)?36:7],m[4]="0",m[5]=x.f||m[3].slice(1),m[6]="e",m[7]=m[3].slice(1));break;case"e":continue}f.push(m.join(":"))}return f.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[i,o,l,o,d(h),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}})(),Sq=(function(){function e(u,h,f,m,x){x.raw?h[f][m]=u:u===""||(u==="TRUE"?h[f][m]=!0:u==="FALSE"?h[f][m]=!1:isNaN(Da(u))?isNaN(td(u).getDate())?u.charCodeAt(0)==35&&la[u]!=null?h[f][m]={t:"e",v:la[u],w:u}:h[f][m]=u:h[f][m]=an(u):h[f][m]=Da(u))}function t(u,h){var f=h||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var v=10,b=0,w=0;w<=g;++w)b=x[w].indexOf(" "),b==-1?b=x[w].length:b++,v=Math.max(v,b);for(w=0;w<=g;++w){m[w]=[];var y=0;for(e(x[w].slice(0,v).trim(),m,w,y,f),y=1;y<=(x[w].length-v)/10+1;++y)e(x[w].slice(v+(y-1)*10,v+y*10).trim(),m,w,y,f)}return f.sheetRows&&(m=m.slice(0,f.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var h={},f=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?f=!f:!f&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m]);if(!x.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m])}return x.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[x.pop()[1]]||44}function i(u,h){var f=h||{},m="",x={};f.dense&&(x["!data"]=[]);var g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=a(u.slice(0,1024)):f&&f.FS?m=f.FS:m=a(u.slice(0,1024));var v=0,b=0,w=0,y=0,N=0,_=m.charCodeAt(0),S=!1,j=0,E=u.charCodeAt(0),k=f.dateNF!=null?kX(f.dateNF):null;function T(){var A=u.slice(y,N);A.slice(-1)=="\r"&&(A=A.slice(0,-1));var C={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),f.cellText!==!1&&(C.w=A),A.length===0)C.t="z";else if(f.raw)C.t="s",C.v=A;else if(A.trim().length===0)C.t="s",C.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(C.t="s",C.v=A.slice(2,-1).replace(/""/g,'"')):SZ(A)?(C.t="s",C.f=A.slice(1),C.v=A):(C.t="s",C.v=A);else if(A=="TRUE")C.t="b",C.v=!0;else if(A=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=Da(A)))C.t="n",C.v=w;else if(!isNaN((w=td(A)).getDate())||k&&A.match(k)){if(C.z=f.dateNF||_t[14],k&&A.match(k)){var R=AX(A,f.dateNF,A.match(k)||[]);w=an(R),f&&f.UTC===!1&&(w=io(w))}else f&&f.UTC===!1?w=io(w):f.cellText!==!1&&f.dateNF&&(C.w=Va(C.z,w));f.cellDates?(C.t="d",C.v=w):(C.t="n",C.v=_r(w)),f.cellNF||delete C.z}else A.charCodeAt(0)==35&&la[A]!=null?(C.t="e",C.w=A,C.v=la[A]):(C.t="s",C.v=A);if(C.t=="z"||(f.dense?(x["!data"][v]||(x["!data"][v]=[]),x["!data"][v][b]=C):x[Rt({c:b,r:v})]=C),y=N+1,E=u.charCodeAt(y),g.e.c<b&&(g.e.c=b),g.e.r<v&&(g.e.r=v),j==_)++b;else if(b=0,++v,f.sheetRows&&f.sheetRows<=v)return!0}e:for(;N<u.length;++N)switch(j=u.charCodeAt(N)){case 34:E===34&&(S=!S);break;case 13:if(S)break;u.charCodeAt(N+1)==10&&++N;case _:case 10:if(!S&&T())break e;break}return N-y>0&&T(),x["!ref"]=Yt(g),x}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):yo(t(u,h),h)}function l(u,h){var f="",m=h.type=="string"?[0,0,0,0]:Jte(u,h);switch(h.type){case"base64":f=vi(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):(h.codepage,f=ot&&Buffer.isBuffer(u)?u.toString("binary"):as(u));break;case"array":f=Ig(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?f=Xs(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Xs(f):h.type=="binary",f.slice(0,19)=="socialcalc:version:"?wC.to_sheet(h.type=="string"?f:Xs(f),h):o(f,h)}function c(u,h){return bo(l(u,h),h)}function d(u){var h=[];if(!u["!ref"])return"";for(var f=jt(u["!ref"]),m,x=u["!data"]!=null,g=f.s.r;g<=f.e.r;++g){for(var v=[],b=f.s.c;b<=f.e.c;++b){var w=Rt({r:g,c:b});if(m=x?(u["!data"][g]||[])[b]:u[w],!m||m.v==null){v.push("          ");continue}for(var y=(m.w||(Ka(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(b===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}})(),yN=(function(){function e(O,I,L){if(O){Hr(O,O.l||0);for(var F=L.Enum||pe;O.l<O.length;){var W=O.read_shift(2),J=F[W]||F[65535],se=O.read_shift(2),ke=O.l+se,ye=J.f&&J.f(O,se,L);if(O.l=ke,I(ye,J,W))return}}}function t(O,I){switch(I.type){case"base64":return n(dn(vi(O)),I);case"binary":return n(dn(O),I);case"buffer":case"array":return n(O,I)}throw"Unsupported type "+I.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(O,I){if(!O)return O;var L=I||{},F={},W="Sheet1",J="",se=0,ke={},ye=[],Pe=[],ue=[];L.dense&&(ue=F["!data"]=[]);var Be={s:{r:0,c:0},e:{r:0,c:0}},Ve=L.sheetRows||0,ve={};if(O[4]==81&&O[5]==80&&O[6]==87)return he(O,I);if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)L.Enum=pe,e(O,function(me,We,Oe){switch(Oe){case 0:L.vers=me,me>=4096&&(L.qpro=!0);break;case 255:L.vers=me,L.works=!0;break;case 6:Be=me;break;case 204:me&&(J=me);break;case 222:J=me;break;case 15:case 51:(!L.qpro&&!L.works||Oe==51)&&me[1].v.charCodeAt(0)<48&&(me[1].v=me[1].v.slice(1)),(L.works||L.works2)&&(me[1].v=me[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=L.dateNF||r[(me[2]&15)-1]||_t[14],L.cellDates&&(me[1].v=Gs(me[1].v),me[1].t=typeof me[1].v=="number"?"n":"d")),L.qpro&&me[3]>se&&(F["!ref"]=Yt(Be),ke[W]=F,ye.push(W),F={},L.dense&&(ue=F["!data"]=[]),Be={s:{r:0,c:0},e:{r:0,c:0}},se=me[3],W=J||"Sheet"+(se+1),J="");var Ae=L.dense?(ue[me[0].r]||[])[me[0].c]:F[Rt(me[0])];if(Ae){Ae.t=me[1].t,Ae.v=me[1].v,me[1].z!=null&&(Ae.z=me[1].z),me[1].f!=null&&(Ae.f=me[1].f),ve=Ae;break}L.dense?(ue[me[0].r]||(ue[me[0].r]=[]),ue[me[0].r][me[0].c]=me[1]):F[Rt(me[0])]=me[1],ve=me[1];break;case 21509:L.works2=!0;break;case 21506:me==5281&&(ve.z="hh:mm:ss",L.cellDates&&ve.t=="n"&&(ve.v=Gs(ve.v),ve.t=typeof ve.v=="number"?"n":"d"));break}},L);else if(O[2]==26||O[2]==14)L.Enum=Ne,O[2]==14&&(L.qpro=!0,O.l=0),e(O,function(me,We,Oe){switch(Oe){case 204:W=me;break;case 22:me[1].v.charCodeAt(0)<48&&(me[1].v=me[1].v.slice(1)),me[1].v=me[1].v.replace(/\x0F./g,function(Ae){return String.fromCharCode(Ae.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>se&&(F["!ref"]=Yt(Be),ke[W]=F,ye.push(W),F={},L.dense&&(ue=F["!data"]=[]),Be={s:{r:0,c:0},e:{r:0,c:0}},se=me[3],W="Sheet"+(se+1)),Ve>0&&me[0].r>=Ve)break;L.dense?(ue[me[0].r]||(ue[me[0].r]=[]),ue[me[0].r][me[0].c]=me[1]):F[Rt(me[0])]=me[1],Be.e.c<me[0].c&&(Be.e.c=me[0].c),Be.e.r<me[0].r&&(Be.e.r=me[0].r);break;case 27:me[14e3]&&(Pe[me[14e3][0]]=me[14e3][1]);break;case 1537:Pe[me[0]]=me[1],me[0]==se&&(W=me[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(F["!ref"]=Yt(Be),ke[J||W]=F,ye.push(J||W),!Pe.length)return{SheetNames:ye,Sheets:ke};for(var we={},fe=[],Ce=0;Ce<Pe.length;++Ce)ke[ye[Ce]]?(fe.push(Pe[Ce]||ye[Ce]),we[Pe[Ce]]=ke[Pe[Ce]]||ke[ye[Ce]]):(fe.push(Pe[Ce]),we[Pe[Ce]]={"!ref":"A1"});return{SheetNames:fe,Sheets:we}}function a(O,I){var L=I||{};if(+L.codepage>=0&&vl(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var F=Dr();if(!O["!ref"])throw new Error("Cannot export empty sheet to WK1");var W=jt(O["!ref"]),J=O["!data"]!=null,se=[];be(F,0,o(1030)),be(F,6,d(W));for(var ke=Math.min(W.e.r,8191),ye=W.s.c;ye<=W.e.c;++ye)se[ye]=ft(ye);for(var Pe=W.s.r;Pe<=ke;++Pe){var ue=pt(Pe);for(ye=W.s.c;ye<=W.e.c;++ye){var Be=J?(O["!data"][Pe]||[])[ye]:O[se[ye]+ue];if(!(!Be||Be.t=="z"))switch(Be.t){case"n":(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?be(F,13,v(Pe,ye,Be)):be(F,14,w(Pe,ye,Be));break;case"d":var Ve=_r(Be.v);(Ve|0)==Ve&&Ve>=-32768&&Ve<=32767?be(F,13,v(Pe,ye,{v:Ve,z:Be.z||_t[14]})):be(F,14,w(Pe,ye,{v:Ve,z:Be.z||_t[14]}));break;default:var ve=Ka(Be);be(F,15,m(Pe,ye,ve.slice(0,239)))}}}return be(F,1),F.end()}function i(O,I){var L=I||{};if(+L.codepage>=0&&vl(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var F=Dr();be(F,0,l(O));for(var W=0,J=0;W<O.SheetNames.length;++W)(O.Sheets[O.SheetNames[W]]||{})["!ref"]&&be(F,27,ce(O.SheetNames[W],J++));var se=0;for(W=0;W<O.SheetNames.length;++W){var ke=O.Sheets[O.SheetNames[W]];if(!(!ke||!ke["!ref"])){for(var ye=jt(ke["!ref"]),Pe=ke["!data"]!=null,ue=[],Be=Math.min(ye.e.r,8191),Ve=ye.s.r;Ve<=Be;++Ve)for(var ve=pt(Ve),we=ye.s.c;we<=ye.e.c;++we){Ve===ye.s.r&&(ue[we]=ft(we));var fe=ue[we]+ve,Ce=Pe?(ke["!data"][Ve]||[])[we]:ke[fe];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")be(F,23,R(Ve,we,se,Ce.v));else{var me=Ka(Ce);be(F,22,T(Ve,we,se,me.slice(0,239)))}}++se}}return be(F,1),F.end()}function o(O){var I=re(2);return I.write_shift(2,O),I}function l(O){var I=re(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var L=0,F=0,W=0,J=0;J<O.SheetNames.length;++J){var se=O.SheetNames[J],ke=O.Sheets[se];if(!(!ke||!ke["!ref"])){++W;var ye=Nr(ke["!ref"]);L<ye.e.r&&(L=ye.e.r),F<ye.e.c&&(F=ye.e.c)}}return L>8191&&(L=8191),I.write_shift(2,L),I.write_shift(1,W),I.write_shift(1,F),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function c(O,I,L){var F={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&L.qpro?(F.s.c=O.read_shift(1),O.l++,F.s.r=O.read_shift(2),F.e.c=O.read_shift(1),O.l++,F.e.r=O.read_shift(2),F):(F.s.c=O.read_shift(2),F.s.r=O.read_shift(2),I==12&&L.qpro&&(O.l+=2),F.e.c=O.read_shift(2),F.e.r=O.read_shift(2),I==12&&L.qpro&&(O.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function d(O){var I=re(8);return I.write_shift(2,O.s.c),I.write_shift(2,O.s.r),I.write_shift(2,O.e.c),I.write_shift(2,O.e.r),I}function u(O,I,L){var F=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(F[0].c=O.read_shift(1),F[3]=O.read_shift(1),F[0].r=O.read_shift(2),O.l+=2):L.works?(F[0].c=O.read_shift(2),F[0].r=O.read_shift(2),F[2]=O.read_shift(2)):(F[2]=O.read_shift(1),F[0].c=O.read_shift(2),F[0].r=O.read_shift(2)),F}function h(O){return O.z&&is(O.z)?240|(r.indexOf(O.z)+1||2):255}function f(O,I,L){var F=O.l+I,W=u(O,I,L);if(W[1].t="s",(L.vers&65534)==20768){O.l++;var J=O.read_shift(1);return W[1].v=O.read_shift(J,"utf8"),W}return L.qpro&&O.l++,W[1].v=O.read_shift(F-O.l,"cstr"),W}function m(O,I,L){var F=re(7+L.length);F.write_shift(1,255),F.write_shift(2,I),F.write_shift(2,O),F.write_shift(1,39);for(var W=0;W<F.length;++W){var J=L.charCodeAt(W);F.write_shift(1,J>=128?95:J)}return F.write_shift(1,0),F}function x(O,I,L){var F=O.l+I,W=u(O,I,L);if(W[1].t="s",L.vers==20768){var J=O.read_shift(1);return W[1].v=O.read_shift(J,"utf8"),W}return W[1].v=O.read_shift(F-O.l,"cstr"),W}function g(O,I,L){var F=u(O,I,L);return F[1].v=O.read_shift(2,"i"),F}function v(O,I,L){var F=re(7);return F.write_shift(1,h(L)),F.write_shift(2,I),F.write_shift(2,O),F.write_shift(2,L.v,"i"),F}function b(O,I,L){var F=u(O,I,L);return F[1].v=O.read_shift(8,"f"),F}function w(O,I,L){var F=re(13);return F.write_shift(1,h(L)),F.write_shift(2,I),F.write_shift(2,O),F.write_shift(8,L.v,"f"),F}function y(O,I,L){var F=O.l+I,W=u(O,I,L);if(W[1].v=O.read_shift(8,"f"),L.qpro)O.l=F;else{var J=O.read_shift(2);j(O.slice(O.l,O.l+J),W),O.l+=J}return W}function N(O,I,L){var F=I&32768;return I&=-32769,I=(F?O:0)+(I>=8192?I-16384:I),(F?"":"$")+(L?ft(I):pt(I))}var _={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(O,I){Hr(O,0);for(var L=[],F=0,W="",J="",se="",ke="";O.l<O.length;){var ye=O[O.l++];switch(ye){case 0:L.push(O.read_shift(8,"f"));break;case 1:J=N(I[0].c,O.read_shift(2),!0),W=N(I[0].r,O.read_shift(2),!1),L.push(J+W);break;case 2:{var Pe=N(I[0].c,O.read_shift(2),!0),ue=N(I[0].r,O.read_shift(2),!1);J=N(I[0].c,O.read_shift(2),!0),W=N(I[0].r,O.read_shift(2),!1),L.push(Pe+ue+":"+J+W)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(O.read_shift(2));break;case 6:{for(var Be="";ye=O[O.l++];)Be+=String.fromCharCode(ye);L.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ke=L.pop(),se=L.pop(),L.push(["AND","OR"][ye-20]+"("+se+","+ke+")");break;default:if(ye<32&&S[ye])ke=L.pop(),se=L.pop(),L.push(se+S[ye]+ke);else if(_[ye]){if(F=_[ye][1],F==69&&(F=O[O.l++]),F>L.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+L.join("|")+"|");return}var Ve=L.slice(-F);L.length-=F,L.push(_[ye][0]+"("+Ve.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}L.length==1?I[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function E(O){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=O.read_shift(2),I[3]=O[O.l++],I[0].c=O[O.l++],I}function k(O,I){var L=E(O);return L[1].t="s",L[1].v=O.read_shift(I-4,"cstr"),L}function T(O,I,L,F){var W=re(6+F.length);W.write_shift(2,O),W.write_shift(1,L),W.write_shift(1,I),W.write_shift(1,39);for(var J=0;J<F.length;++J){var se=F.charCodeAt(J);W.write_shift(1,se>=128?95:se)}return W.write_shift(1,0),W}function A(O,I){var L=E(O);L[1].v=O.read_shift(2);var F=L[1].v>>1;if(L[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return L[1].v=F,L}function C(O,I){var L=E(O),F=O.read_shift(4),W=O.read_shift(4),J=O.read_shift(2);if(J==65535)return F===0&&W===3221225472?(L[1].t="e",L[1].v=15):F===0&&W===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var se=J&32768;return J=(J&32767)-16446,L[1].v=(1-se*2)*(W*Math.pow(2,J+32)+F*Math.pow(2,J)),L}function R(O,I,L,F){var W=re(14);if(W.write_shift(2,O),W.write_shift(1,L),W.write_shift(1,I),F==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var J=0,se=0,ke=0,ye=0;return F<0&&(J=1,F=-F),se=Math.log2(F)|0,F/=Math.pow(2,se-31),ye=F>>>0,(ye&2147483648)==0&&(F/=2,++se,ye=F>>>0),F-=ye,ye|=2147483648,ye>>>=0,F*=Math.pow(2,32),ke=F>>>0,W.write_shift(4,ke),W.write_shift(4,ye),se+=16383+(J?32768:0),W.write_shift(2,se),W}function G(O,I){var L=C(O);return O.l+=I-14,L}function V(O,I){var L=E(O),F=O.read_shift(4);return L[1].v=F>>6,L}function X(O,I){var L=E(O),F=O.read_shift(8,"f");return L[1].v=F,L}function K(O,I){var L=X(O);return O.l+=I-12,L}function Y(O,I){return O[O.l+I-1]==0?O.read_shift(I,"cstr"):""}function q(O,I){var L=O[O.l++];L>I-1&&(L=I-1);for(var F="";F.length<L;)F+=String.fromCharCode(O[O.l++]);return F}function Z(O,I,L){if(!(!L.qpro||I<21)){var F=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var W=O.read_shift(I-21,"cstr");return[F,W]}}function le(O,I){for(var L={},F=O.l+I;O.l<F;){var W=O.read_shift(2);if(W==14e3){for(L[W]=[0,""],L[W][0]=O.read_shift(2);O[O.l];)L[W][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return L}function ce(O,I){var L=re(5+O.length);L.write_shift(2,14e3),L.write_shift(2,I);for(var F=0;F<O.length;++F){var W=O.charCodeAt(F);L[L.l++]=W>127?95:W}return L[L.l++]=0,L}var pe={0:{n:"BOF",f:Gc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:b},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:q},255:{n:"BOF",f:Gc},21506:{n:"WKSNF",f:Gc},65535:{n:""}},Ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},ee={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function oe(O){var I=O.read_shift(2),L=O.read_shift(1);if(L!=0)throw"unsupported QPW string type "+L.toString(16);return O.read_shift(I,"sbcs-cont")}function he(O,I){Hr(O,0);var L=I||{},F={};L.dense&&(F["!data"]=[]);var W=[],J="",se={s:{r:-1,c:-1},e:{r:-1,c:-1}},ke=0,ye=0,Pe=0,ue=0,Be={SheetNames:[],Sheets:{}},Ve=[];e:for(;O.l<O.length;){var ve=O.read_shift(2),we=O.read_shift(2),fe=O.slice(O.l,O.l+we);switch(Hr(fe,0),ve){case 1:if(fe.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Ce=fe.read_shift(4),me=(fe.length-fe.l)/Ce|0,We=0;We<Ce;++We){var Oe=fe.l+me,Ae={};fe.l+=2,Ae.numFmtId=fe.read_shift(2),ee[Ae.numFmtId]&&(Ae.z=ee[Ae.numFmtId]),fe.l=Oe,Ve.push(Ae)}break;case 1025:break;case 1026:break;case 1031:for(fe.l+=12;fe.l<fe.length;)ke=fe.read_shift(2),ye=fe.read_shift(1),W.push(fe.read_shift(ke,"cstr"));break;case 1032:break;case 1537:{var Ye=fe.read_shift(2);F={},L.dense&&(F["!data"]=[]),se.s.c=fe.read_shift(2),se.e.c=fe.read_shift(2),se.s.r=fe.read_shift(4),se.e.r=fe.read_shift(4),fe.l+=4,fe.l+2<fe.length&&(ke=fe.read_shift(2),ye=fe.read_shift(1),J=ke==0?"":fe.read_shift(ke,"cstr")),J||(J=ft(Ye))}break;case 1538:{if(se.s.c>255||se.s.r>999999)break;se.e.c<se.s.c&&(se.e.c=se.s.c),se.e.r<se.s.r&&(se.e.r=se.s.r),F["!ref"]=Yt(se),Zg(Be,F,J)}break;case 2561:Pe=fe.read_shift(2),se.e.c<Pe&&(se.e.c=Pe),se.s.c>Pe&&(se.s.c=Pe),ue=fe.read_shift(4),se.s.r>ue&&(se.s.r=ue),ue=fe.read_shift(4),se.e.r<ue&&(se.e.r=ue);break;case 3073:{ue=fe.read_shift(4),ke=fe.read_shift(4),se.s.r>ue&&(se.s.r=ue),se.e.r<ue+ke-1&&(se.e.r=ue+ke-1);for(var ct=ft(Pe);fe.l<fe.length;){var He={t:"z"},ut=fe.read_shift(1),wn=-1;ut&128&&(wn=fe.read_shift(2));var ti=ut&64?fe.read_shift(2)-1:0;switch(ut&31){case 0:break;case 1:break;case 2:He={t:"n",v:fe.read_shift(2)};break;case 3:He={t:"n",v:fe.read_shift(2,"i")};break;case 4:He={t:"n",v:Wg(fe)};break;case 5:He={t:"n",v:fe.read_shift(8,"f")};break;case 7:He={t:"s",v:W[ye=fe.read_shift(4)-1]};break;case 8:He={t:"n",v:fe.read_shift(8,"f")},fe.l+=2,fe.l+=4,isNaN(He.v)&&(He={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(ut&31)}wn!=-1&&(Ve[wn-1]||{}).z&&(He.z=Ve[wn-1].z);var Fn=0;if(ut&32)switch(ut&31){case 2:Fn=fe.read_shift(2);break;case 3:Fn=fe.read_shift(2,"i");break;case 7:Fn=fe.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(ut&31)}if(!(!L.sheetStubs&&He.t=="z")){var ga=Rr(He);He.t=="n"&&He.z&&is(He.z)&&L.cellDates&&(ga.v=Gs(He.v),ga.t=typeof ga.v=="number"?"n":"d"),F["!data"]!=null?(F["!data"][ue]||(F["!data"][ue]=[]),F["!data"][ue][Pe]=ga):F[ct+pt(ue)]=ga}for(++ue,--ke;ti-- >0&&ke>=0;){if(ut&32)switch(ut&31){case 2:He={t:"n",v:He.v+Fn&65535};break;case 3:He={t:"n",v:He.v+Fn&65535},He.v>32767&&(He.v-=65536);break;case 7:He={t:"s",v:W[ye=ye+Fn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(ut&31)}else switch(ut&31){case 1:He={t:"z"};break;case 2:He={t:"n",v:fe.read_shift(2)};break;case 7:He={t:"s",v:W[ye=fe.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(ut&31)}!L.sheetStubs&&He.t=="z"||(F["!data"]!=null?(F["!data"][ue]||(F["!data"][ue]=[]),F["!data"][ue][Pe]=He):F[ct+pt(ue)]=He),++ue,--ke}}}break;case 3074:{Pe=fe.read_shift(2),ue=fe.read_shift(4);var bs=oe(fe);F["!data"]!=null?(F["!data"][ue]||(F["!data"][ue]=[]),F["!data"][ue][Pe]={t:"s",v:bs}):F[ft(Pe)+pt(ue)]={t:"s",v:bs}}break}O.l+=we}return Be}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})(),Eq=/^\s|\s$|[\t\n\r]/;function Cq(e,t){if(!t.bookSST)return"";var r=[Zt];r[r.length]=Se("sst",null,{xmlns:vo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(Eq)&&(i+=' xml:space="preserve"'),i+=">"+Ze(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Tq(e){return[e.read_shift(4),e.read_shift(4)]}function kq(e,t){return t||(t=re(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Aq=xY;function Pq(e){var t=Dr();xe(t,159,kq(e));for(var r=0;r<e.length;++r)xe(t,19,Aq(e[r]));return xe(t,160),t.end()}function Oq(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function NC(e){var t=0,r,n=Oq(e),a=n.length+1,i,o,l,c,d;for(r=ns(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],l=(t&16384)===0?0:1,c=t<<1&32767,d=l|c,t=d^o;return t^52811}function Dq(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=jt(e["!ref"]),a,i=e["!data"]!=null,o=[],l=n.s.r;l<=n.e.r;++l){r.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),i&&(o=e["!data"][l]||[]),c=n.s.c;c<=n.e.c;++c){var d=Rt({r:l,c});if(a=i?o[c]:e[d],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(Ka(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function wN(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Iq=6,Ia=Iq;function id(e){return Math.floor((e+Math.round(128/Ia)/256)*Ia)}function sd(e){return Math.floor((e-5)/Ia*100+.5)/100}function lp(e){return Math.round((e*Ia+5)/Ia*256)/256}function Kg(e){e.width?(e.wpx=id(e.width),e.wch=sd(e.wpx),e.MDW=Ia):e.wpx?(e.wch=sd(e.wpx),e.width=lp(e.wch),e.MDW=Ia):typeof e.wch=="number"&&(e.width=lp(e.wch),e.wpx=id(e.width),e.MDW=Ia),e.customWidth&&delete e.customWidth}var Rq=96,_C=Rq;function od(e){return e*96/_C}function jC(e){return e*_C/96}function Mq(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Se("numFmt",null,{numFmtId:n,formatCode:Ze(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Fq(e){var t=[];return t[t.length]=Se("cellXfs",null),e.forEach(function(r){t[t.length]=Se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Lq(e,t){var r=[Zt,Se("styleSheet",null,{xmlns:vo[0],"xmlns:vt":or.vt})],n;return e.SSF&&(n=Mq(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Fq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Bq(e,t){var r=e.read_shift(2),n=Ir(e);return[r,n]}function $q(e,t,r){r||(r=re(6+4*t.length)),r.write_shift(2,e),er(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Uq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=_Y(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=NY(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ir(e),n}function Hq(e,t){t||(t=re(153)),t.write_shift(2,e.sz*20),jY(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nd(e.color,t);var n=0;return n=2,t.write_shift(1,n),er(e.name,t),t.length>t.l?t.slice(0,t.l):t}var zq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],If,Wq=pa;function NN(e,t){t||(t=re(84)),If||(If=Dg(zq));var r=If[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(nd({auto:1},t),nd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Vq(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function SC(e,t,r){r||(r=re(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bo(e,t){return t||(t=re(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Kq=pa;function Gq(e,t){return t||(t=re(51)),t.write_shift(1,0),Bo(null,t),Bo(null,t),Bo(null,t),Bo(null,t),Bo(null,t),t.length>t.l?t.slice(0,t.l):t}function Xq(e,t){return t||(t=re(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_l(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Yq(e,t,r){var n=re(2052);return n.write_shift(4,e),_l(t,n),_l(r,n),n.length>n.l?n.slice(0,n.l):n}function qq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(xe(e,615,Kn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&xe(e,44,$q(a,t[a]))}),xe(e,616))}}function Zq(e){var t=1;xe(e,611,Kn(t)),xe(e,43,Hq({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(e,612)}function Jq(e){var t=2;xe(e,603,Kn(t)),xe(e,45,NN({patternType:"none"})),xe(e,45,NN({patternType:"gray125"})),xe(e,604)}function Qq(e){var t=1;xe(e,613,Kn(t)),xe(e,46,Gq()),xe(e,614)}function eZ(e){var t=1;xe(e,626,Kn(t)),xe(e,47,SC({numFmtId:0},65535)),xe(e,627)}function tZ(e,t){xe(e,617,Kn(t.length)),t.forEach(function(r){xe(e,47,SC(r,0))}),xe(e,618)}function rZ(e){var t=1;xe(e,619,Kn(t)),xe(e,48,Xq({xfId:0,name:"Normal"})),xe(e,620)}function nZ(e){var t=0;xe(e,505,Kn(t)),xe(e,506)}function aZ(e){var t=0;xe(e,508,Yq(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function iZ(e,t){var r=Dr();return xe(r,278),qq(r,e.SSF),Zq(r),Jq(r),Qq(r),eZ(r),tZ(r,t.cellXfs),rZ(r),nZ(r),aZ(r),xe(r,279),r.end()}function EC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Zt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function sZ(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ir(e)}}function oZ(e){var t=re(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),er(e.name,t),t.slice(0,t.l)}function lZ(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function cZ(e){var t=re(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function uZ(e,t){var r=re(8+2*t.length);return r.write_shift(4,e),er(t,r),r.slice(0,r.l)}function dZ(e){return e.l+=4,e.read_shift(4)!=0}function hZ(e,t){var r=re(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fZ(){var e=Dr();return xe(e,332),xe(e,334,Kn(1)),xe(e,335,oZ({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,uZ(1,"XLDAPR")),xe(e,52),xe(e,35,Kn(514)),xe(e,4096,Kn(0)),xe(e,4097,Tn(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,hZ(1)),xe(e,51,cZ([[1,0]])),xe(e,338),xe(e,333),e.end()}function mZ(){var e=[Zt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function pZ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Rt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function CC(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Se("xml",null,{"xmlns:v":hn.v,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:mv":hn.mv}).replace(/\/>/,">"),Se("o:shapelayout",Se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],o=65536*e,l=t||[];return l.length>0&&i.push(Se("v:shapetype",[Se("v:stroke",null,{joinstyle:"miter"}),Se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),l.forEach(function(c){++o,i.push(xZ(c,o))}),i.push("</xml>"),i.join("")}function xZ(e,t,r){var n=At(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Se("v:fill",i,a),l={on:"t",obscured:"t"};return["<v:shape"+yl({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Se("v:shadow",null,l),Se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yr("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),yr("x:AutoFill","False"),yr("x:Row",String(n.r)),yr("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function gZ(e){var t=[Zt,Se("comments",null,{xmlns:vo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Ze(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],o=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(d){d.a&&(a=r.indexOf(Ze(d.a))),d.T&&++o,i.push(d.t==null?"":Ze(d.t))}),o===0)n[1].forEach(function(d){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Ze(d.a))+'"><text>'),t.push(yr("t",d.t==null?"":Ze(d.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(yr("t",Ze(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function TC(e,t,r){var n=[Zt,Se("ThreadedComments",null,{xmlns:or.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Se("threadedComment",yr("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function kC(e){var t=[Zt,Se("personList",null,{xmlns:or.TCMNT,"xmlns:x":vo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function vZ(e){var t={};t.iauthor=e.read_shift(4);var r=vs(e);return t.rfx=r.s,t.ref=Rt(r.s),e.l+=16,t}function bZ(e,t){return t==null&&(t=re(36)),t.write_shift(4,e[1].iauthor),wo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var yZ=Ir;function _N(e){return er(e.slice(0,54))}function wZ(e){var t=Dr(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),xe(t,632,_N(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),xe(t,632,_N("tc="+a.ID))))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var o={s:At(n[0]),e:At(n[0])};xe(t,635,bZ([o,a])),a.t&&a.t.length>0&&xe(t,637,vY(a)),xe(t,636),delete a.iauthor})}),xe(t,634),xe(t,629),t.end()}function NZ(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var _Z=["xlsb","xlsm","xlam","biff8","xla"],jN=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,a+(l?"":"$")+ft(u)+(c?"":"$")+pt(d)}return function(a,i){return t=i,a.replace(e,r)}})(),v0=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{v0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var b0=(function(){return function(t,r){return t.replace(v0,function(n,a,i,o,l,c){var d=Ug(o)-(i?0:r.c),u=$g(c)-(l?0:r.r),h=l=="$"?u+1:u==0?"":"["+u+"]",f=i=="$"?d+1:d==0?"":"["+d+"]";return a+"R"+h+"C"+f})}})();function jZ(e,t){return e.replace(v0,function(r,n,a,i,o,l){return n+(a=="$"?a+i:ft(Ug(i)+t.c))+(o=="$"?o+l:pt($g(l)+t.r))})}function SZ(e){return e.length!=1}function zt(e){e.l+=1}function bi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function AC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return PC(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),o=bi(e),l=bi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function PC(e){var t=bi(e),r=bi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function EZ(e,t,r){if(r.biff<8)return PC(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=bi(e),o=bi(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function OC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return CZ(e);var n=e.read_shift(r&&r.biff==12?4:2),a=bi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function CZ(e){var t=bi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function TZ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kZ(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return AZ(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function AZ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function PZ(e,t,r){var n=(e[e.l++]&96)>>5,a=AC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function OZ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=AC(e,i,r);return[n,a,o]}function DZ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function IZ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function RZ(e,t,r){var n=(e[e.l++]&96)>>5,a=EZ(e,t-1,r);return[n,a]}function MZ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function SN(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function FZ(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function LZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function BZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $Z(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function UZ(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function DC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function HZ(e){return e.read_shift(2),DC(e)}function zZ(e){return e.read_shift(2),DC(e)}function WZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=OC(e,0,r);return[n,a]}function VZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kZ(e,0,r);return[n,a]}function KZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=OC(e,0,r);return[n,a,i]}function GZ(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[aQ[a],MC[a],n]}function XZ(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:YZ(e);return[a,(i[0]===0?MC:nQ)[i[1]]]}function YZ(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qZ(e,t,r){e.l+=r&&r.biff==2?3:4}function ZZ(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function JZ(e){return e.l++,Gr[e.read_shift(1)]}function QZ(e){return e.l++,e.read_shift(2)}function eJ(e){return e.l++,e.read_shift(1)!==0}function tJ(e){return e.l++,No(e)}function rJ(e,t,r){return e.l++,gC(e,t-1,r)}function nJ(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=HY(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Gr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=No(e);break;case 2:r[1]=KY(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function aJ(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?vs:YY)(e));return a}function iJ(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=nJ(e,r.biff);return o}function sJ(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function oJ(e,t,r){if(r.biff==5)return lJ(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function lJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function cJ(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function uJ(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function dJ(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function hJ(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var fJ=pa,mJ=pa,pJ=pa;function Ql(e,t,r){return e.l+=2,[TZ(e)]}function Gg(e){return e.l+=6,[]}var xJ=Ql,gJ=Gg,vJ=Gg,bJ=Ql;function IC(e){return e.l+=2,[Gc(e),e.read_shift(2)&1]}var yJ=Ql,wJ=IC,NJ=Gg,_J=Ql,jJ=Ql,SJ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function EJ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),o=SJ[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:i}}function CJ(e){return e.l+=2,[e.read_shift(4)]}function TJ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function kJ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function AJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function PJ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function OJ(e){return e.l+=4,[0,0]}var EN={1:{n:"PtgExp",f:ZZ},2:{n:"PtgTbl",f:pJ},3:{n:"PtgAdd",f:zt},4:{n:"PtgSub",f:zt},5:{n:"PtgMul",f:zt},6:{n:"PtgDiv",f:zt},7:{n:"PtgPower",f:zt},8:{n:"PtgConcat",f:zt},9:{n:"PtgLt",f:zt},10:{n:"PtgLe",f:zt},11:{n:"PtgEq",f:zt},12:{n:"PtgGe",f:zt},13:{n:"PtgGt",f:zt},14:{n:"PtgNe",f:zt},15:{n:"PtgIsect",f:zt},16:{n:"PtgUnion",f:zt},17:{n:"PtgRange",f:zt},18:{n:"PtgUplus",f:zt},19:{n:"PtgUminus",f:zt},20:{n:"PtgPercent",f:zt},21:{n:"PtgParen",f:zt},22:{n:"PtgMissArg",f:zt},23:{n:"PtgStr",f:rJ},26:{n:"PtgSheet",f:TJ},27:{n:"PtgEndSheet",f:kJ},28:{n:"PtgErr",f:JZ},29:{n:"PtgBool",f:eJ},30:{n:"PtgInt",f:QZ},31:{n:"PtgNum",f:tJ},32:{n:"PtgArray",f:MZ},33:{n:"PtgFunc",f:GZ},34:{n:"PtgFuncVar",f:XZ},35:{n:"PtgName",f:sJ},36:{n:"PtgRef",f:WZ},37:{n:"PtgArea",f:PZ},38:{n:"PtgMemArea",f:cJ},39:{n:"PtgMemErr",f:fJ},40:{n:"PtgMemNoMem",f:mJ},41:{n:"PtgMemFunc",f:uJ},42:{n:"PtgRefErr",f:dJ},43:{n:"PtgAreaErr",f:DZ},44:{n:"PtgRefN",f:VZ},45:{n:"PtgAreaN",f:RZ},46:{n:"PtgMemAreaN",f:AJ},47:{n:"PtgMemNoMemN",f:PJ},57:{n:"PtgNameX",f:oJ},58:{n:"PtgRef3d",f:KZ},59:{n:"PtgArea3d",f:OZ},60:{n:"PtgRefErr3d",f:hJ},61:{n:"PtgAreaErr3d",f:IZ},255:{}},DJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},IJ={1:{n:"PtgElfLel",f:IC},2:{n:"PtgElfRw",f:_J},3:{n:"PtgElfCol",f:xJ},6:{n:"PtgElfRwV",f:jJ},7:{n:"PtgElfColV",f:bJ},10:{n:"PtgElfRadical",f:yJ},11:{n:"PtgElfRadicalS",f:NJ},13:{n:"PtgElfColS",f:gJ},15:{n:"PtgElfColSV",f:vJ},16:{n:"PtgElfRadicalLel",f:wJ},25:{n:"PtgList",f:EJ},29:{n:"PtgSxName",f:CJ},255:{}},RJ={0:{n:"PtgAttrNoop",f:OJ},1:{n:"PtgAttrSemi",f:UZ},2:{n:"PtgAttrIf",f:BZ},4:{n:"PtgAttrChoose",f:FZ},8:{n:"PtgAttrGoto",f:LZ},16:{n:"PtgAttrSum",f:qZ},32:{n:"PtgAttrBaxcel",f:SN},33:{n:"PtgAttrBaxcel",f:SN},64:{n:"PtgAttrSpace",f:HZ},65:{n:"PtgAttrSpaceSemi",f:zZ},128:{n:"PtgAttrIfError",f:$Z},255:{}};function MJ(e,t,r,n){if(n.biff<8)return pa(e,t);for(var a=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=iJ(e,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=aJ(e,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&i.push(pa(e,t)),i}function FJ(e,t,r){for(var n=e.l+t,a,i,o=[];n!=e.l;)t=n-e.l,i=e[e.l],a=EN[i]||EN[DJ[i]],(i===24||i===25)&&(a=(i===24?IJ:RJ)[e[e.l+1]]),!a||!a.f?pa(e,t):o.push([a.n,a.f(e,t,r)]);return o}function LJ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var o=n[i];o?o[0]===2?a.push('"'+o[1].replace(/"/g,'""')+'"'):a.push(o[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var BJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $J(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function RC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function CN(e,t,r){var n=RC(e,t,r);return n=="#REF"?n:Nl(n,r)}function so(e,t,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,h=0,f=0,m,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,v="",b=0,w=e[0].length;b<w;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:v=Tt(" ",e[0][g][1][1]);break;case 1:v=Tt("\r",e[0][g][1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}d=d+v,g=-1}l.push(d+BJ[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push($J(d,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Yo(y[1][1],o,a),l.push(qo(u,i));break;case"PtgRefN":u=r?Yo(y[1][1],r,a):y[1][1],l.push(qo(u,i));break;case"PtgRef3d":h=y[1][1],u=Yo(y[1][2],o,a),x=CN(n,h,a),l.push(x+"!"+qo(u,i));break;case"PtgFunc":case"PtgFuncVar":var N=y[1][0],_=y[1][1];N||(N=0),N&=127;var S=N==0?[]:l.slice(-N);l.length-=N,_==="User"&&(_=S.shift()),l.push(_+"("+S.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=lN(y[1][1],r?{s:r}:o,a),l.push(Af(m,a));break;case"PtgArea":m=lN(y[1][1],o,a),l.push(Af(m,a));break;case"PtgArea3d":h=y[1][1],m=y[1][2],x=CN(n,h,a),l.push(x+"!"+Af(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var j=(n.names||[])[f-1]||(n[0]||[])[f],E=j?j.Name:"SH33TJSNAME"+String(f);E&&E.slice(0,6)=="_xlfn."&&!a.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var k=y[1][1];f=y[1][2];var T;if(a.biff<=5)k<0&&(k=-k),n[k]&&(T=n[k][f]);else{var A="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][f]&&n[k][f].itab>0&&(A=n.SheetNames[n[k][f].itab-1]+"!"):A=n.SheetNames[f-1]+"!"),n[k]&&n[k][f])A+=n[k][f].Name;else if(n[0]&&n[0][f])A+=n[0][f].Name;else{var C=(RC(n,k,a)||"").split(";;");C[f-1]?A=C[f-1]:A+="SH33TJSERRX"}l.push(A);break}T||(T={Name:"SH33TJSERRY"}),l.push(T.Name);break;case"PtgParen":var R="(",G=")";if(g>=0){switch(v="",e[0][g][1][0]){case 2:R=Tt(" ",e[0][g][1][1])+R;break;case 3:R=Tt("\r",e[0][g][1][1])+R;break;case 4:G=Tt(" ",e[0][g][1][1])+G;break;case 5:G=Tt("\r",e[0][g][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(R+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[Rt(u)]){var X=n.sharedf[Rt(u)];l.push(so(X,o,V,n,a))}else{var K=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(so(d[1],o,V,n,a)),K=!0;break}K||l.push(y[1])}break;case"PtgArray":l.push("{"+LJ(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Y.indexOf(e[0][b][0])==-1){y=e[0][g];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:v=Tt(" ",y[1][1]);break;case 5:q=!1;case 1:v=Tt("\r",y[1][1]);break;default:if(v="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((q?v:"")+l.pop()+(q?"":v)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function UJ(e){if(e==null){var t=re(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ss(e);return ss(0)}function HJ(e,t,r,n,a){var i=os(t,r,a),o=UJ(e.v),l=re(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=re(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var h=Vt([i,o,l,d]);return h}function y0(e,t,r){var n=e.read_shift(4),a=FJ(e,n,r),i=e.read_shift(4),o=i>0?MJ(e,i,a,r):null;return[a,o]}var zJ=y0,w0=y0,WJ=y0,VJ=y0;function TN(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=re(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=re(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function KJ(e){var t=re(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function GJ(e){var t=re(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function XJ(e){var t=re(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=re(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=re(4);return n.write_shift(4,0),Vt([t,r,n])}function YJ(e){var t=At(e),r=re(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function qJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=At(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=re(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function ZJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=re(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function JJ(e){var t=e.split(":"),r=t[0],n=re(23);n.write_shift(4,15),r=t[0];var a=At(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=At(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function QJ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=re(27);i.write_shift(4,19);var o=a[0],l=At(o);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),o=a[1],l=At(o),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function eQ(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=Nr(e),i=re(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function tQ(e,t){if(typeof e=="number")return TN(e);if(typeof e=="boolean")return GJ(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return KJ(+la[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return YJ(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return JJ(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return eQ(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return qJ(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return QJ(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return ZJ(e,t);if(/^".*"$/.test(e))return XJ(e);if(/^[+-]\d+$/.test(e))return TN(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var rQ=tQ,nQ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},MC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aQ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function iQ(e){var t="of:="+e.replace(v0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function FC(e){return e.replace(/!/,".").replace(/:/,":.")}var Zo=typeof Map<"u";function Xg(e,t,r){var n=0,a=e.length;if(r){if(Zo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Zo?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Zo?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function N0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ia=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=sd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=lp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function LC(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ei(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){OX(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function sQ(e,t,r){if(e&&e["!ref"]){var n=jt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function oQ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Yt(e[r])+'"/>';return t+"</mergeCells>"}function lQ(e,t,r,n,a){var i=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=bl(Ze(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+Se("outlinePr",null,d)}!i&&!l||(a[a.length]=Se("sheetPr",l,o))}var cQ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],uQ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function dQ(e){var t={sheet:1};return cQ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),uQ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=NC(e.password).toString(16).toUpperCase()),Se("sheetProtection",null,t)}function hQ(e){return LC(e),Se("pageMargins",null,e)}function fQ(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Se("col",null,N0(a,n)));return r[r.length]="</cols>",r.join("")}function mQ(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Yt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Nr(a);o.s.r==o.e.r&&(o.e.r=Nr(t["!ref"]).e.r,a=Yt(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=Nl(r.SheetNames[n])+"!"+wl(a);break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Se("autoFilter",null,{ref:a})}function pQ(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Se("sheetViews",Se("sheetView",null,a),{})}function xQ(e,t,r,n,a,i,o){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var l="",c=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=Gr[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=Gr[e.v=7]);break;case"e":l=Gr[e.v];break;case"d":if(n&&n.cellDates){var u=an(e.v,o);l=u.toISOString(),u.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else e=Rr(e),e.t="n",l=""+(e.v=_r(an(e.v,o),o));typeof e.z>"u"&&(e.z=_t[14]);break;default:l=e.v;break}var h=e.t=="z"||e.v==null?"":yr("v",Ze(l)),f={r:t},m=Ei(n.cellXfs,e,n);switch(m!==0&&(f.s=m),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){h=yr("v",""+Xg(n.Strings,e.v,n.revStrings)),f.t="s";break}else f.t="str";break}if(e.t!=c&&(e.t=c,e.v=d),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=Se("f",Ze(e.f),x)+(e.v!=null?h:"")}return e.l&&(e.l.display=Ze(l),r["!links"].push([t,e.l])),e.D&&(f.cm=1),Se("c",h,f)}function gQ(e,t,r,n){var a=[],i=[],o=jt(e["!ref"]),l="",c,d="",u=[],h=0,f=0,m=e["!rows"],x=e["!data"]!=null,g=x?e["!data"]:[],v={r:d},b,w=-1,y=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(f=o.s.c;f<=o.e.c;++f)u[f]=ft(f);for(h=o.s.r;h<=o.e.r;++h){i=[],d=pt(h);var N=x?g[h]:[];for(f=o.s.c;f<=o.e.c;++f){c=u[f]+d;var _=x?N[f]:e[c];_!==void 0&&(l=xQ(_,c,e,t,r,n,y))!=null&&i.push(l)}(i.length>0||m&&m[h])&&(v={r:d},m&&m[h]&&(b=m[h],b.hidden&&(v.hidden=1),w=-1,b.hpx?w=od(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(v.ht=w,v.customHeight=1),b.level&&(v.outlineLevel=b.level)),a[a.length]=Se("row",i.join(""),v))}if(m)for(;h<m.length;++h)m&&m[h]&&(v={r:h+1},b=m[h],b.hidden&&(v.hidden=1),w=-1,b.hpx?w=od(b.hpx):b.hpt&&(w=b.hpt),w>-1&&(v.ht=w,v.customHeight=1),b.level&&(v.outlineLevel=b.level),a[a.length]=Se("row","",v));return a.join("")}function vQ(e,t,r,n){var a=[Zt,Se("worksheet",null,{xmlns:vo[0],"xmlns:r":or.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=jt(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Yt(u)}n||(n={}),c["!comments"]=[];var h=[];lQ(c,r,e,t,a),a[a.length]=Se("dimension",null,{ref:d}),a[a.length]=pQ(c,t,e,r),t.sheetFormat&&(a[a.length]=Se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=fQ(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=gQ(c,t,e,r),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=dQ(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=mQ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=oQ(c["!merges"]));var f=-1,m,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=it(n,-1,Ze(g[1].Target).replace(/#[\s\S]*$/,""),tt.HLINK),m["r:id"]="rId"+x),(f=g[1].Target.indexOf("#"))>-1&&(m.location=Ze(g[1].Target.slice(f+1))),g[1].Tooltip&&(m.tooltip=Ze(g[1].Tooltip)),m.display=g[1].display,a[a.length]=Se("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=hQ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=yr("ignoredErrors",Se("ignoredError",null,{numberStoredAsText:1,sqref:d}))),h.length>0&&(x=it(n,-1,"../drawings/drawing"+(e+1)+".xml",tt.DRAW),a[a.length]=Se("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=h),c["!comments"].length>0&&(x=it(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",tt.VML),a[a.length]=Se("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function bQ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function yQ(e,t,r){var n=re(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=od(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=r["!data"]!=null,h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var f=-1,m=-1,x=h<<10;x<h+1<<10;++x){d.c=x;var g=u?(r["!data"][d.r]||[])[d.c]:r[Rt(d)];g&&(f<0&&(f=x),m=x)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,m))}var v=n.l;return n.l=c,n.write_shift(4,l),n.l=v,n.length>n.l?n.slice(0,n.l):n}function wQ(e,t,r,n){var a=yQ(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&xe(e,0,a)}var NQ=vs,_Q=wo;function jQ(){}function SQ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=bY(e),r}function EQ(e,t,r){r==null&&(r=re(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return nd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),nC(e,r),r.slice(0,r.l)}function CQ(e){var t=Mn(e);return[t]}function TQ(e,t,r){return r==null&&(r=re(8)),ps(t,r)}function kQ(e){var t=xs(e);return[t]}function AQ(e,t,r){return r==null&&(r=re(4)),gs(t,r)}function PQ(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"b"]}function OQ(e,t,r){return r==null&&(r=re(9)),ps(t,r),r.write_shift(1,e.v?1:0),r}function DQ(e){var t=xs(e),r=e.read_shift(1);return[t,r,"b"]}function IQ(e,t,r){return r==null&&(r=re(5)),gs(t,r),r.write_shift(1,e.v?1:0),r}function RQ(e){var t=Mn(e),r=e.read_shift(1);return[t,r,"e"]}function Rf(e,t,r){return r==null&&(r=re(9)),ps(t,r),r.write_shift(1,e.v),r}function MQ(e){var t=xs(e),r=e.read_shift(1);return[t,r,"e"]}function Mf(e,t,r){return r==null&&(r=re(8)),gs(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function FQ(e){var t=Mn(e),r=e.read_shift(4);return[t,r,"s"]}function LQ(e,t,r){return r==null&&(r=re(12)),ps(t,r),r.write_shift(4,t.v),r}function BQ(e){var t=xs(e),r=e.read_shift(4);return[t,r,"s"]}function $Q(e,t,r){return r==null&&(r=re(8)),gs(t,r),r.write_shift(4,t.v),r}function UQ(e){var t=Mn(e),r=No(e);return[t,r,"n"]}function HQ(e,t,r){return r==null&&(r=re(16)),ps(t,r),ss(e.v,r),r}function zQ(e){var t=xs(e),r=No(e);return[t,r,"n"]}function WQ(e,t,r){return r==null&&(r=re(12)),gs(t,r),ss(e.v,r),r}function VQ(e){var t=Mn(e),r=Wg(e);return[t,r,"n"]}function KQ(e,t,r){return r==null&&(r=re(12)),ps(t,r),aC(e.v,r),r}function GQ(e){var t=xs(e),r=Wg(e);return[t,r,"n"]}function XQ(e,t,r){return r==null&&(r=re(8)),gs(t,r),aC(e.v,r),r}function YQ(e){var t=Mn(e),r=Hg(e);return[t,r,"is"]}function qQ(e){var t=Mn(e),r=Ir(e);return[t,r,"str"]}function ZQ(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=re(12+4*e.v.length)),ps(t,r),er(n,r),r.length>r.l?r.slice(0,r.l):r}function JQ(e){var t=xs(e),r=Ir(e);return[t,r,"str"]}function QQ(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=re(8+4*n.length)),gs(t,r),er(n,r),r.length>r.l?r.slice(0,r.l):r}function eee(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=w0(e,n-e.l,r);o[3]=so(l,null,a,r.supbooks,r)}else e.l=n;return o}function tee(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var i=e.read_shift(1),o=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=w0(e,n-e.l,r);o[3]=so(l,null,a,r.supbooks,r)}else e.l=n;return o}function ree(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var i=No(e),o=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=w0(e,n-e.l,r);o[3]=so(l,null,a,r.supbooks,r)}else e.l=n;return o}function nee(e,t,r){var n=e.l+t,a=Mn(e);a.r=r["!row"];var i=Ir(e),o=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=w0(e,n-e.l,r);o[3]=so(l,null,a,r.supbooks,r)}else e.l=n;return o}var aee=vs,iee=wo;function see(e,t){return t==null&&(t=re(4)),t.write_shift(4,e),t}function oee(e,t){var r=e.l+t,n=vs(e),a=g0(e),i=Ir(e),o=Ir(e),l=Ir(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:l};return o&&(c.Tooltip=o),c}function lee(e,t){var r=re(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));wo({s:At(e[0]),e:At(e[0])},r),zg("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return er(a||"",r),er(e[1].Tooltip||"",r),er("",r),r.slice(0,r.l)}function cee(){}function uee(e,t,r){var n=e.l+t,a=iC(e),i=e.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var l=zJ(e,n-e.l,r);o[1]=l}else e.l=n;return o}function dee(e,t,r){var n=e.l+t,a=vs(e),i=[a];if(r.cellFormula){var o=VJ(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}function hee(e,t,r){r==null&&(r=re(18));var n=N0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var BC=["left","right","top","bottom","header","footer"];function fee(e){var t={};return BC.forEach(function(r){t[r]=No(e)}),t}function mee(e,t){return t==null&&(t=re(48)),LC(e),BC.forEach(function(r){ss(e[r],t)}),t}function pee(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function xee(e,t,r){r==null&&(r=re(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function gee(e){var t=re(24);return t.write_shift(4,4),t.write_shift(4,1),wo(e,t),t}function vee(e,t){return t==null&&(t=re(66)),t.write_shift(2,e.password?NC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function bee(){}function yee(){}function wee(e,t,r,n,a,i,o,l){var c={r,c:n};if(t.c&&i["!comments"].push([Rt(c),t.c]),t.v===void 0)return!1;var d="";switch(t.t){case"b":d=t.v?"1":"0";break;case"d":t=Rr(t),t.z=t.z||_t[14],t.v=_r(an(t.v,l),l),t.t="n";break;case"n":case"e":d=""+t.v;break;default:d=t.v;break}switch(c.s=Ei(a.cellXfs,t,a),t.l&&i["!links"].push([Rt(c),t.l]),t.t){case"s":case"str":return a.bookSST?(d=Xg(a.Strings,t.v==null?"":String(t.v),a.revStrings),c.t="s",c.v=d,o?xe(e,18,$Q(t,c)):xe(e,7,LQ(t,c))):(c.t="str",o?xe(e,17,QQ(t,c)):xe(e,6,ZQ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?xe(e,13,XQ(t,c)):xe(e,2,KQ(t,c)):isFinite(t.v)?o?xe(e,16,WQ(t,c)):xe(e,5,HQ(t,c)):(c.t="e",isNaN(t.v)?o?xe(e,14,Mf({v:36},c)):xe(e,3,Rf({v:36},c)):o?xe(e,14,Mf({v:7},c)):xe(e,3,Rf({v:7},c))),!0;case"b":return c.t="b",o?xe(e,15,IQ(t,c)):xe(e,4,OQ(t,c)),!0;case"e":return c.t="e",o?xe(e,14,Mf(t,c)):xe(e,3,Rf(t,c)),!0}return o?xe(e,12,AQ(t,c)):xe(e,1,TQ(t,c)),!0}function Nee(e,t,r,n,a){var i=jt(t["!ref"]||"A1"),o="",l=[],c=(((a||{}).Workbook||{}).WBProps||{}).date1904;xe(e,145);var d=t["!data"]!=null,u=d?t["!data"][i.s.r]:[],h=i.e.r;t["!rows"]&&(h=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=h;++f)if(o=pt(f),d&&(u=t["!data"][f]),wQ(e,t,i,f),!(d&&!u)){var m=!1;if(f<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){f===i.s.r&&(l[x]=ft(x));var g=d?u[x]:t[l[x]+o];if(!g){m=!1;continue}m=wee(e,g,f,x,n,t,m,c)}}xe(e,146)}function _ee(e,t){!t||!t["!merges"]||(xe(e,177,see(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,iee(r))}),xe(e,178))}function jee(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,hee(n,r))}),xe(e,391))}function See(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,gee(jt(t["!ref"]))),xe(e,650))}function Eee(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=it(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),tt.HLINK);xe(e,494,lee(n,a))}}),delete t["!links"]}function Cee(e,t,r,n){if(t["!comments"].length>0){var a=it(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",tt.VML);xe(e,551,zg("rId"+a)),t["!legacy"]=a}}function Tee(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Yt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Nr(i);l.s.r==l.e.r&&(l.e.r=Nr(t["!ref"]).e.r,i=Yt(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref=Nl(r.SheetNames[n])+"!"+wl(i);break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:Nl(r.SheetNames[n])+"!"+wl(i)}),xe(e,161,wo(jt(i))),xe(e,162)}}function kee(e,t,r){xe(e,133),xe(e,137,xee(t,r)),xe(e,138),xe(e,134)}function Aee(e,t){t["!protect"]&&xe(e,535,vee(t["!protect"]))}function Pee(e,t,r,n){var a=Dr(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=jt(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xe(a,129),(r.vbaraw||o["!outline"])&&xe(a,147,EQ(l,o["!outline"])),xe(a,148,_Q(c)),kee(a,o,r.Workbook),jee(a,o),Nee(a,o,e,t,r),Aee(a,o),Tee(a,o,r,e),_ee(a,o),Eee(a,o,n),o["!margins"]&&xe(a,476,mee(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&See(a,o),Cee(a,o,e,n),xe(a,130),a.end()}function Oee(e,t){e.l+=10;var r=Ir(e);return{name:r}}var Dee=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Iee(e){return!e.Workbook||!e.Workbook.WBProps?"false":qX(e.Workbook.WBProps.date1904)?"true":"false"}var Ree=":][*?/\\".split("");function $C(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");Ree.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function Mee(e,t,r){e.forEach(function(n,a){$C(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Fee(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Mee(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)sQ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var o;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a&&(o=c)});var l=Nl(n)+"!"+wl(i["!autofilter"].ref);o?o.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:l})}})}function Lee(e){var t=[Zt];t[t.length]=Se("workbook",null,{xmlns:vo[0],"xmlns:r":or.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Dee.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Se("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Ze(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Se("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Se("definedName",Ze(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Bee(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=op(e),r.name=Ir(e),r}function $ee(e,t){return t||(t=re(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),zg(e.strRelID,t),er(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Uee(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ir(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Hee(e,t){t||(t=re(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),nC(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zee(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),o=yY(e),l,c="";try{l=WJ(e,0,r);try{c=g0(e)}catch{}}catch{console.error("Could not parse defined name "+o)}a&32&&(o="_xlnm."+o),e.l=n;var d={Name:o,Ptg:l,Flags:a};return i<268435455&&(d.Sheet=i),c&&(d.Comment=c),d}function Wee(e,t){var r=re(9),n=0,a=e.Name;OY.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,er(a),rQ(e.Ref,t)];if(e.Comment)i.push(_l(e.Comment));else{var o=re(4);o.write_shift(4,4294967295),i.push(o)}return Vt(i)}function Vee(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,$ee(a))}xe(e,144)}function Kee(e,t){t||(t=re(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return er("SheetJS",t),er(Xu.version,t),er(Xu.version,t),er("7262",t),t.length>t.l?t.slice(0,t.l):t}function Gee(e,t){t||(t=re(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Xee(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(xe(e,135),xe(e,158,Gee(a)),xe(e,136))}}function Yee(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;xe(e,39,Wee(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function qee(e){var t=e.SheetNames.length,r=re(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function Zee(e,t){xe(e,353),xe(e,357),xe(e,362,qee(t)),xe(e,354)}function Jee(e,t){var r=Dr();return xe(r,131),xe(r,128,Kee()),xe(r,153,Hee(e.Workbook&&e.Workbook.WBProps||null)),Xee(r,e),Vee(r,e),Zee(r,e),(e.Workbook||{}).Names&&Yee(r,e),xe(r,132),r.end()}function Qee(e,t){var r=[];return e.Props&&r.push(FY(e.Props,t)),e.Custprops&&r.push(LY(e.Props,e.Custprops)),r.join("")}function ete(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function tte(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Se("NumberFormat",null,{"ss:Format":Ze(_t[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Se("Style",i.join(""),o))}),Se("Styles",r.join(""))}function UC(e){return Se("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+b0(e.Ref,{r:0,c:0})})}function rte(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(UC(a)))}return Se("Names",r.join(""))}function nte(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(UC(l)))}return i.join("")}function ate(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Se("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(yr("ProtectContents","True")),e["!protect"].objects&&a.push(yr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(yr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(yr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(yr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Se("WorksheetOptions",a.join(""),{xmlns:hn.x})}function ite(e){return e.map(function(t){var r=YX(t.t||""),n=Se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Se("Comment",n,a)}).join("")}function ste(e,t,r,n,a,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Ze(b0(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=At(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Ze(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Ze(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var h="",f="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(h="Number",f=String(e.v)):(h="Error",f=Gr[isNaN(e.v)?36:7]);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=Gr[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||_t[14]);break;case"s":h="String",f=XX(e.v||"");break}var m=Ei(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var x=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=ite(e.c)),Se("Cell",g,l)}function ote(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=jC(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function lte(e,t,r,n){if(!e["!ref"])return"";var a=jt(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(v,b){Kg(v);var w=!!v.width,y=N0(b,v),N={"ss:Index":b+1};w&&(N["ss:Width"]=id(y.width)),v.hidden&&(N["ss:Hidden"]="1"),l.push(Se("Column",null,N))});for(var c=e["!data"]!=null,d={r:0,c:0},u=a.s.r;u<=a.e.r;++u){var h=[ote(u,(e["!rows"]||[])[u])];d.r=u;for(var f=a.s.c;f<=a.e.c;++f){d.c=f;var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>u)&&!(i[o].e.c<f)&&!(i[o].e.r<u)){(i[o].s.c!=f||i[o].s.r!=u)&&(m=!0);break}if(!m){var x=ft(f)+pt(u),g=c?(e["!data"][u]||[])[f]:e[x];h.push(ste(g,x,e,t,r,n,d))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function cte(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],o=i?nte(i,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?lte(i,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(ate(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+b0(wl(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function ute(e,t){t||(t={}),e.SSF||(e.SSF=Rr(_t)),e.SSF&&(m0(),f0(e.SSF),t.revssf=p0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Qee(e,t)),r.push(ete(e)),r.push(""),r.push(rte(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Se("Worksheet",cte(n,t,e),{"ss:Name":Ze(e.SheetNames[n])}));return r[2]=tte(e,t),Zt+Se("Workbook",r.join(""),{xmlns:hn.ss,"xmlns:o":hn.o,"xmlns:x":hn.x,"xmlns:ss":hn.ss,"xmlns:dt":hn.dt,"xmlns:html":hn.html})}var Ff={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function dte(e,t){var r=[],n=[],a=[],i=0,o,l=Q2(uN,"n"),c=Q2(dN,"n");if(e.Props)for(o=Xt(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Xt(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?n:a).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)pC.indexOf(a[i][0])>-1||hC.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&gt.utils.cfb_add(t,"/SummaryInformation",xN(n,Ff.SI,c,dN)),(r.length||d.length)&&gt.utils.cfb_add(t,"/DocumentSummaryInformation",xN(r,Ff.DSI,l,uN,d.length?d:null,Ff.UDI))}function hte(e,t){var r=t||{},n=gt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gt.utils.cfb_add(n,a,zC(e,r)),r.biff==8&&(e.Props||e.Custprops)&&dte(e,n),r.biff==8&&e.vbaraw&&NZ(n,gt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var fte={0:{f:bQ},1:{f:CQ},2:{f:VQ},3:{f:RQ},4:{f:PQ},5:{f:UQ},6:{f:qQ},7:{f:FQ},8:{f:nee},9:{f:ree},10:{f:eee},11:{f:tee},12:{f:kQ},13:{f:GQ},14:{f:MQ},15:{f:DQ},16:{f:zQ},17:{f:JQ},18:{f:BQ},19:{f:Hg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zee},40:{},42:{},43:{f:Uq},44:{f:Bq},45:{f:Wq},46:{f:Kq},47:{f:Vq},48:{},49:{f:fY},50:{},51:{f:lZ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:gq},62:{f:YQ},63:{f:pZ},64:{f:bee},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pee},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:SQ},148:{f:NQ,p:16},151:{f:cee},152:{},153:{f:Uee},154:{},155:{},156:{f:Bee},157:{},158:{},159:{T:1,f:Tq},160:{T:-1},161:{T:1,f:vs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:aee},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:sZ},336:{T:-1},337:{f:dZ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:op},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hq},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:uee},427:{f:dee},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:fee},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jQ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oee},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:op},551:{f:g0},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yZ},633:{T:1},634:{T:-1},635:{T:1,f:vZ},636:{T:-1},637:{f:gY},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Oee},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yee},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function be(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Bg(r)&&e.push(r)}}function mte(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return be(e,t,r,a);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Lf(e,t,r,n){var a=re(9);return Jl(a,e,t),xC(r,n||"b",a),a}function pte(e,t,r){var n=re(8+2*r.length);return Jl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function HC(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return be(e,28,Df(n,r[1],r[2]));be(e,28,Df(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)be(e,28,Df(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function xte(e,t,r,n,a,i){var o=0;t.z!=null&&(o=a._BIFF2FmtTable.indexOf(t.z),o==-1&&(a._BIFF2FmtTable.push(t.z),o=a._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<a.cellXfs.length&&a.cellXfs[l].numFmtId!=o;++l);l==a.cellXfs.length&&a.cellXfs.push({numFmtId:o})}if(t.v!=null)switch(t.t){case"d":case"n":var c=t.t=="d"?_r(an(t.v,i),i):t.v;a.biff==2&&c==(c|0)&&c>=0&&c<65536?be(e,2,wq(r,n,c,l,o)):isNaN(c)?be(e,5,Lf(r,n,36,"e")):isFinite(c)?be(e,3,yq(r,n,c,l,o)):be(e,5,Lf(r,n,7,"e"));return;case"b":case"e":be(e,5,Lf(r,n,t.v,t.t));return;case"s":case"str":be(e,4,pte(r,n,t.v==null?"":String(t.v).slice(0,255)));return}be(e,1,Jl(null,r,n))}function gte(e,t,r,n,a){var i=t["!data"]!=null,o=jt(t["!ref"]||"A1"),l="",c=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.r,16383)}for(var d=(((a||{}).Workbook||{}).WBProps||{}).date1904,u=[],h=[],f=o.s.c;f<=o.e.c;++f)c[f]=ft(f);for(var m=o.s.r;m<=o.e.r;++m)for(i&&(u=t["!data"][m]||[]),l=pt(m),f=o.s.c;f<=o.e.c;++f){var x=i?u[f]:t[c[f]+l];x&&(xte(e,x,m,f,n,d),x.c&&h.push([x.c,m,f]))}HC(e,h)}function vte(e,t){for(var r=t||{},n=Dr(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);be(n,r.biff==4?1033:r.biff==3?521:9,Vg(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&be(n,34,kr(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var o=Dr();return gte(o,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(l){r.biff<=3?be(n,30,iq(l)):be(n,1054,sq(l))}),r.cellXfs.forEach(function(l){switch(r.biff){case 2:be(n,67,lq(l));break;case 3:be(n,579,yC(l));break;case 4:be(n,1091,cq(l));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(o.end()),be(n,10),n.end()}var Ln=1,Cn=[];function bte(){var e=re(82+8*Cn.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*Cn.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*Cn.length);{e.write_shift(4,Ln),e.write_shift(4,Cn.length+1);for(var t=0,r=0;r<Cn.length;++r)t+=Cn[r]&&Cn[r][1]||0;e.write_shift(4,t),e.write_shift(4,Cn.length)}Cn.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function yte(e,t){var r=[],n=0,a=Dr(),i=Ln,o;t.forEach(function(c,d){var u="",h=c[0].map(function(y){return y.a&&!u&&(u=y.a),y.t}).join("");++Ln;{var f=re(150);f.write_shift(2,15),f.write_shift(2,61444),f.write_shift(4,150),f.write_shift(2,3234),f.write_shift(2,61450),f.write_shift(4,8),f.write_shift(4,Ln),f.write_shift(4,2560),f.write_shift(2,227),f.write_shift(2,61451),f.write_shift(4,84),f.write_shift(2,128),f.write_shift(4,0),f.write_shift(2,139),f.write_shift(4,2),f.write_shift(2,191),f.write_shift(4,524296),f.write_shift(2,344),f.l+=4,f.write_shift(2,385),f.write_shift(4,134217808),f.write_shift(2,387),f.write_shift(4,134217808),f.write_shift(2,389),f.write_shift(4,268435700),f.write_shift(2,447),f.write_shift(4,1048592),f.write_shift(2,448),f.write_shift(4,134217809),f.write_shift(2,451),f.write_shift(4,268435700),f.write_shift(2,513),f.write_shift(4,134217809),f.write_shift(2,515),f.write_shift(4,268435700),f.write_shift(2,575),f.write_shift(4,196609),f.write_shift(2,959),f.write_shift(4,131072|(c[0].hidden?2:0)),f.l+=2,f.write_shift(2,61456),f.write_shift(4,18),f.write_shift(2,3),f.write_shift(2,c[2]+2),f.l+=2,f.write_shift(2,c[1]+1),f.l+=2,f.write_shift(2,c[2]+4),f.l+=2,f.write_shift(2,c[1]+5),f.l+=2,f.l+=2,f.write_shift(2,61457),f.l+=4,f.l=150,d==0?o=f:be(a,236,f)}n+=150;{var m=re(52);m.write_shift(2,21),m.write_shift(2,18),m.write_shift(2,25),m.write_shift(2,Ln),m.write_shift(2,0),m.l=22,m.write_shift(2,13),m.write_shift(2,22),m.write_shift(4,1651663474),m.write_shift(4,2503426821),m.write_shift(4,2150634280),m.write_shift(4,1768515844+Ln*256),m.write_shift(2,0),m.write_shift(4,0),m.l+=4,be(a,93,m)}{var x=re(8);x.l+=2,x.write_shift(2,61453),x.l+=4,be(a,236,x)}n+=8;{var g=re(18);g.write_shift(2,18),g.l+=8,g.write_shift(2,h.length),g.write_shift(2,16),g.l+=4,be(a,438,g);{var v=re(1+h.length);v.write_shift(1,0),v.write_shift(h.length,h,"sbcs"),be(a,60,v)}{var b=re(16);b.l+=8,b.write_shift(2,h.length),b.l+=6,be(a,60,b)}}{var w=re(12+u.length);w.write_shift(2,c[1]),w.write_shift(2,c[2]),w.write_shift(2,0|(c[0].hidden?0:2)),w.write_shift(2,Ln),w.write_shift(2,u.length),w.write_shift(1,0),w.write_shift(u.length,u,"sbcs"),w.l++,r.push(w)}});{var l=re(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Ln),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,i),l.write_shift(4,5),be(e,236,o?Vt([l,o]):l)}e.push(a.end()),r.forEach(function(c){be(e,28,c)}),Cn.push([i,t.length+1,Ln]),++Ln}function wte(e,t,r){be(e,49,tq({sz:12,name:"Arial"},r))}function Nte(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&be(e,1054,aq(a,t[a],r))})}function _te(e,t){var r=re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(e,2151,r),r=re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),bC(jt(t["!ref"]||"A1"),r),r.write_shift(4,4),be(e,2152,r)}function jte(e,t){for(var r=0;r<16;++r)be(e,224,vN({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){be(e,224,vN(n,0,t))})}function Ste(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];be(e,440,mq(n)),n[1].Tooltip&&be(e,2048,pq(n))}delete t["!links"]}function Ete(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&be(e,125,vq(N0(a,n),a))})}}function Cte(e,t,r,n,a,i){var o=16+Ei(a.cellXfs,t,a);if(t.v==null&&!t.bf){be(e,513,os(r,n,o));return}if(t.bf)be(e,6,HJ(t,r,n,a,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?_r(an(t.v,i),i):t.v;isNaN(l)?be(e,517,Of(r,n,36,o,a,"e")):isFinite(l)?be(e,515,dq(r,n,l,o)):be(e,517,Of(r,n,7,o,a,"e"));break;case"b":case"e":be(e,517,Of(r,n,t.v,o,a,t.t));break;case"s":case"str":if(a.bookSST){var c=Xg(a.Strings,t.v==null?"":String(t.v),a.revStrings);be(e,253,rq(r,n,c,o))}else be(e,516,nq(r,n,(t.v==null?"":String(t.v)).slice(0,255),o,a));break;default:be(e,513,os(r,n,o))}}function Tte(e,t,r){var n=Dr(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=i["!data"]!=null,d=t.biff==8,u="",h=[],f=jt(i["!ref"]||"A1"),m=d?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+m);f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.r,m-1)}be(n,2057,Vg(r,16,t)),be(n,13,Tn(1)),be(n,12,Tn(100)),be(n,15,kr(!0)),be(n,17,kr(!1)),be(n,16,ss(.001)),be(n,95,kr(!0)),be(n,42,kr(!1)),be(n,43,kr(!1)),be(n,130,Tn(1)),be(n,128,uq()),be(n,131,kr(!1)),be(n,132,kr(!1)),d&&Ete(n,i["!cols"]),be(n,512,oq(f,t));var x=(((r||{}).Workbook||{}).WBProps||{}).date1904;d&&(i["!links"]=[]);for(var g=f.s.c;g<=f.e.c;++g)h[g]=ft(g);for(var v=[],b=[],w=f.s.r;w<=f.e.r;++w)for(c&&(b=i["!data"][w]||[]),u=pt(w),g=f.s.c;g<=f.e.c;++g){var y=c?b[g]:i[h[g]+u];y&&(Cte(n,y,w,g,t,x),d&&y.l&&i["!links"].push([h[g]+u,y.l]),y.c&&v.push([y.c,w,g]))}var N=l.CodeName||l.name||a;return d?yte(n,v):HC(n,v),d&&be(n,574,eq((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&be(n,229,fq(i["!merges"])),d&&Ste(n,i),be(n,442,vC(N)),d&&_te(n,i),be(n,10),n.end()}function kte(e,t,r){var n=Dr(),a=(e||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(be(n,2057,Vg(e,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,l?Tn(1200):null),be(n,193,UY(2)),c&&be(n,191),c&&be(n,192),be(n,226),be(n,92,qY("SheetJS",r)),be(n,66,Tn(l?1200:1252)),l&&be(n,353,Tn(0)),l&&be(n,448),be(n,317,bq(e.SheetNames.length)),l&&e.vbaraw&&be(n,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";be(n,442,vC(d))}be(n,156,Tn(17)),be(n,25,kr(!1)),be(n,18,kr(!1)),be(n,19,Tn(0)),l&&be(n,431,kr(!1)),l&&be(n,444,Tn(0)),be(n,61,QY()),be(n,64,kr(!1)),be(n,141,Tn(0)),be(n,34,kr(Iee(e)=="true")),be(n,14,kr(!0)),l&&be(n,439,kr(!1)),be(n,218,Tn(0)),wte(n,e,r),Nte(n,e.SSF,r),jte(n,r),l&&be(n,352,kr(!1));var u=n.end(),h=Dr();l&&be(h,140,xq()),l&&Cn.length&&be(h,235,bte()),l&&r.Strings&&mte(h,252,JY(r.Strings)),be(h,10);var f=h.end(),m=Dr(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var v=u.length+x+f.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};be(m,133,ZY({pos:v,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),v+=t[g].length}var w=m.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),f.length&&y.push(f),Vt(y)}function Ate(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Rr(_t)),e&&e.SSF&&(m0(),f0(e.SSF),r.revssf=p0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),Ln=1,Cn=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Yg(r),r.cellXfs=[],Ei(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Tte(a,r,e);return n.unshift(kte(e,n,r)),Vt(n)}function zC(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Nr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Ate(e,t);case 4:case 3:case 2:return vte(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Pte(e,t,r,n){for(var a=e["!merges"]||[],i=[],o={},l=e["!data"]!=null,c=t.s.c;c<=t.e.c;++c){for(var d=0,u=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>c)&&!(a[h].e.r<r||a[h].e.c<c)){if(a[h].s.r<r||a[h].s.c<c){d=-1;break}d=a[h].e.r-a[h].s.r+1,u=a[h].e.c-a[h].s.c+1;break}if(!(d<0)){var f=ft(c)+pt(r),m=l?(e["!data"][r]||[])[c]:e[f];m&&m.t=="n"&&m.v!=null&&!isFinite(m.v)&&(isNaN(m.v)?m={t:"e",v:36,w:Gr[36]}:m={t:"e",v:7,w:Gr[7]});var x=m&&m.v!=null&&(m.h||Tf(m.w||(Ka(m),m.w)||""))||"";o={},d>1&&(o.rowspan=d),u>1&&(o.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":m&&(o["data-t"]=m&&m.t||"z",m.v!=null&&(o["data-v"]=Tf(m.v instanceof Date?m.v.toISOString():m.v)),m.z!=null&&(o["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+Tf(m.l.Target)+'">'+x+"</a>")),o.id=(n.id||"sjs")+"-"+f,i.push(Se("td",x,o))}}var g="<tr>";return g+i.join("")+"</tr>"}var Ote='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Dte="</body></html>";function Ite(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function WC(e,t){var r=t||{},n=r.header!=null?r.header:Ote,a=r.footer!=null?r.footer:Dte,i=[n],o=Nr(e["!ref"]||"A1");if(i.push(Ite(e,o,r)),e["!ref"])for(var l=o.s.r;l<=o.e.r;++l)i.push(Pte(e,o,l,r));return i.push("</table>"+a),i.join("")}function VC(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,o=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?At(a.origin):a.origin;o=c.r,l=c.c}var d=Math.min(a.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:o,c:l}};if(e["!ref"]){var h=Nr(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),o==-1&&(u.e.r=o=h.e.r+1)}var f=[],m=0,x=e["!rows"]||(e["!rows"]=[]),g=0,v=0,b=0,w=0,y=0,N=0;for(e["!cols"]||(e["!cols"]=[]);g<n.length&&v<d;++g){var _=n[g];if(kN(_)){if(a.display)continue;x[v]={hidden:!0}}var S=_.cells;for(b=w=0;b<S.length;++b){var j=S[b];if(!(a.display&&kN(j))){var E=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):ZX(j.innerHTML),k=j.getAttribute("data-z")||j.getAttribute("z");for(m=0;m<f.length;++m){var T=f[m];T.s.c==w+l&&T.s.r<v+o&&v+o<=T.e.r&&(w=T.e.c+1-l,m=-1)}N=+j.getAttribute("colspan")||1,((y=+j.getAttribute("rowspan")||1)>1||N>1)&&f.push({s:{r:v+o,c:w+l},e:{r:v+o+(y||1)-1,c:w+l+(N||1)-1}});var A={t:"s",v:E},C=j.getAttribute("data-t")||j.getAttribute("t")||"";E!=null&&(E.length==0?A.t=C||"z":a.raw||E.trim().length==0||C=="s"||(C=="e"&&Gr[+E]?A={t:"e",v:+E,w:Gr[+E]}:E==="TRUE"?A={t:"b",v:!0}:E==="FALSE"?A={t:"b",v:!1}:isNaN(Da(E))?isNaN(td(E).getDate())?E.charCodeAt(0)==35&&la[E]!=null&&(A={t:"e",v:la[E],w:E}):(A={t:"d",v:an(E)},a.UTC&&(A.v=x0(A.v)),a.cellDates||(A={t:"n",v:_r(A.v)}),A.z=a.dateNF||_t[14]):A={t:"n",v:Da(E)})),A.z===void 0&&k!=null&&(A.z=k);var R="",G=j.getElementsByTagName("A");if(G&&G.length)for(var V=0;V<G.length&&!(G[V].hasAttribute("href")&&(R=G[V].getAttribute("href"),R.charAt(0)!="#"));++V);R&&R.charAt(0)!="#"&&R.slice(0,11).toLowerCase()!="javascript:"&&(A.l={Target:R}),i?(e["!data"][v+o]||(e["!data"][v+o]=[]),e["!data"][v+o][w+l]=A):e[Rt({c:w+l,r:v+o})]=A,u.e.c<w+l&&(u.e.c=w+l),w+=N}}++v}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,v-1+o),e["!ref"]=Yt(u),v>=d&&(e["!fullref"]=Yt((u.e.r=n.length-g+v-1+o,u))),e}function KC(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),VC(n,e,t)}function Rte(e,t){var r=bo(KC(e,t),t);return r}function kN(e){var t="",r=Mte(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Mte(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Fte=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+yl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Zt+t}})();function Lte(e,t){var r="number",n="",a={"style:name":t},i="",o=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[o]=='"'){for(i="";e[++o]!='"'||e[++o]=='"';)i+=e[o];--o,e[o+1]=="*"?(o++,n+="<number:fill-character>"+Ze(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var l=e.match(/# (\?+)\/(\?+)/);if(l){n+=Se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=e.match(/# (\?+)\/(\d+)/)){n+=Se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Se("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;o<e.length;++o)switch(i=e[o].toLowerCase()){case"h":case"s":c=!0,--o;break t;case"m":r:for(var d=o+1;d<e.length;++d)switch(e[d]){case"y":case"d":break r;case"h":case"s":c=!0,--o;break t}case"y":case"d":for(;(e[++o]||"").toLowerCase()==i[0];)i+=i[0];switch(--o,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++o]!='"'||e[++o]=='"';)i+=e[o];--o,n+="<number:text>"+Ze(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++o],n+="<number:text>"+Ze(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!c)break e;e=e.slice(o+1),o=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");o<e.length;++o)switch(i=e[o].toLowerCase()){case"h":case"m":case"s":for(;(e[++o]||"").toLowerCase()==i[0];)i+=i[0];switch(--o,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[o+1]==".")do i+=e[o+1],++o;while(e[o+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++o]!='"'||e[++o]=='"';)i+=e[o];--o,n+="<number:text>"+Ze(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(i)+"</number:text>";break;case"a":if(e.slice(o,o+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",o+=2;break}if(e.slice(o,o+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",o+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),o=0),o=0,e[o]=='"'){for(;e[++o]!='"'||e[++o]=='"';)i+=e[o];--o,e[o+1]=="*"?(o++,n+="<number:fill-character>"+Ze(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var u=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!u||!u[0])console.error("Could not find numeric part of "+e);else{var h=u[1].replace(/,/g,"");n+="<number:"+(u[3]?"scientific-":"")+'number number:min-integer-digits="'+(h.indexOf("0")==-1?"0":h.length-h.indexOf("0"))+'"'+(u[0].indexOf(",")>-1?' number:grouping="true"':"")+(u[2]&&' number:decimal-places="'+(u[2].length-1)+'"'||' number:decimal-places="0"')+(u[3]&&u[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(u[3]?' number:min-exponent-digits="'+u[3].match(/0+/)[0].length+'"':"")+"></number:"+(u[3]?"scientific-":"")+"number>",o=u.index+u[0].length}if(e[o]=='"'){for(i="";e[++o]!='"'||e[++o]=='"';)i+=e[o];--o,n+="<number:text>"+Ze(i.replace(/""/g,'"'))+"</number:text>"}}return n?Se("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function AN(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(o){var l=(r==-1?"$":"")+FC(o.Ref);return"        "+Se("table:named-range",null,{"table:name":o.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var PN=(function(){var e=function(a,i){return Ze(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,o,l,c,d){var u=[];u.push('      <table:table table:name="'+Ze(i.SheetNames[o])+`" table:style-name="ta1">
`);var h=0,f=0,m=Nr(a["!ref"]||"A1"),x=a["!merges"]||[],g=0,v=a["!data"]!=null;if(a["!cols"])for(f=0;f<=m.e.c;++f)u.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var b="",w=a["!rows"]||[];for(h=0;h<m.s.r;++h)b=w[h]?' table:style-name="ro'+w[h].ods+'"':"",u.push("        <table:table-row"+b+`></table:table-row>
`);for(;h<=m.e.r;++h){for(b=w[h]?' table:style-name="ro'+w[h].ods+'"':"",u.push("        <table:table-row"+b+`>
`),f=0;f<m.s.c;++f)u.push(t);for(;f<=m.e.c;++f){var y=!1,N={},_="";for(g=0;g!=x.length;++g)if(!(x[g].s.c>f)&&!(x[g].s.r>h)&&!(x[g].e.c<f)&&!(x[g].e.r<h)){(x[g].s.c!=f||x[g].s.r!=h)&&(y=!0),N["table:number-columns-spanned"]=x[g].e.c-x[g].s.c+1,N["table:number-rows-spanned"]=x[g].e.r-x[g].s.r+1;break}if(y){u.push(`          <table:covered-table-cell/>
`);continue}var S=Rt({r:h,c:f}),j=v?(a["!data"][h]||[])[f]:a[S];if(j&&j.f&&(N["table:formula"]=Ze(iQ(j.f)),j.F&&j.F.slice(0,S.length)==S)){var E=Nr(j.F);N["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,N["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!j){u.push(t);continue}switch(j.t){case"b":_=j.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=j.v?"true":"false";break;case"n":isFinite(j.v)?(_=j.w||String(j.v||0),N["office:value-type"]="float",N["office:value"]=j.v||0):(isNaN(j.v)?(_="#NUM!",N["table:formula"]="of:=#NUM!"):(_="#DIV/0!",N["table:formula"]="of:="+(j.v<0?"-":"")+"1/0"),N["office:string-value"]="",N["office:value-type"]="string",N["calcext:value-type"]="error");break;case"s":case"str":_=j.v==null?"":j.v,N["office:value-type"]="string";break;case"d":_=j.w||an(j.v,d).toISOString(),N["office:value-type"]="date",N["office:date-value"]=an(j.v,d).toISOString(),N["table:style-name"]="ce1";break;default:u.push(t);continue}var k=e(_);if(j.l&&j.l.Target){var T=j.l.Target;T=T.charAt(0)=="#"?"#"+FC(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),k=Se("text:a",k,{"xlink:href":T.replace(/&/g,"&amp;")})}c[j.z]&&(N["table:style-name"]="ce"+c[j.z].slice(1));var A=Se("text:p",k,{});if(j.c){for(var C="",R="",G={},V=0;V<j.c.length;++V)!C&&j.c[V].a&&(C=j.c[V].a),R+="<text:p>"+e(j.c[V].t)+"</text:p>";j.c.hidden||(G["office:display"]=!0),A=Se("office:annotation",R,G)+A}u.push("          "+Se("table:table-cell",A,N)+`
`)}u.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&u.push(AN(i.Workbook.Names,i.SheetNames,o)),u.push(`      </table:table>
`),u.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var h=0;h<u["!cols"].length;++h)if(u["!cols"][h]){var f=u["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Kg(f),f.ods=o;var m=u["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var h=0;h<u["!rows"].length;++h)if(u["!rows"][h]){u["!rows"][h].ods=l;var f=u["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c={},d=69;return i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u){var h=u["!data"]!=null;if(u["!ref"])for(var f=Nr(u["!ref"]),m=0;m<=f.e.r;++m)for(var x=0;x<=f.e.c;++x){var g=h?(u["!data"][m]||[])[x]:u[Rt({r:m,c:x})];if(!(!g||!g.z||g.z.toLowerCase()=="general")&&!c[g.z]){var v=Lte(g.z,"N"+d);v&&(c[g.z]="N"+d,++d,a.push(v+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Xt(c).forEach(function(u){a.push('<style:style style:name="ce'+c[u].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+c[u]+`"/>
`)}),a.push(` </office:automatic-styles>
`),c};return function(i,o){var l=[Zt],c=yl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=yl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+d+`>
`),l.push(uC().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+c+`>
`);var u=n(l,i);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var h=0;h!=i.SheetNames.length;++h)l.push(r(i.Sheets[i.SheetNames[h]],i,h,o,u,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&l.push(AN(i.Workbook.Names,i.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function GC(e,t){if(t.bookType=="fods")return PN(e,t);var r=Rg(),n="",a=[],i=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,PN(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",qe(r,n,Fte(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",qe(r,n,Zt+uC()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,MY(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,IY(a)),r}var Vr=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function ld(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function jl(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xs(as(e))}function $r(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):dn(bl(e))}function yi(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],o=i.length;if(o<250)for(var l=0;l<o;++l)n[a++]=i[l];else n.set(i,a),a+=o}return n}function Bte(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Sl(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function Me(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[Vr](0,r)}function XC(e){for(var t={l:0},r=[];t.l<e.length;)r.push(Sl(e,t));return r}function YC(e){return yi(e.map(function(t){return Me(t)}))}function xn(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function $e(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=Sl(e,r),i=a&7;a=a/8|0;var o,l=r.l;switch(i){case 0:{for(;e[l++]>=128;);o=e[Vr](r.l,l),r.l=l}break;case 1:o=e[Vr](l,l+8),r.l=l+8;break;case 2:{var c=Sl(e,r);o=e[Vr](r.l,r.l+c),r.l+=c}break;case 5:o=e[Vr](l,l+4),r.l=l+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:o,type:i};t[a]==null&&(t[a]=[]),t[a].push(d)}return t}function Le(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push(Me(n*8+a.type)),a.type==2&&t.push(Me(a.data.length)),t.push(a.data))})}),yi(t)}function cd(e,t){return e?.map(function(r){return t(r.data)})||[]}function ud(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=Sl(e,n),i=$e(e[Vr](n.l,n.l+a));n.l+=a;var o={id:xn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=$e(l.data),d=xn(c[3][0].data);o.messages.push({meta:c,data:e[Vr](n.l,n.l+d)}),n.l+=d}),(t=i[3])!=null&&t[0]&&(o.merge=xn(i[3][0].data)>>>0>0),r.push(o)}return r}function Zs(e){var t=[];return e.forEach(function(r){var n=[[],[{data:Me(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:Me(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Me(o.data.length)}],n[2].push({data:Le(o.meta),type:2})});var i=Le(n);t.push(Me(i.length)),t.push(i),a.forEach(function(o){return t.push(o)})}),yi(t)}function $te(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=Sl(t,r),a=[],i=r.l;i<t.length;){var o=t[i]&3;if(o==0){var l=t[i++]>>2;if(l<60)++l;else{var c=l-59;l=t[i],c>1&&(l|=t[i+1]<<8),c>2&&(l|=t[i+2]<<16),c>3&&(l|=t[i+3]<<24),l>>>=0,l++,i+=c}a.push(t[Vr](i,i+l)),i+=l;continue}else{var d=0,u=0;if(o==1?(u=(t[i]>>2&7)+4,d=(t[i++]&224)<<3,d|=t[i++]):(u=(t[i++]>>2)+1,o==2?(d=t[i]|t[i+1]<<8,i+=2):(d=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),d==0)throw new Error("Invalid offset 0");for(var h=a.length-1,f=d;h>=0&&f>=a[h].length;)f-=a[h].length,--h;if(h<0)if(f==0)f=a[h=0].length;else throw new Error("Invalid offset beyond length");if(u<f)a.push(a[h][Vr](a[h].length-f,a[h].length-f+u));else{for(f>0&&(a.push(a[h][Vr](a[h].length-f)),u-=f),++h;u>=a[h].length;)a.push(a[h]),u-=a[h].length,++h;u&&a.push(a[h][Vr](0,u))}a.length>25&&(a=[yi(a)])}}for(var m=0,x=0;x<a.length;++x)m+=a[x].length;if(m!=n)throw new Error("Unexpected length: ".concat(m," != ").concat(n));return a}function dd(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,$te(n,e[Vr](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:yi(t)}function Js(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Me(n),o=i.length;t.push(i),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[Vr](r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return yi(t)}function Bf(e,t){var r=new Uint8Array(32),n=ld(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&is(e.z)){r[1]=5,n.setFloat64(a,(Gs(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,Bte(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var o=e.v==null?"":String(e.v);if(e.l){var l=t.rsst.findIndex(function(d){var u;return d.v==o&&d.l==((u=e.l)==null?void 0:u.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:o,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=16,a+=4}else{var c=t.sst.indexOf(o);c==-1&&(t.sst[c=t.sst.length]=o),r[1]=3,n.setUint32(a,c,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(Ute(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[Vr](0,a)}function $f(e,t){var r=new Uint8Array(32),n=ld(r),a=12,i=0,o="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(o=e.v==null?"":String(e.v),e.l){var l=t.rsst.findIndex(function(d){var u;return d.v==o&&d.l==((u=e.l)==null?void 0:u.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:o,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(o=e.v==null?"":String(e.v),!e.l){var c=t.sst.indexOf(o);c==-1&&(t.sst[c=t.sst.length]=o),r[1]=3,n.setUint32(a,c,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[Vr](0,a)}function Wt(e){var t=$e(e);return xn(t[1][0].data)}function Tr(e){return Le([[],[{type:0,data:Me(e)}]])}function Cr(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?XC(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:YC(n)}])}function wa(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?XC(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:YC(n.filter(function(a){return a!=t}))}]}function Ute(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function Hte(e,t,r){var n,a,i,o=[[],[{type:0,data:Me(0)}],[{type:0,data:Me(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Me(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Me(1)}]];if(!((n=o[6])!=null&&n[0])||!((a=o[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(o[7][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(o[7][0].data),o[7][0].data=c}if(o[4][0].data.length<2*e.length){var d=new Uint8Array(2*e.length);d.set(o[4][0].data),o[4][0].data=d}for(var u=ld(o[7][0].data),h=0,f=[],m=ld(o[4][0].data),x=0,g=[],v=4,b=0;b<e.length;++b){if(e[b]==null||e[b].t=="z"&&!((i=e[b].c)!=null&&i.length)||e[b].t=="e"){u.setUint16(b*2,65535,!0),m.setUint16(b*2,65535);continue}u.setUint16(b*2,h/v,!0),m.setUint16(b*2,x/v,!0);var w,y;switch(e[b].t){case"d":if(e[b].v instanceof Date){w=Bf(e[b],t),y=$f(e[b],t);break}w=Bf(e[b],t),y=$f(e[b],t);break;case"s":case"n":case"b":case"z":w=Bf(e[b],t),y=$f(e[b],t);break;default:throw new Error("Unsupported value "+e[b])}f.push(w),h+=w.length,g.push(y),x+=y.length,++l}for(o[2][0].data=Me(l),o[5][0].data=Me(5);b<o[7][0].data.length/2;++b)u.setUint16(b*2,65535,!0),m.setUint16(b*2,65535,!0);return o[6][0].data=yi(f),o[3][0].data=yi(g),o[8]=[{type:0,data:Me(1)}],o}function cp(e,t){return{meta:[[],[{type:0,data:Me(e)}]],data:t}}function aa(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function zte(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&ud(dd(a.content)).forEach(function(o){r.push(o.id),t[o.id]={deps:[],location:i,type:xn(o.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&ud(dd(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(o){i.meta[o]&&i.meta[o].forEach(function(l){t[a.id].deps.push(xn(l.data))})})})})}),t}function Rc(e,t,r){return Le([[],[{type:0,data:Me(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:Me(1)}]])}function ON(e){switch(e){case 0:return Rc(99,222,171);case 1:return Rc(162,197,240);case 2:return Rc(255,189,189)}return Rc(Math.random()*255,Math.random()*255,Math.random()*255)}function Wte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=gt.read(t.numbers,{type:"base64"}),n=zte(r),a=ia(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=cd($e(a.messages[0].data)[1],Wt);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(o,l){l>=1&&(Kte(r,n,l+1),a=ia(r,n,1),i=cd($e(a.messages[0].data)[1],Wt)),Gte(r,n,e.Sheets[o],o,l,i[l])}),r}function dt(e,t,r,n){var a=gt.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=ud(dd(a.content)),o=i.find(function(l){return l.id==r});n(o,i),a.content=Js(Zs(i)),a.size=a.content.length}function ia(e,t,r){var n=gt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=ud(dd(n.content)),i=a.find(function(o){return o.id==r});return i}function up(e,t,r){e[3].push({type:2,data:Le([[],[{type:0,data:Me(t)}],[{type:2,data:$r(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:$r(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(0)}]])}),e[1]=[{type:0,data:Me(Math.max(t+1,xn(e[1][0].data)))}]}function Ai(e,t,r,n,a,i){i||(i=aa({deps:[],location:"",type:t},a));var o="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+o,gt.utils.cfb_add(e,o,Js(Zs([{id:i,messages:[cp(t,Le(r))]}])));var l=o.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return dt(e,a,2,function(c){var d=$e(c.messages[0].data);up(d,i||0,l),c.messages[0].data=Le(d)}),i}function Jr(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,d,u=$e(l.data);return(c=u[3])!=null&&c[0]?jl(u[3][0].data)==a:!!((d=u[2])!=null&&d[0]&&jl(u[2][0].data)==a)}),o=$e(e[3][i].data);o[6]||(o[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){o[6].push({type:2,data:Le([[],[{type:0,data:Me(l)}]])})}),e[3][i].data=Le(o)}function Vte(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var c,d,u=$e(l.data);return(c=u[3])!=null&&c[0]?jl(u[3][0].data)==a:!!((d=u[2])!=null&&d[0]&&jl(u[2][0].data)==a)}),o=$e(e[3][i].data);o[6]||(o[6]=[]),o[6]=o[6].filter(function(l){return xn($e(l.data)[1][0].data)!=n}),e[3][i].data=Le(o)}function Kte(e,t,r){var n=-1,a=-1,i={};dt(e,t,1,function(c,d){var u=$e(c.messages[0].data);n=Wt($e(c.messages[0].data)[1][0].data),a=aa({deps:[1],location:t[n].location,type:2},t),i[n]=a,Cr(c,a),u[1].push({type:2,data:Tr(a)});var h=ia(e,t,n);h.id=a,t[1].location==t[a].location?d.push(h):dt(e,t,a,function(f,m){return m.push(h)}),c.messages[0].data=Le(u)});var o=-1;dt(e,t,a,function(c,d){for(var u=$e(c.messages[0].data),h=3;h<=69;++h)delete u[h];var f=cd(u[2],Wt);f.forEach(function(x){return wa(c,x)}),o=aa({deps:[a],location:t[f[0]].location,type:t[f[0]].type},t),Cr(c,o),i[f[0]]=o,u[2]=[{type:2,data:Tr(o)}];var m=ia(e,t,f[0]);m.id=o,t[f[0]].location==t[a].location?d.push(m):(dt(e,t,2,function(x){var g=$e(x.messages[0].data);Jr(g,t,a,o),x.messages[0].data=Le(g)}),dt(e,t,o,function(x,g){return g.push(m)})),c.messages[0].data=Le(u)});var l=-1;dt(e,t,o,function(c,d){for(var u=$e(c.messages[0].data),h=$e(u[1][0].data),f=3;f<=69;++f)delete h[f];var m=Wt(h[2][0].data);h[2][0].data=Tr(i[m]),u[1][0].data=Le(h);var x=Wt(u[2][0].data);wa(c,x),l=aa({deps:[o],location:t[x].location,type:t[x].type},t),Cr(c,l),i[x]=l,u[2][0].data=Tr(l);var g=ia(e,t,x);g.id=l,t[o].location==t[l].location?d.push(g):dt(e,t,l,function(v,b){return b.push(g)}),c.messages[0].data=Le(u)}),dt(e,t,l,function(c,d){var u,h,f=$e(c.messages[0].data),m=jl(f[1][0].data),x=m.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(f[1][0].data=$r(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(_){return delete f[_]}),f[45]){var g=$e(f[45][0].data),v=Wt(g[1][0].data);wa(c,v),delete f[45]}if(f[70]){var b=$e(f[70][0].data);(u=b[2])==null||u.forEach(function(_){var S=$e(_.data);[2,3].map(function(j){return S[j][0]}).forEach(function(j){var E=$e(j.data);if(E[8]){var k=Wt(E[8][0].data);wa(c,k)}})}),delete f[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(_){if(f[_]){var S=Wt(f[_][0].data);delete f[_],wa(c,S)}});var w=$e(f[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(_){var S;if((S=w[_])!=null&&S[0]){var j=Wt(w[_][0].data),E=aa({deps:[l],location:t[j].location,type:t[j].type},t);wa(c,j),Cr(c,E),i[j]=E;var k=ia(e,t,j);if(k.id=E,t[j].location==t[l].location)d.push(k);else{t[E].location=t[j].location.replace(j.toString(),E.toString()),t[E].location==t[j].location&&(t[E].location=t[E].location.replace(/\.iwa/,"-".concat(E,".iwa"))),gt.utils.cfb_add(e,t[E].location,Js(Zs([k])));var T=t[E].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");dt(e,t,2,function(A){var C=$e(A.messages[0].data);up(C,E,T),Jr(C,t,l,E),A.messages[0].data=Le(C)})}w[_][0].data=Tr(E)}});var y=$e(w[1][0].data);(h=y[2])==null||h.forEach(function(_){var S=Wt(_.data),j=aa({deps:[l],location:t[S].location,type:t[S].type},t);wa(c,S),Cr(c,j),i[S]=j;var E=ia(e,t,S);if(E.id=j,t[S].location==t[l].location)d.push(E);else{t[j].location=t[S].location.replace(S.toString(),j.toString()),t[j].location==t[S].location&&(t[j].location=t[j].location.replace(/\.iwa/,"-".concat(j,".iwa"))),gt.utils.cfb_add(e,t[j].location,Js(Zs([E])));var k=t[j].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");dt(e,t,2,function(T){var A=$e(T.messages[0].data);up(A,j,k),Jr(A,t,l,j),T.messages[0].data=Le(A)})}_.data=Tr(j)}),w[1][0].data=Le(y);var N=$e(w[3][0].data);N[1].forEach(function(_){var S=$e(_.data),j=Wt(S[2][0].data),E=i[j];if(!i[j]){E=aa({deps:[l],location:"",type:t[j].type},t),t[E].location="Root Entry/Index/Tables/Tile-".concat(E,".iwa"),i[j]=E;var k=ia(e,t,j);k.id=E,wa(c,j),Cr(c,E),gt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(E,".iwa"),Js(Zs([k]))),dt(e,t,2,function(T){var A=$e(T.messages[0].data);A[3].push({type:2,data:Le([[],[{type:0,data:Me(E)}],[{type:2,data:$r("Tables/Tile")}],[{type:2,data:$r("Tables/Tile-".concat(E))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(0)}]])}),A[1]=[{type:0,data:Me(Math.max(E+1,xn(A[1][0].data)))}],Jr(A,t,l,E),T.messages[0].data=Le(A)})}S[2][0].data=Tr(E),_.data=Le(S)}),w[3][0].data=Le(N)}f[4][0].data=Le(w),c.messages[0].data=Le(f)})}function Gte(e,t,r,n,a,i){var o=[];dt(e,t,i,function(d){var u=$e(d.messages[0].data);u[1]=[{type:2,data:$r(n)}],o=cd(u[2],Wt),d.messages[0].data=Le(u)});var l=ia(e,t,o[0]),c=Wt($e(l.messages[0].data)[2][0].data);dt(e,t,c,function(d,u){return Xte(e,t,r,d,u,c)})}function Xte(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var o=Nr(r["!ref"]);o.s.r=o.s.c=0;var l=!1;o.e.c>999&&(l=!0,o.e.c=999),o.e.r>999999&&(l=!0,o.e.r=999999),l&&console.error("Truncating to ".concat(Yt(o)));var c=[];if(r["!data"])c=r["!data"];else{for(var d=[],u=0;u<=o.e.c;++u)d[u]=ft(u);for(var h=0;h<=o.e.r;++h){c[h]=[];var f=""+(h+1);for(u=0;u<=o.e.c;++u){var m=r[d[u]+f];m&&(c[h][u]=m)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},g=$e(n.messages[0].data);{g[6][0].data=Me(o.e.r+1),g[7][0].data=Me(o.e.c+1),delete g[46];var v=$e(g[4][0].data);{var b=Wt($e(v[1][0].data)[2][0].data);dt(e,t,b,function(ce,pe){var Ne,ee=$e(ce.messages[0].data);if((Ne=ee?.[2])!=null&&Ne[0])for(var oe=0;oe<c.length;++oe){var he=$e(ee[2][0].data);he[1][0].data=Me(oe),he[4][0].data=Me(c[oe].length),ee[2][oe]={type:ee[2][0].type,data:Le(he)}}ce.messages[0].data=Le(ee)});var w=Wt(v[2][0].data);dt(e,t,w,function(ce,pe){for(var Ne=$e(ce.messages[0].data),ee=0;ee<=o.e.c;++ee){var oe=$e(Ne[2][0].data);oe[1][0].data=Me(ee),oe[4][0].data=Me(o.e.r+1),Ne[2][ee]={type:Ne[2][0].type,data:Le(oe)}}ce.messages[0].data=Le(Ne)});var y=$e(v[9][0].data);y[1]=[];var N=$e(v[3][0].data);{var _=256;N[2]=[{type:0,data:Me(_)}];var S=Wt($e(N[1][0].data)[2][0].data),j=(function(){var ce=ia(e,t,2),pe=$e(ce.messages[0].data),Ne=pe[3].filter(function(ee){return xn($e(ee.data)[1][0].data)==S});return Ne?.length?xn($e(Ne[0].data)[12][0].data):0})();gt.utils.cfb_del(e,t[S].location),dt(e,t,2,function(ce){var pe=$e(ce.messages[0].data);pe[3]=pe[3].filter(function(Ne){return xn($e(Ne.data)[1][0].data)!=S}),Vte(pe,t,i,S),ce.messages[0].data=Le(pe)}),wa(n,S),N[1]=[];for(var E=Math.ceil((o.e.r+1)/_),k=0;k<E;++k){var T=aa({deps:[],location:"",type:6002},t);t[T].location="Root Entry/Index/Tables/Tile-".concat(T,".iwa");for(var A=[[],[{type:0,data:Me(0)}],[{type:0,data:Me(Math.min(o.e.r+1,(k+1)*_))}],[{type:0,data:Me(0)}],[{type:0,data:Me(Math.min((k+1)*_,o.e.r+1)-k*_)}],[],[{type:0,data:Me(5)}],[{type:0,data:Me(1)}],[{type:0,data:Me(1)}]],C=k*_;C<=Math.min(o.e.r,(k+1)*_-1);++C){var R=Hte(c[C],x);R[1][0].data=Me(C-k*_),A[5].push({data:Le(R),type:2})}N[1].push({type:2,data:Le([[],[{type:0,data:Me(k)}],[{type:2,data:Tr(T)}]])});var G={id:T,messages:[cp(6002,Le(A))]},V=Js(Zs([G]));gt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(T,".iwa"),V),dt(e,t,2,function(ce){var pe=$e(ce.messages[0].data);pe[3].push({type:2,data:Le([[],[{type:0,data:Me(T)}],[{type:2,data:$r("Tables/Tile")}],[{type:2,data:$r("Tables/Tile-".concat(T))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Me(0)}],[],[{type:0,data:Me(j)}]])}),pe[1]=[{type:0,data:Me(Math.max(T+1,xn(pe[1][0].data)))}],Jr(pe,t,i,T),ce.messages[0].data=Le(pe)}),Cr(n,T),y[1].push({type:2,data:Le([[],[{type:0,data:Me(k*_)}],[{type:0,data:Me(k)}]])})}}if(v[3][0].data=Le(N),v[9][0].data=Le(y),v[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var X=aa({type:6144,deps:[i],location:t[i].location},t);a.push({id:X,messages:[cp(6144,Le([[],r["!merges"].map(function(ce){return{type:2,data:Le([[],[{type:2,data:Le([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.s.r,ce.s.c]).buffer)}]])}],[{type:2,data:Le([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.e.r-ce.s.r+1,ce.e.c-ce.s.c+1]).buffer)}]])}]])}})]))]}),v[13]=[{type:2,data:Tr(X)}],dt(e,t,2,function(ce){var pe=$e(ce.messages[0].data);Jr(pe,t,i,X),ce.messages[0].data=Le(pe)}),Cr(n,X)}else delete v[13];var K=Wt(v[4][0].data);dt(e,t,K,function(ce){var pe=$e(ce.messages[0].data);pe[3]=[],x.sst.forEach(function(Ne,ee){ee!=0&&pe[3].push({type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(1)}],[{type:2,data:$r(Ne)}]])})}),ce.messages[0].data=Le(pe)});var Y=Wt(v[17][0].data);if(dt(e,t,Y,function(ce){var pe=$e(ce.messages[0].data);pe[3]=[];var Ne=[904980,903835,903815,903845];x.rsst.forEach(function(ee,oe){if(oe!=0){var he=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:$r(ee.v)}]];he[10]=[{type:0,data:new Uint8Array([1])}],he[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],he[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],he[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],he[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],he[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],he[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],he[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],he[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var O=aa({deps:[],location:"",type:2001},t),I=[];if(ee.l){var L=Ai(e,2032,[[],[],[{type:2,data:$r(ee.l)}]],"/Index/Tables/DataList",t);he[11]=[];var F=[[],[]];F[1]||(F[1]=[]),F[1].push({type:2,data:Le([[],[{type:0,data:Me(0)}],[{type:2,data:Tr(L)}]])}),he[11][0]={type:2,data:Le(F)},I.push(L)}Ai(e,2001,he,"/Index/Tables/DataList",t,O),dt(e,t,O,function(J){Ne.forEach(function(se){return Cr(J,se)}),I.forEach(function(se){return Cr(J,se)})});var W=Ai(e,6218,[[],[{type:2,data:Tr(O)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);dt(e,t,W,function(J){return Cr(J,O)}),pe[3].push({type:2,data:Le([[],[{type:0,data:Me(oe)}],[{type:0,data:Me(1)}],[],[],[],[],[],[],[{type:2,data:Tr(W)}]])}),Cr(ce,W),dt(e,t,2,function(J){var se=$e(J.messages[0].data);Jr(se,t,Y,W),Jr(se,t,W,O),Jr(se,t,O,I),Jr(se,t,O,Ne),J.messages[0].data=Le(se)})}}),ce.messages[0].data=Le(pe)}),x.cmnt.length>1){var q=Wt(v[19][0].data),Z={},le=0;dt(e,t,q,function(ce){var pe=$e(ce.messages[0].data);pe[3]=[],x.cmnt.forEach(function(Ne,ee){if(ee!=0){var oe=[];Ne.replies&&Ne.replies.forEach(function(I){Z[I.a||""]||(Z[I.a||""]=Ai(e,212,[[],[{type:2,data:$r(I.a||"")}],[{type:2,data:ON(++le)}],[],[{type:0,data:Me(0)}]],"/Index/Tables/DataList",t));var L=Z[I.a||""],F=Ai(e,3056,[[],[{type:2,data:$r(I.t||"")}],[{type:2,data:Le([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Tr(L)}]],"/Index/Tables/DataList",t);dt(e,t,F,function(W){return Cr(W,L)}),oe.push(F),dt(e,t,2,function(W){var J=$e(W.messages[0].data);Jr(J,t,F,L),W.messages[0].data=Le(J)})}),Z[Ne.a||""]||(Z[Ne.a||""]=Ai(e,212,[[],[{type:2,data:$r(Ne.a||"")}],[{type:2,data:ON(++le)}],[],[{type:0,data:Me(0)}]],"/Index/Tables/DataList",t));var he=Z[Ne.a||""],O=Ai(e,3056,[[],[{type:2,data:$r(Ne.t||"")}],[{type:2,data:Le([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Tr(he)}],oe.map(function(I){return{type:2,data:Tr(I)}}),[{type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(0)}]])}]],"/Index/Tables/DataList",t);dt(e,t,O,function(I){Cr(I,he),oe.forEach(function(L){return Cr(I,L)})}),pe[3].push({type:2,data:Le([[],[{type:0,data:Me(ee)}],[{type:0,data:Me(1)}],[],[],[],[],[],[],[],[{type:2,data:Tr(O)}]])}),Cr(ce,O),dt(e,t,2,function(I){var L=$e(I.messages[0].data);Jr(L,t,q,O),Jr(L,t,O,he),oe.length&&Jr(L,t,O,oe),I.messages[0].data=Le(L)})}}),pe[2][0].data=Me(x.cmnt.length+1),ce.messages[0].data=Le(pe)})}}g[4][0].data=Le(v)}n.messages[0].data=Le(g)}function Yte(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Yg(e){Yte([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function qte(e,t){e&&!e.SSF&&(e.SSF=Rr(_t)),e&&e.SSF&&(m0(),f0(e.SSF),t.revssf=p0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=oC();Yg(t=t||{});var i=Rg(),o="",l=0;if(t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(i,o,dC(e.Props,t)),a.coreprops.push(o),it(t.rels,2,o,tt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,o,fC(e.Props)),a.extprops.push(o),it(t.rels,3,o,tt.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(i,o,mC(e.Custprops)),a.custprops.push(o),it(t.rels,4,o,tt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+l+"."+r,qe(i,o,Pee(l-1,t,e,h)),a.sheets.push(o),it(t.wbrels,-1,"worksheets/sheet"+l+"."+r,tt.WS[0]),f){var x=f["!comments"],g=!1,v="";if(x&&x.length>0){var b=!1;x.forEach(function(y){y[1].forEach(function(N){N.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+".xml",qe(i,v,TC(x,u,t)),a.threadedcomments.push(v),it(h,-1,"../threadedComments/threadedComment"+l+".xml",tt.TCMNT)),v="xl/comments"+l+"."+r,qe(i,v,wZ(x)),a.comments.push(v),it(h,-1,"../comments"+l+"."+r,tt.CMNT),g=!0}f["!legacy"]&&g&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",CC(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qe(i,cC(o),Ys(h))}t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(i,o,Pq(t.Strings)),a.strs.push(o),it(t.wbrels,-1,"sharedStrings."+r,tt.SST)),o="xl/workbook."+r,qe(i,o,Jee(e)),a.workbooks.push(o),it(t.rels,1,o,tt.WB),o="xl/theme/theme1.xml";var w=EC(e.Themes,t);return qe(i,o,w),a.themes.push(o),it(t.wbrels,-1,"theme/theme1.xml",tt.THEME),o="xl/styles."+r,qe(i,o,iZ(e,t)),a.styles.push(o),it(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",qe(i,o,e.vbaraw),a.vba.push(o),it(t.wbrels,-1,"vbaProject.bin",tt.VBA)),o="xl/metadata."+r,qe(i,o,fZ()),a.metadata.push(o),it(t.wbrels,-1,"metadata."+r,tt.XLMETA),u.length>1&&(o="xl/persons/person.xml",qe(i,o,kC(u)),a.people.push(o),it(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),qe(i,"[Content_Types].xml",lC(a,t)),qe(i,"_rels/.rels",Ys(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",Ys(t.wbrels)),delete t.revssf,delete t.ssf,i}function Zte(e,t){e&&!e.SSF&&(e.SSF=Rr(_t)),e&&e.SSF&&(m0(),f0(e.SSF),t.revssf=p0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=_Z.indexOf(t.bookType)>-1,a=oC();Yg(t=t||{});var i=Rg(),o="",l=0;if(t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",qe(i,o,dC(e.Props,t)),a.coreprops.push(o),it(t.rels,2,o,tt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,qe(i,o,fC(e.Props)),a.extprops.push(o),it(t.rels,3,o,tt.EXT_PROPS),e.Custprops!==e.Props&&Xt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",qe(i,o,mC(e.Custprops)),a.custprops.push(o),it(t.rels,4,o,tt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],m=(f||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+l+"."+r,qe(i,o,vQ(l-1,t,e,h)),a.sheets.push(o),it(t.wbrels,-1,"worksheets/sheet"+l+"."+r,tt.WS[0]),f){var x=f["!comments"],g=!1,v="";if(x&&x.length>0){var b=!1;x.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(b=!0)})}),b&&(v="xl/threadedComments/threadedComment"+l+".xml",qe(i,v,TC(x,u,t)),a.threadedcomments.push(v),it(h,-1,"../threadedComments/threadedComment"+l+".xml",tt.TCMNT)),v="xl/comments"+l+"."+r,qe(i,v,gZ(x)),a.comments.push(v),it(h,-1,"../comments"+l+"."+r,tt.CMNT),g=!0}f["!legacy"]&&g&&qe(i,"xl/drawings/vmlDrawing"+l+".vml",CC(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qe(i,cC(o),Ys(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,qe(i,o,Cq(t.Strings,t)),a.strs.push(o),it(t.wbrels,-1,"sharedStrings."+r,tt.SST)),o="xl/workbook."+r,qe(i,o,Lee(e)),a.workbooks.push(o),it(t.rels,1,o,tt.WB),o="xl/theme/theme1.xml",qe(i,o,EC(e.Themes,t)),a.themes.push(o),it(t.wbrels,-1,"theme/theme1.xml",tt.THEME),o="xl/styles."+r,qe(i,o,Lq(e,t)),a.styles.push(o),it(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",qe(i,o,e.vbaraw),a.vba.push(o),it(t.wbrels,-1,"vbaProject.bin",tt.VBA)),o="xl/metadata."+r,qe(i,o,mZ()),a.metadata.push(o),it(t.wbrels,-1,"metadata."+r,tt.XLMETA),u.length>1&&(o="xl/persons/person.xml",qe(i,o,kC(u)),a.people.push(o),it(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),qe(i,"[Content_Types].xml",lC(a,t)),qe(i,"_rels/.rels",Ys(t.rels)),qe(i,"xl/_rels/workbook."+r+".rels",Ys(t.wbrels)),delete t.revssf,delete t.ssf,i}function Jte(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=vi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function qC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ql(t.file,gt.write(e,{type:ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gt.write(e,t)}function Qte(e,t){switch(t.bookType){case"ods":return GC(e,t);case"numbers":return Wte(e,t);case"xlsb":return qte(e,t);default:return Zte(e,t)}}function ere(e,t){var r=Rr(t||{}),n=Qte(e,r);return tre(n,r)}function tre(e,t){var r={},n=ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(h0(a))}return t.password&&typeof encrypt_agile<"u"?qC(encrypt_agile(a,t.password),t):t.type==="file"?ql(t.file,a):t.type=="string"?Xs(a):a}function rre(e,t){var r=t||{},n=hte(e,r);return qC(n,r)}function ta(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Yu(bl(n));case"binary":return bl(n);case"string":return e;case"file":return ql(t.file,n,"utf8");case"buffer":return ot?xa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ta(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nre(e,t){switch(t.type){case"base64":return nX(e);case"binary":return e;case"string":return e;case"file":return ql(t.file,e,"binary");case"buffer":return ot?xa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Mc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Yu(r):t.type=="string"?Xs(r):r;case"file":return ql(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function ZC(e,t){rX(),Fee(e);var r=Rr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ZC(e,r);return r.type="array",h0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ta(ute(e,r),r);case"slk":case"sylk":return ta(_q.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return ta(WC(e.Sheets[e.SheetNames[a]],r),r);case"txt":return nre(JC(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ta(qg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ta(jq.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Mc(Nq.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ta(Sq.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ta(Dq(e.Sheets[e.SheetNames[a]]),r);case"eth":return ta(wC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ta(GC(e,r),r);case"wk1":return Mc(yN.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Mc(yN.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Mc(zC(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rre(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ere(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function are(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ire(e,t,r){var n=r||{};return n.type="file",n.file=t,are(n),ZC(e,n)}function sre(e,t,r,n,a,i,o){var l=pt(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=e["!data"]!=null,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!h||e["!data"][r])for(var m=t.s.c;m<=t.e.c;++m){var x=h?(e["!data"][r]||[])[m]:e[n[m]+l];if(x==null||x.t===void 0){if(c===void 0)continue;i[m]!=null&&(f[i[m]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!is(x.z)||(g=Gs(g),typeof g=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(g=io(new Date(g)));break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(g==null)if(x.t=="e"&&g===null)f[i[m]]=null;else if(c!==void 0)f[i[m]]=c;else if(d&&g===null)f[i[m]]=null;else continue;else f[i[m]]=(x.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:d)?g:Ka(x,g,o);g!=null&&(u=!1)}}return{row:f,isempty:u}}function dp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=jt(u);break;case"number":c=jt(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var h=pt(c.s.r),f=[],m=[],x=0,g=0,v=e["!data"]!=null,b=c.s.r,w=0,y={};v&&!e["!data"][b]&&(e["!data"][b]=[]);var N=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(N[w]||{}).hidden)switch(f[w]=ft(w),r=v?e["!data"][b][w]:e[f[w]+h],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=f[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ka(r,null,d),g=y[o]||0,!g)y[o]=1;else{do l=o+"_"+g++;while(y[l]);y[o]=g,y[l]=1}i[w]=l}for(b=c.s.r+a;b<=c.e.r;++b)if(!(_[b]||{}).hidden){var S=sre(e,c,b,f,n,i,d);(S.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[x++]=S.row)}return m.length=x,m}var DN=/"/g;function ore(e,t,r,n,a,i,o,l,c){for(var d=!0,u=[],h="",f=pt(r),m=e["!data"]!=null,x=m&&e["!data"][r]||[],g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=m?x[g]:e[n[g]+f];if(v==null)h="";else if(v.v!=null){d=!1,h=""+(c.rawNumbers&&v.t=="n"?v.v:Ka(v,null,c));for(var b=0,w=0;b!==h.length;++b)if((w=h.charCodeAt(b))===a||w===i||w===34||c.forceQuotes){h='"'+h.replace(DN,'""')+'"';break}h=="ID"&&l==0&&u.length==0&&(h='"ID"')}else v.f!=null&&!v.F?(d=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(DN,'""')+'"')):h="";u.push(h)}if(c.strip)for(;u[u.length-1]==="";)--u.length;return c.blankrows===!1&&d?null:u.join(o)}function qg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=jt(e["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),d="",u=[],h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(u[m]=ft(m));for(var x=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||(d=ore(e,a,g,u,o,c,i,x,n),d!=null&&(d||n.blankrows!==!1)&&r.push((x++?l:"")+d));return r.join("")}function JC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=qg(e,t);return r}function lre(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=jt(e["!ref"]),o="",l=[],c,d=[],u=e["!data"]!=null;for(c=i.s.c;c<=i.e.c;++c)l[c]=ft(c);for(var h=i.s.r;h<=i.e.r;++h)for(o=pt(h),c=i.s.c;c<=i.e.c;++c)if(r=l[c]+o,n=u?(e["!data"][h]||[])[c]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}d[d.length]=r+"="+a}return d}function QC(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,o=e||{};!e&&a&&(o["!data"]=[]);var l=0,c=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?At(n.origin):n.origin;l=d.r,c=d.c}var u={s:{c:0,r:0},e:{c,r:l+t.length-1+i}};if(o["!ref"]){var h=jt(o["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),l==-1&&(l=h.e.r+1,u.e.r=l+t.length-1+i)}else l==-1&&(l=0,u.e.r=t.length-1+i);var f=n.header||[],m=0,x=[];t.forEach(function(v,b){a&&!o["!data"][l+b+i]&&(o["!data"][l+b+i]=[]),a&&(x=o["!data"][l+b+i]),Xt(v).forEach(function(w){(m=f.indexOf(w))==-1&&(f[m=f.length]=w);var y=v[w],N="z",_="",S=a?"":ft(c+m)+pt(l+b+i),j=a?x[c+m]:o[S];y&&typeof y=="object"&&!(y instanceof Date)?a?x[c+m]=y:o[S]=y:(typeof y=="number"?N="n":typeof y=="boolean"?N="b":typeof y=="string"?N="s":y instanceof Date?(N="d",n.UTC||(y=x0(y)),n.cellDates||(N="n",y=_r(y)),_=j!=null&&j.z&&is(j.z)?j.z:n.dateNF||_t[14]):y===null&&n.nullError&&(N="e",y=0),j?(j.t=N,j.v=y,delete j.w,delete j.R,_&&(j.z=_)):a?x[c+m]=j={t:N,v:y}:o[S]=j={t:N,v:y},_&&(j.z=_))})}),u.e.c=Math.max(u.e.c,c+f.length-1);var g=pt(l);if(a&&!o["!data"][l]&&(o["!data"][l]=[]),i)for(m=0;m<f.length;++m)a?o["!data"][l][m+c]={t:"s",v:f[m]}:o[ft(m+c)+g]={t:"s",v:f[m]};return o["!ref"]=Yt(u),o}function cre(e,t){return QC(null,e,t)}function hd(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=At(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?hd(e,Rt(t)):hd(e,ft(r||0)+pt(t))}function ure(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function dre(e,t){var r={SheetNames:[],Sheets:{}};return e&&Zg(r,e,t||"Sheet1"),r}function Zg(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var o=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if($C(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hre(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ure(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function fre(e,t){return e.z=t,e}function eT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function mre(e,t,r){return eT(e,"#"+t,r)}function pre(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function xre(e,t,r,n){for(var a=typeof t!="string"?t:jt(t),i=typeof t=="string"?t:Yt(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=hd(e,o,l);c.t="n",c.F=i,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}var d=Nr(e["!ref"]);return d.s.r>a.s.r&&(d.s.r=a.s.r),d.s.c>a.s.c&&(d.s.c=a.s.c),d.e.r<a.e.r&&(d.e.r=a.e.r),d.e.c<a.e.c&&(d.e.c=a.e.c),e["!ref"]=Yt(d),e}var hp={encode_col:ft,encode_row:pt,encode_cell:Rt,encode_range:Yt,decode_col:Ug,decode_row:$g,split_cell:dY,decode_cell:At,decode_range:Nr,format_cell:Ka,sheet_new:hY,sheet_add_aoa:rC,sheet_add_json:QC,sheet_add_dom:VC,aoa_to_sheet:yo,json_to_sheet:cre,table_to_sheet:KC,table_to_book:Rte,sheet_to_csv:qg,sheet_to_txt:JC,sheet_to_json:dp,sheet_to_html:WC,sheet_to_formulae:lre,sheet_to_row_object_array:dp,sheet_get_cell:hd,book_new:dre,book_append_sheet:Zg,book_set_sheet_visibility:hre,cell_set_number_format:fre,cell_set_hyperlink:eT,cell_set_internal_link:mre,cell_add_comment:pre,sheet_set_array_formula:xre,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Jg=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",gre=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")} VND`:"0 VND",vre=e=>{if(!e)return null;const t=e.match(/nhan tu\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},El=e=>vre(e.note)||e.sender||"",fp=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},bre=[{value:"receipt",label:"Biên Nhận",description:"Mã đơn bắt đầu bằng MAV"},{value:"refund",label:"Hoàn tiền",description:"Các biên nhận khác"}],Bn={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankCode:"VPB"},Uf=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return null;const[,r,n,a]=t.map(Number);return new Date(a,n-1,r).getTime()},yre=e=>{const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return e;const[,r,n,a]=t;return`${a}/${n}/${r}`},wre=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return"";const[,r,n,a]=t;return`${a}-${n}-${r}`},Nre=e=>{const t=r=>typeof r=="string"?r:"";return{id:Number(e?.id)||0,orderCode:t(e?.orderCode??e?.[Es.orderCode]),paidAt:t(e?.paidAt??e?.[Es.paidDate]),amount:Number(e?.amount??e?.[Es.amount])||0,sender:t(e?.sender??e?.[Es.sender]),receiver:t(e?.receiver??e?.[Es.receiver]),note:t(e?.note??e?.[Es.note])}},_re=e=>{const t=["#","Mã đơn","Người gửi","Người nhận","Số tiền gốc","Số tiền định dạng","Nội dung chuyển khoản","Ngày thanh toán","Nhóm"],r=e.map((a,i)=>[i+1,a.orderCode||"",El(a),a.receiver||"",a.amount,Jg(a.amount),a.note||"",a.paidAt?yt(a.paidAt):"",fp(a.orderCode)==="receipt"?"Biên nhận":"Hoàn tiền"]),n=hp.aoa_to_sheet([t,...r]);return n["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}],n},jre=({stats:e})=>s.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)] relative z-0",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e.map(t=>s.jsx(Ca,{title:t.name,value:t.value,icon:t.icon,accent:t.accent},t.name))})}),Sre=({searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:n,dateRangeDisplay:a,rangePickerOpen:i,setRangePickerOpen:o,dateRangeRef:l,toDisplayDate:c,toISODate:d,onDateStartChange:u,onDateEndChange:h,onExport:f,exportDisabled:m,onAddReceipt:x})=>s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.25)] backdrop-blur-sm relative z-10",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 opaciy-70"}),s.jsx("input",{type:"text",placeholder:"Tìm mã đơn, người gửi hoặc ghi chú...",className:"w-full pr-4 py-3 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:g=>t(g.target.value)})]}),s.jsxs("div",{className:"flex flex-wrap lg:flex-nowrap items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsxs("div",{className:"relative",ref:l,children:[s.jsxs("button",{type:"button",onClick:()=>o(!i),className:`flex items-center justify-between gap-3 px-4 py-2.5 rounded-2xl border transition-all text-sm min-w-[200px] ${i?"border-indigo-400/50 bg-indigo-500/20 text-indigo-200":"border-white/10 bg-slate-950/40 text-white hover:bg-white/5"}`,children:[s.jsx("span",{className:"font-medium truncate",children:a}),s.jsx(VN,{className:"w-5 h-5 opacity-70"})]}),i&&s.jsxs("div",{className:"absolute right-0 top-[calc(100%+12px)] w-80 bg-slate-900 border border-white/15 rounded-2xl shadow-2xl z-50 p-5 space-y-4 backdrop-blur-xl",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-[11px] font-bold text-indigo-300/80 uppercase tracking-widest px-1",children:"Từ Ngày"}),s.jsx("input",{type:"date",className:"w-full bg-slate-950/50 border border-white/10 text-white rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:d(r),onChange:g=>u(g.target.value?c(g.target.value):"")})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"text-[11px] font-bold text-indigo-300/80 uppercase tracking-widest px-1",children:"Đến Ngày"}),s.jsx("input",{type:"date",className:"w-full bg-slate-950/50 border border-white/10 text-white rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all",value:d(n),onChange:g=>h(g.target.value?c(g.target.value):"")})]})]}),s.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-white/10",children:[s.jsx("button",{className:"text-sm font-medium text-indigo-400 hover:text-indigo-300 transition-colors",onClick:()=>{u(""),h("")},children:"Xóa"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"px-4 py-2 text-xs font-semibold text-white/70 hover:text-white transition-colors",onClick:()=>o(!1),children:"Đóng"}),s.jsx("button",{className:"px-4 py-2 text-xs font-bold text-white bg-indigo-600 rounded-xl hover:bg-indigo-500 transition-all shadow-lg",onClick:()=>o(!1),children:"Áp Dụng"})]})]})]})]}),s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx(nn,{icon:Ra,onClick:x,className:"!py-2.5 !px-5 text-sm",children:"Thêm biên nhận"}),s.jsx("button",{type:"button",onClick:f,disabled:m,className:`px-5 py-2.5 rounded-2xl text-sm font-semibold transition-all border ${m?"bg-white/5 text-white/30 border-white/5 cursor-not-allowed":"bg-white/5 text-white border-white/10 hover:bg-white/10"}`,children:"Tải Về"})]})]})}),Ere=({activeCategory:e,counts:t,onChange:r})=>s.jsx("div",{className:"rounded-[32px] glass-panel-light p-2 border border-white/5 shadow-2xl flex flex-col sm:flex-row gap-2 relative z-10 transition-all duration-500",children:bre.map(n=>{const a=e===n.value,i=t[n.value];return s.jsxs("button",{type:"button",onClick:()=>r(n.value),className:`group relative flex-1 min-w-[200px] text-left rounded-[26px] px-6 py-5 transition-all duration-500 overflow-hidden ${a?"bg-indigo-600/40 text-white shadow-[0_0_40px_rgba(99,102,241,0.25)] border border-indigo-400/30":"text-indigo-100/60 hover:text-white border border-transparent"}`,children:[a&&s.jsx("div",{className:"absolute -right-8 -top-8 w-24 h-24 bg-indigo-500/20 rounded-full blur-3xl animate-pulse"}),s.jsxs("div",{className:"relative z-10 flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[11px] font-black uppercase tracking-[0.2em] leading-none opacity-80",children:n.label}),s.jsx("p",{className:`text-sm font-bold tracking-tight transition-colors ${a?"text-white":"text-indigo-100/70 group-hover:text-white"}`,children:n.description})]}),s.jsx("div",{className:`text-2xl font-black tracking-tighter ${a?"text-indigo-300":"text-indigo-200/20 group-hover:text-indigo-200/40"}`,children:i.toLocaleString()})]})]},n.value)})}),Cre=({receipts:e,expandedReceiptId:t,onToggle:r,onSelectReceipt:n})=>s.jsx("div",{className:"bg-transparent overflow-visible",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full border-separate border-spacing-y-4 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-5 [&>th]:pb-2 [&>th]:text-[11px] [&>th]:font-black [&>th]:uppercase [&>th]:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-left",children:[s.jsx("th",{className:"w-[120px]",children:"MÃ ĐƠN"}),s.jsx("th",{className:"w-[180px]",children:"NGƯỜI GỬI"}),s.jsx("th",{className:"w-[180px]",children:"NGƯỜI NHẬN"}),s.jsx("th",{className:"w-[140px]",children:"SỐ TIỀN"}),s.jsx("th",{children:"NỘI DUNG CHUYỂN KHOẢN"}),s.jsx("th",{className:"w-[150px] text-right pr-6",children:"NGÀY THANH TOÁN"})]})}),s.jsx("tbody",{className:"",children:e.map(a=>{const i=t===a.id;return s.jsxs(ua.Fragment,{children:[s.jsxs("tr",{className:"group/row cursor-pointer transition-all duration-500 relative z-10",onClick:()=>r(a.id),onDoubleClick:()=>n?n(a):void 0,children:[s.jsx("td",{className:"px-5 py-5 first:rounded-l-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:s.jsx("span",{className:"text-sm font-bold text-white tracking-wider uppercase",children:a.orderCode||"—"})}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:s.jsx("div",{className:"text-sm font-bold text-white tracking-tight",children:El(a)||"—"})}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:s.jsx("div",{className:"text-xs font-medium text-white/80",children:a.receiver||Bn.accountNumber})}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500",children:s.jsx("span",{className:"text-sm font-bold text-emerald-400 tracking-tight",children:Jg(a.amount)})}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 max-w-xs",children:s.jsx("span",{className:"block truncate text-[13px] text-white/60 font-medium",children:a.note||"—"})}),s.jsx("td",{className:"px-5 py-5 last:rounded-r-[24px] glass-panel border-y border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5 transition-all duration-500 text-right pr-6",children:s.jsx("span",{className:"text-xs font-bold text-indigo-300/80 tracking-tighter",children:a.paidAt?yt(a.paidAt):"—"})})]}),i&&s.jsx("tr",{className:"animate-in fade-in slide-in-from-top-2 duration-300 relative z-0",children:s.jsx("td",{colSpan:6,className:"px-6 pb-8 pt-2",children:s.jsxs("div",{className:"rounded-[32px] glass-panel-light p-6 shadow-2xl border border-indigo-500/20",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Mã đơn hàng"}),s.jsx("p",{className:"text-sm font-black text-white",children:a.orderCode||"—"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Người gửi"}),s.jsx("p",{className:"text-sm font-bold text-white",children:El(a)||"—"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Người nhận"}),s.jsx("p",{className:"text-sm font-medium text-indigo-200/80",children:Bn.accountNumber})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Ngày thanh toán"}),s.jsx("p",{className:"text-sm font-bold text-indigo-100/90",children:a.paidAt?yt(a.paidAt):"—"})]})]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-white/5",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-[10px] font-black text-white/30 uppercase tracking-[0.2em] leading-none",children:"Nội dung chuyển khoản"}),s.jsx("div",{className:"relative overflow-hidden rounded-2xl bg-slate-950/40 p-4 border border-white/5",children:s.jsxs("p",{className:"text-[13px] font-medium text-indigo-50 leading-relaxed italic",children:['"',a.note||"Không có nội dung ghi chú đi kèm.",'"']})})]})})]})})})]},a.id)})})]})})}),Tre=({open:e,amount:t,note:r,onClose:n,onAmountChange:a,onNoteChange:i})=>{const[o,l]=p.useState(t),[c,d]=p.useState(r);p.useEffect(()=>{e&&(l(t),d(r))},[e,t,r]);const u=p.useMemo(()=>{const v=o.replace(/[^\d]/g,"");if(!v)return 0;const b=Number(v);return Number.isFinite(b)?b:0},[o]),h=u>0?`${u.toLocaleString("vi-VN")} VND`:"Chưa Cập Nhật",f=p.useMemo(()=>d0({accountNumber:Bn.accountNumber,bankCode:Bn.bankCode,amount:u,description:c.trim(),accountName:Bn.accountHolder}),[u,c]),m=c.trim()||"Chưa có nội dung",x=()=>{const v=o.replace(/[^\d]/g,"");l(v),a(v)},g=()=>{const v=c.trim();d(v),i(v)};return e?s.jsx("div",{className:"fixed inset-0 z-[100] flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:s.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative z-[100]",children:[s.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:n,children:s.jsx(Pt,{className:"h-6 w-6"})}),s.jsxs("div",{className:"px-6 py-10 space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2",children:[s.jsx("h2",{className:"text-2xl font-semibold",children:"Tạo thông tin thanh toán qua QR Code"}),s.jsx("p",{className:"text-sm text-slate-300",children:"Quét mã QR để chuyển khoản nhanh. Nhập số tiền và nội dung để cập nhật chi tiết."})]}),s.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[s.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[s.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Quét mã QR để thanh toán"}),s.jsx("div",{className:"rounded-2xl bg-white p-4 relative z-0",children:s.jsx("img",{src:f,alt:"QR thanh toan",className:"h-64 w-64 object-contain relative z-0"})}),s.jsx("a",{href:f,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400 relative z-10",children:"Tải ảnh QR"}),s.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[s.jsxs("p",{children:["Ngân hàng: ",s.jsx("span",{className:"font-semibold",children:Bn.bankName})]}),s.jsxs("p",{children:["Số tài khoản:"," ",s.jsx("span",{className:"font-semibold",children:Bn.accountNumber})]}),s.jsxs("p",{children:["Chủ tài khoản:"," ",s.jsx("span",{className:"font-semibold uppercase",children:Bn.accountHolder})]}),s.jsxs("p",{children:["Số tiền:"," ",s.jsx("span",{className:"font-semibold text-rose-200",children:h})]}),s.jsxs("p",{children:["Nội dung:"," ",s.jsx("span",{className:"font-semibold text-violet-200",children:m})]})]})]}),s.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[s.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngân hàng"}),s.jsx("p",{className:"text-lg font-semibold text-white",children:Bn.bankName})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[s.jsx("span",{children:"Thụ hưởng"}),s.jsx("span",{className:"font-semibold text-white",children:Bn.accountHolder})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-sm text-slate-300",children:"Số Tài Khoản"}),s.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:Bn.accountNumber})]})]}),s.jsxs("div",{className:"space-y-5",children:[s.jsxs("div",{children:[s.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:x,children:"+ Thêm số tiền"}),s.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[s.jsx("input",{type:"text",placeholder:"Ví dụ: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:o,onChange:v=>l(v.target.value),onBlur:x}),s.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:x,children:"OK"})]})]}),s.jsxs("div",{children:[s.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:g,children:"+ Thêm nội dung"}),s.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[s.jsx("input",{type:"text",placeholder:"Nhập nội dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:c,onChange:v=>d(v.target.value),onBlur:g}),s.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:g,children:"Lưu"})]})]})]})]})]})]})]})}):null},kre=({open:e,receipt:t,onClose:r})=>!e||!t?null:s.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 px-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl relative z-[100]",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tiet bien nhan"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Đóng",children:s.jsx(Pt,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"px-5 py-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1",children:"Mã đơn"}),s.jsx("p",{className:"font-semibold text-gray-900",children:t.orderCode||"--"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1",children:"Ngày Thanh Toán"}),s.jsx("p",{className:"font-semibold text-gray-900",children:t.paidAt?yt(t.paidAt):"--"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1",children:"Người Gửi"}),s.jsx("p",{className:"font-semibold text-gray-900",children:El(t)||"--"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1",children:"Người Nhận"}),s.jsx("p",{className:"font-semibold text-gray-900",children:t.receiver||"--"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1",children:"Số Tiền"}),s.jsx("p",{className:"font-semibold text-gray-900",children:Jg(t.amount)})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Nội Dung Chuyển Khoản"}),s.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:t.note||"Không có ghi chú"})]})]}),s.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"Đóng"})})]})});function Are(){const[e,t]=p.useState(""),[r,n]=p.useState(""),[a,i]=p.useState(""),[o,l]=p.useState("receipt"),[c,d]=p.useState([]),[u,h]=p.useState(!1),[f,m]=p.useState(null),[x,g]=p.useState(!1),[v,b]=p.useState(null),[w,y]=p.useState(!1),[N,_]=p.useState(""),[S,j]=p.useState(""),[E,k]=p.useState(null),T=p.useRef(null);p.useEffect(()=>{(async()=>{try{h(!0),m(null);const le=await Ue("/api/payment-receipts");if(!le.ok)throw new Error("Không thể tải biên nhận.");const ce=await le.json(),pe=Array.isArray(ce?.receipts)?ce.receipts:Array.isArray(ce)?ce:[];d(pe.map(Nre))}catch(le){console.error(le),m(le instanceof Error?le.message:"Không thể tải biên nhận.")}finally{h(!1)}})()},[]);const A=p.useMemo(()=>{const Z=e.trim().toLowerCase(),le=Uf(r),ce=Uf(a);return c.filter(pe=>{const Ne=fp(pe.orderCode),ee=!Z||[pe.orderCode,pe.note,El(pe)].map(L=>L?.toLowerCase()??"").some(L=>L.includes(Z)),oe=Uf(yt(pe.paidAt)||""),he=le===null||oe===null||oe>=le,O=ce===null||oe===null||oe<=ce;return ee&&he&&O&&Ne===o})},[c,e,r,a,o]),C=p.useMemo(()=>{const Z=c.reduce((ce,pe)=>(pe.orderCode||"").toUpperCase().startsWith("MAV")?ce+pe.amount:ce,0),le=c.length>0?c[0].paidAt??"":"";return[{name:"Tổng Biên Nhận",value:c.length.toString(),icon:Vi,accent:wr.sky},{name:"Tổng Số Tiền",value:gre(Z),icon:Vi,accent:wr.emerald},{name:"Biên Nhận Gần Nhất",value:le?yt(le)??"--":"--",icon:qN,accent:wr.violet}]},[c]),R=p.useMemo(()=>c.reduce((Z,le)=>{const ce=fp(le.orderCode);return Z[ce]+=1,Z},{receipt:0,refund:0}),[c]),G=()=>{if(!A.length)return;const Z=_re(A),le=hp.book_new();hp.book_append_sheet(le,Z,"Biên nhận thanh toán");const ce=new Date().toISOString().slice(0,10).replace(/-/g,"");ire(le,`payment_receipts_${ce}.xlsx`)},V=u||A.length===0;p.useEffect(()=>{const Z=le=>{T.current&&!T.current.contains(le.target)&&g(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]);const X=r&&a?`${r} - ${a}`:"dd/mm/yyyy - dd/mm/yyyy",K=Z=>{b(le=>le===Z?null:Z)},Y=Z=>{k(Z)},q=()=>{k(null)};return s.jsxs(s.Fragment,{children:[s.jsx(Tre,{open:w,amount:N,note:S,onClose:()=>y(!1),onAmountChange:_,onNoteChange:j}),s.jsx(kre,{open:!!E,receipt:E,onClose:q}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("h1",{className:"text-4xl lg:text-5xl font-black text-white tracking-tighter",children:["Biên Nhận ",s.jsx("span",{className:"text-indigo-400",children:"Thanh Toán"})]}),s.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Digital Transaction Records & Ledger"})]}),s.jsx(jre,{stats:C}),s.jsx(Sre,{searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:a,dateRangeDisplay:X,rangePickerOpen:x,setRangePickerOpen:g,dateRangeRef:T,toDisplayDate:yre,toISODate:wre,onDateStartChange:n,onDateEndChange:i,onExport:G,exportDisabled:V,onAddReceipt:()=>y(!0)}),f&&s.jsx("div",{className:"text-sm text-red-600 px-1",children:f}),s.jsx(Ere,{activeCategory:o,counts:R,onChange:l}),s.jsx(Cre,{receipts:A,expandedReceiptId:v,onToggle:K,onSelectReceipt:Y}),!u&&A.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Không có Biên Nhận"}),s.jsx("div",{className:"text-white/60",children:"Thử từ khóa khác"})]}),u&&s.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"Đang tải dữ liệu..."})]})]})}const Pre=()=>s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("h1",{className:"text-4xl lg:text-5xl font-black text-white tracking-tighter",children:["Kho ",s.jsx("span",{className:"text-indigo-400",children:"Dữ Liệu"})]}),s.jsx("p",{className:"text-sm font-medium text-indigo-200/60 uppercase tracking-[0.3em]",children:"Central Storage & Inventory Ledger"})]}),Ore=({search:e,onSearchChange:t,onCreate:r,loading:n,error:a})=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.25)] backdrop-blur-sm relative z-10",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1 group",children:[s.jsx(vn,{className:`absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300 pointer-events-none z-10 transition-opacity duration-300 ${n?"opacity-30":"opacity-70 group-focus-within:opacity-100"}`}),s.jsx("input",{type:"text",placeholder:"Tìm kiếm tài khoản, danh mục, mật khẩu...",className:"w-full pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",style:{paddingLeft:"3.25rem"},value:e,onChange:i=>t(i.target.value)}),n&&s.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex gap-1",children:[s.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce"}),s.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce [animation-delay:0.2s]"}),s.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full animate-bounce [animation-delay:0.4s]"})]})]}),s.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto mt-2 lg:mt-0",children:[s.jsx("div",{className:"hidden lg:block w-px h-8 bg-white/10 mx-1"}),s.jsx(nn,{onClick:r,disabled:n,className:"!py-2.5 !px-6 text-sm whitespace-nowrap",children:"Tạo mới"})]})]})}),a&&s.jsxs("div",{className:"mx-2 text-sm text-rose-300 flex items-center gap-2 bg-rose-500/10 border border-rose-500/20 px-4 py-2 rounded-xl",children:[s.jsx(wp,{className:"h-5 w-5"}),s.jsx("span",{children:a})]})]}),Dre="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",Fc=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),Ire=({items:e,draft:t,editingId:r,loading:n,onDraftChange:a,onSave:i,onDelete:o,onCancel:l,onStartEdit:c})=>{const d=(u,h)=>s.jsx("input",{className:`${Dre} bg-white/5 border-white/5 focus:bg-white/10 text-white placeholder:text-white/20`,value:h||"",onChange:f=>a(u,f.target.value)});return s.jsx("div",{className:"storage-table bg-transparent overflow-visible",children:s.jsxs("table",{className:"storage-table__table min-w-full border-separate border-spacing-y-4 text-white",children:[s.jsx("thead",{className:"storage-table__head",children:s.jsxs("tr",{className:"storage-table__head-row [&>th]:px-5 [&>th]:pb-2 [&>th]:text-[11px] [&>th]:font-black [&>th]:uppercase [&>th]:tracking-[0.2em] [&>th]:text-indigo-300/70 [&>th]:text-left",children:[s.jsx("th",{className:"storage-table__th w-[120px]",children:"LOẠI"}),s.jsx("th",{className:"w-[180px]",children:"TÀI KHOẢN"}),s.jsx("th",{className:"w-[140px]",children:"MẬT KHẨU"}),s.jsx("th",{className:"w-[180px]",children:"MAIL DỰ PHÒNG"}),s.jsx("th",{className:"w-[120px]",children:"2FA"}),s.jsx("th",{className:"w-[120px]",children:"TRẠNG THÁI"}),s.jsx("th",{children:"GHI CHÚ"}),s.jsx("th",{className:"w-[140px] text-right pr-6",children:"THAO TÁC"})]})}),s.jsxs("tbody",{className:"",children:[r==="new"&&t&&s.jsxs("tr",{className:"group/row animate-in fade-in slide-in-from-top-2 duration-300 relative z-20",children:[s.jsx("td",{className:"px-5 py-5 first:rounded-l-[24px] glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("category",t.category)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("account",t.account)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("password",t.password)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("backup_email",t.backup_email)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("two_fa",t.two_fa)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("status",t.status)}),s.jsx("td",{className:"px-5 py-5 glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500",children:d("note",t.note)}),s.jsx("td",{className:"px-5 py-5 last:rounded-r-[24px] glass-panel border-y border-indigo-500/30 bg-indigo-500/10 transition-all duration-500 text-right pr-6",children:s.jsxs("div",{className:"inline-flex items-center gap-2",children:[s.jsx("button",{type:"button",className:"w-9 h-9 flex items-center justify-center rounded-xl bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 hover:bg-emerald-500/40 transition-all",onClick:()=>i(void 0),disabled:n,title:"Lưu",children:s.jsx(Wn,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"w-9 h-9 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all",onClick:l,disabled:n,title:"Hủy",children:s.jsx(Pt,{className:"h-4 w-4"})})]})})]}),e.length===0&&r!=="new"?s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-5 py-12 text-center",children:s.jsx("div",{className:"text-white/40 text-sm font-medium tracking-wide",children:"HỆ THỐNG TRỐNG: KHÔNG CÓ HÀNG TỒN KHO"})})}):e.map(u=>{const h=r===u.id,f=h&&t||u;return s.jsxs("tr",{className:`group/row cursor-pointer transition-all duration-500 relative ${h?"z-20":"z-10"}`,children:[s.jsx("td",{className:`px-5 py-5 first:rounded-l-[24px] glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:h?d("category",f.category):s.jsx("span",{className:"text-sm font-bold text-white tracking-wider uppercase whitespace-nowrap",children:u.category||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:s.jsx("div",{className:"text-sm font-bold text-white tracking-tight",children:h?d("account",f.account):u.account||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:s.jsx("div",{className:"text-[13px] font-medium text-white/80",children:h?d("password",f.password):u.password||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:s.jsx("div",{className:"text-[13px] font-medium text-white/60 italic",children:h?d("backup_email",f.backup_email):u.backup_email||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:h?d("two_fa",f.two_fa):s.jsx("span",{className:"text-xs font-black text-indigo-400/80",children:u.two_fa||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:h?d("status",f.status):s.jsx("span",{className:"inline-flex px-2.5 py-1 rounded-full border border-white/10 bg-white/5 text-[10px] font-bold uppercase tracking-wider text-indigo-200 whitespace-nowrap",children:u.status||"—"})}),s.jsx("td",{className:`px-5 py-5 glass-panel border-y transition-all duration-500 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:s.jsx("div",{className:"text-[12px] font-medium text-white/60 max-w-xs truncate",children:h?d("note",f.note):u.note||"—"})}),s.jsx("td",{className:`px-5 py-5 last:rounded-r-[24px] glass-panel border-y transition-all duration-500 text-right pr-6 ${h?"border-indigo-500/30 bg-indigo-500/10":"border-white/5 group-hover/row:border-indigo-500/30 group-hover/row:bg-indigo-500/5"}`,children:s.jsx("div",{className:"inline-flex items-center gap-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 hover:bg-emerald-500/40 transition-all",onClick:()=>i(u.id),disabled:n,title:"Lưu",children:s.jsx(Wn,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/20 border border-rose-500/40 text-rose-400 hover:bg-rose-500/40 transition-all",onClick:()=>o(u.id),disabled:n,title:"Xoá",children:s.jsx(Xr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-white hover:bg-white/10 transition-all",onClick:l,disabled:n,title:"Hủy",children:s.jsx(Pt,{className:"h-4 w-4"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-white/5 border border-white/10 text-indigo-300/60 hover:text-white hover:bg-indigo-500/20 transition-all",onClick:()=>c(u),disabled:n,title:"Sửa",children:s.jsx(ls,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded-xl bg-rose-500/10 border border-rose-500/20 text-rose-400 hover:bg-rose-500/30 transition-all",onClick:()=>o(u.id),disabled:n,title:"Xoá",children:s.jsx(Xr,{className:"h-4 w-4"})})]})})})]},u.id??`${u.category??""}-${u.account??""}`)})]})]})})};function Rre(){const[e,t]=p.useState([]),[r,n]=p.useState(!1),[a,i]=p.useState(null),[o,l]=p.useState(""),[c,d]=p.useState(null),[u,h]=p.useState(null);p.useEffect(()=>{let y=!0;const N=S=>S?Array.isArray(S)?S:Array.isArray(S.items)?S.items:[]:[];return(async()=>{n(!0),i(null);try{let S=await Ue(Je.WAREHOUSE);if(S.status===404&&(S=await Ue("/api/warehouses")),!S.ok)throw new Error(`Không thể tải dữ liệu (${S.status})`);const j=await S.json(),E=N(j);y&&t(E)}catch(S){y&&i(S?.message||"Lỗi không xác định")}finally{y&&n(!1)}})(),()=>{y=!1}},[]);const f=y=>{d(y.id??null),h({...y})},m=()=>{d(null),h(null)},x=(y,N)=>{h(_=>({..._||{},[y]:N}))},g=async y=>{if(!(!y&&c!=="new"||!u)){n(!0),i(null);try{if(c==="new"){const N=await Ue(Je.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!N.ok)throw new Error(`Tạo mới thất bại (${N.status})`);const _=await N.json();t(S=>[...S,_]),m()}else{const N=await Ue(`${Je.WAREHOUSE}/${y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!N.ok)throw new Error(`Cập nhật thất bại (${N.status})`);const _=await N.json();t(S=>S.map(j=>j.id===y?{...j,..._}:j)),m()}}catch(N){i(N?.message||"Lỗi khi cập nhật")}finally{n(!1)}}},v=async y=>{if(y&&confirm("Bạn có chắc muốn xóa bản ghi này?")){n(!0),i(null);try{const N=await Ue(`${Je.WAREHOUSE}/${y}`,{method:"DELETE"});if(!N.ok)throw new Error(`Xoá thất bại (${N.status})`);t(_=>_.filter(S=>S.id!==y)),c===y&&m()}catch(N){i(N?.message||"Lỗi khi xóa")}finally{n(!1)}}},b=()=>{d("new"),h({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Tồn"})},w=p.useMemo(()=>({filtered:e.filter(N=>{if(!o.trim())return!0;const _=Fc(o);return[N.category,N.account,N.password,N.backup_email,N.two_fa,N.note,N.status].some(S=>Fc(S).includes(_))}).sort((N,_)=>{const S=Fc(N.category),j=Fc(_.category);return S.localeCompare(j,"vi")})}),[e,o]);return s.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[s.jsx(Pre,{}),s.jsx(Ore,{search:o,onSearchChange:l,onCreate:b,loading:r,error:a}),s.jsx(Ire,{items:w.filtered,draft:u,editingId:c,loading:r,onDraftChange:x,onSave:g,onDelete:v,onCancel:m,onStartEdit:f,onStartCreate:b})]})}const tT={active:"Hoạt động",inactive:"Không hoạt động",suspended:"Tạm khóa"},Mre=[{value:"all",label:"Tất cả trạng thái"},{value:"active",label:"Hoạt động"},{value:"inactive",label:"Không hoạt động"},{value:"suspended",label:"Tạm khóa"}],Fre=[{id:2,code:"CTV",name:"Cộng Tác Viên"},{id:3,code:"CUSTOMER",name:"Khách"}],IN={"Kim cương":5,Vàng:4,Bạc:3,Đồng:2,Mới:1},RN={active:2,inactive:1,suspended:0};function Lre(e){return[...e].sort((t,r)=>{const n=IN[t.rank]??0,a=IN[r.rank]??0;if(a!==n)return a-n;const i=RN[t.status]??0;return(RN[r.status]??0)-i})}function rT(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(e)}const Bre={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",suspended:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function $re({item:e,index:t,onView:r,onEdit:n}){const a=tT[e.status],i=Bre[e.status];return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:t}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:e.account}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm font-medium text-white whitespace-nowrap",children:e.name}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/90 tabular-nums whitespace-nowrap",children:e.totalOrders.toLocaleString("vi-VN")}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right text-sm text-white/90 tabular-nums whitespace-nowrap",children:rT(e.totalAmount)}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/90 font-medium whitespace-nowrap",children:e.discount}),s.jsx("td",{className:"px-2 py-3 sm:px-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-medium ${i}`,children:a})}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Xem chi tiết",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-4 w-4"})})]})})]})}const Ure={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",suspended:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function Hre({item:e,index:t,onView:r,onEdit:n}){const a=tT[e.status],i=Ure[e.status];return s.jsx("div",{className:"rounded-2xl border border-white/10 bg-slate-800/40 p-4 shadow-lg backdrop-blur-sm",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-xs font-bold text-indigo-300/70 tabular-nums",children:["#",t]}),s.jsx("h3",{className:"text-base font-semibold text-white truncate",children:e.name}),s.jsx("span",{className:`inline-flex items-center rounded-lg border px-2 py-0.5 text-xs font-medium ${i}`,children:a})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1.5 text-sm",children:[s.jsx("div",{className:"text-white/60",children:"Tài khoản"}),s.jsx("div",{className:"text-white font-medium text-right truncate",children:e.account}),s.jsx("div",{className:"text-white/60",children:"Tổng đơn"}),s.jsx("div",{className:"text-white font-medium tabular-nums text-right",children:e.totalOrders.toLocaleString("vi-VN")}),s.jsx("div",{className:"text-white/60",children:"Tổng tiền"}),s.jsx("div",{className:"text-white font-medium tabular-nums text-right",children:rT(e.totalAmount)}),s.jsx("div",{className:"text-white/60",children:"Chiết khấu"}),s.jsx("div",{className:"text-white font-medium text-right",children:e.discount})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 shrink-0",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Xem chi tiết",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-5 w-5"})})]})]})})}async function zre(){const e=await Ue("/api/accounts");if(!e.ok)throw new Error("Không thể tải danh sách tài khoản");const t=await e.json().catch(()=>({}));return!t||!Array.isArray(t.items)?[]:t.items}const Hf=10;function Wre(){const[e,t]=p.useState(""),[r,n]=p.useState("all"),[a,i]=p.useState(1),[o,l]=p.useState("all"),[c,d]=p.useState([]),[u,h]=p.useState(!1),[f,m]=p.useState(null);p.useEffect(()=>{let _=!1;return(async()=>{try{h(!0),m(null);const j=await zre();if(_)return;const E=Lre(j.map(k=>({id:String(k.id),account:k.username||k.email||"",name:k.username||k.email||"",totalOrders:0,totalAmount:0,rank:"Mới",discount:"0%",status:k.isActive?"active":"inactive",roleId:Number(k.roleId)||0})));d(E)}catch(j){console.error(j),_||(m("Không thể tải danh sách tài khoản"),d([]))}finally{_||h(!1)}})(),()=>{_=!0}},[]);const x=p.useMemo(()=>Fre.map(_=>({role:_,count:c.filter(S=>Number(S.roleId)===_.id).length})),[c]),g=p.useMemo(()=>{let _=c;if(o!=="all"&&(_=_.filter(S=>Number(S.roleId)===o)),e.trim()){const S=e.trim().toLowerCase();_=_.filter(j=>j.name.toLowerCase().includes(S))}return r!=="all"&&(_=_.filter(S=>S.status===r)),_},[e,r,o]),v=g.length,b=(a-1)*Hf,w=g.slice(b,b+Hf),y=_=>{console.log("View",_)},N=_=>{console.log("Edit",_)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Danh sách ",s.jsx("span",{className:"text-indigo-400",children:"CTV"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Quản lý Cộng tác viên, hạng, chiết khấu và trạng thái"})]})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{type:"button",onClick:()=>{l("all"),i(1)},className:`px-3.5 py-1.5 rounded-2xl text-xs sm:text-sm font-medium transition-colors ${o==="all"?"bg-indigo-500 text-white shadow-md shadow-indigo-500/40":"bg-slate-900/70 text-indigo-200/80 hover:bg-slate-800"}`,children:["Tất cả"," ",s.jsx("span",{className:"ml-1 rounded-xl bg-black/20 px-2 py-0.5 text-[10px] font-semibold",children:c.length})]}),x.map(({role:_,count:S})=>s.jsxs("button",{type:"button",onClick:()=>{l(_.id),i(1)},className:`px-3.5 py-1.5 rounded-2xl text-xs sm:text-sm font-medium transition-colors ${o===_.id?"bg-indigo-500 text-white shadow-md shadow-indigo-500/40":"bg-slate-900/70 text-indigo-200/80 hover:bg-slate-800"}`,children:[_.name," ",s.jsx("span",{className:"ml-1 rounded-xl bg-black/20 px-2 py-0.5 text-[10px] font-semibold",children:S})]},_.id))]}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap gap-4 items-stretch lg:items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[240px]",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo tên hoặc tài khoản CTV...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:e,onChange:_=>{t(_.target.value),i(1)}})]}),s.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[180px] lg:w-[200px]",children:s.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:r,onChange:_=>{n(_.target.value),i(1)},children:Mre.map(_=>s.jsx("option",{value:_.value,className:"bg-slate-900 text-white",children:_.label},_.value))})})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:w.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy CTV nào"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Thử thay đổi từ khóa hoặc bộ lọc"})]}):s.jsx(Si,{data:w,renderCard:(_,S)=>s.jsx(Hre,{item:_,index:b+S+1,onView:y,onEdit:N}),className:"p-4"}),children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[120px]",children:"TÀI KHOẢN"}),s.jsx("th",{className:"min-w-[140px]",children:"TÊN CTV"}),s.jsx("th",{className:"w-24 text-center",children:"TỔNG ĐƠN"}),s.jsx("th",{className:"w-32 text-right",children:"TỔNG TIỀN"}),s.jsx("th",{className:"w-24 text-center",children:"CHIẾT KHẤU"}),s.jsx("th",{className:"w-28",children:"TRẠNG THÁI"}),s.jsx("th",{className:"w-28 text-right pr-4",children:"THAO TÁC"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:w.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:8,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:"Không tìm thấy CTV nào"}),s.jsx("p",{className:"text-sm text-white/60",children:"Thử thay đổi từ khóa hoặc bộ lọc"})]})}):w.map((_,S)=>s.jsx($re,{item:_,index:b+S+1,onView:y,onEdit:N},_.id))})]})}),v>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:a,totalItems:v,pageSize:Hf,onPageChange:i})})]})]})}const nT={active:"Đang áp dụng",inactive:"Tạm dừng",expired:"Hết hạn"},Vre=[{value:"all",label:"Tất cả trạng thái"},{value:"active",label:"Đang áp dụng"},{value:"inactive",label:"Tạm dừng"},{value:"expired",label:"Hết hạn"}],Kre=[{id:"1",promoCode:"GIAM10",account:"nguyenvana",usedAt:"25/02/2025 14:30",orderCode:"DH001",discountAmount:"50.000₫"},{id:"2",promoCode:"TET2025",account:"tranthib",usedAt:"24/02/2025 10:15",orderCode:"DH002",discountAmount:"15%"},{id:"3",promoCode:"NEWUSER",account:"levanc",usedAt:"23/02/2025 09:00",orderCode:"DH003",discountAmount:"50.000₫"},{id:"4",promoCode:"VIP20",account:"hoangvane",usedAt:"22/02/2025 16:45",orderCode:"DH004",discountAmount:"20%"},{id:"5",promoCode:"GIAM10",account:"phamthid",usedAt:"21/02/2025 11:20",orderCode:"DH005",discountAmount:"45.000₫"}],Gre={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",expired:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function Xre(e){const{item:t,index:r,onView:n,onEdit:a}=e,i=nT[t.status],o=Gre[t.status];return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:r}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm font-medium text-indigo-200 font-mono whitespace-nowrap",children:t.code}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 font-medium whitespace-nowrap",children:t.discount}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:t.max}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/80 whitespace-nowrap max-w-[200px] truncate",title:t.condition,children:t.condition}),s.jsx("td",{className:"px-2 py-3 sm:px-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-medium "+o,children:i})}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx("button",{type:"button",onClick:()=>n(t),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Xem",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>a(t),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-4 w-4"})})]})})]})}const Yre={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",expired:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function qre({item:e,index:t,onView:r,onEdit:n}){const a=nT[e.status],i=Yre[e.status];return s.jsx("div",{className:"rounded-2xl border border-white/10 bg-slate-800/40 p-4 shadow-lg backdrop-blur-sm",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-xs font-bold text-indigo-300/70 tabular-nums",children:["#",t]}),s.jsx("span",{className:"text-base font-mono font-semibold text-indigo-200",children:e.code}),s.jsx("span",{className:`inline-flex items-center rounded-lg border px-2 py-0.5 text-xs font-medium ${i}`,children:a})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1.5 text-sm",children:[s.jsx("div",{className:"text-white/60",children:"Chiết khấu"}),s.jsx("div",{className:"text-white font-medium text-right",children:e.discount}),s.jsx("div",{className:"text-white/60",children:"Tối đa"}),s.jsx("div",{className:"text-white/90 text-right",children:e.max}),s.jsx("div",{className:"text-white/60",children:"Điều kiện"}),s.jsx("div",{className:"text-white/90 text-right truncate",title:e.condition,children:e.condition})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 shrink-0",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Xem",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-5 w-5"})})]})]})})}function Zre({item:e,index:t}){return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:t}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm font-medium text-indigo-200 font-mono whitespace-nowrap",children:e.promoCode}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:e.account}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/80 whitespace-nowrap",children:e.usedAt}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 font-mono whitespace-nowrap",children:e.orderCode??"—"}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 font-medium whitespace-nowrap",children:e.discountAmount})]})}function MN(e){return e==null||!Number.isFinite(e)?"—":new Intl.NumberFormat("vi-VN",{style:"decimal",maximumFractionDigits:0}).format(e)+"₫"}function Jre(e){const t=(e||"").toLowerCase();return t==="active"||t==="applying"?"active":t==="expired"||t==="het_han"?"expired":"inactive"}async function Qre(){const e=await Ue("/api/promotion-codes");if(!e.ok)throw new Error("Không thể tải danh sách mã khuyến mãi");const t=await e.json().catch(()=>({}));return!t||!Array.isArray(t.items)?[]:t.items}function ene(e){const t=e.discountPercent!=null&&Number.isFinite(e.discountPercent)?`${Number(e.discountPercent)}%`:e.description||"—",r=e.maxDiscountAmount!=null&&Number.isFinite(e.maxDiscountAmount)?MN(e.maxDiscountAmount):"Không giới hạn",n=e.minOrderAmount!=null&&Number.isFinite(e.minOrderAmount)?`Đơn từ ${MN(e.minOrderAmount)}`:e.description||"—";return{id:String(e.id),code:e.code??"",discount:t,max:r,condition:n,status:Jre(e.status)}}const Ds=10;function tne(){const[e,t]=p.useState("list"),[r,n]=p.useState(""),[a,i]=p.useState("all"),[o,l]=p.useState(1),[c,d]=p.useState(1),[u,h]=p.useState(""),[f,m]=p.useState([]),[x,g]=p.useState(!1),[v,b]=p.useState(null);p.useEffect(()=>{let C=!1;return(async()=>{try{g(!0),b(null);const G=await Qre();if(C)return;m(G.map(ene))}catch{C||(b("Không thể tải danh sách mã khuyến mãi"),m([]))}finally{C||g(!1)}})(),()=>{C=!0}},[]);const w=p.useMemo(()=>{let C=f;if(r.trim()){const R=r.trim().toLowerCase();C=C.filter(G=>G.code.toLowerCase().includes(R)||G.discount.toLowerCase().includes(R)||G.condition.toLowerCase().includes(R))}return a!=="all"&&(C=C.filter(R=>R.status===a)),C},[f,r,a]),y=w.length,N=(o-1)*Ds,_=w.slice(N,N+Ds),S=p.useMemo(()=>{let C=Kre;if(u.trim()){const R=u.trim().toLowerCase();C=C.filter(G=>G.promoCode.toLowerCase().includes(R)||G.account.toLowerCase().includes(R)||(G.orderCode?.toLowerCase().includes(R)??!1)||G.discountAmount.toLowerCase().includes(R)||G.usedAt.toLowerCase().includes(R))}return C},[u]),j=(c-1)*Ds,E=S.slice(j,j+Ds),k=S.length,T=C=>{console.log("View",C)},A=C=>{console.log("Edit",C)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Mã ",s.jsx("span",{className:"text-indigo-400",children:"khuyến mãi"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Quản lý mã giảm giá, chiết khấu và điều kiện áp dụng"})]})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("button",{type:"button",onClick:()=>{t("list"),l(1)},className:`px-3.5 py-1.5 rounded-2xl text-xs sm:text-sm font-medium transition-colors ${e==="list"?"bg-indigo-500 text-white shadow-md shadow-indigo-500/40":"bg-slate-900/70 text-indigo-200/80 hover:bg-slate-800"}`,children:"Danh sách mã khuyến mãi"}),s.jsx("button",{type:"button",onClick:()=>{t("history"),d(1)},className:`px-3.5 py-1.5 rounded-2xl text-xs sm:text-sm font-medium transition-colors ${e==="history"?"bg-indigo-500 text-white shadow-md shadow-indigo-500/40":"bg-slate-900/70 text-indigo-200/80 hover:bg-slate-800"}`,children:"Lịch sử sử dụng mã khuyến mãi"})]}),e==="list"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:[v&&s.jsx("div",{className:"mb-4 rounded-xl bg-red-500/15 border border-red-500/30 px-4 py-2 text-sm text-red-200",children:v}),s.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap gap-4 items-stretch lg:items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[240px]",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo mã, chiết khấu, điều kiện...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:r,onChange:C=>{n(C.target.value),l(1)}})]}),s.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[180px] lg:w-[200px]",children:s.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:a,onChange:C=>{i(C.target.value),l(1)},children:Vre.map(C=>s.jsx("option",{value:C.value,className:"bg-slate-900 text-white",children:C.label},C.value))})})]})]}),s.jsx("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:x?s.jsx("div",{className:"p-12 text-center text-white/70",children:"Đang tải danh sách mã khuyến mãi..."}):s.jsxs(s.Fragment,{children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:_.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"text-white/70 text-lg mb-2",children:f.length===0?"Chưa có mã khuyến mãi":"Không tìm thấy mã khuyến mãi nào"}),s.jsx("p",{className:"text-white/60 text-sm",children:f.length===0?"":"Thử thay đổi từ khóa hoặc bộ lọc"})]}):s.jsx(Si,{data:_,renderCard:(C,R)=>s.jsx(qre,{item:C,index:N+R+1,onView:T,onEdit:A}),className:"p-4"}),children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[120px]",children:"MÃ KHUYẾN MÃI"}),s.jsx("th",{className:"min-w-[90px]",children:"CHIẾT KHẤU"}),s.jsx("th",{className:"min-w-[100px]",children:"TỐI ĐA"}),s.jsx("th",{className:"min-w-[140px]",children:"ĐIỀU KIỆN"}),s.jsx("th",{className:"w-28",children:"TRẠNG THÁI"}),s.jsx("th",{className:"w-28 text-right pr-4",children:"THAO TÁC"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:_.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:f.length===0?"Chưa có mã khuyến mãi":"Không tìm thấy mã khuyến mãi nào"}),s.jsx("p",{className:"text-sm text-white/60",children:f.length===0?"":"Thử thay đổi từ khóa hoặc bộ lọc"})]})}):_.map((C,R)=>s.jsx(Xre,{item:C,index:N+R+1,onView:T,onEdit:A},C.id))})]})}),y>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:o,totalItems:y,pageSize:Ds,onPageChange:l})})]})})]}),e==="history"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"relative w-full max-w-md",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo mã KM, tài khoản, mã đơn, giảm giá...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:u,onChange:C=>{h(C.target.value),d(1)}})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!1,children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[120px]",children:"MÃ KHUYẾN MÃI"}),s.jsx("th",{className:"min-w-[120px]",children:"TÀI KHOẢN"}),s.jsx("th",{className:"min-w-[140px]",children:"THỜI GIAN SỬ DỤNG"}),s.jsx("th",{className:"min-w-[100px]",children:"MÃ ĐƠN"}),s.jsx("th",{className:"min-w-[100px]",children:"GIẢM GIÁ"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:E.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:"Chưa có lịch sử sử dụng"}),s.jsx("p",{className:"text-sm text-white/60",children:"Dữ liệu sẽ hiển thị khi có mã được sử dụng"})]})}):E.map((C,R)=>s.jsx(Zre,{item:C,index:j+R+1},C.id))})]})}),k>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:c,totalItems:k,pageSize:Ds,onPageChange:d})})]})]})]})}const aT={active:"Hoạt động",inactive:"Không hoạt động",suspended:"Tạm khóa"},rne=[{value:"all",label:"Tất cả trạng thái"},{value:"active",label:"Hoạt động"},{value:"inactive",label:"Không hoạt động"},{value:"suspended",label:"Tạm khóa"}],nne=[{id:"1",account:"nguyenvana",lastName:"Nguyễn Văn",firstName:"A",email:"nguyenvana@email.com",balance:52e5,totalSpent:128e6,rank:"Vàng",status:"active"},{id:"2",account:"tranthib",lastName:"Trần Thị",firstName:"B",email:"tranthib@email.com",balance:28e5,totalSpent:85e6,rank:"Bạc",status:"active"},{id:"3",account:"levanc",lastName:"Lê Văn",firstName:"C",email:"levanc@email.com",balance:0,totalSpent:42e6,rank:"Đồng",status:"active"},{id:"4",account:"phamthid",lastName:"Phạm Thị",firstName:"D",email:"phamthid@email.com",balance:15e5,totalSpent:12e6,rank:"Mới",status:"inactive"},{id:"5",account:"hoangvane",lastName:"Hoàng Văn",firstName:"E",email:"hoangvane@email.com",balance:15e6,totalSpent:52e7,rank:"Kim cương",status:"active"},{id:"6",account:"vothif",lastName:"Võ Thị",firstName:"F",email:"vothif@email.com",balance:0,totalSpent:0,rank:"Mới",status:"suspended"}];function fd(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(e)}const ane={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",suspended:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function ine({item:e,index:t,onView:r,onEdit:n}){const a=aT[e.status],i=ane[e.status];return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:t}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:e.account}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:e.lastName}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm font-medium text-white whitespace-nowrap",children:e.firstName}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/80 whitespace-nowrap max-w-[180px] truncate",title:e.email,children:e.email}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right text-sm text-white/90 tabular-nums whitespace-nowrap",children:fd(e.balance)}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right text-sm text-white/90 tabular-nums whitespace-nowrap",children:fd(e.totalSpent)}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center whitespace-nowrap",children:s.jsx("span",{className:"inline-flex items-center rounded-lg bg-indigo-500/20 px-2.5 py-0.5 text-xs font-medium text-indigo-300 border border-indigo-500/30",children:e.rank})}),s.jsx("td",{className:"px-2 py-3 sm:px-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-medium ${i}`,children:a})}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Xem chi tiết",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-4 w-4"})})]})})]})}const sne={active:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",inactive:"bg-slate-500/20 text-slate-400 border-slate-500/30",suspended:"bg-amber-500/20 text-amber-300 border-amber-500/30"};function one({item:e,index:t,onView:r,onEdit:n}){const a=aT[e.status],i=sne[e.status];return s.jsx("div",{className:"rounded-2xl border border-white/10 bg-slate-800/40 p-4 shadow-lg backdrop-blur-sm",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-xs font-bold text-indigo-300/70 tabular-nums",children:["#",t]}),s.jsx("span",{className:"text-sm text-white/70",children:e.account}),s.jsxs("h3",{className:"text-base font-semibold text-white truncate",children:[e.lastName," ",e.firstName]}),s.jsx("span",{className:`inline-flex items-center rounded-lg border px-2 py-0.5 text-xs font-medium ${i}`,children:a})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1.5 text-sm",children:[s.jsx("div",{className:"text-white/60",children:"Email"}),s.jsx("div",{className:"text-white/90 truncate text-right",children:e.email}),s.jsx("div",{className:"text-white/60",children:"Số dư"}),s.jsx("div",{className:"text-white font-medium tabular-nums text-right",children:fd(e.balance)}),s.jsx("div",{className:"text-white/60",children:"Tổng tiêu"}),s.jsx("div",{className:"text-white font-medium tabular-nums text-right",children:fd(e.totalSpent)}),s.jsx("div",{className:"text-white/60",children:"Hạng"}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"inline-flex items-center rounded-lg bg-indigo-500/20 px-2 py-0.5 text-xs font-medium text-indigo-300 border border-indigo-500/30",children:e.rank})})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 shrink-0",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Xem chi tiết",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-5 w-5"})})]})]})})}const zf=10;function lne(){const[e,t]=p.useState(""),[r,n]=p.useState("all"),[a,i]=p.useState(1),o=p.useMemo(()=>{let f=nne;if(e.trim()){const m=e.trim().toLowerCase();f=f.filter(x=>x.account.toLowerCase().includes(m)||x.firstName.toLowerCase().includes(m)||x.lastName.toLowerCase().includes(m)||x.email.toLowerCase().includes(m))}return r!=="all"&&(f=f.filter(m=>m.status===r)),f},[e,r]),l=o.length,c=(a-1)*zf,d=o.slice(c,c+zf),u=f=>{console.log("View",f)},h=f=>{console.log("Edit",f)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Trạng thái ",s.jsx("span",{className:"text-indigo-400",children:"khách hàng"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Xem số dư, tổng tiêu, hạng và trạng thái khách hàng"})]})}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:flex-wrap gap-4 items-stretch lg:items-center",children:[s.jsxs("div",{className:"relative w-full lg:flex-1 lg:min-w-[240px]",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo tài khoản, họ tên, email...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:e,onChange:f=>{t(f.target.value),i(1)}})]}),s.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[180px] lg:w-[200px]",children:s.jsx("select",{className:"w-full px-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none cursor-pointer transition-all appearance-none",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%23818cf8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='m19.5 8.25-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E")`,backgroundPosition:"right 1rem center",backgroundRepeat:"no-repeat",backgroundSize:"1.1rem",paddingRight:"2.5rem"},value:r,onChange:f=>{n(f.target.value),i(1)},children:rne.map(f=>s.jsx("option",{value:f.value,className:"bg-slate-900 text-white",children:f.label},f.value))})})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:d.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy khách hàng nào"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Thử thay đổi từ khóa hoặc bộ lọc"})]}):s.jsx(Si,{data:d,renderCard:(f,m)=>s.jsx(one,{item:f,index:c+m+1,onView:u,onEdit:h}),className:"p-4"}),children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[100px]",children:"TÀI KHOẢN"}),s.jsx("th",{className:"min-w-[100px]",children:"HỌ"}),s.jsx("th",{className:"min-w-[80px]",children:"TÊN"}),s.jsx("th",{className:"min-w-[160px]",children:"EMAIL"}),s.jsx("th",{className:"w-28 text-right",children:"SỐ DƯ"}),s.jsx("th",{className:"w-28 text-right",children:"TỔNG TIÊU"}),s.jsx("th",{className:"w-24 text-center",children:"HẠNG"}),s.jsx("th",{className:"w-28",children:"TRẠNG THÁI"}),s.jsx("th",{className:"w-28 text-right pr-4",children:"THAO TÁC"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:d.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:10,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:"Không tìm thấy khách hàng nào"}),s.jsx("p",{className:"text-sm text-white/60",children:"Thử thay đổi từ khóa hoặc bộ lọc"})]})}):d.map((f,m)=>s.jsx(ine,{item:f,index:c+m+1,onView:u,onEdit:h},f.id))})]})}),l>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:a,totalItems:l,pageSize:zf,onPageChange:i})})]})]})}const cne=[{id:"1",account:"nguyenvana",type:"add",amount:5e4,description:"Nạp thưởng đăng ký",createdAt:"2025-02-20T10:30:00.000Z"},{id:"2",account:"tranthib",type:"spend",amount:2e4,description:"Đổi quà",createdAt:"2025-02-21T14:15:00.000Z"},{id:"3",account:"hoangvane",type:"add",amount:1e5,description:"Nạp Mcoin",createdAt:"2025-02-22T09:00:00.000Z"}];function mp(e){return new Intl.NumberFormat("vi-VN",{maximumFractionDigits:0}).format(e)+" xu"}function FN(e){const t=new Date(e);return new Intl.DateTimeFormat("vi-VN",{dateStyle:"short",timeStyle:"short"}).format(t)}const Wf=10;function une({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState(null);if(p.useEffect(()=>{e&&(a(""),o(""),c(""),u(null))},[e]),!e)return null;const h=m=>{m.preventDefault(),u(null);const x=n.trim();if(!x){u("Vui lòng nhập tài khoản.");return}const g=i===""?0:parseInt(i.replace(/\D/g,""),10)||0;if(g<=0){u("Số xu phải lớn hơn 0.");return}const v={id:String(Date.now()),account:x,type:"add",amount:g,description:l.trim(),createdAt:new Date().toISOString()};r(v),t(),br({type:"success",message:`Đã nạp ${mp(g)} cho tài khoản ${x}.`})},f=m=>{o(m.target.value.replace(/\D/g,""))};return s.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-slate-950/80 backdrop-blur-sm p-4",onClick:t,role:"presentation",children:s.jsxs("div",{className:"glass-panel-dark rounded-[32px] shadow-2xl w-full max-w-md p-8 border border-white/10",onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":"add-coin-title",children:[s.jsx("h3",{id:"add-coin-title",className:"text-2xl font-bold text-white mb-6 tracking-tight",children:"Add coin"}),d&&s.jsx("p",{className:"text-sm text-red-400 mb-3",children:d}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-indigo-300/50 mb-2 ml-1",children:"Tài khoản"}),s.jsx("input",{type:"text",className:"w-full bg-white/5 border border-white/10 rounded-2xl p-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-white/30",placeholder:"Nhập tài khoản...",value:n,onChange:m=>a(m.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-indigo-300/50 mb-2 ml-1",children:"Số xu"}),s.jsx("input",{type:"text",inputMode:"numeric",className:"w-full bg-white/5 border border-white/10 rounded-2xl p-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-white/30 tabular-nums",placeholder:"Nhập số xu...",value:i,onChange:f})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-indigo-300/50 mb-2 ml-1",children:"Mô tả"}),s.jsx("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-2xl p-3 text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-white/30 resize-none",placeholder:"Mô tả (tùy chọn)",rows:3,value:l,onChange:m=>c(m.target.value)})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"px-6 py-2.5 text-sm font-bold text-white/40 hover:text-white transition-colors",children:"Hủy"}),s.jsx(nn,{type:"submit",className:"!py-2.5 !px-8 text-sm",children:"Xác nhận"})]})]})]})})}function dne(){const[e,t]=p.useState(cne),[r,n]=p.useState(""),[a,i]=p.useState(1),[o,l]=p.useState(!1),c=p.useMemo(()=>{if(!r.trim())return e;const m=r.trim().toLowerCase();return e.filter(x=>x.account.toLowerCase().includes(m)||x.description.toLowerCase().includes(m))},[e,r]),d=c.length,u=(a-1)*Wf,h=c.slice(u,u+Wf),f=m=>{t(x=>[m,...x]),i(1)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Add ",s.jsx("span",{className:"text-indigo-400",children:"Mcoin"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Lịch sử nạp và tiêu coin của khách hàng"})]}),s.jsx(nn,{icon:Ra,onClick:()=>l(!0),className:"shrink-0",children:"Add coin"})]}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7)] backdrop-blur-sm",children:s.jsxs("div",{className:"relative w-full max-w-md",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo tài khoản, mô tả...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:r,onChange:m=>{n(m.target.value),i(1)}})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:h.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"text-white/70 text-lg mb-2",children:"Chưa có giao dịch nào"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Thử thay đổi từ khóa hoặc thêm giao dịch"})]}):s.jsx(Si,{data:h,renderCard:(m,x)=>{const g=m,v=g.type==="add";return s.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-800/40 p-4 shadow-lg backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-xs font-bold text-indigo-300/70 tabular-nums",children:["#",u+x+1]}),s.jsx("span",{className:"text-sm font-medium text-white",children:g.account}),s.jsx("span",{className:v?"inline-flex rounded-lg border px-2 py-0.5 text-xs font-medium bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"inline-flex rounded-lg border px-2 py-0.5 text-xs font-medium bg-rose-500/20 text-rose-300 border-rose-500/30",children:v?"Nạp":"Tiêu"})]}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-x-4 gap-y-1.5 text-sm",children:[s.jsx("div",{className:"text-white/60",children:"Số xu"}),s.jsxs("div",{className:`tabular-nums text-right font-medium ${v?"text-emerald-300":"text-rose-300"}`,children:[v?"+":"-",mp(g.amount)]}),s.jsx("div",{className:"text-white/60",children:"Mô tả"}),s.jsx("div",{className:"text-white/90 text-right truncate",children:g.description||"—"}),s.jsx("div",{className:"text-white/60",children:"Thời gian"}),s.jsx("div",{className:"text-white/80 text-right text-xs",children:FN(g.createdAt)})]})]},g.id)},className:"p-4"}),children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[100px]",children:"TÀI KHOẢN"}),s.jsx("th",{className:"w-24 text-center",children:"LOẠI"}),s.jsx("th",{className:"w-28 text-right",children:"SỐ XU"}),s.jsx("th",{className:"min-w-[140px]",children:"MÔ TẢ"}),s.jsx("th",{className:"min-w-[120px]",children:"THỜI GIAN"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:h.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:6,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:"Chưa có giao dịch nào"}),s.jsx("p",{className:"text-sm text-white/60",children:"Thử thay đổi từ khóa hoặc thêm giao dịch"})]})}):h.map((m,x)=>{const g=m.type==="add";return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:u+x+1}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:m.account}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center whitespace-nowrap",children:s.jsx("span",{className:g?"inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-medium bg-emerald-500/20 text-emerald-300 border-emerald-500/30":"inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-medium bg-rose-500/20 text-rose-300 border-rose-500/30",children:g?"Nạp":"Tiêu"})}),s.jsxs("td",{className:`px-2 py-3 sm:px-4 text-right text-sm tabular-nums whitespace-nowrap ${g?"text-emerald-300":"text-rose-300"}`,children:[g?"+":"-",mp(m.amount)]}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/80 whitespace-nowrap max-w-[200px] truncate",title:m.description,children:m.description||"—"}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/70 whitespace-nowrap",children:FN(m.createdAt)})]},m.id)})})]})}),d>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:a,totalItems:d,pageSize:Wf,onPageChange:i})})]}),s.jsx(une,{isOpen:o,onClose:()=>l(!1),onSuccess:f})]})}const LN=[{id:"1",product:"Gói Premium 1 tháng",key:"XXXX-XXXX-XXXX-AAAA",expiry:"31/03/2025"},{id:"2",product:"Gói Premium 3 tháng",key:"YYYY-YYYY-YYYY-BBBB",expiry:"30/06/2025"},{id:"3",product:"Gói Premium 1 năm",key:"ZZZZ-ZZZZ-ZZZZ-CCCC",expiry:"31/12/2025"},{id:"4",product:"Gói Basic 1 tháng",key:"AAAA-BBBB-CCCC-DDDD",expiry:"15/04/2025"},{id:"5",product:"Gói Premium 1 tháng",key:"EEEE-FFFF-GGGG-HHHH",expiry:"20/05/2025"},{id:"6",product:"Gói Trial 7 ngày",key:"IIII-JJJJ-KKKK-LLLL",expiry:"28/02/2025"}];function hne({item:e,index:t,onView:r,onEdit:n}){return s.jsxs("tr",{className:"group border-b border-white/5 hover:bg-white/[0.03] transition-colors",children:[s.jsx("td",{className:"px-2 py-3 sm:px-4 text-center text-sm text-white/80 tabular-nums whitespace-nowrap",children:t}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm font-medium text-white whitespace-nowrap",children:e.product}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-indigo-200 font-mono whitespace-nowrap",children:e.key}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-sm text-white/90 whitespace-nowrap",children:e.expiry}),s.jsx("td",{className:"px-2 py-3 sm:px-4 text-right whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Xem",children:s.jsx(dr,{className:"h-4 w-4"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 hover:text-white transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-4 w-4"})})]})})]})}function fne({item:e,index:t,onView:r,onEdit:n}){return s.jsx("div",{className:"rounded-2xl border border-white/10 bg-slate-800/40 p-4 shadow-lg backdrop-blur-sm",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsxs("span",{className:"text-xs font-bold text-indigo-300/70 tabular-nums",children:["#",t]}),s.jsx("span",{className:"text-base font-semibold text-white",children:e.product})]}),s.jsxs("div",{className:"mt-3 space-y-1.5 text-sm",children:[s.jsxs("div",{className:"flex justify-between gap-2",children:[s.jsx("span",{className:"text-white/60 shrink-0",children:"Key"}),s.jsx("span",{className:"text-indigo-200 font-mono truncate text-right",children:e.key})]}),s.jsxs("div",{className:"flex justify-between gap-2",children:[s.jsx("span",{className:"text-white/60 shrink-0",children:"Thời hạn"}),s.jsx("span",{className:"text-white/90",children:e.expiry})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-1.5 shrink-0",children:[s.jsx("button",{type:"button",onClick:()=>r(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Xem",children:s.jsx(dr,{className:"h-5 w-5"})}),s.jsx("button",{type:"button",onClick:()=>n(e),className:"p-2 rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition-colors",title:"Chỉnh sửa",children:s.jsx(cr,{className:"h-5 w-5"})})]})]})})}const Vf=10;function mne(){const[e,t]=p.useState(""),[r,n]=p.useState(1),a=p.useMemo(()=>{if(!e.trim())return LN;const u=e.trim().toLowerCase();return LN.filter(h=>h.product.toLowerCase().includes(u)||h.key.toLowerCase().includes(u)||h.expiry.toLowerCase().includes(u))},[e]),i=a.length,o=(r-1)*Vf,l=a.slice(o,o+Vf),c=u=>{console.log("View",u)},d=u=>{console.log("Edit",u)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("h1",{className:"text-3xl font-bold text-white tracking-tight",children:["Quản lí ",s.jsx("span",{className:"text-indigo-400",children:"Key active"})]}),s.jsx("p",{className:"text-sm font-medium text-white/50 tracking-wide",children:"Xem và quản lý key kích hoạt sản phẩm"})]})}),s.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-4 lg:p-5 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:s.jsxs("div",{className:"relative w-full max-w-md",children:[s.jsx(vn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-indigo-300/70 pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Tìm theo sản phẩm, key, thời hạn...",className:"w-full pl-11 pr-4 py-2.5 border border-white/10 rounded-2xl bg-slate-950/40 text-sm text-white focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-400 outline-none transition-all placeholder:text-slate-400/70",value:e,onChange:u=>{t(u.target.value),n(1)}})]})}),s.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[s.jsx(Wa,{showCardOnMobile:!0,cardView:l.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("p",{className:"text-white/70 text-lg mb-2",children:"Không tìm thấy key nào"}),s.jsx("p",{className:"text-white/60 text-sm",children:"Thử thay đổi từ khóa tìm kiếm"})]}):s.jsx(Si,{data:l,renderCard:(u,h)=>s.jsx(fne,{item:u,index:o+h+1,onView:c,onEdit:d}),className:"p-4"}),children:s.jsxs("table",{className:"min-w-full divide-y divide-white/5 text-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"[&>th]:px-2 [&>th]:sm:px-4 [&>th]:py-3 [&>th]:text-[10px] [&>th]:sm:text-[11px] [&>th]:font-bold [&>th]:uppercase [&>th]:tracking-[0.1em] [&>th]:text-indigo-300/70 [&>th]:text-left [&>th]:bg-white/[0.03] [&>th]:whitespace-nowrap",children:[s.jsx("th",{className:"w-12 text-center",children:"STT"}),s.jsx("th",{className:"min-w-[160px]",children:"SẢN PHẨM"}),s.jsx("th",{className:"min-w-[200px]",children:"KEY"}),s.jsx("th",{className:"min-w-[100px]",children:"THỜI HẠN"}),s.jsx("th",{className:"w-28 text-right pr-4",children:"THAO TÁC"})]})}),s.jsx("tbody",{className:"divide-y divide-white/5",children:l.length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center text-white/70",children:[s.jsx("p",{className:"text-lg mb-2",children:"Không tìm thấy key nào"}),s.jsx("p",{className:"text-sm text-white/60",children:"Thử thay đổi từ khóa tìm kiếm"})]})}):l.map((u,h)=>s.jsx(hne,{item:u,index:o+h+1,onView:c,onEdit:d},u.id))})]})}),i>0&&s.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 px-4 py-3 sm:px-6",children:s.jsx(gi,{currentPage:r,totalItems:i,pageSize:Vf,onPageChange:n})})]})]})}function pne(){return s.jsxs(UN,{children:[s.jsx(Jt,{path:"/",element:s.jsx(Kf,{to:"/dashboard",replace:!0})}),s.jsx(Jt,{path:"/dashboard",element:s.jsx(YW,{})}),s.jsx(Jt,{path:"/orders",element:s.jsx(FV,{})}),s.jsx(Jt,{path:"/package-products",element:s.jsx(lK,{})}),s.jsx(Jt,{path:"/product-info",element:s.jsx(KK,{})}),s.jsx(Jt,{path:"/sources",element:s.jsx(DG,{})}),s.jsx(Jt,{path:"/pricing",element:s.jsx(xG,{})}),s.jsx(Jt,{path:"/bill-order",element:s.jsx(tX,{})}),s.jsx(Jt,{path:"/show-price",element:s.jsx(KG,{})}),s.jsx(Jt,{path:"/invoices",element:s.jsx(Are,{})}),s.jsx(Jt,{path:"/warehouse",element:s.jsx(Rre,{})}),s.jsx(Jt,{path:"/ctv",element:s.jsx(Wre,{})}),s.jsx(Jt,{path:"/promo-codes",element:s.jsx(tne,{})}),s.jsx(Jt,{path:"/customer-status",element:s.jsx(lne,{})}),s.jsx(Jt,{path:"/add-mcoin",element:s.jsx(dne,{})}),s.jsx(Jt,{path:"/active-keys",element:s.jsx(mne,{})}),s.jsx(Jt,{path:"*",element:s.jsx(Kf,{to:"/dashboard",replace:!0})})]})}const xne=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(null);if(p.useEffect(()=>{const c=d=>{n(d.detail),t(!0)};return window.addEventListener(Xm,c),()=>{window.removeEventListener(Xm,c)}},[]),!e||!r)return null;const{title:a="Thông báo",message:i,type:o="info"}=r,l=o==="success"?"from-emerald-600/90 via-emerald-700/90 to-emerald-900/95 border-emerald-300/40":o==="error"?"from-rose-600/90 via-rose-700/90 to-rose-900/95 border-rose-300/40":"from-slate-800/95 via-indigo-900/95 to-slate-950/95 border-white/20";return s.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:s.jsxs("div",{className:`w-full max-w-md mx-4 transform transition-all duration-300 rounded-2xl border ${l} p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur-xl`,children:[s.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-3",children:a}),s.jsx("p",{className:"text-sm text-white/90 mb-6 whitespace-pre-line",children:i}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 rounded-md bg-white/10 hover:bg-white/15 text-sm font-semibold text-white border border-white/30 transition-colors",children:"Đóng"})})]})})};function gne(){return s.jsx(TT,{children:s.jsx(cT,{children:s.jsxs(jT,{children:[s.jsx(xne,{}),s.jsxs(UN,{children:[s.jsx(Jt,{path:"/login",element:s.jsx(ET,{})}),s.jsx(Jt,{path:"/*",element:s.jsx(kT,{children:s.jsx(Zk,{children:s.jsx(pne,{})})})})]})]})})})}const vne={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},iT=(e,t)=>{try{const r=vne?.VITE_API_BASE_URL||"http://localhost:3001";fetch(`${r}/api/error-report`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,stack:t,url:window.location.href})}).catch(()=>{})}catch{}};window.onerror=(e,t,r,n,a)=>{a&&iT(a.message,a.stack)};window.onunhandledrejection=e=>{const t=e.reason;iT(t?.message||String(t),t?.stack)};fT.createRoot(document.getElementById("root")).render(s.jsx(gne,{}));
