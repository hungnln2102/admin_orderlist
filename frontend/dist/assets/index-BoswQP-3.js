function RR(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function fs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var vx={exports:{}},mu={},yx={exports:{}},Et={};var eS;function IR(){if(eS)return Et;eS=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function w(H,se,Y){this.props=H,this.context=se,this.refs=_,this.updater=Y||g}w.prototype.isReactComponent={},w.prototype.setState=function(H,se){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,se,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function S(){}S.prototype=w.prototype;function T(H,se,Y){this.props=H,this.context=se,this.refs=_,this.updater=Y||g}var E=T.prototype=new S;E.constructor=T,b(E,w.prototype),E.isPureReactComponent=!0;var k=Array.isArray,A=Object.prototype.hasOwnProperty,j={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function D(H,se,Y){var ce,ue={},me=null,Re=null;if(se!=null)for(ce in se.ref!==void 0&&(Re=se.ref),se.key!==void 0&&(me=""+se.key),se)A.call(se,ce)&&!P.hasOwnProperty(ce)&&(ue[ce]=se[ce]);var U=arguments.length-2;if(U===1)ue.children=Y;else if(1<U){for(var B=Array(U),K=0;K<U;K++)B[K]=arguments[K+2];ue.children=B}if(H&&H.defaultProps)for(ce in U=H.defaultProps,U)ue[ce]===void 0&&(ue[ce]=U[ce]);return{$$typeof:e,type:H,key:me,ref:Re,props:ue,_owner:j.current}}function L(H,se){return{$$typeof:e,type:H.type,key:se,ref:H.ref,props:H.props,_owner:H._owner}}function I(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function O(H){var se={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(Y){return se[Y]})}var M=/\/+/g;function re(H,se){return typeof H=="object"&&H!==null&&H.key!=null?O(""+H.key):se.toString(36)}function oe(H,se,Y,ce,ue){var me=typeof H;(me==="undefined"||me==="boolean")&&(H=null);var Re=!1;if(H===null)Re=!0;else switch(me){case"string":case"number":Re=!0;break;case"object":switch(H.$$typeof){case e:case t:Re=!0}}if(Re)return Re=H,ue=ue(Re),H=ce===""?"."+re(Re,0):ce,k(ue)?(Y="",H!=null&&(Y=H.replace(M,"$&/")+"/"),oe(ue,se,Y,"",function(K){return K})):ue!=null&&(I(ue)&&(ue=L(ue,Y+(!ue.key||Re&&Re.key===ue.key?"":(""+ue.key).replace(M,"$&/")+"/")+H)),se.push(ue)),1;if(Re=0,ce=ce===""?".":ce+":",k(H))for(var U=0;U<H.length;U++){me=H[U];var B=ce+re(me,U);Re+=oe(me,se,Y,B,ue)}else if(B=x(H),typeof B=="function")for(H=B.call(H),U=0;!(me=H.next()).done;)me=me.value,B=ce+re(me,U++),Re+=oe(me,se,Y,B,ue);else if(me==="object")throw se=String(H),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.");return Re}function ee(H,se,Y){if(H==null)return H;var ce=[],ue=0;return oe(H,ce,"","",function(me){return se.call(Y,me,ue++)}),ce}function fe(H){if(H._status===-1){var se=H._result;se=se(),se.then(function(Y){(H._status===0||H._status===-1)&&(H._status=1,H._result=Y)},function(Y){(H._status===0||H._status===-1)&&(H._status=2,H._result=Y)}),H._status===-1&&(H._status=0,H._result=se)}if(H._status===1)return H._result.default;throw H._result}var J={current:null},ie={transition:null},Q={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:ie,ReactCurrentOwner:j};function te(){throw Error("act(...) is not supported in production builds of React.")}return Et.Children={map:ee,forEach:function(H,se,Y){ee(H,function(){se.apply(this,arguments)},Y)},count:function(H){var se=0;return ee(H,function(){se++}),se},toArray:function(H){return ee(H,function(se){return se})||[]},only:function(H){if(!I(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Et.Component=w,Et.Fragment=r,Et.Profiler=a,Et.PureComponent=T,Et.StrictMode=n,Et.Suspense=d,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,Et.act=te,Et.cloneElement=function(H,se,Y){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var ce=b({},H.props),ue=H.key,me=H.ref,Re=H._owner;if(se!=null){if(se.ref!==void 0&&(me=se.ref,Re=j.current),se.key!==void 0&&(ue=""+se.key),H.type&&H.type.defaultProps)var U=H.type.defaultProps;for(B in se)A.call(se,B)&&!P.hasOwnProperty(B)&&(ce[B]=se[B]===void 0&&U!==void 0?U[B]:se[B])}var B=arguments.length-2;if(B===1)ce.children=Y;else if(1<B){U=Array(B);for(var K=0;K<B;K++)U[K]=arguments[K+2];ce.children=U}return{$$typeof:e,type:H.type,key:ue,ref:me,props:ce,_owner:Re}},Et.createContext=function(H){return H={$$typeof:s,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:i,_context:H},H.Consumer=H},Et.createElement=D,Et.createFactory=function(H){var se=D.bind(null,H);return se.type=H,se},Et.createRef=function(){return{current:null}},Et.forwardRef=function(H){return{$$typeof:l,render:H}},Et.isValidElement=I,Et.lazy=function(H){return{$$typeof:f,_payload:{_status:-1,_result:H},_init:fe}},Et.memo=function(H,se){return{$$typeof:h,type:H,compare:se===void 0?null:se}},Et.startTransition=function(H){var se=ie.transition;ie.transition={};try{H()}finally{ie.transition=se}},Et.unstable_act=te,Et.useCallback=function(H,se){return J.current.useCallback(H,se)},Et.useContext=function(H){return J.current.useContext(H)},Et.useDebugValue=function(){},Et.useDeferredValue=function(H){return J.current.useDeferredValue(H)},Et.useEffect=function(H,se){return J.current.useEffect(H,se)},Et.useId=function(){return J.current.useId()},Et.useImperativeHandle=function(H,se,Y){return J.current.useImperativeHandle(H,se,Y)},Et.useInsertionEffect=function(H,se){return J.current.useInsertionEffect(H,se)},Et.useLayoutEffect=function(H,se){return J.current.useLayoutEffect(H,se)},Et.useMemo=function(H,se){return J.current.useMemo(H,se)},Et.useReducer=function(H,se,Y){return J.current.useReducer(H,se,Y)},Et.useRef=function(H){return J.current.useRef(H)},Et.useState=function(H){return J.current.useState(H)},Et.useSyncExternalStore=function(H,se,Y){return J.current.useSyncExternalStore(H,se,Y)},Et.useTransition=function(){return J.current.useTransition()},Et.version="18.3.1",Et}var tS;function mc(){return tS||(tS=1,yx.exports=IR()),yx.exports}var rS;function FR(){if(rS)return mu;rS=1;var e=mc(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(l,d,h){var f,p={},x=null,g=null;h!==void 0&&(x=""+h),d.key!==void 0&&(x=""+d.key),d.ref!==void 0&&(g=d.ref);for(f in d)n.call(d,f)&&!i.hasOwnProperty(f)&&(p[f]=d[f]);if(l&&l.defaultProps)for(f in d=l.defaultProps,d)p[f]===void 0&&(p[f]=d[f]);return{$$typeof:t,type:l,key:x,ref:g,props:p,_owner:a.current}}return mu.Fragment=r,mu.jsx=s,mu.jsxs=s,mu}var nS;function MR(){return nS||(nS=1,vx.exports=FR()),vx.exports}var c=MR(),Lf={},wx={exports:{}},ra={},bx={exports:{}},_x={};var aS;function LR(){return aS||(aS=1,(function(e){function t(ie,Q){var te=ie.length;ie.push(Q);e:for(;0<te;){var H=te-1>>>1,se=ie[H];if(0<a(se,Q))ie[H]=Q,ie[te]=se,te=H;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var Q=ie[0],te=ie.pop();if(te!==Q){ie[0]=te;e:for(var H=0,se=ie.length,Y=se>>>1;H<Y;){var ce=2*(H+1)-1,ue=ie[ce],me=ce+1,Re=ie[me];if(0>a(ue,te))me<se&&0>a(Re,ue)?(ie[H]=Re,ie[me]=te,H=me):(ie[H]=ue,ie[ce]=te,H=ce);else if(me<se&&0>a(Re,te))ie[H]=Re,ie[me]=te,H=me;else break e}}return Q}function a(ie,Q){var te=ie.sortIndex-Q.sortIndex;return te!==0?te:ie.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var d=[],h=[],f=1,p=null,x=3,g=!1,b=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ie){for(var Q=r(h);Q!==null;){if(Q.callback===null)n(h);else if(Q.startTime<=ie)n(h),Q.sortIndex=Q.expirationTime,t(d,Q);else break;Q=r(h)}}function k(ie){if(_=!1,E(ie),!b)if(r(d)!==null)b=!0,fe(A);else{var Q=r(h);Q!==null&&J(k,Q.startTime-ie)}}function A(ie,Q){b=!1,_&&(_=!1,S(D),D=-1),g=!0;var te=x;try{for(E(Q),p=r(d);p!==null&&(!(p.expirationTime>Q)||ie&&!O());){var H=p.callback;if(typeof H=="function"){p.callback=null,x=p.priorityLevel;var se=H(p.expirationTime<=Q);Q=e.unstable_now(),typeof se=="function"?p.callback=se:p===r(d)&&n(d),E(Q)}else n(d);p=r(d)}if(p!==null)var Y=!0;else{var ce=r(h);ce!==null&&J(k,ce.startTime-Q),Y=!1}return Y}finally{p=null,x=te,g=!1}}var j=!1,P=null,D=-1,L=5,I=-1;function O(){return!(e.unstable_now()-I<L)}function M(){if(P!==null){var ie=e.unstable_now();I=ie;var Q=!0;try{Q=P(!0,ie)}finally{Q?re():(j=!1,P=null)}}else j=!1}var re;if(typeof T=="function")re=function(){T(M)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ee=oe.port2;oe.port1.onmessage=M,re=function(){ee.postMessage(null)}}else re=function(){w(M,0)};function fe(ie){P=ie,j||(j=!0,re())}function J(ie,Q){D=w(function(){ie(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,fe(A))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return r(d)},e.unstable_next=function(ie){switch(x){case 1:case 2:case 3:var Q=3;break;default:Q=x}var te=x;x=Q;try{return ie()}finally{x=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,Q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var te=x;x=ie;try{return Q()}finally{x=te}},e.unstable_scheduleCallback=function(ie,Q,te){var H=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?H+te:H):te=H,ie){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=te+se,ie={id:f++,callback:Q,priorityLevel:ie,startTime:te,expirationTime:se,sortIndex:-1},te>H?(ie.sortIndex=te,t(h,ie),r(d)===null&&ie===r(h)&&(_?(S(D),D=-1):_=!0,J(k,te-H))):(ie.sortIndex=se,t(d,ie),b||g||(b=!0,fe(A))),ie},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(ie){var Q=x;return function(){var te=x;x=Q;try{return ie.apply(this,arguments)}finally{x=te}}}})(_x)),_x}var iS;function BR(){return iS||(iS=1,bx.exports=LR()),bx.exports}var sS;function $R(){if(sS)return ra;sS=1;var e=mc(),t=BR();function r(o){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+o,m=1;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function i(o,u){s(o,u),s(o+"Capture",u)}function s(o,u){for(a[o]=u,o=0;o<u.length;o++)n.add(u[o])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function x(o){return d.call(p,o)?!0:d.call(f,o)?!1:h.test(o)?p[o]=!0:(f[o]=!0,!1)}function g(o,u,m,y){if(m!==null&&m.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return y?!1:m!==null?!m.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function b(o,u,m,y){if(u===null||typeof u>"u"||g(o,u,m,y))return!0;if(y)return!1;if(m!==null)switch(m.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function _(o,u,m,y,N,C,R){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=y,this.attributeNamespace=N,this.mustUseProperty=m,this.propertyName=o,this.type=u,this.sanitizeURL=C,this.removeEmptyString=R}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){w[o]=new _(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var u=o[0];w[u]=new _(u,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){w[o]=new _(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){w[o]=new _(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){w[o]=new _(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){w[o]=new _(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){w[o]=new _(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){w[o]=new _(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){w[o]=new _(o,5,!1,o.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function T(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var u=o.replace(S,T);w[u]=new _(u,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var u=o.replace(S,T);w[u]=new _(u,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var u=o.replace(S,T);w[u]=new _(u,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){w[o]=new _(o,1,!1,o.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){w[o]=new _(o,1,!1,o.toLowerCase(),null,!0,!0)});function E(o,u,m,y){var N=w.hasOwnProperty(u)?w[u]:null;(N!==null?N.type!==0:y||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(b(u,m,N,y)&&(m=null),y||N===null?x(u)&&(m===null?o.removeAttribute(u):o.setAttribute(u,""+m)):N.mustUseProperty?o[N.propertyName]=m===null?N.type===3?!1:"":m:(u=N.attributeName,y=N.attributeNamespace,m===null?o.removeAttribute(u):(N=N.type,m=N===3||N===4&&m===!0?"":""+m,y?o.setAttributeNS(y,u,m):o.setAttribute(u,m))))}var k=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),j=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),O=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),ie=Symbol.iterator;function Q(o){return o===null||typeof o!="object"?null:(o=ie&&o[ie]||o["@@iterator"],typeof o=="function"?o:null)}var te=Object.assign,H;function se(o){if(H===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);H=u&&u[1]||""}return`
`+H+o}var Y=!1;function ce(o,u){if(!o||Y)return"";Y=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(je){var y=je}Reflect.construct(o,[],u)}else{try{u.call()}catch(je){y=je}o.call(u.prototype)}else{try{throw Error()}catch(je){y=je}o()}}catch(je){if(je&&y&&typeof je.stack=="string"){for(var N=je.stack.split(`
`),C=y.stack.split(`
`),R=N.length-1,ae=C.length-1;1<=R&&0<=ae&&N[R]!==C[ae];)ae--;for(;1<=R&&0<=ae;R--,ae--)if(N[R]!==C[ae]){if(R!==1||ae!==1)do if(R--,ae--,0>ae||N[R]!==C[ae]){var de=`
`+N[R].replace(" at new "," at ");return o.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",o.displayName)),de}while(1<=R&&0<=ae);break}}}finally{Y=!1,Error.prepareStackTrace=m}return(o=o?o.displayName||o.name:"")?se(o):""}function ue(o){switch(o.tag){case 5:return se(o.type);case 16:return se("Lazy");case 13:return se("Suspense");case 19:return se("SuspenseList");case 0:case 2:case 15:return o=ce(o.type,!1),o;case 11:return o=ce(o.type.render,!1),o;case 1:return o=ce(o.type,!0),o;default:return""}}function me(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case P:return"Fragment";case j:return"Portal";case L:return"Profiler";case D:return"StrictMode";case re:return"Suspense";case oe:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case O:return(o.displayName||"Context")+".Consumer";case I:return(o._context.displayName||"Context")+".Provider";case M:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ee:return u=o.displayName||null,u!==null?u:me(o.type)||"Memo";case fe:u=o._payload,o=o._init;try{return me(o(u))}catch{}}return null}function Re(o){var u=o.type;switch(o.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=u.render,o=o.displayName||o.name||"",u.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(u);case 8:return u===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function U(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function B(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function K(o){var u=B(o)?"checked":"value",m=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),y=""+o[u];if(!o.hasOwnProperty(u)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var N=m.get,C=m.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return N.call(this)},set:function(R){y=""+R,C.call(this,R)}}),Object.defineProperty(o,u,{enumerable:m.enumerable}),{getValue:function(){return y},setValue:function(R){y=""+R},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function z(o){o._valueTracker||(o._valueTracker=K(o))}function ne(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var m=u.getValue(),y="";return o&&(y=B(o)?o.checked?"true":"false":o.value),o=y,o!==m?(u.setValue(o),!0):!1}function Oe(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Pe(o,u){var m=u.checked;return te({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??o._wrapperState.initialChecked})}function we(o,u){var m=u.defaultValue==null?"":u.defaultValue,y=u.checked!=null?u.checked:u.defaultChecked;m=U(u.value!=null?u.value:m),o._wrapperState={initialChecked:y,initialValue:m,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function xe(o,u){u=u.checked,u!=null&&E(o,"checked",u,!1)}function Ee(o,u){xe(o,u);var m=U(u.value),y=u.type;if(m!=null)y==="number"?(m===0&&o.value===""||o.value!=m)&&(o.value=""+m):o.value!==""+m&&(o.value=""+m);else if(y==="submit"||y==="reset"){o.removeAttribute("value");return}u.hasOwnProperty("value")?De(o,u.type,m):u.hasOwnProperty("defaultValue")&&De(o,u.type,U(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(o.defaultChecked=!!u.defaultChecked)}function le(o,u,m){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var y=u.type;if(!(y!=="submit"&&y!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+o._wrapperState.initialValue,m||u===o.value||(o.value=u),o.defaultValue=u}m=o.name,m!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,m!==""&&(o.name=m)}function De(o,u,m){(u!=="number"||Oe(o.ownerDocument)!==o)&&(m==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+m&&(o.defaultValue=""+m))}var Ue=Array.isArray;function Ce(o,u,m,y){if(o=o.options,u){u={};for(var N=0;N<m.length;N++)u["$"+m[N]]=!0;for(m=0;m<o.length;m++)N=u.hasOwnProperty("$"+o[m].value),o[m].selected!==N&&(o[m].selected=N),N&&y&&(o[m].defaultSelected=!0)}else{for(m=""+U(m),u=null,N=0;N<o.length;N++){if(o[N].value===m){o[N].selected=!0,y&&(o[N].defaultSelected=!0);return}u!==null||o[N].disabled||(u=o[N])}u!==null&&(u.selected=!0)}}function Ae(o,u){if(u.dangerouslySetInnerHTML!=null)throw Error(r(91));return te({},u,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function ve(o,u){var m=u.value;if(m==null){if(m=u.children,u=u.defaultValue,m!=null){if(u!=null)throw Error(r(92));if(Ue(m)){if(1<m.length)throw Error(r(93));m=m[0]}u=m}u==null&&(u=""),m=u}o._wrapperState={initialValue:U(m)}}function Le(o,u){var m=U(u.value),y=U(u.defaultValue);m!=null&&(m=""+m,m!==o.value&&(o.value=m),u.defaultValue==null&&o.defaultValue!==m&&(o.defaultValue=m)),y!=null&&(o.defaultValue=""+y)}function pe(o){var u=o.textContent;u===o._wrapperState.initialValue&&u!==""&&u!==null&&(o.value=u)}function tt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ye(o,u){return o==null||o==="http://www.w3.org/1999/xhtml"?tt(u):o==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Be,ot=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,m,y,N){MSApp.execUnsafeLocalFunction(function(){return o(u,m,y,N)})}:o})(function(o,u){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=u;else{for(Be=Be||document.createElement("div"),Be.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Be.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;u.firstChild;)o.appendChild(u.firstChild)}});function et(o,u){if(u){var m=o.firstChild;if(m&&m===o.lastChild&&m.nodeType===3){m.nodeValue=u;return}}o.textContent=u}var Je={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ze=["Webkit","ms","Moz","O"];Object.keys(Je).forEach(function(o){Ze.forEach(function(u){u=u+o.charAt(0).toUpperCase()+o.substring(1),Je[u]=Je[o]})});function At(o,u,m){return u==null||typeof u=="boolean"||u===""?"":m||typeof u!="number"||u===0||Je.hasOwnProperty(o)&&Je[o]?(""+u).trim():u+"px"}function Ot(o,u){o=o.style;for(var m in u)if(u.hasOwnProperty(m)){var y=m.indexOf("--")===0,N=At(m,u[m],y);m==="float"&&(m="cssFloat"),y?o.setProperty(m,N):o[m]=N}}var Mt=te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ie(o,u){if(u){if(Mt[o]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(r(137,o));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(r(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(r(61))}if(u.style!=null&&typeof u.style!="object")throw Error(r(62))}}function at(o,u){if(o.indexOf("-")===-1)return typeof u.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function yt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var bt=null,Tt=null,Kt=null;function mr(o){if(o=eu(o)){if(typeof bt!="function")throw Error(r(280));var u=o.stateNode;u&&(u=Zd(u),bt(o.stateNode,o.type,u))}}function Ar(o){Tt?Kt?Kt.push(o):Kt=[o]:Tt=o}function xn(){if(Tt){var o=Tt,u=Kt;if(Kt=Tt=null,mr(o),u)for(o=0;o<u.length;o++)mr(u[o])}}function Aa(o,u){return o(u)}function Gn(){}var Yn=!1;function Xn(o,u,m){if(Yn)return o(u,m);Yn=!0;try{return Aa(o,u,m)}finally{Yn=!1,(Tt!==null||Kt!==null)&&(Gn(),xn())}}function qa(o,u){var m=o.stateNode;if(m===null)return null;var y=Zd(m);if(y===null)return null;m=y[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(o=o.type,y=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!y;break e;default:o=!1}if(o)return null;if(m&&typeof m!="function")throw Error(r(231,u,typeof m));return m}var ua=!1;if(l)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){ua=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{ua=!1}function Rc(o,u,m,y,N,C,R,ae,de){var je=Array.prototype.slice.call(arguments,3);try{u.apply(m,je)}catch(He){this.onError(He)}}var Ri=!1,Ii=null,F=!1,X=null,W={onError:function(o){Ri=!0,Ii=o}};function V(o,u,m,y,N,C,R,ae,de){Ri=!1,Ii=null,Rc.apply(W,arguments)}function q(o,u,m,y,N,C,R,ae,de){if(V.apply(this,arguments),Ri){if(Ri){var je=Ii;Ri=!1,Ii=null}else throw Error(r(198));F||(F=!0,X=je)}}function Z(o){var u=o,m=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(m=u.return),o=u.return;while(o)}return u.tag===3?m:null}function _e(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function Fe(o){if(Z(o)!==o)throw Error(r(188))}function ye(o){var u=o.alternate;if(!u){if(u=Z(o),u===null)throw Error(r(188));return u!==o?null:o}for(var m=o,y=u;;){var N=m.return;if(N===null)break;var C=N.alternate;if(C===null){if(y=N.return,y!==null){m=y;continue}break}if(N.child===C.child){for(C=N.child;C;){if(C===m)return Fe(N),o;if(C===y)return Fe(N),u;C=C.sibling}throw Error(r(188))}if(m.return!==y.return)m=N,y=C;else{for(var R=!1,ae=N.child;ae;){if(ae===m){R=!0,m=N,y=C;break}if(ae===y){R=!0,y=N,m=C;break}ae=ae.sibling}if(!R){for(ae=C.child;ae;){if(ae===m){R=!0,m=C,y=N;break}if(ae===y){R=!0,y=C,m=N;break}ae=ae.sibling}if(!R)throw Error(r(189))}}if(m.alternate!==y)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?o:u}function Se(o){return o=ye(o),o!==null?Ne(o):null}function Ne(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var u=Ne(o);if(u!==null)return u;o=o.sibling}return null}var Ke=t.unstable_scheduleCallback,Qe=t.unstable_cancelCallback,nt=t.unstable_shouldYield,Ge=t.unstable_requestPaint,ze=t.unstable_now,_t=t.unstable_getCurrentPriorityLevel,Vt=t.unstable_ImmediatePriority,Qt=t.unstable_UserBlockingPriority,Sr=t.unstable_NormalPriority,mo=t.unstable_LowPriority,ys=t.unstable_IdlePriority,di=null,Xr=null;function Ic(o){if(Xr&&typeof Xr.onCommitFiberRoot=="function")try{Xr.onCommitFiberRoot(di,o,void 0,(o.current.flags&128)===128)}catch{}}var Nr=Math.clz32?Math.clz32:Z5,q5=Math.log,Q5=Math.LN2;function Z5(o){return o>>>=0,o===0?32:31-(q5(o)/Q5|0)|0}var Rd=64,Id=4194304;function Fc(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Fd(o,u){var m=o.pendingLanes;if(m===0)return 0;var y=0,N=o.suspendedLanes,C=o.pingedLanes,R=m&268435455;if(R!==0){var ae=R&~N;ae!==0?y=Fc(ae):(C&=R,C!==0&&(y=Fc(C)))}else R=m&~N,R!==0?y=Fc(R):C!==0&&(y=Fc(C));if(y===0)return 0;if(u!==0&&u!==y&&(u&N)===0&&(N=y&-y,C=u&-u,N>=C||N===16&&(C&4194240)!==0))return u;if((y&4)!==0&&(y|=m&16),u=o.entangledLanes,u!==0)for(o=o.entanglements,u&=y;0<u;)m=31-Nr(u),N=1<<m,y|=o[m],u&=~N;return y}function J5(o,u){switch(o){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eD(o,u){for(var m=o.suspendedLanes,y=o.pingedLanes,N=o.expirationTimes,C=o.pendingLanes;0<C;){var R=31-Nr(C),ae=1<<R,de=N[R];de===-1?((ae&m)===0||(ae&y)!==0)&&(N[R]=J5(ae,u)):de<=u&&(o.expiredLanes|=ae),C&=~ae}}function Bp(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function jb(){var o=Rd;return Rd<<=1,(Rd&4194240)===0&&(Rd=64),o}function $p(o){for(var u=[],m=0;31>m;m++)u.push(o);return u}function Mc(o,u,m){o.pendingLanes|=u,u!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,u=31-Nr(u),o[u]=m}function tD(o,u){var m=o.pendingLanes&~u;o.pendingLanes=u,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=u,o.mutableReadLanes&=u,o.entangledLanes&=u,u=o.entanglements;var y=o.eventTimes;for(o=o.expirationTimes;0<m;){var N=31-Nr(m),C=1<<N;u[N]=0,y[N]=-1,o[N]=-1,m&=~C}}function Up(o,u){var m=o.entangledLanes|=u;for(o=o.entanglements;m;){var y=31-Nr(m),N=1<<y;N&u|o[y]&u&&(o[y]|=u),m&=~N}}var Ut=0;function Ob(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Db,zp,Rb,Ib,Fb,Wp=!1,Md=[],ws=null,bs=null,_s=null,Lc=new Map,Bc=new Map,Ss=[],rD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mb(o,u){switch(o){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":bs=null;break;case"mouseover":case"mouseout":_s=null;break;case"pointerover":case"pointerout":Lc.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bc.delete(u.pointerId)}}function $c(o,u,m,y,N,C){return o===null||o.nativeEvent!==C?(o={blockedOn:u,domEventName:m,eventSystemFlags:y,nativeEvent:C,targetContainers:[N]},u!==null&&(u=eu(u),u!==null&&zp(u)),o):(o.eventSystemFlags|=y,u=o.targetContainers,N!==null&&u.indexOf(N)===-1&&u.push(N),o)}function nD(o,u,m,y,N){switch(u){case"focusin":return ws=$c(ws,o,u,m,y,N),!0;case"dragenter":return bs=$c(bs,o,u,m,y,N),!0;case"mouseover":return _s=$c(_s,o,u,m,y,N),!0;case"pointerover":var C=N.pointerId;return Lc.set(C,$c(Lc.get(C)||null,o,u,m,y,N)),!0;case"gotpointercapture":return C=N.pointerId,Bc.set(C,$c(Bc.get(C)||null,o,u,m,y,N)),!0}return!1}function Lb(o){var u=xo(o.target);if(u!==null){var m=Z(u);if(m!==null){if(u=m.tag,u===13){if(u=_e(m),u!==null){o.blockedOn=u,Fb(o.priority,function(){Rb(m)});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){o.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ld(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var m=Kp(o.domEventName,o.eventSystemFlags,u[0],o.nativeEvent);if(m===null){m=o.nativeEvent;var y=new m.constructor(m.type,m);xt=y,m.target.dispatchEvent(y),xt=null}else return u=eu(m),u!==null&&zp(u),o.blockedOn=m,!1;u.shift()}return!0}function Bb(o,u,m){Ld(o)&&m.delete(u)}function aD(){Wp=!1,ws!==null&&Ld(ws)&&(ws=null),bs!==null&&Ld(bs)&&(bs=null),_s!==null&&Ld(_s)&&(_s=null),Lc.forEach(Bb),Bc.forEach(Bb)}function Uc(o,u){o.blockedOn===u&&(o.blockedOn=null,Wp||(Wp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,aD)))}function zc(o){function u(N){return Uc(N,o)}if(0<Md.length){Uc(Md[0],o);for(var m=1;m<Md.length;m++){var y=Md[m];y.blockedOn===o&&(y.blockedOn=null)}}for(ws!==null&&Uc(ws,o),bs!==null&&Uc(bs,o),_s!==null&&Uc(_s,o),Lc.forEach(u),Bc.forEach(u),m=0;m<Ss.length;m++)y=Ss[m],y.blockedOn===o&&(y.blockedOn=null);for(;0<Ss.length&&(m=Ss[0],m.blockedOn===null);)Lb(m),m.blockedOn===null&&Ss.shift()}var fl=k.ReactCurrentBatchConfig,Bd=!0;function iD(o,u,m,y){var N=Ut,C=fl.transition;fl.transition=null;try{Ut=1,Hp(o,u,m,y)}finally{Ut=N,fl.transition=C}}function sD(o,u,m,y){var N=Ut,C=fl.transition;fl.transition=null;try{Ut=4,Hp(o,u,m,y)}finally{Ut=N,fl.transition=C}}function Hp(o,u,m,y){if(Bd){var N=Kp(o,u,m,y);if(N===null)lm(o,u,y,$d,m),Mb(o,y);else if(nD(N,o,u,m,y))y.stopPropagation();else if(Mb(o,y),u&4&&-1<rD.indexOf(o)){for(;N!==null;){var C=eu(N);if(C!==null&&Db(C),C=Kp(o,u,m,y),C===null&&lm(o,u,y,$d,m),C===N)break;N=C}N!==null&&y.stopPropagation()}else lm(o,u,y,null,m)}}var $d=null;function Kp(o,u,m,y){if($d=null,o=yt(y),o=xo(o),o!==null)if(u=Z(o),u===null)o=null;else if(m=u.tag,m===13){if(o=_e(u),o!==null)return o;o=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null);return $d=o,null}function $b(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_t()){case Vt:return 1;case Qt:return 4;case Sr:case mo:return 16;case ys:return 536870912;default:return 16}default:return 16}}var Ns=null,Vp=null,Ud=null;function Ub(){if(Ud)return Ud;var o,u=Vp,m=u.length,y,N="value"in Ns?Ns.value:Ns.textContent,C=N.length;for(o=0;o<m&&u[o]===N[o];o++);var R=m-o;for(y=1;y<=R&&u[m-y]===N[C-y];y++);return Ud=N.slice(o,1<y?1-y:void 0)}function zd(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function Wd(){return!0}function zb(){return!1}function da(o){function u(m,y,N,C,R){this._reactName=m,this._targetInst=N,this.type=y,this.nativeEvent=C,this.target=R,this.currentTarget=null;for(var ae in o)o.hasOwnProperty(ae)&&(m=o[ae],this[ae]=m?m(C):C[ae]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Wd:zb,this.isPropagationStopped=zb,this}return te(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Wd)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Wd)},persist:function(){},isPersistent:Wd}),u}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gp=da(hl),Wc=te({},hl,{view:0,detail:0}),oD=da(Wc),Yp,Xp,Hc,Hd=te({},Wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qp,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Hc&&(Hc&&o.type==="mousemove"?(Yp=o.screenX-Hc.screenX,Xp=o.screenY-Hc.screenY):Xp=Yp=0,Hc=o),Yp)},movementY:function(o){return"movementY"in o?o.movementY:Xp}}),Wb=da(Hd),lD=te({},Hd,{dataTransfer:0}),cD=da(lD),uD=te({},Wc,{relatedTarget:0}),qp=da(uD),dD=te({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),fD=da(dD),hD=te({},hl,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),pD=da(hD),mD=te({},hl,{data:0}),Hb=da(mD),xD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yD(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=vD[o])?!!u[o]:!1}function Qp(){return yD}var wD=te({},Wc,{key:function(o){if(o.key){var u=xD[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=zd(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?gD[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qp,charCode:function(o){return o.type==="keypress"?zd(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?zd(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),bD=da(wD),_D=te({},Hd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kb=da(_D),SD=te({},Wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qp}),ND=da(SD),ED=te({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),TD=da(ED),CD=te({},Hd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),kD=da(CD),AD=[9,13,27,32],Zp=l&&"CompositionEvent"in window,Kc=null;l&&"documentMode"in document&&(Kc=document.documentMode);var PD=l&&"TextEvent"in window&&!Kc,Vb=l&&(!Zp||Kc&&8<Kc&&11>=Kc),Gb=" ",Yb=!1;function Xb(o,u){switch(o){case"keyup":return AD.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qb(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var pl=!1;function jD(o,u){switch(o){case"compositionend":return qb(u);case"keypress":return u.which!==32?null:(Yb=!0,Gb);case"textInput":return o=u.data,o===Gb&&Yb?null:o;default:return null}}function OD(o,u){if(pl)return o==="compositionend"||!Zp&&Xb(o,u)?(o=Ub(),Ud=Vp=Ns=null,pl=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Vb&&u.locale!=="ko"?null:u.data;default:return null}}var DD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qb(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!DD[o.type]:u==="textarea"}function Zb(o,u,m,y){Ar(y),u=Xd(u,"onChange"),0<u.length&&(m=new Gp("onChange","change",null,m,y),o.push({event:m,listeners:u}))}var Vc=null,Gc=null;function RD(o){x2(o,0)}function Kd(o){var u=yl(o);if(ne(u))return o}function ID(o,u){if(o==="change")return u}var Jb=!1;if(l){var Jp;if(l){var em="oninput"in document;if(!em){var e2=document.createElement("div");e2.setAttribute("oninput","return;"),em=typeof e2.oninput=="function"}Jp=em}else Jp=!1;Jb=Jp&&(!document.documentMode||9<document.documentMode)}function t2(){Vc&&(Vc.detachEvent("onpropertychange",r2),Gc=Vc=null)}function r2(o){if(o.propertyName==="value"&&Kd(Gc)){var u=[];Zb(u,Gc,o,yt(o)),Xn(RD,u)}}function FD(o,u,m){o==="focusin"?(t2(),Vc=u,Gc=m,Vc.attachEvent("onpropertychange",r2)):o==="focusout"&&t2()}function MD(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Kd(Gc)}function LD(o,u){if(o==="click")return Kd(u)}function BD(o,u){if(o==="input"||o==="change")return Kd(u)}function $D(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var Qa=typeof Object.is=="function"?Object.is:$D;function Yc(o,u){if(Qa(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var m=Object.keys(o),y=Object.keys(u);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var N=m[y];if(!d.call(u,N)||!Qa(o[N],u[N]))return!1}return!0}function n2(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function a2(o,u){var m=n2(o);o=0;for(var y;m;){if(m.nodeType===3){if(y=o+m.textContent.length,o<=u&&y>=u)return{node:m,offset:u-o};o=y}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=n2(m)}}function i2(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?i2(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function s2(){for(var o=window,u=Oe();u instanceof o.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)o=u.contentWindow;else break;u=Oe(o.document)}return u}function tm(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}function UD(o){var u=s2(),m=o.focusedElem,y=o.selectionRange;if(u!==m&&m&&m.ownerDocument&&i2(m.ownerDocument.documentElement,m)){if(y!==null&&tm(m)){if(u=y.start,o=y.end,o===void 0&&(o=u),"selectionStart"in m)m.selectionStart=u,m.selectionEnd=Math.min(o,m.value.length);else if(o=(u=m.ownerDocument||document)&&u.defaultView||window,o.getSelection){o=o.getSelection();var N=m.textContent.length,C=Math.min(y.start,N);y=y.end===void 0?C:Math.min(y.end,N),!o.extend&&C>y&&(N=y,y=C,C=N),N=a2(m,C);var R=a2(m,y);N&&R&&(o.rangeCount!==1||o.anchorNode!==N.node||o.anchorOffset!==N.offset||o.focusNode!==R.node||o.focusOffset!==R.offset)&&(u=u.createRange(),u.setStart(N.node,N.offset),o.removeAllRanges(),C>y?(o.addRange(u),o.extend(R.node,R.offset)):(u.setEnd(R.node,R.offset),o.addRange(u)))}}for(u=[],o=m;o=o.parentNode;)o.nodeType===1&&u.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<u.length;m++)o=u[m],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var zD=l&&"documentMode"in document&&11>=document.documentMode,ml=null,rm=null,Xc=null,nm=!1;function o2(o,u,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;nm||ml==null||ml!==Oe(y)||(y=ml,"selectionStart"in y&&tm(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Xc&&Yc(Xc,y)||(Xc=y,y=Xd(rm,"onSelect"),0<y.length&&(u=new Gp("onSelect","select",null,u,m),o.push({event:u,listeners:y}),u.target=ml)))}function Vd(o,u){var m={};return m[o.toLowerCase()]=u.toLowerCase(),m["Webkit"+o]="webkit"+u,m["Moz"+o]="moz"+u,m}var xl={animationend:Vd("Animation","AnimationEnd"),animationiteration:Vd("Animation","AnimationIteration"),animationstart:Vd("Animation","AnimationStart"),transitionend:Vd("Transition","TransitionEnd")},am={},l2={};l&&(l2=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function Gd(o){if(am[o])return am[o];if(!xl[o])return o;var u=xl[o],m;for(m in u)if(u.hasOwnProperty(m)&&m in l2)return am[o]=u[m];return o}var c2=Gd("animationend"),u2=Gd("animationiteration"),d2=Gd("animationstart"),f2=Gd("transitionend"),h2=new Map,p2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Es(o,u){h2.set(o,u),i(u,[o])}for(var im=0;im<p2.length;im++){var sm=p2[im],WD=sm.toLowerCase(),HD=sm[0].toUpperCase()+sm.slice(1);Es(WD,"on"+HD)}Es(c2,"onAnimationEnd"),Es(u2,"onAnimationIteration"),Es(d2,"onAnimationStart"),Es("dblclick","onDoubleClick"),Es("focusin","onFocus"),Es("focusout","onBlur"),Es(f2,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KD=new Set("cancel close invalid load scroll toggle".split(" ").concat(qc));function m2(o,u,m){var y=o.type||"unknown-event";o.currentTarget=m,q(y,u,void 0,o),o.currentTarget=null}function x2(o,u){u=(u&4)!==0;for(var m=0;m<o.length;m++){var y=o[m],N=y.event;y=y.listeners;e:{var C=void 0;if(u)for(var R=y.length-1;0<=R;R--){var ae=y[R],de=ae.instance,je=ae.currentTarget;if(ae=ae.listener,de!==C&&N.isPropagationStopped())break e;m2(N,ae,je),C=de}else for(R=0;R<y.length;R++){if(ae=y[R],de=ae.instance,je=ae.currentTarget,ae=ae.listener,de!==C&&N.isPropagationStopped())break e;m2(N,ae,je),C=de}}}if(F)throw o=X,F=!1,X=null,o}function tr(o,u){var m=u[pm];m===void 0&&(m=u[pm]=new Set);var y=o+"__bubble";m.has(y)||(g2(u,o,2,!1),m.add(y))}function om(o,u,m){var y=0;u&&(y|=4),g2(m,o,y,u)}var Yd="_reactListening"+Math.random().toString(36).slice(2);function Qc(o){if(!o[Yd]){o[Yd]=!0,n.forEach(function(m){m!=="selectionchange"&&(KD.has(m)||om(m,!1,o),om(m,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[Yd]||(u[Yd]=!0,om("selectionchange",!1,u))}}function g2(o,u,m,y){switch($b(u)){case 1:var N=iD;break;case 4:N=sD;break;default:N=Hp}m=N.bind(null,u,m,o),N=void 0,!ua||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(N=!0),y?N!==void 0?o.addEventListener(u,m,{capture:!0,passive:N}):o.addEventListener(u,m,!0):N!==void 0?o.addEventListener(u,m,{passive:N}):o.addEventListener(u,m,!1)}function lm(o,u,m,y,N){var C=y;if((u&1)===0&&(u&2)===0&&y!==null)e:for(;;){if(y===null)return;var R=y.tag;if(R===3||R===4){var ae=y.stateNode.containerInfo;if(ae===N||ae.nodeType===8&&ae.parentNode===N)break;if(R===4)for(R=y.return;R!==null;){var de=R.tag;if((de===3||de===4)&&(de=R.stateNode.containerInfo,de===N||de.nodeType===8&&de.parentNode===N))return;R=R.return}for(;ae!==null;){if(R=xo(ae),R===null)return;if(de=R.tag,de===5||de===6){y=C=R;continue e}ae=ae.parentNode}}y=y.return}Xn(function(){var je=C,He=yt(m),Ve=[];e:{var We=h2.get(o);if(We!==void 0){var rt=Gp,lt=o;switch(o){case"keypress":if(zd(m)===0)break e;case"keydown":case"keyup":rt=bD;break;case"focusin":lt="focus",rt=qp;break;case"focusout":lt="blur",rt=qp;break;case"beforeblur":case"afterblur":rt=qp;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Wb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=cD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=ND;break;case c2:case u2:case d2:rt=fD;break;case f2:rt=TD;break;case"scroll":rt=oD;break;case"wheel":rt=kD;break;case"copy":case"cut":case"paste":rt=pD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=Kb}var ct=(u&4)!==0,Er=!ct&&o==="scroll",ge=ct?We!==null?We+"Capture":null:We;ct=[];for(var he=je,Te;he!==null;){Te=he;var qe=Te.stateNode;if(Te.tag===5&&qe!==null&&(Te=qe,ge!==null&&(qe=qa(he,ge),qe!=null&&ct.push(Zc(he,qe,Te)))),Er)break;he=he.return}0<ct.length&&(We=new rt(We,lt,null,m,He),Ve.push({event:We,listeners:ct}))}}if((u&7)===0){e:{if(We=o==="mouseover"||o==="pointerover",rt=o==="mouseout"||o==="pointerout",We&&m!==xt&&(lt=m.relatedTarget||m.fromElement)&&(xo(lt)||lt[Fi]))break e;if((rt||We)&&(We=He.window===He?He:(We=He.ownerDocument)?We.defaultView||We.parentWindow:window,rt?(lt=m.relatedTarget||m.toElement,rt=je,lt=lt?xo(lt):null,lt!==null&&(Er=Z(lt),lt!==Er||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(rt=null,lt=je),rt!==lt)){if(ct=Wb,qe="onMouseLeave",ge="onMouseEnter",he="mouse",(o==="pointerout"||o==="pointerover")&&(ct=Kb,qe="onPointerLeave",ge="onPointerEnter",he="pointer"),Er=rt==null?We:yl(rt),Te=lt==null?We:yl(lt),We=new ct(qe,he+"leave",rt,m,He),We.target=Er,We.relatedTarget=Te,qe=null,xo(He)===je&&(ct=new ct(ge,he+"enter",lt,m,He),ct.target=Te,ct.relatedTarget=Er,qe=ct),Er=qe,rt&&lt)t:{for(ct=rt,ge=lt,he=0,Te=ct;Te;Te=gl(Te))he++;for(Te=0,qe=ge;qe;qe=gl(qe))Te++;for(;0<he-Te;)ct=gl(ct),he--;for(;0<Te-he;)ge=gl(ge),Te--;for(;he--;){if(ct===ge||ge!==null&&ct===ge.alternate)break t;ct=gl(ct),ge=gl(ge)}ct=null}else ct=null;rt!==null&&v2(Ve,We,rt,ct,!1),lt!==null&&Er!==null&&v2(Ve,Er,lt,ct,!0)}}e:{if(We=je?yl(je):window,rt=We.nodeName&&We.nodeName.toLowerCase(),rt==="select"||rt==="input"&&We.type==="file")var dt=ID;else if(Qb(We))if(Jb)dt=BD;else{dt=MD;var gt=FD}else(rt=We.nodeName)&&rt.toLowerCase()==="input"&&(We.type==="checkbox"||We.type==="radio")&&(dt=LD);if(dt&&(dt=dt(o,je))){Zb(Ve,dt,m,He);break e}gt&&gt(o,We,je),o==="focusout"&&(gt=We._wrapperState)&&gt.controlled&&We.type==="number"&&De(We,"number",We.value)}switch(gt=je?yl(je):window,o){case"focusin":(Qb(gt)||gt.contentEditable==="true")&&(ml=gt,rm=je,Xc=null);break;case"focusout":Xc=rm=ml=null;break;case"mousedown":nm=!0;break;case"contextmenu":case"mouseup":case"dragend":nm=!1,o2(Ve,m,He);break;case"selectionchange":if(zD)break;case"keydown":case"keyup":o2(Ve,m,He)}var vt;if(Zp)e:{switch(o){case"compositionstart":var wt="onCompositionStart";break e;case"compositionend":wt="onCompositionEnd";break e;case"compositionupdate":wt="onCompositionUpdate";break e}wt=void 0}else pl?Xb(o,m)&&(wt="onCompositionEnd"):o==="keydown"&&m.keyCode===229&&(wt="onCompositionStart");wt&&(Vb&&m.locale!=="ko"&&(pl||wt!=="onCompositionStart"?wt==="onCompositionEnd"&&pl&&(vt=Ub()):(Ns=He,Vp="value"in Ns?Ns.value:Ns.textContent,pl=!0)),gt=Xd(je,wt),0<gt.length&&(wt=new Hb(wt,o,null,m,He),Ve.push({event:wt,listeners:gt}),vt?wt.data=vt:(vt=qb(m),vt!==null&&(wt.data=vt)))),(vt=PD?jD(o,m):OD(o,m))&&(je=Xd(je,"onBeforeInput"),0<je.length&&(He=new Hb("onBeforeInput","beforeinput",null,m,He),Ve.push({event:He,listeners:je}),He.data=vt))}x2(Ve,u)})}function Zc(o,u,m){return{instance:o,listener:u,currentTarget:m}}function Xd(o,u){for(var m=u+"Capture",y=[];o!==null;){var N=o,C=N.stateNode;N.tag===5&&C!==null&&(N=C,C=qa(o,m),C!=null&&y.unshift(Zc(o,C,N)),C=qa(o,u),C!=null&&y.push(Zc(o,C,N))),o=o.return}return y}function gl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function v2(o,u,m,y,N){for(var C=u._reactName,R=[];m!==null&&m!==y;){var ae=m,de=ae.alternate,je=ae.stateNode;if(de!==null&&de===y)break;ae.tag===5&&je!==null&&(ae=je,N?(de=qa(m,C),de!=null&&R.unshift(Zc(m,de,ae))):N||(de=qa(m,C),de!=null&&R.push(Zc(m,de,ae)))),m=m.return}R.length!==0&&o.push({event:u,listeners:R})}var VD=/\r\n?/g,GD=/\u0000|\uFFFD/g;function y2(o){return(typeof o=="string"?o:""+o).replace(VD,`
`).replace(GD,"")}function qd(o,u,m){if(u=y2(u),y2(o)!==u&&m)throw Error(r(425))}function Qd(){}var cm=null,um=null;function dm(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var fm=typeof setTimeout=="function"?setTimeout:void 0,YD=typeof clearTimeout=="function"?clearTimeout:void 0,w2=typeof Promise=="function"?Promise:void 0,XD=typeof queueMicrotask=="function"?queueMicrotask:typeof w2<"u"?function(o){return w2.resolve(null).then(o).catch(qD)}:fm;function qD(o){setTimeout(function(){throw o})}function hm(o,u){var m=u,y=0;do{var N=m.nextSibling;if(o.removeChild(m),N&&N.nodeType===8)if(m=N.data,m==="/$"){if(y===0){o.removeChild(N),zc(u);return}y--}else m!=="$"&&m!=="$?"&&m!=="$!"||y++;m=N}while(m);zc(u)}function Ts(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return o}function b2(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var m=o.data;if(m==="$"||m==="$!"||m==="$?"){if(u===0)return o;u--}else m==="/$"&&u++}o=o.previousSibling}return null}var vl=Math.random().toString(36).slice(2),fi="__reactFiber$"+vl,Jc="__reactProps$"+vl,Fi="__reactContainer$"+vl,pm="__reactEvents$"+vl,QD="__reactListeners$"+vl,ZD="__reactHandles$"+vl;function xo(o){var u=o[fi];if(u)return u;for(var m=o.parentNode;m;){if(u=m[Fi]||m[fi]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(o=b2(o);o!==null;){if(m=o[fi])return m;o=b2(o)}return u}o=m,m=o.parentNode}return null}function eu(o){return o=o[fi]||o[Fi],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function yl(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(r(33))}function Zd(o){return o[Jc]||null}var mm=[],wl=-1;function Cs(o){return{current:o}}function rr(o){0>wl||(o.current=mm[wl],mm[wl]=null,wl--)}function Zt(o,u){wl++,mm[wl]=o.current,o.current=u}var ks={},gn=Cs(ks),Qn=Cs(!1),go=ks;function bl(o,u){var m=o.type.contextTypes;if(!m)return ks;var y=o.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===u)return y.__reactInternalMemoizedMaskedChildContext;var N={},C;for(C in m)N[C]=u[C];return y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=u,o.__reactInternalMemoizedMaskedChildContext=N),N}function Zn(o){return o=o.childContextTypes,o!=null}function Jd(){rr(Qn),rr(gn)}function _2(o,u,m){if(gn.current!==ks)throw Error(r(168));Zt(gn,u),Zt(Qn,m)}function S2(o,u,m){var y=o.stateNode;if(u=u.childContextTypes,typeof y.getChildContext!="function")return m;y=y.getChildContext();for(var N in y)if(!(N in u))throw Error(r(108,Re(o)||"Unknown",N));return te({},m,y)}function ef(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ks,go=gn.current,Zt(gn,o),Zt(Qn,Qn.current),!0}function N2(o,u,m){var y=o.stateNode;if(!y)throw Error(r(169));m?(o=S2(o,u,go),y.__reactInternalMemoizedMergedChildContext=o,rr(Qn),rr(gn),Zt(gn,o)):rr(Qn),Zt(Qn,m)}var Mi=null,tf=!1,xm=!1;function E2(o){Mi===null?Mi=[o]:Mi.push(o)}function JD(o){tf=!0,E2(o)}function As(){if(!xm&&Mi!==null){xm=!0;var o=0,u=Ut;try{var m=Mi;for(Ut=1;o<m.length;o++){var y=m[o];do y=y(!0);while(y!==null)}Mi=null,tf=!1}catch(N){throw Mi!==null&&(Mi=Mi.slice(o+1)),Ke(Vt,As),N}finally{Ut=u,xm=!1}}return null}var _l=[],Sl=0,rf=null,nf=0,Pa=[],ja=0,vo=null,Li=1,Bi="";function yo(o,u){_l[Sl++]=nf,_l[Sl++]=rf,rf=o,nf=u}function T2(o,u,m){Pa[ja++]=Li,Pa[ja++]=Bi,Pa[ja++]=vo,vo=o;var y=Li;o=Bi;var N=32-Nr(y)-1;y&=~(1<<N),m+=1;var C=32-Nr(u)+N;if(30<C){var R=N-N%5;C=(y&(1<<R)-1).toString(32),y>>=R,N-=R,Li=1<<32-Nr(u)+N|m<<N|y,Bi=C+o}else Li=1<<C|m<<N|y,Bi=o}function gm(o){o.return!==null&&(yo(o,1),T2(o,1,0))}function vm(o){for(;o===rf;)rf=_l[--Sl],_l[Sl]=null,nf=_l[--Sl],_l[Sl]=null;for(;o===vo;)vo=Pa[--ja],Pa[ja]=null,Bi=Pa[--ja],Pa[ja]=null,Li=Pa[--ja],Pa[ja]=null}var fa=null,ha=null,sr=!1,Za=null;function C2(o,u){var m=Ia(5,null,null,0);m.elementType="DELETED",m.stateNode=u,m.return=o,u=o.deletions,u===null?(o.deletions=[m],o.flags|=16):u.push(m)}function k2(o,u){switch(o.tag){case 5:var m=o.type;return u=u.nodeType!==1||m.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(o.stateNode=u,fa=o,ha=Ts(u.firstChild),!0):!1;case 6:return u=o.pendingProps===""||u.nodeType!==3?null:u,u!==null?(o.stateNode=u,fa=o,ha=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(m=vo!==null?{id:Li,overflow:Bi}:null,o.memoizedState={dehydrated:u,treeContext:m,retryLane:1073741824},m=Ia(18,null,null,0),m.stateNode=u,m.return=o,o.child=m,fa=o,ha=null,!0):!1;default:return!1}}function ym(o){return(o.mode&1)!==0&&(o.flags&128)===0}function wm(o){if(sr){var u=ha;if(u){var m=u;if(!k2(o,u)){if(ym(o))throw Error(r(418));u=Ts(m.nextSibling);var y=fa;u&&k2(o,u)?C2(y,m):(o.flags=o.flags&-4097|2,sr=!1,fa=o)}}else{if(ym(o))throw Error(r(418));o.flags=o.flags&-4097|2,sr=!1,fa=o}}}function A2(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;fa=o}function af(o){if(o!==fa)return!1;if(!sr)return A2(o),sr=!0,!1;var u;if((u=o.tag!==3)&&!(u=o.tag!==5)&&(u=o.type,u=u!=="head"&&u!=="body"&&!dm(o.type,o.memoizedProps)),u&&(u=ha)){if(ym(o))throw P2(),Error(r(418));for(;u;)C2(o,u),u=Ts(u.nextSibling)}if(A2(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8){var m=o.data;if(m==="/$"){if(u===0){ha=Ts(o.nextSibling);break e}u--}else m!=="$"&&m!=="$!"&&m!=="$?"||u++}o=o.nextSibling}ha=null}}else ha=fa?Ts(o.stateNode.nextSibling):null;return!0}function P2(){for(var o=ha;o;)o=Ts(o.nextSibling)}function Nl(){ha=fa=null,sr=!1}function bm(o){Za===null?Za=[o]:Za.push(o)}var eR=k.ReactCurrentBatchConfig;function tu(o,u,m){if(o=m.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(r(309));var y=m.stateNode}if(!y)throw Error(r(147,o));var N=y,C=""+o;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===C?u.ref:(u=function(R){var ae=N.refs;R===null?delete ae[C]:ae[C]=R},u._stringRef=C,u)}if(typeof o!="string")throw Error(r(284));if(!m._owner)throw Error(r(290,o))}return o}function sf(o,u){throw o=Object.prototype.toString.call(u),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o))}function j2(o){var u=o._init;return u(o._payload)}function O2(o){function u(ge,he){if(o){var Te=ge.deletions;Te===null?(ge.deletions=[he],ge.flags|=16):Te.push(he)}}function m(ge,he){if(!o)return null;for(;he!==null;)u(ge,he),he=he.sibling;return null}function y(ge,he){for(ge=new Map;he!==null;)he.key!==null?ge.set(he.key,he):ge.set(he.index,he),he=he.sibling;return ge}function N(ge,he){return ge=Ms(ge,he),ge.index=0,ge.sibling=null,ge}function C(ge,he,Te){return ge.index=Te,o?(Te=ge.alternate,Te!==null?(Te=Te.index,Te<he?(ge.flags|=2,he):Te):(ge.flags|=2,he)):(ge.flags|=1048576,he)}function R(ge){return o&&ge.alternate===null&&(ge.flags|=2),ge}function ae(ge,he,Te,qe){return he===null||he.tag!==6?(he=fx(Te,ge.mode,qe),he.return=ge,he):(he=N(he,Te),he.return=ge,he)}function de(ge,he,Te,qe){var dt=Te.type;return dt===P?He(ge,he,Te.props.children,qe,Te.key):he!==null&&(he.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===fe&&j2(dt)===he.type)?(qe=N(he,Te.props),qe.ref=tu(ge,he,Te),qe.return=ge,qe):(qe=Pf(Te.type,Te.key,Te.props,null,ge.mode,qe),qe.ref=tu(ge,he,Te),qe.return=ge,qe)}function je(ge,he,Te,qe){return he===null||he.tag!==4||he.stateNode.containerInfo!==Te.containerInfo||he.stateNode.implementation!==Te.implementation?(he=hx(Te,ge.mode,qe),he.return=ge,he):(he=N(he,Te.children||[]),he.return=ge,he)}function He(ge,he,Te,qe,dt){return he===null||he.tag!==7?(he=Co(Te,ge.mode,qe,dt),he.return=ge,he):(he=N(he,Te),he.return=ge,he)}function Ve(ge,he,Te){if(typeof he=="string"&&he!==""||typeof he=="number")return he=fx(""+he,ge.mode,Te),he.return=ge,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case A:return Te=Pf(he.type,he.key,he.props,null,ge.mode,Te),Te.ref=tu(ge,null,he),Te.return=ge,Te;case j:return he=hx(he,ge.mode,Te),he.return=ge,he;case fe:var qe=he._init;return Ve(ge,qe(he._payload),Te)}if(Ue(he)||Q(he))return he=Co(he,ge.mode,Te,null),he.return=ge,he;sf(ge,he)}return null}function We(ge,he,Te,qe){var dt=he!==null?he.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number")return dt!==null?null:ae(ge,he,""+Te,qe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case A:return Te.key===dt?de(ge,he,Te,qe):null;case j:return Te.key===dt?je(ge,he,Te,qe):null;case fe:return dt=Te._init,We(ge,he,dt(Te._payload),qe)}if(Ue(Te)||Q(Te))return dt!==null?null:He(ge,he,Te,qe,null);sf(ge,Te)}return null}function rt(ge,he,Te,qe,dt){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return ge=ge.get(Te)||null,ae(he,ge,""+qe,dt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case A:return ge=ge.get(qe.key===null?Te:qe.key)||null,de(he,ge,qe,dt);case j:return ge=ge.get(qe.key===null?Te:qe.key)||null,je(he,ge,qe,dt);case fe:var gt=qe._init;return rt(ge,he,Te,gt(qe._payload),dt)}if(Ue(qe)||Q(qe))return ge=ge.get(Te)||null,He(he,ge,qe,dt,null);sf(he,qe)}return null}function lt(ge,he,Te,qe){for(var dt=null,gt=null,vt=he,wt=he=0,Zr=null;vt!==null&&wt<Te.length;wt++){vt.index>wt?(Zr=vt,vt=null):Zr=vt.sibling;var Rt=We(ge,vt,Te[wt],qe);if(Rt===null){vt===null&&(vt=Zr);break}o&&vt&&Rt.alternate===null&&u(ge,vt),he=C(Rt,he,wt),gt===null?dt=Rt:gt.sibling=Rt,gt=Rt,vt=Zr}if(wt===Te.length)return m(ge,vt),sr&&yo(ge,wt),dt;if(vt===null){for(;wt<Te.length;wt++)vt=Ve(ge,Te[wt],qe),vt!==null&&(he=C(vt,he,wt),gt===null?dt=vt:gt.sibling=vt,gt=vt);return sr&&yo(ge,wt),dt}for(vt=y(ge,vt);wt<Te.length;wt++)Zr=rt(vt,ge,wt,Te[wt],qe),Zr!==null&&(o&&Zr.alternate!==null&&vt.delete(Zr.key===null?wt:Zr.key),he=C(Zr,he,wt),gt===null?dt=Zr:gt.sibling=Zr,gt=Zr);return o&&vt.forEach(function(Ls){return u(ge,Ls)}),sr&&yo(ge,wt),dt}function ct(ge,he,Te,qe){var dt=Q(Te);if(typeof dt!="function")throw Error(r(150));if(Te=dt.call(Te),Te==null)throw Error(r(151));for(var gt=dt=null,vt=he,wt=he=0,Zr=null,Rt=Te.next();vt!==null&&!Rt.done;wt++,Rt=Te.next()){vt.index>wt?(Zr=vt,vt=null):Zr=vt.sibling;var Ls=We(ge,vt,Rt.value,qe);if(Ls===null){vt===null&&(vt=Zr);break}o&&vt&&Ls.alternate===null&&u(ge,vt),he=C(Ls,he,wt),gt===null?dt=Ls:gt.sibling=Ls,gt=Ls,vt=Zr}if(Rt.done)return m(ge,vt),sr&&yo(ge,wt),dt;if(vt===null){for(;!Rt.done;wt++,Rt=Te.next())Rt=Ve(ge,Rt.value,qe),Rt!==null&&(he=C(Rt,he,wt),gt===null?dt=Rt:gt.sibling=Rt,gt=Rt);return sr&&yo(ge,wt),dt}for(vt=y(ge,vt);!Rt.done;wt++,Rt=Te.next())Rt=rt(vt,ge,wt,Rt.value,qe),Rt!==null&&(o&&Rt.alternate!==null&&vt.delete(Rt.key===null?wt:Rt.key),he=C(Rt,he,wt),gt===null?dt=Rt:gt.sibling=Rt,gt=Rt);return o&&vt.forEach(function(DR){return u(ge,DR)}),sr&&yo(ge,wt),dt}function Er(ge,he,Te,qe){if(typeof Te=="object"&&Te!==null&&Te.type===P&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case A:e:{for(var dt=Te.key,gt=he;gt!==null;){if(gt.key===dt){if(dt=Te.type,dt===P){if(gt.tag===7){m(ge,gt.sibling),he=N(gt,Te.props.children),he.return=ge,ge=he;break e}}else if(gt.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===fe&&j2(dt)===gt.type){m(ge,gt.sibling),he=N(gt,Te.props),he.ref=tu(ge,gt,Te),he.return=ge,ge=he;break e}m(ge,gt);break}else u(ge,gt);gt=gt.sibling}Te.type===P?(he=Co(Te.props.children,ge.mode,qe,Te.key),he.return=ge,ge=he):(qe=Pf(Te.type,Te.key,Te.props,null,ge.mode,qe),qe.ref=tu(ge,he,Te),qe.return=ge,ge=qe)}return R(ge);case j:e:{for(gt=Te.key;he!==null;){if(he.key===gt)if(he.tag===4&&he.stateNode.containerInfo===Te.containerInfo&&he.stateNode.implementation===Te.implementation){m(ge,he.sibling),he=N(he,Te.children||[]),he.return=ge,ge=he;break e}else{m(ge,he);break}else u(ge,he);he=he.sibling}he=hx(Te,ge.mode,qe),he.return=ge,ge=he}return R(ge);case fe:return gt=Te._init,Er(ge,he,gt(Te._payload),qe)}if(Ue(Te))return lt(ge,he,Te,qe);if(Q(Te))return ct(ge,he,Te,qe);sf(ge,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"?(Te=""+Te,he!==null&&he.tag===6?(m(ge,he.sibling),he=N(he,Te),he.return=ge,ge=he):(m(ge,he),he=fx(Te,ge.mode,qe),he.return=ge,ge=he),R(ge)):m(ge,he)}return Er}var El=O2(!0),D2=O2(!1),of=Cs(null),lf=null,Tl=null,_m=null;function Sm(){_m=Tl=lf=null}function Nm(o){var u=of.current;rr(of),o._currentValue=u}function Em(o,u,m){for(;o!==null;){var y=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,y!==null&&(y.childLanes|=u)):y!==null&&(y.childLanes&u)!==u&&(y.childLanes|=u),o===m)break;o=o.return}}function Cl(o,u){lf=o,_m=Tl=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&u)!==0&&(Jn=!0),o.firstContext=null)}function Oa(o){var u=o._currentValue;if(_m!==o)if(o={context:o,memoizedValue:u,next:null},Tl===null){if(lf===null)throw Error(r(308));Tl=o,lf.dependencies={lanes:0,firstContext:o}}else Tl=Tl.next=o;return u}var wo=null;function Tm(o){wo===null?wo=[o]:wo.push(o)}function R2(o,u,m,y){var N=u.interleaved;return N===null?(m.next=m,Tm(u)):(m.next=N.next,N.next=m),u.interleaved=m,$i(o,y)}function $i(o,u){o.lanes|=u;var m=o.alternate;for(m!==null&&(m.lanes|=u),m=o,o=o.return;o!==null;)o.childLanes|=u,m=o.alternate,m!==null&&(m.childLanes|=u),m=o,o=o.return;return m.tag===3?m.stateNode:null}var Ps=!1;function Cm(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function I2(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ui(o,u){return{eventTime:o,lane:u,tag:0,payload:null,callback:null,next:null}}function js(o,u,m){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(Dt&2)!==0){var N=y.pending;return N===null?u.next=u:(u.next=N.next,N.next=u),y.pending=u,$i(o,m)}return N=y.interleaved,N===null?(u.next=u,Tm(y)):(u.next=N.next,N.next=u),y.interleaved=u,$i(o,m)}function cf(o,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194240)!==0)){var y=u.lanes;y&=o.pendingLanes,m|=y,u.lanes=m,Up(o,m)}}function F2(o,u){var m=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var N=null,C=null;if(m=m.firstBaseUpdate,m!==null){do{var R={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};C===null?N=C=R:C=C.next=R,m=m.next}while(m!==null);C===null?N=C=u:C=C.next=u}else N=C=u;m={baseState:y.baseState,firstBaseUpdate:N,lastBaseUpdate:C,shared:y.shared,effects:y.effects},o.updateQueue=m;return}o=m.lastBaseUpdate,o===null?m.firstBaseUpdate=u:o.next=u,m.lastBaseUpdate=u}function uf(o,u,m,y){var N=o.updateQueue;Ps=!1;var C=N.firstBaseUpdate,R=N.lastBaseUpdate,ae=N.shared.pending;if(ae!==null){N.shared.pending=null;var de=ae,je=de.next;de.next=null,R===null?C=je:R.next=je,R=de;var He=o.alternate;He!==null&&(He=He.updateQueue,ae=He.lastBaseUpdate,ae!==R&&(ae===null?He.firstBaseUpdate=je:ae.next=je,He.lastBaseUpdate=de))}if(C!==null){var Ve=N.baseState;R=0,He=je=de=null,ae=C;do{var We=ae.lane,rt=ae.eventTime;if((y&We)===We){He!==null&&(He=He.next={eventTime:rt,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var lt=o,ct=ae;switch(We=u,rt=m,ct.tag){case 1:if(lt=ct.payload,typeof lt=="function"){Ve=lt.call(rt,Ve,We);break e}Ve=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=ct.payload,We=typeof lt=="function"?lt.call(rt,Ve,We):lt,We==null)break e;Ve=te({},Ve,We);break e;case 2:Ps=!0}}ae.callback!==null&&ae.lane!==0&&(o.flags|=64,We=N.effects,We===null?N.effects=[ae]:We.push(ae))}else rt={eventTime:rt,lane:We,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},He===null?(je=He=rt,de=Ve):He=He.next=rt,R|=We;if(ae=ae.next,ae===null){if(ae=N.shared.pending,ae===null)break;We=ae,ae=We.next,We.next=null,N.lastBaseUpdate=We,N.shared.pending=null}}while(!0);if(He===null&&(de=Ve),N.baseState=de,N.firstBaseUpdate=je,N.lastBaseUpdate=He,u=N.shared.interleaved,u!==null){N=u;do R|=N.lane,N=N.next;while(N!==u)}else C===null&&(N.shared.lanes=0);So|=R,o.lanes=R,o.memoizedState=Ve}}function M2(o,u,m){if(o=u.effects,u.effects=null,o!==null)for(u=0;u<o.length;u++){var y=o[u],N=y.callback;if(N!==null){if(y.callback=null,y=m,typeof N!="function")throw Error(r(191,N));N.call(y)}}}var ru={},hi=Cs(ru),nu=Cs(ru),au=Cs(ru);function bo(o){if(o===ru)throw Error(r(174));return o}function km(o,u){switch(Zt(au,u),Zt(nu,o),Zt(hi,ru),o=u.nodeType,o){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Ye(null,"");break;default:o=o===8?u.parentNode:u,u=o.namespaceURI||null,o=o.tagName,u=Ye(u,o)}rr(hi),Zt(hi,u)}function kl(){rr(hi),rr(nu),rr(au)}function L2(o){bo(au.current);var u=bo(hi.current),m=Ye(u,o.type);u!==m&&(Zt(nu,o),Zt(hi,m))}function Am(o){nu.current===o&&(rr(hi),rr(nu))}var xr=Cs(0);function df(o){for(var u=o;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Pm=[];function jm(){for(var o=0;o<Pm.length;o++)Pm[o]._workInProgressVersionPrimary=null;Pm.length=0}var ff=k.ReactCurrentDispatcher,Om=k.ReactCurrentBatchConfig,_o=0,gr=null,$r=null,qr=null,hf=!1,iu=!1,su=0,tR=0;function vn(){throw Error(r(321))}function Dm(o,u){if(u===null)return!1;for(var m=0;m<u.length&&m<o.length;m++)if(!Qa(o[m],u[m]))return!1;return!0}function Rm(o,u,m,y,N,C){if(_o=C,gr=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ff.current=o===null||o.memoizedState===null?iR:sR,o=m(y,N),iu){C=0;do{if(iu=!1,su=0,25<=C)throw Error(r(301));C+=1,qr=$r=null,u.updateQueue=null,ff.current=oR,o=m(y,N)}while(iu)}if(ff.current=xf,u=$r!==null&&$r.next!==null,_o=0,qr=$r=gr=null,hf=!1,u)throw Error(r(300));return o}function Im(){var o=su!==0;return su=0,o}function pi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qr===null?gr.memoizedState=qr=o:qr=qr.next=o,qr}function Da(){if($r===null){var o=gr.alternate;o=o!==null?o.memoizedState:null}else o=$r.next;var u=qr===null?gr.memoizedState:qr.next;if(u!==null)qr=u,$r=o;else{if(o===null)throw Error(r(310));$r=o,o={memoizedState:$r.memoizedState,baseState:$r.baseState,baseQueue:$r.baseQueue,queue:$r.queue,next:null},qr===null?gr.memoizedState=qr=o:qr=qr.next=o}return qr}function ou(o,u){return typeof u=="function"?u(o):u}function Fm(o){var u=Da(),m=u.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=o;var y=$r,N=y.baseQueue,C=m.pending;if(C!==null){if(N!==null){var R=N.next;N.next=C.next,C.next=R}y.baseQueue=N=C,m.pending=null}if(N!==null){C=N.next,y=y.baseState;var ae=R=null,de=null,je=C;do{var He=je.lane;if((_o&He)===He)de!==null&&(de=de.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),y=je.hasEagerState?je.eagerState:o(y,je.action);else{var Ve={lane:He,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};de===null?(ae=de=Ve,R=y):de=de.next=Ve,gr.lanes|=He,So|=He}je=je.next}while(je!==null&&je!==C);de===null?R=y:de.next=ae,Qa(y,u.memoizedState)||(Jn=!0),u.memoizedState=y,u.baseState=R,u.baseQueue=de,m.lastRenderedState=y}if(o=m.interleaved,o!==null){N=o;do C=N.lane,gr.lanes|=C,So|=C,N=N.next;while(N!==o)}else N===null&&(m.lanes=0);return[u.memoizedState,m.dispatch]}function Mm(o){var u=Da(),m=u.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=o;var y=m.dispatch,N=m.pending,C=u.memoizedState;if(N!==null){m.pending=null;var R=N=N.next;do C=o(C,R.action),R=R.next;while(R!==N);Qa(C,u.memoizedState)||(Jn=!0),u.memoizedState=C,u.baseQueue===null&&(u.baseState=C),m.lastRenderedState=C}return[C,y]}function B2(){}function $2(o,u){var m=gr,y=Da(),N=u(),C=!Qa(y.memoizedState,N);if(C&&(y.memoizedState=N,Jn=!0),y=y.queue,Lm(W2.bind(null,m,y,o),[o]),y.getSnapshot!==u||C||qr!==null&&qr.memoizedState.tag&1){if(m.flags|=2048,lu(9,z2.bind(null,m,y,N,u),void 0,null),Qr===null)throw Error(r(349));(_o&30)!==0||U2(m,u,N)}return N}function U2(o,u,m){o.flags|=16384,o={getSnapshot:u,value:m},u=gr.updateQueue,u===null?(u={lastEffect:null,stores:null},gr.updateQueue=u,u.stores=[o]):(m=u.stores,m===null?u.stores=[o]:m.push(o))}function z2(o,u,m,y){u.value=m,u.getSnapshot=y,H2(u)&&K2(o)}function W2(o,u,m){return m(function(){H2(u)&&K2(o)})}function H2(o){var u=o.getSnapshot;o=o.value;try{var m=u();return!Qa(o,m)}catch{return!0}}function K2(o){var u=$i(o,1);u!==null&&ri(u,o,1,-1)}function V2(o){var u=pi();return typeof o=="function"&&(o=o()),u.memoizedState=u.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ou,lastRenderedState:o},u.queue=o,o=o.dispatch=aR.bind(null,gr,o),[u.memoizedState,o]}function lu(o,u,m,y){return o={tag:o,create:u,destroy:m,deps:y,next:null},u=gr.updateQueue,u===null?(u={lastEffect:null,stores:null},gr.updateQueue=u,u.lastEffect=o.next=o):(m=u.lastEffect,m===null?u.lastEffect=o.next=o:(y=m.next,m.next=o,o.next=y,u.lastEffect=o)),o}function G2(){return Da().memoizedState}function pf(o,u,m,y){var N=pi();gr.flags|=o,N.memoizedState=lu(1|u,m,void 0,y===void 0?null:y)}function mf(o,u,m,y){var N=Da();y=y===void 0?null:y;var C=void 0;if($r!==null){var R=$r.memoizedState;if(C=R.destroy,y!==null&&Dm(y,R.deps)){N.memoizedState=lu(u,m,C,y);return}}gr.flags|=o,N.memoizedState=lu(1|u,m,C,y)}function Y2(o,u){return pf(8390656,8,o,u)}function Lm(o,u){return mf(2048,8,o,u)}function X2(o,u){return mf(4,2,o,u)}function q2(o,u){return mf(4,4,o,u)}function Q2(o,u){if(typeof u=="function")return o=o(),u(o),function(){u(null)};if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function Z2(o,u,m){return m=m!=null?m.concat([o]):null,mf(4,4,Q2.bind(null,u,o),m)}function Bm(){}function J2(o,u){var m=Da();u=u===void 0?null:u;var y=m.memoizedState;return y!==null&&u!==null&&Dm(u,y[1])?y[0]:(m.memoizedState=[o,u],o)}function e_(o,u){var m=Da();u=u===void 0?null:u;var y=m.memoizedState;return y!==null&&u!==null&&Dm(u,y[1])?y[0]:(o=o(),m.memoizedState=[o,u],o)}function t_(o,u,m){return(_o&21)===0?(o.baseState&&(o.baseState=!1,Jn=!0),o.memoizedState=m):(Qa(m,u)||(m=jb(),gr.lanes|=m,So|=m,o.baseState=!0),u)}function rR(o,u){var m=Ut;Ut=m!==0&&4>m?m:4,o(!0);var y=Om.transition;Om.transition={};try{o(!1),u()}finally{Ut=m,Om.transition=y}}function r_(){return Da().memoizedState}function nR(o,u,m){var y=Is(o);if(m={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null},n_(o))a_(u,m);else if(m=R2(o,u,m,y),m!==null){var N=Rn();ri(m,o,y,N),i_(m,u,y)}}function aR(o,u,m){var y=Is(o),N={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null};if(n_(o))a_(u,N);else{var C=o.alternate;if(o.lanes===0&&(C===null||C.lanes===0)&&(C=u.lastRenderedReducer,C!==null))try{var R=u.lastRenderedState,ae=C(R,m);if(N.hasEagerState=!0,N.eagerState=ae,Qa(ae,R)){var de=u.interleaved;de===null?(N.next=N,Tm(u)):(N.next=de.next,de.next=N),u.interleaved=N;return}}catch{}finally{}m=R2(o,u,N,y),m!==null&&(N=Rn(),ri(m,o,y,N),i_(m,u,y))}}function n_(o){var u=o.alternate;return o===gr||u!==null&&u===gr}function a_(o,u){iu=hf=!0;var m=o.pending;m===null?u.next=u:(u.next=m.next,m.next=u),o.pending=u}function i_(o,u,m){if((m&4194240)!==0){var y=u.lanes;y&=o.pendingLanes,m|=y,u.lanes=m,Up(o,m)}}var xf={readContext:Oa,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},iR={readContext:Oa,useCallback:function(o,u){return pi().memoizedState=[o,u===void 0?null:u],o},useContext:Oa,useEffect:Y2,useImperativeHandle:function(o,u,m){return m=m!=null?m.concat([o]):null,pf(4194308,4,Q2.bind(null,u,o),m)},useLayoutEffect:function(o,u){return pf(4194308,4,o,u)},useInsertionEffect:function(o,u){return pf(4,2,o,u)},useMemo:function(o,u){var m=pi();return u=u===void 0?null:u,o=o(),m.memoizedState=[o,u],o},useReducer:function(o,u,m){var y=pi();return u=m!==void 0?m(u):u,y.memoizedState=y.baseState=u,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:u},y.queue=o,o=o.dispatch=nR.bind(null,gr,o),[y.memoizedState,o]},useRef:function(o){var u=pi();return o={current:o},u.memoizedState=o},useState:V2,useDebugValue:Bm,useDeferredValue:function(o){return pi().memoizedState=o},useTransition:function(){var o=V2(!1),u=o[0];return o=rR.bind(null,o[1]),pi().memoizedState=o,[u,o]},useMutableSource:function(){},useSyncExternalStore:function(o,u,m){var y=gr,N=pi();if(sr){if(m===void 0)throw Error(r(407));m=m()}else{if(m=u(),Qr===null)throw Error(r(349));(_o&30)!==0||U2(y,u,m)}N.memoizedState=m;var C={value:m,getSnapshot:u};return N.queue=C,Y2(W2.bind(null,y,C,o),[o]),y.flags|=2048,lu(9,z2.bind(null,y,C,m,u),void 0,null),m},useId:function(){var o=pi(),u=Qr.identifierPrefix;if(sr){var m=Bi,y=Li;m=(y&~(1<<32-Nr(y)-1)).toString(32)+m,u=":"+u+"R"+m,m=su++,0<m&&(u+="H"+m.toString(32)),u+=":"}else m=tR++,u=":"+u+"r"+m.toString(32)+":";return o.memoizedState=u},unstable_isNewReconciler:!1},sR={readContext:Oa,useCallback:J2,useContext:Oa,useEffect:Lm,useImperativeHandle:Z2,useInsertionEffect:X2,useLayoutEffect:q2,useMemo:e_,useReducer:Fm,useRef:G2,useState:function(){return Fm(ou)},useDebugValue:Bm,useDeferredValue:function(o){var u=Da();return t_(u,$r.memoizedState,o)},useTransition:function(){var o=Fm(ou)[0],u=Da().memoizedState;return[o,u]},useMutableSource:B2,useSyncExternalStore:$2,useId:r_,unstable_isNewReconciler:!1},oR={readContext:Oa,useCallback:J2,useContext:Oa,useEffect:Lm,useImperativeHandle:Z2,useInsertionEffect:X2,useLayoutEffect:q2,useMemo:e_,useReducer:Mm,useRef:G2,useState:function(){return Mm(ou)},useDebugValue:Bm,useDeferredValue:function(o){var u=Da();return $r===null?u.memoizedState=o:t_(u,$r.memoizedState,o)},useTransition:function(){var o=Mm(ou)[0],u=Da().memoizedState;return[o,u]},useMutableSource:B2,useSyncExternalStore:$2,useId:r_,unstable_isNewReconciler:!1};function Ja(o,u){if(o&&o.defaultProps){u=te({},u),o=o.defaultProps;for(var m in o)u[m]===void 0&&(u[m]=o[m]);return u}return u}function $m(o,u,m,y){u=o.memoizedState,m=m(y,u),m=m==null?u:te({},u,m),o.memoizedState=m,o.lanes===0&&(o.updateQueue.baseState=m)}var gf={isMounted:function(o){return(o=o._reactInternals)?Z(o)===o:!1},enqueueSetState:function(o,u,m){o=o._reactInternals;var y=Rn(),N=Is(o),C=Ui(y,N);C.payload=u,m!=null&&(C.callback=m),u=js(o,C,N),u!==null&&(ri(u,o,N,y),cf(u,o,N))},enqueueReplaceState:function(o,u,m){o=o._reactInternals;var y=Rn(),N=Is(o),C=Ui(y,N);C.tag=1,C.payload=u,m!=null&&(C.callback=m),u=js(o,C,N),u!==null&&(ri(u,o,N,y),cf(u,o,N))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var m=Rn(),y=Is(o),N=Ui(m,y);N.tag=2,u!=null&&(N.callback=u),u=js(o,N,y),u!==null&&(ri(u,o,y,m),cf(u,o,y))}};function s_(o,u,m,y,N,C,R){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,C,R):u.prototype&&u.prototype.isPureReactComponent?!Yc(m,y)||!Yc(N,C):!0}function o_(o,u,m){var y=!1,N=ks,C=u.contextType;return typeof C=="object"&&C!==null?C=Oa(C):(N=Zn(u)?go:gn.current,y=u.contextTypes,C=(y=y!=null)?bl(o,N):ks),u=new u(m,C),o.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=gf,o.stateNode=u,u._reactInternals=o,y&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=N,o.__reactInternalMemoizedMaskedChildContext=C),u}function l_(o,u,m,y){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,y),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,y),u.state!==o&&gf.enqueueReplaceState(u,u.state,null)}function Um(o,u,m,y){var N=o.stateNode;N.props=m,N.state=o.memoizedState,N.refs={},Cm(o);var C=u.contextType;typeof C=="object"&&C!==null?N.context=Oa(C):(C=Zn(u)?go:gn.current,N.context=bl(o,C)),N.state=o.memoizedState,C=u.getDerivedStateFromProps,typeof C=="function"&&($m(o,u,C,m),N.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(u=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),u!==N.state&&gf.enqueueReplaceState(N,N.state,null),uf(o,m,N,y),N.state=o.memoizedState),typeof N.componentDidMount=="function"&&(o.flags|=4194308)}function Al(o,u){try{var m="",y=u;do m+=ue(y),y=y.return;while(y);var N=m}catch(C){N=`
Error generating stack: `+C.message+`
`+C.stack}return{value:o,source:u,stack:N,digest:null}}function zm(o,u,m){return{value:o,source:null,stack:m??null,digest:u??null}}function Wm(o,u){try{console.error(u.value)}catch(m){setTimeout(function(){throw m})}}var lR=typeof WeakMap=="function"?WeakMap:Map;function c_(o,u,m){m=Ui(-1,m),m.tag=3,m.payload={element:null};var y=u.value;return m.callback=function(){Nf||(Nf=!0,ax=y),Wm(o,u)},m}function u_(o,u,m){m=Ui(-1,m),m.tag=3;var y=o.type.getDerivedStateFromError;if(typeof y=="function"){var N=u.value;m.payload=function(){return y(N)},m.callback=function(){Wm(o,u)}}var C=o.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(m.callback=function(){Wm(o,u),typeof y!="function"&&(Ds===null?Ds=new Set([this]):Ds.add(this));var R=u.stack;this.componentDidCatch(u.value,{componentStack:R!==null?R:""})}),m}function d_(o,u,m){var y=o.pingCache;if(y===null){y=o.pingCache=new lR;var N=new Set;y.set(u,N)}else N=y.get(u),N===void 0&&(N=new Set,y.set(u,N));N.has(m)||(N.add(m),o=_R.bind(null,o,u,m),u.then(o,o))}function f_(o){do{var u;if((u=o.tag===13)&&(u=o.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return o;o=o.return}while(o!==null);return null}function h_(o,u,m,y,N){return(o.mode&1)===0?(o===u?o.flags|=65536:(o.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(u=Ui(-1,1),u.tag=2,js(m,u,1))),m.lanes|=1),o):(o.flags|=65536,o.lanes=N,o)}var cR=k.ReactCurrentOwner,Jn=!1;function Dn(o,u,m,y){u.child=o===null?D2(u,null,m,y):El(u,o.child,m,y)}function p_(o,u,m,y,N){m=m.render;var C=u.ref;return Cl(u,N),y=Rm(o,u,m,y,C,N),m=Im(),o!==null&&!Jn?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~N,zi(o,u,N)):(sr&&m&&gm(u),u.flags|=1,Dn(o,u,y,N),u.child)}function m_(o,u,m,y,N){if(o===null){var C=m.type;return typeof C=="function"&&!dx(C)&&C.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(u.tag=15,u.type=C,x_(o,u,C,y,N)):(o=Pf(m.type,null,y,u,u.mode,N),o.ref=u.ref,o.return=u,u.child=o)}if(C=o.child,(o.lanes&N)===0){var R=C.memoizedProps;if(m=m.compare,m=m!==null?m:Yc,m(R,y)&&o.ref===u.ref)return zi(o,u,N)}return u.flags|=1,o=Ms(C,y),o.ref=u.ref,o.return=u,u.child=o}function x_(o,u,m,y,N){if(o!==null){var C=o.memoizedProps;if(Yc(C,y)&&o.ref===u.ref)if(Jn=!1,u.pendingProps=y=C,(o.lanes&N)!==0)(o.flags&131072)!==0&&(Jn=!0);else return u.lanes=o.lanes,zi(o,u,N)}return Hm(o,u,m,y,N)}function g_(o,u,m){var y=u.pendingProps,N=y.children,C=o!==null?o.memoizedState:null;if(y.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(jl,pa),pa|=m;else{if((m&1073741824)===0)return o=C!==null?C.baseLanes|m:m,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:o,cachePool:null,transitions:null},u.updateQueue=null,Zt(jl,pa),pa|=o,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=C!==null?C.baseLanes:m,Zt(jl,pa),pa|=y}else C!==null?(y=C.baseLanes|m,u.memoizedState=null):y=m,Zt(jl,pa),pa|=y;return Dn(o,u,N,m),u.child}function v_(o,u){var m=u.ref;(o===null&&m!==null||o!==null&&o.ref!==m)&&(u.flags|=512,u.flags|=2097152)}function Hm(o,u,m,y,N){var C=Zn(m)?go:gn.current;return C=bl(u,C),Cl(u,N),m=Rm(o,u,m,y,C,N),y=Im(),o!==null&&!Jn?(u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~N,zi(o,u,N)):(sr&&y&&gm(u),u.flags|=1,Dn(o,u,m,N),u.child)}function y_(o,u,m,y,N){if(Zn(m)){var C=!0;ef(u)}else C=!1;if(Cl(u,N),u.stateNode===null)yf(o,u),o_(u,m,y),Um(u,m,y,N),y=!0;else if(o===null){var R=u.stateNode,ae=u.memoizedProps;R.props=ae;var de=R.context,je=m.contextType;typeof je=="object"&&je!==null?je=Oa(je):(je=Zn(m)?go:gn.current,je=bl(u,je));var He=m.getDerivedStateFromProps,Ve=typeof He=="function"||typeof R.getSnapshotBeforeUpdate=="function";Ve||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ae!==y||de!==je)&&l_(u,R,y,je),Ps=!1;var We=u.memoizedState;R.state=We,uf(u,y,R,N),de=u.memoizedState,ae!==y||We!==de||Qn.current||Ps?(typeof He=="function"&&($m(u,m,He,y),de=u.memoizedState),(ae=Ps||s_(u,m,ae,y,We,de,je))?(Ve||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(u.flags|=4194308)):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=y,u.memoizedState=de),R.props=y,R.state=de,R.context=je,y=ae):(typeof R.componentDidMount=="function"&&(u.flags|=4194308),y=!1)}else{R=u.stateNode,I2(o,u),ae=u.memoizedProps,je=u.type===u.elementType?ae:Ja(u.type,ae),R.props=je,Ve=u.pendingProps,We=R.context,de=m.contextType,typeof de=="object"&&de!==null?de=Oa(de):(de=Zn(m)?go:gn.current,de=bl(u,de));var rt=m.getDerivedStateFromProps;(He=typeof rt=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ae!==Ve||We!==de)&&l_(u,R,y,de),Ps=!1,We=u.memoizedState,R.state=We,uf(u,y,R,N);var lt=u.memoizedState;ae!==Ve||We!==lt||Qn.current||Ps?(typeof rt=="function"&&($m(u,m,rt,y),lt=u.memoizedState),(je=Ps||s_(u,m,je,y,We,lt,de)||!1)?(He||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(y,lt,de),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(y,lt,de)),typeof R.componentDidUpdate=="function"&&(u.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof R.componentDidUpdate!="function"||ae===o.memoizedProps&&We===o.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===o.memoizedProps&&We===o.memoizedState||(u.flags|=1024),u.memoizedProps=y,u.memoizedState=lt),R.props=y,R.state=lt,R.context=de,y=je):(typeof R.componentDidUpdate!="function"||ae===o.memoizedProps&&We===o.memoizedState||(u.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||ae===o.memoizedProps&&We===o.memoizedState||(u.flags|=1024),y=!1)}return Km(o,u,m,y,C,N)}function Km(o,u,m,y,N,C){v_(o,u);var R=(u.flags&128)!==0;if(!y&&!R)return N&&N2(u,m,!1),zi(o,u,C);y=u.stateNode,cR.current=u;var ae=R&&typeof m.getDerivedStateFromError!="function"?null:y.render();return u.flags|=1,o!==null&&R?(u.child=El(u,o.child,null,C),u.child=El(u,null,ae,C)):Dn(o,u,ae,C),u.memoizedState=y.state,N&&N2(u,m,!0),u.child}function w_(o){var u=o.stateNode;u.pendingContext?_2(o,u.pendingContext,u.pendingContext!==u.context):u.context&&_2(o,u.context,!1),km(o,u.containerInfo)}function b_(o,u,m,y,N){return Nl(),bm(N),u.flags|=256,Dn(o,u,m,y),u.child}var Vm={dehydrated:null,treeContext:null,retryLane:0};function Gm(o){return{baseLanes:o,cachePool:null,transitions:null}}function __(o,u,m){var y=u.pendingProps,N=xr.current,C=!1,R=(u.flags&128)!==0,ae;if((ae=R)||(ae=o!==null&&o.memoizedState===null?!1:(N&2)!==0),ae?(C=!0,u.flags&=-129):(o===null||o.memoizedState!==null)&&(N|=1),Zt(xr,N&1),o===null)return wm(u),o=u.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((u.mode&1)===0?u.lanes=1:o.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(R=y.children,o=y.fallback,C?(y=u.mode,C=u.child,R={mode:"hidden",children:R},(y&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=R):C=jf(R,y,0,null),o=Co(o,y,m,null),C.return=u,o.return=u,C.sibling=o,u.child=C,u.child.memoizedState=Gm(m),u.memoizedState=Vm,o):Ym(u,R));if(N=o.memoizedState,N!==null&&(ae=N.dehydrated,ae!==null))return uR(o,u,R,y,ae,N,m);if(C){C=y.fallback,R=u.mode,N=o.child,ae=N.sibling;var de={mode:"hidden",children:y.children};return(R&1)===0&&u.child!==N?(y=u.child,y.childLanes=0,y.pendingProps=de,u.deletions=null):(y=Ms(N,de),y.subtreeFlags=N.subtreeFlags&14680064),ae!==null?C=Ms(ae,C):(C=Co(C,R,m,null),C.flags|=2),C.return=u,y.return=u,y.sibling=C,u.child=y,y=C,C=u.child,R=o.child.memoizedState,R=R===null?Gm(m):{baseLanes:R.baseLanes|m,cachePool:null,transitions:R.transitions},C.memoizedState=R,C.childLanes=o.childLanes&~m,u.memoizedState=Vm,y}return C=o.child,o=C.sibling,y=Ms(C,{mode:"visible",children:y.children}),(u.mode&1)===0&&(y.lanes=m),y.return=u,y.sibling=null,o!==null&&(m=u.deletions,m===null?(u.deletions=[o],u.flags|=16):m.push(o)),u.child=y,u.memoizedState=null,y}function Ym(o,u){return u=jf({mode:"visible",children:u},o.mode,0,null),u.return=o,o.child=u}function vf(o,u,m,y){return y!==null&&bm(y),El(u,o.child,null,m),o=Ym(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function uR(o,u,m,y,N,C,R){if(m)return u.flags&256?(u.flags&=-257,y=zm(Error(r(422))),vf(o,u,R,y)):u.memoizedState!==null?(u.child=o.child,u.flags|=128,null):(C=y.fallback,N=u.mode,y=jf({mode:"visible",children:y.children},N,0,null),C=Co(C,N,R,null),C.flags|=2,y.return=u,C.return=u,y.sibling=C,u.child=y,(u.mode&1)!==0&&El(u,o.child,null,R),u.child.memoizedState=Gm(R),u.memoizedState=Vm,C);if((u.mode&1)===0)return vf(o,u,R,null);if(N.data==="$!"){if(y=N.nextSibling&&N.nextSibling.dataset,y)var ae=y.dgst;return y=ae,C=Error(r(419)),y=zm(C,y,void 0),vf(o,u,R,y)}if(ae=(R&o.childLanes)!==0,Jn||ae){if(y=Qr,y!==null){switch(R&-R){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(y.suspendedLanes|R))!==0?0:N,N!==0&&N!==C.retryLane&&(C.retryLane=N,$i(o,N),ri(y,o,N,-1))}return ux(),y=zm(Error(r(421))),vf(o,u,R,y)}return N.data==="$?"?(u.flags|=128,u.child=o.child,u=SR.bind(null,o),N._reactRetry=u,null):(o=C.treeContext,ha=Ts(N.nextSibling),fa=u,sr=!0,Za=null,o!==null&&(Pa[ja++]=Li,Pa[ja++]=Bi,Pa[ja++]=vo,Li=o.id,Bi=o.overflow,vo=u),u=Ym(u,y.children),u.flags|=4096,u)}function S_(o,u,m){o.lanes|=u;var y=o.alternate;y!==null&&(y.lanes|=u),Em(o.return,u,m)}function Xm(o,u,m,y,N){var C=o.memoizedState;C===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:N}:(C.isBackwards=u,C.rendering=null,C.renderingStartTime=0,C.last=y,C.tail=m,C.tailMode=N)}function N_(o,u,m){var y=u.pendingProps,N=y.revealOrder,C=y.tail;if(Dn(o,u,y.children,m),y=xr.current,(y&2)!==0)y=y&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&S_(o,m,u);else if(o.tag===19)S_(o,m,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}y&=1}if(Zt(xr,y),(u.mode&1)===0)u.memoizedState=null;else switch(N){case"forwards":for(m=u.child,N=null;m!==null;)o=m.alternate,o!==null&&df(o)===null&&(N=m),m=m.sibling;m=N,m===null?(N=u.child,u.child=null):(N=m.sibling,m.sibling=null),Xm(u,!1,N,m,C);break;case"backwards":for(m=null,N=u.child,u.child=null;N!==null;){if(o=N.alternate,o!==null&&df(o)===null){u.child=N;break}o=N.sibling,N.sibling=m,m=N,N=o}Xm(u,!0,m,null,C);break;case"together":Xm(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function yf(o,u){(u.mode&1)===0&&o!==null&&(o.alternate=null,u.alternate=null,u.flags|=2)}function zi(o,u,m){if(o!==null&&(u.dependencies=o.dependencies),So|=u.lanes,(m&u.childLanes)===0)return null;if(o!==null&&u.child!==o.child)throw Error(r(153));if(u.child!==null){for(o=u.child,m=Ms(o,o.pendingProps),u.child=m,m.return=u;o.sibling!==null;)o=o.sibling,m=m.sibling=Ms(o,o.pendingProps),m.return=u;m.sibling=null}return u.child}function dR(o,u,m){switch(u.tag){case 3:w_(u),Nl();break;case 5:L2(u);break;case 1:Zn(u.type)&&ef(u);break;case 4:km(u,u.stateNode.containerInfo);break;case 10:var y=u.type._context,N=u.memoizedProps.value;Zt(of,y._currentValue),y._currentValue=N;break;case 13:if(y=u.memoizedState,y!==null)return y.dehydrated!==null?(Zt(xr,xr.current&1),u.flags|=128,null):(m&u.child.childLanes)!==0?__(o,u,m):(Zt(xr,xr.current&1),o=zi(o,u,m),o!==null?o.sibling:null);Zt(xr,xr.current&1);break;case 19:if(y=(m&u.childLanes)!==0,(o.flags&128)!==0){if(y)return N_(o,u,m);u.flags|=128}if(N=u.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),Zt(xr,xr.current),y)break;return null;case 22:case 23:return u.lanes=0,g_(o,u,m)}return zi(o,u,m)}var E_,qm,T_,C_;E_=function(o,u){for(var m=u.child;m!==null;){if(m.tag===5||m.tag===6)o.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},qm=function(){},T_=function(o,u,m,y){var N=o.memoizedProps;if(N!==y){o=u.stateNode,bo(hi.current);var C=null;switch(m){case"input":N=Pe(o,N),y=Pe(o,y),C=[];break;case"select":N=te({},N,{value:void 0}),y=te({},y,{value:void 0}),C=[];break;case"textarea":N=Ae(o,N),y=Ae(o,y),C=[];break;default:typeof N.onClick!="function"&&typeof y.onClick=="function"&&(o.onclick=Qd)}Ie(m,y);var R;m=null;for(je in N)if(!y.hasOwnProperty(je)&&N.hasOwnProperty(je)&&N[je]!=null)if(je==="style"){var ae=N[je];for(R in ae)ae.hasOwnProperty(R)&&(m||(m={}),m[R]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(a.hasOwnProperty(je)?C||(C=[]):(C=C||[]).push(je,null));for(je in y){var de=y[je];if(ae=N?.[je],y.hasOwnProperty(je)&&de!==ae&&(de!=null||ae!=null))if(je==="style")if(ae){for(R in ae)!ae.hasOwnProperty(R)||de&&de.hasOwnProperty(R)||(m||(m={}),m[R]="");for(R in de)de.hasOwnProperty(R)&&ae[R]!==de[R]&&(m||(m={}),m[R]=de[R])}else m||(C||(C=[]),C.push(je,m)),m=de;else je==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,ae=ae?ae.__html:void 0,de!=null&&ae!==de&&(C=C||[]).push(je,de)):je==="children"?typeof de!="string"&&typeof de!="number"||(C=C||[]).push(je,""+de):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(a.hasOwnProperty(je)?(de!=null&&je==="onScroll"&&tr("scroll",o),C||ae===de||(C=[])):(C=C||[]).push(je,de))}m&&(C=C||[]).push("style",m);var je=C;(u.updateQueue=je)&&(u.flags|=4)}},C_=function(o,u,m,y){m!==y&&(u.flags|=4)};function cu(o,u){if(!sr)switch(o.tailMode){case"hidden":u=o.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?o.tail=null:m.sibling=null;break;case"collapsed":m=o.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function yn(o){var u=o.alternate!==null&&o.alternate.child===o.child,m=0,y=0;if(u)for(var N=o.child;N!==null;)m|=N.lanes|N.childLanes,y|=N.subtreeFlags&14680064,y|=N.flags&14680064,N.return=o,N=N.sibling;else for(N=o.child;N!==null;)m|=N.lanes|N.childLanes,y|=N.subtreeFlags,y|=N.flags,N.return=o,N=N.sibling;return o.subtreeFlags|=y,o.childLanes=m,u}function fR(o,u,m){var y=u.pendingProps;switch(vm(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(u),null;case 1:return Zn(u.type)&&Jd(),yn(u),null;case 3:return y=u.stateNode,kl(),rr(Qn),rr(gn),jm(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(o===null||o.child===null)&&(af(u)?u.flags|=4:o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Za!==null&&(ox(Za),Za=null))),qm(o,u),yn(u),null;case 5:Am(u);var N=bo(au.current);if(m=u.type,o!==null&&u.stateNode!=null)T_(o,u,m,y,N),o.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!y){if(u.stateNode===null)throw Error(r(166));return yn(u),null}if(o=bo(hi.current),af(u)){y=u.stateNode,m=u.type;var C=u.memoizedProps;switch(y[fi]=u,y[Jc]=C,o=(u.mode&1)!==0,m){case"dialog":tr("cancel",y),tr("close",y);break;case"iframe":case"object":case"embed":tr("load",y);break;case"video":case"audio":for(N=0;N<qc.length;N++)tr(qc[N],y);break;case"source":tr("error",y);break;case"img":case"image":case"link":tr("error",y),tr("load",y);break;case"details":tr("toggle",y);break;case"input":we(y,C),tr("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!C.multiple},tr("invalid",y);break;case"textarea":ve(y,C),tr("invalid",y)}Ie(m,C),N=null;for(var R in C)if(C.hasOwnProperty(R)){var ae=C[R];R==="children"?typeof ae=="string"?y.textContent!==ae&&(C.suppressHydrationWarning!==!0&&qd(y.textContent,ae,o),N=["children",ae]):typeof ae=="number"&&y.textContent!==""+ae&&(C.suppressHydrationWarning!==!0&&qd(y.textContent,ae,o),N=["children",""+ae]):a.hasOwnProperty(R)&&ae!=null&&R==="onScroll"&&tr("scroll",y)}switch(m){case"input":z(y),le(y,C,!0);break;case"textarea":z(y),pe(y);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(y.onclick=Qd)}y=N,u.updateQueue=y,y!==null&&(u.flags|=4)}else{R=N.nodeType===9?N:N.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=tt(m)),o==="http://www.w3.org/1999/xhtml"?m==="script"?(o=R.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof y.is=="string"?o=R.createElement(m,{is:y.is}):(o=R.createElement(m),m==="select"&&(R=o,y.multiple?R.multiple=!0:y.size&&(R.size=y.size))):o=R.createElementNS(o,m),o[fi]=u,o[Jc]=y,E_(o,u,!1,!1),u.stateNode=o;e:{switch(R=at(m,y),m){case"dialog":tr("cancel",o),tr("close",o),N=y;break;case"iframe":case"object":case"embed":tr("load",o),N=y;break;case"video":case"audio":for(N=0;N<qc.length;N++)tr(qc[N],o);N=y;break;case"source":tr("error",o),N=y;break;case"img":case"image":case"link":tr("error",o),tr("load",o),N=y;break;case"details":tr("toggle",o),N=y;break;case"input":we(o,y),N=Pe(o,y),tr("invalid",o);break;case"option":N=y;break;case"select":o._wrapperState={wasMultiple:!!y.multiple},N=te({},y,{value:void 0}),tr("invalid",o);break;case"textarea":ve(o,y),N=Ae(o,y),tr("invalid",o);break;default:N=y}Ie(m,N),ae=N;for(C in ae)if(ae.hasOwnProperty(C)){var de=ae[C];C==="style"?Ot(o,de):C==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&ot(o,de)):C==="children"?typeof de=="string"?(m!=="textarea"||de!=="")&&et(o,de):typeof de=="number"&&et(o,""+de):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(a.hasOwnProperty(C)?de!=null&&C==="onScroll"&&tr("scroll",o):de!=null&&E(o,C,de,R))}switch(m){case"input":z(o),le(o,y,!1);break;case"textarea":z(o),pe(o);break;case"option":y.value!=null&&o.setAttribute("value",""+U(y.value));break;case"select":o.multiple=!!y.multiple,C=y.value,C!=null?Ce(o,!!y.multiple,C,!1):y.defaultValue!=null&&Ce(o,!!y.multiple,y.defaultValue,!0);break;default:typeof N.onClick=="function"&&(o.onclick=Qd)}switch(m){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return yn(u),null;case 6:if(o&&u.stateNode!=null)C_(o,u,o.memoizedProps,y);else{if(typeof y!="string"&&u.stateNode===null)throw Error(r(166));if(m=bo(au.current),bo(hi.current),af(u)){if(y=u.stateNode,m=u.memoizedProps,y[fi]=u,(C=y.nodeValue!==m)&&(o=fa,o!==null))switch(o.tag){case 3:qd(y.nodeValue,m,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&qd(y.nodeValue,m,(o.mode&1)!==0)}C&&(u.flags|=4)}else y=(m.nodeType===9?m:m.ownerDocument).createTextNode(y),y[fi]=u,u.stateNode=y}return yn(u),null;case 13:if(rr(xr),y=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(sr&&ha!==null&&(u.mode&1)!==0&&(u.flags&128)===0)P2(),Nl(),u.flags|=98560,C=!1;else if(C=af(u),y!==null&&y.dehydrated!==null){if(o===null){if(!C)throw Error(r(318));if(C=u.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));C[fi]=u}else Nl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;yn(u),C=!1}else Za!==null&&(ox(Za),Za=null),C=!0;if(!C)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=m,u):(y=y!==null,y!==(o!==null&&o.memoizedState!==null)&&y&&(u.child.flags|=8192,(u.mode&1)!==0&&(o===null||(xr.current&1)!==0?Ur===0&&(Ur=3):ux())),u.updateQueue!==null&&(u.flags|=4),yn(u),null);case 4:return kl(),qm(o,u),o===null&&Qc(u.stateNode.containerInfo),yn(u),null;case 10:return Nm(u.type._context),yn(u),null;case 17:return Zn(u.type)&&Jd(),yn(u),null;case 19:if(rr(xr),C=u.memoizedState,C===null)return yn(u),null;if(y=(u.flags&128)!==0,R=C.rendering,R===null)if(y)cu(C,!1);else{if(Ur!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(R=df(o),R!==null){for(u.flags|=128,cu(C,!1),y=R.updateQueue,y!==null&&(u.updateQueue=y,u.flags|=4),u.subtreeFlags=0,y=m,m=u.child;m!==null;)C=m,o=y,C.flags&=14680066,R=C.alternate,R===null?(C.childLanes=0,C.lanes=o,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=R.childLanes,C.lanes=R.lanes,C.child=R.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=R.memoizedProps,C.memoizedState=R.memoizedState,C.updateQueue=R.updateQueue,C.type=R.type,o=R.dependencies,C.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),m=m.sibling;return Zt(xr,xr.current&1|2),u.child}o=o.sibling}C.tail!==null&&ze()>Ol&&(u.flags|=128,y=!0,cu(C,!1),u.lanes=4194304)}else{if(!y)if(o=df(R),o!==null){if(u.flags|=128,y=!0,m=o.updateQueue,m!==null&&(u.updateQueue=m,u.flags|=4),cu(C,!0),C.tail===null&&C.tailMode==="hidden"&&!R.alternate&&!sr)return yn(u),null}else 2*ze()-C.renderingStartTime>Ol&&m!==1073741824&&(u.flags|=128,y=!0,cu(C,!1),u.lanes=4194304);C.isBackwards?(R.sibling=u.child,u.child=R):(m=C.last,m!==null?m.sibling=R:u.child=R,C.last=R)}return C.tail!==null?(u=C.tail,C.rendering=u,C.tail=u.sibling,C.renderingStartTime=ze(),u.sibling=null,m=xr.current,Zt(xr,y?m&1|2:m&1),u):(yn(u),null);case 22:case 23:return cx(),y=u.memoizedState!==null,o!==null&&o.memoizedState!==null!==y&&(u.flags|=8192),y&&(u.mode&1)!==0?(pa&1073741824)!==0&&(yn(u),u.subtreeFlags&6&&(u.flags|=8192)):yn(u),null;case 24:return null;case 25:return null}throw Error(r(156,u.tag))}function hR(o,u){switch(vm(u),u.tag){case 1:return Zn(u.type)&&Jd(),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return kl(),rr(Qn),rr(gn),jm(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 5:return Am(u),null;case 13:if(rr(xr),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(r(340));Nl()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return rr(xr),null;case 4:return kl(),null;case 10:return Nm(u.type._context),null;case 22:case 23:return cx(),null;case 24:return null;default:return null}}var wf=!1,wn=!1,pR=typeof WeakSet=="function"?WeakSet:Set,it=null;function Pl(o,u){var m=o.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(y){wr(o,u,y)}else m.current=null}function Qm(o,u,m){try{m()}catch(y){wr(o,u,y)}}var k_=!1;function mR(o,u){if(cm=Bd,o=s2(),tm(o)){if("selectionStart"in o)var m={start:o.selectionStart,end:o.selectionEnd};else e:{m=(m=o.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var N=y.anchorOffset,C=y.focusNode;y=y.focusOffset;try{m.nodeType,C.nodeType}catch{m=null;break e}var R=0,ae=-1,de=-1,je=0,He=0,Ve=o,We=null;t:for(;;){for(var rt;Ve!==m||N!==0&&Ve.nodeType!==3||(ae=R+N),Ve!==C||y!==0&&Ve.nodeType!==3||(de=R+y),Ve.nodeType===3&&(R+=Ve.nodeValue.length),(rt=Ve.firstChild)!==null;)We=Ve,Ve=rt;for(;;){if(Ve===o)break t;if(We===m&&++je===N&&(ae=R),We===C&&++He===y&&(de=R),(rt=Ve.nextSibling)!==null)break;Ve=We,We=Ve.parentNode}Ve=rt}m=ae===-1||de===-1?null:{start:ae,end:de}}else m=null}m=m||{start:0,end:0}}else m=null;for(um={focusedElem:o,selectionRange:m},Bd=!1,it=u;it!==null;)if(u=it,o=u.child,(u.subtreeFlags&1028)!==0&&o!==null)o.return=u,it=o;else for(;it!==null;){u=it;try{var lt=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var ct=lt.memoizedProps,Er=lt.memoizedState,ge=u.stateNode,he=ge.getSnapshotBeforeUpdate(u.elementType===u.type?ct:Ja(u.type,ct),Er);ge.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var Te=u.stateNode.containerInfo;Te.nodeType===1?Te.textContent="":Te.nodeType===9&&Te.documentElement&&Te.removeChild(Te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(qe){wr(u,u.return,qe)}if(o=u.sibling,o!==null){o.return=u.return,it=o;break}it=u.return}return lt=k_,k_=!1,lt}function uu(o,u,m){var y=u.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var N=y=y.next;do{if((N.tag&o)===o){var C=N.destroy;N.destroy=void 0,C!==void 0&&Qm(u,m,C)}N=N.next}while(N!==y)}}function bf(o,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var m=u=u.next;do{if((m.tag&o)===o){var y=m.create;m.destroy=y()}m=m.next}while(m!==u)}}function Zm(o){var u=o.ref;if(u!==null){var m=o.stateNode;switch(o.tag){case 5:o=m;break;default:o=m}typeof u=="function"?u(o):u.current=o}}function A_(o){var u=o.alternate;u!==null&&(o.alternate=null,A_(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&(delete u[fi],delete u[Jc],delete u[pm],delete u[QD],delete u[ZD])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function P_(o){return o.tag===5||o.tag===3||o.tag===4}function j_(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||P_(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Jm(o,u,m){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?m.nodeType===8?m.parentNode.insertBefore(o,u):m.insertBefore(o,u):(m.nodeType===8?(u=m.parentNode,u.insertBefore(o,m)):(u=m,u.appendChild(o)),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Qd));else if(y!==4&&(o=o.child,o!==null))for(Jm(o,u,m),o=o.sibling;o!==null;)Jm(o,u,m),o=o.sibling}function ex(o,u,m){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?m.insertBefore(o,u):m.appendChild(o);else if(y!==4&&(o=o.child,o!==null))for(ex(o,u,m),o=o.sibling;o!==null;)ex(o,u,m),o=o.sibling}var nn=null,ei=!1;function Os(o,u,m){for(m=m.child;m!==null;)O_(o,u,m),m=m.sibling}function O_(o,u,m){if(Xr&&typeof Xr.onCommitFiberUnmount=="function")try{Xr.onCommitFiberUnmount(di,m)}catch{}switch(m.tag){case 5:wn||Pl(m,u);case 6:var y=nn,N=ei;nn=null,Os(o,u,m),nn=y,ei=N,nn!==null&&(ei?(o=nn,m=m.stateNode,o.nodeType===8?o.parentNode.removeChild(m):o.removeChild(m)):nn.removeChild(m.stateNode));break;case 18:nn!==null&&(ei?(o=nn,m=m.stateNode,o.nodeType===8?hm(o.parentNode,m):o.nodeType===1&&hm(o,m),zc(o)):hm(nn,m.stateNode));break;case 4:y=nn,N=ei,nn=m.stateNode.containerInfo,ei=!0,Os(o,u,m),nn=y,ei=N;break;case 0:case 11:case 14:case 15:if(!wn&&(y=m.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){N=y=y.next;do{var C=N,R=C.destroy;C=C.tag,R!==void 0&&((C&2)!==0||(C&4)!==0)&&Qm(m,u,R),N=N.next}while(N!==y)}Os(o,u,m);break;case 1:if(!wn&&(Pl(m,u),y=m.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=m.memoizedProps,y.state=m.memoizedState,y.componentWillUnmount()}catch(ae){wr(m,u,ae)}Os(o,u,m);break;case 21:Os(o,u,m);break;case 22:m.mode&1?(wn=(y=wn)||m.memoizedState!==null,Os(o,u,m),wn=y):Os(o,u,m);break;default:Os(o,u,m)}}function D_(o){var u=o.updateQueue;if(u!==null){o.updateQueue=null;var m=o.stateNode;m===null&&(m=o.stateNode=new pR),u.forEach(function(y){var N=NR.bind(null,o,y);m.has(y)||(m.add(y),y.then(N,N))})}}function ti(o,u){var m=u.deletions;if(m!==null)for(var y=0;y<m.length;y++){var N=m[y];try{var C=o,R=u,ae=R;e:for(;ae!==null;){switch(ae.tag){case 5:nn=ae.stateNode,ei=!1;break e;case 3:nn=ae.stateNode.containerInfo,ei=!0;break e;case 4:nn=ae.stateNode.containerInfo,ei=!0;break e}ae=ae.return}if(nn===null)throw Error(r(160));O_(C,R,N),nn=null,ei=!1;var de=N.alternate;de!==null&&(de.return=null),N.return=null}catch(je){wr(N,u,je)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)R_(u,o),u=u.sibling}function R_(o,u){var m=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ti(u,o),mi(o),y&4){try{uu(3,o,o.return),bf(3,o)}catch(ct){wr(o,o.return,ct)}try{uu(5,o,o.return)}catch(ct){wr(o,o.return,ct)}}break;case 1:ti(u,o),mi(o),y&512&&m!==null&&Pl(m,m.return);break;case 5:if(ti(u,o),mi(o),y&512&&m!==null&&Pl(m,m.return),o.flags&32){var N=o.stateNode;try{et(N,"")}catch(ct){wr(o,o.return,ct)}}if(y&4&&(N=o.stateNode,N!=null)){var C=o.memoizedProps,R=m!==null?m.memoizedProps:C,ae=o.type,de=o.updateQueue;if(o.updateQueue=null,de!==null)try{ae==="input"&&C.type==="radio"&&C.name!=null&&xe(N,C),at(ae,R);var je=at(ae,C);for(R=0;R<de.length;R+=2){var He=de[R],Ve=de[R+1];He==="style"?Ot(N,Ve):He==="dangerouslySetInnerHTML"?ot(N,Ve):He==="children"?et(N,Ve):E(N,He,Ve,je)}switch(ae){case"input":Ee(N,C);break;case"textarea":Le(N,C);break;case"select":var We=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!C.multiple;var rt=C.value;rt!=null?Ce(N,!!C.multiple,rt,!1):We!==!!C.multiple&&(C.defaultValue!=null?Ce(N,!!C.multiple,C.defaultValue,!0):Ce(N,!!C.multiple,C.multiple?[]:"",!1))}N[Jc]=C}catch(ct){wr(o,o.return,ct)}}break;case 6:if(ti(u,o),mi(o),y&4){if(o.stateNode===null)throw Error(r(162));N=o.stateNode,C=o.memoizedProps;try{N.nodeValue=C}catch(ct){wr(o,o.return,ct)}}break;case 3:if(ti(u,o),mi(o),y&4&&m!==null&&m.memoizedState.isDehydrated)try{zc(u.containerInfo)}catch(ct){wr(o,o.return,ct)}break;case 4:ti(u,o),mi(o);break;case 13:ti(u,o),mi(o),N=o.child,N.flags&8192&&(C=N.memoizedState!==null,N.stateNode.isHidden=C,!C||N.alternate!==null&&N.alternate.memoizedState!==null||(nx=ze())),y&4&&D_(o);break;case 22:if(He=m!==null&&m.memoizedState!==null,o.mode&1?(wn=(je=wn)||He,ti(u,o),wn=je):ti(u,o),mi(o),y&8192){if(je=o.memoizedState!==null,(o.stateNode.isHidden=je)&&!He&&(o.mode&1)!==0)for(it=o,He=o.child;He!==null;){for(Ve=it=He;it!==null;){switch(We=it,rt=We.child,We.tag){case 0:case 11:case 14:case 15:uu(4,We,We.return);break;case 1:Pl(We,We.return);var lt=We.stateNode;if(typeof lt.componentWillUnmount=="function"){y=We,m=We.return;try{u=y,lt.props=u.memoizedProps,lt.state=u.memoizedState,lt.componentWillUnmount()}catch(ct){wr(y,m,ct)}}break;case 5:Pl(We,We.return);break;case 22:if(We.memoizedState!==null){M_(Ve);continue}}rt!==null?(rt.return=We,it=rt):M_(Ve)}He=He.sibling}e:for(He=null,Ve=o;;){if(Ve.tag===5){if(He===null){He=Ve;try{N=Ve.stateNode,je?(C=N.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(ae=Ve.stateNode,de=Ve.memoizedProps.style,R=de!=null&&de.hasOwnProperty("display")?de.display:null,ae.style.display=At("display",R))}catch(ct){wr(o,o.return,ct)}}}else if(Ve.tag===6){if(He===null)try{Ve.stateNode.nodeValue=je?"":Ve.memoizedProps}catch(ct){wr(o,o.return,ct)}}else if((Ve.tag!==22&&Ve.tag!==23||Ve.memoizedState===null||Ve===o)&&Ve.child!==null){Ve.child.return=Ve,Ve=Ve.child;continue}if(Ve===o)break e;for(;Ve.sibling===null;){if(Ve.return===null||Ve.return===o)break e;He===Ve&&(He=null),Ve=Ve.return}He===Ve&&(He=null),Ve.sibling.return=Ve.return,Ve=Ve.sibling}}break;case 19:ti(u,o),mi(o),y&4&&D_(o);break;case 21:break;default:ti(u,o),mi(o)}}function mi(o){var u=o.flags;if(u&2){try{e:{for(var m=o.return;m!==null;){if(P_(m)){var y=m;break e}m=m.return}throw Error(r(160))}switch(y.tag){case 5:var N=y.stateNode;y.flags&32&&(et(N,""),y.flags&=-33);var C=j_(o);ex(o,C,N);break;case 3:case 4:var R=y.stateNode.containerInfo,ae=j_(o);Jm(o,ae,R);break;default:throw Error(r(161))}}catch(de){wr(o,o.return,de)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function xR(o,u,m){it=o,I_(o)}function I_(o,u,m){for(var y=(o.mode&1)!==0;it!==null;){var N=it,C=N.child;if(N.tag===22&&y){var R=N.memoizedState!==null||wf;if(!R){var ae=N.alternate,de=ae!==null&&ae.memoizedState!==null||wn;ae=wf;var je=wn;if(wf=R,(wn=de)&&!je)for(it=N;it!==null;)R=it,de=R.child,R.tag===22&&R.memoizedState!==null?L_(N):de!==null?(de.return=R,it=de):L_(N);for(;C!==null;)it=C,I_(C),C=C.sibling;it=N,wf=ae,wn=je}F_(o)}else(N.subtreeFlags&8772)!==0&&C!==null?(C.return=N,it=C):F_(o)}}function F_(o){for(;it!==null;){var u=it;if((u.flags&8772)!==0){var m=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:wn||bf(5,u);break;case 1:var y=u.stateNode;if(u.flags&4&&!wn)if(m===null)y.componentDidMount();else{var N=u.elementType===u.type?m.memoizedProps:Ja(u.type,m.memoizedProps);y.componentDidUpdate(N,m.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var C=u.updateQueue;C!==null&&M2(u,C,y);break;case 3:var R=u.updateQueue;if(R!==null){if(m=null,u.child!==null)switch(u.child.tag){case 5:m=u.child.stateNode;break;case 1:m=u.child.stateNode}M2(u,R,m)}break;case 5:var ae=u.stateNode;if(m===null&&u.flags&4){m=ae;var de=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&m.focus();break;case"img":de.src&&(m.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var je=u.alternate;if(je!==null){var He=je.memoizedState;if(He!==null){var Ve=He.dehydrated;Ve!==null&&zc(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}wn||u.flags&512&&Zm(u)}catch(We){wr(u,u.return,We)}}if(u===o){it=null;break}if(m=u.sibling,m!==null){m.return=u.return,it=m;break}it=u.return}}function M_(o){for(;it!==null;){var u=it;if(u===o){it=null;break}var m=u.sibling;if(m!==null){m.return=u.return,it=m;break}it=u.return}}function L_(o){for(;it!==null;){var u=it;try{switch(u.tag){case 0:case 11:case 15:var m=u.return;try{bf(4,u)}catch(de){wr(u,m,de)}break;case 1:var y=u.stateNode;if(typeof y.componentDidMount=="function"){var N=u.return;try{y.componentDidMount()}catch(de){wr(u,N,de)}}var C=u.return;try{Zm(u)}catch(de){wr(u,C,de)}break;case 5:var R=u.return;try{Zm(u)}catch(de){wr(u,R,de)}}}catch(de){wr(u,u.return,de)}if(u===o){it=null;break}var ae=u.sibling;if(ae!==null){ae.return=u.return,it=ae;break}it=u.return}}var gR=Math.ceil,_f=k.ReactCurrentDispatcher,tx=k.ReactCurrentOwner,Ra=k.ReactCurrentBatchConfig,Dt=0,Qr=null,Pr=null,an=0,pa=0,jl=Cs(0),Ur=0,du=null,So=0,Sf=0,rx=0,fu=null,ea=null,nx=0,Ol=1/0,Wi=null,Nf=!1,ax=null,Ds=null,Ef=!1,Rs=null,Tf=0,hu=0,ix=null,Cf=-1,kf=0;function Rn(){return(Dt&6)!==0?ze():Cf!==-1?Cf:Cf=ze()}function Is(o){return(o.mode&1)===0?1:(Dt&2)!==0&&an!==0?an&-an:eR.transition!==null?(kf===0&&(kf=jb()),kf):(o=Ut,o!==0||(o=window.event,o=o===void 0?16:$b(o.type)),o)}function ri(o,u,m,y){if(50<hu)throw hu=0,ix=null,Error(r(185));Mc(o,m,y),((Dt&2)===0||o!==Qr)&&(o===Qr&&((Dt&2)===0&&(Sf|=m),Ur===4&&Fs(o,an)),ta(o,y),m===1&&Dt===0&&(u.mode&1)===0&&(Ol=ze()+500,tf&&As()))}function ta(o,u){var m=o.callbackNode;eD(o,u);var y=Fd(o,o===Qr?an:0);if(y===0)m!==null&&Qe(m),o.callbackNode=null,o.callbackPriority=0;else if(u=y&-y,o.callbackPriority!==u){if(m!=null&&Qe(m),u===1)o.tag===0?JD($_.bind(null,o)):E2($_.bind(null,o)),XD(function(){(Dt&6)===0&&As()}),m=null;else{switch(Ob(y)){case 1:m=Vt;break;case 4:m=Qt;break;case 16:m=Sr;break;case 536870912:m=ys;break;default:m=Sr}m=Y_(m,B_.bind(null,o))}o.callbackPriority=u,o.callbackNode=m}}function B_(o,u){if(Cf=-1,kf=0,(Dt&6)!==0)throw Error(r(327));var m=o.callbackNode;if(Dl()&&o.callbackNode!==m)return null;var y=Fd(o,o===Qr?an:0);if(y===0)return null;if((y&30)!==0||(y&o.expiredLanes)!==0||u)u=Af(o,y);else{u=y;var N=Dt;Dt|=2;var C=z_();(Qr!==o||an!==u)&&(Wi=null,Ol=ze()+500,Eo(o,u));do try{wR();break}catch(ae){U_(o,ae)}while(!0);Sm(),_f.current=C,Dt=N,Pr!==null?u=0:(Qr=null,an=0,u=Ur)}if(u!==0){if(u===2&&(N=Bp(o),N!==0&&(y=N,u=sx(o,N))),u===1)throw m=du,Eo(o,0),Fs(o,y),ta(o,ze()),m;if(u===6)Fs(o,y);else{if(N=o.current.alternate,(y&30)===0&&!vR(N)&&(u=Af(o,y),u===2&&(C=Bp(o),C!==0&&(y=C,u=sx(o,C))),u===1))throw m=du,Eo(o,0),Fs(o,y),ta(o,ze()),m;switch(o.finishedWork=N,o.finishedLanes=y,u){case 0:case 1:throw Error(r(345));case 2:To(o,ea,Wi);break;case 3:if(Fs(o,y),(y&130023424)===y&&(u=nx+500-ze(),10<u)){if(Fd(o,0)!==0)break;if(N=o.suspendedLanes,(N&y)!==y){Rn(),o.pingedLanes|=o.suspendedLanes&N;break}o.timeoutHandle=fm(To.bind(null,o,ea,Wi),u);break}To(o,ea,Wi);break;case 4:if(Fs(o,y),(y&4194240)===y)break;for(u=o.eventTimes,N=-1;0<y;){var R=31-Nr(y);C=1<<R,R=u[R],R>N&&(N=R),y&=~C}if(y=N,y=ze()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*gR(y/1960))-y,10<y){o.timeoutHandle=fm(To.bind(null,o,ea,Wi),y);break}To(o,ea,Wi);break;case 5:To(o,ea,Wi);break;default:throw Error(r(329))}}}return ta(o,ze()),o.callbackNode===m?B_.bind(null,o):null}function sx(o,u){var m=fu;return o.current.memoizedState.isDehydrated&&(Eo(o,u).flags|=256),o=Af(o,u),o!==2&&(u=ea,ea=m,u!==null&&ox(u)),o}function ox(o){ea===null?ea=o:ea.push.apply(ea,o)}function vR(o){for(var u=o;;){if(u.flags&16384){var m=u.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var y=0;y<m.length;y++){var N=m[y],C=N.getSnapshot;N=N.value;try{if(!Qa(C(),N))return!1}catch{return!1}}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Fs(o,u){for(u&=~rx,u&=~Sf,o.suspendedLanes|=u,o.pingedLanes&=~u,o=o.expirationTimes;0<u;){var m=31-Nr(u),y=1<<m;o[m]=-1,u&=~y}}function $_(o){if((Dt&6)!==0)throw Error(r(327));Dl();var u=Fd(o,0);if((u&1)===0)return ta(o,ze()),null;var m=Af(o,u);if(o.tag!==0&&m===2){var y=Bp(o);y!==0&&(u=y,m=sx(o,y))}if(m===1)throw m=du,Eo(o,0),Fs(o,u),ta(o,ze()),m;if(m===6)throw Error(r(345));return o.finishedWork=o.current.alternate,o.finishedLanes=u,To(o,ea,Wi),ta(o,ze()),null}function lx(o,u){var m=Dt;Dt|=1;try{return o(u)}finally{Dt=m,Dt===0&&(Ol=ze()+500,tf&&As())}}function No(o){Rs!==null&&Rs.tag===0&&(Dt&6)===0&&Dl();var u=Dt;Dt|=1;var m=Ra.transition,y=Ut;try{if(Ra.transition=null,Ut=1,o)return o()}finally{Ut=y,Ra.transition=m,Dt=u,(Dt&6)===0&&As()}}function cx(){pa=jl.current,rr(jl)}function Eo(o,u){o.finishedWork=null,o.finishedLanes=0;var m=o.timeoutHandle;if(m!==-1&&(o.timeoutHandle=-1,YD(m)),Pr!==null)for(m=Pr.return;m!==null;){var y=m;switch(vm(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Jd();break;case 3:kl(),rr(Qn),rr(gn),jm();break;case 5:Am(y);break;case 4:kl();break;case 13:rr(xr);break;case 19:rr(xr);break;case 10:Nm(y.type._context);break;case 22:case 23:cx()}m=m.return}if(Qr=o,Pr=o=Ms(o.current,null),an=pa=u,Ur=0,du=null,rx=Sf=So=0,ea=fu=null,wo!==null){for(u=0;u<wo.length;u++)if(m=wo[u],y=m.interleaved,y!==null){m.interleaved=null;var N=y.next,C=m.pending;if(C!==null){var R=C.next;C.next=N,y.next=R}m.pending=y}wo=null}return o}function U_(o,u){do{var m=Pr;try{if(Sm(),ff.current=xf,hf){for(var y=gr.memoizedState;y!==null;){var N=y.queue;N!==null&&(N.pending=null),y=y.next}hf=!1}if(_o=0,qr=$r=gr=null,iu=!1,su=0,tx.current=null,m===null||m.return===null){Ur=1,du=u,Pr=null;break}e:{var C=o,R=m.return,ae=m,de=u;if(u=an,ae.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var je=de,He=ae,Ve=He.tag;if((He.mode&1)===0&&(Ve===0||Ve===11||Ve===15)){var We=He.alternate;We?(He.updateQueue=We.updateQueue,He.memoizedState=We.memoizedState,He.lanes=We.lanes):(He.updateQueue=null,He.memoizedState=null)}var rt=f_(R);if(rt!==null){rt.flags&=-257,h_(rt,R,ae,C,u),rt.mode&1&&d_(C,je,u),u=rt,de=je;var lt=u.updateQueue;if(lt===null){var ct=new Set;ct.add(de),u.updateQueue=ct}else lt.add(de);break e}else{if((u&1)===0){d_(C,je,u),ux();break e}de=Error(r(426))}}else if(sr&&ae.mode&1){var Er=f_(R);if(Er!==null){(Er.flags&65536)===0&&(Er.flags|=256),h_(Er,R,ae,C,u),bm(Al(de,ae));break e}}C=de=Al(de,ae),Ur!==4&&(Ur=2),fu===null?fu=[C]:fu.push(C),C=R;do{switch(C.tag){case 3:C.flags|=65536,u&=-u,C.lanes|=u;var ge=c_(C,de,u);F2(C,ge);break e;case 1:ae=de;var he=C.type,Te=C.stateNode;if((C.flags&128)===0&&(typeof he.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(Ds===null||!Ds.has(Te)))){C.flags|=65536,u&=-u,C.lanes|=u;var qe=u_(C,ae,u);F2(C,qe);break e}}C=C.return}while(C!==null)}H_(m)}catch(dt){u=dt,Pr===m&&m!==null&&(Pr=m=m.return);continue}break}while(!0)}function z_(){var o=_f.current;return _f.current=xf,o===null?xf:o}function ux(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Qr===null||(So&268435455)===0&&(Sf&268435455)===0||Fs(Qr,an)}function Af(o,u){var m=Dt;Dt|=2;var y=z_();(Qr!==o||an!==u)&&(Wi=null,Eo(o,u));do try{yR();break}catch(N){U_(o,N)}while(!0);if(Sm(),Dt=m,_f.current=y,Pr!==null)throw Error(r(261));return Qr=null,an=0,Ur}function yR(){for(;Pr!==null;)W_(Pr)}function wR(){for(;Pr!==null&&!nt();)W_(Pr)}function W_(o){var u=G_(o.alternate,o,pa);o.memoizedProps=o.pendingProps,u===null?H_(o):Pr=u,tx.current=null}function H_(o){var u=o;do{var m=u.alternate;if(o=u.return,(u.flags&32768)===0){if(m=fR(m,u,pa),m!==null){Pr=m;return}}else{if(m=hR(m,u),m!==null){m.flags&=32767,Pr=m;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Ur=6,Pr=null;return}}if(u=u.sibling,u!==null){Pr=u;return}Pr=u=o}while(u!==null);Ur===0&&(Ur=5)}function To(o,u,m){var y=Ut,N=Ra.transition;try{Ra.transition=null,Ut=1,bR(o,u,m,y)}finally{Ra.transition=N,Ut=y}return null}function bR(o,u,m,y){do Dl();while(Rs!==null);if((Dt&6)!==0)throw Error(r(327));m=o.finishedWork;var N=o.finishedLanes;if(m===null)return null;if(o.finishedWork=null,o.finishedLanes=0,m===o.current)throw Error(r(177));o.callbackNode=null,o.callbackPriority=0;var C=m.lanes|m.childLanes;if(tD(o,C),o===Qr&&(Pr=Qr=null,an=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||Ef||(Ef=!0,Y_(Sr,function(){return Dl(),null})),C=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||C){C=Ra.transition,Ra.transition=null;var R=Ut;Ut=1;var ae=Dt;Dt|=4,tx.current=null,mR(o,m),R_(m,o),UD(um),Bd=!!cm,um=cm=null,o.current=m,xR(m),Ge(),Dt=ae,Ut=R,Ra.transition=C}else o.current=m;if(Ef&&(Ef=!1,Rs=o,Tf=N),C=o.pendingLanes,C===0&&(Ds=null),Ic(m.stateNode),ta(o,ze()),u!==null)for(y=o.onRecoverableError,m=0;m<u.length;m++)N=u[m],y(N.value,{componentStack:N.stack,digest:N.digest});if(Nf)throw Nf=!1,o=ax,ax=null,o;return(Tf&1)!==0&&o.tag!==0&&Dl(),C=o.pendingLanes,(C&1)!==0?o===ix?hu++:(hu=0,ix=o):hu=0,As(),null}function Dl(){if(Rs!==null){var o=Ob(Tf),u=Ra.transition,m=Ut;try{if(Ra.transition=null,Ut=16>o?16:o,Rs===null)var y=!1;else{if(o=Rs,Rs=null,Tf=0,(Dt&6)!==0)throw Error(r(331));var N=Dt;for(Dt|=4,it=o.current;it!==null;){var C=it,R=C.child;if((it.flags&16)!==0){var ae=C.deletions;if(ae!==null){for(var de=0;de<ae.length;de++){var je=ae[de];for(it=je;it!==null;){var He=it;switch(He.tag){case 0:case 11:case 15:uu(8,He,C)}var Ve=He.child;if(Ve!==null)Ve.return=He,it=Ve;else for(;it!==null;){He=it;var We=He.sibling,rt=He.return;if(A_(He),He===je){it=null;break}if(We!==null){We.return=rt,it=We;break}it=rt}}}var lt=C.alternate;if(lt!==null){var ct=lt.child;if(ct!==null){lt.child=null;do{var Er=ct.sibling;ct.sibling=null,ct=Er}while(ct!==null)}}it=C}}if((C.subtreeFlags&2064)!==0&&R!==null)R.return=C,it=R;else e:for(;it!==null;){if(C=it,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:uu(9,C,C.return)}var ge=C.sibling;if(ge!==null){ge.return=C.return,it=ge;break e}it=C.return}}var he=o.current;for(it=he;it!==null;){R=it;var Te=R.child;if((R.subtreeFlags&2064)!==0&&Te!==null)Te.return=R,it=Te;else e:for(R=he;it!==null;){if(ae=it,(ae.flags&2048)!==0)try{switch(ae.tag){case 0:case 11:case 15:bf(9,ae)}}catch(dt){wr(ae,ae.return,dt)}if(ae===R){it=null;break e}var qe=ae.sibling;if(qe!==null){qe.return=ae.return,it=qe;break e}it=ae.return}}if(Dt=N,As(),Xr&&typeof Xr.onPostCommitFiberRoot=="function")try{Xr.onPostCommitFiberRoot(di,o)}catch{}y=!0}return y}finally{Ut=m,Ra.transition=u}}return!1}function K_(o,u,m){u=Al(m,u),u=c_(o,u,1),o=js(o,u,1),u=Rn(),o!==null&&(Mc(o,1,u),ta(o,u))}function wr(o,u,m){if(o.tag===3)K_(o,o,m);else for(;u!==null;){if(u.tag===3){K_(u,o,m);break}else if(u.tag===1){var y=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Ds===null||!Ds.has(y))){o=Al(m,o),o=u_(u,o,1),u=js(u,o,1),o=Rn(),u!==null&&(Mc(u,1,o),ta(u,o));break}}u=u.return}}function _R(o,u,m){var y=o.pingCache;y!==null&&y.delete(u),u=Rn(),o.pingedLanes|=o.suspendedLanes&m,Qr===o&&(an&m)===m&&(Ur===4||Ur===3&&(an&130023424)===an&&500>ze()-nx?Eo(o,0):rx|=m),ta(o,u)}function V_(o,u){u===0&&((o.mode&1)===0?u=1:(u=Id,Id<<=1,(Id&130023424)===0&&(Id=4194304)));var m=Rn();o=$i(o,u),o!==null&&(Mc(o,u,m),ta(o,m))}function SR(o){var u=o.memoizedState,m=0;u!==null&&(m=u.retryLane),V_(o,m)}function NR(o,u){var m=0;switch(o.tag){case 13:var y=o.stateNode,N=o.memoizedState;N!==null&&(m=N.retryLane);break;case 19:y=o.stateNode;break;default:throw Error(r(314))}y!==null&&y.delete(u),V_(o,m)}var G_;G_=function(o,u,m){if(o!==null)if(o.memoizedProps!==u.pendingProps||Qn.current)Jn=!0;else{if((o.lanes&m)===0&&(u.flags&128)===0)return Jn=!1,dR(o,u,m);Jn=(o.flags&131072)!==0}else Jn=!1,sr&&(u.flags&1048576)!==0&&T2(u,nf,u.index);switch(u.lanes=0,u.tag){case 2:var y=u.type;yf(o,u),o=u.pendingProps;var N=bl(u,gn.current);Cl(u,m),N=Rm(null,u,y,o,N,m);var C=Im();return u.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Zn(y)?(C=!0,ef(u)):C=!1,u.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,Cm(u),N.updater=gf,u.stateNode=N,N._reactInternals=u,Um(u,y,o,m),u=Km(null,u,y,!0,C,m)):(u.tag=0,sr&&C&&gm(u),Dn(null,u,N,m),u=u.child),u;case 16:y=u.elementType;e:{switch(yf(o,u),o=u.pendingProps,N=y._init,y=N(y._payload),u.type=y,N=u.tag=TR(y),o=Ja(y,o),N){case 0:u=Hm(null,u,y,o,m);break e;case 1:u=y_(null,u,y,o,m);break e;case 11:u=p_(null,u,y,o,m);break e;case 14:u=m_(null,u,y,Ja(y.type,o),m);break e}throw Error(r(306,y,""))}return u;case 0:return y=u.type,N=u.pendingProps,N=u.elementType===y?N:Ja(y,N),Hm(o,u,y,N,m);case 1:return y=u.type,N=u.pendingProps,N=u.elementType===y?N:Ja(y,N),y_(o,u,y,N,m);case 3:e:{if(w_(u),o===null)throw Error(r(387));y=u.pendingProps,C=u.memoizedState,N=C.element,I2(o,u),uf(u,y,null,m);var R=u.memoizedState;if(y=R.element,C.isDehydrated)if(C={element:y,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},u.updateQueue.baseState=C,u.memoizedState=C,u.flags&256){N=Al(Error(r(423)),u),u=b_(o,u,y,m,N);break e}else if(y!==N){N=Al(Error(r(424)),u),u=b_(o,u,y,m,N);break e}else for(ha=Ts(u.stateNode.containerInfo.firstChild),fa=u,sr=!0,Za=null,m=D2(u,null,y,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Nl(),y===N){u=zi(o,u,m);break e}Dn(o,u,y,m)}u=u.child}return u;case 5:return L2(u),o===null&&wm(u),y=u.type,N=u.pendingProps,C=o!==null?o.memoizedProps:null,R=N.children,dm(y,N)?R=null:C!==null&&dm(y,C)&&(u.flags|=32),v_(o,u),Dn(o,u,R,m),u.child;case 6:return o===null&&wm(u),null;case 13:return __(o,u,m);case 4:return km(u,u.stateNode.containerInfo),y=u.pendingProps,o===null?u.child=El(u,null,y,m):Dn(o,u,y,m),u.child;case 11:return y=u.type,N=u.pendingProps,N=u.elementType===y?N:Ja(y,N),p_(o,u,y,N,m);case 7:return Dn(o,u,u.pendingProps,m),u.child;case 8:return Dn(o,u,u.pendingProps.children,m),u.child;case 12:return Dn(o,u,u.pendingProps.children,m),u.child;case 10:e:{if(y=u.type._context,N=u.pendingProps,C=u.memoizedProps,R=N.value,Zt(of,y._currentValue),y._currentValue=R,C!==null)if(Qa(C.value,R)){if(C.children===N.children&&!Qn.current){u=zi(o,u,m);break e}}else for(C=u.child,C!==null&&(C.return=u);C!==null;){var ae=C.dependencies;if(ae!==null){R=C.child;for(var de=ae.firstContext;de!==null;){if(de.context===y){if(C.tag===1){de=Ui(-1,m&-m),de.tag=2;var je=C.updateQueue;if(je!==null){je=je.shared;var He=je.pending;He===null?de.next=de:(de.next=He.next,He.next=de),je.pending=de}}C.lanes|=m,de=C.alternate,de!==null&&(de.lanes|=m),Em(C.return,m,u),ae.lanes|=m;break}de=de.next}}else if(C.tag===10)R=C.type===u.type?null:C.child;else if(C.tag===18){if(R=C.return,R===null)throw Error(r(341));R.lanes|=m,ae=R.alternate,ae!==null&&(ae.lanes|=m),Em(R,m,u),R=C.sibling}else R=C.child;if(R!==null)R.return=C;else for(R=C;R!==null;){if(R===u){R=null;break}if(C=R.sibling,C!==null){C.return=R.return,R=C;break}R=R.return}C=R}Dn(o,u,N.children,m),u=u.child}return u;case 9:return N=u.type,y=u.pendingProps.children,Cl(u,m),N=Oa(N),y=y(N),u.flags|=1,Dn(o,u,y,m),u.child;case 14:return y=u.type,N=Ja(y,u.pendingProps),N=Ja(y.type,N),m_(o,u,y,N,m);case 15:return x_(o,u,u.type,u.pendingProps,m);case 17:return y=u.type,N=u.pendingProps,N=u.elementType===y?N:Ja(y,N),yf(o,u),u.tag=1,Zn(y)?(o=!0,ef(u)):o=!1,Cl(u,m),o_(u,y,N),Um(u,y,N,m),Km(null,u,y,!0,o,m);case 19:return N_(o,u,m);case 22:return g_(o,u,m)}throw Error(r(156,u.tag))};function Y_(o,u){return Ke(o,u)}function ER(o,u,m,y){this.tag=o,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ia(o,u,m,y){return new ER(o,u,m,y)}function dx(o){return o=o.prototype,!(!o||!o.isReactComponent)}function TR(o){if(typeof o=="function")return dx(o)?1:0;if(o!=null){if(o=o.$$typeof,o===M)return 11;if(o===ee)return 14}return 2}function Ms(o,u){var m=o.alternate;return m===null?(m=Ia(o.tag,u,o.key,o.mode),m.elementType=o.elementType,m.type=o.type,m.stateNode=o.stateNode,m.alternate=o,o.alternate=m):(m.pendingProps=u,m.type=o.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=o.flags&14680064,m.childLanes=o.childLanes,m.lanes=o.lanes,m.child=o.child,m.memoizedProps=o.memoizedProps,m.memoizedState=o.memoizedState,m.updateQueue=o.updateQueue,u=o.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=o.sibling,m.index=o.index,m.ref=o.ref,m}function Pf(o,u,m,y,N,C){var R=2;if(y=o,typeof o=="function")dx(o)&&(R=1);else if(typeof o=="string")R=5;else e:switch(o){case P:return Co(m.children,N,C,u);case D:R=8,N|=8;break;case L:return o=Ia(12,m,u,N|2),o.elementType=L,o.lanes=C,o;case re:return o=Ia(13,m,u,N),o.elementType=re,o.lanes=C,o;case oe:return o=Ia(19,m,u,N),o.elementType=oe,o.lanes=C,o;case J:return jf(m,N,C,u);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case I:R=10;break e;case O:R=9;break e;case M:R=11;break e;case ee:R=14;break e;case fe:R=16,y=null;break e}throw Error(r(130,o==null?o:typeof o,""))}return u=Ia(R,m,u,N),u.elementType=o,u.type=y,u.lanes=C,u}function Co(o,u,m,y){return o=Ia(7,o,y,u),o.lanes=m,o}function jf(o,u,m,y){return o=Ia(22,o,y,u),o.elementType=J,o.lanes=m,o.stateNode={isHidden:!1},o}function fx(o,u,m){return o=Ia(6,o,null,u),o.lanes=m,o}function hx(o,u,m){return u=Ia(4,o.children!==null?o.children:[],o.key,u),u.lanes=m,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}function CR(o,u,m,y,N){this.tag=u,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$p(0),this.expirationTimes=$p(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$p(0),this.identifierPrefix=y,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function px(o,u,m,y,N,C,R,ae,de){return o=new CR(o,u,m,ae,de),u===1?(u=1,C===!0&&(u|=8)):u=0,C=Ia(3,null,null,u),o.current=C,C.stateNode=o,C.memoizedState={element:y,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cm(C),o}function kR(o,u,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:y==null?null:""+y,children:o,containerInfo:u,implementation:m}}function X_(o){if(!o)return ks;o=o._reactInternals;e:{if(Z(o)!==o||o.tag!==1)throw Error(r(170));var u=o;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Zn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(r(171))}if(o.tag===1){var m=o.type;if(Zn(m))return S2(o,m,u)}return u}function q_(o,u,m,y,N,C,R,ae,de){return o=px(m,y,!0,o,N,C,R,ae,de),o.context=X_(null),m=o.current,y=Rn(),N=Is(m),C=Ui(y,N),C.callback=u??null,js(m,C,N),o.current.lanes=N,Mc(o,N,y),ta(o,y),o}function Of(o,u,m,y){var N=u.current,C=Rn(),R=Is(N);return m=X_(m),u.context===null?u.context=m:u.pendingContext=m,u=Ui(C,R),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=js(N,u,R),o!==null&&(ri(o,N,R,C),cf(o,N,R)),R}function Df(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Q_(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var m=o.retryLane;o.retryLane=m!==0&&m<u?m:u}}function mx(o,u){Q_(o,u),(o=o.alternate)&&Q_(o,u)}function AR(){return null}var Z_=typeof reportError=="function"?reportError:function(o){console.error(o)};function xx(o){this._internalRoot=o}Rf.prototype.render=xx.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(r(409));Of(o,u,null,null)},Rf.prototype.unmount=xx.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;No(function(){Of(null,o,null,null)}),u[Fi]=null}};function Rf(o){this._internalRoot=o}Rf.prototype.unstable_scheduleHydration=function(o){if(o){var u=Ib();o={blockedOn:null,target:o,priority:u};for(var m=0;m<Ss.length&&u!==0&&u<Ss[m].priority;m++);Ss.splice(m,0,o),m===0&&Lb(o)}};function gx(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function If(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function J_(){}function PR(o,u,m,y,N){if(N){if(typeof y=="function"){var C=y;y=function(){var je=Df(R);C.call(je)}}var R=q_(u,y,o,0,null,!1,!1,"",J_);return o._reactRootContainer=R,o[Fi]=R.current,Qc(o.nodeType===8?o.parentNode:o),No(),R}for(;N=o.lastChild;)o.removeChild(N);if(typeof y=="function"){var ae=y;y=function(){var je=Df(de);ae.call(je)}}var de=px(o,0,!1,null,null,!1,!1,"",J_);return o._reactRootContainer=de,o[Fi]=de.current,Qc(o.nodeType===8?o.parentNode:o),No(function(){Of(u,de,m,y)}),de}function Ff(o,u,m,y,N){var C=m._reactRootContainer;if(C){var R=C;if(typeof N=="function"){var ae=N;N=function(){var de=Df(R);ae.call(de)}}Of(u,R,o,N)}else R=PR(m,u,o,N,y);return Df(R)}Db=function(o){switch(o.tag){case 3:var u=o.stateNode;if(u.current.memoizedState.isDehydrated){var m=Fc(u.pendingLanes);m!==0&&(Up(u,m|1),ta(u,ze()),(Dt&6)===0&&(Ol=ze()+500,As()))}break;case 13:No(function(){var y=$i(o,1);if(y!==null){var N=Rn();ri(y,o,1,N)}}),mx(o,1)}},zp=function(o){if(o.tag===13){var u=$i(o,134217728);if(u!==null){var m=Rn();ri(u,o,134217728,m)}mx(o,134217728)}},Rb=function(o){if(o.tag===13){var u=Is(o),m=$i(o,u);if(m!==null){var y=Rn();ri(m,o,u,y)}mx(o,u)}},Ib=function(){return Ut},Fb=function(o,u){var m=Ut;try{return Ut=o,u()}finally{Ut=m}},bt=function(o,u,m){switch(u){case"input":if(Ee(o,m),u=m.name,m.type==="radio"&&u!=null){for(m=o;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<m.length;u++){var y=m[u];if(y!==o&&y.form===o.form){var N=Zd(y);if(!N)throw Error(r(90));ne(y),Ee(y,N)}}}break;case"textarea":Le(o,m);break;case"select":u=m.value,u!=null&&Ce(o,!!m.multiple,u,!1)}},Aa=lx,Gn=No;var jR={usingClientEntryPoint:!1,Events:[eu,yl,Zd,Ar,xn,lx]},pu={findFiberByHostInstance:xo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},OR={bundleType:pu.bundleType,version:pu.version,rendererPackageName:pu.rendererPackageName,rendererConfig:pu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Se(o),o===null?null:o.stateNode},findFiberByHostInstance:pu.findFiberByHostInstance||AR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mf.isDisabled&&Mf.supportsFiber)try{di=Mf.inject(OR),Xr=Mf}catch{}}return ra.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jR,ra.createPortal=function(o,u){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gx(u))throw Error(r(200));return kR(o,u,null,m)},ra.createRoot=function(o,u){if(!gx(o))throw Error(r(299));var m=!1,y="",N=Z_;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onRecoverableError!==void 0&&(N=u.onRecoverableError)),u=px(o,1,!1,null,null,m,!1,y,N),o[Fi]=u.current,Qc(o.nodeType===8?o.parentNode:o),new xx(u)},ra.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=Se(u),o=o===null?null:o.stateNode,o},ra.flushSync=function(o){return No(o)},ra.hydrate=function(o,u,m){if(!If(u))throw Error(r(200));return Ff(null,o,u,!0,m)},ra.hydrateRoot=function(o,u,m){if(!gx(o))throw Error(r(405));var y=m!=null&&m.hydratedSources||null,N=!1,C="",R=Z_;if(m!=null&&(m.unstable_strictMode===!0&&(N=!0),m.identifierPrefix!==void 0&&(C=m.identifierPrefix),m.onRecoverableError!==void 0&&(R=m.onRecoverableError)),u=q_(u,null,o,1,m??null,N,!1,C,R),o[Fi]=u.current,Qc(o),y)for(o=0;o<y.length;o++)m=y[o],N=m._getVersion,N=N(m._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[m,N]:u.mutableSourceEagerHydrationData.push(m,N);return new Rf(u)},ra.render=function(o,u,m){if(!If(u))throw Error(r(200));return Ff(null,o,u,!1,m)},ra.unmountComponentAtNode=function(o){if(!If(o))throw Error(r(40));return o._reactRootContainer?(No(function(){Ff(null,null,o,!1,function(){o._reactRootContainer=null,o[Fi]=null})}),!0):!1},ra.unstable_batchedUpdates=lx,ra.unstable_renderSubtreeIntoContainer=function(o,u,m,y){if(!If(m))throw Error(r(200));if(o==null||o._reactInternals===void 0)throw Error(r(38));return Ff(o,u,m,!1,y)},ra.version="18.3.1-next-f1338f8080-20240426",ra}var oS;function Kk(){if(oS)return wx.exports;oS=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),wx.exports=$R(),wx.exports}var lS;function UR(){if(lS)return Lf;lS=1;var e=Kk();return Lf.createRoot=e.createRoot,Lf.hydrateRoot=e.hydrateRoot,Lf}var zR=UR(),v=mc();const ki=fs(v),Vk=RR({__proto__:null,default:ki},[v]);var WR=Kk();function $u(){return $u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$u.apply(this,arguments)}var Ks;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ks||(Ks={}));const cS="popstate";function HR(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return Fv("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:E0(a)}return VR(t,r,null,e)}function kr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Gk(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function KR(){return Math.random().toString(36).substr(2,8)}function uS(e,t){return{usr:e.state,key:e.key,idx:t}}function Fv(e,t,r,n){return r===void 0&&(r=null),$u({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?xc(t):t,{state:r,key:t&&t.key||n||KR()})}function E0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function VR(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l=Ks.Pop,d=null,h=f();h==null&&(h=0,s.replaceState($u({},s.state,{idx:h}),""));function f(){return(s.state||{idx:null}).idx}function p(){l=Ks.Pop;let w=f(),S=w==null?null:w-h;h=w,d&&d({action:l,location:_.location,delta:S})}function x(w,S){l=Ks.Push;let T=Fv(_.location,w,S);h=f()+1;let E=uS(T,h),k=_.createHref(T);try{s.pushState(E,"",k)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(k)}i&&d&&d({action:l,location:_.location,delta:1})}function g(w,S){l=Ks.Replace;let T=Fv(_.location,w,S);h=f();let E=uS(T,h),k=_.createHref(T);s.replaceState(E,"",k),i&&d&&d({action:l,location:_.location,delta:0})}function b(w){let S=a.location.origin!=="null"?a.location.origin:a.location.href,T=typeof w=="string"?w:E0(w);return T=T.replace(/ $/,"%20"),kr(S,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,S)}let _={get action(){return l},get location(){return e(a,s)},listen(w){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(cS,p),d=w,()=>{a.removeEventListener(cS,p),d=null}},createHref(w){return t(a,w)},createURL:b,encodeLocation(w){let S=b(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:x,replace:g,go(w){return s.go(w)}};return _}var dS;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(dS||(dS={}));function GR(e,t,r){return r===void 0&&(r="/"),YR(e,t,r)}function YR(e,t,r,n){let a=typeof t=="string"?xc(t):t,i=ey(a.pathname||"/",r);if(i==null)return null;let s=Yk(e);XR(s);let l=null;for(let d=0;l==null&&d<s.length;++d){let h=oI(i);l=aI(s[d],h)}return l}function Yk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,l)=>{let d={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};d.relativePath.startsWith("/")&&(kr(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let h=Gs([n,d.relativePath]),f=r.concat(d);i.children&&i.children.length>0&&(kr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Yk(i.children,t,f,h)),!(i.path==null&&!i.index)&&t.push({path:h,score:rI(h,i.index),routesMeta:f})};return e.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let d of Xk(i.path))a(i,s,d)}),t}function Xk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=Xk(n.join("/")),l=[];return l.push(...s.map(d=>d===""?i:[i,d].join("/"))),a&&l.push(...s),l.map(d=>e.startsWith("/")&&d===""?"/":d)}function XR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nI(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const qR=/^:[\w-]+$/,QR=3,ZR=2,JR=1,eI=10,tI=-2,fS=e=>e==="*";function rI(e,t){let r=e.split("/"),n=r.length;return r.some(fS)&&(n+=tI),t&&(n+=ZR),r.filter(a=>!fS(a)).reduce((a,i)=>a+(qR.test(i)?QR:i===""?JR:eI),n)}function nI(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function aI(e,t,r){let{routesMeta:n}=e,a={},i="/",s=[];for(let l=0;l<n.length;++l){let d=n[l],h=l===n.length-1,f=i==="/"?t:t.slice(i.length)||"/",p=iI({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},f),x=d.route;if(!p)return null;Object.assign(a,p.params),s.push({params:a,pathname:Gs([i,p.pathname]),pathnameBase:dI(Gs([i,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(i=Gs([i,p.pathnameBase]))}return s}function iI(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=sI(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((h,f,p)=>{let{paramName:x,isOptional:g}=f;if(x==="*"){let _=l[p]||"";s=i.slice(0,i.length-_.length).replace(/(.)\/+$/,"$1")}const b=l[p];return g&&!b?h[x]=void 0:h[x]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:s,pattern:e}}function sI(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Gk(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,d)=>(n.push({paramName:l,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function oI(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Gk(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ey(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function lI(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?xc(e):e;return{pathname:r?r.startsWith("/")?r:cI(r,t):t,search:fI(n),hash:hI(a)}}function cI(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Sx(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uI(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ty(e,t){let r=uI(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ry(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=xc(e):(a=$u({},e),kr(!a.pathname||!a.pathname.includes("?"),Sx("?","pathname","search",a)),kr(!a.pathname||!a.pathname.includes("#"),Sx("#","pathname","hash",a)),kr(!a.search||!a.search.includes("#"),Sx("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=r;else{let p=t.length-1;if(!n&&s.startsWith("..")){let x=s.split("/");for(;x[0]==="..";)x.shift(),p-=1;a.pathname=x.join("/")}l=p>=0?t[p]:"/"}let d=lI(a,l),h=s&&s!=="/"&&s.endsWith("/"),f=(i||s===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(h||f)&&(d.pathname+="/"),d}const Gs=e=>e.join("/").replace(/\/\/+/g,"/"),dI=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fI=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hI=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function pI(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const qk=["post","put","patch","delete"];new Set(qk);const mI=["get",...qk];new Set(mI);function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uu.apply(this,arguments)}const ny=v.createContext(null),xI=v.createContext(null),io=v.createContext(null),Lh=v.createContext(null),so=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Qk=v.createContext(null);function gI(e,t){let{relative:r}=t===void 0?{}:t;gc()||kr(!1);let{basename:n,navigator:a}=v.useContext(io),{hash:i,pathname:s,search:l}=Jk(e,{relative:r}),d=s;return n!=="/"&&(d=s==="/"?n:Gs([n,s])),a.createHref({pathname:d,search:l,hash:i})}function gc(){return v.useContext(Lh)!=null}function oo(){return gc()||kr(!1),v.useContext(Lh).location}function Zk(e){v.useContext(io).static||v.useLayoutEffect(e)}function Bh(){let{isDataRoute:e}=v.useContext(so);return e?PI():vI()}function vI(){gc()||kr(!1);let e=v.useContext(ny),{basename:t,future:r,navigator:n}=v.useContext(io),{matches:a}=v.useContext(so),{pathname:i}=oo(),s=JSON.stringify(ty(a,r.v7_relativeSplatPath)),l=v.useRef(!1);return Zk(()=>{l.current=!0}),v.useCallback(function(h,f){if(f===void 0&&(f={}),!l.current)return;if(typeof h=="number"){n.go(h);return}let p=ry(h,JSON.parse(s),i,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Gs([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,s,i,e])}function Jk(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=v.useContext(io),{matches:a}=v.useContext(so),{pathname:i}=oo(),s=JSON.stringify(ty(a,n.v7_relativeSplatPath));return v.useMemo(()=>ry(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function yI(e,t){return wI(e,t)}function wI(e,t,r,n){gc()||kr(!1);let{navigator:a}=v.useContext(io),{matches:i}=v.useContext(so),s=i[i.length-1],l=s?s.params:{};s&&s.pathname;let d=s?s.pathnameBase:"/";s&&s.route;let h=oo(),f;if(t){var p;let w=typeof t=="string"?xc(t):t;d==="/"||(p=w.pathname)!=null&&p.startsWith(d)||kr(!1),f=w}else f=h;let x=f.pathname||"/",g=x;if(d!=="/"){let w=d.replace(/^\//,"").split("/");g="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let b=GR(e,{pathname:g}),_=EI(b&&b.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Gs([d,a.encodeLocation?a.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:Gs([d,a.encodeLocation?a.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,n);return t&&_?v.createElement(Lh.Provider,{value:{location:Uu({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Ks.Pop}},_):_}function bI(){let e=AI(),t=pI(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),r?v.createElement("pre",{style:a},r):null,null)}const _I=v.createElement(bI,null);class SI extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?v.createElement(so.Provider,{value:this.props.routeContext},v.createElement(Qk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function NI(e){let{routeContext:t,match:r,children:n}=e,a=v.useContext(ny);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),v.createElement(so.Provider,{value:t},n)}function EI(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let f=s.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);f>=0||kr(!1),s=s.slice(0,Math.min(s.length,f+1))}let d=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<s.length;f++){let p=s[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:x,errors:g}=r,b=p.route.loader&&x[p.route.id]===void 0&&(!g||g[p.route.id]===void 0);if(p.route.lazy||b){d=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((f,p,x)=>{let g,b=!1,_=null,w=null;r&&(g=l&&p.route.id?l[p.route.id]:void 0,_=p.route.errorElement||_I,d&&(h<0&&x===0?(jI("route-fallback"),b=!0,w=null):h===x&&(b=!0,w=p.route.hydrateFallbackElement||null)));let S=t.concat(s.slice(0,x+1)),T=()=>{let E;return g?E=_:b?E=w:p.route.Component?E=v.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=f,v.createElement(NI,{match:p,routeContext:{outlet:f,matches:S,isDataRoute:r!=null},children:E})};return r&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?v.createElement(SI,{location:r.location,revalidation:r.revalidation,component:_,error:g,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):T()},null)}var e4=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(e4||{}),t4=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(t4||{});function TI(e){let t=v.useContext(ny);return t||kr(!1),t}function CI(e){let t=v.useContext(xI);return t||kr(!1),t}function kI(e){let t=v.useContext(so);return t||kr(!1),t}function r4(e){let t=kI(),r=t.matches[t.matches.length-1];return r.route.id||kr(!1),r.route.id}function AI(){var e;let t=v.useContext(Qk),r=CI(),n=r4();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function PI(){let{router:e}=TI(e4.UseNavigateStable),t=r4(t4.UseNavigateStable),r=v.useRef(!1);return Zk(()=>{r.current=!0}),v.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Uu({fromRouteId:t},i)))},[e,t])}const hS={};function jI(e,t,r){hS[e]||(hS[e]=!0)}function Mv(e){let{to:t,replace:r,state:n,relative:a}=e;gc()||kr(!1);let{future:i,static:s}=v.useContext(io),{matches:l}=v.useContext(so),{pathname:d}=oo(),h=Bh(),f=ry(t,ty(l,i.v7_relativeSplatPath),d,a==="path"),p=JSON.stringify(f);return v.useEffect(()=>h(JSON.parse(p),{replace:r,state:n,relative:a}),[h,p,a,r,n]),null}function Fn(e){kr(!1)}function OI(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Ks.Pop,navigator:i,static:s=!1,future:l}=e;gc()&&kr(!1);let d=t.replace(/^\/*/,"/"),h=v.useMemo(()=>({basename:d,navigator:i,static:s,future:Uu({v7_relativeSplatPath:!1},l)}),[d,l,i,s]);typeof n=="string"&&(n=xc(n));let{pathname:f="/",search:p="",hash:x="",state:g=null,key:b="default"}=n,_=v.useMemo(()=>{let w=ey(f,d);return w==null?null:{location:{pathname:w,search:p,hash:x,state:g,key:b},navigationType:a}},[d,f,p,x,g,b,a]);return _==null?null:v.createElement(io.Provider,{value:h},v.createElement(Lh.Provider,{children:r,value:_}))}function pS(e){let{children:t,location:r}=e;return yI(Lv(t),r)}new Promise(()=>{});function Lv(e,t){t===void 0&&(t=[]);let r=[];return v.Children.forEach(e,(n,a)=>{if(!v.isValidElement(n))return;let i=[...t,a];if(n.type===v.Fragment){r.push.apply(r,Lv(n.props.children,i));return}n.type!==Fn&&kr(!1),!n.props.index||!n.props.children||kr(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Lv(n.props.children,i)),r.push(s)}),r}function Bv(){return Bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bv.apply(this,arguments)}function DI(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function RI(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function II(e,t){return e.button===0&&(!t||t==="_self")&&!RI(e)}const FI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],MI="6";try{window.__reactRouterVersion=MI}catch{}const LI="startTransition",mS=Vk[LI];function BI(e){let{basename:t,children:r,future:n,window:a}=e,i=v.useRef();i.current==null&&(i.current=HR({window:a,v5Compat:!0}));let s=i.current,[l,d]=v.useState({action:s.action,location:s.location}),{v7_startTransition:h}=n||{},f=v.useCallback(p=>{h&&mS?mS(()=>d(p)):d(p)},[d,h]);return v.useLayoutEffect(()=>s.listen(f),[s,f]),v.createElement(OI,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:s,future:n})}const $I=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",UI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xS=v.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:l,target:d,to:h,preventScrollReset:f,unstable_viewTransition:p}=t,x=DI(t,FI),{basename:g}=v.useContext(io),b,_=!1;if(typeof h=="string"&&UI.test(h)&&(b=h,$I))try{let E=new URL(window.location.href),k=h.startsWith("//")?new URL(E.protocol+h):new URL(h),A=ey(k.pathname,g);k.origin===E.origin&&A!=null?h=A+k.search+k.hash:_=!0}catch{}let w=gI(h,{relative:a}),S=zI(h,{replace:s,state:l,target:d,preventScrollReset:f,relative:a,unstable_viewTransition:p});function T(E){n&&n(E),E.defaultPrevented||S(E)}return v.createElement("a",Bv({},x,{href:b||w,onClick:_||i?n:T,ref:r,target:d}))});var gS;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gS||(gS={}));var vS;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(vS||(vS={}));function zI(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,unstable_viewTransition:l}=t===void 0?{}:t,d=Bh(),h=oo(),f=Jk(e,{relative:s});return v.useCallback(p=>{if(II(p,r)){p.preventDefault();let x=n!==void 0?n:E0(h)===E0(f);d(e,{replace:x,state:a,preventScrollReset:i,relative:s,unstable_viewTransition:l})}},[h,d,f,n,a,r,e,i,s,l])}function WI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const ay=v.forwardRef(WI);function HI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const KI=v.forwardRef(HI);function VI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const iy=v.forwardRef(VI);function GI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const YI=v.forwardRef(GI);function XI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"}))}const qI=v.forwardRef(XI);function QI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"}))}const T0=v.forwardRef(QI);function ZI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const sy=v.forwardRef(ZI);function JI({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const e6=v.forwardRef(JI);function t6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"}))}const r6=v.forwardRef(t6);function n6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const a6=v.forwardRef(n6);function i6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const n4=v.forwardRef(i6);function s6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const a4=v.forwardRef(s6);function o6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const l6=v.forwardRef(o6);function c6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const nc=v.forwardRef(c6);function u6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Wo=v.forwardRef(u6);function d6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const i4=v.forwardRef(d6);function f6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"}))}const h6=v.forwardRef(f6);function p6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const oy=v.forwardRef(p6);function m6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const x6=v.forwardRef(m6);function g6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Nx=v.forwardRef(g6);function v6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const y6=v.forwardRef(v6);function w6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const ly=v.forwardRef(w6);function b6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ud=v.forwardRef(b6);function _6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const S6=v.forwardRef(_6);function N6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const E6=v.forwardRef(N6);function T6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const il=v.forwardRef(T6);function C6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const s4=v.forwardRef(C6);function k6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const A6=v.forwardRef(k6);function P6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const $h=v.forwardRef(P6);function j6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const ac=v.forwardRef(j6);function O6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const cy=v.forwardRef(O6);function D6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Ai=v.forwardRef(D6);function R6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"}))}const o4=v.forwardRef(R6);function I6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const yS=v.forwardRef(I6);function F6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const uy=v.forwardRef(F6);function M6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const qs=v.forwardRef(M6);function L6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const B6=v.forwardRef(L6);function $6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const U6=v.forwardRef($6);function z6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const l4=v.forwardRef(z6);function W6({title:e,titleId:t,...r},n){return v.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},r),e?v.createElement("title",{id:t},e):null,v.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Hr=v.forwardRef(W6),H6={};var K6={};const V6=(()=>{const e=typeof import.meta<"u"&&H6?.VITE_API_BASE_URL||"";if(e)return e;const t=typeof process<"u"&&K6?.VITE_API_BASE_URL||"";return t||"http://localhost:3001"})();function G6(e){const t=(e||"").trim();return t?/^:\\d+/.test(t)?`http://localhost${t}`:/^localhost:\\d+/.test(t)?`http://${t}`:/^https?:\/\//i.test(t)?t:`http://${t}`:"http://localhost:3001"}const Uh=G6(V6),Y6=e=>{if(e.startsWith("http"))return e;const t=Uh.replace(/\/+$/,""),r=e.replace(/^\/+/,"");return`${t}/${r}`};async function Ct(e,t){const r=Y6(e),n={credentials:t?.credentials??"include",...t};try{return await fetch(r,n)}catch(a){if(!e.startsWith("http")){try{return await fetch(`http://127.0.0.1:3001${e}`,n)}catch{}try{return await fetch(e,n)}catch{}}throw a}}async function X6(e=new Date().getFullYear()){const t=await Ct(`/api/dashboard/charts?year=${e}`);if(!t.ok)throw new Error("Khong the tai du lieu bieu do dashboard.");const r=await t.json().catch(()=>({}))||{},n=Array.isArray(r.months)?r.months:[],a=l=>{const d=l.month||l.month_label||(Number.isFinite(l.month_num)?`T${l.month_num}`:"");return String(d||"").trim()},i=n.map(l=>({month:a(l),total_sales:Number(l.total_revenue??l.total_sales)||0})),s=n.map(l=>({month:a(l),total_orders:Number(l.total_orders)||0,total_canceled:Number(l.total_canceled)||0}));return{revenueData:i,orderStatusData:s,year:Number.isFinite(r.year)?Number(r.year):void 0}}async function q6(){const e=await Ct("/api/dashboard/years");if(!e.ok)throw new Error("Li khi ti danh sch nm");const t=await e.json();return!t||!Array.isArray(t.years)?[]:t.years.map(r=>Number(r)).filter(r=>Number.isFinite(r))}const c4=v.createContext({user:null,setUser:()=>{},loading:!0,refresh:async()=>{}}),dy=()=>v.useContext(c4),Q6=({children:e})=>{const[t,r]=v.useState(null),[n,a]=v.useState(!0),i=async()=>{try{const s=await Ct("/api/auth/me");if(!s.ok){r(null);return}const l=await s.json();r(l.user||null)}catch{r(null)}finally{a(!1)}};return v.useEffect(()=>{i()},[]),c.jsx(c4.Provider,{value:{user:t,setUser:r,loading:n,refresh:i},children:e})},Ex=[{title:"Tng Quan",items:[{name:"Tng Quan",href:"/dashboard",icon:a4}]},{title:"Sn Phm",items:[{name:"n Hng",href:"/orders",icon:uy},{name:"Gi",href:"/package-products",icon:h6},{name:"Bng Gi",href:"/pricing",icon:oy},{name:"Thng Tin Sn Phm",href:"/product-info",icon:E6}]},{title:"C Nhn",items:[{name:"Nh Cung Cp",href:"/sources",icon:x6},{name:"Bo Gi",href:"/show-price",icon:Nx},{name:"Ha n",href:"/bill-order",icon:Nx},{name:"Bin Lai",href:"/invoices",icon:Nx},{name:"Lu Tr",href:"/warehouse",icon:ay}]}],wS=e=>{if(!e)return"";const t=e.startsWith("?")?e.slice(1):e,r=new URLSearchParams(t);return Array.from(r.entries()).map(([n,a])=>`${n}=${a}`).sort().join("&")},Tx=(e,t,r)=>{const[n,a]=r.split("?"),i=a?`?${a}`:"";return e!==n?!1:wS(t)===wS(i)};function Z6({isOpen:e,setIsOpen:t}){const r=oo(),{user:n,setUser:a}=dy(),[i,s]=v.useState(!1),[l,d]=v.useState(()=>Object.fromEntries(Ex.map(p=>[p.title,!0]))),h=p=>{d(x=>({...x,[p]:!x[p]}))},f=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch{}finally{a(null),window.location.href="/login"}};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:c.jsx("button",{onClick:()=>t(!e),className:"bg-white p-2 rounded-lg shadow-lg border border-gray-200",children:e?c.jsx(Hr,{className:"h-6 w-6 text-gray-600"}):c.jsx(e6,{className:"h-6 w-6 text-gray-600"})})}),e&&c.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>t(!1)}),c.jsx("div",{className:`
          fixed top-0 left-0 z-40 w-64 h-full bg-gradient-to-b from-[#0c1230] via-[#141a3c] to-[#0a0e24] shadow-2xl border-r border-white/10
          transform transition-transform duration-300 ease-in-out
          ${e?"translate-x-0":"-translate-x-full"}
          lg:translate-x-0
        `,children:c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsx("div",{className:"px-4 pt-6 pb-4",children:c.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-500 px-4 py-3 shadow-lg shadow-indigo-900/50 text-center border border-white/10",children:[c.jsx("h1",{className:"text-lg font-bold text-white tracking-wide",children:"Admin Orderlist"}),c.jsx("p",{className:"text-[11px] text-indigo-100/90 mt-1 font-medium uppercase tracking-[0.08em]",children:"Control Panel"})]})}),c.jsx("nav",{className:"flex-1 px-3 pb-6 overflow-y-auto space-y-2",children:Ex.map(p=>{const x=l[p.title]??!0,g=p.title===Ex[0].title,b=p.items.some(_=>r.pathname===_.href||Tx(r.pathname,r.search,_.href));return c.jsx("div",{className:`w-full rounded-2xl border border-white/10 bg-white/5 shadow-[0_10px_30px_-12px_rgba(0,0,0,0.45)] backdrop-blur-sm mb-3 ${b?"ring-2 ring-indigo-500/40":""}`,children:g?c.jsx("div",{className:"space-y-1 px-2 py-1",children:p.items.map(_=>{const w=r.pathname===_.href||Tx(r.pathname,r.search,_.href);return c.jsx("div",{className:"space-y-2",children:c.jsxs(xS,{to:_.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${w?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[c.jsx(_.icon,{className:`h-5 w-5 transition-colors ${w?"text-white":"text-indigo-200 group-hover:text-white"}`}),_.name]})},_.name)})}):c.jsxs(c.Fragment,{children:[c.jsxs("button",{type:"button",onClick:()=>h(p.title),className:"w-full px-4 py-2.5 flex items-center justify-between text-[11px] font-semibold uppercase tracking-[0.12em] text-indigo-100 hover:text-white transition bg-white/5 rounded-lg",children:[c.jsx("span",{children:p.title}),c.jsx(i4,{className:`h-4 w-4 transition-transform ${x?"rotate-180":""}`})]}),x&&c.jsx("div",{className:"space-y-1 px-2.5 py-2",children:p.items.map(_=>{const w=r.pathname===_.href||Tx(r.pathname,r.search,_.href);return c.jsx("div",{className:"space-y-2",children:c.jsxs(xS,{to:_.href,onClick:()=>t(!1),className:`
                                group flex items-center gap-3 px-3 py-2.5 text-sm font-semibold rounded-xl transition-all duration-200
                                ${w?"bg-gradient-to-r from-indigo-500 to-blue-500 text-white shadow-lg shadow-indigo-900/40":"text-indigo-100/90 hover:bg-white/10 hover:text-white"}
                              `,children:[c.jsx(_.icon,{className:`h-5 w-5 transition-colors ${w?"text-white":"text-indigo-200 group-hover:text-white"}`}),_.name]})},_.name)})})]})},p.title)})}),c.jsxs("div",{className:"relative p-4 border-t border-white/10 bg-white/5 backdrop-blur-sm",children:[c.jsxs("div",{className:"w-full flex items-center justify-between",children:[c.jsxs("button",{type:"button",onClick:()=>s(p=>!p),className:"flex items-center flex-1",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center shadow-md shadow-indigo-900/40",children:c.jsx("span",{className:"text-white text-sm font-bold tracking-wide",children:(n?.username||"A").slice(0,1).toUpperCase()})}),c.jsxs("div",{className:"ml-3 flex-1 text-left",children:[c.jsx("p",{className:"text-sm font-semibold text-white truncate",children:n?.username||"Ti Khon"}),c.jsx("p",{className:"text-[11px] text-indigo-100/80 truncate",children:n?.role?`Role: ${n.role}`:"Cha ng nhp"})]})]}),c.jsx("button",{type:"button",onClick:f,className:"ml-3 w-9 h-9 flex items-center justify-center rounded-lg bg-red-500/10 text-red-200 hover:bg-red-500/20 border border-red-500/30 transition",title:"ng Xut",children:c.jsx(YI,{className:"h-5 w-5"})})]}),i&&c.jsx("div",{className:"absolute bottom-16 left-4 right-4 rounded-lg border border-white/15 bg-[#0f1432] shadow-2xl shadow-black/40 z-10",children:c.jsx("ul",{className:"py-2 text-sm text-indigo-50 space-y-1",children:["Thng tin","Thm Admin","Thm Quyn","i Mt Khu"].map(p=>c.jsx("li",{children:c.jsx("button",{type:"button",className:"w-full text-left px-4 py-2 hover:bg-white/10",onClick:()=>s(!1),children:p})},p))})})]})]})})]})}const Rr={sky:{border:"border-sky-100/80",glow:"from-sky-100/70 via-white/80 to-blue-100/70",iconBg:"bg-sky-500/90 text-white"},emerald:{border:"border-emerald-100/80",glow:"from-emerald-100/70 via-white/80 to-lime-100/70",iconBg:"bg-emerald-500/90 text-white"},violet:{border:"border-violet-100/80",glow:"from-violet-100/70 via-white/80 to-fuchsia-100/70",iconBg:"bg-violet-500/90 text-white"},amber:{border:"border-amber-100/80",glow:"from-amber-100/70 via-white/80 to-orange-100/70",iconBg:"bg-amber-500/90 text-white"},rose:{border:"border-rose-100/80",glow:"from-rose-100/70 via-white/80 to-pink-100/70",iconBg:"bg-rose-500/90 text-white"},indigo:{border:"border-indigo-100/80",glow:"from-indigo-100/70 via-white/80 to-purple-100/70",iconBg:"bg-indigo-500/90 text-white"},slate:{border:"border-slate-200/80",glow:"from-slate-100/70 via-white/80 to-slate-200/70",iconBg:"bg-slate-600/90 text-white"},teal:{border:"border-teal-100/80",glow:"from-teal-100/70 via-white/80 to-cyan-100/70",iconBg:"bg-teal-500/90 text-white"}},Qi=({title:e,value:t,icon:r,accent:n,subtitle:a,children:i,iconClassName:s="h-6 w-6"})=>c.jsxs("div",{className:"relative isolate overflow-hidden rounded-3xl border border-white/25 bg-gradient-to-br from-slate-200/70 via-indigo-200/60 to-slate-300/70 p-6 shadow-[0_18px_48px_-28px_rgba(0,0,0,0.6),0_12px_30px_-24px_rgba(255,255,255,0.22)] backdrop-blur transition-all hover:shadow-[0_22px_60px_-28px_rgba(0,0,0,0.65),0_16px_36px_-24px_rgba(255,255,255,0.24)]",children:[c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-slate-900",children:e}),c.jsx("p",{className:"mt-2 text-2xl font-semibold text-slate-900",children:t}),a&&c.jsx("p",{className:"mt-1 text-xs font-semibold uppercase tracking-wide text-slate-600",children:a})]}),c.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20 border border-white/35 shadow-inner shadow-black/15 text-slate-800",children:c.jsx(r,{className:s})})]}),i&&c.jsx("div",{className:"mt-4",children:i})]});function u4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=u4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function $t(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=u4(e))&&(n&&(n+=" "),n+=t);return n}var J6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function fy(e){if(typeof e!="string")return!1;var t=J6;return t.includes(e)}var eF=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function d4(e){if(typeof e!="string")return!1;var t=eF;return t.includes(e)}function f4(e){return typeof e=="string"&&e.startsWith("data-")}function Ta(e){var t=Object.entries(e).filter(r=>{var[n]=r;return d4(n)||f4(n)});return Object.fromEntries(t)}function Ho(e){if(e==null)return null;if(v.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Ta(t)}return typeof e=="object"&&!Array.isArray(e)?Ta(e):null}function Kn(e){var t=Object.entries(e).filter(r=>{var[n]=r;return d4(n)||f4(n)||fy(n)});return Object.fromEntries(t)}function tF(e){return e==null?null:v.isValidElement(e)?Kn(e.props):typeof e=="object"&&!Array.isArray(e)?Kn(e):null}var rF=["children","width","height","viewBox","className","style","title","desc"];function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$v.apply(null,arguments)}function nF(e,t){if(e==null)return{};var r,n,a=aF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h4=v.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:l,title:d,desc:h}=e,f=nF(e,rF),p=i||{width:n,height:a,x:0,y:0},x=$t("recharts-surface",s);return v.createElement("svg",$v({},Kn(f),{className:x,width:n,height:a,style:l,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),v.createElement("title",null,d),v.createElement("desc",null,h),r)}),iF=["children","className"];function Uv(){return Uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uv.apply(null,arguments)}function sF(e,t){if(e==null)return{};var r,n,a=oF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hn=v.forwardRef((e,t)=>{var{children:r,className:n}=e,a=sF(e,iF),i=$t("recharts-layer",n);return v.createElement("g",Uv({className:i},Kn(a),{ref:t}),r)}),lF=v.createContext(null);function Jt(e){return function(){return e}}const p4=Math.cos,C0=Math.sin,ui=Math.sqrt,k0=Math.PI,zh=2*k0,zv=Math.PI,Wv=2*zv,Ao=1e-6,cF=Wv-Ao;function m4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function uF(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return m4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class dF{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?m4:uF(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,d=n-t,h=a-r,f=s-t,p=l-r,x=f*f+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(x>Ao)if(!(Math.abs(p*d-h*f)>Ao)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-s,b=a-l,_=d*d+h*h,w=g*g+b*b,S=Math.sqrt(_),T=Math.sqrt(x),E=i*Math.tan((zv-Math.acos((_+x-w)/(2*S*T)))/2),k=E/T,A=E/S;Math.abs(k-1)>Ao&&this._append`L${t+k*f},${r+k*p}`,this._append`A${i},${i},0,0,${+(p*g>f*b)},${this._x1=t+A*d},${this._y1=r+A*h}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),d=n*Math.sin(a),h=t+l,f=r+d,p=1^s,x=s?a-i:i-a;this._x1===null?this._append`M${h},${f}`:(Math.abs(this._x1-h)>Ao||Math.abs(this._y1-f)>Ao)&&this._append`L${h},${f}`,n&&(x<0&&(x=x%Wv+Wv),x>cF?this._append`A${n},${n},0,1,${p},${t-l},${r-d}A${n},${n},0,1,${p},${this._x1=h},${this._y1=f}`:x>Ao&&this._append`A${n},${n},0,${+(x>=zv)},${p},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function hy(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new dF(t)}function py(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function x4(e){this._context=e}x4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Wh(e){return new x4(e)}function g4(e){return e[0]}function v4(e){return e[1]}function y4(e,t){var r=Jt(!0),n=null,a=Wh,i=null,s=hy(l);e=typeof e=="function"?e:e===void 0?g4:Jt(e),t=typeof t=="function"?t:t===void 0?v4:Jt(t);function l(d){var h,f=(d=py(d)).length,p,x=!1,g;for(n==null&&(i=a(g=s())),h=0;h<=f;++h)!(h<f&&r(p=d[h],h,d))===x&&((x=!x)?i.lineStart():i.lineEnd()),x&&i.point(+e(p,h,d),+t(p,h,d));if(g)return i=null,g+""||null}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:Jt(+d),l):e},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:Jt(+d),l):t},l.defined=function(d){return arguments.length?(r=typeof d=="function"?d:Jt(!!d),l):r},l.curve=function(d){return arguments.length?(a=d,n!=null&&(i=a(n)),l):a},l.context=function(d){return arguments.length?(d==null?n=i=null:i=a(n=d),l):n},l}function Bf(e,t,r){var n=null,a=Jt(!0),i=null,s=Wh,l=null,d=hy(h);e=typeof e=="function"?e:e===void 0?g4:Jt(+e),t=typeof t=="function"?t:Jt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?v4:Jt(+r);function h(p){var x,g,b,_=(p=py(p)).length,w,S=!1,T,E=new Array(_),k=new Array(_);for(i==null&&(l=s(T=d())),x=0;x<=_;++x){if(!(x<_&&a(w=p[x],x,p))===S)if(S=!S)g=x,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),b=x-1;b>=g;--b)l.point(E[b],k[b]);l.lineEnd(),l.areaEnd()}S&&(E[x]=+e(w,x,p),k[x]=+t(w,x,p),l.point(n?+n(w,x,p):E[x],r?+r(w,x,p):k[x]))}if(T)return l=null,T+""||null}function f(){return y4().defined(a).curve(s).context(i)}return h.x=function(p){return arguments.length?(e=typeof p=="function"?p:Jt(+p),n=null,h):e},h.x0=function(p){return arguments.length?(e=typeof p=="function"?p:Jt(+p),h):e},h.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:Jt(+p),h):n},h.y=function(p){return arguments.length?(t=typeof p=="function"?p:Jt(+p),r=null,h):t},h.y0=function(p){return arguments.length?(t=typeof p=="function"?p:Jt(+p),h):t},h.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:Jt(+p),h):r},h.lineX0=h.lineY0=function(){return f().x(e).y(t)},h.lineY1=function(){return f().x(e).y(r)},h.lineX1=function(){return f().x(n).y(t)},h.defined=function(p){return arguments.length?(a=typeof p=="function"?p:Jt(!!p),h):a},h.curve=function(p){return arguments.length?(s=p,i!=null&&(l=s(i)),h):s},h.context=function(p){return arguments.length?(p==null?i=l=null:l=s(i=p),h):i},h}class w4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function fF(e){return new w4(e,!0)}function hF(e){return new w4(e,!1)}const my={draw(e,t){const r=ui(t/k0);e.moveTo(r,0),e.arc(0,0,r,0,zh)}},pF={draw(e,t){const r=ui(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},b4=ui(1/3),mF=b4*2,xF={draw(e,t){const r=ui(t/mF),n=r*b4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},gF={draw(e,t){const r=ui(t),n=-r/2;e.rect(n,n,r,r)}},vF=.8908130915292852,_4=C0(k0/10)/C0(7*k0/10),yF=C0(zh/10)*_4,wF=-p4(zh/10)*_4,bF={draw(e,t){const r=ui(t*vF),n=yF*r,a=wF*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=zh*i/5,l=p4(s),d=C0(s);e.lineTo(d*r,-l*r),e.lineTo(l*n-d*a,d*n+l*a)}e.closePath()}},Cx=ui(3),_F={draw(e,t){const r=-ui(t/(Cx*3));e.moveTo(0,r*2),e.lineTo(-Cx*r,-r),e.lineTo(Cx*r,-r),e.closePath()}},Fa=-.5,Ma=ui(3)/2,Hv=1/ui(12),SF=(Hv/2+1)*3,NF={draw(e,t){const r=ui(t/SF),n=r/2,a=r*Hv,i=n,s=r*Hv+r,l=-i,d=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,d),e.lineTo(Fa*n-Ma*a,Ma*n+Fa*a),e.lineTo(Fa*i-Ma*s,Ma*i+Fa*s),e.lineTo(Fa*l-Ma*d,Ma*l+Fa*d),e.lineTo(Fa*n+Ma*a,Fa*a-Ma*n),e.lineTo(Fa*i+Ma*s,Fa*s-Ma*i),e.lineTo(Fa*l+Ma*d,Fa*d-Ma*l),e.closePath()}};function EF(e,t){let r=null,n=hy(a);e=typeof e=="function"?e:Jt(e||my),t=typeof t=="function"?t:Jt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Jt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function A0(){}function P0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function S4(e){this._context=e}S4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:P0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TF(e){return new S4(e)}function N4(e){this._context=e}N4.prototype={areaStart:A0,areaEnd:A0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CF(e){return new N4(e)}function E4(e){this._context=e}E4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:P0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kF(e){return new E4(e)}function T4(e){this._context=e}T4.prototype={areaStart:A0,areaEnd:A0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function AF(e){return new T4(e)}function bS(e){return e<0?-1:1}function _S(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(bS(i)+bS(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function SS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function kx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function j0(e){this._context=e}j0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kx(this,this._t0,SS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kx(this,SS(this,r=_S(this,e,t)),r);break;default:kx(this,this._t0,r=_S(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function C4(e){this._context=new k4(e)}(C4.prototype=Object.create(j0.prototype)).point=function(e,t){j0.prototype.point.call(this,t,e)};function k4(e){this._context=e}k4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function PF(e){return new j0(e)}function jF(e){return new C4(e)}function A4(e){this._context=e}A4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=NS(e),a=NS(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function NS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function OF(e){return new A4(e)}function Hh(e,t){this._context=e,this._t=t}Hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function DF(e){return new Hh(e,.5)}function RF(e){return new Hh(e,0)}function IF(e){return new Hh(e,1)}function ic(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Kv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function FF(e,t){return e[t]}function MF(e){const t=[];return t.key=e,t}function LF(){var e=Jt([]),t=Kv,r=ic,n=FF;function a(i){var s=Array.from(e.apply(this,arguments),MF),l,d=s.length,h=-1,f;for(const p of i)for(l=0,++h;l<d;++l)(s[l][h]=[0,+n(p,s[l].key,h,i)]).data=p;for(l=0,f=py(t(s));l<d;++l)s[f[l]].index=l;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Jt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Kv:typeof i=="function"?i:Jt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??ic,a):r},a}function BF(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}ic(e,t)}}function $F(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}ic(e,t)}}function UF(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,d=0,h=0;l<s;++l){for(var f=e[t[l]],p=f[n][1]||0,x=f[n-1][1]||0,g=(p-x)/2,b=0;b<l;++b){var _=e[t[b]],w=_[n][1]||0,S=_[n-1][1]||0;g+=w-S}d+=p,h+=g*p}a[n-1][1]+=a[n-1][0]=r,d&&(r-=h/d)}a[n-1][1]+=a[n-1][0]=r,ic(e,t)}}var Ax={},Px={},ES;function zF(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Px)),Px}var jx={},TS;function P4(){return TS||(TS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(jx)),jx}var Ox={},CS;function xy(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Ox)),Ox}var Dx={},Rx={},kS;function WF(){return kS||(kS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Rx)),Rx}var AS;function gy(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WF(),r=xy();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let l=0,d="",h="",f=!1;for(a.charCodeAt(0)===46&&(i.push(""),l++);l<s;){const p=a[l];h?p==="\\"&&l+1<s?(l++,d+=a[l]):p===h?h="":d+=p:f?p==='"'||p==="'"?h=p:p==="]"?(f=!1,i.push(d),d=""):d+=p:p==="["?(f=!0,d&&(i.push(d),d="")):p==="."?d&&(i.push(d),d=""):d+=p,l++}return d&&i.push(d),i}e.toPath=n})(Dx)),Dx}var PS;function vy(){return PS||(PS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zF(),r=P4(),n=xy(),a=gy();function i(l,d,h){if(l==null)return h;switch(typeof d){case"string":{if(t.isUnsafeProperty(d))return h;const f=l[d];return f===void 0?r.isDeepKey(d)?i(l,a.toPath(d),h):h:f}case"number":case"symbol":{typeof d=="number"&&(d=n.toKey(d));const f=l[d];return f===void 0?h:f}default:{if(Array.isArray(d))return s(l,d,h);if(Object.is(d?.valueOf(),-0)?d="-0":d=String(d),t.isUnsafeProperty(d))return h;const f=l[d];return f===void 0?h:f}}}function s(l,d,h){if(d.length===0)return h;let f=l;for(let p=0;p<d.length;p++){if(f==null||t.isUnsafeProperty(d[p]))return h;f=f[d[p]]}return f===void 0?h:f}e.get=i})(Ax)),Ax}var Ix,jS;function HF(){return jS||(jS=1,Ix=vy().get),Ix}var KF=HF();const Ko=fs(KF);var tn=e=>e===0?0:e>0?1:-1,Ka=e=>typeof e=="number"&&e!=+e,is=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,pt=e=>(typeof e=="number"||e instanceof Number)&&!Ka(e),Pi=e=>pt(e)||typeof e=="string",VF=0,zu=e=>{var t=++VF;return"".concat(e||"").concat(t)},kn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!pt(t)&&typeof t!="string")return n;var i;if(is(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Ka(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},j4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function br(e,t,r){return pt(e)&&pt(t)?e+r*(t-e):t}function O4(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Ko(n,t))===r)}var fr=e=>e===null||typeof e>"u",dd=e=>fr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),GF=["type","size","sizeType"];function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vv.apply(null,arguments)}function OS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OS(Object(r),!0).forEach(function(n){YF(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YF(e,t,r){return(t=XF(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XF(e){var t=qF(e,"string");return typeof t=="symbol"?t:t+""}function qF(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QF(e,t){if(e==null)return{};var r,n,a=ZF(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZF(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var D4={symbolCircle:my,symbolCross:pF,symbolDiamond:xF,symbolSquare:gF,symbolStar:bF,symbolTriangle:_F,symbolWye:NF},JF=Math.PI/180,eM=e=>{var t="symbol".concat(dd(e));return D4[t]||my},tM=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*JF;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},rM=(e,t)=>{D4["symbol".concat(dd(e))]=t},R4=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=QF(e,GF),i=DS(DS({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var l=()=>{var x=eM(s),g=EF().type(x).size(tM(r,n,s)),b=g();if(b!==null)return b},{className:d,cx:h,cy:f}=i,p=Kn(i);return h===+h&&f===+f&&r===+r?v.createElement("path",Vv({},p,{className:$t("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(f,")"),d:l()})):null};R4.registerSymbol=rM;var yy=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(v.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{fy(a)&&(n[a]=(i=>r[a](r,i)))}),n},nM=(e,t,r)=>n=>(e(t,r,n),null),Kh=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];fy(a)&&typeof i=="function"&&(n||(n={}),n[a]=nM(i,t,r))}),n},Fx={},Mx={},RS;function aM(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],l=n(s);a.has(l)||a.set(l,s)}return Array.from(a.values())}e.uniqBy=t})(Mx)),Mx}var Lx={},IS;function I4(){return IS||(IS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Lx)),Lx}var Bx={},$x={},Ux={},FS;function iM(){return FS||(FS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Ux)),Ux}var MS;function wy(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iM();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})($x)),$x}var zx={},LS;function sM(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(zx)),zx}var BS;function oM(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wy(),r=sM();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Bx)),Bx}var Wx={},Hx={},$S;function lM(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vy();function r(n){return function(a){return t.get(a,n)}}e.property=r})(Hx)),Hx}var Kx={},Vx={},Gx={},Yx={},US;function F4(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Yx)),Yx}var Xx={},zS;function M4(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Xx)),Xx}var qx={},WS;function L4(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(qx)),qx}var HS;function cM(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=F4(),r=M4(),n=L4();function a(f,p,x){return typeof x!="function"?a(f,p,()=>{}):i(f,p,function g(b,_,w,S,T,E){const k=x(b,_,w,S,T,E);return k!==void 0?!!k:i(b,_,g,E)},new Map)}function i(f,p,x,g){if(p===f)return!0;switch(typeof p){case"object":return s(f,p,x,g);case"function":return Object.keys(p).length>0?i(f,{...p},x,g):n.eq(f,p);default:return t.isObject(f)?typeof p=="string"?p==="":!0:n.eq(f,p)}}function s(f,p,x,g){if(p==null)return!0;if(Array.isArray(p))return d(f,p,x,g);if(p instanceof Map)return l(f,p,x,g);if(p instanceof Set)return h(f,p,x,g);const b=Object.keys(p);if(f==null)return b.length===0;if(b.length===0)return!0;if(g?.has(p))return g.get(p)===f;g?.set(p,f);try{for(let _=0;_<b.length;_++){const w=b[_];if(!r.isPrimitive(f)&&!(w in f)||p[w]===void 0&&f[w]!==void 0||p[w]===null&&f[w]!==null||!x(f[w],p[w],w,f,p,g))return!1}return!0}finally{g?.delete(p)}}function l(f,p,x,g){if(p.size===0)return!0;if(!(f instanceof Map))return!1;for(const[b,_]of p.entries()){const w=f.get(b);if(x(w,_,b,f,p,g)===!1)return!1}return!0}function d(f,p,x,g){if(p.length===0)return!0;if(!Array.isArray(f))return!1;const b=new Set;for(let _=0;_<p.length;_++){const w=p[_];let S=!1;for(let T=0;T<f.length;T++){if(b.has(T))continue;const E=f[T];let k=!1;if(x(E,w,_,f,p,g)&&(k=!0),k){b.add(T),S=!0;break}}if(!S)return!1}return!0}function h(f,p,x,g){return p.size===0?!0:f instanceof Set?d([...f],[...p],x,g):!1}e.isMatchWith=a,e.isSetMatch=h})(Gx)),Gx}var KS;function B4(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cM();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(Vx)),Vx}var Qx={},Zx={},Jx={},VS;function uM(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Jx)),Jx}var eg={},GS;function $4(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(eg)),eg}var tg={},YS;function U4(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",l="[object Date]",d="[object Map]",h="[object Set]",f="[object Array]",p="[object Function]",x="[object ArrayBuffer]",g="[object Object]",b="[object Error]",_="[object DataView]",w="[object Uint8Array]",S="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",k="[object BigUint64Array]",A="[object Int8Array]",j="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",L="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=x,e.arrayTag=f,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=_,e.dateTag=l,e.errorTag=b,e.float32ArrayTag=L,e.float64ArrayTag=I,e.functionTag=p,e.int16ArrayTag=j,e.int32ArrayTag=P,e.int8ArrayTag=A,e.mapTag=d,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=h,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=T,e.uint32ArrayTag=E,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=S})(tg)),tg}var rg={},XS;function dM(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(rg)),rg}var qS;function z4(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uM(),r=$4(),n=U4(),a=M4(),i=dM();function s(f,p){return l(f,void 0,f,new Map,p)}function l(f,p,x,g=new Map,b=void 0){const _=b?.(f,p,x,g);if(_!==void 0)return _;if(a.isPrimitive(f))return f;if(g.has(f))return g.get(f);if(Array.isArray(f)){const w=new Array(f.length);g.set(f,w);for(let S=0;S<f.length;S++)w[S]=l(f[S],S,x,g,b);return Object.hasOwn(f,"index")&&(w.index=f.index),Object.hasOwn(f,"input")&&(w.input=f.input),w}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const w=new RegExp(f.source,f.flags);return w.lastIndex=f.lastIndex,w}if(f instanceof Map){const w=new Map;g.set(f,w);for(const[S,T]of f)w.set(S,l(T,S,x,g,b));return w}if(f instanceof Set){const w=new Set;g.set(f,w);for(const S of f)w.add(l(S,void 0,x,g,b));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(i.isTypedArray(f)){const w=new(Object.getPrototypeOf(f)).constructor(f.length);g.set(f,w);for(let S=0;S<f.length;S++)w[S]=l(f[S],S,x,g,b);return w}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const w=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return g.set(f,w),d(w,f,x,g,b),w}if(typeof File<"u"&&f instanceof File){const w=new File([f],f.name,{type:f.type});return g.set(f,w),d(w,f,x,g,b),w}if(typeof Blob<"u"&&f instanceof Blob){const w=new Blob([f],{type:f.type});return g.set(f,w),d(w,f,x,g,b),w}if(f instanceof Error){const w=new f.constructor;return g.set(f,w),w.message=f.message,w.name=f.name,w.stack=f.stack,w.cause=f.cause,d(w,f,x,g,b),w}if(f instanceof Boolean){const w=new Boolean(f.valueOf());return g.set(f,w),d(w,f,x,g,b),w}if(f instanceof Number){const w=new Number(f.valueOf());return g.set(f,w),d(w,f,x,g,b),w}if(f instanceof String){const w=new String(f.valueOf());return g.set(f,w),d(w,f,x,g,b),w}if(typeof f=="object"&&h(f)){const w=Object.create(Object.getPrototypeOf(f));return g.set(f,w),d(w,f,x,g,b),w}return f}function d(f,p,x=f,g,b){const _=[...Object.keys(p),...t.getSymbols(p)];for(let w=0;w<_.length;w++){const S=_[w],T=Object.getOwnPropertyDescriptor(f,S);(T==null||T.writable)&&(f[S]=l(p[S],S,x,g,b))}}function h(f){switch(r.getTag(f)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=l,e.copyProperties=d})(Zx)),Zx}var QS;function fM(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z4();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Qx)),Qx}var ZS;function hM(){return ZS||(ZS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B4(),r=fM();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Kx)),Kx}var ng={},ag={},ig={},JS;function pM(){return JS||(JS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z4(),r=U4();function n(a,i){return t.cloneDeepWith(a,(s,l,d,h)=>{const f=i?.(s,l,d,h);if(f!==void 0)return f;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new a.constructor(a?.valueOf());return t.copyProperties(p,a),p}case r.argumentsTag:{const p={};return t.copyProperties(p,a),p.length=a.length,p[Symbol.iterator]=a[Symbol.iterator],p}default:return}})}e.cloneDeepWith=n})(ig)),ig}var eN;function mM(){return eN||(eN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pM();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(ag)),ag}var sg={},og={},tN;function W4(){return tN||(tN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(og)),og}var lg={},rN;function xM(){return rN||(rN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$4();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(lg)),lg}var nN;function gM(){return nN||(nN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=P4(),r=W4(),n=xM(),a=gy();function i(s,l){let d;if(Array.isArray(l)?d=l:typeof l=="string"&&t.isDeepKey(l)&&s?.[l]==null?d=a.toPath(l):d=[l],d.length===0)return!1;let h=s;for(let f=0;f<d.length;f++){const p=d[f];if((h==null||!Object.hasOwn(h,p))&&!((Array.isArray(h)||n.isArguments(h))&&r.isIndex(p)&&p<h.length))return!1;h=h[p]}return!0}e.has=i})(sg)),sg}var aN;function vM(){return aN||(aN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B4(),r=xy(),n=mM(),a=vy(),i=gM();function s(l,d){switch(typeof l){case"object":{Object.is(l?.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return d=n.cloneDeep(d),function(h){const f=a.get(h,l);return f===void 0?i.has(h,l):d===void 0?f===void 0:t.isMatch(f,d)}}e.matchesProperty=s})(ng)),ng}var iN;function yM(){return iN||(iN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=I4(),r=lM(),n=hM(),a=vM();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(Wx)),Wx}var sN;function wM(){return sN||(sN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aM(),r=I4(),n=oM(),a=yM();function i(s,l=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(l)):[]}e.uniqBy=i})(Fx)),Fx}var cg,oN;function bM(){return oN||(oN=1,cg=wM().uniqBy),cg}var _M=bM();const lN=fs(_M);function SM(e,t,r){return t===!0?lN(e,r):typeof t=="function"?lN(e,t):e}var ug={exports:{}},dg={},fg={exports:{}},hg={};var cN;function NM(){if(cN)return hg;cN=1;var e=mc();function t(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function l(p,x){var g=x(),b=n({inst:{value:g,getSnapshot:x}}),_=b[0].inst,w=b[1];return i(function(){_.value=g,_.getSnapshot=x,d(_)&&w({inst:_})},[p,g,x]),a(function(){return d(_)&&w({inst:_}),p(function(){d(_)&&w({inst:_})})},[p]),s(g),g}function d(p){var x=p.getSnapshot;p=p.value;try{var g=x();return!r(p,g)}catch{return!0}}function h(p,x){return x()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:l;return hg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:f,hg}var uN;function EM(){return uN||(uN=1,fg.exports=NM()),fg.exports}var dN;function TM(){if(dN)return dg;dN=1;var e=mc(),t=EM();function r(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,l=e.useMemo,d=e.useDebugValue;return dg.useSyncExternalStoreWithSelector=function(h,f,p,x,g){var b=i(null);if(b.current===null){var _={hasValue:!1,value:null};b.current=_}else _=b.current;b=l(function(){function S(j){if(!T){if(T=!0,E=j,j=x(j),g!==void 0&&_.hasValue){var P=_.value;if(g(P,j))return k=P}return k=j}if(P=k,n(E,j))return P;var D=x(j);return g!==void 0&&g(P,D)?(E=j,P):(E=j,k=D)}var T=!1,E,k,A=p===void 0?null:p;return[function(){return S(f())},A===null?void 0:function(){return S(A())}]},[f,p,x,g]);var w=a(h,b[0],b[1]);return s(function(){_.hasValue=!0,_.value=w},[w]),d(w),w},dg}var fN;function CM(){return fN||(fN=1,ug.exports=TM()),ug.exports}var kM=CM(),by=v.createContext(null),AM=e=>e,_r=()=>{var e=v.useContext(by);return e?e.store.dispatch:AM},y0=()=>{},PM=()=>y0,jM=(e,t)=>e===t;function ft(e){var t=v.useContext(by);return kM.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:PM,t?t.store.getState:y0,t?t.store.getState:y0,t?e:y0,jM)}function OM(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function DM(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function RM(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var hN=e=>Array.isArray(e)?e:[e];function IM(e){const t=Array.isArray(e[0])?e[0]:e;return RM(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function FM(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var MM=class{constructor(e){this.value=e}deref(){return this.value}},LM=typeof WeakRef<"u"?WeakRef:MM,BM=0,pN=1;function $f(){return{s:BM,v:void 0,o:null,p:null}}function H4(e,t={}){let r=$f();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let l=r;const{length:d}=arguments;for(let p=0,x=d;p<x;p++){const g=arguments[p];if(typeof g=="function"||typeof g=="object"&&g!==null){let b=l.o;b===null&&(l.o=b=new WeakMap);const _=b.get(g);_===void 0?(l=$f(),b.set(g,l)):l=_}else{let b=l.p;b===null&&(l.p=b=new Map);const _=b.get(g);_===void 0?(l=$f(),b.set(g,l)):l=_}}const h=l;let f;if(l.s===pN)f=l.v;else if(f=e.apply(null,arguments),i++,n){const p=a?.deref?.()??a;p!=null&&n(p,f)&&(f=p,i!==0&&i--),a=typeof f=="object"&&f!==null||typeof f=="function"?new LM(f):f}return h.s=pN,h.v=f,f}return s.clearCache=()=>{r=$f(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function $M(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,l,d={},h=a.pop();typeof h=="object"&&(d=h,h=a.pop()),OM(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const f={...r,...d},{memoize:p,memoizeOptions:x=[],argsMemoize:g=H4,argsMemoizeOptions:b=[]}=f,_=hN(x),w=hN(b),S=IM(a),T=p(function(){return i++,h.apply(null,arguments)},..._),E=g(function(){s++;const A=FM(S,arguments);return l=T.apply(null,A),l},...w);return Object.assign(E,{resultFunc:h,memoizedResultFunc:T,dependencies:S,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>l,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:p,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var ke=$M(H4),UM=Object.assign((e,t=ke)=>{DM(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,l,d)=>(s[r[d]]=l,s),{}))},{withTypes:()=>UM}),pg={},mg={},xg={},mN;function zM(){return mN||(mN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),l=t(a);if(s===l&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?l-s:s-l}return 0};e.compareValues=r})(xg)),xg}var gg={},vg={},xN;function K4(){return xN||(xN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(vg)),vg}var gN;function WM(){return gN||(gN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=K4(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(gg)),gg}var vN;function HM(){return vN||(vN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zM(),r=WM(),n=gy();function a(i,s,l,d){if(i==null)return[];l=d?void 0:l,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(g=>String(g));const h=(g,b)=>{let _=g;for(let w=0;w<b.length&&_!=null;++w)_=_[b[w]];return _},f=(g,b)=>b==null||g==null?b:typeof g=="object"&&"key"in g?Object.hasOwn(b,g.key)?b[g.key]:h(b,g.path):typeof g=="function"?g(b):Array.isArray(g)?h(b,g):typeof b=="object"?b[g]:b,p=s.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return i.map(g=>({original:g,criteria:p.map(b=>f(b,g))})).slice().sort((g,b)=>{for(let _=0;_<p.length;_++){const w=t.compareValues(g.criteria[_],b.criteria[_],l[_]);if(w!==0)return w}return 0}).map(g=>g.original)}e.orderBy=a})(mg)),mg}var yg={},yN;function KM(){return yN||(yN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(l,d)=>{for(let h=0;h<l.length;h++){const f=l[h];Array.isArray(f)&&d<i?s(f,d+1):a.push(f)}};return s(r,0),a}e.flatten=t})(yg)),yg}var wg={},wN;function V4(){return wN||(wN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W4(),r=wy(),n=F4(),a=L4();function i(s,l,d){return n.isObject(d)&&(typeof l=="number"&&r.isArrayLike(d)&&t.isIndex(l)&&l<d.length||typeof l=="string"&&l in d)?a.eq(d[l],s):!1}e.isIterateeCall=i})(wg)),wg}var bN;function VM(){return bN||(bN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HM(),r=KM(),n=V4();function a(i,...s){const l=s.length;return l>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:l>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(pg)),pg}var bg,_N;function GM(){return _N||(_N=1,bg=VM().sortBy),bg}var YM=GM();const Vh=fs(YM);var G4=e=>e.legend.settings,XM=e=>e.legend.size,qM=e=>e.legend.payload;ke([qM,G4],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Vh(n,r):n});var Uf=1;function QM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=v.useState({height:0,left:0,top:0,width:0}),n=v.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>Uf||Math.abs(s.left-t.left)>Uf||Math.abs(s.top-t.top)>Uf||Math.abs(s.width-t.width)>Uf)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function on(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ZM=typeof Symbol=="function"&&Symbol.observable||"@@observable",SN=ZM,_g=()=>Math.random().toString(36).substring(7).split("").join("."),JM={INIT:`@@redux/INIT${_g()}`,REPLACE:`@@redux/REPLACE${_g()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${_g()}`},O0=JM;function _y(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Y4(e,t,r){if(typeof e!="function")throw new Error(on(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(on(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(on(1));return r(Y4)(e,t)}let n=e,a=t,i=new Map,s=i,l=0,d=!1;function h(){s===i&&(s=new Map,i.forEach((w,S)=>{s.set(S,w)}))}function f(){if(d)throw new Error(on(3));return a}function p(w){if(typeof w!="function")throw new Error(on(4));if(d)throw new Error(on(5));let S=!0;h();const T=l++;return s.set(T,w),function(){if(S){if(d)throw new Error(on(6));S=!1,h(),s.delete(T),i=null}}}function x(w){if(!_y(w))throw new Error(on(7));if(typeof w.type>"u")throw new Error(on(8));if(typeof w.type!="string")throw new Error(on(17));if(d)throw new Error(on(9));try{d=!0,a=n(a,w)}finally{d=!1}return(i=s).forEach(T=>{T()}),w}function g(w){if(typeof w!="function")throw new Error(on(10));n=w,x({type:O0.REPLACE})}function b(){const w=p;return{subscribe(S){if(typeof S!="object"||S===null)throw new Error(on(11));function T(){const k=S;k.next&&k.next(f())}return T(),{unsubscribe:w(T)}},[SN](){return this}}}return x({type:O0.INIT}),{dispatch:x,subscribe:p,getState:f,replaceReducer:g,[SN]:b}}function e8(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:O0.INIT})>"u")throw new Error(on(12));if(typeof r(void 0,{type:O0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(on(13))})}function X4(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{e8(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let d=!1;const h={};for(let f=0;f<n.length;f++){const p=n[f],x=r[p],g=s[p],b=x(g,l);if(typeof b>"u")throw l&&l.type,new Error(on(14));h[p]=b,d=d||b!==g}return d=d||n.length!==Object.keys(s).length,d?h:s}}function D0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function t8(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(on(15))};const s={getState:a.getState,dispatch:(d,...h)=>i(d,...h)},l=e.map(d=>d(s));return i=D0(...l)(a.dispatch),{...a,dispatch:i}}}function q4(e){return _y(e)&&"type"in e&&typeof e.type=="string"}var Q4=Symbol.for("immer-nothing"),NN=Symbol.for("immer-draftable"),Ca=Symbol.for("immer-state");function ai(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Wu=Object.getPrototypeOf;function Vo(e){return!!e&&!!e[Ca]}function ss(e){return e?Z4(e)||Array.isArray(e)||!!e[NN]||!!e.constructor?.[NN]||fd(e)||Yh(e):!1}var r8=Object.prototype.constructor.toString(),EN=new WeakMap;function Z4(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=EN.get(r);return n===void 0&&(n=Function.toString.call(r),EN.set(r,n)),n===r8}function R0(e,t,r=!0){Gh(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function Gh(e){const t=e[Ca];return t?t.type_:Array.isArray(e)?1:fd(e)?2:Yh(e)?3:0}function Gv(e,t){return Gh(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function J4(e,t,r){const n=Gh(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function n8(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function fd(e){return e instanceof Map}function Yh(e){return e instanceof Set}function Po(e){return e.copy_||e.base_}function Yv(e,t){if(fd(e))return new Map(e);if(Yh(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Z4(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ca];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],l=n[s];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[s]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[s]})}return Object.create(Wu(e),n)}else{const n=Wu(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Sy(e,t=!1){return Xh(e)||Vo(e)||!ss(e)||(Gh(e)>1&&Object.defineProperties(e,{set:zf,add:zf,clear:zf,delete:zf}),Object.freeze(e),t&&Object.values(e).forEach(r=>Sy(r,!0))),e}function a8(){ai(2)}var zf={value:a8};function Xh(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var i8={};function Go(e){const t=i8[e];return t||ai(0,e),t}var Hu;function eA(){return Hu}function s8(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function TN(e,t){t&&(Go("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Xv(e){qv(e),e.drafts_.forEach(o8),e.drafts_=null}function qv(e){e===Hu&&(Hu=e.parent_)}function CN(e){return Hu=s8(Hu,e)}function o8(e){const t=e[Ca];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kN(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ca].modified_&&(Xv(t),ai(4)),ss(e)&&(e=I0(t,e),t.parent_||F0(t,e)),t.patches_&&Go("Patches").generateReplacementPatches_(r[Ca].base_,e,t.patches_,t.inversePatches_)):e=I0(t,r,[]),Xv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Q4?e:void 0}function I0(e,t,r){if(Xh(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[Ca];if(!a)return R0(t,(i,s)=>AN(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return F0(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,l=!1;a.type_===3&&(s=new Set(i),i.clear(),l=!0),R0(s,(d,h)=>AN(e,a,i,d,h,r,l),n),F0(e,i,!1),r&&e.patches_&&Go("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function AN(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const l=Xh(a);if(!(l&&!s)){if(Vo(a)){const d=i&&t&&t.type_!==3&&!Gv(t.assigned_,n)?i.concat(n):void 0,h=I0(e,a,d);if(J4(r,n,h),Vo(h))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(ss(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&l)return;I0(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(fd(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&F0(e,a)}}}function F0(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Sy(t,r)}function l8(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:eA(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=Ny;r&&(a=[n],i=Ku);const{revoke:s,proxy:l}=Proxy.revocable(a,i);return n.draft_=l,n.revoke_=s,l}var Ny={get(e,t){if(t===Ca)return e;const r=Po(e);if(!Gv(r,t))return c8(e,r,t);const n=r[t];return e.finalized_||!ss(n)?n:n===Sg(e.base_,t)?(Ng(e),e.copy_[t]=Zv(n,e)):n},has(e,t){return t in Po(e)},ownKeys(e){return Reflect.ownKeys(Po(e))},set(e,t,r){const n=tA(Po(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Sg(Po(e),t),i=a?.[Ca];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(n8(r,a)&&(r!==void 0||Gv(e.base_,t)))return!0;Ng(e),Qv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Sg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ng(e),Qv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Po(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ai(11)},getPrototypeOf(e){return Wu(e.base_)},setPrototypeOf(){ai(12)}},Ku={};R0(Ny,(e,t)=>{Ku[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ku.deleteProperty=function(e,t){return Ku.set.call(this,e,t,void 0)};Ku.set=function(e,t,r){return Ny.set.call(this,e[0],t,r,e[0])};function Sg(e,t){const r=e[Ca];return(r?Po(r):e)[t]}function c8(e,t,r){const n=tA(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function tA(e,t){if(!(t in e))return;let r=Wu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Wu(r)}}function Qv(e){e.modified_||(e.modified_=!0,e.parent_&&Qv(e.parent_))}function Ng(e){e.copy_||(e.copy_=Yv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var u8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(d=i,...h){return s.produce(d,f=>r.call(this,f,...h))}}typeof r!="function"&&ai(6),n!==void 0&&typeof n!="function"&&ai(7);let a;if(ss(t)){const i=CN(this),s=Zv(t,void 0);let l=!0;try{a=r(s),l=!1}finally{l?Xv(i):qv(i)}return TN(i,n),kN(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===Q4&&(a=void 0),this.autoFreeze_&&Sy(a,!0),n){const i=[],s=[];Go("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else ai(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...l)=>this.produceWithPatches(s,d=>t(d,...l));let n,a;return[this.produce(t,r,(s,l)=>{n=s,a=l}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){ss(e)||ai(8),Vo(e)&&(e=es(e));const t=CN(this),r=Zv(e,void 0);return r[Ca].isManual_=!0,qv(t),r}finishDraft(e,t){const r=e&&e[Ca];(!r||!r.isManual_)&&ai(9);const{scope_:n}=r;return TN(n,t),kN(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Go("Patches").applyPatches_;return Vo(e)?n(e,t):this.produce(e,a=>n(a,t))}};function Zv(e,t){const r=fd(e)?Go("MapSet").proxyMap_(e,t):Yh(e)?Go("MapSet").proxySet_(e,t):l8(e,t);return(t?t.scope_:eA()).drafts_.push(r),r}function es(e){return Vo(e)||ai(10,e),rA(e)}function rA(e){if(!ss(e)||Xh(e))return e;const t=e[Ca];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Yv(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Yv(e,!0);return R0(r,(a,i)=>{J4(r,a,rA(i))},n),t&&(t.finalized_=!1),r}var d8=new u8,nA=d8.produce;function aA(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var f8=aA(),h8=aA,p8=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?D0:D0.apply(null,arguments)};function Va(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Ea(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>q4(n)&&n.type===e,r}var iA=class Tu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Tu.prototype)}static get[Symbol.species](){return Tu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Tu(...t[0].concat(this)):new Tu(...t.concat(this))}};function PN(e){return ss(e)?nA(e,()=>{}):e}function Wf(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function m8(e){return typeof e=="boolean"}var x8=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new iA;return r&&(m8(r)?s.push(f8):s.push(h8(r.extraArgument))),s},sA="RTK_autoBatch",$n=()=>e=>({payload:e,meta:{[sA]:!0}}),jN=e=>t=>{setTimeout(t,e)},oA=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const l=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:jN(10):e.type==="callback"?e.queueNotification:jN(e.timeout),h=()=>{s=!1,i&&(i=!1,l.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const p=()=>a&&f(),x=n.subscribe(p);return l.add(f),()=>{x(),l.delete(f)}},dispatch(f){try{return a=!f?.meta?.[sA],i=!a,i&&(s||(s=!0,d(h))),n.dispatch(f)}finally{a=!0}}})},g8=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new iA(e);return n&&a.push(oA(typeof n=="object"?n:void 0)),a};function v8(e){const t=x8(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(_y(r))l=X4(r);else throw new Error(Ea(1));let d;typeof n=="function"?d=n(t):d=t();let h=D0;a&&(h=p8({trace:!1,...typeof a=="object"&&a}));const f=t8(...d),p=g8(f);let x=typeof s=="function"?s(p):p();const g=h(...x);return Y4(l,i,g)}function lA(e){const t={},r=[];let n;const a={addCase(i,s){const l=typeof i=="string"?i:i.type;if(!l)throw new Error(Ea(28));if(l in t)throw new Error(Ea(29));return t[l]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function y8(e){return typeof e=="function"}function w8(e,t){let[r,n,a]=lA(t),i;if(y8(e))i=()=>PN(e());else{const l=PN(e);i=()=>l}function s(l=i(),d){let h=[r[d.type],...n.filter(({matcher:f})=>f(d)).map(({reducer:f})=>f)];return h.filter(f=>!!f).length===0&&(h=[a]),h.reduce((f,p)=>{if(p)if(Vo(f)){const g=p(f,d);return g===void 0?f:g}else{if(ss(f))return nA(f,x=>p(x,d));{const x=p(f,d);if(x===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return f},l)}return s.getInitialState=i,s}var b8="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_8=(e=21)=>{let t="",r=e;for(;r--;)t+=b8[Math.random()*64|0];return t},S8=Symbol.for("rtk-slice-createasyncthunk");function N8(e,t){return`${e}/${t}`}function E8({creators:e}={}){const t=e?.asyncThunk?.[S8];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(Ea(11));const s=(typeof n.reducers=="function"?n.reducers(C8()):n.reducers)||{},l=Object.keys(s),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(E,k){const A=typeof E=="string"?E:E.type;if(!A)throw new Error(Ea(12));if(A in d.sliceCaseReducersByType)throw new Error(Ea(13));return d.sliceCaseReducersByType[A]=k,h},addMatcher(E,k){return d.sliceMatchers.push({matcher:E,reducer:k}),h},exposeAction(E,k){return d.actionCreators[E]=k,h},exposeCaseReducer(E,k){return d.sliceCaseReducersByName[E]=k,h}};l.forEach(E=>{const k=s[E],A={reducerName:E,type:N8(a,E),createNotation:typeof n.reducers=="function"};A8(k)?j8(A,k,h,t):k8(A,k,h)});function f(){const[E={},k=[],A=void 0]=typeof n.extraReducers=="function"?lA(n.extraReducers):[n.extraReducers],j={...E,...d.sliceCaseReducersByType};return w8(n.initialState,P=>{for(let D in j)P.addCase(D,j[D]);for(let D of d.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of k)P.addMatcher(D.matcher,D.reducer);A&&P.addDefaultCase(A)})}const p=E=>E,x=new Map,g=new WeakMap;let b;function _(E,k){return b||(b=f()),b(E,k)}function w(){return b||(b=f()),b.getInitialState()}function S(E,k=!1){function A(P){let D=P[E];return typeof D>"u"&&k&&(D=Wf(g,A,w)),D}function j(P=p){const D=Wf(x,k,()=>new WeakMap);return Wf(D,P,()=>{const L={};for(const[I,O]of Object.entries(n.selectors??{}))L[I]=T8(O,P,()=>Wf(g,P,w),k);return L})}return{reducerPath:E,getSelectors:j,get selectors(){return j(A)},selectSlice:A}}const T={name:a,reducer:_,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:w,...S(i),injectInto(E,{reducerPath:k,...A}={}){const j=k??i;return E.inject({reducerPath:j,reducer:_},A),{...T,...S(j,!0)}}};return T}}function T8(e,t,r,n){function a(i,...s){let l=t(i);return typeof l>"u"&&n&&(l=r()),e(l,...s)}return a.unwrapped=e,a}var ka=E8();function C8(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function k8({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!P8(n))throw new Error(Ea(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Va(e,s):Va(e))}function A8(e){return e._reducerDefinitionType==="asyncThunk"}function P8(e){return e._reducerDefinitionType==="reducerWithPrepare"}function j8({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Ea(18));const{payloadCreator:i,fulfilled:s,pending:l,rejected:d,settled:h,options:f}=r,p=a(e,i,f);n.exposeAction(t,p),s&&n.addCase(p.fulfilled,s),l&&n.addCase(p.pending,l),d&&n.addCase(p.rejected,d),h&&n.addMatcher(p.settled,h),n.exposeCaseReducer(t,{fulfilled:s||Hf,pending:l||Hf,rejected:d||Hf,settled:h||Hf})}function Hf(){}var O8="task",cA="listener",uA="completed",Ey="cancelled",D8=`task-${Ey}`,R8=`task-${uA}`,Jv=`${cA}-${Ey}`,I8=`${cA}-${uA}`,qh=class{constructor(e){this.code=e,this.message=`${O8} ${Ey} (reason: ${e})`}name="TaskAbortError";message},Ty=(e,t)=>{if(typeof e!="function")throw new TypeError(Ea(32))},M0=()=>{},dA=(e,t=M0)=>(e.catch(t),e),fA=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Lo=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Bo=e=>{if(e.aborted){const{reason:t}=e;throw new qh(t)}};function hA(e,t){let r=M0;return new Promise((n,a)=>{const i=()=>a(new qh(e.reason));if(e.aborted){i();return}r=fA(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=M0})}var F8=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof qh?"cancelled":"rejected",error:r}}finally{t?.()}},L0=e=>t=>dA(hA(e,t).then(r=>(Bo(e),r))),pA=e=>{const t=L0(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Yl}=Object,ON={},Qh="listenerMiddleware",M8=(e,t)=>{const r=n=>fA(e,()=>Lo(n,e.reason));return(n,a)=>{Ty(n);const i=new AbortController;r(i);const s=F8(async()=>{Bo(e),Bo(i.signal);const l=await n({pause:L0(i.signal),delay:pA(i.signal),signal:i.signal});return Bo(i.signal),l},()=>Lo(i,R8));return a?.autoJoin&&t.push(s.catch(M0)),{result:L0(e)(s),cancel(){Lo(i,D8)}}}},L8=(e,t)=>{const r=async(n,a)=>{Bo(t);let i=()=>{};const l=[new Promise((d,h)=>{let f=e({predicate:n,effect:(p,x)=>{x.unsubscribe(),d([p,x.getState(),x.getOriginalState()])}});i=()=>{f(),h()}})];a!=null&&l.push(new Promise(d=>setTimeout(d,a,null)));try{const d=await hA(t,Promise.race(l));return Bo(t),d}finally{i()}};return(n,a)=>dA(r(n,a))},mA=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Va(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Ea(21));return Ty(i),{predicate:a,type:t,effect:i}},xA=Yl(e=>{const{type:t,predicate:r,effect:n}=mA(e);return{id:_8(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ea(22))}}},{withTypes:()=>xA}),DN=(e,t)=>{const{type:r,effect:n,predicate:a}=mA(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},e1=e=>{e.pending.forEach(t=>{Lo(t,Jv)})},B8=(e,t)=>()=>{for(const r of t.keys())e1(r);e.clear()},RN=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},gA=Yl(Va(`${Qh}/add`),{withTypes:()=>gA}),$8=Va(`${Qh}/removeAll`),vA=Yl(Va(`${Qh}/remove`),{withTypes:()=>vA}),U8=(...e)=>{console.error(`${Qh}/error`,...e)},hd=(e={})=>{const t=new Map,r=new Map,n=g=>{const b=r.get(g)??0;r.set(g,b+1)},a=g=>{const b=r.get(g)??1;b===1?r.delete(g):r.set(g,b-1)},{extra:i,onError:s=U8}=e;Ty(s);const l=g=>(g.unsubscribe=()=>t.delete(g.id),t.set(g.id,g),b=>{g.unsubscribe(),b?.cancelActive&&e1(g)}),d=g=>{const b=DN(t,g)??xA(g);return l(b)};Yl(d,{withTypes:()=>d});const h=g=>{const b=DN(t,g);return b&&(b.unsubscribe(),g.cancelActive&&e1(b)),!!b};Yl(h,{withTypes:()=>h});const f=async(g,b,_,w)=>{const S=new AbortController,T=L8(d,S.signal),E=[];try{g.pending.add(S),n(g),await Promise.resolve(g.effect(b,Yl({},_,{getOriginalState:w,condition:(k,A)=>T(k,A).then(Boolean),take:T,delay:pA(S.signal),pause:L0(S.signal),extra:i,signal:S.signal,fork:M8(S.signal,E),unsubscribe:g.unsubscribe,subscribe:()=>{t.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((k,A,j)=>{k!==S&&(Lo(k,Jv),j.delete(k))})},cancel:()=>{Lo(S,Jv),g.pending.delete(S)},throwIfCancelled:()=>{Bo(S.signal)}})))}catch(k){k instanceof qh||RN(s,k,{raisedBy:"effect"})}finally{await Promise.all(E),Lo(S,I8),a(g),g.pending.delete(S)}},p=B8(t,r);return{middleware:g=>b=>_=>{if(!q4(_))return b(_);if(gA.match(_))return d(_.payload);if($8.match(_)){p();return}if(vA.match(_))return h(_.payload);let w=g.getState();const S=()=>{if(w===ON)throw new Error(Ea(23));return w};let T;try{if(T=b(_),t.size>0){const E=g.getState(),k=Array.from(t.values());for(const A of k){let j=!1;try{j=A.predicate(_,E,w)}catch(P){j=!1,RN(s,P,{raisedBy:"predicate"})}j&&f(A,_,g,S)}}}finally{w=ON}return T},startListening:d,stopListening:h,clearListeners:p}};function Ea(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var z8={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},yA=ka({name:"chartLayout",initialState:z8,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:W8,setLayout:H8,setChartSize:K8,setScale:V8}=yA.actions,G8=yA.reducer;function IN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(r),!0).forEach(function(n){Y8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y8(e,t,r){return(t=X8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X8(e){var t=q8(e,"string");return typeof t=="symbol"?t:t+""}function q8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var B0=Math.PI/180,Q8=e=>e*180/Math.PI,Ir=(e,t,r,n)=>({x:e+Math.cos(-B0*n)*r,y:t+Math.sin(-B0*n)*r}),wA=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Z8=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},J8=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=Z8({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var l=(r-a)/s,d=Math.acos(l);return n>i&&(d=2*Math.PI-d),{radius:s,angle:Q8(d),angleInRadian:d}},eL=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},tL=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},rL=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=J8({x:r,y:n},t),{innerRadius:s,outerRadius:l}=t;if(a<s||a>l||a===0)return null;var{startAngle:d,endAngle:h}=eL(t),f=i,p;if(d<=h){for(;f>h;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=h}else{for(;f>d;)f-=360;for(;f<h;)f+=360;p=f>=h&&f<=d}return p?FN(FN({},t),{},{radius:a,angle:tL(f,t)}):null};function bA(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function MN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MN(Object(r),!0).forEach(function(n){nL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nL(e,t,r){return(t=aL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aL(e){var t=iL(e,"string");return typeof t=="symbol"?t:t+""}function iL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function er(e,t,r){return fr(e)||fr(t)?r:Pi(t)?Ko(e,t,r):typeof t=="function"?t(e):r}var sL=(e,t,r,n,a)=>{var i,s=-1,l=(i=t?.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var d=0;d<l;d++){var h=d>0?r[d-1].coordinate:r[l-1].coordinate,f=r[d].coordinate,p=d>=l-1?r[0].coordinate:r[d+1].coordinate,x=void 0;if(tn(f-h)!==tn(p-f)){var g=[];if(tn(p-f)===tn(a[1]-a[0])){x=p;var b=f+a[1]-a[0];g[0]=Math.min(b,(b+h)/2),g[1]=Math.max(b,(b+h)/2)}else{x=h;var _=p+a[1]-a[0];g[0]=Math.min(f,(_+f)/2),g[1]=Math.max(f,(_+f)/2)}var w=[Math.min(f,(x+f)/2),Math.max(f,(x+f)/2)];if(e>w[0]&&e<=w[1]||e>=g[0]&&e<=g[1]){({index:s}=r[d]);break}}else{var S=Math.min(h,p),T=Math.max(h,p);if(e>(S+f)/2&&e<=(T+f)/2){({index:s}=r[d]);break}}}else if(t){for(var E=0;E<l;E++)if(E===0&&e<=(t[E].coordinate+t[E+1].coordinate)/2||E>0&&E<l-1&&e>(t[E].coordinate+t[E-1].coordinate)/2&&e<=(t[E].coordinate+t[E+1].coordinate)/2||E===l-1&&e>(t[E].coordinate+t[E-1].coordinate)/2){({index:s}=t[E]);break}}return s},oL=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:l}=t;if((l==="vertical"||l==="horizontal"&&s==="middle")&&i!=="center"&&pt(e[i]))return za(za({},e),{},{[i]:e[i]+(n||0)});if((l==="horizontal"||l==="vertical"&&i==="center")&&s!=="middle"&&pt(e[s]))return za(za({},e),{},{[s]:e[s]+(a||0)})}return e},lo=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",_A=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,i,s=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(i=!0),l.coordinate));return a||s.push(t),i||s.push(r),s},SA=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:l,isCategorical:d,categoricalDomain:h,tickCount:f,ticks:p,niceTicks:x,axisType:g}=e;if(!s)return null;var b=l==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,_=a==="category"&&s.bandwidth?s.bandwidth()/b:0;if(_=g==="angleAxis"&&i&&i.length>=2?tn(i[0]-i[1])*2*_:_,p||x){var w=(p||x||[]).map((S,T)=>{var E=n?n.indexOf(S):S;return{coordinate:s(E)+_,value:S,offset:_,index:T}});return w.filter(S=>!Ka(S.coordinate))}return d&&h?h.map((S,T)=>({coordinate:s(S)+_,value:S,index:T,offset:_})):s.ticks&&f!=null?s.ticks(f).map((S,T)=>({coordinate:s(S)+_,value:S,offset:_,index:T})):s.domain().map((S,T)=>({coordinate:s(S)+_,value:n?n[S]:S,index:T,offset:_}))},LN=1e-4,lL=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-LN,i=Math.max(n[0],n[1])+LN,s=e(t[0]),l=e(t[r-1]);(s<a||s>i||l<a||l>i)&&e.domain([t[0],t[r-1]])}},cL=(e,t)=>{if(!t||t.length!==2||!pt(t[0])||!pt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!pt(e[0])||e[0]<r)&&(a[0]=r),(!pt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},uL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var l=Ka(e[s][r][1])?e[s][r][0]:e[s][r][1];l>=0?(e[s][r][0]=a,e[s][r][1]=a+l,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+l,i=e[s][r][1])}},dL=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=Ka(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},fL={sign:uL,expand:BF,none:ic,silhouette:$F,wiggle:UF,positive:dL},hL=(e,t,r)=>{var n=fL[r],a=LF().keys(t).value((i,s)=>+er(i,s,0)).order(Kv).offset(n);return a(e)};function pL(e){return e==null?void 0:String(e)}function BN(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!fr(a[t.dataKey])){var l=O4(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var d=er(a,fr(s)?t.dataKey:s);return fr(d)?null:t.scale(d)}var $N=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var l=er(i,t.dataKey,t.scale.domain()[s]);return fr(l)?null:t.scale(l)-a/2+n},mL=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},xL=e=>{var t=e.flat(2).filter(pt);return[Math.min(...t),Math.max(...t)]},gL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],vL=(e,t,r)=>{if(e!=null)return gL(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,l=s.reduce((d,h)=>{var f=bA(h,t,r),p=xL(f);return[Math.min(d[0],p[0]),Math.max(d[1],p[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},UN=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zN=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Vu=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Vh(t,f=>f.coordinate),i=1/0,s=1,l=a.length;s<l;s++){var d=a[s],h=a[s-1];i=Math.min((d.coordinate||0)-(h.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function WN(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return za(za({},t),{},{dataKey:r,payload:n,value:a,name:i})}function vc(e,t){if(e)return String(e);if(typeof t=="string")return t}function yL(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?rL({x:e,y:t},n):null}var wL=(e,t,r,n)=>{var a=t.find(h=>h&&h.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return za(za(za({},n),Ir(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var l=a.coordinate,{angle:d}=n;return za(za(za({},n),Ir(n.cx,n.cy,l,d)),{},{angle:d,radius:l})}return{x:0,y:0}},bL=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,hs=e=>e.layout.width,ps=e=>e.layout.height,_L=e=>e.layout.scale,NA=e=>e.layout.margin,Zh=ke(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Jh=ke(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),EA="data-recharts-item-index",TA="data-recharts-item-data-key",pd=60;function HN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HN(Object(r),!0).forEach(function(n){SL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SL(e,t,r){return(t=NL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NL(e){var t=EL(e,"string");return typeof t=="symbol"?t:t+""}function EL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TL=e=>e.brush.height;function CL(e){var t=Jh(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:pd;return r+a}return r},0)}function kL(e){var t=Jh(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:pd;return r+a}return r},0)}function AL(e){var t=Zh(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function PL(e){var t=Zh(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Kr=ke([hs,ps,NA,TL,CL,kL,AL,PL,G4,XM],(e,t,r,n,a,i,s,l,d,h)=>{var f={left:(r.left||0)+a,right:(r.right||0)+i},p={top:(r.top||0)+s,bottom:(r.bottom||0)+l},x=Kf(Kf({},p),f),g=x.bottom;x.bottom+=n,x=oL(x,d,h);var b=e-x.left-x.right,_=t-x.top-x.bottom;return Kf(Kf({brushBottom:g},x),{},{width:Math.max(b,0),height:Math.max(_,0)})}),jL=ke(Kr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Cy=ke(hs,ps,(e,t)=>({x:0,y:0,width:e,height:t})),OL=v.createContext(null),Vn=()=>v.useContext(OL)!=null,ep=e=>e.brush,tp=ke([ep,Kr,NA],(e,t,r)=>({height:e.height,x:pt(e.x)?e.x:t.left,y:pt(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:pt(e.width)?e.width:t.width})),Eg={},Tg={},Cg={},KN;function DL(){return KN||(KN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,l=null;const d=i!=null&&i.includes("leading"),h=i==null||i.includes("trailing"),f=()=>{l!==null&&(r.apply(s,l),s=void 0,l=null)},p=()=>{h&&f(),_()};let x=null;const g=()=>{x!=null&&clearTimeout(x),x=setTimeout(()=>{x=null,p()},n)},b=()=>{x!==null&&(clearTimeout(x),x=null)},_=()=>{b(),s=void 0,l=null},w=()=>{f()},S=function(...T){if(a?.aborted)return;s=this,l=T;const E=x==null;g(),d&&E&&f()};return S.schedule=g,S.cancel=_,S.flush=w,a?.addEventListener("abort",_,{once:!0}),S}e.debounce=t})(Cg)),Cg}var VN;function RL(){return VN||(VN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DL();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:l=!0,maxWait:d}=i,h=Array(2);s&&(h[0]="leading"),l&&(h[1]="trailing");let f,p=null;const x=t.debounce(function(..._){f=n.apply(this,_),p=null},a,{edges:h}),g=function(..._){return d!=null&&(p===null&&(p=Date.now()),Date.now()-p>=d)?(f=n.apply(this,_),p=Date.now(),x.cancel(),x.schedule(),f):(x.apply(this,_),f)},b=()=>(x.flush(),f);return g.cancel=x.cancel,g.flush=b,g}e.debounce=r})(Tg)),Tg}var GN;function IL(){return GN||(GN=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RL();function r(n,a=0,i={}){const{leading:s=!0,trailing:l=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:l})}e.throttle=r})(Eg)),Eg}var kg,YN;function FL(){return YN||(YN=1,kg=IL().throttle),kg}var ML=FL();const LL=fs(ML);var $0=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},CA=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,l=is(n)?e:Number(n),d=is(a)?t:Number(a);return i&&i>0&&(l?d=l/i:d&&(l=d*i),s&&d>s&&(d=s)),{calculatedWidth:l,calculatedHeight:d}},BL={width:0,height:0,overflow:"visible"},$L={width:0,overflowX:"visible"},UL={height:0,overflowY:"visible"},zL={},WL=e=>{var{width:t,height:r}=e,n=is(t),a=is(r);return n&&a?BL:n?$L:a?UL:zL};function HL(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function jn(e){return Number.isFinite(e)}function sc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function t1(){return t1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t1.apply(null,arguments)}function XN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XN(Object(r),!0).forEach(function(n){KL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KL(e,t,r){return(t=VL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VL(e){var t=GL(e,"string");return typeof t=="symbol"?t:t+""}function GL(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kA=v.createContext({width:-1,height:-1});function AA(e){var{children:t,width:r,height:n}=e,a=v.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:v.createElement(kA.Provider,{value:a},t)}var ky=()=>v.useContext(kA),YL=v.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:l,maxHeight:d,children:h,debounce:f=0,id:p,className:x,onResize:g,style:b={}}=e,_=v.useRef(null),w=v.useRef();w.current=g,v.useImperativeHandle(t,()=>_.current);var[S,T]=v.useState({containerWidth:n.width,containerHeight:n.height}),E=v.useCallback((D,L)=>{T(I=>{var O=Math.round(D),M=Math.round(L);return I.containerWidth===O&&I.containerHeight===M?I:{containerWidth:O,containerHeight:M}})},[]);v.useEffect(()=>{var D=M=>{var re,{width:oe,height:ee}=M[0].contentRect;E(oe,ee),(re=w.current)===null||re===void 0||re.call(w,oe,ee)};f>0&&(D=LL(D,f,{trailing:!0,leading:!1}));var L=new ResizeObserver(D),{width:I,height:O}=_.current.getBoundingClientRect();return E(I,O),L.observe(_.current),()=>{L.disconnect()}},[E,f]);var{containerWidth:k,containerHeight:A}=S;$0(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:P}=CA(k,A,{width:a,height:i,aspect:r,maxHeight:d});return $0(j>0||P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,P,a,i,s,l,r),v.createElement("div",{id:p?"".concat(p):void 0,className:$t("recharts-responsive-container",x),style:qN(qN({},b),{},{width:a,height:i,minWidth:s,minHeight:l,maxHeight:d}),ref:_},v.createElement("div",{style:WL({width:a,height:i})},v.createElement(AA,{width:j,height:P},h)))}),Ag=v.forwardRef((e,t)=>{var r=ky();if(sc(r.width)&&sc(r.height))return e.children;var{width:n,height:a}=HL({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=CA(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return pt(i)&&pt(s)?v.createElement(AA,{width:i,height:s},e.children):v.createElement(YL,t1({},e,{width:n,height:a,ref:t}))}),rp=()=>{var e,t=Vn(),r=ft(jL),n=ft(tp),a=(e=ft(ep))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},XL={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},PA=()=>{var e;return(e=ft(Kr))!==null&&e!==void 0?e:XL},jA=()=>ft(hs),OA=()=>ft(ps),jt=e=>e.layout.layoutType,np=()=>ft(jt),ap=e=>{var t=_r(),r=Vn(),{width:n,height:a}=e,i=ky(),s=n,l=a;return i&&(s=i.width>0?i.width:n,l=i.height>0?i.height:a),v.useEffect(()=>{!r&&sc(s)&&sc(l)&&t(K8({width:s,height:l}))},[t,r,s,l]),null},qL={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},DA=ka({name:"legend",initialState:qL,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:$n()},removeLegendPayload:{reducer(e,t){var r=es(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:$n()}}}),{setLegendSize:Xoe,setLegendSettings:qoe,addLegendPayload:RA,removeLegendPayload:IA}=DA.actions,QL=DA.reducer;function r1(){return r1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r1.apply(null,arguments)}function QN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QN(Object(r),!0).forEach(function(n){ZL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZL(e,t,r){return(t=JL(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JL(e){var t=e7(e,"string");return typeof t=="symbol"?t:t+""}function e7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function t7(e){return Array.isArray(e)&&Pi(e[0])&&Pi(e[1])?e.join(" ~ "):e}var r7=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:l,wrapperClassName:d,labelClassName:h,label:f,labelFormatter:p,accessibilityLayer:x=!1}=e,g=()=>{if(i&&i.length){var A={padding:0,margin:0},j=(l?Vh(i,l):i).map((P,D)=>{if(P.type==="none")return null;var L=P.formatter||s||t7,{value:I,name:O}=P,M=I,re=O;if(L){var oe=L(I,O,P,D,i);if(Array.isArray(oe))[M,re]=oe;else if(oe!=null)M=oe;else return null}var ee=Pg({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},n);return v.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:ee},Pi(re)?v.createElement("span",{className:"recharts-tooltip-item-name"},re):null,Pi(re)?v.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,v.createElement("span",{className:"recharts-tooltip-item-value"},M),v.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return v.createElement("ul",{className:"recharts-tooltip-item-list",style:A},j)}return null},b=Pg({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),_=Pg({margin:0},a),w=!fr(f),S=w?f:"",T=$t("recharts-default-tooltip",d),E=$t("recharts-tooltip-label",h);w&&p&&i!==void 0&&i!==null&&(S=p(f,i));var k=x?{role:"status","aria-live":"assertive"}:{};return v.createElement("div",r1({className:T,style:b},k),v.createElement("p",{className:E,style:_},v.isValidElement(S)?S:"".concat(S)),g())},xu="recharts-tooltip-wrapper",n7={visibility:"hidden"};function a7(e){var{coordinate:t,translateX:r,translateY:n}=e;return $t(xu,{["".concat(xu,"-right")]:pt(r)&&t&&pt(t.x)&&r>=t.x,["".concat(xu,"-left")]:pt(r)&&t&&pt(t.x)&&r<t.x,["".concat(xu,"-bottom")]:pt(n)&&t&&pt(t.y)&&n>=t.y,["".concat(xu,"-top")]:pt(n)&&t&&pt(t.y)&&n<t.y})}function ZN(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:l,viewBox:d,viewBoxDimension:h}=e;if(i&&pt(i[n]))return i[n];var f=r[n]-l-(a>0?a:0),p=r[n]+a;if(t[n])return s[n]?f:p;var x=d[n];if(x==null)return 0;if(s[n]){var g=f,b=x;return g<b?Math.max(p,x):Math.max(f,x)}if(h==null)return 0;var _=p+l,w=x+h;return _>w?Math.max(f,x):Math.max(p,x)}function i7(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function s7(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:l,viewBox:d}=e,h,f,p;return s.height>0&&s.width>0&&r?(f=ZN({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:d,viewBoxDimension:d.width}),p=ZN({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:d,viewBoxDimension:d.height}),h=i7({translateX:f,translateY:p,useTranslate3d:l})):h=n7,{cssProperties:h,cssClasses:a7({translateX:f,translateY:p,coordinate:r})}}function JN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JN(Object(r),!0).forEach(function(n){n1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n1(e,t,r){return(t=o7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o7(e){var t=l7(e,"string");return typeof t=="symbol"?t:t+""}function l7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class c7 extends v.PureComponent{constructor(){super(...arguments),n1(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),n1(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:l,isAnimationActive:d,offset:h,position:f,reverseDirection:p,useTranslate3d:x,viewBox:g,wrapperStyle:b,lastBoundingBox:_,innerRef:w,hasPortalFromProps:S}=this.props,{cssClasses:T,cssProperties:E}=s7({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:h,position:f,reverseDirection:p,tooltipBox:{height:_.height,width:_.width},useTranslate3d:x,viewBox:g}),k=S?{}:Vf(Vf({transition:d&&t?"transform ".concat(n,"ms ").concat(a):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=Vf(Vf({},k),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},b);return v.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:A,ref:w},i)}}var u7=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),co={devToolsEnabled:!1,isSsr:u7()},FA=()=>ft(e=>e.rootProps.accessibilityLayer);function a1(){return a1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a1.apply(null,arguments)}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){d7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d7(e,t,r){return(t=f7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f7(e){var t=h7(e,"string");return typeof t=="symbol"?t:t+""}function h7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rE={curveBasisClosed:CF,curveBasisOpen:kF,curveBasis:TF,curveBumpX:fF,curveBumpY:hF,curveLinearClosed:AF,curveLinear:Wh,curveMonotoneX:PF,curveMonotoneY:jF,curveNatural:OF,curveStep:DF,curveStepAfter:IF,curveStepBefore:RF},Gf=e=>jn(e.x)&&jn(e.y),gu=e=>e.x,vu=e=>e.y,p7=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(dd(e));return(r==="curveMonotone"||r==="curveBump")&&t?rE["".concat(r).concat(t==="vertical"?"Y":"X")]:rE[r]||Wh},m7=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=p7(t,a),l=i?r.filter(Gf):r,d;if(Array.isArray(n)){var h=i?n.filter(p=>Gf(p)):n,f=l.map((p,x)=>tE(tE({},p),{},{base:h[x]}));return a==="vertical"?d=Bf().y(vu).x1(gu).x0(p=>p.base.x):d=Bf().x(gu).y1(vu).y0(p=>p.base.y),d.defined(Gf).curve(s),d(f)}return a==="vertical"&&pt(n)?d=Bf().y(vu).x1(gu).x0(n):pt(n)?d=Bf().x(gu).y1(vu).y0(n):d=y4().x(gu).y(vu),d.defined(Gf).curve(s),d(l)},Ay=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?m7(e):n;return v.createElement("path",a1({},Ta(e),yy(e),{className:$t("recharts-curve",t),d:i===null?void 0:i,ref:a}))},x7=["x","y","top","left","width","height","className"];function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(null,arguments)}function nE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function g7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nE(Object(r),!0).forEach(function(n){v7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v7(e,t,r){return(t=y7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y7(e){var t=w7(e,"string");return typeof t=="symbol"?t:t+""}function w7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function b7(e,t){if(e==null)return{};var r,n,a=_7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var S7=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),N7=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:l}=e,d=b7(e,x7),h=g7({x:t,y:r,top:n,left:a,width:i,height:s},d);return!pt(t)||!pt(r)||!pt(i)||!pt(s)||!pt(n)||!pt(a)?null:v.createElement("path",i1({},Kn(h),{className:$t("recharts-cross",l),d:S7(t,r,i,s,n,a)}))};function E7(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function aE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aE(Object(r),!0).forEach(function(n){C7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C7(e,t,r){return(t=k7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k7(e){var t=A7(e,"string");return typeof t=="symbol"?t:t+""}function A7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mn(e,t){var r=T7({},e),n=t,a=Object.keys(t),i=a.reduce((s,l)=>(s[l]===void 0&&n[l]!==void 0&&(s[l]=n[l]),s),r);return i}function P7(){}function j7(e){return e!=null}function iE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iE(Object(r),!0).forEach(function(n){O7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O7(e,t,r){return(t=D7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D7(e){var t=R7(e,"string");return typeof t=="symbol"?t:t+""}function R7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I7=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),MA=(e,t,r)=>e.map(n=>"".concat(I7(n)," ").concat(t,"ms ").concat(r)).join(","),F7=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Gu=(e,t)=>Object.keys(t).reduce((r,n)=>sE(sE({},r),{},{[n]:e(n,t[n])}),{});function oE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oE(Object(r),!0).forEach(function(n){M7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M7(e,t,r){return(t=L7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L7(e){var t=B7(e,"string");return typeof t=="symbol"?t:t+""}function B7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U0=(e,t,r)=>e+(t-e)*r,s1=e=>{var{from:t,to:r}=e;return t!==r},LA=(e,t,r)=>{var n=Gu((a,i)=>{if(s1(i)){var[s,l]=e(i.from,i.to,i.velocity);return cn(cn({},i),{},{from:s,velocity:l})}return i},t);return r<1?Gu((a,i)=>s1(i)?cn(cn({},i),{},{velocity:U0(i.velocity,n[a].velocity,r),from:U0(i.from,n[a].from,r)}):i,t):LA(e,n,r-1)};function $7(e,t,r,n,a,i){var s,l=n.reduce((x,g)=>cn(cn({},x),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),d=()=>Gu((x,g)=>g.from,l),h=()=>!Object.values(l).filter(s1).length,f=null,p=x=>{s||(s=x);var g=x-s,b=g/r.dt;l=LA(r,l,b),a(cn(cn(cn({},e),t),d())),s=x,h()||(f=i.setTimeout(p))};return()=>(f=i.setTimeout(p),()=>{f()})}function U7(e,t,r,n,a,i,s){var l=null,d=a.reduce((p,x)=>cn(cn({},p),{},{[x]:[e[x],t[x]]}),{}),h,f=p=>{h||(h=p);var x=(p-h)/n,g=Gu((_,w)=>U0(...w,r(x)),d);if(i(cn(cn(cn({},e),t),g)),x<1)l=s.setTimeout(f);else{var b=Gu((_,w)=>U0(...w,r(1)),d);i(cn(cn(cn({},e),t),b))}};return()=>(l=s.setTimeout(f),()=>{l()})}const z7=(e,t,r,n,a,i)=>{var s=F7(e,t);return r.isStepper===!0?$7(e,t,r,s,a,i):U7(e,t,r,n,s,a,i)};var z0=1e-4,BA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],$A=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),lE=(e,t)=>r=>{var n=BA(e,t);return $A(n,r)},W7=(e,t)=>r=>{var n=BA(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return $A(a,r)},cE=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var d=s[0].split("(");d[0]==="cubic-bezier"&&d[1].split(")")[0].split(",").length===4&&([t,n,r,a]=d[1].split(")")[0].split(",").map(b=>parseFloat(b)))}}else s.length===4&&([t,n,r,a]=s);var h=lE(t,r),f=lE(n,a),p=W7(t,r),x=b=>b>1?1:b<0?0:b,g=b=>{for(var _=b>1?1:b,w=_,S=0;S<8;++S){var T=h(w)-_,E=p(w);if(Math.abs(T-_)<z0||E<z0)return f(w);w=x(w-T/E)}return f(w)};return g.isStepper=!1,g},H7=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,l,d)=>{var h=-(s-l)*r,f=d*n,p=d+(h-f)*a/1e3,x=d*a/1e3+s;return Math.abs(x-l)<z0&&Math.abs(p)<z0?[l,0]:[x,p]};return i.isStepper=!0,i.dt=a,i},K7=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return cE(e);case"spring":return H7();default:if(e.split("(")[0]==="cubic-bezier")return cE(e)}return typeof e=="function"?e:null};function V7(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var l=s,[d,...h]=l;if(typeof d=="number"){a=e.setTimeout(i.bind(null,h),d);return}i(d),a=e.setTimeout(i.bind(null,h));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class G7{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function Y7(){return V7(new G7)}var X7=v.createContext(Y7);function q7(e,t){var r=v.useContext(X7);return v.useMemo(()=>t??r(e),[e,t,r])}var Q7={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},uE={t:0},jg={t:1};function md(e){var t=mn(e,Q7),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:l,onAnimationStart:d,children:h}=t,f=q7(t.animationId,t.animationManager),[p,x]=v.useState(r?uE:jg),g=v.useRef(null);return v.useEffect(()=>{r||x(jg)},[r]),v.useEffect(()=>{if(!r||!n)return P7;var b=z7(uE,jg,K7(i),a,x,f.getTimeoutController()),_=()=>{g.current=b()};return f.start([d,s,_,a,l]),()=>{f.stop(),g.current&&g.current(),l()}},[r,n,a,i,s,d,l,f]),h(p.t)}function xd(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=v.useRef(zu(t)),n=v.useRef(e);return n.current!==e&&(r.current=zu(t),n.current=e),r.current}var Z7=["radius"],J7=["radius"];function dE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dE(Object(r),!0).forEach(function(n){e9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e9(e,t,r){return(t=t9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t9(e){var t=r9(e,"string");return typeof t=="symbol"?t:t+""}function r9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W0.apply(null,arguments)}function hE(e,t){if(e==null)return{};var r,n,a=n9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function n9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pE=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,l=r>=0?1:-1,d=n>=0&&r>=0||n<0&&r<0?1:0,h;if(i>0&&a instanceof Array){for(var f=[0,0,0,0],p=0,x=4;p<x;p++)f[p]=a[p]>i?i:a[p];h="M".concat(e,",").concat(t+s*f[0]),f[0]>0&&(h+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(e+l*f[0],",").concat(t)),h+="L ".concat(e+r-l*f[1],",").concat(t),f[1]>0&&(h+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(e+r,",").concat(t+s*f[1])),h+="L ".concat(e+r,",").concat(t+n-s*f[2]),f[2]>0&&(h+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(e+r-l*f[2],",").concat(t+n)),h+="L ".concat(e+l*f[3],",").concat(t+n),f[3]>0&&(h+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(e,",").concat(t+n-s*f[3])),h+="Z"}else if(i>0&&a===+a&&a>0){var g=Math.min(i,a);h="M ".concat(e,",").concat(t+s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+l*g,",").concat(t,`
            L `).concat(e+r-l*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+r,",").concat(t+s*g,`
            L `).concat(e+r,",").concat(t+n-s*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+r-l*g,",").concat(t+n,`
            L `).concat(e+l*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e,",").concat(t+n-s*g," Z")}else h="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return h},a9={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},UA=e=>{var t=mn(e,a9),r=v.useRef(null),[n,a]=v.useState(-1);v.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var J=r.current.getTotalLength();J&&a(J)}catch{}},[]);var{x:i,y:s,width:l,height:d,radius:h,className:f}=t,{animationEasing:p,animationDuration:x,animationBegin:g,isAnimationActive:b,isUpdateAnimationActive:_}=t,w=v.useRef(l),S=v.useRef(d),T=v.useRef(i),E=v.useRef(s),k=v.useMemo(()=>({x:i,y:s,width:l,height:d,radius:h}),[i,s,l,d,h]),A=xd(k,"rectangle-");if(i!==+i||s!==+s||l!==+l||d!==+d||l===0||d===0)return null;var j=$t("recharts-rectangle",f);if(!_){var P=Kn(t),{radius:D}=P,L=hE(P,Z7);return v.createElement("path",W0({},L,{radius:typeof h=="number"?h:void 0,className:j,d:pE(i,s,l,d,h)}))}var I=w.current,O=S.current,M=T.current,re=E.current,oe="0px ".concat(n===-1?1:n,"px"),ee="".concat(n,"px 0px"),fe=MA(["strokeDasharray"],x,typeof p=="string"?p:void 0);return v.createElement(md,{animationId:A,key:A,canBegin:n>0,duration:x,easing:p,isActive:_,begin:g},J=>{var ie=br(I,l,J),Q=br(O,d,J),te=br(M,i,J),H=br(re,s,J);r.current&&(w.current=ie,S.current=Q,T.current=te,E.current=H);var se;b?J>0?se={transition:fe,strokeDasharray:ee}:se={strokeDasharray:oe}:se={strokeDasharray:ee};var Y=Kn(t),{radius:ce}=Y,ue=hE(Y,J7);return v.createElement("path",W0({},ue,{radius:typeof h=="number"?h:void 0,className:j,d:pE(te,H,ie,Q,h),ref:r,style:fE(fE({},se),t.style)}))})};function zA(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Ir(t,r,n,a),l=Ir(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o1.apply(null,arguments)}var i9=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Yf=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:l,cornerIsExternal:d}=e,h=l*(s?1:-1)+n,f=Math.asin(l/h)/B0,p=d?a:a+i*f,x=Ir(t,r,h,p),g=Ir(t,r,n,p),b=d?a-i*f:a,_=Ir(t,r,h*Math.cos(f*B0),b);return{center:x,circleTangency:g,lineTangency:_,theta:f}},WA=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,l=i9(i,s),d=i+l,h=Ir(t,r,a,i),f=Ir(t,r,a,d),p="M ".concat(h.x,",").concat(h.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(i>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(n>0){var x=Ir(t,r,n,i),g=Ir(t,r,n,d);p+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(i<=d),`,
            `).concat(x.x,",").concat(x.y," Z")}else p+="L ".concat(t,",").concat(r," Z");return p},s9=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:d,endAngle:h}=e,f=tn(h-d),{circleTangency:p,lineTangency:x,theta:g}=Yf({cx:t,cy:r,radius:a,angle:d,sign:f,cornerRadius:i,cornerIsExternal:l}),{circleTangency:b,lineTangency:_,theta:w}=Yf({cx:t,cy:r,radius:a,angle:h,sign:-f,cornerRadius:i,cornerIsExternal:l}),S=l?Math.abs(d-h):Math.abs(d-h)-g-w;if(S<0)return s?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):WA({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:d,endAngle:h});var T="M ".concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(S>180),",").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(_.x,",").concat(_.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:k,theta:A}=Yf({cx:t,cy:r,radius:n,angle:d,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),{circleTangency:j,lineTangency:P,theta:D}=Yf({cx:t,cy:r,radius:n,angle:h,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:l}),L=l?Math.abs(d-h):Math.abs(d-h)-A-D;if(L<0&&i===0)return"".concat(T,"L").concat(t,",").concat(r,"Z");T+="L".concat(P.x,",").concat(P.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(j.x,",").concat(j.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(L>180),",").concat(+(f>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(k.x,",").concat(k.y,"Z")}else T+="L".concat(t,",").concat(r,"Z");return T},o9={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},HA=e=>{var t=mn(e,o9),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:l,cornerIsExternal:d,startAngle:h,endAngle:f,className:p}=t;if(i<a||h===f)return null;var x=$t("recharts-sector",p),g=i-a,b=kn(s,g,0,!0),_;return b>0&&Math.abs(h-f)<360?_=s9({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(b,g/2),forceCornerRadius:l,cornerIsExternal:d,startAngle:h,endAngle:f}):_=WA({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:h,endAngle:f}),v.createElement("path",o1({},Kn(t),{className:x,d:_}))};function l9(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:l,cy:d,innerRadius:h,outerRadius:f,angle:p}=t,x=Ir(l,d,h,p),g=Ir(l,d,f,p);n=x.x,a=x.y,i=g.x,s=g.y}else return zA(t);return[{x:n,y:a},{x:i,y:s}]}var Og={},Dg={},Rg={},mE;function c9(){return mE||(mE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=K4();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Rg)),Rg}var xE;function u9(){return xE||(xE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c9();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Dg)),Dg}var gE;function d9(){return gE||(gE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V4(),r=u9();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const l=Math.max(Math.ceil((i-a)/(s||1)),0),d=new Array(l);for(let h=0;h<l;h++)d[h]=a,a+=s;return d}e.range=n})(Og)),Og}var Ig,vE;function f9(){return vE||(vE=1,Ig=d9().range),Ig}var h9=f9();const KA=fs(h9);function Ys(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function p9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Py(e){let t,r,n;e.length!==2?(t=Ys,r=(l,d)=>Ys(e(l),d),n=(l,d)=>e(l)-d):(t=e===Ys||e===p9?e:m9,r=e,n=e);function a(l,d,h=0,f=l.length){if(h<f){if(t(d,d)!==0)return f;do{const p=h+f>>>1;r(l[p],d)<0?h=p+1:f=p}while(h<f)}return h}function i(l,d,h=0,f=l.length){if(h<f){if(t(d,d)!==0)return f;do{const p=h+f>>>1;r(l[p],d)<=0?h=p+1:f=p}while(h<f)}return h}function s(l,d,h=0,f=l.length){const p=a(l,d,h,f-1);return p>h&&n(l[p-1],d)>-n(l[p],d)?p-1:p}return{left:a,center:s,right:i}}function m9(){return 0}function VA(e){return e===null?NaN:+e}function*x9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const g9=Py(Ys),gd=g9.right;Py(VA).center;class yE extends Map{constructor(t,r=w9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(wE(this,t))}has(t){return super.has(wE(this,t))}set(t,r){return super.set(v9(this,t),r)}delete(t){return super.delete(y9(this,t))}}function wE({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function v9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function y9({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function w9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function b9(e=Ys){if(e===Ys)return GA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function GA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const _9=Math.sqrt(50),S9=Math.sqrt(10),N9=Math.sqrt(2);function H0(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=_9?10:i>=S9?5:i>=N9?2:1;let l,d,h;return a<0?(h=Math.pow(10,-a)/s,l=Math.round(e*h),d=Math.round(t*h),l/h<e&&++l,d/h>t&&--d,h=-h):(h=Math.pow(10,a)*s,l=Math.round(e/h),d=Math.round(t/h),l*h<e&&++l,d*h>t&&--d),d<l&&.5<=r&&r<2?H0(e,t,r*2):[l,d,h]}function l1(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?H0(t,e,r):H0(e,t,r);if(!(i>=a))return[];const l=i-a+1,d=new Array(l);if(n)if(s<0)for(let h=0;h<l;++h)d[h]=(i-h)/-s;else for(let h=0;h<l;++h)d[h]=(i-h)*s;else if(s<0)for(let h=0;h<l;++h)d[h]=(a+h)/-s;else for(let h=0;h<l;++h)d[h]=(a+h)*s;return d}function c1(e,t,r){return t=+t,e=+e,r=+r,H0(e,t,r)[2]}function u1(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?c1(t,e,r):c1(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function bE(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function _E(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function YA(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?GA:b9(a);n>r;){if(n-r>600){const d=n-r+1,h=t-r+1,f=Math.log(d),p=.5*Math.exp(2*f/3),x=.5*Math.sqrt(f*p*(d-p)/d)*(h-d/2<0?-1:1),g=Math.max(r,Math.floor(t-h*p/d+x)),b=Math.min(n,Math.floor(t+(d-h)*p/d+x));YA(e,t,g,b,a)}const i=e[t];let s=r,l=n;for(yu(e,r,t),a(e[n],i)>0&&yu(e,r,n);s<l;){for(yu(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?yu(e,r,l):(++l,yu(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function yu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function E9(e,t,r){if(e=Float64Array.from(x9(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return _E(e);if(t>=1)return bE(e);var n,a=(n-1)*t,i=Math.floor(a),s=bE(YA(e,i).subarray(0,i+1)),l=_E(e.subarray(i+1));return s+(l-s)*(a-i)}}function T9(e,t,r=VA){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function C9(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Ya(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ms(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const d1=Symbol("implicit");function jy(){var e=new yE,t=[],r=[],n=d1;function a(i){let s=e.get(i);if(s===void 0){if(n!==d1)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new yE;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return jy(t,r).unknown(n)},Ya.apply(a,arguments),a}function Oy(){var e=jy().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,d=0,h=0,f=.5;delete e.unknown;function p(){var x=t().length,g=a<n,b=g?a:n,_=g?n:a;i=(_-b)/Math.max(1,x-d+h*2),l&&(i=Math.floor(i)),b+=(_-b-i*(x-d))*f,s=i*(1-d),l&&(b=Math.round(b),s=Math.round(s));var w=C9(x).map(function(S){return b+i*S});return r(g?w.reverse():w)}return e.domain=function(x){return arguments.length?(t(x),p()):t()},e.range=function(x){return arguments.length?([n,a]=x,n=+n,a=+a,p()):[n,a]},e.rangeRound=function(x){return[n,a]=x,n=+n,a=+a,l=!0,p()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(x){return arguments.length?(l=!!x,p()):l},e.padding=function(x){return arguments.length?(d=Math.min(1,h=+x),p()):d},e.paddingInner=function(x){return arguments.length?(d=Math.min(1,x),p()):d},e.paddingOuter=function(x){return arguments.length?(h=+x,p()):h},e.align=function(x){return arguments.length?(f=Math.max(0,Math.min(1,x)),p()):f},e.copy=function(){return Oy(t(),[n,a]).round(l).paddingInner(d).paddingOuter(h).align(f)},Ya.apply(p(),arguments)}function XA(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return XA(t())},e}function k9(){return XA(Oy.apply(null,arguments).paddingInner(1))}function Dy(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function qA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function vd(){}var Yu=.7,K0=1/Yu,Xl="\\s*([+-]?\\d+)\\s*",Xu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ti="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",A9=/^#([0-9a-f]{3,8})$/,P9=new RegExp(`^rgb\\(${Xl},${Xl},${Xl}\\)$`),j9=new RegExp(`^rgb\\(${Ti},${Ti},${Ti}\\)$`),O9=new RegExp(`^rgba\\(${Xl},${Xl},${Xl},${Xu}\\)$`),D9=new RegExp(`^rgba\\(${Ti},${Ti},${Ti},${Xu}\\)$`),R9=new RegExp(`^hsl\\(${Xu},${Ti},${Ti}\\)$`),I9=new RegExp(`^hsla\\(${Xu},${Ti},${Ti},${Xu}\\)$`),SE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Dy(vd,qu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:NE,formatHex:NE,formatHex8:F9,formatHsl:M9,formatRgb:EE,toString:EE});function NE(){return this.rgb().formatHex()}function F9(){return this.rgb().formatHex8()}function M9(){return QA(this).formatHsl()}function EE(){return this.rgb().formatRgb()}function qu(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=A9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?TE(t):r===3?new la(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Xf(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Xf(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=P9.exec(e))?new la(t[1],t[2],t[3],1):(t=j9.exec(e))?new la(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=O9.exec(e))?Xf(t[1],t[2],t[3],t[4]):(t=D9.exec(e))?Xf(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=R9.exec(e))?AE(t[1],t[2]/100,t[3]/100,1):(t=I9.exec(e))?AE(t[1],t[2]/100,t[3]/100,t[4]):SE.hasOwnProperty(e)?TE(SE[e]):e==="transparent"?new la(NaN,NaN,NaN,0):null}function TE(e){return new la(e>>16&255,e>>8&255,e&255,1)}function Xf(e,t,r,n){return n<=0&&(e=t=r=NaN),new la(e,t,r,n)}function L9(e){return e instanceof vd||(e=qu(e)),e?(e=e.rgb(),new la(e.r,e.g,e.b,e.opacity)):new la}function f1(e,t,r,n){return arguments.length===1?L9(e):new la(e,t,r,n??1)}function la(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Dy(la,f1,qA(vd,{brighter(e){return e=e==null?K0:Math.pow(K0,e),new la(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yu:Math.pow(Yu,e),new la(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new la($o(this.r),$o(this.g),$o(this.b),V0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:CE,formatHex:CE,formatHex8:B9,formatRgb:kE,toString:kE}));function CE(){return`#${Io(this.r)}${Io(this.g)}${Io(this.b)}`}function B9(){return`#${Io(this.r)}${Io(this.g)}${Io(this.b)}${Io((isNaN(this.opacity)?1:this.opacity)*255)}`}function kE(){const e=V0(this.opacity);return`${e===1?"rgb(":"rgba("}${$o(this.r)}, ${$o(this.g)}, ${$o(this.b)}${e===1?")":`, ${e})`}`}function V0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $o(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Io(e){return e=$o(e),(e<16?"0":"")+e.toString(16)}function AE(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ii(e,t,r,n)}function QA(e){if(e instanceof ii)return new ii(e.h,e.s,e.l,e.opacity);if(e instanceof vd||(e=qu(e)),!e)return new ii;if(e instanceof ii)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,d=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=d<.5?i+a:2-i-a,s*=60):l=d>0&&d<1?0:s,new ii(s,l,d,e.opacity)}function $9(e,t,r,n){return arguments.length===1?QA(e):new ii(e,t,r,n??1)}function ii(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Dy(ii,$9,qA(vd,{brighter(e){return e=e==null?K0:Math.pow(K0,e),new ii(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yu:Math.pow(Yu,e),new ii(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new la(Fg(e>=240?e-240:e+120,a,n),Fg(e,a,n),Fg(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ii(PE(this.h),qf(this.s),qf(this.l),V0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=V0(this.opacity);return`${e===1?"hsl(":"hsla("}${PE(this.h)}, ${qf(this.s)*100}%, ${qf(this.l)*100}%${e===1?")":`, ${e})`}`}}));function PE(e){return e=(e||0)%360,e<0?e+360:e}function qf(e){return Math.max(0,Math.min(1,e||0))}function Fg(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Ry=e=>()=>e;function U9(e,t){return function(r){return e+r*t}}function z9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function W9(e){return(e=+e)==1?ZA:function(t,r){return r-t?z9(t,r,e):Ry(isNaN(t)?r:t)}}function ZA(e,t){var r=t-e;return r?U9(e,r):Ry(isNaN(e)?t:e)}const jE=(function e(t){var r=W9(t);function n(a,i){var s=r((a=f1(a)).r,(i=f1(i)).r),l=r(a.g,i.g),d=r(a.b,i.b),h=ZA(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=l(f),a.b=d(f),a.opacity=h(f),a+""}}return n.gamma=e,n})(1);function H9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function K9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function V9(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=yc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function G9(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function G0(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Y9(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=yc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var h1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mg=new RegExp(h1.source,"g");function X9(e){return function(){return e}}function q9(e){return function(t){return e(t)+""}}function Q9(e,t){var r=h1.lastIndex=Mg.lastIndex=0,n,a,i,s=-1,l=[],d=[];for(e=e+"",t=t+"";(n=h1.exec(e))&&(a=Mg.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,d.push({i:s,x:G0(n,a)})),r=Mg.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?d[0]?q9(d[0].x):X9(t):(t=d.length,function(h){for(var f=0,p;f<t;++f)l[(p=d[f]).i]=p.x(h);return l.join("")})}function yc(e,t){var r=typeof t,n;return t==null||r==="boolean"?Ry(t):(r==="number"?G0:r==="string"?(n=qu(t))?(t=n,jE):Q9:t instanceof qu?jE:t instanceof Date?G9:K9(t)?H9:Array.isArray(t)?V9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Y9:G0)(e,t)}function Iy(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Z9(e,t){t===void 0&&(t=e,e=yc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function J9(e){return function(){return e}}function Y0(e){return+e}var OE=[0,1];function zn(e){return e}function p1(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:J9(isNaN(t)?NaN:.5)}function eB(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function tB(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=p1(a,n),i=r(s,i)):(n=p1(n,a),i=r(i,s)),function(l){return i(n(l))}}function rB(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=p1(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var d=gd(e,l,1,n)-1;return i[d](a[d](l))}}function yd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ip(){var e=OE,t=OE,r=yc,n,a,i,s=zn,l,d,h;function f(){var x=Math.min(e.length,t.length);return s!==zn&&(s=eB(e[0],e[x-1])),l=x>2?rB:tB,d=h=null,p}function p(x){return x==null||isNaN(x=+x)?i:(d||(d=l(e.map(n),t,r)))(n(s(x)))}return p.invert=function(x){return s(a((h||(h=l(t,e.map(n),G0)))(x)))},p.domain=function(x){return arguments.length?(e=Array.from(x,Y0),f()):e.slice()},p.range=function(x){return arguments.length?(t=Array.from(x),f()):t.slice()},p.rangeRound=function(x){return t=Array.from(x),r=Iy,f()},p.clamp=function(x){return arguments.length?(s=x?!0:zn,f()):s!==zn},p.interpolate=function(x){return arguments.length?(r=x,f()):r},p.unknown=function(x){return arguments.length?(i=x,p):i},function(x,g){return n=x,a=g,f()}}function Fy(){return ip()(zn,zn)}function nB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function X0(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function oc(e){return e=X0(Math.abs(e)),e?e[1]:NaN}function aB(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],d=0;a>0&&l>0&&(d+l+1>n&&(l=Math.max(1,n-d)),i.push(r.substring(a-=l,a+l)),!((d+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function iB(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var sB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qu(e){if(!(t=sB.exec(e)))throw new Error("invalid format: "+e);var t;return new My({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Qu.prototype=My.prototype;function My(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}My.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oB(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var JA;function lB(e,t){var r=X0(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(JA=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+X0(e,Math.max(0,t+i-1))[0]}function DE(e,t){var r=X0(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const RE={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:nB,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>DE(e*100,t),r:DE,s:lB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function IE(e){return e}var FE=Array.prototype.map,ME=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function cB(e){var t=e.grouping===void 0||e.thousands===void 0?IE:aB(FE.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?IE:iB(FE.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function h(p){p=Qu(p);var x=p.fill,g=p.align,b=p.sign,_=p.symbol,w=p.zero,S=p.width,T=p.comma,E=p.precision,k=p.trim,A=p.type;A==="n"?(T=!0,A="g"):RE[A]||(E===void 0&&(E=12),k=!0,A="g"),(w||x==="0"&&g==="=")&&(w=!0,x="0",g="=");var j=_==="$"?r:_==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",P=_==="$"?n:/[%p]/.test(A)?s:"",D=RE[A],L=/[defgprs%]/.test(A);E=E===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function I(O){var M=j,re=P,oe,ee,fe;if(A==="c")re=D(O)+re,O="";else{O=+O;var J=O<0||1/O<0;if(O=isNaN(O)?d:D(Math.abs(O),E),k&&(O=oB(O)),J&&+O==0&&b!=="+"&&(J=!1),M=(J?b==="("?b:l:b==="-"||b==="("?"":b)+M,re=(A==="s"?ME[8+JA/3]:"")+re+(J&&b==="("?")":""),L){for(oe=-1,ee=O.length;++oe<ee;)if(fe=O.charCodeAt(oe),48>fe||fe>57){re=(fe===46?a+O.slice(oe+1):O.slice(oe))+re,O=O.slice(0,oe);break}}}T&&!w&&(O=t(O,1/0));var ie=M.length+O.length+re.length,Q=ie<S?new Array(S-ie+1).join(x):"";switch(T&&w&&(O=t(Q+O,Q.length?S-re.length:1/0),Q=""),g){case"<":O=M+O+re+Q;break;case"=":O=M+Q+O+re;break;case"^":O=Q.slice(0,ie=Q.length>>1)+M+O+re+Q.slice(ie);break;default:O=Q+M+O+re;break}return i(O)}return I.toString=function(){return p+""},I}function f(p,x){var g=h((p=Qu(p),p.type="f",p)),b=Math.max(-8,Math.min(8,Math.floor(oc(x)/3)))*3,_=Math.pow(10,-b),w=ME[8+b/3];return function(S){return g(_*S)+w}}return{format:h,formatPrefix:f}}var Qf,Ly,eP;uB({thousands:",",grouping:[3],currency:["$",""]});function uB(e){return Qf=cB(e),Ly=Qf.format,eP=Qf.formatPrefix,Qf}function dB(e){return Math.max(0,-oc(Math.abs(e)))}function fB(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(oc(t)/3)))*3-oc(Math.abs(e)))}function hB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,oc(t)-oc(e))+1}function tP(e,t,r,n){var a=u1(e,t,r),i;switch(n=Qu(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=fB(a,s))&&(n.precision=i),eP(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=hB(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=dB(a))&&(n.precision=i-(n.type==="%")*2);break}}return Ly(n)}function uo(e){var t=e.domain;return e.ticks=function(r){var n=t();return l1(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return tP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],d,h,f=10;for(l<s&&(h=s,s=l,l=h,h=a,a=i,i=h);f-- >0;){if(h=c1(s,l,r),h===d)return n[a]=s,n[i]=l,t(n);if(h>0)s=Math.floor(s/h)*h,l=Math.ceil(l/h)*h;else if(h<0)s=Math.ceil(s*h)/h,l=Math.floor(l*h)/h;else break;d=h}return e},e}function rP(){var e=Fy();return e.copy=function(){return yd(e,rP())},Ya.apply(e,arguments),uo(e)}function nP(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Y0),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return nP(e).unknown(t)},e=arguments.length?Array.from(e,Y0):[0,1],uo(r)}function aP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function LE(e){return Math.log(e)}function BE(e){return Math.exp(e)}function pB(e){return-Math.log(-e)}function mB(e){return-Math.exp(-e)}function xB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function gB(e){return e===10?xB:e===Math.E?Math.exp:t=>Math.pow(e,t)}function vB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function $E(e){return(t,r)=>-e(-t,r)}function By(e){const t=e(LE,BE),r=t.domain;let n=10,a,i;function s(){return a=vB(n),i=gB(n),r()[0]<0?(a=$E(a),i=$E(i),e(pB,mB)):e(LE,BE),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const d=r();let h=d[0],f=d[d.length-1];const p=f<h;p&&([h,f]=[f,h]);let x=a(h),g=a(f),b,_;const w=l==null?10:+l;let S=[];if(!(n%1)&&g-x<w){if(x=Math.floor(x),g=Math.ceil(g),h>0){for(;x<=g;++x)for(b=1;b<n;++b)if(_=x<0?b/i(-x):b*i(x),!(_<h)){if(_>f)break;S.push(_)}}else for(;x<=g;++x)for(b=n-1;b>=1;--b)if(_=x>0?b/i(-x):b*i(x),!(_<h)){if(_>f)break;S.push(_)}S.length*2<w&&(S=l1(h,f,w))}else S=l1(x,g,Math.min(g-x,w)).map(i);return p?S.reverse():S},t.tickFormat=(l,d)=>{if(l==null&&(l=10),d==null&&(d=n===10?"s":","),typeof d!="function"&&(!(n%1)&&(d=Qu(d)).precision==null&&(d.trim=!0),d=Ly(d)),l===1/0)return d;const h=Math.max(1,n*l/t.ticks().length);return f=>{let p=f/i(Math.round(a(f)));return p*n<n-.5&&(p*=n),p<=h?d(f):""}},t.nice=()=>r(aP(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function iP(){const e=By(ip()).domain([1,10]);return e.copy=()=>yd(e,iP()).base(e.base()),Ya.apply(e,arguments),e}function UE(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function zE(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function $y(e){var t=1,r=e(UE(t),zE(t));return r.constant=function(n){return arguments.length?e(UE(t=+n),zE(t)):t},uo(r)}function sP(){var e=$y(ip());return e.copy=function(){return yd(e,sP()).constant(e.constant())},Ya.apply(e,arguments)}function WE(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function yB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function wB(e){return e<0?-e*e:e*e}function Uy(e){var t=e(zn,zn),r=1;function n(){return r===1?e(zn,zn):r===.5?e(yB,wB):e(WE(r),WE(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},uo(t)}function zy(){var e=Uy(ip());return e.copy=function(){return yd(e,zy()).exponent(e.exponent())},Ya.apply(e,arguments),e}function bB(){return zy.apply(null,arguments).exponent(.5)}function HE(e){return Math.sign(e)*e*e}function _B(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oP(){var e=Fy(),t=[0,1],r=!1,n;function a(i){var s=_B(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(HE(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Y0)).map(HE)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return oP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ya.apply(a,arguments),uo(a)}function lP(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=T9(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[gd(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ys),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return lP().domain(e).range(t).unknown(n)},Ya.apply(i,arguments)}function cP(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(d){return d!=null&&d<=d?a[gd(n,d,0,r)]:i}function l(){var d=-1;for(n=new Array(r);++d<r;)n[d]=((d+1)*t-(d-r)*e)/(r+1);return s}return s.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,l()):[e,t]},s.range=function(d){return arguments.length?(r=(a=Array.from(d)).length-1,l()):a.slice()},s.invertExtent=function(d){var h=a.indexOf(d);return h<0?[NaN,NaN]:h<1?[e,n[0]]:h>=r?[n[r-1],t]:[n[h-1],n[h]]},s.unknown=function(d){return arguments.length&&(i=d),s},s.thresholds=function(){return n.slice()},s.copy=function(){return cP().domain([e,t]).range(a).unknown(i)},Ya.apply(uo(s),arguments)}function uP(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[gd(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return uP().domain(e).range(t).unknown(r)},Ya.apply(a,arguments)}const Lg=new Date,Bg=new Date;function Vr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const d=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return d;let h;do d.push(h=new Date(+i)),t(i,l),e(i);while(h<i&&i<s);return d},a.filter=i=>Vr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Lg.setTime(+i),Bg.setTime(+s),e(Lg),e(Bg),Math.floor(r(Lg,Bg))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const q0=Vr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);q0.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Vr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):q0);q0.range;const Zi=1e3,Ha=Zi*60,Ji=Ha*60,os=Ji*24,Wy=os*7,KE=os*30,$g=os*365,Fo=Vr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Zi)},(e,t)=>(t-e)/Zi,e=>e.getUTCSeconds());Fo.range;const Hy=Vr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zi)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getMinutes());Hy.range;const Ky=Vr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCMinutes());Ky.range;const Vy=Vr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zi-e.getMinutes()*Ha)},(e,t)=>{e.setTime(+e+t*Ji)},(e,t)=>(t-e)/Ji,e=>e.getHours());Vy.range;const Gy=Vr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ji)},(e,t)=>(t-e)/Ji,e=>e.getUTCHours());Gy.range;const wd=Vr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ha)/os,e=>e.getDate()-1);wd.range;const sp=Vr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/os,e=>e.getUTCDate()-1);sp.range;const dP=Vr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/os,e=>Math.floor(e/os));dP.range;function sl(e){return Vr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ha)/Wy)}const op=sl(0),Q0=sl(1),SB=sl(2),NB=sl(3),lc=sl(4),EB=sl(5),TB=sl(6);op.range;Q0.range;SB.range;NB.range;lc.range;EB.range;TB.range;function ol(e){return Vr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Wy)}const lp=ol(0),Z0=ol(1),CB=ol(2),kB=ol(3),cc=ol(4),AB=ol(5),PB=ol(6);lp.range;Z0.range;CB.range;kB.range;cc.range;AB.range;PB.range;const Yy=Vr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Yy.range;const Xy=Vr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xy.range;const ls=Vr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ls.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ls.range;const cs=Vr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());cs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Vr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});cs.range;function fP(e,t,r,n,a,i){const s=[[Fo,1,Zi],[Fo,5,5*Zi],[Fo,15,15*Zi],[Fo,30,30*Zi],[i,1,Ha],[i,5,5*Ha],[i,15,15*Ha],[i,30,30*Ha],[a,1,Ji],[a,3,3*Ji],[a,6,6*Ji],[a,12,12*Ji],[n,1,os],[n,2,2*os],[r,1,Wy],[t,1,KE],[t,3,3*KE],[e,1,$g]];function l(h,f,p){const x=f<h;x&&([h,f]=[f,h]);const g=p&&typeof p.range=="function"?p:d(h,f,p),b=g?g.range(h,+f+1):[];return x?b.reverse():b}function d(h,f,p){const x=Math.abs(f-h)/p,g=Py(([,,w])=>w).right(s,x);if(g===s.length)return e.every(u1(h/$g,f/$g,p));if(g===0)return q0.every(Math.max(u1(h,f,p),1));const[b,_]=s[x/s[g-1][2]<s[g][2]/x?g-1:g];return b.every(_)}return[l,d]}const[jB,OB]=fP(cs,Xy,lp,dP,Gy,Ky),[DB,RB]=fP(ls,Yy,op,wd,Vy,Hy);function Ug(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function IB(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,d=e.shortMonths,h=bu(a),f=_u(a),p=bu(i),x=_u(i),g=bu(s),b=_u(s),_=bu(l),w=_u(l),S=bu(d),T=_u(d),E={a:J,A:ie,b:Q,B:te,c:null,d:QE,e:QE,f:a$,g:p$,G:x$,H:t$,I:r$,j:n$,L:hP,m:i$,M:s$,p:H,q:se,Q:eT,s:tT,S:o$,u:l$,U:c$,V:u$,w:d$,W:f$,x:null,X:null,y:h$,Y:m$,Z:g$,"%":JE},k={a:Y,A:ce,b:ue,B:me,c:null,d:ZE,e:ZE,f:b$,g:j$,G:D$,H:v$,I:y$,j:w$,L:mP,m:_$,M:S$,p:Re,q:U,Q:eT,s:tT,S:N$,u:E$,U:T$,V:C$,w:k$,W:A$,x:null,X:null,y:P$,Y:O$,Z:R$,"%":JE},A={a:I,A:O,b:M,B:re,c:oe,d:XE,e:XE,f:QB,g:YE,G:GE,H:qE,I:qE,j:GB,L:qB,m:VB,M:YB,p:L,q:KB,Q:JB,s:e$,S:XB,u:$B,U:UB,V:zB,w:BB,W:WB,x:ee,X:fe,y:YE,Y:GE,Z:HB,"%":ZB};E.x=j(r,E),E.X=j(n,E),E.c=j(t,E),k.x=j(r,k),k.X=j(n,k),k.c=j(t,k);function j(B,K){return function(z){var ne=[],Oe=-1,Pe=0,we=B.length,xe,Ee,le;for(z instanceof Date||(z=new Date(+z));++Oe<we;)B.charCodeAt(Oe)===37&&(ne.push(B.slice(Pe,Oe)),(Ee=VE[xe=B.charAt(++Oe)])!=null?xe=B.charAt(++Oe):Ee=xe==="e"?" ":"0",(le=K[xe])&&(xe=le(z,Ee)),ne.push(xe),Pe=Oe+1);return ne.push(B.slice(Pe,Oe)),ne.join("")}}function P(B,K){return function(z){var ne=wu(1900,void 0,1),Oe=D(ne,B,z+="",0),Pe,we;if(Oe!=z.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(K&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(Pe=zg(wu(ne.y,0,1)),we=Pe.getUTCDay(),Pe=we>4||we===0?Z0.ceil(Pe):Z0(Pe),Pe=sp.offset(Pe,(ne.V-1)*7),ne.y=Pe.getUTCFullYear(),ne.m=Pe.getUTCMonth(),ne.d=Pe.getUTCDate()+(ne.w+6)%7):(Pe=Ug(wu(ne.y,0,1)),we=Pe.getDay(),Pe=we>4||we===0?Q0.ceil(Pe):Q0(Pe),Pe=wd.offset(Pe,(ne.V-1)*7),ne.y=Pe.getFullYear(),ne.m=Pe.getMonth(),ne.d=Pe.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),we="Z"in ne?zg(wu(ne.y,0,1)).getUTCDay():Ug(wu(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(we+5)%7:ne.w+ne.U*7-(we+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,zg(ne)):Ug(ne)}}function D(B,K,z,ne){for(var Oe=0,Pe=K.length,we=z.length,xe,Ee;Oe<Pe;){if(ne>=we)return-1;if(xe=K.charCodeAt(Oe++),xe===37){if(xe=K.charAt(Oe++),Ee=A[xe in VE?K.charAt(Oe++):xe],!Ee||(ne=Ee(B,z,ne))<0)return-1}else if(xe!=z.charCodeAt(ne++))return-1}return ne}function L(B,K,z){var ne=h.exec(K.slice(z));return ne?(B.p=f.get(ne[0].toLowerCase()),z+ne[0].length):-1}function I(B,K,z){var ne=g.exec(K.slice(z));return ne?(B.w=b.get(ne[0].toLowerCase()),z+ne[0].length):-1}function O(B,K,z){var ne=p.exec(K.slice(z));return ne?(B.w=x.get(ne[0].toLowerCase()),z+ne[0].length):-1}function M(B,K,z){var ne=S.exec(K.slice(z));return ne?(B.m=T.get(ne[0].toLowerCase()),z+ne[0].length):-1}function re(B,K,z){var ne=_.exec(K.slice(z));return ne?(B.m=w.get(ne[0].toLowerCase()),z+ne[0].length):-1}function oe(B,K,z){return D(B,t,K,z)}function ee(B,K,z){return D(B,r,K,z)}function fe(B,K,z){return D(B,n,K,z)}function J(B){return s[B.getDay()]}function ie(B){return i[B.getDay()]}function Q(B){return d[B.getMonth()]}function te(B){return l[B.getMonth()]}function H(B){return a[+(B.getHours()>=12)]}function se(B){return 1+~~(B.getMonth()/3)}function Y(B){return s[B.getUTCDay()]}function ce(B){return i[B.getUTCDay()]}function ue(B){return d[B.getUTCMonth()]}function me(B){return l[B.getUTCMonth()]}function Re(B){return a[+(B.getUTCHours()>=12)]}function U(B){return 1+~~(B.getUTCMonth()/3)}return{format:function(B){var K=j(B+="",E);return K.toString=function(){return B},K},parse:function(B){var K=P(B+="",!1);return K.toString=function(){return B},K},utcFormat:function(B){var K=j(B+="",k);return K.toString=function(){return B},K},utcParse:function(B){var K=P(B+="",!0);return K.toString=function(){return B},K}}}var VE={"-":"",_:" ",0:"0"},rn=/^\s*\d+/,FB=/^%/,MB=/[\\^$*+?|[\]().{}]/g;function Ft(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function LB(e){return e.replace(MB,"\\$&")}function bu(e){return new RegExp("^(?:"+e.map(LB).join("|")+")","i")}function _u(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function BB(e,t,r){var n=rn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function $B(e,t,r){var n=rn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function UB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function zB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function WB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function GE(e,t,r){var n=rn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function YE(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function HB(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function KB(e,t,r){var n=rn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function VB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function XE(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function GB(e,t,r){var n=rn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function qE(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function YB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function XB(e,t,r){var n=rn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function qB(e,t,r){var n=rn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function QB(e,t,r){var n=rn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZB(e,t,r){var n=FB.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function JB(e,t,r){var n=rn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function e$(e,t,r){var n=rn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function QE(e,t){return Ft(e.getDate(),t,2)}function t$(e,t){return Ft(e.getHours(),t,2)}function r$(e,t){return Ft(e.getHours()%12||12,t,2)}function n$(e,t){return Ft(1+wd.count(ls(e),e),t,3)}function hP(e,t){return Ft(e.getMilliseconds(),t,3)}function a$(e,t){return hP(e,t)+"000"}function i$(e,t){return Ft(e.getMonth()+1,t,2)}function s$(e,t){return Ft(e.getMinutes(),t,2)}function o$(e,t){return Ft(e.getSeconds(),t,2)}function l$(e){var t=e.getDay();return t===0?7:t}function c$(e,t){return Ft(op.count(ls(e)-1,e),t,2)}function pP(e){var t=e.getDay();return t>=4||t===0?lc(e):lc.ceil(e)}function u$(e,t){return e=pP(e),Ft(lc.count(ls(e),e)+(ls(e).getDay()===4),t,2)}function d$(e){return e.getDay()}function f$(e,t){return Ft(Q0.count(ls(e)-1,e),t,2)}function h$(e,t){return Ft(e.getFullYear()%100,t,2)}function p$(e,t){return e=pP(e),Ft(e.getFullYear()%100,t,2)}function m$(e,t){return Ft(e.getFullYear()%1e4,t,4)}function x$(e,t){var r=e.getDay();return e=r>=4||r===0?lc(e):lc.ceil(e),Ft(e.getFullYear()%1e4,t,4)}function g$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ft(t/60|0,"0",2)+Ft(t%60,"0",2)}function ZE(e,t){return Ft(e.getUTCDate(),t,2)}function v$(e,t){return Ft(e.getUTCHours(),t,2)}function y$(e,t){return Ft(e.getUTCHours()%12||12,t,2)}function w$(e,t){return Ft(1+sp.count(cs(e),e),t,3)}function mP(e,t){return Ft(e.getUTCMilliseconds(),t,3)}function b$(e,t){return mP(e,t)+"000"}function _$(e,t){return Ft(e.getUTCMonth()+1,t,2)}function S$(e,t){return Ft(e.getUTCMinutes(),t,2)}function N$(e,t){return Ft(e.getUTCSeconds(),t,2)}function E$(e){var t=e.getUTCDay();return t===0?7:t}function T$(e,t){return Ft(lp.count(cs(e)-1,e),t,2)}function xP(e){var t=e.getUTCDay();return t>=4||t===0?cc(e):cc.ceil(e)}function C$(e,t){return e=xP(e),Ft(cc.count(cs(e),e)+(cs(e).getUTCDay()===4),t,2)}function k$(e){return e.getUTCDay()}function A$(e,t){return Ft(Z0.count(cs(e)-1,e),t,2)}function P$(e,t){return Ft(e.getUTCFullYear()%100,t,2)}function j$(e,t){return e=xP(e),Ft(e.getUTCFullYear()%100,t,2)}function O$(e,t){return Ft(e.getUTCFullYear()%1e4,t,4)}function D$(e,t){var r=e.getUTCDay();return e=r>=4||r===0?cc(e):cc.ceil(e),Ft(e.getUTCFullYear()%1e4,t,4)}function R$(){return"+0000"}function JE(){return"%"}function eT(e){return+e}function tT(e){return Math.floor(+e/1e3)}var Rl,gP,vP;I$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function I$(e){return Rl=IB(e),gP=Rl.format,Rl.parse,vP=Rl.utcFormat,Rl.utcParse,Rl}function F$(e){return new Date(e)}function M$(e){return e instanceof Date?+e:+new Date(+e)}function qy(e,t,r,n,a,i,s,l,d,h){var f=Fy(),p=f.invert,x=f.domain,g=h(".%L"),b=h(":%S"),_=h("%I:%M"),w=h("%I %p"),S=h("%a %d"),T=h("%b %d"),E=h("%B"),k=h("%Y");function A(j){return(d(j)<j?g:l(j)<j?b:s(j)<j?_:i(j)<j?w:n(j)<j?a(j)<j?S:T:r(j)<j?E:k)(j)}return f.invert=function(j){return new Date(p(j))},f.domain=function(j){return arguments.length?x(Array.from(j,M$)):x().map(F$)},f.ticks=function(j){var P=x();return e(P[0],P[P.length-1],j??10)},f.tickFormat=function(j,P){return P==null?A:h(P)},f.nice=function(j){var P=x();return(!j||typeof j.range!="function")&&(j=t(P[0],P[P.length-1],j??10)),j?x(aP(P,j)):f},f.copy=function(){return yd(f,qy(e,t,r,n,a,i,s,l,d,h))},f}function L$(){return Ya.apply(qy(DB,RB,ls,Yy,op,wd,Vy,Hy,Fo,gP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function B$(){return Ya.apply(qy(jB,OB,cs,Xy,lp,sp,Gy,Ky,Fo,vP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function cp(){var e=0,t=1,r,n,a,i,s=zn,l=!1,d;function h(p){return p==null||isNaN(p=+p)?d:s(a===0?.5:(p=(i(p)-r)*a,l?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t]=p,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),h):[e,t]},h.clamp=function(p){return arguments.length?(l=!!p,h):l},h.interpolator=function(p){return arguments.length?(s=p,h):s};function f(p){return function(x){var g,b;return arguments.length?([g,b]=x,s=p(g,b),h):[s(0),s(1)]}}return h.range=f(yc),h.rangeRound=f(Iy),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return i=p,r=p(e),n=p(t),a=r===n?0:1/(n-r),h}}function fo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function yP(){var e=uo(cp()(zn));return e.copy=function(){return fo(e,yP())},ms.apply(e,arguments)}function wP(){var e=By(cp()).domain([1,10]);return e.copy=function(){return fo(e,wP()).base(e.base())},ms.apply(e,arguments)}function bP(){var e=$y(cp());return e.copy=function(){return fo(e,bP()).constant(e.constant())},ms.apply(e,arguments)}function Qy(){var e=Uy(cp());return e.copy=function(){return fo(e,Qy()).exponent(e.exponent())},ms.apply(e,arguments)}function $$(){return Qy.apply(null,arguments).exponent(.5)}function _P(){var e=[],t=zn;function r(n){if(n!=null&&!isNaN(n=+n))return t((gd(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ys),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>E9(e,i/n))},r.copy=function(){return _P(t).domain(e)},ms.apply(r,arguments)}function up(){var e=0,t=.5,r=1,n=1,a,i,s,l,d,h=zn,f,p=!1,x;function g(_){return isNaN(_=+_)?x:(_=.5+((_=+f(_))-i)*(n*_<n*i?l:d),h(p?Math.max(0,Math.min(1,_)):_))}g.domain=function(_){return arguments.length?([e,t,r]=_,a=f(e=+e),i=f(t=+t),s=f(r=+r),l=a===i?0:.5/(i-a),d=i===s?0:.5/(s-i),n=i<a?-1:1,g):[e,t,r]},g.clamp=function(_){return arguments.length?(p=!!_,g):p},g.interpolator=function(_){return arguments.length?(h=_,g):h};function b(_){return function(w){var S,T,E;return arguments.length?([S,T,E]=w,h=Z9(_,[S,T,E]),g):[h(0),h(.5),h(1)]}}return g.range=b(yc),g.rangeRound=b(Iy),g.unknown=function(_){return arguments.length?(x=_,g):x},function(_){return f=_,a=_(e),i=_(t),s=_(r),l=a===i?0:.5/(i-a),d=i===s?0:.5/(s-i),n=i<a?-1:1,g}}function SP(){var e=uo(up()(zn));return e.copy=function(){return fo(e,SP())},ms.apply(e,arguments)}function NP(){var e=By(up()).domain([.1,1,10]);return e.copy=function(){return fo(e,NP()).base(e.base())},ms.apply(e,arguments)}function EP(){var e=$y(up());return e.copy=function(){return fo(e,EP()).constant(e.constant())},ms.apply(e,arguments)}function Zy(){var e=Uy(up());return e.copy=function(){return fo(e,Zy()).exponent(e.exponent())},ms.apply(e,arguments)}function U$(){return Zy.apply(null,arguments).exponent(.5)}const Cu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Oy,scaleDiverging:SP,scaleDivergingLog:NP,scaleDivergingPow:Zy,scaleDivergingSqrt:U$,scaleDivergingSymlog:EP,scaleIdentity:nP,scaleImplicit:d1,scaleLinear:rP,scaleLog:iP,scaleOrdinal:jy,scalePoint:k9,scalePow:zy,scaleQuantile:lP,scaleQuantize:cP,scaleRadial:oP,scaleSequential:yP,scaleSequentialLog:wP,scaleSequentialPow:Qy,scaleSequentialQuantile:_P,scaleSequentialSqrt:$$,scaleSequentialSymlog:bP,scaleSqrt:bB,scaleSymlog:sP,scaleThreshold:uP,scaleTime:L$,scaleUtc:B$,tickFormat:tP},Symbol.toStringTag,{value:"Module"}));var ho=e=>e.chartData,Jy=ke([ho],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),dp=(e,t,r,n)=>n?Jy(e):ho(e);function Yo(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(jn(t)&&jn(r))return!0}return!1}function rT(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function TP(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(jn(r))a=r;else if(typeof r=="function")return;if(jn(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Yo(s))return s}}function z$(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Yo(n))return rT(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,l;if(a==="auto")t!=null&&(s=Math.min(...t));else if(pt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&UN.test(a)){var d=UN.exec(a);if(d==null||t==null)s=void 0;else{var h=+d[1];s=t[0]-h}}else s=t?.[0];if(i==="auto")t!=null&&(l=Math.max(...t));else if(pt(i))l=i;else if(typeof i=="function")try{t!=null&&(l=i(t?.[1]))}catch{}else if(typeof i=="string"&&zN.test(i)){var f=zN.exec(i);if(f==null||t==null)l=void 0;else{var p=+f[1];l=t[1]+p}}else l=t?.[1];var x=[s,l];if(Yo(x))return t==null?x:rT(x,t,r)}}}var wc=1e9,W$={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},tw,ur=!0,Ga="[DecimalError] ",Uo=Ga+"Invalid argument: ",ew=Ga+"Exponent out of range: ",bc=Math.floor,jo=Math.pow,H$=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Sa,Jr=1e7,nr=7,CP=9007199254740991,J0=bc(CP/nr),st={};st.absoluteValue=st.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};st.comparedTo=st.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};st.decimalPlaces=st.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*nr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};st.dividedBy=st.div=function(e){return ts(this,new this.constructor(e))};st.dividedToIntegerBy=st.idiv=function(e){var t=this,r=t.constructor;return qt(ts(t,new r(e),0,1),r.precision)};st.equals=st.eq=function(e){return!this.cmp(e)};st.exponent=function(){return Lr(this)};st.greaterThan=st.gt=function(e){return this.cmp(e)>0};st.greaterThanOrEqualTo=st.gte=function(e){return this.cmp(e)>=0};st.isInteger=st.isint=function(){return this.e>this.d.length-2};st.isNegative=st.isneg=function(){return this.s<0};st.isPositive=st.ispos=function(){return this.s>0};st.isZero=function(){return this.s===0};st.lessThan=st.lt=function(e){return this.cmp(e)<0};st.lessThanOrEqualTo=st.lte=function(e){return this.cmp(e)<1};st.logarithm=st.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Sa))throw Error(Ga+"NaN");if(r.s<1)throw Error(Ga+(r.s?"NaN":"-Infinity"));return r.eq(Sa)?new n(0):(ur=!1,t=ts(Zu(r,i),Zu(e,i),i),ur=!0,qt(t,a))};st.minus=st.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?PP(t,e):kP(t,(e.s=-e.s,e))};st.modulo=st.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Ga+"NaN");return r.s?(ur=!1,t=ts(r,e,0,1).times(e),ur=!0,r.minus(t)):qt(new n(r),a)};st.naturalExponential=st.exp=function(){return AP(this)};st.naturalLogarithm=st.ln=function(){return Zu(this)};st.negated=st.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};st.plus=st.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?kP(t,e):PP(t,(e.s=-e.s,e))};st.precision=st.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Uo+e);if(t=Lr(a)+1,n=a.d.length-1,r=n*nr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};st.squareRoot=st.sqrt=function(){var e,t,r,n,a,i,s,l=this,d=l.constructor;if(l.s<1){if(!l.s)return new d(0);throw Error(Ga+"NaN")}for(e=Lr(l),ur=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Ni(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=bc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new d(t)):n=new d(a.toString()),r=d.precision,a=s=r+3;;)if(i=n,n=i.plus(ts(l,i,s+2)).times(.5),Ni(i.d).slice(0,s)===(t=Ni(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(qt(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return ur=!0,qt(n,r)};st.times=st.mul=function(e){var t,r,n,a,i,s,l,d,h,f=this,p=f.constructor,x=f.d,g=(e=new p(e)).d;if(!f.s||!e.s)return new p(0);for(e.s*=f.s,r=f.e+e.e,d=x.length,h=g.length,d<h&&(i=x,x=g,g=i,s=d,d=h,h=s),i=[],s=d+h,n=s;n--;)i.push(0);for(n=h;--n>=0;){for(t=0,a=d+n;a>n;)l=i[a]+g[n]*x[a-n-1]+t,i[a--]=l%Jr|0,t=l/Jr|0;i[a]=(i[a]+t)%Jr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,ur?qt(e,p.precision):e};st.toDecimalPlaces=st.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ji(e,0,wc),t===void 0?t=n.rounding:ji(t,0,8),qt(r,e+Lr(r)+1,t))};st.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Xo(n,!0):(ji(e,0,wc),t===void 0?t=a.rounding:ji(t,0,8),n=qt(new a(n),e+1,t),r=Xo(n,!0,e+1)),r};st.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Xo(a):(ji(e,0,wc),t===void 0?t=i.rounding:ji(t,0,8),n=qt(new i(a),e+Lr(a)+1,t),r=Xo(n.abs(),!1,e+Lr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};st.toInteger=st.toint=function(){var e=this,t=e.constructor;return qt(new t(e),Lr(e)+1,t.rounding)};st.toNumber=function(){return+this};st.toPower=st.pow=function(e){var t,r,n,a,i,s,l=this,d=l.constructor,h=12,f=+(e=new d(e));if(!e.s)return new d(Sa);if(l=new d(l),!l.s){if(e.s<1)throw Error(Ga+"Infinity");return l}if(l.eq(Sa))return l;if(n=d.precision,e.eq(Sa))return qt(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=f<0?-f:f)<=CP){for(a=new d(Sa),t=Math.ceil(n/nr+4),ur=!1;r%2&&(a=a.times(l),aT(a.d,t)),r=bc(r/2),r!==0;)l=l.times(l),aT(l.d,t);return ur=!0,e.s<0?new d(Sa).div(a):qt(a,n)}}else if(i<0)throw Error(Ga+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,ur=!1,a=e.times(Zu(l,n+h)),ur=!0,a=AP(a),a.s=i,a};st.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Lr(a),n=Xo(a,r<=i.toExpNeg||r>=i.toExpPos)):(ji(e,1,wc),t===void 0?t=i.rounding:ji(t,0,8),a=qt(new i(a),e,t),r=Lr(a),n=Xo(a,e<=r||r<=i.toExpNeg,e)),n};st.toSignificantDigits=st.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ji(e,1,wc),t===void 0?t=n.rounding:ji(t,0,8)),qt(new n(r),e,t)};st.toString=st.valueOf=st.val=st.toJSON=st[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Lr(e),r=e.constructor;return Xo(e,t<=r.toExpNeg||t>=r.toExpPos)};function kP(e,t){var r,n,a,i,s,l,d,h,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),ur?qt(t,p):t;if(d=e.d,h=t.d,s=e.e,a=t.e,d=d.slice(),i=s-a,i){for(i<0?(n=d,i=-i,l=h.length):(n=h,a=s,l=d.length),s=Math.ceil(p/nr),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=d.length,i=h.length,l-i<0&&(i=l,n=h,h=d,d=n),r=0;i;)r=(d[--i]=d[i]+h[i]+r)/Jr|0,d[i]%=Jr;for(r&&(d.unshift(r),++a),l=d.length;d[--l]==0;)d.pop();return t.d=d,t.e=a,ur?qt(t,p):t}function ji(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Uo+e)}function Ni(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=nr-n.length,r&&(i+=zs(r)),i+=n;s=e[t],n=s+"",r=nr-n.length,r&&(i+=zs(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var ts=(function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%Jr|0,s=i/Jr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,d;if(i!=s)d=i>s?1:-1;else for(l=d=0;l<i;l++)if(n[l]!=a[l]){d=n[l]>a[l]?1:-1;break}return d}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Jr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,d,h,f,p,x,g,b,_,w,S,T,E,k,A,j,P,D,L=n.constructor,I=n.s==a.s?1:-1,O=n.d,M=a.d;if(!n.s)return new L(n);if(!a.s)throw Error(Ga+"Division by zero");for(d=n.e-a.e,P=M.length,A=O.length,g=new L(I),b=g.d=[],h=0;M[h]==(O[h]||0);)++h;if(M[h]>(O[h]||0)&&--d,i==null?T=i=L.precision:s?T=i+(Lr(n)-Lr(a))+1:T=i,T<0)return new L(0);if(T=T/nr+2|0,h=0,P==1)for(f=0,M=M[0],T++;(h<A||f)&&T--;h++)E=f*Jr+(O[h]||0),b[h]=E/M|0,f=E%M|0;else{for(f=Jr/(M[0]+1)|0,f>1&&(M=e(M,f),O=e(O,f),P=M.length,A=O.length),k=P,_=O.slice(0,P),w=_.length;w<P;)_[w++]=0;D=M.slice(),D.unshift(0),j=M[0],M[1]>=Jr/2&&++j;do f=0,l=t(M,_,P,w),l<0?(S=_[0],P!=w&&(S=S*Jr+(_[1]||0)),f=S/j|0,f>1?(f>=Jr&&(f=Jr-1),p=e(M,f),x=p.length,w=_.length,l=t(p,_,x,w),l==1&&(f--,r(p,P<x?D:M,x))):(f==0&&(l=f=1),p=M.slice()),x=p.length,x<w&&p.unshift(0),r(_,p,w),l==-1&&(w=_.length,l=t(M,_,P,w),l<1&&(f++,r(_,P<w?D:M,w))),w=_.length):l===0&&(f++,_=[0]),b[h++]=f,l&&_[0]?_[w++]=O[k]||0:(_=[O[k]],w=1);while((k++<A||_[0]!==void 0)&&T--)}return b[0]||b.shift(),g.e=d,qt(g,s?i+Lr(g)+1:i)}})();function AP(e,t){var r,n,a,i,s,l,d=0,h=0,f=e.constructor,p=f.precision;if(Lr(e)>16)throw Error(ew+Lr(e));if(!e.s)return new f(Sa);for(ur=!1,l=p,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),h+=5;for(n=Math.log(jo(2,h))/Math.LN10*2+5|0,l+=n,r=a=i=new f(Sa),f.precision=l;;){if(a=qt(a.times(e),l),r=r.times(++d),s=i.plus(ts(a,r,l)),Ni(s.d).slice(0,l)===Ni(i.d).slice(0,l)){for(;h--;)i=qt(i.times(i),l);return f.precision=p,t==null?(ur=!0,qt(i,p)):i}i=s}}function Lr(e){for(var t=e.e*nr,r=e.d[0];r>=10;r/=10)t++;return t}function Wg(e,t,r){if(t>e.LN10.sd())throw ur=!0,r&&(e.precision=r),Error(Ga+"LN10 precision limit exceeded");return qt(new e(e.LN10),t)}function zs(e){for(var t="";e--;)t+="0";return t}function Zu(e,t){var r,n,a,i,s,l,d,h,f,p=1,x=10,g=e,b=g.d,_=g.constructor,w=_.precision;if(g.s<1)throw Error(Ga+(g.s?"NaN":"-Infinity"));if(g.eq(Sa))return new _(0);if(t==null?(ur=!1,h=w):h=t,g.eq(10))return t==null&&(ur=!0),Wg(_,h);if(h+=x,_.precision=h,r=Ni(b),n=r.charAt(0),i=Lr(g),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=Ni(g.d),n=r.charAt(0),p++;i=Lr(g),n>1?(g=new _("0."+r),i++):g=new _(n+"."+r.slice(1))}else return d=Wg(_,h+2,w).times(i+""),g=Zu(new _(n+"."+r.slice(1)),h-x).plus(d),_.precision=w,t==null?(ur=!0,qt(g,w)):g;for(l=s=g=ts(g.minus(Sa),g.plus(Sa),h),f=qt(g.times(g),h),a=3;;){if(s=qt(s.times(f),h),d=l.plus(ts(s,new _(a),h)),Ni(d.d).slice(0,h)===Ni(l.d).slice(0,h))return l=l.times(2),i!==0&&(l=l.plus(Wg(_,h+2,w).times(i+""))),l=ts(l,new _(p),h),_.precision=w,t==null?(ur=!0,qt(l,w)):l;l=d,a+=2}}function nT(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=bc(r/nr),e.d=[],n=(r+1)%nr,r<0&&(n+=nr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=nr;n<a;)e.d.push(+t.slice(n,n+=nr));t=t.slice(n),n=nr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),ur&&(e.e>J0||e.e<-J0))throw Error(ew+r)}else e.s=0,e.e=0,e.d=[0];return e}function qt(e,t,r){var n,a,i,s,l,d,h,f,p=e.d;for(s=1,i=p[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=nr,a=t,h=p[f=0];else{if(f=Math.ceil((n+1)/nr),i=p.length,f>=i)return e;for(h=i=p[f],s=1;i>=10;i/=10)s++;n%=nr,a=n-nr+s}if(r!==void 0&&(i=jo(10,s-a-1),l=h/i%10|0,d=t<0||p[f+1]!==void 0||h%i,d=r<4?(l||d)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||d||r==6&&(n>0?a>0?h/jo(10,s-a):0:p[f-1])%10&1||r==(e.s<0?8:7))),t<1||!p[0])return d?(i=Lr(e),p.length=1,t=t-i-1,p[0]=jo(10,(nr-t%nr)%nr),e.e=bc(-t/nr)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(n==0?(p.length=f,i=1,f--):(p.length=f+1,i=jo(10,nr-n),p[f]=a>0?(h/jo(10,s-a)%jo(10,a)|0)*i:0),d)for(;;)if(f==0){(p[0]+=i)==Jr&&(p[0]=1,++e.e);break}else{if(p[f]+=i,p[f]!=Jr)break;p[f--]=0,i=1}for(n=p.length;p[--n]===0;)p.pop();if(ur&&(e.e>J0||e.e<-J0))throw Error(ew+Lr(e));return e}function PP(e,t){var r,n,a,i,s,l,d,h,f,p,x=e.constructor,g=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),ur?qt(t,g):t;if(d=e.d,p=t.d,n=t.e,h=e.e,d=d.slice(),s=h-n,s){for(f=s<0,f?(r=d,s=-s,l=p.length):(r=p,n=h,l=d.length),a=Math.max(Math.ceil(g/nr),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=d.length,l=p.length,f=a<l,f&&(l=a),a=0;a<l;a++)if(d[a]!=p[a]){f=d[a]<p[a];break}s=0}for(f&&(r=d,d=p,p=r,t.s=-t.s),l=d.length,a=p.length-l;a>0;--a)d[l++]=0;for(a=p.length;a>s;){if(d[--a]<p[a]){for(i=a;i&&d[--i]===0;)d[i]=Jr-1;--d[i],d[a]+=Jr}d[a]-=p[a]}for(;d[--l]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=n,ur?qt(t,g):t):new x(0)}function Xo(e,t,r){var n,a=Lr(e),i=Ni(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+zs(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+zs(-a-1)+i,r&&(n=r-s)>0&&(i+=zs(n))):a>=s?(i+=zs(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+zs(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=zs(n))),e.s<0?"-"+i:i}function aT(e,t){if(e.length>t)return e.length=t,!0}function jP(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Uo+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return nT(s,i.toString())}else if(typeof i!="string")throw Error(Uo+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,H$.test(i))nT(s,i);else throw Error(Uo+i)}if(a.prototype=st,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=jP,a.config=a.set=K$,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function K$(e){if(!e||typeof e!="object")throw Error(Ga+"Object expected");var t,r,n,a=["precision",1,wc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(bc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Uo+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Uo+r+": "+n);return this}var tw=jP(W$);Sa=new tw(1);const Wt=tw;var V$=e=>e,OP={},DP=e=>e===OP,iT=e=>function t(){return arguments.length===0||arguments.length===1&&DP(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},RP=(e,t)=>e===1?t:iT(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==OP).length;return i>=e?t(...n):RP(e-i,iT(function(){for(var s=arguments.length,l=new Array(s),d=0;d<s;d++)l[d]=arguments[d];var h=n.map(f=>DP(f)?l.shift():f);return t(...h,...l)}))}),fp=e=>RP(e.length,e),m1=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},G$=fp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Y$=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return V$;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((l,d)=>d(l),i(...arguments))}},x1=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),IP=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,l)=>{var d;return s===((d=t)===null||d===void 0?void 0:d[l])})||(t=a,r=e(...a)),r}};function FP(e){var t;return e===0?t=1:t=Math.floor(new Wt(e).abs().log(10).toNumber())+1,t}function MP(e,t,r){for(var n=new Wt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}fp((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});fp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});fp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var LP=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},BP=(e,t,r)=>{if(e.lte(0))return new Wt(0);var n=FP(e.toNumber()),a=new Wt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new Wt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),d=l.mul(a);return t?new Wt(d.toNumber()):new Wt(Math.ceil(d.toNumber()))},X$=(e,t,r)=>{var n=new Wt(1),a=new Wt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Wt(10).pow(FP(e)-1),a=new Wt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Wt(Math.floor(e)))}else e===0?a=new Wt(Math.floor((t-1)/2)):r||(a=new Wt(Math.floor(e)));var s=Math.floor((t-1)/2),l=Y$(G$(d=>a.add(new Wt(d-s).mul(n)).toNumber()),m1);return l(0,t)},$P=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Wt(0),tickMin:new Wt(0),tickMax:new Wt(0)};var s=BP(new Wt(r).sub(t).div(n-1),a,i),l;t<=0&&r>=0?l=new Wt(0):(l=new Wt(t).add(r).div(2),l=l.sub(new Wt(l).mod(s)));var d=Math.ceil(l.sub(t).div(s).toNumber()),h=Math.ceil(new Wt(r).sub(l).div(s).toNumber()),f=d+h+1;return f>n?$P(t,r,n,a,i+1):(f<n&&(h=r>0?h+(n-f):h,d=r>0?d:d+(n-f)),{step:s,tickMin:l.sub(new Wt(d).mul(s)),tickMax:l.add(new Wt(h).mul(s))})};function q$(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,l]=LP([t,r]);if(s===-1/0||l===1/0){var d=l===1/0?[s,...m1(0,n-1).map(()=>1/0)]:[...m1(0,n-1).map(()=>-1/0),l];return t>r?x1(d):d}if(s===l)return X$(s,n,a);var{step:h,tickMin:f,tickMax:p}=$P(s,l,i,a,0),x=MP(f,p.add(new Wt(.1).mul(h)),h);return t>r?x1(x):x}function Q$(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=LP([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var l=Math.max(t,2),d=BP(new Wt(s).sub(i).div(l-1),a,0),h=[...MP(new Wt(i),new Wt(s),d),s];return a===!1&&(h=h.map(f=>Math.round(f))),r>n?x1(h):h}var Z$=IP(q$),J$=IP(Q$),UP=e=>e.rootProps.maxBarSize,eU=e=>e.rootProps.barGap,zP=e=>e.rootProps.barCategoryGap,tU=e=>e.rootProps.barSize,bd=e=>e.rootProps.stackOffset,rw=e=>e.options.chartName,nw=e=>e.rootProps.syncId,WP=e=>e.rootProps.syncMethod,aw=e=>e.options.eventEmitter,Vi={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},va={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},hp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},rU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Vi.angleAxisId,includeHidden:!1,name:void 0,reversed:Vi.reversed,scale:Vi.scale,tick:Vi.tick,tickCount:void 0,ticks:void 0,type:Vi.type,unit:void 0},nU={allowDataOverflow:va.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:va.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:va.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:va.scale,tick:va.tick,tickCount:va.tickCount,ticks:void 0,type:va.type,unit:void 0},aU={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Vi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Vi.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Vi.scale,tick:Vi.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},iU={allowDataOverflow:va.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:va.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:va.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:va.scale,tick:va.tick,tickCount:va.tickCount,ticks:void 0,type:"category",unit:void 0},iw=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?aU:rU,sw=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?iU:nU,pp=e=>e.polarOptions,ow=ke([hs,ps,Kr],wA),HP=ke([pp,ow],(e,t)=>{if(e!=null)return kn(e.innerRadius,t,0)}),KP=ke([pp,ow],(e,t)=>{if(e!=null)return kn(e.outerRadius,t,t*.8)}),sU=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},VP=ke([pp],sU);ke([iw,VP],hp);var GP=ke([ow,HP,KP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ke([sw,GP],hp);var YP=ke([jt,pp,HP,KP,hs,ps],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:l,startAngle:d,endAngle:h}=t;return{cx:kn(s,a,a/2),cy:kn(l,i,i/2),innerRadius:r,outerRadius:n,startAngle:d,endAngle:h,clockWise:!1}}}),pr=(e,t)=>t,_d=(e,t,r)=>r;function lw(e){return e?.id}var Gr=e=>{var t=jt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},_c=e=>e.tooltip.settings.axisId,Yr=e=>{var t=Gr(e),r=_c(e);return Sd(e,t,r)},XP=ke([Yr],e=>e?.dataKey);function qP(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(l=>{var d,h=(d=l.data)!==null&&d!==void 0?d:n;if(!(h==null||h.length===0)){var f=lw(l);h.forEach((p,x)=>{var g=i==null||a?x:String(er(p,i,null)),b=er(p,l.dataKey,0),_;s.has(g)?_=s.get(g):_={},Object.assign(_,{[f]:b}),s.set(g,_)})}}),Array.from(s.values())}function mp(e){return e.stackId!=null&&e.dataKey!=null}var xp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function gp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function sT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sT(Object(r),!0).forEach(function(n){oU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oU(e,t,r){return(t=lU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lU(e){var t=cU(e,"string");return typeof t=="symbol"?t:t+""}function cU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g1=[0,"auto"],ma={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},QP=(e,t)=>e.cartesianAxis.xAxis[t],xs=(e,t)=>{var r=QP(e,t);return r??ma},xa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:g1,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:pd},ZP=(e,t)=>e.cartesianAxis.yAxis[t],gs=(e,t)=>{var r=ZP(e,t);return r??xa},uU={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},cw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??uU},yr=(e,t,r)=>{switch(t){case"xAxis":return xs(e,r);case"yAxis":return gs(e,r);case"zAxis":return cw(e,r);case"angleAxis":return iw(e,r);case"radiusAxis":return sw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},dU=(e,t,r)=>{switch(t){case"xAxis":return xs(e,r);case"yAxis":return gs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Sd=(e,t,r)=>{switch(t){case"xAxis":return xs(e,r);case"yAxis":return gs(e,r);case"angleAxis":return iw(e,r);case"radiusAxis":return sw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},JP=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function uw(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var vp=e=>e.graphicalItems.cartesianItems,fU=ke([pr,_d],uw),dw=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),Nd=ke([vp,yr,fU],dw,{memoizeOptions:{resultEqualityCheck:gp}}),ej=ke([Nd],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(mp)),tj=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),hU=ke([Nd],tj),fw=e=>e.map(t=>t.data).filter(Boolean).flat(1),pU=ke([Nd],fw,{memoizeOptions:{resultEqualityCheck:gp}}),hw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},pw=ke([pU,dp],hw),mw=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:er(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:er(a,n)}))):e.map(n=>({value:n})),yp=ke([pw,yr,Nd],mw);function rj(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function w0(e){if(Pi(e)||e instanceof Date){var t=Number(e);if(jn(t))return t}}function oT(e){if(Array.isArray(e)){var t=[w0(e[0]),w0(e[1])];return Yo(t)?t:void 0}var r=w0(e);if(r!=null)return[r,r]}function Sc(e){return e.map(w0).filter(j7)}function mU(e,t,r){return!r||typeof t!="number"||Ka(t)?[]:r.length?Sc(r.flatMap(n=>{var a=er(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!jn(i)||!jn(s)))return[t-i,t+s]})):[]}var xU=ke([ej,dp,Yr],qP),nj=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,l]=i,d=l.map(lw);return[s,{stackedData:hL(e,d,r),graphicalItems:l}]}))},v1=ke([xU,ej,bd],nj),aj=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=vL(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},gU=ke([yr],e=>e.allowDataOverflow),xw=e=>{var t;if(e==null||!("domain"in e))return g1;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Sc(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:g1},gw=ke([yr],xw),vw=ke([gw,gU],TP),vU=ke([v1,ho,pr,vw],aj,{memoizeOptions:{resultEqualityCheck:xp}}),wp=e=>e.errorBars,yU=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>rj(r,n)),th=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),l=Math.max(...i);return[s,l]}},yw=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(l=>{r.forEach(d=>{var h,f,p=(h=n[d.id])===null||h===void 0?void 0:h.filter(S=>rj(a,S)),x=er(l,(f=t.dataKey)!==null&&f!==void 0?f:d.dataKey),g=mU(l,x,p);if(g.length>=2){var b=Math.min(...g),_=Math.max(...g);(i==null||b<i)&&(i=b),(s==null||_>s)&&(s=_)}var w=oT(x);w!=null&&(i=i==null?w[0]:Math.min(i,w[0]),s=s==null?w[1]:Math.max(s,w[1]))})}),t?.dataKey!=null&&e.forEach(l=>{var d=oT(er(l,t.dataKey));d!=null&&(i=i==null?d[0]:Math.min(i,d[0]),s=s==null?d[1]:Math.max(s,d[1]))}),jn(i)&&jn(s))return[i,s]},wU=ke([pw,yr,hU,wp,pr],yw,{memoizeOptions:{resultEqualityCheck:xp}});function bU(e){var{value:t}=e;if(Pi(t)||t instanceof Date)return t}var _U=(e,t,r)=>{var n=e.map(bU).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&j4(n))?KA(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},ij=e=>e.referenceElements.dots,Nc=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),SU=ke([ij,pr,_d],Nc),sj=e=>e.referenceElements.areas,NU=ke([sj,pr,_d],Nc),oj=e=>e.referenceElements.lines,EU=ke([oj,pr,_d],Nc),lj=(e,t)=>{var r=Sc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},TU=ke(SU,pr,lj),cj=(e,t)=>{var r=Sc(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},CU=ke([NU,pr],cj),uj=(e,t)=>{var r=Sc(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},kU=ke(EU,pr,uj),AU=ke(TU,kU,CU,(e,t,r)=>th(e,r,t)),ww=(e,t,r,n,a,i,s,l)=>{if(r!=null)return r;var d=s==="vertical"&&l==="xAxis"||s==="horizontal"&&l==="yAxis",h=d?th(n,i,a):th(i,a);return z$(t,h,e.allowDataOverflow)},PU=ke([yr,gw,vw,vU,wU,AU,jt,pr],ww,{memoizeOptions:{resultEqualityCheck:xp}}),jU=[0,1],bw=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:l,type:d}=e,h=lo(t,i);return h&&l==null?KA(0,r.length):d==="category"?_U(n,e,h):a==="expand"?jU:s}},_w=ke([yr,jt,pw,yp,bd,pr,PU],bw),dj=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var l="scale".concat(dd(i));return l in Cu?l:"point"}}},Ec=ke([yr,jt,JP,rw,pr],dj);function OU(e){if(e!=null){if(e in Cu)return Cu[e]();var t="scale".concat(dd(e));if(t in Cu)return Cu[t]()}}function Sw(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=OU(t);if(a!=null){var i=a.domain(r).range(n);return lL(i),i}}}var Nw=(e,t,r)=>{var n=xw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Yo(e))return Z$(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Yo(e))return J$(e,t.tickCount,t.allowDecimals)}},Ew=ke([_w,Sd,Ec],Nw),Tw=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Yo(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],l=r[r.length-1];return[Math.min(a,i),Math.max(s,l)]}return t},DU=ke([yr,_w,Ew,pr],Tw),RU=ke(yp,yr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Sc(e.map(l=>l.value))).sort((l,d)=>l-d);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),fj=ke(RU,jt,zP,Kr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!jn(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=kn(r,e*i),l=e*i/2;return l-s-(l-s)/i*s}return 0}),IU=(e,t)=>{var r=xs(e,t);return r==null||typeof r.padding!="string"?0:fj(e,"xAxis",t,r.padding)},FU=(e,t)=>{var r=gs(e,t);return r==null||typeof r.padding!="string"?0:fj(e,"yAxis",t,r.padding)},MU=ke(xs,IU,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),LU=ke(gs,FU,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),BU=ke([Kr,MU,tp,ep,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),$U=ke([Kr,jt,LU,tp,ep,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ed=(e,t,r,n)=>{var a;switch(t){case"xAxis":return BU(e,r,n);case"yAxis":return $U(e,r,n);case"zAxis":return(a=cw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return VP(e);case"radiusAxis":return GP(e,r);default:return}},hj=ke([yr,Ed],hp),Tc=ke([yr,Ec,DU,hj],Sw);ke([Nd,wp,pr],yU);function pj(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var bp=(e,t)=>t,_p=(e,t,r)=>r,UU=ke(Zh,bp,_p,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(pj)),zU=ke(Jh,bp,_p,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(pj)),mj=(e,t)=>({width:e.width,height:t.height}),WU=(e,t)=>{var r=typeof t.width=="number"?t.width:pd;return{width:r,height:e.height}},xj=ke(Kr,xs,mj),HU=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},KU=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},VU=ke(ps,Kr,UU,bp,_p,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var d=mj(t,l);s==null&&(s=HU(t,n,e));var h=n==="top"&&!a||n==="bottom"&&a;i[l.id]=s-Number(h)*d.height,s+=(h?-1:1)*d.height}),i}),GU=ke(hs,Kr,zU,bp,_p,(e,t,r,n,a)=>{var i={},s;return r.forEach(l=>{var d=WU(t,l);s==null&&(s=KU(t,n,e));var h=n==="left"&&!a||n==="right"&&a;i[l.id]=s-Number(h)*d.width,s+=(h?-1:1)*d.width}),i}),YU=(e,t)=>{var r=xs(e,t);if(r!=null)return VU(e,r.orientation,r.mirror)},XU=ke([Kr,xs,YU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),qU=(e,t)=>{var r=gs(e,t);if(r!=null)return GU(e,r.orientation,r.mirror)},QU=ke([Kr,gs,qU,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),gj=ke(Kr,gs,(e,t)=>{var r=typeof t.width=="number"?t.width:pd;return{width:r,height:e.height}}),lT=(e,t,r)=>{switch(t){case"xAxis":return xj(e,r).width;case"yAxis":return gj(e,r).height;default:return}},vj=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,l=lo(e,n),d=t.map(h=>h.value);if(s&&l&&i==="category"&&a&&j4(d))return d}},Cw=ke([jt,yp,yr,pr],vj),yj=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=lo(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(l=>l.value)}},kw=ke([jt,yp,Sd,pr],yj),cT=ke([jt,dU,Ec,Tc,Cw,kw,Ed,Ew,pr],(e,t,r,n,a,i,s,l,d)=>{if(t==null)return null;var h=lo(e,d);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:d,categoricalDomain:i,duplicateDomain:a,isCategorical:h,niceTicks:l,range:s,realScaleType:r,scale:n}}),ZU=(e,t,r,n,a,i,s,l,d)=>{if(!(t==null||n==null)){var h=lo(e,d),{type:f,ticks:p,tickCount:x}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,b=f==="category"&&n.bandwidth?n.bandwidth()/g:0;b=d==="angleAxis"&&i!=null&&i.length>=2?tn(i[0]-i[1])*2*b:b;var _=p||a;if(_){var w=_.map((S,T)=>{var E=s?s.indexOf(S):S;return{index:T,coordinate:n(E)+b,value:S,offset:b}});return w.filter(S=>!Ka(S.coordinate))}return h&&l?l.map((S,T)=>({coordinate:n(S)+b,value:S,index:T,offset:b})):n.ticks?n.ticks(x).map(S=>({coordinate:n(S)+b,value:S,offset:b})):n.domain().map((S,T)=>({coordinate:n(S)+b,value:s?s[S]:S,index:T,offset:b}))}},wj=ke([jt,Sd,Ec,Tc,Ew,Ed,Cw,kw,pr],ZU),JU=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=lo(e,s),{tickCount:d}=t,h=0;return h=s==="angleAxis"&&n?.length>=2?tn(n[0]-n[1])*2*h:h,l&&i?i.map((f,p)=>({coordinate:r(f)+h,value:f,index:p,offset:h})):r.ticks?r.ticks(d).map(f=>({coordinate:r(f)+h,value:f,offset:h})):r.domain().map((f,p)=>({coordinate:r(f)+h,value:a?a[f]:f,index:p,offset:h}))}},Qs=ke([jt,Sd,Tc,Ed,Cw,kw,pr],JU),Zs=ke(yr,Tc,(e,t)=>{if(!(e==null||t==null))return eh(eh({},e),{},{scale:t})}),ez=ke([yr,Ec,_w,hj],Sw);ke((e,t,r)=>cw(e,r),ez,(e,t)=>{if(!(e==null||t==null))return eh(eh({},e),{},{scale:t})});var tz=ke([jt,Zh,Jh],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),bj=e=>e.options.defaultTooltipEventType,_j=e=>e.options.validateTooltipEventTypes;function Sj(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Aw(e,t){var r=bj(e),n=_j(e);return Sj(t,r,n)}function rz(e){return ft(t=>Aw(t,e))}var Nj=(e,t)=>{var r,n=Number(t);if(!(Ka(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},nz=e=>e.tooltip.settings,Hs={active:!1,index:null,dataKey:void 0,coordinate:void 0},az={itemInteraction:{click:Hs,hover:Hs},axisInteraction:{click:Hs,hover:Hs},keyboardInteraction:Hs,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Ej=ka({name:"tooltip",initialState:az,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:$n()},removeTooltipEntrySettings:{reducer(e,t){var r=es(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:$n()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:iz,removeTooltipEntrySettings:sz,setTooltipSettingsState:oz,setActiveMouseOverItemIndex:Tj,mouseLeaveItem:lz,mouseLeaveChart:Cj,setActiveClickItemIndex:cz,setMouseOverAxisIndex:kj,setMouseClickAxisIndex:uz,setSyncInteraction:y1,setKeyboardInteraction:w1}=Ej.actions,dz=Ej.reducer;function uT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uT(Object(r),!0).forEach(function(n){fz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fz(e,t,r){return(t=hz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hz(e){var t=pz(e,"string");return typeof t=="symbol"?t:t+""}function pz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mz(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function xz(e){return e.index!=null}var Aj=(e,t,r,n)=>{if(t==null)return Hs;var a=mz(e,t,r);if(a==null)return Hs;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(xz(a)){if(i)return Zf(Zf({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Zf(Zf({},Hs),{},{coordinate:a.coordinate})},Pw=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!jn(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},Pj=(e,t,r,n,a,i,s,l)=>{if(!(i==null||l==null)){var d=s[0],h=d==null?void 0:l(d.positions,i);if(h!=null)return h;var f=a?.[Number(i)];if(f)switch(r){case"horizontal":return{x:f.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:f.coordinate}}}},jj=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Td=e=>e.options.tooltipPayloadSearcher,Cc=e=>e.tooltip;function dT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dT(Object(r),!0).forEach(function(n){gz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gz(e,t,r){return(t=vz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vz(e){var t=yz(e,"string");return typeof t=="symbol"?t:t+""}function yz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wz(e,t){return e??t}var Oj=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:l,computedData:d,dataStartIndex:h,dataEndIndex:f}=r,p=[];return e.reduce((x,g)=>{var b,{dataDefinedOnItem:_,settings:w}=g,S=wz(_,l),T=Array.isArray(S)?bA(S,h,f):S,E=(b=w?.dataKey)!==null&&b!==void 0?b:n,k=w?.nameKey,A;if(n&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?A=O4(T,n,a):A=i(T,t,d,k),Array.isArray(A))A.forEach(P=>{var D=fT(fT({},w),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});x.push(WN({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:er(P.payload,P.dataKey),name:P.name}))});else{var j;x.push(WN({tooltipEntrySettings:w,dataKey:E,payload:A,value:er(A,E),name:(j=er(A,k))!==null&&j!==void 0?j:w?.name}))}return x},p)}},jw=ke([Yr,jt,JP,rw,Gr],dj),bz=ke([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),_z=ke([Gr,_c],uw),Cd=ke([bz,Yr,_z],dw,{memoizeOptions:{resultEqualityCheck:gp}}),Sz=ke([Cd],e=>e.filter(mp)),Nz=ke([Cd],fw,{memoizeOptions:{resultEqualityCheck:gp}}),kc=ke([Nz,ho],hw),Ez=ke([Sz,ho,Yr],qP),Ow=ke([kc,Yr,Cd],mw),Dj=ke([Yr],xw),Tz=ke([Yr],e=>e.allowDataOverflow),Rj=ke([Dj,Tz],TP),Cz=ke([Cd],e=>e.filter(mp)),kz=ke([Ez,Cz,bd],nj),Az=ke([kz,ho,Gr,Rj],aj),Pz=ke([Cd],tj),jz=ke([kc,Yr,Pz,wp,Gr],yw,{memoizeOptions:{resultEqualityCheck:xp}}),Oz=ke([ij,Gr,_c],Nc),Dz=ke([Oz,Gr],lj),Rz=ke([sj,Gr,_c],Nc),Iz=ke([Rz,Gr],cj),Fz=ke([oj,Gr,_c],Nc),Mz=ke([Fz,Gr],uj),Lz=ke([Dz,Mz,Iz],th),Bz=ke([Yr,Dj,Rj,Az,jz,Lz,jt,Gr],ww),Ij=ke([Yr,jt,kc,Ow,bd,Gr,Bz],bw),$z=ke([Ij,Yr,jw],Nw),Uz=ke([Yr,Ij,$z,Gr],Tw),Fj=e=>{var t=Gr(e),r=_c(e),n=!1;return Ed(e,t,r,n)},Mj=ke([Yr,Fj],hp),Lj=ke([Yr,jw,Uz,Mj],Sw),zz=ke([jt,Ow,Yr,Gr],vj),Wz=ke([jt,Ow,Yr,Gr],yj),Hz=(e,t,r,n,a,i,s,l)=>{if(t){var{type:d}=t,h=lo(e,l);if(n){var f=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=d==="category"&&n.bandwidth?n.bandwidth()/f:0;return p=l==="angleAxis"&&a!=null&&a?.length>=2?tn(a[0]-a[1])*2*p:p,h&&s?s.map((x,g)=>({coordinate:n(x)+p,value:x,index:g,offset:p})):n.domain().map((x,g)=>({coordinate:n(x)+p,value:i?i[x]:x,index:g,offset:p}))}}},vs=ke([jt,Yr,jw,Lj,Fj,zz,Wz,Gr],Hz),Dw=ke([bj,_j,nz],(e,t,r)=>Sj(r.shared,e,t)),Bj=e=>e.tooltip.settings.trigger,Rw=e=>e.tooltip.settings.defaultIndex,Sp=ke([Cc,Dw,Bj,Rw],Aj),Js=ke([Sp,kc],Pw),$j=ke([vs,Js],Nj),Uj=ke([Sp],e=>{if(e)return e.dataKey}),zj=ke([Cc,Dw,Bj,Rw],jj),Kz=ke([hs,ps,jt,Kr,vs,Rw,zj,Td],Pj),Vz=ke([Sp,Kz],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Gz=ke([Sp],e=>e.active),Yz=ke([zj,Js,ho,XP,$j,Td,Dw],Oj),Xz=ke([Yz],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function hT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hT(Object(r),!0).forEach(function(n){qz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qz(e,t,r){return(t=Qz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qz(e){var t=Zz(e,"string");return typeof t=="symbol"?t:t+""}function Zz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jz=()=>ft(Yr),eW=()=>{var e=Jz(),t=ft(vs),r=ft(Lj);return Vu(pT(pT({},e),{},{scale:r}),t)},tW=()=>ft(rw),Iw=(e,t)=>t,Wj=(e,t,r)=>r,Fw=(e,t,r,n)=>n,rW=ke(vs,e=>Vh(e,t=>t.coordinate)),Mw=ke([Cc,Iw,Wj,Fw],Aj),Hj=ke([Mw,kc],Pw),nW=(e,t,r)=>{if(t!=null){var n=Cc(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Kj=ke([Cc,Iw,Wj,Fw],jj),rh=ke([hs,ps,jt,Kr,vs,Fw,Kj,Td],Pj),aW=ke([Mw,rh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),Vj=ke(vs,Hj,Nj),iW=ke([Kj,Hj,ho,XP,Vj,Td,Iw],Oj),sW=ke([Mw],e=>({isActive:e.active,activeIndex:e.index})),oW=(e,t,r,n,a,i,s,l)=>{if(!(!e||!t||!n||!a||!i)){var d=yL(e.chartX,e.chartY,t,r,l);if(d){var h=bL(d,t),f=sL(h,s,i,n,a),p=wL(t,i,f,d);return{activeIndex:String(f),activeCoordinate:p}}}};function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(null,arguments)}function mT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mT(Object(r),!0).forEach(function(n){lW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lW(e,t,r){return(t=cW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cW(e){var t=uW(e,"string");return typeof t=="symbol"?t:t+""}function uW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dW(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:l,tooltipEventType:d,chartName:h}=e,f=t,p=r,x=n;if(!l||!f||h!=="ScatterChart"&&d!=="axis")return null;var g,b;if(h==="ScatterChart")g=f,b=N7;else if(h==="BarChart")g=E7(s,f,a,i),b=UA;else if(s==="radial"){var{cx:_,cy:w,radius:S,startAngle:T,endAngle:E}=zA(f);g={cx:_,cy:w,startAngle:T,endAngle:E,innerRadius:S,outerRadius:S},b=HA}else g={points:l9(s,f,a)},b=Ay;var k=typeof l=="object"&&"className"in l?l.className:void 0,A=Jf(Jf(Jf(Jf({stroke:"#ccc",pointerEvents:"none"},a),g),Ho(l)),{},{payload:p,payloadIndex:x,className:$t("recharts-tooltip-cursor",k)});return v.isValidElement(l)?v.cloneElement(l,A):v.createElement(b,A)}function fW(e){var t=eW(),r=PA(),n=np(),a=tW();return v.createElement(dW,b1({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var Gj=v.createContext(null),hW=()=>v.useContext(Gj),Hg={exports:{}},xT;function pW(){return xT||(xT=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(d,h,f){this.fn=d,this.context=h,this.once=f||!1}function i(d,h,f,p,x){if(typeof f!="function")throw new TypeError("The listener must be a function");var g=new a(f,p||d,x),b=r?r+h:h;return d._events[b]?d._events[b].fn?d._events[b]=[d._events[b],g]:d._events[b].push(g):(d._events[b]=g,d._eventsCount++),d}function s(d,h){--d._eventsCount===0?d._events=new n:delete d._events[h]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],f,p;if(this._eventsCount===0)return h;for(p in f=this._events)t.call(f,p)&&h.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(f)):h},l.prototype.listeners=function(h){var f=r?r+h:h,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var x=0,g=p.length,b=new Array(g);x<g;x++)b[x]=p[x].fn;return b},l.prototype.listenerCount=function(h){var f=r?r+h:h,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(h,f,p,x,g,b){var _=r?r+h:h;if(!this._events[_])return!1;var w=this._events[_],S=arguments.length,T,E;if(w.fn){switch(w.once&&this.removeListener(h,w.fn,void 0,!0),S){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,f),!0;case 3:return w.fn.call(w.context,f,p),!0;case 4:return w.fn.call(w.context,f,p,x),!0;case 5:return w.fn.call(w.context,f,p,x,g),!0;case 6:return w.fn.call(w.context,f,p,x,g,b),!0}for(E=1,T=new Array(S-1);E<S;E++)T[E-1]=arguments[E];w.fn.apply(w.context,T)}else{var k=w.length,A;for(E=0;E<k;E++)switch(w[E].once&&this.removeListener(h,w[E].fn,void 0,!0),S){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,f);break;case 3:w[E].fn.call(w[E].context,f,p);break;case 4:w[E].fn.call(w[E].context,f,p,x);break;default:if(!T)for(A=1,T=new Array(S-1);A<S;A++)T[A-1]=arguments[A];w[E].fn.apply(w[E].context,T)}}return!0},l.prototype.on=function(h,f,p){return i(this,h,f,p,!1)},l.prototype.once=function(h,f,p){return i(this,h,f,p,!0)},l.prototype.removeListener=function(h,f,p,x){var g=r?r+h:h;if(!this._events[g])return this;if(!f)return s(this,g),this;var b=this._events[g];if(b.fn)b.fn===f&&(!x||b.once)&&(!p||b.context===p)&&s(this,g);else{for(var _=0,w=[],S=b.length;_<S;_++)(b[_].fn!==f||x&&!b[_].once||p&&b[_].context!==p)&&w.push(b[_]);w.length?this._events[g]=w.length===1?w[0]:w:s(this,g)}return this},l.prototype.removeAllListeners=function(h){var f;return h?(f=r?r+h:h,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(Hg)),Hg.exports}var mW=pW();const xW=fs(mW);var Ju=new xW,_1="recharts.syncEvent.tooltip",gT="recharts.syncEvent.brush";function Lw(e,t){if(t){var r=Number.parseInt(t,10);if(!Ka(r))return e?.[r]}}var gW={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Yj=ka({name:"options",initialState:gW,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),vW=Yj.reducer,{createEventEmitter:yW}=Yj.actions;function wW(e){return e.tooltip.syncInteraction}var bW={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Xj=ka({name:"chartData",initialState:bW,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:vT,setDataStartEndIndexes:_W,setComputedData:Qoe}=Xj.actions,SW=Xj.reducer,NW=["x","y"];function yT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Il(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yT(Object(r),!0).forEach(function(n){EW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EW(e,t,r){return(t=TW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TW(e){var t=CW(e,"string");return typeof t=="symbol"?t:t+""}function CW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kW(e,t){if(e==null)return{};var r,n,a=AW(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var qj=()=>{};function PW(){var e=ft(nw),t=ft(aw),r=_r(),n=ft(WP),a=ft(vs),i=np(),s=rp(),l=ft(d=>d.rootProps.className);v.useEffect(()=>{if(e==null)return qj;var d=(h,f,p)=>{if(t!==p&&e===h){if(n==="index"){var x;if(s&&f!==null&&f!==void 0&&(x=f.payload)!==null&&x!==void 0&&x.coordinate&&f.payload.sourceViewBox){var g=f.payload.coordinate,{x:b,y:_}=g,w=kW(g,NW),{x:S,y:T,width:E,height:k}=f.payload.sourceViewBox,A=Il(Il({},w),{},{x:s.x+(E?(b-S)/E:0)*s.width,y:s.y+(k?(_-T)/k:0)*s.height});r(Il(Il({},f),{},{payload:Il(Il({},f.payload),{},{coordinate:A})}))}else r(f);return}if(a!=null){var j;if(typeof n=="function"){var P={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},D=n(a,P);j=a[D]}else n==="value"&&(j=a.find(fe=>String(fe.value)===f.payload.label));var{coordinate:L}=f.payload;if(j==null||f.payload.active===!1||L==null||s==null){r(y1({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:I,y:O}=L,M=Math.min(I,s.x+s.width),re=Math.min(O,s.y+s.height),oe={x:i==="horizontal"?j.coordinate:M,y:i==="horizontal"?re:j.coordinate},ee=y1({active:f.payload.active,coordinate:oe,dataKey:f.payload.dataKey,index:String(j.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox});r(ee)}}};return Ju.on(_1,d),()=>{Ju.off(_1,d)}},[l,r,t,e,n,a,i,s])}function jW(){var e=ft(nw),t=ft(aw),r=_r();v.useEffect(()=>{if(e==null)return qj;var n=(a,i,s)=>{t!==s&&e===a&&r(_W(i))};return Ju.on(gT,n),()=>{Ju.off(gT,n)}},[r,t,e])}function OW(){var e=_r();v.useEffect(()=>{e(yW())},[e]),PW(),jW()}function DW(e,t,r,n,a,i){var s=ft(g=>nW(g,e,t)),l=ft(aw),d=ft(nw),h=ft(WP),f=ft(wW),p=f?.active,x=rp();v.useEffect(()=>{if(!p&&d!=null&&l!=null){var g=y1({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:x});Ju.emit(_1,d,g,l)}},[p,r,s,a,n,l,d,h,i,x])}function wT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wT(Object(r),!0).forEach(function(n){RW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RW(e,t,r){return(t=IW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IW(e){var t=FW(e,"string");return typeof t=="symbol"?t:t+""}function FW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MW(e){return e.dataKey}function LW(e,t){return v.isValidElement(e)?v.cloneElement(e,t):typeof e=="function"?v.createElement(e,t):v.createElement(r7,t)}var _T=[],BW={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!co.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Kg(e){var t=mn(e,BW),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:l,isAnimationActive:d,offset:h,payloadUniqBy:f,position:p,reverseDirection:x,useTranslate3d:g,wrapperStyle:b,cursor:_,shared:w,trigger:S,defaultIndex:T,portal:E,axisId:k}=t,A=_r(),j=typeof T=="number"?String(T):T;v.useEffect(()=>{A(oz({shared:w,trigger:S,axisId:k,active:r,defaultIndex:j}))},[A,w,S,k,r,j]);var P=rp(),D=FA(),L=rz(w),{activeIndex:I,isActive:O}=ft(ue=>sW(ue,L,S,j)),M=ft(ue=>iW(ue,L,S,j)),re=ft(ue=>Vj(ue,L,S,j)),oe=ft(ue=>aW(ue,L,S,j)),ee=M,fe=hW(),J=r??O,[ie,Q]=QM([ee,J]),te=L==="axis"?re:void 0;DW(L,S,oe,te,I,J);var H=E??fe;if(H==null)return null;var se=ee??_T;J||(se=_T),l&&se.length&&(se=SM(ee.filter(ue=>ue.value!=null&&(ue.hide!==!0||t.includeHidden)),f,MW));var Y=se.length>0,ce=v.createElement(c7,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:d,active:J,coordinate:oe,hasPayload:Y,offset:h,position:p,reverseDirection:x,useTranslate3d:g,viewBox:P,wrapperStyle:b,lastBoundingBox:ie,innerRef:Q,hasPortalFromProps:!!E},LW(s,bT(bT({},t),{},{payload:se,label:te,active:J,coordinate:oe,accessibilityLayer:D})));return v.createElement(v.Fragment,null,WR.createPortal(ce,H),J&&v.createElement(fW,{cursor:_,tooltipEventType:L,coordinate:oe,payload:ee,index:I}))}var kd=e=>null;kd.displayName="Cell";function $W(e,t,r){return(t=UW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UW(e){var t=zW(e,"string");return typeof t=="symbol"?t:t+""}function zW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class WW{constructor(t){$W(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function ST(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ST(Object(r),!0).forEach(function(n){KW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ST(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KW(e,t,r){return(t=VW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=GW(e,"string");return typeof t=="symbol"?t:t+""}function GW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YW={cacheSize:2e3,enableCache:!0},Qj=HW({},YW),NT=new WW(Qj.cacheSize),XW={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},ET="recharts_measurement_span";function qW(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l)}var TT=(e,t)=>{try{var r=document.getElementById(ET);r||(r=document.createElement("span"),r.setAttribute("id",ET),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,XW,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Du=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||co.isSsr)return{width:0,height:0};if(!Qj.enableCache)return TT(t,r);var n=qW(t,r),a=NT.get(n);if(a)return a;var i=TT(t,r);return NT.set(n,i),i},CT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,kT=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QW=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZW=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Zj={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},JW=Object.keys(Zj),Vl="NaN";function eH(e,t){return e*Zj[t]}class sa{static parse(t){var r,[,n,a]=(r=ZW.exec(t))!==null&&r!==void 0?r:[];return new sa(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ka(t)&&(this.unit=""),r!==""&&!QW.test(r)&&(this.num=NaN,this.unit=""),JW.includes(r)&&(this.num=eH(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new sa(NaN,""):new sa(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new sa(NaN,""):new sa(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new sa(NaN,""):new sa(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new sa(NaN,""):new sa(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ka(this.num)}}function Jj(e){if(e.includes(Vl))return Vl;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=CT.exec(t))!==null&&r!==void 0?r:[],s=sa.parse(n??""),l=sa.parse(i??""),d=a==="*"?s.multiply(l):s.divide(l);if(d.isNaN())return Vl;t=t.replace(CT,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,[,f,p,x]=(h=kT.exec(t))!==null&&h!==void 0?h:[],g=sa.parse(f??""),b=sa.parse(x??""),_=p==="+"?g.add(b):g.subtract(b);if(_.isNaN())return Vl;t=t.replace(kT,_.toString())}return t}var AT=/\(([^()]*)\)/;function tH(e){for(var t=e,r;(r=AT.exec(t))!=null;){var[,n]=r;t=t.replace(AT,Jj(n))}return t}function rH(e){var t=e.replace(/\s+/g,"");return t=tH(t),t=Jj(t),t}function nH(e){try{return rH(e)}catch{return Vl}}function Vg(e){var t=nH(e.slice(5,-1));return t===Vl?"":t}var aH=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],iH=["dx","dy","angle","className","breakAll"];function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(null,arguments)}function PT(e,t){if(e==null)return{};var r,n,a=sH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eO=/[ \f\n\r\t\v\u2028\u2029]+/,tO=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];fr(t)||(r?a=t.toString().split(""):a=t.toString().split(eO));var i=a.map(l=>({word:l,width:Du(l,n).width})),s=r?0:Du("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},oH=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:l,breakAll:d}=e,h=pt(i),f=s,p=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return O.reduce((M,re)=>{var{word:oe,width:ee}=re,fe=M[M.length-1];if(fe&&(n==null||a||fe.width+ee+r<Number(n)))fe.words.push(oe),fe.width+=ee+r;else{var J={words:[oe],width:ee};M.push(J)}return M},[])},x=p(t),g=I=>I.reduce((O,M)=>O.width>M.width?O:M);if(!h||a)return x;var b=x.length>i||g(x).width>Number(n);if(!b)return x;for(var _="",w=I=>{var O=f.slice(0,I),M=tO({breakAll:d,style:l,children:O+_}).wordsWithComputedWidth,re=p(M),oe=re.length>i||g(re).width>Number(n);return[oe,re]},S=0,T=f.length-1,E=0,k;S<=T&&E<=f.length-1;){var A=Math.floor((S+T)/2),j=A-1,[P,D]=w(j),[L]=w(A);if(!P&&!L&&(S=A+1),P&&L&&(T=A-1),!P&&L){k=D;break}E++}return k||x},jT=e=>{var t=fr(e)?[]:e.toString().split(eO);return[{words:t}]},lH=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!co.isSsr){var l,d,h=tO({breakAll:i,children:n,style:a});if(h){var{wordsWithComputedWidth:f,spaceWidth:p}=h;l=f,d=p}else return jT(n);return oH({breakAll:i,children:n,maxLines:s,style:a},l,d,t,r)}return jT(n)},OT="#808080",Np=v.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:l="start",verticalAnchor:d="end",fill:h=OT}=e,f=PT(e,aH),p=v.useMemo(()=>lH({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:s,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,s,f.style,f.width]),{dx:x,dy:g,angle:b,className:_,breakAll:w}=f,S=PT(f,iH);if(!Pi(r)||!Pi(n)||p.length===0)return null;var T=r+(pt(x)?x:0),E=n+(pt(g)?g:0),k;switch(d){case"start":k=Vg("calc(".concat(i,")"));break;case"middle":k=Vg("calc(".concat((p.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:k=Vg("calc(".concat(p.length-1," * -").concat(a,")"));break}var A=[];if(s){var j=p[0].width,{width:P}=f;A.push("scale(".concat(pt(P)?P/j:1,")"))}return b&&A.push("rotate(".concat(b,", ").concat(T,", ").concat(E,")")),A.length&&(S.transform=A.join(" ")),v.createElement("text",S1({},Kn(S),{ref:t,x:T,y:E,className:$t("recharts-text",_),textAnchor:l,fill:h.includes("url")?OT:h}),p.map((D,L)=>{var I=D.words.join(w?"":" ");return v.createElement("tspan",{x:T,dy:L===0?k:a,key:"".concat(I,"-").concat(L)},I)}))});Np.displayName="Text";var cH=["labelRef"];function uH(e,t){if(e==null)return{};var r,n,a=dH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function DT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DT(Object(r),!0).forEach(function(n){fH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fH(e,t,r){return(t=hH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hH(e){var t=pH(e,"string");return typeof t=="symbol"?t:t+""}function pH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gi(){return Gi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gi.apply(null,arguments)}var rO=v.createContext(null),mH=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=v.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return v.createElement(rO.Provider,{value:s},i)},nO=()=>{var e=v.useContext(rO),t=rp();return e||t},xH=v.createContext(null),gH=()=>{var e=v.useContext(xH),t=ft(YP);return e||t},vH=e=>{var{value:t,formatter:r}=e,n=fr(e.children)?t:e.children;return typeof r=="function"?r(n):n},Bw=e=>e!=null&&typeof e=="function",yH=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},wH=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:l,cy:d,innerRadius:h,outerRadius:f,startAngle:p,endAngle:x,clockWise:g}=a,b=(h+f)/2,_=yH(p,x),w=_>=0?1:-1,S,T;switch(t){case"insideStart":S=p+w*i,T=g;break;case"insideEnd":S=x-w*i,T=!g;break;case"end":S=x+w*i,T=g;break;default:throw new Error("Unsupported position ".concat(t))}T=_<=0?T:!T;var E=Ir(l,d,b,S),k=Ir(l,d,b,S+(T?1:-1)*359),A="M".concat(E.x,",").concat(E.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(T?0:1,`,
    `).concat(k.x,",").concat(k.y),j=fr(e.id)?zu("recharts-radial-line-"):e.id;return v.createElement("text",Gi({},n,{dominantBaseline:"central",className:$t("recharts-radial-bar-label",s)}),v.createElement("defs",null,v.createElement("path",{id:j,d:A})),v.createElement("textPath",{xlinkHref:"#".concat(j)},r))},bH=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:l,endAngle:d}=e,h=(l+d)/2;if(r==="outside"){var{x:f,y:p}=Ir(n,a,s+t,h);return{x:f,y:p,textAnchor:f>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var x=(i+s)/2,{x:g,y:b}=Ir(n,a,x,h);return{x:g,y:b,textAnchor:"middle",verticalAnchor:"middle"}},aO=e=>"cx"in e&&pt(e.cx),_H=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!aO(r)&&(i=r);var{x:s,y:l,width:d,height:h}=t,f=h>=0?1:-1,p=f*n,x=f>0?"end":"start",g=f>0?"start":"end",b=d>=0?1:-1,_=b*n,w=b>0?"end":"start",S=b>0?"start":"end";if(a==="top"){var T={x:s+d/2,y:l-f*n,textAnchor:"middle",verticalAnchor:x};return Tr(Tr({},T),i?{height:Math.max(l-i.y,0),width:d}:{})}if(a==="bottom"){var E={x:s+d/2,y:l+h+p,textAnchor:"middle",verticalAnchor:g};return Tr(Tr({},E),i?{height:Math.max(i.y+i.height-(l+h),0),width:d}:{})}if(a==="left"){var k={x:s-_,y:l+h/2,textAnchor:w,verticalAnchor:"middle"};return Tr(Tr({},k),i?{width:Math.max(k.x-i.x,0),height:h}:{})}if(a==="right"){var A={x:s+d+_,y:l+h/2,textAnchor:S,verticalAnchor:"middle"};return Tr(Tr({},A),i?{width:Math.max(i.x+i.width-A.x,0),height:h}:{})}var j=i?{width:d,height:h}:{};return a==="insideLeft"?Tr({x:s+_,y:l+h/2,textAnchor:S,verticalAnchor:"middle"},j):a==="insideRight"?Tr({x:s+d-_,y:l+h/2,textAnchor:w,verticalAnchor:"middle"},j):a==="insideTop"?Tr({x:s+d/2,y:l+p,textAnchor:"middle",verticalAnchor:g},j):a==="insideBottom"?Tr({x:s+d/2,y:l+h-p,textAnchor:"middle",verticalAnchor:x},j):a==="insideTopLeft"?Tr({x:s+_,y:l+p,textAnchor:S,verticalAnchor:g},j):a==="insideTopRight"?Tr({x:s+d-_,y:l+p,textAnchor:w,verticalAnchor:g},j):a==="insideBottomLeft"?Tr({x:s+_,y:l+h-p,textAnchor:S,verticalAnchor:x},j):a==="insideBottomRight"?Tr({x:s+d-_,y:l+h-p,textAnchor:w,verticalAnchor:x},j):a&&typeof a=="object"&&(pt(a.x)||is(a.x))&&(pt(a.y)||is(a.y))?Tr({x:s+kn(a.x,d),y:l+kn(a.y,h),textAnchor:"end",verticalAnchor:"end"},j):Tr({x:s+d/2,y:l+h/2,textAnchor:"middle",verticalAnchor:"middle"},j)},SH={offset:5};function Ws(e){var t=mn(e,SH),{viewBox:r,position:n,value:a,children:i,content:s,className:l="",textBreakAll:d,labelRef:h}=t,f=gH(),p=nO(),x=n==="center"?p:f??p,g=r||x;if(!g||fr(a)&&fr(i)&&!v.isValidElement(s)&&typeof s!="function")return null;var b=Tr(Tr({},t),{},{viewBox:g});if(v.isValidElement(s)){var{labelRef:_}=b,w=uH(b,cH);return v.cloneElement(s,w)}var S;if(typeof s=="function"){if(S=v.createElement(s,b),v.isValidElement(S))return S}else S=vH(t);var T=aO(g),E=Kn(t);if(T&&(n==="insideStart"||n==="insideEnd"||n==="end"))return wH(t,n,S,E,g);var k=T?bH(g,t.offset,t.position):_H(t,g);return v.createElement(Np,Gi({ref:h,className:$t("recharts-label",l)},E,k,{breakAll:d}),S)}Ws.displayName="Label";var NH=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?v.createElement(Ws,Gi({key:"label-implicit"},n)):Pi(e)?v.createElement(Ws,Gi({key:"label-implicit",value:e},n)):v.isValidElement(e)?e.type===Ws?v.cloneElement(e,Tr({key:"label-implicit"},n)):v.createElement(Ws,Gi({key:"label-implicit",content:e},n)):Bw(e)?v.createElement(Ws,Gi({key:"label-implicit",content:e},n)):e&&typeof e=="object"?v.createElement(Ws,Gi({},e,{key:"label-implicit"},n)):null};function EH(e){var{label:t,labelRef:r}=e,n=nO();return NH(t,n,r)||null}var Gg={},Yg={},RT;function TH(){return RT||(RT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Yg)),Yg}var Xg={},IT;function CH(){return IT||(IT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Xg)),Xg}var FT;function kH(){return FT||(FT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TH(),r=CH(),n=wy();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Gg)),Gg}var qg,MT;function AH(){return MT||(MT=1,qg=kH().last),qg}var PH=AH();const jH=fs(PH);var OH=["valueAccessor"],DH=["dataKey","clockWise","id","textBreakAll"];function nh(){return nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nh.apply(null,arguments)}function LT(e,t){if(e==null)return{};var r,n,a=RH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function RH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var IH=e=>Array.isArray(e.value)?jH(e.value):e.value,iO=v.createContext(void 0),sO=iO.Provider,oO=v.createContext(void 0),FH=oO.Provider;function MH(){return v.useContext(iO)}function LH(){return v.useContext(oO)}function b0(e){var{valueAccessor:t=IH}=e,r=LT(e,OH),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,l=LT(r,DH),d=MH(),h=LH(),f=d||h;return!f||!f.length?null:v.createElement(hn,{className:"recharts-label-list"},f.map((p,x)=>{var g,b=fr(n)?t(p,x):er(p&&p.payload,n),_=fr(i)?{}:{id:"".concat(i,"-").concat(x)};return v.createElement(Ws,nh({key:"label-".concat(x)},Kn(p),l,_,{fill:(g=r.fill)!==null&&g!==void 0?g:p.fill,parentViewBox:p.parentViewBox,value:b,textBreakAll:s,viewBox:p.viewBox,index:x}))}))}b0.displayName="LabelList";function $w(e){var{label:t}=e;return t?t===!0?v.createElement(b0,{key:"labelList-implicit"}):v.isValidElement(t)||Bw(t)?v.createElement(b0,{key:"labelList-implicit",content:t}):typeof t=="object"?v.createElement(b0,nh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function N1(){return N1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N1.apply(null,arguments)}var lO=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=$t("recharts-dot",a);return t===+t&&r===+r&&n===+n?v.createElement("circle",N1({},Ta(e),yy(e),{className:i,cx:t,cy:r,r:n})):null},cO=e=>e.graphicalItems.polarItems,BH=ke([pr,_d],uw),Ep=ke([cO,yr,BH],dw),$H=ke([Ep],fw),Tp=ke([$H,Jy],hw),UH=ke([Tp,yr,Ep],mw);ke([Tp,yr,Ep],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=er(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):t?.dataKey!=null?e.map(n=>({value:er(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var BT=()=>{},zH=ke([Tp,yr,Ep,wp,pr],yw),WH=ke([yr,gw,vw,BT,zH,BT,jt,pr],ww),uO=ke([yr,jt,Tp,UH,bd,pr,WH],bw),HH=ke([uO,yr,Ec],Nw);ke([yr,uO,HH,pr],Tw);var KH={radiusAxis:{},angleAxis:{}},dO=ka({name:"polarAxis",initialState:KH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Zoe,removeRadiusAxis:Joe,addAngleAxis:ele,removeAngleAxis:tle}=dO.actions,VH=dO.reducer;function $T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$T(Object(r),!0).forEach(function(n){GH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$T(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GH(e,t,r){return(t=YH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YH(e){var t=XH(e,"string");return typeof t=="symbol"?t:t+""}function XH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qH=(e,t)=>t,Uw=ke([cO,qH],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),QH=[],zw=(e,t,r)=>r?.length===0?QH:r,fO=ke([Jy,Uw,zw],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if(t?.data!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>UT(UT({},t.presentationProps),i.props))),a!=null)return a}}),ZH=ke([fO,Uw,zw],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=er(n,t.nameKey,t.name),l;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:vc(s,t.dataKey),color:l,payload:n,type:t.legendType}})}),JH=ke([fO,Uw,zw,Kr],(e,t,r,n)=>{if(!(t==null||e==null))return JK({offset:n,pieSettings:t,displayedData:e,cells:r})}),Qg={exports:{}},Gt={};var zT;function eK(){if(zT)return Gt;zT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function b(_){if(typeof _=="object"&&_!==null){var w=_.$$typeof;switch(w){case e:switch(_=_.type,_){case r:case a:case n:case d:case h:case x:return _;default:switch(_=_&&_.$$typeof,_){case s:case l:case p:case f:return _;case i:return _;default:return w}}case t:return w}}}return Gt.ContextConsumer=i,Gt.ContextProvider=s,Gt.Element=e,Gt.ForwardRef=l,Gt.Fragment=r,Gt.Lazy=p,Gt.Memo=f,Gt.Portal=t,Gt.Profiler=a,Gt.StrictMode=n,Gt.Suspense=d,Gt.SuspenseList=h,Gt.isContextConsumer=function(_){return b(_)===i},Gt.isContextProvider=function(_){return b(_)===s},Gt.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===e},Gt.isForwardRef=function(_){return b(_)===l},Gt.isFragment=function(_){return b(_)===r},Gt.isLazy=function(_){return b(_)===p},Gt.isMemo=function(_){return b(_)===f},Gt.isPortal=function(_){return b(_)===t},Gt.isProfiler=function(_){return b(_)===a},Gt.isStrictMode=function(_){return b(_)===n},Gt.isSuspense=function(_){return b(_)===d},Gt.isSuspenseList=function(_){return b(_)===h},Gt.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===r||_===a||_===n||_===d||_===h||typeof _=="object"&&_!==null&&(_.$$typeof===p||_.$$typeof===f||_.$$typeof===s||_.$$typeof===i||_.$$typeof===l||_.$$typeof===g||_.getModuleId!==void 0)},Gt.typeOf=b,Gt}var WT;function tK(){return WT||(WT=1,Qg.exports=eK()),Qg.exports}var rK=tK(),HT=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",KT=null,Zg=null,hO=e=>{if(e===KT&&Array.isArray(Zg))return Zg;var t=[];return v.Children.forEach(e,r=>{fr(r)||(rK.isFragment(r)?t=t.concat(hO(r.props.children)):t.push(r))}),Zg=t,KT=e,t};function Ww(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>HT(a)):n=[HT(t)],hO(e).forEach(a=>{var i=Ko(a,"type.displayName")||Ko(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var pO=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Jg={},VT;function nK(){return VT||(VT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Jg)),Jg}var ev,GT;function aK(){return GT||(GT=1,ev=nK().isPlainObject),ev}var iK=aK();const sK=fs(iK);function YT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function XT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YT(Object(r),!0).forEach(function(n){oK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oK(e,t,r){return(t=lK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lK(e){var t=cK(e,"string");return typeof t=="symbol"?t:t+""}function cK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ah(){return ah=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ah.apply(null,arguments)}var qT=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},uK={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dK=e=>{var t=mn(e,uK),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:l}=t,{animationEasing:d,animationDuration:h,animationBegin:f,isUpdateAnimationActive:p}=t,x=v.useRef(null),[g,b]=v.useState(-1),_=v.useRef(a),w=v.useRef(i),S=v.useRef(s),T=v.useRef(r),E=v.useRef(n),k=xd(e,"trapezoid-");if(v.useEffect(()=>{if(x.current&&x.current.getTotalLength)try{var oe=x.current.getTotalLength();oe&&b(oe)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var A=$t("recharts-trapezoid",l);if(!p)return v.createElement("g",null,v.createElement("path",ah({},Kn(t),{className:A,d:qT(r,n,a,i,s)})));var j=_.current,P=w.current,D=S.current,L=T.current,I=E.current,O="0px ".concat(g===-1?1:g,"px"),M="".concat(g,"px 0px"),re=MA(["strokeDasharray"],h,d);return v.createElement(md,{animationId:k,key:k,canBegin:g>0,duration:h,easing:d,isActive:p,begin:f},oe=>{var ee=br(j,a,oe),fe=br(P,i,oe),J=br(D,s,oe),ie=br(L,r,oe),Q=br(I,n,oe);x.current&&(_.current=ee,w.current=fe,S.current=J,T.current=ie,E.current=Q);var te=oe>0?{transition:re,strokeDasharray:M}:{strokeDasharray:O};return v.createElement("path",ah({},Kn(t),{className:A,d:qT(ie,Q,ee,fe,J),ref:x,style:XT(XT({},te),t.style)}))})},fK=["option","shapeType","propTransformer","activeClassName","isActive"];function hK(e,t){if(e==null)return{};var r,n,a=pK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function QT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QT(Object(r),!0).forEach(function(n){mK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mK(e,t,r){return(t=xK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xK(e){var t=gK(e,"string");return typeof t=="symbol"?t:t+""}function gK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vK(e,t){return ih(ih({},t),e)}function yK(e,t){return e==="symbols"}function ZT(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return v.createElement(UA,r);case"trapezoid":return v.createElement(dK,r);case"sector":return v.createElement(HA,r);case"symbols":if(yK(t))return v.createElement(R4,r);break;default:return null}}function wK(e){return v.isValidElement(e)?e.props:e}function mO(e){var{option:t,shapeType:r,propTransformer:n=vK,activeClassName:a="recharts-active-shape",isActive:i}=e,s=hK(e,fK),l;if(v.isValidElement(t))l=v.cloneElement(t,ih(ih({},s),wK(t)));else if(typeof t=="function")l=t(s);else if(sK(t)&&typeof t!="boolean"){var d=n(t,s);l=v.createElement(ZT,{shapeType:r,elementProps:d})}else{var h=s;l=v.createElement(ZT,{shapeType:r,elementProps:h})}return i?v.createElement(hn,{className:a},l):l}var Hw=(e,t)=>{var r=_r();return(n,a)=>i=>{e?.(n,a,i),r(Tj({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Kw=e=>{var t=_r();return(r,n)=>a=>{e?.(r,n,a),t(lz())}},Vw=(e,t)=>{var r=_r();return(n,a)=>i=>{e?.(n,a,i),r(cz({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Gw(e){var{fn:t,args:r}=e,n=_r(),a=Vn();return v.useLayoutEffect(()=>{if(!a){var i=t(r);return n(iz(i)),()=>{n(sz(i))}}},[t,r,n,a]),null}var xO=()=>{};function gO(e){var{legendPayload:t}=e,r=_r(),n=Vn();return v.useLayoutEffect(()=>n?xO:(r(RA(t)),()=>{r(IA(t))}),[r,n,t]),null}function bK(e){var{legendPayload:t}=e,r=_r(),n=ft(jt);return v.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?xO:(r(RA(t)),()=>{r(IA(t))}),[r,n,t]),null}var tv,_K=()=>{var[e]=v.useState(()=>zu("uid-"));return e},SK=(tv=Vk.useId)!==null&&tv!==void 0?tv:_K;function NK(e,t){var r=SK();return t||(e?"".concat(e,"-").concat(r):r)}var EK=v.createContext(void 0),Yw=e=>{var{id:t,type:r,children:n}=e,a=NK("recharts-".concat(r),t);return v.createElement(EK.Provider,{value:a},n(a))},TK={cartesianItems:[],polarItems:[]},vO=ka({name:"graphicalItems",initialState:TK,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:$n()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=es(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:$n()},removeCartesianGraphicalItem:{reducer(e,t){var r=es(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:$n()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:$n()},removePolarGraphicalItem:{reducer(e,t){var r=es(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:$n()}}}),{addCartesianGraphicalItem:CK,replaceCartesianGraphicalItem:kK,removeCartesianGraphicalItem:AK,addPolarGraphicalItem:PK,removePolarGraphicalItem:jK}=vO.actions,OK=vO.reducer;function yO(e){var t=_r(),r=v.useRef(null);return v.useLayoutEffect(()=>{r.current===null?t(CK(e)):r.current!==e&&t(kK({prev:r.current,next:e})),r.current=e},[t,e]),v.useLayoutEffect(()=>()=>{r.current&&(t(AK(r.current)),r.current=null)},[t]),null}function DK(e){var t=_r();return v.useLayoutEffect(()=>(t(PK(e)),()=>{t(jK(e))}),[t,e]),null}var RK=["onMouseEnter","onClick","onMouseLeave"],IK=["id"],FK=["id"];function Xw(e,t){if(e==null)return{};var r,n,a=MK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function MK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function JT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JT(Object(r),!0).forEach(function(n){LK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LK(e,t,r){return(t=BK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BK(e){var t=$K(e,"string");return typeof t=="symbol"?t:t+""}function $K(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eo(){return eo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eo.apply(null,arguments)}function UK(e){var t=v.useMemo(()=>Ww(e.children,kd),[e.children]),r=ft(n=>ZH(n,e.id,t));return r==null?null:v.createElement(bK,{legendPayload:r})}function zK(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:l,hide:d,tooltipType:h}=e;return{dataDefinedOnItem:n.map(f=>f.tooltipPayload),positions:n.map(f=>f.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:vc(l,t),hide:d,type:h,color:s,unit:""}}}var WK=(e,t)=>e>t?"start":e<t?"end":"middle",HK=(e,t,r)=>kn(typeof t=="function"?t(e):t,r,r*.8),KK=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,l=wA(i,s),d=a+kn(e.cx,i,i/2),h=n+kn(e.cy,s,s/2),f=kn(e.innerRadius,l,0),p=HK(r,e.outerRadius,l),x=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:d,cy:h,innerRadius:f,outerRadius:p,maxRadius:x}},VK=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function GK(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var YK=(e,t)=>{if(v.isValidElement(e))return v.cloneElement(e,t);if(typeof e=="function")return e(t);var r=$t("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return v.createElement(Ay,eo({},t,{type:"linear",className:r}))},XK=(e,t,r)=>{if(v.isValidElement(e))return v.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),v.isValidElement(n)))return n;var a=$t("recharts-pie-label-text",GK(e));return v.createElement(Np,eo({},t,{alignmentBaseline:"middle",className:a}),n)};function qK(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var l=Ta(r),d=Ho(a),h=Ho(i),f=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,p=t.map((x,g)=>{var b=(x.startAngle+x.endAngle)/2,_=Ir(x.cx,x.cy,x.outerRadius+f,b),w=lr(lr(lr(lr({},l),x),{},{stroke:"none"},d),{},{index:g,textAnchor:WK(_.x,x.cx)},_),S=lr(lr(lr(lr({},l),x),{},{fill:"none",stroke:x.fill},h),{},{index:g,points:[Ir(x.cx,x.cy,x.outerRadius,b),_],key:"line"});return v.createElement(hn,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(g)},i&&YK(i,S),XK(a,w,er(x,s)))});return v.createElement(hn,{className:"recharts-pie-labels"},p)}function QK(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?v.createElement($w,{label:a}):v.createElement(qK,{sectors:t,props:r,showLabels:n})}function ZK(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=ft(Js),{onMouseEnter:s,onClick:l,onMouseLeave:d}=a,h=Xw(a,RK),f=Hw(s,a.dataKey),p=Kw(d),x=Vw(l,a.dataKey);return t==null||t.length===0?null:v.createElement(v.Fragment,null,t.map((g,b)=>{if(g?.startAngle===0&&g?.endAngle===0&&t.length!==1)return null;var _=r&&String(b)===i,w=i?n:null,S=_?r:w,T=lr(lr({},g),{},{stroke:g.stroke,tabIndex:-1,[EA]:b,[TA]:a.dataKey});return v.createElement(hn,eo({key:"sector-".concat(g?.startAngle,"-").concat(g?.endAngle,"-").concat(g.midAngle,"-").concat(b),tabIndex:-1,className:"recharts-pie-sector"},Kh(h,g,b),{onMouseEnter:f(g,b),onMouseLeave:p(g,b),onClick:x(g,b)}),v.createElement(mO,eo({option:S,isActive:_,shapeType:"sector"},T)))}))}function JK(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:l,endAngle:d,dataKey:h,nameKey:f,tooltipType:p}=r,x=Math.abs(r.minAngle),g=VK(l,d),b=Math.abs(g),_=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,w=n.filter(j=>er(j,h,0)!==0).length,S=(b>=360?w:w-1)*_,T=b-w*x-S,E=n.reduce((j,P)=>{var D=er(P,h,0);return j+(pt(D)?D:0)},0),k;if(E>0){var A;k=n.map((j,P)=>{var D=er(j,h,0),L=er(j,f,P),I=KK(r,i,j),O=(pt(D)?D:0)/E,M,re=lr(lr({},j),a&&a[P]&&a[P].props);P?M=A.endAngle+tn(g)*_*(D!==0?1:0):M=l;var oe=M+tn(g)*((D!==0?x:0)+O*T),ee=(M+oe)/2,fe=(I.innerRadius+I.outerRadius)/2,J=[{name:L,value:D,payload:re,dataKey:h,type:p}],ie=Ir(I.cx,I.cy,fe,ee);return A=lr(lr(lr(lr({},r.presentationProps),{},{percent:O,cornerRadius:s,name:L,tooltipPayload:J,midAngle:ee,middleRadius:fe,tooltipPosition:ie},re),I),{},{value:D,startAngle:M,endAngle:oe,payload:re,paddingAngle:tn(g)*_}),A})}return k}function eV(e){var{showLabels:t,sectors:r,children:n}=e,a=v.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return v.createElement(FH,{value:t?a:void 0},n)}function tV(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,activeShape:d,inactiveShape:h,onAnimationStart:f,onAnimationEnd:p}=t,x=xd(t,"recharts-pie-"),g=r.current,[b,_]=v.useState(!1),w=v.useCallback(()=>{typeof p=="function"&&p(),_(!1)},[p]),S=v.useCallback(()=>{typeof f=="function"&&f(),_(!0)},[f]);return v.createElement(eV,{showLabels:!b,sectors:n},v.createElement(md,{animationId:x,begin:i,duration:s,isActive:a,easing:l,onAnimationStart:S,onAnimationEnd:w,key:x},T=>{var E=[],k=n&&n[0],A=k?.startAngle;return n?.forEach((j,P)=>{var D=g&&g[P],L=P>0?Ko(j,"paddingAngle",0):0;if(D){var I=br(D.endAngle-D.startAngle,j.endAngle-j.startAngle,T),O=lr(lr({},j),{},{startAngle:A+L,endAngle:A+I+L});E.push(O),A=O.endAngle}else{var{endAngle:M,startAngle:re}=j,oe=br(0,M-re,T),ee=lr(lr({},j),{},{startAngle:A+L,endAngle:A+oe+L});E.push(ee),A=ee.endAngle}}),r.current=E,v.createElement(hn,null,v.createElement(ZK,{sectors:E,activeShape:d,inactiveShape:h,allOtherPieProps:t}))}),v.createElement(QK,{showLabels:!b,sectors:n,props:t}),t.children)}var rV={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!co.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function nV(e){var{id:t}=e,r=Xw(e,IK),{hide:n,className:a,rootTabIndex:i}=e,s=v.useMemo(()=>Ww(e.children,kd),[e.children]),l=ft(f=>JH(f,t,s)),d=v.useRef(null),h=$t("recharts-pie",a);return n||l==null?(d.current=null,v.createElement(hn,{tabIndex:i,className:h})):v.createElement(v.Fragment,null,v.createElement(Gw,{fn:zK,args:lr(lr({},e),{},{sectors:l})}),v.createElement(hn,{tabIndex:i,className:h},v.createElement(tV,{props:lr(lr({},r),{},{sectors:l}),previousSectorsRef:d})))}function wO(e){var t=mn(e,rV),{id:r}=t,n=Xw(t,FK),a=Ta(n);return v.createElement(Yw,{id:r,type:"pie"},i=>v.createElement(v.Fragment,null,v.createElement(DK,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),v.createElement(UK,eo({},n,{id:i})),v.createElement(nV,eo({},n,{id:i}))))}wO.displayName="Pie";function eC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eC(Object(r),!0).forEach(function(n){aV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aV(e,t,r){return(t=iV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iV(e){var t=sV(e,"string");return typeof t=="symbol"?t:t+""}function sV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oV={xAxis:{},yAxis:{},zAxis:{}},bO=ka({name:"cartesianAxis",initialState:oV,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:$n()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:$n()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:$n()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:$n()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:$n()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:$n()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=tC(tC({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:lV,removeXAxis:cV,addYAxis:uV,removeYAxis:dV,addZAxis:rle,removeZAxis:nle,updateYAxisWidth:fV}=bO.actions,hV=bO.reducer,pV=ke([Kr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),mV=ke([pV,hs,ps],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),qw=()=>ft(mV),xV=()=>ft(Xz);function rC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rC(Object(r),!0).forEach(function(n){gV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gV(e,t,r){return(t=vV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vV(e){var t=yV(e,"string");return typeof t=="symbol"?t:t+""}function yV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wV=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=nC(nC({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Ho(a)),yy(a)),l;return v.isValidElement(a)?l=v.cloneElement(a,s):typeof a=="function"?l=a(s):l=v.createElement(lO,s),v.createElement(hn,{className:"recharts-active-dot"},l)};function bV(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=ft(Js),s=xV();if(t==null||s==null)return null;var l=t.find(d=>s.includes(d.payload));return fr(l)?null:wV({point:l,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var _V="Invariant failed";function SV(e,t){throw new Error(_V)}var NV=["x","y"];function E1(){return E1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E1.apply(null,arguments)}function aC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Su(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aC(Object(r),!0).forEach(function(n){EV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EV(e,t,r){return(t=TV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TV(e){var t=CV(e,"string");return typeof t=="symbol"?t:t+""}function CV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kV(e,t){if(e==null)return{};var r,n,a=AV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function AV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PV(e,t){var{x:r,y:n}=e,a=kV(e,NV),i="".concat(r),s=parseInt(i,10),l="".concat(n),d=parseInt(l,10),h="".concat(t.height||a.height),f=parseInt(h,10),p="".concat(t.width||a.width),x=parseInt(p,10);return Su(Su(Su(Su(Su({},t),a),s?{x:s}:{}),d?{y:d}:{}),{},{height:f,width:x,name:t.name,radius:t.radius})}function Qw(e){return v.createElement(mO,E1({shapeType:"rectangle",propTransformer:PV,activeClassName:"recharts-active-bar"},e))}var jV=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(pt(t))return t;var i=pt(n)||fr(n);return i?t(n,a):(i||SV(),r)}},OV={},_O=ka({name:"errorBars",initialState:OV,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:ale,replaceErrorBar:ile,removeErrorBar:sle}=_O.actions,DV=_O.reducer,RV=["children"];function IV(e,t){if(e==null)return{};var r,n,a=FV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function FV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var MV={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},LV=v.createContext(MV);function SO(e){var{children:t}=e,r=IV(e,RV);return v.createElement(LV.Provider,{value:r},t)}function Zw(e,t){var r,n,a=ft(h=>xs(h,e)),i=ft(h=>gs(h,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:ma.allowDataOverflow,l=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:xa.allowDataOverflow,d=s||l;return{needClip:d,needClipX:s,needClipY:l}}function NO(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=qw(),{needClipX:i,needClipY:s,needClip:l}=Zw(t,r);if(!l)return null;var{x:d,y:h,width:f,height:p}=a;return v.createElement("clipPath",{id:"clipPath-".concat(n)},v.createElement("rect",{x:i?d:d-f/2,y:s?h:h-p/2,width:i?f:f*2,height:s?p:p*2}))}var BV=["onMouseEnter","onMouseLeave","onClick"],$V=["value","background","tooltipPosition"],UV=["id"],zV=["onMouseEnter","onClick","onMouseLeave"];function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},to.apply(null,arguments)}function iC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iC(Object(r),!0).forEach(function(n){WV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WV(e,t,r){return(t=HV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HV(e){var t=KV(e,"string");return typeof t=="symbol"?t:t+""}function KV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sh(e,t){if(e==null)return{};var r,n,a=VV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var GV=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:vc(r,t),payload:e}]};function YV(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:vc(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:l}}}function XV(e){var t=ft(Js),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:l,onClick:d}=i,h=sh(i,BV),f=Hw(s,n),p=Kw(l),x=Vw(d,n);if(!a||r==null)return null;var g=Ho(a);return v.createElement(v.Fragment,null,r.map((b,_)=>{var{value:w,background:S,tooltipPosition:T}=b,E=sh(b,$V);if(!S)return null;var k=f(b,_),A=p(b,_),j=x(b,_),P=Un(Un(Un(Un(Un({option:a,isActive:String(_)===t},E),{},{fill:"#eee"},S),g),Kh(h,b,_)),{},{onMouseEnter:k,onMouseLeave:A,onClick:j,dataKey:n,index:_,className:"recharts-bar-background-rectangle"});return v.createElement(Qw,to({key:"background-bar-".concat(_)},P))}))}function qV(e){var{showLabels:t,children:r,rects:n}=e,a=n?.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return Un(Un({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return v.createElement(sO,{value:t?a:void 0},r)}function QV(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,l=ft(Js),d=ft(Uj),h=r&&String(i)===l&&(d==null||s===d),f=h?r:t;return v.createElement(Qw,to({},n,{name:String(n.name)},a,{isActive:h,option:f,index:i,dataKey:s}))}function ZV(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return v.createElement(Qw,to({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function JV(e){var{data:t,props:r}=e,n=Ta(r),{id:a}=n,i=sh(n,UV),{shape:s,dataKey:l,activeBar:d}=r,{onMouseEnter:h,onClick:f,onMouseLeave:p}=r,x=sh(r,zV),g=Hw(h,l),b=Kw(p),_=Vw(f,l);return t?v.createElement(v.Fragment,null,t.map((w,S)=>v.createElement(hn,to({key:"rectangle-".concat(w?.x,"-").concat(w?.y,"-").concat(w?.value,"-").concat(S),className:"recharts-bar-rectangle"},Kh(x,w,S),{onMouseEnter:g(w,S),onMouseLeave:b(w,S),onClick:_(w,S)}),d?v.createElement(QV,{shape:s,activeBar:d,baseProps:i,entry:w,index:S,dataKey:l}):v.createElement(ZV,{shape:s,baseProps:i,entry:w,index:S,dataKey:l})))):null}function eG(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:l,animationEasing:d,onAnimationEnd:h,onAnimationStart:f}=t,p=r.current,x=xd(t,"recharts-bar-"),[g,b]=v.useState(!1),_=!g,w=v.useCallback(()=>{typeof h=="function"&&h(),b(!1)},[h]),S=v.useCallback(()=>{typeof f=="function"&&f(),b(!0)},[f]);return v.createElement(qV,{showLabels:_,rects:n},v.createElement(md,{animationId:x,begin:s,duration:l,isActive:i,easing:d,onAnimationEnd:w,onAnimationStart:S,key:x},T=>{var E=T===1?n:n?.map((k,A)=>{var j=p&&p[A];if(j)return Un(Un({},k),{},{x:br(j.x,k.x,T),y:br(j.y,k.y,T),width:br(j.width,k.width,T),height:br(j.height,k.height,T)});if(a==="horizontal"){var P=br(0,k.height,T);return Un(Un({},k),{},{y:k.y+k.height-P,height:P})}var D=br(0,k.width,T);return Un(Un({},k),{},{width:D})});return T>0&&(r.current=E??null),E==null?null:v.createElement(hn,null,v.createElement(JV,{props:t,data:E}))}),v.createElement($w,{label:t.label}),t.children)}function tG(e){var t=v.useRef(null);return v.createElement(eG,{previousRectanglesRef:t,props:e})}var EO=0,rG=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:er(e,t)}};class nG extends v.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:l,background:d,id:h}=this.props;if(t||r==null)return null;var f=$t("recharts-bar",a),p=h;return v.createElement(hn,{className:f,id:h},l&&v.createElement("defs",null,v.createElement(NO,{clipPathId:p,xAxisId:i,yAxisId:s})),v.createElement(hn,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(p,")"):void 0},v.createElement(XV,{data:r,dataKey:n,background:d,allOtherBarProps:this.props}),v.createElement(tG,this.props)))}}var aG={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!co.isSsr,legendType:"rect",minPointSize:EO,xAxisId:0,yAxisId:0};function iG(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:d,animationEasing:h,isAnimationActive:f}=e,{needClip:p}=Zw(t,r),x=np(),g=Vn(),b=Ww(e.children,kd),_=ft(T=>DG(T,t,r,g,e.id,b));if(x!=="vertical"&&x!=="horizontal")return null;var w,S=_?.[0];return S==null||S.height==null||S.width==null?w=0:w=x==="vertical"?S.height/2:S.width/2,v.createElement(SO,{xAxisId:t,yAxisId:r,data:_,dataPointFormatter:rG,errorBarOffset:w},v.createElement(nG,to({},e,{layout:x,needClip:p,data:_,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:l,animationDuration:d,animationEasing:h,isAnimationActive:f})))}function sG(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:l,xAxisTicks:d,yAxisTicks:h,stackedData:f,displayedData:p,offset:x,cells:g,parentViewBox:b}=e,_=t==="horizontal"?l:s,w=f?_.scale.domain():null,S=mL({numericAxis:_});return p.map((T,E)=>{var k,A,j,P,D,L;f?k=cL(f[E],w):(k=er(T,r),Array.isArray(k)||(k=[S,k]));var I=jV(n,EO)(k[1],E);if(t==="horizontal"){var O,[M,re]=[l.scale(k[0]),l.scale(k[1])];A=$N({axis:s,ticks:d,bandSize:i,offset:a.offset,entry:T,index:E}),j=(O=re??M)!==null&&O!==void 0?O:void 0,P=a.size;var oe=M-re;if(D=Ka(oe)?0:oe,L={x:A,y:x.top,width:P,height:x.height},Math.abs(I)>0&&Math.abs(D)<Math.abs(I)){var ee=tn(D||I)*(Math.abs(I)-Math.abs(D));j-=ee,D+=ee}}else{var[fe,J]=[s.scale(k[0]),s.scale(k[1])];if(A=fe,j=$N({axis:l,ticks:h,bandSize:i,offset:a.offset,entry:T,index:E}),P=J-fe,D=a.size,L={x:x.left,y:j,width:x.width,height:D},Math.abs(I)>0&&Math.abs(P)<Math.abs(I)){var ie=tn(P||I)*(Math.abs(I)-Math.abs(P));P+=ie}}if(A==null||j==null||P==null||D==null)return null;var Q=Un(Un({},T),{},{x:A,y:j,width:P,height:D,value:f?k:k[1],payload:T,background:L,tooltipPosition:{x:A+P/2,y:j+D/2},parentViewBox:b},g&&g[E]&&g[E].props);return Q}).filter(Boolean)}function oG(e){var t=mn(e,aG),r=Vn();return v.createElement(Yw,{id:t.id,type:"bar"},n=>v.createElement(v.Fragment,null,v.createElement(gO,{legendPayload:GV(t)}),v.createElement(Gw,{fn:YV,args:t}),v.createElement(yO,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:pL(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),v.createElement(iG,to({},t,{id:n}))))}var T1=v.memo(oG);T1.displayName="Bar";function sC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function e0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sC(Object(r),!0).forEach(function(n){lG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lG(e,t,r){return(t=cG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cG(e){var t=uG(e,"string");return typeof t=="symbol"?t:t+""}function uG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dG=(e,t)=>t,fG=(e,t,r)=>r,hG=(e,t,r,n)=>n,pG=(e,t,r,n,a)=>a,Ad=ke([vp,pG],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),mG=ke([Ad],e=>e?.maxBarSize),xG=(e,t,r,n,a,i)=>i,oC=(e,t,r)=>{var n=r??e;if(!fr(n))return kn(n,t,0)},gG=ke([jt,vp,dG,fG,hG],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),vG=(e,t,r,n)=>{var a=jt(e);return a==="horizontal"?v1(e,"yAxis",r,n):v1(e,"xAxis",t,n)},yG=(e,t,r)=>{var n=jt(e);return n==="horizontal"?lT(e,"xAxis",t):lT(e,"yAxis",r)},wG=(e,t,r)=>{var n={},a=e.filter(mp),i=e.filter(h=>h.stackId==null),s=a.reduce((h,f)=>(h[f.stackId]||(h[f.stackId]=[]),h[f.stackId].push(f),h),n),l=Object.entries(s).map(h=>{var[f,p]=h,x=p.map(b=>b.dataKey),g=oC(t,r,p[0].barSize);return{stackId:f,dataKeys:x,barSize:g}}),d=i.map(h=>{var f=[h.dataKey].filter(x=>x!=null),p=oC(t,r,h.barSize);return{stackId:void 0,dataKeys:f,barSize:p}});return[...l,...d]},bG=ke([gG,tU,yG],wG),_G=(e,t,r,n,a)=>{var i,s,l=Ad(e,t,r,n,a);if(l!=null){var d=jt(e),h=UP(e),{maxBarSize:f}=l,p=fr(f)?h:f,x,g;return d==="horizontal"?(x=Zs(e,"xAxis",t,n),g=Qs(e,"xAxis",t,n)):(x=Zs(e,"yAxis",r,n),g=Qs(e,"yAxis",r,n)),(i=(s=Vu(x,g,!0))!==null&&s!==void 0?s:p)!==null&&i!==void 0?i:0}},TO=(e,t,r,n)=>{var a=jt(e),i,s;return a==="horizontal"?(i=Zs(e,"xAxis",t,n),s=Qs(e,"xAxis",t,n)):(i=Zs(e,"yAxis",r,n),s=Qs(e,"yAxis",r,n)),Vu(i,s)};function SG(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=kn(e,r,0,!0),l,d=[];if(jn(n[0].barSize)){var h=!1,f=r/i,p=n.reduce((S,T)=>S+(T.barSize||0),0);p+=(i-1)*s,p>=r&&(p-=(i-1)*s,s=0),p>=r&&f>0&&(h=!0,f*=.9,p=i*f);var x=(r-p)/2>>0,g={offset:x-s,size:0};l=n.reduce((S,T)=>{var E,k={stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:g.offset+g.size+s,size:h?f:(E=T.barSize)!==null&&E!==void 0?E:0}},A=[...S,k];return g=A[A.length-1].position,A},d)}else{var b=kn(t,r,0,!0);r-2*b-(i-1)*s<=0&&(s=0);var _=(r-2*b-(i-1)*s)/i;_>1&&(_>>=0);var w=jn(a)?Math.min(_,a):_;l=n.reduce((S,T,E)=>[...S,{stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:b+(_+s)*E+(_-w)/2,size:w}}],d)}return l}}var NG=(e,t,r,n,a,i,s)=>{var l=fr(s)?t:s,d=SG(r,n,a!==i?a:i,e,l);return a!==i&&d!=null&&(d=d.map(h=>e0(e0({},h),{},{position:e0(e0({},h.position),{},{offset:h.position.offset-a/2})}))),d},EG=ke([bG,UP,eU,zP,_G,TO,mG],NG),TG=(e,t,r,n)=>Zs(e,"xAxis",t,n),CG=(e,t,r,n)=>Zs(e,"yAxis",r,n),kG=(e,t,r,n)=>Qs(e,"xAxis",t,n),AG=(e,t,r,n)=>Qs(e,"yAxis",r,n),PG=ke([EG,Ad],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),jG=(e,t)=>{var r=lw(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},OG=ke([vG,Ad],jG),DG=ke([Kr,Cy,TG,CG,kG,AG,PG,jt,dp,TO,OG,Ad,xG],(e,t,r,n,a,i,s,l,d,h,f,p,x)=>{var{chartData:g,dataStartIndex:b,dataEndIndex:_}=d;if(!(p==null||s==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||i==null||h==null)){var{data:w}=p,S;if(w!=null&&w.length>0?S=w:S=g?.slice(b,_+1),S!=null)return sG({layout:l,barSettings:p,pos:s,parentViewBox:t,bandSize:h,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:f,displayedData:S,offset:e,cells:x})}}),CO=e=>{var{chartData:t}=e,r=_r(),n=Vn();return v.useEffect(()=>n?()=>{}:(r(vT(t)),()=>{r(vT(void 0))}),[t,r,n]),null},lC={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},kO=ka({name:"brush",initialState:lC,reducers:{setBrushSettings(e,t){return t.payload==null?lC:t.payload}}}),{setBrushSettings:ole}=kO.actions,RG=kO.reducer;function IG(e,t,r){return(t=FG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FG(e){var t=MG(e,"string");return typeof t=="symbol"?t:t+""}function MG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Jw{static create(t){return new Jw(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}IG(Jw,"EPS",1e-4);function LG(e){return(e%180+180)%180}var BG=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=LG(a),s=i*Math.PI/180,l=Math.atan(n/r),d=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(d)},$G={dots:[],areas:[],lines:[]},AO=ka({name:"referenceElements",initialState:$G,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=es(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=es(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=es(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:lle,removeDot:cle,addArea:ule,removeArea:dle,addLine:fle,removeLine:hle}=AO.actions,UG=AO.reducer,zG=v.createContext(void 0),WG=e=>{var{children:t}=e,[r]=v.useState("".concat(zu("recharts"),"-clip")),n=qw();if(n==null)return null;var{x:a,y:i,width:s,height:l}=n;return v.createElement(zG.Provider,{value:r},v.createElement("defs",null,v.createElement("clipPath",{id:r},v.createElement("rect",{x:a,y:i,height:l,width:s}))),t)};function uc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function PO(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function HG(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return BG(n,r)}function KG(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:l}=e;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function oh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function VG(e,t){return PO(e,t+1)}function GG(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:l}=t,d=0,h=1,f=s,p=function(){var b=n?.[d];if(b===void 0)return{v:PO(n,h)};var _=d,w,S=()=>(w===void 0&&(w=r(b,_)),w),T=b.coordinate,E=d===0||oh(e,T,S,f,l);E||(d=0,f=s,h+=1),E&&(f=T+e*(S()/2+a),d+=h)},x;h<=i.length;)if(x=p(),x)return x.v;return[]}function cC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cC(Object(r),!0).forEach(function(n){YG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YG(e,t,r){return(t=XG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XG(e){var t=qG(e,"string");return typeof t=="symbol"?t:t+""}function qG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QG(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:l}=t,{end:d}=t,h=function(x){var g=i[x],b,_=()=>(b===void 0&&(b=r(g,x)),b);if(x===s-1){var w=e*(g.coordinate+e*_()/2-d);i[x]=g=_n(_n({},g),{},{tickCoord:w>0?g.coordinate-w*e:g.coordinate})}else i[x]=g=_n(_n({},g),{},{tickCoord:g.coordinate});var S=oh(e,g.tickCoord,_,l,d);S&&(d=g.tickCoord-e*(_()/2+a),i[x]=_n(_n({},g),{},{isShow:!0}))},f=s-1;f>=0;f--)h(f);return i}function ZG(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,{start:d,end:h}=t;if(i){var f=n[l-1],p=r(f,l-1),x=e*(f.coordinate+e*p/2-h);s[l-1]=f=_n(_n({},f),{},{tickCoord:x>0?f.coordinate-x*e:f.coordinate});var g=oh(e,f.tickCoord,()=>p,d,h);g&&(h=f.tickCoord-e*(p/2+a),s[l-1]=_n(_n({},f),{},{isShow:!0}))}for(var b=i?l-1:l,_=function(T){var E=s[T],k,A=()=>(k===void 0&&(k=r(E,T)),k);if(T===0){var j=e*(E.coordinate-e*A()/2-d);s[T]=E=_n(_n({},E),{},{tickCoord:j<0?E.coordinate-j*e:E.coordinate})}else s[T]=E=_n(_n({},E),{},{tickCoord:E.coordinate});var P=oh(e,E.tickCoord,A,d,h);P&&(d=E.tickCoord+e*(A()/2+a),s[T]=_n(_n({},E),{},{isShow:!0}))},w=0;w<b;w++)_(w);return s}function eb(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:l,interval:d,tickFormatter:h,unit:f,angle:p}=e;if(!a||!a.length||!n)return[];if(pt(d)||co.isSsr){var x;return(x=VG(a,pt(d)?d:0))!==null&&x!==void 0?x:[]}var g=[],b=l==="top"||l==="bottom"?"width":"height",_=f&&b==="width"?Du(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(E,k)=>{var A=typeof h=="function"?h(E.value,k):E.value;return b==="width"?HG(Du(A,{fontSize:t,letterSpacing:r}),_,p):Du(A,{fontSize:t,letterSpacing:r})[b]},S=a.length>=2?tn(a[1].coordinate-a[0].coordinate):1,T=KG(i,S,b);return d==="equidistantPreserveStart"?GG(S,T,w,a,s):(d==="preserveStart"||d==="preserveStartEnd"?g=ZG(S,T,w,a,s,d==="preserveStartEnd"):g=QG(S,T,w,a,s),g.filter(E=>E.isShow))}var JG=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(f=>{if(f){var p=f.getBoundingClientRect();p.width>s&&(s=p.width)}});var l=r?r.getBoundingClientRect().width:0,d=a+i,h=s+d+l+(r?n:0);return Math.round(h)}return 0},eY=["axisLine","width","height","className","hide","ticks"],tY=["viewBox"],rY=["viewBox"];function C1(e,t){if(e==null)return{};var r,n,a=nY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function nY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qo(){return qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qo.apply(null,arguments)}function uC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uC(Object(r),!0).forEach(function(n){aY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aY(e,t,r){return(t=iY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iY(e){var t=sY(e,"string");return typeof t=="symbol"?t:t+""}function sY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tb={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function oY(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:l,otherSvgProps:d}=e;if(!l)return null;var h=zr(zr(zr({},d),Ta(l)),{},{fill:"none"});if(i==="top"||i==="bottom"){var f=+(i==="top"&&!s||i==="bottom"&&s);h=zr(zr({},h),{},{x1:t,y1:r+f*a,x2:t+n,y2:r+f*a})}else{var p=+(i==="left"&&!s||i==="right"&&s);h=zr(zr({},h),{},{x1:t+p*n,y1:r,x2:t+p*n,y2:r+a})}return v.createElement("line",qo({},h,{className:$t("recharts-cartesian-axis-line",Ko(l,"className"))}))}function lY(e,t,r,n,a,i,s,l,d){var h,f,p,x,g,b,_=l?-1:1,w=e.tickSize||s,S=pt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":h=f=e.coordinate,x=r+ +!l*a,p=x-_*w,b=p-_*d,g=S;break;case"left":p=x=e.coordinate,f=t+ +!l*n,h=f-_*w,g=h-_*d,b=S;break;case"right":p=x=e.coordinate,f=t+ +l*n,h=f+_*w,g=h+_*d,b=S;break;default:h=f=e.coordinate,x=r+ +l*a,p=x+_*w,b=p+_*d,g=S;break}return{line:{x1:h,y1:p,x2:f,y2:x},tick:{x:g,y:b}}}function cY(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function uY(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function dY(e){var{option:t,tickProps:r,value:n}=e,a,i=$t(r.className,"recharts-cartesian-axis-tick-value");if(v.isValidElement(t))a=v.cloneElement(t,zr(zr({},r),{},{className:i}));else if(typeof t=="function")a=t(zr(zr({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=$t(s,t?.className)),a=v.createElement(Np,qo({},r,{className:s}),n)}return a}function fY(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:l,tickTextProps:d,orientation:h,mirror:f,x:p,y:x,width:g,height:b,tickSize:_,tickMargin:w,fontSize:S,letterSpacing:T,getTicksConfig:E,events:k}=e,A=eb(zr(zr({},E),{},{ticks:t}),S,T),j=cY(h,f),P=uY(h,f),D=Ta(E),L=Ho(r),I={};typeof n=="object"&&(I=n);var O=zr(zr({},D),{},{fill:"none"},I),M=A.map((re,oe)=>{var{line:ee,tick:fe}=lY(re,p,x,g,b,h,_,f,w),J=zr(zr(zr(zr({textAnchor:j,verticalAnchor:P},D),{},{stroke:"none",fill:a},L),fe),{},{index:oe,payload:re,visibleTicksCount:A.length,tickFormatter:i,padding:l},d);return v.createElement(hn,qo({className:"recharts-cartesian-axis-tick",key:"tick-".concat(re.value,"-").concat(re.coordinate,"-").concat(re.tickCoord)},Kh(k,re,oe)),n&&v.createElement("line",qo({},O,ee,{className:$t("recharts-cartesian-axis-tick-line",Ko(n,"className"))})),r&&v.createElement(dY,{option:r,tickProps:J,value:"".concat(typeof i=="function"?i(re.value,oe):re.value).concat(s||"")}))});return M.length>0?v.createElement("g",{className:"recharts-cartesian-axis-ticks"},M):null}var hY=v.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:l}=e,d=C1(e,eY),[h,f]=v.useState(""),[p,x]=v.useState(""),g=v.useRef(null);v.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var _;return JG({ticks:g.current,label:(_=e.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var b=v.useCallback(_=>{if(_){var w=_.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=w;var S=w[0];if(S){var T=window.getComputedStyle(S),E=T.fontSize,k=T.letterSpacing;(E!==h||k!==p)&&(f(E),x(k))}}},[h,p]);return s||n!=null&&n<=0||a!=null&&a<=0?null:v.createElement(hn,{className:$t("recharts-cartesian-axis",i),ref:b},v.createElement(oY,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Ta(e)}),v.createElement(fY,{ticks:l,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:h,letterSpacing:p,getTicksConfig:e,events:d}),v.createElement(mH,{x:e.x,y:e.y,width:e.width,height:e.height},v.createElement(EH,{label:e.label,labelRef:e.labelRef}),e.children))}),pY=v.memo(hY,(e,t)=>{var{viewBox:r}=e,n=C1(e,tY),{viewBox:a}=t,i=C1(t,rY);return uc(r,a)&&uc(n,i)}),rb=v.forwardRef((e,t)=>{var r=mn(e,tb);return v.createElement(pY,qo({},r,{ref:t}))});rb.displayName="CartesianAxis";var mY=["x1","y1","x2","y2","key"],xY=["offset"],gY=["xAxisId","yAxisId"],vY=["xAxisId","yAxisId"];function dC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dC(Object(r),!0).forEach(function(n){yY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yY(e,t,r){return(t=wY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=bY(e,"string");return typeof t=="symbol"?t:t+""}function bY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mo(){return Mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mo.apply(null,arguments)}function lh(e,t){if(e==null)return{};var r,n,a=_Y(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _Y(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SY=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:l}=e;return v.createElement("rect",{x:n,y:a,ry:l,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function jO(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:l}=t,d=lh(t,mY),h=Ta(d),{offset:f}=h,p=lh(h,xY);r=v.createElement("line",Mo({},p,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function NY(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=lh(e,gY),d=a.map((h,f)=>{var p=Tn(Tn({},l),{},{x1:t,y1:h,x2:t+r,y2:h,key:"line-".concat(f),index:f});return jO(n,p)});return v.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function EY(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:s}=e,l=lh(e,vY),d=a.map((h,f)=>{var p=Tn(Tn({},l),{},{x1:h,y1:t,x2:h,y2:t+r,key:"line-".concat(f),index:f});return jO(n,p)});return v.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function TY(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:l,horizontal:d=!0}=e;if(!d||!t||!t.length)return null;var h=l.map(p=>Math.round(p+a-a)).sort((p,x)=>p-x);a!==h[0]&&h.unshift(0);var f=h.map((p,x)=>{var g=!h[x+1],b=g?a+s-p:h[x+1]-p;if(b<=0)return null;var _=x%t.length;return v.createElement("rect",{key:"react-".concat(x),y:p,x:n,height:b,width:i,stroke:"none",fill:t[_],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function CY(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:l,verticalPoints:d}=e;if(!t||!r||!r.length)return null;var h=d.map(p=>Math.round(p+a-a)).sort((p,x)=>p-x);a!==h[0]&&h.unshift(0);var f=h.map((p,x)=>{var g=!h[x+1],b=g?a+s-p:h[x+1]-p;if(b<=0)return null;var _=x%r.length;return v.createElement("rect",{key:"react-".concat(x),x:p,y:i,width:b,height:l,stroke:"none",fill:r[_],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return v.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var kY=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return _A(eb(Tn(Tn(Tn({},tb),r),{},{ticks:SA(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},AY=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return _A(eb(Tn(Tn(Tn({},tb),r),{},{ticks:SA(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},PY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function k1(e){var t=jA(),r=OA(),n=PA(),a=Tn(Tn({},mn(e,PY)),{},{x:pt(e.x)?e.x:n.left,y:pt(e.y)?e.y:n.top,width:pt(e.width)?e.width:n.width,height:pt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:l,y:d,width:h,height:f,syncWithTicks:p,horizontalValues:x,verticalValues:g}=a,b=Vn(),_=ft(L=>cT(L,"xAxis",i,b)),w=ft(L=>cT(L,"yAxis",s,b));if(!pt(h)||h<=0||!pt(f)||f<=0||!pt(l)||l!==+l||!pt(d)||d!==+d)return null;var S=a.verticalCoordinatesGenerator||kY,T=a.horizontalCoordinatesGenerator||AY,{horizontalPoints:E,verticalPoints:k}=a;if((!E||!E.length)&&typeof T=="function"){var A=x&&x.length,j=T({yAxis:w?Tn(Tn({},w),{},{ticks:A?x:w.ticks}):void 0,width:t,height:r,offset:n},A?!0:p);$0(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(E=j)}if((!k||!k.length)&&typeof S=="function"){var P=g&&g.length,D=S({xAxis:_?Tn(Tn({},_),{},{ticks:P?g:_.ticks}):void 0,width:t,height:r,offset:n},P?!0:p);$0(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(k=D)}return v.createElement("g",{className:"recharts-cartesian-grid"},v.createElement(SY,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),v.createElement(TY,Mo({},a,{horizontalPoints:E})),v.createElement(CY,Mo({},a,{verticalPoints:k})),v.createElement(NY,Mo({},a,{offset:n,horizontalPoints:E,xAxis:_,yAxis:w})),v.createElement(EY,Mo({},a,{offset:n,verticalPoints:k,xAxis:_,yAxis:w})))}k1.displayName="CartesianGrid";var OO=(e,t,r,n)=>Zs(e,"xAxis",t,n),DO=(e,t,r,n)=>Qs(e,"xAxis",t,n),RO=(e,t,r,n)=>Zs(e,"yAxis",r,n),IO=(e,t,r,n)=>Qs(e,"yAxis",r,n),jY=ke([jt,OO,RO,DO,IO],(e,t,r,n,a)=>lo(e,"xAxis")?Vu(t,n,!1):Vu(r,a,!1)),OY=(e,t,r,n,a)=>a;function DY(e){return e.type==="line"}var RY=ke([vp,OY],(e,t)=>e.filter(DY).find(r=>r.id===t)),IY=ke([jt,OO,RO,DO,IO,RY,jY,dp],(e,t,r,n,a,i,s,l)=>{var{chartData:d,dataStartIndex:h,dataEndIndex:f}=l;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:p,data:x}=i,g;if(x!=null&&x.length>0?g=x:g=d?.slice(h,f+1),g!=null)return aX({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:p,bandSize:s,displayedData:g})}});function FY(e){var t=Ho(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),l=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(l)||l<0)&&(l=n),{r:s,strokeWidth:l}}return{r,strokeWidth:n}}var MY=["id"],LY=["type","layout","connectNulls","needClip"],BY=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function fC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fC(Object(r),!0).forEach(function(n){$Y(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Y(e,t,r){return(t=UY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UY(e){var t=zY(e,"string");return typeof t=="symbol"?t:t+""}function zY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nb(e,t){if(e==null)return{};var r,n,a=WY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qo.apply(null,arguments)}var HY=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:vc(r,t),payload:e}]};function KY(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:l,unit:d}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:vc(s,t),hide:l,type:e.tooltipType,color:e.stroke,unit:d}}}var FO=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function VY(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var GY=(e,t,r)=>{var n=r.reduce((p,x)=>p+x);if(!n)return FO(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,l=[],d=0,h=0;d<r.length;h+=r[d],++d)if(h+r[d]>i){l=[...r.slice(0,d),i-h];break}var f=l.length%2===0?[0,s]:[s];return[...VY(r,a),...l,...f].map(p=>"".concat(p,"px")).join(", ")};function YY(e,t){var r;if(v.isValidElement(e))r=v.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=$t("recharts-line-dot",typeof e!="boolean"?e.className:"");r=v.createElement(lO,Qo({},t,{className:n}))}return r}function XY(e,t){return e==null?!1:t?!0:e.length===1}function qY(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!XY(r,a))return null;var{id:l}=n,d=nb(n,MY),h=pO(a),f=Ta(d),p=tF(a),x=r.map((b,_)=>{var w=ya(ya(ya({key:"dot-".concat(_),r:3},f),p),{},{index:_,cx:b.x,cy:b.y,dataKey:i,value:b.value,payload:b.payload,points:r});return YY(a,w)}),g={clipPath:s?"url(#clipPath-".concat(h?"":"dots-").concat(t,")"):void 0};return v.createElement(hn,Qo({className:"recharts-line-dots",key:"dots"},g),x)}function QY(e){var{showLabels:t,children:r,points:n}=e,a=v.useMemo(()=>n?.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return ya(ya({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return v.createElement(sO,{value:t?a:null},r)}function hC(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:l,connectNulls:d,needClip:h}=i,f=nb(i,LY),p=ya(ya({},Kn(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:l,connectNulls:d,strokeDasharray:a??i.strokeDasharray});return v.createElement(v.Fragment,null,n?.length>1&&v.createElement(Ay,Qo({},p,{pathRef:r})),v.createElement(qY,{points:n,clipPathId:t,props:i}))}function ZY(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function JY(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:l,isAnimationActive:d,animationBegin:h,animationDuration:f,animationEasing:p,animateNewValues:x,width:g,height:b,onAnimationEnd:_,onAnimationStart:w}=r,S=a.current,T=xd(r,"recharts-line-"),[E,k]=v.useState(!1),A=!E,j=v.useCallback(()=>{typeof _=="function"&&_(),k(!1)},[_]),P=v.useCallback(()=>{typeof w=="function"&&w(),k(!0)},[w]),D=ZY(n.current),L=i.current;return v.createElement(QY,{points:s,showLabels:A},r.children,v.createElement(md,{animationId:T,begin:h,duration:f,isActive:d,easing:p,onAnimationEnd:j,onAnimationStart:P,key:T},I=>{var O=br(L,D+L,I),M=Math.min(O,D),re;if(d)if(l){var oe="".concat(l).split(/[,\s]+/gim).map(J=>parseFloat(J));re=GY(M,D,oe)}else re=FO(D,M);else re=l==null?void 0:String(l);if(S){var ee=S.length/s.length,fe=I===1?s:s.map((J,ie)=>{var Q=Math.floor(ie*ee);if(S[Q]){var te=S[Q];return ya(ya({},J),{},{x:br(te.x,J.x,I),y:br(te.y,J.y,I)})}return x?ya(ya({},J),{},{x:br(g*2,J.x,I),y:br(b/2,J.y,I)}):ya(ya({},J),{},{x:J.x,y:J.y})});return a.current=fe,v.createElement(hC,{props:r,points:fe,clipPathId:t,pathRef:n,strokeDasharray:re})}return I>0&&D>0&&(a.current=s,i.current=M),v.createElement(hC,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:re})}),v.createElement($w,{label:r.label}))}function eX(e){var{clipPathId:t,props:r}=e,n=v.useRef(null),a=v.useRef(0),i=v.useRef(null);return v.createElement(JY,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var tX=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:er(e.payload,t)});class rX extends v.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:l,left:d,width:h,height:f,id:p,needClip:x}=this.props;if(t)return null;var g=$t("recharts-line",a),b=p,{r:_,strokeWidth:w}=FY(r),S=pO(r),T=_*2+w;return v.createElement(v.Fragment,null,v.createElement(hn,{className:g},x&&v.createElement("defs",null,v.createElement(NO,{clipPathId:b,xAxisId:i,yAxisId:s}),!S&&v.createElement("clipPath",{id:"clipPath-dots-".concat(b)},v.createElement("rect",{x:d-T/2,y:l-T/2,width:h+T,height:f+T}))),v.createElement(SO,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:tX,errorBarOffset:0},v.createElement(eX,{props:this.props,clipPathId:b}))),v.createElement(bV,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var MO={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!co.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function nX(e){var t=mn(e,MO),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:l,dot:d,hide:h,isAnimationActive:f,label:p,legendType:x,xAxisId:g,yAxisId:b,id:_}=t,w=nb(t,BY),{needClip:S}=Zw(g,b),T=qw(),E=np(),k=Vn(),A=ft(I=>IY(I,g,b,k,_));if(E!=="horizontal"&&E!=="vertical"||A==null||T==null)return null;var{height:j,width:P,x:D,y:L}=T;return v.createElement(rX,Qo({},w,{id:_,connectNulls:l,dot:d,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:f,hide:h,label:p,legendType:x,xAxisId:g,yAxisId:b,points:A,layout:E,height:j,width:P,left:D,top:L,needClip:S}))}function aX(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:l,displayedData:d}=e;return d.map((h,f)=>{var p=er(h,s);if(t==="horizontal"){var x=BN({axis:r,ticks:a,bandSize:l,entry:h,index:f}),g=fr(p)?null:n.scale(p);return{x,y:g,value:p,payload:h}}var b=fr(p)?null:r.scale(p),_=BN({axis:n,ticks:i,bandSize:l,entry:h,index:f});return b==null||_==null?null:{x:b,y:_,value:p,payload:h}}).filter(Boolean)}function iX(e){var t=mn(e,MO),r=Vn();return v.createElement(Yw,{id:t.id,type:"line"},n=>v.createElement(v.Fragment,null,v.createElement(gO,{legendPayload:HY(t)}),v.createElement(Gw,{fn:KY,args:t}),v.createElement(yO,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),v.createElement(nX,Qo({},t,{id:n}))))}var LO=v.memo(iX);LO.displayName="Line";var sX=["dangerouslySetInnerHTML","ticks"],oX=["id"],lX=["domain"],cX=["domain"];function A1(){return A1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A1.apply(null,arguments)}function ch(e,t){if(e==null)return{};var r,n,a=uX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dX(e){var t=_r();return v.useLayoutEffect(()=>(t(lV(e)),()=>{t(cV(e))}),[e,t]),null}var fX=e=>{var{xAxisId:t,className:r}=e,n=ft(Cy),a=Vn(),i="xAxis",s=ft(w=>Tc(w,i,t,a)),l=ft(w=>wj(w,i,t,a)),d=ft(w=>xj(w,t)),h=ft(w=>XU(w,t)),f=ft(w=>QP(w,t));if(d==null||h==null||f==null)return null;var{dangerouslySetInnerHTML:p,ticks:x}=e,g=ch(e,sX),{id:b}=f,_=ch(f,oX);return v.createElement(rb,A1({},g,_,{scale:s,x:h.x,y:h.y,width:d.width,height:d.height,className:$t("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l}))},hX={allowDataOverflow:ma.allowDataOverflow,allowDecimals:ma.allowDecimals,allowDuplicatedCategory:ma.allowDuplicatedCategory,height:ma.height,hide:!1,mirror:ma.mirror,orientation:ma.orientation,padding:ma.padding,reversed:ma.reversed,scale:ma.scale,tickCount:ma.tickCount,type:ma.type,xAxisId:0},pX=e=>{var t,r,n,a,i,s=mn(e,hX);return v.createElement(v.Fragment,null,v.createElement(dX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(fX,s))},mX=(e,t)=>{var{domain:r}=e,n=ch(e,lX),{domain:a}=t,i=ch(t,cX);return uc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:uc({domain:r},{domain:a}):!1},P1=v.memo(pX,mX);P1.displayName="XAxis";var xX=["dangerouslySetInnerHTML","ticks"],gX=["id"],vX=["domain"],yX=["domain"];function j1(){return j1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j1.apply(null,arguments)}function uh(e,t){if(e==null)return{};var r,n,a=wX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bX(e){var t=_r();return v.useLayoutEffect(()=>(t(uV(e)),()=>{t(dV(e))}),[e,t]),null}var _X=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=v.useRef(null),s=v.useRef(null),l=ft(Cy),d=Vn(),h=_r(),f="yAxis",p=ft(A=>Tc(A,f,t,d)),x=ft(A=>gj(A,t)),g=ft(A=>QU(A,t)),b=ft(A=>wj(A,f,t,d)),_=ft(A=>ZP(A,t));if(v.useLayoutEffect(()=>{if(!(n!=="auto"||!x||Bw(a)||v.isValidElement(a)||_==null)){var A=i.current;if(A){var j=A.getCalculatedWidth();Math.round(x.width)!==Math.round(j)&&h(fV({id:t,width:j}))}}},[b,x,h,a,t,n,_]),x==null||g==null||_==null)return null;var{dangerouslySetInnerHTML:w,ticks:S}=e,T=uh(e,xX),{id:E}=_,k=uh(_,gX);return v.createElement(rb,j1({},T,k,{ref:i,labelRef:s,scale:p,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:x.width,height:x.height,className:$t("recharts-".concat(f," ").concat(f),r),viewBox:l,ticks:b}))},SX={allowDataOverflow:xa.allowDataOverflow,allowDecimals:xa.allowDecimals,allowDuplicatedCategory:xa.allowDuplicatedCategory,hide:!1,mirror:xa.mirror,orientation:xa.orientation,padding:xa.padding,reversed:xa.reversed,scale:xa.scale,tickCount:xa.tickCount,type:xa.type,width:xa.width,yAxisId:0},NX=e=>{var t,r,n,a,i,s=mn(e,SX);return v.createElement(v.Fragment,null,v.createElement(bX,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),v.createElement(_X,s))},EX=(e,t)=>{var{domain:r}=e,n=uh(e,vX),{domain:a}=t,i=uh(t,yX);return uc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:uc({domain:r},{domain:a}):!1},O1=v.memo(NX,EX);O1.displayName="YAxis";var rv={exports:{}},nv={};var pC;function TX(){if(pC)return nv;pC=1;var e=mc();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return nv.useSyncExternalStoreWithSelector=function(d,h,f,p,x){var g=a(null);if(g.current===null){var b={hasValue:!1,value:null};g.current=b}else b=g.current;g=s(function(){function w(A){if(!S){if(S=!0,T=A,A=p(A),x!==void 0&&b.hasValue){var j=b.value;if(x(j,A))return E=j}return E=A}if(j=E,r(T,A))return j;var P=p(A);return x!==void 0&&x(j,P)?(T=A,j):(T=A,E=P)}var S=!1,T,E,k=f===void 0?null:f;return[function(){return w(h())},k===null?void 0:function(){return w(k())}]},[h,f,p,x]);var _=n(d,g[0],g[1]);return i(function(){b.hasValue=!0,b.value=_},[_]),l(_),_},nv}var mC;function CX(){return mC||(mC=1,rv.exports=TX()),rv.exports}CX();function kX(e){e()}function AX(){let e=null,t=null;return{clear(){e=null,t=null},notify(){kX(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var xC={notify(){},get:()=>[]};function PX(e,t){let r,n=xC,a=0,i=!1;function s(_){f();const w=n.subscribe(_);let S=!1;return()=>{S||(S=!0,w(),p())}}function l(){n.notify()}function d(){b.onStateChange&&b.onStateChange()}function h(){return i}function f(){a++,r||(r=e.subscribe(d),n=AX())}function p(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=xC)}function x(){i||(i=!0,f())}function g(){i&&(i=!1,p())}const b={addNestedSub:s,notifyNestedSubs:l,handleChangeWrapper:d,isSubscribed:h,trySubscribe:x,tryUnsubscribe:g,getListeners:()=>n};return b}var jX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OX=jX(),DX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",RX=DX(),IX=()=>OX||RX?v.useLayoutEffect:v.useEffect,FX=IX(),MX=Symbol.for("react-redux-context"),LX=typeof globalThis<"u"?globalThis:{};function BX(){if(!v.createContext)return{};const e=LX[MX]??=new Map;let t=e.get(v.createContext);return t||(t=v.createContext(null),e.set(v.createContext,t)),t}var $X=BX();function UX(e){const{children:t,context:r,serverState:n,store:a}=e,i=v.useMemo(()=>{const d=PX(a);return{store:a,subscription:d,getServerState:n?()=>n:void 0}},[a,n]),s=v.useMemo(()=>a.getState(),[a]);FX(()=>{const{subscription:d}=i;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),s!==a.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[i,s]);const l=r||$X;return v.createElement(l.Provider,{value:i},t)}var zX=UX,WX=(e,t)=>t,ab=ke([WX,jt,YP,Gr,Mj,vs,rW,Kr],oW),ib=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},BO=Va("mouseClick"),$O=hd();$O.startListening({actionCreator:BO,effect:(e,t)=>{var r=e.payload,n=ab(t.getState(),ib(r));n?.activeIndex!=null&&t.dispatch(uz({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var D1=Va("mouseMove"),UO=hd();UO.startListening({actionCreator:D1,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Aw(n,n.tooltip.settings.shared),i=ab(n,ib(r));a==="axis"&&(i?.activeIndex!=null?t.dispatch(kj({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(Cj()))}});var gC={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},zO=ka({name:"rootProps",initialState:gC,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:gC.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),HX=zO.reducer,{updateOptions:KX}=zO.actions,WO=ka({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:VX}=WO.actions,GX=WO.reducer,HO=Va("keyDown"),KO=Va("focus"),sb=hd();sb.startListening({actionCreator:HO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Pw(a,kc(r))),l=vs(r);if(i==="Enter"){var d=rh(r,"axis","hover",String(a.index));t.dispatch(w1({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:d}));return}var h=tz(r),f=h==="left-to-right"?1:-1,p=i==="ArrowRight"?1:-1,x=s+p*f;if(!(l==null||x>=l.length||x<0)){var g=rh(r,"axis","hover",String(x));t.dispatch(w1({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});sb.startListening({actionCreator:KO,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=rh(r,"axis","hover",String(i));t.dispatch(w1({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var La=Va("externalEvent"),VO=hd();VO.startListening({actionCreator:La,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Vz(r),activeDataKey:Uj(r),activeIndex:Js(r),activeLabel:$j(r),activeTooltipIndex:Js(r),isTooltipActive:Gz(r)};e.payload.handler(n,e.payload.reactEvent)}}});var YX=ke([Cc],e=>e.tooltipItemPayloads),XX=ke([YX,Td,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(l=>l.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),GO=Va("touchMove"),YO=hd();YO.startListening({actionCreator:GO,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Aw(n,n.tooltip.settings.shared);if(a==="axis"){var i=ab(n,ib({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));i?.activeIndex!=null&&t.dispatch(kj({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,l=r.touches[0],d=document.elementFromPoint(l.clientX,l.clientY);if(!d||!d.getAttribute)return;var h=d.getAttribute(EA),f=(s=d.getAttribute(TA))!==null&&s!==void 0?s:void 0,p=XX(t.getState(),h,f);t.dispatch(Tj({activeDataKey:f,activeIndex:h,activeCoordinate:p}))}}});var qX=X4({brush:RG,cartesianAxis:hV,chartData:SW,errorBars:DV,graphicalItems:OK,layout:G8,legend:QL,options:vW,polarAxis:VH,polarOptions:GX,referenceElements:UG,rootProps:HX,tooltip:dz}),QX=function(t){return v8({reducer:qX,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([$O.middleware,UO.middleware,sb.middleware,VO.middleware,YO.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(oA({type:"raf"}))},devTools:co.devToolsEnabled})};function XO(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Vn(),i=v.useRef(null);if(a)return r;i.current==null&&(i.current=QX(t));var s=by;return v.createElement(zX,{context:s,store:i.current},r)}function qO(e){var{layout:t,margin:r}=e,n=_r(),a=Vn();return v.useEffect(()=>{a||(n(H8(t)),n(W8(r)))},[n,a,t,r]),null}function QO(e){var t=_r();return v.useEffect(()=>{t(KX(e))},[t,e]),null}var ZX=["children"];function JX(e,t){if(e==null)return{};var r,n,a=eq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function eq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dh(){return dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dh.apply(null,arguments)}var tq={width:"100%",height:"100%",display:"block"},rq=v.forwardRef((e,t)=>{var r=jA(),n=OA(),a=FA();if(!sc(r)||!sc(n))return null;var{children:i,otherAttributes:s,title:l,desc:d}=e,h,f;return typeof s.tabIndex=="number"?h=s.tabIndex:h=a?0:void 0,typeof s.role=="string"?f=s.role:f=a?"application":void 0,v.createElement(h4,dh({},s,{title:l,desc:d,role:f,tabIndex:h,width:r,height:n,style:tq,ref:t}),i)}),nq=e=>{var{children:t}=e,r=ft(tp);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return v.createElement(h4,{width:n,height:a,x:s,y:i},t)},vC=v.forwardRef((e,t)=>{var{children:r}=e,n=JX(e,ZX),a=Vn();return a?v.createElement(nq,null,r):v.createElement(rq,dh({ref:t},n),r)});function aq(){var e=_r(),[t,r]=v.useState(null),n=ft(_L);return v.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;jn(i)&&i!==n&&e(V8(i))}},[t,e,n]),r}function yC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yC(Object(r),!0).forEach(function(n){sq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sq(e,t,r){return(t=oq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oq(e){var t=lq(e,"string");return typeof t=="symbol"?t:t+""}function lq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zo.apply(null,arguments)}var cq=()=>(OW(),null);function fh(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var uq=v.forwardRef((e,t)=>{var r,n,a=v.useRef(null),[i,s]=v.useState({containerWidth:fh((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:fh((n=e.style)===null||n===void 0?void 0:n.height)}),l=v.useCallback((h,f)=>{s(p=>{var x=Math.round(h),g=Math.round(f);return p.containerWidth===x&&p.containerHeight===g?p:{containerWidth:x,containerHeight:g}})},[]),d=v.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null){var{width:f,height:p}=h.getBoundingClientRect();l(f,p);var x=b=>{var{width:_,height:w}=b[0].contentRect;l(_,w)},g=new ResizeObserver(x);g.observe(h),a.current=g}},[t,l]);return v.useEffect(()=>()=>{var h=a.current;h?.disconnect()},[l]),v.createElement(v.Fragment,null,v.createElement(ap,{width:i.containerWidth,height:i.containerHeight}),v.createElement("div",Zo({ref:d},e)))}),dq=v.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=v.useState({containerWidth:fh(r),containerHeight:fh(n)}),s=v.useCallback((d,h)=>{i(f=>{var p=Math.round(d),x=Math.round(h);return f.containerWidth===p&&f.containerHeight===x?f:{containerWidth:p,containerHeight:x}})},[]),l=v.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null){var{width:h,height:f}=d.getBoundingClientRect();s(h,f)}},[t,s]);return v.createElement(v.Fragment,null,v.createElement(ap,{width:a.containerWidth,height:a.containerHeight}),v.createElement("div",Zo({ref:l},e)))}),fq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return v.createElement(v.Fragment,null,v.createElement(ap,{width:r,height:n}),v.createElement("div",Zo({ref:t},e)))}),hq=v.forwardRef((e,t)=>{var{width:r,height:n}=e;return is(r)||is(n)?v.createElement(dq,Zo({},e,{ref:t})):v.createElement(fq,Zo({},e,{ref:t}))});function pq(e){return e===!0?uq:hq}var mq=v.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:l,onMouseDown:d,onMouseEnter:h,onMouseLeave:f,onMouseMove:p,onMouseUp:x,onTouchEnd:g,onTouchMove:b,onTouchStart:_,style:w,width:S,responsive:T,dispatchTouchEvents:E=!0}=e,k=v.useRef(null),A=_r(),[j,P]=v.useState(null),[D,L]=v.useState(null),I=aq(),O=ky(),M=O?.width>0?O.width:S,re=O?.height>0?O.height:a,oe=v.useCallback(B=>{I(B),typeof t=="function"&&t(B),P(B),L(B),B!=null&&(k.current=B)},[I,t,P,L]),ee=v.useCallback(B=>{A(BO(B)),A(La({handler:i,reactEvent:B}))},[A,i]),fe=v.useCallback(B=>{A(D1(B)),A(La({handler:h,reactEvent:B}))},[A,h]),J=v.useCallback(B=>{A(Cj()),A(La({handler:f,reactEvent:B}))},[A,f]),ie=v.useCallback(B=>{A(D1(B)),A(La({handler:p,reactEvent:B}))},[A,p]),Q=v.useCallback(()=>{A(KO())},[A]),te=v.useCallback(B=>{A(HO(B.key))},[A]),H=v.useCallback(B=>{A(La({handler:s,reactEvent:B}))},[A,s]),se=v.useCallback(B=>{A(La({handler:l,reactEvent:B}))},[A,l]),Y=v.useCallback(B=>{A(La({handler:d,reactEvent:B}))},[A,d]),ce=v.useCallback(B=>{A(La({handler:x,reactEvent:B}))},[A,x]),ue=v.useCallback(B=>{A(La({handler:_,reactEvent:B}))},[A,_]),me=v.useCallback(B=>{E&&A(GO(B)),A(La({handler:b,reactEvent:B}))},[A,E,b]),Re=v.useCallback(B=>{A(La({handler:g,reactEvent:B}))},[A,g]),U=pq(T);return v.createElement(Gj.Provider,{value:j},v.createElement(lF.Provider,{value:D},v.createElement(U,{width:M??w?.width,height:re??w?.height,className:$t("recharts-wrapper",n),style:iq({position:"relative",cursor:"default",width:M,height:re},w),onClick:ee,onContextMenu:H,onDoubleClick:se,onFocus:Q,onKeyDown:te,onMouseDown:Y,onMouseEnter:fe,onMouseLeave:J,onMouseMove:ie,onMouseUp:ce,onTouchEnd:Re,onTouchMove:me,onTouchStart:ue,ref:oe},v.createElement(cq,null),r)))}),xq=["width","height","responsive","children","className","style","compact","title","desc"];function gq(e,t){if(e==null)return{};var r,n,a=vq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZO=v.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:l,compact:d,title:h,desc:f}=e,p=gq(e,xq),x=Ta(p);return d?v.createElement(v.Fragment,null,v.createElement(ap,{width:r,height:n}),v.createElement(vC,{otherAttributes:x,title:h,desc:f},i)):v.createElement(mq,{className:s,style:l,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},v.createElement(vC,{otherAttributes:x,title:h,desc:f,ref:t},v.createElement(WG,null,i)))});function R1(){return R1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R1.apply(null,arguments)}var yq={top:5,right:5,bottom:5,left:5},wq={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:yq,reverseStackOrder:!1,syncMethod:"index",responsive:!1},JO=v.forwardRef(function(t,r){var n,a=mn(t.categoricalChartProps,wq),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,categoricalChartProps:h}=t,f={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,eventEmitter:void 0};return v.createElement(XO,{preloadedState:{options:f},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:i},v.createElement(CO,{chartData:h.data}),v.createElement(qO,{layout:a.layout,margin:a.margin}),v.createElement(QO,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(ZO,R1({},a,{ref:r})))}),bq=["axis"],_q=v.forwardRef((e,t)=>v.createElement(JO,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bq,tooltipPayloadSearcher:Lw,categoricalChartProps:e,ref:t})),Sq=["axis","item"],Nq=v.forwardRef((e,t)=>v.createElement(JO,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Sq,tooltipPayloadSearcher:Lw,categoricalChartProps:e,ref:t}));function Eq(e){var t=_r();return v.useEffect(()=>{t(VX(e))},[t,e]),null}var Tq=["layout"];function I1(){return I1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I1.apply(null,arguments)}function Cq(e,t){if(e==null)return{};var r,n,a=kq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function kq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Aq={top:5,right:5,bottom:5,left:5},Pq={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Aq,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},jq=v.forwardRef(function(t,r){var n,a=mn(t.categoricalChartProps,Pq),{layout:i}=a,s=Cq(a,Tq),{chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:f}=t,p={chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:f,eventEmitter:void 0};return v.createElement(XO,{preloadedState:{options:p},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},v.createElement(CO,{chartData:a.data}),v.createElement(qO,{layout:i,margin:a.margin}),v.createElement(QO,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),v.createElement(Eq,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),v.createElement(ZO,I1({},s,{ref:r})))}),Oq=["item"],Dq={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Rq=v.forwardRef((e,t)=>{var r=mn(e,Dq);return v.createElement(jq,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Oq,tooltipPayloadSearcher:Lw,categoricalChartProps:r,ref:t})});const or={idOrder:"id_order",idProduct:"id_product",informationOrder:"information_order",customer:"customer",contact:"contact",slot:"slot",orderDate:"order_date",days:"days",orderExpired:"order_expired",supply:"supply",cost:"cost",price:"price",note:"note",status:"status",checkFlag:"check_flag"},Fl={orderCode:"id_order",paidDate:"payment_date",amount:"amount",receiver:"receiver",note:"note",sender:"sender"},av={id:"id",sourceName:"source_name"},iv={sourceId:"source_id",price:"price"},Cr={product:"id_product",pctCtv:"pct_ctv",pctKhach:"pct_khach",isActive:"is_active",package:"package",packageProduct:"package_product",update:"update",pctPromo:"pct_promo"},Iq=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},Yi=()=>{const t=Date.now()+420*60*1e3,r=new Date(t),n=String(r.getUTCDate()).padStart(2,"0"),a=String(r.getUTCMonth()+1).padStart(2,"0"),i=r.getUTCFullYear();return`${n}/${a}/${i}`},e3=(e,t,r)=>{if(!e||!Number.isFinite(t)||t<=0)return e;const[n,a,i]=e.split("/").map(Number),s=new Date(i,a-1,n);return s.setMonth(s.getMonth()+t),s.setDate(s.getDate()-1),`${String(s.getDate()).padStart(2,"0")}/${String(s.getMonth()+1).padStart(2,"0")}/${s.getFullYear()}`},Fq=(e,t)=>{const[r,n,a]=e.split("/").map(Number),[i,s,l]=t.split("/").map(Number),d=new Date(a,n-1,r),h=new Date(l,s-1,i),f=1440*60*1e3;return Math.floor((h.getTime()-d.getTime())/f)+1},wC=e=>String(e).padStart(2,"0"),ob=e=>{if(e==null)return null;if(e instanceof Date&&!Number.isNaN(e.getTime()))return new Date(e.getFullYear(),e.getMonth(),e.getDate());const t=String(e).trim();if(!t)return null;if(/^\d{2}\/\d{2}\/\d{4}$/.test(t)){const[a,i,s]=t.split("/").map(Number);return!a||!i||!s?null:new Date(s,i-1,a)}const r=t.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r.map(Number);return!s||!i||!a?null:new Date(a,i-1,s)}const n=new Date(t);return Number.isNaN(n.getTime())?null:new Date(n.getFullYear(),n.getMonth(),n.getDate())},hr=e=>{if(typeof e=="string"){const r=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(r){const[,a,i,s]=r;return`${s}/${i}/${a}`}const n=e.match(/^(\d{4})\/(\d{2})\/(\d{2})/);if(n){const[,a,i,s]=n;return`${s}/${i}/${a}`}}const t=ob(e);return t?`${wC(t.getDate())}/${wC(t.getMonth()+1)}/${t.getFullYear()}`:""},Mq=e=>{const t=ob(e);if(!t)return!1;const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t.getTime()===r.getTime()},t3=e=>{const t=ob(e);if(!t)return null;const r=new Date;r.setHours(0,0,0,0);const n=1440*60*1e3;return Math.floor((t.getTime()-r.getTime())/n)},hh=e=>{if(!e)return 0;const t=e.match(/--(\d+)m/i);if(!t)return 0;const r=Number(t[1]||0);return Number.isFinite(r)&&r>0?r:0},Lq=e=>{if(!Number.isFinite(e)||e<=0)return 0;const t=Math.floor(e/12),r=e%12;return t*365+r*30},r3=e=>{const t=Number(e);return Number.isFinite(t)?t:0},si=e=>{const t=r3(e),r=1e3;return Number.isFinite(t)?Math.round(t/r)*r:0},Si=e=>`${si(e).toLocaleString("vi-VN")} `,bC=e=>{const t=r3(e);return t>0?t.toLocaleString("vi-VN"):""},Bq=e=>!Number.isFinite(e)||e<=0?"0":e>=1e9?`${(e/1e9).toFixed(1)}B`:e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:`${Math.round(e).toLocaleString("vi-VN")}`,n3=(e,t,r=[])=>{const n=e||"";if(!n)return;const a=r.find(l=>(l[av.sourceName]||l.name||"")===n)?.[av.id]??null;if(a!==null){const d=t.find(h=>h[iv.sourceId]===a)?.[iv.price];if(Number.isFinite(d))return Number(d)}const s=t.find(l=>(l[av.sourceName]||"")===n)?.[iv.price];return Number.isFinite(s)?Number(s):void 0},_C=e=>Math.random().toString(36).substring(2,2+e).toUpperCase(),a3=e=>i3(e).color,SC=e=>i3(e).priority,t0={PAID:" Thanh Ton",UNPAID:"Cha Thanh Ton",EXPIRED:"Ht Hn",RENEWAL:"Cn Gia Hn"},$q={[t0.EXPIRED]:{color:"bg-red-600 text-white",priority:1},[t0.RENEWAL]:{color:"bg-orange-500 text-white",priority:2},[t0.UNPAID]:{color:"bg-yellow-500 text-slate-900",priority:3},[t0.PAID]:{color:"bg-green-600 text-white",priority:4}},i3=e=>$q[e?.trim()]||{color:"bg-slate-600 text-white",priority:5},lb=({accountNumber:e,bankCode:t,amount:r,description:n})=>{const a=(e||"").trim(),i=(t||"").trim();if(!a||!i)return"";const s=new URLSearchParams;s.set("acc",a),s.set("bank",i);const l=Number(r);Number.isFinite(l)&&l>0&&s.set("amount",Math.round(l).toString());const d=(n||"").trim();return d&&s.set("des",d),`https://qr.sepay.vn/img?${s.toString()}`},s3=async e=>{const t=e.headers.get("content-type")||"",r=await e.text();if(r)try{return{data:JSON.parse(r),rawText:r,contentType:t}}catch{}return{data:null,rawText:r,contentType:t}},Uq=e=>e?e.replace(/<[^>]+>/g," ").replace(/&[^;\s]+;/g," ").replace(/\s+/g," ").trim():"",Jo=(e,t={})=>{const{fallback:r=" xy ra li. Vui lng th li sau.",blockPatterns:n}=t,a=Uq(e);return!a||Array.isArray(n)&&n.some(i=>i.test(a))?r:a},o3=Si,l3=e=>Number.isFinite(e)?`${e>=0?"+":"-"}${Math.abs(e).toFixed(1)}%`:"N/A",c3=(e,t)=>t!==0?(e-t)/t*100:e>0?100:0,sv=(e,t,r,n)=>{const a=Number.isFinite(Number(t))?Number(t):0,i=Number.isFinite(Number(r))?Number(r):0,s=n?o3(a):a.toLocaleString("vi-VN"),l=c3(a,i);return{name:e,value:s,change:l3(l),changeType:l>=0?"increase":"decrease"}},zq=[{title:"Tng chi tiu",value:"89,935",delta:"+1.01% thng ny",trend:"up",accent:"amber",icon:T0},{title:"Tng thu nhp",value:"23,283.5",delta:"+0.49% thng ny",trend:"up",accent:"emerald",icon:T0}],Wq=[{name:"Nh ca & Tin ch",value:8e6,color:"#F8C573"},{name:"Thc phm",value:512e4,color:"#9BE7C4"},{name:"Chm sc c nhn",value:538e4,color:"#7CB3FF"},{name:"Ph kin",value:412e4,color:"#F48FB1"},{name:"Dch v khc",value:303e4,color:"#C7D2FE"}],r0=["#F8C573","#9BE7C4","#7CB3FF","#F48FB1","#C7D2FE","#A5B4FC","#F9A8D4"],Hi=e=>{const t=(e.name||"").toLowerCase(),r=(e.note||"").toLowerCase();return t.includes("hana")||r.includes("chu")},Hq=[{name:"Nh ca & Tin ch",used:315e4,total:45e5},{name:"Thc phm & Thit yu",used:226e4,total:45e5},{name:"Chm sc c nhn",used:189e4,total:45e5},{name:"Ph kin",used:152e4,total:45e5}],Kq=[{name:"Laptop mi",progress:50,saved:3375e3,target:675e4,accent:"#f8c573"},{name:"Du lch",progress:70,saved:474e4,target:675e4,accent:"#9be7c4"}],Vq=[{time:"01/12/2025",momo:15e5,bank:325e4,supper:22e5,gold:18e5},{time:"05/12/2025",momo:9e5,bank:2e6,supper:16e5,gold:145e4},{time:"10/12/2025",momo:125e4,bank:28e5,supper:21e5,gold:17e5},{time:"14/12/2025",momo:11e5,bank:26e5,supper:185e4,gold:15e5}],Do=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),NC=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:2}),Gq=new Intl.NumberFormat("vi-VN",{maximumFractionDigits:1}),Yq=e=>{const t=e.replace(/[^\d-]/g,"");if(!t)return"";const r=t.startsWith("-")?"-":"",n=t.replace(/-/g,""),i=(n?Number(n):0).toLocaleString("en-US");return`${r}${i}`},Xq=({title:e,value:t,delta:r,trend:n,accent:a,icon:i})=>{const s=a==="amber"?{iconBg:"bg-amber-100 text-amber-600",chip:"bg-amber-50 text-amber-700"}:{iconBg:"bg-emerald-100 text-emerald-600",chip:"bg-emerald-50 text-emerald-700"},l=n==="up"?T0:qI;return c.jsxs("div",{className:"stats-card p-5 flex items-center justify-between gap-4 bg-white/70 border border-white/40 shadow-lg",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.12em] text-white/70",children:e}),c.jsx("p",{className:"text-3xl font-bold text-white",children:t}),c.jsxs("div",{className:`inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold ${s.chip}`,children:[c.jsx(l,{className:"h-4 w-4"}),c.jsx("span",{children:r})]})]}),c.jsx("div",{className:`h-12 w-12 rounded-2xl flex items-center justify-center ${s.iconBg}`,children:c.jsx(i,{className:"h-6 w-6"})})]})},qq=({name:e,used:t,total:r})=>{const n=Math.min(100,Math.round(t/r*100)),a=r-t;return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold text-white",children:[c.jsx("span",{children:e}),c.jsxs("span",{children:[n,"%"]})]}),c.jsx("div",{className:"h-2 rounded-full bg-slate-200",children:c.jsx("div",{className:"h-full rounded-full bg-slate-900",style:{width:`${n}%`}})}),c.jsxs("p",{className:"text-xs text-white/70",children:["Cn li ",Do.format(a)," / ",Do.format(r)]})]})},Qq=({progress:e,color:t})=>c.jsxs("div",{className:"relative h-14 w-14",children:[c.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`conic-gradient(${t} ${e}%, #e2e8f0 ${e}%)`}}),c.jsxs("div",{className:"absolute inset-[6px] rounded-full bg-slate-900 border border-white/10 flex items-center justify-center text-xs font-semibold text-white shadow-inner shadow-black/30",children:[Math.round(e),"%"]})]}),Zq=()=>{const e=v.useMemo(()=>new Date().getFullYear(),[]),[t,r]=v.useState([]),[n,a]=v.useState([]),[i,s]=v.useState([]),[l,d]=v.useState([]),[h,f]=v.useState(e),[p,x]=v.useState(!0),[g,b]=v.useState(null),[_,w]=v.useState("overview"),[S,T]=v.useState(Vq),[E,k]=v.useState(null),[A]=v.useState(()=>hr(new Date)),[j,P]=v.useState([]),[D,L]=v.useState(!1),[I,O]=v.useState(null),[M,re]=v.useState([]),[oe,ee]=v.useState([]),[fe,J]=v.useState(!1),[ie,Q]=v.useState(null),[te,H]=v.useState({}),[se,Y]=v.useState(null),ce=async le=>{x(!0),b(null);try{const De=await Ct("/api/dashboard/stats");if(!De.ok){const Le=await De.text();throw new Error(Jo(Le,{fallback:"Khng th ti thng k tng quan."}))}const Ue=await De.json(),Ce=[{...sv("Tng n hng",Ue.totalOrders.current,Ue.totalOrders.previous,!1),icon:uy,accent:Rr.sky},{name:"n sp ht hn",value:Ue.overdueOrders.count.toLocaleString("vi-VN"),change:"Cn x l",changeType:"alert",icon:n4,accent:Rr.rose},{...sv("Tng nhp hng",Ue.totalImports.current,Ue.totalImports.previous,!0),icon:ay,accent:Rr.amber},{...sv("Tng li nhun",Ue.totalProfit.current,Ue.totalProfit.previous,!0),icon:a4,accent:Rr.emerald}];r(Ce);const Ae=await X6(le);a(Ae.revenueData),s(Ae.orderStatusData);const ve=Ae.orderStatusData.filter(Le=>Number.isFinite(Number(Le.total_orders)));if(ve.length>=2){const Le=Number(ve[ve.length-1].total_orders)||0,pe=Number(ve[ve.length-2].total_orders)||0,tt=c3(Le,pe);r(Ye=>Ye.map((Be,ot)=>ot===0?{...Be,change:l3(tt),changeType:tt>=0?"increase":"decrease"}:Be))}}catch(De){console.error("Li khi ly d liu dashboard:",De),b(De instanceof Error?Jo(De.message,{fallback:" c li khi ti d liu dashboard. Vui lng th li sau."}):" c li khi ti d liu dashboard. Vui lng th li sau.")}finally{x(!1)}},ue=v.useCallback(async le=>{L(!0),O(null);try{const De=le&&le.trim()?`https://api.hanagold.vn/app/setting/get-chart-gold?date=${encodeURIComponent(le.trim())}`:"https://api.hanagold.vn/app/setting/get-chart-gold",Ue=await fetch(De);if(!Ue.ok)throw new Error(`HTTP ${Ue.status}`);const Ce=await Ue.json();if(!Ce||Ce.signal!==1||!Array.isArray(Ce.data))throw new Error("Du lieu khong hop le");const Ae=[];Ce.data.forEach(ve=>{const Le=ve?.time??"";(Array.isArray(ve?.data)?ve.data:[]).forEach(tt=>{(Array.isArray(tt?.main_gold_price)?tt.main_gold_price:[]).forEach(Be=>{const ot=Number(Be?.ask??NaN),et=Number(Be?.bid??NaN);if(!Number.isFinite(ot)||!Number.isFinite(et))return;const Je=ot*1e6,Ze=et*1e6;Ae.push({time:Le,group:tt?.name??"",displayName:Be?.display_name??Be?.name??"",ask:Je,bid:Ze,trendAsk:Be?.trend?.ask,trendBid:Be?.trend?.bid})})})}),P(Ae)}catch(De){console.error("Li khi ly gi vng HanaGold:",De),O(De instanceof Error?De.message:"Khng th ly d liu gi vng.")}finally{L(!1)}},[]),me=v.useCallback(async le=>{const De=le&&le.trim()?`https://api.hanagold.vn/app/setting/get-chart-gold?date=${encodeURIComponent(le.trim())}`:"https://api.hanagold.vn/app/setting/get-chart-gold",Ue=await fetch(De);if(!Ue.ok)throw new Error(`HTTP ${Ue.status}`);const Ce=await Ue.json();if(!Ce||Ce.signal!==1||!Array.isArray(Ce.data))return null;let Ae=null;return Ce.data.forEach(ve=>{(Array.isArray(ve?.data)?ve.data:[]).forEach(pe=>{(Array.isArray(pe?.main_gold_price)?pe.main_gold_price:[]).forEach(Ye=>{const ot=Number(Ye?.ask??NaN)*1e6;if(!Number.isFinite(ot))return;`${Ye?.display_name||Ye?.name||""} ${pe?.name||""}`.toLowerCase().includes("kim kh")&&(Ae=ot),Ae===null&&(Ae=ot)})})}),Ae===null?null:Ae/10},[]),Re=v.useCallback(async()=>{J(!0),Q(null);try{const le=await Ct("/api/wallets/daily-balances");if(!le.ok)throw new Error(`HTTP ${le.status}`);const De=await le.json(),Ue=Array.isArray(De?.wallets)?De.wallets:[],Ce=Array.isArray(De?.rows)?De.rows:[];re(Ue),ee(Ce)}catch(le){console.error("Failed to fetch wallet balances:",le),Q("Khng th ti d liu dng tin.")}finally{J(!1)}},[]);v.useEffect(()=>{(async()=>{try{const De=await q6();De.length>0?(d(De),f(Ue=>De.includes(Ue)?Ue:De[0])):(d([e]),f(e))}catch(De){console.error("Li khi ly danh sch nm Dashboard:",De),d([e]),f(e)}})()},[e]),v.useEffect(()=>{ce(h)},[h]),v.useEffect(()=>{ue("")},[ue]),v.useEffect(()=>{Re()},[Re]),v.useEffect(()=>{let le=!1;const De=async()=>{const Ue=oe.map(Ae=>z(Ae.recordDate)).filter(Ae=>Ae&&!te[Ae]),Ce=Array.from(new Set(Ue));for(const Ae of Ce)try{const ve=await me(Ae);!le&&ve!==null&&H(Le=>({...Le,[Ae]:ve}))}catch{console.warn("Failed to fetch gold price for",Ae)}};return oe.length&&De(),()=>{le=!0}},[oe,te,me]);const U=v.useMemo(()=>{if(!oe.length||!M.length)return[];const le=oe[0],De=M.filter(Hi),Ue=De[0],Ce={};oe.forEach(pe=>{M.forEach(tt=>{const Ye=Number(pe.values[tt.field]||0);Ce[tt.field]=(Ce[tt.field]||0)+Ye})});const Ae=De.reduce((pe,tt)=>pe+(Number(le.values[tt.field]||0)||0),0),ve=De.reduce((pe,tt)=>pe+(Ce[tt.field]||0),0),Le=De.some(pe=>(pe.note||"").toLowerCase().includes("chu"));return M.filter(pe=>!Hi(pe)||Ue&&pe.field===Ue.field).map((pe,tt)=>{if(Hi(pe)){const ot=Le?ve:Ae;return{name:pe.name||pe.field,value:ot,color:r0[tt%r0.length]}}const Be=(pe.note||"").toLowerCase().includes("chu")?Number(Ce[pe.field]||0):Number(le.values[pe.field]||0);return{name:pe.name||pe.field,value:Be,color:r0[tt%r0.length]}}).filter(pe=>pe.value>0)},[oe,M]),B=U.length?U:Wq,K=v.useMemo(()=>B.reduce((le,De)=>le+De.value,0),[B]),z=v.useCallback(le=>{const De=typeof le=="string"?new Date(le):le;return hr(De)||(typeof le=="string"?le:"")},[]),ne=v.useMemo(()=>{if(!j.length)return[];const le=j[j.length-1]?.time||"";return j.filter(De=>{const Ue=De.time===le,Ce=`${De.displayName||De.name||""}`.toLowerCase(),Ae=`${De.group||""}`.toLowerCase(),ve=Ce.includes("kim kh")||Ce.includes("kht")||Ae.includes("kim kh");return Ue&&ve})},[A,j]),Oe=()=>{const le={};M.forEach(De=>{le[De.field]=""}),Y({recordDate:"",values:le})},Pe=(le,De)=>{Y(Ue=>Ue&&{...Ue,values:{...Ue.values,[le]:Yq(De)}})},we=le=>{Y(De=>De&&{...De,recordDate:le})},xe=()=>{if(!se)return;const le=Ae=>{const ve=(Ae||"").replace(/[^\d-]/g,""),Le=Number(ve||0);return Number.isFinite(Le)?Le:0},De={};M.forEach(Ae=>{const ve=se.values[Ae.field]||"";ve.replace(/[^\d-]/g,"")&&(De[Ae.field]=le(ve))});const Ue=se.recordDate||hr(new Date)||"";if(Object.keys(De).length===0){Y(null);return}(async()=>{J(!0);try{const Ae=await Ct("/api/wallets/daily-balances",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordDate:Ue,values:De})});if(!Ae.ok)throw new Error(`HTTP ${Ae.status}`);await Re()}catch(Ae){console.error("Failed to save wallet balances:",Ae),ee(ve=>[...ve,{recordDate:Ue,values:De}]),Q("Khong the luu len server, chi hien thi tam thoi.")}finally{J(!1),Y(null)}})()},Ee=()=>Y(null);return p?c.jsx("div",{className:"py-10 text-center",children:c.jsx("p",{className:"text-lg font-medium text-white/80",children:"ang ti d liu dashboard..."})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"rounded-2xl bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white sm:p-8",children:[c.jsx("h1",{className:"text-3xl font-bold",children:"Bng iu Khin"}),c.jsx("p",{className:"text-sm text-blue-100",children:"Tng quan hot ng kinh doanh ca bn"})]}),c.jsx("div",{className:"w-full grid grid-cols-2 gap-3 rounded-2xl border border-white/15 bg-white/5 p-3 shadow-[0_16px_45px_-28px_rgba(0,0,0,0.55)]",children:[{key:"overview",label:"Tng quan"},{key:"finance",label:"Chi tiu & Ngn sch"}].map(le=>{const De=_===le.key;return c.jsx("button",{onClick:()=>w(le.key),className:`w-full rounded-full px-4 py-3 text-sm font-semibold transition shadow-sm ${De?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-[0_10px_30px_-18px_rgba(59,130,246,0.8)]":"bg-white/10 text-white/80 hover:bg-white/20"}`,children:le.label},le.key)})}),g&&c.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 text-red-700",children:g}),_==="overview"&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:c.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:t.map((le,De)=>c.jsx(Qi,{title:le.name,value:le.value,icon:le.icon,accent:le.accent,children:c.jsx("div",{className:`flex items-center text-sm font-semibold ${le.changeType==="increase"?"text-emerald-200":le.changeType==="decrease"?"text-rose-200":"text-amber-200"}`,children:le.changeType==="alert"?c.jsx("span",{className:"uppercase tracking-wide",children:"Alert"}):le.changeType==="increase"?c.jsxs(c.Fragment,{children:[c.jsx(sy,{className:"mr-1 h-4 w-4"}),le.change]}):c.jsxs(c.Fragment,{children:[c.jsx(iy,{className:"mr-1 h-4 w-4"}),le.change]})})},`${le.name}-${De}`))})}),c.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-2",children:[c.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[c.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Doanh thu theo thng (Tng gi bn)"}),c.jsx("select",{className:"rounded-2xl border border-white/60 bg-white/80 px-3 py-1 text-sm text-white/80 shadow-inner focus:outline-none focus:ring-2 focus:ring-sky-200 focus:border-sky-300",value:h,onChange:le=>f(Number(le.target.value)),children:l.length===0?c.jsx("option",{value:h,children:h}):l.map(le=>c.jsx("option",{value:le,children:le},le))})]}),c.jsx("div",{className:"w-full",children:c.jsx(Ag,{width:"100%",height:320,children:c.jsxs(_q,{data:n,children:[c.jsx(k1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),c.jsx(P1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),c.jsx(O1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12},tickFormatter:le=>`${Math.round(le/1e6)}M`}),c.jsx(Kg,{formatter:le=>[o3(le),"Doanh thu"],labelStyle:{color:"#111827"}}),c.jsx(LO,{type:"monotone",dataKey:"total_sales",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},activeDot:{r:6,stroke:"#2563eb",strokeWidth:2}})]})})})]}),c.jsxs("div",{className:"relative rounded-3xl border border-white/20 bg-gradient-to-br from-indigo-200/40 via-indigo-300/35 to-slate-200/40 p-6 shadow-[0_20px_55px_-28px_rgba(0,0,0,0.65),0_14px_36px_-24px_rgba(255,255,255,0.2)] backdrop-blur",children:[c.jsx("h3",{className:"mb-6 text-lg font-semibold text-white",children:"Tng n hng v n hy theo thng"}),c.jsx("div",{className:"w-full",children:c.jsx(Ag,{width:"100%",height:320,children:c.jsxs(Nq,{data:i,children:[c.jsx(k1,{strokeDasharray:"3 3",stroke:"#cbd5e166"}),c.jsx(P1,{dataKey:"month",stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),c.jsx(O1,{stroke:"#e5e7eb",tick:{fill:"#e5e7eb",fontSize:12}}),c.jsx(Kg,{formatter:(le,De,Ue)=>[le,Ue?.dataKey==="total_orders"?"Tong don":"Don huy"],labelStyle:{color:"#111827"}}),c.jsx(T1,{dataKey:"total_orders",name:"Tng n",fill:"#3b82f6",radius:[4,4,0,0]}),c.jsx(T1,{dataKey:"total_canceled",name:"n hy",fill:"#ef4444",radius:[4,4,0,0]})]})})})]})]})]}),_==="finance"&&c.jsxs("div",{className:"space-y-6 rounded-[32px] bg-white/5 border border-white/10 p-6 shadow-[0_24px_60px_-34px_rgba(0,0,0,0.7)] backdrop-blur",children:[c.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:zq.map(le=>c.jsx(Xq,{...le},le.title))}),c.jsxs("div",{className:"rounded-3xl border border-white/15 bg-gradient-to-br from-slate-800/60 via-slate-700/50 to-slate-900/60 p-6 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.75),0_14px_36px_-24px_rgba(255,255,255,0.2)]",children:[c.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3 mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Bng gi HanaGold"}),c.jsx("p",{className:"text-xs text-white/70",children:"Mua/Bn theo ngy (ask/bid)"})]}),c.jsx("button",{type:"button",onClick:()=>ue(""),className:"rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white hover:bg-white/20 border border-white/20",children:"Lm mi"})]}),I&&c.jsx("div",{className:"mb-3 rounded-lg border border-amber-300/60 bg-amber-50/10 px-3 py-2 text-sm text-amber-200",children:I}),c.jsx("div",{className:"overflow-x-auto rounded-2xl border border-white/10 bg-white/5",children:c.jsxs("table",{className:"min-w-full text-sm text-white",children:[c.jsx("thead",{className:"bg-white/10 text-xs uppercase tracking-[0.08em] text-white/80",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left",children:"Mc"}),c.jsx("th",{className:"px-3 py-2 text-left",children:"Nhm"}),c.jsx("th",{className:"px-3 py-2 text-right",children:"Mua (bid)"}),c.jsx("th",{className:"px-3 py-2 text-right",children:"Bn (ask)"}),c.jsx("th",{className:"px-3 py-2 text-center",children:"Xu hng"})]})}),c.jsxs("tbody",{className:"divide-y divide-white/10",children:[D&&c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:5,children:"ang ti gi vng..."})}),!D&&ne.length===0&&c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:5,children:"Cha c d liu cho ngy  chn."})}),!D&&ne.map((le,De)=>c.jsxs("tr",{className:"hover:bg-white/5",children:[c.jsx("td",{className:"px-3 py-2 font-semibold",children:le.displayName||"Khng tn"}),c.jsx("td",{className:"px-3 py-2 text-white/80",children:le.group||"-"}),c.jsxs("td",{className:"px-3 py-2 text-right",children:[(le.bid/10).toLocaleString("vi-VN")," "]}),c.jsxs("td",{className:"px-3 py-2 text-right",children:[(le.ask/10).toLocaleString("vi-VN")," "]}),c.jsx("td",{className:"px-3 py-2 text-center",children:c.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-[11px] font-semibold ${le.trendBid==="up"?"bg-emerald-500/20 text-emerald-200":le.trendBid==="down"?"bg-rose-500/20 text-rose-200":"bg-white/10 text-white/80"}`,children:le.trendBid==="up"?"Tng":le.trendBid==="down"?"Gim":"n nh"})})]},`${le.displayName}-${le.time}-${De}`))]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-[1.7fr_1fr]",children:[c.jsxs("div",{className:"rounded-3xl bg-white/70 p-6 space-y-6 shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiu hng thng"}),c.jsx("p",{className:"text-xs text-white/70",children:"Tng quan thng hin ti"})]}),c.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-indigo-500/30 px-3 py-1 text-xs font-semibold text-white shadow-inner shadow-indigo-900/30",children:[c.jsx(yS,{className:"h-4 w-4"}),c.jsx("span",{children:"ang theo di"})]})]}),c.jsxs("div",{className:"grid items-center gap-6 lg:grid-cols-[1.1fr_1fr]",children:[c.jsxs("div",{className:"relative h-72 w-full",children:[c.jsx(Ag,{width:"100%",height:"100%",children:c.jsxs(Rq,{children:[c.jsx(wO,{data:B,dataKey:"value",nameKey:"name",innerRadius:"60%",outerRadius:"85%",paddingAngle:4,cornerRadius:12,stroke:"none",children:B.map(le=>c.jsx(kd,{fill:le.color},le.name))}),c.jsx(Kg,{formatter:le=>Do.format(le),contentStyle:{background:"#ffffff",border:"1px solid #e2e8f0",borderRadius:12,color:"#0f172a"}})]})}),c.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center text-center",children:c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-white",children:Do.format(K)}),c.jsx("p",{className:"text-sm text-white/70",children:"Tng"})]})})]}),c.jsxs("div",{className:"space-y-2 rounded-2xl border border-white/10 bg-white/80 p-3 shadow-inner",children:[c.jsxs("div",{className:"grid grid-cols-12 text-xs font-semibold text-white/75",children:[c.jsx("span",{className:"col-span-6",children:"Nhm"}),c.jsx("span",{className:"col-span-4 text-right",children:"Gi tr"}),c.jsx("span",{className:"col-span-2 text-right",children:"%"})]}),B.map(le=>{const De=le.value/K*100;return c.jsxs("div",{className:"grid grid-cols-12 items-center rounded-xl px-3 py-2 transition-colors hover:bg-white/60",children:[c.jsxs("div",{className:"col-span-6 flex items-center gap-2 text-sm font-semibold text-white",children:[c.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:le.color}}),le.name]}),c.jsx("div",{className:"col-span-4 text-right text-sm font-semibold text-white",children:Do.format(le.value)}),c.jsxs("div",{className:"col-span-2 text-right text-xs text-white/75",children:[Gq.format(De),"%"]})]},le.name)})]})]}),c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/70 p-4 shadow-inner space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Dng Tin"}),c.jsx("span",{className:"text-xs text-white/70",children:"Tng hp theo ngun"})]}),c.jsxs("button",{type:"button",onClick:Oe,className:"inline-flex items-center gap-2 rounded-lg bg-white/10 px-3 py-2 text-xs font-semibold text-white/80 hover:bg-white/20 border border-white/20 transition-colors",children:[c.jsx(Ai,{className:"h-4 w-4"}),c.jsx("span",{children:"Thm dng"})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"min-w-full text-sm",children:[c.jsx("thead",{className:"bg-white/40 text-white/80 text-xs uppercase tracking-[0.08em]",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Thi gian"}),M.filter((le,De,Ue)=>{if(!Hi(le))return!0;const Ce=Ue.findIndex(Ae=>Hi(Ae));return De===Ce}).map(le=>c.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:le.name||"-"},le.field))]})}),c.jsxs("tbody",{className:"divide-y divide-white/40 text-white",children:[se&&c.jsxs(c.Fragment,{children:[c.jsxs("tr",{className:"bg-white/10",children:[c.jsx("td",{className:"px-3 py-2",children:c.jsx("input",{type:"date",value:se.recordDate,onChange:le=>we(le.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-2 py-1 text-sm text-white focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400"})}),M.map(le=>c.jsx("td",{className:"px-3 py-2",children:c.jsx("input",{type:"text",inputMode:"decimal",value:se.values[le.field]??"",onChange:De=>Pe(le.field,De.target.value),className:"w-full rounded-lg border border-white/30 bg-white/10 px-2 py-1 text-right text-sm text-white focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400"})},le.field))]}),c.jsx("tr",{className:"bg-white/5",children:c.jsx("td",{className:"px-3 py-2 text-right text-xs font-semibold text-white/70",colSpan:M.length+1,children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{type:"button",onClick:Ee,className:"rounded-lg border border-white/20 bg-white/10 px-3 py-1 text-xs font-semibold text-white/80 hover:bg-white/20",children:"Hy"}),c.jsx("button",{type:"button",onClick:xe,className:"rounded-lg border border-blue-400 bg-blue-500/80 px-3 py-1 text-xs font-semibold text-white hover:bg-blue-500",children:"Lu"})]})})})]}),fe&&c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:M.length+1,children:"ang ti d liu..."})}),!fe&&oe.map(le=>{const De=z(le.recordDate),Ue=M.filter(Hi),Ce=Ue[0]?.field,Ae=Ue.reduce((pe,tt)=>pe+(Number(le.values[tt.field]||0)||0),0),ve=te[z(le.recordDate)],Le=ve&&ve>0?Ae/ve:null;return c.jsxs("tr",{className:"hover:bg-white/50 transition-colors",children:[c.jsx("td",{className:"px-3 py-2 font-semibold",children:De}),M.filter((pe,tt,Ye)=>{if(!Hi(pe))return!0;const Be=Ye.findIndex(ot=>Hi(ot));return tt===Be}).map(pe=>{const tt=Number(le.values[pe.field]||0),Ye=Hi(pe)&&pe.field===Ce;return c.jsx("td",{className:"px-3 py-2 text-right text-white/90",children:Ye?c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{children:NC.format(Ae)}),c.jsx("div",{className:"text-xs text-white/70",children:Le?`${Le.toFixed(3)} ch`:"-"})]}):NC.format(tt)},pe.field)})]},le.recordDate)}),!fe&&oe.length===0&&c.jsx("tr",{children:c.jsx("td",{className:"px-3 py-3 text-center text-white/70",colSpan:M.length+1,children:"Cha c d liu."})})]})]}),ie&&c.jsx("div",{className:"mt-3 rounded-lg border border-amber-300/60 bg-amber-50/10 px-3 py-2 text-sm text-amber-200",children:ie})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"stats-card bg-white/80 p-4 flex items-start gap-3 shadow-xl",children:[c.jsx("div",{className:"h-10 w-10 rounded-full bg-white flex items-center justify-center border border-amber-100",children:c.jsx(r6,{className:"h-5 w-5 text-amber-700"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tiu thc phm tng 20% trong thng ny"}),c.jsx("p",{className:"text-xs text-amber-700",children:"Xem li hn mc  trnh vt ngn sch."})]})]}),c.jsxs("div",{className:"stats-card bg-white/80 p-5 space-y-4 shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Ngn sch"}),c.jsx(y6,{className:"h-5 w-5 text-white/70"})]}),c.jsx("div",{className:"space-y-3",children:Hq.map(le=>c.jsx(qq,{...le},le.name))}),c.jsx("button",{type:"button",className:"w-full rounded-xl bg-slate-900 py-3 text-sm font-semibold text-white shadow-[0_12px_30px_-18px_rgba(15,23,42,0.45)] hover:bg-slate-800 transition-colors",children:"To ngn sch"})]}),c.jsxs("div",{className:"stats-card bg-white/80 p-5 space-y-4 shadow-xl",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Mc tiu tit kim"}),c.jsx(l6,{className:"h-5 w-5 text-emerald-500"})]}),c.jsx("div",{className:"space-y-3",children:Kq.map(le=>c.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-white/40 bg-white/60 px-3 py-2 shadow-[0_12px_32px_-26px_rgba(0,0,0,0.35)]",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Qq,{progress:le.progress,color:le.accent}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:le.name}),c.jsxs("p",{className:"text-xs text-white/75",children:[Do.format(le.saved)," / ",Do.format(le.target)]})]})]}),c.jsx(yS,{className:"h-5 w-5 text-white/70"})]},le.name))}),c.jsx("button",{type:"button",className:"w-full rounded-xl bg-slate-900/80 py-3 text-sm font-semibold text-white border border-white/30 hover:bg-slate-900 transition-colors shadow-[0_12px_30px_-24px_rgba(0,0,0,0.45)]",children:"t mc tiu mi"})]})]})]})]})]})},Jq={ID_ORDER:or.idOrder,ID_PRODUCT:or.idProduct,INFORMATION_ORDER:or.informationOrder,CUSTOMER:or.customer,CONTACT:or.contact,SLOT:or.slot,ORDER_DATE:or.orderDate,DAYS:or.days,ORDER_EXPIRED:or.orderExpired,SUPPLY:or.supply,COST:or.cost,PRICE:or.price,NOTE:or.note,STATUS:or.status,CHECK_FLAG:or.checkFlag,REFUND:or.refund},kt={ORDERS:"/api/orders",ORDER_BY_ID:e=>`/api/orders/${e}`,ORDER_RENEW:e=>`/api/orders/${encodeURIComponent(e)}/renew`,ORDER_EXPRIED:"/api/orders/expired",ORDERS_EXPIRED:"/api/orders/expired",ORDERS_CANCELED:"/api/orders/canceled",ORDER_CANCELED_REFUND:e=>`/api/orders/canceled/${e}/refund`,SUPPLIES:"/api/supplies",PRODUCTS_BY_SUPPLY:e=>`/api/supplies/${e}/products`,CALCULATE_PRICE:"/api/orders/calculate-price",PRODUCTS_ALL:"/api/products",PRODUCT_DESCRIPTIONS:"/api/product-descriptions",PRODUCT_PRICES:"/api/product-prices",PRODUCT_PRICE_DETAIL:e=>`/api/product-prices/${e}`,SUPPLIES_BY_PRODUCT:e=>`/api/products/supplies-by-name/${encodeURIComponent(e)}`,SUPPLY_PRICES_BY_PRODUCT_NAME:e=>`/api/products/all-prices-by-name/${encodeURIComponent(e)}`,UPDATE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}/price`,CREATE_SUPPLY_PRICE:e=>`/api/product-prices/${e}/suppliers`,DELETE_SUPPLY_PRICE:(e,t)=>`/api/products/${e}/suppliers/${t}`,PAYMENT_RECEIPTS:"/api/payment-receipts",PURCHASE_ORDERS:"/api/purchase-orders",REFUNDS:"/api/refunds",BANK_LIST:"/api/banks",WAREHOUSE:"/api/warehouse"},G=Jq,It={SO_NGAY_CON_LAI:"so_ngay_con_lai_virtual",GIA_TRI_CON_LAI:"gia_tri_con_lai_virtual",TRANG_THAI_TEXT:"trang_thai_text_virtual",CHECK_FLAG_STATUS:"check_flag_status_virtual",ORDER_DATE_DISPLAY:"order_date_display_virtual",EXPIRY_DATE_DISPLAY:"expiry_date_display_virtual"},oi={ORDER_EXPIRED:"Ht Hn",CAN_GIA_HAN:"Cn Gia Hn",CHUA_THANH_TOAN:"Cha Thanh Ton",DA_THANH_TOAN:" Thanh Ton"},u3={active:{label:"n Hng",description:"Danh sch n ang hot ng",endpoint:kt.ORDERS},expired:{label:"Ht Hn",description:"Danh sch cc n hng  ht hn",endpoint:kt.ORDERS_EXPIRED},canceled:{label:"Hon Tin",description:"n  hy/hon tin",endpoint:kt.ORDERS_CANCELED}},eQ=["active","expired","canceled"],tQ="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-sky-500 via-indigo-500 to-purple-600 px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_45px_-20px_rgba(99,102,241,0.9)] transition-all focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-white/40",rQ="opacity-60 cursor-not-allowed shadow-none pointer-events-none",Ci=ki.forwardRef(({icon:e,className:t="",disabled:r,children:n,...a},i)=>c.jsxs("button",{ref:i,className:`${tQ} ${r?rQ:"hover:-translate-y-0.5"} ${t}`,disabled:r,...a,children:[e&&c.jsx(e,{className:"h-4 w-4"}),c.jsx("span",{className:"font-semibold",children:n})]}));Ci.displayName="GradientButton";const d3=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,secondaryMessage:i,confirmLabel:s="OK",cancelLabel:l="Hy",isSubmitting:d=!1})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 transition-opacity duration-300",children:c.jsxs("div",{className:"w-full max-w-md mx-4 transform transition-all duration-300 scale-100 rounded-2xl border border-white/15 bg-gradient-to-br from-slate-900/90 via-indigo-900/85 to-slate-950/90 p-6 shadow-[0_20px_60px_-25px_rgba(0,0,0,0.9)] backdrop-blur",children:[c.jsx("h3",{className:"text-lg font-semibold leading-6 text-white mb-2",children:n}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-sm text-white/90",children:a}),i?c.jsx("p",{className:"mt-2 text-sm font-semibold text-rose-300",children:i}):null]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:t,disabled:d,className:"px-4 py-2 rounded-md border border-white/20 bg-white/10 text-white hover:bg-white/15 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:l}),c.jsx("button",{type:"button",onClick:r,disabled:d,className:"px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:d?"ang X L...":s})]})]})}):null,nQ="VPB",EC="9183400998",aQ="NGO LE NGOC HUNG",iQ=({isOpen:e,onClose:t,order:r,formatCurrency:n})=>{const[a,i]=v.useState(null),[s,l]=v.useState(!1),[d,h]=v.useState(null),f=ie=>typeof ie=="string"||typeof ie=="number"||ie instanceof Date?ie:null,p=ie=>{if(ie==null)return null;if(typeof ie=="number")return Number.isFinite(ie)?ie:null;if(typeof ie=="string"){const Q=ie.trim();if(!Q)return null;const te=Number(Q);return Number.isFinite(te)?te:null}return null},x=r?.[G.ID_ORDER],g=r?.[G.ID_PRODUCT],b=Number(r?.[G.PRICE])||0,_=r?.[G.SUPPLY]||"",w=r?.customer_type||_||"",S=r?.registration_date||r?.[G.ORDER_DATE]||"",T=Iq(hr(S)||S)||null;v.useEffect(()=>{if(!e||!x||!g){i(null),l(!1),h(null);return}let ie=!1;i(b);const Q={san_pham_name:g,id_product:g,id_order:x};return T&&(Q.order_date=T),w&&(Q.customer_type=w),(async()=>{try{l(!0),h(null);const H=await Ct(kt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)}),{data:se,rawText:Y}=await s3(H);if(!H.ok){const ue=se?.error||Y||`Server responded with ${H.status}`;throw new Error(ue)}const ce=se??{};if(!ie){const ue=Number(ce.price??ce.gia_ban);i(Number.isFinite(ue)&&ue>=0?ue:b)}}catch(H){console.error("Li khi tnh li gi n hng:",H),ie||(h("Khng th tnh li gi t ng. ang hin th gi hin c."),i(b))}finally{ie||l(!1)}})(),()=>{ie=!0}},[e,x,g,w,b,T]);const E=v.useMemo(()=>{if(!r)return 0;const ie=Number(r[G.PRICE])||0;return Math.max(0,a??ie)},[r,a]);if(!e||!r)return null;const k=String(r[It.TRANG_THAI_TEXT]||r.trangThaiText||r[G.STATUS]||"").trim()||"Cha Thanh Ton",A=r[It.SO_NGAY_CON_LAI]!==void 0&&r[It.SO_NGAY_CON_LAI]!==null?Number(r[It.SO_NGAY_CON_LAI]):null,j=p(r.so_ngay_con_lai),P=f(r.expiry_date||r.expiry_date_display||r[It.EXPIRY_DATE_DISPLAY]||r[G.ORDER_EXPIRED]),D=t3(P)??p(r[G.DAYS]),L=A!==null&&Number.isFinite(A)?A:j??D??0,I=f(r.registration_date_display||r[It.ORDER_DATE_DISPLAY]||r.registration_date||r[G.ORDER_DATE]),O=(r.registration_date_display||r[It.ORDER_DATE_DISPLAY]||hr(I)||String(r[G.ORDER_DATE]||""))??"",M=r.expiry_date_display||r[It.EXPIRY_DATE_DISPLAY]||hr(P)||String(r[G.ORDER_EXPIRED]||""),re=E,oe=String(r[G.ID_ORDER]||""),ee=Math.max(0,Number(re)||0),fe=si(ee),J=lb({accountNumber:EC,bankCode:nQ,amount:fe,description:oe});return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300 px-4 py-6",onClick:t,children:c.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-3xl transform transition-all duration-300 scale-100 max-h-[95vh] flex flex-col overflow-hidden text-slate-100",onClick:ie=>ie.stopPropagation(),children:[c.jsxs("div",{className:"flex justify-center items-center p-4 border-b bg-slate-800/80 rounded-t-lg sticky top-0 z-10",children:[c.jsxs("h3",{className:"text-xl font-semibold text-white",children:["Chi tit n hng:"," ",c.jsx("span",{className:"text-blue-600",children:r[G.ID_ORDER]})]}),c.jsx("button",{type:"button",onClick:t,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx(Hr,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"p-6 overflow-y-auto flex-grow space-y-5 text-gray-700",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-3 text-sm",children:[c.jsxs("dl",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"ID n:"}),c.jsx("dd",{className:"text-slate-100 font-semibold w-2/3 text-right",children:r[G.ID_ORDER]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Sn Phm:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[G.ID_PRODUCT]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Thng Tin Sn Phm:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right break-words",children:r[G.INFORMATION_ORDER]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Slot:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[G.SLOT]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ghi Ch:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[G.NOTE]||"-"})]}),c.jsxs("div",{className:"flex justify-between pt-1 pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Trng Thi:"}),c.jsx("dd",{className:"w-2/3 text-right",children:c.jsx("span",{className:`inline-flex items-center px-3 py-1 text-sm font-bold rounded-full ${a3(k)}`,children:k})})]})]}),c.jsxs("dl",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Khch Hng:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[G.CUSTOMER]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1 items-start",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3 shrink-0",children:"Lin H:"}),c.jsx("dd",{className:"w-2/3 text-right break-all",children:c.jsx("a",{href:r[G.CONTACT],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:r[G.CONTACT]||"-"})})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Order:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:O})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:r[G.DAYS]})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"Ngy Ht Hn:"}),c.jsx("dd",{className:"text-slate-100 w-2/3 text-right",children:M})]}),c.jsxs("div",{className:"flex justify-between border-b pb-1",children:[c.jsx("dt",{className:"font-medium text-slate-400 w-1/3",children:"S Ngy Cn Li:"}),c.jsx("dd",{className:"text-indigo-600 font-bold w-2/3 text-right",children:L})]})]})]}),c.jsx("hr",{className:"my-4 border-white/10"}),c.jsxs("div",{className:"text-center bg-gradient-to-b from-slate-800 via-slate-900 to-slate-950 p-4 rounded-xl border border-white/10 shadow-[0_18px_40px_-24px_rgba(0,0,0,0.8)]",children:[c.jsx("h4",{className:"text-lg font-semibold text-indigo-100 mb-3",children:"Qut m QR  thanh ton (VietQR)"}),J?c.jsx("div",{className:"flex justify-center mb-3",children:c.jsx("img",{src:J,alt:`QR Code thanh ton ${r[G.ID_ORDER]}`,className:"border-2 border-indigo-200/60 rounded-lg p-1 bg-white shadow-lg shadow-indigo-900/40",width:280,height:280})}):c.jsx("p",{className:"text-red-600 font-medium",children:"Khng th to m QR. Vui lng kim tra li cu hnh"}),c.jsxs("div",{className:"text-sm text-slate-100 space-y-1",children:[c.jsxs("p",{children:["Ngn hng: ",c.jsx("strong",{className:"text-indigo-100",children:"VP Bank"})]}),c.jsxs("p",{children:["S ti khon: ",c.jsx("strong",{className:"text-indigo-100",children:EC})]}),c.jsxs("p",{children:["Ch ti khon: ",c.jsx("strong",{className:"text-indigo-100",children:aQ})]}),c.jsxs("p",{children:["S tin:"," ",c.jsx("strong",{className:"text-xl text-red-600",children:s?"ang tnh...":n(fe)})]}),d&&c.jsx("p",{className:"text-xs text-red-500",children:d}),c.jsxs("p",{children:["Ni dung: ",c.jsx("strong",{className:"text-indigo-200",children:oe})," ","(Vui lng in ng)"]})]})]})]})]})})},TC=Uh,In="w-full p-2 rounded-lg border border-white/25 bg-white/10 text-slate-100 placeholder-white/70 focus:ring-indigo-300/70 focus:border-indigo-300/70 transition-all",na="block text-sm font-medium text-slate-100 mb-1",xi="bg-white/10 border-white/20 text-slate-300 cursor-not-allowed",CC=e=>(Number(e)||0).toLocaleString("vi-VN")+" d",kC=e=>typeof e=="string"||typeof e=="number"||e instanceof Date?e:null,sQ=(e,t)=>{const[r,n]=v.useState(null),[a,i]=v.useState([]),[s,l]=v.useState([]),d=v.useRef(e),[h,f]=v.useState(!1),p=v.useCallback(()=>{const k=d.current?.[G.SUPPLY]||"";return k.trim()?{id:-1,source_name:k}:null},[]),x=v.useCallback(k=>{const A=p();return A&&!k.some(P=>P.source_name===A.source_name)?[A,...k]:k},[p]),g=v.useCallback(async k=>{if(!k){const A=x([]);return i(A),A}try{const A=await fetch(`${TC}${kt.SUPPLIES_BY_PRODUCT(k)}`,{credentials:"include"});if(!A.ok)throw new Error("Li ti danh sch ngun.");const j=await A.json(),P=x(j);return i(P),P}catch(A){console.error("Li khi fetch supplies cho sn phm:",A);const j=x([]);return i(j),j}},[x]),b=v.useCallback(async k=>{if(!k)return l([]),[];try{const A=await fetch(`${TC}${kt.SUPPLY_PRICES_BY_PRODUCT_NAME(k)}`,{credentials:"include"});if(!A.ok)throw new Error("Li ti danh sch gi ngun.");const j=await A.json();return l(j),j}catch(A){return console.error("Li khi fetch gi ngun cho sn phm:",A),l([]),[]}},[]);v.useEffect(()=>{if(t&&e){const k={...e,cost:Number(e.cost??0),price:Number(e.price??0)};n(k),d.current=k,i(j=>x(j));const A=e.id_product;A&&(g(A),b(A)),f(!1)}else t||(n(null),i([]),l([]),f(!1))},[t,e,g,b,x]),v.useEffect(()=>{if(!t||!r?.id_product)return;const k=r.id_product;g(k),b(k)},[t,r?.id_product,g,b]);const _=v.useCallback((k,A)=>{n(j=>j&&{...j,[k]:A})},[]),w=v.useCallback(k=>{const j=a.find(L=>L.id===k)?.source_name||r?.[G.SUPPLY]||"";f(!1),_(G.SUPPLY,j||"");const P=n3(j,s,a)??s.find(L=>L.source_id===k)?.price??null,D=Number(P);if(Number.isFinite(D))_(G.COST,D);else if(d.current){const L=Number(d.current[G.COST]||0);_(G.COST,L)}},[r,_,a,s]),S=v.useCallback(k=>{f(!0),_(G.SUPPLY,k)},[_]),T=v.useCallback(()=>{f(k=>{const A=!k;return A||_(G.SUPPLY,""),A})},[_]),E=v.useCallback(()=>{n(d.current);const k=d.current?.id_product;k&&(g(k),b(k))},[g,b]);return{formData:r,supplies:a,isCustomSupply:h,supplyPrices:s,handleSupplySelect:w,resetForm:E,setFieldValue:_,handleCustomSupplyChange:S,toggleCustomSupply:T}},oQ=({isOpen:e,onClose:t,order:r,onSave:n})=>{const{formData:a,supplies:i,isCustomSupply:s,handleSupplySelect:l,resetForm:d,setFieldValue:h,handleCustomSupplyChange:f,toggleCustomSupply:p}=sQ(r,e),[x,g]=v.useState(!1),b=A=>a?String(a[A]??""):"",_=A=>a&&Number(a[A]??0)||0,w=v.useCallback(A=>{const j=A.target,{name:P,value:D}=j,L=j instanceof HTMLInputElement&&j.type==="checkbox"?j.checked:D;h(P,L)},[h]),S=v.useMemo(()=>{if(!a)return"";const A=i.find(j=>j.source_name===a[G.SUPPLY]);return A?String(A.id):""},[a,i]),T=v.useMemo(()=>{if(!a)return"";const A=kC(a.registration_date_display||a.registration_date||a[G.ORDER_DATE]);return hr(A)||String(A||"")},[a]),E=v.useMemo(()=>{if(!a)return"";const A=kC(a.expiry_date_display||a.expiry_date||a[G.ORDER_EXPIRED]);return hr(A)||String(A||"")},[a]),k=async A=>{if(A.preventDefault(),!!a){g(!0);try{await n(a)}finally{g(!1)}}};return!e||!a?null:c.jsx("div",{className:"edit-order-shell fixed inset-0 z-50 flex items-center justify-center bg-black/55 backdrop-blur-lg px-4 py-6",children:c.jsxs("div",{className:"edit-order-panel custom-scroll w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-800/85 via-slate-800/80 to-indigo-900/85 text-slate-100 shadow-[0_24px_70px_-28px_rgba(0,0,0,0.8),0_16px_40px_-26px_rgba(99,102,241,0.35)] backdrop-blur-xl",children:[c.jsxs("div",{className:"edit-order-header flex items-center justify-between border-b border-white/15 px-6 py-4 sticky top-0 bg-white/10 backdrop-blur-md z-10 rounded-t-2xl",children:[c.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Chnh sa n hng"}),c.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors","aria-label":"ng",children:c.jsx(Hr,{className:"h-6 w-6"})})]}),c.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:na,children:"M n hng"}),c.jsx("input",{type:"text",name:G.ID_ORDER,value:b(G.ID_ORDER),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Khch hng"}),c.jsx("input",{type:"text",name:G.CUSTOMER,value:b(G.CUSTOMER),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Lin h"}),c.jsx("input",{type:"text",name:G.CONTACT,value:b(G.CONTACT),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Slot"}),c.jsx("input",{type:"text",name:G.SLOT,value:b(G.SLOT),onChange:w,className:In})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Sn phm"}),c.jsx("input",{type:"text",name:G.ID_PRODUCT,value:b(G.ID_PRODUCT),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Ngun"}),c.jsxs("div",{className:"flex items-center gap-2",children:[s?c.jsx("input",{type:"text",name:G.SUPPLY,value:b(G.SUPPLY),onChange:A=>f(A.target.value),className:In,placeholder:"Nhp ngun mi"}):c.jsxs("select",{name:G.SUPPLY,value:S,onChange:A=>l(Number(A.target.value)),className:In,children:[c.jsx("option",{value:"",children:"-- Gi nguyn hoc chn --"}),i.map(A=>c.jsx("option",{value:A.id,children:A.source_name},A.id))]}),c.jsx("button",{type:"button",onClick:p,className:`inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${s?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,"aria-label":s?"Tt nhp ngun mi":"Nhp ngun mi",children:s?c.jsx(s4,{className:"h-6 w-6","aria-hidden":"true"}):c.jsx(cy,{className:"h-6 w-6","aria-hidden":"true"})})]}),!i.length&&!s&&c.jsx("p",{className:"mt-1 text-xs text-slate-300",children:"Khng c danh sch ngun cho sn phm hin ti."})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Thng tin n hng"}),c.jsx("input",{type:"text",name:G.INFORMATION_ORDER,value:b(G.INFORMATION_ORDER),onChange:w,className:In})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Ngy ng k"}),c.jsx("input",{type:"text",name:G.ORDER_DATE,value:T,readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"S ngy"}),c.jsx("input",{type:"text",name:G.DAYS,value:b(G.DAYS),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Ngy ht hn"}),c.jsx("input",{type:"text",name:G.ORDER_EXPIRED,value:E,readOnly:!0,disabled:!0,className:`${In} ${xi}`})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Gi nhp"}),c.jsx("input",{type:"text",name:G.COST,value:CC(_(G.COST)),readOnly:!0,disabled:!0,className:`${In} ${xi} font-semibold`})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Gi bn"}),c.jsx("input",{type:"text",name:G.PRICE,value:CC(_(G.PRICE)),readOnly:!0,disabled:!0,className:`${In} ${xi} font-semibold text-emerald-300`})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Trng thi"}),c.jsx("input",{type:"text",name:G.STATUS,value:b(G.STATUS),readOnly:!0,disabled:!0,className:`${In} ${xi}`})]}),c.jsxs("div",{className:"flex items-center gap-3 mt-6 md:mt-8",children:[c.jsx("label",{className:"text-sm font-medium text-slate-100 mb-0",children:"Kim tra"}),c.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-white/30 text-indigo-300 focus:ring-indigo-400",checked:!!a[G.CHECK_FLAG],disabled:!0,readOnly:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:na,children:"Ghi ch"}),c.jsx("textarea",{name:G.NOTE,value:b(G.NOTE),rows:4,onChange:w,className:In})]}),c.jsxs("div",{className:"flex justify-end gap-3 border-t border-white/10 pt-4",children:[c.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"Hon tc"}),c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded-lg border border-white/15 text-slate-100 hover:bg-white/10",children:"ng"}),c.jsx("button",{type:"submit",disabled:x,className:`px-5 py-2 rounded-lg text-white font-medium transition-colors ${x?"bg-white/20 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600"}`,children:x?"ang lu...":"Lu thay i"})]})]})]})})},F1=e=>{if(!e||e.indexOf("/")===-1)return e;const t=e.split("/");return t.length===3?`${t[2]}-${t[1]}-${t[0]}`:e},ph=(e,t)=>{if(!e||t<=0)return"N/A";const r=e.split("/");if(r.length!==3)return"N/A";const n=parseInt(r[0],10),a=parseInt(r[1],10),i=parseInt(r[2],10),s=new Date(i,a-1,n);s.setDate(s.getDate()+t-1);const l=String(s.getDate()).padStart(2,"0"),d=String(s.getMonth()+1).padStart(2,"0"),h=s.getFullYear();return`${l}/${d}/${h}`},f3={[G.ID_ORDER]:"",[G.ID_PRODUCT]:"",[G.INFORMATION_ORDER]:"",[G.CUSTOMER]:"",[G.CONTACT]:"",[G.SLOT]:"",[G.ORDER_DATE]:"",[G.DAYS]:"0",[G.ORDER_EXPIRED]:"",[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.NOTE]:"",[G.STATUS]:"Cha Thanh Ton",[G.CHECK_FLAG]:null},sn="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 transition-all",bn="block text-sm font-medium text-gray-700 mb-1",Ml="bg-gray-100 cursor-not-allowed",AC=({name:e,value:t,options:r,placeholder:n,disabled:a,onChange:i,onClear:s})=>{const l=v.useRef(null),[d,h]=v.useState(!1),[f,p]=v.useState(""),x=v.useMemo(()=>{const b=r.find(_=>_.value===t);return b?b.label:""},[r,t]);v.useEffect(()=>{p(x)},[x]);const g=v.useMemo(()=>{const b=(f||"").toLowerCase().trim();return b?r.filter(_=>_.label.toLowerCase().includes(b)):r},[r,f]);return v.useEffect(()=>{const b=_=>{l.current&&(l.current.contains(_.target)||h(!1))};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[]),c.jsxs("div",{ref:l,className:"relative",children:[c.jsx("input",{name:e,type:"text",value:f,onChange:b=>{const _=b.target.value;p(_),_===""&&s?.(),d||h(!0)},onFocus:()=>h(!0),disabled:a,placeholder:n,className:`${sn} pr-8`,autoComplete:"off"}),!!f&&s&&!a&&c.jsx("button",{type:"button",onMouseDown:b=>{b.preventDefault(),p(""),s(),h(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-300 hover:text-white","aria-label":"Clear",children:""}),d&&!a&&c.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto",children:g.length===0?c.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"Khng c kt qu"}):g.map(b=>c.jsx("div",{className:`px-3 py-2 text-sm cursor-pointer hover:bg-indigo-500/15 ${b.value===t?"bg-gray-50":""}`,onMouseDown:_=>{_.preventDefault(),p(b.label),h(!1),i(b.value,b)},children:b.label},`${String(b.value)}-${b.label}`))})]})},lQ=e=>{const[t,r]=v.useState(f3),[n,a]=v.useState(e),[i,s]=v.useState(null),[l,d]=v.useState(!1),h=v.useCallback(f=>{r(p=>({...p,...f}))},[]);return{formData:t,setFormData:r,customerType:n,setCustomerType:a,selectedSupplyId:i,setSelectedSupplyId:s,customProductTouched:l,setCustomProductTouched:d,updateForm:h}},cQ=({customerType:e,setFormData:t,productName:r})=>{const[n,a]=v.useState(!1),[i,s]=v.useState(!1),l=v.useRef(""),d=v.useCallback(async(p,x,g,b)=>{a(!0),s(!1);try{const _=F1(b)||b||null,w=await Ct(kt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({supply_id:p,san_pham_name:x,id_product:x,id_order:g,order_date:_,customer_type:e})}),{data:S,rawText:T}=await s3(w);if(!w.ok){const D=S?.error||T||"Loi tinh gia tu Server.";throw new Error(D)}if(!S)throw new Error("Phan hoi khong hop le tu server.");const E=S||{},k=hr(b)||b||Yi(),A={cost:Math.max(0,Number(E.gia_nhap??E.cost??0)||0),price:Math.max(0,Number(E.gia_ban??E.price??0)||0),days:Number(E.so_ngay_da_dang_ki??E.days??0)||0,order_expired:""},j=(E.order_expired??E.het_han??"").trim(),P=hr(j)||j||(A.days>0?ph(k,A.days):"");return A.order_expired=P,A}catch(_){console.error("Loi khi tinh gia:",_),s(!1),alert(`Tinh gia that bai: ${_ instanceof Error?_.message:"Loi khong xac dinh"}`);return}finally{a(!1)}},[e]),h=v.useCallback((p,x,g,b)=>{if(!p)return;const _=hr(x)||x||Yi();let w=Number(p.days||0)||0,S=p.order_expired||(w>0?ph(_,w):"");const T=hh(b?.infoOverride||"")||hh((b?.productNameOverride||r||"").toString());if(T>0){const E=Lq(T),k=e3(_,T);E>0&&(w=E,S=k)}t(E=>{const k=Number(E[G.COST]||0),A=Number.isFinite(p.cost)&&p.cost>0?p.cost:void 0,P=b?.updateCost??!0?A??Number(g??k??0):k,D=Number(E[G.PRICE]||0),L=Number.isFinite(p.price)&&p.price>0?p.price:void 0;let I=L??D??0;return e==="MAVK"&&(I=L??P??D??0),{...E,[G.COST]:P,[G.PRICE]:I,[G.DAYS]:w>0?String(w):String(E[G.DAYS]||"0"),[G.ORDER_EXPIRED]:S||E[G.ORDER_EXPIRED]||""}}),s(!0)},[e,r,t]),f=v.useCallback((p,x,g,b,_,w)=>{!x||!g||!b||d(p,x,g,b).then(S=>h(S,b,_,{...w,productNameOverride:x,infoOverride:l.current}))},[h,d]);return{isLoading:n,setIsLoading:a,isDataLoaded:i,setIsDataLoaded:s,calculatePrice:d,applyCalculationResult:h,recalcPrice:f,infoRef:l}},uQ=e=>{const[t,r]=v.useState([]),[n,a]=v.useState([]),[i,s]=v.useState([]),[l,d]=v.useState([]),h=v.useCallback(async()=>{try{const g=await fetch(`${e}${kt.PRODUCTS_ALL}`,{credentials:"include"});if(!g.ok)throw new Error("Loi tai danh sach san pham.");const b=await g.json();s(b)}catch(g){console.error("Loi khi fetch products:",g)}},[e]),f=v.useCallback(async()=>{try{const g=await fetch(`${e}${kt.SUPPLIES}`,{credentials:"include"});if(!g.ok)throw new Error("Loi tai danh sach nguon.");const b=await g.json();r(b),a(_=>_.length?_:b)}catch(g){console.error("Loi khi fetch all supplies:",g),r([])}},[e]),p=v.useCallback(async g=>{if(!g){a(b=>b.length?b:t);return}try{const b=await fetch(`${e}${kt.SUPPLIES_BY_PRODUCT(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Loi tai danh sach nguon.");const _=await b.json();a(_)}catch(b){console.error("Loi khi fetch supplies:",b),a(t)}},[e,t]),x=v.useCallback(async g=>{try{const b=await fetch(`${e}${kt.SUPPLY_PRICES_BY_PRODUCT_NAME(g)}`,{credentials:"include"});if(!b.ok)throw new Error("Loi tinh gia nhap cua nguon.");const _=await b.json();d(_)}catch(b){console.error("Loi khi fetch all supply prices:",b),d([])}},[e]);return{allSupplies:t,supplies:n,products:i,supplyPrices:l,setSupplies:a,setSupplyPrices:d,fetchProducts:h,fetchAllSupplies:f,fetchSuppliesByProduct:p,fetchAllSupplyPrices:x}},dQ=Uh,fQ=(e,t,r)=>{const{formData:n,setFormData:a,customerType:i,setCustomerType:s,selectedSupplyId:l,setSelectedSupplyId:d,customProductTouched:h,setCustomProductTouched:f,updateForm:p}=lQ("MAVC"),{allSupplies:x,supplies:g,products:b,supplyPrices:_,setSupplies:w,setSupplyPrices:S,fetchProducts:T,fetchAllSupplies:E,fetchSuppliesByProduct:k,fetchAllSupplyPrices:A}=uQ(dQ),j=n[G.ID_PRODUCT],P=n[G.ID_ORDER],D=n[G.ORDER_DATE],{isLoading:L,isDataLoaded:I,setIsDataLoaded:O,recalcPrice:M,infoRef:re}=cQ({customerType:i,setFormData:a,productName:j}),oe=v.useMemo(()=>i+_C(5),[i]),ee=v.useMemo(()=>Yi(),[]);v.useEffect(()=>{re.current=n[G.INFORMATION_ORDER]||""},[n,re]),v.useEffect(()=>{if(e){const Y="MAVC",ce=Y+_C(5),ue=Yi();s(Y),a({...f3,[G.ID_ORDER]:ce,[G.ORDER_DATE]:ue,[G.ORDER_EXPIRED]:ue}),O(!1),d(null),w([]),S([]),f(!1),T(),E()}},[E,T,e,s,a,O,d,w,S,f]),v.useEffect(()=>{e&&a(Y=>({...Y,[G.ID_ORDER]:oe}))},[oe,e,a]),v.useEffect(()=>{if(!j||!P||!D||r)return;const Y=l??0;M(Y,j,P,D,void 0,{updateCost:!!Y})},[i,M,j,P,D,l,r]),v.useEffect(()=>{j||(d(null),a(Y=>{if(!Y[G.ID_PRODUCT]&&Number(Y[G.PRICE]||0)===0&&String(Y[G.DAYS]||"0")==="0")return Y;const ue=Y[G.ORDER_DATE]||Yi();return{...Y,[G.ID_PRODUCT]:"",[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.DAYS]:"0",[G.ORDER_EXPIRED]:ue}}))},[j,a,d]);const fe=Y=>{const ce=(Y||"").trim();if(d(null),f(!1),!ce){a(Re=>({...Re,[G.ID_PRODUCT]:"",[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.DAYS]:"0",[G.ORDER_EXPIRED]:Re[G.ORDER_DATE]||ee})),w(x),S([]),O(!1);return}a(Re=>({...Re,[G.ID_PRODUCT]:ce,[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.DAYS]:"0",[G.ORDER_EXPIRED]:Re[G.ORDER_DATE]||ee})),w([]),S([]),k(ce),A(ce);const ue=n[G.ID_ORDER],me=n[G.ORDER_DATE];if(ue&&me&&!r){const Re=l??0;M(Re,ce,ue,me,void 0,{updateCost:!!Re})}},J=(Y,ce,ue)=>{const me=_.map(K=>({source_id:K.source_id,price:K.price})),Re=g.map(K=>({id:K.id,source_name:K.source_name})),U=n3(ce,me,Re),B=Number(U);if(Number.isFinite(B))return B;if(Y!==0){const K=_.find(ne=>ne.source_id===Y)?.price,z=Number(K);if(Number.isFinite(z))return z}return ue};return{formData:n,supplies:g,allSupplies:x,products:b,isLoading:L,isDataLoaded:I,selectedSupplyId:l,customerType:i,updateForm:p,setIsDataLoaded:O,customProductTouched:h,setCustomProductTouched:f,handleChange:Y=>{const{name:ce,value:ue}=Y.target;p({[ce]:ue})},handleProductSelect:fe,handleSourceSelect:Y=>{const ce=g.find(z=>z.id===Y),ue=Number(n[G.COST]||0),me=ce?.source_name||"",Re=J(Y,me,ue);d(Y===0?null:Y),a(z=>{const ne={...z,[G.SUPPLY]:ce?ce.source_name:"",[G.COST]:Re};return i==="MAVK"&&(ne[G.PRICE]=Re),ne});const U=n[G.ID_PRODUCT],B=n[G.ID_ORDER],K=n[G.ORDER_DATE];if(!U||!B||!K){O(!1);return}M(Y,U,B,K,Re,{updateCost:!0})},handleProductChange:Y=>{const ce=Y.target.value;if(d(null),f(!1),a(ue=>({...ue,[G.ID_PRODUCT]:ce,[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.DAYS]:"0",[G.ORDER_EXPIRED]:ue[G.ORDER_DATE]||ee})),w([]),S([]),ce){k(ce),A(ce);const ue=n[G.ID_ORDER]||"",me=n[G.ORDER_DATE]||"";if(ue&&me&&!r){const Re=l??0;M(Re,ce,ue,me,void 0,{updateCost:!!Re})}}else O(!1)},handleCustomerTypeChange:Y=>{const ce=Y.target.value;s(ce),d(null),w([]),S([]),O(!1),a(ue=>({...ue,[G.ID_PRODUCT]:"",[G.SUPPLY]:"",[G.COST]:0,[G.PRICE]:0,[G.DAYS]:"0",[G.ORDER_EXPIRED]:ue[G.ORDER_DATE]||Yi()}))},handleSubmit:Y=>{if(Y.preventDefault(),n&&n[G.ID_PRODUCT]&&n[G.SUPPLY]&&n[G.CUSTOMER]&&n[G.INFORMATION_ORDER]&&!L){const ue=hr(n[G.ORDER_DATE])||n[G.ORDER_DATE]||Yi(),me=hr(n[G.ORDER_EXPIRED])||n[G.ORDER_EXPIRED]||"",Re=Number(n[G.DAYS]||0)||0;let U=me;if(!U&&ue&&Re>0){const ne=ph(ue,Re);ne&&ne!=="N/A"&&(U=ne,p({[G.ORDER_EXPIRED]:U}))}const B=F1(ue),K=U?F1(U):B,z={...n,[G.COST]:Number(n[G.COST]),[G.PRICE]:Number(n[G.PRICE]),[G.ORDER_DATE]:B,[G.ORDER_EXPIRED]:K,[G.CONTACT]:n[G.CONTACT]||null,[G.SLOT]:n[G.SLOT]||null,[G.NOTE]:n[G.NOTE]||null};return t(z),!0}else return alert("Vui long dien day du cac thong tin"),!1}}},hQ=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=v.useState(!1),{formData:i,updateForm:s,supplies:l,products:d,isLoading:h,selectedSupplyId:f,customerType:p,setIsDataLoaded:x,customProductTouched:g,setCustomProductTouched:b,handleChange:_,handleProductSelect:w,handleSourceSelect:S,handleCustomerTypeChange:T,handleSubmit:E}=fQ(e,r,n),k=i[G.INFORMATION_ORDER]||"",A=i[G.ID_PRODUCT]||"",j=i[G.ORDER_DATE]||Yi(),P=i[G.COST],D=i[G.PRICE],L=v.useMemo(()=>i[G.ORDER_EXPIRED]||"",[i]),I=v.useMemo(()=>i[G.ORDER_DATE]||Yi(),[i]),O=v.useMemo(()=>Number(i[G.DAYS]||0)||0,[i]),M=v.useCallback(ee=>fe=>{const ie=(fe.target.value||"").replace(/\D/g,""),Q=ie?parseInt(ie,10):0;s({[ee]:Q})},[s]);v.useEffect(()=>{if(!n||!g)return;const ee=hh(k)||hh(A),fe=j;if(ee>0){const J=e3(fe,ee),ie=Fq(fe,J);s({[G.DAYS]:String(ie),[G.ORDER_EXPIRED]:J})}},[n,g,k,A,j,s]),v.useEffect(()=>{if(!L)return;const ee=hr(L);if(!ee&&I&&O>0){const fe=ph(I,O);fe&&fe!=="N/A"&&fe!==L&&s({[G.ORDER_EXPIRED]:fe})}else ee&&ee!==L&&s({[G.ORDER_EXPIRED]:ee})},[L,I,O,s]);const re=v.useMemo(()=>{const ee=i[G.ID_PRODUCT]||"",fe=i[G.SUPPLY]||"",J=i[G.INFORMATION_ORDER]||"",ie=i[G.CUSTOMER]||"";return!!ee&&!!fe&&!!J&&!!ie},[i]);if(v.useEffect(()=>{x(re)},[re,x]),!e)return null;const oe=!!(i[G.CUSTOMER]&&i[G.ID_PRODUCT]&&i[G.SUPPLY]&&i[G.INFORMATION_ORDER]);return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm transition-opacity duration-300",children:c.jsxs("div",{className:"bg-slate-900/90 border border-white/10 rounded-lg shadow-[0_18px_48px_-28px_rgba(0,0,0,0.8)] w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col text-slate-100",children:[c.jsxs("div",{className:"p-5 border-b border-slate-700 sticky top-0 bg-slate-800/80 z-10 flex justify-between items-center",children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"To n Hng Mi"}),c.jsx("button",{type:"button",onClick:t,className:"text-slate-300 hover:text-white transition-colors",children:c.jsx(Hr,{className:"h-6 w-6"})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c.jsx("form",{onSubmit:E,children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 border p-4 rounded-lg bg-gray-50",children:[c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Loi Khch Hng"}),c.jsxs("select",{name:"customer_type",value:p,onChange:T,className:sn,children:[c.jsx("option",{value:"MAVC",children:"Cng Tc Vin"}),c.jsx("option",{value:"MAVL",children:"Khch L"}),c.jsx("option",{value:"MAVK",children:"Khuyn Mi"}),c.jsx("option",{value:"MAVT",children:"Qu Tng"}),c.jsx("option",{value:"MAVN",children:"Nhp Hng"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"M n Hng"}),c.jsx("input",{type:"text",name:G.ID_ORDER,value:i[G.ID_ORDER]||"",readOnly:!0,className:`${sn} font-semibold ${Ml}`})]}),c.jsxs("div",{children:[c.jsxs("label",{className:bn,children:["Tn Khch Hng ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:G.CUSTOMER,value:i[G.CUSTOMER]||"",onChange:_,className:sn,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Link Lin H"}),c.jsx("input",{type:"url",name:G.CONTACT,value:i[G.CONTACT]||"",onChange:_,className:sn})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 border p-4 rounded-lg items-end",children:[c.jsxs("div",{className:"md:col-span-5",children:[c.jsxs("label",{className:bn,children:["Sn Phm ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx(AC,{name:G.ID_PRODUCT,value:i[G.ID_PRODUCT]||"",options:d.map(ee=>({value:ee.san_pham,label:ee.san_pham})),placeholder:"-- Chn --",onChange:ee=>w(String(ee)),onClear:()=>w(""),disabled:n})]}),c.jsxs("div",{className:"md:col-span-5",children:[c.jsxs("label",{className:bn,children:["Ngun ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx(AC,{name:G.SUPPLY,value:f??"",options:l.map(ee=>({value:ee.id,label:ee.source_name})),placeholder:"-- Chn --",disabled:n||!i[G.ID_PRODUCT],onChange:ee=>S(Number(ee)),onClear:()=>S(0)})]}),c.jsx("div",{className:"md:col-span-2 flex items-end md:justify-end",children:c.jsx("button",{type:"button","aria-label":"Toggle",onClick:()=>{b(!1),a(ee=>!ee)},className:`mt-6 md:mt-0 inline-flex items-center justify-center w-10 h-10 rounded-md text-white ${n?"bg-red-500 hover:bg-red-600":"bg-green-500 hover:bg-green-600"}`,children:n?c.jsx(s4,{className:"h-6 w-6","aria-hidden":"true"}):c.jsx(cy,{className:"h-6 w-6","aria-hidden":"true"})})}),n&&c.jsxs("div",{className:"md:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Sn Phm Mi"}),c.jsx("input",{type:"text",name:G.ID_PRODUCT,value:i[G.ID_PRODUCT]||"",onChange:_,onBlur:()=>b(!0),className:sn,placeholder:"Nhp Tn Sn Phm Mi"})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Ngun Mi"}),c.jsx("input",{type:"text",name:G.SUPPLY,value:i[G.SUPPLY]||"",onChange:_,className:sn,placeholder:"Nhp Tn Ngun Mi"})]})]}),c.jsxs("div",{className:"md:col-span-12",children:[c.jsxs("label",{className:bn,children:["Thng Tin Sn Phm ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:G.INFORMATION_ORDER,value:i[G.INFORMATION_ORDER]||"",onChange:_,className:sn,required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Ngy ng K"}),c.jsx("input",{type:"text",name:G.ORDER_DATE,value:i[G.ORDER_DATE]||"",readOnly:!0,className:`${sn} ${Ml}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"S Ngy ng K"}),c.jsx("input",{type:"text",name:G.DAYS,value:i[G.DAYS]||"",readOnly:!0,className:`${sn} ${Ml}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Ngy Ht Hn"}),c.jsx("input",{type:"text",name:G.ORDER_EXPIRED,value:i[G.ORDER_EXPIRED]||"",readOnly:!0,className:`${sn} font-medium text-red-600 ${Ml}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Slot"}),c.jsx("input",{type:"text",name:G.SLOT,value:i[G.SLOT]||"",onChange:_,className:sn})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Gi Nhp"}),n?c.jsx("input",{type:"text",inputMode:"numeric",name:G.COST,value:bC(Number(P??0)),onChange:M(G.COST),className:`${sn} font-semibold`}):c.jsx("input",{type:"text",name:G.COST,value:Si(P??0),readOnly:!0,className:`${sn} font-semibold ${Ml}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Gi Bn"}),n?c.jsx("input",{type:"text",inputMode:"numeric",name:G.PRICE,value:bC(Number(D??0)),onChange:M(G.PRICE),className:`${sn} font-semibold text-green-700`}):c.jsx("input",{type:"text",name:G.PRICE,value:Si(D??0),readOnly:!0,className:`${sn} font-semibold text-green-700 ${Ml}`})]}),c.jsxs("div",{children:[c.jsx("label",{className:bn,children:"Ghi Ch"}),c.jsx("textarea",{name:G.NOTE,value:i[G.NOTE]||"",onChange:_,rows:8,className:sn})]})]})]})]})})}),c.jsxs("div",{className:"p-5 border-t border-gray-200 bg-gray-50 flex justify-end sticky bottom-0 z-10",children:[c.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 text-base font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-indigo-500/15 transition-colors shadow-sm mr-3",children:"Hy"}),c.jsx("button",{type:"submit",onClick:E,className:`px-6 py-2 text-base font-medium text-white rounded-lg transition-colors shadow-md ${oe&&!h?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,disabled:!oe||h,children:h?"ang Tnh Gi...":"To n Hng"})]})]})})},PC={"ht hn":oi.ORDER_EXPIRED,"cn gia hn":oi.CAN_GIA_HAN,"cha thanh ton":oi.CHUA_THANH_TOAN," thanh ton":oi.DA_THANH_TOAN,"cha hon":"Cha Hon"," hon":" Hon"},ku=e=>si(e).toLocaleString("vi-VN")+" VND",Nu=async e=>{try{const t=await e.text();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object"&&"error"in r)return r.error||null;if(typeof r=="string")return r}catch{}return t}catch{return null}},_0=e=>e==null?"":String(e).normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),ov=e=>_0(e).replace(/[^a-z0-9]/g,""),jC=(e,t)=>{const r=e??t;return r==null?"":hr(r)||String(r)},Xi=e=>{if(e==null)return e;if(typeof e!="boolean"&&(typeof e=="string"||typeof e=="number"||e instanceof Date))return e},pQ=e=>e==null?e:typeof e=="boolean"?null:typeof e=="number"||typeof e=="string"?e:null,lv=e=>{if(e==null)return null;if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},mQ=e=>{if(e==null)return null;if(typeof e=="boolean")return e;if(typeof e=="number"){if(e===1)return!0;if(e===0)return!1}if(typeof e=="string"){const t=e.trim().toLowerCase();if(["true","t","1"].includes(t))return!0;if(["false","f","0"].includes(t))return!1}return null},Gl=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",M1=e=>e==="chua thanh toan"||e==="chua hoan"||e.includes("chua thanh toan")||e.includes("chua hoan"),xQ=e=>{const t=Gl(e);return t&&PC[t]?PC[t]:e},OC=e=>{const t=Xi(e.expiry_date)??Xi(e[G.ORDER_EXPIRED])??Xi(e.expiry_date_display)??Xi(e[It.EXPIRY_DATE_DISPLAY]),n=(hr(t)||String(t||"")).split("/");if(n.length===3){const[i,s,l]=n.map(Number);if(Number.isFinite(i)&&Number.isFinite(s)&&Number.isFinite(l))return new Date(l,s-1,i).getTime()}const a=new Date(String(t||""));return Number.isFinite(a.getTime())?a.getTime():0};function gQ(e,t=300){const[r,n]=v.useState(e);return v.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}const n0=[{name:"Tng n Hng",value:"0",icon:nc,accent:Rr.sky},{name:"Cn Gia Hn",value:"0",icon:ly,accent:Rr.amber},{name:"Ht Hn",value:"0",icon:iy,accent:Rr.rose},{name:"ng K Hm Nay",value:"0",icon:sy,accent:Rr.emerald}],Bs=Uh,vQ=e=>{const[t,r]=v.useState([]),[n,a]=v.useState(""),[i,s]=v.useState("all"),[l,d]=v.useState("all"),[h,f]=v.useState(1),[p,x]=v.useState(10),[g,b]=v.useState(!1),[_,w]=v.useState(!1),[S,T]=v.useState(!1),[E,k]=v.useState(!1),[A,j]=v.useState(null),[P,D]=v.useState(null),[L,I]=v.useState(null),[O,M]=v.useState(null),[re,oe]=v.useState(null),ee=gQ(n,300),fe=v.useCallback(async()=>{try{M(null);const we=u3[e].endpoint,xe=await fetch(`${Bs}${we}`,{credentials:"include"});if(xe.status===401){window.location.href="/login";return}if(!xe.ok)throw new Error(`Li my ch: ${xe.status}`);const Ee=await xe.json();Array.isArray(Ee)?r(Ee):console.error("D liu nhn c khng phi l mng:",Ee)}catch(we){console.error("Li khi ti n hng:",we);const xe=we instanceof TypeError?"Khng th kt ni n my ch. Vui lng kim tra li dch v backend.":we instanceof Error?we.message:"C li khng xc nh khi ti n hng.";M(xe)}finally{}},[e]);v.useEffect(()=>{fe()},[fe]),v.useEffect(()=>{r([]),a(""),d("all"),f(1),b(!1),w(!1),T(!1),k(!1),j(null),D(null),I(null)},[e]);const J=v.useMemo(()=>{const we=t.map(et=>{const Je=Xi(et.registration_date??et[G.ORDER_DATE]),Ze=Xi(et.expiry_date??et[G.ORDER_EXPIRED]),At=jC(Xi(et.registration_date_display),Je),Ot=jC(Xi(et.expiry_date_display),Ze),Mt=lv(pQ(et.so_ngay_con_lai)),Ie=t3(Ze||Ot),at=Mt??Ie??0,xt=et[G.STATUS]||"Cha Thanh Ton",yt=xQ(xt.trim()),bt=mQ(et[G.CHECK_FLAG]),Tt=si(Number.parseFloat(String(et[G.PRICE]??0))||0),Kt=Number(et[G.DAYS])||0,mr=Math.max(0,at);let Ar=Kt>0?Tt*mr/Kt:0;const xn=et.can_hoan??et[G.REFUND]??et.refund;let Aa=lv(xn)??(Number.isFinite(Ar)?Ar:null);if(e==="canceled"){const Gn=lv(et.refund);Gn!==null&&(Ar=Gn,Aa=Gn)}return{...et,[It.SO_NGAY_CON_LAI]:at,[It.GIA_TRI_CON_LAI]:Ar,[It.CHECK_FLAG_STATUS]:bt,[It.TRANG_THAI_TEXT]:yt,[It.ORDER_DATE_DISPLAY]:At,[It.EXPIRY_DATE_DISPLAY]:Ot,can_hoan:Aa}}),xe=_0(ee),Ee=ov(ee),le=i==="all"?[G.CUSTOMER,G.ID_ORDER,G.ID_PRODUCT,G.INFORMATION_ORDER,G.SUPPLY,G.CONTACT]:[i],De=l==="all"?"":Gl(l),Ue=we.filter(et=>{const Je=!xe||le.some(Mt=>{const Ie=et[Mt],at=_0(Ie);if(!at)return!1;if(Mt===G.ID_ORDER){const xt=ov(Ie);return!!Ee&&xt.includes(Ee)||at.includes(xe)}return at.includes(xe)}),Ze=!!Ee&&ov(et[G.ID_ORDER]).includes(Ee),At=!!xe&&_0(et[G.ID_PRODUCT]).includes(xe),Ot=l==="all"||Gl(String(et[It.TRANG_THAI_TEXT]||""))===De;return(Je||Ze||At)&&Ot});Ue.sort((et,Je)=>{const Ze=String(et[It.TRANG_THAI_TEXT]||""),At=String(Je[It.TRANG_THAI_TEXT]||""),Ot=Gl(Ze),Mt=Gl(At),Ie=M1(Ot),at=M1(Mt);if(Ie!==at)return Ie?-1:1;if(e==="expired"){const Ar=OC(et),xn=OC(Je);if(Ar!==xn)return xn-Ar}const xt=SC(Ze),yt=SC(At);if(xt!==yt)return xt-yt;const bt=Number(et[It.SO_NGAY_CON_LAI]??0),Tt=Number(Je[It.SO_NGAY_CON_LAI]??0);if(bt!==Tt)return bt-Tt;const Kt=et[G.ID_ORDER]||"",mr=Je[G.ID_ORDER]||"";return Kt<mr?-1:Kt>mr?1:0});const Ce=we.length,Ae=we.filter(et=>{const Je=Number(et[It.SO_NGAY_CON_LAI]??0);return Number.isFinite(Je)&&Je>0&&Je<=4}).length,ve=we.filter(et=>{const Je=Number(et[It.SO_NGAY_CON_LAI]??0);return Number.isFinite(Je)&&Je<=0}).length,Le=we.filter(et=>{const Je=Xi(et.registration_date||et.registration_date_display||et[It.ORDER_DATE_DISPLAY]||et[G.ORDER_DATE]);return Mq(Je)}).length,pe=[{...n0[0],value:String(Ce)},{...n0[1],value:String(Ae)},{...n0[2],value:String(ve)},{...n0[3],value:String(Le)}],tt=Math.ceil(Ue.length/p),Ye=h*p,Be=Ye-p,ot=Ue.slice(Be,Ye);return{filteredOrders:Ue,currentOrders:ot,totalPages:tt,updatedStats:pe,totalRecords:Ce}},[t,ee,i,l,p,h,e]),{filteredOrders:ie,totalPages:Q}=J;v.useEffect(()=>{f(1)},[ee,i,l,p]);const te=v.useMemo(()=>{const we=[];if(Q<=7){for(let De=1;De<=Q;De++)we.push(De);return we}const xe=(De,Ue,Ce)=>Math.min(Math.max(De,Ue),Ce),Ee=xe(h-1,2,Q-3),le=xe(h+1,4,Q-1);we.push(1),Ee>2&&we.push("...");for(let De=Ee;De<=le;De++)we.push(De);return le<Q-1&&we.push("..."),we.push(Q),we},[h,Q]),H=v.useCallback(()=>k(!0),[]),se=v.useCallback(()=>k(!1),[]),Y=v.useCallback(()=>{w(!1),j(null)},[]),ce=v.useCallback(()=>{T(!1),I(null)},[]),ue=v.useCallback(()=>{b(!1),D(null)},[]),me=v.useCallback(we=>{j(we),w(!0)},[]),Re=v.useCallback(we=>{const xe={...we,cost:Number(we[G.COST]??0)||0,price:Number(we[G.PRICE]??0)||0};I(xe),T(!0)},[]),U=v.useCallback(we=>{D(we),b(!0)},[]),B=v.useCallback(async we=>{se();try{const xe=await fetch(`${Bs}${kt.ORDERS}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(we)});if(!xe.ok){const le=await xe.json();throw new Error(le.error||"Li khi to n hng mi t My ch")}await fe();const Ee=await xe.json();me(Ee)}catch(xe){console.error("Li khi to n hng:",xe),alert(`Li khi to n hng: ${xe instanceof Error?xe.message:String(xe)}`)}},[se,fe,me]),K=v.useCallback(async we=>{if(!we||!we.id)return;const Ee=String(we[G.STATUS]||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),le=we[G.CHECK_FLAG];let De=null;if(Ee==="chua thanh toan"&&le==null?De={[G.CHECK_FLAG]:!1}:Ee==="chua thanh toan"&&le===!1?De={[G.STATUS]:oi.DA_THANH_TOAN,[G.CHECK_FLAG]:!0}:De={[G.STATUS]:oi.DA_THANH_TOAN,[G.CHECK_FLAG]:!0},!!De)try{const Ue=await fetch(`${Bs}${kt.ORDER_BY_ID(we.id)}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(De)});if(!Ue.ok){const Ce=await Nu(Ue);throw new Error(Ce||"Li khi cp nht trng thi t my ch")}await fe()}catch(Ue){console.error("Li khi nh du  thanh ton:",Ue),alert(`Khng th nh du  thanh ton: ${Ue instanceof Error?Ue.message:String(Ue)}`)}},[fe]),z=v.useCallback(async we=>{if(!we)return;const xe=String(we[G.ID_ORDER]||"").trim();if(!xe){alert("Khng tm thy m n  gia hn.");return}const Ee=`${Bs}${kt.ORDER_RENEW(xe)}`;console.log("[Renew] start",{orderCode:xe,orderId:we.id,apiBase:Bs,renewUrl:Ee}),oe(xe);try{const le=await fetch(Ee,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({forceRenewal:!0})});let De=null;try{De=await le.clone().text()}catch{De=null}if(console.log("[Renew] response",{orderCode:xe,status:le.status,body:De}),!le.ok){const Ue=await Nu(le);throw new Error(Ue||`Gia hn tht bi (m: ${le.status||"unknown"})`)}await fe(),alert("Gia hn thnh cng.")}catch(le){console.error("Li khi gia hn n:",le),alert(`Gia hn tht bi: ${le instanceof Error?le.message:String(le)}`)}finally{oe(null)}},[fe]),ne=v.useCallback(async we=>{if(!(!we||!we.id))try{const xe=await fetch(`${Bs}${kt.ORDER_CANCELED_REFUND(we.id)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"});if(!xe.ok){const Ee=await Nu(xe);throw new Error(Ee||"Li khi xc nhn hon tin t my ch")}await fe()}catch(xe){console.error("Li khi xc nhn hon tin:",xe),alert(`Li khi xc nhn hon tin: ${xe instanceof Error?xe.message:String(xe)}`)}},[fe]),Oe=v.useCallback(async we=>{ce();const xe={[G.ID_ORDER]:we.id_order,[G.ID_PRODUCT]:we.id_product,[G.INFORMATION_ORDER]:we.information_order,[G.CUSTOMER]:we.customer,[G.CONTACT]:we.contact,[G.SLOT]:we.slot,[G.SUPPLY]:we.supply,[G.COST]:Number(we.cost??0)||0,[G.PRICE]:Number(we.price??0)||0,[G.NOTE]:we.note,[G.STATUS]:we.status,[G.CHECK_FLAG]:we.check_flag};try{const Ee=await fetch(`${Bs}${kt.ORDER_BY_ID(Number(we.id))}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(xe)});if(!Ee.ok){const le=await Nu(Ee);throw new Error(le||"Li khi cp nht n hng t My ch")}await fe()}catch(Ee){console.error("Li khi cp nht n hng:",Ee),alert(`Li khi cp nht n hng: ${Ee instanceof Error?Ee.message:String(Ee)}`)}},[ce,fe]),Pe=v.useCallback(async()=>{if(P){b(!1);try{const we=await fetch(`${Bs}${kt.ORDER_BY_ID(P.id)}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({can_hoan:P[It.GIA_TRI_CON_LAI],gia_tri_con_lai:P[It.GIA_TRI_CON_LAI],check_flag:P[It.CHECK_FLAG_STATUS]})});if(!we.ok){const xe=await Nu(we);throw new Error(xe||"Li khi xa n hng t My ch")}r(xe=>xe.filter(Ee=>Ee.id!==P.id))}catch(we){console.error("Li khi xa n hng:",we),alert(`Li khi xa n hng: ${we instanceof Error?we.message:String(we)}`)}finally{D(null)}}},[P]);return{...J,filteredOrders:ie,paginationPages:te,searchTerm:n,setSearchTerm:a,searchField:i,setSearchField:s,statusFilter:l,setStatusFilter:d,currentPage:h,setCurrentPage:f,rowsPerPage:p,setRowsPerPage:x,isModalOpen:g,isViewModalOpen:_,isEditModalOpen:S,isCreateModalOpen:E,orderToView:A,orderToDelete:P,orderToEdit:L,openCreateModal:H,closeCreateModal:se,closeViewModal:Y,closeEditModal:ce,closeModal:ue,handleViewOrder:me,handleEditOrder:Re,handleDeleteOrder:U,handleSaveNewOrder:B,handleSaveEdit:Oe,handleConfirmRefund:ne,handleMarkPaid:K,handleRenewOrder:z,confirmDelete:Pe,fetchError:O,reloadOrders:fe,renewingOrderCode:re}},h3=ki.memo(function({order:t,index:r,isExpanded:n,showRemainingColumn:a,showActionButtons:i,isActiveDataset:s,isCanceled:l,totalColumns:d,renewingOrderCode:h,onToggleDetails:f,onView:p,onEdit:x,onDelete:g,onConfirmRefund:b,onMarkPaid:_,onRenew:w}){const{[It.SO_NGAY_CON_LAI]:S,[It.GIA_TRI_CON_LAI]:T,[It.TRANG_THAI_TEXT]:E,[It.CHECK_FLAG_STATUS]:k}=t,A=Number.isFinite(Number(t[G.COST]))?Number(t[G.COST]):0,j=Number.isFinite(Number(t[G.PRICE]))?Number(t[G.PRICE]):0,P=Number.isFinite(Number(T))?Number(T):0,D=Number.isFinite(Number(t.can_hoan))?Number(t.can_hoan):null,L=l?Math.max(0,D!==null&&Number.isFinite(P)?Math.min(D,P):D??P):P,I=Gl(String(E||"")),O=M1(I),M=l&&I.includes("chua hoan"),re=t[It.ORDER_DATE_DISPLAY]||"",oe=t[It.EXPIRY_DATE_DISPLAY]||"",ee=String(t[G.ID_ORDER]||"").trim(),fe=h===ee,J=Number.isFinite(Number(S))?Number(S):0,ie=l?"text-indigo-600":J<=0?"text-red-600":J<=4?"text-orange-500":"text-green-500",Q=l?ku(L):J,te=v.useCallback(()=>{t.id!==void 0&&t.id!==null&&f(t.id)},[f,t.id]),H=se=>Y=>{Y.stopPropagation(),se(t)};return c.jsxs(ki.Fragment,{children:[c.jsxs("tr",{onClick:te,className:`cursor-pointer transition ${r%2===0?"bg-slate-900/55":"bg-indigo-950/40"} ${n?"bg-indigo-700/25":""} hover:bg-indigo-600/25`,children:[c.jsx("td",{className:"px-4 py-4 text-sm font-medium text-white w-[150px] text-center",children:c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"font-bold whitespace-nowrap truncate max-w-[150px]",children:t[G.ID_ORDER]||""}),c.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[G.ID_PRODUCT]||""})]})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-white w-[140px] text-center",children:c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"text-white/80 text-xs whitespace-nowrap truncate max-w-[150px]",children:t[G.INFORMATION_ORDER]||""}),t[G.SLOT]?c.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",children:t[G.SLOT]}):null]})}),c.jsx("td",{className:"px-4 py-4 text-sm text-white w-[150px] text-center",children:c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("span",{className:"font-medium whitespace-nowrap truncate max-w-[150px]",children:t[G.CUSTOMER]||""}),c.jsx("span",{className:"text-white/70 text-xs mt-0.5 whitespace-nowrap truncate max-w-[150px]",title:String(t[G.CONTACT]||""),children:t[G.CONTACT]||""})]})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm text-white w-[150px] text-center",children:re&&oe?`${re} - ${oe}`:re||oe||""}),a&&c.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-sm font-bold w-[60px] text-center",children:c.jsx("span",{className:ie,children:Q})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate w-[90px] text-center",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a3(String(E||""))}`,children:String(E||"")})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap truncate text-right text-sm font-medium w-[90px]",children:c.jsxs("div",{className:"flex space-x-2 justify-end",children:[c.jsx("button",{onClick:H(p),className:"text-blue-600 hover:text-blue-900 p-1 rounded",children:c.jsx(ud,{className:"h-4 w-4"})}),M&&c.jsx("button",{onClick:H(b),className:"text-emerald-600 hover:text-emerald-800 p-1 rounded",title:"Xc nhn  gii/hon tin",children:c.jsx(nc,{className:"h-4 w-4"})}),s&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:H(x),className:"text-green-600 hover:text-green-900 p-1 rounded",children:c.jsx(ac,{className:"h-4 w-4"})}),c.jsx("button",{onClick:H(g),className:"text-red-500 hover:text-red-700 p-1 rounded",title:"Xoa don hang",children:c.jsx(qs,{className:"h-4 w-4"})})]})]})})]}),n&&c.jsx("tr",{className:"bg-indigo-900/40",children:c.jsx("td",{colSpan:d,className:"px-6 pb-6 pt-0",children:c.jsxs("div",{className:"rounded-2xl border border-dashed border-indigo-200/60 bg-indigo-600/20 p-5 shadow-lg shadow-indigo-900/30",children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1 text-center",children:[c.jsx("p",{className:"text-sm font-semibold text-indigo-50",children:"Chi tit n hng"}),c.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wide text-indigo-200",children:["#",t[G.ID_ORDER]||""]})]}),i&&c.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[!(t[G.STATUS]===oi.DA_THANH_TOAN&&t[G.CHECK_FLAG]===!0||I==="can gia han")&&c.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-md shadow-emerald-900/40",onClick:H(_),children:" Thanh Ton"}),!O&&c.jsx("button",{className:"rounded-full px-3 py-1 text-xs font-semibold text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 shadow-md shadow-indigo-900/40 disabled:opacity-70 disabled:cursor-not-allowed",disabled:fe,onClick:se=>{se.stopPropagation(),fe||w(t)},children:fe?"ang Gia Hn...":"Gia Hn"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ngun"}),c.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[G.SUPPLY]||"N/A"})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi nhp"}),c.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:ku(A)})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi bn"}),c.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:ku(j)})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Gi tr cn li"}),c.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:ku(L)})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"S ngy"}),c.jsx("p",{className:"mt-1 text-sm font-semibold text-white",children:t[G.DAYS]||0})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Ghi ch"}),c.jsx("p",{className:"mt-1 text-sm text-indigo-50 text-center",children:t[G.NOTE]||"Khng c ghi ch."})]}),c.jsxs("div",{className:"rounded-xl border border-indigo-200/60 bg-indigo-500/20 p-3 text-center sm:col-span-2 lg:col-span-5 flex flex-col items-center justify-center",children:[c.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-200",children:"Kim tra"}),k===null?c.jsx("div",{className:"mt-3 h-5"}):c.jsx("div",{className:"mt-3 flex items-center justify-center",children:c.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:!!k,readOnly:!0,onClick:se=>se.stopPropagation()})})]})]})]})})})]})});h3.displayName="OrderRow";const yQ=[{value:"all",label:"Tt c ct"},{value:G.ID_ORDER,label:"M n Hng"},{value:G.ID_PRODUCT,label:"Sn Phm"},{value:G.INFORMATION_ORDER,label:"Thng tin"},{value:G.CUSTOMER,label:"Khch Hng"},{value:G.SLOT,label:"Slot"},{value:G.SUPPLY,label:"Ngun"}];function wQ(){const[e,t]=v.useState("active"),[r,n]=v.useState({active:0,expired:0,canceled:0}),{currentOrders:a,totalPages:i,updatedStats:s,filteredOrders:l,paginationPages:d,searchTerm:h,setSearchTerm:f,searchField:p,setSearchField:x,statusFilter:g,setStatusFilter:b,currentPage:_,setCurrentPage:w,rowsPerPage:S,setRowsPerPage:T,isModalOpen:E,isViewModalOpen:k,isEditModalOpen:A,isCreateModalOpen:j,orderToView:P,orderToDelete:D,orderToEdit:L,openCreateModal:I,closeCreateModal:O,closeViewModal:M,closeEditModal:re,closeModal:oe,handleViewOrder:ee,handleEditOrder:fe,handleDeleteOrder:J,handleSaveNewOrder:ie,handleSaveEdit:Q,handleConfirmRefund:te,handleMarkPaid:H,handleRenewOrder:se,confirmDelete:Y,fetchError:ce,reloadOrders:ue,totalRecords:me,renewingOrderCode:Re}=vQ(e);v.useEffect(()=>{n(Ee=>Ee[e]===me?Ee:{...Ee,[e]:me})},[e,me]);const U=e==="active",[B,K]=v.useState(null),z=v.useCallback(Ee=>{K(le=>le===Ee?null:Ee)},[]),ne=e!=="expired",Oe=e!=="expired",Pe=e==="canceled",we=Pe?"Gi Tr Cn Li":"Cn Li",xe=ne?7:6;return c.jsxs("div",{className:"space-y-6",children:[ce&&c.jsxs("div",{className:"flex flex-col gap-3 rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-800 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[c.jsx("span",{children:ce}),c.jsx("button",{type:"button",onClick:ue,className:"rounded-md border border-red-300 px-4 py-2 text-xs font-semibold uppercase tracking-wide text-red-700 transition hover:bg-red-100",children:"Th Li"})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun L n Hng"}),c.jsx("p",{className:"mt-1 text-sm text-gray-200",children:"Qun l v theo di tt c cc n hng ca khch hng"})]}),c.jsx("div",{className:"mt-4 sm:mt-0",children:U&&c.jsx(Ci,{icon:Ai,onClick:I,children:"To n Hng Mi"})})]}),c.jsx("div",{className:"rounded-[28px] bg-gradient-to-r from-indigo-200/60 via-indigo-300/55 to-slate-200/45 p-4 shadow-[0_20px_50px_-28px_rgba(0,0,0,0.5),0_14px_32px_-24px_rgba(255,255,255,0.25)] border border-white/20",children:c.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:eQ.map(Ee=>{const le=Ee,De=u3[le],Ue=e===le,Ce=r[le]??0;return c.jsxs("button",{type:"button",onClick:()=>t(le),className:`flex items-center justify-between rounded-2xl px-5 py-4 text-left transition shadow-[0_12px_28px_-16px_rgba(0,0,0,0.65),0_8px_22px_-18px_rgba(255,255,255,0.12)] ${Ue?"bg-gradient-to-r from-indigo-500 via-violet-500 to-indigo-500 text-white ring-1 ring-white/25":"bg-indigo-700/70 text-indigo-100 hover:bg-indigo-600/80 ring-1 ring-white/10"}`,children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white drop-shadow",children:De.label}),c.jsx("p",{className:"text-xs text-indigo-100/80",children:De.description})]}),c.jsx("div",{className:"text-2xl font-bold text-lime-200 drop-shadow",children:Ce.toLocaleString("vi-VN")})]},Ee)})})}),c.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-slate-800/65 via-slate-700/55 to-slate-900/65 border border-white/15 p-6 shadow-[0_20px_55px_-30px_rgba(0,0,0,0.7),0_14px_34px_-26px_rgba(255,255,255,0.2)] backdrop-blur-sm",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(Ee=>c.jsx(Qi,{title:Ee.name,value:Ee.value,icon:Ee.icon,accent:Ee.accent},Ee.name))})}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[c.jsxs("div",{className:"relative",children:[c.jsx(il,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Tm kim n hng, khch hng...",className:"w-full pl-10 pr-44 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:h,onChange:Ee=>f(Ee.target.value)}),c.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:c.jsx("select",{className:"min-w-[140px] md:min-w-[180px] px-3 py-1.5 border border-gray-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:p,onChange:Ee=>x(Ee.target.value),children:yQ.map(Ee=>c.jsx("option",{value:Ee.value,children:Ee.label},Ee.value))})})]}),c.jsxs("div",{className:"relative",children:[c.jsx(S6,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:g,onChange:Ee=>b(Ee.target.value),children:[c.jsx("option",{value:"all",children:"Tt c trng thi"}),c.jsx("option",{value:oi.DA_THANH_TOAN,children:" thanh ton"}),c.jsx("option",{value:oi.CHUA_THANH_TOAN,children:"Cha thanh ton"}),c.jsx("option",{value:oi.CAN_GIA_HAN,children:"Cn gia hn"}),c.jsx("option",{value:oi.ORDER_EXPIRED,children:"Ht hn"})]})]})]})}),c.jsxs("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-white/10 table-fixed text-white",children:[c.jsx("thead",{className:"bg-slate-900/90",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"ORDER/SN PHM"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[140px] whitespace-nowrap truncate",children:"THNG TIN N HNG"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"KHCH HNG"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[150px] whitespace-nowrap truncate",children:"HN N HNG"}),ne&&c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[60px] whitespace-nowrap truncate",children:we}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"TRNG THI"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-white/70 uppercase tracking-wider w-[90px] whitespace-nowrap truncate",children:"THAO TC"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:a.length===0?c.jsx("tr",{children:c.jsxs("td",{colSpan:xe,className:"text-center py-12",children:[c.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng tm thy n hng"}),c.jsx("div",{className:"text-white/60",children:"Th thay i b lc tm kim"})]})}):a.map((Ee,le)=>c.jsx(h3,{order:Ee,index:le,isExpanded:B===Ee.id,showRemainingColumn:ne,showActionButtons:Oe,isActiveDataset:U,isCanceled:Pe,totalColumns:xe,renewingOrderCode:Re,onToggleDetails:z,onView:ee,onEdit:fe,onDelete:J,onConfirmRefund:te,onMarkPaid:H,onRenew:se},Ee.id))})]})}),l.length>0&&c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-t border-white/10 bg-slate-900/85 text-white px-4 py-3 sm:px-6",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-white/80",children:[c.jsx("span",{children:"Hin th"}),c.jsxs("select",{id:"rowsPerPage",value:S,onChange:Ee=>T(Number(Ee.target.value)),className:"rounded-md border border-white/20 bg-slate-900/70 py-1 pl-2 pr-7 text-white focus:border-indigo-400 focus:ring-indigo-400",children:[c.jsx("option",{value:10,children:"10"}),c.jsx("option",{value:25,children:"25"}),c.jsx("option",{value:50,children:"50"})]}),c.jsx("span",{children:"dng"})]}),c.jsxs("div",{className:"flex items-center gap-2 sm:justify-end",children:[c.jsx("button",{onClick:()=>w(1),disabled:_===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang u",children:"<<"}),c.jsx("button",{onClick:()=>w(Ee=>Math.max(Ee-1,1)),disabled:_===1,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang trc",children:"<"}),c.jsx("div",{className:"flex items-center gap-1",children:d.map((Ee,le)=>Ee==="..."?c.jsx("span",{className:"px-3 py-1 text-white/50",children:"..."},`ellipsis-${le}`):c.jsx("button",{onClick:()=>w(Ee),disabled:Ee===_,className:`h-9 min-w-[36px] rounded-lg px-3 text-sm font-semibold transition border ${Ee===_?"bg-blue-600 text-white border-blue-500 shadow-lg shadow-blue-900/40":"bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`,children:Ee},Ee))}),c.jsx("button",{onClick:()=>w(Ee=>Math.min(Ee+1,i)),disabled:_===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang sau",children:">"}),c.jsx("button",{onClick:()=>w(i),disabled:_===i,className:"h-9 w-9 rounded-lg border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed","aria-label":"Trang cui",children:">>"})]})]})]}),c.jsx(d3,{isOpen:E,onClose:oe,onConfirm:Y,title:"Xc nhn xa",message:`Bn c chc chn mun xa n hng: ${D?.id_order}?`}),c.jsx(iQ,{isOpen:k,onClose:M,order:P,formatCurrency:ku}),c.jsx(oQ,{isOpen:A,onClose:re,order:L,onSave:Ee=>Q(Ee)}),c.jsx(hQ,{isOpen:j,onClose:O,onSave:Ee=>{ie(Ee)}})]})}const bQ={informationUser:"",informationPass:"",informationMail:"",note:"",accountUser:"",accountPass:"",accountMail:"",accountNote:"",supplier:"",import:"",expired:"",capacity:"",slot:"",slotLinkMode:"information",hasCapacity:!1},mh=[{value:"information",label:"Thng tin gi"},{value:"note",label:"Ghi ch"},{value:"supplier",label:"Nh cung cp"},{value:"import",label:"Gi nhp (VND)"},{value:"expired",label:"Ngy ht hn"},{value:"capacity",label:"Tng dung lng (GB)"}],L1=e=>e.filter(t=>t!=="capacity"),dc=5,fc=2e3,B1=100,_Q=.2,SQ=2,NQ=[{value:"information",label:"Lin kt theo thng tin n hng",helper:"Cc gi s c lin kt vi n hng da trn cc trng thng tin nh tn sn phm, thng tin sn phm."},{value:"slot",label:"Lin kt theo v tr",helper:"Cc gi s c lin kt vi n hng da trn m nh danh v tr (slot) ca n hng."}],DC=[{value:"all",label:"Tt c trng thi"},{value:"full",label:"Cn nhiu"},{value:"low",label:"Sp ht"},{value:"out",label:" ht"}],EQ=or.informationOrder,p3=or.slot,m3="package_slot_link_prefs",x3=(e,t)=>t<=0||e<=0?"out":e/t<=_Q?"low":"ok",Au=e=>e<=0?"out":e<SQ?"low":"ok",Cp=e=>(e||"").toLowerCase().replace(/[^a-z0-9]/g,""),RC=e=>{const t=Cp(e);return{normalized:t,lettersOnly:t.replace(/[0-9]/g,"")}},Xs=e=>e==null?"":(typeof e=="string"?e:String(e)).trim(),g3=e=>{const t=hr(e??"");if(t)return t;const r=(e||"").trim();if(!r)return"";const n=r.match(/^(\d{1,2})[/-](\d{1,2})[/-](\d{4})$/);if(n){const[,a,i,s]=n;return`${String(a).padStart(2,"0")}/${String(i).padStart(2,"0")}/${s}`}return r},IC=e=>{const t=Xs(e);return t?t.replace(/\s+/g," ").trim().toLowerCase():""},$1=e=>{const t=Xs(e);return t?t.toLowerCase().replace(/\s+/g,""):""},TQ=e=>{const t=$1(e.informationUser||"");return t?[t]:[]},CQ=(e,t)=>t==="slot"?e.slotDisplay||e.customerDisplay||e.informationDisplay||"":e.informationDisplay||e.customerDisplay||e.slotDisplay||"",kQ=(e,t,r)=>{const n=Xs(r);if(t!=="slot")return n?[n]:[];const i=(e.slotDisplay??"").split("|").map(l=>Xs(l)).filter(Boolean);if(i.length>=1)return i;const s=Xs(e.customerDisplay);return s?[s,`${s} (2)`]:n?[n]:[]},FC=e=>{if(!e)return null;const t=e.match(/(\d{2,4})/);if(!t)return null;const r=Number(t[1]);return Number.isFinite(r)?r:null},AQ=(e,t)=>{let n=t.productKey;if(e){const s=n.indexOf(e);s>=0&&(n=n.slice(s+e.length))}const a=FC(n);if(a)return a;const i=Cp(t.base?.id_product??"");return FC(i)},PQ=e=>`${e&&Number.isFinite(e)&&e>0?Math.round(e):B1} GB`,jQ=e=>e===p3?"slot":"information",a0=e=>e==="slot"?p3:EQ,v3=e=>Cp(e),wi=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.replace(/[^0-9]/g,"");if(!t)return null;const r=Number(t);return Number.isFinite(r)?r:null}return null},cv=e=>e==null?"":typeof e=="string"?e:String(e),MC=(e,t,r)=>[e&&`Ti khon: ${e}`,t&&`Mt khu: ${t}`,r&&`Mail 2FA: ${r}`].filter(Boolean).join(" | ")||"",OQ=e=>{const t="slotLimit"in e&&typeof e.slotLimit=="number"?String(e.slotLimit):cv(e.slot),r="capacityLimit"in e&&typeof e.capacityLimit=="number"?String(e.capacityLimit):cv(e.capacity);return{informationUser:e.informationUser??"",informationPass:e.informationPass??"",informationMail:e.informationMail??"",note:e.note??"",accountUser:e.accountUser??"",accountPass:e.accountPass??"",accountMail:e.accountMail??"",accountNote:e.accountNote??"",supplier:e.supplier??"",import:cv(e.import),expired:e.expired??"",capacity:r,slot:t,slotLinkMode:e.slotLinkMode??"information",hasCapacity:e.hasCapacityField??!1}},DQ=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(m3);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}},RQ=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(m3,JSON.stringify(e))}catch{}},LC=(e,t)=>{const r=e.capacity===void 0||e.capacity===null?null:e.capacity,n=e.hasCapacityField===void 0?!!e.hasCapacity||r!==null:!!e.hasCapacityField,a=e.match??e.matchModeValue??null,i=e.id!==void 0&&e.id!==null?t[String(e.id)]:void 0,s=a?jQ(a):e.slotLinkMode??(i==="slot"?"slot":"information"),l=Array.isArray(e.productCodes)?e.productCodes.map(h=>typeof h=="string"?h.trim():"").filter(h=>!!h):[],d=Array.from(new Set(l.map(h=>v3(h)).filter(Boolean)));return{...e,slot:e.slot??dc,slotUsed:e.slotUsed??0,capacity:r,hasCapacityField:n,slotLinkMode:s,matchModeValue:a,productCodes:l,normalizedProductCodes:d}},IQ=({row:e,showCapacityColumn:t,tableColumnCount:r,isExpanded:n,onToggle:a,onEdit:i,onView:s,onDelete:l})=>{const d=e.slotLimit||dc,h=e.slotUsed,f=e.remainingSlots,p=d>0?Math.min(f/d*100,100):0,x=Au(f),g=x==="out"?"bg-red-500":x==="low"?"bg-yellow-500":"bg-green-500",b=e.capacityLimit||fc,_=e.capacityUsed,w=e.remainingCapacity,S=b>0?Math.min(w/b*100,100):0,T=x3(w,b),E=T==="out"?"bg-red-500":T==="low"?"bg-yellow-500":"bg-green-500",k=Math.min(h,d),A=e.slotAssignments??[],j=Array.from({length:Math.max(d,0)},(D,L)=>{const I=L+1,O=I<=k,M=A[I-1]??null;return{slotNumber:I,isUsed:O,assignment:M}}),P=t&&!!e.hasCapacityField;return c.jsxs(c.Fragment,{children:[c.jsxs("tr",{onClick:()=>a(e.id),className:`hover:bg-indigo-500/20 ${n?"bg-indigo-900/30":""} cursor-pointer text-white`,children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-white",children:e.package}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.informationUser||""}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[c.jsxs("div",{className:"text-sm text-white",children:[c.jsx("span",{className:"font-medium",children:h})," / ",d," V tr"]}),c.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:c.jsx("div",{className:`h-2 rounded-full ${g}`,style:{width:`${p}%`}})}),c.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",f]})]}),t&&c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:P?c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"text-sm text-white",children:[c.jsx("span",{className:"font-medium",children:_})," /"," ",b," GB"]}),c.jsx("div",{className:"w-full bg-white/20 rounded-full h-2 mt-1",children:c.jsx("div",{className:`h-2 rounded-full ${E}`,style:{width:`${S}%`}})}),c.jsxs("div",{className:"text-xs text-white/70 mt-1",children:["Cn trng: ",w," GB"]})]}):c.jsx("div",{className:"text-sm text-white/70 italic",children:"Khng c"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.supplier||""}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[Number(e.import||0).toLocaleString("vi-VN")," VND"]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:g3(e.expired)}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:e.note||""}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-3",children:[c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-blue-50 text-blue-600 hover:bg-blue-100 transition",type:"button","aria-label":"Sa",onClick:D=>{D.stopPropagation(),i(e)},children:c.jsx(ac,{className:"h-4 w-4"})}),c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-purple-50 text-purple-600 hover:bg-purple-100 transition",type:"button","aria-label":"Xem",onClick:D=>{D.stopPropagation(),s(e)},children:c.jsx(ud,{className:"h-4 w-4"})}),c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-red-50 text-red-600 hover:bg-red-100 transition",type:"button","aria-label":"Xa",onClick:D=>{D.stopPropagation(),l(e)},children:c.jsx(qs,{className:"h-4 w-4"})})]})]}),n&&c.jsx("tr",{children:c.jsx("td",{colSpan:r,className:"bg-indigo-900/30 px-6 py-4 text-white",children:c.jsxs("div",{className:"border border-dashed border-white/40 rounded-lg p-4 space-y-4 text-center",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi Tit Cc v tr"}),c.jsxs("p",{className:"text-xs text-white/80",children:["Hin th ",d," v tr - ",h,"  dng,"," ",f," cn trng"]})]}),c.jsx("div",{className:"flex flex-wrap justify-center gap-3",children:j.map(D=>c.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg border px-3 py-2 basis-1/2 sm:basis-1/3 lg:basis-1/5 min-w-[120px] ${D.isUsed?"border-yellow-300 bg-yellow-50":"border-green-200 bg-green-50"}`,title:D.assignment?.matchValue||D.assignment?.slotLabel||void 0,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(a6,{className:`h-5 w-5 ${D.isUsed?"text-yellow-500":"text-green-500"}`}),c.jsx("span",{className:"text-sm font-semibold text-gray-900 max-w-[170px] truncate",title:D.assignment?.slotLabel||(D.assignment?void 0:`v tr ${D.slotNumber}`),children:D.assignment?.slotLabel?D.assignment.slotLabel:`v tr ${D.slotNumber}`})]}),c.jsx("p",{className:`text-xs mt-1 ${D.isUsed?"text-yellow-700":"text-green-700"}`,children:D.assignment&&P?PQ(D.assignment.capacityUnits):D.isUsed?" dng":"Cn trng"})]},D.slotNumber))})]})})})]})},FQ=({rows:e,loading:t,showCapacityColumn:r,tableColumnCount:n,onEdit:a,onView:i,onDelete:s})=>{const[l,d]=v.useState(null),h=f=>{d(p=>p===f?null:f)};return c.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden text-white",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Tn Gi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thng Tin Gi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"S Lng"}),r&&c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Dung Lng"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"NCC"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Gi Nhp"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ngy Ht Hn"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Ghi Ch"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/80 uppercase tracking-wider",children:"Thao Tc"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?c.jsx("tr",{children:c.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"ang Ti D Liu..."})}):e.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:n,className:"px-6 py-8 text-center text-white/80 text-sm",children:"Khng c gi no  hin th."})}):e.map((f,p)=>c.jsx(IQ,{row:f,showCapacityColumn:r,tableColumnCount:n,isExpanded:l===f.id,onToggle:h,onEdit:a,onView:i,onDelete:s},`${f.id}-${p}`))})]})})})},cb=({open:e,title:t,onClose:r,children:n,footer:a})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden",role:"dialog","aria-modal":"true",children:[c.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[c.jsx("h2",{className:"text-lg font-semibold text-white",children:t}),c.jsx("button",{onClick:r,className:"text-white/70 hover:text-gray-600 transition","aria-label":"?A3ng",children:c.jsx(Hr,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"px-5 py-4 max-h-[70vh] overflow-y-auto",children:n}),c.jsx("div",{className:"px-5 py-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:a})]})}):null,MQ=({open:e,initialName:t,initialFields:r,onClose:n,onSubmit:a,mode:i})=>{const[s,l]=v.useState(t),[d,h]=v.useState(new Set(r)),[f,p]=v.useState(null);v.useEffect(()=>{e&&(l(t),h(new Set(r)),p(null))},[e,r,t]);const x=w=>{h(S=>{const T=new Set(S);return T.has(w)?T.delete(w):T.add(w),T})},g=()=>h(new Set(mh.map(w=>w.value))),b=()=>h(new Set),_=w=>{w.preventDefault();const S=s.trim();if(!S){p("Vui lng nhp tn loi gi.");return}if(d.size===0){p("Vui lng chn t nht mt trng d liu.");return}a(S,Array.from(d))};return c.jsx(cb,{open:e,title:i==="edit"&&t?`Chnh sa loi gi: ${t}`:"To loi gi sn phm mi",onClose:n,footer:c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy b"}),c.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:i==="create"?"To Loi":"Lu Thay i"})]}),children:c.jsxs("form",{onSubmit:_,className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn Loi Gi"}),c.jsx("input",{type:"text",value:s,onChange:w=>l(w.target.value),placeholder:"V d: Google One, Netflix, Spotify...",className:`w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 ${i==="edit"?"bg-gray-100 cursor-not-allowed":""}`,disabled:i==="edit"}),i==="edit"&&c.jsx("p",{className:"text-xs text-white/70 mt-1",children:"Bn ch c th chnh sa cc trng d liu, tn loi gi gi nguyn."})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Cc trng d liu ca loi gi ny"}),c.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[c.jsx("button",{type:"button",onClick:g,className:"text-blue-600 hover:text-blue-700",children:"Chn tt c"}),c.jsx("button",{type:"button",onClick:b,className:"text-rose-600 hover:text-rose-700",children:"B chn tt c"})]})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:mh.map(w=>c.jsxs("label",{className:`flex items-center gap-3 rounded-lg border p-3 transition cursor-pointer ${d.has(w.value)?"bg-blue-50 border-blue-200 ring-1 ring-blue-300":"bg-white border-gray-200 hover:bg-indigo-500/10"}`,children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-white/40 text-blue-600 focus:ring-blue-500",checked:d.has(w.value),onChange:()=>x(w.value)}),c.jsx("span",{className:"text-sm font-medium text-gray-800",children:w.label})]},w.value))})]}),f&&c.jsx("p",{className:"text-sm text-red-600",children:f})]})})},BC=({open:e,mode:t,template:r,initialValues:n,onClose:a,onSubmit:i})=>{const s=v.useMemo(()=>({...bQ,...n??{}}),[n]),[l,d]=v.useState(s),h=v.useCallback(T=>{const E=T.replace(/[^0-9]/g,"");if(!E)return"";const k=Number(E);return Number.isFinite(k)?k.toLocaleString("vi-VN"):""},[]);v.useEffect(()=>{e&&d({...s,import:h(s.import)})},[e,s,h]);const f=(T,E)=>{const k=E.target.value;if(T==="import"){d(A=>({...A,import:h(k)}));return}d(A=>({...A,[T]:k}))},p=T=>{T.preventDefault(),i(l)},x=T=>{d(E=>({...E,slotLinkMode:T}))},b=["information","note","supplier","import","expired"].some(T=>r.fields.includes(T)),_=r.fields.includes("capacity"),w=b||_,S=b&&_;return c.jsx(cb,{open:e,title:`${t==="add"?"Thm Gi":"Sa Gi"} - ${r.name}`,onClose:a,footer:c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-200 rounded-lg hover:bg-indigo-500/15 transition",children:"Hy"}),c.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:t==="add"?"Lu gi":"Lu thay i"})]}),children:c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[w&&c.jsxs("div",{className:`grid grid-cols-1 gap-4 ${S?"md:grid-cols-2":""}`,children:[b&&c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-white",children:"Chi tit gi"}),c.jsx("p",{className:"text-xs text-white/80",children:"Nhp cc trng m t lin quan n gi ny."})]}),r.fields.includes("information")&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),c.jsx("input",{type:"text",value:l.informationUser,onChange:T=>f("informationUser",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),c.jsx("input",{type:"text",value:l.informationPass,onChange:T=>f("informationPass",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),c.jsx("input",{type:"email",value:l.informationMail,onChange:T=>f("informationMail",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),r.fields.includes("note")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),c.jsx("input",{type:"text",value:l.note,onChange:T=>f("note",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ghi ch cho gi ny"})]}),r.fields.includes("supplier")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nh cung cp"}),c.jsx("input",{type:"text",value:l.supplier,onChange:T=>f("supplier",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),r.fields.includes("import")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi nhp (VND)"}),c.jsx("input",{type:"text",inputMode:"numeric",value:l.import,onChange:T=>f("import",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ngy ht hn"}),c.jsx("input",{type:"date",value:l.expired,onChange:T=>f("expired",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),_&&c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),c.jsx("p",{className:"text-xs text-white/80",children:"Cung cp thng tin ti khon dung lng."})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ti khon"}),c.jsx("input",{type:"text",value:l.accountUser,onChange:T=>f("accountUser",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tn ng nhp"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mt khu"}),c.jsx("input",{type:"text",value:l.accountPass,onChange:T=>f("accountPass",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mt khu"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mail 2FA"}),c.jsx("input",{type:"email",value:l.accountMail,onChange:T=>f("accountMail",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"mail@example.com"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch"}),c.jsx("textarea",{value:l.accountNote,onChange:T=>f("accountNote",T),className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Ghi ch cho ti khon dung lng"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dung lng (GB)"}),c.jsx("input",{type:"number",min:0,value:l.capacity,onChange:T=>f("capacity",T),placeholder:`Mc nh: ${fc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"S v tr (slot)"}),c.jsx("input",{type:"number",min:0,value:l.slot,onChange:T=>f("slot",T),placeholder:`Mc nh: ${dc}`,className:"w-full border border-white/40 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"flex items-center justify-between mb-2",children:c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Chn ch  ghp lnh"}),c.jsx("p",{className:"text-xs text-white/80",children:"Chn phng thc kt ni gia gi v n hng."})]})}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:NQ.map(T=>{const E=l.slotLinkMode===T.value;return c.jsxs("button",{type:"button",onClick:()=>x(T.value),className:`border rounded-lg p-3 text-left transition ${E?"border-white/40 bg-white/10 text-white shadow-md":"border-white/20 bg-white/0 text-white/80 hover:border-white/40 hover:bg-white/5"}`,children:[c.jsx("span",{className:"block text-sm font-semibold",children:T.label}),c.jsx("span",{className:"block text-xs text-white/70 mt-1",children:T.helper})]},T.value)})}),c.jsxs("p",{className:"text-xs text-white/80 mt-2",children:[c.jsx("b",{children:"Link theo thng tin n hng:"})," So khp thng tin gi (ti khon, mail, v.v.) vi chi tit trong n hng.",c.jsx("br",{}),c.jsx("b",{children:"Link theo v tr:"})," So khp thng tin gi vi m v tr (slot) khai bo trong n hng.",c.jsx("br",{})]})]}),r.fields.length===0&&c.jsx("p",{className:"text-sm text-white/80",children:"Loi gi ny khng c trng d liu no c cu hnh."})]})})},LQ=({open:e,row:t,onClose:r})=>{if(!e||!t)return null;const n=[{label:"Ti khon",value:t.informationUser},{label:"Mt khu",value:t.informationPass},{label:"Mail 2FA",value:t.informationMail},{label:"Ghi ch",value:t.note},{label:"Ngun",value:t.supplier},{label:"Gi nhp",value:t.import},{label:"Ngy ht hn",value:g3(t.expired)}],a=[{label:"Ti khon",value:t.accountUser},{label:"Mt khu",value:t.accountPass},{label:"Mail 2FA",value:t.accountMail},{label:"Ghi ch",value:t.accountNote}],i=!!t.hasCapacityField,s=t.capacityLimit||fc,l=t.capacityUsed||0,d=t.remainingCapacity||0,h=s>0?Math.min(d/s*100,100):0,f=x3(d,s),p=f==="out"?"bg-red-500":f==="low"?"bg-yellow-500":"bg-green-500";return c.jsx(cb,{open:e,title:`Chi Tit Gi: ${t.package}`,onClose:r,footer:c.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition",children:"ng"}),children:c.jsxs("div",{className:`grid grid-cols-1 gap-4 ${i?"md:grid-cols-2":""}`,children:[c.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-white",children:"Thng tin gi"}),c.jsx("p",{className:"text-xs text-white/80",children:"Cc trng d liu c lu cho gi ny."})]}),c.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:n.map(x=>c.jsxs("div",{children:[c.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),c.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))})]}),i&&c.jsxs("section",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-white",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-white",children:"Ti khon dung lng"}),c.jsx("p",{className:"text-xs text-white/80",children:"Tng quan v ti khon dung lng."})]}),c.jsx("dl",{className:"grid grid-cols-1 gap-3 text-sm",children:a.map(x=>c.jsxs("div",{children:[c.jsx("dt",{className:"text-[11px] uppercase tracking-wide text-white/80",children:x.label}),c.jsx("dd",{className:"text-sm font-medium text-white break-words",children:x.value!==null&&x.value!==void 0&&x.value!==""?x.value:"-"})]},x.label))}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-sm text-white",children:[c.jsx("span",{className:"font-semibold",children:l})," /"," ",s," GB"]}),c.jsx("div",{className:"w-full bg-white/20 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full ${p}`,style:{width:`${h}%`}})}),c.jsxs("div",{className:"text-xs text-white/80",children:["Cn trng: ",d," GB"]})]})]})]})})},y3=(e,t)=>{const r=e.base;return r?.id!==void 0&&r?.id!==null?`id:${r.id}`:r?.id_order!==void 0&&r?.id_order!==null?`code:${r.id_order}`:`${e.productKey||e.infoKey}-${t}`},BQ=(e,t)=>{if(e.size===0)return[];const r=new Map;return e.forEach(n=>{const a=t.get(n);a?.length&&a.forEach(i=>{const s=y3(i,r.size);r.has(s)||r.set(s,i)})}),Array.from(r.values())},$Q=()=>{const[e,t]=v.useState(""),[r,n]=v.useState("all"),[a,i]=v.useState("all"),[s,l]=v.useState([]),[d,h]=v.useState([]),[f,p]=v.useState([]),[x,g]=v.useState(!0),[b,_]=v.useState(!0),[w,S]=v.useState(!1),[T,E]=v.useState(()=>DQ()),k=v.useRef(T),A=v.useMemo(()=>mh.map(Y=>Y.value),[]);v.useEffect(()=>{k.current=T},[T]);const j=v.useCallback((Y,ce)=>{const ue=String(Y);E(me=>{if(me[ue]===ce)return me;const Re={...me,[ue]:ce};return RQ(Re),Re})},[]);v.useEffect(()=>{let Y=!1;return(async()=>{try{g(!0);const ce=await Ct("/api/package-products");if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const ue=await ce.json();if(!Y)if(Array.isArray(ue)){const me=ue.map(Re=>LC(Re,k.current));l(me)}else l([])}catch(ce){console.error("Ti sn phm gi tht bi:",ce),Y||l([])}finally{Y||g(!1)}})(),()=>{Y=!0}},[]),v.useEffect(()=>{let Y=!1;return(async()=>{try{_(!0),S(!1);const ce=await Ct("/api/orders");if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const ue=await ce.json();Y||(Array.isArray(ue)?h(ue):h([]),S(!0))}catch(ce){console.error("Ti danh sch n hng tht bi:",ce),Y||(h([]),S(!1))}finally{Y||_(!1)}})(),()=>{Y=!0}},[]);const P=v.useMemo(()=>Array.from(new Set(s.map(Y=>Y.package))).sort(),[s]);v.useEffect(()=>{p(Y=>{const ce=new Map(Y.map(me=>[me.name,me]));let ue=!1;return P.forEach(me=>{if(!me)return;const Re=s.some(B=>B.package===me&&B.hasCapacityField),U=ce.get(me);if(!U){const B=Re?A:L1(A);ce.set(me,{name:me,fields:B,isCustom:!1}),ue=!0;return}if(U.isCustom!==!0&&!Re&&U.fields.includes("capacity")){const B=L1(U.fields);ce.set(me,{...U,fields:B}),ue=!0}}),ue?Array.from(ce.values()).sort((me,Re)=>me.name.localeCompare(Re.name)):Y})},[P,s,A]);const D=v.useMemo(()=>d.map(Y=>{const ce=RC(Y.id_product??""),ue=RC(Y.information_order??"");return{base:Y,productKey:ce.normalized,productLettersKey:ce.lettersOnly,infoKey:ue.normalized,infoLettersKey:ue.lettersOnly,slotDisplay:Xs(Y.slot),slotKey:IC(Y.slot),slotMatchKey:$1(Y.slot),informationDisplay:Xs(Y.information_order),informationKey:IC(Y.information_order),informationMatchKey:$1(Y.information_order),customerDisplay:Xs(Y.customer),productCodeNormalized:v3(Y.id_product)}}),[d]),L=v.useMemo(()=>{const Y=new Map;return D.forEach(ce=>{if(!ce.productCodeNormalized)return;const ue=ce.productCodeNormalized;Y.has(ue)||Y.set(ue,[]),Y.get(ue).push(ce)}),Y},[D]),I=v.useMemo(()=>s.map(Y=>{const ce=!!Y.hasCapacityField,ue=wi(Y.slot),me=ue&&ue>0?Math.floor(ue):dc,Re=wi(Y.slotUsed),U=Cp(Y.package),B=U.replace(/[0-9]/g,""),z=(Y.slotLinkMode??"information")==="information"?"slot":"information",ne=z==="slot"?"information":"slot",Oe=TQ(Y),Pe=Y.normalizedProductCodes??[],we=Pe.length>0?new Set(Pe):null,xe=w&&D.length>0&&(we?.size||U.length>0),Ee=Ze=>!we||we.size===0?!1:!!Ze.productCodeNormalized&&we.has(Ze.productCodeNormalized),le=Ze=>{if(!U)return!1;const At=!!Ze.productKey&&(Ze.productKey.startsWith(U)||Ze.productKey.includes(U))||!!B&&!!Ze.productLettersKey&&(Ze.productLettersKey.startsWith(B)||Ze.productLettersKey.includes(B)),Ot=!!Ze.infoKey&&(Ze.infoKey.startsWith(U)||Ze.infoKey.includes(U))||!!B&&!!Ze.infoLettersKey&&(Ze.infoLettersKey.startsWith(B)||Ze.infoLettersKey.includes(B));return At||Ot},De=Ze=>Ee(Ze)||le(Ze),Ue=Ze=>{if(Oe.length===0)return!0;const At=ne==="slot"?Ze.slotMatchKey:Ze.informationMatchKey;return At?Oe.some(Ot=>Ot===At||Ot.includes(At)||At.includes(Ot)):!1},Ce=xe&&we?.size?BQ(we,L):null,Ae=xe?(()=>{const Ze=new Map,At=Ot=>{const Mt=y3(Ot,Ze.size);Ze.has(Mt)||Ze.set(Mt,Ot)};return Ce?.forEach(At),D.forEach(Ot=>{De(Ot)&&At(Ot)}),Array.from(Ze.values()).filter(Ot=>Ue(Ot))})():[],ve=new Set,Le=[];xe&&Ae.forEach(Ze=>{const At=CQ(Ze,z),Mt=(ne==="slot"?Ze.slotDisplay:Ze.informationDisplay)||Ze.customerDisplay||"",Ie=Ze.base?.id!==void 0&&Ze.base?.id!==null?`id:${Ze.base.id}`:Ze.base?.id_order!==void 0&&Ze.base?.id_order!==null?`code:${Ze.base.id_order}`:`${Mt}-${Le.length}`;if(ve.has(Ie))return;ve.add(Ie);const at=At||Mt,xt=kQ(Ze,z,at);if(xt.length===0)return;const yt=ce?AQ(U,Ze):null;xt.forEach(bt=>{const Tt=bt||at||"";Tt&&Le.push({slotLabel:Tt,matchValue:Mt||Tt,sourceOrderId:Ze.base?.id??null,sourceOrderCode:Ze.base?.id_order??null,displayColumn:z,matchColumn:ne,capacityUnits:yt})})});const pe=Le.length>0?Le.length:Re!==null?Math.max(Math.floor(Re),0):0,tt=Math.min(pe,me),Ye=Math.max(me-tt,0);let Be=0,ot=0,et=0;if(ce){const Ze=wi(Y.capacity);Be=Ze&&Ze>0?Math.floor(Ze):fc;const At=wi(Y.capacityUsed),Ot=Le.length>0?Le.reduce((Ie,at)=>Ie+(at.capacityUnits??B1),0):pe*B1,Mt=Math.min(Ot,Be);ot=Math.min(Math.max(At!==null?Math.floor(At):Mt,0),Be),et=Math.max(Be-ot,0)}const Je=xe?Ae.map(Ze=>Ze.base):[];return{...Y,slotUsed:tt,slotLimit:me,remainingSlots:Ye,capacityLimit:Be,capacityUsed:ot,remainingCapacity:et,slotAssignments:Le,matchedOrders:Je,packageCode:U,hasCapacityField:ce,productCodes:Y.productCodes??[],normalizedProductCodes:Pe,matchModeValue:Y.matchModeValue??Y.match??null}}),[s,D,w,L]),O=r!=="all"?r:null,M=v.useMemo(()=>O?f.find(Y=>Y.name===O)??null:null,[f,O]),re=v.useMemo(()=>O?I.filter(Y=>Y.package===O):I,[I,O]),oe=v.useMemo(()=>re.filter(Y=>{const ce=e.trim().toLowerCase(),ue=[Y.information,Y.informationUser,Y.informationMail,Y.informationPass,Y.accountUser,Y.accountMail,Y.accountPass,Y.note],me=ce.length===0||ue.some(K=>(K==null?"":String(K)).toLowerCase().includes(ce)),Re=r==="all"||Y.package===r,U=Au(Y.remainingSlots);return me&&Re&&(a==="all"||a==="full"&&U==="ok"||a===U)}),[re,e,r,a]),ee=v.useMemo(()=>[...oe].sort((Y,ce)=>{const ue=Number(Y.remainingSlots),me=Number(ce.remainingSlots),Re=Number.isFinite(ue)?ue:Number.POSITIVE_INFINITY,U=Number.isFinite(me)?me:Number.POSITIVE_INFINITY,B=Re<=0?Number.POSITIVE_INFINITY:Re,K=U<=0?Number.POSITIVE_INFINITY:U;return B===K?0:B-K}),[oe]),J=oe.some(Y=>Y.hasCapacityField??!1)||oe.length===0&&(M?.fields.includes("capacity")??!1),ie=J?9:8,Q=v.useMemo(()=>{const Y=re.reduce((ue,me)=>Au(me.remainingSlots)==="low"?ue+1:ue,0),ce=re.reduce((ue,me)=>Au(me.remainingSlots)==="out"?ue+1:ue,0);return{total:re.length,low:Y,out:ce}},[re]),te=v.useMemo(()=>{const Y=new Set;return I.forEach(ce=>{const ue=(ce.package||"").trim();ue&&Y.add(ue)}),f.forEach(ce=>{ce.name&&Y.add(ce.name)}),Array.from(Y).sort((ce,ue)=>ce.localeCompare(ue))},[I,f]),H=v.useMemo(()=>{const Y=new Map;return te.forEach(ce=>Y.set(ce,{total:0,low:0,out:0})),I.forEach(ce=>{const ue=(ce.package||"").trim();if(!ue)return;const me=Y.get(ue);if(!me)return;me.total+=1;const Re=Au(ce.remainingSlots);Re==="low"&&(me.low+=1),Re==="out"&&(me.out+=1)}),te.map(ce=>({name:ce,...Y.get(ce)??{total:0,low:0,out:0}}))},[te,I]),se=v.useCallback(Y=>LC(Y,k.current),[]);return{data:{rows:s,templates:f,computedRows:I,filteredRows:oe,sortedRows:ee,scopedRows:re,selectedPackage:O,selectedTemplate:M,packageSummaries:H,slotStats:Q,showCapacityColumn:J,tableColumnCount:ie,loading:x||b,packagesLoading:x,ordersLoading:b,ordersReady:w,defaultTemplateFields:A},filters:{searchTerm:e,categoryFilter:r,statusFilter:a},actions:{setSearchTerm:t,setCategoryFilter:n,setStatusFilter:i,setRows:l,setTemplates:p,persistSlotLinkPreference:j,applySlotLinkPrefs:se}}},$C=[{border:"border-sky-100/70",glow:"from-sky-100/80 via-white/80 to-blue-100/70",link:"text-sky-600 hover:text-sky-700"},{border:"border-emerald-100/70",glow:"from-emerald-100/80 via-white/80 to-lime-100/70",link:"text-emerald-600 hover:text-emerald-700"},{border:"border-violet-100/70",glow:"from-violet-100/80 via-white/80 to-fuchsia-100/70",link:"text-violet-600 hover:text-violet-700"},{border:"border-amber-100/70",glow:"from-amber-100/80 via-white/80 to-orange-100/70",link:"text-amber-600 hover:text-amber-700"}],UQ=()=>{const{data:{templates:e,filteredRows:t,sortedRows:r,selectedPackage:n,selectedTemplate:a,packageSummaries:i,slotStats:s,showCapacityColumn:l,tableColumnCount:d,loading:h,defaultTemplateFields:f},filters:{searchTerm:p,categoryFilter:x,statusFilter:g},actions:{setSearchTerm:b,setCategoryFilter:_,setStatusFilter:w,setRows:S,setTemplates:T,persistSlotLinkPreference:E,applySlotLinkPrefs:k}}=$Q(),[A,j]=v.useState(!1),[P,D]=v.useState(""),[L,I]=v.useState(mh.map(Ie=>Ie.value)),[O,M]=v.useState("create"),[re,oe]=v.useState(!1),[ee,fe]=v.useState(!1),[J,ie]=v.useState(null),[Q,te]=v.useState(!1),[H,se]=v.useState(null),[Y,ce]=v.useState(!1),[ue,me]=v.useState(!1),[Re,U]=v.useState(new Set),[B,K]=v.useState(null),[z,ne]=v.useState(!1),[Oe,Pe]=v.useState(null),we=oo(),xe=Bh();v.useEffect(()=>{const xt=new URLSearchParams(we.search).get("package")||"all";_(yt=>yt===xt?yt:xt)},[we.search,_]);const Ee=v.useCallback(Ie=>{const at=Ie==="all"||x===Ie?"all":Ie;at!==x&&_(at);const xt=new URLSearchParams(we.search);at==="all"?xt.delete("package"):xt.set("package",at);const yt=xt.toString(),bt=yt?`?${yt}`:"";bt!==we.search&&xe({pathname:we.pathname,search:bt},{replace:!0})},[x,we.pathname,we.search,xe,_]),le=()=>{if(n&&a){Ue({name:n,fields:a.fields,mode:"edit"});return}Ue()},De=()=>{if(n){if(!a){Ue({name:n,fields:f,mode:"create"});return}oe(!0)}},Ue=v.useCallback(Ie=>{D(Ie?.name??""),I(Ie?.fields&&Ie.fields.length>0?Ie.fields:f),M(Ie?.mode??"create"),j(!0)},[f]),Ce=v.useCallback((Ie,at)=>{const xt=Ie.trim();xt&&(T(yt=>{const bt=yt.filter(Tt=>Tt.name!==xt);return bt.push({name:xt,fields:at,isCustom:!0}),bt.sort((Tt,Kt)=>Tt.name.localeCompare(Kt.name))}),j(!1),Ee(xt))},[Ee,T]),Ae=v.useCallback(Ie=>{const at=e.find(xt=>xt.name===Ie)??null;Ue({name:Ie,fields:at?.fields??f,mode:"edit"})},[e,Ue,f]),ve=v.useCallback(()=>{ce(!1),U(new Set)},[]),Le=v.useCallback(Ie=>{const at=Ie.trim();at&&U(xt=>{const yt=new Set(xt);return yt.has(at)?yt.delete(at):yt.add(at),yt})},[]),pe=v.useCallback(async()=>{if(Re.size===0){ve();return}me(!0);const Ie=Array.from(Re);try{const at=await Ct("/api/package-products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:Ie})});if(!at.ok){const bt=await at.text();throw new Error(bt||`HTTP ${at.status}`)}const xt=await at.json().catch(()=>({})),yt=Array.isArray(xt.deletedNames)?xt.deletedNames:Ie;S(bt=>bt.filter(Tt=>!yt.includes((Tt.package||"").trim()))),T(bt=>bt.filter(Tt=>!yt.includes(Tt.name))),n&&yt.includes(n)&&Ee("all")}catch(at){console.error("Xa nhm tht bi:",at),alert(`Xa nhm tht bi: ${at instanceof Error?at.message:"Li khng xc nh"}`)}finally{me(!1),ve()}},[Re,ve,n,Ee,S,T]),tt=v.useCallback(Ie=>{const at=e.find(xt=>xt.name===Ie.package)??{name:Ie.package,fields:Ie.hasCapacityField?f:L1(f),isCustom:!1};ie({rowId:Ie.id,template:at,initialValues:OQ(Ie),accountStorageId:Ie.accountStorageId??null}),fe(!0)},[e,f]),Ye=v.useCallback(()=>{fe(!1),ie(null)},[]),Be=v.useCallback(Ie=>{se(Ie),te(!0)},[]),ot=v.useCallback(()=>{te(!1),se(null)},[]),et=v.useCallback(Ie=>{Pe(null),K(Ie)},[]),Je=v.useCallback(()=>{ne(!1),Pe(null),K(null)},[]),Ze=v.useCallback(async()=>{if(!B||z)return;const Ie=B.id,at=(B.package||"").trim();if(Ie==null){Pe("Khong tim thay ID goi de xoa.");return}ne(!0);const xt=async yt=>{const bt=await yt.text().catch(()=>""),Tt=bt?bt.replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim():"",Kt=yt.status?` (HTTP ${yt.status})`:"",mr=Tt||yt.statusText||"Khong the thuc hien xoa tren may chu";throw new Error(`Khong the xoa goi${Kt}: ${mr}`)};try{const yt=await Ct(`/api/package-products/${Ie}`,{method:"DELETE"});yt.ok||await xt(yt);const bt=await yt.json().catch(()=>({}));console.log("Delete package product response",{targetId:Ie,targetName:at,data:bt});const Tt=new Set((bt.deletedIds&&bt.deletedIds.length?bt.deletedIds:[Ie]).map(Kt=>String(Kt)));S(Kt=>Kt.filter(mr=>{const Ar=mr.id!==void 0&&mr.id!==null?String(mr.id):"__";return!Tt.has(Ar)})),Je()}catch(yt){console.error("Xoa goi that bai:",yt),Pe(yt instanceof Error?yt.message:"Loi khong xac dinh"),ne(!1)}},[z,B,S,T,n,Ee,Je,Pe]),At=v.useCallback(async Ie=>{if(!a)return;const at=a.fields.includes("capacity"),xt=a.fields.includes("information"),yt=a.fields.includes("note"),bt=a.fields.includes("supplier"),Tt=a.fields.includes("import"),Kt=wi(Ie.slot),mr=Kt!==null&&Kt>0?Math.floor(Kt):dc,Ar=wi(Ie.capacity),xn=Ar!==null&&Ar>0?Math.floor(Ar):fc,Aa=xt?MC(Ie.informationUser||null,Ie.informationPass||null,Ie.informationMail||null):"",Gn={packageName:a.name,informationUser:xt&&Ie.informationUser||null,informationPass:xt&&Ie.informationPass||null,informationMail:xt&&Ie.informationMail||null,note:yt&&Ie.note||null,supplier:bt&&Ie.supplier||null,importPrice:Tt?wi(Ie.import)??0:null,accountUser:at&&Ie.accountUser||null,accountPass:at&&Ie.accountPass||null,accountMail:at&&Ie.accountMail||null,accountNote:at&&Ie.accountNote||null,capacity:at?xn:null,hasCapacityField:at,expired:Ie.expired||null,slotLimit:mr,matchMode:a0(Ie.slotLinkMode)};try{const Yn=await Ct("/api/package-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Gn)});if(!Yn.ok)throw new Error(`HTTP ${Yn.status}`);const Xn=await Yn.json(),qa=k({...Xn,slot:mr,slotUsed:0,capacity:at?xn:Xn.capacity,information:xt?Aa||null:Xn.information,match:Xn.match??a0(Ie.slotLinkMode),hasCapacityField:at});S(ua=>[...ua,qa]),Xn.id!==void 0&&Xn.id!==null&&E(Xn.id,Ie.slotLinkMode),oe(!1)}catch(Yn){console.error("Li khi to gi sn phm:",Yn)}},[a,k,S,E]),Ot=v.useCallback(async Ie=>{if(!J)return;const{template:at,rowId:xt,accountStorageId:yt}=J,bt=at.fields.includes("capacity"),Tt=at.fields.includes("information"),Kt=at.fields.includes("note"),mr=at.fields.includes("supplier"),Ar=at.fields.includes("import"),xn=wi(Ie.slot),Aa=xn!==null&&xn>0?Math.floor(xn):dc,Gn=wi(Ie.capacity),Yn=Gn!==null&&Gn>0?Math.floor(Gn):fc,Xn=Tt?MC(Ie.informationUser||null,Ie.informationPass||null,Ie.informationMail||null):"",qa={packageName:at.name,informationUser:Tt&&Ie.informationUser||null,informationPass:Tt&&Ie.informationPass||null,informationMail:Tt&&Ie.informationMail||null,note:Kt&&Ie.note||null,supplier:mr&&Ie.supplier||null,importPrice:Ar?wi(Ie.import)??0:null,expired:Ie.expired||null,slotLimit:Aa,accountStorageId:yt??null,accountUser:bt&&Ie.accountUser||null,accountPass:bt&&Ie.accountPass||null,accountMail:bt&&Ie.accountMail||null,accountNote:bt&&Ie.accountNote||null,capacity:bt?Yn:null,hasCapacityField:bt,matchMode:a0(Ie.slotLinkMode)};try{const ua=await Ct(`/api/package-products/${xt}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(qa)});if(!ua.ok)throw new Error(`HTTP ${ua.status}`);const qn=await ua.json(),Rc=k({...qn,slot:Aa,capacity:bt?Yn:qn.capacity,information:Tt?Xn||null:qn.information,match:qn.match??a0(Ie.slotLinkMode),hasCapacityField:bt});S(Ri=>Ri.map(Ii=>Ii.id===xt?Rc:Ii)),E(xt,Ie.slotLinkMode),Ye()}catch(ua){console.error(`Cp nht Gi Sn Phm ${xt} Li:`,ua)}},[J,Ye,k,S,E]),Mt=v.useMemo(()=>[{name:"Tng",value:String(s.total),icon:nc,accent:Rr.sky},{name:"Gi sp ht",value:String(s.low),icon:ly,accent:Rr.amber},{name:"Gi  ht",value:String(s.out),icon:iy,accent:Rr.rose},{name:"Thm hm nay",value:"0",icon:sy,accent:Rr.emerald}],[s]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun l Gi Sn phm"}),c.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Qun l cc loi gi sn phm v cc gi con."})]}),c.jsxs("div",{className:"mt-4 sm:mt-0 flex flex-wrap gap-3",children:[Y?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:pe,className:"flex items-center justify-center gap-1 rounded-lg bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-600 transition disabled:opacity-60",disabled:ue,title:"Xc nhn xa",children:c.jsx(Wo,{className:"h-5 w-5"})}),c.jsx("button",{type:"button",onClick:ve,className:"flex items-center justify-center gap-1 rounded-lg bg-white/20 px-3 py-2 text-sm font-semibold text-gray-800 shadow hover:bg-gray-300 transition disabled:opacity-60",disabled:ue,title:"Hy xa",children:c.jsx(Hr,{className:"h-5 w-5"})})]}):c.jsx(Ci,{icon:qs,onClick:()=>{ce(!0),U(new Set)},disabled:ue,children:"Xa Loi gi"}),c.jsx(Ci,{icon:Ai,onClick:le,children:"To Loi Gi"}),c.jsx(Ci,{icon:Ai,onClick:De,disabled:!n,children:"Thm Gi"})]})]}),c.jsx("div",{className:"rounded-[32px] bg-gradient-to-br from-white/5 via-indigo-900/35 to-indigo-950/55 border border-white/10 p-6 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Mt.map(Ie=>c.jsx(Qi,{title:Ie.name,value:Ie.value,icon:Ie.icon,accent:Ie.accent},Ie.name))})}),c.jsxs("div",{className:"bg-white/10 rounded-xl shadow-sm p-6 text-white",children:[c.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-white",children:"Tng quan cc loi gi"}),c.jsx("p",{className:"text-sm text-white/80",children:"Chn mt loi gi  xem chi tit hoc xa."})]})}),i.length===0?c.jsx("p",{className:"mt-6 text-sm text-white/70",children:"Khng c loi gi no c tm thy."}):c.jsx("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:i.map((Ie,at)=>{const xt=Ie.name===n,yt=$C[at%$C.length],bt=Re.has(Ie.name.trim());return c.jsxs("div",{className:`relative isolate rounded-3xl border ${yt.border} bg-white/80 p-5 text-white shadow-[0_20px_50px_-35px_rgba(15,23,42,0.7)] backdrop-blur transition duration-200 ${xt?"ring-2 ring-blue-400 shadow-[0_25px_65px_-35px_rgba(37,99,235,0.7)]":"hover:shadow-[0_30px_75px_-40px_rgba(15,23,42,0.55)]"}`,children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-white/70",children:"Loi Gi"}),c.jsx("h3",{className:"text-lg font-semibold",children:Ie.name}),c.jsxs("p",{className:"mt-1 text-sm text-white/80",children:["S lng gi: ",Ie.total]})]}),Y?c.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-rose-600",children:[c.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-rose-300 text-rose-600 focus:ring-rose-400",checked:bt,disabled:ue,onChange:()=>Le(Ie.name)}),"Chn  xa"]}):c.jsx("div",{className:"flex flex-col items-end gap-1 text-sm font-semibold",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>Ee(Ie.name),className:`p-2 rounded-full hover:bg-blue-50 transition ${xt?"text-blue-300":"text-white/80"}`,title:"Xem chi tit",children:c.jsx(ud,{className:"h-5 w-5"})}),c.jsx("button",{type:"button",onClick:()=>Ae(Ie.name),className:"p-2 rounded-full hover:bg-indigo-50 text-indigo-500 transition",title:"Chnh sa Loi Gi",children:c.jsx(ac,{className:"h-5 w-5"})})]})})]}),c.jsxs("dl",{className:"mt-5 grid grid-cols-3 gap-4 text-sm",children:[c.jsxs("div",{className:"rounded-2xl border border-white/60 bg-white/70 p-3 text-center shadow-inner",children:[c.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tng"}),c.jsx("dd",{className:"mt-1 text-2xl font-bold text-white",children:Ie.total})]}),c.jsxs("div",{className:"rounded-2xl border border-amber-100/70 bg-amber-50/60 p-3 text-center shadow-inner",children:[c.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-amber-600",children:"Sp ht"}),c.jsx("dd",{className:"mt-1 text-2xl font-bold text-amber-500",children:Ie.low})]}),c.jsxs("div",{className:"rounded-2xl border border-rose-100/70 bg-rose-50/60 p-3 text-center shadow-inner",children:[c.jsx("dt",{className:"text-xs font-semibold uppercase tracking-wide text-rose-600",children:"Ht"}),c.jsx("dd",{className:"mt-1 text-2xl font-bold text-rose-500",children:Ie.out})]})]})]},Ie.name)})})]}),n&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[c.jsxs("div",{className:"relative",children:[c.jsx(il,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:`Tm kim trong cc gi ca ${n}...`,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900 placeholder:text-gray-400",value:p,onChange:Ie=>b(Ie.target.value)})]}),c.jsx("select",{className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900",value:g,onChange:Ie=>w(Ie.target.value),children:DC.map(Ie=>c.jsx("option",{value:Ie.value,children:Ie.label},Ie.value))}),c.jsx("button",{className:`px-4 py-2 rounded-lg transition-colors ${t.length?"bg-gray-100 text-gray-800 hover:bg-indigo-50":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,disabled:!t.length,children:"Xut Excel"})]}),c.jsxs("div",{className:"text-sm text-white/80",children:["ang xem loi gi:"," ",c.jsx("span",{className:"font-medium text-white",children:n??"Tt c"}),g!=="all"&&c.jsxs(c.Fragment,{children:[" ",""," ",c.jsx("span",{className:"font-medium text-white",children:DC.find(Ie=>Ie.value===g)?.label})]})]})]}),c.jsx(FQ,{rows:r,loading:h,showCapacityColumn:l,tableColumnCount:d,onEdit:tt,onView:Be,onDelete:et})]}),c.jsx(MQ,{open:A,initialName:P,initialFields:L,mode:O,onClose:()=>j(!1),onSubmit:Ce}),a&&c.jsx(BC,{mode:"add",open:re,template:a,onClose:()=>oe(!1),onSubmit:At}),ee&&J&&c.jsx(BC,{mode:"edit",open:ee,template:J.template,initialValues:J.initialValues,onClose:Ye,onSubmit:Ot}),c.jsx(LQ,{open:Q,row:H,onClose:ot}),c.jsx(d3,{isOpen:!!B,onClose:Je,onConfirm:Ze,title:"Xac nhan xoa goi",message:`Ban co chac muon xoa goi "${B?.package}"?`,secondaryMessage:Oe||void 0,confirmLabel:"OK",cancelLabel:"Huy",isSubmitting:z})]})},zQ=async e=>{const t=await Ct("/api/product-descriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text().catch(()=>"");throw new Error(Jo(n,{fallback:"Khong the luu product_desc."}))}const r=await t.json().catch(()=>null);if(!r||typeof r!="object")throw new Error("Phan hoi khong hop le tu server.");return{id:Number(r.id)||0,productId:r.productId||"",productName:r.productName??null,rules:r.rules||"",rulesHtml:r.rulesHtml||r.rules||"",description:r.description||"",descriptionHtml:r.descriptionHtml||r.description||"",imageUrl:r.imageUrl??null}},WQ=async(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.limit!==void 0&&t.set("limit",String(e.limit)),e.offset!==void 0&&t.set("offset",String(e.offset));const r=t.toString(),n=await Ct(`/api/product-descriptions${r?`?${r}`:""}`);if(!n.ok){const l=await n.text().catch(()=>"");throw new Error(Jo(l,{fallback:"Khong the tai thong tin san pham."}))}const a=await n.json().catch(()=>null);if(!a||!Array.isArray(a.items))return{items:[],count:0,total:0,offset:0,limit:e.limit};const i=typeof a.count=="number"&&Number.isFinite(a.count)?a.count:a.items.length,s=typeof a.total=="number"&&Number.isFinite(a.total)?a.total:i;return{...a,count:i,total:s,offset:typeof a.offset=="number"&&Number.isFinite(a.offset)?a.offset:e.offset??0,limit:typeof a.limit=="number"&&Number.isFinite(a.limit)?a.limit:e.limit??a.items.length}},HQ=({searchTerm:e,onSearchChange:t,onAddClick:r})=>c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsxs("div",{className:"relative flex-1 min-w-[220px] max-w-xl",children:[c.jsx("input",{type:"text",placeholder:"Tm kim theo tn hoc m sn phm...",className:"w-full bg-[#0f1729] border border-white/10 text-white placeholder:text-white/50 rounded-lg pl-10 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/50",value:e,onChange:n=>t(n.target.value)}),c.jsx(il,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/60"})]}),c.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold rounded-lg shadow",onClick:r,type:"button",children:"Thm Sn Phm Mi"})]}),U1=(e,t,r)=>Math.min(Math.max(e,t),r),KQ=(e,t)=>{const r=[];if(e<=5){for(let i=1;i<=e;i++)r.push(i);return r}const n=U1(t-1,2,e-3),a=U1(t+1,4,e-1);r.push(1),n>2&&r.push("...");for(let i=n;i<=a;i++)r.push(i);return a<e-1&&r.push("..."),r.push(e),r};function VQ({currentPage:e,totalItems:t,pageSize:r=10,onPageChange:n,className:a=""}){const i=r>0?r:10,s=Math.max(1,Math.ceil(t/i)),l=U1(e,1,s),d=l>1,h=l<s,f="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition disabled:opacity-40 disabled:cursor-not-allowed",p="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 hover:bg-white/10 transition",x="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]",g=t===0?0:(l-1)*i+1,b=Math.min(l*i,t),_=KQ(s,l);return c.jsxs("div",{className:`flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between text-sm ${a}`,children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx("button",{className:f,onClick:()=>n(1),disabled:!d,children:"<<"}),c.jsx("button",{className:f,onClick:()=>n(l-1),disabled:!d,children:"<"}),c.jsx("div",{className:"flex items-center gap-1.5",children:_.map((w,S)=>w==="..."?c.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${S}`):c.jsx("button",{className:`${p} ${w===l?x:""}`,onClick:()=>n(w),disabled:w===l,children:w},w))}),c.jsx("button",{className:f,onClick:()=>n(l+1),disabled:!h,children:">"}),c.jsx("button",{className:f,onClick:()=>n(s),disabled:!h,children:">>"})]}),c.jsx("div",{className:"text-white/70",children:t===0?"0 mc":`${g}-${b} trong ${t}`})]})}const S0=10,GQ=e=>{const t=e.trim();return t?t.slice(0,2).toUpperCase():"--"},un=e=>e?e.replace(/--\d+m$/i,"").trim():"",oa=e=>(e||"").replace(/\n/g,"<br/>"),Ll=e=>un(e).toLowerCase(),uv=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),Pu=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","SECTION"]),a=s=>{if(s.nodeType===Node.TEXT_NODE)return uv(s.textContent||"");if(s.nodeType===Node.ELEMENT_NODE){const l=s;if(l.tagName==="BR")return"<br/>";if(l.tagName==="A"){const h=l.getAttribute("href")||"#",f=uv(h),p=Array.from(l.childNodes).map(a).join("");return`<a href="${f}" title="${f}" target="_blank" rel="noopener noreferrer">${p}</a>`}const d=Array.from(l.childNodes).map(a).join("");return n.has(l.tagName)?`${d}<br/>`:d}return""};return Array.from(r.body.childNodes).map(a).join("").replace(/(?:<br\/>\s*){3,}/g,"<br/><br/>")}catch{return uv(e)}},YQ=e=>e?Pu(e):"",dv=(e,t)=>{if(t&&t.trim())return{rulesHtml:e||"",descriptionHtml:t};const r=(e||"").replace(/<\/?(?:p|div)[^>]*>/gi,`
`).replace(/<br\s*\/?>(?![\s\S]*<td)/gi,`
`).replace(/<br\s*\/?>(?=\s*<\/)/gi,`
`).replace(/<br\s*\/?>(?=\s*$)/gi,`
`),n=r.normalize("NFD").replace(/[\u0300-\u036f]/g,""),a=/(thA'ng tin\s*&\s*tA-nh nng|thA'ng tin sn phcm|mA' t|nTi dung|tA-nh nng)/i,i=n.match(a),s=l=>l.replace(/\n+/g,`
`).split(`
`).join("<br/>");if(i&&(i.index??0)>=3){const l=i.index??0,d=r.slice(0,l).trim(),h=r.slice(l).trim();return{rulesHtml:s(d),descriptionHtml:s(h)}}return{rulesHtml:e||"",descriptionHtml:t||""}},XQ=(e,t,r)=>{const n=(r||"").toLowerCase().trim(),a=new Map;t.forEach(l=>{const d=Ll(l.san_pham||""),h=Ll(l.package_product||"");[d,h].filter(Boolean).forEach(p=>{a.has(p)||a.set(p,l)})});const i=new Map;for(const l of e){const d=Ll(l.productId||""),h=d?a.get(d):null,f={...l,productId:un(l.productId||""),productName:l.productName||(h?un(h.package_product||h.san_pham||""):null)||l.productId,packageProduct:h?un(h.package_product||h.san_pham||""):null,packageName:h?un(h.package||h.san_pham||""):null,rulesHtml:l.rulesHtml||oa(l.rules||""),descriptionHtml:l.descriptionHtml||oa(l.description||"")},p=d||Ll(f.productName||"");p&&(i.has(p)||i.set(p,f))}for(const l of t){const d=Ll(l.san_pham||""),h=Ll(l.package_product||""),f=d||h,p=d&&i.has(d)||h&&i.has(h);!f||p||i.set(f,{id:l.id,productId:un(l.san_pham||""),productName:un(l.package_product||l.san_pham||""),packageProduct:un(l.package_product||l.san_pham||""),packageName:un(l.package||""),rules:"",rulesHtml:"",description:"",descriptionHtml:"",imageUrl:null})}let s=Array.from(i.values());return n&&(s=s.filter(l=>`${l.productId||""} ${l.productName||""} ${l.description||""} ${l.rules||""}`.toLowerCase().replace(/\s+/g," ").includes(n))),s},UC=({item:e,size:t="small"})=>{const r=e.productName||e.productId||"--",n=GQ(r),a=t==="large"?"w-32 h-32 text-2xl":"w-12 h-12 text-xs",i="rounded-md bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white font-bold";return e.imageUrl?c.jsx("img",{src:e.imageUrl,alt:r,className:`${a} rounded-md object-cover`,onError:s=>{s.currentTarget.style.display="none"}}):c.jsx("div",{className:`${a} ${i}`,children:c.jsx("span",{children:n})})},qQ=({item:e,isExpanded:t,onToggle:r,onEdit:n})=>{const a=e.packageProduct||e.productName||e.productId||"--",i=e.rulesHtml||oa(e.rules||""),s=e.descriptionHtml||oa(e.description||""),{rulesHtml:l,descriptionHtml:d}=dv(i,s),h=Pu(l)||"Cha c-p nh-t",f=Pu(d||oa(e.description||""))||"Cha c-p nh-t";return c.jsxs(ki.Fragment,{children:[c.jsxs("tr",{className:`hover:bg-white/5 cursor-pointer ${t?"bg-white/5":""}`,onClick:()=>r(t?null:Number(e.id)),children:[c.jsx("td",{className:"px-4 py-3",children:c.jsx(UC,{item:e})}),c.jsx("td",{className:"px-4 py-3 text-white",children:c.jsx("div",{className:"flex flex-col",children:c.jsx("span",{className:"font-semibold text-white",children:un(e.productId||"")||"--"})})}),c.jsx("td",{className:"px-4 py-3 text-white",children:un(a)||"--"}),c.jsx("td",{className:"px-5 py-3 pr-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:c.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.rulesHtml?void 0:e.rules||"",dangerouslySetInnerHTML:{__html:h}})}),c.jsx("td",{className:"px-5 py-3 pl-5 text-white/80 align-top border-r border-white/10 min-w-[240px]",children:c.jsx("span",{className:"block whitespace-pre-line break-words rich-display",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},title:e.descriptionHtml?void 0:e.description||"",dangerouslySetInnerHTML:{__html:f}})}),c.jsxs("td",{className:"px-4 py-3 space-x-2 whitespace-nowrap text-center align-top",children:[c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"Xem",type:"button",children:c.jsx(ud,{className:"h-5 w-5 text-blue-400"})}),c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"S-a",type:"button",onClick:p=>{p.stopPropagation(),n(e)},children:c.jsx($h,{className:"h-5 w-5 text-green-400"})}),c.jsx("button",{className:"inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/5 hover:bg-white/10 transition-colors",title:"XA3a",type:"button",children:c.jsx(qs,{className:"h-5 w-5 text-red-400"})})]})]}),t&&c.jsx("tr",{className:"bg-white/5",children:c.jsxs("td",{colSpan:6,className:"px-6 py-4",children:[c.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3 mb-3 flex flex-col items-center text-center",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"ThA'ng tin chi tit"}),c.jsx("p",{className:"mt-2 text-white/80 leading-relaxed",children:un(e.packageProduct||e.productName||e.productId||"")||"Cha cA3 mA' t chi tit."})]}),c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsx("div",{className:"w-full md:w-64 rounded-lg border border-white/10 bg-white/5 p-4 flex flex-col items-center justify-center text-white",children:c.jsx(UC,{item:e,size:"large"})}),c.jsxs("div",{className:"flex-1 space-y-3",children:[c.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Quy t_c bo hAnh"}),c.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Pu(dv(e.rulesHtml||oa(e.rules||""),e.descriptionHtml||oa(e.description||"")).rulesHtml)||"Cha cA3 quy t_c."}})]}),c.jsxs("div",{className:"rounded-lg border border-white/10 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"ThA'ng tin sn phcm"}),c.jsx("div",{className:"mt-2 text-white/80 leading-relaxed break-words rich-display",dangerouslySetInnerHTML:{__html:Pu(dv(e.rulesHtml||oa(e.rules||""),e.descriptionHtml||oa(e.description||"")).descriptionHtml||oa(e.description||""))||"Cha cA3 nTi dung."}})]})]})]})]})})]},`${e.id}-${e.productId}`)},QQ=({products:e,mergedTotal:t,loading:r,currentPage:n,pageSize:a,onPageChange:i,expandedId:s,onToggleExpand:l,onEdit:d})=>c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-[#0b1220] shadow-xl overflow-hidden",children:[c.jsxs("div",{className:"border-b border-white/10 px-4 py-3 flex items-center justify-between",children:[c.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sn Phcm"}),r&&c.jsx("span",{className:"text-xs text-white/60",children:"?ang ti..."})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full table-fixed divide-y divide-white/10 text-sm text-white/90",children:[c.jsxs("colgroup",{children:[c.jsx("col",{style:{width:"8%"}}),c.jsx("col",{style:{width:"14%"}}),c.jsx("col",{style:{width:"17%"}}),c.jsx("col",{style:{width:"25%",minWidth:"240px"}}),c.jsx("col",{style:{width:"25%",minWidth:"240px"}}),c.jsx("col",{style:{width:"11%",minWidth:"120px"}})]}),c.jsx("thead",{className:"bg-white/5 text-white",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"nh"}),c.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"MA Sn Phcm"}),c.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"TAn Sn Phcm"}),c.jsx("th",{className:"px-5 py-3 text-left font-semibold border-r border-white/10 min-w-[240px]",children:"Quy T_c"}),c.jsx("th",{className:"px-5 py-3 text-left font-semibold min-w-[240px] border-r border-white/10",children:"MA' T"}),c.jsx("th",{className:"px-4 py-3 text-left font-semibold min-w-[120px] text-center",children:"Thao TAc"})]})}),c.jsxs("tbody",{className:"divide-y divide-white/5",children:[e.map(h=>c.jsx(qQ,{item:h,isExpanded:s===h.id,onToggle:l,onEdit:d},`${h.id}-${h.productId}`)),!r&&e.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/70",children:"KhA'ng cA3 d_ liu product_desc."})}),r&&e.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-white/80",children:"?ang ti danh sAch..."})})]})]})}),c.jsx("div",{className:"border-t border-white/10 px-4 py-3",children:c.jsx(VQ,{currentPage:n,totalItems:t,pageSize:a,onPageChange:i})})]}),ZQ=({open:e,url:t,error:r,onChange:n,onClose:a,onConfirm:i})=>e?c.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 px-4",children:c.jsxs("div",{className:"w-full max-w-sm rounded-xl bg-[#0b1220] border border-white/10 p-5 shadow-2xl space-y-4",children:[c.jsx("h4",{className:"text-white font-semibold",children:'ChA"n liAn kt'}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70",children:"URL"}),c.jsx("input",{type:"text",value:t,onChange:s=>n(s.target.value),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."}),r&&c.jsx("div",{className:"text-xs text-rose-300",children:r})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3",children:[c.jsx("button",{className:"px-3 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:a,type:"button",children:"Hy"}),c.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:i,type:"button",children:'ChA"n link'})]})]})}):null,JQ=({product:e,saving:t,onClose:r,onSave:n})=>{const a=v.useMemo(()=>({productId:un(e?.productId||""),productName:un(e?.packageProduct||e?.productName||"")||"",rules:e?.rules||"",rulesHtml:e?.rulesHtml||oa(e?.rules||""),description:e?.description||"",descriptionHtml:e?.descriptionHtml||oa(e?.description||""),imageUrl:e?.imageUrl||""}),[e]),[i,s]=v.useState(a),[l,d]=v.useState(null),h=v.useRef(null),f=v.useRef(null),p=v.useRef(null),x=v.useRef(!1),[g,b]=v.useState(null),[_,w]=v.useState("#38bdf8"),S=v.useRef(null),[T,E]=v.useState(!1),[k,A]=v.useState("https://"),[j,P]=v.useState(null);v.useEffect(()=>{e&&(s(a),d(null),E(!1),A("https://"),P(null))},[a,e]);const D=()=>l==="rules"?h.current:f.current,L=(Q,te)=>{if(!te)return;const H=document.getSelection(),se=H&&H.rangeCount>0?H.getRangeAt(0).cloneRange():null,Y=YQ(te.innerHTML),ce=te.innerText;x.current=!0,s(me=>({...me,[Q]:ce,[`${Q}Html`]:Y}));const ue=document.activeElement===te;se&&ue&&(H?.removeAllRanges(),H?.addRange(se))};v.useEffect(()=>{const Q=h.current;if(Q){if(x.current){x.current=!1;return}Q.innerHTML=i.rulesHtml||oa(i.rules)}},[i.rules,i.rulesHtml]),v.useEffect(()=>{const Q=f.current;if(Q){if(x.current){x.current=!1;return}Q.innerHTML=i.descriptionHtml||oa(i.description)}},[i.description,i.descriptionHtml]),v.useEffect(()=>{if(!g)return;const Q=S.current;Q&&requestAnimationFrame(()=>{typeof Q.showPicker=="function"?Q.showPicker():Q.click()})},[g]);const I=()=>{const Q=D();if(!Q){p.current=null;return}const te=document.getSelection();te&&te.rangeCount>0&&Q.contains(te.focusNode)?p.current=te.getRangeAt(0).cloneRange():p.current=null},O=(Q,te,H=!1)=>{const se=D();if(se){if(H&&p.current){const Y=document.getSelection();Y&&(Y.removeAllRanges(),Y.addRange(p.current))}else I();se.focus(),document.execCommand(Q,!1,te),L(l||"rules",se)}},M=()=>{D()&&(I(),A("https://"),P(null),E(!0))},re=()=>{E(!1),P(null),A("https://")},oe=()=>{const Q=D();if(!Q){P('Vui lAng ch?n nTi dung tr>c khi chA"n link.');return}const te=k.trim();if(!/^https?:\/\//i.test(te)){P("URL phi b_t `u bng http:// hoc https://");return}Q.focus();const H=document.getSelection();H&&p.current&&(H.removeAllRanges(),H.addRange(p.current)),document.execCommand("createLink",!1,te),L(l||"rules",Q),re()},ee=(Q,te)=>{d(te),I(),b(Q),w(Q==="hiliteColor"?"#fef08a":"#38bdf8")},fe=Q=>{const te=g;te&&(w(Q),b(null),O(te,Q,!0))},J=Q=>{if(!Q){b(null);return}w(Q),fe(Q)},ie=Q=>c.jsx("div",{className:"rich-toolbar-wrapper",children:c.jsxs("div",{className:"rich-toolbar mb-2",children:[c.jsx("button",{type:"button",onClick:()=>O("bold"),children:"B"}),c.jsx("button",{type:"button",onClick:()=>O("italic"),children:"I"}),c.jsx("button",{type:"button",onClick:()=>O("underline"),children:"U"}),c.jsx("button",{type:"button",onClick:M,children:c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4",children:[c.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),c.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.71"})]})}),c.jsx("button",{type:"button","data-color-button":"true",onClick:()=>ee("foreColor",Q),children:"A"}),c.jsx("button",{type:"button","data-color-button":"true",onClick:()=>ee("hiliteColor",Q),children:"Bg"}),c.jsx("button",{type:"button",className:"rich-toolbar-heading",onClick:()=>{const te=window.prompt("Chon heading (1-6):","2"),H=Number(te);Number.isInteger(H)&&H>=1&&H<=6&&O("formatBlock",`h${H}`)},children:"H"}),c.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:te=>{const H=te.target.value;te.target.value="",H&&O("fontName",H)},children:[c.jsx("option",{value:"",children:"Font"}),c.jsx("option",{value:"Arial",children:"Arial"}),c.jsx("option",{value:"Georgia",children:"Georgia"}),c.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),c.jsx("option",{value:"Verdana",children:"Verdana"}),c.jsx("option",{value:"Tahoma",children:"Tahoma"}),c.jsx("option",{value:"Roboto",children:"Roboto"}),c.jsx("option",{value:"Inter",children:"Inter"}),c.jsx("option",{value:"Poppins",children:"Poppins"}),c.jsx("option",{value:"Montserrat",children:"Montserrat"}),c.jsx("option",{value:"Open Sans",children:"Open Sans"}),c.jsx("option",{value:"Nunito",children:"Nunito"}),c.jsx("option",{value:"Raleway",children:"Raleway"}),c.jsx("option",{value:"Merriweather",children:"Merriweather"}),c.jsx("option",{value:"Playfair Display",children:"Playfair Display"}),c.jsx("option",{value:"Courier New",children:"Courier New"}),c.jsx("option",{value:"Fira Code",children:"Fira Code"}),c.jsx("option",{value:"Source Sans Pro",children:"Source Sans Pro"})]}),c.jsxs("select",{className:"rich-toolbar-select",value:"",onChange:te=>{const H=te.target.value;te.target.value="",H&&O("fontSize",H)},children:[c.jsx("option",{value:"",children:"Size"}),c.jsx("option",{value:"2",children:"12px"}),c.jsx("option",{value:"3",children:"16px"}),c.jsx("option",{value:"4",children:"18px"}),c.jsx("option",{value:"5",children:"24px"}),c.jsx("option",{value:"6",children:"32px"}),c.jsx("option",{value:"7",children:"48px"})]})]})});return e?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-black/50 px-4 py-8",children:c.jsxs("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl bg-[#0b1220] border border-white/10 shadow-2xl custom-scroll",children:[c.jsx("input",{ref:S,type:"color",className:"rich-color-native",value:_,onChange:Q=>J(Q.target.value),onBlur:()=>b(null)}),c.jsxs("div",{className:"flex items-center justify-between border-b border-white/10 px-5 py-3",children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Ch%nh s-a thA'ng tin sn phcm"}),c.jsx("button",{className:"text-white/70 hover:text-white",onClick:r,disabled:t,type:"button",children:"A-"})]}),c.jsxs("div",{className:"space-y-4 px-5 py-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"MA sn phcm"}),c.jsx("input",{type:"text",value:i.productId,onChange:Q=>s(te=>({...te,productId:Q.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"TAn sn phcm / Package product"}),c.jsx("input",{type:"text",value:i.productName,onChange:Q=>s(te=>({...te,productName:Q.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Quy t_c"}),ie("rules"),c.jsx("div",{ref:h,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>d("rules"),onInput:Q=>L("rules",Q.currentTarget),onBlur:Q=>L("rules",Q.currentTarget)},(e?.id??"rules")+"-editor")]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"MA' t"}),ie("description"),c.jsx("div",{ref:f,className:"rich-editor",contentEditable:!0,suppressContentEditableWarning:!0,onFocus:()=>d("description"),onInput:Q=>L("description",Q.currentTarget),onBlur:Q=>L("description",Q.currentTarget)},(e?.id??"description")+"-editor")]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs uppercase tracking-wide text-white/70 mb-1",children:"Image URL"}),c.jsx("input",{type:"text",value:i.imageUrl,onChange:Q=>s(te=>({...te,imageUrl:Q.target.value})),className:"w-full rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50",placeholder:"https://..."})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3 border-t border-white/10 px-5 py-3",children:[c.jsx("button",{className:"px-4 py-2 text-sm font-semibold text-white/80 hover:text-white",onClick:r,disabled:t,type:"button",children:"Hy"}),c.jsx("button",{className:"px-4 py-2 rounded-lg bg-blue-600 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",onClick:()=>n(i),disabled:t,type:"button",children:t?"?ang lu...":"Lu thay `\x07i"})]})]})}),c.jsx(ZQ,{open:!!e&&T,url:k,error:j,onChange:Q=>{A(Q),P(null)},onClose:re,onConfirm:oe})]}):null},eZ=()=>{const[e,t]=v.useState(null),[r,n]=v.useState(1),[a,i]=v.useState([]),[s,l]=v.useState([]),[d,h]=v.useState(""),[f,p]=v.useState(!1),[x,g]=v.useState(null),b=v.useMemo(()=>XQ(a,s,d),[a,s,d]),_=v.useMemo(()=>Math.max(1,Math.ceil(b.length/S0)),[b.length]),w=v.useMemo(()=>{const E=(r-1)*S0,k=E+S0;return b.slice(E,k)},[b,r]),S=v.useCallback(async()=>{p(!0),g(null);try{const[E,k]=await Promise.all([WQ({}),Ct("/api/products")]),A=await k.json().catch(()=>[]);i(Array.isArray(E.items)?E.items:[]),l(Array.isArray(A)?A:[])}catch(E){i([]),l([]),g(Jo(E instanceof Error?E.message:String(E??""),{fallback:"KhA'ng th ti danh sAch sn phcm."}))}finally{p(!1)}},[]);return v.useEffect(()=>{S()},[S]),v.useEffect(()=>{r>_&&n(_)},[r,_]),{data:{mergedProducts:b,pagedProducts:w,loading:f,error:x,currentPage:r,totalPages:_,expandedId:e,searchTerm:d},actions:{handleSearchChange:E=>{h(E),n(1)},setCurrentPage:n,setExpandedId:t,reload:S,setProductDescs:i,setError:g}}},tZ=()=>{const{data:{mergedProducts:e,pagedProducts:t,loading:r,error:n,currentPage:a,expandedId:i,searchTerm:s},actions:{handleSearchChange:l,setCurrentPage:d,setExpandedId:h,reload:f,setProductDescs:p,setError:x}}=eZ(),[g,b]=v.useState(null),[_,w]=v.useState(!1),S=k=>{b(k)},T=()=>{b(null),w(!1)},E=v.useCallback(async k=>{if(!g)return;w(!0);const A={productId:k.productId.trim()||g.productId||"",rules:k.rulesHtml||k.rules,description:k.descriptionHtml||k.description,imageUrl:k.imageUrl||null};try{const j=await zQ(A),P=j.rulesHtml||j.rules||k.rulesHtml||k.rules||"",D=j.descriptionHtml||j.description||k.descriptionHtml||k.description||"",L={...g,id:j.id||g.id,productId:j.productId,productName:un(k.productName||g.productName||"")||g.productName,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:D,imageUrl:j.imageUrl||k.imageUrl||null};p(I=>{const O=un(j.productId||g.productId||"").toLowerCase(),M=I.findIndex(oe=>un(oe.productId||"").toLowerCase()===O);if(M===-1)return[...I,{id:j.id||g.id,productId:j.productId,productName:L.productName||null,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:D,imageUrl:j.imageUrl||null}];const re=[...I];return re[M]={...re[M],id:j.id||re[M].id,productId:j.productId,productName:L.productName||re[M].productName||null,rules:j.rules||"",rulesHtml:P,description:j.description||"",descriptionHtml:D,imageUrl:j.imageUrl||null},re}),b(null)}catch(j){x(Jo(j instanceof Error?j.message:String(j??""),{fallback:"Khng th lu thng tin sn phm."}))}finally{w(!1)}},[g,p,x]);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Thng Tin Sn Phm"}),c.jsx("p",{className:"text-sm text-white/70",children:"ng b vi bng product_desc trong database."})]}),c.jsx(HQ,{searchTerm:s,onSearchChange:l,onAddClick:f}),n&&c.jsx("div",{className:"rounded-xl border border-rose-400/30 bg-rose-500/10 px-4 py-3 text-sm text-rose-200",children:n}),c.jsx(QQ,{products:t,mergedTotal:e.length,loading:r,currentPage:a,pageSize:S0,onPageChange:d,expandedId:i,onToggleExpand:h,onEdit:S}),g&&c.jsx(JQ,{product:g,saving:_,onClose:T,onSave:E})]})},rZ=({searchTerm:e,statusFilter:t,isLoading:r,isRefreshing:n,error:a,onSearchChange:i,onStatusChange:s,onRefresh:l})=>c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/70 via-slate-900/60 to-indigo-950/70 p-6 text-white shadow-lg backdrop-blur",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[c.jsxs("div",{className:"relative md:col-span-2",children:[c.jsx(il,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-white/60"}),c.jsx("input",{type:"text",placeholder:"Tm Kim Sn Phm...",className:"w-full rounded-lg border border-white/20 bg-white/10 px-10 py-2 text-white placeholder:text-white/60 focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:e,onChange:d=>i(d.target.value)})]}),c.jsxs("select",{className:"w-full rounded-lg border border-white/20 bg-white/10 px-4 py-2 text-white focus:border-blue-400/60 focus:ring-2 focus:ring-blue-500/60",value:t,onChange:d=>s(d.target.value),children:[c.jsx("option",{value:"all",children:"Trng Thi"}),c.jsx("option",{value:"active",children:"ang Hot ng"}),c.jsx("option",{value:"inactive",children:"Tm Dng"})]}),c.jsx(Ci,{className:"w-full justify-center",type:"button",onClick:l,disabled:r||n,children:r||n?"ang ng B...":"ng B Li"})]}),a&&c.jsx("div",{className:"mt-4 rounded-lg border border-red-400/40 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:a})]}),nZ=({stats:e,onAddProduct:t})=>c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col justify-between gap-3 sm:flex-row sm:items-center",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bng Gi Sn Phm"}),c.jsx(Ci,{icon:Ai,onClick:t,children:"Thm Sn Phm"})]}),c.jsx("div",{className:"rounded-[28px] border border-white/10 bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:c.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(r=>c.jsx(Qi,{title:r.name,value:r.value,icon:r.icon,subtitle:r.subtitle,accent:Rr[r.accent]},r.name))})})]}),z1=new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}),W1=0,fv=()=>{const e=typeof globalThis<"u"?globalThis.crypto:null;return{id:e&&typeof e.randomUUID=="function"?e.randomUUID():Math.random().toString(36).slice(2),sourceId:null,sourceName:"",price:"",numberBank:"",bankBin:"",useCustomName:!1}},w3=e=>{if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.round(Math.abs(e)/1e3)*1e3;return e<0?-t:t},zC=e=>e==null?"":String(e).replace(/[_]+/g," ").replace(/\s+/g," ").trim(),aZ=e=>e?e.replace(/[_]+/g," ").replace(/--/g," ").replace(/\s+/g," ").trim():"-",iZ=e=>{if(!e)return null;const t=e.match(/(\d+)\s*m\b/i);if(!t)return null;const r=Number.parseInt(t[1],10);return!Number.isFinite(r)||r<=0?null:`${r} Thng`},sZ=(e,t)=>{const r=iZ(t);return e&&r?`${e} ${r}`:e||r||aZ(t)||"Khng Xc nh"},$s=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?t:null},oZ=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;const t=String(e).trim().toLowerCase();return t?["true","1","t","y","yes"].includes(t):!1},lZ=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t))return null;const r=t>1?t/100:t;return r<0||r>=1?null:1-r},xh=(e,t,r)=>typeof e!="number"||!Number.isFinite(e)||e<W1||typeof t!="number"||typeof r!="number"||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?!1:lZ(t,e)!==null,cZ=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim():"",uZ=e=>{const t=new Map;for(const r of e){const n=Number.isFinite(r.sourceId)&&r.sourceId>0?`id:${r.sourceId}`:`name:${cZ(r.sourceName)}`,a=t.get(n);if(!a){t.set(n,r);continue}const i=a.price??Number.POSITIVE_INFINITY,s=r.price??Number.POSITIVE_INFINITY,l=Date.parse(a.lastOrderDate??"")||0,d=Date.parse(r.lastOrderDate??"")||0;(s<i||s===i&&d>l)&&t.set(n,r)}return Array.from(t.values())},i0=e=>[...e].sort((t,r)=>{const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(n!==a)return n-a;const i=Date.parse(t.lastOrderDate??"")||0,s=Date.parse(r.lastOrderDate??"")||0;return i!==s?s-i:t.sourceName.localeCompare(r.sourceName)}),Wl=(e,t)=>`${e}-${t}`,ed=(e,t)=>typeof e!="number"||!Number.isFinite(e)||e<=0||typeof t!="number"||!Number.isFinite(t)||t<=0?null:e*t,b3=(e,t)=>ed(t,e),_3=(e,t,r,n,a)=>{const i=typeof n=="number"&&Number.isFinite(n)&&n>0&&n||typeof a=="number"&&Number.isFinite(a)&&a>0&&a||null;if(i===null||t===null||t===void 0||typeof t!="number"||!Number.isFinite(t)||!xh(t,e,r))return null;const s=t>1?t/100:t,l=e&&e>1?e:e||1,d=i*l,h=d-d*s;return Math.min(d,Math.max(i,h))},ju=(e,t)=>{if(typeof t!="number"||!Number.isFinite(t)||t<=0)return e;const r=b3(e.pctCtv,t),n=typeof r=="number"&&Number.isFinite(r)&&r>0?r:e.wholesalePrice,a=ed(n??t,e.pctKhach),i=_3(e.pctKhach,e.pctPromo,e.pctCtv,n??t,t);return{...e,baseSupplyPrice:t,wholesalePrice:typeof n=="number"&&Number.isFinite(n)&&n>0?n:e.wholesalePrice,retailPrice:typeof a=="number"&&Number.isFinite(a)&&a>0?a:e.retailPrice,promoPrice:typeof i=="number"&&Number.isFinite(i)&&i>0?i:e.promoPrice}},H1=e=>{const t=(e||"").replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?r.toLocaleString("vi-VN"):""},S3=e=>{if(e==null)return"";const t=String(e).replace(/\D+/g,"");if(!t)return"";const r=Number(t);return Number.isFinite(r)?new Intl.NumberFormat("vi-VN").format(r):""},Wa=e=>{if(e==null)return null;const t=e.toString().replace(",",".").trim();return t?$s(t):null},WC=({multiplier:e,price:t,basePrice:r})=>"",aa=e=>{const t=w3(e);return t===null||t<=0?"-":z1.format(t)},hv=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return null;const t=e*100;return`${Math.abs(t-Math.round(t))<.01?Math.round(t).toString():t.toFixed(2).replace(/\.?0+$/,"")}%`},HC=e=>{if(!e)return"-";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString("vi-VN")},Ru=e=>(e||"").trim(),KC=e=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const t=w3(e)??0;return t===0?z1.format(0):z1.format(t)},dZ=(e,t,r)=>{if(typeof e!="number"||!Number.isFinite(e))return"-";const n=typeof t=="number"&&Number.isFinite(t)?t-e:null,a=typeof r=="number"&&Number.isFinite(r)?r-e:null,i=KC(n),s=KC(a);return`${i} - ${s}`},gh=e=>{if(!e)return Number.NEGATIVE_INFINITY;const t=Date.parse(e);return Number.isFinite(t)?t:Number.NEGATIVE_INFINITY},fZ=e=>e.length?e.reduce((t,r)=>{if(!t)return r;const n=t.price??Number.POSITIVE_INFINITY,a=r.price??Number.POSITIVE_INFINITY;if(a<n)return r;if(a>n)return t;const i=gh(t.lastOrderDate);return gh(r.lastOrderDate)>i?r:t},null):null,Us=(e,t)=>{const r=e.reduce((n,a)=>{const i=typeof a.price=="number"&&Number.isFinite(a.price)?a.price:Number.NEGATIVE_INFINITY;return i>n?i:n},Number.NEGATIVE_INFINITY);return Number.isFinite(r)&&r>0?r:typeof t=="number"&&Number.isFinite(t)&&t>0?t:null},N3=(e,t)=>{const r=zC(e?.[Cr.package]??e?.package_label),n=zC(e?.[Cr.packageProduct]??e?.package_product_label),a=(e?.[Cr.product]??e?.id_product_label??e?.id_product??"").toString().trim();return{id:Number.isFinite(Number(e?.id))?Number(e?.id):t,packageName:r||"Khng xc nh",packageProduct:n,sanPhamRaw:a,variantLabel:sZ(n,a),pctCtv:$s(e?.[Cr.pctCtv]),pctKhach:$s(e?.[Cr.pctKhach]),pctPromo:$s(e?.[Cr.pctPromo]),isActive:oZ(e?.[Cr.isActive]),baseSupplyPrice:$s(e?.max_supply_price),wholesalePrice:$s(e?.computed_wholesale_price??e?.wholesale_price??e?.gia_si??e?.gia_ctv),retailPrice:$s(e?.computed_retail_price??e?.retail_price??e?.gia_le),promoPrice:$s(e?.computed_promo_price??e?.promo_price??e?.gia_khuyen_mai??e?.gia_km),lastUpdated:typeof e?.[Cr.update]=="string"?e[Cr.update]:typeof e?.updated_at=="string"?e.updated_at:typeof e?.updatedAt=="string"?e.updatedAt:typeof e?.update=="string"?e.update:null}},hZ=({item:e,productKey:t,isExpanded:r,statusOverride:n,updatedTimestamp:a,supplyState:i,pendingNewSupply:s,supplierOptions:l,isLoadingSuppliers:d,editingProductId:h,productEditForm:f,productEditError:p,isSavingProductEdit:x,isDeletingProduct:g,editingSupplyRows:b,supplyPriceDrafts:_,savingSupplyRows:w,supplyRowErrors:S,onToggleProductDetails:T,onStartProductEdit:E,onProductEditChange:k,onCancelProductEdit:A,onSubmitProductEdit:j,onRequestDeleteProduct:P,onStartEditingSupply:D,onSupplyInputChange:L,onCancelSupplyEditing:I,onConfirmSupplyEditing:O,onStartAddSupplierRow:M,onNewSupplierInputChange:re,onCancelAddSupplierRow:oe,onConfirmAddSupplierRow:ee,onDeleteSupplyRow:fe,onToggleStatus:J,fetchSupplyPricesForProduct:ie})=>{const Q=i?.items??[],te=s??null,H=fZ(Q),se=H?.price??e.baseSupplyPrice,Y=H?.sourceName??"-",ce=Us(Q,e.baseSupplyPrice),ue=[...Q.map(Ce=>({kind:"existing",supplier:Ce})),...te?[{kind:"new"}]:[]],me=n??e.isActive??!1,Re=a??e.lastUpdated??"",U=Re?HC(Re):"-",B=xh(e.pctPromo,e.pctKhach,e.pctCtv),K=h===e.id,z=K?f:null,ne=z?{pctCtv:Wa(z.pctCtv),pctKhach:Wa(z.pctKhach),pctPromo:Wa(z.pctPromo)}:null,Oe=ne?b3(ne.pctCtv,ce):null,Pe=typeof Oe=="number"&&Number.isFinite(Oe)&&Oe>0?Oe:ce,we=ne?ed(Pe,ne.pctKhach):null,xe=ne?_3(ne.pctKhach,ne.pctPromo,ne.pctCtv,Oe,ce):null,Ee=hv(ne?.pctPromo??null),le=xh(ne?.pctPromo??null,ne?.pctKhach??null,ne?.pctCtv??null)&&Number.isFinite(xe??NaN),De=typeof ce=="number"&&Number.isFinite(ce)&&ce>0?aa(ce):"Cha c d liu",Ue=()=>{ie(e.sanPhamRaw)};return c.jsxs(ki.Fragment,{children:[c.jsxs("tr",{className:"cursor-pointer bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 transition hover:from-indigo-900/70 hover:via-indigo-800/50 hover:to-indigo-900/70",onClick:()=>T(e),children:[c.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(i4,{className:`mt-1 h-4 w-4 text-white/60 transition-transform ${r?"rotate-180":""}`}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-semibold text-white",children:e.packageName}),c.jsx("div",{className:"text-xs text-white/70",children:e.variantLabel})]})]})}),c.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[c.jsx("div",{className:"text-sm font-semibold text-white",children:aa(e.wholesalePrice)}),c.jsx("div",{className:"text-xs text-white/70",children:WC({multiplier:e.pctCtv,price:e.wholesalePrice,basePrice:e.baseSupplyPrice})})]}),c.jsxs("td",{className:"whitespace-nowrap px-6 py-4",children:[c.jsx("div",{className:"text-sm font-semibold text-amber-300",children:aa(e.retailPrice)}),c.jsx("div",{className:"text-xs text-white/70",children:WC({multiplier:e.pctKhach,price:e.retailPrice,basePrice:e.baseSupplyPrice})})]}),c.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:B?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"text-sm font-semibold text-pink-200",children:aa(e.promoPrice)}),c.jsx("div",{className:"text-xs text-white/70",children:hv(e.pctPromo)??"-"})]}):c.jsx("div",{className:"text-sm text-white/60",children:"-"})}),c.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:c.jsx("div",{className:"flex flex-col items-center",children:c.jsx("button",{type:"button",onClick:Ce=>{Ce.stopPropagation(),J(e)},className:`relative flex h-9 w-9 items-center justify-center rounded-full border-2 shadow-inner transition ${me?"border-emerald-200 bg-emerald-500 text-white":"border-white/20 bg-white/10 text-white/60"}`,"aria-pressed":me,children:c.jsx(o4,{className:"h-4 w-4"})})})}),c.jsx("td",{className:"whitespace-nowrap px-6 py-4",children:c.jsx("div",{className:"text-sm text-white",children:U})}),c.jsx("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-3",children:[c.jsx("button",{className:"text-blue-300 hover:text-blue-200",onClick:Ce=>E(Ce,e),children:c.jsx(ac,{className:"h-4 w-4"})}),c.jsx("button",{className:`text-rose-400 hover:text-rose-300 ${g?"cursor-not-allowed opacity-60":""}`,onClick:Ce=>P(Ce,e),disabled:g,children:c.jsx(qs,{className:"h-4 w-4"})})]})})]}),K&&z&&c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-6 pb-6",children:c.jsxs("div",{className:"space-y-6 rounded-2xl border border-white/10 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[c.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-200",children:"Thng Tin Sn Phm"}),c.jsxs("div",{className:"mt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Tn sn phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:z.packageName,onChange:Ce=>k("packageName",Ce.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Gi sn phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:z.packageProduct,onChange:Ce=>k("packageProduct",Ce.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"M sn phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:z.sanPham,onChange:Ce=>k("sanPham",Ce.target.value)})]})]})]}),c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-200",children:"T gi"}),c.jsxs("div",{className:"mt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi CTV"}),c.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:z.pctCtv,onChange:Ce=>k("pctCtv",Ce.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi khch"}),c.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:z.pctKhach,onChange:Ce=>k("pctKhach",Ce.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"T gi khuyn mi"}),c.jsx("input",{type:"number",step:"0.01",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:z.pctPromo,onChange:Ce=>k("pctPromo",Ce.target.value)})]})]})]})]}),z&&c.jsxs("div",{className:"rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/70 via-slate-900/70 to-indigo-950/80 p-4 shadow-lg backdrop-blur",children:[c.jsxs("div",{className:"flex flex-col gap-1 text-xs font-semibold uppercase tracking-wide text-white/80 sm:flex-row sm:items-center sm:justify-between",children:[c.jsx("span",{children:"Gi d kin theo t gi"}),c.jsxs("span",{className:"font-medium normal-case text-amber-200",children:["Gi ngun cao nht:"," ",c.jsx("span",{className:"font-semibold",children:De})]})]}),c.jsxs("div",{className:`mt-4 grid gap-3 text-center text-sm ${le?"md:grid-cols-3":"md:grid-cols-2"}`,children:[c.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi S d kin"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(Oe)}),c.jsx("p",{className:"text-[11px] text-white/70",children:z.pctCtv?`T Gi: ${z.pctCtv}`:"Nhp t gi CTV"})]}),c.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khch d kin"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(we)}),c.jsx("p",{className:"text-[11px] text-white/70",children:z.pctKhach?`T Gi: ${z.pctKhach}`:"Nhp t gi khch"})]}),le&&c.jsxs("div",{className:"rounded-xl border border-white/15 bg-white/5 px-4 py-3 shadow-lg backdrop-blur-sm",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi Khuyn mi d kin"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(xe)}),c.jsx("p",{className:"text-[11px] text-white/70",children:Ee??"Nhp t gi khuyn mi"})]})]})]}),p&&c.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:p}),c.jsxs("div",{className:"flex flex-wrap justify-end gap-3",children:[c.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:A,disabled:x,children:"Hy b"}),c.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-indigo-200/50 hover:opacity-90 disabled:opacity-60",onClick:j,disabled:x,children:x?"ang Lu...":"Lu thay i"})]})]})})}),r&&c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-6 pb-6",children:c.jsx("div",{className:"rounded-2xl border border-dashed border-white/20 bg-white/5 p-4 text-white",children:c.jsxs("div",{className:"space-y-4 rounded-2xl border border-white/15 bg-gradient-to-br from-indigo-950/80 via-slate-900/70 to-indigo-950/80 px-6 py-5 text-white shadow-lg",children:[c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-sm font-semibold text-white",children:"Chi tit gi sn phm"})}),c.jsxs("div",{className:`grid gap-4 text-center ${B?"md:grid-cols-4":"md:grid-cols-3"}`,children:[c.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi ngun thp nht"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(se)}),c.jsx("p",{className:"text-xs text-white/70",children:Y})]}),c.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi s hin ti"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(e.wholesalePrice)})]}),c.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi khch hin ti"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(e.retailPrice)})]}),B&&c.jsxs("div",{className:"flex flex-col items-center rounded-xl border border-white/15 bg-white/5 px-4 py-3",children:[c.jsx("p",{className:"text-xs uppercase text-white/70",children:"Gi khuyn mi hin ti"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-white",children:aa(e.promoPrice)}),c.jsx("p",{className:"text-xs text-white/70",children:hv(e.pctPromo)??"-"})]})]}),c.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/15",children:[c.jsx("div",{className:"flex justify-end border-b border-white/10 bg-white/5 px-4 py-2",children:c.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white shadow-sm ring-1 ring-white/20 hover:bg-white/15 disabled:opacity-50",onClick:()=>M(e.id),disabled:!!te,children:[c.jsx(cy,{className:"h-4 w-4"}),"Thm ngun"]})}),c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-white/5 text-[11px] uppercase tracking-wide text-white/70",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left",children:"NCC"}),c.jsx("th",{className:"px-4 py-2 text-center",children:"Gi nhp"}),c.jsx("th",{className:"px-4 py-2 text-center",children:"Li nhun"}),c.jsx("th",{className:"px-4 py-2 text-center",children:"Thao tc"})]})}),c.jsx("tbody",{children:i?.loading?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"ang Ti D Liu"})}):i?.error?c.jsx("tr",{children:c.jsxs("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white",children:[c.jsx("span",{children:i.error})," ",c.jsx("button",{type:"button",className:"text-xs text-red-400 hover:text-red-200 hover:underline",onClick:Ue,children:"Th Li"})]})}):Q.length===0&&ue.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"px-4 py-3 text-center text-xs text-white/70",children:"Cha c d liu t NCC"})}):ue.map(Ce=>{if(Ce.kind==="existing"&&Ce.supplier){const Ae=Ce.supplier,ve=Wl(e.id,Ae.sourceId),Le=b[ve]??!1,pe=w[ve]??!1,tt=_[ve]??(Ae.price??"").toString();S[ve];const Ye=!Le||pe,Be=aa(Ae.price);return c.jsxs("tr",{className:"border-t border-dashed border-white/10",children:[c.jsxs("td",{className:"px-4 py-3",children:[c.jsx("div",{className:"text-sm font-semibold text-white",children:Ae.sourceName}),c.jsx("div",{className:"text-xs text-white/60",children:Ae.lastOrderDate?HC(Ae.lastOrderDate):"-"})]}),c.jsx("td",{className:"px-4 py-3",children:Le?c.jsxs("div",{className:"flex flex-col items-center gap-1",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"text",className:"w-28 rounded-lg border border-white/25 bg-white/5 px-2 py-1 text-center text-sm text-white placeholder:text-white/50 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/30 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:tt,onChange:ot=>L(e.id,Ae.sourceId,ot.target.value),disabled:Ye}),c.jsx("span",{className:"text-xs text-white/70",children:""})]}),c.jsx("span",{className:"text-[11px] text-white/60",children:"Nhp gi mi"})]}):c.jsx("div",{className:"flex justify-center",children:c.jsx("span",{className:"inline-flex min-w-[112px] justify-center rounded-lg bg-white/10 px-3 py-2 text-sm font-semibold text-white",children:Be})})}),c.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:dZ(Ae.price,e.wholesalePrice,e.retailPrice)}),c.jsx("td",{className:"px-4 py-3",children:Le?c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:pe,onClick:()=>O(e.id,Ae.sourceId,t,e.sanPhamRaw),children:c.jsx(Wo,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:pe,onClick:()=>I(e.id,Ae.sourceId),children:c.jsx(Hr,{className:"h-4 w-4"})})]}):c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-white/25 text-white/80 hover:border-white/40 hover:text-white disabled:opacity-60",disabled:pe,onClick:()=>D(e.id,Ae.sourceId,Ae.price),children:c.jsx(ac,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full border border-red-200/60 text-red-200 hover:border-red-200 hover:bg-red-500/10 disabled:opacity-60",disabled:pe,onClick:()=>fe(e.id,Ae.sourceId,t,e.sanPhamRaw),children:c.jsx(l4,{className:"h-4 w-4"})})]})})]},ve)}if(Ce.kind==="new"&&te){const Ae=te,ve=Ae.useCustomName?"__custom__":Ae.sourceId!==null?`id:${Ae.sourceId}`:Ae.sourceName?`name:${Ae.sourceName}`:"",Le=l.length>0,pe=tt=>{const Ye=tt.target.value;if(Ye==="__custom__"){re(e.id,"useCustomName",!0),re(e.id,"sourceName",""),re(e.id,"sourceId",null);return}if(re(e.id,"useCustomName",!1),!Ye){re(e.id,"sourceId",null),re(e.id,"sourceName","");return}const Be=l.find(ot=>(ot.id!==null?`id:${ot.id}`:`name:${ot.name}`)===Ye);re(e.id,"sourceId",Be?.id??null),re(e.id,"sourceName",Be?.name??Ye.replace(/^name:/,"").trim())};return c.jsxs(ki.Fragment,{children:[c.jsxs("tr",{className:"border-t border-dashed border-white/15 bg-slate-900/50",children:[c.jsx("td",{className:"px-4 py-3",children:c.jsx("div",{className:"flex flex-col gap-2",children:Le&&!Ae.useCustomName?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{className:"w-60 max-w-xs rounded-lg border border-white/20 bg-slate-900/80 px-3 py-2 text-sm text-white shadow-sm focus:border-indigo-300 focus:outline-none focus:ring-2 focus:ring-indigo-300/30 disabled:opacity-60",value:ve,onChange:pe,disabled:Ae.isSaving,children:[c.jsx("option",{value:"",children:d?"ang ti Nh Cung Cp...":"Chn Nh Cung Cp..."}),l.map(tt=>{const Ye=tt.id!==null?`id:${tt.id}`:`name:${tt.name}`;return c.jsx("option",{value:Ye,children:tt.name},Ye)}),c.jsx("option",{value:"__custom__",children:"Nhp tn Nh Cung Cp khc"})]}),c.jsx("button",{type:"button",className:"rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>re(e.id,"useCustomName",!0),disabled:Ae.isSaving,children:"Nhp"})]}):c.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Le&&c.jsxs("button",{type:"button",className:"flex items-center gap-1 rounded-md border border-white/20 px-2 py-1 text-xs text-white/80 hover:border-indigo-300 hover:text-white",onClick:()=>re(e.id,"useCustomName",!1),disabled:Ae.isSaving,children:[c.jsx("span",{className:"text-sm",children:""}),c.jsx("span",{className:"sr-only",children:"Chn t danh sch"})]}),c.jsx("input",{type:"text",className:"w-60 max-w-xs rounded-lg border border-indigo-300/60 bg-white/95 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200",placeholder:"Tn NCC",value:Ae.sourceName,onChange:tt=>re(e.id,"sourceName",tt.target.value),disabled:Ae.isSaving})]})})}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-center gap-1",children:[c.jsx("input",{type:"text",className:"w-28 rounded-lg border border-sky-200 bg-white px-2 py-1 text-center text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-200 appearance-none [appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",placeholder:"Gi nhp",value:Ae.price,onChange:tt=>re(e.id,"price",tt.target.value),disabled:Ae.isSaving}),c.jsx("span",{className:"text-xs text-white/70",children:""})]})}),c.jsx("td",{className:"px-4 py-3 text-center text-xs text-white/70",children:"-"}),c.jsx("td",{className:"px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-green-600/20 text-green-200 hover:bg-green-500/30 disabled:opacity-60",disabled:Ae.isSaving,onClick:()=>ee(e),children:c.jsx(Wo,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-red-600/20 text-red-200 hover:bg-red-500/30 disabled:opacity-60",disabled:Ae.isSaving,onClick:()=>oe(e.id),children:c.jsx(Hr,{className:"h-4 w-4"})})]})})]}),Ae.error&&c.jsx("tr",{children:c.jsx("td",{colSpan:4,className:"px-4 pb-3 text-center text-xs text-red-200",children:Ae.error})})]},`new-${e.id}`)}return null})})]})]})]})})})})]})},pZ=ki.memo(hZ),mZ=({items:e,totalRows:t,currentPage:r,rowsPerPage:n,onPageChange:a,onRowsPerPageChange:i,isLoading:s,error:l,expandedProductId:d,supplyPriceMap:h,statusOverrides:f,updatedTimestampMap:p,supplierOptions:x,isLoadingSuppliers:g,editingSupplyRows:b,supplyPriceDrafts:_,savingSupplyRows:w,supplyRowErrors:S,newSupplyRows:T,editingProductId:E,productEditForm:k,productEditError:A,isSavingProductEdit:j,deleteProductState:P,onToggleProductDetails:D,onStartProductEdit:L,onProductEditChange:I,onCancelProductEdit:O,onSubmitProductEdit:M,onRequestDeleteProduct:re,onStartEditingSupply:oe,onSupplyInputChange:ee,onCancelSupplyEditing:fe,onConfirmSupplyEditing:J,onStartAddSupplierRow:ie,onNewSupplierInputChange:Q,onCancelAddSupplierRow:te,onConfirmAddSupplierRow:H,onDeleteSupplyRow:se,onToggleStatus:Y,fetchSupplyPricesForProduct:ce})=>{const ue=Math.max(1,Math.ceil(t/n)),me=Math.min(Math.max(r,1),ue),Re=[10,20,50],U=ki.useMemo(()=>{const Oe=(Ee,le)=>{Ee>=1&&Ee<=ue&&le.add(Ee)},Pe=new Set([1,ue]);Oe(me-1,Pe),Oe(me,Pe),Oe(me+1,Pe),me<=2&&(Oe(2,Pe),Oe(3,Pe),Oe(4,Pe)),me>=ue-1&&(Oe(ue-1,Pe),Oe(ue-2,Pe),Oe(ue-3,Pe));const we=Array.from(Pe).sort((Ee,le)=>Ee-le),xe=[];return we.forEach((Ee,le)=>{le>0&&Ee-we[le-1]>1&&xe.push("ellipsis"),xe.push(Ee)}),xe},[me,ue]),B=Oe=>{const Pe=Math.min(Math.max(Oe,1),ue);a(Pe)},K="w-10 h-10 flex items-center justify-center rounded-xl border border-white/10 bg-white/5 text-white/80 transition hover:bg-white/10 disabled:opacity-40 disabled:cursor-not-allowed",z="w-10 h-10 flex items-center justify-center rounded-xl font-semibold border border-white/10 bg-white/5 text-white/80 transition hover:bg-white/10",ne="rounded-full bg-gradient-to-br from-[#323b74] via-[#22294f] to-[#151c39] text-white border border-[#6b74ff]/50 shadow-[0_12px_30px_-14px_rgba(107,116,255,0.8)]";return c.jsxs("div",{className:"overflow-hidden rounded-2xl border border-white/10 bg-white/10 text-white shadow-lg backdrop-blur",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[c.jsx("thead",{className:"bg-white/5",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Sn Phm"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi S"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi L"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Gi Khyn Mi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Tnh Trng"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Cp Nht"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase text-white/80",children:"Thao Tc"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10 bg-white/5",children:s?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:"ang Ti D Liu..."})}):e.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-sm text-white/80",children:l?"Khng th ti d liu. Vui lng th li.":"Khng c sn phm."})}):e.map(Oe=>{const Pe=d===Oe.id,we=Ru(Oe.sanPhamRaw),xe=h[we],Ee=T[Oe.id]||null,le=P.product?.id===Oe.id&&P.loading;return c.jsx(pZ,{item:Oe,productKey:we,isExpanded:Pe,statusOverride:f[Oe.id],updatedTimestamp:p[Oe.id],supplyState:xe,pendingNewSupply:Ee,supplierOptions:x,isLoadingSuppliers:g,editingProductId:E,productEditForm:k,productEditError:A,isSavingProductEdit:j,isDeletingProduct:le,editingSupplyRows:b,supplyPriceDrafts:_,savingSupplyRows:w,supplyRowErrors:S,onToggleProductDetails:D,onStartProductEdit:L,onProductEditChange:I,onCancelProductEdit:O,onSubmitProductEdit:M,onRequestDeleteProduct:re,onStartEditingSupply:oe,onSupplyInputChange:ee,onCancelSupplyEditing:fe,onConfirmSupplyEditing:J,onStartAddSupplierRow:ie,onNewSupplierInputChange:Q,onCancelAddSupplierRow:te,onConfirmAddSupplierRow:H,onDeleteSupplyRow:se,onToggleStatus:Y,fetchSupplyPricesForProduct:ce},Oe.id)})})]})}),c.jsxs("div",{className:"flex flex-col gap-3 border-t border-white/10 bg-slate-950/70 px-4 py-3 text-sm text-white/80 md:flex-row md:items-center md:justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{children:"Hin th"}),c.jsx("select",{className:"rounded-lg border border-white/20 bg-slate-900 px-3 py-1 text-white shadow-sm focus:border-indigo-400 focus:outline-none",value:n,onChange:Oe=>i(Number(Oe.target.value)),children:Re.map(Oe=>c.jsx("option",{value:Oe,children:Oe},Oe))}),c.jsx("span",{children:"dng"})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-1.5",children:[c.jsx("button",{className:K,onClick:()=>B(1),disabled:me===1,"aria-label":"Trang u",children:"<<"}),c.jsx("button",{className:K,onClick:()=>B(me-1),disabled:me===1,"aria-label":"Trang trc",children:"<"}),U.map((Oe,Pe)=>Oe==="ellipsis"?c.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white/50",children:"..."},`ellipsis-${Pe}`):c.jsx("button",{className:`${z} ${me===Oe?ne:""}`,onClick:()=>B(Oe),children:Oe},Oe)),c.jsx("button",{className:K,onClick:()=>B(me+1),disabled:me===ue,"aria-label":"Trang sau",children:">"}),c.jsx("button",{className:K,onClick:()=>B(ue),disabled:me===ue,"aria-label":"Trang cui",children:">>"})]})]})]})},xZ=({isOpen:e,createForm:t,createSuppliers:r,supplierOptions:n,bankOptions:a,isLoadingSuppliers:i,isLoadingBanks:s,isSubmitting:l,createError:d,onClose:h,onFormChange:f,onSupplierChange:p,onSupplierSelectChange:x,onSupplierPriceInput:g,onEnableCustomSupplier:b,onAddSupplier:_,onRemoveSupplier:w,onSubmit:S})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-black/40 px-2 py-4 sm:px-4 sm:py-6",children:c.jsxs("div",{className:"relative flex w-full max-w-5xl flex-col rounded-2xl bg-white shadow-2xl max-h-[95vh]",children:[c.jsx("button",{className:"absolute right-4 top-4 text-white/60 hover:text-white/70",onClick:h,children:c.jsx(Hr,{className:"h-6 w-6"})}),c.jsxs("div",{className:"flex-1 space-y-6 overflow-y-auto px-4 py-6 sm:px-6 sm:py-8",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-sky-100",children:"Thm Sn Phm mi"}),c.jsx("p",{className:"text-base text-sky-200/90",children:"Nhp Thng tin Sn Phm, Nh Cung Cp, T Gi"})]}),c.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[c.jsxs("div",{className:"rounded-2xl border border-sky-100 bg-gradient-to-br from-white via-sky-50 to-sky-100/40 p-5 shadow-sm",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-600",children:"Thng Tin Sn Phm"}),c.jsxs("div",{className:"mt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Sn Phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageName,onChange:T=>f("packageName",T.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Sn Phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.packageProduct,onChange:T=>f("packageProduct",T.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"M Sn Phm"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-sky-300/50 focus:ring-2 focus:ring-sky-200/40",value:t.sanPham,onChange:T=>f("sanPham",T.target.value)})]})]})]}),c.jsxs("div",{className:"rounded-2xl border border-purple-100 bg-gradient-to-br from-white via-purple-50 to-purple-100/40 p-5 shadow-sm",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-purple-600",children:"T Gi"}),c.jsxs("div",{className:"mt-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi CTV"}),c.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctCtv,onChange:T=>f("pctCtv",T.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khch"}),c.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctKhach,onChange:T=>f("pctKhach",T.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"T Gi Khuyn Mi"}),c.jsx("input",{type:"number",step:"0.01",min:"0",className:"mt-1 w-full rounded-xl border border-white/20 bg-white/10 px-3 py-2 text-sm text-white placeholder:text-white/60 shadow-inner focus:border-purple-300/50 focus:ring-2 focus:ring-purple-200/40 appearance-none [appearance:textfield] [-moz-appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none",value:t.pctPromo,onChange:T=>f("pctPromo",T.target.value)})]})]})]})]}),c.jsx("div",{className:"rounded-2xl border border-gray-100 bg-gradient-to-br from-white via-gray-50 to-gray-100/40 p-5 shadow-sm",children:c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-white/70",children:"Thng Tin Nh Cung Cp"}),c.jsx("div",{className:"space-y-4",children:r.map(T=>c.jsxs("div",{className:"rounded-2xl border border-white/70 bg-white/80 p-4 shadow-inner",children:[c.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[c.jsx("p",{className:"text-sm font-semibold text-white",children:"Nh Cung Cp"}),r.length>1&&c.jsx("button",{type:"button",className:"text-xs text-red-500 hover:text-red-600",onClick:()=>w(T.id),children:"Xa"})]}),c.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Tn Nh Cung Cp"}),c.jsxs("div",{className:"mt-1 flex items-stretch gap-2",children:[c.jsx("div",{className:"flex-1",children:T.useCustomName?c.jsx("input",{type:"text",className:"w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",placeholder:"Nhp tn Nh Cung Cp",value:T.sourceName,onChange:E=>p(T.id,"sourceName",E.target.value)}):c.jsxs("select",{className:"supplier-select w-full rounded-xl border border-gray-200 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.sourceId!==null?String(T.sourceId):T.sourceName,onChange:E=>x(T.id,E.target.value),children:[c.jsx("option",{value:"",children:i?"ang ti Nh Cung Cp...":"Chn Nh Cung Cp"}),n.map(E=>{const k=E.id!==null?String(E.id):E.name;return c.jsx("option",{value:k,children:E.name},k)})]})}),c.jsx("button",{type:"button",className:"flex h-10 w-10 items-center justify-center rounded-xl border border-blue-300/70 bg-white/90 text-blue-600 hover:bg-blue-600 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-200 disabled:opacity-60",onClick:()=>T.useCustomName?x(T.id,""):b(T.id),title:T.useCustomName?"Quay li chn Nh Cung Cp c sn":"Thm Nh Cung Cp mi (in tn th cng)",children:T.useCustomName?c.jsx(A6,{className:"h-5 w-5"}):c.jsx(Ai,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Gi Nhp"}),c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:S3(T.price),onChange:E=>g(T.id,E.target.value),placeholder:"0"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"S Ti Khon"}),(()=>{const E=!T.useCustomName&&!!T.sourceId&&!!(T.bankBin||T.numberBank);return c.jsx("input",{type:"text",className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.numberBank,onChange:k=>p(T.id,"numberBank",k.target.value),disabled:E,style:E?{opacity:.7,cursor:"not-allowed"}:void 0})})()]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Ngn Hng"}),(()=>{const E=!T.useCustomName&&!!T.sourceId&&!!(T.bankBin||T.numberBank);return c.jsxs("select",{className:"mt-1 w-full rounded-xl border border-gray-200 bg-white/90 px-3 py-2 text-sm focus:border-blue-300 focus:ring-2 focus:ring-blue-200",value:T.bankBin,onChange:k=>p(T.id,"bankBin",k.target.value),disabled:E,style:E?{opacity:.7,cursor:"not-allowed"}:void 0,children:[c.jsx("option",{value:"",children:"Chn Ngn Hng"}),a.map(k=>c.jsx("option",{value:k.bin,children:k.name},k.bin))]})})(),s&&c.jsx("p",{className:"mt-1 text-[11px] text-white/60",children:"ang Ti Danh Sch Ngn Hng..."})]}),c.jsx("div",{className:"md:col-span-2",children:(()=>{const E=Number((T.price||"").replace(/\D+/g,"")),k=Wa(t.pctCtv),A=Wa(t.pctKhach),j=E&&k?ed(E,k):null,P=A&&(j||E)?ed(j||E,A):null;return c.jsxs("div",{className:"mt-3 rounded-xl border border-white/20 bg-white/10 px-4 py-3 shadow-inner",children:[c.jsx("p",{className:"text-xs font-semibold text-white/70 uppercase tracking-wide",children:"Xem trc gi"}),c.jsxs("div",{className:"mt-2 grid gap-3 md:grid-cols-2",children:[c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi s (theo T gi CTV)"}),c.jsx("span",{className:"text-sm font-semibold text-white",children:j?aa(j):"-"})]}),c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("span",{className:"text-[11px] uppercase text-white/60",children:"Gi l (theo T gi Khch)"}),c.jsx("span",{className:"text-sm font-semibold text-white",children:P?aa(P):"-"})]})]})]})})()})]})]},T.id))}),c.jsx("div",{className:"flex justify-center",children:c.jsxs("button",{type:"button",className:"inline-flex items-center rounded-full border border-dashed border-blue-300 px-4 py-2 text-sm font-semibold text-blue-600 hover:border-blue-400 hover:text-blue-700",onClick:_,children:[c.jsx(U6,{className:"mr-2 h-4 w-4"}),"Thm Nh Cung Cp"]})})]})}),d&&c.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600",children:d}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{type:"button",className:"inline-flex items-center rounded-xl border border-white/25 bg-white/10 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:border-white/60 hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white/30 disabled:cursor-not-allowed disabled:opacity-50",onClick:h,disabled:l,children:"Hy B"}),c.jsx(Ci,{className:"px-5 py-2 text-sm font-semibold",onClick:S,disabled:l,children:l?"ang Lu...":"Lu Sn Phm"})]})]})]})}):null,gZ=({product:e,loading:t,error:r,onClose:n,onConfirm:a})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",onClick:()=>{t||n()},children:c.jsxs("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl",onClick:i=>i.stopPropagation(),children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-lg font-bold text-sky-100",children:"Xc nh Xa"}),c.jsx("p",{className:"text-sm text-sky-200/90",children:"Hnh ng ny s Xa Sn Phm khi bng Gi."})]}),c.jsx("button",{type:"button",className:"text-white/60 hover:text-white/70 disabled:opacity-50",onClick:n,disabled:t,children:c.jsx(Hr,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"space-y-3 text-sm text-white/70",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-bold text-sky-100",children:e.packageName||e.packageProduct||e.sanPhamRaw||`Sn Phm #${e.id}`}),c.jsxs("p",{className:"text-sm text-sky-200/90",children:["M: ",e.sanPhamRaw||"Khng xc nh"]})]}),c.jsx("p",{children:"Bn c chc chn mun xa sn phm ny? Hnh ng khng th hon tc v d liu lin quan s c cp nht."})]}),r&&c.jsx("p",{className:"mt-4 text-xs text-red-500",children:r}),c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[c.jsx("button",{type:"button",className:"rounded-lg border border-gray-200 px-4 py-2 text-sm font-medium text-white/70 hover:bg-indigo-500/10 disabled:opacity-50",onClick:n,disabled:t,children:"Hy"}),c.jsx("button",{type:"button",className:"rounded-lg bg-rose-600 px-4 py-2 text-sm font-semibold text-white hover:bg-rose-700 disabled:opacity-60",onClick:a,disabled:t,children:t?"ang Xa...":"Xa Sn Phm"})]})]})}):null,vZ=e=>{const[t,r]=v.useState(""),[n,a]=v.useState("all"),[i,s]=v.useState(1),[l,d]=v.useState(10),[h,f]=v.useState([]),[p,x]=v.useState(!1),[g,b]=v.useState(null),[_,w]=v.useState(null),[S,T]=v.useState({}),[E,k]=v.useState({}),[A,j]=v.useState(!1),P=v.useCallback(async()=>{x(!0),b(null);try{const O=await fetch(`${e}${kt.PRODUCT_PRICES}`,{credentials:"include"});if(O.status===401){window.location.href="/login";return}if(!O.ok)throw new Error("KhA'ng th ti d_ liu sn phcm.");const M=await O.json(),ee=(Array.isArray(M)?M:Array.isArray(M?.items)?M.items:[]).map((J,ie)=>N3(J,ie)).map(J=>ju(J,J.baseSupplyPrice)),fe=ee.reduce((J,ie)=>(ie.lastUpdated&&(J[ie.id]=ie.lastUpdated),J),{});f(ee),T({}),k(fe)}catch(O){console.error("L-i khi ti d_ liu:",O),f([]),b(O instanceof Error?O.message:"KhA'ng th ti d_ liu product_price.")}finally{x(!1)}},[e]),D=v.useMemo(()=>{const O=t.trim().toLowerCase();return h.filter(M=>n==="active"&&!M.isActive||n==="inactive"&&M.isActive?!1:O?[M.packageName,M.packageProduct,M.sanPhamRaw,M.variantLabel].join(" ").toLowerCase().includes(O):!0).sort((M,re)=>{const oe=!(S[M.id]??M.isActive),ee=!(S[re.id]??re.isActive);if(oe!==ee)return oe?1:-1;const fe=gh(E[M.id]??M.lastUpdated),J=gh(E[re.id]??re.lastUpdated);return fe!==J?J-fe:M.id-re.id})},[h,t,n,S,E]),L=v.useMemo(()=>{const O=(i-1)*l,M=O+l;return D.slice(O,M)},[D,i,l]),I=D.length;return{currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:d,totalRows:I,searchTerm:t,setSearchTerm:r,statusFilter:n,setStatusFilter:a,productPrices:h,setProductPrices:f,isLoading:p,setIsLoading:x,error:g,setError:b,statusOverrides:S,setStatusOverrides:T,updatedTimestampMap:E,setUpdatedTimestampMap:k,expandedProductId:_,setExpandedProductId:w,isRefreshing:A,setIsRefreshing:j,fetchProductPrices:P,filteredPricing:L}},yZ=async e=>{const t=await Ct(`/api/product-prices/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.text();throw new Error(Jo(n,{fallback:"Khng th xa sn phm khi bng gi.",blockPatterns:[/(cannot\s+delete)/i]}))}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},wZ=e=>({packageName:e.packageName||"",packageProduct:e.packageProduct||"",sanPham:e.sanPhamRaw||"",pctCtv:e.pctCtv!==null&&e.pctCtv!==void 0?String(e.pctCtv):"",pctKhach:e.pctKhach!==null&&e.pctKhach!==void 0?String(e.pctKhach):"",pctPromo:e.pctPromo!==null&&e.pctPromo!==void 0?String(e.pctPromo):""}),bZ=({apiBase:e,productPrices:t,setProductPrices:r,fetchProductPrices:n,statusOverrides:a,setStatusOverrides:i,updatedTimestampMap:s,setUpdatedTimestampMap:l})=>{const[d,h]=v.useState(null),[f,p]=v.useState(null),[x,g]=v.useState(null),[b,_]=v.useState(!1),[w,S]=v.useState(!1),[T,E]=v.useState({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),[k,A]=v.useState([fv()]),[j,P]=v.useState(null),[D,L]=v.useState(!1),[I,O]=v.useState([]),[M,re]=v.useState(!1),[oe,ee]=v.useState([]),[fe,J]=v.useState(!1),[ie,Q]=v.useState({product:null,loading:!1,error:null}),te=v.useCallback(async()=>{if(!(fe||oe.length>0)){J(!0);try{const Ce=await fetch(`${e}${kt.BANK_LIST}`,{credentials:"include"});if(!Ce.ok)throw new Error("Khng th ti danh sch ngn hng.");const Ae=await Ce.json(),ve=Array.isArray(Ae)?Ae.map(Le=>({bin:Le?.bin?.toString().trim()??"",name:Le?.bank_name?.toString().trim()??Le?.name??""})).filter(Le=>Le.bin&&Le.name):[];ee(ve)}catch(Ce){console.error("Li khi ti danh sch ngn hng:",Ce)}finally{J(!1)}}},[e,oe.length,fe]),H=v.useCallback(async()=>{if(!(M||I.length>0)){re(!0);try{const Ce=await fetch(`${e}${kt.SUPPLIES}`,{credentials:"include"});if(!Ce.ok)throw new Error("Khng th ti danh sch NCC.");const Ae=await Ce.json().catch(()=>null),Le=(Array.isArray(Ae?.items)?Ae.items:Array.isArray(Ae)?Ae:[]).map(Ye=>{const Be=Ye?.id??Ye?.sourceId??Ye?.source_id,ot=typeof Be=="number"&&Number.isFinite(Be)?Be:Number.isFinite(Number(Be))?Number(Be):null,et=Ye?.source_name??Ye?.name??Ye?.sourceName??Ye?.source??"";return{id:ot??null,name:(et||"").trim(),numberBank:Ye?.number_bank??Ye?.numberBank??Ye?.bankNumber??"",binBank:Ye?.bin_bank??Ye?.binBank??Ye?.bankBin??""}}).filter(Ye=>Ye.name.length>0),pe=[],tt=new Set;for(const Ye of Le){const Be=Ye.id!==null?`id:${Ye.id}`:`name:${Ye.name.toLowerCase().trim()}`;tt.has(Be)||(tt.add(Be),pe.push(Ye))}O(pe)}catch(Ce){console.error("Li khi ti danh sch NCC:",Ce)}finally{re(!1)}}},[e,M,I.length]);v.useEffect(()=>{!M&&I.length===0&&H()},[M,I.length,H]),v.useEffect(()=>{w&&oe.length===0&&!fe&&te(),w&&I.length===0&&!M&&H()},[w,oe.length,fe,te,I.length,M,H]);const se=(Ce,Ae)=>{if(Ce.stopPropagation(),_(!1),d===Ae.id){h(null),p(null),g(null);return}g(null),h(Ae.id),p(wZ(Ae))},Y=(Ce,Ae)=>{p(ve=>ve&&{...ve,[Ce]:Ae})},ce=()=>{h(null),p(null),g(null),_(!1)},ue=async()=>{if(!f||d===null)return;const Ce=f.packageName?.trim()??"",Ae=f.packageProduct?.trim()??"",ve=f.sanPham?.trim()??"";if(!ve){g("Vui lng nhp m sn phm hp l");return}const Le=Wa(f.pctCtv),pe=Wa(f.pctKhach),tt=Wa(f.pctPromo);if(!Le||Le<=0){g("T gi CTV phi ln hn 0");return}if(!pe||pe<=0){g("T gi Khch phi ln hn 0");return}if(tt!==null){if(tt<W1){g("T l khuyn mi khng c m.");return}const Ye=Math.max(0,pe-1);if(Ye===0&&tt>0){g("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(tt>Ye){g(`T l khuyn mi khng c vt ${Ye.toFixed(2)}`);return}}_(!0),g(null);try{const Ye=await fetch(`${e}${kt.PRODUCT_PRICE_DETAIL(d)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:Ce,packageProduct:Ae,sanPham:ve,pctCtv:Le,pctKhach:pe,pctPromo:tt}),credentials:"include"}),Be=await Ye.text();let ot=null;if(Be)try{ot=JSON.parse(Be)}catch{ot=null}if(!Ye.ok){const Je=ot?.error||Be?.trim()||"Khng th cp nht gi sn phm";throw new Error(Je)}const et=N3(ot,d);r(Je=>Je.map(Ze=>Ze.id===d?et:Ze)),et?.id!==void 0&&l(Je=>({...Je,[et.id]:et.lastUpdated||new Date().toISOString()})),await n(),h(null),p(null)}catch(Ye){console.error("Li khi cp nht gi sn phm:",Ye),g(Ye instanceof Error?Ye.message:"Khng th cp nht gi sn phm")}finally{_(!1)}},me=v.useCallback((Ce,Ae)=>{Ce.stopPropagation(),Q({product:Ae,loading:!1,error:null})},[]),Re=v.useCallback(()=>{Q({product:null,loading:!1,error:null})},[]),U=v.useCallback(async()=>{const Ce=ie.product;if(Ce){Q(Ae=>({...Ae,loading:!0,error:null}));try{const Ae=await yZ(Ce.id);if(!Ae.success)throw new Error(Ae.message||"Khng th xa sn phm.");r(ve=>ve.filter(Le=>Le.id!==Ce.id)),i(ve=>{const Le={...ve};return delete Le[Ce.id],Le}),l(ve=>{const Le={...ve};return delete Le[Ce.id],Le}),Re()}catch(Ae){console.error("Failed to delete product price:",Ae),Q(ve=>({...ve,loading:!1,error:Ae instanceof Error?Ae.message:"Khng th xa sn phm. Vui lng th li."}))}}},[Re,ie.product,r,i,l]),B=()=>{E({packageName:"",packageProduct:"",sanPham:"",pctCtv:"",pctKhach:"",pctPromo:""}),A([fv()]),P(null),L(!1)},K=()=>{B(),S(!0),oe.length===0&&!fe&&te(),I.length===0&&!M&&H()},z=()=>{S(!1),B()};return{editingProductId:d,productEditForm:f,productEditError:x,isSavingProductEdit:b,isCreateModalOpen:w,createForm:T,createSuppliers:k,createError:j,isSubmittingCreate:D,supplierOptions:I,isLoadingSuppliers:M,bankOptions:oe,isLoadingBanks:fe,deleteProductState:ie,handleStartProductEdit:se,handleProductEditChange:Y,handleCancelProductEdit:ce,handleSubmitProductEdit:ue,handleRequestDeleteProduct:me,confirmDeleteProduct:U,closeDeleteProductModal:Re,handleOpenCreateModal:K,handleCloseCreateModal:z,handleCreateFormChange:(Ce,Ae)=>{E(ve=>({...ve,[Ce]:Ae}))},handleSupplierChange:(Ce,Ae,ve)=>{A(Le=>Le.map(pe=>pe.id===Ce?{...pe,[Ae]:Ae==="sourceId"?ve&&Number(ve)||null:Ae==="useCustomName"?ve==="true":ve}:pe))},handleSupplierSelectChange:(Ce,Ae)=>{const ve=I.find(Le=>Le.id!==null&&Ae===String(Le.id)||Le.id===null&&Ae===Le.name)||null;A(Le=>Le.map(pe=>pe.id===Ce?{...pe,sourceId:ve?.id??null,sourceName:ve?.name??"",numberBank:ve?.numberBank??"",bankBin:ve?.binBank??"",useCustomName:!1}:pe))},handleSupplierPriceInput:(Ce,Ae)=>{const ve=H1(Ae);A(Le=>Le.map(pe=>pe.id===Ce?{...pe,price:ve}:pe))},handleEnableCustomSupplier:Ce=>{A(Ae=>Ae.map(ve=>ve.id===Ce?{...ve,sourceId:null,sourceName:"",numberBank:"",bankBin:"",useCustomName:!0}:ve))},handleAddSupplierRow:()=>{A(Ce=>[...Ce,fv()])},handleRemoveSupplierRow:Ce=>{A(Ae=>Ae.length===1?Ae:Ae.filter(ve=>ve.id!==Ce))},handleSubmitCreateProduct:async()=>{const Ce=T.packageName.trim(),Ae=T.packageProduct.trim(),ve=T.sanPham.trim(),Le=Wa(T.pctCtv),pe=Wa(T.pctKhach),tt=Wa(T.pctPromo);if(!ve){P("Vui lng nhp m sn phm");return}if(Le!==null&&Le<=0){P("T gi CTV phi ln hn 0.");return}if(pe!==null&&pe<=0){P("T gi khch phi ln hn 0.");return}if(tt!==null){if(tt<W1){P("T l khuyn mi khng c m.");return}if(pe!==null&&pe>0){const Be=Math.max(0,pe-1);if(Be===0&&tt>0){P("T gi khuyn mi khng p dng khi T gi Khch  mc 1.");return}if(tt>Be){P(`T l khuyn mi khng c vt ${Be.toFixed(2)}`);return}}}const Ye=k.map(Be=>{const ot=Be.sourceName.trim(),et=Number((Be.price||"").replace(/\D+/g,"")),Je=Number.isFinite(et)&&et>0?et:null;return!ot&&Je===null?null:{sourceId:Be.sourceId!==null&&Number.isFinite(Be.sourceId)?Be.sourceId:void 0,sourceName:ot||void 0,price:Je,numberBank:Be.numberBank.trim()||void 0,binBank:Be.bankBin.trim()||void 0}}).filter(Be=>!!(Be&&(Be.sourceId!==void 0||Be.sourceName)));L(!0),P(null);try{const Be=await fetch(`${e}${kt.PRODUCT_PRICES}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packageName:Ce,packageProduct:Ae,sanPham:ve,pctCtv:Le,pctKhach:pe,pctPromo:tt,suppliers:Ye}),credentials:"include"}),ot=await Be.text();let et=null;if(ot)try{et=JSON.parse(ot)}catch{et=null}if(!Be.ok){const Je=et?.error||ot?.trim()||"Khng th to sn phm";throw new Error(Je)}await n(),z()}catch(Be){console.error("Li khi to sn phm:",Be),P(Be instanceof Error?Be.message:"Khng th to sn phm")}finally{L(!1)}},handleToggleStatus:async Ce=>{const ve=!(a[Ce.id]??Ce.isActive??!1),Le=a[Ce.id],pe=s[Ce.id],tt=new Date().toISOString();i(Ye=>({...Ye,[Ce.id]:ve})),r(Ye=>Ye.map(Be=>Be.id===Ce.id?{...Be,isActive:ve}:Be)),l(Ye=>({...Ye,[Ce.id]:tt}));try{const Ye=await fetch(`${e}${kt.PRODUCT_PRICES}/${Ce.id}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:ve}),credentials:"include"});if(!Ye.ok)throw new Error("Li khi cp nht trng thi");const Be=await Ye.json(),ot=Be?.is_active??ve,et=typeof Be?.update=="string"?Be.update:tt;i(Je=>({...Je,[Ce.id]:ot})),r(Je=>Je.map(Ze=>Ze.id===Ce.id?{...Ze,isActive:ot,lastUpdated:et}:Ze)),l(Je=>({...Je,[Ce.id]:et}))}catch(Ye){console.error("Failed to toggle product status:",Ye),i(Be=>{const ot={...Be};return Le===void 0?delete ot[Ce.id]:ot[Ce.id]=Le,ot}),r(Be=>Be.map(ot=>ot.id===Ce.id?{...ot,isActive:Le??Ce.isActive??!1}:ot)),l(Be=>{const ot={...Be};return pe?ot[Ce.id]=pe:delete ot[Ce.id],ot}),alert("Cp nht tht bi. Vui lng th li")}}}},_Z=({apiBase:e,setProductPrices:t,fetchProductPrices:r})=>{const[n,a]=v.useState({}),[i,s]=v.useState({}),[l,d]=v.useState({}),[h,f]=v.useState({}),[p,x]=v.useState({}),[g,b]=v.useState({}),_=v.useCallback(async I=>{const O=Ru(I);if(O){a(M=>({...M,[O]:{items:M[O]?.items??[],loading:!0,error:null,productName:M[O]?.productName??I}}));try{const M=await fetch(`${e}${kt.SUPPLY_PRICES_BY_PRODUCT_NAME(I)}`,{credentials:"include"});if(!M.ok)throw new Error("KhA'ng th ti giA nh-p");const re=await M.json(),oe=Array.isArray(re)?re.map((J,ie)=>({sourceId:Number.isFinite(Number(J?.sourceId??J?.source_id))?Number(J?.sourceId??J?.source_id):ie,sourceName:J?.sourceName?.toString().trim()||J?.source_name?.toString().trim()||`NhA Cung Cp #${Number(J?.sourceId)||ie+1}`,price:typeof J?.price=="number"&&Number.isFinite(J.price)?J.price:null,lastOrderDate:typeof J?.last_order_date=="string"?J.last_order_date:null})):[],ee=i0(uZ(oe)),fe=Us(ee,null);typeof fe=="number"&&Number.isFinite(fe)&&fe>0&&t(J=>{let ie=!1;const Q=J.map(te=>{if(Ru(te.sanPhamRaw)!==O)return te;const H=typeof te.baseSupplyPrice=="number"&&Number.isFinite(te.baseSupplyPrice)&&Math.abs(te.baseSupplyPrice-fe)<1e-5,se=typeof te.wholesalePrice=="number"&&Number.isFinite(te.wholesalePrice)&&te.wholesalePrice>0,Y=typeof te.retailPrice=="number"&&Number.isFinite(te.retailPrice)&&te.retailPrice>0,ce=xh(te.pctPromo,te.pctKhach,te.pctCtv),ue=typeof te.promoPrice=="number"&&Number.isFinite(te.promoPrice)&&te.promoPrice>0;return H&&se&&Y&&(!ce||ue)?te:(ie=!0,ju({...te,baseSupplyPrice:fe},fe))});return ie?Q:J}),a(J=>({...J,[O]:{loading:!1,error:null,items:ee,productName:I}}))}catch(M){a(re=>({...re,[O]:{loading:!1,items:re[O]?.items??[],error:M instanceof Error?M.message:"KhA'ng th ti giA nh-p ca NCC",productName:re[O]?.productName??I}}))}}},[e,t]),w=I=>{s(O=>{const M={...O};return delete M[I],M}),d(O=>{const M={...O};return delete M[I],M}),x(O=>{const M={...O};return delete M[I],M})},S=(I,O,M)=>{const re=Wl(I,O);s(oe=>({...oe,[re]:!0})),d(oe=>({...oe,[re]:M==null?"":S3(M)})),x(oe=>({...oe,[re]:null}))},T=(I,O,M)=>{const re=Wl(I,O),oe=H1(M);d(ee=>({...ee,[re]:oe})),x(ee=>({...ee,[re]:null}))},E=(I,O)=>{const M=Wl(I,O);w(M),f(re=>{const oe={...re};return delete oe[M],oe})},k=async(I,O,M,re)=>{const oe=Wl(I,O),fe=l[oe]?.toString().trim()??"";if(!fe){x(ie=>({...ie,[oe]:"Vui lAng nh-p giA hp l"}));return}const J=Number(fe.replace(/\D+/g,""));if(!Number.isFinite(J)||J<0){x(ie=>({...ie,[oe]:"GiA nh-p khA'ng `c thp hn 0."}));return}f(ie=>({...ie,[oe]:!0}));try{const ie=await fetch(`${e}${kt.UPDATE_SUPPLY_PRICE(I,O)}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:J}),credentials:"include"}),Q=await ie.json().catch(()=>null);if(!ie.ok)throw new Error(Q?.error||"KhA'ng th c-p nh-t giA nh-p");const te=Number.isFinite(Number(Q?.price))?Number(Q?.price):J;let H=null,se=!1;if(a(Y=>{const ce=Y[M];if(!ce)return Y;const ue=Us(ce.items,null),me=ce.items.find(Oe=>Oe.sourceId===O),Re=typeof me?.price=="number"?me.price:null,U=typeof Re=="number"&&typeof ue=="number"&&Math.abs(Re-ue)<1e-5,B=i0(ce.items.map(Oe=>Oe.sourceId===O?{...Oe,price:te}:Oe)),K=Us(B,null),z=Re===null||Re!==te;return typeof K=="number"&&Number.isFinite(K)&&K>0?(H=K,(K!==ue||U&&z)&&(se=!0)):U&&z&&(H=K??null,se=!0),{...Y,[M]:{...ce,items:B}}}),se&&t(Y=>Y.map(ce=>ce.id===I?ju(ce,H):ce)),w(oe),await _(re),se)try{await r()}catch(Y){console.error("Failed to refresh product pricing:",Y)}}catch(ie){x(Q=>({...Q,[oe]:ie instanceof Error?ie.message:"KhA'ng th c-p nh-t giA nh-p."}))}finally{f(ie=>{const Q={...ie};return delete Q[oe],Q})}},A=I=>{b(O=>O[I]?O:{...O,[I]:{sourceName:"",sourceId:null,useCustomName:!1,price:"",error:null,isSaving:!1}})},j=(I,O,M)=>{let re=M;if(O==="price")re=H1(String(M??""));else if(O==="sourceId"){const oe=Number(M);re=M===null||Number.isNaN(oe)||!Number.isFinite(oe)?null:oe}else O==="useCustomName"?re=!!M:re=String(M??"");b(oe=>{const ee=oe[I];if(!ee)return oe;const fe={...ee,[O]:re,error:null};return O==="useCustomName"&&(re?(fe.sourceId=null,fe.sourceName=""):!fe.sourceName&&ee.sourceName&&(fe.sourceName=ee.sourceName)),{...oe,[I]:fe}})},P=I=>{b(O=>{const M={...O};return delete M[I],M})};return{supplyPriceMap:n,editingSupplyRows:i,supplyPriceDrafts:l,savingSupplyRows:h,supplyRowErrors:p,newSupplyRows:g,fetchSupplyPricesForProduct:_,handleStartEditingSupply:S,handleSupplyInputChange:T,handleCancelSupplyEditing:E,handleConfirmSupplyEditing:k,handleStartAddSupplierRow:A,handleNewSupplierInputChange:j,handleCancelAddSupplierRow:P,handleConfirmAddSupplierRow:async I=>{const O=g[I.id];if(!O)return;const M=O.sourceName.trim(),re=O.useCustomName||O.sourceId===null?null:O.sourceId,oe=Number((O.price||"").replace(/\D+/g,""));if(!M){b(ee=>({...ee,[I.id]:{...O,error:"Vui long chon hoac nhap ten nguon hop le."}}));return}if(!Number.isFinite(oe)||oe<=0){b(ee=>({...ee,[I.id]:{...O,error:"Gia nhap phai lon hon 0."}}));return}b(ee=>({...ee,[I.id]:{...O,isSaving:!0,error:null}}));try{const ee=await fetch(`${e}${kt.CREATE_SUPPLY_PRICE(I.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceName:M,sourceId:re,price:oe}),credentials:"include"}),fe=await ee.json().catch(()=>null);if(!ee.ok)throw new Error(fe?.error||"Khong the them nguon moi.");const J=Ru(I.sanPhamRaw),ie=Number(fe?.sourceId),Q=Number.isFinite(ie)&&ie>0?ie:re,te=Number.isFinite(Number(fe?.price))?Number(fe?.price):oe;let H=null,se=!1;if(a(Y=>{const ce=Y[J],ue=ce?.items??[],me=ue.some(z=>typeof z.sourceId=="number"&&z.sourceId===Q),Re=i0(me?ue.map(z=>z.sourceId===Q?{...z,price:te}:z):[...ue,{sourceId:Number.isFinite(Q)&&Q>0?Q:Date.now(),sourceName:M,price:te,lastOrderDate:null}]),U=Us(ue,null),B=Us(Re,null);return(typeof U=="number"&&typeof B=="number"?Math.abs(B-U)>1e-5:U!==B)&&(se=!0),H=B,{...Y,[J]:{loading:ce?.loading??!1,error:null,items:Re}}}),se&&t(Y=>Y.map(ce=>ce.id===I.id?ju(ce,H):ce)),await _(I.sanPhamRaw),P(I.id),se)try{await r()}catch(Y){console.error("Failed to refresh product pricing:",Y)}}catch(ee){b(fe=>({...fe,[I.id]:{...O,isSaving:!1,error:ee instanceof Error?ee.message:"Khong the them nguon moi."}}))}},handleDeleteSupplyRow:async(I,O,M,re)=>{const oe=Wl(I,O);x(J=>({...J,[oe]:null})),f(J=>({...J,[oe]:!0}));let ee=null,fe=!1;try{const J=await fetch(`${e}${kt.DELETE_SUPPLY_PRICE(I,O)}`,{method:"DELETE",credentials:"include"}),ie=await J.json().catch(()=>null);if(!J.ok)throw new Error(ie?.error||"Khong the xoa nguon nay.");if(a(Q=>{const te=Q[M];if(!te)return Q;const H=i0(te.items.filter(ue=>ue.sourceId!==O)),se=Us(te.items,null),Y=Us(H,null);return(typeof se=="number"&&typeof Y=="number"?Math.abs(Y-se)>1e-5:se!==Y)&&(fe=!0),ee=Y,{...Q,[M]:{...te,items:H}}}),w(oe),fe&&t(Q=>Q.map(te=>te.id===I?ju(te,ee):te)),await _(re),fe)try{await r()}catch(Q){console.error("Failed to refresh product pricing:",Q)}}catch(J){x(ie=>({...ie,[oe]:J instanceof Error?J.message:"Khong the xoa nguon nay."}))}finally{f(J=>{const ie={...J};return delete ie[oe],ie})}}}},SZ={};var NZ={};const pv=typeof import.meta<"u"&&SZ?.VITE_API_BASE_URL||NZ.VITE_API_BASE_URL||"http://localhost:3001",EZ=()=>{const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:d,productPrices:h,setProductPrices:f,isLoading:p,error:x,statusOverrides:g,setStatusOverrides:b,updatedTimestampMap:_,setUpdatedTimestampMap:w,expandedProductId:S,setExpandedProductId:T,isRefreshing:E,setIsRefreshing:k,fetchProductPrices:A,filteredPricing:j}=vZ(pv),P=_Z({apiBase:pv,setProductPrices:f,fetchProductPrices:A}),{supplyPriceMap:D,fetchSupplyPricesForProduct:L}=P,I=bZ({apiBase:pv,productPrices:h,setProductPrices:f,fetchProductPrices:A,statusOverrides:g,setStatusOverrides:b,updatedTimestampMap:_,setUpdatedTimestampMap:w});v.useEffect(()=>{A()},[A]);const O=v.useCallback(async()=>{if(!E){k(!0);try{await A();const oe=new Set;Object.values(D).forEach(ee=>{ee?.productName&&oe.add(ee.productName)}),await Promise.all(Array.from(oe).map(ee=>L(ee)))}catch(oe){console.error("Failed to refresh pricing data:",oe)}finally{k(!1)}}},[E,A,k,D,L]),M=oe=>{const ee=S===oe.id?null:oe.id;if(T(ee),ee===oe.id){const fe=Ru(oe.sanPhamRaw),J=P.supplyPriceMap[fe];(!J||!J.loading&&J.items.length===0)&&P.fetchSupplyPricesForProduct(oe.sanPhamRaw)}},re=v.useMemo(()=>{const oe=h.length,ee=h.filter(J=>J.isActive).length,fe=oe-ee;return[{name:"Tng Sn Phm",value:oe.toString(),icon:oy,accent:"emerald",subtitle:"Tt c sn phm"},{name:"ang Hot ng",value:ee.toString(),icon:T0,accent:"sky",subtitle:"Sn sng bn"},{name:"Tm Dng",value:fe.toString(),icon:ac,accent:"violet",subtitle:"ang n trn bng gi"}]},[h]);return{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,currentPage:a,setCurrentPage:i,rowsPerPage:s,setRowsPerPage:l,totalRows:d,filteredPricing:j,pricingStats:re,isLoading:p,error:x,isRefreshing:E,expandedProductId:S,supplyPriceMap:D,editingSupplyRows:P.editingSupplyRows,supplyPriceDrafts:P.supplyPriceDrafts,savingSupplyRows:P.savingSupplyRows,supplyRowErrors:P.supplyRowErrors,newSupplyRows:P.newSupplyRows,editingProductId:I.editingProductId,productEditForm:I.productEditForm,productEditError:I.productEditError,isSavingProductEdit:I.isSavingProductEdit,isCreateModalOpen:I.isCreateModalOpen,createForm:I.createForm,createSuppliers:I.createSuppliers,createError:I.createError,isSubmittingCreate:I.isSubmittingCreate,supplierOptions:I.supplierOptions,isLoadingSuppliers:I.isLoadingSuppliers,bankOptions:I.bankOptions,isLoadingBanks:I.isLoadingBanks,statusOverrides:g,updatedTimestampMap:_,deleteProductState:I.deleteProductState,handleRefreshAll:O,handleToggleProductDetails:M,handleStartEditingSupply:P.handleStartEditingSupply,handleSupplyInputChange:P.handleSupplyInputChange,handleCancelSupplyEditing:P.handleCancelSupplyEditing,handleConfirmSupplyEditing:P.handleConfirmSupplyEditing,handleStartAddSupplierRow:P.handleStartAddSupplierRow,handleNewSupplierInputChange:P.handleNewSupplierInputChange,handleCancelAddSupplierRow:P.handleCancelAddSupplierRow,handleConfirmAddSupplierRow:P.handleConfirmAddSupplierRow,handleDeleteSupplyRow:P.handleDeleteSupplyRow,handleStartProductEdit:I.handleStartProductEdit,handleProductEditChange:I.handleProductEditChange,handleCancelProductEdit:I.handleCancelProductEdit,handleSubmitProductEdit:I.handleSubmitProductEdit,handleRequestDeleteProduct:I.handleRequestDeleteProduct,confirmDeleteProduct:I.confirmDeleteProduct,closeDeleteProductModal:I.closeDeleteProductModal,handleOpenCreateModal:I.handleOpenCreateModal,handleCloseCreateModal:I.handleCloseCreateModal,handleCreateFormChange:I.handleCreateFormChange,handleSupplierChange:I.handleSupplierChange,handleSupplierSelectChange:I.handleSupplierSelectChange,handleSupplierPriceInput:I.handleSupplierPriceInput,handleEnableCustomSupplier:I.handleEnableCustomSupplier,handleAddSupplierRow:I.handleAddSupplierRow,handleRemoveSupplierRow:I.handleRemoveSupplierRow,handleSubmitCreateProduct:I.handleSubmitCreateProduct,handleToggleStatus:I.handleToggleStatus,fetchSupplyPricesForProduct:P.fetchSupplyPricesForProduct}};function TZ(){const{searchTerm:e,setSearchTerm:t,statusFilter:r,setStatusFilter:n,totalRows:a,currentPage:i,setCurrentPage:s,rowsPerPage:l,setRowsPerPage:d,pricingStats:h,filteredPricing:f,isLoading:p,error:x,isRefreshing:g,expandedProductId:b,supplyPriceMap:_,statusOverrides:w,updatedTimestampMap:S,editingSupplyRows:T,supplyPriceDrafts:E,savingSupplyRows:k,supplyRowErrors:A,newSupplyRows:j,editingProductId:P,productEditForm:D,productEditError:L,isSavingProductEdit:I,deleteProductState:O,isCreateModalOpen:M,createForm:re,createSuppliers:oe,createError:ee,isSubmittingCreate:fe,supplierOptions:J,isLoadingSuppliers:ie,bankOptions:Q,isLoadingBanks:te,handleRefreshAll:H,handleToggleProductDetails:se,handleStartProductEdit:Y,handleProductEditChange:ce,handleCancelProductEdit:ue,handleSubmitProductEdit:me,handleRequestDeleteProduct:Re,confirmDeleteProduct:U,closeDeleteProductModal:B,handleStartEditingSupply:K,handleSupplyInputChange:z,handleCancelSupplyEditing:ne,handleConfirmSupplyEditing:Oe,handleStartAddSupplierRow:Pe,handleNewSupplierInputChange:we,handleCancelAddSupplierRow:xe,handleConfirmAddSupplierRow:Ee,handleDeleteSupplyRow:le,handleToggleStatus:De,handleOpenCreateModal:Ue,handleCloseCreateModal:Ce,handleCreateFormChange:Ae,handleSupplierChange:ve,handleSupplierSelectChange:Le,handleSupplierPriceInput:pe,handleEnableCustomSupplier:tt,handleAddSupplierRow:Ye,handleRemoveSupplierRow:Be,handleSubmitCreateProduct:ot,fetchSupplyPricesForProduct:et}=EZ();return c.jsxs(c.Fragment,{children:[c.jsx(gZ,{product:O.product,loading:O.loading,error:O.error,onClose:B,onConfirm:U}),c.jsx(xZ,{isOpen:M,createForm:re,createSuppliers:oe,supplierOptions:J,bankOptions:Q,isLoadingSuppliers:ie,isLoadingBanks:te,createError:ee,isSubmitting:fe,onClose:Ce,onFormChange:Ae,onSupplierChange:ve,onSupplierSelectChange:Le,onSupplierPriceInput:pe,onEnableCustomSupplier:tt,onAddSupplier:Ye,onRemoveSupplier:Be,onSubmit:ot,parseRatioInput:Wa}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(nZ,{stats:h,onAddProduct:Ue}),c.jsx(rZ,{searchTerm:e,statusFilter:r,isLoading:p,isRefreshing:g,error:x,onSearchChange:t,onStatusChange:n,onRefresh:H}),c.jsx(mZ,{items:f,isLoading:p,error:x,totalRows:a,currentPage:i,rowsPerPage:l,onPageChange:s,onRowsPerPageChange:Je=>{d(Je),s(1)},expandedProductId:b,supplyPriceMap:_,statusOverrides:w,updatedTimestampMap:S,supplierOptions:J,isLoadingSuppliers:ie,editingSupplyRows:T,supplyPriceDrafts:E,savingSupplyRows:k,supplyRowErrors:A,newSupplyRows:j,editingProductId:P,productEditForm:D,productEditError:L,isSavingProductEdit:I,deleteProductState:O,onToggleProductDetails:se,onStartProductEdit:Y,onProductEditChange:ce,onCancelProductEdit:ue,onSubmitProductEdit:me,onRequestDeleteProduct:Re,onStartEditingSupply:K,onSupplyInputChange:z,onCancelSupplyEditing:ne,onConfirmSupplyEditing:Oe,onStartAddSupplierRow:Pe,onNewSupplierInputChange:we,onCancelAddSupplierRow:xe,onConfirmAddSupplierRow:Ee,onDeleteSupplyRow:le,onToggleStatus:De,fetchSupplyPricesForProduct:et})]})]})}function CZ(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[a,i]=v.useState(null),[s,l]=v.useState(!1),d=v.useMemo(()=>`retro-grid-${Math.random().toString(36).slice(2)}`,[]),{setUser:h}=dy(),f=Bh();return c.jsxs("div",{className:"retro-login",children:[c.jsx("svg",{width:"0",height:"0",className:"sr-only","aria-hidden":"true",children:c.jsxs("linearGradient",{id:d,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[c.jsx("stop",{offset:"0%",stopColor:"#ff6ec7"}),c.jsx("stop",{offset:"50%",stopColor:"#7c5cff"}),c.jsx("stop",{offset:"100%",stopColor:"#4de1ec"})]})}),c.jsxs("div",{className:"retro-shell",children:[c.jsxs("div",{className:"retro-bg","aria-hidden":"true",children:[c.jsx("div",{className:"retro-grid"}),c.jsx("div",{className:"retro-sun"}),c.jsx("div",{className:"retro-planet"}),c.jsx("div",{className:"retro-glow"})]}),c.jsxs("div",{className:"retro-card",children:[c.jsx("div",{className:"card-top",children:c.jsxs("div",{className:"title",children:[c.jsx("p",{className:"eyebrow",children:"Cho mng tr li"}),c.jsx("h1",{className:"gradient-title",children:"Mavryk Premium"}),c.jsx("p",{className:"subtitle",children:"Nhp thng tin ca bn  vo trang qun tr."})]})}),c.jsxs("form",{className:"form",onSubmit:p=>{p.preventDefault(),i(null),l(!0),Ct("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:r})}).then(async x=>{if(!x.ok){const b=await x.json().catch(()=>({}));throw new Error(b.error||"Login failed")}const g=await x.json();h(g.user||null),f("/dashboard",{replace:!0})}).catch(x=>{i(x instanceof Error?x.message:"Login failed")}).finally(()=>l(!1))},children:[c.jsxs("label",{className:"field",children:[c.jsx("span",{children:"Ti khon"}),c.jsx("input",{type:"text",required:!0,value:e,onChange:p=>t(p.target.value),placeholder:"Nhp tn ng nhp"})]}),c.jsxs("label",{className:"field",children:[c.jsx("span",{children:"Mt khu"}),c.jsx("input",{type:"password",required:!0,value:r,onChange:p=>n(p.target.value),placeholder:"Nhp mt khu"})]}),c.jsxs("div",{className:"controls",children:[c.jsxs("label",{className:"remember",children:[c.jsx("input",{type:"checkbox",defaultChecked:!0}),c.jsx("span",{children:"Ghi nh ng nhp"})]}),c.jsx("button",{type:"button",className:"ghost",children:"Qun mt khu?"})]}),c.jsx("button",{type:"submit",className:"cta",disabled:s,children:s?"ang ng nhp...":"ng nhp"}),a&&c.jsx("p",{className:"error-msg",children:a})]})]})]}),c.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Vast+Shadow&display=swap');

        :root {
          --retro-bg: #0b0b14;
          --retro-card: rgba(13, 14, 26, 0.8);
          --retro-border: rgba(255, 255, 255, 0.08);
          --retro-text: #e5e7ff;
          --retro-muted: #9aa4c2;
          --retro-accent: #ff6ec7;
          --retro-accent-2: #7c5cff;
          --retro-glow: 0 10px 50px rgba(124, 92, 255, 0.5);
          --glass: rgba(255, 255, 255, 0.04);
          color-scheme: dark;
        }

        .retro-login {
          min-height: 100vh;
          background: radial-gradient(circle at 20% 20%, rgba(255, 110, 199, 0.12), transparent 30%),
                      radial-gradient(circle at 80% 0%, rgba(77, 225, 236, 0.12), transparent 32%),
                      var(--retro-bg);
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 32px;
          position: relative;
          overflow: hidden;
          font-family: "Inter", "Space Grotesk", system-ui, -apple-system, sans-serif;
        }

        .retro-shell {
          position: relative;
          width: min(1100px, 100%);
          min-height: 620px;
          border: 1px solid var(--retro-border);
          border-radius: 24px;
          overflow: hidden;
          background: linear-gradient(135deg, rgba(255, 110, 199, 0.06), rgba(77, 225, 236, 0.05));
          box-shadow: 0 30px 120px rgba(0, 0, 0, 0.45);
        }

        .retro-bg {
          position: absolute;
          inset: 0;
          overflow: hidden;
          pointer-events: none;
        }

        .retro-grid {
          position: absolute;
          inset: 0;
          background-image: linear-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(255,255,255,0.04) 1px, transparent 1px);
          background-size: 80px 80px;
          transform: perspective(600px) rotateX(70deg) translateY(-20%);
          transform-origin: center;
          filter: blur(0.3px);
        }

        .retro-sun {
          position: absolute;
          width: 340px;
          height: 340px;
          border-radius: 50%;
          background: conic-gradient(from 120deg, rgba(255, 110, 199, 0.3), rgba(124, 92, 255, 0.35), rgba(77, 225, 236, 0.3));
          top: -80px;
          left: 50%;
          transform: translateX(-50%);
          filter: blur(10px);
          opacity: 0.9;
        }

        .retro-planet {
          position: absolute;
          width: 120px;
          height: 120px;
          border-radius: 50%;
          background: radial-gradient(circle at 30% 30%, #fff, #7c5cff 45%, #0b0b14 75%);
          top: 60px;
          right: 140px;
          box-shadow: 0 0 40px rgba(124, 92, 255, 0.7);
          opacity: 0.7;
        }

        .retro-glow {
          position: absolute;
          inset: 0;
          background: radial-gradient(circle at 50% 70%, rgba(255, 110, 199, 0.1), transparent 45%);
          mix-blend-mode: screen;
        }

        .retro-card {
          position: relative;
          z-index: 1;
          margin: 48px;
          padding: 36px;
          border-radius: 18px;
          background: var(--retro-card);
          border: 1px solid var(--retro-border);
          backdrop-filter: blur(16px);
          box-shadow: var(--retro-glow);
          color: var(--retro-text);
          display: grid;
          gap: 24px;
          max-width: 640px;
          overflow: hidden;
        }
        .retro-card::before {
          content: "";
          position: absolute;
          inset: -60px;
          background: conic-gradient(#ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          filter: blur(40px);
          opacity: 0.45;
          animation: spinGlow 12s linear infinite;
          z-index: 0;
          pointer-events: none;
        }
        .retro-card > * { position: relative; z-index: 1; }

        .card-top {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }

        .badge {
          align-self: flex-start;
          padding: 6px 12px;
          border-radius: 999px;
          background: linear-gradient(90deg, rgba(255, 110, 199, 0.2), rgba(77, 225, 236, 0.2));
          border: 1px solid rgba(255, 255, 255, 0.12);
          text-transform: uppercase;
          letter-spacing: 0.08em;
          font-size: 11px;
          color: var(--retro-text);
        }

        .title h1 {
          font-size: 36px;
          line-height: 1.2;
          margin: 6px 0 6px;
          letter-spacing: -0.01em;
        }
        .gradient-title {
          background: linear-gradient(120deg, #ff6ec7, #7c5cff, #4de1ec, #ff6ec7);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          animation: gradientShift 4s ease-in-out infinite;
          font-family: "Vast Shadow", "Cinzel Decorative", "Inter", system-ui, -apple-system, sans-serif;
          letter-spacing: 0.5px;
        }
        .title .eyebrow {
          text-transform: uppercase;
          letter-spacing: 0.12em;
          font-size: 12px;
          color: var(--retro-muted);
          margin: 0;
        }
        .title .subtitle {
          margin: 0;
          color: var(--retro-muted);
          font-size: 14px;
        }

        .form {
          display: grid;
          gap: 16px;
        }
        .field {
          display: grid;
          gap: 6px;
          font-size: 14px;
          color: var(--retro-text);
        }
        .field input {
          width: 100%;
          border-radius: 12px;
          border: 1px solid var(--retro-border);
          background: var(--glass);
          padding: 12px 14px;
          color: var(--retro-text);
          transition: border-color 0.2s, box-shadow 0.2s;
        }
        .field input:focus {
          outline: none;
          border-color: rgba(255, 110, 199, 0.6);
          box-shadow: 0 0 0 3px rgba(124, 92, 255, 0.25);
        }

        .controls {
          display: flex;
          align-items: center;
          justify-content: space-between;
          font-size: 13px;
          color: var(--retro-muted);
        }
        .remember {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          cursor: pointer;
        }
        .remember input { accent-color: #7c5cff; }
        .ghost {
          background: transparent;
          border: none;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          padding: 4px 8px;
        }

        .cta {
          width: 100%;
          border: none;
          border-radius: 14px;
          padding: 14px;
          font-weight: 700;
          letter-spacing: 0.01em;
          color: #0b0b14;
          background: linear-gradient(90deg, #ff6ec7, #7c5cff, #4de1ec);
          box-shadow: 0 15px 40px rgba(124, 92, 255, 0.45);
          cursor: pointer;
          transition: transform 0.15s ease, box-shadow 0.15s ease;
        }
        .cta:hover {
          transform: translateY(-1px);
          box-shadow: 0 18px 50px rgba(124, 92, 255, 0.55);
        }
        .cta:active { transform: translateY(0); }

        .divider {
          display: grid;
          grid-template-columns: 1fr auto 1fr;
          align-items: center;
          gap: 10px;
          color: var(--retro-muted);
          font-size: 12px;
        }
        .divider span {
          height: 1px;
          background: linear-gradient(90deg, rgba(255, 255, 255, 0), rgba(255,255,255,0.25), rgba(255,255,255,0));
        }

        .social {
          display: grid;
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 10px;
        }
        .social button {
          border: 1px solid var(--retro-border);
          background: var(--glass);
          border-radius: 12px;
          padding: 10px 12px;
          color: var(--retro-text);
          font-weight: 600;
          cursor: pointer;
          transition: border-color 0.2s, transform 0.2s;
        }
        .social button:hover {
          border-color: rgba(255, 110, 199, 0.5);
          transform: translateY(-1px);
        }
        .cta:disabled { opacity: 0.6; cursor: not-allowed; }
        .error-msg { margin-top: 8px; color: #ff9b9b; font-size: 13px; }
        @keyframes gradientShift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
        }
        @keyframes spinBorder {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes spinGlow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .retro-shell { margin: 16px; }
          .retro-card { margin: 32px 20px; padding: 28px; }
        }
      `})]})}const kZ=async e=>{const t=await Ct(`/api/supplies/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(t.status===404)return{success:!0,message:"Ngun  c xa trc ."};if(!t.ok){const n=await t.text();throw new Error(n||"Khng th xa ngun.")}const r=await t.json().catch(()=>null);return r&&typeof r.success=="boolean"?r:{success:!0}},AZ=({stats:e})=>c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsx(Qi,{title:"Tng NCC",value:e.totalSuppliers,icon:B6,accent:Rr.sky}),c.jsx(Qi,{title:"ang hot ng",value:e.activeSuppliers,icon:nc,accent:Rr.emerald}),c.jsx(Qi,{title:"Tng n",value:e.monthlyOrders,icon:uy,accent:Rr.violet}),c.jsx(Qi,{title:"Tng nhp",value:Bq(e.totalImportValue),icon:oy,accent:Rr.amber})]}),VC=e=>e.trim().toLowerCase(),mv=e=>{const r=String(e||"").replace(/[^\d-]/g,""),n=r.startsWith("-")?"-"+r.slice(1).replace(/-/g,""):r.replace(/-/g,""),a=Number(n);return Number.isFinite(a)?a:0},PZ=lb,GC=Si,jZ=({supplyId:e})=>{const[t,r]=v.useState([]),[n,a]=v.useState(!1),[i,s]=v.useState({round:"",import:"",paid:"",isEditing:!1}),[l,d]=v.useState(null),[h,f]=v.useState(""),p=w=>{const S=String(w||"").replace(/[^\d-]/g,""),T=S.startsWith("-")?"-"+S.slice(1).replace(/-/g,""):S.replace(/-/g,"");if(T==="-")return"-";const E=Number(T);return Number.isFinite(E)?E.toLocaleString("vi-VN"):""},x=v.useCallback(async()=>{a(!0);try{const w=await Ct(`/api/supplies/${e}/payments?offset=0&limit=20`);if(w.ok){const S=await w.json();r(S.payments||[])}}finally{a(!1)}},[e]);v.useEffect(()=>{x()},[x]);const g=async()=>{if(i.round)try{const w={round:i.round,totalImport:mv(i.import),paid:mv(i.paid),status:"Cha Thanh Ton"};(await Ct(`/api/supplies/${e}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).ok&&(s({round:"",import:"",paid:"",isEditing:!1}),x())}catch(w){console.error(w)}},b=async w=>{try{await Ct(`/api/supplies/${e}/payments/${w}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalImport:mv(h)})}),d(null),x()}catch(S){console.error(S)}},_=w=>(w||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim();return c.jsxs("div",{className:"bg-slate-900/80 rounded-xl border border-white/10 overflow-hidden",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex justify-between items-center",children:[c.jsx("h4",{className:"text-sm font-semibold text-white",children:"Lch S Thanh Ton"}),c.jsxs("button",{onClick:()=>s({...i,isEditing:!0}),className:"text-xs flex items-center gap-1 bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full text-white transition",children:[c.jsx(Ai,{className:"h-3 w-3"})," Thm Chu K"]})]}),c.jsxs("table",{className:"w-full text-sm text-left text-white/80",children:[c.jsx("thead",{className:"bg-white/5 text-xs uppercase text-white/60",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2",children:"Chu K"}),c.jsx("th",{className:"px-4 py-2",children:"Tng Nhp"}),c.jsx("th",{className:"px-4 py-2",children:" Thanh Ton"}),c.jsx("th",{className:"px-4 py-2",children:"Trng Thi"}),c.jsx("th",{className:"px-4 py-2 text-right",children:"Thao Tc"})]})}),c.jsxs("tbody",{className:"divide-y divide-white/5",children:[i.isEditing&&c.jsxs("tr",{className:"bg-indigo-500/10",children:[c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"Tn chu k...",value:i.round,onChange:w=>s({...i,round:w.target.value})})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:i.import,onChange:w=>s({...i,import:p(w.target.value)})})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{className:"bg-transparent border-b border-white/30 w-full focus:outline-none text-white",placeholder:"0",value:i.paid,onChange:w=>s({...i,paid:p(w.target.value)})})}),c.jsx("td",{className:"px-4 py-2 text-xs italic opacity-70",children:"Mi"}),c.jsxs("td",{className:"px-4 py-2 text-right",children:[c.jsx("button",{onClick:g,className:"text-emerald-400 hover:text-emerald-300 mr-2",children:c.jsx(Wo,{className:"h-5 w-5 inline"})}),c.jsx("button",{onClick:()=>s({...i,isEditing:!1}),className:"text-rose-400 hover:text-rose-300",children:c.jsx(Hr,{className:"h-5 w-5 inline"})})]})]}),n?c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"text-center py-4",children:"ang ti..."})}):t.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"text-center py-4 opacity-50",children:"Cha c d liu thanh ton"})}):t.map(w=>{const S=_(w.status)==="chua thanh toan";return c.jsxs("tr",{className:"hover:bg-white/5",children:[c.jsx("td",{className:"px-4 py-2",children:w.round}),c.jsx("td",{className:"px-4 py-2",children:l===w.id?c.jsx("input",{className:"bg-black/20 border border-white/20 rounded px-1 w-24 text-right",value:h,onChange:T=>f(p(T.target.value))}):GC(w.totalImport)}),c.jsx("td",{className:"px-4 py-2",children:GC(w.paid)}),c.jsx("td",{className:"px-4 py-2",children:w.status}),c.jsx("td",{className:"px-4 py-2 text-right",children:l===w.id?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>b(w.id),className:"text-emerald-400 mr-2",children:c.jsx(Wo,{className:"h-4 w-4 inline"})}),c.jsx("button",{onClick:()=>d(null),className:"text-rose-400",children:c.jsx(Hr,{className:"h-4 w-4 inline"})})]}):S&&c.jsx("button",{onClick:()=>{d(w.id),f(w.totalImport.toLocaleString("vi-VN"))},className:"text-white/40 hover:text-blue-300",children:c.jsx($h,{className:"h-4 w-4 inline"})})})]},w.id)})]})]})]})},s0=Si,OZ=e=>e?hr(e):"--",DZ=({supplies:e,loading:t,expandedId:r,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l})=>c.jsx("div",{className:"bg-white/5 border border-white/10 rounded-2xl overflow-hidden shadow-2xl backdrop-blur-sm",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-left",children:[c.jsx("thead",{className:"bg-black/20 text-xs uppercase text-white/60 font-semibold",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3",children:"Nh cung cp"}),c.jsx("th",{className:"px-4 py-3",children:"Ti khon"}),c.jsx("th",{className:"px-4 py-3",children:"Thng ny"}),c.jsx("th",{className:"px-4 py-3",children:"Ln cui"}),c.jsx("th",{className:"px-4 py-3",children:" tr"}),c.jsx("th",{className:"px-4 py-3",children:"Cn n"}),c.jsx("th",{className:"px-4 py-3",children:"Thanh ton"}),c.jsx("th",{className:"px-4 py-3 text-center",children:"TT"}),c.jsx("th",{className:"px-4 py-3 text-right",children:"Thao tc"})]})}),c.jsx("tbody",{className:"divide-y divide-white/5",children:t?c.jsx("tr",{children:c.jsx("td",{colSpan:8,className:"text-center py-8 text-white/50",children:"ang ti..."})}):e.map(d=>c.jsx(RZ,{supply:d,isExpanded:r===d.id,onToggle:n,onEdit:a,onDelete:i,onView:s,onToggleStatus:l},d.id))})]})})}),RZ=({supply:e,isExpanded:t,onToggle:r,onEdit:n,onDelete:a,onView:i,onToggleStatus:s})=>c.jsxs(c.Fragment,{children:[c.jsxs("tr",{className:"bg-gradient-to-r from-indigo-950/70 via-slate-900/60 to-indigo-950/70 hover:bg-white/5 cursor-pointer transition border-b border-white/5",onClick:()=>r(e.id),children:[c.jsxs("td",{className:"px-4 py-4",children:[c.jsx("div",{className:"font-medium text-white",children:e.sourceName||"Khng Tn"}),c.jsxs("div",{className:"text-xs text-white/60",children:["Tng n: ",e.totalOrders]})]}),c.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[c.jsx("div",{children:e.numberBank||"--"}),c.jsx("div",{className:"text-xs text-white/50",children:e.bankName})]}),c.jsxs("td",{className:"px-4 py-4 text-white/80 text-sm",children:[c.jsxs("div",{children:[e.monthlyOrders," n"]}),c.jsx("div",{className:"text-xs text-emerald-400",children:s0(e.monthlyImportValue)})]}),c.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:OZ(e.lastOrderDate)}),c.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:s0(e.totalPaidImport)}),c.jsx("td",{className:"px-4 py-4 font-bold text-orange-400 text-sm",children:s0(Math.min(0,e.totalUnpaidImport||0))}),c.jsx("td",{className:"px-4 py-4 text-white/80 text-sm",children:s0(Math.max(0,e.totalUnpaidImport||0))}),c.jsx("td",{className:"px-4 py-4 text-center",children:c.jsx("button",{onClick:l=>{l.stopPropagation(),s(e)},className:`w-8 h-8 rounded-full flex items-center justify-center transition ${e.isActive?"bg-emerald-500 text-white":"bg-gray-600 text-gray-300"}`,children:c.jsx(o4,{className:"h-4 w-4"})})}),c.jsx("td",{className:"px-4 py-4 text-right",children:c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:l=>{l.stopPropagation(),i(e)},className:"p-1 text-blue-400 hover:text-blue-300",children:c.jsx(ud,{className:"h-5 w-5"})}),c.jsx("button",{onClick:l=>{l.stopPropagation(),n(e)},className:"p-1 text-green-400 hover:text-green-300",children:c.jsx($h,{className:"h-5 w-5"})}),c.jsx("button",{onClick:l=>{l.stopPropagation(),a(e)},className:"p-1 text-rose-400 hover:text-rose-300",children:c.jsx(qs,{className:"h-5 w-5"})})]})})]}),t&&c.jsx("tr",{children:c.jsx("td",{colSpan:8,className:"px-0 pb-4 pt-0 bg-indigo-950/30",children:c.jsx("div",{className:"p-4 border-b border-white/10 shadow-inner",children:c.jsx(jZ,{supplyId:e.id})})})})]}),IZ=(e,t)=>{const[r,n]=v.useState(!1),[a,i]=v.useState(null),[s,l]=v.useState(null),d=v.useCallback(async()=>{if(e){n(!0),i(null);try{const h=await Ct(`/api/supplies/${e}/overview`),f=await h.json();if(!h.ok)throw new Error(f?.error||"Khng ti c chi tit");l(f)}catch(h){i(h?.message||" c li xy ra")}finally{n(!1)}}},[e]);return v.useEffect(()=>{t&&e?d():t||(l(null),i(null))},[t,e,d]),{overview:s,loading:r,error:a,fetchOverview:d,setError:i}},FZ=({supply:e,fetchOverview:t,onRefreshList:r})=>{const[n,a]=v.useState(null),[i,s]=v.useState(null);return{confirmingId:n,qrPayment:i,confirmPayment:async h=>{a(h);try{const f=await Ct(`/api/payment-supply/${h}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!f.ok){const p=await f.json().catch(()=>({}));throw new Error(p?.error||"Khng th thanh ton chu k")}return await t(),s(null),r?.(),{success:!0}}catch(f){return{success:!1,error:f?.message||"Khng th thanh ton chu k"}}finally{a(null)}},showQrForPayment:h=>{const f=(h.totalImport||0)-(h.paid||0),p=Math.abs(f),x=f>0,g=(()=>{const S=new Date,T=String(S.getDate()).padStart(2,"0"),E=String(S.getMonth()+1).padStart(2,"0"),k=S.getFullYear();return`${T}/${E}/${k}`})(),b=x?e?.numberBank||"":"MAVPRE",_=x?e?.binBank||"":"970432",w=PZ({accountNumber:b,bankCode:_,amount:p,description:h.round||g});s({id:h.id,amount:p,url:w,round:h.round||""})},setQrPayment:s}},MZ=({payment:e,onClose:t})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4",onClick:t,children:c.jsxs("div",{className:"bg-slate-900 text-white rounded-2xl border border-white/10 shadow-2xl p-6 w-full max-w-sm",onClick:r=>r.stopPropagation(),children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"Chu k"}),c.jsx("p",{className:"text-lg font-bold",children:e.round||"QR thanh ton"})]}),c.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70",children:c.jsx(Hr,{className:"h-5 w-5"})})]}),e.url?c.jsx("img",{src:e.url,alt:"QR thanh ton",className:"rounded-lg border border-white/10 bg-white p-4 w-full"}):c.jsx("div",{className:"w-full aspect-square rounded-lg border border-dashed border-white/20 flex items-center justify-center text-white/60",children:"Thiu thng tin  to QR"}),c.jsx("p",{className:"text-xs text-white/60 text-center mt-3",children:"Qut QR  thanh ton s tin chu k."})]})}):null,LZ=({isOpen:e,onClose:t,supplyId:r,banks:n=[],onRefreshList:a})=>{const{overview:i,loading:s,error:l,fetchOverview:d,setError:h}=IZ(r,e),{confirmingId:f,qrPayment:p,confirmPayment:x,showQrForPayment:g,setQrPayment:b}=FZ({supply:i?.supply,fetchOverview:d,onRefreshList:a});if(!e||!r)return null;const _=i?.supply,w=i?.stats,S=i?.unpaidPayments||[],T=S.reduce((I,O)=>I+Math.max(0,(O.totalImport||0)-(O.paid||0)),0),E=w?.monthlyOrders||[],k=_?.isActive?"ang hot ng":"Tm dng",A=_?.isActive?"bg-emerald-500/20 text-emerald-200":"bg-gray-500/20 text-gray-200",j=_?.bankName||n.find(I=>(I.bin||"").trim()===(_?.binBank||"").trim())?.name||_?.binBank||"--",P=[{label:"Tng n",value:w?.totalOrders??0},{label:" thanh ton",value:w?.paidOrders??0},{label:"Cha thanh ton",value:w?.unpaidOrders??0},{label:" hy",value:w?.canceledOrders??0}],D=async I=>{const O=await x(I);O.success||h(O.error||"Khng th thanh ton chu k")},L=()=>{b(null),t()};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/60 p-4",onClick:L,children:c.jsxs("div",{className:"bg-slate-900 border border-white/20 p-6 rounded-2xl text-white w-full max-w-4xl max-h-[90vh] shadow-2xl overflow-y-auto",onClick:I=>I.stopPropagation(),children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm text-white/60",children:["Chi tit Supplier #",r]}),c.jsx("h2",{className:"text-2xl font-bold",children:_?.sourceName||"ang ti..."}),_&&c.jsx("span",{className:`inline-flex mt-2 px-3 py-1 rounded-full text-xs font-semibold ${A}`,children:k})]}),c.jsx("button",{onClick:L,className:"p-2 rounded-full hover:bg-white/10 transition text-white/70","aria-label":"ng",children:c.jsx(Hr,{className:"h-6 w-6"})})]}),s?c.jsx("div",{className:"mt-6 text-center text-white/70",children:"ang ti chi tit..."}):l?c.jsxs("div",{className:"mt-6 bg-rose-500/10 text-rose-200 border border-rose-500/40 rounded-xl p-4 flex items-center justify-between gap-3",children:[c.jsx("span",{children:l}),c.jsx("button",{onClick:d,className:"px-3 py-1 rounded-lg bg-rose-500 text-white text-sm hover:bg-rose-600",children:"Th li"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-6",children:[c.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[c.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Thng tin chung"}),c.jsxs("div",{className:"text-sm text-white/80 space-y-1",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-white/50",children:"Ngn hng: "}),j]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-white/50",children:"S ti khon: "}),_?.numberBank||"--"]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-white/50",children:"Trng thi: "}),k]})]})]}),c.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4 space-y-2",children:[c.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Tng quan thanh ton"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-white/80",children:[c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[c.jsx("p",{className:"text-white/50 text-xs",children:" thanh ton"}),c.jsx("p",{className:"text-lg font-semibold",children:Si(w?.totalPaidAmount||0)})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[c.jsx("p",{className:"text-white/50 text-xs",children:"Cn n"}),c.jsx("p",{className:"text-lg font-semibold text-orange-300",children:Si(T)})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[c.jsx("p",{className:"text-white/50 text-xs",children:"n cha thanh ton"}),c.jsx("p",{className:"text-lg font-semibold",children:w?.unpaidOrders??0})]}),c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[c.jsx("p",{className:"text-white/50 text-xs",children:"n  thanh ton"}),c.jsx("p",{className:"text-lg font-semibold",children:w?.paidOrders??0})]})]})]})]}),c.jsx("div",{className:"grid md:grid-cols-4 gap-3 mt-4",children:P.map(I=>c.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/5",children:[c.jsx("p",{className:"text-white/50 text-xs",children:I.label}),c.jsx("p",{className:"text-xl font-semibold",children:I.value})]},I.label))}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4",children:[c.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"Chu k cha thanh ton"}),c.jsxs("span",{className:"text-xs text-white/60",children:["Cn n ",Si(T)]})]}),S.length===0?c.jsx("p",{className:"text-white/50 text-sm",children:"Khng c chu k n."}):c.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:S.map(I=>c.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5 gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("p",{className:"font-semibold text-sm truncate",children:I.round||"Chu k"}),c.jsx("p",{className:"text-xs text-white/60",children:I.status})]}),c.jsxs("div",{className:"text-right text-sm",children:[c.jsxs("p",{children:["Nhp: ",Si(I.totalImport||0)]}),c.jsxs("p",{className:"text-white/60 text-xs",children:[" tr: ",Si(I.paid||0)]})]}),c.jsx("div",{className:"flex-shrink-0",children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:()=>g(I),className:"px-3 py-1.5 text-xs rounded-lg bg-indigo-500 text-white hover:bg-indigo-600",children:"Xem QR"}),c.jsx("button",{disabled:f===I.id,onClick:()=>D(I.id),className:"px-3 py-1.5 text-xs rounded-lg bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-60",children:f===I.id?"ang x l...":"Thanh ton"})]})})]},I.id))})]}),c.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-sm font-semibold text-white/80",children:"n theo thng"}),c.jsxs("span",{className:"text-xs text-white/60",children:[E.length," thng"]})]}),E.length===0?c.jsx("p",{className:"text-white/50 text-sm",children:"Cha c d liu."}):c.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto custom-scroll scroll-overlay",children:E.map(I=>c.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-lg px-3 py-2 border border-white/5",children:[c.jsxs("span",{className:"text-sm font-semibold",children:["Thng ",I.month]}),c.jsxs("span",{className:"text-sm",children:[I.orders," n"]})]},I.month))})]})]}),c.jsx("div",{className:"mt-6 text-right",children:c.jsx("button",{onClick:L,className:"px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white",children:"ng"})})]})]})}),c.jsx(MZ,{payment:p,onClose:()=>b(null)})]})},BZ=()=>{const[e,t]=v.useState([]),[r,n]=v.useState({totalSuppliers:0,activeSuppliers:0,monthlyOrders:0,totalImportValue:0}),[a,i]=v.useState(!1),[s,l]=v.useState(null),d=v.useCallback(async()=>{i(!0);try{const f=await Ct("/api/supply-insights");if(!f.ok)throw new Error("Li ti d liu");const p=await f.json(),x=(p.supplies||[]).map(g=>{const b=g.isActive??(g.status!=="inactive"&&g.status!=="tam dung");return{...g,isActive:b,status:b?"active":"inactive",products:Array.isArray(g.products)?g.products.filter(Boolean):[]}});t(x),n({totalSuppliers:Number(p.stats?.totalSuppliers)||0,activeSuppliers:Number(p.stats?.activeSuppliers)||x.filter(g=>g.isActive).length,monthlyOrders:Number(p.stats?.monthlyOrders)||0,totalImportValue:Number(p.stats?.totalImportValue)||0})}catch(f){l(f instanceof Error?f.message:"Li khng xc nh")}finally{i(!1)}},[]);return{supplies:e,stats:r,loading:a,error:s,fetchSupplies:d,setSupplies:t,toggleStatus:async(f,p)=>{t(x=>x.map(g=>g.id===f?{...g,isActive:!p,status:p?"inactive":"active"}:g));try{await Ct(`/api/supplies/${f}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!p})})}catch{t(x=>x.map(g=>g.id===f?{...g,isActive:p,status:p?"active":"inactive"}:g)),alert("Khng th cp nht trng thi")}}}},$Z=({isOpen:e,onClose:t,onSuccess:r,banks:n})=>{const[a,i]=v.useState({sourceName:"",numberBank:"",bankBin:"",status:"active"}),[s,l]=v.useState(!1),[d,h]=v.useState(null);if(v.useEffect(()=>{e&&n.length>0&&!a.bankBin&&i(p=>({...p,bankBin:n[0].bin}))},[e,n,a.bankBin]),!e)return null;const f=async p=>{if(p.preventDefault(),!a.sourceName.trim())return h("Tn khng c  trng");l(!0),h(null);try{const x=await Ct("/api/supplies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_name:a.sourceName,number_bank:a.numberBank,bin_bank:a.bankBin,status:a.status})});if(!x.ok)throw new Error((await x.json()).error||"Li khi to");r(),t(),i({sourceName:"",numberBank:"",bankBin:n[0]?.bin||"",status:"active"})}catch(x){h(x instanceof Error?x.message:"Li to nh cung cp")}finally{l(!1)}};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-md p-6",onClick:p=>p.stopPropagation(),children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Thm Nh Cung Cp Mi"}),d&&c.jsx("p",{className:"text-sm text-red-600 mb-3",children:d}),c.jsxs("form",{onSubmit:f,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tn Nh Cung Cp"}),c.jsx("input",{className:"w-full border rounded-lg p-2 mt-1 focus:ring-2 focus:ring-blue-500",value:a.sourceName,onChange:p=>i({...a,sourceName:p.target.value}),placeholder:"Nhp tn..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"S Ti Khon"}),c.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:a.numberBank,onChange:p=>i({...a,numberBank:p.target.value}),placeholder:"STK..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngn Hng"}),c.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:a.bankBin,onChange:p=>i({...a,bankBin:p.target.value}),children:n.map(p=>c.jsx("option",{value:p.bin,children:p.name||p.bin},p.bin))})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),c.jsx("button",{type:"submit",disabled:s,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:s?"ang x l...":"Thm Mi"})]})]})]})})},UZ=({isOpen:e,onClose:t,onSuccess:r,supply:n,banks:a})=>{const[i,s]=v.useState({sourceName:"",numberBank:"",bankBin:""}),[l,d]=v.useState(!1),[h,f]=v.useState(null);if(v.useEffect(()=>{n&&s({sourceName:n.sourceName||"",numberBank:n.numberBank||"",bankBin:n.binBank||a[0]?.bin||""})},[n,a]),!e||!n)return null;const p=async x=>{x.preventDefault(),d(!0);try{if(!(await Ct(`/api/supplies/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_name:i.sourceName,number_bank:i.numberBank,bin_bank:i.bankBin})})).ok)throw new Error("Li cp nht");r(),t()}catch(g){f(g instanceof Error?g.message:"Li cp nht")}finally{d(!1)}};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:t,children:c.jsxs("div",{className:"w-full max-w-lg bg-white rounded-2xl p-6 shadow-2xl",onClick:x=>x.stopPropagation(),children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Chnh Sa Thng Tin"}),c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tn Nh Cung Cp"}),c.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.sourceName,onChange:x=>s({...i,sourceName:x.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"S Ti Khon"}),c.jsx("input",{className:"w-full border rounded-lg p-2 mt-1",value:i.numberBank,onChange:x=>s({...i,numberBank:x.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Ngn Hng"}),c.jsx("select",{className:"w-full border rounded-lg p-2 mt-1",value:i.bankBin,onChange:x=>s({...i,bankBin:x.target.value}),children:a.map(x=>c.jsx("option",{value:x.bin,children:x.name||x.bin},x.bin))})]}),h&&c.jsx("p",{className:"text-sm text-red-500",children:h}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Hy"}),c.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Lu Thay i"})]})]})]})})},zZ=({isOpen:e,onClose:t,onConfirm:r,supplyName:n})=>e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full shadow-2xl",children:[c.jsx("h3",{className:"text-lg font-bold text-rose-600 mb-2",children:"Xa Nh Cung Cp?"}),c.jsxs("p",{className:"text-gray-600 mb-6",children:["Bn c chc mun xa ",c.jsx("b",{children:n}),"? Hnh ng ny khng th hon tc."]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:"Hy"}),c.jsx("button",{onClick:r,className:"px-4 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700",children:"Xa Vnh Vin"})]})]})}):null;function WZ(){const{supplies:e,stats:t,loading:r,fetchSupplies:n,setSupplies:a,toggleStatus:i}=BZ(),[s,l]=v.useState(""),[d,h]=v.useState("all"),[f,p]=v.useState([]),[x,g]=v.useState(null),[b,_]=v.useState(!1),[w,S]=v.useState(null),[T,E]=v.useState(null),[k,A]=v.useState(null);v.useEffect(()=>{n(),Ct("/api/banks").then(D=>D.json()).then(D=>{Array.isArray(D)&&p(D.map(L=>({bin:L.bin,name:L.bank_name||L.bankName||L.name||L.bank||L.bin})))}).catch(console.error)},[n]);const j=v.useMemo(()=>{const D=VC(s),L=e.filter(O=>{const M=!D||VC(O.sourceName).includes(D),re=d==="all"||(d==="active"?O.isActive:!O.isActive);return M&&re}),I=O=>{if(!O)return 0;const M=new Date(O).getTime();return Number.isFinite(M)?M:0};return L.sort((O,M)=>{const re=Number(O.totalUnpaidImport)||0,oe=Number(M.totalUnpaidImport)||0,ee=re>0,fe=oe>0;if(ee!==fe)return ee?-1:1;const J=re<0,ie=oe<0;if(J!==ie)return J?-1:1;if((ee||J)&&re!==oe)return oe-re;const Q=I(O.lastOrderDate),te=I(M.lastOrderDate),H=Q>0,se=te>0;if(H!==se)return H?-1:1;if(Q!==te)return te-Q;const Y=(M.totalOrders||0)-(O.totalOrders||0);return Y!==0?Y:O.sourceName.localeCompare(M.sourceName)})},[e,s,d]),P=async()=>{if(k){const D=await kZ(k.id);D.success?(a(L=>L.filter(I=>I.id!==k.id)),A(null)):alert(D.message)}};return c.jsxs("div",{className:"space-y-6 pb-20",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"Qun L Ngun Hng"}),c.jsx("p",{className:"text-white/60 text-sm",children:"Theo di cng n v chu k thanh ton"})]}),c.jsx(Ci,{icon:Ai,onClick:()=>_(!0),children:"Thm NCC"})]}),c.jsx(AZ,{stats:t}),c.jsxs("div",{className:"bg-white/5 border border-white/10 p-4 rounded-2xl flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(il,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-white/40"}),c.jsx("input",{className:"w-full bg-black/20 border border-white/10 rounded-xl py-2 pl-10 text-white focus:outline-none focus:border-indigo-500",placeholder:"Tm kim...",value:s,onChange:D=>l(D.target.value)})]}),c.jsxs("select",{className:"bg-black/20 border border-white/10 rounded-xl px-4 py-2 text-white focus:outline-none",value:d,onChange:D=>h(D.target.value),children:[c.jsx("option",{value:"all",children:"Tt c trng thi"}),c.jsx("option",{value:"active",children:"ang hot ng"}),c.jsx("option",{value:"inactive",children:"Tm dng"})]})]}),c.jsx(DZ,{supplies:j,loading:r,expandedId:x,onToggle:D=>g(L=>L===D?null:D),onEdit:S,onDelete:A,onView:D=>E(D.id),onToggleStatus:D=>i(D.id,D.isActive)}),c.jsx($Z,{isOpen:b,onClose:()=>_(!1),onSuccess:n,banks:f}),c.jsx(UZ,{isOpen:!!w,onClose:()=>S(null),onSuccess:n,supply:w,banks:f}),c.jsx(zZ,{isOpen:!!k,onClose:()=>A(null),onConfirm:P,supplyName:k?.sourceName}),c.jsx(LZ,{isOpen:!!T,onClose:()=>E(null),supplyId:T,banks:f,onRefreshList:n})]})}const xv=e=>e.toLocaleString("vi-VN"),Oo=e=>{const t=Number(e);return Number.isFinite(t)?t:0},o0=e=>(e||"").trim().toLowerCase(),l0=e=>{const t=(e||"").trim();return t?t.replace(/--\s*\d+\s*[md]\s*$/i,"").trim():""},Hl=e=>(e||"").trim().toLowerCase(),gv=e=>{const t=Number(e);return Number.isFinite(t)?t:0},HZ=e=>{const t=gv(e?.price),r=gv(e?.resellPrice),n=gv(e?.promoPrice);return{price:t||r||n||0,promoPrice:n||0,resellPrice:r||void 0}},KZ=e=>{if(!e)return{months:null,days:null};const t=e.match(/--\s*(\d+)\s*([md])\b/i)||e.match(/(\d+)\s*([md])\b/i);if(!t||!t[1])return{months:null,days:null};const r=Number(t[1]);if(!Number.isFinite(r))return{months:null,days:null};const n=(t[2]||"").toLowerCase();return n==="d"?{months:null,days:r}:n==="m"?{months:r,days:null}:{months:null,days:null}},VZ=(e,t)=>{if(e){const h=si(e.price||0),f=e.promoPrice>0?si(e.promoPrice):0;return{unitPrice:h,discount:f}}const r=t?.basePrice??t?.unitPrice??0,n=t?.pctPromo!==void 0?Oo(t.pctPromo):0,a=n>1?n/100:Math.max(0,n),i=t?.pctKhach!==void 0&&t?.pctKhach>0?t.pctKhach:1,s=t?.pctCtv!==void 0&&t?.pctCtv>0?t.pctCtv:1,l=si(r*i*s),d=a>0?si(l*a):0;return{unitPrice:l,discount:d}},YC=e=>{if(!e)return"";try{const r=new DOMParser().parseFromString(e,"text/html"),n=new Set(["DIV","P","BR","LI","UL","OL","SECTION"]),a=[],i=(l,d)=>{if(l.nodeType===Node.TEXT_NODE){d.push((l.textContent||"").replace(/\u00a0/g," "));return}if(l.nodeType===Node.ELEMENT_NODE){const h=l;if(h.tagName==="BR"){d.push(`
`);return}const f=[];h.childNodes.forEach(x=>i(x,f));const p=f.join("");d.push(p),n.has(h.tagName)&&d.push(`
`)}},s=[];return r.body.childNodes.forEach(l=>i(l,s)),s.join("").replace(/\u00a0/g," ").replace(/\n{3,}/g,`

`).replace(/[ \t]+\n/g,`
`).trim()}catch{return e||""}},GZ=e=>{if(!e)return"";const[t,r,n]=e.split("-");return!t||!r||!n?e:`${n}/${r}/${t}`},YZ=(e,t)=>{const r=new Set,n=[];return e.forEach(a=>{const s=(a?.[Cr.product]||a?.san_pham||"").trim();if(!s)return;const l=s.toLowerCase();if(r.has(l))return;r.add(l);const d=KZ(s),h=Oo(a?.pct_khach??a?.[Cr.pctKhach]),f=Oo(a?.pct_ctv??a?.[Cr.pctCtv]),p=h>10?h/100:h>0?h:1,x=f>10?f/100:f>0?f:1,g=Oo(a?.pct_promo??a?.[Cr.pctPromo]),b=g>1?g/100:Math.max(0,g),_=Oo(a?.max_supply_price),w=Oo(a?.computed_retail_price??a?.retail_price??a?.gia_le??a?.gia_ban)||0,S=Oo(a?.computed_promo_price??a?.promo_price??a?.gia_khuyen_mai??a?.gia_km)||0,T=_>0?si(_):0,k=(w||S||T)*(x>0?x:1)*(p>0?p:1),A=si(k),j=A*(1-b),P=si(j),D=Math.min(A,T>0?Math.max(T,P):P),L=D>0?A-D:0,I=a?.[Cr.packageProduct]||a?.package_product||a?.package_product_label||"",O=I?`${I} (${s})`:a?.package?`${a?.package} (${s})`:s,M=Hl(s),re=t[M];n.push({productId:s,value:s,productDisplay:a?.package||s,packageDisplay:I||a?.package||s,label:O,durationMonths:d.months,durationDays:d.days,term:d.days?`${d.days} ngay`:"",unitPrice:A,discountValue:L,basePrice:re?.price??re?.resellPrice??w??A,promoPrice:re?.promoPrice??0,pctPromo:b,pctKhach:p,pctCtv:x,wholesalePrice:T})}),n.sort((a,i)=>a.label.localeCompare(i.label,"vi"))},Bl="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",XZ=({recipient:e,onRecipientChange:t,quoteDate:r,onQuoteDateChange:n,quoteCode:a,contact:i,onContactChange:s,productSearch:l,onProductSearchChange:d,filteredOptions:h,selectedProductKeys:f,onToggleProduct:p,onAddSelectedProduct:x,onResetSearch:g,lines:b,onRemoveLine:_,onDownload:w})=>c.jsxs("div",{className:"no-print rounded-2xl bg-white/5 border border-white/10 shadow-lg shadow-indigo-900/30",children:[c.jsx("div",{className:"border-b border-white/10 px-6 py-4",children:c.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thong tin bao gia"})}),c.jsxs("div",{className:"px-6 py-5 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-white",children:"Kinh gui"}),c.jsx("input",{type:"text",value:e,onChange:S=>t(S.target.value),className:Bl})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-white",children:"Ngay"}),c.jsx("input",{type:"date",value:r,onChange:S=>n(S.target.value),className:Bl})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-white",children:"Ma bao gia"}),c.jsx("input",{value:a,readOnly:!0,className:`${Bl} opacity-80`})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-white",children:"Lien he"}),c.jsx("input",{type:"text",value:i,onChange:S=>s(S.target.value),className:Bl,placeholder:"Email / SDT"})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-white",children:"Ghi chu (tuy chon)"}),c.jsx("input",{type:"text",className:Bl,placeholder:"Thong tin them cho bao gia"})]})]}),c.jsxs("div",{className:"border border-white/15 rounded-lg p-3 space-y-2",children:[c.jsx("label",{className:"text-sm font-semibold text-white block",children:"Ma san pham"}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[c.jsx("input",{type:"text",value:l,onChange:S=>d(S.target.value),className:`${Bl} text-sm`,placeholder:"Tim san pham..."}),c.jsx("button",{type:"button",onClick:g,className:"px-3 py-2 text-sm rounded-lg border border-white/20 bg-white/5 text-white hover:border-white/40 transition-colors",children:"Xoa Tim Kiem"})]}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-52 overflow-y-auto rounded-lg border border-white/20 bg-white/5 p-2",children:h.map(S=>{const T=f.includes(S.value);return c.jsx("button",{type:"button",onClick:()=>p(S.value),className:`text-left rounded-md border px-3 py-2 text-sm transition-colors ${T?"border-blue-400/80 bg-blue-500/20 text-white":"border-white/10 bg-white/5 hover:border-white/30 text-white/90"}`,title:S.label,children:S.label},S.value)})}),c.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[c.jsx("button",{type:"button",onClick:x,className:"rounded bg-blue-600/80 hover:bg-blue-600 text-white px-3 py-2 text-sm disabled:opacity-60",disabled:!f.length,children:"Them"}),c.jsx("button",{type:"button",onClick:w,className:"rounded bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm",children:"Download PDF"})]}),b.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:b.map(S=>c.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1.5 text-white text-sm",children:[S.product,c.jsx("button",{type:"button",onClick:()=>_(S.id),className:"text-red-300 hover:text-red-200 font-semibold",title:"Xoa",children:"x"})]},S.id))})]})]})]}),qZ=({rows:e})=>c.jsxs("table",{className:"w-full text-sm border-t border-b border-slate-600 text-white print:text-black",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"text-center bg-indigo-100 text-slate-900 font-semibold",children:[c.jsx("th",{className:"border border-slate-600 py-2 w-12",children:"STT"}),c.jsx("th",{className:"border border-slate-600 py-2 px-2 whitespace-nowrap",children:"TEN SAN PHAM"}),c.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"GOI"}),c.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"THOI GIAN"}),c.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"DON GIA"}),c.jsx("th",{className:"border border-slate-600 py-2 w-28",children:"GIAM GIA"}),c.jsx("th",{className:"border border-slate-600 py-2 w-32",children:"THANH TIEN"}),c.jsx("th",{className:"border border-slate-600 py-2 w-36",children:"GHI CHU"})]})}),c.jsx("tbody",{children:e.map((t,r)=>c.jsxs("tr",{className:"align-top",children:[c.jsx("td",{className:"border border-slate-600 text-center py-2",children:r+1}),c.jsx("td",{className:"border border-slate-600 px-2 py-2 text-center text-white print:text-black",title:t.product,children:t.product}),c.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.packageName||t.term}),c.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:t.durationMonths?`${t.durationMonths} thang`:t.durationDays?`${t.durationDays} ngay`:t.term||"--"}),c.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:xv(t.unitPrice)}),c.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:xv(t.discount||0)}),c.jsx("td",{className:"border border-slate-600 text-center px-2 py-2 text-white print:text-black",children:xv(t.total)}),c.jsx("td",{className:"border border-slate-600 px-2 py-2 text-sm text-white print:text-black",children:t.note||""})]},t.id))})]}),QZ=({sections:e})=>{const t=c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Quy Tac"}),c.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chua cap nhat."}),c.jsx("p",{className:"font-semibold mt-3",children:"Thong tin san pham"}),c.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:"Chua cap nhat."})]});return c.jsxs("div",{className:"px-6 py-4 text-sm leading-6 border-b border-slate-600 space-y-4 text-white/90 print:text-black",children:[e.length===0?t:e.map(r=>c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-semibold",children:r.name}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Quy Tac"}),c.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.rules||"Chua cap nhat."})]}),c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Thong tin san pham"}),c.jsx("div",{className:"mt-1 whitespace-pre-wrap break-words",children:r.description||"Chua cap nhat."})]})]},r.name)),c.jsxs("div",{className:"pt-2 text-sm",children:[c.jsx("p",{className:"font-semibold",children:"Moi thong tin chi tiet co the lien he:"}),c.jsxs("div",{className:"mt-1 whitespace-pre-wrap",children:["- Fanpage: Mavryk - Tai Khoan Premium",`
`,"- Zalo: 0378.304.963",`
`,"- Telegram: @hung_culi"]})]})]})},ZZ="/assets/sign-DzA7EGyE.png",JZ=()=>c.jsx("div",{className:"flex justify-center px-6 py-8 text-sm text-white print:text-black",children:c.jsxs("div",{className:"px-6 py-4 space-y-2 min-w-[280px] max-w-md text-center",children:[c.jsx("p",{className:"font-semibold underline underline-offset-2",children:"Mavryk Premium Store"}),c.jsx("p",{className:"text-[12px] italic text-white/80 print:text-black",children:"(Ky, ghi ro ho ten)"}),c.jsx("div",{className:"min-h-[110px] flex items-center justify-center",children:c.jsx("img",{src:ZZ,alt:"Chu ky",className:"max-h-[110px] max-w-[260px]",style:{objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none"}})})]})}),eJ={};var tJ={};const rJ="/mavryk-logo.png",XC=typeof import.meta<"u"&&eJ?.VITE_API_BASE_URL||tJ.VITE_API_BASE_URL||"http://localhost:3001";function nJ(){v.useEffect(()=>{const ee=document.title;return document.title="Mavryk Premium Store",()=>{document.title=ee}},[]);const[e,t]=v.useState(new Date().toISOString().slice(0,10)),[r,n]=v.useState("Ms. Diu Nguyen"),[a,i]=v.useState(""),[s,l]=v.useState([]),[d,h]=v.useState([]),[f,p]=v.useState(""),[x,g]=v.useState({}),b=v.useRef({}),[_,w]=v.useState([]),[S,T]=v.useState([]),E=v.useMemo(()=>{const ee=S.map(J=>({...J,total:(J.unitPrice-(J.discount||0))*J.quantity})),fe=ee.reduce((J,ie)=>J+ie.total,0);return{rows:ee,grandTotal:fe}},[S]);v.useEffect(()=>{let ee=!0;return(async()=>{try{const ie=await fetch(`${XC}${kt.PRODUCT_PRICES}`,{credentials:"include"});if(!ie.ok)throw new Error("Failed to load product_price");const Q=await ie.json();if(!ee)return;Array.isArray(Q)?l(Q):Q?.items&&Array.isArray(Q.items)?l(Q.items):l([])}catch(ie){console.error("Khong the tai product_price:",ie)}})(),(async()=>{try{const ie=await fetch(`${XC}${kt.PRODUCT_DESCRIPTIONS}`,{credentials:"include"});if(!ie.ok)throw new Error("Failed to load product_desc");const Q=await ie.json();ee&&Q?.items&&Array.isArray(Q.items)&&h(Q.items.map(te=>({productId:te.productId||te.product_id||"",rules:te.rules??"",description:te.description??""})))}catch(ie){console.error("Khong the tai product_desc:",ie)}})(),()=>{ee=!1}},[]);const k=v.useCallback(async ee=>{const fe=ee.map(te=>({original:te,key:Hl(te)})).filter(te=>te.key);if(!fe.length)return x;const J=fe.filter(te=>!x[te.key]);if(!J.length)return x;const ie={},Q=[];return J.forEach(({original:te,key:H})=>{if(b.current[H]){Q.push(b.current[H].then(Y=>{Y&&(ie[H]=Y)}));return}const se=(async()=>{try{const Y=await Ct(kt.CALCULATE_PRICE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({san_pham_name:te,id_product:te,customer_type:"LE",for_quote:!0})}),ce=await Y.json().catch(()=>null);if(!Y.ok)throw new Error(ce?.error||"Fail calculate-price");return HZ(ce)}catch(Y){return console.error("calculate-price failed",te,Y),null}})();b.current[H]=se,Q.push(se.then(Y=>{Y&&(ie[H]=Y)}).finally(()=>{delete b.current[H]}))}),Q.length&&await Promise.all(Q),Object.keys(ie).length?(g(te=>({...te,...ie})),{...x,...ie}):x},[x]),A=v.useMemo(()=>YZ(s,x),[s,x]),j=v.useMemo(()=>{const ee=new Map;return A.forEach(fe=>{ee.set(Hl(fe.value),fe)}),ee},[A]),P=v.useMemo(()=>{const ee=new Map;return s.forEach(fe=>{const J=fe?.[Cr.product]||fe?.san_pham||"",ie=fe?.[Cr.packageProduct]||fe?.package_product||fe?.package_product_label||"",Q=o0(l0(J));Q&&ie&&ee.set(Q,ie)}),ee},[s]),D=v.useMemo(()=>{const ee=new Map;return d.forEach(fe=>{const J=o0(l0(fe.productId));J&&ee.set(J,fe)}),ee},[d]),L=v.useMemo(()=>{const ee=f.trim().toLowerCase();return ee?A.filter(fe=>{const J=fe.label.toLowerCase(),ie=fe.value.toLowerCase(),Q=fe.productDisplay.toLowerCase();return J.includes(ee)||ie.includes(ee)||Q.includes(ee)}):A},[A,f]),I=v.useMemo(()=>{const ee=new Set,fe=[];return S.forEach(J=>{const ie=J.productCode||J.product||"",Q=o0(l0(ie));if(!Q||ee.has(Q))return;ee.add(Q);const te=D.get(Q),H=P.get(Q)||J.packageName||J.product;fe.push({name:H,rules:YC(te?.rules),description:YC(te?.description)})}),fe},[S,D,P]),O=async()=>{if(!_.length)return;const ee=_.map(J=>J.trim()).filter(Boolean);if(!ee.length)return;const fe=await k(ee);T(J=>{const ie=[...J];return ee.forEach(Q=>{const te=j.get(Hl(Q))??j.get(Hl(Q.normalize("NFD").replace(/[\u0300-\u036f]/g,""))),H=(ie.length+1).toString(),se=te?.durationDays?`${te.durationDays} ngay`:te?.term||"",Y=Hl(Q),ce=fe[Y],{unitPrice:ue,discount:me}=VZ(ce,te||{});ie.push({id:H,productCode:Q,product:te?.productDisplay||Q,packageName:te?.packageDisplay||P.get(o0(l0(Q)))||"",term:se,durationMonths:te?.durationMonths??null,durationDays:te?.durationDays??null,unitPrice:ue,quantity:1,discount:me})}),ie}),w([])},M=ee=>T(fe=>fe.filter(J=>J.id!==ee)),re=`BG-${(e||"").replaceAll("-","")||"----"}`;return c.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[c.jsx("style",{children:`
    /* Hide scrollbars while keeping scroll functionality */
    body {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    body::-webkit-scrollbar {
      display: none;
    }

    @media print {
      /* Hide everything except the printable quote */
      body { background: white !important; margin: 0 !important; padding: 0 !important; }
      body * { visibility: hidden !important; }
      #quote-print-area,
      #quote-print-area * { visibility: visible !important; }
      #quote-print-area {
        position: absolute;
        left: 0;
        top: 0;
        box-shadow: none !important;
        border: none !important;
      }
      .no-print { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
    }
  `}),c.jsx(XZ,{recipient:r,onRecipientChange:n,quoteDate:e,onQuoteDateChange:t,quoteCode:re,contact:a,onContactChange:i,productSearch:f,onProductSearchChange:p,filteredOptions:L,selectedProductKeys:_,onToggleProduct:ee=>w(fe=>fe.includes(ee)?fe.filter(J=>J!==ee):[...fe,ee]),onAddSelectedProduct:O,onResetSearch:()=>p(""),lines:S,onRemoveLine:M,onDownload:()=>window.print()}),c.jsx("div",{className:"print-wrapper flex justify-center",children:c.jsx("div",{id:"quote-print-area",className:"bg-white text-slate-900 print-target",style:{width:"210mm",minHeight:"297mm",padding:"12mm 10mm",fontSize:"18px"},children:c.jsxs("div",{children:[c.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 pt-2 pb-2",children:[c.jsx("div",{className:"relative flex items-center justify-center",style:{maxWidth:"140px",maxHeight:"90px"},children:c.jsx("img",{src:rJ,alt:"Mavryk Logo",className:"max-w-full max-h-full",style:{objectFit:"contain",mixBlendMode:"screen"},onError:ee=>{ee.currentTarget.style.display="none"}})}),c.jsx("div",{className:"text-sm leading-6 text-white print:text-black flex items-center justify-center text-center",children:c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold",children:"Mavryk Premium Store"}),c.jsx("p",{children:"SDT: 0378.304.963"}),c.jsx("p",{children:"Web: mavrykpremium.store"})]})})]}),c.jsx("div",{className:"text-center text-[20px] font-bold bg-indigo-100 text-indigo-900 py-3 tracking-wide uppercase",children:"BANG BAO GIA"}),c.jsxs("div",{className:"px-6 py-4 text-sm leading-6 text-white/90 print:text-slate-800 space-y-1",children:[c.jsxs("p",{children:["Ngay: ",c.jsx("strong",{children:GZ(e)||"..."})]}),c.jsxs("p",{children:["Kinh gui: ",c.jsx("strong",{children:r})]}),a?c.jsxs("p",{children:["Thong tin lien he: ",c.jsx("strong",{children:a})]}):null,c.jsx("p",{className:"mt-3 italic",children:"Loi mo dau, xin cam on quy khach hang da quan tam den san pham cua chung toi. Chung toi xin gui den quy khach bang bao gia chi tiet nhu sau:"})]}),c.jsx(qZ,{rows:E.rows}),c.jsx(QZ,{sections:I}),c.jsx(JZ,{})]})})})]})}const aJ=({form:e,invoiceCodes:t,onChange:r,onAddInvoiceCode:n,onRemoveInvoiceCode:a,onSubmit:i})=>{const s=v.useId(),[l,d]=v.useState(null),h="w-full rounded-lg border border-white/20 bg-white/5 text-white placeholder:text-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",f="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm shadow-sm shadow-indigo-900/40 flex flex-wrap items-center gap-2 min-h-[48px]",p="w-full rounded-lg border border-white/20 bg-white/5 text-white px-3 py-2 text-sm focus-within:ring-2 focus-within:ring-blue-400/60 focus-within:border-blue-400/60 flex items-center relative overflow-hidden",x=g=>{g.key==="Enter"&&(g.preventDefault(),n())};return c.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-hidden",children:[c.jsx("div",{className:"border-b border-slate-200 px-6 py-4",children:c.jsx("h2",{className:"text-lg font-semibold text-white",children:"Thng tin ha n"})}),c.jsxs("form",{className:"px-6 py-5 space-y-4",onSubmit:i,children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{htmlFor:s,className:"text-sm font-medium text-slate-100",children:"Ha n"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:f,onMouseLeave:()=>d(null),children:t.map(g=>c.jsxs("button",{type:"button",onClick:()=>a(g.id),onMouseEnter:()=>d(g.id),onMouseLeave:()=>d(null),className:"relative inline-flex shrink-0 items-center gap-2 rounded-full bg-slate-900/70 px-3 py-1.5 text-white shadow-sm shadow-indigo-900/40 hover:bg-slate-800/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500/60","aria-label":`Xa ha n ${g.code}`,children:[c.jsx("span",{className:"pointer-events-none font-semibold text-sm",children:g.code}),c.jsx("span",{className:`inline-flex h-6 w-6 items-center justify-center rounded-full bg-white/10 text-white/80 transition-colors ${l===g.id?"bg-white/20 text-red-500":""}`,children:c.jsx(Hr,{className:"h-4 w-4"})})]},g.id))}),c.jsx("div",{className:p,children:c.jsx("input",{id:s,type:"text",onMouseEnter:()=>d(null),onFocus:()=>d(null),onBlur:()=>d(null),value:e.invoiceCode,onChange:g=>r("invoiceCode",g.target.value),onKeyDown:x,className:"w-full bg-transparent text-white placeholder:text-slate-300 focus:outline-none h-8 relative z-0",placeholder:"Nhp m ha n v nhn Enter"})})]})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Ngy"}),c.jsx("input",{type:"date",value:e.invoiceDate,onChange:g=>r("invoiceDate",g.target.value),className:h})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"M s thu"}),c.jsx("input",{type:"text",value:e.taxCode,onChange:g=>r("taxCode",g.target.value),className:h})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Khch hng / Cng ty"}),c.jsx("input",{type:"text",value:e.customerName,onChange:g=>r("customerName",g.target.value),className:h})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"Fax"}),c.jsx("input",{type:"text",value:e.fax,onChange:g=>r("fax",g.target.value),className:h})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"a ch"}),c.jsx("textarea",{value:e.address,onChange:g=>r("address",g.target.value),rows:2,className:`${h} resize-none`})]}),c.jsxs("label",{className:"space-y-1",children:[c.jsx("span",{className:"text-sm font-medium text-slate-100",children:"ST"}),c.jsx("input",{type:"text",value:e.phone,onChange:g=>r("phone",g.target.value),className:h})]})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-md shadow-blue-500/30 hover:bg-blue-700 transition",children:"Cp nht thng tin"})})]})]})};let qC=0;const iJ=e=>(qC+=1,{id:`inv-${Date.now().toString(36)}-${qC.toString(36)}`,code:e}),c0=e=>(e||"").trim().toLowerCase(),QC=e=>{if(!e)return null;const t=e.match(/--\s*(\d+)\s*m/i);if(t&&t[1]){const r=Number(t[1]);return Number.isFinite(r)?r:null}return null},sJ=e=>{const t=(e||"").trim().toUpperCase();return t.startsWith("MAVC")?"MAVC":t.startsWith("MAVL")?"MAVL":t.startsWith("MAVK")?"MAVK":t.startsWith("MAVT")?"MAVT":null},vv=e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:0},oJ=e=>{const t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;const r=t>1?t/100:t;return Math.min(Math.max(r,0),1)},$l={name:"MAVRYK PREMIUM",address:"Phan Vn Tr, Phng 11, Qun Bnh Thnh",phone:"(0378.304.963)",bank:"VP Bank",accountNumber:"9183400998",receiver:"Ng L Ngc Hng"},lJ={invoiceCode:"",invoiceDate:new Date().toISOString().slice(0,10),customerName:"",address:"",phone:"",fax:"",taxCode:""},yv="'Myriad Pro','Myriad','Segoe UI','Helvetica Neue',Arial,sans-serif",wv=e=>`${e.toLocaleString("vi-VN")} `,cJ=({form:e,invoiceLines:t,totals:r,dateDisplay:n,onDownload:a})=>{const i=`
    #invoice-preview,
    #invoice-preview * {
      font-family: ${yv};
    }
    @media print {
      @page { size: A4; margin: 0; }
      html, body { margin: 0; padding: 0; background: white !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .app-aurora { background: white !important; }
      .app-aurora .bg-white,
      .app-aurora .bg-white\\/90,
      .app-aurora .bg-white\\/80,
      .app-aurora .bg-white\\/70,
      .app-aurora .bg-white\\/60,
      .app-aurora .bg-gray-50 {
        background: white !important;
        box-shadow: none !important;
        border: 1px solid transparent !important;
        color: #111 !important;
      }
      .app-aurora input,
      .app-aurora textarea,
      .app-aurora select {
        background: white !important;
        color: #111 !important;
        border-color: #ccc !important;
      }
      .app-aurora > :not(.print-shell) { display: none !important; }
      .print-shell > :not(main) { display: none !important; }
      main > :not(.print-wrapper) { display: none !important; }
      .print-wrapper { margin: 0 !important; padding: 0 !important; }
      .print-wrapper > :not(.print-target) { display: none !important; }
      .print-target { display: block !important; }
      .print-hidden { display: none !important; }
      #invoice-print-area {
        display: block !important;
        margin: 0 auto !important;
        padding: 0 !important;
        width: 100% !important;
        background: white !important;
      }
      #invoice-preview {
        box-sizing: border-box !important;
        box-shadow: none !important;
        border: none !important;
        background: white !important;
        color: #111 !important;
        width: 100% !important;
        max-width: 210mm !important;
        margin: 0 auto !important;
        padding: 24px !important;
        page-break-inside: avoid !important;
      }
      #invoice-preview table th,
      #invoice-preview table td {
        color: #111 !important;
      }
      #invoice-preview,
      #invoice-preview * {
        font-family: ${yv} !important;
      }
    }
  `;return c.jsxs("div",{className:"rounded-2xl bg-white shadow-md border border-slate-200 print-target",children:[c.jsx("div",{className:"border-b border-slate-200 px-6 py-4 print-hidden",children:c.jsx("h2",{className:"text-lg font-semibold text-white",children:"Xem trc & ti v"})}),c.jsxs("div",{className:"p-6",children:[c.jsx("style",{children:i}),c.jsx("div",{id:"invoice-print-area",children:c.jsxs("div",{id:"invoice-preview",className:"mx-auto max-w-5xl border border-slate-300 bg-white shadow-sm px-10 py-10 text-white",style:{fontFamily:yv},children:[c.jsxs("div",{className:"text-center leading-7",children:[c.jsx("h1",{className:"text-2xl font-bold uppercase tracking-wide",children:$l.name}),c.jsxs("p",{children:["a ch: ",$l.address]}),c.jsxs("p",{children:["in thoi: ",$l.phone]}),c.jsxs("p",{children:["Ngn hng: ",$l.bank]}),c.jsxs("p",{children:["STK: ",$l.accountNumber]}),c.jsxs("p",{children:["Tn ngi nhn: ",$l.receiver]})]}),c.jsx("div",{className:"my-4 h-px bg-slate-300"}),c.jsxs("div",{className:"text-center space-y-2 leading-7",children:[c.jsx("h2",{className:"text-xl font-bold uppercase",children:"HA N BN HNG"}),c.jsx("div",{className:"text-sm",children:c.jsxs("p",{children:["Ngy: ",n]})})]}),c.jsxs("div",{className:"mt-6 space-y-1 text-sm leading-6 px-2",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Khch hng: "}),e.customerName||"---"]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"a ch: "}),e.address||"---"]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"SDT: "}),e.phone||"---",c.jsx("span",{className:"ml-6 font-semibold",children:"Fax: "}),e.fax||"---"]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"M s Thu: "}),e.taxCode||"---"]})]}),c.jsx("div",{className:"mt-8 px-2",children:c.jsx("div",{className:"overflow-hidden border border-slate-700 rounded-sm",children:c.jsxs("table",{className:"w-full border-collapse text-sm text-white leading-6",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-transparent text-white font-semibold",children:[c.jsx("th",{className:"border border-slate-700 px-3 py-2 text-left text-white",children:"Tn hng ha / Dch v"}),c.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"n gi"}),c.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"SL"}),c.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Chit khu"}),c.jsx("th",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:"Thnh tin"})]})}),c.jsx("tbody",{children:t.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:5,className:"border border-slate-700 px-3 py-3 text-center text-white/80",children:"Cha c m ha n no c chn."})}):t.map(s=>c.jsxs("tr",{children:[c.jsx("td",{className:"border border-slate-700 px-3 py-2 text-white",children:c.jsx("div",{className:"font-semibold",children:s.description})}),c.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:wv(s.unitPrice)}),c.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:s.quantity}),c.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:`${s.discountPct.toLocaleString("vi-VN",{maximumFractionDigits:2})} %`}),c.jsx("td",{className:"border border-slate-700 px-3 py-2 text-center text-white font-semibold",children:wv(s.total)})]},s.id))})]})})}),c.jsxs("div",{className:"mt-4 pr-4 text-right text-sm font-semibold",children:["Tng tin hng: ",wv(r.subtotal)]}),c.jsx("div",{className:"mt-8 text-center text-sm italic",children:"Cm n v hn gp li!"})]})}),c.jsx("div",{className:"mt-6 flex justify-center print-hidden",children:c.jsxs("button",{type:"button",onClick:a,className:"inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2.5 text-sm font-semibold text-white shadow-md shadow-emerald-500/30 hover:bg-emerald-700 transition",children:[c.jsx(KI,{className:"h-5 w-5"}),"Download PDF"]})})]})]})},uJ={};var dJ={};const ZC=typeof import.meta<"u"&&uJ?.VITE_API_BASE_URL||dJ.VITE_API_BASE_URL||"http://localhost:3001";function fJ(){v.useEffect(()=>{const T=document.title;return document.title="Mavryk Premium Store",()=>{document.title=T}},[]);const[e,t]=v.useState(lJ),[r,n]=v.useState([]),[a,i]=v.useState([]),[s,l]=v.useState([]);v.useEffect(()=>{let T=!0;const E=async()=>{try{const A=await fetch(`${ZC}${kt.ORDERS}`,{credentials:"include"});if(!A.ok)throw new Error("Failed to load orders");const j=await A.json();T&&Array.isArray(j)&&i(j)}catch(A){console.error("Khng th ti d liu order_list:",A)}},k=async()=>{try{const A=await fetch(`${ZC}${kt.PRODUCT_PRICES}`,{credentials:"include"});if(!A.ok)throw new Error("Khng th ti gi sn phm");const j=await A.json();T&&j?.items&&Array.isArray(j.items)&&l(j.items)}catch(A){console.error("Khng th ti d liu product_price:",A)}};return E(),k(),()=>{T=!1}},[]);const d=v.useMemo(()=>{const T=new Map;return a.forEach(E=>{const k=c0(E?.[or.idOrder]);k&&T.set(k,E)}),T},[a]),h=v.useMemo(()=>{const T=new Map;return s.forEach(E=>{const k=c0(E?.[Cr.product]);k&&T.set(k,E)}),T},[s]),f=v.useMemo(()=>r.map(T=>{const E=d.get(c0(T.code)),k=c0(E?.[or.idProduct]),A=h.get(k),j=sJ(E?.[or.idOrder]||T.code),P=QC(E?.[or.idProduct])||QC(A?.[Cr.product]),D=P?`${P} thng`:"",L=A?.[Cr.packageProduct]||A?.[Cr.package]||E?.[or.idProduct]||T.code,I=D?`${L} ${D}`:L,O=vv(A?.computed_wholesale_price)||vv(E?.[or.price]),M=vv(A?.computed_retail_price)||O;let re=M;j==="MAVC"?re=O:j==="MAVT"?re=0:j==="MAVL"||j==="MAVK"?re=M:re=M||O;const oe=j==="MAVK"?oJ(A?.[Cr.pctPromo]):0,ee=Number((oe*100).toFixed(2)),fe=1,J=Math.max(0,re*fe*(1-oe));return{id:T.id,code:T.code,description:I,unitPrice:re,quantity:fe,discountPct:ee,total:J}}),[r,d,h]),p=v.useMemo(()=>({subtotal:f.reduce((E,k)=>E+k.total,0)}),[f]),x=v.useMemo(()=>{if(!e.invoiceDate)return"..... thng ..... nm 20..";const T=new Date(e.invoiceDate);return Number.isNaN(T.getTime())?"..... thng ..... nm 20..":new Intl.DateTimeFormat("vi-VN").format(T)},[e.invoiceDate]),g=(T,E)=>{t(k=>({...k,[T]:E}))},b=()=>{const T=e.invoiceCode.trim();T&&(n(E=>E.some(k=>k.code===T)?E:[...E,iJ(T)]),t(E=>({...E,invoiceCode:""})))},_=T=>{n(E=>E.filter(k=>k.id!==T))},w=T=>{T.preventDefault()},S=()=>{window.print()};return c.jsxs("div",{className:"space-y-6 print-wrapper",children:[c.jsx(aJ,{form:e,invoiceCodes:r,onChange:g,onAddInvoiceCode:b,onRemoveInvoiceCode:_,onSubmit:w}),c.jsx(cJ,{form:e,invoiceLines:f,totals:p,dateDisplay:x,onDownload:S})]})}var vh={};vh.version="0.20.3";var qi=1200,td=function(e){qi=e};function hJ(){td(1200)}var u0=function(t){return String.fromCharCode(t)},JC=function(t){return String.fromCharCode(t)},Cn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yh(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),i=r>>2,n=e.charCodeAt(h++),s=(r&3)<<4|n>>4,a=e.charCodeAt(h++),l=(n&15)<<2|a>>6,d=a&63,isNaN(n)?l=d=64:isNaN(a)&&(d=64),t+=Cn.charAt(i)+Cn.charAt(s)+Cn.charAt(l)+Cn.charAt(d);return t}function pJ(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,d=0,h=0;h<e.length;)r=e.charCodeAt(h++),r>255&&(r=95),i=r>>2,n=e.charCodeAt(h++),n>255&&(n=95),s=(r&3)<<4|n>>4,a=e.charCodeAt(h++),a>255&&(a=95),l=(n&15)<<2|a>>6,d=a&63,isNaN(n)?l=d=64:isNaN(a)&&(d=64),t+=Cn.charAt(i)+Cn.charAt(s)+Cn.charAt(l)+Cn.charAt(d);return t}function mJ(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0,d=0,h=0;h<e.length;)r=e[h++],i=r>>2,n=e[h++],s=(r&3)<<4|n>>4,a=e[h++],l=(n&15)<<2|a>>6,d=a&63,isNaN(n)?l=d=64:isNaN(a)&&(d=64),t+=Cn.charAt(i)+Cn.charAt(s)+Cn.charAt(l)+Cn.charAt(d);return t}function ro(e){var t="",r=0,n=0,a=0,i=0,s=0,l=0,d=0;if(e.slice(0,5)=="data:"){var h=e.slice(0,1024).indexOf(";base64,");h>-1&&(e=e.slice(h+8))}e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)i=Cn.indexOf(e.charAt(h++)),s=Cn.indexOf(e.charAt(h++)),r=i<<2|s>>4,t+=String.fromCharCode(r),l=Cn.indexOf(e.charAt(h++)),n=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),d=Cn.indexOf(e.charAt(h++)),a=(l&3)<<6|d,d!==64&&(t+=String.fromCharCode(a));return t}var Bt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Di=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})(),wh=(function(){if(typeof Buffer>"u")return!1;var e=Di([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1})();function el(e){return Bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ek(e){return Bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wa=function(t){return Bt?Di(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function kp(e){if(typeof ArrayBuffer>"u")return wa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function tl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xJ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Dr=Bt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Di(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)a=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(wa(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function gJ(e){for(var t=[],r=0,n=e.length+250,a=el(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|l>>6&15|(s&3)<<4,a[r++]=128|l&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=el(65535),n=65530)}return t.push(a.slice(0,r)),Dr(t)}var Iu=/\u0000/g,d0=/[\u0001-\u0006]/g;function ql(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function li(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}function ub(e,t){var r=""+e;return r.length>=t?r:cr(" ",t-r.length)+r}function bh(e,t){var r=""+e;return r.length>=t?r:r+cr(" ",t-r.length)}function vJ(e,t){var r=""+Math.round(e);return r.length>=t?r:cr("0",t-r.length)+r}function yJ(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}var tk=Math.pow(2,32);function Ul(e,t){if(e>tk||e<-tk)return vJ(e,t);var r=Math.round(e);return yJ(r,t)}function _h(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var rk=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],bv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function wJ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ar={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nk={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Sh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,l=0,d=1,h=0,f=0,p=Math.floor(a);h<t&&(p=Math.floor(a),l=p*s+i,f=p*h+d,!(a-p<5e-8));)a=1/(a-p),i=s,s=l,d=h,h=f;if(f>t&&(h>t?(f=d,l=i):(f=h,l=s)),!r)return[0,n*l,f];var x=Math.floor(n*l/f);return[x,n*l-x*f,f]}function _J(e){var t=e.toPrecision(16);if(t.indexOf("e")>-1){var r=t.slice(0,t.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+cr("0",r.length-15),r+t.slice(t.indexOf("e"))}var n=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+cr("0",t.length-15);return Number(n)}function zl(e,t,r){if(e>2958465||e<0)return null;e=_J(e);var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),s=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),n<60&&(i=(i+6)%7),r&&(i=CJ(d,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}function db(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SJ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NJ(e){var t=e<0?12:11,r=db(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function EJ(e){var t=db(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function TJ(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NJ(e):t===10?r=e.toFixed(10).substr(0,12):r=EJ(e),db(SJ(r.toUpperCase()))}function K1(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):TJ(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return us(14,pn(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function CJ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function kJ(e,t,r,n){var a="",i=0,s=0,l=r.y,d,h=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,h=2;break;default:d=l%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,h=t.length;break;case 3:return bv[r.m-1][1];case 5:return bv[r.m-1][0];default:return bv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,h=t.length;break;case 3:return rk[r.q][0];default:return rk[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?li(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=li(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=l,h=1;break}var f=h>0?li(d,h):"";return f}function Vs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var E3=/%/g;function AJ(e,t,r){var n=t.replace(E3,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+cr("%",a)}function PJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function T3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+T3(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,h,f){return d+h+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var C3=/# (\?+)( ?)\/( ?)(\d+)/;function jJ(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,l=n;return r+(i===0?"":""+i)+" "+(s===0?cr(" ",e[1].length+1+e[4].length):ub(s,e[1].length)+e[2]+"/"+e[3]+li(l,e[4].length))}function OJ(e,t,r){return r+(t===0?"":""+t)+cr(" ",e[1].length+2+e[4].length)}var k3=/^#*0*\.([0#]+)/,A3=/\)[^)]*[0#]/,P3=/\(###\) ###\\?-####/;function Ln(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ak(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ik(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function DJ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function RJ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ba(e,t,r){if(e.charCodeAt(0)===40&&!t.match(A3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ba("n",n,r):"("+Ba("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return PJ(e,t,r);if(t.indexOf("%")!==-1)return AJ(e,t,r);if(t.indexOf("E")!==-1)return T3(t,r);if(t.charCodeAt(0)===36)return"$"+Ba(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Ul(d,t.length);if(t.match(/^[#?]+$/))return a=Ul(r,0),a==="0"&&(a=""),a.length>t.length?a:Ln(t.substr(0,t.length-a.length))+a;if(i=t.match(C3))return jJ(i,d,h);if(t.match(/^#+0+$/))return h+Ul(d,t.length-t.indexOf("0"));if(i=t.match(k3))return a=ak(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Ln(i[1])).replace(/\.$/,"."+Ln(i[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+cr("0",Ln(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+ak(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+Vs(Ul(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ba(e,t,-r):Vs(""+(Math.floor(r)+DJ(r,i[1].length)))+"."+li(ik(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ba(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ql(Ba(e,t.replace(/[\\-]/g,""),r)),s=0,ql(ql(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(P3))return a=Ba(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Sh(d,Math.pow(10,s)-1,!1),a=""+h,f=rs("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=bh(l[2],s),f.length<i[4].length&&(f=Ln(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Sh(d,Math.pow(10,s)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ub(l[1],s)+i[2]+"/"+i[3]+bh(l[2],s):cr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Ul(r,0),t.length<=a.length?a:Ln(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,x=t.length-a.length-p;return Ln(t.substr(0,p)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=ik(r,i[1].length),r<0?"-"+Ba(e,t,-r):Vs(RJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?li(0,3-b.length):"")+b})+"."+li(s,i[1].length);switch(t){case"###,##0.00":return Ba(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Vs(Ul(d,0));return g!=="0"?h+g:"";case"###,###.00":return Ba(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ba(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function IJ(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function FJ(e,t,r){var n=t.replace(E3,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+cr("%",a)}function j3(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+j3(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,d,h,f){return d+h+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function gi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(A3)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gi("n",n,r):"("+gi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return IJ(e,t,r);if(t.indexOf("%")!==-1)return FJ(e,t,r);if(t.indexOf("E")!==-1)return j3(t,r);if(t.charCodeAt(0)===36)return"$"+gi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,l,d=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+li(d,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ln(t.substr(0,t.length-a.length))+a;if(i=t.match(C3))return OJ(i,d,h);if(t.match(/^#+0+$/))return h+li(d,t.length-t.indexOf("0"));if(i=t.match(k3))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ln(i[1])).replace(/\.$/,"."+Ln(i[1])),a=a.replace(/\.(\d*)$/,function(b,_){return"."+_+cr("0",Ln(i[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return h+Vs(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gi(e,t,-r):Vs(""+r)+"."+cr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return gi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ql(gi(e,t.replace(/[\\-]/g,""),r)),s=0,ql(ql(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(P3))return a=gi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),l=Sh(d,Math.pow(10,s)-1,!1),a=""+h,f=rs("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=bh(l[2],s),f.length<i[4].length&&(f=Ln(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),l=Sh(d,Math.pow(10,s)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ub(l[1],s)+i[2]+"/"+i[3]+bh(l[2],s):cr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ln(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,x=t.length-a.length-p;return Ln(t.substr(0,p)+a+t.substr(t.length-x))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+gi(e,t,-r):Vs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?li(0,3-b.length):"")+b})+"."+li(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Vs(""+d);return g!=="0"?h+g:"";default:if(t.match(/\.[0#?]*$/))return gi(e,t.slice(0,t.lastIndexOf(".")),r)+Ln(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rs(e,t,r){return(r|0)===r?gi(e,t,r):Ba(e,t,r)}function MJ(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var O3=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":_h(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(O3))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function LJ(e,t,r,n){for(var a=[],i="",s=0,l="",d="t",h,f,p,x="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!_h(e,s))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(p=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++s;break;case"\\":var g=e.charAt(++s),b=g==="("||g===")"?g:"t";a[a.length]={t:b,v:g},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(h==null&&(h=zl(t,r,e.charAt(s+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},d=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=zl(t,r),h==null))return"";for(i=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)i+=l;l==="m"&&d.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=x),a[a.length]={t:l,v:i},d=l;break;case"A":case"a":case"":var _={t:l,v:l};if(h==null&&(h=zl(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?e.charAt(s+2):l),_.t="T",x="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",s+=5,x="h"):e.substr(s,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",s+=5,x="h"):(_.t="t",++s),h==null&&_.t==="T")return"";a[a.length]=_,d=l;break;case"[":for(i=l;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(O3)){if(h==null&&(h=zl(t,r),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",rl(e)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=l;++s<e.length&&(l=e.charAt(s))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++s)===l;)i+=l;a[a.length]={t:l,v:i},d=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++s;break}var w=0,S=0,T;for(s=a.length-1,d="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=x,d="h",w<1&&(w=1);break;case"s":(T=a[s].v.match(/\.0+$/))&&(S=Math.max(S,T[0].length-1),w=4),w<3&&(w=3);case"d":case"y":case"e":d=a[s].t;break;case"M":d=a[s].t,w<2&&(w=2);break;case"m":d==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}var E;switch(w){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,E=zl(h.D),E.u=h.u,E.S=h.S,E.M=h.M,E.H=h.H,h=E);break;case 4:switch(S){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,E=zl(h.D),E.u=h.u,E.S=h.S,E.M=h.M,E.H=h.H,h=E);break}var k="",A;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=kJ(a[s].t.charCodeAt(0),a[s].v,h,S),a[s].t="t";break;case"n":case"?":for(A=s+1;a[A]!=null&&((l=a[A].t)==="?"||l==="D"||(l===" "||l==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[s].v+=a[A].v,a[A]={v:"",t:";"},++A;k+=a[s].v,s=A-1;break;case"G":a[s].t="t",a[s].v=K1(t,r);break}var j="",P,D;if(k.length>0){k.charCodeAt(0)==40?(P=t<0&&k.charCodeAt(0)===45?-t:t,D=rs("n",k,P)):(P=t<0&&n>1?-t:t,D=rs("n",k,P),P<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),A=D.length-1;var L=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){L=s;break}var I=a.length;if(L===a.length&&D.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(A>=a[s].v.length-1?(A-=a[s].v.length,a[s].v=D.substr(A+1,a[s].v.length)):A<0?a[s].v="":(a[s].v=D.substr(0,A+1),A=-1),a[s].t="t",I=s);A>=0&&I<a.length&&(a[I].v=D.substr(0,A+1)+a[I].v)}else if(L!==a.length&&D.indexOf("E")===-1){for(A=D.indexOf(".")-1,s=L;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===L?a[s].v.indexOf(".")-1:a[s].v.length-1,j=a[s].v.substr(f+1);f>=0;--f)A>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(j=D.charAt(A--)+j);a[s].v=j,a[s].t="t",I=s}for(A>=0&&I<a.length&&(a[I].v=D.substr(0,A+1)+a[I].v),A=D.indexOf(".")+1,s=L;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==L)){for(f=a[s].v.indexOf(".")>-1&&s===L?a[s].v.indexOf(".")+1:0,j=a[s].v.substr(0,f);f<a[s].v.length;++f)A<D.length&&(j+=D.charAt(A++));a[s].v=j,a[s].t="t",I=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(P=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=rs(a[s].t,a[s].v,P),a[s].t="t");var O="";for(s=0;s!==a.length;++s)a[s]!=null&&(O+=a[s].v);return O}var sk=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ok(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function BJ(e,t){var r=MJ(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(sk),l=r[1].match(sk);return ok(t,s)?[n,r[0]]:ok(t,l)?[n,r[1]]:[n,r[s!=null&&l!=null?2:1]]}return[n,i]}function us(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ar)[e],n==null&&(n=r.table&&r.table[nk[e]]||ar[nk[e]]),n==null&&(n=bJ[e]||"General");break}if(_h(n,0))return K1(t,r);t instanceof Date&&(t=pn(t,r.date1904));var a=BJ(n,t);if(_h(a[1]))return K1(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return LJ(a[1],t,r,a[0])}function D3(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ar[r]==null){t<0&&(t=r);continue}if(ar[r]==e){t=r;break}}t<0&&(t=391)}return ar[t]=e,t}function Ap(e){for(var t=0;t!=392;++t)e[t]!==void 0&&D3(e[t],t)}function Pp(){ar=wJ()}var Nh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $J(e){var t=typeof e=="number"?ar[e]:e;return t=t.replace(Nh,"(\\d+)"),Nh.lastIndex=0,new RegExp("^"+t+"$")}function UJ(e,t,r){var n=-1,a=-1,i=-1,s=-1,l=-1,d=-1;(t.match(Nh)||[]).forEach(function(p,x){var g=parseInt(r[x+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=g;break;case"d":i=g;break;case"h":s=g;break;case"s":d=g;break;case"m":s>=0?l=g:a=g;break}}),Nh.lastIndex=0,d>=0&&l==-1&&a>=0&&(l=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return s==-1&&l==-1&&d==-1?h:n==-1&&a==-1&&i==-1?f:h+"T"+f}var zJ={"d.m":"d\\.m"};function WJ(e,t){return D3(zJ[e]||e,t)}var lk=(function(){var e={};e.version="1.2.0";function t(){for(var P=0,D=new Array(256),L=0;L!=256;++L)P=L,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,D[L]=P;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(P){var D=0,L=0,I=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)O[I]=P[I];for(I=0;I!=256;++I)for(L=P[I],D=256+I;D<4096;D+=256)L=O[D]=L>>>8^P[L&255];var M=[];for(I=1;I!=16;++I)M[I-1]=typeof Int32Array<"u"&&typeof O.subarray=="function"?O.subarray(I*256,I*256+256):O.slice(I*256,I*256+256);return M}var a=n(r),i=a[0],s=a[1],l=a[2],d=a[3],h=a[4],f=a[5],p=a[6],x=a[7],g=a[8],b=a[9],_=a[10],w=a[11],S=a[12],T=a[13],E=a[14];function k(P,D){for(var L=D^-1,I=0,O=P.length;I<O;)L=L>>>8^r[(L^P.charCodeAt(I++))&255];return~L}function A(P,D){for(var L=D^-1,I=P.length-15,O=0;O<I;)L=E[P[O++]^L&255]^T[P[O++]^L>>8&255]^S[P[O++]^L>>16&255]^w[P[O++]^L>>>24]^_[P[O++]]^b[P[O++]]^g[P[O++]]^x[P[O++]]^p[P[O++]]^f[P[O++]]^h[P[O++]]^d[P[O++]]^l[P[O++]]^s[P[O++]]^i[P[O++]]^r[P[O++]];for(I+=15;O<I;)L=L>>>8^r[(L^P[O++])&255];return~L}function j(P,D){for(var L=D^-1,I=0,O=P.length,M=0,re=0;I<O;)M=P.charCodeAt(I++),M<128?L=L>>>8^r[(L^M)&255]:M<2048?(L=L>>>8^r[(L^(192|M>>6&31))&255],L=L>>>8^r[(L^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,re=P.charCodeAt(I++)&1023,L=L>>>8^r[(L^(240|M>>8&7))&255],L=L>>>8^r[(L^(128|M>>2&63))&255],L=L>>>8^r[(L^(128|re>>6&15|(M&3)<<4))&255],L=L>>>8^r[(L^(128|re&63))&255]):(L=L>>>8^r[(L^(224|M>>12&15))&255],L=L>>>8^r[(L^(128|M>>6&63))&255],L=L>>>8^r[(L^(128|M&63))&255]);return~L}return e.table=r,e.bstr=k,e.buf=A,e.str=j,e})(),Xt=(function(){var t={};t.version="1.2.2";function r(F,X){for(var W=F.split("/"),V=X.split("/"),q=0,Z=0,_e=Math.min(W.length,V.length);q<_e;++q){if(Z=W[q].length-V[q].length)return Z;if(W[q]!=V[q])return W[q]<V[q]?-1:1}return W.length-V.length}function n(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:n(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(0,X+1)}function a(F){if(F.charAt(F.length-1)=="/")return a(F.slice(0,-1));var X=F.lastIndexOf("/");return X===-1?F:F.slice(X+1)}function i(F,X){typeof X=="string"&&(X=new Date(X));var W=X.getHours();W=W<<6|X.getMinutes(),W=W<<5|X.getSeconds()>>>1,F.write_shift(2,W);var V=X.getFullYear()-1980;V=V<<4|X.getMonth()+1,V=V<<5|X.getDate(),F.write_shift(2,V)}function s(F){var X=F.read_shift(2)&65535,W=F.read_shift(2)&65535,V=new Date,q=W&31;W>>>=5;var Z=W&15;W>>>=4,V.setMilliseconds(0),V.setFullYear(W+1980),V.setMonth(Z-1),V.setDate(q);var _e=X&31;X>>>=5;var Fe=X&63;return X>>>=6,V.setHours(X),V.setMinutes(Fe),V.setSeconds(_e<<1),V}function l(F){Bn(F,0);for(var X={},W=0;F.l<=F.length-4;){var V=F.read_shift(2),q=F.read_shift(2),Z=F.l+q,_e={};switch(V){case 21589:W=F.read_shift(1),W&1&&(_e.mtime=F.read_shift(4)),q>5&&(W&2&&(_e.atime=F.read_shift(4)),W&4&&(_e.ctime=F.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break;case 1:{var Fe=F.read_shift(4),ye=F.read_shift(4);_e.usz=ye*Math.pow(2,32)+Fe,Fe=F.read_shift(4),ye=F.read_shift(4),_e.csz=ye*Math.pow(2,32)+Fe}break}F.l=Z,X[V]=_e}return X}var d;function h(){return d||(d=HJ)}function f(F,X){if(F[0]==80&&F[1]==75)return bt(F,X);if((F[0]|32)==109&&(F[1]|32)==105)return Xn(F,X);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var W=3,V=512,q=0,Z=0,_e=0,Fe=0,ye=0,Se=[],Ne=F.slice(0,512);Bn(Ne,0);var Ke=p(Ne);switch(W=Ke[0],W){case 3:V=512;break;case 4:V=4096;break;case 0:if(Ke[1]==0)return bt(F,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}V!==512&&(Ne=F.slice(0,V),Bn(Ne,28));var Qe=F.slice(0,V);x(Ne,W);var nt=Ne.read_shift(4,"i");if(W===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Ne.l+=4,_e=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),Fe=Ne.read_shift(4,"i"),q=Ne.read_shift(4,"i"),ye=Ne.read_shift(4,"i"),Z=Ne.read_shift(4,"i");for(var Ge=-1,ze=0;ze<109&&(Ge=Ne.read_shift(4,"i"),!(Ge<0));++ze)Se[ze]=Ge;var _t=g(F,V);w(ye,Z,_t,V,Se);var Vt=T(_t,_e,Se,V);_e<Vt.length&&(Vt[_e].name="!Directory"),q>0&&Fe!==re&&(Vt[Fe].name="!MiniFAT"),Vt[Se[0]].name="!FAT",Vt.fat_addrs=Se,Vt.ssz=V;var Qt={},Sr=[],mo=[],ys=[];E(_e,Vt,_t,Sr,q,Qt,mo,Fe),b(mo,ys,Sr),Sr.shift();var di={FileIndex:mo,FullPaths:ys};return X&&X.raw&&(di.raw={header:Qe,sectors:_t}),di}function p(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(oe,"Header Signature: "),F.l+=16;var X=F.read_shift(2,"u");return[F.read_shift(2,"u"),X]}function x(F,X){var W=9;switch(F.l+=2,W=F.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function g(F,X){for(var W=Math.ceil(F.length/X)-1,V=[],q=1;q<W;++q)V[q-1]=F.slice(q*X,(q+1)*X);return V[W-1]=F.slice(W*X),V}function b(F,X,W){for(var V=0,q=0,Z=0,_e=0,Fe=0,ye=W.length,Se=[],Ne=[];V<ye;++V)Se[V]=Ne[V]=V,X[V]=W[V];for(;Fe<Ne.length;++Fe)V=Ne[Fe],q=F[V].L,Z=F[V].R,_e=F[V].C,Se[V]===V&&(q!==-1&&Se[q]!==q&&(Se[V]=Se[q]),Z!==-1&&Se[Z]!==Z&&(Se[V]=Se[Z])),_e!==-1&&(Se[_e]=V),q!==-1&&V!=Se[V]&&(Se[q]=Se[V],Ne.lastIndexOf(q)<Fe&&Ne.push(q)),Z!==-1&&V!=Se[V]&&(Se[Z]=Se[V],Ne.lastIndexOf(Z)<Fe&&Ne.push(Z));for(V=1;V<ye;++V)Se[V]===V&&(Z!==-1&&Se[Z]!==Z?Se[V]=Se[Z]:q!==-1&&Se[q]!==q&&(Se[V]=Se[q]));for(V=1;V<ye;++V)if(F[V].type!==0){if(Fe=V,Fe!=Se[Fe])do Fe=Se[Fe],X[V]=X[Fe]+"/"+X[V];while(Fe!==0&&Se[Fe]!==-1&&Fe!=Se[Fe]);Se[V]=-1}for(X[0]+="/",V=1;V<ye;++V)F[V].type!==2&&(X[V]+="/")}function _(F,X,W){for(var V=F.start,q=F.size,Z=[],_e=V;W&&q>0&&_e>=0;)Z.push(X.slice(_e*M,_e*M+M)),q-=M,_e=Ro(W,_e*4);return Z.length===0?be(0):Dr(Z).slice(0,F.size)}function w(F,X,W,V,q){var Z=re;if(F===re){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var _e=W[F],Fe=(V>>>2)-1;if(!_e)return;for(var ye=0;ye<Fe&&(Z=Ro(_e,ye*4))!==re;++ye)q.push(Z);X>=1&&w(Ro(_e,V-4),X-1,W,V,q)}}function S(F,X,W,V,q){var Z=[],_e=[];q||(q=[]);var Fe=V-1,ye=0,Se=0;for(ye=X;ye>=0;){q[ye]=!0,Z[Z.length]=ye,_e.push(F[ye]);var Ne=W[Math.floor(ye*4/V)];if(Se=ye*4&Fe,V<4+Se)throw new Error("FAT boundary crossed: "+ye+" 4 "+V);if(!F[Ne])break;ye=Ro(F[Ne],Se)}return{nodes:Z,data:mk([_e])}}function T(F,X,W,V){var q=F.length,Z=[],_e=[],Fe=[],ye=[],Se=V-1,Ne=0,Ke=0,Qe=0,nt=0;for(Ne=0;Ne<q;++Ne)if(Fe=[],Qe=Ne+X,Qe>=q&&(Qe-=q),!_e[Qe]){ye=[];var Ge=[];for(Ke=Qe;Ke>=0;){Ge[Ke]=!0,_e[Ke]=!0,Fe[Fe.length]=Ke,ye.push(F[Ke]);var ze=W[Math.floor(Ke*4/V)];if(nt=Ke*4&Se,V<4+nt)throw new Error("FAT boundary crossed: "+Ke+" 4 "+V);if(!F[ze]||(Ke=Ro(F[ze],nt),Ge[Ke]))break}Z[Qe]={nodes:Fe,data:mk([ye])}}return Z}function E(F,X,W,V,q,Z,_e,Fe){for(var ye=0,Se=V.length?2:0,Ne=X[F].data,Ke=0,Qe=0,nt;Ke<Ne.length;Ke+=128){var Ge=Ne.slice(Ke,Ke+128);Bn(Ge,64),Qe=Ge.read_shift(2),nt=gb(Ge,0,Qe-Se),V.push(nt);var ze={name:nt,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},_t=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);_t!==0&&(ze.ct=k(Ge,Ge.l-8));var Vt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Vt!==0&&(ze.mt=k(Ge,Ge.l-8)),ze.start=Ge.read_shift(4,"i"),ze.size=Ge.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=re,ze.name=""),ze.type===5?(ye=ze.start,q>0&&ye!==re&&(X[ye].name="!StreamData")):ze.size>=4096?(ze.storage="fat",X[ze.start]===void 0&&(X[ze.start]=S(W,ze.start,X.fat_addrs,X.ssz)),X[ze.start].name=ze.name,ze.content=X[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:ye!==re&&ze.start!==re&&X[ye]&&(ze.content=_(ze,X[ye].data,(X[Fe]||{}).data))),ze.content&&Bn(ze.content,0),Z[nt]=ze,_e.push(ze)}}function k(F,X){return new Date((_a(F,X+4)/1e7*Math.pow(2,32)+_a(F,X)/1e7-11644473600)*1e3)}function A(F,X){return h(),f(d.readFileSync(F),X)}function j(F,X){var W=X&&X.type;switch(W||Bt&&Buffer.isBuffer(F)&&(W="buffer"),W||"base64"){case"file":return A(F,X);case"base64":return f(wa(ro(F)),X);case"binary":return f(wa(F),X)}return f(F,X)}function P(F,X){var W=X||{},V=W.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=V+"/",F.FileIndex[0]={name:V,type:5}),W.CLSID&&(F.FileIndex[0].clsid=W.CLSID),D(F)}function D(F){var X="Sh33tJ5";if(!Xt.find(F,"/"+X)){var W=be(4);W[0]=55,W[1]=W[3]=50,W[2]=54,F.FileIndex.push({name:X,type:2,content:W,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+X),L(F)}}function L(F,X){P(F);for(var W=!1,V=!1,q=F.FullPaths.length-1;q>=0;--q){var Z=F.FileIndex[q];switch(Z.type){case 0:V?W=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(Z.R*Z.L*Z.C)&&(W=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!X)){var _e=new Date(1987,1,19),Fe=0,ye=Object.create?Object.create(null):{},Se=[];for(q=0;q<F.FullPaths.length;++q)ye[F.FullPaths[q]]=!0,F.FileIndex[q].type!==0&&Se.push([F.FullPaths[q],F.FileIndex[q]]);for(q=0;q<Se.length;++q){var Ne=n(Se[q][0]);for(V=ye[Ne];!V;){for(;n(Ne)&&!ye[n(Ne)];)Ne=n(Ne);Se.push([Ne,{name:a(Ne).replace("/",""),type:1,clsid:fe,ct:_e,mt:_e,content:null}]),ye[Ne]=!0,Ne=n(Se[q][0]),V=ye[Ne]}}for(Se.sort(function(nt,Ge){return r(nt[0],Ge[0])}),F.FullPaths=[],F.FileIndex=[],q=0;q<Se.length;++q)F.FullPaths[q]=Se[q][0],F.FileIndex[q]=Se[q][1];for(q=0;q<Se.length;++q){var Ke=F.FileIndex[q],Qe=F.FullPaths[q];if(Ke.name=a(Qe).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||fe,q===0)Ke.C=Se.length>1?1:-1,Ke.size=0,Ke.type=5;else if(Qe.slice(-1)=="/"){for(Fe=q+1;Fe<Se.length&&n(F.FullPaths[Fe])!=Qe;++Fe);for(Ke.C=Fe>=Se.length?-1:Fe,Fe=q+1;Fe<Se.length&&n(F.FullPaths[Fe])!=n(Qe);++Fe);Ke.R=Fe>=Se.length?-1:Fe,Ke.type=1}else n(F.FullPaths[q+1]||"")==n(Qe)&&(Ke.R=q+1),Ke.type=2}}}function I(F,X){var W=X||{};if(W.fileType=="mad")return qa(F,W);switch(L(F),W.fileType){case"zip":return Kt(F,W)}var V=(function(nt){for(var Ge=0,ze=0,_t=0;_t<nt.FileIndex.length;++_t){var Vt=nt.FileIndex[_t];if(Vt.content){var Qt=Vt.content.length;Qt>0&&(Qt<4096?Ge+=Qt+63>>6:ze+=Qt+511>>9)}}for(var Sr=nt.FullPaths.length+3>>2,mo=Ge+7>>3,ys=Ge+127>>7,di=mo+ze+Sr+ys,Xr=di+127>>7,Ic=Xr<=109?0:Math.ceil((Xr-109)/127);di+Xr+Ic+127>>7>Xr;)Ic=++Xr<=109?0:Math.ceil((Xr-109)/127);var Nr=[1,Ic,Xr,ys,Sr,ze,Ge,0];return nt.FileIndex[0].size=Ge<<6,Nr[7]=(nt.FileIndex[0].start=Nr[0]+Nr[1]+Nr[2]+Nr[3]+Nr[4]+Nr[5])+(Nr[6]+7>>3),Nr})(F),q=be(V[7]<<9),Z=0,_e=0;{for(Z=0;Z<8;++Z)q.write_shift(1,ee[Z]);for(Z=0;Z<8;++Z)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),Z=0;Z<3;++Z)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,V[2]),q.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:re),q.write_shift(4,V[3]),q.write_shift(-4,V[1]?V[0]-1:re),q.write_shift(4,V[1]),Z=0;Z<109;++Z)q.write_shift(-4,Z<V[2]?V[1]+Z:-1)}if(V[1])for(_e=0;_e<V[1];++_e){for(;Z<236+_e*127;++Z)q.write_shift(-4,Z<V[2]?V[1]+Z:-1);q.write_shift(-4,_e===V[1]-1?re:_e+1)}var Fe=function(nt){for(_e+=nt;Z<_e-1;++Z)q.write_shift(-4,Z+1);nt&&(++Z,q.write_shift(-4,re))};for(_e=Z=0,_e+=V[1];Z<_e;++Z)q.write_shift(-4,J.DIFSECT);for(_e+=V[2];Z<_e;++Z)q.write_shift(-4,J.FATSECT);Fe(V[3]),Fe(V[4]);for(var ye=0,Se=0,Ne=F.FileIndex[0];ye<F.FileIndex.length;++ye)Ne=F.FileIndex[ye],Ne.content&&(Se=Ne.content.length,!(Se<4096)&&(Ne.start=_e,Fe(Se+511>>9)));for(Fe(V[6]+7>>3);q.l&511;)q.write_shift(-4,J.ENDOFCHAIN);for(_e=Z=0,ye=0;ye<F.FileIndex.length;++ye)Ne=F.FileIndex[ye],Ne.content&&(Se=Ne.content.length,!(!Se||Se>=4096)&&(Ne.start=_e,Fe(Se+63>>6)));for(;q.l&511;)q.write_shift(-4,J.ENDOFCHAIN);for(Z=0;Z<V[4]<<2;++Z){var Ke=F.FullPaths[Z];if(!Ke||Ke.length===0){for(ye=0;ye<17;++ye)q.write_shift(4,0);for(ye=0;ye<3;++ye)q.write_shift(4,-1);for(ye=0;ye<12;++ye)q.write_shift(4,0);continue}Ne=F.FileIndex[Z],Z===0&&(Ne.start=Ne.size?Ne.start-1:re);var Qe=Z===0&&W.root||Ne.name;if(Qe.length>31&&(console.error("Name "+Qe+" will be truncated to "+Qe.slice(0,31)),Qe=Qe.slice(0,31)),Se=2*(Qe.length+1),q.write_shift(64,Qe,"utf16le"),q.write_shift(2,Se),q.write_shift(1,Ne.type),q.write_shift(1,Ne.color),q.write_shift(-4,Ne.L),q.write_shift(-4,Ne.R),q.write_shift(-4,Ne.C),Ne.clsid)q.write_shift(16,Ne.clsid,"hex");else for(ye=0;ye<4;++ye)q.write_shift(4,0);q.write_shift(4,Ne.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,Ne.start),q.write_shift(4,Ne.size),q.write_shift(4,0)}for(Z=1;Z<F.FileIndex.length;++Z)if(Ne=F.FileIndex[Z],Ne.size>=4096)if(q.l=Ne.start+1<<9,Bt&&Buffer.isBuffer(Ne.content))Ne.content.copy(q,q.l,0,Ne.size),q.l+=Ne.size+511&-512;else{for(ye=0;ye<Ne.size;++ye)q.write_shift(1,Ne.content[ye]);for(;ye&511;++ye)q.write_shift(1,0)}for(Z=1;Z<F.FileIndex.length;++Z)if(Ne=F.FileIndex[Z],Ne.size>0&&Ne.size<4096)if(Bt&&Buffer.isBuffer(Ne.content))Ne.content.copy(q,q.l,0,Ne.size),q.l+=Ne.size+63&-64;else{for(ye=0;ye<Ne.size;++ye)q.write_shift(1,Ne.content[ye]);for(;ye&63;++ye)q.write_shift(1,0)}if(Bt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function O(F,X){var W=F.FullPaths.map(function(ye){return ye.toUpperCase()}),V=W.map(function(ye){var Se=ye.split("/");return Se[Se.length-(ye.slice(-1)=="/"?2:1)]}),q=!1;X.charCodeAt(0)===47?(q=!0,X=W[0].slice(0,-1)+X):q=X.indexOf("/")!==-1;var Z=X.toUpperCase(),_e=q===!0?W.indexOf(Z):V.indexOf(Z);if(_e!==-1)return F.FileIndex[_e];var Fe=!Z.match(d0);for(Z=Z.replace(Iu,""),Fe&&(Z=Z.replace(d0,"!")),_e=0;_e<W.length;++_e)if((Fe?W[_e].replace(d0,"!"):W[_e]).replace(Iu,"")==Z||(Fe?V[_e].replace(d0,"!"):V[_e]).replace(Iu,"")==Z)return F.FileIndex[_e];return null}var M=64,re=-2,oe="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(F,X,W){h();var V=I(F,W);d.writeFileSync(X,V)}function Q(F){for(var X=new Array(F.length),W=0;W<F.length;++W)X[W]=String.fromCharCode(F[W]);return X.join("")}function te(F,X){var W=I(F,X);switch(X&&X.type||"buffer"){case"file":return h(),d.writeFileSync(X.filename,W),W;case"binary":return typeof W=="string"?W:Q(W);case"base64":return yh(typeof W=="string"?W:Q(W));case"buffer":if(Bt)return Buffer.isBuffer(W)?W:Di(W);case"array":return typeof W=="string"?wa(W):W}return W}var H;function se(F){try{var X=F.InflateRaw,W=new X;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)H=F;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function Y(F,X){if(!H)return xt(F,X);var W=H.InflateRaw,V=new W,q=V._processChunk(F.slice(F.l),V._finishFlushFlag);return F.l+=V.bytesRead,q}function ce(F){return H?H.deflateRawSync(F):et(F)}var ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(F){var X=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(X>>16|X>>8|X)&255}for(var B=typeof Uint8Array<"u",K=B?new Uint8Array(256):[],z=0;z<256;++z)K[z]=U(z);function ne(F,X){var W=K[F&255];return X<=8?W>>>8-X:(W=W<<8|K[F>>8&255],X<=16?W>>>16-X:(W=W<<8|K[F>>16&255],W>>>24-X))}function Oe(F,X){var W=X&7,V=X>>>3;return(F[V]|(W<=6?0:F[V+1]<<8))>>>W&3}function Pe(F,X){var W=X&7,V=X>>>3;return(F[V]|(W<=5?0:F[V+1]<<8))>>>W&7}function we(F,X){var W=X&7,V=X>>>3;return(F[V]|(W<=4?0:F[V+1]<<8))>>>W&15}function xe(F,X){var W=X&7,V=X>>>3;return(F[V]|(W<=3?0:F[V+1]<<8))>>>W&31}function Ee(F,X){var W=X&7,V=X>>>3;return(F[V]|(W<=1?0:F[V+1]<<8))>>>W&127}function le(F,X,W){var V=X&7,q=X>>>3,Z=(1<<W)-1,_e=F[q]>>>V;return W<8-V||(_e|=F[q+1]<<8-V,W<16-V)||(_e|=F[q+2]<<16-V,W<24-V)||(_e|=F[q+3]<<24-V),_e&Z}function De(F,X,W){var V=X&7,q=X>>>3;return V<=5?F[q]|=(W&7)<<V:(F[q]|=W<<V&255,F[q+1]=(W&7)>>8-V),X+3}function Ue(F,X,W){var V=X&7,q=X>>>3;return W=(W&1)<<V,F[q]|=W,X+1}function Ce(F,X,W){var V=X&7,q=X>>>3;return W<<=V,F[q]|=W&255,W>>>=8,F[q+1]=W,X+8}function Ae(F,X,W){var V=X&7,q=X>>>3;return W<<=V,F[q]|=W&255,W>>>=8,F[q+1]=W&255,F[q+2]=W>>>8,X+16}function ve(F,X){var W=F.length,V=2*W>X?2*W:X+5,q=0;if(W>=X)return F;if(Bt){var Z=ek(V);if(F.copy)F.copy(Z);else for(;q<F.length;++q)Z[q]=F[q];return Z}else if(B){var _e=new Uint8Array(V);if(_e.set)_e.set(F);else for(;q<W;++q)_e[q]=F[q];return _e}return F.length=V,F}function Le(F){for(var X=new Array(F),W=0;W<F;++W)X[W]=0;return X}function pe(F,X,W){var V=1,q=0,Z=0,_e=0,Fe=0,ye=F.length,Se=B?new Uint16Array(32):Le(32);for(Z=0;Z<32;++Z)Se[Z]=0;for(Z=ye;Z<W;++Z)F[Z]=0;ye=F.length;var Ne=B?new Uint16Array(ye):Le(ye);for(Z=0;Z<ye;++Z)Se[q=F[Z]]++,V<q&&(V=q),Ne[Z]=0;for(Se[0]=0,Z=1;Z<=V;++Z)Se[Z+16]=Fe=Fe+Se[Z-1]<<1;for(Z=0;Z<ye;++Z)Fe=F[Z],Fe!=0&&(Ne[Z]=Se[Fe+16]++);var Ke=0;for(Z=0;Z<ye;++Z)if(Ke=F[Z],Ke!=0)for(Fe=ne(Ne[Z],V)>>V-Ke,_e=(1<<V+4-Ke)-1;_e>=0;--_e)X[Fe|_e<<Ke]=Ke&15|Z<<4;return V}var tt=B?new Uint16Array(512):Le(512),Ye=B?new Uint16Array(32):Le(32);if(!B){for(var Be=0;Be<512;++Be)tt[Be]=0;for(Be=0;Be<32;++Be)Ye[Be]=0}(function(){for(var F=[],X=0;X<32;X++)F.push(5);pe(F,Ye,32);var W=[];for(X=0;X<=143;X++)W.push(8);for(;X<=255;X++)W.push(9);for(;X<=279;X++)W.push(7);for(;X<=287;X++)W.push(8);pe(W,tt,288)})();var ot=(function(){for(var X=B?new Uint8Array(32768):[],W=0,V=0;W<Re.length-1;++W)for(;V<Re[W+1];++V)X[V]=W;for(;V<32768;++V)X[V]=29;var q=B?new Uint8Array(259):[];for(W=0,V=0;W<me.length-1;++W)for(;V<me[W+1];++V)q[V]=W;function Z(Fe,ye){for(var Se=0;Se<Fe.length;){var Ne=Math.min(65535,Fe.length-Se),Ke=Se+Ne==Fe.length;for(ye.write_shift(1,+Ke),ye.write_shift(2,Ne),ye.write_shift(2,~Ne&65535);Ne-- >0;)ye[ye.l++]=Fe[Se++]}return ye.l}function _e(Fe,ye){for(var Se=0,Ne=0,Ke=B?new Uint16Array(32768):[];Ne<Fe.length;){var Qe=Math.min(65535,Fe.length-Ne);if(Qe<10){for(Se=De(ye,Se,+(Ne+Qe==Fe.length)),Se&7&&(Se+=8-(Se&7)),ye.l=Se/8|0,ye.write_shift(2,Qe),ye.write_shift(2,~Qe&65535);Qe-- >0;)ye[ye.l++]=Fe[Ne++];Se=ye.l*8;continue}Se=De(ye,Se,+(Ne+Qe==Fe.length)+2);for(var nt=0;Qe-- >0;){var Ge=Fe[Ne];nt=(nt<<5^Ge)&32767;var ze=-1,_t=0;if((ze=Ke[nt])&&(ze|=Ne&-32768,ze>Ne&&(ze-=32768),ze<Ne))for(;Fe[ze+_t]==Fe[Ne+_t]&&_t<250;)++_t;if(_t>2){Ge=q[_t],Ge<=22?Se=Ce(ye,Se,K[Ge+1]>>1)-1:(Ce(ye,Se,3),Se+=5,Ce(ye,Se,K[Ge-23]>>5),Se+=3);var Vt=Ge<8?0:Ge-4>>2;Vt>0&&(Ae(ye,Se,_t-me[Ge]),Se+=Vt),Ge=X[Ne-ze],Se=Ce(ye,Se,K[Ge]>>3),Se-=3;var Qt=Ge<4?0:Ge-2>>1;Qt>0&&(Ae(ye,Se,Ne-ze-Re[Ge]),Se+=Qt);for(var Sr=0;Sr<_t;++Sr)Ke[nt]=Ne&32767,nt=(nt<<5^Fe[Ne])&32767,++Ne;Qe-=_t-1}else Ge<=143?Ge=Ge+48:Se=Ue(ye,Se,1),Se=Ce(ye,Se,K[Ge]),Ke[nt]=Ne&32767,++Ne}Se=Ce(ye,Se,0)-1}return ye.l=(Se+7)/8|0,ye.l}return function(ye,Se){return ye.length<8?Z(ye,Se):_e(ye,Se)}})();function et(F){var X=be(50+Math.floor(F.length*1.1)),W=ot(F,X);return X.slice(0,W)}var Je=B?new Uint16Array(32768):Le(32768),Ze=B?new Uint16Array(32768):Le(32768),At=B?new Uint16Array(128):Le(128),Ot=1,Mt=1;function Ie(F,X){var W=xe(F,X)+257;X+=5;var V=xe(F,X)+1;X+=5;var q=we(F,X)+4;X+=4;for(var Z=0,_e=B?new Uint8Array(19):Le(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ye=1,Se=B?new Uint8Array(8):Le(8),Ne=B?new Uint8Array(8):Le(8),Ke=_e.length,Qe=0;Qe<q;++Qe)_e[ue[Qe]]=Z=Pe(F,X),ye<Z&&(ye=Z),Se[Z]++,X+=3;var nt=0;for(Se[0]=0,Qe=1;Qe<=ye;++Qe)Ne[Qe]=nt=nt+Se[Qe-1]<<1;for(Qe=0;Qe<Ke;++Qe)(nt=_e[Qe])!=0&&(Fe[Qe]=Ne[nt]++);var Ge=0;for(Qe=0;Qe<Ke;++Qe)if(Ge=_e[Qe],Ge!=0){nt=K[Fe[Qe]]>>8-Ge;for(var ze=(1<<7-Ge)-1;ze>=0;--ze)At[nt|ze<<Ge]=Ge&7|Qe<<3}var _t=[];for(ye=1;_t.length<W+V;)switch(nt=At[Ee(F,X)],X+=nt&7,nt>>>=3){case 16:for(Z=3+Oe(F,X),X+=2,nt=_t[_t.length-1];Z-- >0;)_t.push(nt);break;case 17:for(Z=3+Pe(F,X),X+=3;Z-- >0;)_t.push(0);break;case 18:for(Z=11+Ee(F,X),X+=7;Z-- >0;)_t.push(0);break;default:_t.push(nt),ye<nt&&(ye=nt);break}var Vt=_t.slice(0,W),Qt=_t.slice(W);for(Qe=W;Qe<286;++Qe)Vt[Qe]=0;for(Qe=V;Qe<30;++Qe)Qt[Qe]=0;return Ot=pe(Vt,Je,286),Mt=pe(Qt,Ze,30),X}function at(F,X){if(F[0]==3&&!(F[1]&3))return[el(X),2];for(var W=0,V=0,q=ek(X||1<<18),Z=0,_e=q.length>>>0,Fe=0,ye=0;(V&1)==0;){if(V=Pe(F,W),W+=3,V>>>1)V>>1==1?(Fe=9,ye=5):(W=Ie(F,W),Fe=Ot,ye=Mt);else{W&7&&(W+=8-(W&7));var Se=F[W>>>3]|F[(W>>>3)+1]<<8;if(W+=32,Se>0)for(!X&&_e<Z+Se&&(q=ve(q,Z+Se),_e=q.length);Se-- >0;)q[Z++]=F[W>>>3],W+=8;continue}for(;;){!X&&_e<Z+32767&&(q=ve(q,Z+32767),_e=q.length);var Ne=le(F,W,Fe),Ke=V>>>1==1?tt[Ne]:Je[Ne];if(W+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)q[Z++]=Ke;else{if(Ke==256)break;Ke-=257;var Qe=Ke<8?0:Ke-4>>2;Qe>5&&(Qe=0);var nt=Z+me[Ke];Qe>0&&(nt+=le(F,W,Qe),W+=Qe),Ne=le(F,W,ye),Ke=V>>>1==1?Ye[Ne]:Ze[Ne],W+=Ke&15,Ke>>>=4;var Ge=Ke<4?0:Ke-2>>1,ze=Re[Ke];for(Ge>0&&(ze+=le(F,W,Ge),W+=Ge),!X&&_e<nt&&(q=ve(q,nt+100),_e=q.length);Z<nt;)q[Z]=q[Z-ze],++Z}}}return X?[q,W+7>>>3]:[q.slice(0,Z),W+7>>>3]}function xt(F,X){var W=F.slice(F.l||0),V=at(W,X);return F.l+=V[1],V[0]}function yt(F,X){if(F)typeof console<"u"&&console.error(X);else throw new Error(X)}function bt(F,X){var W=F;Bn(W,0);var V=[],q=[],Z={FileIndex:V,FullPaths:q};P(Z,{root:X.root});for(var _e=W.length-4;(W[_e]!=80||W[_e+1]!=75||W[_e+2]!=5||W[_e+3]!=6)&&_e>=0;)--_e;W.l=_e+4,W.l+=4;var Fe=W.read_shift(2);W.l+=6;var ye=W.read_shift(4);for(W.l=ye,_e=0;_e<Fe;++_e){W.l+=20;var Se=W.read_shift(4),Ne=W.read_shift(4),Ke=W.read_shift(2),Qe=W.read_shift(2),nt=W.read_shift(2);W.l+=8;var Ge=W.read_shift(4),ze=l(W.slice(W.l+Ke,W.l+Ke+Qe));W.l+=Ke+Qe+nt;var _t=W.l;W.l=Ge+4,ze&&ze[1]&&((ze[1]||{}).usz&&(Ne=ze[1].usz),(ze[1]||{}).csz&&(Se=ze[1].csz)),Tt(W,Se,Ne,Z,ze),W.l=_t}return Z}function Tt(F,X,W,V,q){F.l+=2;var Z=F.read_shift(2),_e=F.read_shift(2),Fe=s(F);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var ye=F.read_shift(4),Se=F.read_shift(4),Ne=F.read_shift(4),Ke=F.read_shift(2),Qe=F.read_shift(2),nt="",Ge=0;Ge<Ke;++Ge)nt+=String.fromCharCode(F[F.l++]);if(Qe){var ze=l(F.slice(F.l,F.l+Qe));(ze[21589]||{}).mt&&(Fe=ze[21589].mt),(ze[1]||{}).usz&&(Ne=ze[1].usz),(ze[1]||{}).csz&&(Se=ze[1].csz),q&&((q[21589]||{}).mt&&(Fe=q[21589].mt),(q[1]||{}).usz&&(Ne=q[1].usz),(q[1]||{}).csz&&(Se=q[1].csz))}F.l+=Qe;var _t=F.slice(F.l,F.l+Se);switch(_e){case 8:_t=Y(F,Ne);break;case 0:F.l+=Se;break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var Vt=!1;Z&8&&(ye=F.read_shift(4),ye==134695760&&(ye=F.read_shift(4),Vt=!0),Se=F.read_shift(4),Ne=F.read_shift(4)),Se!=X&&yt(Vt,"Bad compressed size: "+X+" != "+Se),Ne!=W&&yt(Vt,"Bad uncompressed size: "+W+" != "+Ne),qn(V,nt,_t,{unsafe:!0,mt:Fe})}function Kt(F,X){var W=X||{},V=[],q=[],Z=be(1),_e=W.compression?8:0,Fe=0,ye=0,Se=0,Ne=0,Ke=0,Qe=F.FullPaths[0],nt=Qe,Ge=F.FileIndex[0],ze=[],_t=0;for(ye=1;ye<F.FullPaths.length;++ye)if(nt=F.FullPaths[ye].slice(Qe.length),Ge=F.FileIndex[ye],!(!Ge.size||!Ge.content||Array.isArray(Ge.content)&&Ge.content.length==0||nt=="Sh33tJ5")){var Vt=Ne,Qt=be(nt.length);for(Se=0;Se<nt.length;++Se)Qt.write_shift(1,nt.charCodeAt(Se)&127);Qt=Qt.slice(0,Qt.l),ze[Ke]=typeof Ge.content=="string"?lk.bstr(Ge.content,0):lk.buf(Ge.content,0);var Sr=typeof Ge.content=="string"?wa(Ge.content):Ge.content;_e==8&&(Sr=ce(Sr)),Z=be(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Fe),Z.write_shift(2,_e),Ge.mt?i(Z,Ge.mt):Z.write_shift(4,0),Z.write_shift(-4,ze[Ke]),Z.write_shift(4,Sr.length),Z.write_shift(4,Ge.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),Ne+=Z.length,V.push(Z),Ne+=Qt.length,V.push(Qt),Ne+=Sr.length,V.push(Sr),Z=be(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Fe),Z.write_shift(2,_e),Z.write_shift(4,0),Z.write_shift(-4,ze[Ke]),Z.write_shift(4,Sr.length),Z.write_shift(4,Ge.content.length),Z.write_shift(2,Qt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Vt),_t+=Z.l,q.push(Z),_t+=Qt.length,q.push(Qt),++Ke}return Z=be(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Ke),Z.write_shift(2,Ke),Z.write_shift(4,_t),Z.write_shift(4,Ne),Z.write_shift(2,0),Dr([Dr(V),Dr(q),Z])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ar(F,X){if(F.ctype)return F.ctype;var W=F.name||"",V=W.match(/\.([^\.]+)$/);return V&&mr[V[1]]||X&&(V=(W=X).match(/[\.\\]([^\.\\])+$/),V&&mr[V[1]])?mr[V[1]]:"application/octet-stream"}function xn(F){for(var X=yh(F),W=[],V=0;V<X.length;V+=76)W.push(X.slice(V,V+76));return W.join(`\r
`)+`\r
`}function Aa(F){var X=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Se){var Ne=Se.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],V=X.split(`\r
`),q=0;q<V.length;++q){var Z=V[q];if(Z.length==0){W.push("");continue}for(var _e=0;_e<Z.length;){var Fe=76,ye=Z.slice(_e,_e+Fe);ye.charAt(Fe-1)=="="?Fe--:ye.charAt(Fe-2)=="="?Fe-=2:ye.charAt(Fe-3)=="="&&(Fe-=3),ye=Z.slice(_e,_e+Fe),_e+=Fe,_e<Z.length&&(ye+="="),W.push(ye)}}return W.join(`\r
`)}function Gn(F){for(var X=[],W=0;W<F.length;++W){for(var V=F[W];W<=F.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+F[++W];X.push(V)}for(var q=0;q<X.length;++q)X[q]=X[q].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return wa(X.join(`\r
`))}function Yn(F,X,W){for(var V="",q="",Z="",_e,Fe=0;Fe<10;++Fe){var ye=X[Fe];if(!ye||ye.match(/^\s*$/))break;var Se=ye.match(/^([^:]*?):\s*([^\s].*)$/);if(Se)switch(Se[1].toLowerCase()){case"content-location":V=Se[2].trim();break;case"content-type":Z=Se[2].trim();break;case"content-transfer-encoding":q=Se[2].trim();break}}switch(++Fe,q.toLowerCase()){case"base64":_e=wa(ro(X.slice(Fe).join("")));break;case"quoted-printable":_e=Gn(X.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var Ne=qn(F,V.slice(W.length),_e,{unsafe:!0});Z&&(Ne.ctype=Z)}function Xn(F,X){if(Q(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=X&&X.root||"",V=(Bt&&Buffer.isBuffer(F)?F.toString("binary"):Q(F)).split(`\r
`),q=0,Z="";for(q=0;q<V.length;++q)if(Z=V[q],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),W||(W=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),Z.slice(0,W.length)!=W););var _e=(V[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Fe="--"+(_e[1]||""),ye=[],Se=[],Ne={FileIndex:ye,FullPaths:Se};P(Ne);var Ke,Qe=0;for(q=0;q<V.length;++q){var nt=V[q];nt!==Fe&&nt!==Fe+"--"||(Qe++&&Yn(Ne,V.slice(Ke,q),W),Ke=q)}return Ne}function qa(F,X){var W=X||{},V=W.boundary||"SheetJS";V="------="+V;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],Z=F.FullPaths[0],_e=Z,Fe=F.FileIndex[0],ye=1;ye<F.FullPaths.length;++ye)if(_e=F.FullPaths[ye].slice(Z.length),Fe=F.FileIndex[ye],!(!Fe.size||!Fe.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_t){return"_x"+_t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_t){return"_u"+_t.charCodeAt(0).toString(16)+"_"});for(var Se=Fe.content,Ne=Bt&&Buffer.isBuffer(Se)?Se.toString("binary"):Q(Se),Ke=0,Qe=Math.min(1024,Ne.length),nt=0,Ge=0;Ge<=Qe;++Ge)(nt=Ne.charCodeAt(Ge))>=32&&nt<128&&++Ke;var ze=Ke>=Qe*4/5;q.push(V),q.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+_e),q.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),q.push("Content-Type: "+Ar(Fe,_e)),q.push(""),q.push(ze?Aa(Ne):xn(Ne))}return q.push(V+`--\r
`),q.join(`\r
`)}function ua(F){var X={};return P(X,F),X}function qn(F,X,W,V){var q=V&&V.unsafe;q||P(F);var Z=!q&&Xt.find(F,X);if(!Z){var _e=F.FullPaths[0];X.slice(0,_e.length)==_e?_e=X:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+X).replace("//","/")),Z={name:a(X),type:2},F.FileIndex.push(Z),F.FullPaths.push(_e),q||Xt.utils.cfb_gc(F)}return Z.content=W,Z.size=W?W.length:0,V&&(V.CLSID&&(Z.clsid=V.CLSID),V.mt&&(Z.mt=V.mt),V.ct&&(Z.ct=V.ct)),Z}function Rc(F,X){P(F);var W=Xt.find(F,X);if(W){for(var V=0;V<F.FileIndex.length;++V)if(F.FileIndex[V]==W)return F.FileIndex.splice(V,1),F.FullPaths.splice(V,1),!0}return!1}function Ri(F,X,W){P(F);var V=Xt.find(F,X);if(V){for(var q=0;q<F.FileIndex.length;++q)if(F.FileIndex[q]==V)return F.FileIndex[q].name=a(W),F.FullPaths[q]=W,!0}return!1}function Ii(F){L(F,!0)}return t.find=O,t.read=j,t.parse=f,t.write=te,t.writeFile=ie,t.utils={cfb_new:ua,cfb_add:qn,cfb_del:Rc,cfb_mov:Ri,cfb_gc:Ii,ReadShift:Fu,CheckField:q3,prep_blob:Bn,bconcat:Dr,use_zlib:se,_deflateRaw:et,_inflateRaw:xt,consts:J},t})(),HJ;function ck(e){return typeof e=="string"?kp(e):Array.isArray(e)?xJ(e):e}function Pd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=kp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?rd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([ck(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+mJ(new Uint8Array(ck(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(t)&&(t=tl(t)),d.write(t),d.close(),t}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+e)}function Fr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function uk(e,t){for(var r=[],n=Fr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function fb(e){for(var t=[],r=Fr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function jp(e){for(var t=[],r=Fr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function KJ(e){for(var t=[],r=Fr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var R3=Date.UTC(1899,11,30,0,0,0),VJ=Date.UTC(1899,11,31,0,0,0),GJ=Date.UTC(1904,0,1,0,0,0);function pn(e,t){var r=e.getTime(),n=(r-R3)/(1440*60*1e3);return t?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Ql(e){if(e>=60&&e<61)return e;var t=new Date;return t.setTime((e>60?e:e+1)*24*60*60*1e3+R3),t}var YJ=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,XJ=/^(\d+)-(\d+)-(\d+)$/,I3=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function ca(e,t){if(e instanceof Date)return e;var r=e.match(YJ);if(r)return new Date((t?GJ:VJ)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=e.match(XJ),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=e.match(I3),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var n=new Date(e);return n}function hb(e,t){if(Bt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}var n=[],a=0;try{for(a=0;a<e.length-65536;a+=65536)n.push(String.fromCharCode.apply(0,e.slice(a,a+65536)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{try{for(;a<e.length-16384;a+=16384)n.push(String.fromCharCode.apply(0,e.slice(a,a+16384)));n.push(String.fromCharCode.apply(0,e.slice(a)))}catch{for(;a!=e.length;++a)n.push(String.fromCharCode(e[a]))}}return n.join("")}function On(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=On(e[r]));return t}function cr(e,t){for(var r="";r.length<t;)r+=e;return r}function ns(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var qJ=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,QJ=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,ZJ=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,JJ=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function eee(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+(e[7]=="p"?12:0),0,0,0))}function tee(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],parseFloat(e[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],parseFloat(e[3])*1e3)):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}var ree=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eh(e){if(ZJ.test(e))return e.indexOf("Z")==-1?Op(new Date(e)):new Date(e);var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(qJ);if(n)return eee(n);if(n=r.match(QJ),n)return tee(n);if(n=r.match(I3),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var a=new Date(JJ&&e.indexOf("UTC")==-1?e+" UTC":e),i=new Date(NaN),s=a.getYear();a.getMonth();var l=a.getDate();if(isNaN(l))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&ree.indexOf(t)==-1)return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return s<0||s>8099||e.match(/[^-0-9:,\/\\\ ]/)?i:a}function hc(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function Op(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function St(e,t,r){if(e.FullPaths){if(Array.isArray(r)&&typeof r[0]=="string"&&(r=r.join("")),typeof r=="string"){var n;return Bt?n=Di(r):n=gJ(r),Xt.utils.cfb_add(e,t,n)}Xt.utils.cfb_add(e,t,r)}else e.file(t,r)}function pb(){return Xt.utils.cfb_new()}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,nee={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},mb=fb(nee),xb=/[&<>'"]/g,aee=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Nt(e){var t=e+"";return t.replace(xb,function(r){return mb[r]}).replace(aee,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function dk(e){return Nt(e).replace(/ /g,"_x0020_")}var F3=/[\u0000-\u001f]/g;function _v(e){var t=e+"";return t.replace(xb,function(r){return mb[r]}).replace(/\n/g,"<br/>").replace(F3,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function iee(e){var t=e+"";return t.replace(xb,function(r){return mb[r]}).replace(F3,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function see(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function oee(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Sv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function fk(e){var t=el(2*e.length),r,n,a=1,i=0,s=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function hk(e){return Di(e,"binary").toString("utf8")}var f0="foo bar baz",Zl=Bt&&(hk(f0)==Sv(f0)&&hk||fk(f0)==Sv(f0)&&fk)||Sv,rd=Bt?function(e){return Di(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},lee=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),M3=/(^\s|\s$|\n)/;function dn(e,t){return"<"+e+(t.match(M3)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function nd(e){return Fr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,r){return"<"+e+(r!=null?nd(r):"")+(t!=null?(t.match(M3)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function V1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function cee(e,t){switch(typeof e){case"string":var r=Xe("vt:lpwstr",Nt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",Nt(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",V1(e));throw new Error("Unable to serialize "+e)}var en={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ac=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ba={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uee(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function dee(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var pk=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},mk=Bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Di(t)})):pk(e)}:pk,xk=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ou(e,a)));return n.join("").replace(Iu,"")},gb=Bt?function(e,t,r){return!Buffer.isBuffer(e)||!wh?xk(e,t,r):e.toString("utf16le",t,r).replace(Iu,"")}:xk,gk=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},L3=Bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):gk(e,t,r)}:gk,vk=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Kl(e,a)));return n.join("")},jd=Bt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):vk(t,r,n)}:vk,B3=function(e,t){var r=_a(e,t);return r>0?jd(e,t+4,t+4+r-1):""},$3=B3,U3=function(e,t){var r=_a(e,t);return r>0?jd(e,t+4,t+4+r-1):""},z3=U3,W3=function(e,t){var r=2*_a(e,t);return r>0?jd(e,t+4,t+4+r-1):""},H3=W3,K3=function(t,r){var n=_a(t,r);return n>0?gb(t,r+4,r+4+n):""},V3=K3,G3=function(e,t){var r=_a(e,t);return r>0?jd(e,t+4,t+4+r):""},Y3=G3,X3=function(e,t){return uee(e,t)},Th=X3,vb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Bt&&($3=function(t,r){if(!Buffer.isBuffer(t))return B3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z3=function(t,r){if(!Buffer.isBuffer(t))return U3(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},H3=function(t,r){if(!Buffer.isBuffer(t)||!wh)return W3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},V3=function(t,r){if(!Buffer.isBuffer(t)||!wh)return K3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Y3=function(t,r){if(!Buffer.isBuffer(t))return G3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Th=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):X3(t,r)},vb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Kl=function(e,t){return e[t]},Ou=function(e,t){return e[t+1]*256+e[t]},fee=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},_a=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ro=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},hee=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Fu(e,t){var r="",n,a,i=[],s,l,d,h;switch(t){case"dbcs":if(h=this.l,Bt&&Buffer.isBuffer(this)&&wh)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(Ou(this,h)),h+=2;e*=2;break;case"utf8":r=jd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=gb(this,this.l,this.l+e);break;case"wstr":return Fu.call(this,e,"dbcs");case"lpstr-ansi":r=$3(this,this.l),e=4+_a(this,this.l);break;case"lpstr-cp":r=z3(this,this.l),e=4+_a(this,this.l);break;case"lpwstr":r=H3(this,this.l),e=4+2*_a(this,this.l);break;case"lpp4":e=4+_a(this,this.l),r=V3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_a(this,this.l),r=Y3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Kl(this,this.l+e++))!==0;)i.push(u0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Ou(this,this.l+e))!==0;)i.push(u0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return s=Kl(this,h),this.l=h+1,l=Fu.call(this,e-d,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(u0(Ou(this,h))),h+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return s=Kl(this,h),this.l=h+1,l=Fu.call(this,e-d,s?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(u0(Kl(this,h))),h+=1}r=i.join("");break;default:switch(e){case 1:return n=Kl(this,this.l),this.l++,n;case 2:return n=(t==="i"?fee:Ou)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ro:hee)(this,this.l),this.l+=4,n):(a=_a(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Th(this,this.l):a=Th([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=L3(this,this.l,e);break}}return this.l+=e,r}var pee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mee=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},xee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function gee(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)xee(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,pee(this,t,this.l);break;case 8:if(n=8,r==="f"){dee(this,t,this.l);break}case 16:break;case-4:n=4,mee(this,t,this.l);break}return this.l+=n,this}function q3(e,t){var r=L3(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Bn(e,t){e.l=t,e.read_shift=Fu,e.chk=q3,e.write_shift=gee}function Oi(e,t){e.l+=t}function be(e){var t=el(e);return Bn(t,0),t}function An(){var e=[],t=Bt?16384:2048;Bt&&be(t).copy;var r=function(f){var p=be(f);return Bn(p,0),p},n=r(t),a=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},s=function(){return a(),Dr(e)},l=function(){return a(),e},d=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:d,end:s,_bufs:e,end2:l}}function Me(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Nse[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&vb(r)&&e.push(r)}}function Mu(e,t,r){var n=On(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yk(e,t,r){var n=On(e);return n.s=Mu(n.s,t.s,r),n.e=Mu(n.e,t.s,r),n}function Lu(e,t){if(e.cRel&&e.c<0)for(e=On(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=On(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=vr(e);return!e.cRel&&e.cRel!=null&&(r=wee(r)),!e.rRel&&e.rRel!=null&&(r=vee(r)),r}function Nv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yt(e.s.r)+":"+(e.e.rRel?"":"$")+Yt(e.e.r):Lu(e.s,t.biff)+":"+Lu(e.e,t.biff)}function yb(e){return parseInt(yee(e),10)-1}function Yt(e){return""+(e+1)}function vee(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yee(e){return e.replace(/\$(\d+)$/,"$1")}function wb(e){for(var t=bee(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function wee(e){return e.replace(/^([A-Z])/,"$$$1")}function bee(e){return e.replace(/^\$([A-Z])/,"$1")}function _ee(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function vr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function fn(e){var t=e.indexOf(":");return t==-1?{s:dr(e),e:dr(e)}:{s:dr(e.slice(0,t)),e:dr(e.slice(t+1))}}function Mr(e,t){return typeof t>"u"||typeof t=="number"?Mr(e.s,e.e):(typeof e!="string"&&(e=vr(e)),typeof t!="string"&&(t=vr(t)),e==t?e:e+":"+t)}function ad(e){var t=fn(e);return"$"+Ht(t.s.c)+"$"+Yt(t.s.r)+":$"+Ht(t.e.c)+"$"+Yt(t.e.r)}function id(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function ir(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function wk(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=us(e.z,r?pn(t):t)}catch{}try{return e.w=us((e.XF||{}).numFmtId||(r?14:0),r?pn(t):t)}catch{return""+t}}function ds(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Hn[e.v]||e.v:t==null?wk(e,e.v):wk(e,t))}function Pc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function See(e){var t={},r=e||{};return r.dense&&(t["!data"]=[]),t}function Q3(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=e||(a?{"!data":[]}:{});a&&!i["!data"]&&(i["!data"]=[]);var s=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var d=typeof n.origin=="string"?dr(n.origin):n.origin;s=d.r,l=d.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=ir(i["!ref"]);h.s.c=f.s.c,h.s.r=f.s.r,h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),s==-1&&(h.e.r=s=i["!ref"]?f.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var p=[],x=!1,g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");var b=s+g;a&&(i["!data"][b]||(i["!data"][b]=[]),p=i["!data"][b]);for(var _=t[g],w=0;w!=_.length;++w)if(!(typeof _[w]>"u")){var S={v:_[w],t:""},T=l+w;if(h.s.r>b&&(h.s.r=b),h.s.c>T&&(h.s.c=T),h.e.r<b&&(h.e.r=b),h.e.c<T&&(h.e.c=T),x=!0,_[w]&&typeof _[w]=="object"&&!Array.isArray(_[w])&&!(_[w]instanceof Date))S=_[w];else if(Array.isArray(S.v)&&(S.f=_[w][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?isFinite(S.v)?S.t="n":isNaN(S.v)?(S.t="e",S.v=15):(S.t="e",S.v=7):typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||ar[14],n.UTC||(S.v=Op(S.v)),n.cellDates?(S.t="d",S.w=us(S.z,pn(S.v,n.date1904))):(S.t="n",S.v=pn(S.v,n.date1904),S.w=us(S.z,S.v))):S.t="s";if(a)p[T]&&p[T].z&&(S.z=p[T].z),p[T]=S;else{var E=Ht(T)+(b+1);i[E]&&i[E].z&&(S.z=i[E].z),i[E]=S}}}return x&&h.s.c<104e5&&(i["!ref"]=Mr(h)),i}function jc(e,t){return Q3(null,e,t)}function Nee(e){return e.read_shift(4,"i")}function ci(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function Pn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Wr(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Eee(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Tee(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function bb(e,t){var r=e.l,n=e.read_shift(1),a=Pn(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var l=e.read_shift(4),d=0;d!=l;++d)i.push(Eee(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Cee(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),Wr(e.t,t),r?t.slice(0,t.l):t}var kee=bb;function Aee(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),Wr(e.t,t),t.write_shift(4,1),Tee({},t),r?t.slice(0,t.l):t}function Xa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ll(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function cl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ul(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Pee=Pn,Z3=Wr;function Dp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function sd(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jee=Pn,G1=Dp,_b=sd;function Sb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Th([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ro(t,0)>>2;return r?a/100:a}function J3(e,t){t==null&&(t=be(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function e5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Oee(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var dl=e5,Oc=Oee;function Dc(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function nl(e,t){return(t||be(8)).write_shift(8,e,"f")}function Dee(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var h=zee[a];h&&(t.rgb=Ok(h));break;case 2:t.rgb=Ok([s,l,d]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Ch(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Ree(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Iee(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var t5=2,ga=3,h0=11,kh=19,p0=64,Fee=65,Mee=71,Lee=4108,Bee=4126,ln=80,bk={1:{n:"CodePage",t:t5},2:{n:"Category",t:ln},3:{n:"PresentationFormat",t:ln},4:{n:"ByteCount",t:ga},5:{n:"LineCount",t:ga},6:{n:"ParagraphCount",t:ga},7:{n:"SlideCount",t:ga},8:{n:"NoteCount",t:ga},9:{n:"HiddenCount",t:ga},10:{n:"MultimediaClipCount",t:ga},11:{n:"ScaleCrop",t:h0},12:{n:"HeadingPairs",t:Lee},13:{n:"TitlesOfParts",t:Bee},14:{n:"Manager",t:ln},15:{n:"Company",t:ln},16:{n:"LinksUpToDate",t:h0},17:{n:"CharacterCount",t:ga},19:{n:"SharedDoc",t:h0},22:{n:"HyperlinksChanged",t:h0},23:{n:"AppVersion",t:ga,p:"version"},24:{n:"DigSig",t:Fee},26:{n:"ContentType",t:ln},27:{n:"ContentStatus",t:ln},28:{n:"Language",t:ln},29:{n:"Version",t:ln},255:{},2147483648:{n:"Locale",t:kh},2147483651:{n:"Behavior",t:kh},1919054434:{}},_k={1:{n:"CodePage",t:t5},2:{n:"Title",t:ln},3:{n:"Subject",t:ln},4:{n:"Author",t:ln},5:{n:"Keywords",t:ln},6:{n:"Comments",t:ln},7:{n:"Template",t:ln},8:{n:"LastAuthor",t:ln},9:{n:"RevNumber",t:ln},10:{n:"EditTime",t:p0},11:{n:"LastPrinted",t:p0},12:{n:"CreatedDate",t:p0},13:{n:"ModifiedDate",t:p0},14:{n:"PageCount",t:ga},15:{n:"WordCount",t:ga},16:{n:"CharCount",t:ga},17:{n:"Thumbnail",t:Mee},18:{n:"Application",t:ln},19:{n:"DocSecurity",t:ga},255:{},2147483648:{n:"Locale",t:kh},2147483651:{n:"Behavior",t:kh},1919054434:{}};function $ee(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Uee=$ee([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zee=On(Uee),Hn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ei={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Hee={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},m0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function r5(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function n5(e,t,r){var n=KJ(Hee),a=[],i;a[a.length]=Br,a[a.length]=Xe("Types",null,{xmlns:en.CT,"xmlns:xsd":en.xsd,"xmlns:xsi":en.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Xe("Default",null,{Extension:h[0],ContentType:h[1]})}));var s=function(h){e[h]&&e[h].length>0&&(i=e[h][0],a[a.length]=Xe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:m0[h][t.bookType]||m0[h].xlsx}))},l=function(h){(e[h]||[]).forEach(function(f){a[a.length]=Xe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:m0[h][t.bookType]||m0[h].xlsx})})},d=function(h){(e[h]||[]).forEach(function(f){a[a.length]=Xe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:n[h][0]})})};return s("workbooks"),l("sheets"),l("charts"),d("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),l("metadata"),d("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function a5(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Jl(e){var t=[Br,Xe("Relationships",null,{xmlns:en.RELS})];return Fr(e["!id"]).forEach(function(r){t[t.length]=Xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Lt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Pt.HLINK,Pt.XPATH,Pt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function Kee(e){var t=[Br];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Sk(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Vee(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Gee(e){var t=[Br];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Sk(e[r][0],e[r][1])),t.push(Vee("",e[r][0]));return t.push(Sk("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function i5(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vh.version+"</meta:generator></office:meta></office:document-meta>"}var zo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ev(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Nt(t),n[n.length]=r?Xe(e,t,r):dn(e,t))}function s5(e,t){var r=t||{},n=[Br,Xe("cp:coreProperties",null,{"xmlns:cp":en.CORE_PROPS,"xmlns:dc":en.dc,"xmlns:dcterms":en.dcterms,"xmlns:dcmitype":en.dcmitype,"xmlns:xsi":en.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ev("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:V1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Ev("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:V1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=zo.length;++i){var s=zo[i],l=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Ev(s[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ec=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],o5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function l5(e){var t=[],r=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=Br,t[t.length]=Xe("Properties",null,{xmlns:en.EXT_PROPS,"xmlns:vt":en.vt}),ec.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Nt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Nt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function c5(e){var t=[Br,Xe("Properties",null,{xmlns:en.CUST_PROPS,"xmlns:vt":en.vt})];if(!e)return t.join("");var r=1;return Fr(e).forEach(function(a){++r,t[t.length]=Xe("property",cee(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Nt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Nk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Yee(e,t){var r=[];return Fr(Nk).map(function(n){for(var a=0;a<zo.length;++a)if(zo[a][1]==n)return zo[a];for(a=0;a<ec.length;++a)if(ec[a][1]==n)return ec[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(dn(Nk[n[1]]||n[1],a))}}),Xe("DocumentProperties",r.join(""),{xmlns:ba.o})}function Xee(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Fr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<zo.length;++s)if(i==zo[s][1])return;for(s=0;s<ec.length;++s)if(i==ec[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var l=e[i],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l=String(l),a.push(Xe(dk(i),l,{"dt:dt":d}))}}),t&&Fr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Xe(dk(i),s,{"dt:dt":l}))}}),"<"+n+' xmlns="'+ba.o+'">'+a.join("")+"</"+n+">"}function qee(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=be(8);return s.write_shift(4,n),s.write_shift(4,a),s}function Ek(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=qee(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Dr([r,n])}var u5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Qee(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Tk(e,t,r){var n=be(8),a=[],i=[],s=8,l=0,d=be(8),h=be(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),i.push(d),a.push(h),s+=8+d.length,!t){h=be(8),h.write_shift(4,0),a.unshift(h);var f=[be(4)];for(f[0].write_shift(4,e.length),l=0;l<e.length;++l){var p=e[l][0];for(d=be(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,l+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);f.push(d)}d=Dr(f),i.unshift(d),s+=8+d.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(u5.indexOf(e[l][0])>-1||o5.indexOf(e[l][0])>-1)&&e[l][1]!=null){var x=e[l][1],g=0;if(t){g=+t[e[l][0]];var b=r[g];if(b.p=="version"&&typeof x=="string"){var _=x.split(".");x=(+_[0]<<16)+(+_[1]||0)}d=Ek(b.t,x)}else{var w=Qee(x);w==-1&&(w=31,x=String(x)),d=Ek(w,x)}i.push(d),h=be(8),h.write_shift(4,t?g:2+l),a.push(h),s+=8+d.length}var S=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,S),S+=i[l].length;return n.write_shift(4,s),n.write_shift(4,i.length),Dr([n].concat(a).concat(i))}function Ck(e,t,r,n,a,i){var s=be(a?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Xt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var d=Tk(e,r,n);if(l.push(d),a){var h=Tk(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+d.length),l.push(h)}return Dr(l)}function Zee(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Jee(e,t){return e.read_shift(t)===1}function En(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function N0(e){return e.read_shift(2,"u")}function Ua(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function d5(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function f5(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=qi;if(r&&r.biff>=8&&(qi=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return qi=i,l}function ete(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Dr(a)}function tte(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rte(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):tte(e,n,r)}function nte(e,t,r){if(r.biff>5)return rte(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function h5(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function kk(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function ate(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),kk(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&kk(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,n.length-3*d+1),r=0;r<n.length-3*d;++r)t.write_shift(1,n.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function al(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ite(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function ste(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function p5(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Nb(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=be(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function ote(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function lte(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function cte(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=ete(e[a]);var i=Dr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function ute(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function dte(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function fte(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=be(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function hte(e,t,r,n){var a=be(10);return al(e,t,n,a),a.write_shift(4,r),a}function pte(e,t,r,n,a){var i=!a||a.biff==8,s=be(8+ +i+(1+i)*r.length);return al(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function mte(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function xte(e){var t=be(1+e.length);return t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function gte(e){var t=be(3+e.length);return t.l+=2,t.write_shift(1,e.length),t.write_shift(e.length,e,"sbcs"),t}function vte(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Ak(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function yte(e){var t=be(4);return t.l+=2,t.write_shift(1,e.numFmtId),t.l++,t}function m5(e){var t=be(12);return t.l++,t.write_shift(1,e.numFmtId),t.l+=10,t}var wte=m5;function bte(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Tv(e,t,r,n,a,i){var s=be(8);return al(e,t,n,s),d5(r,i,s),s}function _te(e,t,r,n){var a=be(14);return al(e,t,n,a),nl(r,a),a}function Ste(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return Pk(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(ite(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Pk(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=f5(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Cv(e,t,r,n){var a=be(6+(n||e.length));return a.write_shift(2,t),a.write_shift(2,r),a.write_shift(2,n||e.length),a.write_shift(e.length,e,"sbcs"),a}function Nte(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)p5(e[r],t);return t}function Ete(e){var t=be(24),r=dr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Dr([t,ate(e[1])])}function Tte(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=dr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Cte(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function kte(e,t,r){if(!r.cellStyles)return Oi(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var h={s:a,e:i,w:s,ixfe:l,flags:d};return(r.biff>=5||!r.biff)&&(h.level=d>>8&7),h}function Ate(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Pte(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Od(e,t,r,n,a){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(1,n||0),e.write_shift(1,a||0),e.write_shift(1,0),e}function jte(e,t,r,n,a){var i=be(15);return Od(i,e,t,n||0,a||0),i.write_shift(8,r,"f"),i}function Ote(e,t,r,n,a){var i=be(9);return Od(i,e,t,n||0,a||0),i.write_shift(2,r),i}var Dte=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=fb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,d){var h=[],f=el(1);switch(d.type){case"base64":f=wa(ro(l));break;case"binary":f=wa(l);break;case"buffer":case"array":f=l;break}Bn(f,0);var p=f.read_shift(1),x=!!(p&136),g=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,x=!0;break;case 49:g=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,w=521;p==2&&(_=f.read_shift(2)),f.l+=3,p!=2&&(_=f.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(w=f.read_shift(2));var S=f.read_shift(2);d.codepage,p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&e[f[f.l]],f.l+=1,f.l+=2),b&&(f.l+=36);for(var T=[],E={},k=Math.min(f.length,p==2?521:w-10-(g?264:0)),A=b?32:11;f.l<k&&f[f.l]!=13;)switch(E={},E.name=tl(f.slice(f.l,f.l+A)).replace(/[\u0000\r\n][\S\s]*$/g,""),f.l+=A,E.type=String.fromCharCode(f.read_shift(1)),p!=2&&!b&&(E.offset=f.read_shift(4)),E.len=f.read_shift(1),p==2&&(E.offset=f.read_shift(2)),E.dec=f.read_shift(1),E.name.length&&T.push(E),p!=2&&(f.l+=b?13:14),E.type){case"B":(!g||E.len!=8)&&d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var j=0,P=0;for(h[0]=[],P=0;P!=T.length;++P)h[0][P]=T[P].name;for(;_-- >0;){if(f[f.l]===42){f.l+=S;continue}for(++f.l,h[++j]=[],P=0,P=0;P!=T.length;++P){var D=f.slice(f.l,f.l+T[P].len);f.l+=T[P].len,Bn(D,0);var L=tl(D);switch(T[P].type){case"C":L.trim().length&&(h[j][P]=L.replace(/([^\s])\s+$/,"$1"));break;case"D":L.length===8?(h[j][P]=new Date(Date.UTC(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8),0,0,0,0)),d&&d.UTC||(h[j][P]=hc(h[j][P]))):h[j][P]=L;break;case"F":h[j][P]=parseFloat(L.trim());break;case"+":case"I":h[j][P]=b?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":h[j][P]=!0;break;case"N":case"F":h[j][P]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));h[j][P]="##MEMO##"+(b?parseInt(L.trim(),10):D.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(h[j][P]=+L||0);break;case"@":h[j][P]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":{var I=D.read_shift(4),O=D.read_shift(4);if(I==0&&O==0)break;h[j][P]=new Date((I-2440588)*864e5+O),d&&d.UTC||(h[j][P]=hc(h[j][P]))}break;case"Y":h[j][P]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[j][P]=-D.read_shift(-8,"f");break;case"B":if(g&&T[P].len==8){h[j][P]=D.read_shift(8,"f");break}case"G":case"P":D.l+=T[P].len;break;case"0":if(T[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[P].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=T,h}function n(l,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var f=jc(r(l,h),h);return f["!cols"]=h.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete h.DBF,f}function a(l,d){try{var h=Pc(n(l,d),d);return h.bookType="dbf",h}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,d){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=d||{},f=qi;if(+h.codepage>=0&&td(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=An(),x=Q1(l,{header:1,raw:!0,cellDates:!0}),g=x[0],b=x.slice(1),_=l["!cols"]||[],w=0,S=0,T=0,E=1;for(w=0;w<g.length;++w){if(((_[w]||{}).DBF||{}).name){g[w]=_[w].DBF.name,++T;continue}if(g[w]!=null){if(++T,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(S=0;S<1024;++S)if(g.indexOf(g[w]+"_"+S)==-1){g[w]+="_"+S;break}}}}var k=ir(l["!ref"]),A=[],j=[],P=[];for(w=0;w<=k.e.c-k.s.c;++w){var D="",L="",I=0,O=[];for(S=0;S<b.length;++S)b[S][w]!=null&&O.push(b[S][w]);if(O.length==0||g[w]==null){A[w]="?";continue}for(S=0;S<O.length;++S){switch(typeof O[S]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=O[S]instanceof Date?"D":"C";break;default:L="C"}I=Math.max(I,String(O[S]).length),D=D&&D!=L?"C":L}I>250&&(I=250),L=((_[w]||{}).DBF||{}).type,L=="C"&&_[w].DBF.len>I&&(I=_[w].DBF.len),D=="B"&&L=="N"&&(D="N",P[w]=_[w].DBF.dec,I=_[w].DBF.len),j[w]=D=="C"||L=="N"?I:i[D]||0,E+=j[w],A[w]=D}var M=p.next(32);for(M.write_shift(4,318902576),M.write_shift(4,b.length),M.write_shift(2,296+32*T),M.write_shift(2,E),w=0;w<4;++w)M.write_shift(4,0);var re=+t[qi]||3;for(M.write_shift(4,0|re<<8),e[re]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+qi+", using 1252"),qi=1252),w=0,S=0;w<g.length;++w)if(g[w]!=null){var oe=p.next(32),ee=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);oe.write_shift(1,ee,"sbcs"),oe.write_shift(1,A[w]=="?"?"C":A[w],"sbcs"),oe.write_shift(4,S),oe.write_shift(1,j[w]||i[A[w]]||0),oe.write_shift(1,P[w]||0),oe.write_shift(1,2),oe.write_shift(4,0),oe.write_shift(1,0),oe.write_shift(4,0),oe.write_shift(4,0),S+=j[w]||i[A[w]]||0}var fe=p.next(264);for(fe.write_shift(4,13),w=0;w<65;++w)fe.write_shift(4,0);for(w=0;w<b.length;++w){var J=p.next(E);for(J.write_shift(1,0),S=0;S<g.length;++S)if(g[S]!=null)switch(A[S]){case"L":J.write_shift(1,b[w][S]==null?63:b[w][S]?84:70);break;case"B":J.write_shift(8,b[w][S]||0,"f");break;case"N":var ie="0";for(typeof b[w][S]=="number"&&(ie=b[w][S].toFixed(P[S]||0)),ie.length>j[S]&&(ie=ie.slice(0,j[S])),T=0;T<j[S]-ie.length;++T)J.write_shift(1,32);J.write_shift(1,ie,"sbcs");break;case"D":b[w][S]?(J.write_shift(4,("0000"+b[w][S].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(b[w][S].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+b[w][S].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var Q=J.l,te=String(b[w][S]!=null?b[w][S]:"").slice(0,j[S]);for(J.write_shift(1,te,"cpstr"),Q+=j[S]-J.l,T=0;T<Q;++T)J.write_shift(1,32);break}}return qi=f,p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),Rte=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Fr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+Fr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(g,b){var _=e[b];return typeof _=="number"?JC(_):_},n=function(g,b,_){var w=b.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return w==59?g:JC(w)};e["|"]=254;var a=function(g){return g.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function i(g,b){switch(b.type){case"base64":return s(ro(g),b);case"binary":return s(g,b);case"buffer":return s(Bt&&Buffer.isBuffer(g)?g.toString("binary"):tl(g),b);case"array":return s(hb(g),b)}throw new Error("Unrecognized type "+b.type)}function s(g,b){var _=g.split(/[\n\r]+/),w=-1,S=-1,T=0,E=0,k=[],A=[],j=null,P={},D=[],L=[],I=[],O=0,M,re={Workbook:{WBProps:{},Names:[]}};for(+b.codepage>=0&&td(+b.codepage);T!==_.length;++T){O=0;var oe=_[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ee=oe.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),fe=ee[0],J;if(oe.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"V":{var ie=parseInt(ee[E].slice(1),10);ie>=1&&ie<=4&&(re.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(ee[1].charAt(0)){case"P":A.push(oe.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Q={Sheet:0};for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"N":Q.Name=ee[E].slice(1);break;case"E":Q.Ref=(b&&b.sheet||"Sheet1")+"!"+Ik(ee[E].slice(1));break}re.Workbook.Names.push(Q)}break;case"C":var te=!1,H=!1,se=!1,Y=!1,ce=-1,ue=-1,me="",Re="z",U="";for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"A":U=ee[E].slice(1);break;case"X":S=parseInt(ee[E].slice(1),10)-1,H=!0;break;case"Y":for(w=parseInt(ee[E].slice(1),10)-1,H||(S=0),M=k.length;M<=w;++M)k[M]=[];break;case"K":J=ee[E].slice(1),J.charAt(0)==='"'?(J=J.slice(1,J.length-1),Re="s"):J==="TRUE"||J==="FALSE"?(J=J==="TRUE",Re="b"):J.charAt(0)=="#"&&Ei[J]!=null?(Re="e",J=Ei[J]):isNaN(ns(J))||(J=ns(J),Re="n",j!==null&&rl(j)&&b.cellDates&&(J=Ql(re.Workbook.WBProps.date1904?J+1462:J),Re=typeof J=="number"?"n":"d")),te=!0;break;case"E":Y=!0,me=Ik(ee[E].slice(1),{r:w,c:S});break;case"S":se=!0;break;case"G":break;case"R":ce=parseInt(ee[E].slice(1),10)-1;break;case"C":ue=parseInt(ee[E].slice(1),10)-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+oe)}if(te&&(k[w][S]?(k[w][S].t=Re,k[w][S].v=J):k[w][S]={t:Re,v:J},j&&(k[w][S].z=j),b.cellText!==!1&&j&&(k[w][S].w=us(k[w][S].z,k[w][S].v,{date1904:re.Workbook.WBProps.date1904})),j=null),se){if(Y)throw new Error("SYLK shared formula cannot have own formula");var B=ce>-1&&k[ce][ue];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");me=Ire(B[1],{r:w-ce,c:S-ue})}me&&(k[w][S]?k[w][S].f=me:k[w][S]={t:"n",f:me}),U&&(k[w][S]||(k[w][S]={t:"z"}),k[w][S].c=[{a:"SheetJSYLK",t:U}]);break;case"F":var K=0;for(E=1;E<ee.length;++E)switch(ee[E].charAt(0)){case"X":S=parseInt(ee[E].slice(1),10)-1,++K;break;case"Y":for(w=parseInt(ee[E].slice(1),10)-1,M=k.length;M<=w;++M)k[M]=[];break;case"M":O=parseInt(ee[E].slice(1),10)/20;break;case"F":break;case"G":break;case"P":j=A[parseInt(ee[E].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(I=ee[E].slice(1).split(" "),M=parseInt(I[0],10);M<=parseInt(I[1],10);++M)O=parseInt(I[2],10),L[M-1]=O===0?{hidden:!0}:{wch:O};break;case"C":S=parseInt(ee[E].slice(1),10)-1,L[S]||(L[S]={});break;case"R":w=parseInt(ee[E].slice(1),10)-1,D[w]||(D[w]={}),O>0?(D[w].hpt=O,D[w].hpx=y5(O)):O===0&&(D[w].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+oe)}K<1&&(j=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+oe)}}return D.length>0&&(P["!rows"]=D),L.length>0&&(P["!cols"]=L),L.forEach(function(z){Eb(z)}),b&&b.sheetRows&&(k=k.slice(0,b.sheetRows)),[k,P,re]}function l(g,b){var _=i(g,b),w=_[0],S=_[1],T=_[2],E=On(b);E.date1904=(((T||{}).Workbook||{}).WBProps||{}).date1904;var k=jc(w,E);Fr(S).forEach(function(j){k[j]=S[j]});var A=Pc(k,b);return Fr(T).forEach(function(j){A[j]=T[j]}),A.bookType="sylk",A}function d(g,b,_,w,S,T){var E="C;Y"+(_+1)+";X"+(w+1)+";K";switch(g.t){case"n":E+=isFinite(g.v)?g.v||0:Hn[isNaN(g.v)?36:7],g.f&&!g.F&&(E+=";E"+Ip(g.f,{r:_,c:w}));break;case"b":E+=g.v?"TRUE":"FALSE";break;case"e":E+=g.w||Hn[g.v]||g.v;break;case"d":E+=pn(ca(g.v,T),T);break;case"s":E+='"'+(g.v==null?"":String(g.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(g,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";A";return w+=a(g.map(function(S){return S.t}).join("")),w}function f(g,b){b.forEach(function(_,w){var S="F;W"+(w+1)+" "+(w+1)+" ";_.hidden?S+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Ah(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Ph(_.wpx)),typeof _.wch=="number"&&(S+=Math.round(_.wch))),S.charAt(S.length-1)!=" "&&g.push(S)})}function p(g,b){b.forEach(function(_,w){var S="F;";_.hidden?S+="M0;":_.hpt?S+="M"+20*_.hpt+";":_.hpx&&(S+="M"+20*jh(_.hpx)+";"),S.length>2&&g.push(S+"R"+(w+1))})}function x(g,b,_){b||(b={}),b._formats=["General"];var w=["ID;PSheetJS;N;E"],S=[],T=ir(g["!ref"]||"A1"),E,k=g["!data"]!=null,A=`\r
`,j=(((_||{}).Workbook||{}).WBProps||{}).date1904,P="General";w.push("P;PGeneral");var D=T.s.r,L=T.s.c,I=[];if(g["!ref"]){for(D=T.s.r;D<=T.e.r;++D)if(!(k&&!g["!data"][D])){for(I=[],L=T.s.c;L<=T.e.c;++L)E=k?g["!data"][D][L]:g[Ht(L)+Yt(D)],!(!E||!E.c)&&I.push(h(E.c,D,L));I.length&&S.push(I.join(A))}}if(g["!ref"]){for(D=T.s.r;D<=T.e.r;++D)if(!(k&&!g["!data"][D])){for(I=[],L=T.s.c;L<=T.e.c;++L)if(E=k?g["!data"][D][L]:g[Ht(L)+Yt(D)],!(!E||E.v==null&&(!E.f||E.F))){if((E.z||(E.t=="d"?ar[14]:"General"))!=P){var O=b._formats.indexOf(E.z);O==-1&&(b._formats.push(E.z),O=b._formats.length-1,w.push("P;P"+E.z.replace(/;/g,";;"))),I.push("F;P"+O+";Y"+(D+1)+";X"+(L+1))}I.push(d(E,g,D,L,b,j))}S.push(I.join(A))}}return w.push("F;P0;DG0G8;M255"),g["!cols"]&&f(w,g["!cols"]),g["!rows"]&&p(w,g["!rows"]),g["!ref"]&&w.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" ")),w.push("O;L;D;B"+(j?";V4":"")+";K47;G100 0.001"),delete b._formats,w.join(A)+A+S.join(A)+A+"E"+A}return{to_workbook:l,from_sheet:x}})(),Ite=(function(){function e(l,d){switch(d.type){case"base64":return t(ro(l),d);case"binary":return t(l,d);case"buffer":return t(Bt&&Buffer.isBuffer(l)?l.toString("binary"):tl(l),d);case"array":return t(hb(l),d)}throw new Error("Unrecognized type "+d.type)}function t(l,d){for(var h=l.split(`
`),f=-1,p=-1,x=0,g=[];x!==h.length;++x){if(h[x].trim()==="BOT"){g[++f]=[],p=0;continue}if(!(f<0)){var b=h[x].trim().split(","),_=b[0],w=b[1];++x;for(var S=h[x]||"";(S.match(/["]/g)||[]).length&1&&x<h.length-1;)S+=`
`+h[++x];switch(S=S.trim(),+_){case-1:if(S==="BOT"){g[++f]=[],p=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?g[f][p]=!0:S==="FALSE"?g[f][p]=!1:isNaN(ns(w))?isNaN(Eh(w).getDate())?g[f][p]=w:(g[f][p]=ca(w),d&&d.UTC||(g[f][p]=hc(g[f][p]))):g[f][p]=ns(w),++p;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),g[f][p++]=S!==""?S:null;break}if(S==="EOD")break}}return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),g}function r(l,d){return jc(e(l,d),d)}function n(l,d){var h=Pc(r(l,d),d);return h.bookType="dif",h}function a(l,d){return"0,"+String(l)+`\r
`+d}function i(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function s(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var d=ir(l["!ref"]),h=l["!data"]!=null,f=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(d.e.r-d.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(d.e.c-d.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],p=d.s.r;p<=d.e.r;++p){for(var x=h?l["!data"][p]:[],g=`-1,0\r
BOT\r
`,b=d.s.c;b<=d.e.c;++b){var _=h?x&&x[b]:l[vr({r:p,c:b})];if(_==null){g+=`1,0\r
""\r
`;continue}switch(_.t){case"n":_.w!=null?g+="0,"+_.w+`\r
V`:_.v!=null?g+=a(_.v,"V"):_.f!=null&&!_.F?g+=i("="+_.f):g+=`1,0\r
""`;break;case"b":g+=_.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":g+=i(isNaN(+_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=us(_.z||ar[14],pn(ca(_.v)))),g+=a(_.w,"V");break;default:g+=`1,0\r
""`}g+=`\r
`}f.push(g)}return f.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:s}})(),x5=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,x){for(var g=p.split(`
`),b=-1,_=-1,w=0,S=[];w!==g.length;++w){var T=g[w].trim().split(":");if(T[0]==="cell"){var E=dr(T[1]);if(S.length<=E.r)for(b=S.length;b<=E.r;++b)S[b]||(S[b]=[]);switch(b=E.r,_=E.c,T[2]){case"t":S[b][_]=e(T[3]);break;case"v":S[b][_]=+T[3];break;case"vtf":var k=T[T.length-1];case"vtc":switch(T[3]){case"nl":S[b][_]=!!+T[4];break;default:S[b][_]=T[T.length-1].charAt(0)=="#"?{t:"e",v:Ei[T[T.length-1]]}:+T[4];break}T[2]=="vtf"&&(S[b][_]=[S[b][_],k])}}}return x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),S}function n(p,x){return jc(r(p,x),x)}function a(p,x){return Pc(n(p,x),x)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(p){if(!p||!p["!ref"])return"";for(var x=[],g=[],b,_="",w=fn(p["!ref"]),S=p["!data"]!=null,T=w.s.r;T<=w.e.r;++T)for(var E=w.s.c;E<=w.e.c;++E)if(_=vr({r:T,c:E}),b=S?(p["!data"][T]||[])[E]:p[_],!(!b||b.v==null||b.t==="z")){switch(g=["cell",_,"t"],b.t){case"s":g.push(t(b.v));break;case"b":g[2]="vt"+(b.f?"f":"c"),g[3]="nl",g[4]=b.v?"1":"0",g[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var k=pn(ca(b.v));g[2]="vtc",g[3]="nd",g[4]=""+k,g[5]=b.w||us(b.z||ar[14],k);break;case"n":isFinite(b.v)?b.f?(g[2]="vtf",g[3]="n",g[4]=b.v,g[5]=t(b.f)):(g[2]="v",g[3]=b.v):(g[2]="vt"+(b.f?"f":"c"),g[3]="e"+Hn[isNaN(b.v)?36:7],g[4]="0",g[5]=b.f||g[3].slice(1),g[6]="e",g[7]=g[3].slice(1));break;case"e":continue}x.push(g.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function f(p){return[i,s,l,s,h(p),d].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}})(),Fte=(function(){function e(f,p,x,g,b){b.raw?p[x][g]=f:f===""||(f==="TRUE"?p[x][g]=!0:f==="FALSE"?p[x][g]=!1:isNaN(ns(f))?isNaN(Eh(f).getDate())?f.charCodeAt(0)==35&&Ei[f]!=null?p[x][g]={t:"e",v:Ei[f],w:f}:p[x][g]=f:p[x][g]=ca(f):p[x][g]=ns(f))}function t(f,p){var x=p||{},g=[];if(!f||f.length===0)return g;for(var b=f.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,S=0,T=0;T<=_;++T)S=b[T].indexOf(" "),S==-1?S=b[T].length:S++,w=Math.max(w,S);for(T=0;T<=_;++T){g[T]=[];var E=0;for(e(b[T].slice(0,w).trim(),g,T,E,x),E=1;E<=(b[T].length-w)/10+1;++E)e(b[T].slice(w+(E-1)*10,w+E*10).trim(),g,T,E,x)}return x.sheetRows&&(g=g.slice(0,x.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var p={},x=!1,g=0,b=0;g<f.length;++g)(b=f.charCodeAt(g))==34?x=!x:!x&&b in r&&(p[b]=(p[b]||0)+1);b=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&b.push([p[g],g]);if(!b.length){p=n;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&b.push([p[g],g])}return b.sort(function(_,w){return _[0]-w[0]||n[_[1]]-n[w[1]]}),r[b.pop()[1]]||44}function i(f,p){var x=p||{},g="",b={};x.dense&&(b["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(g=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(g=f.charAt(4),f=f.slice(6)):g=a(f.slice(0,1024)):x&&x.FS?g=x.FS:g=a(f.slice(0,1024));var w=0,S=0,T=0,E=0,k=0,A=g.charCodeAt(0),j=!1,P=0,D=f.charCodeAt(0),L=x.dateNF!=null?$J(x.dateNF):null;function I(){var O=f.slice(E,k);O.slice(-1)=="\r"&&(O=O.slice(0,-1));var M={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),x.cellText!==!1&&(M.w=O),O.length===0)M.t="z";else if(x.raw)M.t="s",M.v=O;else if(O.trim().length===0)M.t="s",M.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(M.t="s",M.v=O.slice(2,-1).replace(/""/g,'"')):Fre(O)?(M.t="s",M.f=O.slice(1),M.v=O):(M.t="s",M.v=O);else if(O=="TRUE")M.t="b",M.v=!0;else if(O=="FALSE")M.t="b",M.v=!1;else if(!isNaN(T=ns(O)))M.t="n",M.v=T;else if(!isNaN((T=Eh(O)).getDate())||L&&O.match(L)){if(M.z=x.dateNF||ar[14],L&&O.match(L)){var re=UJ(O,x.dateNF,O.match(L)||[]);T=ca(re),x&&x.UTC===!1&&(T=hc(T))}else x&&x.UTC===!1?T=hc(T):x.cellText!==!1&&x.dateNF&&(M.w=us(M.z,T));x.cellDates?(M.t="d",M.v=T):(M.t="n",M.v=pn(T)),x.cellNF||delete M.z}else O.charCodeAt(0)==35&&Ei[O]!=null?(M.t="e",M.w=O,M.v=Ei[O]):(M.t="s",M.v=O);if(M.t=="z"||(x.dense?(b["!data"][w]||(b["!data"][w]=[]),b["!data"][w][S]=M):b[vr({c:S,r:w})]=M),E=k+1,D=f.charCodeAt(E),_.e.c<S&&(_.e.c=S),_.e.r<w&&(_.e.r=w),P==A)++S;else if(S=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;k<f.length;++k)switch(P=f.charCodeAt(k)){case 34:D===34&&(j=!j);break;case 13:if(j)break;f.charCodeAt(k+1)==10&&++k;case A:case 10:if(!j&&I())break e;break}return k-E>0&&I(),b["!ref"]=Mr(_),b}function s(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,p):jc(t(f,p),p)}function l(f,p){var x="",g=p.type=="string"?[0,0,0,0]:coe(f,p);switch(p.type){case"base64":x=ro(f);break;case"binary":x=f;break;case"buffer":p.codepage==65001?x=f.toString("utf8"):(p.codepage,x=Bt&&Buffer.isBuffer(f)?f.toString("binary"):tl(f));break;case"array":x=hb(f);break;case"string":x=f;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?x=Zl(x.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?x=Zl(x):p.type=="binary",x.slice(0,19)=="socialcalc:version:"?x5.to_sheet(p.type=="string"?x:Zl(x),p):s(x,p)}function d(f,p){return Pc(l(f,p),p)}function h(f){var p=[];if(!f["!ref"])return"";for(var x=ir(f["!ref"]),g,b=f["!data"]!=null,_=x.s.r;_<=x.e.r;++_){for(var w=[],S=x.s.c;S<=x.e.c;++S){var T=vr({r:_,c:S});if(g=b?(f["!data"][_]||[])[S]:f[T],!g||g.v==null){w.push("          ");continue}for(var E=(g.w||(ds(g),g.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(S===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:l,from_sheet:h}})(),jk=(function(){function e(U,B,K){if(U){Bn(U,U.l||0);for(var z=K.Enum||Y;U.l<U.length;){var ne=U.read_shift(2),Oe=z[ne]||z[65535],Pe=U.read_shift(2),we=U.l+Pe,xe=Oe.f&&Oe.f(U,Pe,K);if(U.l=we,B(xe,Oe,ne))return}}}function t(U,B){switch(B.type){case"base64":return n(wa(ro(U)),B);case"binary":return n(wa(U),B);case"buffer":case"array":return n(U,B)}throw"Unsupported type "+B.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(U,B){if(!U)return U;var K=B||{},z={},ne="Sheet1",Oe="",Pe=0,we={},xe=[],Ee=[],le=[];K.dense&&(le=z["!data"]=[]);var De={s:{r:0,c:0},e:{r:0,c:0}},Ue=K.sheetRows||0,Ce={};if(U[4]==81&&U[5]==80&&U[6]==87)return Re(U,B);if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)K.Enum=Y,e(U,function(pe,tt,Ye){switch(Ye){case 0:K.vers=pe,pe>=4096&&(K.qpro=!0);break;case 255:K.vers=pe,K.works=!0;break;case 6:De=pe;break;case 204:pe&&(Oe=pe);break;case 222:Oe=pe;break;case 15:case 51:(!K.qpro&&!K.works||Ye==51)&&pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),(K.works||K.works2)&&(pe[1].v=pe[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=K.dateNF||r[(pe[2]&15)-1]||ar[14],K.cellDates&&(pe[1].v=Ql(pe[1].v),pe[1].t=typeof pe[1].v=="number"?"n":"d")),K.qpro&&pe[3]>Pe&&(z["!ref"]=Mr(De),we[ne]=z,xe.push(ne),z={},K.dense&&(le=z["!data"]=[]),De={s:{r:0,c:0},e:{r:0,c:0}},Pe=pe[3],ne=Oe||"Sheet"+(Pe+1),Oe="");var Be=K.dense?(le[pe[0].r]||[])[pe[0].c]:z[vr(pe[0])];if(Be){Be.t=pe[1].t,Be.v=pe[1].v,pe[1].z!=null&&(Be.z=pe[1].z),pe[1].f!=null&&(Be.f=pe[1].f),Ce=Be;break}K.dense?(le[pe[0].r]||(le[pe[0].r]=[]),le[pe[0].r][pe[0].c]=pe[1]):z[vr(pe[0])]=pe[1],Ce=pe[1];break;case 21509:K.works2=!0;break;case 21506:pe==5281&&(Ce.z="hh:mm:ss",K.cellDates&&Ce.t=="n"&&(Ce.v=Ql(Ce.v),Ce.t=typeof Ce.v=="number"?"n":"d"));break}},K);else if(U[2]==26||U[2]==14)K.Enum=ce,U[2]==14&&(K.qpro=!0,U.l=0),e(U,function(pe,tt,Ye){switch(Ye){case 204:ne=pe;break;case 22:pe[1].v.charCodeAt(0)<48&&(pe[1].v=pe[1].v.slice(1)),pe[1].v=pe[1].v.replace(/\x0F./g,function(Be){return String.fromCharCode(Be.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>Pe&&(z["!ref"]=Mr(De),we[ne]=z,xe.push(ne),z={},K.dense&&(le=z["!data"]=[]),De={s:{r:0,c:0},e:{r:0,c:0}},Pe=pe[3],ne="Sheet"+(Pe+1)),Ue>0&&pe[0].r>=Ue)break;K.dense?(le[pe[0].r]||(le[pe[0].r]=[]),le[pe[0].r][pe[0].c]=pe[1]):z[vr(pe[0])]=pe[1],De.e.c<pe[0].c&&(De.e.c=pe[0].c),De.e.r<pe[0].r&&(De.e.r=pe[0].r);break;case 27:pe[14e3]&&(Ee[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Ee[pe[0]]=pe[1],pe[0]==Pe&&(ne=pe[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(z["!ref"]=Mr(De),we[Oe||ne]=z,xe.push(Oe||ne),!Ee.length)return{SheetNames:xe,Sheets:we};for(var Ae={},ve=[],Le=0;Le<Ee.length;++Le)we[xe[Le]]?(ve.push(Ee[Le]||xe[Le]),Ae[Ee[Le]]=we[Ee[Le]]||we[xe[Le]]):(ve.push(Ee[Le]),Ae[Ee[Le]]={"!ref":"A1"});return{SheetNames:ve,Sheets:Ae}}function a(U,B){var K=B||{};if(+K.codepage>=0&&td(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var z=An();if(!U["!ref"])throw new Error("Cannot export empty sheet to WK1");var ne=ir(U["!ref"]),Oe=U["!data"]!=null,Pe=[];$e(z,0,s(1030)),$e(z,6,h(ne));for(var we=Math.min(ne.e.r,8191),xe=ne.s.c;xe<=ne.e.c;++xe)Pe[xe]=Ht(xe);for(var Ee=ne.s.r;Ee<=we;++Ee){var le=Yt(Ee);for(xe=ne.s.c;xe<=ne.e.c;++xe){var De=Oe?(U["!data"][Ee]||[])[xe]:U[Pe[xe]+le];if(!(!De||De.t=="z"))switch(De.t){case"n":(De.v|0)==De.v&&De.v>=-32768&&De.v<=32767?$e(z,13,w(Ee,xe,De)):$e(z,14,T(Ee,xe,De));break;case"d":var Ue=pn(De.v);(Ue|0)==Ue&&Ue>=-32768&&Ue<=32767?$e(z,13,w(Ee,xe,{v:Ue,z:De.z||ar[14]})):$e(z,14,T(Ee,xe,{v:Ue,z:De.z||ar[14]}));break;default:var Ce=ds(De);$e(z,15,g(Ee,xe,Ce.slice(0,239)))}}}return $e(z,1),z.end()}function i(U,B){var K=B||{};if(+K.codepage>=0&&td(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var z=An();$e(z,0,l(U));for(var ne=0,Oe=0;ne<U.SheetNames.length;++ne)(U.Sheets[U.SheetNames[ne]]||{})["!ref"]&&$e(z,27,se(U.SheetNames[ne],Oe++));var Pe=0;for(ne=0;ne<U.SheetNames.length;++ne){var we=U.Sheets[U.SheetNames[ne]];if(!(!we||!we["!ref"])){for(var xe=ir(we["!ref"]),Ee=we["!data"]!=null,le=[],De=Math.min(xe.e.r,8191),Ue=xe.s.r;Ue<=De;++Ue)for(var Ce=Yt(Ue),Ae=xe.s.c;Ae<=xe.e.c;++Ae){Ue===xe.s.r&&(le[Ae]=Ht(Ae));var ve=le[Ae]+Ce,Le=Ee?(we["!data"][Ue]||[])[Ae]:we[ve];if(!(!Le||Le.t=="z"))if(Le.t=="n")$e(z,23,re(Ue,Ae,Pe,Le.v));else{var pe=ds(Le);$e(z,22,I(Ue,Ae,Pe,pe.slice(0,239)))}}++Pe}}return $e(z,1),z.end()}function s(U){var B=be(2);return B.write_shift(2,U),B}function l(U){var B=be(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var K=0,z=0,ne=0,Oe=0;Oe<U.SheetNames.length;++Oe){var Pe=U.SheetNames[Oe],we=U.Sheets[Pe];if(!(!we||!we["!ref"])){++ne;var xe=fn(we["!ref"]);K<xe.e.r&&(K=xe.e.r),z<xe.e.c&&(z=xe.e.c)}}return K>8191&&(K=8191),B.write_shift(2,K),B.write_shift(1,ne),B.write_shift(1,z),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function d(U,B,K){var z={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&K.qpro?(z.s.c=U.read_shift(1),U.l++,z.s.r=U.read_shift(2),z.e.c=U.read_shift(1),U.l++,z.e.r=U.read_shift(2),z):(z.s.c=U.read_shift(2),z.s.r=U.read_shift(2),B==12&&K.qpro&&(U.l+=2),z.e.c=U.read_shift(2),z.e.r=U.read_shift(2),B==12&&K.qpro&&(U.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function h(U){var B=be(8);return B.write_shift(2,U.s.c),B.write_shift(2,U.s.r),B.write_shift(2,U.e.c),B.write_shift(2,U.e.r),B}function f(U,B,K){var z=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(z[0].c=U.read_shift(1),z[3]=U.read_shift(1),z[0].r=U.read_shift(2),U.l+=2):K.works?(z[0].c=U.read_shift(2),z[0].r=U.read_shift(2),z[2]=U.read_shift(2)):(z[2]=U.read_shift(1),z[0].c=U.read_shift(2),z[0].r=U.read_shift(2)),z}function p(U){return U.z&&rl(U.z)?240|(r.indexOf(U.z)+1||2):255}function x(U,B,K){var z=U.l+B,ne=f(U,B,K);if(ne[1].t="s",(K.vers&65534)==20768){U.l++;var Oe=U.read_shift(1);return ne[1].v=U.read_shift(Oe,"utf8"),ne}return K.qpro&&U.l++,ne[1].v=U.read_shift(z-U.l,"cstr"),ne}function g(U,B,K){var z=be(7+K.length);z.write_shift(1,255),z.write_shift(2,B),z.write_shift(2,U),z.write_shift(1,39);for(var ne=0;ne<z.length;++ne){var Oe=K.charCodeAt(ne);z.write_shift(1,Oe>=128?95:Oe)}return z.write_shift(1,0),z}function b(U,B,K){var z=U.l+B,ne=f(U,B,K);if(ne[1].t="s",K.vers==20768){var Oe=U.read_shift(1);return ne[1].v=U.read_shift(Oe,"utf8"),ne}return ne[1].v=U.read_shift(z-U.l,"cstr"),ne}function _(U,B,K){var z=f(U,B,K);return z[1].v=U.read_shift(2,"i"),z}function w(U,B,K){var z=be(7);return z.write_shift(1,p(K)),z.write_shift(2,B),z.write_shift(2,U),z.write_shift(2,K.v,"i"),z}function S(U,B,K){var z=f(U,B,K);return z[1].v=U.read_shift(8,"f"),z}function T(U,B,K){var z=be(13);return z.write_shift(1,p(K)),z.write_shift(2,B),z.write_shift(2,U),z.write_shift(8,K.v,"f"),z}function E(U,B,K){var z=U.l+B,ne=f(U,B,K);if(ne[1].v=U.read_shift(8,"f"),K.qpro)U.l=z;else{var Oe=U.read_shift(2);P(U.slice(U.l,U.l+Oe),ne),U.l+=Oe}return ne}function k(U,B,K){var z=B&32768;return B&=-32769,B=(z?U:0)+(B>=8192?B-16384:B),(z?"":"$")+(K?Ht(B):Yt(B))}var A={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(U,B){Bn(U,0);for(var K=[],z=0,ne="",Oe="",Pe="",we="";U.l<U.length;){var xe=U[U.l++];switch(xe){case 0:K.push(U.read_shift(8,"f"));break;case 1:Oe=k(B[0].c,U.read_shift(2),!0),ne=k(B[0].r,U.read_shift(2),!1),K.push(Oe+ne);break;case 2:{var Ee=k(B[0].c,U.read_shift(2),!0),le=k(B[0].r,U.read_shift(2),!1);Oe=k(B[0].c,U.read_shift(2),!0),ne=k(B[0].r,U.read_shift(2),!1),K.push(Ee+le+":"+Oe+ne)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(U.read_shift(2));break;case 6:{for(var De="";xe=U[U.l++];)De+=String.fromCharCode(xe);K.push('"'+De.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:we=K.pop(),Pe=K.pop(),K.push(["AND","OR"][xe-20]+"("+Pe+","+we+")");break;default:if(xe<32&&j[xe])we=K.pop(),Pe=K.pop(),K.push(Pe+j[xe]+we);else if(A[xe]){if(z=A[xe][1],z==69&&(z=U[U.l++]),z>K.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+K.join("|")+"|");return}var Ue=K.slice(-z);K.length-=z,K.push(A[xe][0]+"("+Ue.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}K.length==1?B[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function D(U){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=U.read_shift(2),B[3]=U[U.l++],B[0].c=U[U.l++],B}function L(U,B){var K=D(U);return K[1].t="s",K[1].v=U.read_shift(B-4,"cstr"),K}function I(U,B,K,z){var ne=be(6+z.length);ne.write_shift(2,U),ne.write_shift(1,K),ne.write_shift(1,B),ne.write_shift(1,39);for(var Oe=0;Oe<z.length;++Oe){var Pe=z.charCodeAt(Oe);ne.write_shift(1,Pe>=128?95:Pe)}return ne.write_shift(1,0),ne}function O(U,B){var K=D(U);K[1].v=U.read_shift(2);var z=K[1].v>>1;if(K[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return K[1].v=z,K}function M(U,B){var K=D(U),z=U.read_shift(4),ne=U.read_shift(4),Oe=U.read_shift(2);if(Oe==65535)return z===0&&ne===3221225472?(K[1].t="e",K[1].v=15):z===0&&ne===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Pe=Oe&32768;return Oe=(Oe&32767)-16446,K[1].v=(1-Pe*2)*(ne*Math.pow(2,Oe+32)+z*Math.pow(2,Oe)),K}function re(U,B,K,z){var ne=be(14);if(ne.write_shift(2,U),ne.write_shift(1,K),ne.write_shift(1,B),z==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var Oe=0,Pe=0,we=0,xe=0;return z<0&&(Oe=1,z=-z),Pe=Math.log2(z)|0,z/=Math.pow(2,Pe-31),xe=z>>>0,(xe&2147483648)==0&&(z/=2,++Pe,xe=z>>>0),z-=xe,xe|=2147483648,xe>>>=0,z*=Math.pow(2,32),we=z>>>0,ne.write_shift(4,we),ne.write_shift(4,xe),Pe+=16383+(Oe?32768:0),ne.write_shift(2,Pe),ne}function oe(U,B){var K=M(U);return U.l+=B-14,K}function ee(U,B){var K=D(U),z=U.read_shift(4);return K[1].v=z>>6,K}function fe(U,B){var K=D(U),z=U.read_shift(8,"f");return K[1].v=z,K}function J(U,B){var K=fe(U);return U.l+=B-12,K}function ie(U,B){return U[U.l+B-1]==0?U.read_shift(B,"cstr"):""}function Q(U,B){var K=U[U.l++];K>B-1&&(K=B-1);for(var z="";z.length<K;)z+=String.fromCharCode(U[U.l++]);return z}function te(U,B,K){if(!(!K.qpro||B<21)){var z=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ne=U.read_shift(B-21,"cstr");return[z,ne]}}function H(U,B){for(var K={},z=U.l+B;U.l<z;){var ne=U.read_shift(2);if(ne==14e3){for(K[ne]=[0,""],K[ne][0]=U.read_shift(2);U[U.l];)K[ne][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return K}function se(U,B){var K=be(5+U.length);K.write_shift(2,14e3),K.write_shift(2,B);for(var z=0;z<U.length;++z){var ne=U.charCodeAt(z);K[K.l++]=ne>127?95:ne}return K[K.l++]=0,K}var Y={0:{n:"BOF",f:N0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:b},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:Q},255:{n:"BOF",f:N0},21506:{n:"WKSNF",f:N0},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:oe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ee},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},ue={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function me(U){var B=U.read_shift(2),K=U.read_shift(1);if(K!=0)throw"unsupported QPW string type "+K.toString(16);return U.read_shift(B,"sbcs-cont")}function Re(U,B){Bn(U,0);var K=B||{},z={};K.dense&&(z["!data"]=[]);var ne=[],Oe="",Pe={s:{r:-1,c:-1},e:{r:-1,c:-1}},we=0,xe=0,Ee=0,le=0,De={SheetNames:[],Sheets:{}},Ue=[];e:for(;U.l<U.length;){var Ce=U.read_shift(2),Ae=U.read_shift(2),ve=U.slice(U.l,U.l+Ae);switch(Bn(ve,0),Ce){case 1:if(ve.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Le=ve.read_shift(4),pe=(ve.length-ve.l)/Le|0,tt=0;tt<Le;++tt){var Ye=ve.l+pe,Be={};ve.l+=2,Be.numFmtId=ve.read_shift(2),ue[Be.numFmtId]&&(Be.z=ue[Be.numFmtId]),ve.l=Ye,Ue.push(Be)}break;case 1025:break;case 1026:break;case 1031:for(ve.l+=12;ve.l<ve.length;)we=ve.read_shift(2),xe=ve.read_shift(1),ne.push(ve.read_shift(we,"cstr"));break;case 1032:break;case 1537:{var ot=ve.read_shift(2);z={},K.dense&&(z["!data"]=[]),Pe.s.c=ve.read_shift(2),Pe.e.c=ve.read_shift(2),Pe.s.r=ve.read_shift(4),Pe.e.r=ve.read_shift(4),ve.l+=4,ve.l+2<ve.length&&(we=ve.read_shift(2),xe=ve.read_shift(1),Oe=we==0?"":ve.read_shift(we,"cstr")),Oe||(Oe=Ht(ot))}break;case 1538:{if(Pe.s.c>255||Pe.s.r>999999)break;Pe.e.c<Pe.s.c&&(Pe.e.c=Pe.s.c),Pe.e.r<Pe.s.r&&(Pe.e.r=Pe.s.r),z["!ref"]=Mr(Pe),Pb(De,z,Oe)}break;case 2561:Ee=ve.read_shift(2),Pe.e.c<Ee&&(Pe.e.c=Ee),Pe.s.c>Ee&&(Pe.s.c=Ee),le=ve.read_shift(4),Pe.s.r>le&&(Pe.s.r=le),le=ve.read_shift(4),Pe.e.r<le&&(Pe.e.r=le);break;case 3073:{le=ve.read_shift(4),we=ve.read_shift(4),Pe.s.r>le&&(Pe.s.r=le),Pe.e.r<le+we-1&&(Pe.e.r=le+we-1);for(var et=Ht(Ee);ve.l<ve.length;){var Je={t:"z"},Ze=ve.read_shift(1),At=-1;Ze&128&&(At=ve.read_shift(2));var Ot=Ze&64?ve.read_shift(2)-1:0;switch(Ze&31){case 0:break;case 1:break;case 2:Je={t:"n",v:ve.read_shift(2)};break;case 3:Je={t:"n",v:ve.read_shift(2,"i")};break;case 4:Je={t:"n",v:Sb(ve)};break;case 5:Je={t:"n",v:ve.read_shift(8,"f")};break;case 7:Je={t:"s",v:ne[xe=ve.read_shift(4)-1]};break;case 8:Je={t:"n",v:ve.read_shift(8,"f")},ve.l+=2,ve.l+=4,isNaN(Je.v)&&(Je={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Ze&31)}At!=-1&&(Ue[At-1]||{}).z&&(Je.z=Ue[At-1].z);var Mt=0;if(Ze&32)switch(Ze&31){case 2:Mt=ve.read_shift(2);break;case 3:Mt=ve.read_shift(2,"i");break;case 7:Mt=ve.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Ze&31)}if(!(!K.sheetStubs&&Je.t=="z")){var Ie=On(Je);Je.t=="n"&&Je.z&&rl(Je.z)&&K.cellDates&&(Ie.v=Ql(Je.v),Ie.t=typeof Ie.v=="number"?"n":"d"),z["!data"]!=null?(z["!data"][le]||(z["!data"][le]=[]),z["!data"][le][Ee]=Ie):z[et+Yt(le)]=Ie}for(++le,--we;Ot-- >0&&we>=0;){if(Ze&32)switch(Ze&31){case 2:Je={t:"n",v:Je.v+Mt&65535};break;case 3:Je={t:"n",v:Je.v+Mt&65535},Je.v>32767&&(Je.v-=65536);break;case 7:Je={t:"s",v:ne[xe=xe+Mt>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Ze&31)}else switch(Ze&31){case 1:Je={t:"z"};break;case 2:Je={t:"n",v:ve.read_shift(2)};break;case 7:Je={t:"s",v:ne[xe=ve.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Ze&31)}!K.sheetStubs&&Je.t=="z"||(z["!data"]!=null?(z["!data"][le]||(z["!data"][le]=[]),z["!data"][le][Ee]=Je):z[et+Yt(le)]=Je),++le,--we}}}break;case 3074:{Ee=ve.read_shift(2),le=ve.read_shift(4);var at=me(ve);z["!data"]!=null?(z["!data"][le]||(z["!data"][le]=[]),z["!data"][le][Ee]={t:"s",v:at}):z[Ht(Ee)+Yt(le)]={t:"s",v:at}}break}U.l+=Ae}return De}return{sheet_to_wk1:a,book_to_wk3:i,to_workbook:t}})(),Mte=/^\s|\s$|[\t\n\r]/;function Lte(e,t){if(!t.bookSST)return"";var r=[Br];r[r.length]=Xe("sst",null,{xmlns:Ac[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),typeof a.t!="string"&&(a.t=String(a.t)),a.t.match(Mte)&&(i+=' xml:space="preserve"'),i+=">"+Nt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Bte(e){return[e.read_shift(4),e.read_shift(4)]}function $te(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Ute=Cee;function zte(e){var t=An();Me(t,159,$te(e));for(var r=0;r<e.length;++r)Me(t,19,Ute(e[r]));return Me(t,160),t.end()}function Wte(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function g5(e){var t=0,r,n=Wte(e),a=n.length+1,i,s,l,d,h;for(r=el(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],l=(t&16384)===0?0:1,d=t<<1&32767,h=l|d,t=h^s;return t^52811}function Hte(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=ir(e["!ref"]),a,i=e["!data"]!=null,s=[],l=n.s.r;l<=n.e.r;++l){r.push("\\trowd\\trautofit1");for(var d=n.s.c;d<=n.e.c;++d)r.push("\\cellx"+(d+1));for(r.push("\\pard\\intbl"),i&&(s=e["!data"][l]||[]),d=n.s.c;d<=n.e.c;++d){var h=vr({r:l,c:d});if(a=i?s[d]:e[h],!a||a.v==null&&(!a.f||a.F)){r.push(" \\cell");continue}r.push(" "+(a.w||(ds(a),a.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function Ok(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Kte=6,as=Kte;function Ah(e){return Math.floor((e+Math.round(128/as)/256)*as)}function Ph(e){return Math.floor((e-5)/as*100+.5)/100}function Y1(e){return Math.round((e*as+5)/as*256)/256}function Eb(e){e.width?(e.wpx=Ah(e.width),e.wch=Ph(e.wpx),e.MDW=as):e.wpx?(e.wch=Ph(e.wpx),e.width=Y1(e.wch),e.MDW=as):typeof e.wch=="number"&&(e.width=Y1(e.wch),e.wpx=Ah(e.width),e.MDW=as),e.customWidth&&delete e.customWidth}var Vte=96,v5=Vte;function jh(e){return e*96/v5}function y5(e){return e*v5/96}function Gte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Xe("numFmt",null,{numFmtId:n,formatCode:Nt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Yte(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(r){t[t.length]=Xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Xte(e,t){var r=[Br,Xe("styleSheet",null,{xmlns:Ac[0],"xmlns:vt":en.vt})],n;return e.SSF&&(n=Gte(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Yte(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function qte(e,t){var r=e.read_shift(2),n=Pn(e);return[r,n]}function Qte(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),Wr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Zte(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Ree(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var l=e.read_shift(1);l>0&&(n.family=l);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=Dee(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Pn(e),n}function Jte(e,t){t||(t=be(153)),t.write_shift(2,e.sz*20),Iee(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ch(e.color,t);var n=0;return n=2,t.write_shift(1,n),Wr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ere=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],kv,tre=Oi;function Dk(e,t){t||(t=be(84)),kv||(kv=fb(ere));var r=kv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Ch({auto:1},t),Ch({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function rre(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function w5(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Eu(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var nre=Oi;function are(e,t){return t||(t=be(51)),t.write_shift(1,0),Eu(null,t),Eu(null,t),Eu(null,t),Eu(null,t),Eu(null,t),t.length>t.l?t.slice(0,t.l):t}function ire(e,t){return t||(t=be(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),sd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function sre(e,t,r){var n=be(2052);return n.write_shift(4,e),sd(t,n),sd(r,n),n.length>n.l?n.slice(0,n.l):n}function ore(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Me(e,615,ci(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Me(e,44,Qte(a,t[a]))}),Me(e,616))}}function lre(e){var t=1;Me(e,611,ci(t)),Me(e,43,Jte({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(e,612)}function cre(e){var t=2;Me(e,603,ci(t)),Me(e,45,Dk({patternType:"none"})),Me(e,45,Dk({patternType:"gray125"})),Me(e,604)}function ure(e){var t=1;Me(e,613,ci(t)),Me(e,46,are()),Me(e,614)}function dre(e){var t=1;Me(e,626,ci(t)),Me(e,47,w5({numFmtId:0},65535)),Me(e,627)}function fre(e,t){Me(e,617,ci(t.length)),t.forEach(function(r){Me(e,47,w5(r,0))}),Me(e,618)}function hre(e){var t=1;Me(e,619,ci(t)),Me(e,48,ire({xfId:0,name:"Normal"})),Me(e,620)}function pre(e){var t=0;Me(e,505,ci(t)),Me(e,506)}function mre(e){var t=0;Me(e,508,sre(t,"TableStyleMedium9","PivotStyleMedium4")),Me(e,509)}function xre(e,t){var r=An();return Me(r,278),ore(r,e.SSF),lre(r),cre(r),ure(r),dre(r),fre(r,t.cellXfs),hre(r),pre(r),mre(r),Me(r,279),r.end()}function b5(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function gre(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Pn(e)}}function vre(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Wr(e.name,t),t.slice(0,t.l)}function yre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function wre(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function bre(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),Wr(t,r),r.slice(0,r.l)}function _re(e){return e.l+=4,e.read_shift(4)!=0}function Sre(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Nre(){var e=An();return Me(e,332),Me(e,334,ci(1)),Me(e,335,vre({name:"XLDAPR",version:12e4,flags:3496657072})),Me(e,336),Me(e,339,bre(1,"XLDAPR")),Me(e,52),Me(e,35,ci(514)),Me(e,4096,ci(0)),Me(e,4097,Ua(1)),Me(e,36),Me(e,53),Me(e,340),Me(e,337,Sre(1)),Me(e,51,wre([[1,0]])),Me(e,338),Me(e,333),e.end()}function Ere(){var e=[Br];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Tre(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=vr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function _5(e,t,r){var n=[21600,21600],a=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Xe("xml",null,{"xmlns:v":ba.v,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:mv":ba.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],s=65536*e,l=t||[];return l.length>0&&i.push(Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:a})),l.forEach(function(d){++s,i.push(Cre(d,s))}),i.push("</xml>"),i.join("")}function Cre(e,t,r){var n=dr(e[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var i=a.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Xe("v:fill",i,a),l={on:"t",obscured:"t"};return["<v:shape"+nd({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Xe("v:shadow",null,l),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dn("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),dn("x:AutoFill","False"),dn("x:Row",String(n.r)),dn("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function kre(e){var t=[Br,Xe("comments",null,{xmlns:Ac[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Nt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[],s=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(h){h.a&&(a=r.indexOf(Nt(h.a))),h.T&&++s,i.push(h.t==null?"":Nt(h.t))}),s===0)n[1].forEach(function(h){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Nt(h.a))+'"><text>'),t.push(dn("t",h.t==null?"":Nt(h.t))),t.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(a=r.indexOf("tc="+n[1][0].ID)),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>');for(var l=`Comment:
    `+i[0]+`
`,d=1;d<i.length;++d)l+=`Reply:
    `+i[d]+`
`;t.push(dn("t",Nt(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function S5(e,t,r){var n=[Br,Xe("ThreadedComments",null,{xmlns:en.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=d.id:d.parentId=i,s.ID=d.id,s.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Xe("threadedComment",dn("text",s.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function N5(e){var t=[Br,Xe("personList",null,{xmlns:en.TCMNT,"xmlns:x":Ac[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Are(e){var t={};t.iauthor=e.read_shift(4);var r=dl(e);return t.rfx=r.s,t.ref=vr(r.s),e.l+=16,t}function Pre(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),Oc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var jre=Pn;function Rk(e){return Wr(e.slice(0,54))}function Ore(e){var t=An(),r=[];return Me(t,628),Me(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Me(t,632,Rk(a.a)),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),Me(t,632,Rk("tc="+a.ID))))})}),Me(t,631),Me(t,633),e.forEach(function(n){n[1].forEach(function(a){var i=-1;a.ID&&(i=r.indexOf("tc="+a.ID)),i==-1&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),i==-1&&(i=r.indexOf(a.a)),a.iauthor=i;var s={s:dr(n[0]),e:dr(n[0])};Me(t,635,Pre([s,a])),a.t&&a.t.length>0&&Me(t,637,Aee(a)),Me(t,636),delete a.iauthor})}),Me(t,634),Me(t,629),t.end()}function Dre(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Xt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Rre=["xlsb","xlsm","xlam","biff8","xla"],Ik=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var l=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return l?f+=t.c:--f,d?h+=t.r:--h,a+(l?"":"$")+Ht(f)+(d?"":"$")+Yt(h)}return function(a,i){return t=i,a.replace(e,r)}})(),Rp=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Rp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Ip=(function(){return function(t,r){return t.replace(Rp,function(n,a,i,s,l,d){var h=wb(s)-(i?0:r.c),f=yb(d)-(l?0:r.r),p=l=="$"?f+1:f==0?"":"["+f+"]",x=i=="$"?h+1:h==0?"":"["+h+"]";return a+"R"+p+"C"+x})}})();function Ire(e,t){return e.replace(Rp,function(r,n,a,i,s,l){return n+(a=="$"?a+i:Ht(wb(i)+t.c))+(s=="$"?s+l:Yt(yb(l)+t.r))})}function Fre(e){return e.length!=1}function jr(e){e.l+=1}function no(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function E5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return T5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=no(e),l=no(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function T5(e){var t=no(e),r=no(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Mre(e,t,r){if(r.biff<8)return T5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=no(e),s=no(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function C5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Lre(e);var n=e.read_shift(r&&r.biff==12?4:2),a=no(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Lre(e){var t=no(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Bre(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $re(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Ure(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:l}}function Ure(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function zre(e,t,r){var n=(e[e.l++]&96)>>5,a=E5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Wre(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=E5(e,i,r);return[n,a,s]}function Hre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Kre(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Vre(e,t,r){var n=(e[e.l++]&96)>>5,a=Mre(e,t-1,r);return[n,a]}function Gre(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Fk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Yre(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Xre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function qre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Qre(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Zre(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function k5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Jre(e){return e.read_shift(2),k5(e)}function ene(e){return e.read_shift(2),k5(e)}function tne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=C5(e,0,r);return[n,a]}function rne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=$re(e,0,r);return[n,a]}function nne(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=C5(e,0,r);return[n,a,i]}function ane(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[mae[a],j5[a],n]}function ine(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:sne(e);return[a,(i[0]===0?j5:pae)[i[1]]]}function sne(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function one(e,t,r){e.l+=r&&r.biff==2?3:4}function lne(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function cne(e){return e.l++,Hn[e.read_shift(1)]}function une(e){return e.l++,e.read_shift(2)}function dne(e){return e.l++,e.read_shift(1)!==0}function fne(e){return e.l++,Dc(e)}function hne(e,t,r){return e.l++,f5(e,t-1,r)}function pne(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Jee(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Hn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dc(e);break;case 2:r[1]=nte(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function mne(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?dl:ste)(e));return a}function xne(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var l=0;l!=a;++l)s[i][l]=pne(e,r.biff);return s}function gne(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function vne(e,t,r){if(r.biff==5)return yne(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function yne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function wne(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function bne(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _ne(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Sne(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Nne=Oi,Ene=Oi,Tne=Oi;function Dd(e,t,r){return e.l+=2,[Bre(e)]}function Tb(e){return e.l+=6,[]}var Cne=Dd,kne=Tb,Ane=Tb,Pne=Dd;function A5(e){return e.l+=2,[N0(e),e.read_shift(2)&1]}var jne=Dd,One=A5,Dne=Tb,Rne=Dd,Ine=Dd,Fne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Mne(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=Fne[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Lne(e){return e.l+=2,[e.read_shift(4)]}function Bne(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $ne(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Une(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Wne(e){return e.l+=4,[0,0]}var Mk={1:{n:"PtgExp",f:lne},2:{n:"PtgTbl",f:Tne},3:{n:"PtgAdd",f:jr},4:{n:"PtgSub",f:jr},5:{n:"PtgMul",f:jr},6:{n:"PtgDiv",f:jr},7:{n:"PtgPower",f:jr},8:{n:"PtgConcat",f:jr},9:{n:"PtgLt",f:jr},10:{n:"PtgLe",f:jr},11:{n:"PtgEq",f:jr},12:{n:"PtgGe",f:jr},13:{n:"PtgGt",f:jr},14:{n:"PtgNe",f:jr},15:{n:"PtgIsect",f:jr},16:{n:"PtgUnion",f:jr},17:{n:"PtgRange",f:jr},18:{n:"PtgUplus",f:jr},19:{n:"PtgUminus",f:jr},20:{n:"PtgPercent",f:jr},21:{n:"PtgParen",f:jr},22:{n:"PtgMissArg",f:jr},23:{n:"PtgStr",f:hne},26:{n:"PtgSheet",f:Bne},27:{n:"PtgEndSheet",f:$ne},28:{n:"PtgErr",f:cne},29:{n:"PtgBool",f:dne},30:{n:"PtgInt",f:une},31:{n:"PtgNum",f:fne},32:{n:"PtgArray",f:Gre},33:{n:"PtgFunc",f:ane},34:{n:"PtgFuncVar",f:ine},35:{n:"PtgName",f:gne},36:{n:"PtgRef",f:tne},37:{n:"PtgArea",f:zre},38:{n:"PtgMemArea",f:wne},39:{n:"PtgMemErr",f:Nne},40:{n:"PtgMemNoMem",f:Ene},41:{n:"PtgMemFunc",f:bne},42:{n:"PtgRefErr",f:_ne},43:{n:"PtgAreaErr",f:Hre},44:{n:"PtgRefN",f:rne},45:{n:"PtgAreaN",f:Vre},46:{n:"PtgMemAreaN",f:Une},47:{n:"PtgMemNoMemN",f:zne},57:{n:"PtgNameX",f:vne},58:{n:"PtgRef3d",f:nne},59:{n:"PtgArea3d",f:Wre},60:{n:"PtgRefErr3d",f:Sne},61:{n:"PtgAreaErr3d",f:Kre},255:{}},Hne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Kne={1:{n:"PtgElfLel",f:A5},2:{n:"PtgElfRw",f:Rne},3:{n:"PtgElfCol",f:Cne},6:{n:"PtgElfRwV",f:Ine},7:{n:"PtgElfColV",f:Pne},10:{n:"PtgElfRadical",f:jne},11:{n:"PtgElfRadicalS",f:Dne},13:{n:"PtgElfColS",f:kne},15:{n:"PtgElfColSV",f:Ane},16:{n:"PtgElfRadicalLel",f:One},25:{n:"PtgList",f:Mne},29:{n:"PtgSxName",f:Lne},255:{}},Vne={0:{n:"PtgAttrNoop",f:Wne},1:{n:"PtgAttrSemi",f:Zre},2:{n:"PtgAttrIf",f:qre},4:{n:"PtgAttrChoose",f:Yre},8:{n:"PtgAttrGoto",f:Xre},16:{n:"PtgAttrSum",f:one},32:{n:"PtgAttrBaxcel",f:Fk},33:{n:"PtgAttrBaxcel",f:Fk},64:{n:"PtgAttrSpace",f:Jre},65:{n:"PtgAttrSpaceSemi",f:ene},128:{n:"PtgAttrIfError",f:Qre},255:{}};function Gne(e,t,r,n){if(n.biff<8)return Oi(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=xne(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=mne(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Oi(e,t)),i}function Yne(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Mk[i]||Mk[Hne[i]],(i===24||i===25)&&(a=(i===24?Kne:Vne)[e[e.l+1]]),!a||!a.f?Oi(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Xne(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var qne={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Qne(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function P5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Lk(e,t,r){var n=P5(e,t,r);return n=="#REF"?n:id(n,r)}function pc(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},l=[],d,h,f,p=0,x=0,g,b="";if(!e[0]||!e[0][0])return"";for(var _=-1,w="",S=0,T=e[0].length;S<T;++S){var E=e[0][S];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=l.pop(),h=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:w=cr(" ",e[0][_][1][1]);break;case 1:w=cr("\r",e[0][_][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}h=h+w,_=-1}l.push(h+qne[E[0]]+d);break;case"PtgIsect":d=l.pop(),h=l.pop(),l.push(h+" "+d);break;case"PtgUnion":d=l.pop(),h=l.pop(),l.push(h+","+d);break;case"PtgRange":d=l.pop(),h=l.pop(),l.push(Qne(h,d));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Mu(E[1][1],s,a),l.push(Lu(f,i));break;case"PtgRefN":f=r?Mu(E[1][1],r,a):E[1][1],l.push(Lu(f,i));break;case"PtgRef3d":p=E[1][1],f=Mu(E[1][2],s,a),b=Lk(n,p,a),l.push(b+"!"+Lu(f,i));break;case"PtgFunc":case"PtgFuncVar":var k=E[1][0],A=E[1][1];k||(k=0),k&=127;var j=k==0?[]:l.slice(-k);l.length-=k,A==="User"&&(A=j.shift()),l.push(A+"("+j.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":g=yk(E[1][1],r?{s:r}:s,a),l.push(Nv(g,a));break;case"PtgArea":g=yk(E[1][1],s,a),l.push(Nv(g,a));break;case"PtgArea3d":p=E[1][1],g=E[1][2],b=Lk(n,p,a),l.push(b+"!"+Nv(g,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=E[1][2];var P=(n.names||[])[x-1]||(n[0]||[])[x],D=P?P.Name:"SH33TJSNAME"+String(x);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),l.push(D);break;case"PtgNameX":var L=E[1][1];x=E[1][2];var I;if(a.biff<=5)L<0&&(L=-L),n[L]&&(I=n[L][x]);else{var O="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][x]&&n[L][x].itab>0&&(O=n.SheetNames[n[L][x].itab-1]+"!"):O=n.SheetNames[x-1]+"!"),n[L]&&n[L][x])O+=n[L][x].Name;else if(n[0]&&n[0][x])O+=n[0][x].Name;else{var M=(P5(n,L,a)||"").split(";;");M[x-1]?O=M[x-1]:O+="SH33TJSERRX"}l.push(O);break}I||(I={Name:"SH33TJSERRY"}),l.push(I.Name);break;case"PtgParen":var re="(",oe=")";if(_>=0){switch(w="",e[0][_][1][0]){case 2:re=cr(" ",e[0][_][1][1])+re;break;case 3:re=cr("\r",e[0][_][1][1])+re;break;case 4:oe=cr(" ",e[0][_][1][1])+oe;break;case 5:oe=cr("\r",e[0][_][1][1])+oe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(re+l.pop()+oe);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[vr(f)]){var fe=n.sharedf[vr(f)];l.push(pc(fe,s,ee,n,a))}else{var J=!1;for(d=0;d!=n.arrayf.length;++d)if(h=n.arrayf[d],!(f.c<h[0].s.c||f.c>h[0].e.c)&&!(f.r<h[0].s.r||f.r>h[0].e.r)){l.push(pc(h[1],s,ee,n,a)),J=!0;break}J||l.push(E[1])}break;case"PtgArray":l.push("{"+Xne(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&_>=0&&ie.indexOf(e[0][S][0])==-1){E=e[0][_];var Q=!0;switch(E[1][0]){case 4:Q=!1;case 0:w=cr(" ",E[1][1]);break;case 5:Q=!1;case 1:w=cr("\r",E[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((Q?w:"")+l.pop()+(Q?"":w)),_=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function Zne(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return nl(e);return nl(0)}function Jne(e,t,r,n,a){var i=al(t,r,a),s=Zne(e.v),l=be(6),d=33;l.write_shift(2,d),l.write_shift(4,0);for(var h=be(e.bf.length),f=0;f<e.bf.length;++f)h[f]=e.bf[f];var p=Dr([i,s,l,h]);return p}function Fp(e,t,r){var n=e.read_shift(4),a=Yne(e,n,r),i=e.read_shift(4),s=i>0?Gne(e,i,a,r):null;return[a,s]}var eae=Fp,Mp=Fp,tae=Fp,rae=Fp;function Bk(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=be(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=be(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function nae(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function aae(e){var t=be(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function iae(e){var t=be(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=be(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=be(4);return n.write_shift(4,0),Dr([t,r,n])}function sae(e){var t=dr(e),r=be(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function oae(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var a=dr(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=be(17);return i.write_shift(4,9),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.r),i.write_shift(2,a.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i}function lae(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=be(17);return a.write_shift(4,9),a.write_shift(1,60),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(4,0),a}function cae(e){var t=e.split(":"),r=t[0],n=be(23);n.write_shift(4,15),r=t[0];var a=dr(r);return n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],a=dr(r),n.write_shift(1,36),n.write_shift(4,a.r),n.write_shift(2,a.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function uae(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=e.split(":"),i=be(27);i.write_shift(4,19);var s=a[0],l=dr(s);return i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(d){return d.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),s=a[1],l=dr(s),i.write_shift(1,58),i.write_shift(2,2+t.SheetNames.map(function(d){return d.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,l.r),i.write_shift(2,l.c|(s.charAt(0)=="$"?0:1)<<14|(s.match(/\$\d/)?0:1)<<15),i.write_shift(1,17),i.write_shift(4,0),i}function dae(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=fn(e),i=be(23);return i.write_shift(4,15),i.write_shift(1,59),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,a.s.r),i.write_shift(4,a.e.r),i.write_shift(2,a.s.c),i.write_shift(2,a.e.c),i.write_shift(4,0),i}function fae(e,t){if(typeof e=="number")return Bk(e);if(typeof e=="boolean")return aae(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return nae(+Ei[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return sae(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return cae(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return dae(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return oae(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return uae(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return lae(e,t);if(/^".*"$/.test(e))return iae(e);if(/^[+-]\d+$/.test(e))return Bk(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var hae=fae,pae={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mae={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xae(e){var t="of:="+e.replace(Rp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function O5(e){return e.replace(/!/,".").replace(/:/,":.")}var Bu=typeof Map<"u";function Cb(e,t,r){var n=0,a=e.length;if(r){if(Bu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Bu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Bu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Lp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(as=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Ph(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Y1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function D5(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function po(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){WJ(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function gae(e,t,r){if(e&&e["!ref"]){var n=ir(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function vae(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Mr(e[r])+'"/>';return t+"</mergeCells>"}function yae(e,t,r,n,a){var i=!1,s={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}i=!0,s.codeName=rd(Nt(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),l=(l||"")+Xe("outlinePr",null,h)}!i&&!l||(a[a.length]=Xe("sheetPr",l,s))}var wae=["objects","scenarios","selectLockedCells","selectUnlockedCells"],bae=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _ae(e){var t={sheet:1};return wae.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),bae.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=g5(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}function Sae(e){return D5(e),Xe("pageMargins",null,e)}function Nae(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Xe("col",null,Lp(a,n)));return r[r.length]="</cols>",r.join("")}function Eae(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Mr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=fn(a);s.s.r==s.e.r&&(s.e.r=fn(t["!ref"]).e.r,a=Mr(s));for(var l=0;l<i.length;++l){var d=i[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref=id(r.SheetNames[n])+"!"+ad(a);break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Xe("autoFilter",null,{ref:a})}function Tae(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,a),{})}function Cae(e,t,r,n,a,i,s){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var l="",d=e.t,h=e.v;if(e.t!=="z")switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=Hn[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=Hn[e.v=7]);break;case"e":l=Hn[e.v];break;case"d":if(n&&n.cellDates){var f=ca(e.v,s);l=f.toISOString(),f.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else e=On(e),e.t="n",l=""+(e.v=pn(ca(e.v,s),s));typeof e.z>"u"&&(e.z=ar[14]);break;default:l=e.v;break}var p=e.t=="z"||e.v==null?"":dn("v",Nt(l)),x={r:t},g=po(n.cellXfs,e,n);switch(g!==0&&(x.s=g),e.t){case"n":break;case"d":x.t="d";break;case"b":x.t="b";break;case"e":x.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){p=dn("v",""+Cb(n.Strings,e.v,n.revStrings)),x.t="s";break}else x.t="str";break}if(e.t!=d&&(e.t=d,e.v=h),typeof e.f=="string"&&e.f){var b=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;p=Xe("f",Nt(e.f),b)+(e.v!=null?p:"")}return e.l&&(e.l.display=Nt(l),r["!links"].push([t,e.l])),e.D&&(x.cm=1),Xe("c",p,x)}function kae(e,t,r,n){var a=[],i=[],s=ir(e["!ref"]),l="",d,h="",f=[],p=0,x=0,g=e["!rows"],b=e["!data"]!=null,_=b?e["!data"]:[],w={r:h},S,T=-1,E=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(x=s.s.c;x<=s.e.c;++x)f[x]=Ht(x);for(p=s.s.r;p<=s.e.r;++p){i=[],h=Yt(p);var k=b?_[p]:[];for(x=s.s.c;x<=s.e.c;++x){d=f[x]+h;var A=b?k[x]:e[d];A!==void 0&&(l=Cae(A,d,e,t,r,n,E))!=null&&i.push(l)}(i.length>0||g&&g[p])&&(w={r:h},g&&g[p]&&(S=g[p],S.hidden&&(w.hidden=1),T=-1,S.hpx?T=jh(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(w.ht=T,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),a[a.length]=Xe("row",i.join(""),w))}if(g)for(;p<g.length;++p)g&&g[p]&&(w={r:p+1},S=g[p],S.hidden&&(w.hidden=1),T=-1,S.hpx?T=jh(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(w.ht=T,w.customHeight=1),S.level&&(w.outlineLevel=S.level),a[a.length]=Xe("row","",w));return a.join("")}function Aae(e,t,r,n){var a=[Br,Xe("worksheet",null,{xmlns:Ac[0],"xmlns:r":en.r})],i=r.SheetNames[e],s=0,l="",d=r.Sheets[i];d==null&&(d={});var h=d["!ref"]||"A1",f=ir(h);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),h=Mr(f)}n||(n={}),d["!comments"]=[];var p=[];yae(d,r,e,t,a),a[a.length]=Xe("dimension",null,{ref:h}),a[a.length]=Tae(d,t,e,r),t.sheetFormat&&(a[a.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=Nae(d,d["!cols"])),a[s=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(l=kae(d,t,e,r),l.length>0&&(a[a.length]=l)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),d["!protect"]&&(a[a.length]=_ae(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=Eae(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=vae(d["!merges"]));var x=-1,g,b=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(_){_[1].Target&&(g={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=Lt(n,-1,Nt(_[1].Target).replace(/#[\s\S]*$/,""),Pt.HLINK),g["r:id"]="rId"+b),(x=_[1].Target.indexOf("#"))>-1&&(g.location=Nt(_[1].Target.slice(x+1))),_[1].Tooltip&&(g.tooltip=Nt(_[1].Tooltip)),g.display=_[1].display,a[a.length]=Xe("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=Sae(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=dn("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),p.length>0&&(b=Lt(n,-1,"../drawings/drawing"+(e+1)+".xml",Pt.DRAW),a[a.length]=Xe("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=p),d["!comments"].length>0&&(b=Lt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Pt.VML),a[a.length]=Xe("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Pae(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function jae(e,t,r){var n=be(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=jh(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var l=0,d=n.l;n.l+=4;for(var h={r:e,c:0},f=r["!data"]!=null,p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var x=-1,g=-1,b=p<<10;b<p+1<<10;++b){h.c=b;var _=f?(r["!data"][h.r]||[])[h.c]:r[vr(h)];_&&(x<0&&(x=b),g=b)}x<0||(++l,n.write_shift(4,x),n.write_shift(4,g))}var w=n.l;return n.l=d,n.write_shift(4,l),n.l=w,n.length>n.l?n.slice(0,n.l):n}function Oae(e,t,r,n){var a=jae(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Me(e,0,a)}var Dae=dl,Rae=Oc;function Iae(){}function Fae(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Pee(e),r}function Mae(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Ch({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Z3(e,r),r.slice(0,r.l)}function Lae(e){var t=Xa(e);return[t]}function Bae(e,t,r){return r==null&&(r=be(8)),ll(t,r)}function $ae(e){var t=cl(e);return[t]}function Uae(e,t,r){return r==null&&(r=be(4)),ul(t,r)}function zae(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"b"]}function Wae(e,t,r){return r==null&&(r=be(9)),ll(t,r),r.write_shift(1,e.v?1:0),r}function Hae(e){var t=cl(e),r=e.read_shift(1);return[t,r,"b"]}function Kae(e,t,r){return r==null&&(r=be(5)),ul(t,r),r.write_shift(1,e.v?1:0),r}function Vae(e){var t=Xa(e),r=e.read_shift(1);return[t,r,"e"]}function Av(e,t,r){return r==null&&(r=be(9)),ll(t,r),r.write_shift(1,e.v),r}function Gae(e){var t=cl(e),r=e.read_shift(1);return[t,r,"e"]}function Pv(e,t,r){return r==null&&(r=be(8)),ul(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Yae(e){var t=Xa(e),r=e.read_shift(4);return[t,r,"s"]}function Xae(e,t,r){return r==null&&(r=be(12)),ll(t,r),r.write_shift(4,t.v),r}function qae(e){var t=cl(e),r=e.read_shift(4);return[t,r,"s"]}function Qae(e,t,r){return r==null&&(r=be(8)),ul(t,r),r.write_shift(4,t.v),r}function Zae(e){var t=Xa(e),r=Dc(e);return[t,r,"n"]}function Jae(e,t,r){return r==null&&(r=be(16)),ll(t,r),nl(e.v,r),r}function eie(e){var t=cl(e),r=Dc(e);return[t,r,"n"]}function tie(e,t,r){return r==null&&(r=be(12)),ul(t,r),nl(e.v,r),r}function rie(e){var t=Xa(e),r=Sb(e);return[t,r,"n"]}function nie(e,t,r){return r==null&&(r=be(12)),ll(t,r),J3(e.v,r),r}function aie(e){var t=cl(e),r=Sb(e);return[t,r,"n"]}function iie(e,t,r){return r==null&&(r=be(8)),ul(t,r),J3(e.v,r),r}function sie(e){var t=Xa(e),r=bb(e);return[t,r,"is"]}function oie(e){var t=Xa(e),r=Pn(e);return[t,r,"str"]}function lie(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(12+4*e.v.length)),ll(t,r),Wr(n,r),r.length>r.l?r.slice(0,r.l):r}function cie(e){var t=cl(e),r=Pn(e);return[t,r,"str"]}function uie(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=be(8+4*n.length)),ul(t,r),Wr(n,r),r.length>r.l?r.slice(0,r.l):r}function die(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var l=Mp(e,n-e.l,r);s[3]=pc(l,null,a,r.supbooks,r)}else e.l=n;return s}function fie(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var l=Mp(e,n-e.l,r);s[3]=pc(l,null,a,r.supbooks,r)}else e.l=n;return s}function hie(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=Dc(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var l=Mp(e,n-e.l,r);s[3]=pc(l,null,a,r.supbooks,r)}else e.l=n;return s}function pie(e,t,r){var n=e.l+t,a=Xa(e);a.r=r["!row"];var i=Pn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var l=Mp(e,n-e.l,r);s[3]=pc(l,null,a,r.supbooks,r)}else e.l=n;return s}var mie=dl,xie=Oc;function gie(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function vie(e,t){var r=e.l+t,n=dl(e),a=Dp(e),i=Pn(e),s=Pn(e),l=Pn(e);e.l=r;var d={rfx:n,relId:a,loc:i,display:l};return s&&(d.Tooltip=s),d}function yie(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Oc({s:dr(e[0]),e:dr(e[0])},r),_b("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Wr(a||"",r),Wr(e[1].Tooltip||"",r),Wr("",r),r.slice(0,r.l)}function wie(){}function bie(e,t,r){var n=e.l+t,a=e5(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var l=eae(e,n-e.l,r);s[1]=l}else e.l=n;return s}function _ie(e,t,r){var n=e.l+t,a=dl(e),i=[a];if(r.cellFormula){var s=rae(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Sie(e,t,r){r==null&&(r=be(18));var n=Lp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var R5=["left","right","top","bottom","header","footer"];function Nie(e){var t={};return R5.forEach(function(r){t[r]=Dc(e)}),t}function Eie(e,t){return t==null&&(t=be(48)),D5(e),R5.forEach(function(r){nl(e[r],t)}),t}function Tie(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Cie(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function kie(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),Oc(e,t),t}function Aie(e,t){return t==null&&(t=be(66)),t.write_shift(2,e.password?g5(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Pie(){}function jie(){}function Oie(e,t,r,n,a,i,s,l){var d={r,c:n};if(t.c&&i["!comments"].push([vr(d),t.c]),t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=On(t),t.z=t.z||ar[14],t.v=pn(ca(t.v,l),l),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}switch(d.s=po(a.cellXfs,t,a),t.l&&i["!links"].push([vr(d),t.l]),t.t){case"s":case"str":return a.bookSST?(h=Cb(a.Strings,t.v==null?"":String(t.v),a.revStrings),d.t="s",d.v=h,s?Me(e,18,Qae(t,d)):Me(e,7,Xae(t,d))):(d.t="str",s?Me(e,17,uie(t,d)):Me(e,6,lie(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Me(e,13,iie(t,d)):Me(e,2,nie(t,d)):isFinite(t.v)?s?Me(e,16,tie(t,d)):Me(e,5,Jae(t,d)):(d.t="e",isNaN(t.v)?s?Me(e,14,Pv({v:36},d)):Me(e,3,Av({v:36},d)):s?Me(e,14,Pv({v:7},d)):Me(e,3,Av({v:7},d))),!0;case"b":return d.t="b",s?Me(e,15,Kae(t,d)):Me(e,4,Wae(t,d)),!0;case"e":return d.t="e",s?Me(e,14,Pv(t,d)):Me(e,3,Av(t,d)),!0}return s?Me(e,12,Uae(t,d)):Me(e,1,Bae(t,d)),!0}function Die(e,t,r,n,a){var i=ir(t["!ref"]||"A1"),s="",l=[],d=(((a||{}).Workbook||{}).WBProps||{}).date1904;Me(e,145);var h=t["!data"]!=null,f=h?t["!data"][i.s.r]:[],p=i.e.r;t["!rows"]&&(p=Math.max(i.e.r,t["!rows"].length-1));for(var x=i.s.r;x<=p;++x)if(s=Yt(x),h&&(f=t["!data"][x]),Oae(e,t,i,x),!(h&&!f)){var g=!1;if(x<=i.e.r)for(var b=i.s.c;b<=i.e.c;++b){x===i.s.r&&(l[b]=Ht(b));var _=h?f[b]:t[l[b]+s];if(!_){g=!1;continue}g=Oie(e,_,x,b,n,t,g,d)}}Me(e,146)}function Rie(e,t){!t||!t["!merges"]||(Me(e,177,gie(t["!merges"].length)),t["!merges"].forEach(function(r){Me(e,176,xie(r))}),Me(e,178))}function Iie(e,t){!t||!t["!cols"]||(Me(e,390),t["!cols"].forEach(function(r,n){r&&Me(e,60,Sie(n,r))}),Me(e,391))}function Fie(e,t){!t||!t["!ref"]||(Me(e,648),Me(e,649,kie(ir(t["!ref"]))),Me(e,650))}function Mie(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Lt(r,-1,n[1].Target.replace(/#[\s\S]*$/,""),Pt.HLINK);Me(e,494,yie(n,a))}}),delete t["!links"]}function Lie(e,t,r,n){if(t["!comments"].length>0){var a=Lt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pt.VML);Me(e,551,_b("rId"+a)),t["!legacy"]=a}}function Bie(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Mr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=fn(i);l.s.r==l.e.r&&(l.e.r=fn(t["!ref"]).e.r,i=Mr(l));for(var d=0;d<s.length;++d){var h=s[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref=id(r.SheetNames[n])+"!"+ad(i);break}}d==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:id(r.SheetNames[n])+"!"+ad(i)}),Me(e,161,Oc(ir(i))),Me(e,162)}}function $ie(e,t,r){Me(e,133),Me(e,137,Cie(t,r)),Me(e,138),Me(e,134)}function Uie(e,t){t["!protect"]&&Me(e,535,Aie(t["!protect"]))}function zie(e,t,r,n){var a=An(),i=r.SheetNames[e],s=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var d=ir(s["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Me(a,129),(r.vbaraw||s["!outline"])&&Me(a,147,Mae(l,s["!outline"])),Me(a,148,Rae(d)),$ie(a,s,r.Workbook),Iie(a,s),Die(a,s,e,t,r),Uie(a,s),Bie(a,s,r,e),Rie(a,s),Mie(a,s,n),s["!margins"]&&Me(a,476,Eie(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Fie(a,s),Lie(a,s,e,n),Me(a,130),a.end()}function Wie(e,t){e.l+=10;var r=Pn(e);return{name:r}}var Hie=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Kie(e){return!e.Workbook||!e.Workbook.WBProps?"false":oee(e.Workbook.WBProps.date1904)?"true":"false"}var Vie=":][*?/\\".split("");function I5(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");Vie.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function Gie(e,t,r){e.forEach(function(n,a){I5(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Yie(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Gie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)gae(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,a){var i=e.Sheets[n];if(!(!i||!i["!autofilter"])){var s;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(d){d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a&&(s=d)});var l=id(n)+"!"+ad(i["!autofilter"].ref);s?s.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:l})}})}function Xie(e){var t=[Br];t[t.length]=Xe("workbook",null,{xmlns:Ac[0],"xmlns:r":en.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Hie.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Xe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Nt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Xe("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var d={name:l.Name};l.Comment&&(d.comment=l.Comment),l.Sheet!=null&&(d.localSheetId=""+l.Sheet),l.Hidden&&(d.hidden="1"),l.Ref&&(t[t.length]=Xe("definedName",Nt(l.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function qie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=G1(e),r.name=Pn(e),r}function Qie(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),_b(e.strRelID,t),Wr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Zie(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Pn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Jie(e,t){t||(t=be(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),Z3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function ese(e,t,r){var n=e.l+t,a=e.read_shift(4);e.l+=1;var i=e.read_shift(4),s=jee(e),l,d="";try{l=tae(e,0,r);try{d=Dp(e)}catch{}}catch{console.error("Could not parse defined name "+s)}a&32&&(s="_xlnm."+s),e.l=n;var h={Name:s,Ptg:l,Flags:a};return i<268435455&&(h.Sheet=i),d&&(h.Comment=d),h}function tse(e,t){var r=be(9),n=0,a=e.Name;Wee.indexOf(a)>-1&&(n|=32,a=a.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var i=[r,Wr(a),hae(e.Ref,t)];if(e.Comment)i.push(sd(e.Comment));else{var s=be(4);s.write_shift(4,4294967295),i.push(s)}return Dr(i)}function rse(e,t){Me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Me(e,156,Qie(a))}Me(e,144)}function nse(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Wr("SheetJS",t),Wr(vh.version,t),Wr(vh.version,t),Wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function ase(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ise(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Me(e,135),Me(e,158,ase(a)),Me(e,136))}}function sse(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;Me(e,39,tse(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function ose(e){var t=e.SheetNames.length,r=be(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function lse(e,t){Me(e,353),Me(e,357),Me(e,362,ose(t)),Me(e,354)}function cse(e,t){var r=An();return Me(r,131),Me(r,128,nse()),Me(r,153,Jie(e.Workbook&&e.Workbook.WBProps||null)),ise(r,e),rse(r,e),lse(r,e),(e.Workbook||{}).Names&&sse(r,e),Me(r,132),r.end()}function use(e,t){var r=[];return e.Props&&r.push(Yee(e.Props,t)),e.Custprops&&r.push(Xee(e.Props,e.Custprops)),r.join("")}function dse(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function fse(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Xe("NumberFormat",null,{"ss:Format":Nt(ar[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Xe("Style",i.join(""),s))}),Xe("Styles",r.join(""))}function F5(e){return Xe("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+Ip(e.Ref,{r:0,c:0})})}function hse(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(F5(a)))}return Xe("Names",r.join(""))}function pse(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var l=a[s];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(F5(l)))}return i.join("")}function mse(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(dn("ProtectContents","True")),e["!protect"].objects&&a.push(dn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(dn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(dn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(dn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Xe("WorksheetOptions",a.join(""),{xmlns:ba.x})}function xse(e){return e.map(function(t){var r=see(t.t||""),n=Xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),a={};return t.a&&(a["ss:Author"]=t.a),e.hidden||(a["ss:ShowAlways"]="1"),Xe("Comment",n,a)}).join("")}function gse(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Nt(Ip(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var d=dr(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(d.r==s.r?"":"["+(d.r-s.r)+"]")+"C"+(d.c==s.c?"":"["+(d.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Nt(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Nt(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],f=0;f!=h.length;++f)h[f].s.c!=s.c||h[f].s.r!=s.r||(h[f].e.c>h[f].s.c&&(l["ss:MergeAcross"]=h[f].e.c-h[f].s.c),h[f].e.r>h[f].s.r&&(l["ss:MergeDown"]=h[f].e.r-h[f].s.r));var p="",x="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(p="Number",x=String(e.v)):(p="Error",x=Hn[isNaN(e.v)?36:7]);break;case"b":p="Boolean",x=e.v?"1":"0";break;case"e":p="Error",x=Hn[e.v];break;case"d":p="DateTime",x=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ar[14]);break;case"s":p="String",x=iee(e.v||"");break}var g=po(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+g),l["ss:Index"]=s.c+1;var b=e.v!=null?x:"",_=e.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(e.c||[]).length>0&&(_+=xse(e.c)),Xe("Cell",_,l)}function vse(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=y5(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function yse(e,t,r,n){if(!e["!ref"])return"";var a=ir(e["!ref"]),i=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(w,S){Eb(w);var T=!!w.width,E=Lp(S,w),k={"ss:Index":S+1};T&&(k["ss:Width"]=Ah(E.width)),w.hidden&&(k["ss:Hidden"]="1"),l.push(Xe("Column",null,k))});for(var d=e["!data"]!=null,h={r:0,c:0},f=a.s.r;f<=a.e.r;++f){var p=[vse(f,(e["!rows"]||[])[f])];h.r=f;for(var x=a.s.c;x<=a.e.c;++x){h.c=x;var g=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>x)&&!(i[s].s.r>f)&&!(i[s].e.c<x)&&!(i[s].e.r<f)){(i[s].s.c!=x||i[s].s.r!=f)&&(g=!0);break}if(!g){var b=Ht(x)+Yt(f),_=d?(e["!data"][f]||[])[x]:e[b];p.push(gse(_,b,e,t,r,n,h))}}p.push("</Row>"),p.length>2&&l.push(p.join(""))}return l.join("")}function wse(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?pse(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?yse(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(mse(i,t,e,r)),i&&i["!autofilter"]&&n.push('<AutoFilter x:Range="'+Ip(ad(i["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function bse(e,t){t||(t={}),e.SSF||(e.SSF=On(ar)),e.SSF&&(Pp(),Ap(e.SSF),t.revssf=jp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(use(e,t)),r.push(dse(e)),r.push(""),r.push(hse(e));for(var n=0;n<e.SheetNames.length;++n)r.push(Xe("Worksheet",wse(n,t,e),{"ss:Name":Nt(e.SheetNames[n])}));return r[2]=fse(e,t),Br+Xe("Workbook",r.join(""),{xmlns:ba.ss,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:ss":ba.ss,"xmlns:dt":ba.dt,"xmlns:html":ba.html})}var jv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _se(e,t){var r=[],n=[],a=[],i=0,s,l=uk(bk,"n"),d=uk(_k,"n");if(e.Props)for(s=Fr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(d,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Fr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(l,s[i])?r:Object.prototype.hasOwnProperty.call(d,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var h=[];for(i=0;i<a.length;++i)u5.indexOf(a[i][0])>-1||o5.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);n.length&&Xt.utils.cfb_add(t,"/SummaryInformation",Ck(n,jv.SI,d,_k)),(r.length||h.length)&&Xt.utils.cfb_add(t,"/DocumentSummaryInformation",Ck(r,jv.DSI,l,bk,h.length?h:null,jv.UDI))}function Sse(e,t){var r=t||{},n=Xt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xt.utils.cfb_add(n,a,L5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&_se(e,n),r.biff==8&&e.vbaraw&&Dre(n,Xt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Nse={0:{f:Pae},1:{f:Lae},2:{f:rie},3:{f:Vae},4:{f:zae},5:{f:Zae},6:{f:oie},7:{f:Yae},8:{f:pie},9:{f:hie},10:{f:die},11:{f:fie},12:{f:$ae},13:{f:aie},14:{f:Gae},15:{f:Hae},16:{f:eie},17:{f:cie},18:{f:qae},19:{f:bb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ese},40:{},42:{},43:{f:Zte},44:{f:qte},45:{f:tre},46:{f:nre},47:{f:rre},48:{},49:{f:Nee},50:{},51:{f:yre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:kte},62:{f:sie},63:{f:Tre},64:{f:Pie},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Oi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Tie},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Fae},148:{f:Dae,p:16},151:{f:wie},152:{},153:{f:Zie},154:{},155:{},156:{f:qie},157:{},158:{},159:{T:1,f:Bte},160:{T:-1},161:{T:1,f:dl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mie},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gre},336:{T:-1},337:{f:_re,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:G1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ste},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bie},427:{f:_ie},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Nie},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Iae},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vie},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:G1},551:{f:Dp},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jre},633:{T:1},634:{T:-1},635:{T:1,f:Are},636:{T:-1},637:{f:kee},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Wie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jie},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function $e(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&vb(r)&&e.push(r)}}function Ese(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return $e(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],l=0,d=0,h=0;h+(s[l]||8224)<=8224;)h+=s[l]||8224,l++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h;d<a;){for(f=e.next(4),f.write_shift(2,60),h=0;h+(s[l]||8224)<=8224;)h+=s[l]||8224,l++;f.write_shift(2,h),e.push(r.slice(d,d+h)),d+=h}}}function Ov(e,t,r,n){var a=be(9);return Od(a,e,t),d5(r,n||"b",a),a}function Tse(e,t,r){var n=be(8+2*r.length);return Od(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function M5(e,t){t.forEach(function(r){var n=r[0].map(function(i){return i.t}).join("");if(n.length<=2048)return $e(e,28,Cv(n,r[1],r[2]));$e(e,28,Cv(n.slice(0,2048),r[1],r[2],n.length));for(var a=2048;a<n.length;a+=2048)$e(e,28,Cv(n.slice(a,Math.min(a+2048,n.length)),-1,-1,Math.min(2048,n.length-a)))})}function Cse(e,t,r,n,a,i){var s=0;t.z!=null&&(s=a._BIFF2FmtTable.indexOf(t.z),s==-1&&(a._BIFF2FmtTable.push(t.z),s=a._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<a.cellXfs.length&&a.cellXfs[l].numFmtId!=s;++l);l==a.cellXfs.length&&a.cellXfs.push({numFmtId:s})}if(t.v!=null)switch(t.t){case"d":case"n":var d=t.t=="d"?pn(ca(t.v,i),i):t.v;a.biff==2&&d==(d|0)&&d>=0&&d<65536?$e(e,2,Ote(r,n,d,l,s)):isNaN(d)?$e(e,5,Ov(r,n,36,"e")):isFinite(d)?$e(e,3,jte(r,n,d,l,s)):$e(e,5,Ov(r,n,7,"e"));return;case"b":case"e":$e(e,5,Ov(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,Tse(r,n,t.v==null?"":String(t.v).slice(0,255)));return}$e(e,1,Od(null,r,n))}function kse(e,t,r,n,a){var i=t["!data"]!=null,s=ir(t["!ref"]||"A1"),l="",d=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.r,16383)}for(var h=(((a||{}).Workbook||{}).WBProps||{}).date1904,f=[],p=[],x=s.s.c;x<=s.e.c;++x)d[x]=Ht(x);for(var g=s.s.r;g<=s.e.r;++g)for(i&&(f=t["!data"][g]||[]),l=Yt(g),x=s.s.c;x<=s.e.c;++x){var b=i?f[x]:t[d[x]+l];b&&(Cse(e,b,g,x,n,h),b.c&&p.push([b.c,g,x]))}M5(e,p)}function Ase(e,t){for(var r=t||{},n=An(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);$e(n,r.biff==4?1033:r.biff==3?521:9,Nb(e,16,r)),((e.Workbook||{}).WBProps||{}).date1904&&$e(n,34,En(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var s=An();return kse(s,e.Sheets[e.SheetNames[a]],a,r,e),r._BIFF2FmtTable.forEach(function(l){r.biff<=3?$e(n,30,xte(l)):$e(n,1054,gte(l))}),r.cellXfs.forEach(function(l){switch(r.biff){case 2:$e(n,67,yte(l));break;case 3:$e(n,579,m5(l));break;case 4:$e(n,1091,wte(l));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(s.end()),$e(n,10),n.end()}var ni=1,$a=[];function Pse(){var e=be(82+8*$a.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*$a.length);{e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*$a.length);{e.write_shift(4,ni),e.write_shift(4,$a.length+1);for(var t=0,r=0;r<$a.length;++r)t+=$a[r]&&$a[r][1]||0;e.write_shift(4,t),e.write_shift(4,$a.length)}$a.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])})}return e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}function jse(e,t){var r=[],n=0,a=An(),i=ni,s;t.forEach(function(d,h){var f="",p=d[0].map(function(E){return E.a&&!f&&(f=E.a),E.t}).join("");++ni;{var x=be(150);x.write_shift(2,15),x.write_shift(2,61444),x.write_shift(4,150),x.write_shift(2,3234),x.write_shift(2,61450),x.write_shift(4,8),x.write_shift(4,ni),x.write_shift(4,2560),x.write_shift(2,227),x.write_shift(2,61451),x.write_shift(4,84),x.write_shift(2,128),x.write_shift(4,0),x.write_shift(2,139),x.write_shift(4,2),x.write_shift(2,191),x.write_shift(4,524296),x.write_shift(2,344),x.l+=4,x.write_shift(2,385),x.write_shift(4,134217808),x.write_shift(2,387),x.write_shift(4,134217808),x.write_shift(2,389),x.write_shift(4,268435700),x.write_shift(2,447),x.write_shift(4,1048592),x.write_shift(2,448),x.write_shift(4,134217809),x.write_shift(2,451),x.write_shift(4,268435700),x.write_shift(2,513),x.write_shift(4,134217809),x.write_shift(2,515),x.write_shift(4,268435700),x.write_shift(2,575),x.write_shift(4,196609),x.write_shift(2,959),x.write_shift(4,131072|(d[0].hidden?2:0)),x.l+=2,x.write_shift(2,61456),x.write_shift(4,18),x.write_shift(2,3),x.write_shift(2,d[2]+2),x.l+=2,x.write_shift(2,d[1]+1),x.l+=2,x.write_shift(2,d[2]+4),x.l+=2,x.write_shift(2,d[1]+5),x.l+=2,x.l+=2,x.write_shift(2,61457),x.l+=4,x.l=150,h==0?s=x:$e(a,236,x)}n+=150;{var g=be(52);g.write_shift(2,21),g.write_shift(2,18),g.write_shift(2,25),g.write_shift(2,ni),g.write_shift(2,0),g.l=22,g.write_shift(2,13),g.write_shift(2,22),g.write_shift(4,1651663474),g.write_shift(4,2503426821),g.write_shift(4,2150634280),g.write_shift(4,1768515844+ni*256),g.write_shift(2,0),g.write_shift(4,0),g.l+=4,$e(a,93,g)}{var b=be(8);b.l+=2,b.write_shift(2,61453),b.l+=4,$e(a,236,b)}n+=8;{var _=be(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,p.length),_.write_shift(2,16),_.l+=4,$e(a,438,_);{var w=be(1+p.length);w.write_shift(1,0),w.write_shift(p.length,p,"sbcs"),$e(a,60,w)}{var S=be(16);S.l+=8,S.write_shift(2,p.length),S.l+=6,$e(a,60,S)}}{var T=be(12+f.length);T.write_shift(2,d[1]),T.write_shift(2,d[2]),T.write_shift(2,0|(d[0].hidden?0:2)),T.write_shift(2,ni),T.write_shift(2,f.length),T.write_shift(1,0),T.write_shift(f.length,f,"sbcs"),T.l++,r.push(T)}});{var l=be(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,ni),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,i),l.write_shift(4,5),$e(e,236,s?Dr([l,s]):l)}e.push(a.end()),r.forEach(function(d){$e(e,28,d)}),$a.push([i,t.length+1,ni]),++ni}function Ose(e,t,r){$e(e,49,fte({sz:12,name:"Arial"},r))}function Dse(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&$e(e,1054,mte(a,t[a],r))})}function Rse(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),p5(ir(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function Ise(e,t){for(var r=0;r<16;++r)$e(e,224,Ak({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,Ak(n,0,t))})}function Fse(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,Ete(n)),n[1].Tooltip&&$e(e,2048,Tte(n))}delete t["!links"]}function Mse(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&$e(e,125,Ate(Lp(a,n),a))})}}function Lse(e,t,r,n,a,i){var s=16+po(a.cellXfs,t,a);if(t.v==null&&!t.bf){$e(e,513,al(r,n,s));return}if(t.bf)$e(e,6,Jne(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?pn(ca(t.v,i),i):t.v;isNaN(l)?$e(e,517,Tv(r,n,36,s,a,"e")):isFinite(l)?$e(e,515,_te(r,n,l,s)):$e(e,517,Tv(r,n,7,s,a,"e"));break;case"b":case"e":$e(e,517,Tv(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var d=Cb(a.Strings,t.v==null?"":String(t.v),a.revStrings);$e(e,253,hte(r,n,d,s))}else $e(e,516,pte(r,n,(t.v==null?"":String(t.v)).slice(0,255),s,a));break;default:$e(e,513,al(r,n,s))}}function Bse(e,t,r){var n=An(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},d=i["!data"]!=null,h=t.biff==8,f="",p=[],x=ir(i["!ref"]||"A1"),g=h?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV"+g);x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.r,g-1)}$e(n,2057,Nb(r,16,t)),$e(n,13,Ua(1)),$e(n,12,Ua(100)),$e(n,15,En(!0)),$e(n,17,En(!1)),$e(n,16,nl(.001)),$e(n,95,En(!0)),$e(n,42,En(!1)),$e(n,43,En(!1)),$e(n,130,Ua(1)),$e(n,128,bte()),$e(n,131,En(!1)),$e(n,132,En(!1)),h&&Mse(n,i["!cols"]),$e(n,512,vte(x,t));var b=(((r||{}).Workbook||{}).WBProps||{}).date1904;h&&(i["!links"]=[]);for(var _=x.s.c;_<=x.e.c;++_)p[_]=Ht(_);for(var w=[],S=[],T=x.s.r;T<=x.e.r;++T)for(d&&(S=i["!data"][T]||[]),f=Yt(T),_=x.s.c;_<=x.e.c;++_){var E=d?S[_]:i[p[_]+f];E&&(Lse(n,E,T,_,t,b),h&&E.l&&i["!links"].push([p[_]+f,E.l]),E.c&&w.push([E.c,T,_]))}var k=l.CodeName||l.name||a;return h?jse(n,w):M5(n,w),h&&$e(n,574,dte((s.Views||[])[0])),h&&(i["!merges"]||[]).length&&$e(n,229,Nte(i["!merges"])),h&&Fse(n,i),$e(n,442,h5(k)),h&&Rse(n,i),$e(n,10),n.end()}function $se(e,t,r){var n=An(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},l=r.biff==8,d=r.biff==5;if($e(n,2057,Nb(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,l?Ua(1200):null),$e(n,193,Zee(2)),d&&$e(n,191),d&&$e(n,192),$e(n,226),$e(n,92,ote("SheetJS",r)),$e(n,66,Ua(l?1200:1252)),l&&$e(n,353,Ua(0)),l&&$e(n,448),$e(n,317,Pte(e.SheetNames.length)),l&&e.vbaraw&&$e(n,211),l&&e.vbaraw){var h=s.CodeName||"ThisWorkbook";$e(n,442,h5(h))}$e(n,156,Ua(17)),$e(n,25,En(!1)),$e(n,18,En(!1)),$e(n,19,Ua(0)),l&&$e(n,431,En(!1)),l&&$e(n,444,Ua(0)),$e(n,61,ute()),$e(n,64,En(!1)),$e(n,141,Ua(0)),$e(n,34,En(Kie(e)=="true")),$e(n,14,En(!0)),l&&$e(n,439,En(!1)),$e(n,218,Ua(0)),Ose(n,e,r),Dse(n,e.SSF,r),Ise(n,r),l&&$e(n,352,En(!1));var f=n.end(),p=An();l&&$e(p,140,Cte()),l&&$a.length&&$e(p,235,Pse()),l&&r.Strings&&Ese(p,252,cte(r.Strings)),$e(p,10);var x=p.end(),g=An(),b=0,_=0;for(_=0;_<e.SheetNames.length;++_)b+=(l?12:11)+(l?2:1)*e.SheetNames[_].length;var w=f.length+b+x.length;for(_=0;_<e.SheetNames.length;++_){var S=i[_]||{};$e(g,133,lte({pos:w,hs:S.Hidden||0,dt:0,name:e.SheetNames[_]},r)),w+=t[_].length}var T=g.end();if(b!=T.length)throw new Error("BS8 "+b+" != "+T.length);var E=[];return f.length&&E.push(f),T.length&&E.push(T),x.length&&E.push(x),Dr(E)}function Use(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=On(ar)),e&&e.SSF&&(Pp(),Ap(e.SSF),r.revssf=jp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),ni=1,$a=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kb(r),r.cellXfs=[],po(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Bse(a,r,e);return n.unshift($se(e,n,r)),Dr(n)}function L5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=fn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost."),a.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond row 65536.  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Use(e,t);case 4:case 3:case 2:return Ase(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function zse(e,t,r,n){for(var a=e["!merges"]||[],i=[],s={},l=e["!data"]!=null,d=t.s.c;d<=t.e.c;++d){for(var h=0,f=0,p=0;p<a.length;++p)if(!(a[p].s.r>r||a[p].s.c>d)&&!(a[p].e.r<r||a[p].e.c<d)){if(a[p].s.r<r||a[p].s.c<d){h=-1;break}h=a[p].e.r-a[p].s.r+1,f=a[p].e.c-a[p].s.c+1;break}if(!(h<0)){var x=Ht(d)+Yt(r),g=l?(e["!data"][r]||[])[d]:e[x];g&&g.t=="n"&&g.v!=null&&!isFinite(g.v)&&(isNaN(g.v)?g={t:"e",v:36,w:Hn[36]}:g={t:"e",v:7,w:Hn[7]});var b=g&&g.v!=null&&(g.h||_v(g.w||(ds(g),g.w)||""))||"";s={},h>1&&(s.rowspan=h),f>1&&(s.colspan=f),n.editable?b='<span contenteditable="true">'+b+"</span>":g&&(s["data-t"]=g&&g.t||"z",g.v!=null&&(s["data-v"]=_v(g.v instanceof Date?g.v.toISOString():g.v)),g.z!=null&&(s["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+_v(g.l.Target)+'">'+b+"</a>")),s.id=(n.id||"sjs")+"-"+x,i.push(Xe("td",b,s))}}var _="<tr>";return _+i.join("")+"</tr>"}var Wse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Hse="</body></html>";function Kse(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function B5(e,t){var r=t||{},n=r.header!=null?r.header:Wse,a=r.footer!=null?r.footer:Hse,i=[n],s=fn(e["!ref"]||"A1");if(i.push(Kse(e,s,r)),e["!ref"])for(var l=s.s.r;l<=s.e.r;++l)i.push(zse(e,s,l,r));return i.push("</table>"+a),i.join("")}function $5(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var a=r||{},i=e["!data"]!=null,s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var d=typeof a.origin=="string"?dr(a.origin):a.origin;s=d.r,l=d.c}var h=Math.min(a.sheetRows||1e7,n.length),f={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=fn(e["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),s==-1&&(f.e.r=s=p.e.r+1)}var x=[],g=0,b=e["!rows"]||(e["!rows"]=[]),_=0,w=0,S=0,T=0,E=0,k=0;for(e["!cols"]||(e["!cols"]=[]);_<n.length&&w<h;++_){var A=n[_];if($k(A)){if(a.display)continue;b[w]={hidden:!0}}var j=A.cells;for(S=T=0;S<j.length;++S){var P=j[S];if(!(a.display&&$k(P))){var D=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):lee(P.innerHTML),L=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<x.length;++g){var I=x[g];I.s.c==T+l&&I.s.r<w+s&&w+s<=I.e.r&&(T=I.e.c+1-l,g=-1)}k=+P.getAttribute("colspan")||1,((E=+P.getAttribute("rowspan")||1)>1||k>1)&&x.push({s:{r:w+s,c:T+l},e:{r:w+s+(E||1)-1,c:T+l+(k||1)-1}});var O={t:"s",v:D},M=P.getAttribute("data-t")||P.getAttribute("t")||"";D!=null&&(D.length==0?O.t=M||"z":a.raw||D.trim().length==0||M=="s"||(M=="e"&&Hn[+D]?O={t:"e",v:+D,w:Hn[+D]}:D==="TRUE"?O={t:"b",v:!0}:D==="FALSE"?O={t:"b",v:!1}:isNaN(ns(D))?isNaN(Eh(D).getDate())?D.charCodeAt(0)==35&&Ei[D]!=null&&(O={t:"e",v:Ei[D],w:D}):(O={t:"d",v:ca(D)},a.UTC&&(O.v=Op(O.v)),a.cellDates||(O={t:"n",v:pn(O.v)}),O.z=a.dateNF||ar[14]):O={t:"n",v:ns(D)})),O.z===void 0&&L!=null&&(O.z=L);var re="",oe=P.getElementsByTagName("A");if(oe&&oe.length)for(var ee=0;ee<oe.length&&!(oe[ee].hasAttribute("href")&&(re=oe[ee].getAttribute("href"),re.charAt(0)!="#"));++ee);re&&re.charAt(0)!="#"&&re.slice(0,11).toLowerCase()!="javascript:"&&(O.l={Target:re}),i?(e["!data"][w+s]||(e["!data"][w+s]=[]),e["!data"][w+s][T+l]=O):e[vr({c:T+l,r:w+s})]=O,f.e.c<T+l&&(f.e.c=T+l),T+=k}}++w}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),f.e.r=Math.max(f.e.r,w-1+s),e["!ref"]=Mr(f),w>=h&&(e["!fullref"]=Mr((f.e.r=n.length-_+w-1+s,f))),e}function U5(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),$5(n,e,t)}function Vse(e,t){var r=Pc(U5(e,t),t);return r}function $k(e){var t="",r=Gse(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Gse(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Yse=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+nd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Br+t}})();function Xse(e,t){var r="number",n="",a={"style:name":t},i="",s=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Nt(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Nt(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var l=e.match(/# (\?+)\/(\?+)/);if(l){n+=Xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=e.match(/# (\?+)\/(\d+)/)){n+=Xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=e.match(/\b(\d+)(|\.\d+)%/)){r="percentage",n+=Xe("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var d=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"s":d=!0,--s;break t;case"m":r:for(var h=s+1;h<e.length;++h)switch(e[h]){case"y":case"d":break r;case"h":case"s":d=!0,--s;break t}case"y":case"d":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(i.length%2?"short":"long")+'" number:textual="'+(i.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(i.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(i.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Nt(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":i=e[++s],n+="<number:text>"+Nt(i)+"</number:text>";break;case"/":case":":n+="<number:text>"+Nt(i)+"</number:text>";break;default:console.error("unrecognized character "+i+" in ODF format "+e)}if(!d)break e;e=e.slice(s+1),s=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),a["number:truncate-on-overflow"]="false");s<e.length;++s)switch(i=e[s].toLowerCase()){case"h":case"m":case"s":for(;(e[++s]||"").toLowerCase()==i[0];)i+=i[0];switch(--s,i){case"h":case"hh":n+='<number:hours number:style="'+(i.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(i.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[s+1]==".")do i+=e[s+1],++s;while(e[s+1]=="0");n+='<number:seconds number:style="'+(i.match("ss")?"long":"short")+'"'+(i.match(/\./)?' number:decimal-places="'+(i.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Nt(i.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Nt(i)+"</number:text>";break;case"a":if(e.slice(s,s+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",s+=2;break}if(e.slice(s,s+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",s+=4;break}default:console.error("unrecognized character "+i+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),s=0),s=0,e[s]=='"'){for(;e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,e[s+1]=="*"?(s++,n+="<number:fill-character>"+Nt(i.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Nt(i.replace(/""/g,'"'))+"</number:text>",e=e.slice(s+1),s=0}var f=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!f||!f[0])console.error("Could not find numeric part of "+e);else{var p=f[1].replace(/,/g,"");n+="<number:"+(f[3]?"scientific-":"")+'number number:min-integer-digits="'+(p.indexOf("0")==-1?"0":p.length-p.indexOf("0"))+'"'+(f[0].indexOf(",")>-1?' number:grouping="true"':"")+(f[2]&&' number:decimal-places="'+(f[2].length-1)+'"'||' number:decimal-places="0"')+(f[3]&&f[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(f[3]?' number:min-exponent-digits="'+f[3].match(/0+/)[0].length+'"':"")+"></number:"+(f[3]?"scientific-":"")+"number>",s=f.index+f[0].length}if(e[s]=='"'){for(i="";e[++s]!='"'||e[++s]=='"';)i+=e[s];--s,n+="<number:text>"+Nt(i.replace(/""/g,'"'))+"</number:text>"}}return n?Xe("number:"+r+"-style",n,a):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function Uk(e,t,r){for(var n=[],a=0;a<e.length;++a){var i=e[a];i&&i.Sheet==(r==-1?null:r)&&n.push(i)}return n.length?`      <table:named-expressions>
`+n.map(function(s){var l=(r==-1?"$":"")+O5(s.Ref);return"        "+Xe("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var zk=(function(){var e=function(a,i){return Nt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=function(a,i,s,l,d,h){var f=[];f.push('      <table:table table:name="'+Nt(i.SheetNames[s])+`" table:style-name="ta1">
`);var p=0,x=0,g=fn(a["!ref"]||"A1"),b=a["!merges"]||[],_=0,w=a["!data"]!=null;if(a["!cols"])for(x=0;x<=g.e.c;++x)f.push("        <table:table-column"+(a["!cols"][x]?' table:style-name="co'+a["!cols"][x].ods+'"':"")+`></table:table-column>
`);var S="",T=a["!rows"]||[];for(p=0;p<g.s.r;++p)S=T[p]?' table:style-name="ro'+T[p].ods+'"':"",f.push("        <table:table-row"+S+`></table:table-row>
`);for(;p<=g.e.r;++p){for(S=T[p]?' table:style-name="ro'+T[p].ods+'"':"",f.push("        <table:table-row"+S+`>
`),x=0;x<g.s.c;++x)f.push(t);for(;x<=g.e.c;++x){var E=!1,k={},A="";for(_=0;_!=b.length;++_)if(!(b[_].s.c>x)&&!(b[_].s.r>p)&&!(b[_].e.c<x)&&!(b[_].e.r<p)){(b[_].s.c!=x||b[_].s.r!=p)&&(E=!0),k["table:number-columns-spanned"]=b[_].e.c-b[_].s.c+1,k["table:number-rows-spanned"]=b[_].e.r-b[_].s.r+1;break}if(E){f.push(`          <table:covered-table-cell/>
`);continue}var j=vr({r:p,c:x}),P=w?(a["!data"][p]||[])[x]:a[j];if(P&&P.f&&(k["table:formula"]=Nt(xae(P.f)),P.F&&P.F.slice(0,j.length)==j)){var D=fn(P.F);k["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,k["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!P){f.push(t);continue}switch(P.t){case"b":A=P.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=P.v?"true":"false";break;case"n":isFinite(P.v)?(A=P.w||String(P.v||0),k["office:value-type"]="float",k["office:value"]=P.v||0):(isNaN(P.v)?(A="#NUM!",k["table:formula"]="of:=#NUM!"):(A="#DIV/0!",k["table:formula"]="of:="+(P.v<0?"-":"")+"1/0"),k["office:string-value"]="",k["office:value-type"]="string",k["calcext:value-type"]="error");break;case"s":case"str":A=P.v==null?"":P.v,k["office:value-type"]="string";break;case"d":A=P.w||ca(P.v,h).toISOString(),k["office:value-type"]="date",k["office:date-value"]=ca(P.v,h).toISOString(),k["table:style-name"]="ce1";break;default:f.push(t);continue}var L=e(A);if(P.l&&P.l.Target){var I=P.l.Target;I=I.charAt(0)=="#"?"#"+O5(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),L=Xe("text:a",L,{"xlink:href":I.replace(/&/g,"&amp;")})}d[P.z]&&(k["table:style-name"]="ce"+d[P.z].slice(1));var O=Xe("text:p",L,{});if(P.c){for(var M="",re="",oe={},ee=0;ee<P.c.length;++ee)!M&&P.c[ee].a&&(M=P.c[ee].a),re+="<text:p>"+e(P.c[ee].t)+"</text:p>";P.c.hidden||(oe["office:display"]=!0),O=Xe("office:annotation",re,oe)+O}f.push("          "+Xe("table:table-cell",O,k)+`
`)}f.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&f.push(Uk(i.Workbook.Names,i.SheetNames,s)),f.push(`      </table:table>
`),f.join("")},n=function(a,i){a.push(` <office:automatic-styles>
`);var s=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var x=f["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Eb(x),x.ods=s;var g=f["!cols"][p].wpx+"px";a.push('  <style:style style:name="co'+s+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++s}}});var l=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=l;var x=f["!rows"][p].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var d={},h=69;return i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f){var p=f["!data"]!=null;if(f["!ref"])for(var x=fn(f["!ref"]),g=0;g<=x.e.r;++g)for(var b=0;b<=x.e.c;++b){var _=p?(f["!data"][g]||[])[b]:f[vr({r:g,c:b})];if(!(!_||!_.z||_.z.toLowerCase()=="general")&&!d[_.z]){var w=Xse(_.z,"N"+h);w&&(d[_.z]="N"+h,++h,a.push(w+`
`))}}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Fr(d).forEach(function(f){a.push('<style:style style:name="ce'+d[f].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+d[f]+`"/>
`)}),a.push(` </office:automatic-styles>
`),d};return function(i,s){var l=[Br],d=nd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=nd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});s.bookType=="fods"?(l.push("<office:document"+d+h+`>
`),l.push(i5().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+d+`>
`);var f=n(l,i);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var p=0;p!=i.SheetNames.length;++p)l.push(r(i.Sheets[i.SheetNames[p]],i,p,s,f,((i.Workbook||{}).WBProps||{}).date1904));return(i.Workbook||{}).Names&&l.push(Uk(i.Workbook.Names,i.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),s.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function z5(e,t){if(t.bookType=="fods")return zk(e,t);var r=pb(),n="",a=[],i=[];return n="mimetype",St(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",St(r,n,zk(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",St(r,n,Yse(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",St(r,n,Br+i5()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",St(r,n,Gee(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",St(r,n,Kee(a)),r}var Wn=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function Oh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function od(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Zl(tl(e))}function Mn(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):wa(rd(e))}function ao(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0;r<e.length;++r){var i=e[r],s=i.length;if(s<250)for(var l=0;l<s;++l)n[a++]=i[l];else n.set(i,a),a+=s}return n}function qse(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function ld(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function ut(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[Wn](0,r)}function W5(e){for(var t={l:0},r=[];t.l<e.length;)r.push(ld(e,t));return r}function H5(e){return ao(e.map(function(t){return ut(t)}))}function Na(e){var t=0,r=e[t]&127;return e[t++]<128||(r|=(e[t]&127)<<7,e[t++]<128)||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r|=(e[t]&15)<<28),r}function mt(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,a=ld(e,r),i=a&7;a=a/8|0;var s,l=r.l;switch(i){case 0:{for(;e[l++]>=128;);s=e[Wn](r.l,l),r.l=l}break;case 1:s=e[Wn](l,l+8),r.l=l+8;break;case 2:{var d=ld(e,r);s=e[Wn](r.l,r.l+d),r.l+=d}break;case 5:s=e[Wn](l,l+4),r.l=l+4;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var h={data:s,type:i};t[a]==null&&(t[a]=[]),t[a].push(h)}return t}function ht(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(a){a.data&&(t.push(ut(n*8+a.type)),a.type==2&&t.push(ut(a.data.length)),t.push(a.data))})}),ao(t)}function Dh(e,t){return e?.map(function(r){return t(r.data)})||[]}function Rh(e){for(var t,r=[],n={l:0};n.l<e.length;){var a=ld(e,n),i=mt(e[Wn](n.l,n.l+a));n.l+=a;var s={id:Na(i[1][0].data),messages:[]};i[2].forEach(function(l){var d=mt(l.data),h=Na(d[3][0].data);s.messages.push({meta:d,data:e[Wn](n.l,n.l+h)}),n.l+=h}),(t=i[3])!=null&&t[0]&&(s.merge=Na(i[3][0].data)>>>0>0),r.push(s)}return r}function tc(e){var t=[];return e.forEach(function(r){var n=[[],[{data:ut(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:ut(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ut(s.data.length)}],n[2].push({data:ht(s.meta),type:2})});var i=ht(n);t.push(ut(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ao(t)}function Qse(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=ld(t,r),a=[],i=r.l;i<t.length;){var s=t[i]&3;if(s==0){var l=t[i++]>>2;if(l<60)++l;else{var d=l-59;l=t[i],d>1&&(l|=t[i+1]<<8),d>2&&(l|=t[i+2]<<16),d>3&&(l|=t[i+3]<<24),l>>>=0,l++,i+=d}a.push(t[Wn](i,i+l)),i+=l;continue}else{var h=0,f=0;if(s==1?(f=(t[i]>>2&7)+4,h=(t[i++]&224)<<3,h|=t[i++]):(f=(t[i++]>>2)+1,s==2?(h=t[i]|t[i+1]<<8,i+=2):(h=(t[i]|t[i+1]<<8|t[i+2]<<16|t[i+3]<<24)>>>0,i+=4)),h==0)throw new Error("Invalid offset 0");for(var p=a.length-1,x=h;p>=0&&x>=a[p].length;)x-=a[p].length,--p;if(p<0)if(x==0)x=a[p=0].length;else throw new Error("Invalid offset beyond length");if(f<x)a.push(a[p][Wn](a[p].length-x,a[p].length-x+f));else{for(x>0&&(a.push(a[p][Wn](a[p].length-x)),f-=x),++p;f>=a[p].length;)a.push(a[p]),f-=a[p].length,++p;f&&a.push(a[p][Wn](0,f))}a.length>25&&(a=[ao(a)])}}for(var g=0,b=0;b<a.length;++b)g+=a[b].length;if(g!=n)throw new Error("Unexpected length: ".concat(g," != ").concat(n));return a}function Ih(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,Qse(n,e[Wn](r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:ao(t)}function rc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ut(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[Wn](r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ao(t)}function Dv(e,t){var r=new Uint8Array(32),n=Oh(r),a=12,i=0;switch(r[0]=5,e.t){case"n":if(e.z&&rl(e.z)){r[1]=5,n.setFloat64(a,(Ql(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break}else r[1]=2,qse(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":{var s=e.v==null?"":String(e.v);if(e.l){var l=t.rsst.findIndex(function(h){var f;return h.v==s&&h.l==((f=e.l)==null?void 0:f.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=16,a+=4}else{var d=t.sst.indexOf(s);d==-1&&(t.sst[d=t.sst.length]=s),r[1]=3,n.setUint32(a,d,!0),i|=8,a+=4}}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=4,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(t.cmnt.push(Zse(e.c)),n.setUint32(a,t.cmnt.length-1,!0),i|=524288,a+=4),n.setUint32(8,i,!0),r[Wn](0,a)}function Rv(e,t){var r=new Uint8Array(32),n=Oh(r),a=12,i=0,s="";switch(r[0]=4,e.t){case"n":break;case"b":break;case"s":if(s=e.v==null?"":String(e.v),e.l){var l=t.rsst.findIndex(function(h){var f;return h.v==s&&h.l==((f=e.l)==null?void 0:f.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:s,l:e.l.Target}),r[1]=9,n.setUint32(a,l,!0),i|=512,a+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(a,t.cmnt.length-1,!0),i|=4096,a+=4),e.t){case"n":r[1]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(s=e.v==null?"":String(e.v),!e.l){var d=t.sst.indexOf(s);d==-1&&(t.sst[d=t.sst.length]=s),r[1]=3,n.setUint32(a,d,!0),i|=16,a+=4}break;case"d":r[1]=5,n.setFloat64(a,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),i|=64,a+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r[Wn](0,a)}function Or(e){var t=mt(e);return Na(t[1][0].data)}function Nn(e){return ht([[],[{type:0,data:ut(e)}]])}function Sn(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?W5(e.messages[0].meta[5][0].data):[],a=n.indexOf(t);a==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:H5(n)}])}function Ki(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?W5(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:H5(n.filter(function(a){return a!=t}))}]}function Zse(e){for(var t={a:"",t:"",replies:[]},r=0;r<e.length;++r)r==0?(t.a=e[r].a,t.t=e[r].t):t.replies.push({a:e[r].a,t:e[r].t});return t}function Jse(e,t,r){var n,a,i,s=[[],[{type:0,data:ut(0)}],[{type:0,data:ut(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ut(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ut(1)}]];if(!((n=s[6])!=null&&n[0])||!((a=s[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(s[7][0].data.length<2*e.length){var d=new Uint8Array(2*e.length);d.set(s[7][0].data),s[7][0].data=d}if(s[4][0].data.length<2*e.length){var h=new Uint8Array(2*e.length);h.set(s[4][0].data),s[4][0].data=h}for(var f=Oh(s[7][0].data),p=0,x=[],g=Oh(s[4][0].data),b=0,_=[],w=4,S=0;S<e.length;++S){if(e[S]==null||e[S].t=="z"&&!((i=e[S].c)!=null&&i.length)||e[S].t=="e"){f.setUint16(S*2,65535,!0),g.setUint16(S*2,65535);continue}f.setUint16(S*2,p/w,!0),g.setUint16(S*2,b/w,!0);var T,E;switch(e[S].t){case"d":if(e[S].v instanceof Date){T=Dv(e[S],t),E=Rv(e[S],t);break}T=Dv(e[S],t),E=Rv(e[S],t);break;case"s":case"n":case"b":case"z":T=Dv(e[S],t),E=Rv(e[S],t);break;default:throw new Error("Unsupported value "+e[S])}x.push(T),p+=T.length,_.push(E),b+=E.length,++l}for(s[2][0].data=ut(l),s[5][0].data=ut(5);S<s[7][0].data.length/2;++S)f.setUint16(S*2,65535,!0),g.setUint16(S*2,65535,!0);return s[6][0].data=ao(x),s[3][0].data=ao(_),s[8]=[{type:0,data:ut(1)}],s}function X1(e,t){return{meta:[[],[{type:0,data:ut(e)}]],data:t}}function bi(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function eoe(e){var t={},r=[];return e.FileIndex.map(function(n,a){return[n,e.FullPaths[a]]}).forEach(function(n){var a=n[0],i=n[1];a.type==2&&a.name.match(/\.iwa/)&&a.content[0]==0&&Rh(Ih(a.content)).forEach(function(s){r.push(s.id),t[s.id]={deps:[],location:i,type:Na(s.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&Rh(Ih(n.content)).forEach(function(a){a.messages.forEach(function(i){[5,6].forEach(function(s){i.meta[s]&&i.meta[s].forEach(function(l){t[a.id].deps.push(Na(l.data))})})})})}),t}function x0(e,t,r){return ht([[],[{type:0,data:ut(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ut(1)}]])}function Wk(e){switch(e){case 0:return x0(99,222,171);case 1:return x0(162,197,240);case 2:return x0(255,189,189)}return x0(Math.random()*255,Math.random()*255,Math.random()*255)}function toe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=Xt.read(t.numbers,{type:"base64"}),n=eoe(r),a=_i(r,n,1);if(a==null)throw"Could not find message ".concat(1," in Numbers template");var i=Dh(mt(a.messages[0].data)[1],Or);if(i.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(s,l){l>=1&&(noe(r,n,l+1),a=_i(r,n,1),i=Dh(mt(a.messages[0].data)[1],Or)),aoe(r,n,e.Sheets[s],s,l,i[l])}),r}function zt(e,t,r,n){var a=Xt.find(e,t[r].location);if(!a)throw"Could not find ".concat(t[r].location," in Numbers template");var i=Rh(Ih(a.content)),s=i.find(function(l){return l.id==r});n(s,i),a.content=rc(tc(i)),a.size=a.content.length}function _i(e,t,r){var n=Xt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var a=Rh(Ih(n.content)),i=a.find(function(s){return s.id==r});return i}function q1(e,t,r){e[3].push({type:2,data:ht([[],[{type:0,data:ut(t)}],[{type:2,data:Mn(r.replace(/-[\s\S]*$/,""))}],[{type:2,data:Mn(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ut(0)}],[],[{type:0,data:ut(0)}]])}),e[1]=[{type:0,data:ut(Math.max(t+1,Na(e[1][0].data)))}]}function ko(e,t,r,n,a,i){i||(i=bi({deps:[],location:"",type:t},a));var s="".concat(n,"-").concat(i,".iwa");a[i].location="Root Entry"+s,Xt.utils.cfb_add(e,s,rc(tc([{id:i,messages:[X1(t,ht(r))]}])));var l=s.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return zt(e,a,2,function(d){var h=mt(d.messages[0].data);q1(h,i||0,l),d.messages[0].data=ht(h)}),i}function ia(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var d,h,f=mt(l.data);return(d=f[3])!=null&&d[0]?od(f[3][0].data)==a:!!((h=f[2])!=null&&h[0]&&od(f[2][0].data)==a)}),s=mt(e[3][i].data);s[6]||(s[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){s[6].push({type:2,data:ht([[],[{type:0,data:ut(l)}]])})}),e[3][i].data=ht(s)}function roe(e,t,r,n){var a=t[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),i=e[3].findIndex(function(l){var d,h,f=mt(l.data);return(d=f[3])!=null&&d[0]?od(f[3][0].data)==a:!!((h=f[2])!=null&&h[0]&&od(f[2][0].data)==a)}),s=mt(e[3][i].data);s[6]||(s[6]=[]),s[6]=s[6].filter(function(l){return Na(mt(l.data)[1][0].data)!=n}),e[3][i].data=ht(s)}function noe(e,t,r){var n=-1,a=-1,i={};zt(e,t,1,function(d,h){var f=mt(d.messages[0].data);n=Or(mt(d.messages[0].data)[1][0].data),a=bi({deps:[1],location:t[n].location,type:2},t),i[n]=a,Sn(d,a),f[1].push({type:2,data:Nn(a)});var p=_i(e,t,n);p.id=a,t[1].location==t[a].location?h.push(p):zt(e,t,a,function(x,g){return g.push(p)}),d.messages[0].data=ht(f)});var s=-1;zt(e,t,a,function(d,h){for(var f=mt(d.messages[0].data),p=3;p<=69;++p)delete f[p];var x=Dh(f[2],Or);x.forEach(function(b){return Ki(d,b)}),s=bi({deps:[a],location:t[x[0]].location,type:t[x[0]].type},t),Sn(d,s),i[x[0]]=s,f[2]=[{type:2,data:Nn(s)}];var g=_i(e,t,x[0]);g.id=s,t[x[0]].location==t[a].location?h.push(g):(zt(e,t,2,function(b){var _=mt(b.messages[0].data);ia(_,t,a,s),b.messages[0].data=ht(_)}),zt(e,t,s,function(b,_){return _.push(g)})),d.messages[0].data=ht(f)});var l=-1;zt(e,t,s,function(d,h){for(var f=mt(d.messages[0].data),p=mt(f[1][0].data),x=3;x<=69;++x)delete p[x];var g=Or(p[2][0].data);p[2][0].data=Nn(i[g]),f[1][0].data=ht(p);var b=Or(f[2][0].data);Ki(d,b),l=bi({deps:[s],location:t[b].location,type:t[b].type},t),Sn(d,l),i[b]=l,f[2][0].data=Nn(l);var _=_i(e,t,b);_.id=l,t[s].location==t[l].location?h.push(_):zt(e,t,l,function(w,S){return S.push(_)}),d.messages[0].data=ht(f)}),zt(e,t,l,function(d,h){var f,p,x=mt(d.messages[0].data),g=od(x[1][0].data),b=g.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(x[1][0].data=Mn(b),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(A){return delete x[A]}),x[45]){var _=mt(x[45][0].data),w=Or(_[1][0].data);Ki(d,w),delete x[45]}if(x[70]){var S=mt(x[70][0].data);(f=S[2])==null||f.forEach(function(A){var j=mt(A.data);[2,3].map(function(P){return j[P][0]}).forEach(function(P){var D=mt(P.data);if(D[8]){var L=Or(D[8][0].data);Ki(d,L)}})}),delete x[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(A){if(x[A]){var j=Or(x[A][0].data);delete x[A],Ki(d,j)}});var T=mt(x[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(A){var j;if((j=T[A])!=null&&j[0]){var P=Or(T[A][0].data),D=bi({deps:[l],location:t[P].location,type:t[P].type},t);Ki(d,P),Sn(d,D),i[P]=D;var L=_i(e,t,P);if(L.id=D,t[P].location==t[l].location)h.push(L);else{t[D].location=t[P].location.replace(P.toString(),D.toString()),t[D].location==t[P].location&&(t[D].location=t[D].location.replace(/\.iwa/,"-".concat(D,".iwa"))),Xt.utils.cfb_add(e,t[D].location,rc(tc([L])));var I=t[D].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");zt(e,t,2,function(O){var M=mt(O.messages[0].data);q1(M,D,I),ia(M,t,l,D),O.messages[0].data=ht(M)})}T[A][0].data=Nn(D)}});var E=mt(T[1][0].data);(p=E[2])==null||p.forEach(function(A){var j=Or(A.data),P=bi({deps:[l],location:t[j].location,type:t[j].type},t);Ki(d,j),Sn(d,P),i[j]=P;var D=_i(e,t,j);if(D.id=P,t[j].location==t[l].location)h.push(D);else{t[P].location=t[j].location.replace(j.toString(),P.toString()),t[P].location==t[j].location&&(t[P].location=t[P].location.replace(/\.iwa/,"-".concat(P,".iwa"))),Xt.utils.cfb_add(e,t[P].location,rc(tc([D])));var L=t[P].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");zt(e,t,2,function(I){var O=mt(I.messages[0].data);q1(O,P,L),ia(O,t,l,P),I.messages[0].data=ht(O)})}A.data=Nn(P)}),T[1][0].data=ht(E);var k=mt(T[3][0].data);k[1].forEach(function(A){var j=mt(A.data),P=Or(j[2][0].data),D=i[P];if(!i[P]){D=bi({deps:[l],location:"",type:t[P].type},t),t[D].location="Root Entry/Index/Tables/Tile-".concat(D,".iwa"),i[P]=D;var L=_i(e,t,P);L.id=D,Ki(d,P),Sn(d,D),Xt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(D,".iwa"),rc(tc([L]))),zt(e,t,2,function(I){var O=mt(I.messages[0].data);O[3].push({type:2,data:ht([[],[{type:0,data:ut(D)}],[{type:2,data:Mn("Tables/Tile")}],[{type:2,data:Mn("Tables/Tile-".concat(D))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ut(0)}],[],[{type:0,data:ut(0)}]])}),O[1]=[{type:0,data:ut(Math.max(D+1,Na(O[1][0].data)))}],ia(O,t,l,D),I.messages[0].data=ht(O)})}j[2][0].data=Nn(D),A.data=ht(j)}),T[3][0].data=ht(k)}x[4][0].data=ht(T),d.messages[0].data=ht(x)})}function aoe(e,t,r,n,a,i){var s=[];zt(e,t,i,function(h){var f=mt(h.messages[0].data);f[1]=[{type:2,data:Mn(n)}],s=Dh(f[2],Or),h.messages[0].data=ht(f)});var l=_i(e,t,s[0]),d=Or(mt(l.messages[0].data)[2][0].data);zt(e,t,d,function(h,f){return ioe(e,t,r,h,f,d)})}function ioe(e,t,r,n,a,i){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var s=fn(r["!ref"]);s.s.r=s.s.c=0;var l=!1;s.e.c>999&&(l=!0,s.e.c=999),s.e.r>999999&&(l=!0,s.e.r=999999),l&&console.error("Truncating to ".concat(Mr(s)));var d=[];if(r["!data"])d=r["!data"];else{for(var h=[],f=0;f<=s.e.c;++f)h[f]=Ht(f);for(var p=0;p<=s.e.r;++p){d[p]=[];var x=""+(p+1);for(f=0;f<=s.e.c;++f){var g=r[h[f]+x];g&&(d[p][f]=g)}}}var b={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=mt(n.messages[0].data);{_[6][0].data=ut(s.e.r+1),_[7][0].data=ut(s.e.c+1),delete _[46];var w=mt(_[4][0].data);{var S=Or(mt(w[1][0].data)[2][0].data);zt(e,t,S,function(se,Y){var ce,ue=mt(se.messages[0].data);if((ce=ue?.[2])!=null&&ce[0])for(var me=0;me<d.length;++me){var Re=mt(ue[2][0].data);Re[1][0].data=ut(me),Re[4][0].data=ut(d[me].length),ue[2][me]={type:ue[2][0].type,data:ht(Re)}}se.messages[0].data=ht(ue)});var T=Or(w[2][0].data);zt(e,t,T,function(se,Y){for(var ce=mt(se.messages[0].data),ue=0;ue<=s.e.c;++ue){var me=mt(ce[2][0].data);me[1][0].data=ut(ue),me[4][0].data=ut(s.e.r+1),ce[2][ue]={type:ce[2][0].type,data:ht(me)}}se.messages[0].data=ht(ce)});var E=mt(w[9][0].data);E[1]=[];var k=mt(w[3][0].data);{var A=256;k[2]=[{type:0,data:ut(A)}];var j=Or(mt(k[1][0].data)[2][0].data),P=(function(){var se=_i(e,t,2),Y=mt(se.messages[0].data),ce=Y[3].filter(function(ue){return Na(mt(ue.data)[1][0].data)==j});return ce?.length?Na(mt(ce[0].data)[12][0].data):0})();Xt.utils.cfb_del(e,t[j].location),zt(e,t,2,function(se){var Y=mt(se.messages[0].data);Y[3]=Y[3].filter(function(ce){return Na(mt(ce.data)[1][0].data)!=j}),roe(Y,t,i,j),se.messages[0].data=ht(Y)}),Ki(n,j),k[1]=[];for(var D=Math.ceil((s.e.r+1)/A),L=0;L<D;++L){var I=bi({deps:[],location:"",type:6002},t);t[I].location="Root Entry/Index/Tables/Tile-".concat(I,".iwa");for(var O=[[],[{type:0,data:ut(0)}],[{type:0,data:ut(Math.min(s.e.r+1,(L+1)*A))}],[{type:0,data:ut(0)}],[{type:0,data:ut(Math.min((L+1)*A,s.e.r+1)-L*A)}],[],[{type:0,data:ut(5)}],[{type:0,data:ut(1)}],[{type:0,data:ut(1)}]],M=L*A;M<=Math.min(s.e.r,(L+1)*A-1);++M){var re=Jse(d[M],b);re[1][0].data=ut(M-L*A),O[5].push({data:ht(re),type:2})}k[1].push({type:2,data:ht([[],[{type:0,data:ut(L)}],[{type:2,data:Nn(I)}]])});var oe={id:I,messages:[X1(6002,ht(O))]},ee=rc(tc([oe]));Xt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(I,".iwa"),ee),zt(e,t,2,function(se){var Y=mt(se.messages[0].data);Y[3].push({type:2,data:ht([[],[{type:0,data:ut(I)}],[{type:2,data:Mn("Tables/Tile")}],[{type:2,data:Mn("Tables/Tile-".concat(I))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ut(0)}],[],[{type:0,data:ut(P)}]])}),Y[1]=[{type:0,data:ut(Math.max(I+1,Na(Y[1][0].data)))}],ia(Y,t,i,I),se.messages[0].data=ht(Y)}),Sn(n,I),E[1].push({type:2,data:ht([[],[{type:0,data:ut(L*A)}],[{type:0,data:ut(L)}]])})}}if(w[3][0].data=ht(k),w[9][0].data=ht(E),w[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var fe=bi({type:6144,deps:[i],location:t[i].location},t);a.push({id:fe,messages:[X1(6144,ht([[],r["!merges"].map(function(se){return{type:2,data:ht([[],[{type:2,data:ht([[],[{type:5,data:new Uint8Array(new Uint16Array([se.s.r,se.s.c]).buffer)}]])}],[{type:2,data:ht([[],[{type:5,data:new Uint8Array(new Uint16Array([se.e.r-se.s.r+1,se.e.c-se.s.c+1]).buffer)}]])}]])}})]))]}),w[13]=[{type:2,data:Nn(fe)}],zt(e,t,2,function(se){var Y=mt(se.messages[0].data);ia(Y,t,i,fe),se.messages[0].data=ht(Y)}),Sn(n,fe)}else delete w[13];var J=Or(w[4][0].data);zt(e,t,J,function(se){var Y=mt(se.messages[0].data);Y[3]=[],b.sst.forEach(function(ce,ue){ue!=0&&Y[3].push({type:2,data:ht([[],[{type:0,data:ut(ue)}],[{type:0,data:ut(1)}],[{type:2,data:Mn(ce)}]])})}),se.messages[0].data=ht(Y)});var ie=Or(w[17][0].data);if(zt(e,t,ie,function(se){var Y=mt(se.messages[0].data);Y[3]=[];var ce=[904980,903835,903815,903845];b.rsst.forEach(function(ue,me){if(me!=0){var Re=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Mn(ue.v)}]];Re[10]=[{type:0,data:new Uint8Array([1])}],Re[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Re[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Re[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Re[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Re[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Re[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Re[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Re[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var U=bi({deps:[],location:"",type:2001},t),B=[];if(ue.l){var K=ko(e,2032,[[],[],[{type:2,data:Mn(ue.l)}]],"/Index/Tables/DataList",t);Re[11]=[];var z=[[],[]];z[1]||(z[1]=[]),z[1].push({type:2,data:ht([[],[{type:0,data:ut(0)}],[{type:2,data:Nn(K)}]])}),Re[11][0]={type:2,data:ht(z)},B.push(K)}ko(e,2001,Re,"/Index/Tables/DataList",t,U),zt(e,t,U,function(Oe){ce.forEach(function(Pe){return Sn(Oe,Pe)}),B.forEach(function(Pe){return Sn(Oe,Pe)})});var ne=ko(e,6218,[[],[{type:2,data:Nn(U)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);zt(e,t,ne,function(Oe){return Sn(Oe,U)}),Y[3].push({type:2,data:ht([[],[{type:0,data:ut(me)}],[{type:0,data:ut(1)}],[],[],[],[],[],[],[{type:2,data:Nn(ne)}]])}),Sn(se,ne),zt(e,t,2,function(Oe){var Pe=mt(Oe.messages[0].data);ia(Pe,t,ie,ne),ia(Pe,t,ne,U),ia(Pe,t,U,B),ia(Pe,t,U,ce),Oe.messages[0].data=ht(Pe)})}}),se.messages[0].data=ht(Y)}),b.cmnt.length>1){var Q=Or(w[19][0].data),te={},H=0;zt(e,t,Q,function(se){var Y=mt(se.messages[0].data);Y[3]=[],b.cmnt.forEach(function(ce,ue){if(ue!=0){var me=[];ce.replies&&ce.replies.forEach(function(B){te[B.a||""]||(te[B.a||""]=ko(e,212,[[],[{type:2,data:Mn(B.a||"")}],[{type:2,data:Wk(++H)}],[],[{type:0,data:ut(0)}]],"/Index/Tables/DataList",t));var K=te[B.a||""],z=ko(e,3056,[[],[{type:2,data:Mn(B.t||"")}],[{type:2,data:ht([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Nn(K)}]],"/Index/Tables/DataList",t);zt(e,t,z,function(ne){return Sn(ne,K)}),me.push(z),zt(e,t,2,function(ne){var Oe=mt(ne.messages[0].data);ia(Oe,t,z,K),ne.messages[0].data=ht(Oe)})}),te[ce.a||""]||(te[ce.a||""]=ko(e,212,[[],[{type:2,data:Mn(ce.a||"")}],[{type:2,data:Wk(++H)}],[],[{type:0,data:ut(0)}]],"/Index/Tables/DataList",t));var Re=te[ce.a||""],U=ko(e,3056,[[],[{type:2,data:Mn(ce.t||"")}],[{type:2,data:ht([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Nn(Re)}],me.map(function(B){return{type:2,data:Nn(B)}}),[{type:2,data:ht([[],[{type:0,data:ut(ue)}],[{type:0,data:ut(0)}]])}]],"/Index/Tables/DataList",t);zt(e,t,U,function(B){Sn(B,Re),me.forEach(function(K){return Sn(B,K)})}),Y[3].push({type:2,data:ht([[],[{type:0,data:ut(ue)}],[{type:0,data:ut(1)}],[],[],[],[],[],[],[],[{type:2,data:Nn(U)}]])}),Sn(se,U),zt(e,t,2,function(B){var K=mt(B.messages[0].data);ia(K,t,Q,U),ia(K,t,U,Re),me.length&&ia(K,t,U,me),B.messages[0].data=ht(K)})}}),Y[2][0].data=ut(b.cmnt.length+1),se.messages[0].data=ht(Y)})}}_[4][0].data=ht(w)}n.messages[0].data=ht(_)}function soe(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function kb(e){soe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ooe(e,t){e&&!e.SSF&&(e.SSF=On(ar)),e&&e.SSF&&(Pp(),Ap(e.SSF),t.revssf=jp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,a=r5();kb(t=t||{});var i=pb(),s="",l=0;if(t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",St(i,s,s5(e.Props,t)),a.coreprops.push(s),Lt(t.rels,2,s,Pt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,St(i,s,l5(e.Props)),a.extprops.push(s),Lt(t.rels,3,s,Pt.EXT_PROPS),e.Custprops!==e.Props&&Fr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",St(i,s,c5(e.Custprops)),a.custprops.push(s),Lt(t.rels,4,s,Pt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var p={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,St(i,s,zie(l-1,t,e,p)),a.sheets.push(s),Lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Pt.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(E){E[1].forEach(function(k){k.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+l+".xml",St(i,w,S5(b,f,t)),a.threadedcomments.push(w),Lt(p,-1,"../threadedComments/threadedComment"+l+".xml",Pt.TCMNT)),w="xl/comments"+l+"."+r,St(i,w,Ore(b)),a.comments.push(w),Lt(p,-1,"../comments"+l+"."+r,Pt.CMNT),_=!0}x["!legacy"]&&_&&St(i,"xl/drawings/vmlDrawing"+l+".vml",_5(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&St(i,a5(s),Jl(p))}t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,St(i,s,zte(t.Strings)),a.strs.push(s),Lt(t.wbrels,-1,"sharedStrings."+r,Pt.SST)),s="xl/workbook."+r,St(i,s,cse(e)),a.workbooks.push(s),Lt(t.rels,1,s,Pt.WB),s="xl/theme/theme1.xml";var T=b5(e.Themes,t);return St(i,s,T),a.themes.push(s),Lt(t.wbrels,-1,"theme/theme1.xml",Pt.THEME),s="xl/styles."+r,St(i,s,xre(e,t)),a.styles.push(s),Lt(t.wbrels,-1,"styles."+r,Pt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",St(i,s,e.vbaraw),a.vba.push(s),Lt(t.wbrels,-1,"vbaProject.bin",Pt.VBA)),s="xl/metadata."+r,St(i,s,Nre()),a.metadata.push(s),Lt(t.wbrels,-1,"metadata."+r,Pt.XLMETA),f.length>1&&(s="xl/persons/person.xml",St(i,s,N5(f)),a.people.push(s),Lt(t.wbrels,-1,"persons/person.xml",Pt.PEOPLE)),St(i,"[Content_Types].xml",n5(a,t)),St(i,"_rels/.rels",Jl(t.rels)),St(i,"xl/_rels/workbook."+r+".rels",Jl(t.wbrels)),delete t.revssf,delete t.ssf,i}function loe(e,t){e&&!e.SSF&&(e.SSF=On(ar)),e&&e.SSF&&(Pp(),Ap(e.SSF),t.revssf=jp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Rre.indexOf(t.bookType)>-1,a=r5();kb(t=t||{});var i=pb(),s="",l=0;if(t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",St(i,s,s5(e.Props,t)),a.coreprops.push(s),Lt(t.rels,2,s,Pt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,St(i,s,l5(e.Props)),a.extprops.push(s),Lt(t.rels,3,s,Pt.EXT_PROPS),e.Custprops!==e.Props&&Fr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",St(i,s,c5(e.Custprops)),a.custprops.push(s),Lt(t.rels,4,s,Pt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var p={"!id":{}},x=e.Sheets[e.SheetNames[l-1]],g=(x||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+l+"."+r,St(i,s,Aae(l-1,t,e,p)),a.sheets.push(s),Lt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Pt.WS[0])}if(x){var b=x["!comments"],_=!1,w="";if(b&&b.length>0){var S=!1;b.forEach(function(T){T[1].forEach(function(E){E.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+l+".xml",St(i,w,S5(b,f,t)),a.threadedcomments.push(w),Lt(p,-1,"../threadedComments/threadedComment"+l+".xml",Pt.TCMNT)),w="xl/comments"+l+"."+r,St(i,w,kre(b)),a.comments.push(w),Lt(p,-1,"../comments"+l+"."+r,Pt.CMNT),_=!0}x["!legacy"]&&_&&St(i,"xl/drawings/vmlDrawing"+l+".vml",_5(l,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&St(i,a5(s),Jl(p))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,St(i,s,Lte(t.Strings,t)),a.strs.push(s),Lt(t.wbrels,-1,"sharedStrings."+r,Pt.SST)),s="xl/workbook."+r,St(i,s,Xie(e)),a.workbooks.push(s),Lt(t.rels,1,s,Pt.WB),s="xl/theme/theme1.xml",St(i,s,b5(e.Themes,t)),a.themes.push(s),Lt(t.wbrels,-1,"theme/theme1.xml",Pt.THEME),s="xl/styles."+r,St(i,s,Xte(e,t)),a.styles.push(s),Lt(t.wbrels,-1,"styles."+r,Pt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",St(i,s,e.vbaraw),a.vba.push(s),Lt(t.wbrels,-1,"vbaProject.bin",Pt.VBA)),s="xl/metadata."+r,St(i,s,Ere()),a.metadata.push(s),Lt(t.wbrels,-1,"metadata."+r,Pt.XLMETA),f.length>1&&(s="xl/persons/person.xml",St(i,s,N5(f)),a.people.push(s),Lt(t.wbrels,-1,"persons/person.xml",Pt.PEOPLE)),St(i,"[Content_Types].xml",n5(a,t)),St(i,"_rels/.rels",Jl(t.rels)),St(i,"xl/_rels/workbook."+r+".rels",Jl(t.wbrels)),delete t.revssf,delete t.ssf,i}function coe(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ro(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function K5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Pd(t.file,Xt.write(e,{type:Bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Xt.write(e,t)}function uoe(e,t){switch(t.bookType){case"ods":return z5(e,t);case"numbers":return toe(e,t);case"xlsb":return ooe(e,t);default:return loe(e,t)}}function doe(e,t){var r=On(t||{}),n=uoe(e,r);return foe(n,r)}function foe(e,t){var r={},n=Bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Xt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(kp(a))}return t.password&&typeof encrypt_agile<"u"?K5(encrypt_agile(a,t.password),t):t.type==="file"?Pd(t.file,a):t.type=="string"?Zl(a):a}function hoe(e,t){var r=t||{},n=Sse(e,r);return K5(n,r)}function vi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return yh(rd(n));case"binary":return rd(n);case"string":return e;case"file":return Pd(t.file,n,"utf8");case"buffer":return Bt?Di(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):vi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function poe(e,t){switch(t.type){case"base64":return pJ(e);case"binary":return e;case"string":return e;case"file":return Pd(t.file,e,"binary");case"buffer":return Bt?Di(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function g0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?yh(r):t.type=="string"?Zl(r):r;case"file":return Pd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function V5(e,t){hJ(),Yie(e);var r=On(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=V5(e,r);return r.type="array",kp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return vi(bse(e,r),r);case"slk":case"sylk":return vi(Rte.from_sheet(e.Sheets[e.SheetNames[a]],r,e),r);case"htm":case"html":return vi(B5(e.Sheets[e.SheetNames[a]],r),r);case"txt":return poe(G5(e.Sheets[e.SheetNames[a]],r),r);case"csv":return vi(Ab(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return vi(Ite.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return g0(Dte.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return vi(Fte.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return vi(Hte(e.Sheets[e.SheetNames[a]]),r);case"eth":return vi(x5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return vi(z5(e,r),r);case"wk1":return g0(jk.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return g0(jk.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),g0(L5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),hoe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return doe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function moe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function xoe(e,t,r){var n=r||{};return n.type="file",n.file=t,moe(n),V5(e,n)}function goe(e,t,r,n,a,i,s){var l=Yt(r),d=s.defval,h=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),f=!0,p=e["!data"]!=null,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!p||e["!data"][r])for(var g=t.s.c;g<=t.e.c;++g){var b=p?(e["!data"][r]||[])[g]:e[n[g]+l];if(b==null||b.t===void 0){if(d===void 0)continue;i[g]!=null&&(x[i[g]]=d);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"b":case"n":if(!b.z||!rl(b.z)||(_=Ql(_),typeof _=="number"))break;case"d":s&&(s.UTC||s.raw===!1)||(_=hc(new Date(_)));break;default:throw new Error("unrecognized type "+b.t)}if(i[g]!=null){if(_==null)if(b.t=="e"&&_===null)x[i[g]]=null;else if(d!==void 0)x[i[g]]=d;else if(h&&_===null)x[i[g]]=null;else continue;else x[i[g]]=(b.t==="n"&&typeof s.rawNumbers=="boolean"?s.rawNumbers:h)?_:ds(b,_,s);_!=null&&(f=!1)}}return{row:x,isempty:f}}function Q1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},f=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof f){case"string":d=ir(f);break;case"number":d=ir(e["!ref"]),d.s.r=f;break;default:d=f}n>0&&(a=0);var p=Yt(d.s.r),x=[],g=[],b=0,_=0,w=e["!data"]!=null,S=d.s.r,T=0,E={};w&&!e["!data"][S]&&(e["!data"][S]=[]);var k=h.skipHidden&&e["!cols"]||[],A=h.skipHidden&&e["!rows"]||[];for(T=d.s.c;T<=d.e.c;++T)if(!(k[T]||{}).hidden)switch(x[T]=Ht(T),r=w?e["!data"][S][T]:e[x[T]+p],n){case 1:i[T]=T-d.s.c;break;case 2:i[T]=x[T];break;case 3:i[T]=h.header[T-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=s=ds(r,null,h),_=E[s]||0,!_)E[s]=1;else{do l=s+"_"+_++;while(E[l]);E[s]=_,E[l]=1}i[T]=l}for(S=d.s.r+a;S<=d.e.r;++S)if(!(A[S]||{}).hidden){var j=goe(e,d,S,x,n,i,h);(j.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(g[b++]=j.row)}return g.length=b,g}var Hk=/"/g;function voe(e,t,r,n,a,i,s,l,d){for(var h=!0,f=[],p="",x=Yt(r),g=e["!data"]!=null,b=g&&e["!data"][r]||[],_=t.s.c;_<=t.e.c;++_)if(n[_]){var w=g?b[_]:e[n[_]+x];if(w==null)p="";else if(w.v!=null){h=!1,p=""+(d.rawNumbers&&w.t=="n"?w.v:ds(w,null,d));for(var S=0,T=0;S!==p.length;++S)if((T=p.charCodeAt(S))===a||T===i||T===34||d.forceQuotes){p='"'+p.replace(Hk,'""')+'"';break}p=="ID"&&l==0&&f.length==0&&(p='"ID"')}else w.f!=null&&!w.F?(h=!1,p="="+w.f,p.indexOf(",")>=0&&(p='"'+p.replace(Hk,'""')+'"')):p="";f.push(p)}if(d.strip)for(;f[f.length-1]==="";)--f.length;return d.blankrows===!1&&h?null:f.join(s)}function Ab(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var a=ir(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,d=l.charCodeAt(0),h="",f=[],p=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(p[g]||{}).hidden||(f[g]=Ht(g));for(var b=0,_=a.s.r;_<=a.e.r;++_)(x[_]||{}).hidden||(h=voe(e,a,_,f,s,d,i,b,n),h!=null&&(h||n.blankrows!==!1)&&r.push((b++?l:"")+h));return r.join("")}function G5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ab(e,t);return r}function yoe(e,t){var r="",n,a="";if(e==null||e["!ref"]==null)return[];var i=ir(e["!ref"]),s="",l=[],d,h=[],f=e["!data"]!=null;for(d=i.s.c;d<=i.e.c;++d)l[d]=Ht(d);for(var p=i.s.r;p<=i.e.r;++p)for(s=Yt(p),d=i.s.c;d<=i.e.c;++d)if(r=l[d]+s,n=f?(e["!data"][p]||[])[d]:e[r],a="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;a=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)a=n.f;else{if(t&&t.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)a=""+n.v;else if(n.t=="b")a=n.v?"TRUE":"FALSE";else if(n.w!==void 0)a="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?a="'"+n.v:a=""+n.v}}h[h.length]=r+"="+a}return h}function Y5(e,t,r){var n=r||{},a=e?e["!data"]!=null:n.dense,i=+!n.skipHeader,s=e||{};!e&&a&&(s["!data"]=[]);var l=0,d=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?dr(n.origin):n.origin;l=h.r,d=h.c}var f={s:{c:0,r:0},e:{c:d,r:l+t.length-1+i}};if(s["!ref"]){var p=ir(s["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),l==-1&&(l=p.e.r+1,f.e.r=l+t.length-1+i)}else l==-1&&(l=0,f.e.r=t.length-1+i);var x=n.header||[],g=0,b=[];t.forEach(function(w,S){a&&!s["!data"][l+S+i]&&(s["!data"][l+S+i]=[]),a&&(b=s["!data"][l+S+i]),Fr(w).forEach(function(T){(g=x.indexOf(T))==-1&&(x[g=x.length]=T);var E=w[T],k="z",A="",j=a?"":Ht(d+g)+Yt(l+S+i),P=a?b[d+g]:s[j];E&&typeof E=="object"&&!(E instanceof Date)?a?b[d+g]=E:s[j]=E:(typeof E=="number"?k="n":typeof E=="boolean"?k="b":typeof E=="string"?k="s":E instanceof Date?(k="d",n.UTC||(E=Op(E)),n.cellDates||(k="n",E=pn(E)),A=P!=null&&P.z&&rl(P.z)?P.z:n.dateNF||ar[14]):E===null&&n.nullError&&(k="e",E=0),P?(P.t=k,P.v=E,delete P.w,delete P.R,A&&(P.z=A)):a?b[d+g]=P={t:k,v:E}:s[j]=P={t:k,v:E},A&&(P.z=A))})}),f.e.c=Math.max(f.e.c,d+x.length-1);var _=Yt(l);if(a&&!s["!data"][l]&&(s["!data"][l]=[]),i)for(g=0;g<x.length;++g)a?s["!data"][l][g+d]={t:"s",v:x[g]}:s[Ht(g+d)+_]={t:"s",v:x[g]};return s["!ref"]=Mr(f),s}function woe(e,t){return Y5(null,e,t)}function Fh(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=dr(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Fh(e,vr(t)):Fh(e,Ht(r||0)+Yt(t))}function boe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function _oe(e,t){var r={SheetNames:[],Sheets:{}};return e&&Pb(r,e,t||"Sheet1"),r}function Pb(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0&&r.length<32){var i=r.match(/\d+$/);a=i&&+i[0]||0;var s=i&&r.slice(0,i.index)||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(I5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Soe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=boe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Noe(e,t){return e.z=t,e}function X5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Eoe(e,t,r){return X5(e,"#"+t,r)}function Toe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Coe(e,t,r,n){for(var a=typeof t!="string"?t:ir(t),i=typeof t=="string"?t:Mr(t),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var d=Fh(e,s,l);d.t="n",d.F=i,delete d.v,s==a.s.r&&l==a.s.c&&(d.f=r,n&&(d.D=!0))}var h=fn(e["!ref"]);return h.s.r>a.s.r&&(h.s.r=a.s.r),h.s.c>a.s.c&&(h.s.c=a.s.c),h.e.r<a.e.r&&(h.e.r=a.e.r),h.e.c<a.e.c&&(h.e.c=a.e.c),e["!ref"]=Mr(h),e}var Z1={encode_col:Ht,encode_row:Yt,encode_cell:vr,encode_range:Mr,decode_col:wb,decode_row:yb,split_cell:_ee,decode_cell:dr,decode_range:fn,format_cell:ds,sheet_new:See,sheet_add_aoa:Q3,sheet_add_json:Y5,sheet_add_dom:$5,aoa_to_sheet:jc,json_to_sheet:woe,table_to_sheet:U5,table_to_book:Vse,sheet_to_csv:Ab,sheet_to_txt:G5,sheet_to_json:Q1,sheet_to_html:B5,sheet_to_formulae:yoe,sheet_to_row_object_array:Q1,sheet_get_cell:Fh,book_new:_oe,book_append_sheet:Pb,book_set_sheet_visibility:Soe,cell_set_number_format:Noe,cell_set_hyperlink:X5,cell_set_internal_link:Eoe,cell_add_comment:Toe,sheet_set_array_formula:Coe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Mh=e=>Number.isFinite(e)?`VND ${Math.round(e).toLocaleString("vi-VN")}`:"VND 0",koe=e=>Number.isFinite(e)?`${Math.round(e).toLocaleString("vi-VN")} VND`:"0 VND",Aoe=e=>{if(!e)return null;const t=e.match(/nhan tu\s+(.+?)\s+trace/i);return t&&t[1].trim()||null},cd=e=>Aoe(e.note)||e.sender||"",J1=e=>{const t=(e||"").toUpperCase().trim();return t&&t.startsWith("MAV")?"receipt":"refund"},Poe=[{value:"receipt",label:"Bin Nhn",description:"M n bt u bng MAV"},{value:"refund",label:"Hon tin",description:"Cc bin nhn khc"}],yi={bankName:"VP Bank",accountHolder:"NGO LE NGOC HUNG",accountNumber:"9183400998",bankBin:"970432"},Iv=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return null;const[,r,n,a]=t.map(Number);return new Date(a,n-1,r).getTime()},joe=e=>{const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!t)return e;const[,r,n,a]=t;return`${a}/${n}/${r}`},Ooe=e=>{const t=e.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!t)return"";const[,r,n,a]=t;return`${a}-${n}-${r}`},Doe=e=>{const t=r=>typeof r=="string"?r:"";return{id:Number(e?.id)||0,orderCode:t(e?.orderCode??e?.[Fl.orderCode]),paidAt:t(e?.paidAt??e?.[Fl.paidDate]),amount:Number(e?.amount??e?.[Fl.amount])||0,sender:t(e?.sender??e?.[Fl.sender]),receiver:t(e?.receiver??e?.[Fl.receiver]),note:t(e?.note??e?.[Fl.note])}},Roe=e=>{const t=["#","M n","Ngi gi","Ngi nhn","S tin gc","S tin nh dng","Ni dung chuyn khon","Ngy thanh ton","Nhm"],r=e.map((a,i)=>[i+1,a.orderCode||"",cd(a),a.receiver||"",a.amount,Mh(a.amount),a.note||"",a.paidAt?hr(a.paidAt):"",J1(a.orderCode)==="receipt"?"Bin nhn":"Hon tin"]),n=Z1.aoa_to_sheet([t,...r]);return n["!cols"]=[{wch:5},{wch:18},{wch:26},{wch:14},{wch:20},{wch:48},{wch:14},{wch:12}],n},Ioe=({stats:e})=>c.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-white/6 via-indigo-400/25 to-indigo-900/40 border border-white/10 p-5 shadow-[0_24px_65px_-28px_rgba(0,0,0,0.8),0_18px_42px_-26px_rgba(255,255,255,0.25)]",children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e.map(t=>c.jsx(Qi,{title:t.name,value:t.value,icon:t.icon,accent:t.accent},t.name))})}),Foe=({searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:n,dateRangeDisplay:a,rangePickerOpen:i,setRangePickerOpen:s,dateRangeRef:l,toDisplayDate:d,toISODate:h,onDateStartChange:f,onDateEndChange:p,onExport:x,exportDisabled:g})=>c.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 space-y-4 relative z-50",children:c.jsxs("div",{className:"flex flex-col lg:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(il,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Tm m n, ngi gi hoc ghi ch...",className:"w-full pl-12 pr-4 py-3 border border-gray-200 bg-gray-50/60 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:e,onChange:b=>t(b.target.value)})]}),c.jsxs("div",{className:"relative z-[120] flex items-stretch",ref:l,children:[c.jsxs("button",{type:"button",onClick:()=>s(!i),className:`flex items-center justify-between gap-3 px-4 py-3 rounded-2xl border transition w-full lg:w-64 ${i?"border-indigo-400/70 bg-indigo-900/60 shadow-[0_10px_30px_-18px_rgba(79,70,229,0.65)]":"border-white/15 bg-slate-900/70 text-white hover:bg-slate-800/70 shadow-[0_10px_26px_-18px_rgba(0,0,0,0.65)]"} text-white`,children:[c.jsx("div",{className:"flex flex-col text-left",children:c.jsx("span",{className:"text-sm font-medium",children:a})}),c.jsx(n4,{className:`w-5 h-5 ${i?"text-indigo-300":"text-slate-200"}`})]}),i&&c.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-80 bg-white border border-gray-200 rounded-2xl shadow-xl z-[150] p-4 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"T Ngy"}),c.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:h(r),onChange:b=>f(b.target.value?d(b.target.value):"")})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-semibold text-gray-500 mb-1 uppercase tracking-wide",children:"n Ngy"}),c.jsx("input",{type:"date",inputMode:"numeric",className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:h(n),onChange:b=>p(b.target.value?d(b.target.value):"")})]})]}),c.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[c.jsx("button",{className:"text-sm font-medium text-blue-600 hover:text-blue-800",onClick:()=>{f(""),p("")},children:"Xa Khong"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 border border-gray-200 rounded-lg hover:bg-indigo-500/10",onClick:()=>s(!1),children:"ng"}),c.jsx("button",{className:"px-3 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",onClick:()=>s(!1),children:"p Dng"})]})]})]})]}),c.jsx("button",{type:"button",onClick:x,disabled:g,className:`px-5 py-3 rounded-2xl bg-gray-900 text-white text-sm font-semibold transition-colors shadow-sm ${g?"opacity-60 cursor-not-allowed":"hover:bg-gray-700"}`,children:"Ti V"})]})}),Moe=({activeCategory:e,counts:t,onChange:r})=>c.jsx("div",{className:"rounded-[28px] bg-gradient-to-br from-slate-800/75 via-slate-800/60 to-slate-900/80 border border-white/12 p-4 shadow-[0_20px_55px_-32px_rgba(0,0,0,0.8),0_14px_36px_-28px_rgba(255,255,255,0.18)] backdrop-blur-sm flex flex-col sm:flex-row gap-3 text-slate-200",children:Poe.map(n=>{const a=e===n.value;return c.jsx("button",{type:"button",onClick:()=>r(n.value),className:`flex-1 min-w-[180px] text-left rounded-2xl border p-4 transition shadow-[0_12px_28px_-18px_rgba(0,0,0,0.65)] ${a?"bg-gradient-to-r from-indigo-500 to-violet-500 text-white border-white/50 shadow-[0_16px_45px_-22px_rgba(79,70,229,0.65)]":"bg-slate-800/70 text-slate-100 border-white/12 hover:bg-slate-700/70 hover:border-white/20"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-semibold drop-shadow-sm",children:n.label}),c.jsx("p",{className:"text-xs text-slate-300 mt-1",children:n.description})]}),c.jsx("span",{className:`text-lg font-semibold ${a?"text-white":"text-slate-100"}`,children:t[n.value]})]})},n.value)})}),Loe=({receipts:e,expandedReceiptId:t,onToggle:r,onSelectReceipt:n})=>c.jsx("div",{className:"rounded-[18px] bg-gradient-to-br from-indigo-900/70 via-slate-900/70 to-slate-950/70 border border-white/12 shadow-[0_20px_65px_-30px_rgba(0,0,0,0.85)] overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-white/10 text-white",children:[c.jsx("thead",{className:"bg-slate-900/90",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"M n"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Gi"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngi Nhn"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"S Tin"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ni Dung Chuyn Khon"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white/70 uppercase tracking-wider",children:"Ngy Thanh Ton"})]})}),c.jsx("tbody",{className:"divide-y divide-white/10",children:e.map((a,i)=>{const s=t===a.id;return c.jsxs(ki.Fragment,{children:[c.jsxs("tr",{className:`transition ${i%2===0?"bg-slate-900/55":"bg-indigo-950/40"} hover:bg-indigo-600/25 ${s?"ring-2 ring-indigo-400/60":""} cursor-pointer`,onClick:()=>r(a.id),onDoubleClick:()=>n?n(a):void 0,children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white font-semibold",children:a.orderCode||"--"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm font-medium text-white",children:cd(a)||"--"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("div",{className:"text-sm font-medium text-white",children:a.receiver||yi.accountNumber})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-white",children:Mh(a.amount)}),c.jsx("td",{className:"px-6 py-4 text-sm text-white/90 max-w-xs",children:c.jsx("span",{className:"block truncate text-white/90",children:a.note||"--"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white/80",children:a.paidAt?hr(a.paidAt):"--"})]}),s&&c.jsx("tr",{className:"bg-indigo-900/35",children:c.jsx("td",{colSpan:6,className:"px-6 pb-5 pt-2",children:c.jsxs("div",{className:"rounded-2xl border border-white/10 bg-slate-900/70 p-4 text-sm text-white/90 space-y-2",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"M n"}),c.jsx("p",{className:"font-semibold text-white",children:a.orderCode||"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"Ngi gi"}),c.jsx("p",{className:"font-semibold text-white",children:cd(a)||"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"Ngi nhn"}),c.jsx("p",{className:"font-semibold text-white",children:yi.accountNumber})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"S tin"}),c.jsx("p",{className:"font-semibold text-emerald-200",children:Mh(a.amount)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"Ngy thanh ton"}),c.jsx("p",{className:"font-semibold text-white",children:a.paidAt?hr(a.paidAt):"--"})]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-white/60",children:"Ni dung chuyn khon"}),c.jsx("p",{className:"mt-1 rounded-xl bg-white/5 px-3 py-2 text-white",children:a.note||"Khng c ghi ch"})]})]})})})]},a.id)})})]})})}),Boe=({open:e,amount:t,note:r,onClose:n,onAmountChange:a,onNoteChange:i})=>{const[s,l]=v.useState(t),[d,h]=v.useState(r);v.useEffect(()=>{e&&(l(t),h(r))},[e,t,r]);const f=v.useMemo(()=>{const w=s.replace(/[^\d]/g,"");if(!w)return 0;const S=Number(w);return Number.isFinite(S)?S:0},[s]),p=f>0?`${f.toLocaleString("vi-VN")} VND`:"Cha Cp Nht",x=v.useMemo(()=>lb({accountNumber:yi.accountNumber,bankCode:yi.bankBin,amount:f,description:d.trim()}),[f,d]),g=d.trim()||"Cha c ni dung",b=()=>{const w=s.replace(/[^\d]/g,"");l(w),a(w)},_=()=>{const w=d.trim();h(w),i(w)};return e?c.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto bg-slate-900/80 px-3 py-6",children:c.jsxs("div",{className:"w-full max-w-5xl rounded-3xl bg-slate-900 text-white shadow-2xl border border-slate-700 relative",children:[c.jsx("button",{className:"absolute right-6 top-6 text-slate-400 hover:text-indigo-100 transition",onClick:n,children:c.jsx(Hr,{className:"h-6 w-6"})}),c.jsxs("div",{className:"px-6 py-10 space-y-6",children:[c.jsxs("div",{className:"text-center space-y-2",children:[c.jsx("h2",{className:"text-2xl font-semibold",children:"To thng tin thanh ton qua QR Code"}),c.jsx("p",{className:"text-sm text-slate-300",children:"Qut m QR  chuyn khon nhanh. Nhp s tin v ni dung  cp nht chi tit."})]}),c.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[c.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 flex flex-col items-center text-center space-y-4",children:[c.jsx("p",{className:"text-lg font-semibold text-sky-200",children:"Qut m QR  thanh ton"}),c.jsx("div",{className:"rounded-2xl bg-white p-4",children:c.jsx("img",{src:x,alt:"QR thanh toan",className:"h-64 w-64 object-contain"})}),c.jsx("a",{href:x,download:!0,className:"inline-flex items-center justify-center rounded-full bg-sky-500 px-5 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400",children:"Ti nh QR"}),c.jsxs("div",{className:"w-full text-left space-y-1 text-sm text-slate-200",children:[c.jsxs("p",{children:["Ngn hng: ",c.jsx("span",{className:"font-semibold",children:yi.bankName})]}),c.jsxs("p",{children:["S ti khon:"," ",c.jsx("span",{className:"font-semibold",children:yi.accountNumber})]}),c.jsxs("p",{children:["Ch ti khon:"," ",c.jsx("span",{className:"font-semibold uppercase",children:yi.accountHolder})]}),c.jsxs("p",{children:["S tin:"," ",c.jsx("span",{className:"font-semibold text-rose-200",children:p})]}),c.jsxs("p",{children:["Ni dung:"," ",c.jsx("span",{className:"font-semibold text-violet-200",children:g})]})]})]}),c.jsxs("div",{className:"rounded-2xl border border-slate-700 bg-slate-800/60 p-6 space-y-5",children:[c.jsxs("div",{className:"flex items-center space-x-3 border-b border-slate-700 pb-4",children:[c.jsx("img",{src:"https://companieslogo.com/img/orig/VPB.VN-b0a9916f.png?t=1722928514",alt:"VPBank",className:"h-10 w-10 object-contain"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm uppercase tracking-wide text-slate-300",children:"Ngn hng"}),c.jsx("p",{className:"text-lg font-semibold text-white",children:yi.bankName})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between text-sm text-slate-300",children:[c.jsx("span",{children:"Th hng"}),c.jsx("span",{className:"font-semibold text-white",children:yi.accountHolder})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-sm text-slate-300",children:"S Ti Khon"}),c.jsx("div",{className:"rounded-xl border border-slate-600 bg-slate-900/50 px-3 py-2 text-white font-semibold",children:yi.accountNumber})]})]}),c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("button",{type:"button",className:"w-full rounded-xl border border-sky-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-sky-200 hover:border-sky-300 transition",onClick:b,children:"+ Thm s tin"}),c.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[c.jsx("input",{type:"text",placeholder:"V d: 65000",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-sky-400 focus:ring-2 focus:ring-sky-400/40",value:s,onChange:w=>l(w.target.value),onBlur:b}),c.jsx("button",{type:"button",className:"rounded-xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white",onClick:b,children:"OK"})]})]}),c.jsxs("div",{children:[c.jsx("button",{type:"button",className:"w-full rounded-xl border border-violet-400/50 bg-slate-900/40 px-4 py-2 text-sm font-semibold text-violet-200 hover:border-violet-300 transition",onClick:_,children:"+ Thm ni dung"}),c.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[c.jsx("input",{type:"text",placeholder:"Nhp ni dung",className:"flex-1 rounded-xl border border-slate-600 bg-slate-900/70 px-3 py-2 text-sm text-white focus:border-violet-400 focus:ring-2 focus:ring-violet-400/30",value:d,onChange:w=>h(w.target.value),onBlur:_}),c.jsx("button",{type:"button",className:"rounded-xl bg-violet-500 px-4 py-2 text-sm font-semibold text-white",onClick:_,children:"Lu"})]})]})]})]})]})]})]})}):null},$oe=({open:e,receipt:t,onClose:r})=>!e||!t?null:c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-xl",children:[c.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chi tiet bien nhan"}),c.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"ng",children:c.jsx(Hr,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"px-5 py-4 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1",children:"M n"}),c.jsx("p",{className:"font-semibold text-gray-900",children:t.orderCode||"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1",children:"Ngy Thanh Ton"}),c.jsx("p",{className:"font-semibold text-gray-900",children:t.paidAt?hr(t.paidAt):"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Gi"}),c.jsx("p",{className:"font-semibold text-gray-900",children:cd(t)||"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1",children:"Ngi Nhn"}),c.jsx("p",{className:"font-semibold text-gray-900",children:t.receiver||"--"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1",children:"S Tin"}),c.jsx("p",{className:"font-semibold text-gray-900",children:Mh(t.amount)})]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500 mb-1 text-sm",children:"Ni Dung Chuyn Khon"}),c.jsx("div",{className:"p-3 rounded-lg border border-gray-200 text-sm text-gray-800 bg-gray-50 min-h-[80px]",children:t.note||"Khng c ghi ch"})]})]}),c.jsx("div",{className:"px-5 py-4 border-t border-gray-200 flex justify-end",children:c.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-300 rounded-lg hover:bg-indigo-500/10 transition",children:"ng"})})]})});function Uoe(){const[e,t]=v.useState(""),[r,n]=v.useState(""),[a,i]=v.useState(""),[s,l]=v.useState("receipt"),[d,h]=v.useState([]),[f,p]=v.useState(!1),[x,g]=v.useState(null),[b,_]=v.useState(!1),[w,S]=v.useState(null),[T,E]=v.useState(!1),[k,A]=v.useState(""),[j,P]=v.useState(""),[D,L]=v.useState(null),I=v.useRef(null);v.useEffect(()=>{(async()=>{try{p(!0),g(null);const H=await Ct("/api/payment-receipts");if(!H.ok)throw new Error("Khng th ti bin nhn.");const se=await H.json(),Y=Array.isArray(se?.receipts)?se.receipts:Array.isArray(se)?se:[];h(Y.map(Doe))}catch(H){console.error(H),g(H instanceof Error?H.message:"Khng th ti bin nhn.")}finally{p(!1)}})()},[]);const O=v.useMemo(()=>{const te=e.trim().toLowerCase(),H=Iv(r),se=Iv(a);return d.filter(Y=>{const ce=J1(Y.orderCode),ue=!te||[Y.orderCode,Y.note,cd(Y)].map(K=>K?.toLowerCase()??"").some(K=>K.includes(te)),me=Iv(hr(Y.paidAt)||""),Re=H===null||me===null||me>=H,U=se===null||me===null||me<=se;return ue&&Re&&U&&ce===s})},[d,e,r,a,s]),M=v.useMemo(()=>{const te=d.reduce((se,Y)=>(Y.orderCode||"").toUpperCase().startsWith("MAV")?se+Y.amount:se,0),H=d.length>0?d[0].paidAt??"":"";return[{name:"Tng Bin Nhn",value:d.length.toString(),icon:nc,accent:Rr.sky},{name:"Tng S Tin",value:koe(te),icon:nc,accent:Rr.emerald},{name:"Bin Nhn Gn Nht",value:H?hr(H)??"--":"--",icon:l4,accent:Rr.violet}]},[d]),re=v.useMemo(()=>d.reduce((te,H)=>{const se=J1(H.orderCode);return te[se]+=1,te},{receipt:0,refund:0}),[d]),oe=()=>{if(!O.length)return;const te=Roe(O),H=Z1.book_new();Z1.book_append_sheet(H,te,"Bin nhn thanh ton");const se=new Date().toISOString().slice(0,10).replace(/-/g,"");xoe(H,`payment_receipts_${se}.xlsx`)},ee=f||O.length===0;v.useEffect(()=>{const te=H=>{I.current&&!I.current.contains(H.target)&&_(!1)};return document.addEventListener("mousedown",te),()=>document.removeEventListener("mousedown",te)},[]);const fe=r&&a?`${r} - ${a}`:"dd/mm/yyyy - dd/mm/yyyy",J=te=>{S(H=>H===te?null:te)},ie=te=>{L(te)},Q=()=>{L(null)};return c.jsxs(c.Fragment,{children:[c.jsx(Boe,{open:T,amount:k,note:j,onClose:()=>E(!1),onAmountChange:A,onNoteChange:P}),c.jsx($oe,{open:!!D,receipt:D,onClose:Q}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-white drop-shadow-sm",children:"Bin nhn thanh ton"}),c.jsx("p",{className:"mt-1 text-sm text-white/80",children:"Theo di giao dch chuyn khon c lu trong h thng"})]}),c.jsx(Ci,{icon:Ai,className:"mt-4 sm:mt-0",onClick:()=>E(!0),children:"Thm bin nhn"})]}),c.jsx(Ioe,{stats:M}),c.jsx(Foe,{searchTerm:e,onSearchChange:t,dateStart:r,dateEnd:a,dateRangeDisplay:fe,rangePickerOpen:b,setRangePickerOpen:_,dateRangeRef:I,toDisplayDate:joe,toISODate:Ooe,onDateStartChange:n,onDateEndChange:i,onExport:oe,exportDisabled:ee}),x&&c.jsx("div",{className:"text-sm text-red-600 px-1",children:x}),c.jsx(Moe,{activeCategory:s,counts:re,onChange:l}),c.jsx(Loe,{receipts:O,expandedReceiptId:w,onToggle:J,onSelectReceipt:ie}),!f&&O.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-white/70 text-lg mb-2",children:"Khng c Bin Nhn"}),c.jsx("div",{className:"text-white/60",children:"Th t kha khc"})]}),f&&c.jsx("div",{className:"text-center py-8 text-white/60 text-sm",children:"ang ti d liu..."})]})]})}const zoe=()=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ay,{className:"h-7 w-7 text-indigo-300"}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-white",children:"Luu tru"}),c.jsx("p",{className:"text-sm text-white/70",children:"Hang dang con ton kho (chua ghep vao don hang)"})]})]}),Woe=({search:e,onSearchChange:t,onCreate:r,loading:n,error:a})=>c.jsx("div",{className:"rounded-2xl border border-white/10 bg-white/5 shadow-lg shadow-indigo-900/40 p-4 space-y-3",children:c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(il,{className:"h-5 w-5 text-white/60 absolute left-3 top-2.5"}),c.jsx("input",{className:"w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60 pl-10",placeholder:"Tim theo goi, tai khoan, nha cung cap...",value:e,onChange:s=>t(s.target.value)})]}),c.jsxs("button",{type:"button",onClick:r,className:"inline-flex items-center gap-2 rounded-xl bg-indigo-600/80 hover:bg-indigo-600 text-white px-3 py-2 text-sm font-semibold disabled:opacity-60",disabled:n,children:[c.jsx(Ai,{className:"h-4 w-4"}),"Them"]}),n&&c.jsxs("div",{className:"text-sm text-white/80 flex items-center gap-2",children:[c.jsx("span",{className:"animate-spin h-4 w-4 rounded-full border-2 border-white/40 border-t-transparent"}),"Dang tai..."]}),a&&c.jsxs("div",{className:"text-sm text-rose-200 flex items-center gap-2",children:[c.jsx(ly,{className:"h-5 w-5"}),a]})]})}),Hoe="w-full rounded-lg border border-white/15 bg-white/5 px-3 py-2 text-white placeholder:text-slate-300 focus:ring-2 focus:ring-blue-400/60 focus:border-blue-400/60",v0=e=>(e??"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),Koe=({items:e,draft:t,editingId:r,loading:n,onDraftChange:a,onSave:i,onDelete:s,onCancel:l,onStartEdit:d})=>{const h=(f,p)=>c.jsx("input",{className:`${Hoe} bg-white/10 border-white/20`,value:p||"",onChange:x=>a(f,x.target.value)});return c.jsx("div",{className:"overflow-auto rounded-xl border border-white/10 bg-white/5",children:c.jsxs("table",{className:"min-w-full text-sm text-white",children:[c.jsx("thead",{className:"bg-white/10 text-left",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Loai"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Tai khoan"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mat khau"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Mail du phong"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"2FA"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Trang thai"}),c.jsx("th",{className:"px-4 py-2 font-semibold",children:"Ghi chu"}),c.jsx("th",{className:"px-4 py-2 font-semibold text-center",children:"Thao tac"})]})}),c.jsxs("tbody",{children:[r==="new"&&t&&c.jsxs("tr",{className:"border-t border-white/5 bg-white/5",children:[c.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:h("category",t.category)}),c.jsx("td",{className:"px-4 py-2",children:h("account",t.account)}),c.jsx("td",{className:"px-4 py-2",children:h("password",t.password)}),c.jsx("td",{className:"px-4 py-2",children:h("backup_email",t.backup_email)}),c.jsx("td",{className:"px-4 py-2",children:h("two_fa",t.two_fa)}),c.jsx("td",{className:"px-4 py-2",children:h("status",t.status)}),c.jsx("td",{className:"px-4 py-2",children:h("note",t.note)}),c.jsx("td",{className:"px-4 py-2 text-center",children:c.jsxs("div",{className:"inline-flex items-center gap-2",children:[c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>i(void 0),disabled:n,title:"Luu",children:c.jsx(Wo,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:l,disabled:n,title:"Huy",children:c.jsx(Hr,{className:"h-4 w-4"})})]})})]}),e.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-white/70",children:"Khong co hang ton kho"})}):e.map(f=>{const p=r===f.id,x=p&&t||f;return c.jsxs("tr",{className:"border-t border-white/5 hover:bg-white/5",children:[c.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-semibold",children:p?h("category",x.category):f.category||"N/A"}),c.jsx("td",{className:"px-4 py-2",children:p?h("account",x.account):c.jsx("div",{className:"font-medium",children:f.account||"Chua co tai khoan"})}),c.jsx("td",{className:"px-4 py-2",children:p?h("password",x.password):f.password||c.jsx("span",{className:"text-white/60",children:"--"})}),c.jsx("td",{className:"px-4 py-2",children:p?h("backup_email",x.backup_email):f.backup_email||c.jsx("span",{className:"text-white/60",children:"--"})}),c.jsx("td",{className:"px-4 py-2",children:p?h("two_fa",x.two_fa):f.two_fa||c.jsx("span",{className:"text-white/60",children:"--"})}),c.jsx("td",{className:"px-4 py-2",children:p?h("status",x.status):c.jsx("span",{className:"inline-flex rounded-full bg-white/10 px-3 py-1 text-xs font-semibold text-white",children:f.status||"--"})}),c.jsx("td",{className:"px-4 py-2",children:p?h("note",x.note):c.jsx("div",{className:"text-white/80 whitespace-pre-wrap break-words",children:f.note||"--"})}),c.jsx("td",{className:"px-4 py-2 text-center",children:c.jsx("div",{className:"inline-flex items-center gap-2",children:p?c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-emerald-600/70 hover:bg-emerald-600 text-white transition disabled:opacity-60",onClick:()=>i(f.id),disabled:n,title:"Luu",children:c.jsx(Wo,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-rose-600/70 hover:bg-rose-600 text-white transition disabled:opacity-60",onClick:()=>s(f.id),disabled:n,title:"Xoa",children:c.jsx(qs,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition disabled:opacity-60",onClick:l,disabled:n,title:"Huy",children:c.jsx(Hr,{className:"h-4 w-4"})})]}):c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-indigo-100 hover:text-white transition disabled:opacity-60",onClick:()=>d(f),disabled:n,title:"Sua",children:c.jsx($h,{className:"h-4 w-4"})}),c.jsx("button",{type:"button",className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-rose-200 hover:text-rose-100 transition disabled:opacity-60",onClick:()=>s(f.id),disabled:n,title:"Xoa",children:c.jsx(qs,{className:"h-4 w-4"})})]})})})]},f.id??`${f.category??""}-${f.account??""}`)})]})]})})};function Voe(){const[e,t]=v.useState([]),[r,n]=v.useState(!1),[a,i]=v.useState(null),[s,l]=v.useState(""),[d,h]=v.useState(null),[f,p]=v.useState(null);v.useEffect(()=>{let E=!0;const k=j=>j?Array.isArray(j)?j:Array.isArray(j.items)?j.items:[]:[];return(async()=>{n(!0),i(null);try{let j=await Ct(kt.WAREHOUSE);if(j.status===404&&(j=await Ct("/api/warehouses")),!j.ok)throw new Error(`Khong the tai du lieu (${j.status})`);const P=await j.json(),D=k(P);E&&t(D)}catch(j){E&&i(j?.message||"Loi khong xac dinh")}finally{E&&n(!1)}})(),()=>{E=!1}},[]);const x=E=>{h(E.id??null),p({...E})},g=()=>{h(null),p(null)},b=(E,k)=>{p(A=>({...A||{},[E]:k}))},_=async E=>{if(!(!E&&d!=="new"||!f)){n(!0),i(null);try{if(d==="new"){const k=await Ct(kt.WAREHOUSE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!k.ok)throw new Error(`Tao moi that bai (${k.status})`);const A=await k.json();t(j=>[...j,A]),g()}else{const k=await Ct(`${kt.WAREHOUSE}/${E}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});if(!k.ok)throw new Error(`Cap nhat that bai (${k.status})`);const A=await k.json();t(j=>j.map(P=>P.id===E?{...P,...A}:P)),g()}}catch(k){i(k?.message||"Loi khi cap nhat")}finally{n(!1)}}},w=async E=>{if(E&&confirm("Ban co chac muon xoa ban ghi nay?")){n(!0),i(null);try{const k=await Ct(`${kt.WAREHOUSE}/${E}`,{method:"DELETE"});if(!k.ok)throw new Error(`Xoa that bai (${k.status})`);t(A=>A.filter(j=>j.id!==E)),d===E&&g()}catch(k){i(k?.message||"Loi khi xoa")}finally{n(!1)}}},S=()=>{h("new"),p({category:"",account:"",password:"",backup_email:"",two_fa:"",note:"",status:"Ton"})},T=v.useMemo(()=>({filtered:e.filter(k=>{if(!s.trim())return!0;const A=v0(s);return[k.category,k.account,k.password,k.backup_email,k.two_fa,k.note,k.status].some(j=>v0(j).includes(A))}).sort((k,A)=>{const j=v0(k.category),P=v0(A.category);return j.localeCompare(P,"vi")})}),[e,s]);return c.jsxs("div",{className:"p-4 lg:p-6 space-y-4",children:[c.jsx(zoe,{}),c.jsx(Woe,{search:s,onSearchChange:l,onCreate:S,loading:r,error:a}),c.jsx(Koe,{items:T.filtered,draft:f,editingId:d,loading:r,onDraftChange:b,onSave:_,onDelete:w,onCancel:g,onStartEdit:x,onStartCreate:S})]})}function Goe({children:e}){const{user:t,loading:r}=dy(),n=oo();return r?null:t?c.jsx(c.Fragment,{children:e}):c.jsx(Mv,{to:"/login",replace:!0,state:{from:n.pathname}})}function Yoe(){const[e,t]=v.useState(!1);return c.jsx(BI,{children:c.jsx(Q6,{children:c.jsxs(pS,{children:[c.jsx(Fn,{path:"/login",element:c.jsx(CZ,{})}),c.jsx(Fn,{path:"/*",element:c.jsx(Goe,{children:c.jsxs("div",{className:"min-h-screen app-aurora",children:[c.jsx(Z6,{isOpen:e,setIsOpen:t}),c.jsxs("div",{className:"transition-all duration-300 ease-in-out lg:ml-64 print-shell",children:[c.jsx("div",{className:"h-16 lg:hidden"}),c.jsx("main",{className:"p-0 pt-[10px] pl-[10px] max-w-none",children:c.jsxs(pS,{children:[c.jsx(Fn,{path:"/",element:c.jsx(Mv,{to:"/dashboard",replace:!0})}),c.jsx(Fn,{path:"/dashboard",element:c.jsx(Zq,{})}),c.jsx(Fn,{path:"/orders",element:c.jsx(wQ,{})}),c.jsx(Fn,{path:"/package-products",element:c.jsx(UQ,{})}),c.jsx(Fn,{path:"/product-info",element:c.jsx(tZ,{})}),c.jsx(Fn,{path:"/sources",element:c.jsx(WZ,{})}),c.jsx(Fn,{path:"/pricing",element:c.jsx(TZ,{})}),c.jsx(Fn,{path:"/bill-order",element:c.jsx(fJ,{})}),c.jsx(Fn,{path:"/show-price",element:c.jsx(nJ,{})}),c.jsx(Fn,{path:"/invoices",element:c.jsx(Uoe,{})}),c.jsx(Fn,{path:"/warehouse",element:c.jsx(Voe,{})}),c.jsx(Fn,{path:"*",element:c.jsx(Mv,{to:"/dashboard",replace:!0})})]})})]})]})})})]})})})}zR.createRoot(document.getElementById("root")).render(c.jsx(Yoe,{}));
